2025-06-06 15:18:21,534 - INFO - Application logging to file: logs/app_20250606_151821.log
2025-06-06 15:18:21,535 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-06 15:18:21,535 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-06 15:18:21,535 - INFO - Train Mode: train, Visualization Path: vis
2025-06-06 15:18:21,535 - INFO - Found 46 files to process.
2025-06-06 15:18:21,535 - INFO - 
--- Processing file: nw_graph_encoded_1749044168.dot ---
2025-06-06 15:18:21,535 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot
2025-06-06 15:18:21,535 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot file.
2025-06-06 15:18:21,537 - INFO - Parsed 20 nodes.
2025-06-06 15:18:21,538 - INFO - Parsed 27 edges.
2025-06-06 15:18:21,539 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:21,539 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:21,540 - DEBUG - Initial node features tensor shape: torch.Size([20, 19])
2025-06-06 15:18:21,542 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:21,542 - DEBUG - Node features tensor shape after scaling: torch.Size([20, 19])
2025-06-06 15:18:21,543 - DEBUG - Edge index tensor shape: torch.Size([2, 27])
2025-06-06 15:18:21,543 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:21,544 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:18:21,545 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-06 15:18:21,545 - DEBUG - Shape of encoded categorical edge features: torch.Size([27, 2])
2025-06-06 15:18:21,546 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:21,546 - DEBUG - Shape of scaled numerical edge features: torch.Size([27, 20])
2025-06-06 15:18:21,546 - DEBUG - Final edge attributes tensor shape: torch.Size([27, 22])
2025-06-06 15:18:21,547 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:21,547 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-06 15:18:21,547 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-06 15:18:21,643 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-06 15:18:21,647 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-06 15:18:21,651 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-06 15:18:21,654 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-06 15:18:21,654 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-06 15:18:21,654 - INFO - RunningStats initialized.
2025-06-06 15:18:21,654 - INFO - RunningStats initialized.
2025-06-06 15:18:21,654 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-06 15:18:21,656 - INFO - Using device: cpu
2025-06-06 15:18:21,656 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-06 15:18:21,749 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 24
2025-06-06 15:18:21,749 - INFO - Resuming online updates from step: 24
2025-06-06 15:18:21,749 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-06 15:18:21,749 - INFO - Performing online update...
2025-06-06 15:18:21,750 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:21,750 - DEBUG - Updated RunningStats: new_mean=[ 4.24179333e-10 -4.47459765e-10 -2.59923369e-09  2.29922324e-09
 -2.55380000e-08  1.38379138e-08 -9.62910136e-09 -2.30249672e-09
 -2.98584883e-09  9.91116124e-10  1.39623249e-09 -1.53229225e-09
  3.72705147e-09 -3.45991395e-09  9.86248984e-10  8.07574838e-10
 -3.77224240e-09  1.16830668e-09 -4.76854511e-09], new_M2=[194602.00540115 194602.00535794 194602.00026687 194602.00432196
 194601.998477   194601.99850062 194601.99598497 194601.99818301
 194601.99315624 194601.99842011 194602.00189731 194601.9938672
 194601.99277963 154810.99667463 154811.00010588 154810.9988389
 154811.00001141 194602.00020937 194602.00774398], new_n=194602
2025-06-06 15:18:21,751 - DEBUG - Updated RunningStats: new_mean=[ 1.41532250e+00  5.49863993e+00  1.06630511e-10  2.59668680e-10
  1.43500550e-10 -1.64374584e-10 -1.28667713e-09  1.99941330e-10
  2.92109098e-10 -2.04935543e-10  3.23762162e-10 -3.49191445e-09
 -8.72714064e-10  2.86343887e-10  3.09699760e-10 -1.56274159e-10
 -1.56274159e-10 -1.56274159e-10 -1.56274159e-10 -1.56274159e-10
 -1.56274159e-10 -8.04825104e-11], new_M2=[ 107884.9650104  1871847.22475999  419095.99899734  419096.00591938
  419096.00569482  419095.99325985  419096.00036953  419095.99910393
  419096.00166847  419095.99933428  419095.99393489  419096.00854099
  419096.001123    419095.99983346  419096.00182681  419095.99456326
  419095.99456326  419095.99456326  419095.99456326  419095.99456326
  419095.99456326  419095.9990658 ], new_n=419096
2025-06-06 15:18:21,751 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89192277 0.89192278 0.89192278 0.89192278 1.
 1.00000002]
2025-06-06 15:18:21,751 - DEBUG - Calculated standard deviation: [0.50736874 2.11338413 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:21,751 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:21,751 - DEBUG - Online update step: 1/50
2025-06-06 15:18:21,751 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,751 - DEBUG - Online update step: 2/50
2025-06-06 15:18:21,751 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,751 - DEBUG - Online update step: 3/50
2025-06-06 15:18:21,751 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 4/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 5/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 6/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 7/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 8/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 9/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 10/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 11/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 12/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,752 - DEBUG - Online update step: 13/50
2025-06-06 15:18:21,752 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 14/50
2025-06-06 15:18:21,753 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 15/50
2025-06-06 15:18:21,753 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 16/50
2025-06-06 15:18:21,753 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 17/50
2025-06-06 15:18:21,753 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 18/50
2025-06-06 15:18:21,753 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,753 - DEBUG - Online update step: 19/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,754 - DEBUG - Online update step: 20/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,754 - DEBUG - Online update step: 21/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,754 - DEBUG - Online update step: 22/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,754 - DEBUG - Online update step: 23/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,754 - DEBUG - Online update step: 24/50
2025-06-06 15:18:21,754 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,755 - DEBUG - Online update step: 25/50
2025-06-06 15:18:21,756 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,756 - DEBUG - Online update step: 26/50
2025-06-06 15:18:21,756 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,756 - DEBUG - Online update step: 27/50
2025-06-06 15:18:21,756 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,756 - DEBUG - Online update step: 28/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 29/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 30/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 31/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 32/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 33/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,757 - DEBUG - Online update step: 34/50
2025-06-06 15:18:21,757 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 35/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 36/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 37/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 38/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 39/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 40/50
2025-06-06 15:18:21,758 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,758 - DEBUG - Online update step: 41/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 42/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 43/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 44/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 45/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 46/50
2025-06-06 15:18:21,759 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,759 - DEBUG - Online update step: 47/50
2025-06-06 15:18:21,760 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,760 - DEBUG - Online update step: 48/50
2025-06-06 15:18:21,760 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,760 - DEBUG - Online update step: 49/50
2025-06-06 15:18:21,760 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,760 - DEBUG - Online update step: 50/50
2025-06-06 15:18:21,760 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,760 - WARNING - No successful steps during online update.
2025-06-06 15:18:21,762 - DEBUG - Current node mean: [ 3.5762788e-08 -3.5762788e-08  0.0000000e+00 -3.5762788e-08
  1.1920929e-08  0.0000000e+00  0.0000000e+00  3.5762788e-08
  2.2351742e-08  0.0000000e+00  5.9604646e-09  0.0000000e+00
 -1.1920929e-08  2.3841858e-08  1.1920929e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.3841858e-08], current edge mean: [ 1.4814815e-01  2.6296296e+00  4.4151589e-09 -8.8303178e-09
 -8.8303178e-09  8.8303178e-09  1.7660636e-08 -3.5321271e-08
  8.8303178e-09 -8.8303178e-09 -4.4151589e-09  1.4349267e-08
  0.0000000e+00  3.5321271e-08  3.5321271e-08  1.3245477e-08
  1.3245477e-08  1.3245477e-08  1.3245477e-08  1.3245477e-08
  1.3245477e-08  0.0000000e+00]
2025-06-06 15:18:21,762 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4975
2025-06-06 15:18:21,762 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:18:21,763 - DEBUG - Updated reference mean: node=[ 3.5762788e-08 -3.5762788e-08  0.0000000e+00 -3.5762788e-08
  1.1920929e-08  0.0000000e+00  0.0000000e+00  3.5762788e-08
  2.2351742e-08  0.0000000e+00  5.9604646e-09  0.0000000e+00
 -1.1920929e-08  2.3841858e-08  1.1920929e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.3841858e-08], edge=[ 1.4814815e-01  2.6296296e+00  4.4151589e-09 -8.8303178e-09
 -8.8303178e-09  8.8303178e-09  1.7660636e-08 -3.5321271e-08
  8.8303178e-09 -8.8303178e-09 -4.4151589e-09  1.4349267e-08
  0.0000000e+00  3.5321271e-08  3.5321271e-08  1.3245477e-08
  1.3245477e-08  1.3245477e-08  1.3245477e-08  1.3245477e-08
  1.3245477e-08  0.0000000e+00]
2025-06-06 15:18:21,763 - DEBUG - Updated reference std: node=[1.0259784 1.0259784 1.0259783 1.0259783 1.0259784 1.0259783 1.0259783
 1.0259783 1.0259783 1.0259783 1.0259783 1.0259783 1.0259784 1.0259783
 1.0259784 1.0259783 1.0259783 1.0259783 1.0259783], edge=[0.362014  1.5479054 1.0190494 1.0190493 1.0190493 1.0190494 1.0190493
 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493
 1.0190493 1.0190494 1.0190494 1.0190494 1.0190494 1.0190494 1.0190494
 1.0190493]
2025-06-06 15:18:21,764 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:21,764 - INFO - Running anomaly detection...
2025-06-06 15:18:21,764 - INFO - Starting anomaly detection.
2025-06-06 15:18:21,951 - DEBUG - Node reconstruction errors: [0.01675244 0.01675243 0.01675243 0.559429   0.01675243 0.01675243
 0.6774985  0.01675243 0.50433576 0.01675243 0.01675243 0.1912607
 0.3254799  0.19310485 0.01675244 0.04407169 0.5288434  0.01675243
 0.01675244 0.04407172]
2025-06-06 15:18:21,951 - DEBUG - Edge reconstruction errors: [0.7999825  0.7999813  0.7999834  0.79999983 0.7978211  0.7978266
 0.79765755 0.7714779  0.7936723  0.68501204 0.55057645 0.5708997
 0.04498321 0.01976919 0.04812449 0.68745667 0.6824448  0.68620324
 0.6903688  0.6835901  0.67549926 0.67976516 0.5786699  0.8
 0.8        0.8        0.8       ]
2025-06-06 15:18:21,953 - ERROR - An error occurred while processing file nw_graph_encoded_1749044168.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:21,953 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:21,954 - INFO - 
--- Processing file: nw_graph_encoded_1749044228.dot ---
2025-06-06 15:18:21,954 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot
2025-06-06 15:18:21,954 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot file.
2025-06-06 15:18:21,958 - INFO - Parsed 49 nodes.
2025-06-06 15:18:21,961 - INFO - Parsed 66 edges.
2025-06-06 15:18:21,965 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:21,966 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:21,968 - DEBUG - Initial node features tensor shape: torch.Size([49, 19])
2025-06-06 15:18:21,971 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:21,972 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 19])
2025-06-06 15:18:21,972 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-06 15:18:21,972 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:21,973 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:18:21,973 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:18:21,973 - DEBUG - Shape of encoded categorical edge features: torch.Size([66, 2])
2025-06-06 15:18:21,974 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:21,974 - DEBUG - Shape of scaled numerical edge features: torch.Size([66, 20])
2025-06-06 15:18:21,974 - DEBUG - Final edge attributes tensor shape: torch.Size([66, 22])
2025-06-06 15:18:21,974 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:21,974 - INFO - Performing online update...
2025-06-06 15:18:21,975 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:21,975 - DEBUG - Updated RunningStats: new_mean=[ 4.23125207e-10 -4.46246673e-10 -2.59704832e-09  2.29818514e-09
 -2.55331023e-08  1.38356552e-08 -9.62606497e-09 -2.30099847e-09
 -2.98188196e-09  9.93469437e-10  1.39833072e-09 -1.53481555e-09
  3.72703188e-09 -3.46669830e-09  9.86306926e-10  8.05381161e-10
 -3.76926414e-09  1.17069194e-09 -4.77224412e-09], new_M2=[194651.00540006 194651.00535685 194651.00026695 194651.00432004
 194650.99847433 194650.99850411 194650.99598818 194650.99818458
 194650.99315704 194650.99841998 194651.00189651 194650.99386549
 194650.99278037 154859.99667473 154860.00010551 154859.99884084
 154860.00001295 194651.00021071 194651.00774764], new_n=194651
2025-06-06 15:18:21,976 - DEBUG - Updated RunningStats: new_mean=[ 1.41512112e+00  5.49826320e+00  1.06834797e-10  2.59627793e-10
  1.43775685e-10 -1.63704361e-10 -1.28522029e-09  2.00238685e-10
  2.91680942e-10 -2.05025478e-10  3.24671031e-10 -3.48974898e-09
 -8.72596646e-10  2.88218494e-10  3.08797798e-10 -1.55649648e-10
 -1.55649648e-10 -1.55649648e-10 -1.55649648e-10 -1.55649648e-10
 -1.55649648e-10 -8.02032137e-11], new_M2=[ 108000.67930061 1872531.23561061  419161.99899646  419162.0059186
  419162.00569583  419161.99326259  419162.00036684  419161.99910259
  419162.00166869  419161.99933477  419161.99393768  419162.00853924
  419162.0011222   419161.99983312  419162.00182489  419161.99456698
  419161.99456698  419161.99456698  419161.99456698  419161.99456698
  419161.99456698  419161.99906631], new_n=419162
2025-06-06 15:18:21,976 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89195163 0.89195164 0.89195164 0.89195164 1.
 1.00000002]
2025-06-06 15:18:21,976 - DEBUG - Calculated standard deviation: [0.50760079 2.11360381 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:21,976 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:21,976 - DEBUG - Online update step: 1/50
2025-06-06 15:18:21,976 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,976 - DEBUG - Online update step: 2/50
2025-06-06 15:18:21,976 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,976 - DEBUG - Online update step: 3/50
2025-06-06 15:18:21,976 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,976 - DEBUG - Online update step: 4/50
2025-06-06 15:18:21,976 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,976 - DEBUG - Online update step: 5/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 6/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 7/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 8/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 9/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 10/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 11/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 12/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 13/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 14/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 15/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 16/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 17/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 18/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 19/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 20/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,977 - DEBUG - Online update step: 21/50
2025-06-06 15:18:21,977 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 22/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 23/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 24/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 25/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 26/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 27/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 28/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 29/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 30/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 31/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 32/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 33/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 34/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 35/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 36/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,978 - DEBUG - Online update step: 37/50
2025-06-06 15:18:21,978 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 38/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 39/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 40/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 41/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 42/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 43/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 44/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 45/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 46/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 47/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 48/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 49/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - DEBUG - Online update step: 50/50
2025-06-06 15:18:21,979 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:21,979 - WARNING - No successful steps during online update.
2025-06-06 15:18:21,982 - DEBUG - Current node mean: [-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], current edge mean: [ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:18:21,982 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5192
2025-06-06 15:18:21,982 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:18:21,983 - DEBUG - Updated reference mean: node=[-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], edge=[ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:18:21,984 - DEBUG - Updated reference std: node=[1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363], edge=[0.345804  2.1706347 1.0076629 1.0076629 1.007663  1.007663  1.0076629
 1.0076629 1.0076629 1.0076629 1.007663  1.0076629 1.0076629 1.0076629
 1.0076629 1.007663  1.007663  1.007663  1.007663  1.007663  1.007663
 1.0076629]
2025-06-06 15:18:21,984 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:21,984 - INFO - Running anomaly detection...
2025-06-06 15:18:21,984 - INFO - Starting anomaly detection.
2025-06-06 15:18:22,025 - DEBUG - Node reconstruction errors: [0.07977078 0.00718954 0.00718954 0.07977078 0.00718954 0.00718954
 0.01514881 0.07339779 0.00718954 0.05352092 0.00718954 0.02649076
 1.8940403  0.05352092 0.02649076 0.19464332 0.46226415 0.00718954
 0.00718954 0.0779943  0.00718954 0.01514881 0.02649076 0.02649076
 0.02649076 0.00718954 0.6922126  0.00718954 0.04191439 0.00718954
 0.02649076 0.84768426 0.00718954 0.00718954 0.02649076 0.00718954
 0.02649076 0.00718954 0.00718954 0.02649076 0.02649076 0.02649076
 0.04191439 0.5971215  0.00718954 0.00718954 0.01514881 0.07977074
 0.00718954]
2025-06-06 15:18:22,026 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.25889426 0.784113   0.76725066 0.13345379
 0.0324415  0.07107979 0.7770684  0.7781419  0.7779897  0.7762514
 0.77538204 0.13265598 0.12865388 0.16629994 0.16955847 0.15383822
 0.15088445 0.14734215 0.01884902 0.20897055 0.2064954  0.38622567
 0.38410026 0.376745   0.18588263 0.31428146 0.18228662 0.19306087
 0.09430957 0.1853689  0.18614072 0.2385943  0.16915685 0.00542396
 0.6084311  0.15389782 0.11175132 0.1548416  0.14769065 0.19663519
 0.2019049  0.30637646 0.20148891 0.19175756 0.14824957 0.1706649
 0.08035159 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8       ]
2025-06-06 15:18:22,027 - ERROR - An error occurred while processing file nw_graph_encoded_1749044228.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:22,027 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:22,027 - INFO - 
--- Processing file: nw_graph_encoded_1749044288.dot ---
2025-06-06 15:18:22,027 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot
2025-06-06 15:18:22,027 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot file.
2025-06-06 15:18:22,030 - INFO - Parsed 65 nodes.
2025-06-06 15:18:22,031 - INFO - Parsed 89 edges.
2025-06-06 15:18:22,034 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:22,034 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:22,035 - DEBUG - Initial node features tensor shape: torch.Size([65, 19])
2025-06-06 15:18:22,036 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:22,036 - DEBUG - Node features tensor shape after scaling: torch.Size([65, 19])
2025-06-06 15:18:22,037 - DEBUG - Edge index tensor shape: torch.Size([2, 89])
2025-06-06 15:18:22,037 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:22,038 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:22,039 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:18:22,039 - DEBUG - Shape of encoded categorical edge features: torch.Size([89, 2])
2025-06-06 15:18:22,040 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:22,040 - DEBUG - Shape of scaled numerical edge features: torch.Size([89, 20])
2025-06-06 15:18:22,040 - DEBUG - Final edge attributes tensor shape: torch.Size([89, 22])
2025-06-06 15:18:22,041 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:22,041 - INFO - Performing online update...
2025-06-06 15:18:22,041 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:22,042 - DEBUG - Updated RunningStats: new_mean=[ 4.21644726e-10 -4.44681945e-10 -2.59905116e-09  2.29420379e-09
 -2.55264155e-08  1.38299652e-08 -9.61596411e-09 -2.30099563e-09
 -2.98088655e-09  9.90995023e-10  1.40796558e-09 -1.53613986e-09
  3.73497105e-09 -3.46676549e-09  9.86360316e-10  8.08173416e-10
 -3.76892422e-09  1.17351530e-09 -4.77371216e-09], new_M2=[194716.00539825 194716.00535504 194716.0002626  194716.00431521
 194715.99847648 194715.99850737 194715.99598447 194715.99818775
 194715.99315525 194715.99842508 194716.00189768 194715.99386764
 194715.99277907 154924.99667393 154925.00010531 154924.99883959
 154925.00001156 194716.00020974 194716.0077494 ], new_n=194716
2025-06-06 15:18:22,042 - DEBUG - Updated RunningStats: new_mean=[ 1.41505208e+00  5.49778295e+00  1.06892088e-10  2.59705963e-10
  1.44040332e-10 -1.63575755e-10 -1.28699114e-09  1.98937756e-10
  2.90723800e-10 -2.05292950e-10  3.24531024e-10 -3.48975455e-09
 -8.71278496e-10  2.90005512e-10  3.07737060e-10 -1.56249704e-10
 -1.56249704e-10 -1.56249704e-10 -1.56249704e-10 -1.56249704e-10
 -1.56249704e-10 -8.11747092e-11], new_M2=[ 108019.37233781 1873374.68925301  419250.99899675  419251.00591935
  419251.00569923  419250.99326447  419251.0003652   419250.99909979
  419251.00166659  419250.99933496  419250.99393546  419251.00854029
  419251.00112281  419250.99983172  419251.00182418  419250.99456156
  419250.99456156  419250.99456156  419250.99456156  419250.99456156
  419250.99456156  419250.99906024], new_n=419251
2025-06-06 15:18:22,042 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89198988 0.89198989 0.89198989 0.89198989 1.
 1.00000002]
2025-06-06 15:18:22,043 - DEBUG - Calculated standard deviation: [0.50759083 2.11385537 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:22,043 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:22,043 - DEBUG - Online update step: 1/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 2/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 3/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 4/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 5/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 6/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 7/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 8/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,043 - DEBUG - Online update step: 9/50
2025-06-06 15:18:22,043 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 10/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 11/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 12/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 13/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 14/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 15/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 16/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 17/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 18/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 19/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 20/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 21/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 22/50
2025-06-06 15:18:22,044 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,044 - DEBUG - Online update step: 23/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 24/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 25/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 26/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 27/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 28/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 29/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 30/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 31/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 32/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 33/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 34/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 35/50
2025-06-06 15:18:22,045 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,045 - DEBUG - Online update step: 36/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 37/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 38/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 39/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 40/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 41/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 42/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 43/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 44/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 45/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 46/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 47/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 48/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 49/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,046 - DEBUG - Online update step: 50/50
2025-06-06 15:18:22,046 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,047 - WARNING - No successful steps during online update.
2025-06-06 15:18:22,048 - DEBUG - Current node mean: [-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], current edge mean: [ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:18:22,048 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0700
2025-06-06 15:18:22,048 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:18:22,048 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:18:22,048 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:18:22,049 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:18:22,049 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:18:22,049 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:18:22,049 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:18:22,049 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:18:22,050 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:18:22,050 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:18:22,050 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:18:22,050 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:18:22,051 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:18:22,052 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:18:22,052 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:18:22,053 - INFO - Optimizer and scheduler reset.
2025-06-06 15:18:22,054 - DEBUG - Updated reference mean: node=[-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], edge=[ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:18:22,054 - DEBUG - Updated reference std: node=[1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822], edge=[0.32475337 2.0999053  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658 ]
2025-06-06 15:18:22,054 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:22,054 - INFO - Running anomaly detection...
2025-06-06 15:18:22,055 - INFO - Starting anomaly detection.
2025-06-06 15:18:22,462 - DEBUG - Node reconstruction errors: [  2.2936623   2.2936623   2.2936623   1.2987584   1.2987584   1.738639
   3.7807999   1.4060289   1.6116239   1.4060289   1.2987584   1.4060289
   1.2987583   1.2595505   2.2936623  71.91079     1.4060289   1.2773569
   1.2987584  80.83364     1.2987584 494.2044      1.4060289   1.4060289
   1.613781    1.2987583   1.5842389   1.2987584   1.2987584   1.4060289
   1.4060287   1.6116238   1.9188148   1.2987584   6.409082    2.2913594
 196.51039     1.4060289   1.2987583   1.2987584 865.2039      2.2913592
   1.4060289   1.9188142   1.2773569   1.2987584   1.2987584   5.6031995
   1.2987584   1.613781    8.500708   21.618155    1.2987584   1.2987584
   2.4958436   1.6116244   1.6116239   1.2987584   2.2936623   1.2987584
   1.2987584   1.6116239   6.0658956   1.6116245   2.2936628]
2025-06-06 15:18:22,464 - DEBUG - Edge reconstruction errors: [0.79749626 0.796964   0.7979966  0.7987833  0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.79891324 0.7998972
 0.6116329  0.7999517  0.7904113  0.7987514  0.799969   0.7999669
 0.799978   0.79995537 0.19999677 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999975 0.19999975 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19976449 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999951 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999975 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.19999999]
2025-06-06 15:18:22,475 - ERROR - An error occurred while processing file nw_graph_encoded_1749044288.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:22,476 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:22,476 - INFO - 
--- Processing file: nw_graph_encoded_1749044348.dot ---
2025-06-06 15:18:22,476 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot
2025-06-06 15:18:22,476 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot file.
2025-06-06 15:18:22,480 - INFO - Parsed 77 nodes.
2025-06-06 15:18:22,483 - INFO - Parsed 106 edges.
2025-06-06 15:18:22,488 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:22,488 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:22,490 - DEBUG - Initial node features tensor shape: torch.Size([77, 19])
2025-06-06 15:18:22,492 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:22,493 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 19])
2025-06-06 15:18:22,493 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-06 15:18:22,493 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:22,495 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:22,495 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:18:22,496 - DEBUG - Shape of encoded categorical edge features: torch.Size([106, 2])
2025-06-06 15:18:22,497 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:22,497 - DEBUG - Shape of scaled numerical edge features: torch.Size([106, 20])
2025-06-06 15:18:22,497 - DEBUG - Final edge attributes tensor shape: torch.Size([106, 22])
2025-06-06 15:18:22,497 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:22,497 - INFO - Performing online update...
2025-06-06 15:18:22,497 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:22,498 - DEBUG - Updated RunningStats: new_mean=[ 4.21286810e-10 -4.44238425e-10 -2.58960906e-09  2.29344991e-09
 -2.55141832e-08  1.38244983e-08 -9.60940910e-09 -2.29893860e-09
 -2.97970823e-09  9.86395933e-10  1.40098324e-09 -1.53415568e-09
  3.73471861e-09 -3.46401815e-09  9.78473670e-10  8.09536895e-10
 -3.76200308e-09  1.17769864e-09 -4.77304911e-09], new_M2=[194793.00540041 194793.0053572  194793.00025983 194793.00431126
 194792.99847808 194792.99850978 194792.99598699 194792.99818536
 194792.99315972 194792.99841884 194793.00189424 194792.99386547
 194792.99277333 155001.99667597 155002.00011097 155001.99884114
 155002.0000119  194793.00020784 194793.00775029], new_n=194793
2025-06-06 15:18:22,499 - DEBUG - Updated RunningStats: new_mean=[ 1.41497817e+00  5.49725174e+00  1.08175361e-10  2.59067342e-10
  1.45429699e-10 -1.62988083e-10 -1.28642903e-09  1.99456005e-10
  2.89208299e-10 -2.04135082e-10  3.23187559e-10 -3.49116186e-09
 -8.70503056e-10  2.85774805e-10  3.02400338e-10 -1.56458943e-10
 -1.56458943e-10 -1.56458943e-10 -1.56458943e-10 -1.56458943e-10
 -1.56458943e-10 -8.03546904e-11], new_M2=[ 108041.83912514 1874284.08263607  419356.99900394  419357.00591397
  419357.00570747  419356.99327037  419357.00036625  419356.99910507
  419357.00166515  419356.99933401  419356.99392674  419357.00854344
  419357.00112334  419356.99983417  419357.00182337  419356.99456081
  419356.99456081  419356.99456081  419356.99456081  419356.99456081
  419356.99456081  419356.99906466], new_n=419357
2025-06-06 15:18:22,499 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89203516 0.89203517 0.89203517 0.89203517 1.
 1.00000002]
2025-06-06 15:18:22,499 - DEBUG - Calculated standard deviation: [0.50757946 2.11410114 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:22,499 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:22,499 - DEBUG - Online update step: 1/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 2/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 3/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 4/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 5/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 6/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 7/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 8/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 9/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 10/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 11/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 12/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 13/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 14/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 15/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 16/50
2025-06-06 15:18:22,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,500 - DEBUG - Online update step: 17/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 18/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 19/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 20/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 21/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 22/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 23/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 24/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 25/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 26/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,501 - DEBUG - Online update step: 27/50
2025-06-06 15:18:22,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 28/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 29/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 30/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 31/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 32/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,502 - DEBUG - Online update step: 33/50
2025-06-06 15:18:22,502 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 34/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 35/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 36/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 37/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 38/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 39/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,503 - DEBUG - Online update step: 40/50
2025-06-06 15:18:22,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 41/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 42/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 43/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 44/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 45/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 46/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 47/50
2025-06-06 15:18:22,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,504 - DEBUG - Online update step: 48/50
2025-06-06 15:18:22,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,505 - DEBUG - Online update step: 49/50
2025-06-06 15:18:22,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,505 - DEBUG - Online update step: 50/50
2025-06-06 15:18:22,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,505 - WARNING - No successful steps during online update.
2025-06-06 15:18:22,506 - DEBUG - Current node mean: [-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], current edge mean: [ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:18:22,506 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.9938
2025-06-06 15:18:22,506 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:18:22,507 - DEBUG - Updated reference mean: node=[-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], edge=[ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:18:22,507 - DEBUG - Updated reference std: node=[1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575], edge=[0.3573135 2.0502229 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506]
2025-06-06 15:18:22,507 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:22,507 - INFO - Running anomaly detection...
2025-06-06 15:18:22,508 - INFO - Starting anomaly detection.
2025-06-06 15:18:22,534 - DEBUG - Node reconstruction errors: [2.2937148e+00 1.6473562e+00 1.6473562e+00 1.6473562e+00 1.6473562e+00
 1.6473562e+00 1.6473559e+00 1.6473559e+00 1.6473562e+00 1.1092224e+00
 1.1092224e+00 1.5600971e+00 3.3184261e+00 1.6473562e+00 1.2542768e+00
 1.2369920e+00 1.2542766e+00 1.1092224e+00 1.2542766e+00 1.2840258e+00
 1.2307107e+00 4.7824893e+00 7.8851715e+01 1.8458256e+00 1.2542766e+00
 1.6473562e+00 1.0375949e+00 1.1092224e+00 9.7078064e+01 1.1092224e+00
 6.1088513e+02 1.2542768e+00 1.2542766e+00 1.5583891e+00 1.6473562e+00
 1.1092224e+00 1.6714289e+00 1.1092221e+00 1.1092221e+00 1.2542768e+00
 1.2542766e+00 1.2369915e+00 1.8323332e+00 1.1092224e+00 5.9298720e+00
 1.8594302e+00 2.5725269e+02 1.2542768e+00 1.1092224e+00 1.1092224e+00
 1.0434790e+03 1.8594302e+00 1.2542766e+00 1.8323332e+00 1.0375950e+00
 1.1092223e+00 1.1092224e+00 6.1266174e+00 1.1092224e+00 1.5583891e+00
 9.3907728e+00 2.6670534e+01 1.1092223e+00 1.1092223e+00 1.8458248e+00
 1.2369915e+00 2.2937148e+00 1.2369915e+00 1.1092224e+00 1.6473562e+00
 1.6473559e+00 1.1092223e+00 1.1092224e+00 1.2369915e+00 7.1156449e+00
 1.2369919e+00 1.6473556e+00]
2025-06-06 15:18:22,535 - DEBUG - Edge reconstruction errors: [0.19999796 0.1999982  0.19999748 0.7671757  0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999713 0.19998664
 0.1999926  0.1999808  0.19999987 0.19999927 0.19999999 0.19999999
 0.19999999 0.19997007 0.1999622  0.19997936 0.19998044 0.19996911
 0.19996995 0.19997674 0.19999999 0.19997567 0.19995743 0.19999963
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999975 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.19999999]
2025-06-06 15:18:22,548 - ERROR - An error occurred while processing file nw_graph_encoded_1749044348.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:22,549 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:22,549 - INFO - 
--- Processing file: nw_graph_encoded_1749044408.dot ---
2025-06-06 15:18:22,549 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot
2025-06-06 15:18:22,549 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot file.
2025-06-06 15:18:22,552 - INFO - Parsed 131 nodes.
2025-06-06 15:18:22,554 - INFO - Parsed 188 edges.
2025-06-06 15:18:22,564 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:22,564 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:22,565 - DEBUG - Initial node features tensor shape: torch.Size([131, 19])
2025-06-06 15:18:22,565 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:22,566 - DEBUG - Node features tensor shape after scaling: torch.Size([131, 19])
2025-06-06 15:18:22,566 - DEBUG - Edge index tensor shape: torch.Size([2, 188])
2025-06-06 15:18:22,566 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:22,567 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:22,568 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:18:22,568 - DEBUG - Shape of encoded categorical edge features: torch.Size([188, 2])
2025-06-06 15:18:22,569 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:22,569 - DEBUG - Shape of scaled numerical edge features: torch.Size([188, 20])
2025-06-06 15:18:22,569 - DEBUG - Final edge attributes tensor shape: torch.Size([188, 22])
2025-06-06 15:18:22,569 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:22,569 - INFO - Performing online update...
2025-06-06 15:18:22,569 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:22,570 - DEBUG - Updated RunningStats: new_mean=[ 4.22413154e-10 -4.45258565e-10 -2.58878605e-09  2.29213792e-09
 -2.55031519e-08  1.37983893e-08 -9.60279814e-09 -2.30412083e-09
 -2.97690302e-09  9.90319779e-10  1.40738052e-09 -1.54023412e-09
  3.73557229e-09 -3.47873760e-09  9.77816080e-10  8.08266603e-10
 -3.76119484e-09  1.16908100e-09 -4.78513055e-09], new_M2=[194924.00539637 194924.00535317 194924.0002655  194924.0043165
 194923.99847555 194923.99850814 194923.99597809 194923.99817383
 194923.99317245 194923.99842334 194924.00189916 194923.99385479
 194923.99277476 155132.99668183 155133.0001155  155132.99884346
 155133.00001288 194924.00021783 194924.00776077], new_n=194924
2025-06-06 15:18:22,570 - DEBUG - Updated RunningStats: new_mean=[ 1.41489709e+00  5.49634962e+00  1.08180719e-10  2.57788057e-10
  1.46176992e-10 -1.61978275e-10 -1.28057380e-09  1.97260000e-10
  2.88776250e-10 -1.99252640e-10  3.25067231e-10 -3.49337451e-09
 -8.69010829e-10  2.87418180e-10  3.03374751e-10 -1.55869945e-10
 -1.55869945e-10 -1.55869945e-10 -1.55869945e-10 -1.55869945e-10
 -1.55869945e-10 -8.07715303e-11], new_M2=[ 108083.6931819  1875806.65943824  419544.99901331  419545.00590588
  419545.0057123   419544.99327098  419545.00036707  419544.99909742
  419545.00166791  419544.99933123  419544.99394318  419545.0085507
  419545.00112291  419544.99983809  419545.00184094  419544.99456365
  419544.99456365  419544.99456365  419544.99456365  419544.99456365
  419544.99456365  419544.99906359], new_n=419545
2025-06-06 15:18:22,570 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89211211 0.89211212 0.89211211 0.89211212 1.
 1.00000002]
2025-06-06 15:18:22,570 - DEBUG - Calculated standard deviation: [0.507564   2.11448575 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:22,570 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:22,571 - DEBUG - Online update step: 1/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 2/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 3/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 4/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 5/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 6/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 7/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 8/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 9/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 10/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 11/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 12/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 13/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 14/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 15/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 16/50
2025-06-06 15:18:22,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,571 - DEBUG - Online update step: 17/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 18/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 19/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 20/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 21/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 22/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 23/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 24/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 25/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 26/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 27/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 28/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 29/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 30/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 31/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 32/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 33/50
2025-06-06 15:18:22,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,572 - DEBUG - Online update step: 34/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 35/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 36/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 37/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 38/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 39/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 40/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 41/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 42/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 43/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 44/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 45/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 46/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 47/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 48/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 49/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - DEBUG - Online update step: 50/50
2025-06-06 15:18:22,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,573 - WARNING - No successful steps during online update.
2025-06-06 15:18:22,574 - DEBUG - Current node mean: [-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], current edge mean: [ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:18:22,574 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.9517
2025-06-06 15:18:22,574 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:18:22,574 - DEBUG - Updated reference mean: node=[-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], edge=[ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:18:22,575 - DEBUG - Updated reference std: node=[1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388], edge=[0.43694445 2.0172415  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026702  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703 ]
2025-06-06 15:18:22,575 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:22,575 - INFO - Running anomaly detection...
2025-06-06 15:18:22,575 - INFO - Starting anomaly detection.
2025-06-06 15:18:22,676 - DEBUG - Node reconstruction errors: [1.2752388e+00 1.2752388e+00 1.2752388e+00 6.0316294e-01 6.9009800e+00
 6.0316294e-01 9.7471029e-01 7.2528410e-01 6.5084112e-01 6.5084112e-01
 7.2528410e-01 6.0316294e-01 1.2752388e+00 1.2752388e+00 6.0316294e-01
 1.0870273e+00 7.2528410e-01 2.7105371e+01 9.0303984e+00 1.0622652e+00
 1.3049102e+00 7.2528410e-01 6.2600522e+00 7.2528410e-01 7.2528386e-01
 6.2294459e-01 1.2572025e+00 1.5927272e+03 1.2752388e+00 7.2528410e-01
 1.0223720e+00 1.2434621e+02 1.2752388e+00 6.5796638e+00 7.2528410e-01
 1.5480103e+00 1.0223720e+00 1.2752388e+00 7.2528410e-01 7.2528410e-01
 7.2528410e-01 7.2528410e-01 1.4184638e+00 7.2528410e-01 2.9105976e+00
 1.3194915e+03 1.3049102e+00 1.0223720e+00 1.0223720e+00 1.2752388e+00
 1.2752388e+00 1.6798293e+02 6.2294459e-01 6.5084106e-01 8.8781750e-01
 1.0888736e+00 1.4118166e+02 8.8080758e-01 7.6542085e-01 9.7471029e-01
 1.2752388e+00 7.2528410e-01 1.0223720e+00 7.2528410e-01 1.0223720e+00
 1.0223720e+00 7.2528410e-01 6.0316294e-01 8.8781750e-01 1.2752388e+00
 9.1132838e-01 1.0622652e+00 1.1971922e+00 1.0622652e+00 7.2528410e-01
 7.2528410e-01 2.7000613e+00 9.1132838e-01 6.5084106e-01 6.5084106e-01
 1.8109070e+00 1.0223720e+00 9.1132826e-01 6.5084094e-01 6.0316294e-01
 2.9105976e+00 6.5084112e-01 7.2528410e-01 4.0688210e+00 2.2307992e+00
 2.9105976e+00 8.8781726e-01 8.8781726e-01 8.8781726e-01 1.4646747e+00
 1.0622652e+00 8.8781750e-01 1.2572024e+00 1.2752388e+00 1.0622652e+00
 1.0622652e+00 8.8781726e-01 1.0622652e+00 9.7471029e-01 1.2164010e+00
 8.8781738e-01 1.0637096e+02 1.0223722e+00 1.0637095e+02 8.8781726e-01
 1.2164011e+00 8.8781750e-01 8.8781726e-01 8.8781726e-01 8.8781726e-01
 1.0622652e+00 8.8781726e-01 9.7113519e+02 8.8781726e-01 1.2752388e+00
 1.2752388e+00 1.2752388e+00 1.2752388e+00 1.2752388e+00 1.4807054e+00
 1.4807054e+00 1.0622652e+00 1.2752388e+00 6.5084112e-01 1.5480103e+00
 1.4807059e+00]
2025-06-06 15:18:22,676 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.19999999 0.19999999 0.19999999 0.79963607
 0.1962663  0.19706118 0.19630665 0.19999939 0.1867879  0.19582278
 0.19988972 0.09721923 0.19985765 0.19803333 0.1997292  0.19999951
 0.12677628 0.19958818 0.13874024 0.18678766 0.4276517  0.11885703
 0.1983828  0.1890437  0.1867885  0.11291164 0.4732219  0.48554173
 0.19689912 0.05937636 0.09869355 0.09963095 0.1428222  0.02503985
 0.19999927 0.03580886 0.79999983 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.8        0.8        0.8        0.8
 0.8        0.8       ]
2025-06-06 15:18:22,677 - ERROR - An error occurred while processing file nw_graph_encoded_1749044408.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:22,678 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:22,678 - INFO - 
--- Processing file: nw_graph_encoded_1749044468.dot ---
2025-06-06 15:18:22,678 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot
2025-06-06 15:18:22,678 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot file.
2025-06-06 15:18:22,683 - INFO - Parsed 258 nodes.
2025-06-06 15:18:22,689 - INFO - Parsed 397 edges.
2025-06-06 15:18:22,746 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:22,747 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:22,754 - DEBUG - Initial node features tensor shape: torch.Size([258, 19])
2025-06-06 15:18:22,773 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:22,784 - DEBUG - Node features tensor shape after scaling: torch.Size([258, 19])
2025-06-06 15:18:22,785 - DEBUG - Edge index tensor shape: torch.Size([2, 397])
2025-06-06 15:18:22,785 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:22,793 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:22,793 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:22,794 - DEBUG - Shape of encoded categorical edge features: torch.Size([397, 2])
2025-06-06 15:18:22,795 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:22,795 - DEBUG - Shape of scaled numerical edge features: torch.Size([397, 20])
2025-06-06 15:18:22,795 - DEBUG - Final edge attributes tensor shape: torch.Size([397, 22])
2025-06-06 15:18:22,795 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:22,795 - INFO - Performing online update...
2025-06-06 15:18:22,795 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:22,796 - DEBUG - Updated RunningStats: new_mean=[ 4.23381689e-10 -4.45433453e-10 -2.61315364e-09  2.27538507e-09
 -2.54840990e-08  1.37990836e-08 -9.57269810e-09 -2.28931802e-09
 -2.97296802e-09  9.91072046e-10  1.38292208e-09 -1.54919185e-09
  3.72025153e-09 -3.45803047e-09  9.70034239e-10  8.03533644e-10
 -3.77240826e-09  1.16916395e-09 -4.77758384e-09], new_M2=[195182.00539258 195182.00534927 195182.00027101 195182.00428802
 195181.99847034 195181.99850826 195181.99597949 195181.9981764
 195181.99318463 195181.99841654 195182.00188941 195181.99385828
 195181.99277367 155390.99667504 155391.00009974 155390.99885009
 155391.00001749 195182.00022244 195182.00775695], new_n=195182
2025-06-06 15:18:22,796 - DEBUG - Updated RunningStats: new_mean=[ 1.41481205e+00  5.49545652e+00  1.10974125e-10  2.59849416e-10
  1.47026805e-10 -1.63358229e-10 -1.27627831e-09  1.94292470e-10
  2.87692874e-10 -1.93127380e-10  3.24130084e-10 -3.49592183e-09
 -8.68632842e-10  2.81344853e-10  3.04458514e-10 -1.54154093e-10
 -1.54154093e-10 -1.54154093e-10 -1.54154093e-10 -1.54154093e-10
 -1.54154093e-10 -7.98224904e-11], new_M2=[ 108175.98611475 1878080.83103146  419941.99902367  419942.00594181
  419942.0057282   419941.99323844  419942.00035252  419941.99909331
  419942.00165885  419941.99932645  419941.9939655   419942.00856618
  419942.00112632  419941.99983897  419942.00183214  419941.99457997
  419941.99457997  419941.99457997  419941.99457997  419941.99457997
  419941.99457997  419941.99906832], new_n=419942
2025-06-06 15:18:22,797 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89226333 0.89226334 0.89226333 0.89226334 1.
 1.00000002]
2025-06-06 15:18:22,797 - DEBUG - Calculated standard deviation: [0.50754058 2.1147668  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:22,797 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:22,797 - DEBUG - Online update step: 1/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 2/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 3/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 4/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 5/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 6/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 7/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 8/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,797 - DEBUG - Online update step: 9/50
2025-06-06 15:18:22,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,798 - DEBUG - Online update step: 10/50
2025-06-06 15:18:22,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,798 - DEBUG - Online update step: 11/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 12/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 13/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 14/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 15/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 16/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 17/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 18/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 19/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 20/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 21/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 22/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 23/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 24/50
2025-06-06 15:18:22,802 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,802 - DEBUG - Online update step: 25/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 26/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 27/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 28/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 29/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 30/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 31/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 32/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 33/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 34/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 35/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 36/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 37/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 38/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 39/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 40/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 41/50
2025-06-06 15:18:22,803 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,803 - DEBUG - Online update step: 42/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 43/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 44/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 45/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 46/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 47/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 48/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 49/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - DEBUG - Online update step: 50/50
2025-06-06 15:18:22,804 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:22,804 - WARNING - No successful steps during online update.
2025-06-06 15:18:22,810 - DEBUG - Current node mean: [ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], current edge mean: [ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:18:22,810 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4463
2025-06-06 15:18:22,810 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:18:22,810 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:18:22,810 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:18:22,811 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:18:22,812 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:18:22,813 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:18:22,813 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:18:22,813 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:18:22,813 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:18:22,813 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:18:22,814 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:18:22,814 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:18:22,814 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:18:22,814 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:18:22,814 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:18:22,815 - INFO - Optimizer and scheduler reset.
2025-06-06 15:18:22,815 - DEBUG - Updated reference mean: node=[ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], edge=[ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:18:22,815 - DEBUG - Updated reference std: node=[1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436], edge=[0.47429672 2.2020373  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618 ]
2025-06-06 15:18:22,816 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:22,816 - INFO - Running anomaly detection...
2025-06-06 15:18:22,816 - INFO - Starting anomaly detection.
2025-06-06 15:18:23,342 - DEBUG - Node reconstruction errors: [1.7254847e+00 6.2332165e-01 3.1516762e+00 9.7380006e-01 6.1915016e-01
 6.2332165e-01 6.2332165e-01 6.2332165e-01 7.6365143e-01 7.6365143e-01
 7.8493321e-01 6.7043237e+02 6.2332165e-01 2.2746723e+00 8.6541468e-01
 2.2746723e+00 2.2746723e+00 2.0348859e+02 2.0348859e+02 7.8493321e-01
 6.6706938e-01 7.6365143e-01 6.1915016e-01 8.0741602e-01 6.1915016e-01
 6.2332171e-01 8.6541468e-01 7.6365143e-01 7.8493321e-01 1.6033676e+00
 7.8493321e-01 7.6365143e-01 6.6706938e-01 2.3884289e+00 3.1388927e+00
 3.5381398e+00 1.7769632e+00 9.7380006e-01 7.6365143e-01 7.6365143e-01
 8.6541468e-01 2.3884289e+00 2.8691619e+03 9.7380006e-01 2.2851155e+00
 7.4818730e-01 7.7924818e-01 2.8324437e+00 9.7380006e-01 7.2098410e-01
 3.1659176e+00 1.7769635e+00 1.7769632e+00 6.1915016e-01 7.6365143e-01
 7.4787837e-01 1.8471130e+00 6.1915016e-01 7.6365143e-01 7.2098410e-01
 7.8493321e-01 1.7769632e+00 2.3711448e+00 2.3711448e+00 8.6541468e-01
 1.7769632e+00 2.3711448e+00 7.6365143e-01 7.6365143e-01 1.7769632e+00
 7.6365143e-01 2.2851155e+00 8.6541468e-01 1.2964754e+00 1.1058480e+00
 6.2332165e-01 7.6365131e-01 7.4787855e-01 7.6365143e-01 1.3364781e+00
 6.2332165e-01 7.4818730e-01 7.8493321e-01 9.7380006e-01 6.2332165e-01
 5.7163965e+02 7.6365143e-01 7.6365143e-01 7.6365143e-01 7.6365143e-01
 6.2332165e-01 7.6365143e-01 8.6541468e-01 7.6365143e-01 9.0534669e-01
 1.3180977e+00 2.3711448e+00 7.6365143e-01 2.5104883e+00 6.2332165e-01
 1.7666769e+00 2.3884289e+00 6.2332171e-01 1.7769635e+00 7.6365143e-01
 1.8725865e+00 1.7769632e+00 1.2964754e+00 1.7769632e+00 1.7769632e+00
 7.6365143e-01 2.3711448e+00 2.7813110e+00 6.2332165e-01 8.6541468e-01
 2.3554401e+00 3.1516762e+00 1.0144333e+00 8.6206474e+00 2.7307060e+00
 7.6365143e-01 5.8353156e+02 7.8656107e-01 1.7769632e+00 1.7254847e+00
 2.2851155e+00 2.2783669e+03 7.6365143e-01 1.4362040e+00 6.2332171e-01
 1.7769632e+00 7.6365143e-01 9.0655947e+00 1.7769632e+00 4.8244190e+00
 1.0536226e+00 6.1915016e-01 7.6365143e-01 9.0990973e+00 2.7492271e+01
 2.8724736e+03 1.7769632e+00 8.6541468e-01 1.2964754e+00 2.2098486e+00
 1.2964754e+00 7.6365143e-01 7.6365143e-01 8.6541468e-01 1.4362040e+00
 1.7769632e+00 9.7380006e-01 9.7380006e-01 7.6365143e-01 7.4787843e-01
 7.6365131e-01 2.7156444e+00 7.6365143e-01 2.2851155e+00 7.6365143e-01
 7.6365143e-01 7.6365143e-01 2.2851155e+00 7.6365143e-01 7.6365143e-01
 1.7769632e+00 2.7307060e+00 7.6365143e-01 6.2332165e-01 6.2332165e-01
 2.3711448e+00 6.2332165e-01 7.6365143e-01 1.4358667e+00 7.1214509e+00
 7.6365143e-01 7.8839934e-01 7.6365143e-01 7.6365143e-01 7.6365143e-01
 1.7769635e+00 1.2964756e+00 7.6365143e-01 7.6365143e-01 7.6365143e-01
 7.6365143e-01 7.6365143e-01 7.6365143e-01 8.6541468e-01 5.9354456e+02
 7.6365143e-01 6.2332165e-01 7.6365143e-01 7.6365143e-01 7.6365143e-01
 7.6365143e-01 1.7666769e+00 7.8656107e-01 7.6365143e-01 2.3711448e+00
 8.4520693e+00 7.6365143e-01 7.6365143e-01 8.6541468e-01 6.2332165e-01
 8.6541468e-01 1.7769635e+00 1.5980575e+00 7.6365143e-01 6.2332165e-01
 4.4870100e+00 7.6365143e-01 7.6365143e-01 7.6365143e-01 1.5980574e+00
 7.6365143e-01 7.6365143e-01 7.6365143e-01 9.3445128e-01 7.6365143e-01
 7.6365143e-01 6.2332165e-01 7.6365143e-01 6.2332165e-01 2.7307060e+00
 7.6365143e-01 7.6365143e-01 7.8839934e-01 7.6365143e-01 2.3711448e+00
 6.2332165e-01 7.6365143e-01 7.6365131e-01 7.6365131e-01 1.5980574e+00
 7.6365143e-01 7.6365143e-01 7.6365143e-01 7.6365143e-01 2.3554401e+00
 6.2332165e-01 7.6365143e-01 7.6365143e-01 8.6541468e-01 7.6365143e-01
 7.8493321e-01 7.6365143e-01 7.8656107e-01 8.6541468e-01 1.7254847e+00
 7.8656107e-01 8.6541468e-01 7.6365143e-01 8.6541468e-01 2.2746723e+00
 8.6541468e-01 8.6541480e-01 7.8656107e-01]
2025-06-06 15:18:23,343 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.19999999 0.19999915 0.19999975 0.8        0.8
 0.8        0.8        0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19445515 0.19387203 0.19448906 0.19889623
 0.19999999 0.19999999 0.19999999 0.19774348 0.19513947 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.1999901  0.8
 0.19999999 0.19967073 0.1996463  0.19970596 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19425994 0.16225302 0.16717368 0.19999999 0.65414864
 0.19999999 0.19999999 0.19999999 0.19999713 0.19999653 0.19999999
 0.19999999 0.19999546 0.1999963  0.19999903 0.19999987 0.19999999
 0.19999641 0.19997519 0.19997996 0.19997042 0.19997483 0.19999665
 0.19999593 0.1999963  0.1999951  0.19999605 0.19999653 0.19999653
 0.1999957  0.19999725 0.19999641 0.8        0.8        0.8
 0.8        0.19999927 0.19999927 0.19999927 0.7420786  0.6087856
 0.14732474 0.40609053 0.20736289 0.799553   0.79810953 0.79892164
 0.7986938  0.8        0.79763347 0.19217658 0.7042233  0.49876004
 0.178505   0.12761158 0.19034332 0.79946566 0.79824203 0.7988699
 0.79862756 0.7999756  0.7999278  0.7999102  0.799879   0.7999616
 0.7999523  0.13813645 0.21828848 0.14721346 0.7999828  0.79997927
 0.79997426 0.79989594 0.799951   0.7999391  0.7999824  0.7999903
 0.7999879  0.02157259 0.08409244 0.7998606  0.09466869 0.02056384
 0.7999933  0.7999971  0.79999644 0.07492459 0.19999999 0.7999519
 0.79998606 0.7992463  0.7164327  0.53637695 0.8        0.8
 0.7221522  0.55743575 0.06626689 0.06185102 0.04784179 0.07565081
 0.8        0.1749512  0.08524758 0.0859834  0.02728808 0.06594837
 0.08149379 0.05418277 0.06839138 0.09015405 0.07599932 0.07652211
 0.7998118  0.70363754 0.5353804  0.05939102 0.796457   0.78639066
 0.08503354 0.08724123 0.72596765 0.7103214  0.0769245  0.09601557
 0.07530153 0.15595675 0.6516832  0.62369215 0.69051164 0.66871893
 0.37714538 0.5803907  0.54296994 0.09681755 0.66269904 0.6363667
 0.7996145  0.79953253 0.66256887 0.63618284 0.08565313 0.08843249
 0.6652775  0.63937634 0.6619854  0.6355423  0.66153824 0.63504267
 0.79964364 0.7995679  0.64285505 0.61355805 0.6648357  0.638849
 0.6031931  0.5684998  0.08503979 0.0902406  0.09597009 0.7875571
 0.7847717  0.5449058  0.54546785 0.53874564 0.78923106 0.7868162
 0.7884804  0.78589785 0.7883085  0.7856893  0.5523141  0.5417032
 0.79995596 0.799946   0.8        0.19999999 0.19999999 0.8
 0.78916913 0.7916226  0.78960174 0.06998402 0.19999975 0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.19999522 0.19991118 0.7756437  0.19827634 0.7770897  0.72377086
 0.7996524  0.79988855 0.79986167 0.05766004 0.19810224 0.06808764
 0.0609659  0.7996774  0.79989594 0.7998706  0.19783604 0.7996815
 0.7998532  0.79981804 0.8        0.7997004  0.7999142  0.7998933
 0.16113216 0.79025596 0.7880046  0.50249815 0.45653445 0.7999936
 0.799992   0.79997724 0.5881657  0.550707   0.71577126 0.69831026
 0.57517433 0.5362228  0.5299712  0.48633063 0.37196836 0.31955943
 0.7999689  0.7999623  0.79998565 0.7999405  0.1578396  0.15600193
 0.25987953 0.7998841  0.7998958  0.79987365 0.7999981  0.7999977
 0.79999715 0.6088753  0.7999997  0.7999995  0.79999936 0.6088753
 0.27867353 0.78732324 0.7843852  0.799999   0.7999997  0.79999965
 0.78590375 0.74767387 0.799999   0.79999965 0.79999954 0.3386192
 0.5588012  0.7828161  0.7404437  0.27875733 0.79999906 0.79999954
 0.7999995  0.30275422 0.30520308 0.29569715 0.3134016  0.27167952
 0.799948   0.79984134 0.7873247  0.78440255 0.7800543  0.77547127
 0.26270062 0.8        0.25515318 0.2672938  0.30590492 0.31940705
 0.79025364 0.743569   0.5588012  0.79985887 0.799948   0.26629114
 0.24168056 0.25362492 0.26586586 0.78363484 0.74864143 0.28520334
 0.5859151  0.27224994 0.2934162  0.24485117 0.24427843 0.24433118
 0.24171817 0.79988253 0.31131247 0.23866493 0.26183587 0.26672405
 0.2511149  0.33218202 0.5588012  0.29163897 0.65610695 0.78146845
 0.7772015  0.5588012  0.76791257 0.7857986  0.79999125 0.79758185
 0.7857986  0.7499777  0.750163   0.75488335 0.75264853 0.75633574
 0.7501037  0.7556954  0.748117   0.7494413  0.799128   0.7976496
 0.75073504]
2025-06-06 15:18:23,346 - ERROR - An error occurred while processing file nw_graph_encoded_1749044468.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:23,346 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:23,346 - INFO - 
--- Processing file: nw_graph_encoded_1749044528.dot ---
2025-06-06 15:18:23,346 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot
2025-06-06 15:18:23,346 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot file.
2025-06-06 15:18:23,359 - INFO - Parsed 365 nodes.
2025-06-06 15:18:23,373 - INFO - Parsed 656 edges.
2025-06-06 15:18:23,482 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:23,483 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:23,486 - DEBUG - Initial node features tensor shape: torch.Size([365, 19])
2025-06-06 15:18:23,493 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:23,501 - DEBUG - Node features tensor shape after scaling: torch.Size([365, 19])
2025-06-06 15:18:23,502 - DEBUG - Edge index tensor shape: torch.Size([2, 656])
2025-06-06 15:18:23,503 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:23,507 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:23,512 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:23,513 - DEBUG - Shape of encoded categorical edge features: torch.Size([656, 2])
2025-06-06 15:18:23,514 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:23,514 - DEBUG - Shape of scaled numerical edge features: torch.Size([656, 20])
2025-06-06 15:18:23,514 - DEBUG - Final edge attributes tensor shape: torch.Size([656, 22])
2025-06-06 15:18:23,514 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:23,514 - INFO - Performing online update...
2025-06-06 15:18:23,514 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:23,515 - DEBUG - Updated RunningStats: new_mean=[ 4.39355962e-10 -4.60604540e-10 -2.61787755e-09  2.27586248e-09
 -2.54023927e-08  1.37919202e-08 -9.61420579e-09 -2.28245399e-09
 -2.96741880e-09  1.01101605e-09  1.40251568e-09 -1.54515715e-09
  3.70523000e-09 -3.42200930e-09  9.64718300e-10  8.02033801e-10
 -3.79066605e-09  1.16965111e-09 -4.79411782e-09], new_M2=[195547.00539272 195547.00534928 195547.00028515 195547.00430542
 195546.99846583 195546.99848933 195546.99597097 195546.99818638
 195546.99318771 195546.99843644 195547.00189806 195546.99385512
 195546.99280654 155755.99665611 155756.00009084 155755.9988441
 155756.00002816 195547.00019391 195547.00776852], new_n=195547
2025-06-06 15:18:23,515 - DEBUG - Updated RunningStats: new_mean=[ 1.41475946e+00  5.49431524e+00  1.06142744e-10  2.56805540e-10
  1.47488899e-10 -1.65963740e-10 -1.28550102e-09  1.97547509e-10
  2.88411644e-10 -2.03250448e-10  3.16879840e-10 -3.48434238e-09
 -8.64058483e-10  2.65600927e-10  3.01342016e-10 -1.50809792e-10
 -1.50809792e-10 -1.50809792e-10 -1.50809792e-10 -1.50809792e-10
 -1.50809792e-10 -8.17262748e-11], new_M2=[ 108339.45621472 1881069.90773141  420597.9989902   420598.00589578
  420598.00574358  420597.99321542  420598.00035906  420597.99911802
  420598.00165303  420597.99933495  420597.99392429  420598.00854854
  420598.00112231  420597.99984703  420598.0018023   420597.99462045
  420597.99462045  420597.99462045  420597.99462045  420597.99462045
  420597.99462045  420597.99903535], new_n=420598
2025-06-06 15:18:23,516 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89247654 0.89247655 0.89247655 0.89247655 1.
 1.00000002]
2025-06-06 15:18:23,516 - DEBUG - Calculated standard deviation: [0.50752767 2.11479788 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:23,516 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:23,516 - DEBUG - Online update step: 1/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 2/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 3/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 4/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 5/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 6/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 7/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 8/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,516 - DEBUG - Online update step: 9/50
2025-06-06 15:18:23,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 10/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 11/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 12/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 13/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 14/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 15/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 16/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 17/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 18/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 19/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 20/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 21/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 22/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 23/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 24/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 25/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 26/50
2025-06-06 15:18:23,517 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,517 - DEBUG - Online update step: 27/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 28/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 29/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 30/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 31/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 32/50
2025-06-06 15:18:23,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,518 - DEBUG - Online update step: 33/50
2025-06-06 15:18:23,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,520 - DEBUG - Online update step: 34/50
2025-06-06 15:18:23,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,520 - DEBUG - Online update step: 35/50
2025-06-06 15:18:23,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,520 - DEBUG - Online update step: 36/50
2025-06-06 15:18:23,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,520 - DEBUG - Online update step: 37/50
2025-06-06 15:18:23,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 38/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 39/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 40/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 41/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 42/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 43/50
2025-06-06 15:18:23,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,521 - DEBUG - Online update step: 44/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 45/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 46/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 47/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 48/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 49/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - DEBUG - Online update step: 50/50
2025-06-06 15:18:23,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:23,522 - WARNING - No successful steps during online update.
2025-06-06 15:18:23,524 - DEBUG - Current node mean: [ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], current edge mean: [ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:18:23,525 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3455
2025-06-06 15:18:23,525 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:18:23,525 - DEBUG - Updated reference mean: node=[ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], edge=[ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:18:23,526 - DEBUG - Updated reference std: node=[1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727], edge=[0.4984336 2.0070016 1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763 ]
2025-06-06 15:18:23,526 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:23,526 - INFO - Running anomaly detection...
2025-06-06 15:18:23,526 - INFO - Starting anomaly detection.
2025-06-06 15:18:24,095 - DEBUG - Node reconstruction errors: [9.6030968e-01 9.6030968e-01 9.6030968e-01 9.6030968e-01 9.6030968e-01
 9.6030968e-01 9.6030968e-01 9.6030968e-01 9.6030968e-01 9.6030968e-01
 9.6030968e-01 9.6030968e-01 9.6030968e-01 9.6030968e-01 8.3540446e-01
 8.3540446e-01 7.6673853e-01 5.9711915e-01 8.3540446e-01 8.8345569e-01
 8.3540446e-01 8.3540446e-01 5.9711915e-01 9.6030968e-01 8.3540446e-01
 5.9711915e-01 9.6030968e-01 1.2969009e+00 8.8345569e-01 1.3969350e+00
 1.3969350e+00 8.3540446e-01 8.3540446e-01 9.6030968e-01 1.3969350e+00
 8.3540446e-01 1.3969353e+00 8.3540446e-01 8.3540446e-01 8.3540446e-01
 9.6030968e-01 7.3388445e-01 1.3969350e+00 1.8045517e+00 1.8045517e+00
 1.8045517e+00 1.3969350e+00 8.3540446e-01 1.3969350e+00 8.3540446e-01
 8.3540446e-01 9.6030968e-01 8.8345569e-01 1.3969350e+00 8.3540446e-01
 5.9711915e-01 8.3540446e-01 8.3540446e-01 8.3540446e-01 9.6030968e-01
 8.3540446e-01 8.3540446e-01 8.3540446e-01 8.3540446e-01 8.3540446e-01
 8.3540446e-01 8.3540446e-01 3.8480587e+00 5.9711915e-01 5.9711915e-01
 1.8045517e+00 6.1869669e-01 4.1315322e+00 9.3126857e-01 1.4046367e+00
 5.6266356e-01 6.1869669e-01 8.8345569e-01 5.6266356e-01 6.1869669e-01
 8.5826182e-01 9.6030968e-01 1.0260544e+00 7.8835065e+02 5.6266356e-01
 1.3879151e+00 1.2969009e+00 1.3879151e+00 1.8045517e+00 1.3879151e+00
 2.4895764e+02 2.4895764e+02 8.8345569e-01 1.0260544e+00 6.6099823e-01
 8.5826182e-01 6.9803935e-01 7.5346386e-01 1.4046367e+00 5.6266356e-01
 1.2969009e+00 8.5826182e-01 1.0260544e+00 2.0325048e+00 8.4524024e-01
 1.3351638e+00 1.3969350e+00 8.7675172e-01 9.6030968e-01 1.6101593e+00
 2.1624496e+00 2.3567417e+00 1.1862619e+00 1.3312644e+00 1.3973786e+00
 8.5826182e-01 8.3540446e-01 1.5194870e+00 2.4068142e+03 1.3312644e+00
 1.3351638e+00 7.9445547e-01 7.3388445e-01 9.8607403e-01 1.5998379e+00
 1.3312644e+00 1.3969350e+00 8.0818605e-01 2.6572134e+00 2.3133419e+00
 9.6030968e-01 2.3133419e+00 6.9358826e-01 8.0906993e-01 8.9514852e-01
 2.1439245e+00 1.4046367e+00 8.0906993e-01 8.0818605e-01 1.0260544e+00
 1.2133360e+00 3.0034504e+00 3.0034504e+00 1.3969350e+00 2.3133419e+00
 3.0034502e+00 1.3351638e+00 1.3351637e+00 2.3133419e+00 8.5826182e-01
 1.3351638e+00 8.8345569e-01 8.3540446e-01 1.7705145e+00 1.2730629e+00
 5.6266356e-01 8.5257959e-01 8.9514852e-01 8.5826182e-01 1.6007203e+00
 5.6266356e-01 8.0818605e-01 1.0260544e+00 1.3312644e+00 5.9711915e-01
 1.3351638e+00 7.7548651e+02 8.3540446e-01 1.3351638e+00 8.5826182e-01
 8.0906993e-01 8.0906993e-01 5.6266356e-01 1.3351638e+00 8.3540446e-01
 1.3351638e+00 6.9029695e-01 2.6572134e+00 3.0034504e+00 1.3351638e+00
 3.3445375e+00 1.4966029e+00 8.8345575e-01 2.3068376e+00 1.6101587e+00
 5.6266356e-01 2.3133419e+00 8.5826182e-01 2.4131839e+00 2.3133419e+00
 1.7705145e+00 2.3133419e+00 2.3133419e+00 8.3540446e-01 8.5826182e-01
 3.0034504e+00 1.6347923e+00 5.6266356e-01 1.3969350e+00 1.4046367e+00
 4.1315327e+00 1.2133360e+00 8.0239172e+00 2.0073349e+00 8.5826182e-01
 7.9410596e+02 5.9711915e-01 8.3540446e-01 1.2730629e+00 8.8345569e-01
 1.8045517e+00 1.3351638e+00 2.6503821e+03 8.5257959e-01 1.9137144e+00
 9.6030968e-01 5.6266356e-01 8.8345569e-01 2.3133423e+00 8.5826182e-01
 1.1779798e+01 2.3133421e+00 4.3003683e+00 1.9324293e+00 1.4046367e+00
 8.5826182e-01 8.3540446e-01 1.1089738e+01 3.1779146e+01 3.3241985e+03
 1.1632501e+00 8.3540446e-01 1.0333780e+00 1.8929965e+00 1.7705145e+00
 1.3973786e+00 1.3351638e+00 8.3540446e-01 1.2730629e+00 2.3133419e+00
 7.6673853e-01 1.3312644e+00 9.3306440e-01 1.5513544e+00 8.9514852e-01
 1.3351638e+00 1.9901930e+00 8.0906993e-01 1.5513544e+00 1.8045517e+00
 8.5257959e-01 8.5826182e-01 1.3351638e+00 1.3351638e+00 8.5826182e-01
 1.3351638e+00 8.3540446e-01 2.3133419e+00 2.0073349e+00 1.3351638e+00
 5.6266356e-01 9.6030968e-01 1.3351638e+00 1.4050052e+00 5.6266356e-01
 9.6030968e-01 7.5346386e-01 1.5816613e+00 9.3818579e+00 1.3351638e+00
 8.4524024e-01 8.5257959e-01 8.5826182e-01 1.3351638e+00 8.3540446e-01
 2.3133419e+00 1.7705145e+00 8.5826182e-01 8.5826182e-01 8.5826182e-01
 1.3351638e+00 8.5826182e-01 1.3351638e+00 8.3540446e-01 7.7284882e+02
 8.5826182e-01 1.3351638e+00 8.5826182e-01 8.5826182e-01 8.3540446e-01
 8.3540446e-01 8.5826182e-01 1.3351638e+00 5.9711915e-01 2.3068376e+00
 5.9711915e-01 8.5826182e-01 8.3540446e-01 3.0034504e+00 9.6686583e+00
 1.3351638e+00 8.5826182e-01 1.2969009e+00 5.6266356e-01 1.2969011e+00
 2.3133419e+00 1.8613733e+00 8.5826182e-01 1.4966029e+00 4.9877610e+00
 8.5826182e-01 8.0906993e-01 8.5257959e-01 1.5816613e+00 8.5257959e-01
 1.3351638e+00 1.3973786e+00 1.0052748e+00 8.5257959e-01 8.5826182e-01
 1.4966029e+00 9.6030968e-01 8.5826182e-01 8.2735175e-01 8.8345569e-01
 1.5253617e+00 8.5826182e-01 8.5826182e-01 8.7310648e-01 8.5826182e-01
 3.0034504e+00 1.5513544e+00 8.5826188e-01 8.3540446e-01 8.5826182e-01
 8.0906993e-01 1.8613733e+00 8.3540446e-01 8.5826182e-01 1.8045517e+00
 8.5826182e-01 8.0906993e-01 9.6030968e-01 8.5257959e-01 9.6030968e-01
 1.4046367e+00 1.9741596e+00 8.5826182e-01 8.5826182e-01 1.8658935e+00
 8.5826182e-01 8.4524024e-01 8.5826182e-01 2.6605608e+03 1.5284141e+00
 8.3540446e-01 1.6433989e+00 5.9711915e-01 5.9711915e-01 6.1869669e-01
 1.2969009e+00 1.4046367e+00 1.2969009e+00 8.3540463e-01 5.9711909e-01]
2025-06-06 15:18:24,098 - DEBUG - Edge reconstruction errors: [8.00000012e-01 8.00000012e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 1.99999988e-01
 1.99999273e-01 1.99999869e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 1.99999869e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99999988e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99999988e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99828327e-01
 1.99814796e-01 1.99853122e-01 1.99952543e-01 1.99999988e-01
 1.99999988e-01 1.99999988e-01 1.99943602e-01 1.99923933e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99998796e-01
 1.99999511e-01 1.99996769e-01 8.00000012e-01 1.99999988e-01
 1.99998677e-01 1.99998081e-01 1.99998438e-01 1.99998915e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99999273e-01
 1.99999511e-01 1.99999511e-01 1.99999988e-01 1.99999988e-01
 1.99999988e-01 1.99999988e-01 1.99991524e-01 1.99980438e-01
 1.99984491e-01 1.99989617e-01 1.99999988e-01 3.45406771e-01
 1.99999988e-01 1.99999869e-01 1.99999988e-01 1.99999869e-01
 1.99999988e-01 1.99999988e-01 1.99999988e-01 1.99999273e-01
 1.99999392e-01 1.99999988e-01 1.99999869e-01 1.99999988e-01
 1.99999869e-01 1.96235895e-01 1.96997941e-01 1.97906077e-01
 1.96157813e-01 1.96952403e-01 1.97569370e-01 1.99999988e-01
 1.99998558e-01 1.99998200e-01 1.99998200e-01 1.99998677e-01
 1.87876999e-01 1.76614165e-01 1.81265235e-01 1.99998558e-01
 1.99998558e-01 1.99999988e-01 1.87869668e-01 1.76092923e-01
 1.80849552e-01 1.99999630e-01 1.99996889e-01 1.44908965e-01
 1.55586660e-01 1.70488298e-01 1.31622136e-01 1.44726038e-01
 1.75735593e-01 1.99997246e-01 1.15280271e-01 1.31284952e-01
 1.78318083e-01 1.46931946e-01 1.57234073e-01 1.68527544e-01
 1.99999750e-01 1.99999750e-01 1.99999750e-01 1.24508977e-01
 1.38890147e-01 1.72259569e-01 1.37280822e-01 1.49357796e-01
 1.67681456e-01 1.99997962e-01 1.34256601e-01 1.46882892e-01
 1.74122810e-01 1.10518038e-01 1.27357066e-01 1.71061397e-01
 1.86429918e-01 1.89153671e-01 1.94760203e-01 1.33597493e-01
 1.46344602e-01 1.72537208e-01 1.99999630e-01 1.99999630e-01
 1.99999750e-01 1.99999630e-01 1.98700726e-01 1.99997246e-01
 1.99996531e-01 1.99997127e-01 1.99997008e-01 1.99997246e-01
 1.99988067e-01 1.99990332e-01 1.99999630e-01 1.99994266e-01
 1.71320975e-01 1.99993432e-01 1.99994147e-01 1.99992955e-01
 1.99999869e-01 1.99993312e-01 1.99993670e-01 1.99992955e-01
 1.99945509e-01 1.99993312e-01 1.99992955e-01 1.99994981e-01
 1.99876845e-01 1.99994862e-01 1.99993432e-01 1.99993074e-01
 1.99996650e-01 1.98329329e-01 1.99993074e-01 1.99992836e-01
 1.99993312e-01 1.99993908e-01 1.99957669e-01 1.99993432e-01
 1.99996173e-01 1.99981630e-01 1.99994147e-01 1.98570192e-01
 1.99992120e-01 1.99992955e-01 1.99993551e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 1.99997962e-01
 1.99999988e-01 1.99999988e-01 1.99983418e-01 1.97988212e-01
 1.99611664e-01 1.99988425e-01 1.99814081e-01 1.99997365e-01
 1.96992934e-01 1.99381292e-01 1.98812306e-01 1.99054480e-01
 8.00000012e-01 1.98997855e-01 1.99999988e-01 1.99958622e-01
 1.99992359e-01 1.99999869e-01 1.99999750e-01 1.99996769e-01
 1.98199332e-01 1.99516356e-01 1.98888421e-01 1.99111223e-01
 1.83859348e-01 1.90953970e-01 1.92747712e-01 1.96371734e-01
 1.90575421e-01 1.92344308e-01 1.99999750e-01 1.99978769e-01
 1.99986160e-01 1.70012593e-01 1.50586128e-01 1.59732580e-01
 1.96057141e-01 1.91904485e-01 1.93427920e-01 1.77192569e-01
 1.57159030e-01 1.65273905e-01 1.99855268e-01 1.99995577e-01
 4.15189028e-01 3.24734449e-02 1.99999511e-01 1.99999154e-01
 1.44387186e-01 7.40369558e-02 9.67101455e-02 1.99999392e-01
 1.99999988e-01 4.78906631e-02 3.43446404e-01 1.16764009e-01
 6.34672046e-02 8.87829065e-02 1.69683278e-01 1.92237377e-01
 1.82061136e-01 1.85716391e-01 8.00000012e-01 8.00000012e-01
 1.99939668e-01 1.99988186e-01 1.43420875e-01 1.22195959e-01
 1.36626422e-01 1.99999392e-01 1.34918809e-01 8.14396143e-02
 1.02931082e-01 1.43422604e-01 6.62067533e-02 9.00734663e-02
 8.00000012e-01 1.99946940e-01 1.99883521e-01 1.99907482e-01
 1.99999511e-01 1.99999511e-01 1.28258586e-01 9.40748453e-02
 1.13464415e-01 1.99999392e-01 1.45608544e-01 5.00606894e-02
 7.64229894e-02 1.99999273e-01 1.99999392e-01 1.49992228e-01
 5.08105397e-01 4.61758971e-01 1.41509712e-01 5.93541265e-02
 8.42862129e-02 1.99999392e-01 1.87409997e-01 1.73681378e-01
 1.93570912e-01 1.44994676e-01 1.55619085e-01 1.39555573e-01
 8.24437141e-02 1.03775620e-01 1.99120283e-01 1.99818850e-01
 1.99999511e-01 1.99999511e-01 8.46697092e-02 1.04423940e-01
 8.07827115e-02 2.47988522e-01 1.93472385e-01 1.49783015e-01
 6.42281175e-02 8.84113312e-02 1.42966330e-01 6.28038645e-02
 8.72167349e-02 1.99997365e-01 1.99977100e-01 1.99981391e-01
 1.99971378e-01 1.99976742e-01 1.99605346e-01 1.99980557e-01
 1.99984372e-01 1.99999511e-01 7.95288086e-02 1.01316988e-01
 5.59075475e-02 8.19362402e-02 1.99287891e-01 1.99422419e-01
 1.99999511e-01 1.99999511e-01 1.99972928e-01 1.99978054e-01
 1.99974597e-01 1.99979365e-01 1.99974000e-01 1.99978888e-01
 1.97675109e-01 1.98148310e-01 1.99973404e-01 1.99978530e-01
 1.99972212e-01 1.99977458e-01 4.32722628e-01 3.78902078e-01
 1.99999511e-01 1.99999511e-01 1.99999511e-01 1.99632466e-01
 1.99701905e-01 8.71617794e-02 6.00546002e-02 1.93166137e-02
 1.99990094e-01 1.99990213e-01 1.99748874e-01 1.99796200e-01
 1.99747086e-01 1.99794769e-01 1.99636161e-01 1.99704885e-01
 1.99989378e-01 1.99989617e-01 1.56573355e-01 1.63256526e-01
 9.36069489e-02 4.73676324e-02 8.00000012e-01 8.00000012e-01
 8.00000012e-01 1.99989736e-01 1.99702024e-01 1.99758291e-01
 4.88782525e-01 4.38870490e-01 1.99991167e-01 2.41718173e-01
 1.85902476e-01 1.94292009e-01 1.95366085e-01 5.51591158e-01
 8.00000012e-01 1.99999988e-01 1.99999988e-01 8.00000012e-01
 1.41103506e-01 7.06522465e-02 9.31318402e-02 3.08130383e-02
 1.43365502e-01 1.99999988e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 8.00000012e-01 8.00000012e-01 8.00000012e-01
 8.00000012e-01 1.99999988e-01 1.99999750e-01 1.88123345e-01
 1.99206591e-01 2.26217091e-01 2.15636492e-02 1.15689814e-01
 3.79623502e-01 3.25429708e-01 1.87934577e-01 1.99996173e-01
 1.99876368e-01 1.89853311e-01 7.01931477e-01 7.57070124e-01
 7.47619390e-01 1.99996412e-01 1.50569677e-02 1.59420371e-01
 1.12638831e-01 8.00000012e-01 3.62243056e-02 2.63535321e-01
 2.11990356e-01 1.99953735e-01 7.93400645e-01 7.91822016e-01
 7.81701803e-01 7.83818543e-01 7.80029178e-01 7.59283245e-01
 7.82203615e-01 7.78046489e-01 7.45363176e-01 7.88468957e-01
 7.85753250e-01 7.49876082e-01 7.89982796e-01 7.87682831e-01
 7.55111575e-01 1.23497486e-01 1.37009323e-01 7.85382152e-01
 7.81948984e-01 7.58300602e-01 1.98286414e-01 1.98610365e-01
 6.17200971e-01 5.81679761e-01 6.83942258e-01 4.02909458e-01
 1.99950397e-01 1.99945152e-01 1.99453235e-01 7.88743913e-01
 7.93005645e-01 7.91304410e-01 7.98402846e-01 7.97494531e-01
 7.96881855e-01 1.04365349e-02 1.49999440e-01 7.95388043e-01
 7.90924728e-01 7.88782537e-01 1.97106957e-01 1.99420869e-01
 3.08216214e-02 5.81548810e-02 7.81334758e-01 7.94332385e-01
 7.92987764e-01 1.60558105e-01 1.90642715e-01 7.81654596e-01
 7.92918384e-01 7.91243434e-01 1.99348330e-01 1.97617173e-01
 1.29972100e-02 1.51973546e-01 7.81346500e-01 7.91775823e-01
 7.89832830e-01 7.68823028e-01 7.84557402e-01 7.80795693e-01
 5.14638424e-02 7.83262789e-01 7.92876661e-01 7.91190028e-01
 1.99387014e-01 7.85305023e-01 7.91756153e-01 7.89807916e-01
 1.99428201e-01 7.95897186e-01 7.84136534e-01 7.94150472e-01
 7.92724848e-01 1.69409394e-01 1.75055265e-01 1.76584244e-01
 1.80927992e-01 7.80291498e-01 7.94175088e-01 7.92793036e-01
 8.00000012e-01 1.96449220e-01 1.96256936e-01 7.83417284e-01
 7.93453038e-01 7.91902065e-01 7.86123872e-01 7.92503834e-01
 7.90732026e-01 7.68482924e-01 6.17538095e-01 7.76944399e-01
 7.71381319e-01 1.97617173e-01 2.72227108e-01 5.53307891e-01
 1.99480295e-01 1.99505031e-01 1.99476957e-01 7.80538797e-01
 7.96282470e-01 7.95399368e-01 7.91280448e-01 7.67672896e-01
 7.86491871e-01 7.83192337e-01 1.94993019e-01 1.27494335e-04
 1.56506181e-01 1.99349880e-01 1.96213841e-01 1.96432173e-01
 1.99495494e-01 1.99495614e-01 1.99505150e-01 4.81779754e-01
 1.96094751e-01 1.76479340e-01 1.99478626e-01 1.99463248e-01
 1.99492872e-01 7.82908618e-01 7.91496933e-01 7.89488077e-01
 7.91280746e-01 7.88322270e-01 7.85465419e-01 7.84371614e-01
 7.90648997e-01 7.88439691e-01 3.55257392e-02 1.78219497e-01
 1.82264328e-01 1.97617173e-01 7.93769538e-01 7.96301782e-01
 7.95422673e-01 7.99679220e-01 7.99554706e-01 7.99448013e-01
 7.99599230e-01 7.22079277e-02 1.19864523e-01 1.12878919e-01
 1.93254590e-01 1.92594767e-01 7.91230977e-01 7.96901047e-01
 7.96164691e-01 7.91025162e-01 7.97403276e-01 7.96785355e-01
 7.91808128e-01 7.97545791e-01 7.96960890e-01 1.92576766e-01
 7.96819091e-01 7.99091041e-01 7.98868060e-01 1.92764997e-01
 7.90198982e-01 7.97597647e-01 7.97025800e-01 7.96411753e-01
 7.88718760e-01 7.94213831e-01 7.92782128e-01 7.98683941e-01
 7.99671173e-01 7.99592316e-01 7.35380054e-02 7.98968136e-01
 7.99652159e-01 7.99568832e-01 1.19864523e-01 1.10830843e-01
 1.92922890e-01 1.88726783e-01 9.96791124e-02 1.90621197e-01
 1.89583480e-01 1.92551315e-01 1.92335010e-01 1.93733335e-01
 1.92014754e-01 1.91891968e-01 1.91270173e-01 1.90971792e-01
 1.67824268e-01 1.67824268e-01 1.89156711e-01 1.91320181e-01
 7.88208306e-01 7.88208306e-01 7.88208306e-01 1.98427498e-01
 2.23495305e-01 1.92115188e-01 1.90535784e-01 1.91363871e-01
 1.92709386e-01 7.88926184e-01 2.19915569e-01 2.19811499e-01
 1.69734597e-01 1.93367481e-01 1.91915095e-01 7.59317756e-01
 7.75068641e-01 7.91116178e-01 1.19864523e-01 6.61502481e-02
 1.91218495e-01 1.93015516e-01 1.38311505e-01 1.63460076e-01
 5.14868498e-02 1.41568184e-02 8.05855989e-02 4.02060151e-02
 1.47708654e-01 1.89683616e-01 1.88866138e-01 1.89609587e-01
 1.62271857e-01 1.05653942e-01 1.04692638e-01 4.45587903e-01
 6.87917292e-01 6.65384173e-01 9.91656780e-02 8.00000012e-01]
2025-06-06 15:18:24,236 - ERROR - An error occurred while processing file nw_graph_encoded_1749044528.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:24,236 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:24,237 - INFO - 
--- Processing file: nw_graph_encoded_1749044588.dot ---
2025-06-06 15:18:24,237 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot
2025-06-06 15:18:24,237 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot file.
2025-06-06 15:18:24,250 - INFO - Parsed 422 nodes.
2025-06-06 15:18:24,272 - INFO - Parsed 847 edges.
2025-06-06 15:18:24,453 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:24,453 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:24,457 - DEBUG - Initial node features tensor shape: torch.Size([422, 19])
2025-06-06 15:18:24,466 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:24,479 - DEBUG - Node features tensor shape after scaling: torch.Size([422, 19])
2025-06-06 15:18:24,480 - DEBUG - Edge index tensor shape: torch.Size([2, 847])
2025-06-06 15:18:24,480 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:24,489 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:24,490 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:24,491 - DEBUG - Shape of encoded categorical edge features: torch.Size([847, 2])
2025-06-06 15:18:24,496 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:24,496 - DEBUG - Shape of scaled numerical edge features: torch.Size([847, 20])
2025-06-06 15:18:24,497 - DEBUG - Final edge attributes tensor shape: torch.Size([847, 22])
2025-06-06 15:18:24,497 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:24,497 - INFO - Performing online update...
2025-06-06 15:18:24,497 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:24,497 - DEBUG - Updated RunningStats: new_mean=[ 4.38866082e-10 -4.59156443e-10 -2.62364596e-09  2.28004822e-09
 -2.53519493e-08  1.36908967e-08 -9.62224504e-09 -2.27772905e-09
 -2.95106773e-09  1.02530123e-09  1.48355591e-09 -1.52753460e-09
  3.69208055e-09 -3.41338570e-09  9.50683842e-10  7.56394547e-10
 -3.77166776e-09  1.15955468e-09 -4.79383122e-09], new_M2=[195969.00534802 195969.0053044  195969.00027472 195969.0043189
 195968.99847066 195968.99848225 195968.9959432  195968.99819807
 195968.99318978 195968.99845683 195969.00189543 195968.99385778
 195968.9927748  156177.9966855  156178.00011607 156177.99881954
 156178.00003314 195969.00022269 195969.00776127], new_n=195969
2025-06-06 15:18:24,498 - DEBUG - Updated RunningStats: new_mean=[ 1.41478485e+00  5.49304654e+00  1.10076726e-10  2.56405717e-10
  1.45455831e-10 -1.62670660e-10 -1.27679486e-09  1.94084346e-10
  2.94995178e-10 -2.07008603e-10  3.22584448e-10 -3.49077963e-09
 -8.59476229e-10  2.31689835e-10  3.01717559e-10 -1.51447261e-10
 -1.51447261e-10 -1.51447261e-10 -1.51447261e-10 -1.51447261e-10
 -1.51447261e-10 -8.14494274e-11], new_M2=[ 108554.87561604 1884360.87289211  421444.99902649  421445.00592853
  421445.00573804  421444.99325679  421445.00034317  421444.99912391
  421445.0016674   421444.99934057  421444.9939265   421445.00858651
  421445.00111884  421444.99986245  421445.00179812  421444.99459746
  421444.99459746  421444.99459746  421444.99459746  421444.99459746
  421444.99459746  421444.9990206 ], new_n=421445
2025-06-06 15:18:24,498 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.892722   0.89272201 0.892722   0.89272201 1.
 1.00000002]
2025-06-06 15:18:24,498 - DEBUG - Calculated standard deviation: [0.50752123 2.11451897 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:24,499 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:24,499 - DEBUG - Online update step: 1/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 2/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 3/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 4/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 5/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 6/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 7/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 8/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 9/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 10/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 11/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 12/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 13/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 14/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 15/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 16/50
2025-06-06 15:18:24,503 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,503 - DEBUG - Online update step: 17/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 18/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 19/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 20/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 21/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 22/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 23/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 24/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 25/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 26/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 27/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 28/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 29/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 30/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 31/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 32/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 33/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 34/50
2025-06-06 15:18:24,504 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,504 - DEBUG - Online update step: 35/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 36/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 37/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 38/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 39/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 40/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 41/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 42/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 43/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 44/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 45/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 46/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 47/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 48/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 49/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - DEBUG - Online update step: 50/50
2025-06-06 15:18:24,505 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:24,505 - WARNING - No successful steps during online update.
2025-06-06 15:18:24,508 - DEBUG - Current node mean: [ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], current edge mean: [ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:18:24,508 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2979
2025-06-06 15:18:24,508 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:18:24,509 - DEBUG - Updated reference mean: node=[ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], edge=[ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:18:24,509 - DEBUG - Updated reference std: node=[1.0011868 1.0011868 1.001187  1.001187  1.001187  1.001187  1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187  1.0011868 1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187 ], edge=[0.5044536 1.8686519 1.0005909 1.0005909 1.0005908 1.0005909 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005909 1.0005908 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908
 1.0005908]
2025-06-06 15:18:24,509 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:24,509 - INFO - Running anomaly detection...
2025-06-06 15:18:24,509 - INFO - Starting anomaly detection.
2025-06-06 15:18:25,393 - DEBUG - Node reconstruction errors: [1.13029969e+00 1.13029969e+00 8.97595942e-01 8.97595942e-01
 8.97595942e-01 2.01294255e+00 1.13029969e+00 2.01294255e+00
 1.13029969e+00 1.05535913e+00 9.76489127e-01 6.81856453e-01
 9.76489127e-01 9.76489127e-01 6.81856453e-01 6.81856453e-01
 9.76489127e-01 6.81856453e-01 1.13029969e+00 9.76489127e-01
 9.76489127e-01 9.76489127e-01 9.76489127e-01 9.76489127e-01
 9.76489127e-01 1.07296515e+00 1.21119630e+00 2.58657806e+02
 9.76489127e-01 9.76489127e-01 7.88747311e-01 9.76489127e-01
 1.21119630e+00 9.76489127e-01 9.76489127e-01 1.07296515e+00
 9.76489127e-01 9.76489127e-01 9.76489127e-01 1.07296515e+00
 9.76489127e-01 1.07296526e+00 9.76489127e-01 9.76489127e-01
 9.76489127e-01 9.76489127e-01 9.76489127e-01 6.76456273e-01
 9.53150690e-01 1.27385950e+00 5.89887440e-01 9.53150690e-01
 8.97595942e-01 9.37697887e-01 1.08313954e+00 9.53150690e-01
 6.76456273e-01 1.07296515e+00 9.53150690e-01 5.89887440e-01
 1.07296515e+00 1.08313954e+00 9.37697887e-01 1.08313954e+00
 1.08313954e+00 9.53150690e-01 9.53150690e-01 9.76489127e-01
 9.76489127e-01 1.08313954e+00 9.53150690e-01 1.08313954e+00
 1.08313954e+00 1.08313954e+00 9.53150690e-01 1.13029969e+00
 9.76489127e-01 6.76456273e-01 1.08313954e+00 1.89879489e+00
 9.76489127e-01 1.89879489e+00 9.76489127e-01 1.61186206e+00
 1.08313954e+00 1.08313966e+00 1.56552005e+00 1.08313954e+00
 1.08313954e+00 1.07296515e+00 9.37697887e-01 1.08313954e+00
 1.08313954e+00 7.75919259e-01 1.08313954e+00 9.53150690e-01
 1.08313954e+00 9.76489127e-01 6.76456273e-01 9.53150690e-01
 1.13029969e+00 1.08313954e+00 9.53150690e-01 9.53150690e-01
 9.53150690e-01 9.53150690e-01 3.60470057e+00 5.89887440e-01
 5.89887440e-01 1.89879489e+00 7.26818979e-01 4.58872223e+00
 9.15289044e-01 1.16647303e+00 8.55300903e-01 6.59443378e-01
 9.37697887e-01 1.11282444e+00 7.26818979e-01 9.29644644e-01
 9.76489127e-01 8.07744980e-01 9.48390320e+02 1.11282444e+00
 1.18271732e+00 1.00589228e+00 1.18271720e+00 1.89879525e+00
 1.61645985e+00 2.58738251e+02 2.58738251e+02 9.37697887e-01
 8.07744980e-01 7.63775766e-01 1.05742109e+00 7.66341031e-01
 7.26818979e-01 1.33828163e+00 6.48374736e-01 9.76489127e-01
 1.00589228e+00 1.05742109e+00 1.26400328e+00 1.77281594e+00
 1.00613248e+00 1.11282444e+00 1.08313954e+00 9.32889223e-01
 1.07296515e+00 1.41637743e+00 1.87294567e+00 8.97595942e-01
 2.03838992e+00 1.34189129e+00 1.60485947e+00 1.11282444e+00
 9.29644644e-01 9.53150690e-01 1.29762268e+00 8.97595942e-01
 2.85048242e+03 1.60485947e+00 1.06633461e+00 9.15289044e-01
 6.76456273e-01 9.15289044e-01 1.33828163e+00 1.60485947e+00
 1.08313954e+00 9.15289044e-01 2.36060619e+00 2.64895034e+00
 1.07296515e+00 2.64895058e+00 8.33397925e-01 9.50448275e-01
 1.09790730e+00 2.35596323e+00 1.18271732e+00 9.50448275e-01
 9.15289044e-01 1.26400328e+00 1.30157995e+00 3.32171226e+00
 3.32171226e+00 1.16315806e+00 2.64895058e+00 3.32171226e+00
 1.11282444e+00 1.06633461e+00 2.64895058e+00 1.05742109e+00
 9.76489127e-01 1.06633461e+00 9.37697887e-01 9.53150690e-01
 2.06311941e+00 1.23337317e+00 1.11282444e+00 9.29644644e-01
 1.09790730e+00 1.05742109e+00 1.77492487e+00 1.11282444e+00
 9.15289044e-01 1.26400328e+00 1.60485947e+00 5.89887440e-01
 1.06633461e+00 9.02317200e+02 9.53150690e-01 1.06633461e+00
 6.81856453e-01 1.05742109e+00 9.50448394e-01 9.50448275e-01
 1.11282444e+00 1.06633461e+00 9.53150690e-01 1.06633461e+00
 6.52045012e-01 2.29243994e+00 3.32171226e+00 1.06633461e+00
 3.76482916e+00 1.21017778e+00 9.37697887e-01 2.67787242e+00
 1.41637743e+00 1.11282444e+00 2.64895058e+00 9.88036096e-01
 8.97595942e-01 2.24666452e+00 2.64895058e+00 2.06311941e+00
 2.64895058e+00 2.64895058e+00 1.18431556e+00 1.05742109e+00
 3.32171226e+00 1.33828163e+00 6.48374736e-01 1.08313954e+00
 1.16647303e+00 4.58872223e+00 8.97595942e-01 1.30157995e+00
 7.59017801e+00 1.66543877e+00 1.05742109e+00 9.68930481e+02
 1.08313954e+00 9.53150690e-01 1.36252367e+00 9.37697649e-01
 1.82012618e+00 1.21992123e+00 3.09643115e+03 9.29644644e-01
 2.21772814e+00 9.76489127e-01 1.11282444e+00 9.76489127e-01
 1.08313954e+00 2.64895058e+00 1.05742109e+00 1.30649776e+01
 1.30157995e+00 3.98920846e+00 1.82325304e+00 1.16647303e+00
 1.05742109e+00 9.53150690e-01 1.07893295e+01 3.41053391e+01
 3.87395386e+03 2.48600316e+00 9.53150690e-01 8.97595942e-01
 1.21762419e+00 1.72545826e+00 2.06311941e+00 1.11282444e+00
 1.11282444e+00 9.53150690e-01 1.23337317e+00 2.64895058e+00
 6.81856453e-01 1.60485947e+00 1.89203739e+00 1.05999446e+00
 1.88425982e+00 1.09790730e+00 1.06633461e+00 1.73450065e+00
 9.50448275e-01 1.72545826e+00 1.90505862e+00 9.29644644e-01
 1.05742121e+00 1.06633437e+00 1.67297626e+00 7.26818979e-01
 1.06633461e+00 9.53150690e-01 2.64895058e+00 1.82740307e+00
 1.06633461e+00 6.48374736e-01 9.76489127e-01 1.06633461e+00
 1.41256869e+00 1.11282444e+00 9.76489127e-01 7.26818979e-01
 1.67136061e+00 1.04829855e+01 1.06633461e+00 1.00613248e+00
 9.29644644e-01 1.89203739e+00 1.05742109e+00 1.11282444e+00
 9.53150690e-01 2.64895058e+00 2.06311941e+00 1.05742109e+00
 1.05742109e+00 9.29644644e-01 1.06633461e+00 8.97595942e-01
 9.29644644e-01 1.06633461e+00 9.53150690e-01 8.81288879e+02
 1.05742109e+00 1.72545826e+00 9.88036096e-01 9.29644823e-01
 1.61777580e+00 9.53150570e-01 9.53150570e-01 1.05742121e+00
 1.06633461e+00 5.89887440e-01 2.67787242e+00 1.08313954e+00
 9.76489127e-01 1.05742109e+00 1.08313954e+00 3.32171226e+00
 1.05430918e+01 1.06633461e+00 1.05742109e+00 1.00589228e+00
 1.11282444e+00 1.00589228e+00 2.64895058e+00 2.07430887e+00
 7.26818979e-01 1.21017778e+00 4.99874687e+00 9.29644644e-01
 9.50448275e-01 9.29644644e-01 1.67136061e+00 9.29644644e-01
 1.11282444e+00 1.11282444e+00 9.31930721e-01 9.29644644e-01
 9.88036096e-01 1.21017778e+00 9.76489127e-01 1.05742109e+00
 8.14644396e-01 9.37697887e-01 1.85152376e+00 1.05742109e+00
 1.05742109e+00 1.01326203e+00 1.05742109e+00 3.32171226e+00
 1.21992099e+00 9.29644644e-01 1.08313966e+00 9.88036096e-01
 9.50448275e-01 2.07430887e+00 9.53150690e-01 1.05742109e+00
 1.89879489e+00 9.29644644e-01 9.50448275e-01 1.21119630e+00
 1.31611383e+00 9.76489127e-01 1.18271732e+00 1.72545826e+00
 6.81856453e-01 1.05742109e+00 9.29644644e-01 1.52936780e+00
 9.76489127e-01 9.29644644e-01 1.00613248e+00 1.11282444e+00
 9.76489127e-01 6.81856453e-01 3.10611255e+03 1.16315806e+00
 9.53150690e-01 1.61186206e+00 1.08313954e+00 5.89887440e-01
 6.59443378e-01 1.00589228e+00 1.16647303e+00 1.00589216e+00
 9.53150690e-01 1.18431556e+00]
2025-06-06 15:18:25,401 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.7999995  0.79999423
 0.79999834 0.799998   0.79999536 0.19999999 0.19999999 0.19999999
 0.8        0.8        0.8        0.8        0.8        0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999403 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19961971
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999987 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999987 0.19999987 0.19999999 0.19999999 0.19999963
 0.19999963 0.19999975 0.19999951 0.19999963 0.19999987 0.19999999
 0.19999939 0.19999951 0.19999987 0.19999963 0.19999975 0.19999975
 0.19999999 0.19999999 0.19999999 0.19999951 0.19999963 0.19999987
 0.19999963 0.19999975 0.19999975 0.19999999 0.19999963 0.19999963
 0.19999987 0.19999939 0.19999951 0.19999987 0.19999951 0.19999963
 0.19999975 0.19999963 0.19999975 0.19999987 0.19999999 0.19999975
 0.19999963 0.19999975 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999987 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999975
 0.19999939 0.19999951 0.19999999 0.19999999 0.19999963 0.19999939
 0.19999951 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999963 0.19999903 0.19999915 0.19999963 0.19999892 0.19999915
 0.19999999 0.19999975 0.19999975 0.1999988  0.19999903 0.19999963
 0.19999927 0.19999939 0.19999999 0.19999999 0.19999999 0.19999784
 0.19999653 0.19999737 0.19999999 0.19999999 0.19999963 0.1999988
 0.19999903 0.19999999 0.19999999 0.19999999 0.19999999 0.19999963
 0.19999856 0.19999892 0.19999987 0.19999987 0.19999987 0.19999999
 0.19999963 0.19999915 0.19999939 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999796 0.19999546 0.19999641 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999927 0.19999939 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.8
 0.8        0.8        0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.19999951
 0.19999987 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999844 0.19999963 0.19999999
 0.19999999 0.19999963 0.19999903 0.19999927 0.19999999 0.19999999
 0.19999963 0.19999892 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.7997524  0.79998356 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999987 0.8
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999963 0.19999975 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999987 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999987 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999987 0.19999999
 0.19999951 0.19999963 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999987 0.19999999 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999987 0.19999987 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999987 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999987 0.19999987 0.19999927
 0.19999939 0.19999963 0.19999987 0.19999987 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987 0.19999987
 0.7988732  0.79857975 0.7973928  0.19999987 0.19999975 0.19999987
 0.19999999 0.19999999 0.19999951 0.19999963 0.19999999 0.19999987
 0.19999987 0.19999999 0.19999999 0.19999951 0.19999999 0.1999988
 0.19999641 0.19999987 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999844 0.8
 0.19999999 0.19999999 0.8        0.19999951 0.1999988  0.19999903
 0.19999796 0.19999987 0.19999999 0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.19999999 0.19999999
 0.19999987 0.19999987 0.1999982  0.19999951 0.1999858  0.19996053
 0.19996911 0.19999987 0.19999999 0.19999987 0.19999987 0.19999212
 0.19998258 0.19998628 0.19999999 0.19999963 0.19999939 0.19999951
 0.8        0.19999963 0.19999915 0.19999927 0.19999963 0.19975436
 0.19980776 0.19990832 0.19969755 0.1997633  0.19989485 0.19995588
 0.1999653  0.19998509 0.19995648 0.19996601 0.1999889  0.19990414
 0.19992417 0.1999821  0.19999975 0.19999987 0.19994694 0.19995838
 0.19998044 0.19999999 0.19999999 0.19996077 0.19996923 0.1999293
 0.19998962 0.19999999 0.19999999 0.19999999 0.19993287 0.199902
 0.19992334 0.19847274 0.19929177 0.1994462  0.19971061 0.19999641
 0.19999927 0.19980288 0.1999368  0.19995052 0.19996983 0.19999641
 0.19999927 0.19999999 0.19999951 0.19999963 0.19995397 0.19986361
 0.1998933  0.19998139 0.19999605 0.19995338 0.19988471 0.19990975
 0.19999999 0.19999701 0.19999927 0.19999689 0.19999939 0.19995481
 0.19989866 0.19992071 0.19969374 0.19938177 0.1995166  0.19999939
 0.1999504  0.19989032 0.19991416 0.19999963 0.19995135 0.1999132
 0.19993204 0.19999951 0.19199026 0.19836688 0.19634128 0.1971367
 0.19999987 0.19999987 0.19937927 0.19951421 0.1997906  0.19976664
 0.1992268  0.19939476 0.8        0.19999999 0.19999999 0.19972634
 0.19938487 0.19951874 0.19971156 0.19952184 0.19962579 0.19995028
 0.19999439 0.1999411  0.19995362 0.19999999 0.19996971 0.19985062
 0.19994837 0.1999597  0.19999999 0.19999999 0.19999999 0.19995624
 0.19980145 0.1998437  0.19982785 0.19996709 0.1999399  0.1999529
 0.19999999 0.19999939 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999284 0.19999999 0.19983894
 0.19974208 0.1997981  0.19999999 0.19999999 0.19999999 0.19994932
 0.19990188 0.19992322 0.19752681 0.19873631 0.1990115  0.19995302
 0.19991416 0.19993287 0.19999665 0.19937718 0.19951254 0.19979095
 0.19866186 0.1995061  0.19961357 0.19987255 0.19977534 0.1998241
 0.19959378 0.19979382 0.19983858 0.1949929  0.19999963 0.19999892
 0.19999975 0.19999999 0.19999999 0.19989866 0.19971776 0.19977915
 0.19990128 0.19968647 0.1997546  0.19989401 0.19965178 0.19972754
 0.19999999 0.19973159 0.19911838 0.19930917 0.19999999 0.19990844
 0.19967347 0.19974446 0.19959378 0.19991165 0.19982731 0.1998648
 0.19943249 0.19797754 0.19841665 0.19999927 0.19972694 0.19933158
 0.19947731 0.19999892 0.19999975 0.19999999 0.19999856 0.19999975
 0.19999999 0.19933087 0.19925785 0.19941932 0.19947922 0.19857508
 0.19888449 0.19999999 0.19999892 0.19943929 0.19836867 0.1987226
 0.19999999 0.19940394 0.19802457 0.1984536  0.19940871 0.19859266
 0.19889838 0.19694996 0.19419903 0.19542867 0.19694996 0.19902283
 0.19923502 0.19940144 0.19877267 0.19903928 0.19999999 0.17778015
 0.19392383 0.19971573 0.19971573 0.1999585  0.19991046 0.19992954
 0.19999868 0.19999999 0.19940728 0.19813204 0.198538   0.19999999
 0.19948381 0.1980977  0.19851089 0.19970274 0.19999868 0.19999391
 0.1999951  0.19999999 0.19999999 0.19992048 0.19979072 0.19810373
 0.1985085  0.19741565 0.19999892 0.19999963 0.19999999 0.19999999
 0.19937384 0.19830614 0.19867414 0.19999987 0.19999927 0.19999939
 0.19999558 0.19999653 0.19999987 0.19999999 0.19641364 0.19415885
 0.19542325 0.19999999 0.19999987 0.19999975 0.19394636 0.17797029
 0.182679   0.19898689 0.1972403  0.19783914 0.1999864  0.19998914
 0.19999975 0.19999975 0.19996983 0.19997603 0.1999883  0.19999069
 0.19999462 0.1999957  0.19322258 0.19469166 0.19999272 0.19999415
 0.19998366 0.199987   0.19915968 0.1999976  0.19999963 0.19999975
 0.19999748 0.19160682 0.19999748 0.19999725 0.19999737 0.19999725
 0.8       ]
2025-06-06 15:18:25,403 - ERROR - An error occurred while processing file nw_graph_encoded_1749044588.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:25,404 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:25,404 - INFO - 
--- Processing file: nw_graph_encoded_1749044648.dot ---
2025-06-06 15:18:25,404 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot
2025-06-06 15:18:25,404 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot file.
2025-06-06 15:18:25,426 - INFO - Parsed 512 nodes.
2025-06-06 15:18:25,442 - INFO - Parsed 1046 edges.
2025-06-06 15:18:25,692 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:25,692 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:25,696 - DEBUG - Initial node features tensor shape: torch.Size([512, 19])
2025-06-06 15:18:25,704 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:25,714 - DEBUG - Node features tensor shape after scaling: torch.Size([512, 19])
2025-06-06 15:18:25,715 - DEBUG - Edge index tensor shape: torch.Size([2, 1046])
2025-06-06 15:18:25,715 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:25,721 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:25,722 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:25,724 - DEBUG - Shape of encoded categorical edge features: torch.Size([1046, 2])
2025-06-06 15:18:25,725 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:25,726 - DEBUG - Shape of scaled numerical edge features: torch.Size([1046, 20])
2025-06-06 15:18:25,726 - DEBUG - Final edge attributes tensor shape: torch.Size([1046, 22])
2025-06-06 15:18:25,726 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:25,726 - INFO - Performing online update...
2025-06-06 15:18:25,726 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:25,727 - DEBUG - Updated RunningStats: new_mean=[ 4.13226074e-10 -4.70701107e-10 -2.63971287e-09  2.27459971e-09
 -2.52376516e-08  1.36634110e-08 -9.57244701e-09 -2.28021189e-09
 -2.93924439e-09  1.03684949e-09  1.49409963e-09 -1.52112718e-09
  3.70126791e-09 -3.38750272e-09  9.27729644e-10  7.39513785e-10
 -3.77729891e-09  1.16663165e-09 -4.69306121e-09], new_M2=[196481.00538769 196481.00534195 196481.00027389 196481.00431896
 196480.99847757 196480.99846419 196480.99594498 196480.99819042
 196480.99319232 196480.99848616 196481.00187898 196480.99386114
 196480.99278941 156689.99667834 156690.00008258 156689.99883388
 156690.00001918 196481.00019372 196481.00772368], new_n=196481
2025-06-06 15:18:25,727 - DEBUG - Updated RunningStats: new_mean=[ 1.41476150e+00  5.49145189e+00  1.07067622e-10  2.58300654e-10
  1.43062948e-10 -1.60004593e-10 -1.26622341e-09  1.84348962e-10
  3.00287971e-10 -2.19407585e-10  3.25145242e-10 -3.48719440e-09
 -8.58712154e-10  2.13834031e-10  2.91568970e-10 -1.51330667e-10
 -1.51330667e-10 -1.51330667e-10 -1.51330667e-10 -1.51330667e-10
 -1.51330667e-10 -8.10468687e-11], new_M2=[ 108817.09844233 1888639.87849685  422490.99898308  422491.00598267
  422491.00568928  422490.99330021  422491.00034238  422490.99908359
  422491.00165218  422490.99935844  422490.99389029  422491.00860059
  422491.00112097  422490.99988228  422491.00177401  422490.99458045
  422490.99458045  422490.99458045  422490.99458045  422490.99458045
  422490.99458045  422490.99903638], new_n=422491
2025-06-06 15:18:25,727 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89301829 0.8930183  0.8930183  0.8930183  1.
 1.00000002]
2025-06-06 15:18:25,728 - DEBUG - Calculated standard deviation: [0.50750443 2.11429629 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:25,728 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:25,728 - DEBUG - Online update step: 1/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 2/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 3/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 4/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 5/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 6/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 7/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 8/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 9/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 10/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 11/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 12/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,728 - DEBUG - Online update step: 13/50
2025-06-06 15:18:25,728 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 14/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 15/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 16/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 17/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 18/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 19/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 20/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 21/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 22/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 23/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 24/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 25/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 26/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 27/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 28/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 29/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 30/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,729 - DEBUG - Online update step: 31/50
2025-06-06 15:18:25,729 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 32/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 33/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 34/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 35/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 36/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 37/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 38/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 39/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 40/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 41/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 42/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 43/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 44/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 45/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 46/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 47/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 48/50
2025-06-06 15:18:25,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,730 - DEBUG - Online update step: 49/50
2025-06-06 15:18:25,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,731 - DEBUG - Online update step: 50/50
2025-06-06 15:18:25,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:25,731 - WARNING - No successful steps during online update.
2025-06-06 15:18:25,732 - DEBUG - Current node mean: [-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], current edge mean: [ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:18:25,732 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3039
2025-06-06 15:18:25,732 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:18:25,732 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:18:25,732 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:18:25,733 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:18:25,734 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:18:25,735 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:18:25,735 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:18:25,735 - INFO - Optimizer and scheduler reset.
2025-06-06 15:18:25,736 - DEBUG - Updated reference mean: node=[-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], edge=[ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:18:25,736 - DEBUG - Updated reference std: node=[1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978], edge=[0.50084144 1.9184657  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784 ]
2025-06-06 15:18:25,736 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:25,736 - INFO - Running anomaly detection...
2025-06-06 15:18:25,736 - INFO - Starting anomaly detection.
2025-06-06 15:18:26,093 - DEBUG - Node reconstruction errors: [1.1614082e+00 1.1614082e+00 1.1614082e+00 1.1614082e+00 1.1614082e+00
 1.1614082e+00 1.0517550e+00 8.4137207e-01 8.4137207e-01 8.4137207e-01
 7.0174497e-01 8.4137207e-01 8.4137207e-01 1.1614082e+00 1.1614082e+00
 8.4137207e-01 8.4137207e-01 8.4137207e-01 8.4137207e-01 8.4137207e-01
 8.4137207e-01 8.4137207e-01 8.4137207e-01 8.4137207e-01 8.4137207e-01
 9.4216067e-01 8.4137207e-01 7.0174497e-01 8.4137207e-01 8.4137207e-01
 8.4137207e-01 8.4137207e-01 8.4137207e-01 7.0174497e-01 8.4137207e-01
 8.4137207e-01 9.4216067e-01 8.4137207e-01 7.0174497e-01 8.4137207e-01
 7.0174497e-01 7.0174497e-01 1.0475429e+00 1.0475429e+00 7.0174497e-01
 7.0174497e-01 7.0174497e-01 1.9115357e+00 8.4137207e-01 1.9115357e+00
 8.4137207e-01 7.9075867e-01 8.4137207e-01 6.2011993e-01 8.4137207e-01
 4.4516563e-01 7.9075867e-01 8.4137207e-01 9.0294164e-01 8.4137207e-01
 8.4137207e-01 4.4516563e-01 8.4137207e-01 4.4516563e-01 6.2011993e-01
 9.0294164e-01 1.0475429e+00 7.9075867e-01 7.9075867e-01 1.1614082e+00
 7.9075867e-01 7.9075867e-01 9.4216067e-01 7.9075867e-01 8.0849254e-01
 1.3179375e+00 7.9075867e-01 7.9075867e-01 8.4920819e+02 6.2011993e-01
 6.2011993e-01 8.4137207e-01 5.6956202e-01 6.1464149e-01 7.9075867e-01
 7.9075867e-01 6.2011993e-01 1.3179375e+00 6.2011993e-01 1.1614082e+00
 7.9075867e-01 7.0174497e-01 6.2011993e-01 1.1614082e+00 7.2623616e-01
 1.0517550e+00 1.1614082e+00 6.7995977e-01 7.2623616e-01 6.2011993e-01
 6.2011993e-01 6.2011993e-01 7.0174509e-01 6.2011993e-01 6.2011993e-01
 3.7097308e-01 7.0174497e-01 3.7097308e-01 1.1969935e+00 7.0883739e-01
 4.9165592e-01 7.0174497e-01 5.4315603e-01 7.0883739e-01 4.2202231e-01
 3.1315249e-01 7.2623616e-01 5.4315603e-01 1.1046225e+00 1.1614082e+00
 7.2623616e-01 6.5393746e-01 4.9246496e-01 6.5393746e-01 6.5393746e-01
 4.9165592e-01 8.4137207e-01 4.9165592e-01 6.2011993e-01 6.2011993e-01
 6.5393746e-01 4.9165592e-01 6.5393746e-01 6.5393746e-01 6.5393746e-01
 4.9165592e-01 1.0475429e+00 6.2011993e-01 3.1315249e-01 6.5393746e-01
 1.3611166e+00 6.7995977e-01 1.3611166e+00 8.4137207e-01 5.0986689e-01
 1.2899015e+00 6.5393746e-01 6.5393746e-01 8.4137207e-01 1.2454176e+00
 6.5393746e-01 6.5393746e-01 7.2623616e-01 4.9246496e-01 6.5393746e-01
 6.5393746e-01 7.6726723e-01 6.5393746e-01 4.9165592e-01 6.5393746e-01
 6.7995977e-01 3.1315249e-01 3.7097308e-01 8.4137207e-01 7.0883739e-01
 4.9165592e-01 8.4137207e-01 7.0174497e-01 4.9165592e-01 4.9165592e-01
 4.9165592e-01 3.2712641e+00 8.4137207e-01 2.9982573e-01 2.9982573e-01
 1.5151596e+00 9.4216067e-01 2.2630094e-01 2.2098746e+00 2.1645451e-01
 6.5428245e-01 2.7831903e-01 2.1694131e-01 4.9246496e-01 6.2650359e-01
 2.2630094e-01 4.0435347e-01 6.2011993e-01 1.9236058e-01 1.6342013e+03
 6.8289030e-01 6.6368443e-01 6.4086455e-01 6.6368443e-01 1.3611166e+00
 1.4112045e+00 8.5882318e+02 8.5882318e+02 4.9246496e-01 1.9236058e-01
 2.2040676e-01 4.5043409e-01 1.8559428e-01 2.2630094e-01 8.4137207e-01
 1.1813745e+00 6.8289030e-01 7.9075867e-01 1.1046225e+00 4.4451639e-01
 5.0953937e-01 1.1521150e+00 3.6334029e-01 1.1823640e+00 7.0883739e-01
 3.0663481e-01 7.2623616e-01 9.2894435e-01 1.0238435e+00 7.0174497e-01
 1.6155468e+00 5.9734386e-01 4.0287963e-01 6.8289030e-01 8.4137207e-01
 7.0174497e-01 4.0435347e-01 4.9165592e-01 7.5818139e-01 7.0174497e-01
 4.9038633e+03 6.8984842e-01 6.2368250e-01 2.6136333e-01 3.7097308e-01
 2.1645451e-01 1.0768871e+00 6.8984842e-01 6.5393746e-01 2.1645451e-01
 8.4137207e-01 1.5802677e+00 1.3903180e+00 7.2623616e-01 1.3903180e+00
 3.0207005e-01 4.4451639e-01 4.1262302e-01 1.4171053e+00 1.1614082e+00
 6.6368443e-01 4.0405449e-01 2.1645451e-01 5.0953937e-01 6.1350822e-01
 1.8602600e+00 1.8602600e+00 1.1614082e+00 1.3940771e+00 1.9115357e+00
 1.3903180e+00 1.8602600e+00 6.8289030e-01 6.8289030e-01 1.3903180e+00
 4.4451639e-01 1.1614082e+00 8.4137207e-01 5.0986689e-01 6.2368250e-01
 4.9246496e-01 4.9165592e-01 9.9424887e-01 4.8642716e-01 7.2895157e-01
 4.0435347e-01 3.9139152e-01 4.4451639e-01 8.9233661e-01 6.2650359e-01
 2.1645451e-01 5.0953937e-01 6.8984842e-01 2.9982573e-01 6.2368250e-01
 1.1518896e+03 4.9165592e-01 1.0737679e+00 7.9075867e-01 4.5043409e-01
 4.0405449e-01 4.0405449e-01 6.2650359e-01 6.2368250e-01 4.9165592e-01
 6.8289030e-01 4.3337962e-01 1.5490144e+00 1.8602600e+00 6.8289030e-01
 1.8074036e+00 1.0737679e+00 4.9246496e-01 1.2936337e+00 9.2894435e-01
 6.2650359e-01 9.4216067e-01 1.3903180e+00 4.4451633e-01 7.0174497e-01
 1.2077185e+00 1.3903180e+00 9.9424887e-01 1.3903180e+00 1.3903180e+00
 8.4137207e-01 7.0883739e-01 4.5043409e-01 1.8602600e+00 1.0124394e+00
 2.7831903e-01 7.0174497e-01 6.5393746e-01 1.1614082e+00 7.1094114e-01
 2.2098746e+00 7.0174497e-01 6.1350822e-01 4.3219438e+00 1.0613209e+00
 4.5043409e-01 1.3785315e+03 1.1046225e+00 4.9165592e-01 5.6740409e-01
 4.9246496e-01 8.8028795e-01 1.0737679e+00 8.4137207e-01 4.7102295e+03
 4.0435347e-01 1.1091666e+00 6.2011993e-01 6.2650359e-01 6.2011993e-01
 7.0883739e-01 1.3903180e+00 4.4451639e-01 5.7527819e+00 6.1350822e-01
 1.4910333e+00 9.8919946e-01 6.5428245e-01 4.5043409e-01 4.9165592e-01
 7.8171668e+00 1.7890871e+01 6.7844258e+03 1.4206272e+00 4.9165592e-01
 7.0174497e-01 4.4398409e-01 1.3832856e+00 9.9424887e-01 7.2895157e-01
 6.8289030e-01 4.9165592e-01 4.8642716e-01 1.3903180e+00 9.0294164e-01
 6.8984842e-01 1.5902383e+00 3.6446929e-01 1.1614082e+00 1.6619831e+00
 4.1262302e-01 6.8289030e-01 1.2146589e+00 4.0405449e-01 1.1614082e+00
 1.0613209e+00 1.4448167e+00 4.0435347e-01 4.5043409e-01 6.2368250e-01
 7.2895157e-01 2.2630094e-01 6.2368250e-01 4.9165592e-01 1.3903180e+00
 1.0613209e+00 6.2368250e-01 2.5709730e-01 6.2011993e-01 6.2368250e-01
 6.6138417e-01 6.2650359e-01 6.2011993e-01 2.2630094e-01 1.2587957e+00
 8.4137207e-01 6.0148115e+00 6.8289030e-01 4.5898989e-01 4.0435347e-01
 1.5902383e+00 4.5043409e-01 6.2650359e-01 4.9165592e-01 1.3903180e+00
 9.9424887e-01 4.4451633e-01 1.1614082e+00 8.4137207e-01 4.4451639e-01
 4.0435347e-01 6.2368250e-01 7.0174497e-01 5.2193433e-01 3.1043718e+00
 4.9165592e-01 1.3018851e+03 4.4451639e-01 9.5498937e-01 4.4451639e-01
 2.7831903e-01 1.4724960e+00 4.9165592e-01 4.9165592e-01 4.5043409e-01
 6.8289030e-01 1.1614082e+00 7.0883739e-01 1.2936337e+00 6.5393746e-01
 6.2011993e-01 4.5043409e-01 6.5393746e-01 1.8602600e+00 6.6182523e+00
 6.8289030e-01 4.4451639e-01 6.4086455e-01 6.2650359e-01 7.0883739e-01
 1.3903180e+00 1.2236034e+00 8.4137207e-01 2.2630094e-01 1.0737679e+00
 5.5595469e+00 4.0435347e-01 4.4451639e-01 4.0435347e-01 1.1643081e+00
 4.0435347e-01 6.2650359e-01 6.2650359e-01 7.0174497e-01 2.7375558e-01
 4.0435347e-01 8.4137207e-01 4.4451639e-01 1.0737679e+00 6.2011993e-01
 2.7831903e-01 3.5669225e-01 4.9246496e-01 1.5352155e+00 4.4451639e-01
 2.7831903e-01 4.5898989e-01 4.4451639e-01 1.8602600e+00 1.0737679e+00
 3.6912414e-01 6.5393746e-01 5.2193433e-01 4.0405449e-01 8.5719401e-01
 4.9165592e-01 5.2193433e-01 1.3611166e+00 4.0435347e-01 4.0405449e-01
 7.9075867e-01 1.1154561e+00 7.9075867e-01 6.6368443e-01 1.2243086e+00
 4.4516563e-01 5.2193433e-01 5.2193433e-01 6.3208008e-01 6.2011993e-01
 4.4451639e-01 3.6334029e-01 1.0737679e+00 7.9075867e-01 7.9075867e-01
 4.9189106e+03 1.0180486e+00 4.9165592e-01 1.2899015e+00 6.5393746e-01
 2.9982573e-01 2.1694131e-01 6.4086455e-01 6.5428245e-01 6.4086455e-01
 5.4315585e-01 7.0883733e-01]
2025-06-06 15:18:26,093 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        ... 0.19999999 0.8        0.19999999]
2025-06-06 15:18:26,109 - ERROR - An error occurred while processing file nw_graph_encoded_1749044648.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:26,110 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:26,110 - INFO - 
--- Processing file: nw_graph_encoded_1749044708.dot ---
2025-06-06 15:18:26,110 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot
2025-06-06 15:18:26,110 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot file.
2025-06-06 15:18:26,122 - INFO - Parsed 640 nodes.
2025-06-06 15:18:26,137 - INFO - Parsed 1302 edges.
2025-06-06 15:18:26,488 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:26,488 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:26,494 - DEBUG - Initial node features tensor shape: torch.Size([640, 19])
2025-06-06 15:18:26,500 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:26,500 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 19])
2025-06-06 15:18:26,501 - DEBUG - Edge index tensor shape: torch.Size([2, 1302])
2025-06-06 15:18:26,502 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:26,511 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:26,512 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:26,513 - DEBUG - Shape of encoded categorical edge features: torch.Size([1302, 2])
2025-06-06 15:18:26,515 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:26,515 - DEBUG - Shape of scaled numerical edge features: torch.Size([1302, 20])
2025-06-06 15:18:26,515 - DEBUG - Final edge attributes tensor shape: torch.Size([1302, 22])
2025-06-06 15:18:26,516 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:26,516 - INFO - Performing online update...
2025-06-06 15:18:26,516 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:26,517 - DEBUG - Updated RunningStats: new_mean=[ 4.10523746e-10 -4.67812172e-10 -2.64807547e-09  2.28751167e-09
 -2.52491457e-08  1.36785419e-08 -9.55482352e-09 -2.26445551e-09
 -2.91488502e-09  1.03159327e-09  1.45069575e-09 -1.49351029e-09
  3.66082753e-09 -3.37983053e-09  1.00303292e-09  7.10654884e-10
 -3.72209763e-09  1.14053778e-09 -4.65711132e-09], new_M2=[197121.00532543 197121.00527969 197121.00026595 197121.0043394
 197120.99841728 197120.99844231 197120.99594604 197120.99822146
 197120.99314437 197120.99843688 197121.001854   197120.99391997
 197120.99277046 157329.9966922  157330.00006897 157329.99884783
 157330.00002901 197121.00021583 197121.00772109], new_n=197121
2025-06-06 15:18:26,517 - DEBUG - Updated RunningStats: new_mean=[ 1.41474257e+00  5.48977213e+00  1.10665499e-10  2.53611743e-10
  1.44214613e-10 -1.57551121e-10 -1.26074714e-09  1.83991366e-10
  2.87241315e-10 -2.17162233e-10  3.22425601e-10 -3.45061056e-09
 -8.59565940e-10  1.81549386e-10  2.85524521e-10 -1.49121955e-10
 -1.49121955e-10 -1.49121955e-10 -1.49121955e-10 -1.49121955e-10
 -1.49121955e-10 -8.48246438e-11], new_M2=[ 109143.7713412  1893381.91729456  423792.99903355  423793.00589262
  423793.00576988  423792.99336598  423793.0003623   423792.99906888
  423793.00166526  423792.99935291  423792.9938514   423793.00854348
  423793.0011177   423792.99991143  423793.00179166  423792.99461394
  423792.99461394  423792.99461394  423792.99461394  423792.99461394
  423792.99461394  423792.99897621], new_n=423793
2025-06-06 15:18:26,518 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89338637 0.89338637 0.89338637 0.89338637 1.
 1.00000002]
2025-06-06 15:18:26,518 - DEBUG - Calculated standard deviation: [0.50748427 2.11369453 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:26,518 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:26,518 - DEBUG - Online update step: 1/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 2/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 3/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 4/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 5/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 6/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 7/50
2025-06-06 15:18:26,518 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,518 - DEBUG - Online update step: 8/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 9/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 10/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 11/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 12/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 13/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 14/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 15/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 16/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 17/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 18/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 19/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 20/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 21/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,519 - DEBUG - Online update step: 22/50
2025-06-06 15:18:26,519 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 23/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 24/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 25/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 26/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 27/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 28/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 29/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 30/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 31/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 32/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 33/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 34/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 35/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 36/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,520 - DEBUG - Online update step: 37/50
2025-06-06 15:18:26,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 38/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 39/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 40/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 41/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 42/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 43/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 44/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 45/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 46/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 47/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 48/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 49/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - DEBUG - Online update step: 50/50
2025-06-06 15:18:26,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:26,521 - WARNING - No successful steps during online update.
2025-06-06 15:18:26,522 - DEBUG - Current node mean: [-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], current edge mean: [ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:18:26,522 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2579
2025-06-06 15:18:26,523 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:18:26,523 - DEBUG - Updated reference mean: node=[-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], edge=[ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:18:26,523 - DEBUG - Updated reference std: node=[1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007823 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821], edge=[0.5010547 1.8293908 1.0003842 1.0003842 1.0003843 1.0003843 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842]
2025-06-06 15:18:26,523 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:26,523 - INFO - Running anomaly detection...
2025-06-06 15:18:26,524 - INFO - Starting anomaly detection.
2025-06-06 15:18:26,860 - DEBUG - Node reconstruction errors: [1.1484845e+00 3.1232815e+00 1.1484845e+00 1.1484845e+00 1.1484845e+00
 1.1484845e+00 1.1484845e+00 1.1484845e+00 1.1484845e+00 1.1484845e+00
 9.4202846e-01 8.5264194e-01 9.4202846e-01 8.5264194e-01 8.5264194e-01
 8.5264194e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01
 8.5264194e-01 8.5264194e-01 9.4202846e-01 8.5264194e-01 8.5264194e-01
 8.5264194e-01 8.5264194e-01 7.6162076e-01 8.5264194e-01 8.7369156e-01
 8.3236361e-01 7.6093072e-01 7.3411077e-01 8.7369156e-01 7.6093072e-01
 8.5264194e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01
 8.5264194e-01 8.5264194e-01 1.1484845e+00 8.5264194e-01 8.5264194e-01
 9.4202846e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01 9.4202846e-01
 9.4202846e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01 9.4202846e-01
 8.5264194e-01 9.4202846e-01 8.5264194e-01 8.5264194e-01 8.5264194e-01
 7.3411077e-01 7.3411077e-01 9.4202846e-01 9.4202846e-01 6.6787398e-01
 6.4640868e-01 7.5402117e-01 2.1185265e-01 8.5264194e-01 9.8758376e-01
 7.3411077e-01 1.3443358e+00 6.2515151e+03 7.0065528e-01 1.1110165e+00
 3.8083133e-01 3.9683098e-01 5.0167418e-01 6.2130070e-01 3.9683098e-01
 1.0785962e+00 3.8795054e-01 3.5880777e-01 4.6500227e-01 3.8795054e-01
 3.9683098e-01 6.5057069e-01 2.5690755e-01 1.9481137e+00 3.6561933e-01
 1.1484845e+00 4.4543853e-01 4.6500227e-01 3.2071787e-01 2.1052752e-01
 1.0476350e+00 8.3852237e-01 3.5880777e-01 2.8452978e-01 5.5368870e-01
 6.5381163e-01 8.5264194e-01 3.5880777e-01 3.9683098e-01 3.5880777e-01
 6.2682099e+00 1.0476350e+00 1.9442795e-01 6.4240777e-01 1.5003885e+00
 2.1066566e+00 6.6787398e-01 1.1110165e+00 3.6561933e-01 7.4722033e+00
 1.9481137e+00 6.5057069e-01 1.5048280e+00 6.6787398e-01 8.5264194e-01
 1.2109818e+00 4.4233683e-01 4.2433891e-01 1.4652370e+00 2.5690755e-01
 1.6301519e+00 1.5329171e+03 4.4233683e-01 1.0712445e+00 3.9683098e-01
 4.9086711e-01 1.7089802e+00 6.7658454e-01 8.5264194e-01 3.6561933e-01
 9.4202846e-01 3.6561933e-01 1.1007209e+00 1.5003885e+00 8.2388109e-01
 6.5381163e-01 6.5057069e-01 1.6078631e+00 8.5264194e-01 3.8562536e-01
 6.7447048e-01 6.9002099e+00 2.6138219e-01 8.3852237e-01 9.4202846e-01
 4.5865735e-01 1.9442795e-01 5.0167418e-01 6.5381163e-01 8.5264194e-01
 6.7658454e-01 6.5446097e-01 2.6519564e-01 6.7658454e-01 4.6500227e-01
 6.7658454e-01 1.9442795e-01 1.1432040e+00 4.5865735e-01 3.5880777e-01
 1.1432040e+00 9.4202846e-01 3.8795054e-01 1.2882835e+00 9.4202846e-01
 6.7447048e-01 4.5773864e-01 8.5264194e-01 1.6078631e+00 6.5381163e-01
 7.8095359e-01 6.0284585e-01 1.1484845e+00 7.2752875e-01 1.1432040e+00
 3.5880777e-01 1.1007209e+00 5.5495232e-01 1.4841796e+00 8.5484355e+03
 9.2354250e+00 4.2669818e-01 4.5865735e-01 1.0400441e+00 6.3414401e-01
 8.5264194e-01 6.5136757e+00 8.5264194e-01 3.6561933e-01 1.5003885e+00
 1.2834995e+00 5.0167418e-01 5.0167418e-01 1.2179976e+00 3.9683098e-01
 5.9563057e+03 6.4240777e-01 1.0476350e+00 4.1056386e-01 6.0284585e-01
 4.4233683e-01 1.6662635e+03 4.5865735e-01 1.0388744e+00 5.1665177e+00
 7.3559320e-01 4.9086711e-01 2.3512645e+00 1.4403881e+00 7.2694856e-01
 8.5264194e-01 1.0114539e+00 6.5057069e-01 2.1052752e-01 1.0694361e+00
 4.5865735e-01 7.3411077e-01 6.6787398e-01 6.4240777e-01 1.5003885e+00
 1.5003885e+00 1.1007209e+00 1.5003885e+00 4.9086711e-01 3.6561933e-01
 7.1662813e-01 1.5003885e+00 7.8411585e-01 1.0715660e+00 1.5048280e+00
 4.1056386e-01 1.5003885e+00 1.0476350e+00 1.9695174e+00 1.7303032e+00
 3.2011503e-01 7.2752875e-01 1.1110165e+00 6.5381163e-01 3.8795054e-01
 4.5865735e-01 7.0065528e-01 1.1432040e+00 4.4233683e-01 4.6500227e-01
 1.2538822e+00 1.6603544e+00 1.4247378e+03 2.6138219e-01 7.8095359e-01
 5.6917143e-01 2.8260043e-01 1.9481137e+00 6.5381163e-01 1.0037328e+00
 3.6561933e-01 3.5185885e-01 1.5584955e+00 3.5880777e-01 4.8162556e-01
 4.4233683e-01 6.7658454e-01 6.7447048e-01 3.5887814e-01 6.4240777e-01
 8.5264194e-01 3.6561933e-01 1.5003885e+00 1.1110165e+00 8.5264194e-01
 1.9481137e+00 8.5264194e-01 1.5003885e+00 1.8630533e+00 1.3496084e+00
 1.0712445e+00 1.9481137e+00 1.9481137e+00 8.4372872e-01 8.5264194e-01
 5.6917137e-01 2.3417333e-01 3.8795054e-01 3.6561933e-01 8.1242508e-01
 8.5264194e-01 1.5180062e+00 3.5880777e-01 3.9683098e-01 4.1935408e-01
 1.5003885e+00 3.9683098e-01 6.7123735e-01 1.5003885e+00 9.5071650e-01
 3.5880777e-01 1.6316519e+00 7.2590202e-01 3.9683098e-01 7.8411585e-01
 2.3417333e-01 4.4233683e-01 6.5057069e-01 7.8095359e-01 1.1347773e+00
 2.3417333e-01 4.0275493e-01 8.5264194e-01 2.4124563e-01 1.2109818e+00
 7.8095359e-01 4.9086711e-01 8.7315673e-01 2.5690755e-01 8.3852237e-01
 8.5264194e-01 8.3852237e-01 6.7447048e-01 3.8759387e-01 8.3236361e-01
 8.5264194e-01 8.5264194e-01 6.4356369e-01 1.5345688e+00 4.9086711e-01
 9.4202846e-01 6.4640868e-01 1.0725814e+00 8.2388109e-01 2.5921020e-01
 6.6787398e-01 1.1432040e+00 2.4395117e-01 1.2464106e+00 5.6917137e-01
 3.6561933e-01 7.0065528e-01 8.5264194e-01 7.2752875e-01 1.1347773e+00
 6.4240777e-01 4.5865735e-01 2.5450602e-01 1.3624836e+00 1.8812780e-01
 4.1056386e-01 1.0444148e+03 7.3411077e-01 1.0444148e+03 1.3886040e+00
 1.4403881e+00 3.9683098e-01 7.1662813e-01 6.4640868e-01 7.1662813e-01
 2.1222981e+03 1.8812780e-01 5.0167418e-01 2.5690755e-01 8.5264194e-01
 6.7658454e-01 4.9086711e-01 6.5381163e-01 8.5264194e-01 4.1056386e-01
 2.1052752e-01 7.5402117e-01 2.3417333e-01 2.3512645e+00 9.4202846e-01
 9.4202846e-01 7.3411077e-01 6.4240777e-01 2.5690755e-01 9.4855708e-01
 1.5281782e+00 2.6138219e-01 3.1671882e-01 6.4240789e-01 3.4906938e+00
 1.2265534e+00 4.4233683e-01 4.4233683e-01 4.4233683e-01 4.9086711e-01
 6.9260001e-01 7.5402117e-01 4.1056386e-01 4.4233683e-01 3.8795054e-01
 6.6787398e-01 1.4943639e+00 4.4233683e-01 6.4240777e-01 2.6419777e-01
 2.4638261e-01 7.2590202e-01 1.3011293e+00 6.5057069e-01 1.4773461e+00
 6.7447048e-01 6.5057069e-01 6.5057069e-01 4.6500227e-01 6.7123735e-01
 1.1266756e+00 8.0998862e-01 1.1266756e+00 4.4233683e-01 6.5057069e-01
 3.0382504e+01 8.5264194e-01 3.6561933e-01 6.5057069e-01 1.3443358e+00
 3.5887814e-01 5.7095796e-01 1.4997321e+00 6.5057069e-01 3.1671882e-01
 5.0167418e-01 8.3852237e-01 6.5057069e-01 6.5057069e-01 7.2590202e-01
 4.4233683e-01 5.0654447e-01 6.5057069e-01 7.0065528e-01 5.0167418e-01
 5.7095796e-01 1.0371097e+00 1.3011318e+00 4.6500227e-01 8.5264194e-01
 4.9970552e-01 6.5057069e-01 4.4233683e-01 4.0123594e-01 6.5057069e-01
 1.9481137e+00 4.1056386e-01 6.5057069e-01 6.7123735e-01 8.5264194e-01
 1.0407852e+00 8.3852237e-01 6.4240777e-01 5.4350746e-01 3.6561933e-01
 6.5381163e-01 6.7123735e-01 2.4638261e-01 3.0475143e-01 6.6787398e-01
 1.0388744e+00 4.6500227e-01 4.9086711e-01 4.4233683e-01 1.0712445e+00
 1.1007209e+00 1.0687501e+00 2.6419777e-01 6.7658454e-01 4.9086711e-01
 3.1671882e-01 5.0167418e-01 9.4202846e-01 5.0167418e-01 5.5368870e-01
 2.5690755e-01 5.0167418e-01 5.0167418e-01 5.0167418e-01 8.5264194e-01
 4.0909722e-01 6.7123735e-01 7.0065528e-01 5.1801842e-01 8.5264194e-01
 1.0715660e+00 4.6500227e-01 4.6500227e-01 7.3411077e-01 6.7123735e-01
 8.5264194e-01 8.5264194e-01 5.0167418e-01 9.4202846e-01 1.2453642e+00
 7.0065528e-01 8.5264194e-01 1.1582142e+00 5.0167418e-01 7.0065528e-01
 7.6298934e-01 4.1582534e-01 6.6787398e-01 4.4950911e-01 6.4240777e-01
 5.0167418e-01 5.0167418e-01 8.0998862e-01 1.0283986e+03 7.0065528e-01
 9.4202846e-01 7.0065522e-01 4.9086711e-01 1.2707036e+00 3.1671882e-01
 1.1634569e+00 6.9260001e-01 4.5865735e-01 7.6298934e-01 1.1634569e+00
 7.0065528e-01 7.3411077e-01 9.4202846e-01 4.6500227e-01 8.7209904e-01
 8.3852237e-01 1.3068335e+00 5.0167418e-01 5.0167418e-01 3.3534569e-01
 3.3534569e-01 4.4233683e-01 8.3852237e-01 1.3643470e+00 8.3852237e-01
 7.6298934e-01 8.3852237e-01 1.1328684e+00 1.1634569e+00 3.3534569e-01
 9.4855708e-01 9.4855708e-01 5.0167418e-01 8.5264194e-01 8.5264194e-01
 8.3852237e-01 8.5264194e-01 7.0065528e-01 1.0476350e+00 6.4240777e-01
 1.8630533e+00 8.5264194e-01 8.5264194e-01 6.4240777e-01 1.8630533e+00
 4.9086711e-01 4.9086711e-01 1.6438888e+00 4.9086711e-01 8.3852237e-01
 6.4640868e-01 8.3852237e-01 5.0167418e-01 4.9086711e-01 1.3643470e+00
 1.1634569e+00 6.9260001e-01 1.2453642e+00 6.5381163e-01 6.4240777e-01
 9.4855708e-01 9.4855708e-01 6.4240777e-01 4.9086711e-01 7.8411585e-01
 8.3852237e-01 6.4240777e-01 6.4240777e-01 6.5446097e-01 8.3852237e-01
 4.9086711e-01 3.3534569e-01 6.4240777e-01 6.9260001e-01 7.0851618e-01
 6.4240777e-01 8.5264194e-01 8.5264194e-01 6.4240777e-01 5.5368870e-01
 6.9260001e-01 6.4240777e-01 8.3852237e-01 6.7913073e-01 8.3852237e-01
 1.5003885e+00 6.4240777e-01 6.9260001e-01 7.8411585e-01 8.5264194e-01
 6.4240777e-01 8.5264194e-01 8.5264194e-01 4.5865735e-01 8.5264194e-01
 2.0414954e-01 6.4240777e-01 6.4240777e-01 4.9086711e-01 2.5690755e-01
 8.3852237e-01 6.4240777e-01 1.1432040e+00 6.9260001e-01 7.3411077e-01
 7.3411077e-01 1.4403881e+00 8.5264194e-01 8.5264194e-01 8.5264194e-01
 8.5264194e-01 7.3411077e-01 8.5264194e-01 1.0712445e+00 8.5264194e-01
 7.3411077e-01 9.5071650e-01 3.1299624e+00 8.5264194e-01 7.3411077e-01
 8.5264194e-01 7.3411077e-01 8.3236361e-01 1.1328684e+00 8.5264194e-01
 9.4202846e-01 6.2341367e+03 9.4202846e-01 4.5773864e-01 9.4202846e-01]
2025-06-06 15:18:26,861 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 ... 0.19999999 0.19999999 0.8       ]
2025-06-06 15:18:26,869 - ERROR - An error occurred while processing file nw_graph_encoded_1749044708.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:26,869 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:26,869 - INFO - 
--- Processing file: nw_graph_encoded_1749044768.dot ---
2025-06-06 15:18:26,869 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot
2025-06-06 15:18:26,869 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot file.
2025-06-06 15:18:26,899 - INFO - Parsed 693 nodes.
2025-06-06 15:18:26,917 - INFO - Parsed 1448 edges.
2025-06-06 15:18:27,398 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:27,399 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:27,405 - DEBUG - Initial node features tensor shape: torch.Size([693, 19])
2025-06-06 15:18:27,411 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:27,422 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 19])
2025-06-06 15:18:27,425 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-06 15:18:27,425 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:27,443 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:27,444 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:27,445 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-06 15:18:27,447 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:27,447 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-06 15:18:27,447 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-06 15:18:27,447 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:27,447 - INFO - Performing online update...
2025-06-06 15:18:27,447 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:27,448 - DEBUG - Updated RunningStats: new_mean=[ 3.94773023e-10 -4.51860751e-10 -2.75043630e-09  2.26533597e-09
 -2.51326682e-08  1.36672697e-08 -9.53777195e-09 -2.27656002e-09
 -2.90284660e-09  1.02300757e-09  1.50730812e-09 -1.48195044e-09
  3.65335096e-09 -3.37605022e-09  9.52890253e-10  6.89182307e-10
 -3.76028187e-09  1.13779920e-09 -4.62964739e-09], new_M2=[197814.00531149 197814.00526575 197814.00030005 197814.00432769
 197813.99839443 197813.99844888 197813.99592809 197813.99820356
 197813.99319283 197813.99844318 197814.00184998 197813.99391541
 197813.99277143 158022.996703   158023.00006966 158022.99886628
 158023.00000908 197814.0002197  197814.00769222], new_n=197814
2025-06-06 15:18:27,449 - DEBUG - Updated RunningStats: new_mean=[ 1.41475775e+00  5.48802444e+00  1.12096738e-10  2.53665133e-10
  1.44714361e-10 -1.58158696e-10 -1.24417469e-09  1.85961770e-10
  2.99021680e-10 -2.06821620e-10  3.15000418e-10 -3.46048397e-09
 -8.60302370e-10  1.68578994e-10  2.88630250e-10 -1.49261283e-10
 -1.49261283e-10 -1.49261283e-10 -1.49261283e-10 -1.49261283e-10
 -1.49261283e-10 -8.50069514e-11], new_M2=[ 109514.34626953 1898361.26445008  425240.99905464  425241.0059393
  425241.0057994   425240.99333492  425241.00036056  425240.99910922
  425241.00166317  425240.99933534  425240.99386721  425241.00860678
  425241.00110754  425240.99991649  425241.0018182   425240.9945664
  425240.9945664   425240.9945664   425240.9945664   425240.9945664
  425240.9945664   425240.99895599], new_n=425241
2025-06-06 15:18:27,449 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89378206 0.89378207 0.89378207 0.89378207 1.
 1.00000002]
2025-06-06 15:18:27,449 - DEBUG - Calculated standard deviation: [0.50747884 2.11286557 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:27,449 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:27,449 - DEBUG - Online update step: 1/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 2/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 3/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 4/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 5/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 6/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 7/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 8/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,449 - DEBUG - Online update step: 9/50
2025-06-06 15:18:27,449 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 10/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 11/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 12/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 13/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 14/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 15/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 16/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 17/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 18/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 19/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 20/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 21/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 22/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 23/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 24/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 25/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 26/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,450 - DEBUG - Online update step: 27/50
2025-06-06 15:18:27,450 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 28/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 29/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 30/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 31/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 32/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 33/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 34/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 35/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 36/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 37/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 38/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 39/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 40/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 41/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 42/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 43/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 44/50
2025-06-06 15:18:27,451 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,451 - DEBUG - Online update step: 45/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - DEBUG - Online update step: 46/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - DEBUG - Online update step: 47/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - DEBUG - Online update step: 48/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - DEBUG - Online update step: 49/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - DEBUG - Online update step: 50/50
2025-06-06 15:18:27,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:27,452 - WARNING - No successful steps during online update.
2025-06-06 15:18:27,453 - DEBUG - Current node mean: [-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], current edge mean: [ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:18:27,453 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2421
2025-06-06 15:18:27,453 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:18:27,453 - DEBUG - Updated reference mean: node=[-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], edge=[ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:18:27,453 - DEBUG - Updated reference std: node=[1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223], edge=[0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455]
2025-06-06 15:18:27,453 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:27,453 - INFO - Running anomaly detection...
2025-06-06 15:18:27,454 - INFO - Starting anomaly detection.
2025-06-06 15:18:27,650 - DEBUG - Node reconstruction errors: [1.3260223e+00 1.3260223e+00 1.3260223e+00 1.3260223e+00 1.3260223e+00
 1.3260223e+00 1.3260223e+00 1.0074797e+00 1.0074797e+00 1.0074797e+00
 1.0074797e+00 1.0074797e+00 1.0074797e+00 8.9604479e-01 8.9604479e-01
 2.4264660e+00 8.9604479e-01 8.9604479e-01 1.0074797e+00 1.0074797e+00
 1.0074797e+00 1.0074797e+00 1.0074797e+00 8.9604479e-01 1.0074797e+00
 1.0074797e+00 8.9604479e-01 1.0074797e+00 8.9604479e-01 8.9604479e-01
 9.4081467e-01 1.0074797e+00 1.0074797e+00 2.8959789e+00 1.0074797e+00
 1.0074797e+00 1.0074797e+00 1.0074797e+00 1.0074797e+00 1.0074797e+00
 1.0074797e+00 1.0518386e+00 8.3162057e-01 7.6689321e-01 8.3162057e-01
 7.6689321e-01 7.6689321e-01 7.6689321e-01 7.6689321e-01 7.6689321e-01
 7.6689321e-01 7.6689321e-01 7.6689321e-01 9.1861224e-01 8.3162057e-01
 7.6689321e-01 1.1065105e+00 9.1861224e-01 7.6689321e-01 7.6689321e-01
 6.7601317e-01 7.6689321e-01 7.6471621e-01 7.0076382e-01 6.7565912e-01
 6.2557673e-01 7.6471621e-01 6.7565912e-01 7.6689327e-01 7.6689327e-01
 8.3162057e-01 7.6689321e-01 7.6689321e-01 7.6689321e-01 1.0074797e+00
 7.0076382e-01 1.0074797e+00 7.6689321e-01 7.6689321e-01 8.3162057e-01
 7.6689321e-01 7.6689321e-01 7.6689321e-01 8.3162057e-01 8.3162057e-01
 7.6689321e-01 7.6689321e-01 9.1861224e-01 1.0074797e+00 8.3162057e-01
 7.6689321e-01 8.3162057e-01 7.6689321e-01 7.6689321e-01 7.6689321e-01
 7.0076382e-01 6.2557673e-01 8.3162057e-01 8.3162057e-01 6.1166847e-01
 6.1714029e-01 7.5025445e-01 2.8841472e-01 7.6689321e-01 9.4253129e-01
 6.2557673e-01 1.3331953e+00 6.7601592e+03 6.3515097e-01 1.0164900e+00
 4.0771663e-01 3.8333464e-01 4.8567480e-01 5.8578265e-01 3.8333464e-01
 9.8455220e-01 5.0814360e-01 3.6657119e-01 4.2999011e-01 4.0481523e-01
 4.2861181e-01 6.1175781e-01 2.2794543e-01 1.9179019e+00 3.6251712e-01
 1.0074797e+00 4.9575073e-01 4.2999011e-01 3.0708140e-01 1.9885947e-01
 9.8022521e-01 7.3871946e-01 3.6657119e-01 2.8962362e-01 4.7210893e-01
 6.2308466e-01 7.6689321e-01 3.6657119e-01 2.8841472e-01 3.6657113e-01
 6.3818469e+00 9.8022521e-01 1.9404450e-01 5.9492809e-01 1.4928325e+00
 2.0351186e+00 6.1166847e-01 1.1538292e+00 3.6251712e-01 8.6453218e+00
 1.9179019e+00 6.1175781e-01 1.5500307e+00 6.1166847e-01 7.6689321e-01
 1.0977651e+00 4.4252968e-01 4.0424889e-01 1.8302419e+00 2.2794543e-01
 1.6273981e+00 1.5994403e+03 4.4252968e-01 9.1861224e-01 3.8333464e-01
 4.2943668e-01 1.5591909e+00 6.5980321e-01 7.6689321e-01 3.6251712e-01
 8.3162057e-01 3.6251712e-01 1.1182157e+00 1.4928325e+00 8.2230550e-01
 6.2308466e-01 6.1175781e-01 1.5716556e+00 7.6689321e-01 3.8006219e-01
 6.2753028e-01 7.1175594e+00 2.6011929e-01 3.7763808e+00 8.3162057e-01
 4.7940063e-01 1.9404450e-01 4.8567480e-01 6.2308466e-01 9.1861224e-01
 6.5980321e-01 5.7987893e-01 2.7834049e-01 6.5980321e-01 4.2999011e-01
 6.5980321e-01 3.4764338e-01 1.6273981e+00 4.7940063e-01 3.6657119e-01
 1.0360175e+00 8.3162057e-01 4.0481523e-01 1.3058418e+00 8.3162057e-01
 1.0977651e+00 4.8906970e-01 7.6689321e-01 1.9878126e+00 6.2308472e-01
 8.1400394e-01 5.6768119e-01 1.0074797e+00 1.0074797e+00 6.5924698e-01
 1.0360175e+00 3.6657119e-01 1.1182157e+00 6.1350650e-01 1.4555830e+00
 9.2091777e+03 9.7722893e+00 1.6981829e+00 4.7940063e-01 9.9449277e-01
 6.4304823e-01 1.0074797e+00 9.1861224e-01 6.6232004e+00 7.6689321e-01
 3.6251712e-01 1.4928325e+00 1.1341532e+00 4.8567480e-01 4.8567480e-01
 1.2252755e+00 1.0074797e+00 3.8333464e-01 6.4349102e+03 5.9492809e-01
 1.0977651e+00 4.0411460e-01 7.3588312e-01 4.4252968e-01 1.8383766e+03
 4.7940063e-01 9.6030354e-01 5.0896873e+00 7.0312518e-01 4.2943668e-01
 2.3397198e+00 1.4394146e+00 6.7898244e-01 7.6689321e-01 1.0734866e+00
 6.1175781e-01 1.9885947e-01 1.1913066e+00 4.7940063e-01 6.2557673e-01
 6.1166847e-01 5.9492809e-01 1.4928325e+00 1.4928325e+00 1.1182157e+00
 1.4928325e+00 4.2943668e-01 3.6251712e-01 6.9888502e-01 1.4928325e+00
 7.0177418e-01 1.0656415e+00 1.5500307e+00 4.0411460e-01 1.4928325e+00
 9.8022521e-01 1.9871969e+00 1.6186595e+00 2.7767178e-01 6.5924692e-01
 1.1331857e+00 6.2308466e-01 4.0481523e-01 4.7940063e-01 6.3515097e-01
 1.0360175e+00 4.4252968e-01 4.2999011e-01 1.6550205e+00 1.7934345e+00
 1.5404736e+03 2.6011929e-01 8.1400394e-01 6.0134429e-01 2.6643810e-01
 1.9179019e+00 6.2308466e-01 1.0257328e+00 3.6251712e-01 3.5761783e-01
 1.6550205e+00 3.6657119e-01 4.8182568e-01 4.4252968e-01 6.5980321e-01
 6.2753028e-01 3.1719923e-01 5.9492809e-01 7.6689321e-01 3.6251712e-01
 1.4928325e+00 1.0164900e+00 8.3162057e-01 1.9179019e+00 2.6344101e+00
 7.6689321e-01 1.4928325e+00 1.7907401e+00 1.2413493e+00 9.1861224e-01
 1.9179019e+00 1.9179019e+00 5.6768119e-01 9.3823946e-01 6.0134429e-01
 2.4759428e-01 4.2861181e-01 8.9604479e-01 3.6251712e-01 7.3345613e-01
 7.6689321e-01 1.5216783e+00 3.6657119e-01 2.8841472e-01 8.3648318e-01
 8.9604479e-01 1.4928325e+00 3.8333464e-01 6.2037259e-01 1.4928325e+00
 1.0030690e+00 4.2861181e-01 1.5544771e+00 7.8953356e-01 3.8333464e-01
 7.0177418e-01 2.4759428e-01 4.4252968e-01 6.1175781e-01 8.1400394e-01
 1.0500549e+00 2.4759428e-01 3.3669692e-01 7.6689321e-01 3.2882047e-01
 1.1538292e+00 8.1400394e-01 4.2943668e-01 8.6540335e-01 1.0074797e+00
 2.8841472e-01 7.3871946e-01 9.1861224e-01 7.3871946e-01 1.0074797e+00
 6.2753028e-01 3.9763093e-01 7.0076382e-01 9.1861224e-01 7.6689321e-01
 6.6023391e-01 1.5453321e+00 8.1632662e-01 8.3162057e-01 6.1714029e-01
 1.0393953e+00 1.1495004e+00 2.4269706e-01 7.1604717e-01 1.0360175e+00
 2.2748601e-01 1.0074797e+00 1.4473646e+00 6.0134429e-01 3.6251712e-01
 6.3515097e-01 7.6689321e-01 6.5924698e-01 1.0500549e+00 7.0177418e-01
 8.9604479e-01 4.7940063e-01 2.7665889e-01 1.3845435e+00 1.9783264e-01
 4.0411460e-01 1.1261184e+03 6.2557673e-01 1.1261184e+03 1.3182185e+00
 1.4394146e+00 3.8333464e-01 6.9888502e-01 6.1714029e-01 6.9888502e-01
 2.3335293e+03 3.7949523e-01 4.8567480e-01 2.2794543e-01 7.6689321e-01
 6.5980321e-01 4.2943668e-01 6.2308466e-01 9.1861224e-01 4.0411460e-01
 1.9885947e-01 8.4479433e-01 2.4759428e-01 2.3397198e+00 8.3162069e-01
 8.3162057e-01 6.2557673e-01 5.9492809e-01 2.2794543e-01 8.1632662e-01
 1.4684451e+00 2.6011929e-01 2.7389306e-01 5.9492809e-01 3.2607682e+00
 1.1034378e+00 4.4252968e-01 4.4252968e-01 4.4252968e-01 4.2943668e-01
 6.3432467e-01 7.5025445e-01 4.0411460e-01 4.4252968e-01 4.0481523e-01
 7.1604717e-01 1.4790525e+00 4.4252968e-01 5.9492809e-01 2.3713779e-01
 2.3533271e-01 6.4578366e-01 1.2297716e+00 6.1175781e-01 1.3543692e+00
 6.2753028e-01 6.1175781e-01 6.1175781e-01 3.3669692e-01 6.2037259e-01
 1.0222895e+00 1.2052594e+00 1.0222895e+00 4.4252968e-01 1.1034378e+00
 3.4453655e+01 7.6689321e-01 3.6251712e-01 6.1175781e-01 1.3331953e+00
 3.1719923e-01 5.1986295e-01 1.4597445e+00 6.1175781e-01 2.7389306e-01
 4.8567480e-01 7.3871946e-01 1.1353962e+00 6.1175781e-01 6.4578366e-01
 4.8434815e-01 5.2577633e-01 6.1175781e-01 6.3515097e-01 4.8567480e-01
 5.1986295e-01 1.0812292e+00 1.3262142e+00 4.2999011e-01 7.6689321e-01
 4.8076117e-01 6.1175781e-01 4.4252968e-01 3.6490208e-01 6.1175781e-01
 1.9179019e+00 4.0411460e-01 6.1175781e-01 6.2037259e-01 7.6689321e-01
 9.6168637e-01 1.3302155e+00 5.9492809e-01 4.8434815e-01 3.6251712e-01
 6.2308466e-01 6.2037259e-01 2.3533271e-01 2.7144957e-01 6.1166847e-01
 1.1863184e+00 4.8434815e-01 4.2943668e-01 4.4252968e-01 9.1861224e-01
 8.9604479e-01 1.1182157e+00 9.7496647e-01 2.3713779e-01 6.5980321e-01
 4.2943668e-01 3.3669692e-01 5.7987893e-01 8.3162057e-01 4.8567480e-01
 4.7210893e-01 2.2794543e-01 4.8567480e-01 4.8567480e-01 1.3260223e+00
 4.8567480e-01 9.1861224e-01 3.4764338e-01 6.2037259e-01 8.6695802e-01
 4.8484135e-01 7.6689321e-01 1.0656415e+00 4.2999011e-01 3.3669692e-01
 6.2557673e-01 6.2037259e-01 9.1861224e-01 7.6689321e-01 4.8567480e-01
 8.3162057e-01 1.1123948e+00 6.3515097e-01 7.6689321e-01 1.1495004e+00
 4.8567480e-01 6.3515097e-01 6.7435855e-01 3.5274917e-01 6.1166847e-01
 4.1767290e-01 5.9492809e-01 1.1065105e+00 4.8567480e-01 4.8567480e-01
 7.2207552e-01 1.1041937e+03 6.3515097e-01 8.3162069e-01 6.3515091e-01
 4.2943668e-01 1.1411020e+00 1.2163786e+00 1.1495004e+00 6.3432467e-01
 4.7940063e-01 6.7435855e-01 1.1495004e+00 6.3515097e-01 6.2557673e-01
 8.3162057e-01 4.2999011e-01 7.5276423e-01 7.3871946e-01 1.2148600e+00
 4.8567480e-01 4.8567480e-01 3.0933169e-01 3.0933169e-01 4.4252968e-01
 9.3994188e-01 1.2086191e+00 7.3871946e-01 6.7435855e-01 7.3871946e-01
 1.0176653e+00 1.0474445e+00 3.0933169e-01 3.7763808e+00 8.1632662e-01
 4.8567480e-01 9.1861224e-01 7.6689321e-01 7.3871946e-01 7.6689321e-01
 6.3515097e-01 9.8022521e-01 7.0177418e-01 1.0074797e+00 1.7907401e+00
 7.6689321e-01 7.6689321e-01 5.9492809e-01 1.7907401e+00 4.2943668e-01
 4.2943668e-01 1.5290998e+00 4.2943668e-01 7.3871946e-01 6.1714029e-01
 8.1632662e-01 4.8567480e-01 4.2943668e-01 4.0129561e+00 1.0474445e+00
 6.3432467e-01 1.1123948e+00 6.2308466e-01 5.9492809e-01 8.1632662e-01
 8.1632662e-01 5.9492809e-01 4.2943668e-01 7.0177418e-01 7.3871946e-01
 5.9492809e-01 5.9492809e-01 5.7987893e-01 7.3871946e-01 4.2943668e-01
 3.0933169e-01 5.9492809e-01 7.0177418e-01 7.1928877e-01 5.9492809e-01
 7.6689321e-01 7.6689321e-01 1.0074797e+00 5.9492809e-01 4.7210893e-01
 6.3432467e-01 5.9492809e-01 7.3871946e-01 1.1538292e+00 7.3871946e-01
 1.4928325e+00 5.9492809e-01 6.3432467e-01 7.0177418e-01 7.6689321e-01
 5.9492809e-01 7.6689321e-01 7.6689321e-01 4.7940063e-01 7.6689321e-01
 2.2094755e-01 5.9492809e-01 5.9492809e-01 4.2943668e-01 2.2794543e-01
 7.3871946e-01 5.9492809e-01 1.0360175e+00 6.3432467e-01 1.3260223e+00
 6.2557673e-01 6.2557673e-01 1.4394146e+00 7.6689321e-01 7.6689321e-01
 7.6689321e-01 7.6689321e-01 6.2557673e-01 7.6689321e-01 9.1861224e-01
 9.1861224e-01 9.1861224e-01 9.1861224e-01 2.9751663e+00 7.6689321e-01
 1.1065105e+00 6.2557673e-01 7.6689321e-01 6.2557673e-01 8.0927056e-01
 1.0176653e+00 9.1861224e-01 8.3162057e-01 6.7417754e+03 8.3162057e-01
 1.3260223e+00 4.2583269e-01 8.3162051e-01]
2025-06-06 15:18:27,650 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 ... 0.19999999 0.19999999 0.8       ]
2025-06-06 15:18:27,674 - ERROR - An error occurred while processing file nw_graph_encoded_1749044768.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:27,675 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:27,675 - INFO - 
--- Processing file: nw_graph_encoded_1749044828.dot ---
2025-06-06 15:18:27,675 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot
2025-06-06 15:18:27,675 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot file.
2025-06-06 15:18:27,703 - INFO - Parsed 715 nodes.
2025-06-06 15:18:27,721 - INFO - Parsed 1521 edges.
2025-06-06 15:18:28,149 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:28,149 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:28,154 - DEBUG - Initial node features tensor shape: torch.Size([715, 19])
2025-06-06 15:18:28,165 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:28,172 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 19])
2025-06-06 15:18:28,178 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-06 15:18:28,178 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:28,203 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:28,205 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:28,207 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 2])
2025-06-06 15:18:28,209 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:28,209 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 20])
2025-06-06 15:18:28,209 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 22])
2025-06-06 15:18:28,209 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:28,209 - INFO - Performing online update...
2025-06-06 15:18:28,210 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:28,210 - DEBUG - Updated RunningStats: new_mean=[ 3.92450558e-10 -4.49332685e-10 -2.85837147e-09  2.23548567e-09
 -2.50877883e-08  1.36671725e-08 -9.45658567e-09 -2.27766818e-09
 -2.90980545e-09  1.02416445e-09  1.62197213e-09 -1.47015824e-09
  3.62465648e-09 -3.30331972e-09  9.49908776e-10  6.83697910e-10
 -3.79267466e-09  1.12171328e-09 -4.58970583e-09], new_M2=[198529.00524653 198529.00520079 198529.00029387 198529.00434399
 198528.99842432 198528.99840361 198528.99591954 198528.99817993
 198528.99321324 198528.99841888 198529.00184664 198528.99392332
 198528.99281064 158737.99670453 158738.00005229 158737.99886596
 158737.99998547 198529.00019199 198529.00766474], new_n=198529
2025-06-06 15:18:28,211 - DEBUG - Updated RunningStats: new_mean=[ 1.41478857e+00  5.48623589e+00  1.10331509e-10  2.49515433e-10
  1.44758352e-10 -1.57200765e-10 -1.24290548e-09  1.84611569e-10
  2.99270788e-10 -1.88353995e-10  3.09611209e-10 -3.45604089e-09
 -8.54895149e-10  2.28737758e-10  2.89329939e-10 -1.48169242e-10
 -1.48169242e-10 -1.48169242e-10 -1.48169242e-10 -1.48169242e-10
 -1.48169242e-10 -8.19810182e-11], new_M2=[ 109905.78637273 1903495.64960567  426761.99899158  426762.00584223
  426762.00579394  426761.99334414  426762.00038665  426761.99908672
  426762.00164839  426761.99931478  426761.99396614  426762.00861671
  426762.00110397  426761.99992136  426762.00185637  426761.99457574
  426761.99457574  426761.99457574  426761.99457574  426761.99457574
  426761.99457574  426761.99896373], new_n=426762
2025-06-06 15:18:28,211 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89418724 0.89418725 0.89418725 0.89418725 1.
 1.00000002]
2025-06-06 15:18:28,212 - DEBUG - Calculated standard deviation: [0.50747822 2.11194728 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:28,212 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:28,212 - DEBUG - Online update step: 1/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 2/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 3/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 4/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 5/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 6/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 7/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 8/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 9/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 10/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 11/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 12/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,212 - DEBUG - Online update step: 13/50
2025-06-06 15:18:28,212 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 14/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 15/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 16/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 17/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 18/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 19/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 20/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 21/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 22/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 23/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 24/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 25/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 26/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 27/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 28/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 29/50
2025-06-06 15:18:28,213 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,213 - DEBUG - Online update step: 30/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 31/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 32/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 33/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 34/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 35/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 36/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 37/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 38/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 39/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 40/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 41/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 42/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 43/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 44/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 45/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,214 - DEBUG - Online update step: 46/50
2025-06-06 15:18:28,214 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,215 - DEBUG - Online update step: 47/50
2025-06-06 15:18:28,215 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,215 - DEBUG - Online update step: 48/50
2025-06-06 15:18:28,215 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,215 - DEBUG - Online update step: 49/50
2025-06-06 15:18:28,215 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,215 - DEBUG - Online update step: 50/50
2025-06-06 15:18:28,215 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:28,215 - WARNING - No successful steps during online update.
2025-06-06 15:18:28,233 - DEBUG - Current node mean: [-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], current edge mean: [ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:18:28,233 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2368
2025-06-06 15:18:28,233 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:18:28,233 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:18:28,233 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:18:28,238 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:18:28,239 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:18:28,239 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:18:28,239 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:18:28,239 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:18:28,239 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:18:28,240 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:18:28,240 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:18:28,240 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:18:28,240 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:18:28,240 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:18:28,245 - INFO - Optimizer and scheduler reset.
2025-06-06 15:18:28,245 - DEBUG - Updated reference mean: node=[-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], edge=[ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:18:28,246 - DEBUG - Updated reference std: node=[1.0007    1.0007    1.0007    1.0007    1.0007    1.0007    1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007    1.0007001 1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007   ], edge=[0.5073971 1.7682712 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289]
2025-06-06 15:18:28,246 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:28,246 - INFO - Running anomaly detection...
2025-06-06 15:18:28,246 - INFO - Starting anomaly detection.
2025-06-06 15:18:29,640 - DEBUG - Node reconstruction errors: [5.97726643e-01 5.97726643e-01 8.45320046e-01 5.97726643e-01
 8.45320046e-01 5.97726643e-01 5.97726643e-01 5.97726643e-01
 7.36421585e-01 5.97726643e-01 5.97726643e-01 2.71566963e+00
 7.36421585e-01 5.97726643e-01 5.97726643e-01 5.97726643e-01
 5.97726643e-01 1.04555213e+00 5.97726643e-01 5.97726643e-01
 5.97726643e-01 5.97726643e-01 9.83778000e-01 4.21576798e-01
 4.21576798e-01 4.21576798e-01 4.21576798e-01 4.21576798e-01
 6.36565447e-01 6.36565447e-01 1.70002401e+00 6.36565447e-01
 6.36565447e-01 4.21576798e-01 9.83778000e-01 9.83778000e-01
 9.83778000e-01 4.21576798e-01 6.36565447e-01 4.21576798e-01
 1.04591906e+00 6.36565447e-01 4.21576798e-01 6.36565447e-01
 6.36565447e-01 4.22944307e-01 4.21576798e-01 4.21576798e-01
 2.52624440e+00 4.21576798e-01 4.21576798e-01 4.21576798e-01
 4.21576798e-01 4.21576798e-01 4.21576798e-01 4.21576798e-01
 9.71472800e-01 3.91671270e-01 3.24689895e-01 3.91671270e-01
 3.24689895e-01 3.24689895e-01 3.24689895e-01 3.24689895e-01
 3.24689895e-01 3.24689895e-01 3.24689895e-01 3.24689895e-01
 9.26384985e-01 3.91671270e-01 3.24689895e-01 5.30950665e-01
 9.26384985e-01 3.24689895e-01 3.24689895e-01 3.45550507e-01
 3.24689895e-01 3.95576239e-01 1.01662052e+00 3.45585376e-01
 5.03490329e-01 3.95576239e-01 3.45585376e-01 3.24689895e-01
 3.24689895e-01 3.91671270e-01 3.24689895e-01 3.24689895e-01
 3.24689895e-01 4.21576798e-01 5.49015045e-01 4.21576798e-01
 3.24689895e-01 3.24689895e-01 3.91671270e-01 3.24689895e-01
 3.24689895e-01 3.24689895e-01 3.91671270e-01 3.91671270e-01
 3.24689895e-01 3.24689895e-01 9.26384985e-01 5.30950665e-01
 3.91671270e-01 3.24689895e-01 3.91671270e-01 3.24689895e-01
 3.24689895e-01 3.24689895e-01 5.49015045e-01 9.44639087e-01
 3.91671270e-01 3.91671270e-01 9.67243791e-01 1.19799519e+00
 1.25616097e+00 6.26882970e-01 3.24689895e-01 1.61553657e+00
 9.44639087e-01 1.44579208e+00 1.57479309e+03 9.82140899e-01
 1.48855793e+00 6.58081532e-01 4.61484343e-01 3.62973243e-01
 1.09573138e+00 4.61484343e-01 1.27169263e+00 6.11091435e-01
 4.81942028e-01 3.91504437e-01 5.56141675e-01 5.11629403e-01
 1.07481432e+00 5.41973948e-01 2.63199925e+00 7.53383458e-01
 4.21576798e-01 8.92429173e-01 3.91504437e-01 8.33565176e-01
 4.95823294e-01 1.48855793e+00 1.45149422e+00 4.81942028e-01
 8.29057038e-01 4.53013808e-01 1.08926094e+00 3.24689895e-01
 4.81942028e-01 6.26882970e-01 4.81942028e-01 1.36217203e+01
 1.48855793e+00 4.96648937e-01 7.88787246e-01 2.12623835e+00
 1.48739195e+00 9.79236007e-01 1.29862106e+00 4.56187338e-01
 1.32364502e+01 2.63199925e+00 9.57325757e-01 2.68887520e+00
 9.79236007e-01 3.24689895e-01 1.45281124e+00 5.31535149e-01
 3.75063300e-01 1.38524473e+00 5.41973948e-01 1.52946639e+00
 5.97726643e-01 6.67382996e+02 4.87914443e-01 9.44639087e-01
 4.61484343e-01 4.43963647e-01 1.87912190e+00 1.21344268e+00
 8.32250237e-01 3.24689895e-01 4.56187338e-01 3.91671270e-01
 4.56187338e-01 1.69090414e+00 2.12623835e+00 1.28561914e+00
 1.08926094e+00 1.07481432e+00 1.73318660e+00 3.24689895e-01
 5.67874312e-01 9.98433650e-01 1.05489845e+01 5.28353870e-01
 3.08556485e+00 3.91671270e-01 6.98162854e-01 4.96648937e-01
 3.62973243e-01 1.08926094e+00 9.26384985e-01 1.21344268e+00
 4.02083725e-01 1.10812593e+00 1.21344268e+00 3.91504437e-01
 5.97726643e-01 1.21344268e+00 8.09313059e-01 1.52946639e+00
 6.98162854e-01 4.81942028e-01 1.29862106e+00 3.91671270e-01
 5.56141675e-01 1.67691302e+00 3.91671270e-01 1.45281124e+00
 7.91472614e-01 6.52001023e-01 1.52386427e+00 1.08926094e+00
 1.31653082e+00 1.13327098e+00 4.21576798e-01 4.21576798e-01
 9.47297454e-01 1.29862106e+00 4.81942028e-01 1.69090414e+00
 9.62670863e-01 1.55308867e+00 2.05331641e+03 1.47313585e+01
 1.86918414e+00 6.11091435e-01 1.36224651e+00 1.05753398e+00
 4.21576798e-01 9.26384985e-01 1.16963472e+01 3.24689895e-01
 4.56187338e-01 2.12623835e+00 1.27081394e+00 3.62973243e-01
 3.62973243e-01 1.82438815e+00 4.21576798e-01 4.61484343e-01
 1.62926917e+03 4.85882461e-01 1.45281124e+00 4.03935045e-01
 1.36783075e+00 4.87914443e-01 7.62041748e+02 6.98162854e-01
 1.27795196e+00 5.83517885e+00 1.08304679e+00 4.43963647e-01
 4.03743696e+00 1.87966573e+00 1.05661952e+00 3.24689895e-01
 2.09235549e+00 1.07481432e+00 7.53383458e-01 1.60554266e+00
 7.53383458e-01 5.03490329e-01 9.79236007e-01 6.19013906e-01
 2.12623835e+00 2.12623835e+00 1.69090414e+00 2.12623835e+00
 4.43963647e-01 4.56187338e-01 1.11964655e+00 2.12623835e+00
 3.92059386e-01 1.66112614e+00 2.68887520e+00 4.03935045e-01
 2.12623835e+00 1.50704050e+00 3.51888585e+00 1.87813389e+00
 1.14124596e+00 9.98978078e-01 1.57868230e+00 1.08926094e+00
 5.56141675e-01 6.98162854e-01 9.82140899e-01 1.23730862e+00
 4.87914443e-01 3.91504437e-01 1.43172026e+00 2.61279774e+00
 6.45659302e+02 5.28353870e-01 1.31653082e+00 9.82386649e-01
 9.66452539e-01 2.63199925e+00 1.08926094e+00 1.51242113e+00
 4.56187338e-01 5.55545688e-01 1.52875865e+00 4.81942028e-01
 9.70569193e-01 4.87914443e-01 1.21344268e+00 9.98433650e-01
 8.07403207e-01 3.08419675e-01 3.24689895e-01 5.97726643e-01
 4.56187338e-01 2.12623835e+00 1.45192301e+00 3.91671270e-01
 2.63199925e+00 1.70477676e+00 3.24689895e-01 2.12623835e+00
 1.65238476e+00 1.57256472e+00 9.26384985e-01 2.63199925e+00
 2.63199925e+00 1.27781069e+00 4.94879663e-01 9.82386649e-01
 6.92776859e-01 5.11629403e-01 6.36565447e-01 6.11091435e-01
 9.28782701e-01 3.24689895e-01 2.03923655e+00 4.81942028e-01
 6.26882970e-01 5.97726643e-01 9.73778188e-01 7.19844460e-01
 2.12623835e+00 4.61484343e-01 1.07463372e+00 1.27699685e+00
 1.43878829e+00 6.11091435e-01 1.68052709e+00 9.67243791e-01
 4.61484343e-01 3.92059386e-01 6.92776859e-01 4.87914443e-01
 1.07481432e+00 1.31653082e+00 1.49634874e+00 6.92776859e-01
 6.82632446e-01 3.24689895e-01 8.37984025e-01 1.23781300e+00
 1.31653082e+00 4.43963647e-01 1.30614245e+00 4.21576798e-01
 6.26882970e-01 9.25134659e-01 9.26384985e-01 9.30701733e-01
 4.21576798e-01 9.98433650e-01 6.92864060e-01 5.49015045e-01
 9.26384985e-01 3.24689895e-01 1.08987844e+00 1.70934474e+00
 9.30701733e-01 3.91671270e-01 1.19799519e+00 1.24928761e+00
 1.25926852e+00 7.49924481e-01 9.57325757e-01 1.29862106e+00
 6.37383759e-01 4.21576798e-01 2.41479993e+00 9.82386649e-01
 4.56187338e-01 9.34862316e-01 5.97726643e-01 3.24689895e-01
 9.47297454e-01 1.49634874e+00 3.92059386e-01 6.36565447e-01
 6.98162854e-01 7.28441238e-01 2.08691883e+00 5.81467688e-01
 4.03935045e-01 1.00131299e+03 5.03490329e-01 1.00131299e+03
 1.61976385e+00 1.87966573e+00 4.61484343e-01 1.11964655e+00
 1.19799519e+00 1.11964655e+00 8.61189697e+02 8.52691472e-01
 3.62973243e-01 5.41973948e-01 3.24689895e-01 1.21344268e+00
 4.43963647e-01 1.08926094e+00 9.26384985e-01 4.03935045e-01
 4.95823294e-01 1.05661952e+00 6.92776859e-01 4.03743696e+00
 3.91671270e-01 3.91671270e-01 5.03490329e-01 4.85882461e-01
 5.41973948e-01 9.03981388e-01 1.38882637e+00 5.28353870e-01
 4.76413727e-01 4.85882461e-01 3.10382795e+00 1.43412209e+00
 4.87914443e-01 4.87914443e-01 4.87914443e-01 4.43963647e-01
 3.22033226e-01 1.25616097e+00 4.03935045e-01 4.87914443e-01
 5.56141675e-01 9.08743620e-01 1.69993889e+00 4.87914443e-01
 3.08419675e-01 4.38308001e-01 4.57939655e-01 1.53285635e+00
 1.32442808e+00 1.07481432e+00 1.56506956e+00 9.98978078e-01
 1.07481432e+00 1.07481432e+00 6.82632446e-01 1.07463372e+00
 1.43352413e+00 1.29862106e+00 1.43352413e+00 8.54852796e-01
 1.27081394e+00 4.08509521e+01 3.24689895e-01 4.56187338e-01
 1.07481432e+00 1.44579208e+00 6.40087306e-01 3.48838001e-01
 1.27561605e+00 1.07481432e+00 4.76413727e-01 3.62973243e-01
 9.25134659e-01 1.29091418e+00 1.07481432e+00 9.23328876e-01
 4.40429837e-01 8.07403207e-01 1.07481432e+00 9.82140899e-01
 3.62973243e-01 3.48838001e-01 1.84183121e+00 1.83917141e+00
 3.91504437e-01 3.24689895e-01 7.85987914e-01 1.07481432e+00
 4.87914443e-01 8.73495817e-01 1.07481432e+00 2.63199925e+00
 4.03935045e-01 1.07481432e+00 1.07463372e+00 3.24689895e-01
 1.50716496e+00 1.34339476e+00 3.08419675e-01 4.40429837e-01
 4.56187338e-01 1.08926094e+00 1.07463372e+00 4.57939655e-01
 8.85670424e-01 9.79236007e-01 1.23291838e+00 4.40429837e-01
 4.43963647e-01 4.87914443e-01 9.26384985e-01 6.36565447e-01
 1.69090414e+00 1.52431607e+00 4.38308001e-01 5.97726643e-01
 1.21344268e+00 4.43963647e-01 6.82632446e-01 4.02083725e-01
 3.91671270e-01 3.62973243e-01 4.53013808e-01 5.41973948e-01
 3.62973243e-01 3.62973243e-01 5.97726643e-01 3.62973243e-01
 9.26384985e-01 8.09313059e-01 1.07463372e+00 9.34862316e-01
 3.25356245e-01 3.24689895e-01 1.66112614e+00 3.91504437e-01
 5.57170451e-01 5.03490329e-01 1.07463372e+00 9.26384985e-01
 3.24689895e-01 3.62973243e-01 3.91671270e-01 1.45149422e+00
 9.82140899e-01 3.24689895e-01 1.28561914e+00 3.62973243e-01
 9.82140899e-01 9.14690912e-01 4.46835458e-01 1.05321825e+00
 8.86317730e-01 4.85882461e-01 5.30950665e-01 3.62973243e-01
 3.62973243e-01 1.09807169e+00 1.00014844e+03 9.82140899e-01
 3.91671270e-01 9.82140899e-01 4.43963647e-01 1.28561914e+00
 1.46557653e+00 1.25926852e+00 3.22033226e-01 6.98162854e-01
 9.55639780e-01 1.28561914e+00 9.82140899e-01 5.03490329e-01
 3.91671270e-01 3.91504437e-01 8.99993002e-01 9.25134659e-01
 1.58000565e+00 3.62973243e-01 3.62973243e-01 6.40087306e-01
 4.50617135e-01 4.87914443e-01 9.30701733e-01 1.46365190e+00
 9.25134659e-01 9.14690912e-01 9.30701733e-01 1.24217856e+00
 1.45114183e+00 4.50617135e-01 3.04412103e+00 9.30701733e-01
 3.62973243e-01 9.26384985e-01 3.24689895e-01 9.25134659e-01
 3.24689895e-01 9.82140899e-01 1.50704050e+00 3.92059386e-01
 4.21576798e-01 1.65238476e+00 3.24689895e-01 3.24689895e-01
 3.08419675e-01 1.65238476e+00 4.43963647e-01 4.43963647e-01
 1.83514988e+00 4.43963647e-01 9.25134659e-01 1.19799519e+00
 9.03981388e-01 3.62973243e-01 6.27268136e-01 3.53062367e+00
 1.45114183e+00 4.85882461e-01 1.45149422e+00 1.08926094e+00
 4.85882461e-01 9.03981388e-01 9.03981388e-01 3.08419675e-01
 6.27268136e-01 3.92059386e-01 9.25134659e-01 3.08419675e-01
 4.85882461e-01 4.02083725e-01 9.25134659e-01 6.27268136e-01
 4.50617135e-01 3.08419675e-01 3.92059386e-01 1.16220593e+00
 3.08419675e-01 3.24689895e-01 3.24689895e-01 4.21576798e-01
 3.08419675e-01 4.53013808e-01 3.22033226e-01 4.85882461e-01
 9.25134659e-01 1.23781300e+00 9.25134659e-01 2.12623835e+00
 4.85882461e-01 3.22033226e-01 3.92059386e-01 3.24689895e-01
 4.85882461e-01 3.24689895e-01 3.24689895e-01 6.98162854e-01
 3.24689895e-01 6.32533908e-01 3.08419675e-01 4.85882461e-01
 4.43963647e-01 5.41973948e-01 9.30701733e-01 3.08419675e-01
 1.23730862e+00 3.22033226e-01 5.97726643e-01 6.52001023e-01
 5.03490329e-01 1.87966573e+00 4.94879663e-01 4.94879663e-01
 6.26528561e-01 3.24689895e-01 5.03490329e-01 3.24689895e-01
 9.26384985e-01 9.26384985e-01 9.26384985e-01 9.26384985e-01
 3.14652896e+00 3.24689895e-01 5.30950665e-01 5.03490329e-01
 3.24689895e-01 5.03490329e-01 6.52001023e-01 1.24217856e+00
 9.26384985e-01 3.91671270e-01 1.56939294e+03 3.91671270e-01
 1.04555213e+00 6.29639149e-01 3.91671270e-01]
2025-06-06 15:18:29,641 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:18:29,883 - ERROR - An error occurred while processing file nw_graph_encoded_1749044828.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:29,884 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:29,884 - INFO - 
--- Processing file: nw_graph_encoded_1749044888.dot ---
2025-06-06 15:18:29,884 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot
2025-06-06 15:18:29,884 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot file.
2025-06-06 15:18:29,911 - INFO - Parsed 731 nodes.
2025-06-06 15:18:29,934 - INFO - Parsed 1560 edges.
2025-06-06 15:18:30,436 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:30,436 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:30,443 - DEBUG - Initial node features tensor shape: torch.Size([731, 19])
2025-06-06 15:18:30,453 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:30,476 - DEBUG - Node features tensor shape after scaling: torch.Size([731, 19])
2025-06-06 15:18:30,478 - DEBUG - Edge index tensor shape: torch.Size([2, 1560])
2025-06-06 15:18:30,478 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:30,502 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:30,503 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:30,505 - DEBUG - Shape of encoded categorical edge features: torch.Size([1560, 2])
2025-06-06 15:18:30,507 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:30,507 - DEBUG - Shape of scaled numerical edge features: torch.Size([1560, 20])
2025-06-06 15:18:30,507 - DEBUG - Final edge attributes tensor shape: torch.Size([1560, 22])
2025-06-06 15:18:30,508 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:30,508 - INFO - Performing online update...
2025-06-06 15:18:30,508 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:30,509 - DEBUG - Updated RunningStats: new_mean=[ 4.21596867e-10 -4.78270318e-10 -2.86142096e-09  2.21786203e-09
 -2.49993415e-08  1.36084709e-08 -9.47603601e-09 -2.27993151e-09
 -2.91603146e-09  1.04235589e-09  1.61878876e-09 -1.46125007e-09
  3.64336607e-09 -3.27011258e-09  8.89402309e-10  7.08560109e-10
 -3.79999919e-09  1.11297102e-09 -4.56389426e-09], new_M2=[199260.00527184 199260.00522611 199260.0002512  199260.00438155
 199259.998439   199259.99839187 199259.99592639 199259.99812856
 199259.99322536 199259.99845744 199260.00185318 199259.99395455
 199259.9927934  159468.99669201 159469.00005758 159468.99887091
 159469.0000247  199260.0002367  199260.00768573], new_n=199260
2025-06-06 15:18:30,509 - DEBUG - Updated RunningStats: new_mean=[ 1.41483277e+00  5.48439025e+00  1.08549227e-10  2.48660551e-10
  1.43260413e-10 -1.58959669e-10 -1.25036672e-09  2.01022527e-10
  2.92818722e-10 -1.77554535e-10  2.98740299e-10 -3.44613645e-09
 -8.53664847e-10  2.64103271e-10  2.85119006e-10 -1.47386880e-10
 -1.47386880e-10 -1.47386880e-10 -1.47386880e-10 -1.47386880e-10
 -1.47386880e-10 -8.22412419e-11], new_M2=[ 110307.68447103 1908790.13320122  428321.99902323  428322.00584481
  428322.00578603  428321.99325245  428322.00037946  428321.99913042
  428322.00165154  428321.99929705  428321.99400441  428322.00862453
  428322.00109819  428321.99988972  428322.00188027  428321.99460491
  428321.99460491  428321.99460491  428321.99460491  428321.99460491
  428321.99460491  428321.99896042], new_n=428322
2025-06-06 15:18:30,510 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.8945983  0.89459831 0.8945983  0.89459831 1.
 1.00000002]
2025-06-06 15:18:30,510 - DEBUG - Calculated standard deviation: [0.50747855 2.11102754 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:30,510 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:30,510 - DEBUG - Online update step: 1/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 2/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 3/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 4/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 5/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 6/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,510 - DEBUG - Online update step: 7/50
2025-06-06 15:18:30,510 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 8/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 9/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 10/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 11/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 12/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 13/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 14/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 15/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 16/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 17/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 18/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 19/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 20/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,511 - DEBUG - Online update step: 21/50
2025-06-06 15:18:30,511 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 22/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 23/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 24/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 25/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 26/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 27/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 28/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 29/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 30/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 31/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 32/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 33/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 34/50
2025-06-06 15:18:30,512 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,512 - DEBUG - Online update step: 35/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 36/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 37/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 38/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 39/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 40/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 41/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 42/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 43/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 44/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 45/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 46/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 47/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 48/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 49/50
2025-06-06 15:18:30,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,513 - DEBUG - Online update step: 50/50
2025-06-06 15:18:30,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:30,514 - WARNING - No successful steps during online update.
2025-06-06 15:18:30,529 - DEBUG - Current node mean: [ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], current edge mean: [ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:18:30,530 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2392
2025-06-06 15:18:30,530 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:18:30,530 - DEBUG - Updated reference mean: node=[ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], edge=[ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:18:30,530 - DEBUG - Updated reference std: node=[1.0006847 1.0006847 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847], edge=[0.50758785 1.7720196  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207 ]
2025-06-06 15:18:30,530 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:30,530 - INFO - Running anomaly detection...
2025-06-06 15:18:30,531 - INFO - Starting anomaly detection.
2025-06-06 15:18:31,742 - DEBUG - Node reconstruction errors: [2.13640189e+00 9.55065979e+02 9.95325387e-01 7.44160175e-01
 7.44160175e-01 1.01330221e+00 7.44160175e-01 1.01330221e+00
 1.01330221e+00 5.31852782e-01 5.31852782e-01 7.69594431e-01
 5.31852782e-01 7.69594431e-01 5.31852782e-01 5.31852782e-01
 5.31852782e-01 6.53028250e-01 5.31852782e-01 5.31852782e-01
 2.65760207e+00 6.53028250e-01 1.05255544e+00 5.31852782e-01
 5.31852782e-01 5.31852782e-01 1.01139784e+00 5.31852782e-01
 5.31852782e-01 5.31852782e-01 1.05255544e+00 9.54691052e-01
 3.85829836e-01 3.85829836e-01 3.85829836e-01 3.85829836e-01
 1.01330221e+00 3.85829836e-01 5.87385416e-01 5.87385416e-01
 1.65514219e+00 5.87385416e-01 5.87385416e-01 3.85829836e-01
 1.60710883e+00 9.54691052e-01 9.54691052e-01 3.85829836e-01
 5.87385416e-01 3.85829836e-01 9.94080782e-01 5.87385416e-01
 3.85829836e-01 5.87385416e-01 5.87385416e-01 3.96263361e-01
 3.85829836e-01 3.85829836e-01 2.49263835e+00 3.85829836e-01
 3.85829836e-01 3.85829836e-01 3.85829836e-01 3.85829836e-01
 3.85829836e-01 3.85829836e-01 9.55248058e-01 3.62044901e-01
 3.13393861e-01 3.62044901e-01 3.13393861e-01 3.13393861e-01
 7.44160235e-01 3.13393831e-01 3.13393861e-01 3.13393861e-01
 3.13393861e-01 3.13393861e-01 3.13393861e-01 9.13750887e-01
 3.62044901e-01 3.13393861e-01 4.78027910e-01 9.13750887e-01
 3.13393861e-01 3.13393861e-01 3.34527165e-01 3.13393861e-01
 3.72188568e-01 9.66634452e-01 3.34545851e-01 4.79210287e-01
 3.72188568e-01 3.34545851e-01 3.13393861e-01 3.13393861e-01
 3.62044901e-01 3.13393861e-01 3.13393861e-01 3.13393861e-01
 3.85829836e-01 9.00515497e-01 3.85829836e-01 3.13393861e-01
 3.13393861e-01 3.62044901e-01 3.13393861e-01 3.13393861e-01
 3.13393861e-01 3.62044901e-01 3.62044901e-01 3.13393861e-01
 3.13393861e-01 9.13750887e-01 4.78027910e-01 3.62044901e-01
 3.13393861e-01 3.62044901e-01 3.13393861e-01 3.13393861e-01
 3.13393861e-01 5.13069689e-01 9.20327842e-01 3.62044901e-01
 3.62044901e-01 9.32049811e-01 1.20400774e+00 1.26451409e+00
 6.01289034e-01 3.13393861e-01 1.62254083e+00 9.20327842e-01
 1.43813670e+00 1.62389746e+03 7.44160175e-01 9.90487933e-01
 1.46190178e+00 6.69926167e-01 4.65858161e-01 3.72630298e-01
 1.09583521e+00 4.65858161e-01 1.46486497e+00 5.78065753e-01
 4.92718637e-01 3.95122051e-01 5.69913685e-01 5.01444042e-01
 1.08442593e+00 5.30954897e-01 2.53534651e+00 7.08536923e-01
 3.85829836e-01 1.00354946e+00 3.95122051e-01 8.25761557e-01
 1.03365183e+00 1.63926148e+00 1.46037066e+00 4.92718637e-01
 8.24417114e-01 4.38019544e-01 1.09990501e+00 3.13393861e-01
 4.92718637e-01 6.01289034e-01 4.92718637e-01 1.30486403e+01
 1.46190178e+00 4.99416113e-01 7.15952933e-01 2.06152797e+00
 1.46328223e+00 9.90227342e-01 1.26459241e+00 7.44160175e-01
 4.69990939e-01 1.27197084e+01 2.53534651e+00 1.00711536e+00
 1.78773355e+00 9.90227342e-01 3.13393861e-01 1.44334972e+00
 4.99450475e-01 3.84391934e-01 1.33941305e+00 5.30954897e-01
 1.49747646e+00 5.31852782e-01 6.68352905e+02 5.02386689e-01
 9.20327842e-01 4.65858161e-01 4.34597015e-01 1.86929822e+00
 1.22408414e+00 7.44160175e-01 3.13393861e-01 4.69990939e-01
 3.62044901e-01 4.69990939e-01 1.65480494e+00 2.06152797e+00
 1.25413871e+00 1.09990501e+00 1.02750337e+00 1.71690249e+00
 3.13393861e-01 5.68307340e-01 1.00520563e+00 1.02033110e+01
 5.31799316e-01 3.06684160e+00 3.62044901e-01 7.09570825e-01
 4.99416113e-01 3.72630298e-01 1.09990501e+00 9.13751006e-01
 1.22408414e+00 3.88966858e-01 1.22421944e+00 1.22408414e+00
 3.95122051e-01 5.31852782e-01 1.22408414e+00 7.73531973e-01
 1.49747646e+00 7.09570825e-01 4.92718637e-01 1.26459241e+00
 3.62044901e-01 5.69913566e-01 1.65499532e+00 3.62044901e-01
 1.44334972e+00 8.01014841e-01 5.96684933e-01 1.49016905e+00
 1.09990501e+00 1.30255282e+00 1.09114397e+00 3.85829836e-01
 3.85829836e-01 9.52060401e-01 1.26459241e+00 4.92718637e-01
 1.65480494e+00 9.33237791e-01 1.52518082e+00 2.10006592e+03
 1.44776707e+01 1.85218871e+00 5.78065753e-01 1.36863232e+00
 1.04637909e+00 3.85829836e-01 9.13750887e-01 1.13049345e+01
 3.13393861e-01 4.69990939e-01 2.06152797e+00 1.23956180e+00
 3.72630298e-01 3.72630298e-01 1.78272974e+00 3.85829836e-01
 4.65858161e-01 1.67051147e+03 4.49933499e-01 1.44334972e+00
 4.15077150e-01 1.30828261e+00 5.02386689e-01 7.95451355e+02
 7.09570825e-01 1.01330221e+00 1.28095174e+00 5.81123686e+00
 1.06061900e+00 4.34597015e-01 3.90235257e+00 1.42677915e+00
 1.02640414e+00 3.13393861e-01 2.07269835e+00 1.08442593e+00
 7.08536923e-01 1.57713664e+00 7.08536923e-01 4.79210287e-01
 9.90227342e-01 5.59165239e-01 2.06152821e+00 2.06152821e+00
 1.65480494e+00 2.06152797e+00 4.34597015e-01 4.69990939e-01
 1.12867880e+00 2.06152797e+00 3.70073318e-01 1.65234721e+00
 2.64236283e+00 4.15077150e-01 2.06152797e+00 1.51676524e+00
 3.42253160e+00 1.86152828e+00 1.07045460e+00 9.67546880e-01
 1.54981387e+00 1.09990501e+00 5.69913566e-01 7.09570825e-01
 9.75520909e-01 1.23703313e+00 5.02386689e-01 3.95122051e-01
 1.38563251e+00 2.60998344e+00 6.43689453e+02 5.31799316e-01
 1.30255282e+00 9.85043049e-01 9.21022117e-01 2.53534651e+00
 1.09990501e+00 1.47523892e+00 4.69990939e-01 5.68729579e-01
 9.95325387e-01 1.47564566e+00 4.92718637e-01 9.46418345e-01
 5.02386689e-01 1.22408414e+00 1.00520563e+00 7.36923337e-01
 7.12162554e-01 3.13393861e-01 5.31852782e-01 4.69990939e-01
 2.06152797e+00 1.44848752e+00 3.62044901e-01 2.53534651e+00
 1.65362597e+00 3.13393861e-01 2.06152797e+00 1.63082600e+00
 1.54423690e+00 9.13750887e-01 2.53534651e+00 2.53534651e+00
 1.36866999e+00 4.54661965e-01 9.85043049e-01 6.85021222e-01
 5.01444042e-01 9.94080782e-01 5.78065753e-01 9.21974778e-01
 3.13393861e-01 2.01787114e+00 4.92718697e-01 6.01288855e-01
 5.31852841e-01 9.57749546e-01 6.59333587e-01 2.06152797e+00
 4.65858161e-01 1.08329618e+00 1.41985846e+00 1.39213562e+00
 5.78065753e-01 1.64266801e+00 9.32049811e-01 4.65858161e-01
 3.70073318e-01 6.85021222e-01 5.02386689e-01 1.08442593e+00
 1.30255282e+00 1.49737215e+00 6.85021222e-01 6.37602448e-01
 3.13393861e-01 1.06640720e+00 1.22686732e+00 1.30255282e+00
 4.34597015e-01 1.31205893e+00 3.85829836e-01 6.01289034e-01
 9.27948117e-01 1.05380976e+00 9.05969203e-01 3.85829836e-01
 1.00520563e+00 6.92425311e-01 5.13069689e-01 9.13750887e-01
 3.13393861e-01 1.08270776e+00 1.66957247e+00 9.05969203e-01
 3.62044901e-01 1.20400774e+00 1.23970890e+00 1.24489677e+00
 1.44517088e+00 1.00711536e+00 1.26459241e+00 6.22462332e-01
 3.85829836e-01 2.38411546e+00 9.85043049e-01 4.69990939e-01
 9.11804318e-01 5.31852782e-01 3.13393861e-01 9.52060401e-01
 1.49737215e+00 3.70073318e-01 5.87385416e-01 7.09570825e-01
 9.53160346e-01 2.06520700e+00 5.84031463e-01 4.15077150e-01
 9.48213623e+02 4.79210287e-01 9.48213623e+02 1.62391663e+00
 1.86183250e+00 4.65858161e-01 1.12867880e+00 1.20400774e+00
 1.12867880e+00 8.87933716e+02 8.02884221e-01 3.72630268e-01
 5.30954897e-01 3.13393861e-01 1.22408414e+00 4.34597015e-01
 1.09990501e+00 9.13750887e-01 4.15077150e-01 4.93725717e-01
 1.02640414e+00 6.85021222e-01 3.90235257e+00 3.62044901e-01
 3.62044901e-01 4.79210287e-01 4.49933499e-01 5.30954897e-01
 8.91923785e-01 1.34133685e+00 5.31799316e-01 4.64782059e-01
 4.49933499e-01 3.08987951e+00 1.41686189e+00 5.02386689e-01
 5.02386689e-01 5.02386689e-01 4.34597015e-01 3.15269977e-01
 1.26451409e+00 4.15077150e-01 5.02386689e-01 5.69913566e-01
 9.03700769e-01 1.68839884e+00 5.02386689e-01 3.13847303e-01
 4.36353236e-01 4.61957872e-01 1.49575615e+00 1.29030871e+00
 1.08442593e+00 1.56309891e+00 9.67546880e-01 1.08442593e+00
 1.08442593e+00 7.86021113e-01 1.08329618e+00 1.43288791e+00
 1.26459241e+00 1.43288791e+00 7.86021113e-01 1.23956180e+00
 4.12398567e+01 3.13393861e-01 4.69990939e-01 1.08442593e+00
 1.43813670e+00 5.95089734e-01 3.45400900e-01 1.25392413e+00
 1.08442593e+00 4.64782059e-01 3.72630298e-01 9.27948117e-01
 1.28349316e+00 1.08442593e+00 9.28006530e-01 4.30130392e-01
 7.36923337e-01 1.08442593e+00 9.90487933e-01 3.72630298e-01
 3.45400870e-01 1.82070899e+00 1.80586505e+00 3.95122051e-01
 3.13393861e-01 7.64324129e-01 1.08442593e+00 5.02386689e-01
 8.50194037e-01 1.08442593e+00 2.53534651e+00 4.15077150e-01
 1.08442593e+00 1.08329618e+00 3.13393861e-01 1.51189005e+00
 1.30259633e+00 3.13847303e-01 4.30130392e-01 4.69990939e-01
 1.09990501e+00 1.08329618e+00 4.61957872e-01 8.31799805e-01
 9.90227342e-01 1.22115803e+00 4.30130392e-01 4.34597015e-01
 5.02386689e-01 9.13750887e-01 9.94080782e-01 1.65480494e+00
 1.52454531e+00 4.36353236e-01 5.31852782e-01 1.22408414e+00
 4.34597015e-01 7.86021113e-01 3.88966888e-01 3.62044901e-01
 3.72630298e-01 4.38019544e-01 5.30954897e-01 3.72630298e-01
 3.72630298e-01 5.31852782e-01 3.72630298e-01 9.13750887e-01
 7.73531973e-01 1.08329618e+00 9.11804318e-01 3.32189232e-01
 3.13393861e-01 1.65234721e+00 3.95122051e-01 5.34115493e-01
 4.79210287e-01 1.08329618e+00 9.13750887e-01 3.13393861e-01
 3.72630298e-01 3.62044901e-01 1.43129396e+00 9.90487933e-01
 3.13393861e-01 1.25413871e+00 3.72630298e-01 9.90487933e-01
 9.17115271e-01 4.33825254e-01 1.00711536e+00 1.12866390e+00
 4.49933499e-01 4.78027910e-01 3.72630268e-01 3.72630268e-01
 1.04873860e+00 9.44600220e+02 1.00518572e+00 3.62044901e-01
 9.90487933e-01 4.34597015e-01 1.25413871e+00 1.44473362e+00
 1.24489677e+00 3.15269977e-01 7.09570825e-01 9.14135396e-01
 1.25413871e+00 9.90487933e-01 4.79210287e-01 3.62044901e-01
 3.95122051e-01 8.91121626e-01 9.27948117e-01 1.55288470e+00
 3.72630298e-01 3.72630298e-01 5.95089734e-01 4.51439261e-01
 5.02386689e-01 9.05969203e-01 1.44480979e+00 9.27948117e-01
 9.17115271e-01 9.05969203e-01 1.24027073e+00 1.44539618e+00
 4.51439261e-01 3.03985262e+00 9.05969203e-01 3.72630298e-01
 9.13750887e-01 3.13393861e-01 9.27948117e-01 3.13393861e-01
 9.90487933e-01 1.51676524e+00 3.70073318e-01 3.85829836e-01
 1.63082600e+00 3.13393861e-01 3.13393861e-01 3.13847303e-01
 1.63082600e+00 4.34597015e-01 4.34597015e-01 1.83540964e+00
 4.34597015e-01 9.27948117e-01 1.20400774e+00 8.91923785e-01
 3.72630298e-01 5.76376736e-01 3.61090016e+00 1.44539618e+00
 4.49933499e-01 1.46037066e+00 1.09990501e+00 4.49933499e-01
 8.91923785e-01 8.91923785e-01 3.13847303e-01 5.76376736e-01
 7.44160175e-01 3.70073318e-01 9.27948117e-01 3.13847303e-01
 4.49933618e-01 3.88966858e-01 9.27948117e-01 5.76376736e-01
 4.51439261e-01 3.13847303e-01 5.59165239e-01 1.14311123e+00
 3.13847303e-01 3.13393861e-01 3.13393861e-01 3.85829836e-01
 3.13847303e-01 4.38019544e-01 3.15269977e-01 4.49933499e-01
 9.27948117e-01 1.22686732e+00 9.27948117e-01 2.06152797e+00
 4.49933499e-01 3.15269977e-01 3.70073318e-01 3.13393861e-01
 4.49933499e-01 3.13393861e-01 3.13393861e-01 7.09570825e-01
 3.13393861e-01 6.35928512e-01 3.13847303e-01 4.49933499e-01
 4.34597015e-01 5.30954897e-01 9.05969203e-01 5.59165239e-01
 1.23703313e+00 3.15269977e-01 5.31852782e-01 5.96684933e-01
 4.79210287e-01 1.86183250e+00 4.54661965e-01 4.54661965e-01
 5.67940116e-01 3.13393861e-01 4.79210287e-01 3.13393861e-01
 9.13750887e-01 9.13750887e-01 9.13750887e-01 9.13750887e-01
 3.16535711e+00 3.13393861e-01 4.78027910e-01 4.79210287e-01
 3.13393861e-01 4.79210287e-01 9.00515497e-01 1.24027073e+00
 9.13750887e-01 3.62044901e-01 1.61598706e+03 3.62044901e-01
 1.01139784e+00 6.11151934e-01 3.62044811e-01]
2025-06-06 15:18:31,746 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:18:32,001 - ERROR - An error occurred while processing file nw_graph_encoded_1749044888.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:32,002 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:32,002 - INFO - 
--- Processing file: nw_graph_encoded_1749044948.dot ---
2025-06-06 15:18:32,002 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot
2025-06-06 15:18:32,002 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot file.
2025-06-06 15:18:32,032 - INFO - Parsed 762 nodes.
2025-06-06 15:18:32,054 - INFO - Parsed 1622 edges.
2025-06-06 15:18:32,709 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:32,710 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:32,716 - DEBUG - Initial node features tensor shape: torch.Size([762, 19])
2025-06-06 15:18:32,725 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:32,734 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 19])
2025-06-06 15:18:32,735 - DEBUG - Edge index tensor shape: torch.Size([2, 1622])
2025-06-06 15:18:32,735 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:32,760 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:32,761 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:32,763 - DEBUG - Shape of encoded categorical edge features: torch.Size([1622, 2])
2025-06-06 15:18:32,770 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:32,770 - DEBUG - Shape of scaled numerical edge features: torch.Size([1622, 20])
2025-06-06 15:18:32,771 - DEBUG - Final edge attributes tensor shape: torch.Size([1622, 22])
2025-06-06 15:18:32,771 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:32,771 - INFO - Performing online update...
2025-06-06 15:18:32,771 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:32,773 - DEBUG - Updated RunningStats: new_mean=[ 4.00472385e-10 -4.56929934e-10 -2.84098445e-09  2.19466238e-09
 -2.48433144e-08  1.35225084e-08 -9.40447543e-09 -2.29791607e-09
 -2.89803157e-09  1.04315280e-09  1.55183180e-09 -1.46633648e-09
  3.60877603e-09 -3.28055353e-09  8.70956229e-10  7.38937732e-10
 -3.79863436e-09  1.11487712e-09 -4.52900079e-09], new_M2=[200022.00522103 200022.00517529 200022.0002218  200022.00436179
 200021.99846875 200021.99841832 200021.9959909  200021.99809398
 200021.99326128 200021.99846858 200022.00183043 200021.99391958
 200021.99284829 160230.99668057 160231.00008639 160230.99890008
 160231.00001859 200022.00022902 200022.00765044], new_n=200022
2025-06-06 15:18:32,774 - DEBUG - Updated RunningStats: new_mean=[ 1.41484938e+00  5.48247911e+00  1.10403968e-10  2.52876402e-10
  1.47594665e-10 -1.60519360e-10 -1.22935929e-09  2.12867507e-10
  2.87172166e-10 -1.62112104e-10  2.98488400e-10 -3.41592519e-09
 -8.54193928e-10  2.30424070e-10  2.71282590e-10 -1.47526726e-10
 -1.47526726e-10 -1.47526726e-10 -1.47526726e-10 -1.47526726e-10
 -1.47526726e-10 -8.48165182e-11], new_M2=[ 110722.63564557 1914362.01516247  429943.99902448  429944.00595869
  429944.0059016   429943.99316995  429944.00037434  429943.99915598
  429944.00167458  429943.99928363  429943.99406877  429944.00857441
  429944.00111087  429943.9998953   429944.00183483  429943.99457136
  429943.99457136  429943.99457136  429943.99457136  429943.99457136
  429943.99457136  429943.99889388], new_n=429944
2025-06-06 15:18:32,774 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89502339 0.8950234  0.89502339 0.8950234  1.
 1.00000002]
2025-06-06 15:18:32,774 - DEBUG - Calculated standard deviation: [0.50747221 2.11011482 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:32,774 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:32,774 - DEBUG - Online update step: 1/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 2/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 3/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 4/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 5/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 6/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 7/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 8/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 9/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 10/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 11/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 12/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 13/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 14/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,775 - DEBUG - Online update step: 15/50
2025-06-06 15:18:32,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 16/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 17/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 18/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 19/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 20/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 21/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 22/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 23/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 24/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 25/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 26/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 27/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 28/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 29/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,776 - DEBUG - Online update step: 30/50
2025-06-06 15:18:32,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 31/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 32/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 33/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 34/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 35/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 36/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 37/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 38/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 39/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 40/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 41/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 42/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 43/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 44/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 45/50
2025-06-06 15:18:32,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,777 - DEBUG - Online update step: 46/50
2025-06-06 15:18:32,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,778 - DEBUG - Online update step: 47/50
2025-06-06 15:18:32,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,778 - DEBUG - Online update step: 48/50
2025-06-06 15:18:32,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,778 - DEBUG - Online update step: 49/50
2025-06-06 15:18:32,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,778 - DEBUG - Online update step: 50/50
2025-06-06 15:18:32,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:32,778 - WARNING - No successful steps during online update.
2025-06-06 15:18:32,792 - DEBUG - Current node mean: [-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], current edge mean: [ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:18:32,792 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2392
2025-06-06 15:18:32,792 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:18:32,793 - DEBUG - Updated reference mean: node=[-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], edge=[ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:18:32,793 - DEBUG - Updated reference std: node=[1.0006567 1.0006567 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568], edge=[0.5059302 1.7836741 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084]
2025-06-06 15:18:32,793 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:32,793 - INFO - Running anomaly detection...
2025-06-06 15:18:32,793 - INFO - Starting anomaly detection.
2025-06-06 15:18:33,281 - DEBUG - Node reconstruction errors: [1.03961539e+00 1.03961539e+00 1.03961539e+00 8.02324533e-01
 8.02324533e-01 1.19679272e+00 8.02324533e-01 8.02324533e-01
 8.02324533e-01 8.02324533e-01 8.02324533e-01 8.02324533e-01
 8.02324533e-01 8.02324533e-01 1.08441257e+00 8.02324533e-01
 8.02324533e-01 8.02324533e-01 2.02625132e+00 9.89641663e+02
 8.02324533e-01 7.07451344e-01 5.94377518e-01 1.18316984e+00
 5.94377518e-01 8.44871104e-01 1.18316984e+00 4.38462555e-01
 4.38462555e-01 6.57039225e-01 4.38462555e-01 6.57039225e-01
 4.38462555e-01 8.02324533e-01 4.38462555e-01 4.38462555e-01
 5.31878769e-01 4.38462555e-01 4.38462555e-01 2.70474052e+00
 6.46826446e-01 1.66007185e+00 4.38462555e-01 4.38462555e-01
 4.38462555e-01 9.85414028e-01 4.38462555e-01 4.38462555e-01
 8.02324533e-01 4.38462555e-01 9.92659330e-01 9.37923849e-01
 3.43260795e-01 3.43260795e-01 3.43260795e-01 6.00205541e-01
 8.44871104e-01 3.43260795e-01 5.27934134e-01 5.27934134e-01
 8.02324533e-01 1.68957937e+00 5.27934134e-01 5.27934134e-01
 3.43260795e-01 1.52576733e+00 9.37923849e-01 9.37923849e-01
 3.43260795e-01 5.27934134e-01 3.43260795e-01 9.48951125e-01
 5.27934134e-01 6.00205541e-01 5.27934134e-01 5.27934134e-01
 3.57955396e-01 3.43260795e-01 3.43260795e-01 2.44562697e+00
 3.43260795e-01 3.43260795e-01 3.43260795e-01 3.43260795e-01
 3.43260795e-01 3.43260795e-01 3.43260795e-01 9.56805408e-01
 5.83731472e-01 3.04748744e-01 3.27735007e-01 3.04748744e-01
 3.04748744e-01 5.94377518e-01 3.04748744e-01 3.04748744e-01
 3.04748744e-01 3.04748744e-01 3.04748744e-01 3.04748744e-01
 9.22741532e-01 3.27735007e-01 3.04748744e-01 4.03347731e-01
 9.22741532e-01 3.04748744e-01 7.42960155e-01 3.29447865e-01
 3.04748744e-01 3.45437229e-01 9.84227717e-01 3.29467207e-01
 4.55350876e-01 3.45437229e-01 3.29467207e-01 3.04748744e-01
 3.04748744e-01 3.27735007e-01 3.04748744e-01 3.04748744e-01
 5.83731472e-01 3.43260795e-01 7.42960155e-01 3.43260795e-01
 3.04748744e-01 8.02324533e-01 3.04748744e-01 3.27735007e-01
 3.04748744e-01 3.04748744e-01 3.04748744e-01 5.83731472e-01
 3.27735007e-01 3.04748744e-01 3.04748744e-01 9.22741532e-01
 4.03347731e-01 3.27735007e-01 3.04748744e-01 3.27735007e-01
 3.04748744e-01 3.04748744e-01 3.04748744e-01 4.71221715e-01
 9.10758197e-01 3.27735007e-01 3.27735007e-01 8.99198651e-01
 1.21927428e+00 1.27798355e+00 5.68270385e-01 5.83731472e-01
 1.66166115e+00 9.10758197e-01 1.51235509e+00 1.68404260e+03
 5.94377518e-01 1.02265871e+00 8.02324533e-01 1.45519245e+00
 6.77597761e-01 4.67001826e-01 3.91882896e-01 1.09788954e+00
 4.67001826e-01 1.47428679e+00 5.30622125e-01 5.08792341e-01
 3.98448706e-01 5.84257364e-01 4.84686613e-01 1.10913861e+00
 9.01838601e-01 2.29452586e+00 6.44688368e-01 3.43260795e-01
 1.13689482e+00 3.98448706e-01 8.31003964e-01 9.01838601e-01
 1.66036165e+00 1.43960094e+00 5.08792341e-01 8.25214088e-01
 4.24285382e-01 1.12432694e+00 3.04748744e-01 5.08792341e-01
 5.68270385e-01 5.08792341e-01 1.32608414e+01 1.45519245e+00
 5.12180448e-01 7.45574772e-01 1.89499140e+00 1.51055050e+00
 1.01801133e+00 1.23943102e+00 5.94377518e-01 4.81156200e-01
 1.27928858e+01 2.29452586e+00 9.53130543e-01 1.79147637e+00
 1.01801133e+00 3.04748744e-01 1.45254588e+00 4.58449930e-01
 3.98632675e-01 1.36662185e+00 9.01838601e-01 1.47960520e+00
 4.38462555e-01 6.93217834e+02 5.17982304e-01 9.10758197e-01
 4.67001826e-01 4.31679368e-01 1.89549994e+00 1.24130094e+00
 5.94377518e-01 3.04748744e-01 4.81156200e-01 3.27735007e-01
 4.81156200e-01 1.54548419e+00 1.89499140e+00 1.23318851e+00
 1.12432694e+00 1.44924581e+00 1.79363251e+00 5.83731472e-01
 5.60962439e-01 1.02959764e+00 1.05557308e+01 5.41436017e-01
 3.07528114e+00 3.27735007e-01 7.08730221e-01 5.12180448e-01
 3.91882896e-01 1.12432694e+00 9.22741532e-01 1.24130094e+00
 3.71268839e-01 1.10135937e+00 1.24130094e+00 3.98448706e-01
 4.38462555e-01 1.24130094e+00 7.36756623e-01 1.47960520e+00
 7.08730221e-01 5.08792341e-01 1.37237775e+00 3.27735007e-01
 5.84257364e-01 1.62453985e+00 3.27735007e-01 1.45254588e+00
 7.94655323e-01 5.20358980e-01 1.53227532e+00 1.12432694e+00
 1.24200869e+00 1.01228547e+00 3.43260795e-01 3.43260795e-01
 9.74230528e-01 1.23943102e+00 5.08792341e-01 1.54548419e+00
 8.77346039e-01 1.48246717e+00 2.17988403e+03 1.47972555e+01
 1.86872160e+00 5.30622125e-01 1.38870943e+00 1.00960350e+00
 3.43260795e-01 9.22741532e-01 1.24821882e+01 3.04748744e-01
 4.81156200e-01 1.89499140e+00 1.22305524e+00 3.91882896e-01
 3.91882896e-01 1.66293514e+00 3.43260795e-01 4.67001826e-01
 1.73159009e+03 3.98513734e-01 1.45254588e+00 4.35436904e-01
 1.21816182e+00 5.17982304e-01 8.26492371e+02 7.08730221e-01
 8.44871104e-01 1.30048633e+00 5.84710503e+00 1.00562811e+00
 4.31679368e-01 3.70325279e+00 1.49499547e+00 1.00243247e+00
 3.04748744e-01 1.99383187e+00 1.10913861e+00 6.44688368e-01
 1.56696379e+00 6.44688368e-01 4.55350876e-01 1.01801133e+00
 5.81904471e-01 1.89499140e+00 1.89499140e+00 1.54548419e+00
 1.89499140e+00 4.31679368e-01 4.81156200e-01 1.15352571e+00
 1.89499140e+00 3.44335765e-01 1.62757051e+00 2.62580800e+00
 4.35436904e-01 1.89499140e+00 1.55820680e+00 2.39496756e+00
 1.82884192e+00 1.10685289e+00 9.44352925e-01 1.53860271e+00
 1.12432694e+00 5.84257364e-01 7.08730221e-01 1.12208903e+00
 1.25108373e+00 5.17982304e-01 3.98448706e-01 1.65490067e+00
 2.57784653e+00 6.66295105e+02 5.41436017e-01 1.24200869e+00
 9.57855344e-01 8.38347137e-01 2.29452586e+00 1.12432694e+00
 1.38758123e+00 4.81156200e-01 5.72816968e-01 1.26399791e+00
 1.47707534e+00 5.08792341e-01 8.02324533e-01 9.10201430e-01
 5.17982304e-01 1.24130094e+00 1.02959764e+00 7.75094509e-01
 5.81904471e-01 3.04748744e-01 4.38462555e-01 4.81156200e-01
 1.89499140e+00 1.47859013e+00 3.27735007e-01 2.29452586e+00
 1.67307913e+00 3.04748744e-01 1.89499140e+00 1.70687628e+00
 1.53474176e+00 9.22741532e-01 2.29452586e+00 2.29452586e+00
 1.35940135e+00 3.94433349e-01 9.57855344e-01 6.85627401e-01
 4.84686613e-01 9.48951125e-01 5.30622125e-01 9.16908681e-01
 3.04748744e-01 2.05568218e+00 5.08792341e-01 5.68270385e-01
 4.38462555e-01 9.32603538e-01 5.70515752e-01 1.89499140e+00
 4.67001826e-01 1.10751319e+00 1.33703279e+00 1.34893608e+00
 5.30622125e-01 1.58308756e+00 8.99198651e-01 4.67001826e-01
 3.44335765e-01 6.85627401e-01 5.17982304e-01 1.52525675e+00
 1.24200869e+00 9.30502415e-01 1.51759183e+00 6.85627401e-01
 1.08441257e+00 8.26148450e-01 3.04748744e-01 9.49178398e-01
 1.36124349e+00 1.24200869e+00 4.31679368e-01 1.32301223e+00
 3.43260795e-01 5.68270385e-01 9.55049634e-01 1.47530746e+00
 8.92484665e-01 3.43260795e-01 1.02959764e+00 6.84285820e-01
 4.71221715e-01 9.22741532e-01 3.04748744e-01 1.04791832e+00
 1.63710129e+00 8.92484665e-01 3.27735007e-01 1.21927428e+00
 1.22740948e+00 1.24410355e+00 1.45445967e+00 9.53130543e-01
 1.37237775e+00 9.82503474e-01 3.43260795e-01 2.31812596e+00
 9.57855344e-01 4.81156200e-01 9.00217533e-01 4.38462555e-01
 3.04748744e-01 9.74230528e-01 1.51759183e+00 3.44335765e-01
 5.27934134e-01 7.08730221e-01 9.82503474e-01 2.11273503e+00
 5.90005815e-01 4.35436904e-01 9.83119263e+02 1.09988129e+00
 9.83119263e+02 1.64709592e+00 1.93026316e+00 4.67001826e-01
 1.15352571e+00 1.21927428e+00 1.15352571e+00 9.20372009e+02
 7.27688789e-01 3.91882896e-01 5.18963635e-01 3.04748744e-01
 1.24130094e+00 4.31679368e-01 1.12432694e+00 9.22741532e-01
 4.35436904e-01 4.94926512e-01 1.00243247e+00 6.85627401e-01
 3.70325279e+00 5.83731472e-01 3.27735007e-01 4.55350876e-01
 3.98513734e-01 5.18963635e-01 9.87803817e-01 2.40618324e+00
 5.41436017e-01 4.54382956e-01 3.98513734e-01 3.11147261e+00
 1.42271888e+00 5.17982304e-01 5.17982304e-01 5.17982304e-01
 4.31679368e-01 3.11768055e-01 1.27798355e+00 4.35436904e-01
 5.17982304e-01 5.84257364e-01 9.14007783e-01 1.77097118e+00
 5.17982304e-01 3.24620485e-01 4.40863311e-01 4.75383103e-01
 1.52525675e+00 1.58740866e+00 1.10913861e+00 1.58234954e+00
 9.44352925e-01 1.10913861e+00 1.10913861e+00 6.85555935e-01
 1.10751319e+00 1.46823156e+00 1.37237775e+00 1.46823156e+00
 6.85555935e-01 1.22305524e+00 4.20048485e+01 3.04748744e-01
 4.81156200e-01 1.10913861e+00 1.51235509e+00 5.35281360e-01
 3.42310101e-01 1.30179167e+00 1.10913861e+00 4.54382956e-01
 3.91882896e-01 9.55049515e-01 1.38375688e+00 1.10913861e+00
 9.50017452e-01 4.16401595e-01 7.75094509e-01 1.10913861e+00
 1.02265871e+00 3.91882896e-01 3.42310101e-01 1.75013316e+00
 1.82525861e+00 3.98448706e-01 3.04748744e-01 7.23073125e-01
 1.10913861e+00 5.17982304e-01 8.32716465e-01 1.10913861e+00
 2.29452586e+00 4.35436904e-01 1.10913861e+00 1.10751319e+00
 3.04748744e-01 1.55398130e+00 1.27599108e+00 3.24620485e-01
 8.26148450e-01 4.81156200e-01 1.10135937e+00 1.10751319e+00
 4.75383103e-01 7.62872517e-01 1.01801133e+00 1.22152996e+00
 4.16401595e-01 4.31679368e-01 5.17982304e-01 9.22741532e-01
 9.48951125e-01 1.54548419e+00 1.56537247e+00 4.40863311e-01
 4.38462555e-01 1.24130094e+00 4.31679368e-01 2.02625132e+00
 8.26148450e-01 3.71268839e-01 3.27735007e-01 3.91882896e-01
 1.03961539e+00 7.45574772e-01 9.01838601e-01 3.91882896e-01
 3.91882896e-01 4.38462555e-01 3.91882896e-01 9.22741532e-01
 7.36756623e-01 1.10751319e+00 9.00217533e-01 3.46034616e-01
 3.04748744e-01 1.62757051e+00 3.98448706e-01 5.03610551e-01
 4.55350876e-01 1.10751319e+00 9.22741532e-01 7.18675792e-01
 3.91882896e-01 3.27735007e-01 1.48079777e+00 1.02265871e+00
 5.83731472e-01 1.61514926e+00 3.91882896e-01 1.02265871e+00
 9.44386959e-01 4.22024518e-01 9.53130543e-01 1.02027810e+00
 3.98513734e-01 4.03347731e-01 3.91882896e-01 3.91882896e-01
 8.02324533e-01 1.07350016e+00 9.80217102e+02 1.44590533e+00
 3.27735007e-01 1.02265871e+00 4.31679368e-01 1.61514926e+00
 1.34278858e+00 1.24410355e+00 3.11768055e-01 7.08730221e-01
 8.84675980e-01 1.23318851e+00 1.02265871e+00 4.55350876e-01
 3.27735007e-01 3.98448706e-01 9.03905392e-01 9.55049634e-01
 1.69530928e+00 3.91882896e-01 3.91882896e-01 5.35281360e-01
 4.62230623e-01 5.17982304e-01 8.92484665e-01 1.45751357e+00
 9.55049634e-01 9.44386959e-01 9.87803817e-01 1.25599301e+00
 1.48226035e+00 4.62230623e-01 3.06516671e+00 8.92484665e-01
 3.91882896e-01 9.22741532e-01 5.83731472e-01 9.55049634e-01
 5.83731472e-01 1.02265871e+00 1.55820680e+00 3.44335765e-01
 3.43260795e-01 1.70687628e+00 3.04748744e-01 3.04748744e-01
 3.24620485e-01 1.70687628e+00 4.31679368e-01 4.31679368e-01
 1.85411656e+00 4.31679368e-01 8.02324533e-01 9.55049634e-01
 1.21927428e+00 9.03130591e-01 3.91882896e-01 5.14597833e-01
 3.54709697e+00 1.48226035e+00 3.98513734e-01 1.43960094e+00
 1.12432683e+00 3.98513824e-01 9.03130710e-01 9.03130591e-01
 5.81904471e-01 5.14597833e-01 5.94377518e-01 3.44335765e-01
 9.55049634e-01 3.24620485e-01 3.98513734e-01 3.71268839e-01
 9.55049634e-01 8.02324533e-01 5.14597833e-01 4.62230623e-01
 3.24620485e-01 4.75763470e-01 1.09837079e+00 3.24620485e-01
 3.04748744e-01 3.04748744e-01 6.00205541e-01 3.24620485e-01
 4.24285382e-01 3.11768055e-01 3.98513734e-01 9.55049634e-01
 1.22960746e+00 9.55049634e-01 1.89499140e+00 3.98513734e-01
 3.11768055e-01 3.44335765e-01 3.04748744e-01 3.98513734e-01
 3.04748744e-01 3.04748744e-01 7.08730221e-01 3.04748744e-01
 6.42420709e-01 3.24620485e-01 3.98513734e-01 1.16660690e+00
 5.18963635e-01 9.87803817e-01 4.75763470e-01 1.25108373e+00
 5.81904471e-01 4.38462555e-01 5.20358980e-01 4.55350876e-01
 1.93026316e+00 5.83731472e-01 3.94433349e-01 5.83731472e-01
 3.04748744e-01 4.55350876e-01 3.04748744e-01 9.22741532e-01
 9.22741532e-01 9.22741532e-01 9.22741532e-01 3.23396873e+00
 3.04748744e-01 4.03347731e-01 4.55350876e-01 3.04748744e-01
 4.55350876e-01 9.06665206e-01 1.25599301e+00 9.22741532e-01
 5.83731472e-01 1.67678479e+03 3.27735007e-01 9.85414028e-01
 5.83221018e-01 5.83731592e-01]
2025-06-06 15:18:33,281 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:18:33,405 - ERROR - An error occurred while processing file nw_graph_encoded_1749044948.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:33,405 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:33,406 - INFO - 
--- Processing file: nw_graph_encoded_1749045008.dot ---
2025-06-06 15:18:33,406 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot
2025-06-06 15:18:33,406 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot file.
2025-06-06 15:18:33,436 - INFO - Parsed 780 nodes.
2025-06-06 15:18:33,463 - INFO - Parsed 1667 edges.
2025-06-06 15:18:34,092 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:34,093 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:34,101 - DEBUG - Initial node features tensor shape: torch.Size([780, 19])
2025-06-06 15:18:34,110 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:34,120 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 19])
2025-06-06 15:18:34,122 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-06 15:18:34,122 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:34,134 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:34,136 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:34,138 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 2])
2025-06-06 15:18:34,140 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:34,145 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 20])
2025-06-06 15:18:34,154 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 22])
2025-06-06 15:18:34,154 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:34,154 - INFO - Performing online update...
2025-06-06 15:18:34,154 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:34,155 - DEBUG - Updated RunningStats: new_mean=[ 3.79548433e-10 -4.35786677e-10 -2.77221486e-09  2.20880799e-09
 -2.47438441e-08  1.32834218e-08 -9.45536176e-09 -2.26780354e-09
 -2.90948211e-09  1.03757949e-09  1.62290618e-09 -1.47622434e-09
  3.64811374e-09 -3.28675212e-09  9.01708852e-10  7.22338862e-10
 -3.79055760e-09  1.10423877e-09 -4.52276210e-09], new_M2=[200802.00518506 200802.00513933 200802.00021946 200802.0043736
 200801.99851081 200801.99841226 200801.99596202 200801.9981499
 200801.99324002 200801.99847109 200802.00180773 200801.99390838
 200801.99279524 161010.99668005 161011.00007069 161010.9988851
 161011.00001019 200802.00022791 200802.00766592], new_n=200802
2025-06-06 15:18:34,156 - DEBUG - Updated RunningStats: new_mean=[ 1.41486894e+00  5.48051602e+00  1.04286204e-10  2.50319284e-10
  1.43734671e-10 -1.64973415e-10 -1.22099449e-09  2.20862525e-10
  2.66911632e-10 -1.54253096e-10  2.97760639e-10 -3.37450249e-09
 -8.52343478e-10  1.72085313e-10  2.67999360e-10 -1.47789032e-10
 -1.47789032e-10 -1.47789032e-10 -1.47789032e-10 -1.47789032e-10
 -1.47789032e-10 -8.57438188e-11], new_M2=[ 111148.73706185 1920104.89947201  431610.99901509  431611.00588924
  431611.00579739  431610.99303266  431611.00036139  431610.99917805
  431611.00167418  431610.99926964  431610.99404185  431611.00850619
  431611.00111115  431610.99994908  431611.00181738  431610.99455598
  431610.99455598  431610.99455598  431610.99455598  431610.99455598
  431610.99455598  431610.99889564], new_n=431611
2025-06-06 15:18:34,156 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89545497 0.89545498 0.89545498 0.89545498 1.
 1.00000002]
2025-06-06 15:18:34,156 - DEBUG - Calculated standard deviation: [0.50746491 2.10919254 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:34,157 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:34,157 - DEBUG - Online update step: 1/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 2/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 3/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 4/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 5/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 6/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 7/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 8/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 9/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 10/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 11/50
2025-06-06 15:18:34,157 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,157 - DEBUG - Online update step: 12/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 13/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 14/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 15/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 16/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 17/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 18/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 19/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 20/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 21/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 22/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 23/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 24/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,158 - DEBUG - Online update step: 25/50
2025-06-06 15:18:34,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 26/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 27/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 28/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 29/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 30/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 31/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 32/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 33/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 34/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 35/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 36/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 37/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 38/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 39/50
2025-06-06 15:18:34,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,159 - DEBUG - Online update step: 40/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 41/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 42/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 43/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 44/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 45/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 46/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 47/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 48/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 49/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - DEBUG - Online update step: 50/50
2025-06-06 15:18:34,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:18:34,160 - WARNING - No successful steps during online update.
2025-06-06 15:18:34,164 - DEBUG - Current node mean: [-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], current edge mean: [ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:18:34,164 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2400
2025-06-06 15:18:34,164 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:18:34,164 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:18:34,164 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:18:34,165 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:18:34,166 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:18:34,167 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:18:34,167 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:18:34,167 - INFO - Optimizer and scheduler reset.
2025-06-06 15:18:34,168 - DEBUG - Updated reference mean: node=[-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], edge=[ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:18:34,168 - DEBUG - Updated reference std: node=[1.0006416 1.0006416 1.0006416 1.0006417 1.0006417 1.0006416 1.0006416
 1.0006417 1.0006416 1.0006417 1.0006416 1.0006416 1.0006416 1.0006416
 1.0006416 1.0006416 1.0006416 1.0006416 1.0006417], edge=[0.505705 1.785948 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003  ]
2025-06-06 15:18:34,168 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:18:34,169 - INFO - Running anomaly detection...
2025-06-06 15:18:34,169 - INFO - Starting anomaly detection.
2025-06-06 15:18:35,137 - DEBUG - Node reconstruction errors: [2.5765879e+00 1.4006917e+00 1.4750807e+00 1.4006917e+00 1.4006917e+00
 1.4006917e+00 1.4006917e+00 1.0823911e+00 1.2373220e+00 1.3111919e+00
 1.0823911e+00 1.0823911e+00 1.0823911e+00 1.4220786e+00 1.0823911e+00
 1.0823911e+00 1.0823911e+00 1.6135646e+00 1.7656525e+00 1.6135646e+00
 1.0823911e+00 1.0823911e+00 2.0363476e+00 3.1908627e+02 1.0823911e+00
 1.1030910e+00 8.2557595e-01 1.5306561e+00 8.2557595e-01 1.5306561e+00
 1.5306561e+00 6.4057136e-01 6.4057136e-01 5.8265764e-01 6.4057136e-01
 5.8265764e-01 6.4057136e-01 1.2373220e+00 6.4057136e-01 6.4057136e-01
 7.1799088e-01 6.4057136e-01 6.4057136e-01 3.0299423e+00 8.4463549e-01
 1.7121948e+00 6.4057136e-01 6.4057136e-01 6.4057136e-01 1.0182383e+00
 6.4057136e-01 6.4057136e-01 1.0823911e+00 6.4057136e-01 1.4688641e+00
 9.8369700e-01 5.3055978e-01 5.3055978e-01 5.3055978e-01 9.3689668e-01
 8.2106358e-01 5.3055978e-01 4.2497766e-01 4.2497766e-01 1.0823911e+00
 1.6750170e+00 4.2497766e-01 4.2497766e-01 5.3055978e-01 1.5506964e+00
 9.8369700e-01 9.8369700e-01 5.3055978e-01 4.2497766e-01 5.3055978e-01
 1.0692117e+00 4.2497766e-01 7.6386064e-01 4.2497766e-01 4.2497766e-01
 5.5354023e-01 9.3689668e-01 5.3055978e-01 2.7245045e+00 5.3055978e-01
 5.3055978e-01 5.3055978e-01 5.3055978e-01 5.3055978e-01 5.3055978e-01
 5.3055978e-01 1.4006917e+00 9.3794751e-01 7.1760678e-01 4.7026262e-01
 4.8565614e-01 4.7026262e-01 4.7026262e-01 8.2557595e-01 4.7026262e-01
 4.7026262e-01 4.7026262e-01 4.7026262e-01 4.7026262e-01 4.7026262e-01
 9.1359919e-01 4.8565614e-01 4.7026262e-01 5.6703812e-01 1.7068202e+00
 4.7026262e-01 8.8049108e-01 4.9393934e-01 4.7026262e-01 4.9532700e-01
 1.1908212e+00 4.9383521e-01 3.1869704e-01 4.9532700e-01 4.9383521e-01
 4.7026262e-01 4.7026262e-01 4.8565614e-01 4.7026262e-01 4.7026262e-01
 7.1760678e-01 5.3055978e-01 1.0703560e+00 5.3055978e-01 4.7026262e-01
 1.6135646e+00 4.7026262e-01 4.8565614e-01 4.7026262e-01 4.7026262e-01
 4.7026262e-01 7.1760678e-01 4.8565614e-01 4.7026262e-01 4.7026262e-01
 9.1359919e-01 1.4006917e+00 5.6703812e-01 4.8565614e-01 4.7026262e-01
 1.4006917e+00 4.8565614e-01 4.7026262e-01 4.7026262e-01 4.7026262e-01
 3.6764950e-01 9.5972240e-01 4.8565614e-01 4.8565614e-01 1.0489563e+00
 1.4006916e+00 1.0284559e+00 1.1503110e+00 7.9890823e-01 7.1760678e-01
 1.3729450e+00 9.5972240e-01 1.5900470e+00 2.0875830e+03 8.2557595e-01
 9.1858381e-01 1.0823911e+00 1.8592168e+00 6.9453222e-01 5.5003303e-01
 1.4750807e+00 5.1896745e-01 9.0716630e-01 5.5003303e-01 1.8946466e+00
 9.3509996e-01 5.7939428e-01 4.9397349e-01 1.7779016e+00 6.3694811e-01
 9.3509996e-01 9.8320520e-01 6.4700520e-01 1.7666508e+00 4.3731996e-01
 5.3055978e-01 9.7711021e-01 4.9397349e-01 5.6137639e-01 6.4700520e-01
 1.9327720e+00 1.4183513e+00 5.7939428e-01 5.2631235e-01 2.8794983e-01
 1.0371987e+00 4.7026262e-01 5.7939428e-01 3.7723219e-01 5.7939428e-01
 9.8276482e+00 1.5840241e+00 3.3304375e-01 6.5564156e-01 1.4857968e+00
 1.6882143e+00 9.6241641e-01 1.8592168e+00 1.1030910e+00 5.5373430e-01
 7.1204562e+00 1.7666508e+00 1.3944499e+00 2.3272195e+00 9.6241641e-01
 4.7026262e-01 1.5168587e+00 5.3144228e-01 5.1179260e-01 1.5570823e+00
 6.4700520e-01 1.8996389e+00 6.4057136e-01 1.3377959e+03 5.9588641e-01
 9.5972240e-01 5.5003303e-01 2.8106052e-01 1.9605387e+00 1.0769714e+00
 8.2557595e-01 4.7026262e-01 5.5373430e-01 4.8565614e-01 5.5373430e-01
 1.2482952e+00 1.4857968e+00 1.2609884e+00 1.0371987e+00 1.8659722e+00
 1.8565696e+00 7.1760678e-01 8.1474954e-01 1.0278125e+00 6.3091311e+00
 3.5473013e-01 3.6900477e+00 4.8565614e-01 7.2034556e-01 3.3304375e-01
 5.1896745e-01 1.0371987e+00 1.3670028e+00 1.0769714e+00 4.6654853e-01
 1.3442823e+00 1.0769714e+00 4.9397349e-01 6.4057136e-01 1.0769714e+00
 4.8855901e-01 1.8996389e+00 7.2034556e-01 5.7939428e-01 1.7386812e+00
 2.5562086e+00 4.8565614e-01 6.3694811e-01 2.5015841e+00 4.8565614e-01
 1.5168587e+00 7.7183986e-01 4.4089860e-01 1.6647419e+00 1.0371987e+00
 1.0484953e+00 1.3106595e+00 5.3055978e-01 5.3055978e-01 1.0405998e+00
 1.5340111e+00 5.7939428e-01 1.2482952e+00 8.2674474e-01 2.3884373e+00
 1.7623606e+03 8.3040686e+00 1.8788033e+00 5.8404392e-01 1.4559969e+00
 9.3087941e-01 5.3055978e-01 9.1359919e-01 9.1278677e+00 4.7026262e-01
 5.5373430e-01 1.4857968e+00 1.3846382e+00 5.1896745e-01 5.1896745e-01
 1.3353846e+00 5.3055978e-01 5.5003303e-01 2.5957339e+03 5.0038701e-01
 1.5168587e+00 5.3721988e-01 9.1006237e-01 5.9588641e-01 1.6707516e+03
 7.2034550e-01 1.5306561e+00 1.3312119e+00 6.5009236e+00 8.9410329e-01
 2.8106052e-01 3.4352815e+00 1.7596031e+00 1.2612851e+00 4.7026262e-01
 2.5371456e+00 9.8320520e-01 4.3731996e-01 2.0216224e+00 4.3731996e-01
 3.1869704e-01 9.6241641e-01 7.0252258e-01 1.4857968e+00 1.4857968e+00
 1.2482952e+00 1.4857968e+00 2.8106052e-01 5.5373430e-01 1.1267854e+00
 1.4857968e+00 4.6496090e-01 1.3644783e+00 2.5537663e+00 5.3721988e-01
 1.4857968e+00 1.4646516e+00 3.0982337e+00 2.5779207e+00 7.9322934e-01
 1.1457497e+00 1.8417603e+00 1.0371987e+00 6.3694811e-01 7.2034556e-01
 1.3492868e+00 1.3787236e+00 5.9588641e-01 4.9397349e-01 2.0252743e+00
 4.0371852e+00 1.2910774e+03 3.5473013e-01 1.0484953e+00 8.7754136e-01
 5.6267148e-01 1.7666508e+00 1.0371987e+00 1.0249032e+00 5.5373430e-01
 6.1095041e-01 1.6135646e+00 2.2032692e+00 5.7939428e-01 1.0823911e+00
 6.7320222e-01 5.9588641e-01 1.0769714e+00 1.0278125e+00 6.3424951e-01
 7.0252258e-01 4.7026262e-01 6.4057136e-01 5.5373430e-01 1.4857968e+00
 1.4825273e+00 4.8565614e-01 1.7666508e+00 1.6511515e+00 4.7026262e-01
 1.4857968e+00 2.0339067e+00 1.6963835e+00 9.1359913e-01 1.7666506e+00
 1.7666508e+00 1.0074562e+00 5.2113307e-01 8.7754136e-01 4.6617919e-01
 9.3509996e-01 1.0692117e+00 5.8404392e-01 1.1533464e+00 4.7026262e-01
 2.4028885e+00 5.7939428e-01 3.7723219e-01 6.4057136e-01 1.2304400e+00
 5.0039935e-01 1.4857968e+00 5.5003303e-01 9.4177169e-01 2.1098380e+00
 1.1512450e+00 5.8404392e-01 2.6628726e+00 1.0489562e+00 5.5003303e-01
 4.6496090e-01 4.6617919e-01 5.9588641e-01 1.7177820e+00 1.0484953e+00
 1.2373220e+00 1.6057518e+00 4.6617919e-01 1.3111919e+00 6.3811857e-01
 4.7026262e-01 8.8231999e-01 1.8946466e+00 1.0484953e+00 2.8106052e-01
 1.2613418e+00 5.3055978e-01 3.7723219e-01 8.9410639e-01 1.5339956e+00
 9.7061300e-01 5.3055978e-01 1.4824147e+00 6.9407398e-01 3.6764950e-01
 9.1359919e-01 4.7026262e-01 9.8235744e-01 2.3428710e+00 9.7061300e-01
 4.8565614e-01 1.0284559e+00 1.6163021e+00 1.1811565e+00 1.1940365e+00
 1.3944499e+00 1.8592168e+00 6.7516065e-01 5.3055978e-01 3.1580250e+00
 8.7754136e-01 5.5373430e-01 1.0049959e+00 6.4057136e-01 4.7026262e-01
 1.4824147e+00 1.6057518e+00 4.6496090e-01 4.2497766e-01 7.2034556e-01
 6.7516065e-01 2.1430905e+00 3.8878930e-01 5.3721988e-01 2.9983731e+02
 1.3670028e+00 2.9983731e+02 1.8105571e+00 1.9866921e+00 5.5003303e-01
 1.1267854e+00 1.0284559e+00 1.1267854e+00 1.5020438e+03 8.1474954e-01
 5.1896745e-01 3.4331203e-01 4.7026262e-01 1.0769714e+00 2.8106052e-01
 1.0371987e+00 9.1359919e-01 5.3721988e-01 3.2249275e-01 1.2612851e+00
 4.6617919e-01 3.4352815e+00 7.1760678e-01 4.8565614e-01 3.1869704e-01
 5.0038701e-01 3.4331203e-01 1.5862406e+00 1.1716826e+00 3.1955569e+00
 3.5473013e-01 3.0790406e-01 5.0038701e-01 3.7656209e+00 1.4169681e+00
 5.9588641e-01 5.9588641e-01 5.9588641e-01 2.8106052e-01 4.5230711e-01
 1.1503110e+00 5.3721988e-01 5.9588641e-01 6.3694811e-01 1.0021749e+00
 1.9142822e+00 5.9588641e-01 4.7455636e-01 2.8972876e-01 3.0419210e-01
 1.6776273e+00 2.0774124e+00 9.8320520e-01 1.6869651e+00 1.1457497e+00
 9.8320520e-01 9.8320520e-01 5.0696170e-01 9.4177169e-01 1.3866676e+00
 1.8592168e+00 1.3866676e+00 5.0696170e-01 1.3846382e+00 5.0531609e+01
 4.7026262e-01 5.5373430e-01 9.8320520e-01 1.4006917e+00 1.5900470e+00
 4.0282029e-01 4.5946145e-01 1.6227512e+00 9.8320520e-01 3.0790409e-01
 5.1896745e-01 8.9410639e-01 1.5943041e+00 9.8320520e-01 9.6973127e-01
 8.9563388e-01 6.3424951e-01 9.8320520e-01 9.1858381e-01 5.1896745e-01
 4.5946145e-01 2.4281960e+00 2.4574933e+00 4.9397349e-01 4.7026262e-01
 7.2616148e-01 9.8320520e-01 5.9588641e-01 5.7641774e-01 9.8320520e-01
 1.7666508e+00 5.3721988e-01 9.8320520e-01 9.4177169e-01 4.7026262e-01
 1.3700274e+00 1.1859201e+00 4.7455636e-01 7.9096198e-01 5.5373430e-01
 1.3442823e+00 9.4177169e-01 3.0419210e-01 5.1726007e-01 9.6241641e-01
 1.5433477e+00 4.9582461e-01 2.8106052e-01 5.9588641e-01 9.1359919e-01
 1.0692117e+00 1.2482952e+00 1.3018017e+00 1.7779016e+00 2.8972876e-01
 6.4057136e-01 1.0769714e+00 2.8106052e-01 2.0363476e+00 7.9096198e-01
 4.6654853e-01 4.8565614e-01 5.1896745e-01 1.4006917e+00 8.2778698e-01
 6.4700520e-01 5.1896745e-01 5.1896745e-01 6.4057136e-01 5.1896745e-01
 9.1359919e-01 4.8855901e-01 9.4177169e-01 1.0049959e+00 4.8342603e-01
 4.7026262e-01 1.3644783e+00 4.9397349e-01 3.5053155e-01 3.1869704e-01
 9.4177169e-01 9.1359919e-01 8.8474405e-01 5.1896745e-01 4.8565614e-01
 1.5496777e+00 9.1858381e-01 7.1760666e-01 2.0926378e+00 5.1896745e-01
 9.1858381e-01 9.2084825e-01 2.8186777e-01 1.8342632e+00 7.5421369e-01
 5.0038701e-01 5.6703812e-01 5.1896745e-01 5.1896745e-01 1.2373220e+00
 1.4824147e+00 3.0716064e+02 1.6052570e+00 4.8565614e-01 9.1858381e-01
 2.8106052e-01 1.7758534e+00 1.7863538e+00 1.1811565e+00 4.5230711e-01
 7.2034556e-01 9.5645255e-01 1.2609884e+00 9.1858381e-01 3.1869704e-01
 4.8565614e-01 4.9397349e-01 9.4799185e-01 8.9410639e-01 1.9373175e+00
 5.1896745e-01 5.1896745e-01 4.0282029e-01 2.9315385e-01 5.9588641e-01
 9.7061300e-01 1.2973075e+00 8.9410639e-01 9.2084825e-01 1.1716826e+00
 1.2304609e+00 1.3109293e+00 2.9315385e-01 4.0517898e+00 9.7061300e-01
 5.1896745e-01 9.1359919e-01 7.1760678e-01 8.9410639e-01 7.1760678e-01
 9.1858381e-01 1.4646516e+00 4.6496090e-01 5.3055978e-01 1.7434822e+00
 4.7026262e-01 4.7026262e-01 4.7455636e-01 1.7434822e+00 2.8106052e-01
 2.8106052e-01 1.4006917e+00 1.9227703e+00 2.8106052e-01 1.2373220e+00
 8.9410639e-01 1.0284559e+00 9.1711164e-01 5.1896745e-01 8.2778698e-01
 1.7779016e+00 4.2481551e+00 1.3109293e+00 8.6710387e-01 1.7220238e+00
 1.0371985e+00 5.0038701e-01 1.3477113e+00 9.1711164e-01 7.0252258e-01
 4.0675977e-01 8.2557595e-01 1.0818652e+00 8.9410639e-01 4.7455636e-01
 5.0038701e-01 4.6654853e-01 1.3477113e+00 1.0823911e+00 4.0675977e-01
 2.9315385e-01 4.7455636e-01 5.7454377e-01 8.3838272e-01 4.7455636e-01
 4.7026262e-01 4.7026262e-01 7.6386082e-01 4.7455636e-01 2.8794983e-01
 4.5230711e-01 5.0038701e-01 8.9410639e-01 1.4412832e+00 8.9410639e-01
 1.7779016e+00 1.4857968e+00 5.0038701e-01 4.5230711e-01 4.6496090e-01
 4.7026262e-01 5.0038701e-01 4.7026262e-01 4.7026262e-01 7.2034556e-01
 4.7026262e-01 4.2806906e-01 4.7455636e-01 5.0038701e-01 1.0445322e+00
 3.4331203e-01 1.3477113e+00 5.7454377e-01 1.3787236e+00 7.0252258e-01
 6.4057136e-01 9.5526916e-01 3.1869704e-01 1.9866921e+00 7.1760678e-01
 5.2113307e-01 1.4006917e+00 7.1760678e-01 4.7026262e-01 3.1869704e-01
 8.8474405e-01 9.1359919e-01 9.1359919e-01 9.1359919e-01 9.1359919e-01
 3.7409363e+00 4.7026262e-01 9.3689668e-01 3.1869704e-01 4.7026262e-01
 3.1869704e-01 1.0703560e+00 1.2304609e+00 9.1359919e-01 7.1760678e-01
 2.0929160e+03 8.8049108e-01 1.0182383e+00 1.2226248e+00 7.1760666e-01]
2025-06-06 15:18:35,144 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:18:35,320 - ERROR - An error occurred while processing file nw_graph_encoded_1749045008.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:18:35,324 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:18:35,324 - INFO - 
--- Processing file: nw_graph_encoded_1749046127.dot ---
2025-06-06 15:18:35,324 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot
2025-06-06 15:18:35,324 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot file.
2025-06-06 15:18:35,351 - INFO - Parsed 799 nodes.
2025-06-06 15:18:35,378 - INFO - Parsed 1718 edges.
2025-06-06 15:18:36,141 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:18:36,141 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:18:36,149 - DEBUG - Initial node features tensor shape: torch.Size([799, 19])
2025-06-06 15:18:36,169 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:18:36,182 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 19])
2025-06-06 15:18:36,185 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-06 15:18:36,185 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:18:36,496 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:18:36,498 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:18:36,501 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 2])
2025-06-06 15:18:36,504 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:18:36,515 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 20])
2025-06-06 15:18:36,523 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 22])
2025-06-06 15:18:36,523 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:18:36,523 - INFO - Performing online update...
2025-06-06 15:18:36,523 - INFO - Starting online update for 50 steps.
2025-06-06 15:18:36,524 - DEBUG - Updated RunningStats: new_mean=[ 3.65885305e-10 -4.21900662e-10 -2.87638601e-09  2.20933011e-09
 -2.46694300e-08  1.33437906e-08 -9.33052107e-09 -2.23512613e-09
 -2.89070745e-09  1.03804995e-09  1.74005858e-09 -1.44339500e-09
  3.62197683e-09 -3.26278653e-09  8.91556776e-10  7.29639227e-10
 -3.80280889e-09  1.08314161e-09 -4.55502484e-09], new_M2=[201601.00514268 201601.00509694 201601.00023859 201601.00442037
 201600.99854519 201600.99840548 201600.99600416 201600.99816372
 201600.99318175 201600.99843682 201601.00183422 201600.99391868
 201600.99279694 161809.99667376 161810.00009013 161809.99888559
 161810.00000065 201601.00020196 201601.0076998 ], new_n=201601
2025-06-06 15:18:36,525 - DEBUG - Updated RunningStats: new_mean=[ 1.41489030e+00  5.47850479e+00  9.72937587e-11  2.48780648e-10
  1.40575833e-10 -1.58958373e-10 -1.21235867e-09  2.02092951e-10
  2.75519832e-10 -1.68173403e-10  2.96515644e-10 -3.34415506e-09
 -8.53399429e-10  1.24670253e-10  2.68690604e-10 -1.51868535e-10
 -1.51868535e-10 -1.51868535e-10 -1.51868535e-10 -1.51868535e-10
 -1.51868535e-10 -8.27353396e-11], new_M2=[ 111591.36181054 1926006.03282036  433328.99894004  433329.00587729
  433329.0057573   433328.99318474  433329.00033293  433328.99913492
  433329.00167777  433328.99928746  433328.99415344  433329.00846064
  433329.00112089  433328.9999936   433329.0017675   433328.99445562
  433328.99445562  433328.99445562  433328.99445562  433328.99445562
  433328.99445562  433328.99893863], new_n=433329
2025-06-06 15:18:36,525 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89589339 0.8958934  0.8958934  0.8958934  1.
 1.00000002]
2025-06-06 15:18:36,530 - DEBUG - Calculated standard deviation: [0.50746537 2.10823949 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:18:36,530 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:18:36,530 - DEBUG - Online update step: 1/50
2025-06-06 15:18:36,531 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:18:36,562 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:18:36,569 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:18:36,569 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:18:36,598 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:18:36,614 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:18:36,656 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:18:36,669 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:18:36,716 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:18:36,716 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:18:36,723 - DEBUG - Applied edge dropout: 82 edges dropped.
2025-06-06 15:18:36,723 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:18:36,731 - DEBUG - Applied edge dropout: 41 edges dropped.
2025-06-06 15:18:36,751 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:18:36,793 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:18:36,804 - DEBUG - Applied edge dropout: 115 edges dropped.
2025-06-06 15:18:36,823 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:38,886 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:39,099 - DEBUG - Edge anomaly scores shape: torch.Size([12798, 1])
2025-06-06 15:18:39,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:39,157 - DEBUG - Node reconstruction loss: 27.4721
2025-06-06 15:18:39,163 - DEBUG - Edge reconstruction loss: 0.1438
2025-06-06 15:18:39,163 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:39,167 - DEBUG - Online update step: 2/50
2025-06-06 15:18:39,169 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:18:39,172 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:18:39,217 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:18:39,227 - DEBUG - Applied edge dropout: 37 edges dropped.
2025-06-06 15:18:39,234 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:18:39,244 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:18:39,280 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:18:39,315 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:18:39,316 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:18:39,322 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:18:39,322 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:18:39,330 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:18:39,338 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:18:39,378 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:18:39,409 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:18:39,409 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:18:39,427 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:41,907 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:42,063 - DEBUG - Edge anomaly scores shape: torch.Size([12834, 1])
2025-06-06 15:18:42,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:42,131 - DEBUG - Node reconstruction loss: 27.3101
2025-06-06 15:18:42,149 - DEBUG - Edge reconstruction loss: 0.2558
2025-06-06 15:18:42,150 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:42,162 - DEBUG - Online update step: 3/50
2025-06-06 15:18:42,173 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:18:42,181 - DEBUG - Applied edge dropout: 109 edges dropped.
2025-06-06 15:18:42,220 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:18:42,221 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:18:42,222 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:18:42,223 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:18:42,253 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:18:42,263 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:18:42,270 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:18:42,281 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:18:42,286 - DEBUG - Applied edge dropout: 61 edges dropped.
2025-06-06 15:18:42,316 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:18:42,356 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:18:42,357 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:18:42,364 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:18:42,392 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:18:42,408 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:45,121 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:45,367 - DEBUG - Edge anomaly scores shape: torch.Size([12873, 1])
2025-06-06 15:18:45,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:45,444 - DEBUG - Node reconstruction loss: 27.4525
2025-06-06 15:18:45,451 - DEBUG - Edge reconstruction loss: 0.3042
2025-06-06 15:18:45,451 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:45,462 - DEBUG - Online update step: 4/50
2025-06-06 15:18:45,471 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:18:45,471 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:18:45,514 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:18:45,525 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:18:45,561 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:18:45,567 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:18:45,568 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:18:45,588 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:18:45,619 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:18:45,662 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-06 15:18:45,669 - DEBUG - Applied edge dropout: 70 edges dropped.
2025-06-06 15:18:45,670 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:18:45,710 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:18:45,718 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:18:45,718 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:18:45,725 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:18:45,739 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:48,735 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:49,006 - DEBUG - Edge anomaly scores shape: torch.Size([12821, 1])
2025-06-06 15:18:49,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:49,105 - DEBUG - Node reconstruction loss: 27.8418
2025-06-06 15:18:49,116 - DEBUG - Edge reconstruction loss: 0.1791
2025-06-06 15:18:49,119 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:49,121 - DEBUG - Online update step: 5/50
2025-06-06 15:18:49,166 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:18:49,179 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:18:49,239 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:18:49,240 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:18:49,246 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:18:49,269 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:18:49,270 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:18:49,277 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:18:49,295 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:18:49,348 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:18:49,509 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:18:49,510 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:18:49,531 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:18:49,585 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:18:49,594 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:18:49,594 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:18:49,622 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:51,681 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:51,760 - DEBUG - Edge anomaly scores shape: torch.Size([12879, 1])
2025-06-06 15:18:51,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:51,798 - DEBUG - Node reconstruction loss: 27.1711
2025-06-06 15:18:51,798 - DEBUG - Edge reconstruction loss: 0.2283
2025-06-06 15:18:51,798 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:51,801 - DEBUG - Online update step: 6/50
2025-06-06 15:18:51,802 - DEBUG - Applied edge dropout: 75 edges dropped.
2025-06-06 15:18:51,803 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:18:51,803 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:18:51,803 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:18:51,804 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:18:51,805 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:18:51,805 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:18:51,805 - DEBUG - Applied edge dropout: 46 edges dropped.
2025-06-06 15:18:51,806 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:18:51,807 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:18:51,807 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:18:51,807 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:18:51,808 - DEBUG - Applied edge dropout: 87 edges dropped.
2025-06-06 15:18:51,808 - DEBUG - Applied edge dropout: 104 edges dropped.
2025-06-06 15:18:51,808 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:18:51,809 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:18:51,810 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:53,316 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:53,468 - DEBUG - Edge anomaly scores shape: torch.Size([12798, 1])
2025-06-06 15:18:53,524 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:53,543 - DEBUG - Node reconstruction loss: 26.6230
2025-06-06 15:18:53,552 - DEBUG - Edge reconstruction loss: 0.2462
2025-06-06 15:18:53,552 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:53,555 - DEBUG - Online update step: 7/50
2025-06-06 15:18:53,580 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:18:53,620 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:18:53,628 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:18:53,629 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:18:53,629 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:18:53,634 - DEBUG - Applied edge dropout: 113 edges dropped.
2025-06-06 15:18:53,636 - DEBUG - Applied edge dropout: 65 edges dropped.
2025-06-06 15:18:53,636 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:18:53,637 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:18:53,637 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:18:53,638 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:18:53,641 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:18:53,644 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:18:53,676 - DEBUG - Applied edge dropout: 130 edges dropped.
2025-06-06 15:18:53,676 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:18:53,699 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:18:53,712 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:55,542 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:55,769 - DEBUG - Edge anomaly scores shape: torch.Size([12819, 1])
2025-06-06 15:18:55,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:55,837 - DEBUG - Node reconstruction loss: 27.4468
2025-06-06 15:18:55,844 - DEBUG - Edge reconstruction loss: 0.2847
2025-06-06 15:18:55,844 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:55,846 - DEBUG - Online update step: 8/50
2025-06-06 15:18:55,849 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:18:55,891 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:18:55,905 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:18:55,912 - DEBUG - Applied edge dropout: 123 edges dropped.
2025-06-06 15:18:55,912 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:18:55,944 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:18:55,955 - DEBUG - Applied edge dropout: 70 edges dropped.
2025-06-06 15:18:55,968 - DEBUG - Applied edge dropout: 136 edges dropped.
2025-06-06 15:18:56,011 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:18:56,021 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:18:56,073 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:18:56,075 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:18:56,075 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:18:56,108 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:18:56,115 - DEBUG - Applied edge dropout: 27 edges dropped.
2025-06-06 15:18:56,123 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:18:56,142 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:18:58,449 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:18:58,635 - DEBUG - Edge anomaly scores shape: torch.Size([12816, 1])
2025-06-06 15:18:58,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:18:58,706 - DEBUG - Node reconstruction loss: 27.3253
2025-06-06 15:18:58,712 - DEBUG - Edge reconstruction loss: 0.1711
2025-06-06 15:18:58,712 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:18:58,715 - DEBUG - Online update step: 9/50
2025-06-06 15:18:58,740 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:18:58,765 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:18:58,770 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:18:58,770 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:18:58,810 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:18:58,814 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:18:58,816 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:18:58,818 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:18:58,818 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:18:58,818 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:18:58,822 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:18:58,828 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:18:58,836 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:18:58,840 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:18:58,840 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:18:58,876 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:18:58,898 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:00,764 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:00,977 - DEBUG - Edge anomaly scores shape: torch.Size([12890, 1])
2025-06-06 15:19:01,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:01,069 - DEBUG - Node reconstruction loss: 26.5058
2025-06-06 15:19:01,074 - DEBUG - Edge reconstruction loss: 0.1015
2025-06-06 15:19:01,074 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:01,082 - DEBUG - Online update step: 10/50
2025-06-06 15:19:01,095 - DEBUG - Applied edge dropout: 57 edges dropped.
2025-06-06 15:19:01,138 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:19:01,148 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:19:01,160 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:19:01,167 - DEBUG - Applied edge dropout: 94 edges dropped.
2025-06-06 15:19:01,175 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:19:01,175 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:01,201 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:01,203 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:01,204 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:01,212 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:01,212 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:01,214 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:01,214 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:01,214 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:01,215 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:01,310 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:03,939 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:04,147 - DEBUG - Edge anomaly scores shape: torch.Size([12847, 1])
2025-06-06 15:19:04,209 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:04,223 - DEBUG - Node reconstruction loss: 26.7904
2025-06-06 15:19:04,231 - DEBUG - Edge reconstruction loss: 0.0554
2025-06-06 15:19:04,231 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:04,238 - DEBUG - Online update step: 11/50
2025-06-06 15:19:04,247 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:04,293 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:19:04,348 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-06 15:19:04,360 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:04,372 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:04,383 - DEBUG - Applied edge dropout: 65 edges dropped.
2025-06-06 15:19:04,399 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:04,400 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:04,446 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:04,482 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:04,483 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:04,525 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:04,526 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:04,537 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:04,550 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:19:04,550 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:04,576 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:07,226 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:07,430 - DEBUG - Edge anomaly scores shape: torch.Size([12808, 1])
2025-06-06 15:19:07,488 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:07,501 - DEBUG - Node reconstruction loss: 27.2661
2025-06-06 15:19:07,508 - DEBUG - Edge reconstruction loss: 0.0562
2025-06-06 15:19:07,508 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:07,517 - DEBUG - Online update step: 12/50
2025-06-06 15:19:07,551 - DEBUG - Applied edge dropout: 124 edges dropped.
2025-06-06 15:19:07,559 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:07,561 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:07,569 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:07,582 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:07,583 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:07,641 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-06 15:19:07,649 - DEBUG - Applied edge dropout: 33 edges dropped.
2025-06-06 15:19:07,650 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:07,656 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:07,664 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:07,710 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:07,711 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:07,757 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:07,766 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:19:07,805 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-06 15:19:07,820 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:10,249 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:10,475 - DEBUG - Edge anomaly scores shape: torch.Size([12785, 1])
2025-06-06 15:19:10,559 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:10,573 - DEBUG - Node reconstruction loss: 27.1210
2025-06-06 15:19:10,580 - DEBUG - Edge reconstruction loss: 0.3050
2025-06-06 15:19:10,580 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:10,582 - DEBUG - Online update step: 13/50
2025-06-06 15:19:10,587 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:10,595 - DEBUG - Applied edge dropout: 30 edges dropped.
2025-06-06 15:19:10,595 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:10,634 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:10,684 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:10,684 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:10,684 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:10,744 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:10,782 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:10,789 - DEBUG - Applied edge dropout: 110 edges dropped.
2025-06-06 15:19:10,789 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:10,797 - DEBUG - Applied edge dropout: 72 edges dropped.
2025-06-06 15:19:10,836 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:10,842 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:10,851 - DEBUG - Applied edge dropout: 89 edges dropped.
2025-06-06 15:19:10,860 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:10,877 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:12,884 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:13,196 - DEBUG - Edge anomaly scores shape: torch.Size([12836, 1])
2025-06-06 15:19:13,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:13,299 - DEBUG - Node reconstruction loss: 27.2707
2025-06-06 15:19:13,308 - DEBUG - Edge reconstruction loss: 0.0848
2025-06-06 15:19:13,308 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:13,311 - DEBUG - Online update step: 14/50
2025-06-06 15:19:13,311 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:13,323 - DEBUG - Applied edge dropout: 104 edges dropped.
2025-06-06 15:19:13,323 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:13,330 - DEBUG - Applied edge dropout: 49 edges dropped.
2025-06-06 15:19:13,378 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:13,414 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:13,420 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:13,427 - DEBUG - Applied edge dropout: 22 edges dropped.
2025-06-06 15:19:13,433 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:13,451 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:13,462 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:13,462 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:13,491 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:13,491 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:13,532 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:13,563 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:13,583 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:15,789 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:15,836 - DEBUG - Edge anomaly scores shape: torch.Size([12835, 1])
2025-06-06 15:19:15,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:15,841 - DEBUG - Node reconstruction loss: 27.1129
2025-06-06 15:19:15,841 - DEBUG - Edge reconstruction loss: 0.1742
2025-06-06 15:19:15,843 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:15,848 - DEBUG - Online update step: 15/50
2025-06-06 15:19:15,857 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:15,903 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:15,946 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:15,947 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:15,954 - DEBUG - Applied edge dropout: 101 edges dropped.
2025-06-06 15:19:15,960 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:19:15,964 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:15,980 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:19:15,981 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:15,989 - DEBUG - Applied edge dropout: 32 edges dropped.
2025-06-06 15:19:16,004 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:16,005 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:16,036 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:16,038 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:16,089 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:16,089 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:16,173 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:19,269 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:19,458 - DEBUG - Edge anomaly scores shape: torch.Size([12811, 1])
2025-06-06 15:19:19,526 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:19,549 - DEBUG - Node reconstruction loss: 27.3470
2025-06-06 15:19:19,552 - DEBUG - Edge reconstruction loss: 0.0891
2025-06-06 15:19:19,552 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:19,556 - DEBUG - Online update step: 16/50
2025-06-06 15:19:19,575 - DEBUG - Applied edge dropout: 136 edges dropped.
2025-06-06 15:19:19,579 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:19,584 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:19,585 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:19:19,585 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:19,585 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:19,586 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:19,596 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:19,596 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:19,597 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:19,597 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:19,597 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:19,609 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:19,625 - DEBUG - Applied edge dropout: 70 edges dropped.
2025-06-06 15:19:19,626 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:19,626 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:19,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:21,683 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:21,917 - DEBUG - Edge anomaly scores shape: torch.Size([12792, 1])
2025-06-06 15:19:21,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:21,999 - DEBUG - Node reconstruction loss: 26.6672
2025-06-06 15:19:22,009 - DEBUG - Edge reconstruction loss: 0.1423
2025-06-06 15:19:22,009 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:22,011 - DEBUG - Online update step: 17/50
2025-06-06 15:19:22,023 - DEBUG - Applied edge dropout: 118 edges dropped.
2025-06-06 15:19:22,030 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:19:22,038 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:19:22,038 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:22,078 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:22,110 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:22,110 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:22,116 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:22,123 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:19:22,123 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:22,153 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:22,183 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:22,194 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:22,194 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:22,232 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-06 15:19:22,240 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:22,254 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:24,235 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:24,392 - DEBUG - Edge anomaly scores shape: torch.Size([12753, 1])
2025-06-06 15:19:24,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:24,461 - DEBUG - Node reconstruction loss: 26.9250
2025-06-06 15:19:24,467 - DEBUG - Edge reconstruction loss: 0.1939
2025-06-06 15:19:24,468 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:24,471 - DEBUG - Online update step: 18/50
2025-06-06 15:19:24,518 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:24,518 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:24,519 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:24,550 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:24,583 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:24,590 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:24,601 - DEBUG - Applied edge dropout: 22 edges dropped.
2025-06-06 15:19:24,603 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:24,609 - DEBUG - Applied edge dropout: 29 edges dropped.
2025-06-06 15:19:24,642 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:24,647 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:19:24,647 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:24,655 - DEBUG - Applied edge dropout: 117 edges dropped.
2025-06-06 15:19:24,666 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:24,704 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:19:24,715 - DEBUG - Applied edge dropout: 54 edges dropped.
2025-06-06 15:19:24,734 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:26,254 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:26,350 - DEBUG - Edge anomaly scores shape: torch.Size([12883, 1])
2025-06-06 15:19:26,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:26,352 - DEBUG - Node reconstruction loss: 27.7014
2025-06-06 15:19:26,352 - DEBUG - Edge reconstruction loss: 0.1820
2025-06-06 15:19:26,352 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:26,354 - DEBUG - Online update step: 19/50
2025-06-06 15:19:26,355 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-06 15:19:26,355 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:26,356 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:26,356 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:26,356 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:26,357 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:26,357 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:26,357 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:26,357 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:19:26,358 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:26,358 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-06 15:19:26,358 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:26,358 - DEBUG - Applied edge dropout: 101 edges dropped.
2025-06-06 15:19:26,359 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:26,359 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:26,360 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:26,361 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:27,292 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:27,494 - DEBUG - Edge anomaly scores shape: torch.Size([12779, 1])
2025-06-06 15:19:27,556 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:27,576 - DEBUG - Node reconstruction loss: 26.4841
2025-06-06 15:19:27,585 - DEBUG - Edge reconstruction loss: 0.1178
2025-06-06 15:19:27,585 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:27,587 - DEBUG - Online update step: 20/50
2025-06-06 15:19:27,628 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:27,636 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:19:27,643 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:27,643 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:27,643 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:27,676 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:27,713 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:27,713 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:27,722 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:27,733 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:19:27,791 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:27,799 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:27,805 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:27,806 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:27,813 - DEBUG - Applied edge dropout: 60 edges dropped.
2025-06-06 15:19:27,872 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:27,930 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:30,572 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:30,852 - DEBUG - Edge anomaly scores shape: torch.Size([12831, 1])
2025-06-06 15:19:30,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:30,892 - DEBUG - Node reconstruction loss: 26.7023
2025-06-06 15:19:30,892 - DEBUG - Edge reconstruction loss: 0.1305
2025-06-06 15:19:30,892 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:30,896 - DEBUG - Online update step: 21/50
2025-06-06 15:19:30,897 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:30,935 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:30,947 - DEBUG - Applied edge dropout: 94 edges dropped.
2025-06-06 15:19:30,957 - DEBUG - Applied edge dropout: 47 edges dropped.
2025-06-06 15:19:31,013 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:31,021 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:31,036 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:31,037 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:31,051 - DEBUG - Applied edge dropout: 136 edges dropped.
2025-06-06 15:19:31,062 - DEBUG - Applied edge dropout: 32 edges dropped.
2025-06-06 15:19:31,077 - DEBUG - Applied edge dropout: 90 edges dropped.
2025-06-06 15:19:31,078 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:31,084 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:31,134 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:31,135 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:31,135 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:31,151 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:33,350 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:33,512 - DEBUG - Edge anomaly scores shape: torch.Size([12906, 1])
2025-06-06 15:19:33,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:33,597 - DEBUG - Node reconstruction loss: 26.6244
2025-06-06 15:19:33,607 - DEBUG - Edge reconstruction loss: 0.1078
2025-06-06 15:19:33,607 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:33,610 - DEBUG - Online update step: 22/50
2025-06-06 15:19:33,648 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:33,656 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:33,694 - DEBUG - Applied edge dropout: 186 edges dropped.
2025-06-06 15:19:33,701 - DEBUG - Applied edge dropout: 57 edges dropped.
2025-06-06 15:19:33,748 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:19:33,779 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:33,780 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:33,789 - DEBUG - Applied edge dropout: 108 edges dropped.
2025-06-06 15:19:33,789 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:33,790 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:33,797 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:33,797 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:33,804 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:33,847 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:33,857 - DEBUG - Applied edge dropout: 41 edges dropped.
2025-06-06 15:19:33,864 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:33,883 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:36,446 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:36,589 - DEBUG - Edge anomaly scores shape: torch.Size([12850, 1])
2025-06-06 15:19:36,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:36,591 - DEBUG - Node reconstruction loss: 28.4268
2025-06-06 15:19:36,592 - DEBUG - Edge reconstruction loss: 0.1454
2025-06-06 15:19:36,592 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:36,595 - DEBUG - Online update step: 23/50
2025-06-06 15:19:36,596 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:36,596 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:36,596 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:36,597 - DEBUG - Applied edge dropout: 124 edges dropped.
2025-06-06 15:19:36,598 - DEBUG - Applied edge dropout: 184 edges dropped.
2025-06-06 15:19:36,598 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:36,599 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:36,599 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:36,599 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:36,600 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:36,600 - DEBUG - Applied edge dropout: 42 edges dropped.
2025-06-06 15:19:36,600 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:36,601 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:36,601 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:19:36,602 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:36,602 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:19:36,604 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:37,061 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:37,090 - DEBUG - Edge anomaly scores shape: torch.Size([12852, 1])
2025-06-06 15:19:37,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:37,092 - DEBUG - Node reconstruction loss: 26.7631
2025-06-06 15:19:37,093 - DEBUG - Edge reconstruction loss: 0.1692
2025-06-06 15:19:37,093 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:37,095 - DEBUG - Online update step: 24/50
2025-06-06 15:19:37,096 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:19:37,096 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:37,097 - DEBUG - Applied edge dropout: 107 edges dropped.
2025-06-06 15:19:37,097 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:19:37,098 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:37,098 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:19:37,099 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:37,099 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:37,103 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:37,104 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:19:37,104 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-06 15:19:37,104 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-06 15:19:37,105 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:37,106 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:37,106 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:37,107 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:37,108 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:37,724 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:37,805 - DEBUG - Edge anomaly scores shape: torch.Size([12832, 1])
2025-06-06 15:19:37,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:37,806 - DEBUG - Node reconstruction loss: 26.5485
2025-06-06 15:19:37,810 - DEBUG - Edge reconstruction loss: 0.0724
2025-06-06 15:19:37,810 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:37,812 - DEBUG - Online update step: 25/50
2025-06-06 15:19:37,813 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:37,813 - DEBUG - Applied edge dropout: 24 edges dropped.
2025-06-06 15:19:37,813 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:19:37,817 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:37,817 - DEBUG - Applied edge dropout: 61 edges dropped.
2025-06-06 15:19:37,817 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:37,818 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:19:37,818 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:37,818 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:37,819 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:37,819 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:37,819 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:37,820 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:37,820 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:37,820 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:19:37,820 - DEBUG - Applied edge dropout: 29 edges dropped.
2025-06-06 15:19:37,836 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:38,141 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:38,162 - DEBUG - Edge anomaly scores shape: torch.Size([12883, 1])
2025-06-06 15:19:38,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:38,163 - DEBUG - Node reconstruction loss: 26.1539
2025-06-06 15:19:38,163 - DEBUG - Edge reconstruction loss: 0.1285
2025-06-06 15:19:38,164 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:38,166 - DEBUG - Online update step: 26/50
2025-06-06 15:19:38,167 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:38,167 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-06 15:19:38,167 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:38,168 - DEBUG - Applied edge dropout: 60 edges dropped.
2025-06-06 15:19:38,168 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:38,168 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:38,169 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:38,169 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:38,169 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:19:38,170 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:38,170 - DEBUG - Applied edge dropout: 33 edges dropped.
2025-06-06 15:19:38,170 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:38,170 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:38,171 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:38,171 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:38,171 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:38,172 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:38,589 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:38,608 - DEBUG - Edge anomaly scores shape: torch.Size([12829, 1])
2025-06-06 15:19:38,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:38,609 - DEBUG - Node reconstruction loss: 27.0415
2025-06-06 15:19:38,609 - DEBUG - Edge reconstruction loss: 0.0793
2025-06-06 15:19:38,610 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:38,612 - DEBUG - Online update step: 27/50
2025-06-06 15:19:38,612 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:38,613 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:38,613 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:38,613 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:38,614 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:38,614 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:38,614 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:38,615 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:38,615 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:19:38,615 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:38,615 - DEBUG - Applied edge dropout: 101 edges dropped.
2025-06-06 15:19:38,616 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:38,616 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:38,616 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:38,616 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:38,617 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:38,618 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:38,934 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:38,955 - DEBUG - Edge anomaly scores shape: torch.Size([12879, 1])
2025-06-06 15:19:38,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:38,957 - DEBUG - Node reconstruction loss: 26.1906
2025-06-06 15:19:38,957 - DEBUG - Edge reconstruction loss: 0.1101
2025-06-06 15:19:38,957 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:38,959 - DEBUG - Online update step: 28/50
2025-06-06 15:19:38,961 - DEBUG - Applied edge dropout: 57 edges dropped.
2025-06-06 15:19:38,961 - DEBUG - Applied edge dropout: 126 edges dropped.
2025-06-06 15:19:38,961 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:38,962 - DEBUG - Applied edge dropout: 184 edges dropped.
2025-06-06 15:19:38,962 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:38,962 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:38,963 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:38,963 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:38,963 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:38,963 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:38,964 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:38,964 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:38,964 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:38,964 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:38,964 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:38,968 - DEBUG - Applied edge dropout: 46 edges dropped.
2025-06-06 15:19:38,969 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:39,255 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:39,275 - DEBUG - Edge anomaly scores shape: torch.Size([12831, 1])
2025-06-06 15:19:39,276 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:39,276 - DEBUG - Node reconstruction loss: 27.2536
2025-06-06 15:19:39,277 - DEBUG - Edge reconstruction loss: 0.1180
2025-06-06 15:19:39,277 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:39,279 - DEBUG - Online update step: 29/50
2025-06-06 15:19:39,280 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:39,280 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:39,280 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:39,281 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:39,281 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:39,282 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:39,282 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:39,282 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:19:39,282 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:39,283 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:19:39,283 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:39,283 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:39,284 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:39,284 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:39,284 - DEBUG - Applied edge dropout: 48 edges dropped.
2025-06-06 15:19:39,284 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:39,286 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:39,592 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:39,616 - DEBUG - Edge anomaly scores shape: torch.Size([12784, 1])
2025-06-06 15:19:39,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:39,617 - DEBUG - Node reconstruction loss: 27.6540
2025-06-06 15:19:39,618 - DEBUG - Edge reconstruction loss: 0.0775
2025-06-06 15:19:39,618 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:39,620 - DEBUG - Online update step: 30/50
2025-06-06 15:19:39,621 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:39,621 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:39,621 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:39,622 - DEBUG - Applied edge dropout: 99 edges dropped.
2025-06-06 15:19:39,622 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:39,623 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:39,623 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:39,623 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:39,623 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:39,624 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:39,624 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:39,624 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:39,624 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:39,625 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:39,625 - DEBUG - Applied edge dropout: 76 edges dropped.
2025-06-06 15:19:39,625 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:39,636 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:39,866 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:39,885 - DEBUG - Edge anomaly scores shape: torch.Size([12817, 1])
2025-06-06 15:19:39,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:39,886 - DEBUG - Node reconstruction loss: 27.1862
2025-06-06 15:19:39,887 - DEBUG - Edge reconstruction loss: 0.3628
2025-06-06 15:19:39,887 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:39,889 - DEBUG - Online update step: 31/50
2025-06-06 15:19:39,889 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:39,890 - DEBUG - Applied edge dropout: 37 edges dropped.
2025-06-06 15:19:39,890 - DEBUG - Applied edge dropout: 90 edges dropped.
2025-06-06 15:19:39,890 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:39,891 - DEBUG - Applied edge dropout: 126 edges dropped.
2025-06-06 15:19:39,891 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:39,891 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:39,891 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:39,892 - DEBUG - Applied edge dropout: 178 edges dropped.
2025-06-06 15:19:39,892 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:39,892 - DEBUG - Applied edge dropout: 67 edges dropped.
2025-06-06 15:19:39,892 - DEBUG - Applied edge dropout: 186 edges dropped.
2025-06-06 15:19:39,893 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:39,893 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:19:39,893 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:39,893 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:39,894 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:40,130 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:40,152 - DEBUG - Edge anomaly scores shape: torch.Size([12821, 1])
2025-06-06 15:19:40,153 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:40,153 - DEBUG - Node reconstruction loss: 27.4066
2025-06-06 15:19:40,154 - DEBUG - Edge reconstruction loss: 0.2512
2025-06-06 15:19:40,154 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:40,157 - DEBUG - Online update step: 32/50
2025-06-06 15:19:40,158 - DEBUG - Applied edge dropout: 28 edges dropped.
2025-06-06 15:19:40,158 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:40,159 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:40,159 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:40,160 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:40,160 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:40,161 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:19:40,161 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:19:40,162 - DEBUG - Applied edge dropout: 109 edges dropped.
2025-06-06 15:19:40,162 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:40,163 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:40,163 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:40,164 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:40,164 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:40,165 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:40,165 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:40,167 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:40,431 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:40,449 - DEBUG - Edge anomaly scores shape: torch.Size([12814, 1])
2025-06-06 15:19:40,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:40,450 - DEBUG - Node reconstruction loss: 26.9144
2025-06-06 15:19:40,451 - DEBUG - Edge reconstruction loss: 0.0921
2025-06-06 15:19:40,451 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:40,453 - DEBUG - Online update step: 33/50
2025-06-06 15:19:40,453 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:40,454 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:40,454 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:40,455 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:40,455 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:40,455 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:40,456 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:19:40,456 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:40,456 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:40,456 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:40,457 - DEBUG - Applied edge dropout: 49 edges dropped.
2025-06-06 15:19:40,457 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:40,458 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:40,459 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:40,459 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:40,460 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:19:40,461 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:40,691 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:40,711 - DEBUG - Edge anomaly scores shape: torch.Size([12880, 1])
2025-06-06 15:19:40,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:40,713 - DEBUG - Node reconstruction loss: 26.9792
2025-06-06 15:19:40,713 - DEBUG - Edge reconstruction loss: 0.2651
2025-06-06 15:19:40,713 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:40,716 - DEBUG - Online update step: 34/50
2025-06-06 15:19:40,721 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:40,722 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:40,723 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:40,726 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:40,727 - DEBUG - Applied edge dropout: 129 edges dropped.
2025-06-06 15:19:40,727 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:40,728 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:40,729 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:40,729 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:40,730 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:40,730 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:40,730 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:40,730 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:40,730 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:19:40,731 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:40,731 - DEBUG - Applied edge dropout: 108 edges dropped.
2025-06-06 15:19:40,750 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:41,025 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:41,049 - DEBUG - Edge anomaly scores shape: torch.Size([12855, 1])
2025-06-06 15:19:41,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:41,050 - DEBUG - Node reconstruction loss: 27.1953
2025-06-06 15:19:41,051 - DEBUG - Edge reconstruction loss: 0.2112
2025-06-06 15:19:41,051 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:41,053 - DEBUG - Online update step: 35/50
2025-06-06 15:19:41,054 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:41,054 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:41,055 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:41,055 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:41,055 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:41,055 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:41,056 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:41,056 - DEBUG - Applied edge dropout: 126 edges dropped.
2025-06-06 15:19:41,056 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:41,057 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:41,057 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:41,057 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:41,058 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:41,058 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:41,058 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:19:41,059 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:41,078 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:41,332 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:41,353 - DEBUG - Edge anomaly scores shape: torch.Size([12827, 1])
2025-06-06 15:19:41,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:41,355 - DEBUG - Node reconstruction loss: 27.1901
2025-06-06 15:19:41,355 - DEBUG - Edge reconstruction loss: 0.1130
2025-06-06 15:19:41,355 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:41,358 - DEBUG - Online update step: 36/50
2025-06-06 15:19:41,358 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:41,359 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:19:41,359 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:41,360 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:41,360 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:41,360 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:41,360 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:41,361 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:19:41,361 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:19:41,361 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:41,362 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:41,362 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:41,362 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:41,362 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:19:41,363 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:41,363 - DEBUG - Applied edge dropout: 113 edges dropped.
2025-06-06 15:19:41,364 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:41,620 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:41,643 - DEBUG - Edge anomaly scores shape: torch.Size([12797, 1])
2025-06-06 15:19:41,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:41,645 - DEBUG - Node reconstruction loss: 27.2762
2025-06-06 15:19:41,645 - DEBUG - Edge reconstruction loss: 0.2140
2025-06-06 15:19:41,645 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:41,648 - DEBUG - Online update step: 37/50
2025-06-06 15:19:41,649 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:41,649 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:19:41,650 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:41,650 - DEBUG - Applied edge dropout: 30 edges dropped.
2025-06-06 15:19:41,650 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:41,651 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:41,651 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:41,651 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:41,653 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:41,653 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:19:41,654 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:41,655 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:19:41,655 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:41,655 - DEBUG - Applied edge dropout: 129 edges dropped.
2025-06-06 15:19:41,656 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:41,656 - DEBUG - Applied edge dropout: 53 edges dropped.
2025-06-06 15:19:41,657 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:41,919 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:41,940 - DEBUG - Edge anomaly scores shape: torch.Size([12848, 1])
2025-06-06 15:19:41,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:41,942 - DEBUG - Node reconstruction loss: 26.7157
2025-06-06 15:19:41,942 - DEBUG - Edge reconstruction loss: 0.1032
2025-06-06 15:19:41,942 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:41,944 - DEBUG - Online update step: 38/50
2025-06-06 15:19:41,944 - DEBUG - Applied edge dropout: 30 edges dropped.
2025-06-06 15:19:41,945 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:19:41,945 - DEBUG - Applied edge dropout: 58 edges dropped.
2025-06-06 15:19:41,945 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:41,945 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:41,946 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:41,946 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:41,946 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:41,946 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:41,947 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:19:41,947 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:41,948 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-06 15:19:41,948 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:41,948 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:19:41,948 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:41,949 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:41,950 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:42,212 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:42,236 - DEBUG - Edge anomaly scores shape: torch.Size([12807, 1])
2025-06-06 15:19:42,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:42,237 - DEBUG - Node reconstruction loss: 27.1039
2025-06-06 15:19:42,238 - DEBUG - Edge reconstruction loss: 0.2515
2025-06-06 15:19:42,238 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:42,240 - DEBUG - Online update step: 39/50
2025-06-06 15:19:42,241 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:42,241 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:42,241 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:42,242 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:19:42,242 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-06 15:19:42,242 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:42,243 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:42,243 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:19:42,243 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:42,244 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:42,244 - DEBUG - Applied edge dropout: 178 edges dropped.
2025-06-06 15:19:42,244 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:19:42,245 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:42,245 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:42,245 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:42,246 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:42,247 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:42,523 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:42,546 - DEBUG - Edge anomaly scores shape: torch.Size([12750, 1])
2025-06-06 15:19:42,547 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:42,547 - DEBUG - Node reconstruction loss: 27.1740
2025-06-06 15:19:42,548 - DEBUG - Edge reconstruction loss: 0.1354
2025-06-06 15:19:42,548 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:42,550 - DEBUG - Online update step: 40/50
2025-06-06 15:19:42,551 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:42,551 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:42,551 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:42,552 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:42,552 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:42,552 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:42,553 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:42,553 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:42,553 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:42,553 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:42,554 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:42,554 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:42,554 - DEBUG - Applied edge dropout: 105 edges dropped.
2025-06-06 15:19:42,554 - DEBUG - Applied edge dropout: 58 edges dropped.
2025-06-06 15:19:42,555 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:42,555 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:42,577 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:42,812 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:42,833 - DEBUG - Edge anomaly scores shape: torch.Size([12811, 1])
2025-06-06 15:19:42,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:42,834 - DEBUG - Node reconstruction loss: 26.6483
2025-06-06 15:19:42,835 - DEBUG - Edge reconstruction loss: 0.1603
2025-06-06 15:19:42,835 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:42,837 - DEBUG - Online update step: 41/50
2025-06-06 15:19:42,838 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:42,838 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:42,839 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:19:42,839 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:42,840 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:19:42,840 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:42,840 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:42,841 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:19:42,841 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:42,841 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:42,842 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:42,842 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:42,842 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:42,842 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:42,843 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:42,843 - DEBUG - Applied edge dropout: 50 edges dropped.
2025-06-06 15:19:42,844 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:43,119 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:43,141 - DEBUG - Edge anomaly scores shape: torch.Size([12849, 1])
2025-06-06 15:19:43,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:43,142 - DEBUG - Node reconstruction loss: 26.6524
2025-06-06 15:19:43,143 - DEBUG - Edge reconstruction loss: 0.2091
2025-06-06 15:19:43,143 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:43,146 - DEBUG - Online update step: 42/50
2025-06-06 15:19:43,146 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:43,148 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:19:43,149 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:19:43,149 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:43,150 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:43,150 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:43,150 - DEBUG - Applied edge dropout: 67 edges dropped.
2025-06-06 15:19:43,151 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:43,151 - DEBUG - Applied edge dropout: 126 edges dropped.
2025-06-06 15:19:43,151 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:43,152 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:43,152 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:43,152 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:43,153 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:43,154 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:19:43,155 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:43,156 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:43,424 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:43,449 - DEBUG - Edge anomaly scores shape: torch.Size([12857, 1])
2025-06-06 15:19:43,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:43,450 - DEBUG - Node reconstruction loss: 26.4753
2025-06-06 15:19:43,451 - DEBUG - Edge reconstruction loss: 0.1939
2025-06-06 15:19:43,451 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:43,453 - DEBUG - Online update step: 43/50
2025-06-06 15:19:43,454 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:43,454 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:43,455 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:43,455 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:19:43,455 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:43,455 - DEBUG - Applied edge dropout: 72 edges dropped.
2025-06-06 15:19:43,456 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:43,456 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:43,457 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-06 15:19:43,457 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:19:43,457 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:19:43,457 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:43,458 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:43,458 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:43,458 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:43,458 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:19:43,460 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:43,814 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:43,839 - DEBUG - Edge anomaly scores shape: torch.Size([12806, 1])
2025-06-06 15:19:43,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:43,840 - DEBUG - Node reconstruction loss: 26.9982
2025-06-06 15:19:43,841 - DEBUG - Edge reconstruction loss: 0.1149
2025-06-06 15:19:43,841 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:43,843 - DEBUG - Online update step: 44/50
2025-06-06 15:19:43,844 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:43,844 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:43,844 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:43,845 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:43,845 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:19:43,845 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:43,846 - DEBUG - Applied edge dropout: 90 edges dropped.
2025-06-06 15:19:43,846 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:43,846 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:43,846 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:43,847 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:43,847 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:43,847 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:43,848 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:43,848 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:43,848 - DEBUG - Applied edge dropout: 51 edges dropped.
2025-06-06 15:19:43,851 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:44,124 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:44,146 - DEBUG - Edge anomaly scores shape: torch.Size([12797, 1])
2025-06-06 15:19:44,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:44,149 - DEBUG - Node reconstruction loss: 26.1367
2025-06-06 15:19:44,149 - DEBUG - Edge reconstruction loss: 0.0619
2025-06-06 15:19:44,149 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:44,151 - DEBUG - Online update step: 45/50
2025-06-06 15:19:44,152 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:44,152 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:44,153 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:44,153 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:19:44,153 - DEBUG - Applied edge dropout: 131 edges dropped.
2025-06-06 15:19:44,153 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:44,154 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:44,154 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:44,154 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:44,154 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:44,156 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:44,156 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:44,156 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:44,157 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:19:44,157 - DEBUG - Applied edge dropout: 82 edges dropped.
2025-06-06 15:19:44,157 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:19:44,169 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:44,486 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:44,505 - DEBUG - Edge anomaly scores shape: torch.Size([12875, 1])
2025-06-06 15:19:44,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:44,506 - DEBUG - Node reconstruction loss: 27.6304
2025-06-06 15:19:44,507 - DEBUG - Edge reconstruction loss: 0.2143
2025-06-06 15:19:44,507 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:44,509 - DEBUG - Online update step: 46/50
2025-06-06 15:19:44,510 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:44,510 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:44,510 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:44,511 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:44,511 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:44,511 - DEBUG - Applied edge dropout: 42 edges dropped.
2025-06-06 15:19:44,511 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:19:44,512 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:44,512 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:19:44,512 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:44,513 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:19:44,513 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:44,513 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:44,514 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:44,514 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:19:44,514 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:44,515 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:44,808 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:44,830 - DEBUG - Edge anomaly scores shape: torch.Size([12784, 1])
2025-06-06 15:19:44,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:44,831 - DEBUG - Node reconstruction loss: 27.2512
2025-06-06 15:19:44,831 - DEBUG - Edge reconstruction loss: 0.2115
2025-06-06 15:19:44,831 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:44,834 - DEBUG - Online update step: 47/50
2025-06-06 15:19:44,835 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:44,835 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:44,835 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:44,836 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:44,836 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:19:44,837 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:44,837 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:44,837 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:19:44,838 - DEBUG - Applied edge dropout: 72 edges dropped.
2025-06-06 15:19:44,838 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:44,838 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:44,839 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:44,839 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:44,839 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:44,839 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:44,839 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:19:44,841 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:45,085 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:45,107 - DEBUG - Edge anomaly scores shape: torch.Size([12869, 1])
2025-06-06 15:19:45,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:45,108 - DEBUG - Node reconstruction loss: 26.3271
2025-06-06 15:19:45,108 - DEBUG - Edge reconstruction loss: 0.3049
2025-06-06 15:19:45,109 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:45,111 - DEBUG - Online update step: 48/50
2025-06-06 15:19:45,112 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-06 15:19:45,113 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:19:45,113 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:45,114 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:45,114 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:45,114 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:45,115 - DEBUG - Applied edge dropout: 120 edges dropped.
2025-06-06 15:19:45,116 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:45,116 - DEBUG - Applied edge dropout: 104 edges dropped.
2025-06-06 15:19:45,116 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:45,117 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:45,117 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:45,117 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:45,118 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:19:45,118 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:45,118 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:45,119 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:45,392 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:45,427 - DEBUG - Edge anomaly scores shape: torch.Size([12817, 1])
2025-06-06 15:19:45,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:45,447 - DEBUG - Node reconstruction loss: 26.2612
2025-06-06 15:19:45,450 - DEBUG - Edge reconstruction loss: 0.1273
2025-06-06 15:19:45,450 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:45,452 - DEBUG - Online update step: 49/50
2025-06-06 15:19:45,452 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:45,453 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:45,453 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:45,454 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:19:45,454 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:45,454 - DEBUG - Applied edge dropout: 184 edges dropped.
2025-06-06 15:19:45,454 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:45,459 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:45,459 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:45,459 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:45,460 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:19:45,460 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:45,460 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:45,460 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:45,461 - DEBUG - Applied edge dropout: 33 edges dropped.
2025-06-06 15:19:45,462 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:45,463 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:46,311 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:46,339 - DEBUG - Edge anomaly scores shape: torch.Size([12767, 1])
2025-06-06 15:19:46,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:46,340 - DEBUG - Node reconstruction loss: 26.5090
2025-06-06 15:19:46,341 - DEBUG - Edge reconstruction loss: 0.0874
2025-06-06 15:19:46,342 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:46,344 - DEBUG - Online update step: 50/50
2025-06-06 15:19:46,345 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:46,345 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:46,345 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:19:46,345 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:46,356 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:46,357 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:46,357 - DEBUG - Applied edge dropout: 58 edges dropped.
2025-06-06 15:19:46,357 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:46,375 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:46,375 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:46,378 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:46,378 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:46,378 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:46,379 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:46,382 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:19:46,382 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:46,400 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:46,680 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:46,700 - DEBUG - Edge anomaly scores shape: torch.Size([12850, 1])
2025-06-06 15:19:46,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:46,701 - DEBUG - Node reconstruction loss: 27.5750
2025-06-06 15:19:46,701 - DEBUG - Edge reconstruction loss: 0.2164
2025-06-06 15:19:46,702 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:46,704 - WARNING - No successful steps during online update.
2025-06-06 15:19:46,705 - DEBUG - Current node mean: [ 1.31294335e-08 -1.31294335e-08 -1.67101888e-08 -6.56471677e-09
  1.13390559e-08  3.16299982e-08  7.75830156e-09  6.56471677e-09
  1.43230183e-08 -2.14845279e-08  1.79037727e-08 -3.58075458e-09
  5.37113198e-09  1.25326416e-08  1.13390559e-08 -1.19358490e-09
  0.00000000e+00 -2.32749056e-08 -3.81947167e-08], current edge mean: [ 1.4202561e+00  4.9732246e+00 -4.4408583e-09  0.0000000e+00
  1.1102146e-09  1.1102146e-09  3.3306438e-09 -6.6612875e-09
  4.4408583e-09 -5.5510729e-09  1.1102146e-09  7.7715017e-09
 -2.2204292e-09 -1.9983862e-08  1.9983862e-08 -2.2204292e-09
 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09
 -2.2204292e-09  2.2204292e-09]
2025-06-06 15:19:46,705 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2397
2025-06-06 15:19:46,705 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:19:46,705 - DEBUG - Updated reference mean: node=[ 1.31294335e-08 -1.31294335e-08 -1.67101888e-08 -6.56471677e-09
  1.13390559e-08  3.16299982e-08  7.75830156e-09  6.56471677e-09
  1.43230183e-08 -2.14845279e-08  1.79037727e-08 -3.58075458e-09
  5.37113198e-09  1.25326416e-08  1.13390559e-08 -1.19358490e-09
  0.00000000e+00 -2.32749056e-08 -3.81947167e-08], edge=[ 1.4202561e+00  4.9732246e+00 -4.4408583e-09  0.0000000e+00
  1.1102146e-09  1.1102146e-09  3.3306438e-09 -6.6612875e-09
  4.4408583e-09 -5.5510729e-09  1.1102146e-09  7.7715017e-09
 -2.2204292e-09 -1.9983862e-08  1.9983862e-08 -2.2204292e-09
 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09
 -2.2204292e-09  2.2204292e-09]
2025-06-06 15:19:46,706 - DEBUG - Updated reference std: node=[1.0006263 1.0006263 1.0006263 1.0006264 1.0006264 1.0006263 1.0006264
 1.0006263 1.0006263 1.0006263 1.0006264 1.0006263 1.0006263 1.0006263
 1.0006263 1.0006263 1.0006263 1.0006263 1.0006264], edge=[0.5077014 1.7833711 1.0002911 1.0002911 1.0002911 1.0002912 1.0002911
 1.0002911 1.0002911 1.0002911 1.0002912 1.0002911 1.0002911 1.0002912
 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911
 1.0002912]
2025-06-06 15:19:46,706 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:19:46,706 - INFO - Running anomaly detection...
2025-06-06 15:19:46,706 - INFO - Starting anomaly detection.
2025-06-06 15:19:46,724 - DEBUG - Node reconstruction errors: [5.3491940e+00 5.3491940e+00 8.0678247e+02 9.8158664e-01 1.3875730e+00
 9.8158664e-01 1.3875730e+00 9.8158664e-01 1.9430633e+00 1.7540544e+00
 8.1518877e-01 1.1986988e+00 8.1518877e-01 8.1518877e-01 8.1518877e-01
 8.1518877e-01 7.1034038e-01 7.7687091e-01 1.0905991e+00 7.1034038e-01
 7.1034038e-01 7.1034038e-01 8.7534791e-01 7.1034038e-01 7.1034038e-01
 7.1034038e-01 1.2215976e+00 1.5450650e+00 1.2215976e+00 7.1034038e-01
 1.3875730e+00 7.1034038e-01 1.6382746e+00 9.5008673e+02 7.1034038e-01
 7.8004998e-01 6.5223694e-01 1.0492879e+00 6.5223694e-01 1.0492879e+00
 9.8158664e-01 1.2386247e+00 6.3341564e-01 6.3341564e-01 9.0690625e-01
 6.3341564e-01 9.0690625e-01 6.3341564e-01 7.7687091e-01 6.3341564e-01
 6.3341564e-01 6.6078550e-01 6.3341564e-01 6.3341564e-01 9.1752214e+00
 7.1312582e-01 1.2521197e+00 6.3341564e-01 6.3341564e-01 6.3341564e-01
 9.1111833e-01 6.3341564e-01 6.3341564e-01 7.1034038e-01 6.3341564e-01
 9.4414639e-01 9.5955735e-01 6.4548898e-01 6.4548898e-01 6.4548898e-01
 8.1178319e-01 9.8231268e-01 6.4548898e-01 8.3003503e-01 8.3003503e-01
 7.1034038e-01 1.5678692e+00 8.3003503e-01 8.3003497e-01 1.0083443e+00
 1.5432715e+00 8.0968493e-01 8.0968493e-01 6.4548898e-01 8.3003503e-01
 6.4548898e-01 9.5955735e-01 8.3003503e-01 7.4139363e-01 8.3003503e-01
 8.3003503e-01 5.7564032e-01 8.1178319e-01 6.4548898e-01 8.6673670e+00
 6.4548898e-01 6.4548898e-01 6.4548898e-01 6.4548898e-01 6.4548898e-01
 6.4548898e-01 6.4548898e-01 8.1518877e-01 8.3232915e-01 1.2605763e+01
 8.0490124e-01 6.7006391e-01 6.7309582e-01 6.7006391e-01 6.7006391e-01
 8.5764933e-01 6.7006391e-01 6.7006391e-01 6.7006391e-01 6.7006391e-01
 6.7006391e-01 6.7006391e-01 7.6935095e-01 6.7309582e-01 6.7006391e-01
 6.5699756e-01 1.1607294e+00 6.7006391e-01 9.1922921e-01 5.7895488e-01
 6.7006391e-01 5.6970388e-01 8.0895364e-01 5.7740825e-01 7.8447247e-01
 5.6970388e-01 5.7740825e-01 6.7006391e-01 6.7006391e-01 6.7309582e-01
 6.7006391e-01 6.7006391e-01 8.0490124e-01 6.4548898e-01 9.8309630e-01
 6.4548898e-01 6.7006391e-01 1.2215976e+00 6.7006391e-01 6.7309582e-01
 6.7006391e-01 6.7006391e-01 6.7006391e-01 8.0490124e-01 6.7309582e-01
 6.7006391e-01 6.7006391e-01 7.6935095e-01 8.1518877e-01 6.5699756e-01
 6.7309582e-01 6.7006391e-01 8.1518877e-01 6.7309576e-01 6.7006379e-01
 6.7006391e-01 6.7006391e-01 7.9602844e-01 7.5364095e-01 6.7309582e-01
 6.7309582e-01 1.2792202e+00 8.1518877e-01 9.3247646e-01 1.0252098e+00
 9.9061865e-01 8.0490124e-01 1.0578583e+00 7.5364095e-01 1.8466166e+00
 7.0779315e+02 6.5223694e-01 8.1408679e-01 7.1034038e-01 2.1906922e+00
 1.1036143e+00 9.7258568e-01 1.1986988e+00 7.9120380e-01 1.2505096e+00
 9.7258568e-01 2.1242173e+00 1.1882286e+00 9.6859026e-01 8.6464369e-01
 9.8158664e-01 9.8352891e-01 1.1882286e+00 8.6116010e-01 9.1339272e-01
 1.8269846e+00 8.0192709e-01 6.4548898e-01 1.1331154e+00 8.6464369e-01
 1.4539995e+00 9.1339272e-01 1.6570898e+00 1.0557067e+00 9.6859026e-01
 1.1766557e+00 7.6012367e-01 9.1118228e-01 6.7006391e-01 9.6859026e-01
 7.6528126e-01 9.6859026e-01 2.9904043e+01 1.3010412e+00 7.8194755e-01
 8.5234350e-01 1.6559489e+00 1.4263386e+00 8.3492827e-01 1.8037958e+00
 7.8004998e-01 9.7545475e-01 2.2995960e+01 1.8269846e+00 1.0461268e+00
 2.9292438e+00 8.3492827e-01 6.7006391e-01 1.2194268e+00 9.2199147e-01
 8.6079836e-01 1.5963362e+00 9.1339272e-01 2.1187277e+00 6.3341564e-01
 1.3436045e+03 8.9390200e-01 7.5364095e-01 9.7258556e-01 7.6306897e-01
 1.9147010e+00 9.4162029e-01 6.5223694e-01 6.7006391e-01 9.7545475e-01
 6.7309582e-01 9.7545475e-01 1.4735132e+00 1.6559489e+00 1.4205551e+00
 9.1118228e-01 1.7112377e+00 1.8939795e+00 8.0490124e-01 1.9888842e+00
 9.1529423e-01 1.9842260e+01 8.3190644e-01 8.6695662e+00 6.7309582e-01
 1.0122061e+00 7.8194755e-01 7.9120380e-01 9.1118228e-01 8.6150819e-01
 9.4162029e-01 7.8150058e-01 1.5298480e+00 9.4162029e-01 8.6464369e-01
 8.5726708e-01 9.4162029e-01 1.0132385e+00 2.1187277e+00 1.0122061e+00
 9.6859026e-01 1.7088709e+00 1.9430633e+00 6.7309582e-01 9.8352891e-01
 2.3500752e+00 6.7309582e-01 1.2194268e+00 1.1229538e+00 8.1309640e-01
 1.7797362e+00 1.7891670e+00 1.3141606e+00 1.3368711e+00 6.4548898e-01
 6.4548898e-01 9.4123459e-01 1.5380130e+00 9.6859026e-01 1.4735132e+00
 1.7671523e+00 2.6039865e+00 7.8062170e+02 2.6017736e+01 1.8917919e+00
 1.0088048e+00 1.5059963e+00 1.5383576e+00 6.4548898e-01 7.6935095e-01
 2.0384211e+01 6.7006391e-01 9.7545475e-01 1.6559489e+00 1.4670801e+00
 7.9120380e-01 7.9120380e-01 1.6029711e+00 6.4548898e-01 9.7258568e-01
 7.9379663e+02 7.3611498e-01 1.2194268e+00 8.7048662e-01 1.3779582e+00
 8.9390200e-01 2.0497617e+03 1.0122061e+00 1.0492879e+00 1.4231151e+00
 1.5017263e+01 1.5796074e+00 7.6306909e-01 3.7877748e+00 5.5754623e+00
 1.1675444e+00 6.7006391e-01 6.3358870e+00 8.6116010e-01 8.0192709e-01
 1.9075773e+00 8.0192709e-01 7.8447247e-01 8.3492827e-01 8.5822475e-01
 1.6559489e+00 1.6559489e+00 1.4735132e+00 1.6559489e+00 7.6306909e-01
 9.7545475e-01 1.0274028e+00 1.6559489e+00 7.1563011e-01 1.1719688e+00
 2.7507463e+00 8.7048620e-01 1.6559489e+00 1.0895709e+00 5.3805823e+00
 2.2360961e+00 1.0131164e+00 1.0037805e+00 1.7655320e+00 9.1118228e-01
 9.8352891e-01 1.0122061e+00 9.3462169e-01 1.4612736e+00 8.9390200e-01
 8.6464369e-01 2.1401672e+00 8.0805092e+00 1.7400271e+03 8.3190644e-01
 1.3141606e+00 1.1561227e+00 1.7274411e+00 1.8269846e+00 9.1118228e-01
 1.2213478e+00 9.7545475e-01 1.0762473e+00 1.2215976e+00 2.1311159e+00
 9.6859026e-01 7.1034038e-01 1.0671877e+00 8.9390200e-01 9.4162029e-01
 9.1529423e-01 8.5583234e-01 8.5822475e-01 6.7006391e-01 6.3341564e-01
 9.7545475e-01 1.6559489e+00 1.1472362e+00 6.7309582e-01 1.8269846e+00
 1.5461863e+00 6.7006391e-01 1.6559489e+00 1.8437647e+00 1.7034481e+00
 7.6935095e-01 1.8269846e+00 1.8269846e+00 1.3523940e+00 6.9426966e-01
 1.1561227e+00 8.5393614e-01 1.1882286e+00 8.1078857e-01 1.0088048e+00
 2.2637799e+00 6.7006391e-01 3.0642159e+00 9.6859026e-01 7.6528126e-01
 6.3341564e-01 1.5318025e+00 1.0083445e+00 1.6559489e+00 9.7258568e-01
 8.8243562e-01 2.0348182e+00 1.3945957e+00 1.0088048e+00 2.8458350e+00
 1.2792202e+00 9.7258568e-01 7.1563011e-01 8.5393614e-01 8.9390200e-01
 1.6336581e+00 1.3141606e+00 7.7687091e-01 1.3563416e+00 8.5393614e-01
 1.0905991e+00 8.7630481e-01 6.7006391e-01 1.1412686e+00 2.1906922e+00
 1.3141606e+00 7.6306909e-01 1.1370382e+00 6.4548898e-01 7.6528126e-01
 7.8605157e-01 1.5194038e+00 7.4873680e-01 6.4548898e-01 1.2006902e+00
 1.2041407e+00 7.9602844e-01 7.6935095e-01 6.7006391e-01 1.5273062e+00
 2.2602739e+00 7.4873680e-01 6.7309582e-01 9.3247646e-01 2.7014191e+00
 1.3704338e+00 1.2040248e+00 1.1241446e+00 1.8037958e+00 9.8651946e-01
 6.4548898e-01 7.2842407e+00 1.1561227e+00 9.7545475e-01 7.9326165e-01
 6.3341564e-01 6.7006391e-01 1.2006902e+00 1.3563416e+00 7.1563011e-01
 8.3003503e-01 1.0122061e+00 9.8651946e-01 2.2832890e+00 8.0433553e-01
 8.7048620e-01 9.4141150e+02 8.6150819e-01 9.4141150e+02 1.7327056e+00
 2.0731874e+00 9.7258568e-01 1.0274028e+00 9.3247646e-01 1.0274028e+00
 5.3796472e+02 1.0571450e+00 7.9120380e-01 7.3772353e-01 6.7006391e-01
 9.4162029e-01 7.6306909e-01 9.1118228e-01 7.6935095e-01 8.7048620e-01
 7.4035478e-01 1.1675444e+00 8.5393614e-01 3.7877748e+00 8.0490124e-01
 6.7309582e-01 7.8447247e-01 7.3611498e-01 7.3772353e-01 9.0118819e-01
 8.2543486e-01 8.6988297e+00 8.3190644e-01 7.2862464e-01 7.3611498e-01
 8.1371365e+00 1.0765592e+00 8.9390200e-01 8.9390200e-01 8.9390200e-01
 7.6306909e-01 7.1186519e-01 1.0252098e+00 8.7048620e-01 8.9390200e-01
 9.8352891e-01 8.3868408e-01 2.0251701e+00 8.9390200e-01 7.2008806e-01
 7.4408883e-01 7.8799045e-01 9.8158664e-01 1.3226905e+00 2.3880417e+00
 8.6116010e-01 1.6624700e+00 1.6187003e+00 8.6116010e-01 8.6116010e-01
 1.0083358e+00 8.8243562e-01 1.0301622e+00 1.8037958e+00 1.0301622e+00
 4.5109572e+00 1.4670801e+00 8.6917503e+01 6.7006391e-01 9.7545475e-01
 8.6116010e-01 1.4450774e+00 1.8466166e+00 7.8340757e-01 7.6817179e-01
 1.7117542e+00 8.6116010e-01 7.2862464e-01 7.9120368e-01 7.8605163e-01
 5.2875710e+00 8.6116010e-01 8.2322550e-01 1.3875730e+00 1.0755622e+00
 8.5583234e-01 8.6116010e-01 8.1408679e-01 7.9120380e-01 7.6817179e-01
 5.3336444e+00 3.4012764e+00 8.6464369e-01 6.7006391e-01 1.2614176e+00
 8.6116010e-01 8.9390200e-01 1.3533220e+00 8.6116010e-01 1.8269846e+00
 8.7048620e-01 8.6116010e-01 8.8243562e-01 6.7006391e-01 1.0314634e+00
 1.3844055e+00 9.6913451e-01 9.3793344e-01 9.7545475e-01 1.5298480e+00
 8.8243562e-01 7.8799045e-01 9.7897428e-01 8.3492827e-01 2.0582325e+00
 8.9666015e-01 7.6306909e-01 8.9390200e-01 7.6935095e-01 8.1078857e-01
 1.4735132e+00 1.0519203e+00 9.8158664e-01 7.4408883e-01 6.3341564e-01
 9.4162029e-01 7.6306909e-01 1.6382746e+00 1.0083358e+00 7.8150058e-01
 6.7309582e-01 7.9120380e-01 8.1518877e-01 9.0170711e-01 9.1339272e-01
 7.9120380e-01 7.9120380e-01 6.3341564e-01 7.9120380e-01 7.6935095e-01
 1.0132385e+00 8.8243562e-01 7.9326165e-01 7.7315485e-01 6.7006391e-01
 1.1719688e+00 8.6464369e-01 7.5019568e-01 7.8447247e-01 8.8243562e-01
 7.6935095e-01 8.6767548e-01 7.9120380e-01 6.7309582e-01 1.1039046e+00
 1.0144780e+00 8.0490124e-01 1.8969682e+00 5.3491936e+00 7.9120368e-01
 8.1408679e-01 7.8074592e-01 7.4377900e-01 1.4468725e+00 1.2282032e+00
 7.3611498e-01 6.5699756e-01 7.9120380e-01 7.9120380e-01 7.7687091e-01
 1.2006902e+00 9.3969379e+02 1.6080972e+00 6.7309582e-01 8.1408679e-01
 7.6306909e-01 1.7748454e+00 2.0940616e+00 1.6080972e+00 7.1186519e-01
 1.0122061e+00 1.1841495e+00 1.4205551e+00 8.1408679e-01 7.8447247e-01
 6.7309582e-01 8.6464369e-01 7.6276869e-01 7.8605157e-01 2.4182448e+00
 7.9120380e-01 7.9120380e-01 7.8340757e-01 1.0144780e+00 8.9390200e-01
 7.4873680e-01 1.0451887e+00 7.8605157e-01 7.8074592e-01 9.8158664e-01
 8.2543486e-01 1.3881315e+00 1.0269529e+00 7.8328264e-01 8.8371506e+00
 7.4873680e-01 7.9120380e-01 7.6935095e-01 8.0490124e-01 7.8605157e-01
 8.0490124e-01 8.1408679e-01 1.0895709e+00 7.1563011e-01 6.4548898e-01
 1.7252461e+00 6.7006391e-01 6.7006391e-01 7.2008806e-01 1.7252461e+00
 7.6306909e-01 7.6306909e-01 8.1518877e-01 2.2357495e+00 7.6306909e-01
 7.7687091e-01 7.8605157e-01 9.3247646e-01 7.5497472e-01 7.9120380e-01
 9.0170711e-01 9.8158664e-01 9.3421535e+00 1.6080972e+00 9.1733724e-01
 1.1810799e+00 9.8158664e-01 9.1118228e-01 7.3611492e-01 8.7462920e-01
 7.5497472e-01 8.5822475e-01 7.9184991e-01 1.9430633e+00 6.5223694e-01
 9.9285680e-01 7.8605157e-01 7.2008806e-01 7.3611498e-01 7.8150058e-01
 8.7462920e-01 7.1034038e-01 7.9184991e-01 7.8328264e-01 7.2008806e-01
 7.9377288e-01 1.1554762e+00 7.2008806e-01 6.7006391e-01 6.7006391e-01
 7.4139363e-01 7.2008806e-01 7.6012367e-01 7.1186519e-01 7.3611498e-01
 7.8605157e-01 1.4942801e+00 7.8605157e-01 9.8158664e-01 1.6559489e+00
 7.3611498e-01 7.1186519e-01 7.1563011e-01 6.7006391e-01 7.3611498e-01
 6.7006391e-01 6.7006391e-01 1.0122061e+00 6.7006391e-01 8.5909575e-01
 7.2008806e-01 7.3611498e-01 1.2691588e+00 7.3772353e-01 8.7462920e-01
 7.9377288e-01 1.4612736e+00 8.5822475e-01 6.3341564e-01 1.3250465e+00
 7.8447247e-01 2.0731874e+00 8.0490124e-01 9.8158664e-01 6.9426966e-01
 8.1518877e-01 9.8309630e-01 6.7006391e-01 7.8447247e-01 8.6767548e-01
 7.6935095e-01 7.6935095e-01 7.6935095e-01 7.6935095e-01 7.9848294e+00
 6.7006391e-01 8.1178319e-01 7.8447247e-01 6.7006391e-01 7.8447247e-01
 9.8309630e-01 1.3881315e+00 7.6935095e-01 8.0490124e-01 7.0793927e+02
 9.1922921e-01 9.1111833e-01 1.4021482e+00 9.8309630e-01]
2025-06-06 15:19:46,725 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:19:46,727 - ERROR - An error occurred while processing file nw_graph_encoded_1749046127.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:19:46,727 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:19:46,727 - INFO - 
--- Processing file: nw_graph_encoded_1749046187.dot ---
2025-06-06 15:19:46,727 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749046187.dot
2025-06-06 15:19:46,727 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749046187.dot file.
2025-06-06 15:19:46,745 - INFO - Parsed 974 nodes.
2025-06-06 15:19:46,768 - INFO - Parsed 2053 edges.
2025-06-06 15:19:47,480 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:19:47,480 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:19:47,486 - DEBUG - Initial node features tensor shape: torch.Size([974, 19])
2025-06-06 15:19:47,496 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:19:47,499 - DEBUG - Node features tensor shape after scaling: torch.Size([974, 19])
2025-06-06 15:19:47,501 - DEBUG - Edge index tensor shape: torch.Size([2, 2053])
2025-06-06 15:19:47,501 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:19:47,515 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:19:47,516 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-06 15:19:47,518 - DEBUG - Shape of encoded categorical edge features: torch.Size([2053, 2])
2025-06-06 15:19:47,519 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:19:47,520 - DEBUG - Shape of scaled numerical edge features: torch.Size([2053, 20])
2025-06-06 15:19:47,520 - DEBUG - Final edge attributes tensor shape: torch.Size([2053, 22])
2025-06-06 15:19:47,520 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:19:47,520 - INFO - Performing online update...
2025-06-06 15:19:47,520 - INFO - Starting online update for 50 steps.
2025-06-06 15:19:47,520 - DEBUG - Updated RunningStats: new_mean=[ 3.43419309e-10 -3.97988398e-10 -2.89168533e-09  2.20249571e-09
 -2.46196680e-08  1.33175887e-08 -9.37113429e-09 -2.24431385e-09
 -2.87739712e-09  1.01305093e-09  1.65368317e-09 -1.39746889e-09
  3.58102323e-09 -3.21370307e-09  1.01616338e-09  9.01200846e-10
 -3.89751084e-09  1.03768793e-09 -4.53135843e-09], new_M2=[202575.00511047 202575.0050634  202575.0002169  202575.00438285
 202574.99854269 202574.99847856 202574.99598886 202574.99813642
 202574.99318211 202574.99847657 202575.00184766 202574.99396211
 202574.99282355 162783.99666905 162784.00011987 162783.99881287
 162783.99995482 202575.00019427 202575.00763579], new_n=202575
2025-06-06 15:19:47,521 - DEBUG - Updated RunningStats: new_mean=[ 1.41461981e+00  5.47893804e+00  9.53441657e-11  2.49380455e-10
  1.37496054e-10 -1.55371648e-10 -1.19153651e-09  2.09544900e-10
  2.66959762e-10 -1.53855983e-10  3.06488873e-10 -3.31699323e-09
 -8.40901293e-10  6.71311713e-11  2.57626575e-10 -1.50547920e-10
 -1.50547920e-10 -1.50547920e-10 -1.50547920e-10 -1.50547920e-10
 -1.50547920e-10 -8.09708422e-11], new_M2=[ 112093.66201634 1937320.36179037  435381.99891708  435382.00589874
  435382.00569018  435381.99327594  435382.00033105  435381.9991811
  435382.00164491  435381.99925834  435381.9942078   435382.00842671
  435382.00110536  435381.99999415  435382.00172737  435381.99447395
  435381.99447395  435381.99447395  435381.99447395  435381.99447395
  435381.99447395  435381.99897398], new_n=435382
2025-06-06 15:19:47,521 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999999
 0.99999998 0.89642287 0.89642288 0.89642288 0.89642288 1.
 1.00000002]
2025-06-06 15:19:47,521 - DEBUG - Calculated standard deviation: [0.50740564 2.10943179 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:19:47,521 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:19:47,521 - DEBUG - Online update step: 1/50
2025-06-06 15:19:47,522 - DEBUG - Applied edge dropout: 184 edges dropped.
2025-06-06 15:19:47,522 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:47,522 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:47,522 - DEBUG - Applied edge dropout: 94 edges dropped.
2025-06-06 15:19:47,523 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-06 15:19:47,523 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:47,523 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:47,524 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:47,524 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:47,524 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:19:47,524 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:47,524 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:47,525 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:47,525 - DEBUG - Applied edge dropout: 58 edges dropped.
2025-06-06 15:19:47,525 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:47,525 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:47,526 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:47,794 - DEBUG - Node anomaly scores shape: torch.Size([7735, 1])
2025-06-06 15:19:47,816 - DEBUG - Edge anomaly scores shape: torch.Size([14317, 1])
2025-06-06 15:19:47,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:47,817 - DEBUG - Node reconstruction loss: 26.7984
2025-06-06 15:19:47,818 - DEBUG - Edge reconstruction loss: 0.1807
2025-06-06 15:19:47,818 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:47,820 - DEBUG - Online update step: 2/50
2025-06-06 15:19:47,821 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:47,821 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:47,822 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:47,822 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:47,822 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:47,822 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:19:47,823 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:47,823 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:47,823 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:47,824 - DEBUG - Applied edge dropout: 57 edges dropped.
2025-06-06 15:19:47,824 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-06 15:19:47,824 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:47,825 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:47,825 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:19:47,825 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:47,825 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:47,827 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:48,119 - DEBUG - Node anomaly scores shape: torch.Size([7928, 1])
2025-06-06 15:19:48,144 - DEBUG - Edge anomaly scores shape: torch.Size([14671, 1])
2025-06-06 15:19:48,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:48,145 - DEBUG - Node reconstruction loss: 27.3568
2025-06-06 15:19:48,146 - DEBUG - Edge reconstruction loss: 0.2403
2025-06-06 15:19:48,146 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:48,148 - DEBUG - Online update step: 3/50
2025-06-06 15:19:48,149 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:48,150 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:48,150 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:48,150 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:48,151 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-06 15:19:48,151 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:48,151 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:19:48,151 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:48,152 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-06 15:19:48,152 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:48,152 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:48,152 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:48,154 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:48,154 - DEBUG - Applied edge dropout: 112 edges dropped.
2025-06-06 15:19:48,154 - DEBUG - Applied edge dropout: 107 edges dropped.
2025-06-06 15:19:48,155 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:19:48,156 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:48,493 - DEBUG - Node anomaly scores shape: torch.Size([7231, 1])
2025-06-06 15:19:48,515 - DEBUG - Edge anomaly scores shape: torch.Size([13183, 1])
2025-06-06 15:19:48,516 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:48,516 - DEBUG - Node reconstruction loss: 27.6969
2025-06-06 15:19:48,517 - DEBUG - Edge reconstruction loss: 0.2941
2025-06-06 15:19:48,517 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:48,520 - DEBUG - Online update step: 4/50
2025-06-06 15:19:48,521 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:48,522 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:48,522 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:48,522 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:48,522 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:48,523 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:48,523 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-06 15:19:48,524 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:48,524 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:48,524 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:19:48,524 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:48,525 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:48,525 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:48,525 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:48,526 - DEBUG - Applied edge dropout: 42 edges dropped.
2025-06-06 15:19:48,526 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:48,531 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:48,805 - DEBUG - Node anomaly scores shape: torch.Size([7481, 1])
2025-06-06 15:19:48,829 - DEBUG - Edge anomaly scores shape: torch.Size([13712, 1])
2025-06-06 15:19:48,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:48,831 - DEBUG - Node reconstruction loss: 26.0045
2025-06-06 15:19:48,831 - DEBUG - Edge reconstruction loss: 0.4206
2025-06-06 15:19:48,831 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:48,833 - DEBUG - Online update step: 5/50
2025-06-06 15:19:48,834 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:19:48,834 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:48,834 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:48,835 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:48,835 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:48,835 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:48,836 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-06 15:19:48,836 - DEBUG - Applied edge dropout: 43 edges dropped.
2025-06-06 15:19:48,836 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:48,836 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:48,837 - DEBUG - Applied edge dropout: 98 edges dropped.
2025-06-06 15:19:48,837 - DEBUG - Applied edge dropout: 56 edges dropped.
2025-06-06 15:19:48,837 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:48,838 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:48,838 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:19:48,838 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:48,839 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:49,207 - DEBUG - Node anomaly scores shape: torch.Size([7571, 1])
2025-06-06 15:19:49,238 - DEBUG - Edge anomaly scores shape: torch.Size([13988, 1])
2025-06-06 15:19:49,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:49,241 - DEBUG - Node reconstruction loss: 27.4523
2025-06-06 15:19:49,241 - DEBUG - Edge reconstruction loss: 0.0577
2025-06-06 15:19:49,241 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:49,244 - DEBUG - Online update step: 6/50
2025-06-06 15:19:49,244 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:49,245 - DEBUG - Applied edge dropout: 48 edges dropped.
2025-06-06 15:19:49,245 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:49,245 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:49,246 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:49,246 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:49,246 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:49,246 - DEBUG - Applied edge dropout: 118 edges dropped.
2025-06-06 15:19:49,247 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-06 15:19:49,247 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:49,247 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-06 15:19:49,248 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:49,248 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:49,248 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:49,248 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:49,249 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:49,273 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:49,539 - DEBUG - Node anomaly scores shape: torch.Size([7194, 1])
2025-06-06 15:19:49,559 - DEBUG - Edge anomaly scores shape: torch.Size([13085, 1])
2025-06-06 15:19:49,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:49,560 - DEBUG - Node reconstruction loss: 26.6515
2025-06-06 15:19:49,561 - DEBUG - Edge reconstruction loss: 0.1234
2025-06-06 15:19:49,561 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:49,563 - DEBUG - Online update step: 7/50
2025-06-06 15:19:49,564 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:49,564 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:49,565 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:49,565 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:49,565 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:49,565 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:49,566 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:49,566 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:49,566 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:49,566 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:49,567 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:49,567 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:49,567 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:19:49,568 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:49,568 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-06 15:19:49,568 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:49,569 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:50,083 - DEBUG - Node anomaly scores shape: torch.Size([7628, 1])
2025-06-06 15:19:50,106 - DEBUG - Edge anomaly scores shape: torch.Size([14071, 1])
2025-06-06 15:19:50,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:50,110 - DEBUG - Node reconstruction loss: 27.5788
2025-06-06 15:19:50,110 - DEBUG - Edge reconstruction loss: 0.0744
2025-06-06 15:19:50,110 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:50,113 - DEBUG - Online update step: 8/50
2025-06-06 15:19:50,114 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:50,117 - DEBUG - Applied edge dropout: 53 edges dropped.
2025-06-06 15:19:50,118 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-06 15:19:50,119 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:50,121 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:50,121 - DEBUG - Applied edge dropout: 110 edges dropped.
2025-06-06 15:19:50,126 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:50,126 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:50,133 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:50,133 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:50,133 - DEBUG - Applied edge dropout: 113 edges dropped.
2025-06-06 15:19:50,134 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:50,134 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:50,134 - DEBUG - Applied edge dropout: 54 edges dropped.
2025-06-06 15:19:50,135 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:19:50,135 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:19:50,146 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:50,893 - DEBUG - Node anomaly scores shape: torch.Size([7862, 1])
2025-06-06 15:19:50,929 - DEBUG - Edge anomaly scores shape: torch.Size([14548, 1])
2025-06-06 15:19:50,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:50,931 - DEBUG - Node reconstruction loss: 26.5728
2025-06-06 15:19:50,932 - DEBUG - Edge reconstruction loss: 0.2008
2025-06-06 15:19:50,932 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:50,934 - DEBUG - Online update step: 9/50
2025-06-06 15:19:50,935 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:50,935 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:50,935 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:50,935 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:50,936 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:50,936 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:50,936 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:19:50,936 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:50,937 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:50,937 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:19:50,937 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:19:50,938 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:50,938 - DEBUG - Applied edge dropout: 117 edges dropped.
2025-06-06 15:19:50,938 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:50,938 - DEBUG - Applied edge dropout: 101 edges dropped.
2025-06-06 15:19:50,939 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:50,940 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:51,401 - DEBUG - Node anomaly scores shape: torch.Size([7571, 1])
2025-06-06 15:19:51,463 - DEBUG - Edge anomaly scores shape: torch.Size([13932, 1])
2025-06-06 15:19:51,464 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:51,465 - DEBUG - Node reconstruction loss: 27.9555
2025-06-06 15:19:51,465 - DEBUG - Edge reconstruction loss: 0.1069
2025-06-06 15:19:51,465 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:51,468 - DEBUG - Online update step: 10/50
2025-06-06 15:19:51,469 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:51,469 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:51,470 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:51,470 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-06 15:19:51,470 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:51,471 - DEBUG - Applied edge dropout: 46 edges dropped.
2025-06-06 15:19:51,471 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:51,471 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:51,472 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:19:51,472 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:51,472 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:19:51,473 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:51,473 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:51,473 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:51,473 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:51,474 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-06 15:19:51,475 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:52,038 - DEBUG - Node anomaly scores shape: torch.Size([7278, 1])
2025-06-06 15:19:52,064 - DEBUG - Edge anomaly scores shape: torch.Size([13252, 1])
2025-06-06 15:19:52,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:52,065 - DEBUG - Node reconstruction loss: 26.7799
2025-06-06 15:19:52,065 - DEBUG - Edge reconstruction loss: 0.1356
2025-06-06 15:19:52,066 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:52,068 - DEBUG - Online update step: 11/50
2025-06-06 15:19:52,069 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:52,069 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:19:52,070 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:52,071 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:52,071 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:52,071 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:52,072 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:52,072 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:52,072 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:52,072 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:52,073 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:52,073 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:52,073 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:52,074 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:52,074 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:52,074 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:19:52,096 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:52,376 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:52,409 - DEBUG - Edge anomaly scores shape: torch.Size([12870, 1])
2025-06-06 15:19:52,410 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:52,413 - DEBUG - Node reconstruction loss: 26.9919
2025-06-06 15:19:52,414 - DEBUG - Edge reconstruction loss: 0.1234
2025-06-06 15:19:52,414 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:52,416 - DEBUG - Online update step: 12/50
2025-06-06 15:19:52,417 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:52,417 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:52,417 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:52,418 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:52,418 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:52,418 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:52,418 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:52,419 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:52,419 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:52,419 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:52,420 - DEBUG - Applied edge dropout: 63 edges dropped.
2025-06-06 15:19:52,420 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:19:52,420 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:52,421 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:52,421 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:52,421 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-06 15:19:52,423 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:52,676 - DEBUG - Node anomaly scores shape: torch.Size([7278, 1])
2025-06-06 15:19:52,700 - DEBUG - Edge anomaly scores shape: torch.Size([13329, 1])
2025-06-06 15:19:52,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:52,702 - DEBUG - Node reconstruction loss: 27.8621
2025-06-06 15:19:52,702 - DEBUG - Edge reconstruction loss: 0.6330
2025-06-06 15:19:52,702 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:52,705 - DEBUG - Online update step: 13/50
2025-06-06 15:19:52,706 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:19:52,707 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:19:52,707 - DEBUG - Applied edge dropout: 32 edges dropped.
2025-06-06 15:19:52,708 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:19:52,708 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:52,708 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:52,708 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:52,709 - DEBUG - Applied edge dropout: 131 edges dropped.
2025-06-06 15:19:52,709 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:52,709 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:52,710 - DEBUG - Applied edge dropout: 130 edges dropped.
2025-06-06 15:19:52,710 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:52,710 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:52,711 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:19:52,711 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-06 15:19:52,711 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:19:52,712 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:53,030 - DEBUG - Node anomaly scores shape: torch.Size([7481, 1])
2025-06-06 15:19:53,059 - DEBUG - Edge anomaly scores shape: torch.Size([13747, 1])
2025-06-06 15:19:53,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:53,061 - DEBUG - Node reconstruction loss: 26.3407
2025-06-06 15:19:53,061 - DEBUG - Edge reconstruction loss: 0.3160
2025-06-06 15:19:53,061 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:53,064 - DEBUG - Online update step: 14/50
2025-06-06 15:19:53,064 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:53,065 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:19:53,065 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:53,066 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:53,066 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:53,066 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:53,069 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-06 15:19:53,069 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:53,070 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:53,070 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:53,070 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:53,070 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:53,071 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:53,071 - DEBUG - Applied edge dropout: 115 edges dropped.
2025-06-06 15:19:53,071 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:53,071 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:53,073 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:53,321 - DEBUG - Node anomaly scores shape: torch.Size([7194, 1])
2025-06-06 15:19:53,344 - DEBUG - Edge anomaly scores shape: torch.Size([13117, 1])
2025-06-06 15:19:53,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:53,347 - DEBUG - Node reconstruction loss: 26.7529
2025-06-06 15:19:53,348 - DEBUG - Edge reconstruction loss: 0.2119
2025-06-06 15:19:53,348 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:53,351 - DEBUG - Online update step: 15/50
2025-06-06 15:19:53,351 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:53,352 - DEBUG - Applied edge dropout: 130 edges dropped.
2025-06-06 15:19:53,352 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:19:53,352 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:19:53,353 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-06 15:19:53,353 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-06 15:19:53,354 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:53,354 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:53,354 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:53,354 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:53,354 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:19:53,355 - DEBUG - Applied edge dropout: 43 edges dropped.
2025-06-06 15:19:53,355 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:53,355 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:53,356 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-06 15:19:53,356 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:53,357 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:53,793 - DEBUG - Node anomaly scores shape: torch.Size([7944, 1])
2025-06-06 15:19:53,823 - DEBUG - Edge anomaly scores shape: torch.Size([14568, 1])
2025-06-06 15:19:53,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:53,825 - DEBUG - Node reconstruction loss: 27.4643
2025-06-06 15:19:53,825 - DEBUG - Edge reconstruction loss: 0.1225
2025-06-06 15:19:53,825 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:53,828 - DEBUG - Online update step: 16/50
2025-06-06 15:19:53,828 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:53,829 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:19:53,829 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:19:53,829 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:53,830 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:53,830 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:53,830 - DEBUG - Applied edge dropout: 79 edges dropped.
2025-06-06 15:19:53,831 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:53,831 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:53,832 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:19:53,832 - DEBUG - Applied edge dropout: 112 edges dropped.
2025-06-06 15:19:53,832 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:53,832 - DEBUG - Applied edge dropout: 106 edges dropped.
2025-06-06 15:19:53,833 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:53,833 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:53,833 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-06 15:19:53,861 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:54,234 - DEBUG - Node anomaly scores shape: torch.Size([7300, 1])
2025-06-06 15:19:54,257 - DEBUG - Edge anomaly scores shape: torch.Size([13415, 1])
2025-06-06 15:19:54,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:54,258 - DEBUG - Node reconstruction loss: 27.6394
2025-06-06 15:19:54,259 - DEBUG - Edge reconstruction loss: 0.2743
2025-06-06 15:19:54,259 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:54,262 - DEBUG - Online update step: 17/50
2025-06-06 15:19:54,263 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:54,263 - DEBUG - Applied edge dropout: 22 edges dropped.
2025-06-06 15:19:54,264 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:54,264 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:54,264 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:54,265 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:19:54,265 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:54,265 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:19:54,265 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:54,266 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:54,266 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:54,267 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:54,269 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:54,269 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:19:54,270 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:54,270 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:54,272 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:54,573 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:54,596 - DEBUG - Edge anomaly scores shape: torch.Size([12814, 1])
2025-06-06 15:19:54,597 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:54,597 - DEBUG - Node reconstruction loss: 27.1817
2025-06-06 15:19:54,597 - DEBUG - Edge reconstruction loss: 0.2119
2025-06-06 15:19:54,597 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:54,600 - DEBUG - Online update step: 18/50
2025-06-06 15:19:54,601 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:54,601 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:54,601 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:54,602 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:54,602 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:54,602 - DEBUG - Applied edge dropout: 117 edges dropped.
2025-06-06 15:19:54,603 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-06 15:19:54,603 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:54,603 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:19:54,604 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:54,604 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:54,604 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:19:54,604 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:54,605 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:54,605 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:54,605 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:54,606 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:54,876 - DEBUG - Node anomaly scores shape: torch.Size([7862, 1])
2025-06-06 15:19:54,899 - DEBUG - Edge anomaly scores shape: torch.Size([14557, 1])
2025-06-06 15:19:54,900 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:54,901 - DEBUG - Node reconstruction loss: 26.9033
2025-06-06 15:19:54,902 - DEBUG - Edge reconstruction loss: 0.1991
2025-06-06 15:19:54,902 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:54,904 - DEBUG - Online update step: 19/50
2025-06-06 15:19:54,905 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:19:54,905 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:19:54,905 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:54,906 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:54,906 - DEBUG - Applied edge dropout: 72 edges dropped.
2025-06-06 15:19:54,906 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:19:54,907 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:54,907 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:19:54,908 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:54,908 - DEBUG - Applied edge dropout: 22 edges dropped.
2025-06-06 15:19:54,908 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:54,909 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:54,909 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-06 15:19:54,909 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:54,910 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:54,910 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-06 15:19:54,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:55,230 - DEBUG - Node anomaly scores shape: torch.Size([7944, 1])
2025-06-06 15:19:55,255 - DEBUG - Edge anomaly scores shape: torch.Size([14577, 1])
2025-06-06 15:19:55,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:55,256 - DEBUG - Node reconstruction loss: 27.2927
2025-06-06 15:19:55,257 - DEBUG - Edge reconstruction loss: 0.1215
2025-06-06 15:19:55,257 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:55,259 - DEBUG - Online update step: 20/50
2025-06-06 15:19:55,260 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:19:55,261 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-06 15:19:55,261 - DEBUG - Applied edge dropout: 189 edges dropped.
2025-06-06 15:19:55,261 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:19:55,262 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:19:55,262 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:55,262 - DEBUG - Applied edge dropout: 90 edges dropped.
2025-06-06 15:19:55,263 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:55,263 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:55,264 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:55,264 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:55,264 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:55,264 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:55,265 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:55,265 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:55,265 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:19:55,267 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:55,595 - DEBUG - Node anomaly scores shape: torch.Size([7278, 1])
2025-06-06 15:19:55,620 - DEBUG - Edge anomaly scores shape: torch.Size([13300, 1])
2025-06-06 15:19:55,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:55,621 - DEBUG - Node reconstruction loss: 27.2194
2025-06-06 15:19:55,622 - DEBUG - Edge reconstruction loss: 0.0775
2025-06-06 15:19:55,622 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:55,624 - DEBUG - Online update step: 21/50
2025-06-06 15:19:55,625 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:55,625 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:55,625 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:55,626 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-06 15:19:55,626 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:55,626 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:19:55,627 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:55,627 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:55,627 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:55,628 - DEBUG - Applied edge dropout: 131 edges dropped.
2025-06-06 15:19:55,628 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:55,628 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-06 15:19:55,629 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:55,629 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:55,629 - DEBUG - Applied edge dropout: 22 edges dropped.
2025-06-06 15:19:55,629 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:55,643 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:55,901 - DEBUG - Node anomaly scores shape: torch.Size([7481, 1])
2025-06-06 15:19:55,924 - DEBUG - Edge anomaly scores shape: torch.Size([13742, 1])
2025-06-06 15:19:55,925 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:55,925 - DEBUG - Node reconstruction loss: 26.6648
2025-06-06 15:19:55,926 - DEBUG - Edge reconstruction loss: 0.0545
2025-06-06 15:19:55,926 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:55,928 - DEBUG - Online update step: 22/50
2025-06-06 15:19:55,929 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:19:55,929 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-06 15:19:55,930 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:55,930 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-06 15:19:55,930 - DEBUG - Applied edge dropout: 98 edges dropped.
2025-06-06 15:19:55,931 - DEBUG - Applied edge dropout: 47 edges dropped.
2025-06-06 15:19:55,931 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:55,931 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:19:55,932 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:55,932 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-06 15:19:55,932 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:19:55,933 - DEBUG - Applied edge dropout: 109 edges dropped.
2025-06-06 15:19:55,933 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:19:55,933 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:55,934 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:55,934 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:55,935 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:56,185 - DEBUG - Node anomaly scores shape: torch.Size([7194, 1])
2025-06-06 15:19:56,206 - DEBUG - Edge anomaly scores shape: torch.Size([13030, 1])
2025-06-06 15:19:56,207 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:56,207 - DEBUG - Node reconstruction loss: 26.7395
2025-06-06 15:19:56,207 - DEBUG - Edge reconstruction loss: 0.0827
2025-06-06 15:19:56,208 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:56,210 - DEBUG - Online update step: 23/50
2025-06-06 15:19:56,211 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:56,211 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:56,211 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:56,212 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:19:56,212 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:19:56,212 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:19:56,213 - DEBUG - Applied edge dropout: 136 edges dropped.
2025-06-06 15:19:56,213 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:19:56,213 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:56,213 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:56,214 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:56,214 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:56,214 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:56,215 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:19:56,215 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:56,215 - DEBUG - Applied edge dropout: 178 edges dropped.
2025-06-06 15:19:56,216 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:56,459 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:56,480 - DEBUG - Edge anomaly scores shape: torch.Size([12823, 1])
2025-06-06 15:19:56,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:56,482 - DEBUG - Node reconstruction loss: 26.1731
2025-06-06 15:19:56,482 - DEBUG - Edge reconstruction loss: 0.1127
2025-06-06 15:19:56,482 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:56,485 - DEBUG - Online update step: 24/50
2025-06-06 15:19:56,485 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:56,485 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:56,486 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:19:56,486 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:19:56,486 - DEBUG - Applied edge dropout: 110 edges dropped.
2025-06-06 15:19:56,487 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:56,487 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:19:56,487 - DEBUG - Applied edge dropout: 47 edges dropped.
2025-06-06 15:19:56,488 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-06 15:19:56,488 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:19:56,488 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:19:56,489 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-06 15:19:56,489 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:56,489 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:56,490 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:19:56,490 - DEBUG - Applied edge dropout: 126 edges dropped.
2025-06-06 15:19:56,491 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:56,775 - DEBUG - Node anomaly scores shape: torch.Size([7916, 1])
2025-06-06 15:19:56,800 - DEBUG - Edge anomaly scores shape: torch.Size([14631, 1])
2025-06-06 15:19:56,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:56,802 - DEBUG - Node reconstruction loss: 27.5898
2025-06-06 15:19:56,803 - DEBUG - Edge reconstruction loss: 0.2393
2025-06-06 15:19:56,803 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:56,805 - DEBUG - Online update step: 25/50
2025-06-06 15:19:56,806 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:56,806 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:56,807 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:56,807 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:19:56,807 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:56,808 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:19:56,808 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-06 15:19:56,809 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:56,810 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:19:56,811 - DEBUG - Applied edge dropout: 115 edges dropped.
2025-06-06 15:19:56,811 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:19:56,812 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:56,812 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:19:56,813 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:19:56,813 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:56,813 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:56,815 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:57,166 - DEBUG - Node anomaly scores shape: torch.Size([7213, 1])
2025-06-06 15:19:57,193 - DEBUG - Edge anomaly scores shape: torch.Size([13198, 1])
2025-06-06 15:19:57,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:57,195 - DEBUG - Node reconstruction loss: 27.4882
2025-06-06 15:19:57,195 - DEBUG - Edge reconstruction loss: 0.2131
2025-06-06 15:19:57,195 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:57,198 - DEBUG - Online update step: 26/50
2025-06-06 15:19:57,198 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:57,198 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:19:57,199 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:19:57,199 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:19:57,201 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:57,201 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-06 15:19:57,202 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:19:57,202 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:57,202 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:57,203 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:19:57,203 - DEBUG - Applied edge dropout: 99 edges dropped.
2025-06-06 15:19:57,204 - DEBUG - Applied edge dropout: 56 edges dropped.
2025-06-06 15:19:57,204 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:19:57,205 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:19:57,205 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:57,205 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:19:57,213 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:57,483 - DEBUG - Node anomaly scores shape: torch.Size([7213, 1])
2025-06-06 15:19:57,504 - DEBUG - Edge anomaly scores shape: torch.Size([13140, 1])
2025-06-06 15:19:57,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:57,505 - DEBUG - Node reconstruction loss: 26.2222
2025-06-06 15:19:57,506 - DEBUG - Edge reconstruction loss: 0.1247
2025-06-06 15:19:57,506 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:57,508 - DEBUG - Online update step: 27/50
2025-06-06 15:19:57,510 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:19:57,510 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:19:57,511 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:57,511 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:19:57,511 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:19:57,512 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:19:57,512 - DEBUG - Applied edge dropout: 112 edges dropped.
2025-06-06 15:19:57,512 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:57,512 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:57,513 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:57,513 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:57,513 - DEBUG - Applied edge dropout: 184 edges dropped.
2025-06-06 15:19:57,514 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:57,514 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:19:57,514 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:19:57,515 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-06 15:19:57,517 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:57,813 - DEBUG - Node anomaly scores shape: torch.Size([7862, 1])
2025-06-06 15:19:57,839 - DEBUG - Edge anomaly scores shape: torch.Size([14517, 1])
2025-06-06 15:19:57,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:57,840 - DEBUG - Node reconstruction loss: 26.9853
2025-06-06 15:19:57,840 - DEBUG - Edge reconstruction loss: 0.2066
2025-06-06 15:19:57,840 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:57,843 - DEBUG - Online update step: 28/50
2025-06-06 15:19:57,843 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:19:57,844 - DEBUG - Applied edge dropout: 48 edges dropped.
2025-06-06 15:19:57,844 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:19:57,845 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:57,845 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:57,846 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:57,846 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:19:57,846 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:19:57,846 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:19:57,847 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:19:57,847 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:19:57,847 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:57,848 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-06 15:19:57,848 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:19:57,848 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:19:57,849 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:19:57,850 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:58,148 - DEBUG - Node anomaly scores shape: torch.Size([7862, 1])
2025-06-06 15:19:58,170 - DEBUG - Edge anomaly scores shape: torch.Size([14571, 1])
2025-06-06 15:19:58,171 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:58,172 - DEBUG - Node reconstruction loss: 26.7595
2025-06-06 15:19:58,172 - DEBUG - Edge reconstruction loss: 0.4337
2025-06-06 15:19:58,172 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:58,175 - DEBUG - Online update step: 29/50
2025-06-06 15:19:58,175 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:19:58,176 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:19:58,176 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:19:58,176 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:19:58,177 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:58,177 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:58,177 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:19:58,177 - DEBUG - Applied edge dropout: 67 edges dropped.
2025-06-06 15:19:58,178 - DEBUG - Applied edge dropout: 99 edges dropped.
2025-06-06 15:19:58,178 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:58,178 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:58,178 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:19:58,179 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-06 15:19:58,179 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:58,179 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:19:58,180 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:19:58,181 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:58,564 - DEBUG - Node anomaly scores shape: torch.Size([7278, 1])
2025-06-06 15:19:58,590 - DEBUG - Edge anomaly scores shape: torch.Size([13315, 1])
2025-06-06 15:19:58,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:58,591 - DEBUG - Node reconstruction loss: 26.9438
2025-06-06 15:19:58,592 - DEBUG - Edge reconstruction loss: 0.2702
2025-06-06 15:19:58,592 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:58,594 - DEBUG - Online update step: 30/50
2025-06-06 15:19:58,594 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:58,594 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:19:58,595 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:58,595 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:58,595 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:19:58,596 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:58,596 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:19:58,596 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:58,596 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:19:58,597 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:58,597 - DEBUG - Applied edge dropout: 53 edges dropped.
2025-06-06 15:19:58,597 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:58,597 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:58,597 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:19:58,598 - DEBUG - Applied edge dropout: 77 edges dropped.
2025-06-06 15:19:58,598 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:19:58,599 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:58,865 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:19:58,887 - DEBUG - Edge anomaly scores shape: torch.Size([12862, 1])
2025-06-06 15:19:58,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:58,888 - DEBUG - Node reconstruction loss: 27.1294
2025-06-06 15:19:58,889 - DEBUG - Edge reconstruction loss: 0.2417
2025-06-06 15:19:58,889 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:58,891 - DEBUG - Online update step: 31/50
2025-06-06 15:19:58,892 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:19:58,892 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:58,893 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:19:58,893 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:58,893 - DEBUG - Applied edge dropout: 46 edges dropped.
2025-06-06 15:19:58,893 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:58,894 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:19:58,894 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-06 15:19:58,895 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-06 15:19:58,895 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:19:58,895 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:58,895 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:19:58,896 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:58,896 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:19:58,896 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:58,897 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:19:58,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:59,185 - DEBUG - Node anomaly scores shape: torch.Size([7571, 1])
2025-06-06 15:19:59,207 - DEBUG - Edge anomaly scores shape: torch.Size([13963, 1])
2025-06-06 15:19:59,208 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:59,209 - DEBUG - Node reconstruction loss: 27.5608
2025-06-06 15:19:59,209 - DEBUG - Edge reconstruction loss: 0.3278
2025-06-06 15:19:59,209 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:59,212 - DEBUG - Online update step: 32/50
2025-06-06 15:19:59,212 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:59,213 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:59,213 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:19:59,214 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:19:59,214 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:19:59,214 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:59,214 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:19:59,215 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:19:59,215 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:59,215 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-06 15:19:59,216 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:59,216 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:19:59,216 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:19:59,217 - DEBUG - Applied edge dropout: 124 edges dropped.
2025-06-06 15:19:59,217 - DEBUG - Applied edge dropout: 178 edges dropped.
2025-06-06 15:19:59,217 - DEBUG - Applied edge dropout: 56 edges dropped.
2025-06-06 15:19:59,219 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:59,462 - DEBUG - Node anomaly scores shape: torch.Size([7231, 1])
2025-06-06 15:19:59,482 - DEBUG - Edge anomaly scores shape: torch.Size([13257, 1])
2025-06-06 15:19:59,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:59,484 - DEBUG - Node reconstruction loss: 27.0576
2025-06-06 15:19:59,484 - DEBUG - Edge reconstruction loss: 0.0840
2025-06-06 15:19:59,484 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:59,487 - DEBUG - Online update step: 33/50
2025-06-06 15:19:59,487 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-06 15:19:59,488 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:59,488 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:19:59,488 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:19:59,489 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:19:59,489 - DEBUG - Applied edge dropout: 76 edges dropped.
2025-06-06 15:19:59,489 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:19:59,490 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:19:59,490 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:19:59,490 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:19:59,490 - DEBUG - Applied edge dropout: 35 edges dropped.
2025-06-06 15:19:59,491 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:59,491 - DEBUG - Applied edge dropout: 186 edges dropped.
2025-06-06 15:19:59,491 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:19:59,491 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:59,492 - DEBUG - Applied edge dropout: 113 edges dropped.
2025-06-06 15:19:59,493 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:19:59,775 - DEBUG - Node anomaly scores shape: torch.Size([7628, 1])
2025-06-06 15:19:59,797 - DEBUG - Edge anomaly scores shape: torch.Size([14042, 1])
2025-06-06 15:19:59,798 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:19:59,799 - DEBUG - Node reconstruction loss: 26.4475
2025-06-06 15:19:59,799 - DEBUG - Edge reconstruction loss: 0.0545
2025-06-06 15:19:59,799 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:19:59,802 - DEBUG - Online update step: 34/50
2025-06-06 15:19:59,802 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:19:59,802 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:19:59,803 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:59,803 - DEBUG - Applied edge dropout: 84 edges dropped.
2025-06-06 15:19:59,805 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:19:59,805 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:59,806 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:19:59,806 - DEBUG - Applied edge dropout: 129 edges dropped.
2025-06-06 15:19:59,807 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:19:59,807 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:19:59,807 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:19:59,807 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:59,808 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:19:59,808 - DEBUG - Applied edge dropout: 41 edges dropped.
2025-06-06 15:19:59,808 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:19:59,809 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:19:59,810 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:00,076 - DEBUG - Node anomaly scores shape: torch.Size([7481, 1])
2025-06-06 15:20:00,101 - DEBUG - Edge anomaly scores shape: torch.Size([13801, 1])
2025-06-06 15:20:00,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:00,103 - DEBUG - Node reconstruction loss: 27.0910
2025-06-06 15:20:00,104 - DEBUG - Edge reconstruction loss: 0.0495
2025-06-06 15:20:00,104 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:00,106 - DEBUG - Online update step: 35/50
2025-06-06 15:20:00,107 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-06 15:20:00,108 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:20:00,108 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:20:00,109 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:20:00,109 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:20:00,109 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:20:00,109 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:20:00,110 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:20:00,110 - DEBUG - Applied edge dropout: 56 edges dropped.
2025-06-06 15:20:00,110 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:20:00,111 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:20:00,111 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:20:00,111 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:20:00,112 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:20:00,112 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:20:00,112 - DEBUG - Applied edge dropout: 185 edges dropped.
2025-06-06 15:20:00,113 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:00,441 - DEBUG - Node anomaly scores shape: torch.Size([7928, 1])
2025-06-06 15:20:00,469 - DEBUG - Edge anomaly scores shape: torch.Size([14592, 1])
2025-06-06 15:20:00,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:00,470 - DEBUG - Node reconstruction loss: 26.9556
2025-06-06 15:20:00,471 - DEBUG - Edge reconstruction loss: 0.2798
2025-06-06 15:20:00,471 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:00,473 - DEBUG - Online update step: 36/50
2025-06-06 15:20:00,474 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:20:00,474 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:20:00,475 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:20:00,475 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-06 15:20:00,475 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:20:00,476 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:20:00,476 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:20:00,476 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:20:00,476 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:20:00,477 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:20:00,477 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:20:00,477 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:20:00,478 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:20:00,478 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:20:00,478 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-06 15:20:00,479 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:20:00,495 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:00,755 - DEBUG - Node anomaly scores shape: torch.Size([7353, 1])
2025-06-06 15:20:00,777 - DEBUG - Edge anomaly scores shape: torch.Size([13499, 1])
2025-06-06 15:20:00,778 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:00,778 - DEBUG - Node reconstruction loss: 26.5219
2025-06-06 15:20:00,778 - DEBUG - Edge reconstruction loss: 0.0756
2025-06-06 15:20:00,779 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:00,781 - DEBUG - Online update step: 37/50
2025-06-06 15:20:00,782 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:20:00,782 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:20:00,782 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:20:00,783 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:20:00,783 - DEBUG - Applied edge dropout: 133 edges dropped.
2025-06-06 15:20:00,783 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:20:00,784 - DEBUG - Applied edge dropout: 123 edges dropped.
2025-06-06 15:20:00,784 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:20:00,784 - DEBUG - Applied edge dropout: 37 edges dropped.
2025-06-06 15:20:00,784 - DEBUG - Applied edge dropout: 144 edges dropped.
2025-06-06 15:20:00,785 - DEBUG - Applied edge dropout: 110 edges dropped.
2025-06-06 15:20:00,785 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:20:00,785 - DEBUG - Applied edge dropout: 72 edges dropped.
2025-06-06 15:20:00,786 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:20:00,786 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:20:00,786 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-06 15:20:00,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:01,051 - DEBUG - Node anomaly scores shape: torch.Size([7231, 1])
2025-06-06 15:20:01,090 - DEBUG - Edge anomaly scores shape: torch.Size([13227, 1])
2025-06-06 15:20:01,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:01,092 - DEBUG - Node reconstruction loss: 27.8203
2025-06-06 15:20:01,092 - DEBUG - Edge reconstruction loss: 0.1084
2025-06-06 15:20:01,092 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:01,095 - DEBUG - Online update step: 38/50
2025-06-06 15:20:01,096 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:20:01,096 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:20:01,097 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:20:01,097 - DEBUG - Applied edge dropout: 82 edges dropped.
2025-06-06 15:20:01,098 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-06 15:20:01,098 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:20:01,098 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:20:01,099 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:20:01,102 - DEBUG - Applied edge dropout: 124 edges dropped.
2025-06-06 15:20:01,102 - DEBUG - Applied edge dropout: 92 edges dropped.
2025-06-06 15:20:01,102 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:20:01,103 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:20:01,103 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:20:01,103 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:20:01,104 - DEBUG - Applied edge dropout: 44 edges dropped.
2025-06-06 15:20:01,104 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:20:01,105 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:01,571 - DEBUG - Node anomaly scores shape: torch.Size([7481, 1])
2025-06-06 15:20:01,773 - DEBUG - Edge anomaly scores shape: torch.Size([13721, 1])
2025-06-06 15:20:01,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:01,842 - DEBUG - Node reconstruction loss: 26.1516
2025-06-06 15:20:01,849 - DEBUG - Edge reconstruction loss: 0.1171
2025-06-06 15:20:01,849 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:01,851 - DEBUG - Online update step: 39/50
2025-06-06 15:20:01,857 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:20:01,863 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:20:01,863 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:20:01,864 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:20:01,868 - DEBUG - Applied edge dropout: 109 edges dropped.
2025-06-06 15:20:01,898 - DEBUG - Applied edge dropout: 185 edges dropped.
2025-06-06 15:20:01,898 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:20:01,906 - DEBUG - Applied edge dropout: 137 edges dropped.
2025-06-06 15:20:01,940 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:20:01,987 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:20:02,002 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:20:02,003 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:20:02,006 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:20:02,006 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:20:02,042 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:20:02,093 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-06 15:20:02,120 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:04,213 - DEBUG - Node anomaly scores shape: torch.Size([7278, 1])
2025-06-06 15:20:04,426 - DEBUG - Edge anomaly scores shape: torch.Size([13263, 1])
2025-06-06 15:20:04,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:04,520 - DEBUG - Node reconstruction loss: 27.1183
2025-06-06 15:20:04,526 - DEBUG - Edge reconstruction loss: 0.0956
2025-06-06 15:20:04,526 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:04,535 - DEBUG - Online update step: 40/50
2025-06-06 15:20:04,540 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:20:04,576 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:20:04,577 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:20:04,623 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:20:04,628 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:20:04,628 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:20:04,667 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:20:04,674 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:20:04,675 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:20:04,681 - DEBUG - Applied edge dropout: 108 edges dropped.
2025-06-06 15:20:04,688 - DEBUG - Applied edge dropout: 122 edges dropped.
2025-06-06 15:20:04,717 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:20:04,725 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:20:04,732 - DEBUG - Applied edge dropout: 98 edges dropped.
2025-06-06 15:20:04,774 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:20:04,781 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:20:04,811 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:05,827 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:20:05,851 - DEBUG - Edge anomaly scores shape: torch.Size([12791, 1])
2025-06-06 15:20:05,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:05,853 - DEBUG - Node reconstruction loss: 26.4525
2025-06-06 15:20:05,853 - DEBUG - Edge reconstruction loss: 0.1667
2025-06-06 15:20:05,853 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:05,856 - DEBUG - Online update step: 41/50
2025-06-06 15:20:05,856 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:20:05,857 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:20:05,857 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:20:05,858 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-06 15:20:05,858 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:20:05,858 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:20:05,858 - DEBUG - Applied edge dropout: 57 edges dropped.
2025-06-06 15:20:05,859 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:20:05,859 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:20:05,859 - DEBUG - Applied edge dropout: 177 edges dropped.
2025-06-06 15:20:05,860 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:20:05,860 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:20:05,860 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:20:05,860 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:20:05,861 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:20:05,861 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:20:05,872 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:20:06,552 - DEBUG - Node anomaly scores shape: torch.Size([7353, 1])
2025-06-06 15:20:06,831 - DEBUG - Edge anomaly scores shape: torch.Size([13519, 1])
2025-06-06 15:20:06,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:20:06,905 - DEBUG - Node reconstruction loss: 26.9994
2025-06-06 15:20:06,913 - DEBUG - Edge reconstruction loss: 0.0932
2025-06-06 15:20:06,913 - ERROR - Error during loss calculation: name 'anomaly_loss' is not defined
2025-06-06 15:20:06,915 - DEBUG - Online update step: 42/50
2025-06-06 15:20:06,920 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:20:06,967 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-06 15:20:06,973 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:20:07,020 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:20:07,059 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:20:07,088 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:20:07,096 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:20:07,134 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:20:07,143 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:20:07,150 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:20:07,150 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:20:07,164 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:20:07,172 - DEBUG - Applied edge dropout: 108 edges dropped.
2025-06-06 15:20:07,172 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:20:07,172 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:20:07,186 - DEBUG - Applied edge dropout: 94 edges dropped.
2025-06-06 15:20:07,208 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
