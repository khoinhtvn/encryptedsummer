2025-06-06 15:07:28,204 - INFO - Application logging to file: logs/app_20250606_150728.log
2025-06-06 15:07:28,204 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-06 15:07:28,204 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-06 15:07:28,205 - INFO - Train Mode: train, Visualization Path: vis
2025-06-06 15:07:28,205 - INFO - Found 46 files to process.
2025-06-06 15:07:28,206 - INFO - 
--- Processing file: nw_graph_encoded_1749044168.dot ---
2025-06-06 15:07:28,206 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot
2025-06-06 15:07:28,206 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot file.
2025-06-06 15:07:28,207 - INFO - Parsed 20 nodes.
2025-06-06 15:07:28,208 - INFO - Parsed 27 edges.
2025-06-06 15:07:28,209 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:28,209 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:28,210 - DEBUG - Initial node features tensor shape: torch.Size([20, 19])
2025-06-06 15:07:28,211 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:28,212 - DEBUG - Node features tensor shape after scaling: torch.Size([20, 19])
2025-06-06 15:07:28,212 - DEBUG - Edge index tensor shape: torch.Size([2, 27])
2025-06-06 15:07:28,212 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:28,213 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:07:28,214 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-06 15:07:28,214 - DEBUG - Shape of encoded categorical edge features: torch.Size([27, 2])
2025-06-06 15:07:28,215 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:28,216 - DEBUG - Shape of scaled numerical edge features: torch.Size([27, 20])
2025-06-06 15:07:28,216 - DEBUG - Final edge attributes tensor shape: torch.Size([27, 22])
2025-06-06 15:07:28,216 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:28,216 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-06 15:07:28,216 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-06 15:07:28,277 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-06 15:07:28,280 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-06 15:07:28,282 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-06 15:07:28,283 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-06 15:07:28,283 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-06 15:07:28,283 - INFO - RunningStats initialized.
2025-06-06 15:07:28,283 - INFO - RunningStats initialized.
2025-06-06 15:07:28,283 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-06 15:07:28,284 - INFO - Using device: cpu
2025-06-06 15:07:28,284 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-06 15:07:28,342 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 24
2025-06-06 15:07:28,342 - INFO - Resuming online updates from step: 24
2025-06-06 15:07:28,343 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-06 15:07:28,343 - INFO - Performing online update...
2025-06-06 15:07:28,343 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:28,344 - DEBUG - Updated RunningStats: new_mean=[ 4.24179333e-10 -4.47459765e-10 -2.59923369e-09  2.29922324e-09
 -2.55380000e-08  1.38379138e-08 -9.62910136e-09 -2.30249672e-09
 -2.98584883e-09  9.91116124e-10  1.39623249e-09 -1.53229225e-09
  3.72705147e-09 -3.45991395e-09  9.86248984e-10  8.07574838e-10
 -3.77224240e-09  1.16830668e-09 -4.76854511e-09], new_M2=[194602.00540115 194602.00535794 194602.00026687 194602.00432196
 194601.998477   194601.99850062 194601.99598497 194601.99818301
 194601.99315624 194601.99842011 194602.00189731 194601.9938672
 194601.99277963 154810.99667463 154811.00010588 154810.9988389
 154811.00001141 194602.00020937 194602.00774398], new_n=194602
2025-06-06 15:07:28,344 - DEBUG - Updated RunningStats: new_mean=[ 1.41532250e+00  5.49863993e+00  1.06630511e-10  2.59668680e-10
  1.43500550e-10 -1.64374584e-10 -1.28667713e-09  1.99941330e-10
  2.92109098e-10 -2.04935543e-10  3.23762162e-10 -3.49191445e-09
 -8.72714064e-10  2.86343887e-10  3.09699760e-10 -1.56274159e-10
 -1.56274159e-10 -1.56274159e-10 -1.56274159e-10 -1.56274159e-10
 -1.56274159e-10 -8.04825104e-11], new_M2=[ 107884.9650104  1871847.22475999  419095.99899734  419096.00591938
  419096.00569482  419095.99325985  419096.00036953  419095.99910393
  419096.00166847  419095.99933428  419095.99393489  419096.00854099
  419096.001123    419095.99983346  419096.00182681  419095.99456326
  419095.99456326  419095.99456326  419095.99456326  419095.99456326
  419095.99456326  419095.9990658 ], new_n=419096
2025-06-06 15:07:28,344 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89192277 0.89192278 0.89192278 0.89192278 1.
 1.00000002]
2025-06-06 15:07:28,345 - DEBUG - Calculated standard deviation: [0.50736874 2.11338413 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:28,345 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:28,345 - DEBUG - Online update step: 1/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 2/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 3/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 4/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 5/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 6/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 7/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 8/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 9/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 10/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 11/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 12/50
2025-06-06 15:07:28,345 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,345 - DEBUG - Online update step: 13/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 14/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 15/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 16/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 17/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 18/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 19/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 20/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 21/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 22/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 23/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 24/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 25/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 26/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 27/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 28/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 29/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 30/50
2025-06-06 15:07:28,346 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,346 - DEBUG - Online update step: 31/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 32/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 33/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 34/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 35/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 36/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 37/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 38/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 39/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 40/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 41/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 42/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 43/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 44/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 45/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 46/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 47/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,347 - DEBUG - Online update step: 48/50
2025-06-06 15:07:28,347 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,348 - DEBUG - Online update step: 49/50
2025-06-06 15:07:28,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,348 - DEBUG - Online update step: 50/50
2025-06-06 15:07:28,348 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,348 - WARNING - No successful steps during online update.
2025-06-06 15:07:28,348 - DEBUG - Current node mean: [ 3.5762788e-08 -3.5762788e-08  0.0000000e+00 -3.5762788e-08
  1.1920929e-08  0.0000000e+00  0.0000000e+00  3.5762788e-08
  2.2351742e-08  0.0000000e+00  5.9604646e-09  0.0000000e+00
 -1.1920929e-08  2.3841858e-08  1.1920929e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.3841858e-08], current edge mean: [ 1.4814815e-01  2.6296296e+00  4.4151589e-09 -8.8303178e-09
 -8.8303178e-09  8.8303178e-09  1.7660636e-08 -3.5321271e-08
  8.8303178e-09 -8.8303178e-09 -4.4151589e-09  1.4349267e-08
  0.0000000e+00  3.5321271e-08  3.5321271e-08  1.3245477e-08
  1.3245477e-08  1.3245477e-08  1.3245477e-08  1.3245477e-08
  1.3245477e-08  0.0000000e+00]
2025-06-06 15:07:28,348 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4975
2025-06-06 15:07:28,349 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:07:28,349 - DEBUG - Updated reference mean: node=[ 3.5762788e-08 -3.5762788e-08  0.0000000e+00 -3.5762788e-08
  1.1920929e-08  0.0000000e+00  0.0000000e+00  3.5762788e-08
  2.2351742e-08  0.0000000e+00  5.9604646e-09  0.0000000e+00
 -1.1920929e-08  2.3841858e-08  1.1920929e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.3841858e-08], edge=[ 1.4814815e-01  2.6296296e+00  4.4151589e-09 -8.8303178e-09
 -8.8303178e-09  8.8303178e-09  1.7660636e-08 -3.5321271e-08
  8.8303178e-09 -8.8303178e-09 -4.4151589e-09  1.4349267e-08
  0.0000000e+00  3.5321271e-08  3.5321271e-08  1.3245477e-08
  1.3245477e-08  1.3245477e-08  1.3245477e-08  1.3245477e-08
  1.3245477e-08  0.0000000e+00]
2025-06-06 15:07:28,349 - DEBUG - Updated reference std: node=[1.0259784 1.0259784 1.0259783 1.0259783 1.0259784 1.0259783 1.0259783
 1.0259783 1.0259783 1.0259783 1.0259783 1.0259783 1.0259784 1.0259783
 1.0259784 1.0259783 1.0259783 1.0259783 1.0259783], edge=[0.362014  1.5479054 1.0190494 1.0190493 1.0190493 1.0190494 1.0190493
 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493 1.0190493
 1.0190493 1.0190494 1.0190494 1.0190494 1.0190494 1.0190494 1.0190494
 1.0190493]
2025-06-06 15:07:28,349 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:28,349 - INFO - Running anomaly detection...
2025-06-06 15:07:28,349 - INFO - Starting anomaly detection.
2025-06-06 15:07:28,410 - DEBUG - Node reconstruction errors: [0.01675244 0.01675243 0.01675243 0.559429   0.01675243 0.01675243
 0.6774985  0.01675243 0.50433576 0.01675243 0.01675243 0.1912607
 0.3254799  0.19310485 0.01675244 0.04407169 0.5288434  0.01675243
 0.01675244 0.04407172]
2025-06-06 15:07:28,416 - DEBUG - Edge reconstruction errors: [0.7999825  0.7999813  0.7999834  0.79999983 0.7978211  0.7978266
 0.79765755 0.7714779  0.7936723  0.68501204 0.55057645 0.5708997
 0.04498321 0.01976919 0.04812449 0.68745667 0.6824448  0.68620324
 0.6903688  0.6835901  0.67549926 0.67976516 0.5786699  0.8
 0.8        0.8        0.8       ]
2025-06-06 15:07:28,517 - ERROR - An error occurred while processing file nw_graph_encoded_1749044168.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:28,528 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:28,529 - INFO - 
--- Processing file: nw_graph_encoded_1749044228.dot ---
2025-06-06 15:07:28,529 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot
2025-06-06 15:07:28,529 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot file.
2025-06-06 15:07:28,530 - INFO - Parsed 49 nodes.
2025-06-06 15:07:28,531 - INFO - Parsed 66 edges.
2025-06-06 15:07:28,536 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:28,536 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:28,537 - DEBUG - Initial node features tensor shape: torch.Size([49, 19])
2025-06-06 15:07:28,539 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:28,539 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 19])
2025-06-06 15:07:28,539 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-06 15:07:28,539 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:28,540 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:07:28,541 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:07:28,541 - DEBUG - Shape of encoded categorical edge features: torch.Size([66, 2])
2025-06-06 15:07:28,542 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:28,542 - DEBUG - Shape of scaled numerical edge features: torch.Size([66, 20])
2025-06-06 15:07:28,542 - DEBUG - Final edge attributes tensor shape: torch.Size([66, 22])
2025-06-06 15:07:28,542 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:28,543 - INFO - Performing online update...
2025-06-06 15:07:28,543 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:28,543 - DEBUG - Updated RunningStats: new_mean=[ 4.23125207e-10 -4.46246673e-10 -2.59704832e-09  2.29818514e-09
 -2.55331023e-08  1.38356552e-08 -9.62606497e-09 -2.30099847e-09
 -2.98188196e-09  9.93469437e-10  1.39833072e-09 -1.53481555e-09
  3.72703188e-09 -3.46669830e-09  9.86306926e-10  8.05381161e-10
 -3.76926414e-09  1.17069194e-09 -4.77224412e-09], new_M2=[194651.00540006 194651.00535685 194651.00026695 194651.00432004
 194650.99847433 194650.99850411 194650.99598818 194650.99818458
 194650.99315704 194650.99841998 194651.00189651 194650.99386549
 194650.99278037 154859.99667473 154860.00010551 154859.99884084
 154860.00001295 194651.00021071 194651.00774764], new_n=194651
2025-06-06 15:07:28,544 - DEBUG - Updated RunningStats: new_mean=[ 1.41512112e+00  5.49826320e+00  1.06834797e-10  2.59627793e-10
  1.43775685e-10 -1.63704361e-10 -1.28522029e-09  2.00238685e-10
  2.91680942e-10 -2.05025478e-10  3.24671031e-10 -3.48974898e-09
 -8.72596646e-10  2.88218494e-10  3.08797798e-10 -1.55649648e-10
 -1.55649648e-10 -1.55649648e-10 -1.55649648e-10 -1.55649648e-10
 -1.55649648e-10 -8.02032137e-11], new_M2=[ 108000.67930061 1872531.23561061  419161.99899646  419162.0059186
  419162.00569583  419161.99326259  419162.00036684  419161.99910259
  419162.00166869  419161.99933477  419161.99393768  419162.00853924
  419162.0011222   419161.99983312  419162.00182489  419161.99456698
  419161.99456698  419161.99456698  419161.99456698  419161.99456698
  419161.99456698  419161.99906631], new_n=419162
2025-06-06 15:07:28,544 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89195163 0.89195164 0.89195164 0.89195164 1.
 1.00000002]
2025-06-06 15:07:28,544 - DEBUG - Calculated standard deviation: [0.50760079 2.11360381 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:28,544 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:28,544 - DEBUG - Online update step: 1/50
2025-06-06 15:07:28,544 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,544 - DEBUG - Online update step: 2/50
2025-06-06 15:07:28,544 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,544 - DEBUG - Online update step: 3/50
2025-06-06 15:07:28,544 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,544 - DEBUG - Online update step: 4/50
2025-06-06 15:07:28,544 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 5/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 6/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 7/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 8/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 9/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 10/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 11/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 12/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 13/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 14/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 15/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 16/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 17/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 18/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 19/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 20/50
2025-06-06 15:07:28,545 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,545 - DEBUG - Online update step: 21/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 22/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 23/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 24/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 25/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 26/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 27/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 28/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 29/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 30/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 31/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 32/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 33/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 34/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 35/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 36/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 37/50
2025-06-06 15:07:28,546 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,546 - DEBUG - Online update step: 38/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 39/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 40/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 41/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 42/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 43/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 44/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 45/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 46/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 47/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 48/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 49/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - DEBUG - Online update step: 50/50
2025-06-06 15:07:28,547 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:28,547 - WARNING - No successful steps during online update.
2025-06-06 15:07:28,548 - DEBUG - Current node mean: [-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], current edge mean: [ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:07:28,548 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5192
2025-06-06 15:07:28,548 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:07:28,549 - DEBUG - Updated reference mean: node=[-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], edge=[ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:07:28,549 - DEBUG - Updated reference std: node=[1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363], edge=[0.345804  2.1706347 1.0076629 1.0076629 1.007663  1.007663  1.0076629
 1.0076629 1.0076629 1.0076629 1.007663  1.0076629 1.0076629 1.0076629
 1.0076629 1.007663  1.007663  1.007663  1.007663  1.007663  1.007663
 1.0076629]
2025-06-06 15:07:28,549 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:28,549 - INFO - Running anomaly detection...
2025-06-06 15:07:28,549 - INFO - Starting anomaly detection.
2025-06-06 15:07:29,178 - DEBUG - Node reconstruction errors: [0.07977078 0.00718954 0.00718954 0.07977078 0.00718954 0.00718954
 0.01514881 0.07339779 0.00718954 0.05352092 0.00718954 0.02649076
 1.8940403  0.05352092 0.02649076 0.19464332 0.46226415 0.00718954
 0.00718954 0.0779943  0.00718954 0.01514881 0.02649076 0.02649076
 0.02649076 0.00718954 0.6922126  0.00718954 0.04191439 0.00718954
 0.02649076 0.84768426 0.00718954 0.00718954 0.02649076 0.00718954
 0.02649076 0.00718954 0.00718954 0.02649076 0.02649076 0.02649076
 0.04191439 0.5971215  0.00718954 0.00718954 0.01514881 0.07977074
 0.00718954]
2025-06-06 15:07:29,184 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.25889426 0.784113   0.76725066 0.13345379
 0.0324415  0.07107979 0.7770684  0.7781419  0.7779897  0.7762514
 0.77538204 0.13265598 0.12865388 0.16629994 0.16955847 0.15383822
 0.15088445 0.14734215 0.01884902 0.20897055 0.2064954  0.38622567
 0.38410026 0.376745   0.18588263 0.31428146 0.18228662 0.19306087
 0.09430957 0.1853689  0.18614072 0.2385943  0.16915685 0.00542396
 0.6084311  0.15389782 0.11175132 0.1548416  0.14769065 0.19663519
 0.2019049  0.30637646 0.20148891 0.19175756 0.14824957 0.1706649
 0.08035159 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8       ]
2025-06-06 15:07:29,309 - ERROR - An error occurred while processing file nw_graph_encoded_1749044228.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:29,310 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:29,310 - INFO - 
--- Processing file: nw_graph_encoded_1749044288.dot ---
2025-06-06 15:07:29,310 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot
2025-06-06 15:07:29,310 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot file.
2025-06-06 15:07:29,311 - INFO - Parsed 65 nodes.
2025-06-06 15:07:29,312 - INFO - Parsed 89 edges.
2025-06-06 15:07:29,314 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:29,314 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:29,315 - DEBUG - Initial node features tensor shape: torch.Size([65, 19])
2025-06-06 15:07:29,316 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:29,316 - DEBUG - Node features tensor shape after scaling: torch.Size([65, 19])
2025-06-06 15:07:29,316 - DEBUG - Edge index tensor shape: torch.Size([2, 89])
2025-06-06 15:07:29,316 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:29,317 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:29,317 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:07:29,318 - DEBUG - Shape of encoded categorical edge features: torch.Size([89, 2])
2025-06-06 15:07:29,318 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:29,318 - DEBUG - Shape of scaled numerical edge features: torch.Size([89, 20])
2025-06-06 15:07:29,318 - DEBUG - Final edge attributes tensor shape: torch.Size([89, 22])
2025-06-06 15:07:29,318 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:29,318 - INFO - Performing online update...
2025-06-06 15:07:29,319 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:29,319 - DEBUG - Updated RunningStats: new_mean=[ 4.21644726e-10 -4.44681945e-10 -2.59905116e-09  2.29420379e-09
 -2.55264155e-08  1.38299652e-08 -9.61596411e-09 -2.30099563e-09
 -2.98088655e-09  9.90995023e-10  1.40796558e-09 -1.53613986e-09
  3.73497105e-09 -3.46676549e-09  9.86360316e-10  8.08173416e-10
 -3.76892422e-09  1.17351530e-09 -4.77371216e-09], new_M2=[194716.00539825 194716.00535504 194716.0002626  194716.00431521
 194715.99847648 194715.99850737 194715.99598447 194715.99818775
 194715.99315525 194715.99842508 194716.00189768 194715.99386764
 194715.99277907 154924.99667393 154925.00010531 154924.99883959
 154925.00001156 194716.00020974 194716.0077494 ], new_n=194716
2025-06-06 15:07:29,320 - DEBUG - Updated RunningStats: new_mean=[ 1.41505208e+00  5.49778295e+00  1.06892088e-10  2.59705963e-10
  1.44040332e-10 -1.63575755e-10 -1.28699114e-09  1.98937756e-10
  2.90723800e-10 -2.05292950e-10  3.24531024e-10 -3.48975455e-09
 -8.71278496e-10  2.90005512e-10  3.07737060e-10 -1.56249704e-10
 -1.56249704e-10 -1.56249704e-10 -1.56249704e-10 -1.56249704e-10
 -1.56249704e-10 -8.11747092e-11], new_M2=[ 108019.37233781 1873374.68925301  419250.99899675  419251.00591935
  419251.00569923  419250.99326447  419251.0003652   419250.99909979
  419251.00166659  419250.99933496  419250.99393546  419251.00854029
  419251.00112281  419250.99983172  419251.00182418  419250.99456156
  419250.99456156  419250.99456156  419250.99456156  419250.99456156
  419250.99456156  419250.99906024], new_n=419251
2025-06-06 15:07:29,320 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89198988 0.89198989 0.89198989 0.89198989 1.
 1.00000002]
2025-06-06 15:07:29,320 - DEBUG - Calculated standard deviation: [0.50759083 2.11385537 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:29,320 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:29,320 - DEBUG - Online update step: 1/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,320 - DEBUG - Online update step: 2/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,320 - DEBUG - Online update step: 3/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,320 - DEBUG - Online update step: 4/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,320 - DEBUG - Online update step: 5/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,320 - DEBUG - Online update step: 6/50
2025-06-06 15:07:29,320 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 7/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 8/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 9/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 10/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 11/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 12/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 13/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 14/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 15/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 16/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 17/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 18/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 19/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 20/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 21/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 22/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 23/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 24/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,321 - DEBUG - Online update step: 25/50
2025-06-06 15:07:29,321 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 26/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 27/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 28/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 29/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 30/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 31/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 32/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 33/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 34/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 35/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 36/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 37/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 38/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 39/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 40/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 41/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 42/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 43/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,322 - DEBUG - Online update step: 44/50
2025-06-06 15:07:29,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 45/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 46/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 47/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 48/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 49/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - DEBUG - Online update step: 50/50
2025-06-06 15:07:29,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:29,323 - WARNING - No successful steps during online update.
2025-06-06 15:07:29,323 - DEBUG - Current node mean: [-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], current edge mean: [ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:07:29,323 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0700
2025-06-06 15:07:29,324 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:07:29,324 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:07:29,324 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:07:29,325 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:07:29,326 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:07:29,326 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:07:29,326 - INFO - Optimizer and scheduler reset.
2025-06-06 15:07:29,327 - DEBUG - Updated reference mean: node=[-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], edge=[ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:07:29,327 - DEBUG - Updated reference std: node=[1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822], edge=[0.32475337 2.0999053  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658 ]
2025-06-06 15:07:29,327 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:29,327 - INFO - Running anomaly detection...
2025-06-06 15:07:29,327 - INFO - Starting anomaly detection.
2025-06-06 15:07:30,010 - DEBUG - Node reconstruction errors: [  1.831591     1.831591     1.831591     0.5808749    0.5808749
   1.6549958    5.938216     0.6029805    0.9811542    0.6029805
   0.5808749    0.6029805    0.58087486   2.3250759    1.831591
  43.287876     0.6029805    0.8414482    0.5808749   81.636604
   0.5808749  105.188736     0.6029805    0.6029805    1.2160463
   0.58087486   1.9270779    0.5808749    0.5808749    0.6029805
   0.6029803    0.9811542    1.066082     0.5808749    9.133824
   2.5366929   31.967562     0.6029805    0.58087486   0.5808749
 327.86694      2.5366929    0.6029805    1.0660822    0.8414482
   0.5808749    0.5808749    5.105994     0.5808749    1.2160463
  20.862661    75.893005     0.5808749    0.5808749    2.8080952
   0.9811546    0.9811542    0.5808749    1.831591     0.5808749
   0.5808749    0.9811542    5.767937     0.9811547    1.8315908 ]
2025-06-06 15:07:30,011 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.8       ]
2025-06-06 15:07:30,094 - ERROR - An error occurred while processing file nw_graph_encoded_1749044288.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:30,094 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:30,095 - INFO - 
--- Processing file: nw_graph_encoded_1749044348.dot ---
2025-06-06 15:07:30,095 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot
2025-06-06 15:07:30,095 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot file.
2025-06-06 15:07:30,097 - INFO - Parsed 77 nodes.
2025-06-06 15:07:30,099 - INFO - Parsed 106 edges.
2025-06-06 15:07:30,105 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:30,105 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:30,107 - DEBUG - Initial node features tensor shape: torch.Size([77, 19])
2025-06-06 15:07:30,108 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:30,108 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 19])
2025-06-06 15:07:30,109 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-06 15:07:30,109 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:30,110 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:30,111 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:07:30,111 - DEBUG - Shape of encoded categorical edge features: torch.Size([106, 2])
2025-06-06 15:07:30,112 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:30,112 - DEBUG - Shape of scaled numerical edge features: torch.Size([106, 20])
2025-06-06 15:07:30,113 - DEBUG - Final edge attributes tensor shape: torch.Size([106, 22])
2025-06-06 15:07:30,113 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:30,113 - INFO - Performing online update...
2025-06-06 15:07:30,113 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:30,113 - DEBUG - Updated RunningStats: new_mean=[ 4.21286810e-10 -4.44238425e-10 -2.58960906e-09  2.29344991e-09
 -2.55141832e-08  1.38244983e-08 -9.60940910e-09 -2.29893860e-09
 -2.97970823e-09  9.86395933e-10  1.40098324e-09 -1.53415568e-09
  3.73471861e-09 -3.46401815e-09  9.78473670e-10  8.09536895e-10
 -3.76200308e-09  1.17769864e-09 -4.77304911e-09], new_M2=[194793.00540041 194793.0053572  194793.00025983 194793.00431126
 194792.99847808 194792.99850978 194792.99598699 194792.99818536
 194792.99315972 194792.99841884 194793.00189424 194792.99386547
 194792.99277333 155001.99667597 155002.00011097 155001.99884114
 155002.0000119  194793.00020784 194793.00775029], new_n=194793
2025-06-06 15:07:30,114 - DEBUG - Updated RunningStats: new_mean=[ 1.41497817e+00  5.49725174e+00  1.08175361e-10  2.59067342e-10
  1.45429699e-10 -1.62988083e-10 -1.28642903e-09  1.99456005e-10
  2.89208299e-10 -2.04135082e-10  3.23187559e-10 -3.49116186e-09
 -8.70503056e-10  2.85774805e-10  3.02400338e-10 -1.56458943e-10
 -1.56458943e-10 -1.56458943e-10 -1.56458943e-10 -1.56458943e-10
 -1.56458943e-10 -8.03546904e-11], new_M2=[ 108041.83912514 1874284.08263607  419356.99900394  419357.00591397
  419357.00570747  419356.99327037  419357.00036625  419356.99910507
  419357.00166515  419356.99933401  419356.99392674  419357.00854344
  419357.00112334  419356.99983417  419357.00182337  419356.99456081
  419356.99456081  419356.99456081  419356.99456081  419356.99456081
  419356.99456081  419356.99906466], new_n=419357
2025-06-06 15:07:30,114 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89203516 0.89203517 0.89203517 0.89203517 1.
 1.00000002]
2025-06-06 15:07:30,114 - DEBUG - Calculated standard deviation: [0.50757946 2.11410114 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:30,114 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:30,114 - DEBUG - Online update step: 1/50
2025-06-06 15:07:30,114 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,114 - DEBUG - Online update step: 2/50
2025-06-06 15:07:30,114 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,114 - DEBUG - Online update step: 3/50
2025-06-06 15:07:30,114 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,114 - DEBUG - Online update step: 4/50
2025-06-06 15:07:30,114 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,114 - DEBUG - Online update step: 5/50
2025-06-06 15:07:30,114 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 6/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 7/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 8/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 9/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 10/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 11/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 12/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 13/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 14/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 15/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 16/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 17/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 18/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 19/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 20/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 21/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 22/50
2025-06-06 15:07:30,115 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,115 - DEBUG - Online update step: 23/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 24/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 25/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 26/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 27/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 28/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 29/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 30/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 31/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 32/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 33/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 34/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 35/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 36/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 37/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 38/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 39/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,116 - DEBUG - Online update step: 40/50
2025-06-06 15:07:30,116 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 41/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 42/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 43/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 44/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 45/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 46/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 47/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 48/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 49/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - DEBUG - Online update step: 50/50
2025-06-06 15:07:30,117 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,117 - WARNING - No successful steps during online update.
2025-06-06 15:07:30,118 - DEBUG - Current node mean: [-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], current edge mean: [ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:07:30,118 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.9938
2025-06-06 15:07:30,118 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:07:30,118 - DEBUG - Updated reference mean: node=[-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], edge=[ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:07:30,118 - DEBUG - Updated reference std: node=[1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575], edge=[0.3573135 2.0502229 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506]
2025-06-06 15:07:30,118 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:30,118 - INFO - Running anomaly detection...
2025-06-06 15:07:30,119 - INFO - Starting anomaly detection.
2025-06-06 15:07:30,214 - DEBUG - Node reconstruction errors: [  2.0583339    1.1917377    1.1917377    1.1917377    1.1917377
   1.1917377    1.1917374    1.1917374    1.1917377    0.47634807
   0.47634807   1.3531477    6.319151     1.1917377    0.61915576
   0.6850538    0.61915576   0.47634807   0.61915576   2.2921364
   2.6141882    5.9455385   61.59746      2.1482644    0.61915576
   1.1917377    0.6282755    0.47634807  95.902855     0.47634807
 136.3338       0.61915576   0.61915576   1.1130546    1.1917377
   0.47634807   1.9997245    0.47634798   0.476348     0.61915576
   0.61915576   0.68505365   1.084836     0.47634807  10.992887
   1.8766427   42.723885     0.61915576   0.47634807   0.47634807
 399.19263      1.8766427    0.61915576   1.084836     0.6282754
   0.47634792   0.47634807   5.31906      0.47634807   1.1130546
  22.809856    87.52273      0.47634792   0.47634792   2.1482646
   0.68505365   2.0583339    0.68505365   0.47634807   1.1917377
   1.1917374    0.47634792   0.47634807   0.68505365   7.392375
   0.68505365   1.1917375 ]
2025-06-06 15:07:30,215 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.8       ]
2025-06-06 15:07:30,233 - ERROR - An error occurred while processing file nw_graph_encoded_1749044348.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:30,234 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:30,234 - INFO - 
--- Processing file: nw_graph_encoded_1749044408.dot ---
2025-06-06 15:07:30,234 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot
2025-06-06 15:07:30,234 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot file.
2025-06-06 15:07:30,236 - INFO - Parsed 131 nodes.
2025-06-06 15:07:30,245 - INFO - Parsed 188 edges.
2025-06-06 15:07:30,254 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:30,257 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:30,258 - DEBUG - Initial node features tensor shape: torch.Size([131, 19])
2025-06-06 15:07:30,259 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:30,259 - DEBUG - Node features tensor shape after scaling: torch.Size([131, 19])
2025-06-06 15:07:30,260 - DEBUG - Edge index tensor shape: torch.Size([2, 188])
2025-06-06 15:07:30,260 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:30,261 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:30,261 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:07:30,262 - DEBUG - Shape of encoded categorical edge features: torch.Size([188, 2])
2025-06-06 15:07:30,262 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:30,262 - DEBUG - Shape of scaled numerical edge features: torch.Size([188, 20])
2025-06-06 15:07:30,262 - DEBUG - Final edge attributes tensor shape: torch.Size([188, 22])
2025-06-06 15:07:30,263 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:30,263 - INFO - Performing online update...
2025-06-06 15:07:30,263 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:30,263 - DEBUG - Updated RunningStats: new_mean=[ 4.22413154e-10 -4.45258565e-10 -2.58878605e-09  2.29213792e-09
 -2.55031519e-08  1.37983893e-08 -9.60279814e-09 -2.30412083e-09
 -2.97690302e-09  9.90319779e-10  1.40738052e-09 -1.54023412e-09
  3.73557229e-09 -3.47873760e-09  9.77816080e-10  8.08266603e-10
 -3.76119484e-09  1.16908100e-09 -4.78513055e-09], new_M2=[194924.00539637 194924.00535317 194924.0002655  194924.0043165
 194923.99847555 194923.99850814 194923.99597809 194923.99817383
 194923.99317245 194923.99842334 194924.00189916 194923.99385479
 194923.99277476 155132.99668183 155133.0001155  155132.99884346
 155133.00001288 194924.00021783 194924.00776077], new_n=194924
2025-06-06 15:07:30,264 - DEBUG - Updated RunningStats: new_mean=[ 1.41489709e+00  5.49634962e+00  1.08180719e-10  2.57788057e-10
  1.46176992e-10 -1.61978275e-10 -1.28057380e-09  1.97260000e-10
  2.88776250e-10 -1.99252640e-10  3.25067231e-10 -3.49337451e-09
 -8.69010829e-10  2.87418180e-10  3.03374751e-10 -1.55869945e-10
 -1.55869945e-10 -1.55869945e-10 -1.55869945e-10 -1.55869945e-10
 -1.55869945e-10 -8.07715303e-11], new_M2=[ 108083.6931819  1875806.65943824  419544.99901331  419545.00590588
  419545.0057123   419544.99327098  419545.00036707  419544.99909742
  419545.00166791  419544.99933123  419544.99394318  419545.0085507
  419545.00112291  419544.99983809  419545.00184094  419544.99456365
  419544.99456365  419544.99456365  419544.99456365  419544.99456365
  419544.99456365  419544.99906359], new_n=419545
2025-06-06 15:07:30,264 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89211211 0.89211212 0.89211211 0.89211212 1.
 1.00000002]
2025-06-06 15:07:30,264 - DEBUG - Calculated standard deviation: [0.507564   2.11448575 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:30,264 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:30,264 - DEBUG - Online update step: 1/50
2025-06-06 15:07:30,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,264 - DEBUG - Online update step: 2/50
2025-06-06 15:07:30,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,264 - DEBUG - Online update step: 3/50
2025-06-06 15:07:30,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 4/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 5/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 6/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 7/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 8/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 9/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 10/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 11/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 12/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 13/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 14/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 15/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 16/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 17/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 18/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 19/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,265 - DEBUG - Online update step: 20/50
2025-06-06 15:07:30,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 21/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 22/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 23/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 24/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 25/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 26/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 27/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 28/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 29/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 30/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 31/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 32/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 33/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 34/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 35/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 36/50
2025-06-06 15:07:30,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,266 - DEBUG - Online update step: 37/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 38/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 39/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 40/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 41/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 42/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 43/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 44/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 45/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 46/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 47/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 48/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 49/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - DEBUG - Online update step: 50/50
2025-06-06 15:07:30,267 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:30,267 - WARNING - No successful steps during online update.
2025-06-06 15:07:30,268 - DEBUG - Current node mean: [-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], current edge mean: [ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:07:30,268 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.9517
2025-06-06 15:07:30,268 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:07:30,269 - DEBUG - Updated reference mean: node=[-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], edge=[ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:07:30,269 - DEBUG - Updated reference std: node=[1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388], edge=[0.43694445 2.0172415  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026702  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703 ]
2025-06-06 15:07:30,269 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:30,269 - INFO - Running anomaly detection...
2025-06-06 15:07:30,269 - INFO - Starting anomaly detection.
2025-06-06 15:07:31,146 - DEBUG - Node reconstruction errors: [1.0714364e+00 1.0714364e+00 1.0714364e+00 3.6994362e-01 6.3231187e+00
 3.6994362e-01 8.9146084e-01 5.1073474e-01 4.1421568e-01 4.1421568e-01
 5.1073474e-01 3.6994362e-01 1.0714363e+00 1.0714363e+00 3.6994362e-01
 2.4391487e+00 5.1073474e-01 9.7178528e+01 2.3563818e+01 1.4740744e+00
 9.7711241e-01 5.1073474e-01 4.8793006e+00 5.1073474e-01 5.1073468e-01
 4.7961706e-01 1.0228516e+00 5.8455786e+02 1.0714364e+00 5.1073474e-01
 8.0746114e-01 9.5298393e+01 1.0714364e+00 1.3536558e+01 5.1073474e-01
 1.2070366e+00 8.0746114e-01 1.0714364e+00 5.1073474e-01 5.1073474e-01
 5.1073468e-01 5.1073468e-01 1.1720170e+00 5.1073480e-01 4.0742836e+00
 6.0881836e+02 9.7711241e-01 8.0746114e-01 8.0746114e-01 1.0714364e+00
 1.0714364e+00 1.5445905e+02 4.7961706e-01 4.1421565e-01 6.4261174e-01
 1.9356718e+00 1.3663730e+02 1.8637317e+00 1.5593277e+00 8.9146084e-01
 1.0714364e+00 5.1073474e-01 8.0746114e-01 5.1073474e-01 8.0746114e-01
 8.0746114e-01 5.1073474e-01 3.6994362e-01 6.4261174e-01 1.0714363e+00
 1.5430298e+00 1.4740744e+00 9.3384057e-01 1.4740744e+00 5.1073474e-01
 5.1073474e-01 4.4624901e+00 1.5430298e+00 4.1421565e-01 4.1421565e-01
 1.7655311e+00 8.0746114e-01 1.5430307e+00 4.1421577e-01 3.6994362e-01
 4.0742836e+00 4.1421568e-01 5.1073474e-01 5.2472057e+00 4.8823581e+00
 4.0742836e+00 6.4261192e-01 6.4261192e-01 6.4261192e-01 1.2964245e+00
 1.4740744e+00 6.4261174e-01 1.0228515e+00 1.0714364e+00 1.4740744e+00
 1.4740744e+00 6.4261192e-01 1.4740744e+00 8.9146084e-01 1.8914038e+00
 6.4261174e-01 2.3785359e+02 8.0746114e-01 2.3785352e+02 6.4261192e-01
 1.8914038e+00 6.4261174e-01 6.4261192e-01 6.4261192e-01 6.4261192e-01
 1.4740744e+00 6.4261192e-01 2.3519775e+02 6.4261192e-01 1.0714364e+00
 1.0714364e+00 1.0714364e+00 1.0714364e+00 1.0714364e+00 1.9086002e+00
 1.9086002e+00 1.4740744e+00 1.0714364e+00 4.1421568e-01 1.2070366e+00
 1.9086016e+00]
2025-06-06 15:07:31,151 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.2786126  0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-06 15:07:31,281 - ERROR - An error occurred while processing file nw_graph_encoded_1749044408.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:31,286 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:31,286 - INFO - 
--- Processing file: nw_graph_encoded_1749044468.dot ---
2025-06-06 15:07:31,286 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot
2025-06-06 15:07:31,286 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot file.
2025-06-06 15:07:31,294 - INFO - Parsed 258 nodes.
2025-06-06 15:07:31,304 - INFO - Parsed 397 edges.
2025-06-06 15:07:31,353 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:31,354 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:31,359 - DEBUG - Initial node features tensor shape: torch.Size([258, 19])
2025-06-06 15:07:31,369 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:31,385 - DEBUG - Node features tensor shape after scaling: torch.Size([258, 19])
2025-06-06 15:07:31,386 - DEBUG - Edge index tensor shape: torch.Size([2, 397])
2025-06-06 15:07:31,386 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:31,393 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:31,394 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:31,395 - DEBUG - Shape of encoded categorical edge features: torch.Size([397, 2])
2025-06-06 15:07:31,400 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:31,400 - DEBUG - Shape of scaled numerical edge features: torch.Size([397, 20])
2025-06-06 15:07:31,400 - DEBUG - Final edge attributes tensor shape: torch.Size([397, 22])
2025-06-06 15:07:31,401 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:31,401 - INFO - Performing online update...
2025-06-06 15:07:31,401 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:31,401 - DEBUG - Updated RunningStats: new_mean=[ 4.23381689e-10 -4.45433453e-10 -2.61315364e-09  2.27538507e-09
 -2.54840990e-08  1.37990836e-08 -9.57269810e-09 -2.28931802e-09
 -2.97296802e-09  9.91072046e-10  1.38292208e-09 -1.54919185e-09
  3.72025153e-09 -3.45803047e-09  9.70034239e-10  8.03533644e-10
 -3.77240826e-09  1.16916395e-09 -4.77758384e-09], new_M2=[195182.00539258 195182.00534927 195182.00027101 195182.00428802
 195181.99847034 195181.99850826 195181.99597949 195181.9981764
 195181.99318463 195181.99841654 195182.00188941 195181.99385828
 195181.99277367 155390.99667504 155391.00009974 155390.99885009
 155391.00001749 195182.00022244 195182.00775695], new_n=195182
2025-06-06 15:07:31,402 - DEBUG - Updated RunningStats: new_mean=[ 1.41481205e+00  5.49545652e+00  1.10974125e-10  2.59849416e-10
  1.47026805e-10 -1.63358229e-10 -1.27627831e-09  1.94292470e-10
  2.87692874e-10 -1.93127380e-10  3.24130084e-10 -3.49592183e-09
 -8.68632842e-10  2.81344853e-10  3.04458514e-10 -1.54154093e-10
 -1.54154093e-10 -1.54154093e-10 -1.54154093e-10 -1.54154093e-10
 -1.54154093e-10 -7.98224904e-11], new_M2=[ 108175.98611475 1878080.83103146  419941.99902367  419942.00594181
  419942.0057282   419941.99323844  419942.00035252  419941.99909331
  419942.00165885  419941.99932645  419941.9939655   419942.00856618
  419942.00112632  419941.99983897  419942.00183214  419941.99457997
  419941.99457997  419941.99457997  419941.99457997  419941.99457997
  419941.99457997  419941.99906832], new_n=419942
2025-06-06 15:07:31,402 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89226333 0.89226334 0.89226333 0.89226334 1.
 1.00000002]
2025-06-06 15:07:31,402 - DEBUG - Calculated standard deviation: [0.50754058 2.1147668  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:31,402 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:31,402 - DEBUG - Online update step: 1/50
2025-06-06 15:07:31,402 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,402 - DEBUG - Online update step: 2/50
2025-06-06 15:07:31,403 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,403 - DEBUG - Online update step: 3/50
2025-06-06 15:07:31,406 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,406 - DEBUG - Online update step: 4/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 5/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 6/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 7/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 8/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 9/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 10/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 11/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 12/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 13/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 14/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 15/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 16/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 17/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 18/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 19/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,407 - DEBUG - Online update step: 20/50
2025-06-06 15:07:31,407 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 21/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 22/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 23/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 24/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 25/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 26/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 27/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 28/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 29/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 30/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 31/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 32/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 33/50
2025-06-06 15:07:31,408 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,408 - DEBUG - Online update step: 34/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 35/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 36/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 37/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 38/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 39/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 40/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 41/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 42/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 43/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 44/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 45/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 46/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 47/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 48/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 49/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,409 - DEBUG - Online update step: 50/50
2025-06-06 15:07:31,409 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:31,410 - WARNING - No successful steps during online update.
2025-06-06 15:07:31,412 - DEBUG - Current node mean: [ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], current edge mean: [ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:07:31,412 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4463
2025-06-06 15:07:31,413 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:07:31,413 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:07:31,413 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:07:31,414 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:07:31,415 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:07:31,415 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:07:31,415 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:07:31,415 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:07:31,415 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:07:31,416 - INFO - Optimizer and scheduler reset.
2025-06-06 15:07:31,416 - DEBUG - Updated reference mean: node=[ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], edge=[ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:07:31,417 - DEBUG - Updated reference std: node=[1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436], edge=[0.47429672 2.2020373  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618 ]
2025-06-06 15:07:31,417 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:31,417 - INFO - Running anomaly detection...
2025-06-06 15:07:31,417 - INFO - Starting anomaly detection.
2025-06-06 15:07:31,962 - DEBUG - Node reconstruction errors: [2.2477055e+00 6.9919193e-01 2.3613853e+00 5.6833851e-01 5.3784305e-01
 6.9919193e-01 6.9919193e-01 6.9919193e-01 6.3289690e-01 6.3289690e-01
 5.2741647e-01 5.7066785e+02 6.9919193e-01 2.3898742e+00 8.7612706e-01
 2.3898742e+00 2.3898742e+00 3.1116452e+02 3.1116452e+02 5.2741647e-01
 6.1491764e-01 6.3289690e-01 5.3784305e-01 7.6786870e-01 5.3784305e-01
 6.9919175e-01 8.7612706e-01 6.3289690e-01 5.2741647e-01 1.7513918e+00
 5.2741647e-01 6.3289690e-01 6.1491764e-01 2.2035351e+00 2.5132177e+00
 3.9542282e+00 1.0692326e+00 5.6833851e-01 6.3289690e-01 6.3289690e-01
 8.7612706e-01 2.2035351e+00 2.8093279e+03 5.6833851e-01 2.6577649e+00
 6.2825328e-01 6.0016799e-01 3.8169320e+00 5.6833851e-01 5.1717693e-01
 2.3925076e+00 1.0692327e+00 1.0692326e+00 5.3784305e-01 6.3289690e-01
 5.8544648e-01 1.9740337e+00 5.3784305e-01 6.3289690e-01 5.1717693e-01
 5.2741647e-01 1.0692326e+00 1.5679578e+00 1.5679578e+00 8.7612706e-01
 1.0692326e+00 1.5679578e+00 6.3289690e-01 6.3289690e-01 1.0692326e+00
 6.3289690e-01 2.6577649e+00 8.7612706e-01 7.5464523e-01 7.3626810e-01
 6.9919193e-01 6.3289702e-01 5.8544654e-01 6.3289690e-01 1.0055526e+00
 6.9919193e-01 6.2825328e-01 5.2741647e-01 5.6833851e-01 6.9919193e-01
 2.9798218e+02 6.3289690e-01 6.3289690e-01 6.3289690e-01 6.3289690e-01
 6.9919193e-01 6.3289690e-01 8.7612706e-01 6.3289690e-01 1.0627706e+00
 1.1142405e+00 1.5679578e+00 6.3289690e-01 1.9725281e+00 6.9919193e-01
 1.6948800e+00 2.2035351e+00 6.9919175e-01 1.0692327e+00 6.3289690e-01
 1.1560812e+00 1.0692326e+00 7.5464523e-01 1.0692326e+00 1.0692326e+00
 6.3289690e-01 1.5679578e+00 3.6764643e+00 6.9919193e-01 8.7612706e-01
 2.5555220e+00 2.3613853e+00 8.2137698e-01 7.0782719e+00 3.7984025e+00
 6.3289690e-01 3.0905704e+02 1.0062177e+00 1.0692326e+00 2.2477055e+00
 2.6577649e+00 1.8363191e+03 6.3289690e-01 8.7305349e-01 6.9919175e-01
 1.0692326e+00 6.3289690e-01 3.1952605e+00 1.0692326e+00 4.5335326e+00
 1.0754614e+00 5.3784305e-01 6.3289690e-01 4.2021389e+00 9.4693237e+01
 2.8125198e+03 1.0692326e+00 8.7612706e-01 7.5464523e-01 2.4978874e+00
 7.5464523e-01 6.3289690e-01 6.3289690e-01 8.7612706e-01 8.7305361e-01
 1.0692326e+00 5.6833851e-01 5.6833851e-01 6.3289690e-01 5.8544654e-01
 6.3289702e-01 2.5159729e+00 6.3289690e-01 2.6577649e+00 6.3289690e-01
 6.3289690e-01 6.3289690e-01 2.6577649e+00 6.3289690e-01 6.3289690e-01
 1.0692326e+00 3.7984025e+00 6.3289690e-01 6.9919193e-01 6.9919193e-01
 1.5679578e+00 6.9919193e-01 6.3289690e-01 1.4562242e+00 3.0496194e+00
 6.3289690e-01 7.3480493e-01 6.3289690e-01 6.3289690e-01 6.3289690e-01
 1.0692327e+00 7.5464529e-01 6.3289690e-01 6.3289690e-01 6.3289690e-01
 6.3289690e-01 6.3289690e-01 6.3289690e-01 8.7612706e-01 3.1695731e+02
 6.3289690e-01 6.9919193e-01 6.3289690e-01 6.3289690e-01 6.3289690e-01
 6.3289690e-01 1.6948800e+00 1.0062177e+00 6.3289690e-01 1.5679578e+00
 2.9922297e+00 6.3289690e-01 6.3289690e-01 8.7612706e-01 6.9919193e-01
 8.7612706e-01 1.0692327e+00 1.9345661e+00 6.3289690e-01 6.9919193e-01
 1.8456120e+01 6.3289690e-01 6.3289690e-01 6.3289690e-01 1.9345661e+00
 6.3289690e-01 6.3289690e-01 6.3289690e-01 7.8819293e-01 6.3289690e-01
 6.3289690e-01 6.9919193e-01 6.3289690e-01 6.9919193e-01 3.7984025e+00
 6.3289690e-01 6.3289690e-01 7.3480493e-01 6.3289690e-01 1.5679578e+00
 6.9919193e-01 6.3289690e-01 6.3289702e-01 6.3289702e-01 1.9345661e+00
 6.3289690e-01 6.3289690e-01 6.3289690e-01 6.3289690e-01 2.5555220e+00
 6.9919193e-01 6.3289690e-01 6.3289690e-01 8.7612706e-01 6.3289690e-01
 5.2741647e-01 6.3289690e-01 1.0062177e+00 8.7612706e-01 2.2477055e+00
 1.0062177e+00 8.7612706e-01 6.3289690e-01 8.7612706e-01 2.3898742e+00
 8.7612706e-01 8.7612695e-01 1.0062177e+00]
2025-06-06 15:07:31,964 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8]
2025-06-06 15:07:32,103 - ERROR - An error occurred while processing file nw_graph_encoded_1749044468.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:32,107 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:32,107 - INFO - 
--- Processing file: nw_graph_encoded_1749044528.dot ---
2025-06-06 15:07:32,107 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot
2025-06-06 15:07:32,107 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot file.
2025-06-06 15:07:32,116 - INFO - Parsed 365 nodes.
2025-06-06 15:07:32,130 - INFO - Parsed 656 edges.
2025-06-06 15:07:32,249 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:32,250 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:32,253 - DEBUG - Initial node features tensor shape: torch.Size([365, 19])
2025-06-06 15:07:32,275 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:32,287 - DEBUG - Node features tensor shape after scaling: torch.Size([365, 19])
2025-06-06 15:07:32,288 - DEBUG - Edge index tensor shape: torch.Size([2, 656])
2025-06-06 15:07:32,288 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:32,293 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:32,304 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:32,305 - DEBUG - Shape of encoded categorical edge features: torch.Size([656, 2])
2025-06-06 15:07:32,307 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:32,311 - DEBUG - Shape of scaled numerical edge features: torch.Size([656, 20])
2025-06-06 15:07:32,311 - DEBUG - Final edge attributes tensor shape: torch.Size([656, 22])
2025-06-06 15:07:32,311 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:32,311 - INFO - Performing online update...
2025-06-06 15:07:32,311 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:32,312 - DEBUG - Updated RunningStats: new_mean=[ 4.39355962e-10 -4.60604540e-10 -2.61787755e-09  2.27586248e-09
 -2.54023927e-08  1.37919202e-08 -9.61420579e-09 -2.28245399e-09
 -2.96741880e-09  1.01101605e-09  1.40251568e-09 -1.54515715e-09
  3.70523000e-09 -3.42200930e-09  9.64718300e-10  8.02033801e-10
 -3.79066605e-09  1.16965111e-09 -4.79411782e-09], new_M2=[195547.00539272 195547.00534928 195547.00028515 195547.00430542
 195546.99846583 195546.99848933 195546.99597097 195546.99818638
 195546.99318771 195546.99843644 195547.00189806 195546.99385512
 195546.99280654 155755.99665611 155756.00009084 155755.9988441
 155756.00002816 195547.00019391 195547.00776852], new_n=195547
2025-06-06 15:07:32,313 - DEBUG - Updated RunningStats: new_mean=[ 1.41475946e+00  5.49431524e+00  1.06142744e-10  2.56805540e-10
  1.47488899e-10 -1.65963740e-10 -1.28550102e-09  1.97547509e-10
  2.88411644e-10 -2.03250448e-10  3.16879840e-10 -3.48434238e-09
 -8.64058483e-10  2.65600927e-10  3.01342016e-10 -1.50809792e-10
 -1.50809792e-10 -1.50809792e-10 -1.50809792e-10 -1.50809792e-10
 -1.50809792e-10 -8.17262748e-11], new_M2=[ 108339.45621472 1881069.90773141  420597.9989902   420598.00589578
  420598.00574358  420597.99321542  420598.00035906  420597.99911802
  420598.00165303  420597.99933495  420597.99392429  420598.00854854
  420598.00112231  420597.99984703  420598.0018023   420597.99462045
  420597.99462045  420597.99462045  420597.99462045  420597.99462045
  420597.99462045  420597.99903535], new_n=420598
2025-06-06 15:07:32,313 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89247654 0.89247655 0.89247655 0.89247655 1.
 1.00000002]
2025-06-06 15:07:32,313 - DEBUG - Calculated standard deviation: [0.50752767 2.11479788 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:32,313 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:32,313 - DEBUG - Online update step: 1/50
2025-06-06 15:07:32,313 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,313 - DEBUG - Online update step: 2/50
2025-06-06 15:07:32,313 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,313 - DEBUG - Online update step: 3/50
2025-06-06 15:07:32,313 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,313 - DEBUG - Online update step: 4/50
2025-06-06 15:07:32,314 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,314 - DEBUG - Online update step: 5/50
2025-06-06 15:07:32,314 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 6/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 7/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 8/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 9/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 10/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 11/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 12/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 13/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 14/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 15/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 16/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 17/50
2025-06-06 15:07:32,322 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,322 - DEBUG - Online update step: 18/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 19/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 20/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 21/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 22/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 23/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 24/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 25/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 26/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 27/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 28/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 29/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 30/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 31/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 32/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 33/50
2025-06-06 15:07:32,323 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,323 - DEBUG - Online update step: 34/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 35/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 36/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 37/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 38/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 39/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 40/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 41/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 42/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 43/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 44/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 45/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 46/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 47/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 48/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,324 - DEBUG - Online update step: 49/50
2025-06-06 15:07:32,324 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,325 - DEBUG - Online update step: 50/50
2025-06-06 15:07:32,325 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:32,332 - WARNING - No successful steps during online update.
2025-06-06 15:07:32,333 - DEBUG - Current node mean: [ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], current edge mean: [ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:07:32,333 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3455
2025-06-06 15:07:32,333 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:07:32,333 - DEBUG - Updated reference mean: node=[ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], edge=[ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:07:32,333 - DEBUG - Updated reference std: node=[1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727], edge=[0.4984336 2.0070016 1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763 ]
2025-06-06 15:07:32,334 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:32,334 - INFO - Running anomaly detection...
2025-06-06 15:07:32,334 - INFO - Starting anomaly detection.
2025-06-06 15:07:33,010 - DEBUG - Node reconstruction errors: [1.0294958e+00 1.0294958e+00 1.0294958e+00 1.0294958e+00 1.0294958e+00
 1.0294958e+00 1.0294958e+00 1.0294958e+00 1.0294958e+00 1.0294958e+00
 1.0294958e+00 1.0294958e+00 1.0294958e+00 1.0294958e+00 7.8757972e-01
 7.8757972e-01 1.0329676e+00 7.3194522e-01 7.8757972e-01 8.8346940e-01
 7.8757972e-01 7.8757972e-01 7.3194522e-01 1.0294958e+00 7.8757972e-01
 7.3194522e-01 1.0294958e+00 1.3292373e+00 8.8346940e-01 1.4915708e+00
 1.4915708e+00 7.8757972e-01 7.8757972e-01 1.0294958e+00 1.4915708e+00
 7.8757972e-01 1.4915711e+00 7.8757972e-01 7.8757972e-01 7.8757972e-01
 1.0294958e+00 8.4192085e-01 1.4915708e+00 2.3322072e+00 2.3322072e+00
 2.3322072e+00 1.4915708e+00 7.8757972e-01 1.4915708e+00 7.8757972e-01
 7.8757972e-01 1.0294958e+00 8.8346940e-01 1.4915708e+00 7.8757972e-01
 7.3194522e-01 7.8757972e-01 7.8757972e-01 7.8757972e-01 1.0294958e+00
 7.8757972e-01 7.8757972e-01 7.8757972e-01 7.8757972e-01 7.8757972e-01
 7.8757972e-01 7.8757972e-01 4.6994700e+00 7.3194522e-01 7.3194522e-01
 2.3322072e+00 6.2106466e-01 3.0450845e+00 7.3859733e-01 1.2391728e+00
 5.7641411e-01 6.2106466e-01 8.8346940e-01 5.7641411e-01 6.2106466e-01
 6.6910982e-01 1.0294958e+00 6.8814611e-01 6.7664734e+02 5.7641411e-01
 1.1361958e+00 1.3292373e+00 1.1361958e+00 2.3322072e+00 1.1361958e+00
 3.8411118e+02 3.8411118e+02 8.8346940e-01 6.8814611e-01 5.4714954e-01
 6.6910982e-01 6.1474729e-01 7.5312775e-01 1.2391728e+00 5.7641411e-01
 1.3292373e+00 6.6910982e-01 6.8814611e-01 2.0451922e+00 6.9058371e-01
 1.2721057e+00 1.4915708e+00 8.6887342e-01 1.0294958e+00 1.1346865e+00
 1.6097378e+00 2.1800048e+00 9.8885077e-01 8.4337586e-01 1.4368417e+00
 6.6910982e-01 7.8757972e-01 1.2519729e+00 2.0926260e+03 8.4337586e-01
 1.2721057e+00 5.8160460e-01 8.4192085e-01 6.9317269e-01 1.8716105e+00
 8.4337586e-01 1.4915708e+00 7.0122206e-01 2.2703846e+00 1.5603809e+00
 1.0294958e+00 1.5603809e+00 5.4851580e-01 7.0003730e-01 6.3396335e-01
 2.1570766e+00 1.2391728e+00 7.0003730e-01 7.0122206e-01 6.8814611e-01
 1.0988702e+00 2.2075822e+00 2.2075822e+00 1.4915708e+00 1.5603809e+00
 2.2075822e+00 1.2721057e+00 1.2721059e+00 1.5603809e+00 6.6910982e-01
 1.2721057e+00 8.8346940e-01 7.8757972e-01 1.1104653e+00 1.1387854e+00
 5.7641411e-01 8.3156514e-01 6.3396335e-01 6.6910982e-01 1.2581712e+00
 5.7641411e-01 7.0122206e-01 6.8814611e-01 8.4337586e-01 7.3194522e-01
 1.2721057e+00 4.3708774e+02 7.8757972e-01 1.2721057e+00 6.6910982e-01
 7.0003730e-01 7.0003730e-01 5.7641411e-01 1.2721057e+00 7.8757972e-01
 1.2721057e+00 7.6660138e-01 2.2703846e+00 2.2075822e+00 1.2721057e+00
 2.5409904e+00 1.9210267e+00 8.8346934e-01 2.0614898e+00 1.1346866e+00
 5.7641411e-01 1.5603809e+00 6.6910982e-01 1.4283293e+00 1.5603809e+00
 1.1104653e+00 1.5603809e+00 1.5603809e+00 7.8757972e-01 6.6910982e-01
 2.2075822e+00 1.7970692e+00 5.7641411e-01 1.4915708e+00 1.2391728e+00
 3.0450845e+00 1.0988702e+00 6.9121590e+00 1.8952928e+00 6.6910982e-01
 4.4404364e+02 7.3194522e-01 7.8757972e-01 1.1387854e+00 8.8346940e-01
 2.3322072e+00 1.2721057e+00 2.1392837e+03 8.3156514e-01 1.2413085e+00
 1.0294958e+00 5.7641411e-01 8.8346940e-01 1.5603809e+00 6.6910982e-01
 3.8454072e+00 1.5603809e+00 4.3245606e+00 1.4546573e+00 1.2391728e+00
 6.6910982e-01 7.8757972e-01 4.4746966e+00 1.1048847e+02 3.2657273e+03
 1.0026468e+00 7.8757972e-01 8.3899891e-01 1.4561790e+00 1.1104653e+00
 1.4368417e+00 1.2721057e+00 7.8757972e-01 1.1387854e+00 1.5603809e+00
 1.0329676e+00 8.4337586e-01 8.4704119e-01 2.1101539e+00 6.3396335e-01
 1.2721057e+00 1.9622145e+00 7.0003730e-01 2.1101539e+00 2.3322072e+00
 8.3156514e-01 6.6910982e-01 1.2721057e+00 1.2721057e+00 6.6910982e-01
 1.2721057e+00 7.8757972e-01 1.5603809e+00 1.8952936e+00 1.2721057e+00
 5.7641411e-01 1.0294958e+00 1.2721057e+00 1.2231888e+00 5.7641411e-01
 1.0294958e+00 7.5312775e-01 1.4407470e+00 3.2543428e+00 1.2721057e+00
 6.9058371e-01 8.3156514e-01 6.6910982e-01 1.2721057e+00 7.8757972e-01
 1.5603809e+00 1.1104653e+00 6.6910982e-01 6.6910982e-01 6.6910982e-01
 1.2721057e+00 6.6910982e-01 1.2721057e+00 7.8757972e-01 4.3715829e+02
 6.6910982e-01 1.2721057e+00 6.6910982e-01 6.6910982e-01 7.8757972e-01
 7.8757972e-01 6.6910994e-01 1.2721057e+00 7.3194522e-01 2.0614898e+00
 7.3194522e-01 6.6910982e-01 7.8757972e-01 2.2075822e+00 4.1878171e+00
 1.2721057e+00 6.6910982e-01 1.3292373e+00 5.7641411e-01 1.3292373e+00
 1.5603809e+00 2.1346073e+00 6.6910982e-01 1.9210267e+00 2.0378408e+01
 6.6910982e-01 7.0003730e-01 8.3156514e-01 1.4407470e+00 8.3156514e-01
 1.2721057e+00 1.4368417e+00 9.4167507e-01 8.3156514e-01 6.6910982e-01
 1.9210267e+00 1.0294958e+00 6.6910982e-01 9.8457116e-01 8.8346940e-01
 1.8279181e+00 6.6910982e-01 6.6910982e-01 8.1650108e-01 6.6910982e-01
 2.2075822e+00 2.1101539e+00 6.6911000e-01 7.8757972e-01 6.6910982e-01
 7.0003730e-01 2.1346073e+00 7.8757972e-01 6.6910982e-01 2.3322072e+00
 6.6910982e-01 7.0003730e-01 1.0294958e+00 8.3156514e-01 1.0294958e+00
 1.2391728e+00 1.6756755e+00 6.6910982e-01 6.6910982e-01 1.5111861e+00
 6.6910982e-01 6.9058371e-01 6.6910982e-01 2.1550679e+03 2.1922474e+00
 7.8757972e-01 1.7901760e+00 7.3194522e-01 7.3194522e-01 6.2106466e-01
 1.3292373e+00 1.2391728e+00 1.3292373e+00 7.8757977e-01 7.3194504e-01]
2025-06-06 15:07:33,012 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8]
2025-06-06 15:07:33,019 - ERROR - An error occurred while processing file nw_graph_encoded_1749044528.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:33,024 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:33,024 - INFO - 
--- Processing file: nw_graph_encoded_1749044588.dot ---
2025-06-06 15:07:33,024 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot
2025-06-06 15:07:33,024 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot file.
2025-06-06 15:07:33,033 - INFO - Parsed 422 nodes.
2025-06-06 15:07:33,049 - INFO - Parsed 847 edges.
2025-06-06 15:07:33,196 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:33,197 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:33,200 - DEBUG - Initial node features tensor shape: torch.Size([422, 19])
2025-06-06 15:07:33,206 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:33,215 - DEBUG - Node features tensor shape after scaling: torch.Size([422, 19])
2025-06-06 15:07:33,216 - DEBUG - Edge index tensor shape: torch.Size([2, 847])
2025-06-06 15:07:33,216 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:33,224 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:33,229 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:33,230 - DEBUG - Shape of encoded categorical edge features: torch.Size([847, 2])
2025-06-06 15:07:33,232 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:33,232 - DEBUG - Shape of scaled numerical edge features: torch.Size([847, 20])
2025-06-06 15:07:33,232 - DEBUG - Final edge attributes tensor shape: torch.Size([847, 22])
2025-06-06 15:07:33,232 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:33,232 - INFO - Performing online update...
2025-06-06 15:07:33,232 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:33,233 - DEBUG - Updated RunningStats: new_mean=[ 4.38866082e-10 -4.59156443e-10 -2.62364596e-09  2.28004822e-09
 -2.53519493e-08  1.36908967e-08 -9.62224504e-09 -2.27772905e-09
 -2.95106773e-09  1.02530123e-09  1.48355591e-09 -1.52753460e-09
  3.69208055e-09 -3.41338570e-09  9.50683842e-10  7.56394547e-10
 -3.77166776e-09  1.15955468e-09 -4.79383122e-09], new_M2=[195969.00534802 195969.0053044  195969.00027472 195969.0043189
 195968.99847066 195968.99848225 195968.9959432  195968.99819807
 195968.99318978 195968.99845683 195969.00189543 195968.99385778
 195968.9927748  156177.9966855  156178.00011607 156177.99881954
 156178.00003314 195969.00022269 195969.00776127], new_n=195969
2025-06-06 15:07:33,234 - DEBUG - Updated RunningStats: new_mean=[ 1.41478485e+00  5.49304654e+00  1.10076726e-10  2.56405717e-10
  1.45455831e-10 -1.62670660e-10 -1.27679486e-09  1.94084346e-10
  2.94995178e-10 -2.07008603e-10  3.22584448e-10 -3.49077963e-09
 -8.59476229e-10  2.31689835e-10  3.01717559e-10 -1.51447261e-10
 -1.51447261e-10 -1.51447261e-10 -1.51447261e-10 -1.51447261e-10
 -1.51447261e-10 -8.14494274e-11], new_M2=[ 108554.87561604 1884360.87289211  421444.99902649  421445.00592853
  421445.00573804  421444.99325679  421445.00034317  421444.99912391
  421445.0016674   421444.99934057  421444.9939265   421445.00858651
  421445.00111884  421444.99986245  421445.00179812  421444.99459746
  421444.99459746  421444.99459746  421444.99459746  421444.99459746
  421444.99459746  421444.9990206 ], new_n=421445
2025-06-06 15:07:33,234 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.892722   0.89272201 0.892722   0.89272201 1.
 1.00000002]
2025-06-06 15:07:33,234 - DEBUG - Calculated standard deviation: [0.50752123 2.11451897 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:33,234 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:33,234 - DEBUG - Online update step: 1/50
2025-06-06 15:07:33,234 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,234 - DEBUG - Online update step: 2/50
2025-06-06 15:07:33,234 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,234 - DEBUG - Online update step: 3/50
2025-06-06 15:07:33,234 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,234 - DEBUG - Online update step: 4/50
2025-06-06 15:07:33,234 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,234 - DEBUG - Online update step: 5/50
2025-06-06 15:07:33,234 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,234 - DEBUG - Online update step: 6/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 7/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 8/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 9/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 10/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 11/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 12/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 13/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 14/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 15/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 16/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 17/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 18/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 19/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 20/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 21/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 22/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 23/50
2025-06-06 15:07:33,235 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,235 - DEBUG - Online update step: 24/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 25/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 26/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 27/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 28/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 29/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 30/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 31/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 32/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 33/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 34/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 35/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 36/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 37/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 38/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 39/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 40/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,236 - DEBUG - Online update step: 41/50
2025-06-06 15:07:33,236 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 42/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 43/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 44/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 45/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 46/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 47/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 48/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 49/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - DEBUG - Online update step: 50/50
2025-06-06 15:07:33,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:33,237 - WARNING - No successful steps during online update.
2025-06-06 15:07:33,238 - DEBUG - Current node mean: [ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], current edge mean: [ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:07:33,238 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2979
2025-06-06 15:07:33,238 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:07:33,239 - DEBUG - Updated reference mean: node=[ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], edge=[ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:07:33,240 - DEBUG - Updated reference std: node=[1.0011868 1.0011868 1.001187  1.001187  1.001187  1.001187  1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187  1.0011868 1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187 ], edge=[0.5044536 1.8686519 1.0005909 1.0005909 1.0005908 1.0005909 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005909 1.0005908 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908
 1.0005908]
2025-06-06 15:07:33,241 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:33,241 - INFO - Running anomaly detection...
2025-06-06 15:07:33,241 - INFO - Starting anomaly detection.
2025-06-06 15:07:34,079 - DEBUG - Node reconstruction errors: [1.3027599e+00 1.3027599e+00 1.2093948e+00 1.2093948e+00 1.2093948e+00
 3.0203142e+00 1.3027599e+00 3.0203142e+00 1.3027599e+00 1.1166004e+00
 1.0368332e+00 8.6798817e-01 1.0368332e+00 1.0368332e+00 8.6798817e-01
 8.6798817e-01 1.0368332e+00 8.6798817e-01 1.3027599e+00 1.0368332e+00
 1.0368332e+00 1.0368332e+00 1.0368332e+00 1.0368332e+00 1.0368332e+00
 1.1462002e+00 1.3216617e+00 4.0220227e+02 1.0368332e+00 1.0368332e+00
 1.2349240e+00 1.0368332e+00 1.3216617e+00 1.0368332e+00 1.0368332e+00
 1.1462002e+00 1.0368332e+00 1.0368332e+00 1.0368332e+00 1.1462002e+00
 1.0368330e+00 1.1462001e+00 1.0368328e+00 1.0368332e+00 1.0368332e+00
 1.0368332e+00 1.0368332e+00 7.1239209e-01 8.7195790e-01 1.9014068e+00
 6.6733450e-01 8.7195790e-01 1.2093948e+00 9.0322584e-01 1.0586154e+00
 8.7195790e-01 7.1239209e-01 1.1462002e+00 8.7195790e-01 6.6733450e-01
 1.1462002e+00 1.0586154e+00 9.0322584e-01 1.0586154e+00 1.0586154e+00
 8.7195790e-01 8.7195790e-01 1.0368332e+00 1.0368332e+00 1.0586154e+00
 8.7195790e-01 1.0586154e+00 1.0586154e+00 1.0586154e+00 8.7195790e-01
 1.3027599e+00 1.0368332e+00 7.1239209e-01 1.0586154e+00 2.4489572e+00
 1.0368332e+00 2.4489572e+00 1.0368332e+00 1.6753395e+00 1.0586154e+00
 1.0586153e+00 1.2542835e+00 1.0586154e+00 1.0586154e+00 1.1462002e+00
 9.0322584e-01 1.0586154e+00 1.0586154e+00 1.0324093e+00 1.0586154e+00
 8.7195790e-01 1.0586154e+00 1.0368332e+00 7.1239209e-01 8.7195790e-01
 1.3027599e+00 1.0586154e+00 8.7195790e-01 8.7195790e-01 8.7195790e-01
 8.7195790e-01 4.6523480e+00 6.6733450e-01 6.6733450e-01 2.4489572e+00
 6.4572382e-01 3.3595786e+00 7.7944475e-01 8.8755959e-01 7.9687709e-01
 5.8769178e-01 9.0322584e-01 1.0292038e+00 6.4572382e-01 8.6869842e-01
 1.0368332e+00 6.7529470e-01 8.2038812e+02 1.0292038e+00 1.0141684e+00
 9.4014078e-01 1.0141684e+00 2.4489572e+00 1.5534275e+00 4.0136996e+02
 4.0136996e+02 9.0322584e-01 6.7529470e-01 5.6928176e-01 8.0879855e-01
 5.8769637e-01 6.4572382e-01 1.5542926e+00 5.8887911e-01 1.0368332e+00
 9.4014078e-01 8.0879855e-01 8.6074376e-01 1.4914083e+00 7.9252863e-01
 1.0292038e+00 1.0586154e+00 9.1213930e-01 1.1462002e+00 9.1391987e-01
 1.4370265e+00 1.2093948e+00 1.9924963e+00 1.0711213e+00 1.0469661e+00
 1.0292038e+00 8.6869842e-01 8.7195790e-01 9.1415864e-01 1.2093948e+00
 2.4909473e+03 1.0469661e+00 9.1049665e-01 7.7944475e-01 7.1239209e-01
 7.7944475e-01 1.5542926e+00 1.0469661e+00 1.0586154e+00 7.7944487e-01
 2.0261974e+00 1.8291030e+00 1.1462002e+00 1.8291028e+00 6.2356323e-01
 7.9162341e-01 7.8204083e-01 2.4427650e+00 1.0141684e+00 7.9162341e-01
 7.7944475e-01 8.6074376e-01 1.1215054e+00 2.4764106e+00 2.4764106e+00
 1.5939471e+00 1.8291028e+00 2.4764106e+00 1.0292038e+00 9.1049665e-01
 1.8291028e+00 8.0879855e-01 1.0368332e+00 9.1049665e-01 9.0322584e-01
 8.7195790e-01 1.3568926e+00 1.0809616e+00 1.0292038e+00 8.6869842e-01
 7.8204083e-01 8.0879855e-01 1.4185221e+00 1.0292038e+00 7.7944475e-01
 8.6074376e-01 1.0469661e+00 6.6733450e-01 9.1049665e-01 5.0790091e+02
 8.7195790e-01 9.1049665e-01 8.6798799e-01 8.0879855e-01 7.9162341e-01
 7.9162341e-01 1.0292038e+00 9.1049665e-01 8.7195790e-01 9.1049665e-01
 6.7922461e-01 1.8708004e+00 2.4764106e+00 9.1049665e-01 2.8585286e+00
 1.4229785e+00 9.0322584e-01 2.3284397e+00 9.1391987e-01 1.0292038e+00
 1.8291028e+00 9.9705076e-01 1.2093948e+00 1.6628288e+00 1.8291028e+00
 1.3568926e+00 1.8291028e+00 1.8291028e+00 1.2451009e+00 8.0879855e-01
 2.4764106e+00 1.5542926e+00 5.8887911e-01 1.0586154e+00 8.8755959e-01
 3.3595786e+00 1.2093948e+00 1.1215054e+00 7.0314469e+00 1.4052156e+00
 8.0879855e-01 5.4777185e+02 1.0586154e+00 8.7195790e-01 1.2019529e+00
 9.0322572e-01 6.1886678e+00 1.5584160e+00 2.5111558e+03 8.6869842e-01
 1.4744365e+00 1.0368332e+00 1.0292038e+00 1.0368332e+00 1.0586154e+00
 1.8291028e+00 8.0879855e-01 4.1066403e+00 1.1215054e+00 4.0916510e+00
 1.6144614e+00 8.8755959e-01 8.0879855e-01 8.7195790e-01 4.6663775e+00
 1.2087027e+02 3.8031658e+03 2.0859931e+00 8.7195790e-01 1.2093948e+00
 9.3327099e-01 1.5845919e+00 1.3568926e+00 1.0292038e+00 1.0292038e+00
 8.7195790e-01 1.0809616e+00 1.8291028e+00 8.6798817e-01 1.0469661e+00
 2.6851928e+00 8.9828902e-01 2.1936414e+00 7.8204083e-01 9.1049665e-01
 1.6998056e+00 7.9162341e-01 1.5845919e+00 2.5422056e+00 8.6869854e-01
 8.0879861e-01 9.1049653e-01 1.4300362e+00 6.4572382e-01 9.1049665e-01
 8.7195790e-01 1.8291028e+00 1.8189390e+00 9.1049665e-01 5.8887911e-01
 1.0368332e+00 9.1049665e-01 1.2294316e+00 1.0292038e+00 1.0368332e+00
 6.4572382e-01 1.5483559e+00 3.3044631e+00 9.1049665e-01 7.9252863e-01
 8.6869842e-01 2.6851928e+00 8.0879855e-01 1.0292038e+00 8.7195790e-01
 1.8291028e+00 1.3568926e+00 8.0879855e-01 8.0879855e-01 8.6869842e-01
 9.1049665e-01 1.2093948e+00 8.6869842e-01 9.1049665e-01 8.7195790e-01
 4.9650031e+02 8.0879855e-01 1.5845919e+00 9.9705076e-01 8.6869854e-01
 1.8773851e+00 8.7195796e-01 8.7195796e-01 8.0879861e-01 9.1049665e-01
 6.6733450e-01 2.3284397e+00 1.0586154e+00 1.0368332e+00 8.0879855e-01
 1.0586154e+00 2.4764106e+00 4.1584449e+00 9.1049665e-01 8.0879855e-01
 9.4014078e-01 1.0292038e+00 9.4014078e-01 1.8291028e+00 2.3087468e+00
 6.4572382e-01 1.4229785e+00 2.0042059e+01 8.6869842e-01 7.9162341e-01
 8.6869842e-01 1.5483559e+00 8.6869842e-01 1.0292038e+00 1.0292038e+00
 8.0684203e-01 8.6869842e-01 9.9705076e-01 1.4229785e+00 1.0368332e+00
 8.0879855e-01 9.1740179e-01 9.0322584e-01 2.2380853e+00 8.0879855e-01
 8.0879855e-01 9.8628312e-01 8.0879855e-01 2.4764106e+00 1.5584160e+00
 8.6869854e-01 1.0586153e+00 9.9705076e-01 7.9162341e-01 2.3087468e+00
 8.7195790e-01 8.0879855e-01 2.4489572e+00 8.6869842e-01 7.9162341e-01
 1.3216617e+00 1.7654874e+00 1.0368332e+00 1.0141684e+00 1.5845919e+00
 8.6798817e-01 8.0879855e-01 8.6869842e-01 1.0980554e+00 1.0368332e+00
 8.6869842e-01 7.9252863e-01 1.0292038e+00 1.0368332e+00 8.6798817e-01
 2.5275154e+03 1.5939471e+00 8.7195790e-01 1.6753395e+00 1.0586154e+00
 6.6733450e-01 5.8769178e-01 9.4014078e-01 8.8755959e-01 9.4014090e-01
 8.7195790e-01 1.2451010e+00]
2025-06-06 15:07:34,088 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8]
2025-06-06 15:07:34,285 - ERROR - An error occurred while processing file nw_graph_encoded_1749044588.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:34,286 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:34,286 - INFO - 
--- Processing file: nw_graph_encoded_1749044648.dot ---
2025-06-06 15:07:34,286 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot
2025-06-06 15:07:34,286 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot file.
2025-06-06 15:07:34,304 - INFO - Parsed 512 nodes.
2025-06-06 15:07:34,323 - INFO - Parsed 1046 edges.
2025-06-06 15:07:34,551 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:34,552 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:34,556 - DEBUG - Initial node features tensor shape: torch.Size([512, 19])
2025-06-06 15:07:34,575 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:34,605 - DEBUG - Node features tensor shape after scaling: torch.Size([512, 19])
2025-06-06 15:07:34,606 - DEBUG - Edge index tensor shape: torch.Size([2, 1046])
2025-06-06 15:07:34,606 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:34,614 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:34,615 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:34,616 - DEBUG - Shape of encoded categorical edge features: torch.Size([1046, 2])
2025-06-06 15:07:34,617 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:34,618 - DEBUG - Shape of scaled numerical edge features: torch.Size([1046, 20])
2025-06-06 15:07:34,618 - DEBUG - Final edge attributes tensor shape: torch.Size([1046, 22])
2025-06-06 15:07:34,618 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:34,618 - INFO - Performing online update...
2025-06-06 15:07:34,618 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:34,619 - DEBUG - Updated RunningStats: new_mean=[ 4.13226074e-10 -4.70701107e-10 -2.63971287e-09  2.27459971e-09
 -2.52376516e-08  1.36634110e-08 -9.57244701e-09 -2.28021189e-09
 -2.93924439e-09  1.03684949e-09  1.49409963e-09 -1.52112718e-09
  3.70126791e-09 -3.38750272e-09  9.27729644e-10  7.39513785e-10
 -3.77729891e-09  1.16663165e-09 -4.69306121e-09], new_M2=[196481.00538769 196481.00534195 196481.00027389 196481.00431896
 196480.99847757 196480.99846419 196480.99594498 196480.99819042
 196480.99319232 196480.99848616 196481.00187898 196480.99386114
 196480.99278941 156689.99667834 156690.00008258 156689.99883388
 156690.00001918 196481.00019372 196481.00772368], new_n=196481
2025-06-06 15:07:34,620 - DEBUG - Updated RunningStats: new_mean=[ 1.41476150e+00  5.49145189e+00  1.07067622e-10  2.58300654e-10
  1.43062948e-10 -1.60004593e-10 -1.26622341e-09  1.84348962e-10
  3.00287971e-10 -2.19407585e-10  3.25145242e-10 -3.48719440e-09
 -8.58712154e-10  2.13834031e-10  2.91568970e-10 -1.51330667e-10
 -1.51330667e-10 -1.51330667e-10 -1.51330667e-10 -1.51330667e-10
 -1.51330667e-10 -8.10468687e-11], new_M2=[ 108817.09844233 1888639.87849685  422490.99898308  422491.00598267
  422491.00568928  422490.99330021  422491.00034238  422490.99908359
  422491.00165218  422490.99935844  422490.99389029  422491.00860059
  422491.00112097  422490.99988228  422491.00177401  422490.99458045
  422490.99458045  422490.99458045  422490.99458045  422490.99458045
  422490.99458045  422490.99903638], new_n=422491
2025-06-06 15:07:34,620 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89301829 0.8930183  0.8930183  0.8930183  1.
 1.00000002]
2025-06-06 15:07:34,620 - DEBUG - Calculated standard deviation: [0.50750443 2.11429629 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:34,620 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:34,620 - DEBUG - Online update step: 1/50
2025-06-06 15:07:34,620 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,620 - DEBUG - Online update step: 2/50
2025-06-06 15:07:34,620 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,620 - DEBUG - Online update step: 3/50
2025-06-06 15:07:34,620 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,620 - DEBUG - Online update step: 4/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 5/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 6/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 7/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 8/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 9/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 10/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 11/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 12/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 13/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 14/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 15/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 16/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 17/50
2025-06-06 15:07:34,621 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,621 - DEBUG - Online update step: 18/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 19/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 20/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 21/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 22/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 23/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 24/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 25/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 26/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 27/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 28/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 29/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 30/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,622 - DEBUG - Online update step: 31/50
2025-06-06 15:07:34,622 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 32/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 33/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 34/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 35/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 36/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 37/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 38/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 39/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 40/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 41/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 42/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 43/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 44/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,623 - DEBUG - Online update step: 45/50
2025-06-06 15:07:34,623 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - DEBUG - Online update step: 46/50
2025-06-06 15:07:34,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - DEBUG - Online update step: 47/50
2025-06-06 15:07:34,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - DEBUG - Online update step: 48/50
2025-06-06 15:07:34,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - DEBUG - Online update step: 49/50
2025-06-06 15:07:34,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - DEBUG - Online update step: 50/50
2025-06-06 15:07:34,624 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:34,624 - WARNING - No successful steps during online update.
2025-06-06 15:07:34,625 - DEBUG - Current node mean: [-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], current edge mean: [ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:07:34,625 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3039
2025-06-06 15:07:34,625 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:07:34,625 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:07:34,625 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:07:34,626 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:07:34,627 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:07:34,627 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:07:34,627 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:07:34,627 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:07:34,627 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:07:34,628 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:07:34,628 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:07:34,628 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:07:34,628 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:07:34,628 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:07:34,629 - INFO - Optimizer and scheduler reset.
2025-06-06 15:07:34,629 - DEBUG - Updated reference mean: node=[-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], edge=[ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:07:34,630 - DEBUG - Updated reference std: node=[1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978], edge=[0.50084144 1.9184657  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784 ]
2025-06-06 15:07:34,630 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:34,630 - INFO - Running anomaly detection...
2025-06-06 15:07:34,630 - INFO - Starting anomaly detection.
2025-06-06 15:07:35,824 - DEBUG - Node reconstruction errors: [1.2665499e+00 1.2665499e+00 1.2665499e+00 1.2665499e+00 1.2665499e+00
 1.2665499e+00 1.2545061e+00 9.3201107e-01 9.3201107e-01 9.3201107e-01
 9.4661021e-01 9.3201107e-01 9.3201107e-01 1.2665499e+00 1.2665499e+00
 9.3201107e-01 9.3201107e-01 9.3201107e-01 9.3201107e-01 9.3201107e-01
 9.3201107e-01 9.3201107e-01 9.3201107e-01 9.3201107e-01 9.3201107e-01
 1.0421880e+00 9.3201107e-01 9.4661021e-01 9.3201107e-01 9.3201107e-01
 9.3201107e-01 9.3201107e-01 9.3201107e-01 9.4661021e-01 9.3201107e-01
 9.3201107e-01 1.0421880e+00 9.3201107e-01 9.4661021e-01 9.3201107e-01
 9.4661021e-01 9.4661021e-01 1.4185874e+00 1.4185874e+00 9.4661021e-01
 9.4661021e-01 9.4661021e-01 1.0803919e+00 9.3201107e-01 1.0803919e+00
 9.3201107e-01 1.1216936e+00 9.3201107e-01 7.4312812e-01 9.3201107e-01
 7.8178692e-01 1.1216936e+00 9.3201107e-01 1.2971296e+00 9.3201107e-01
 9.3201107e-01 7.8178692e-01 9.3201107e-01 7.8178692e-01 7.4312812e-01
 1.2971296e+00 1.4185874e+00 1.1216936e+00 1.1216936e+00 1.2665499e+00
 1.1216936e+00 1.1216936e+00 1.0421880e+00 1.1216936e+00 9.9190921e-01
 1.9025013e+00 1.1216936e+00 1.1216936e+00 8.8094879e+01 7.4312812e-01
 7.4312812e-01 9.3201107e-01 7.7316535e-01 7.9946840e-01 1.1216936e+00
 1.1216936e+00 7.4312812e-01 1.9025013e+00 7.4312812e-01 1.2665499e+00
 1.1216936e+00 9.4661021e-01 7.4312812e-01 1.2665499e+00 1.0645680e+00
 1.2545061e+00 1.2665499e+00 7.6272535e-01 1.0645680e+00 7.4312812e-01
 7.4312812e-01 7.4312812e-01 9.4661027e-01 7.4312812e-01 7.4312812e-01
 5.8474869e-01 9.4661021e-01 5.8474869e-01 1.6444786e+00 1.0488309e+00
 7.0356345e-01 9.4661021e-01 6.3954514e-01 1.0488309e+00 5.8396637e-01
 6.3572294e-01 1.0645680e+00 6.3954514e-01 1.5992575e+00 1.2665499e+00
 1.0645680e+00 9.5781404e-01 6.2341732e-01 9.5781404e-01 9.5781404e-01
 7.0356345e-01 9.3201107e-01 7.0356345e-01 7.4312812e-01 7.4312812e-01
 9.5781404e-01 7.0356345e-01 9.5781404e-01 9.5781404e-01 9.5781404e-01
 7.0356345e-01 1.4185874e+00 7.4312812e-01 6.3572294e-01 9.5781404e-01
 6.9496888e-01 7.6272535e-01 6.9496888e-01 9.3201107e-01 7.4898726e-01
 8.0587274e-01 9.5781404e-01 9.5781404e-01 9.3201107e-01 1.4969918e+00
 9.5781404e-01 9.5781404e-01 1.0645680e+00 6.2341732e-01 9.5781404e-01
 9.5781404e-01 1.0784321e+00 9.5781404e-01 7.0356345e-01 9.5781404e-01
 7.6272535e-01 6.3572294e-01 5.8474869e-01 9.3201107e-01 1.0488309e+00
 7.0356345e-01 9.3201107e-01 9.4661021e-01 7.0356345e-01 7.0356345e-01
 7.0356345e-01 4.5079937e+00 9.3201107e-01 7.5866199e-01 7.5866199e-01
 1.1221510e+00 1.0421880e+00 5.1062459e-01 2.9203389e+00 4.9085492e-01
 9.5229530e-01 4.8641992e-01 6.3824439e-01 6.2341732e-01 9.3351847e-01
 5.1062459e-01 5.6464404e-01 7.4312812e-01 4.6430090e-01 5.6330194e+02
 1.0325682e+00 9.6954614e-01 9.9869776e-01 9.6954614e-01 6.9496888e-01
 1.5553299e+00 9.1359230e+01 9.1359230e+01 6.2341732e-01 4.6430090e-01
 7.5403309e-01 7.8290749e-01 5.6026524e-01 5.1062459e-01 9.3201107e-01
 1.8069930e+00 1.0325682e+00 1.1216936e+00 1.5992575e+00 5.5673867e-01
 1.0198302e+00 2.3302016e+00 6.3405287e-01 1.8109627e+00 1.0488309e+00
 4.8261270e-01 1.0645680e+00 1.2207104e+00 1.1619108e+00 9.4661021e-01
 1.6948043e+00 9.0918911e-01 5.4564250e-01 1.0325682e+00 9.3201107e-01
 9.4661021e-01 5.6464404e-01 7.0356345e-01 1.0190333e+00 9.4661021e-01
 1.4759060e+03 1.3820058e+00 9.3729192e-01 4.8369005e-01 5.8474869e-01
 4.9085492e-01 1.5868676e+00 1.3820058e+00 9.5781404e-01 4.9085492e-01
 9.3201107e-01 1.4441067e+00 2.3277712e+00 1.0645680e+00 2.3277712e+00
 1.0270306e+00 5.5673867e-01 7.8382057e-01 8.5434872e-01 1.2665499e+00
 9.6954614e-01 6.3593942e-01 4.9085492e-01 1.0198302e+00 7.9401684e-01
 2.9751577e+00 2.9751577e+00 1.2665499e+00 1.6483220e+00 1.0803919e+00
 2.3277712e+00 2.9751577e+00 1.0325682e+00 1.0325682e+00 2.3277712e+00
 5.5673867e-01 1.2665499e+00 9.3201107e-01 7.4898726e-01 9.3729192e-01
 6.2341732e-01 7.0356345e-01 1.8037722e+00 7.4915648e-01 1.0283322e+00
 5.6464404e-01 5.1024169e-01 5.5673867e-01 1.6150692e+00 9.3351847e-01
 4.9085492e-01 1.0198302e+00 1.3820058e+00 7.5866199e-01 9.3729192e-01
 7.0496899e+02 7.0356345e-01 1.5753937e+00 1.1216936e+00 7.8290749e-01
 6.3593942e-01 6.3593942e-01 9.3351847e-01 9.3729192e-01 7.0356345e-01
 1.0325682e+00 5.9374303e-01 1.7647368e+00 2.9751577e+00 1.0325682e+00
 2.1966736e+00 1.5753937e+00 6.2341732e-01 1.1567768e+00 1.2207104e+00
 9.3351847e-01 1.0421880e+00 2.3277712e+00 5.5673867e-01 9.4661021e-01
 1.0355597e+00 2.3277712e+00 1.8037722e+00 2.3277712e+00 2.3277712e+00
 9.3201107e-01 1.0488309e+00 7.8290749e-01 2.9751577e+00 1.4319042e+00
 4.8641992e-01 9.4661021e-01 9.5781404e-01 1.2665499e+00 1.0653625e+00
 2.9203389e+00 9.4661021e-01 7.9401684e-01 4.2235508e+00 1.2999845e+00
 7.8290749e-01 8.6923779e+02 1.5992575e+00 7.0356345e-01 7.9439831e-01
 6.2341732e-01 2.0157249e+00 1.5753937e+00 9.3201107e-01 1.2571006e+03
 5.6464404e-01 1.9320229e+00 7.4312812e-01 9.3351847e-01 7.4312812e-01
 1.0488309e+00 2.3277712e+00 5.5673867e-01 9.2285099e+00 7.9401684e-01
 2.9730802e+00 1.2228861e+00 9.5229530e-01 7.8290749e-01 7.0356345e-01
 1.0167588e+01 2.8198143e+01 2.2526599e+03 1.3598877e+00 7.0356345e-01
 9.4661021e-01 7.7548265e-01 1.5811305e+00 1.8037722e+00 1.0283322e+00
 1.0325682e+00 7.0356345e-01 7.4915648e-01 2.3277712e+00 1.2971296e+00
 1.3820058e+00 8.1924385e-01 5.6632251e-01 1.2665499e+00 1.7587633e+00
 7.8382057e-01 1.0325682e+00 1.6558160e+00 6.3593942e-01 1.2665499e+00
 1.2999845e+00 7.3581779e-01 5.6464404e-01 7.8290749e-01 9.3729192e-01
 1.0283322e+00 5.1062459e-01 9.3729192e-01 7.0356345e-01 2.3277712e+00
 1.2999845e+00 9.3729192e-01 8.4985501e-01 7.4312812e-01 9.3729192e-01
 1.0499010e+00 9.3351847e-01 7.4312812e-01 5.1062459e-01 8.7363034e-01
 9.3201107e-01 6.4931698e+00 1.0325682e+00 5.7013166e-01 5.6464404e-01
 8.1924385e-01 7.8290749e-01 9.3351847e-01 7.0356345e-01 2.3277712e+00
 1.8037722e+00 5.5673867e-01 1.2665499e+00 9.3201107e-01 5.5673867e-01
 5.6464404e-01 9.3729192e-01 9.4661021e-01 6.1567569e-01 4.4294810e+00
 7.0356345e-01 8.1626868e+02 5.5673867e-01 1.2399002e+00 5.5673867e-01
 4.8641992e-01 9.1406280e-01 7.0356345e-01 7.0356345e-01 7.8290749e-01
 1.0325682e+00 1.2665499e+00 1.0488309e+00 1.1567768e+00 9.5781404e-01
 7.4312812e-01 7.8290749e-01 9.5781404e-01 2.9751577e+00 8.7048473e+00
 1.0325682e+00 5.5673867e-01 9.9869776e-01 9.3351847e-01 1.0488309e+00
 2.3277712e+00 6.9614011e-01 9.3201107e-01 5.1062459e-01 1.5753937e+00
 1.2517980e+01 5.6464404e-01 5.5673867e-01 5.6464404e-01 7.6509136e-01
 5.6464404e-01 9.3351847e-01 9.3351847e-01 9.4661021e-01 4.8746645e-01
 5.6464404e-01 9.3201107e-01 5.5673867e-01 1.5753937e+00 7.4312812e-01
 4.8641992e-01 5.7800263e-01 6.2341732e-01 1.7514542e+00 5.5673867e-01
 4.8641992e-01 5.7013166e-01 5.5673867e-01 2.9751577e+00 1.5753937e+00
 5.3859192e-01 9.5781404e-01 6.1567569e-01 6.3593942e-01 2.0246463e+00
 7.0356345e-01 6.1567569e-01 6.9496888e-01 5.6464404e-01 6.3593942e-01
 1.1216936e+00 1.3561023e+00 1.1216936e+00 9.6954614e-01 1.4232924e+00
 7.8178692e-01 6.1567569e-01 6.1567569e-01 1.0609906e+00 7.4312812e-01
 5.5673867e-01 6.3405287e-01 1.5753937e+00 1.1216936e+00 1.1216936e+00
 1.4812794e+03 1.4297240e+00 7.0356345e-01 8.0587274e-01 9.5781404e-01
 7.5866199e-01 6.3824439e-01 9.9869776e-01 9.5229530e-01 9.9869776e-01
 6.3954496e-01 1.0488309e+00]
2025-06-06 15:07:35,825 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:07:36,006 - ERROR - An error occurred while processing file nw_graph_encoded_1749044648.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:36,007 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:36,007 - INFO - 
--- Processing file: nw_graph_encoded_1749044708.dot ---
2025-06-06 15:07:36,007 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot
2025-06-06 15:07:36,007 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot file.
2025-06-06 15:07:36,017 - INFO - Parsed 640 nodes.
2025-06-06 15:07:36,034 - INFO - Parsed 1302 edges.
2025-06-06 15:07:36,356 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:36,356 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:36,361 - DEBUG - Initial node features tensor shape: torch.Size([640, 19])
2025-06-06 15:07:36,367 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:36,372 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 19])
2025-06-06 15:07:36,373 - DEBUG - Edge index tensor shape: torch.Size([2, 1302])
2025-06-06 15:07:36,373 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:36,382 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:36,383 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:36,384 - DEBUG - Shape of encoded categorical edge features: torch.Size([1302, 2])
2025-06-06 15:07:36,386 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:36,386 - DEBUG - Shape of scaled numerical edge features: torch.Size([1302, 20])
2025-06-06 15:07:36,386 - DEBUG - Final edge attributes tensor shape: torch.Size([1302, 22])
2025-06-06 15:07:36,386 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:36,386 - INFO - Performing online update...
2025-06-06 15:07:36,386 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:36,387 - DEBUG - Updated RunningStats: new_mean=[ 4.10523746e-10 -4.67812172e-10 -2.64807547e-09  2.28751167e-09
 -2.52491457e-08  1.36785419e-08 -9.55482352e-09 -2.26445551e-09
 -2.91488502e-09  1.03159327e-09  1.45069575e-09 -1.49351029e-09
  3.66082753e-09 -3.37983053e-09  1.00303292e-09  7.10654884e-10
 -3.72209763e-09  1.14053778e-09 -4.65711132e-09], new_M2=[197121.00532543 197121.00527969 197121.00026595 197121.0043394
 197120.99841728 197120.99844231 197120.99594604 197120.99822146
 197120.99314437 197120.99843688 197121.001854   197120.99391997
 197120.99277046 157329.9966922  157330.00006897 157329.99884783
 157330.00002901 197121.00021583 197121.00772109], new_n=197121
2025-06-06 15:07:36,388 - DEBUG - Updated RunningStats: new_mean=[ 1.41474257e+00  5.48977213e+00  1.10665499e-10  2.53611743e-10
  1.44214613e-10 -1.57551121e-10 -1.26074714e-09  1.83991366e-10
  2.87241315e-10 -2.17162233e-10  3.22425601e-10 -3.45061056e-09
 -8.59565940e-10  1.81549386e-10  2.85524521e-10 -1.49121955e-10
 -1.49121955e-10 -1.49121955e-10 -1.49121955e-10 -1.49121955e-10
 -1.49121955e-10 -8.48246438e-11], new_M2=[ 109143.7713412  1893381.91729456  423792.99903355  423793.00589262
  423793.00576988  423792.99336598  423793.0003623   423792.99906888
  423793.00166526  423792.99935291  423792.9938514   423793.00854348
  423793.0011177   423792.99991143  423793.00179166  423792.99461394
  423792.99461394  423792.99461394  423792.99461394  423792.99461394
  423792.99461394  423792.99897621], new_n=423793
2025-06-06 15:07:36,388 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89338637 0.89338637 0.89338637 0.89338637 1.
 1.00000002]
2025-06-06 15:07:36,388 - DEBUG - Calculated standard deviation: [0.50748427 2.11369453 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:36,388 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:36,388 - DEBUG - Online update step: 1/50
2025-06-06 15:07:36,388 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,388 - DEBUG - Online update step: 2/50
2025-06-06 15:07:36,388 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,388 - DEBUG - Online update step: 3/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 4/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 5/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 6/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 7/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 8/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 9/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 10/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 11/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 12/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 13/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 14/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 15/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 16/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,389 - DEBUG - Online update step: 17/50
2025-06-06 15:07:36,389 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 18/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 19/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 20/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 21/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 22/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 23/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 24/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 25/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 26/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 27/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 28/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 29/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 30/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 31/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,390 - DEBUG - Online update step: 32/50
2025-06-06 15:07:36,390 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 33/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 34/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 35/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 36/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 37/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 38/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 39/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 40/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 41/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 42/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 43/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 44/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 45/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 46/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,391 - DEBUG - Online update step: 47/50
2025-06-06 15:07:36,391 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,392 - DEBUG - Online update step: 48/50
2025-06-06 15:07:36,392 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,392 - DEBUG - Online update step: 49/50
2025-06-06 15:07:36,392 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,392 - DEBUG - Online update step: 50/50
2025-06-06 15:07:36,392 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:36,392 - WARNING - No successful steps during online update.
2025-06-06 15:07:36,393 - DEBUG - Current node mean: [-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], current edge mean: [ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:07:36,393 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2579
2025-06-06 15:07:36,393 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:07:36,393 - DEBUG - Updated reference mean: node=[-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], edge=[ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:07:36,393 - DEBUG - Updated reference std: node=[1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007823 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821], edge=[0.5010547 1.8293908 1.0003842 1.0003842 1.0003843 1.0003843 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842]
2025-06-06 15:07:36,394 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:36,394 - INFO - Running anomaly detection...
2025-06-06 15:07:36,394 - INFO - Starting anomaly detection.
2025-06-06 15:07:36,724 - DEBUG - Node reconstruction errors: [1.1801414e+00 4.1849046e+00 1.1801414e+00 1.1801414e+00 1.1801414e+00
 1.1801414e+00 1.1801414e+00 1.1801414e+00 1.1801414e+00 1.1801414e+00
 9.8308682e-01 8.7177455e-01 9.8308682e-01 8.7177455e-01 8.7177455e-01
 8.7177455e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01
 8.7177455e-01 8.7177455e-01 9.8308682e-01 8.7177455e-01 8.7177455e-01
 8.7177455e-01 8.7177455e-01 7.0646626e-01 8.7177455e-01 7.8311336e-01
 1.0014868e+00 7.0867014e-01 9.5606244e-01 7.8311336e-01 7.0867014e-01
 8.7177455e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01
 8.7177455e-01 8.7177455e-01 1.1801414e+00 8.7177455e-01 8.7177455e-01
 9.8308682e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01 9.8308682e-01
 9.8308682e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01 9.8308682e-01
 8.7177455e-01 9.8308682e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01
 9.5606244e-01 9.5606244e-01 9.8308682e-01 9.8308682e-01 9.8192698e-01
 1.0337799e+00 1.0565962e+00 7.0002723e-01 8.7177455e-01 1.3992654e+00
 9.5606244e-01 8.1278265e-01 1.8979561e+03 1.0089813e+00 1.6473991e+00
 7.0314485e-01 4.6976736e-01 6.3200885e-01 1.1320615e+00 4.6976736e-01
 1.3368022e+00 6.6267586e-01 5.5295837e-01 5.3497875e-01 6.6267586e-01
 4.6976736e-01 9.5889133e-01 4.5157933e-01 3.0563064e+00 4.7713748e-01
 1.1801414e+00 5.3650397e-01 5.3497875e-01 5.9507692e-01 4.6195140e-01
 1.4921534e+00 1.1746433e+00 5.5295837e-01 5.4694134e-01 7.6374382e-01
 9.7192174e-01 8.7177455e-01 5.5295837e-01 4.6976736e-01 5.5295837e-01
 1.4619502e+01 1.4921534e+00 5.3718138e-01 6.8966883e-01 2.4361670e+00
 1.1593915e+00 9.8192698e-01 1.6473991e+00 4.7713748e-01 1.0008110e+01
 3.0563064e+00 9.5889133e-01 1.3986416e+00 9.8192698e-01 8.7177455e-01
 1.8654701e+00 6.7898405e-01 5.1285666e-01 8.8481361e-01 4.5157933e-01
 1.6815429e+00 9.8681281e+02 6.7898428e-01 1.4461658e+00 4.6976736e-01
 7.8536177e-01 1.8994519e+00 1.0073556e+00 8.7177455e-01 4.7713748e-01
 9.8308682e-01 4.7713748e-01 1.9257675e+00 2.4361670e+00 1.1256126e+00
 9.7192174e-01 9.5889133e-01 7.8914011e-01 8.7177455e-01 4.7754917e-01
 1.0114434e+00 7.8519654e+00 7.8246909e-01 1.1746433e+00 9.8308682e-01
 8.4857059e-01 5.3718138e-01 6.3200885e-01 9.7192174e-01 8.7177455e-01
 1.0073556e+00 6.8580282e-01 9.1796416e-01 1.0073556e+00 5.3497875e-01
 1.0073556e+00 5.3718138e-01 1.3352070e+00 8.4857059e-01 5.5295837e-01
 1.3352070e+00 9.8308682e-01 6.6267586e-01 1.7456452e+00 9.8308682e-01
 1.0114434e+00 8.8874817e-01 8.7177455e-01 7.8914011e-01 9.7192174e-01
 1.5048368e+00 8.2074523e-01 1.1801414e+00 1.1137244e+00 1.3352070e+00
 5.5295837e-01 1.9257675e+00 6.4535975e-01 1.4368086e+00 2.8638782e+03
 1.1932117e+01 6.1749494e-01 8.4857059e-01 1.2738403e+00 8.9155346e-01
 8.7177455e-01 1.0547817e+01 8.7177455e-01 4.7713748e-01 2.4361670e+00
 1.4795380e+00 6.3200885e-01 6.3200885e-01 2.0703726e+00 4.6976736e-01
 1.6043009e+03 6.8966883e-01 1.4921534e+00 5.5895132e-01 8.2074523e-01
 6.7898405e-01 1.0835387e+03 8.4857059e-01 1.2707382e+00 5.4501958e+00
 7.9237163e-01 7.8536177e-01 3.1069176e+00 7.4795955e-01 1.0669883e+00
 8.7177455e-01 2.2269490e+00 9.5889133e-01 4.6195140e-01 1.4448379e+00
 8.4857059e-01 9.5606244e-01 9.8192698e-01 6.8966883e-01 2.4361670e+00
 2.4361670e+00 1.9257675e+00 2.4361670e+00 7.8536177e-01 4.7713748e-01
 1.0278813e+00 2.4361670e+00 8.1059408e-01 1.3634884e+00 1.3986416e+00
 5.5895132e-01 2.4361670e+00 1.4921534e+00 2.4270394e+00 2.0241623e+00
 4.9175173e-01 1.1137244e+00 1.6473991e+00 9.7192174e-01 6.6267586e-01
 8.4857059e-01 1.0089813e+00 1.3352070e+00 6.7898405e-01 5.3497875e-01
 8.2451981e-01 3.2295578e+00 9.0229285e+02 7.8246909e-01 1.5048368e+00
 1.1351289e+00 5.1722360e-01 3.0563064e+00 9.7192174e-01 1.8071184e+00
 4.7713748e-01 4.8030114e-01 1.0840830e+00 5.5295837e-01 8.1299973e-01
 6.7898405e-01 1.0073556e+00 1.0114434e+00 6.3834631e-01 6.8966883e-01
 8.7177455e-01 4.7713748e-01 2.4361670e+00 1.6473991e+00 8.7177455e-01
 3.0563064e+00 8.7177455e-01 2.4361670e+00 9.3878984e-01 1.5343033e+00
 1.4461658e+00 3.0563064e+00 3.0563064e+00 8.5146242e-01 8.7177455e-01
 1.1351287e+00 5.7348633e-01 6.6267586e-01 4.7713748e-01 1.0863104e+00
 8.7177455e-01 1.0430080e+00 5.5295837e-01 4.6976736e-01 5.9516519e-01
 2.4361670e+00 4.6976736e-01 1.0096980e+00 2.4361670e+00 1.3032862e+00
 5.5295837e-01 1.5175492e+00 1.0907850e+00 4.6976736e-01 8.1059408e-01
 5.7348633e-01 6.7898405e-01 9.5889133e-01 1.5048368e+00 1.6685513e+00
 5.7348633e-01 5.4665405e-01 8.7177455e-01 5.1345313e-01 1.8654701e+00
 1.5048368e+00 7.8536177e-01 1.1359799e+00 4.5157933e-01 1.1746433e+00
 8.7177455e-01 1.1746433e+00 1.0114434e+00 5.5459940e-01 1.0014868e+00
 8.7177455e-01 8.7177455e-01 1.0542625e+00 1.6112182e+00 7.8536177e-01
 9.8308682e-01 1.0337799e+00 1.2349625e+00 1.1256126e+00 4.6854541e-01
 9.8192698e-01 1.3352070e+00 4.5186490e-01 2.4376645e+00 1.1351287e+00
 4.7713748e-01 1.0089813e+00 8.7177455e-01 1.1137244e+00 1.6685513e+00
 6.8966883e-01 8.4857059e-01 8.6677271e-01 8.3664972e-01 5.2796096e-01
 5.5895132e-01 1.1301064e+02 9.5606244e-01 1.1301064e+02 1.5005238e+00
 7.4795955e-01 4.6976736e-01 1.0278813e+00 1.0337799e+00 1.0278813e+00
 7.2998590e+02 5.2796096e-01 6.3200885e-01 4.5157933e-01 8.7177455e-01
 1.0073556e+00 7.8536177e-01 9.7192174e-01 8.7177455e-01 5.5895132e-01
 4.6195140e-01 1.0565962e+00 5.7348633e-01 3.1069176e+00 9.8308682e-01
 9.8308682e-01 9.5606244e-01 6.8966883e-01 4.5157933e-01 1.3483673e+00
 1.0058546e+00 7.8246909e-01 4.9892962e-01 6.8966866e-01 4.8055978e+00
 1.8630592e+00 6.7898405e-01 6.7898405e-01 6.7898405e-01 7.8536177e-01
 7.1782231e-01 1.0565962e+00 5.5895132e-01 6.7898405e-01 6.6267586e-01
 9.8192698e-01 7.4863553e-01 6.7898405e-01 6.8966883e-01 5.2091181e-01
 6.2108815e-01 1.0907850e+00 1.4852535e+00 9.5889133e-01 1.6189533e+00
 1.0114434e+00 9.5889133e-01 9.5889133e-01 5.3497875e-01 1.0096980e+00
 1.6392596e+00 1.2572540e+00 1.6392596e+00 6.7898405e-01 9.5889133e-01
 3.5002247e+01 8.7177455e-01 4.7713748e-01 9.5889133e-01 8.1278265e-01
 6.3834631e-01 6.0226029e-01 9.1350603e-01 9.5889133e-01 4.9892959e-01
 6.3200885e-01 1.1746433e+00 9.5889133e-01 9.5889133e-01 1.0907850e+00
 6.7898405e-01 6.4830810e-01 9.5889133e-01 1.0089813e+00 6.3200885e-01
 6.0226029e-01 2.3231020e+00 1.2170712e+00 5.3497875e-01 8.7177455e-01
 5.9152514e-01 9.5889133e-01 6.7898405e-01 5.8838701e-01 9.5889133e-01
 3.0563064e+00 5.5895132e-01 9.5889133e-01 1.0096980e+00 8.7177455e-01
 1.4818056e+00 1.1746433e+00 6.8966883e-01 5.9487695e-01 4.7713748e-01
 9.7192174e-01 1.0096980e+00 6.2108815e-01 4.9973312e-01 9.8192698e-01
 1.2707382e+00 5.3497875e-01 7.8536177e-01 6.7898405e-01 1.4461658e+00
 1.9257675e+00 1.4995652e+00 5.2091181e-01 1.0073556e+00 7.8536177e-01
 4.9892959e-01 6.3200885e-01 9.8308682e-01 6.3200885e-01 7.6374382e-01
 4.5157933e-01 6.3200885e-01 6.3200885e-01 6.3200885e-01 8.7177455e-01
 5.8077556e-01 1.0096980e+00 1.0089813e+00 5.7696623e-01 8.7177455e-01
 1.3634884e+00 5.3497875e-01 5.3497875e-01 9.5606244e-01 1.0096980e+00
 8.7177455e-01 8.7177455e-01 6.3200885e-01 9.8308682e-01 1.6986289e+00
 1.0089813e+00 8.7177455e-01 1.4109124e+00 6.3200885e-01 1.0089813e+00
 1.1137482e+00 6.1313772e-01 9.8192698e-01 6.9342917e-01 6.8966883e-01
 6.3200885e-01 6.3200885e-01 1.2572540e+00 1.0791067e+02 1.0089813e+00
 9.8308706e-01 1.0089813e+00 7.8536177e-01 1.8842236e+00 4.9892959e-01
 1.6515937e+00 7.1782231e-01 8.4857059e-01 1.1137482e+00 1.6515937e+00
 1.0089813e+00 9.5606244e-01 9.8308682e-01 5.3497875e-01 1.2931675e+00
 1.1746433e+00 1.5560864e+00 6.3200885e-01 6.3200885e-01 7.2345686e-01
 7.2345686e-01 6.7898405e-01 1.1746433e+00 1.9347931e+00 1.1746433e+00
 1.1137482e+00 1.1746433e+00 1.3553498e+00 1.6515937e+00 7.2345686e-01
 1.3483673e+00 1.3483673e+00 6.3200885e-01 8.7177455e-01 8.7177455e-01
 1.1746433e+00 8.7177455e-01 1.0089813e+00 1.4921534e+00 6.8966883e-01
 9.3878984e-01 8.7177455e-01 8.7177455e-01 6.8966883e-01 9.3878984e-01
 7.8536177e-01 7.8536177e-01 1.6605591e+00 7.8536177e-01 1.1746433e+00
 1.0337799e+00 1.1746433e+00 6.3200885e-01 7.8536177e-01 1.9347931e+00
 1.6515937e+00 7.1782231e-01 1.6986289e+00 9.7192174e-01 6.8966883e-01
 1.3483673e+00 1.3483673e+00 6.8966883e-01 7.8536177e-01 8.1059408e-01
 1.1746433e+00 6.8966883e-01 6.8966883e-01 6.8580282e-01 1.1746433e+00
 7.8536177e-01 7.2345686e-01 6.8966883e-01 7.1782231e-01 1.1741298e+00
 6.8966883e-01 8.7177455e-01 8.7177455e-01 6.8966883e-01 7.6374382e-01
 7.1782231e-01 6.8966883e-01 1.1746433e+00 1.0314642e+00 1.1746433e+00
 2.4361670e+00 6.8966883e-01 7.1782231e-01 8.1059408e-01 8.7177455e-01
 6.8966883e-01 8.7177455e-01 8.7177455e-01 8.4857059e-01 8.7177455e-01
 6.5720451e-01 6.8966883e-01 6.8966883e-01 7.8536177e-01 4.5157933e-01
 1.1746433e+00 6.8966883e-01 1.3352070e+00 7.1782231e-01 9.5606244e-01
 9.5606244e-01 7.4795955e-01 8.7177455e-01 8.7177455e-01 8.7177455e-01
 8.7177455e-01 9.5606244e-01 8.7177455e-01 1.4461658e+00 8.7177455e-01
 9.5606244e-01 1.3032862e+00 4.6994109e+00 8.7177455e-01 9.5606244e-01
 8.7177455e-01 9.5606244e-01 1.0014868e+00 1.3553498e+00 8.7177455e-01
 9.8308682e-01 1.8892401e+03 9.8308682e-01 8.8874805e-01 9.8308706e-01]
2025-06-06 15:07:36,725 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:07:36,726 - ERROR - An error occurred while processing file nw_graph_encoded_1749044708.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:36,727 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:36,727 - INFO - 
--- Processing file: nw_graph_encoded_1749044768.dot ---
2025-06-06 15:07:36,727 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot
2025-06-06 15:07:36,727 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot file.
2025-06-06 15:07:36,738 - INFO - Parsed 693 nodes.
2025-06-06 15:07:36,753 - INFO - Parsed 1448 edges.
2025-06-06 15:07:37,144 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:37,145 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:37,150 - DEBUG - Initial node features tensor shape: torch.Size([693, 19])
2025-06-06 15:07:37,156 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:37,162 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 19])
2025-06-06 15:07:37,163 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-06 15:07:37,163 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:37,172 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:37,173 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:37,175 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-06 15:07:37,176 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:37,177 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-06 15:07:37,177 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-06 15:07:37,177 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:37,177 - INFO - Performing online update...
2025-06-06 15:07:37,177 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:37,178 - DEBUG - Updated RunningStats: new_mean=[ 3.94773023e-10 -4.51860751e-10 -2.75043630e-09  2.26533597e-09
 -2.51326682e-08  1.36672697e-08 -9.53777195e-09 -2.27656002e-09
 -2.90284660e-09  1.02300757e-09  1.50730812e-09 -1.48195044e-09
  3.65335096e-09 -3.37605022e-09  9.52890253e-10  6.89182307e-10
 -3.76028187e-09  1.13779920e-09 -4.62964739e-09], new_M2=[197814.00531149 197814.00526575 197814.00030005 197814.00432769
 197813.99839443 197813.99844888 197813.99592809 197813.99820356
 197813.99319283 197813.99844318 197814.00184998 197813.99391541
 197813.99277143 158022.996703   158023.00006966 158022.99886628
 158023.00000908 197814.0002197  197814.00769222], new_n=197814
2025-06-06 15:07:37,178 - DEBUG - Updated RunningStats: new_mean=[ 1.41475775e+00  5.48802444e+00  1.12096738e-10  2.53665133e-10
  1.44714361e-10 -1.58158696e-10 -1.24417469e-09  1.85961770e-10
  2.99021680e-10 -2.06821620e-10  3.15000418e-10 -3.46048397e-09
 -8.60302370e-10  1.68578994e-10  2.88630250e-10 -1.49261283e-10
 -1.49261283e-10 -1.49261283e-10 -1.49261283e-10 -1.49261283e-10
 -1.49261283e-10 -8.50069514e-11], new_M2=[ 109514.34626953 1898361.26445008  425240.99905464  425241.0059393
  425241.0057994   425240.99333492  425241.00036056  425240.99910922
  425241.00166317  425240.99933534  425240.99386721  425241.00860678
  425241.00110754  425240.99991649  425241.0018182   425240.9945664
  425240.9945664   425240.9945664   425240.9945664   425240.9945664
  425240.9945664   425240.99895599], new_n=425241
2025-06-06 15:07:37,179 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89378206 0.89378207 0.89378207 0.89378207 1.
 1.00000002]
2025-06-06 15:07:37,179 - DEBUG - Calculated standard deviation: [0.50747884 2.11286557 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:37,179 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:37,179 - DEBUG - Online update step: 1/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 2/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 3/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 4/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 5/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 6/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 7/50
2025-06-06 15:07:37,179 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,179 - DEBUG - Online update step: 8/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 9/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 10/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 11/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 12/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 13/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 14/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 15/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 16/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 17/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 18/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 19/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 20/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 21/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 22/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,180 - DEBUG - Online update step: 23/50
2025-06-06 15:07:37,180 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 24/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 25/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 26/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 27/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 28/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 29/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 30/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 31/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 32/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 33/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 34/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 35/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 36/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 37/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 38/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,181 - DEBUG - Online update step: 39/50
2025-06-06 15:07:37,181 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 40/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 41/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 42/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 43/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 44/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 45/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 46/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 47/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 48/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 49/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - DEBUG - Online update step: 50/50
2025-06-06 15:07:37,182 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:37,182 - WARNING - No successful steps during online update.
2025-06-06 15:07:37,183 - DEBUG - Current node mean: [-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], current edge mean: [ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:07:37,183 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2421
2025-06-06 15:07:37,183 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:07:37,184 - DEBUG - Updated reference mean: node=[-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], edge=[ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:07:37,184 - DEBUG - Updated reference std: node=[1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223], edge=[0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455]
2025-06-06 15:07:37,184 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:37,184 - INFO - Running anomaly detection...
2025-06-06 15:07:37,184 - INFO - Starting anomaly detection.
2025-06-06 15:07:38,263 - DEBUG - Node reconstruction errors: [1.36192429e+00 1.36192429e+00 1.36192429e+00 1.36192429e+00
 1.36192429e+00 1.36192429e+00 1.36192429e+00 1.03589213e+00
 1.03589213e+00 1.03589213e+00 1.03589213e+00 1.03589213e+00
 1.03589213e+00 1.11034393e+00 1.11034393e+00 1.40673220e+00
 1.11034393e+00 1.11034393e+00 1.03589213e+00 1.03589213e+00
 1.03589213e+00 1.03589213e+00 1.03589213e+00 1.11034393e+00
 1.03589213e+00 1.03589213e+00 1.11034393e+00 1.03589213e+00
 1.11034393e+00 1.11034393e+00 8.44704390e-01 1.03589213e+00
 1.03589213e+00 4.11909866e+00 1.03589213e+00 1.03589213e+00
 1.03589213e+00 1.03589213e+00 1.03589213e+00 1.03589213e+00
 1.03589213e+00 1.42085361e+00 8.65590334e-01 7.92948008e-01
 8.65590334e-01 7.92948008e-01 7.92948008e-01 7.92948008e-01
 7.92948008e-01 7.92948008e-01 7.92948008e-01 7.92948008e-01
 7.92948008e-01 1.27766943e+00 8.65590334e-01 7.92948008e-01
 1.17344737e+00 1.27766943e+00 7.92948008e-01 7.92948008e-01
 6.42885447e-01 7.92948008e-01 6.96558058e-01 9.02356803e-01
 6.44121170e-01 8.91904831e-01 6.96558058e-01 6.44121170e-01
 7.92947948e-01 7.92947948e-01 8.65590334e-01 7.92948008e-01
 7.92948008e-01 7.92948008e-01 1.03589213e+00 9.02356803e-01
 1.03589213e+00 7.92948008e-01 7.92948008e-01 8.65590334e-01
 7.92948008e-01 7.92948008e-01 7.92948008e-01 8.65590334e-01
 8.65590334e-01 7.92948008e-01 7.92948008e-01 1.27766943e+00
 1.03589213e+00 8.65590334e-01 7.92948008e-01 8.65590334e-01
 7.92948008e-01 7.92948008e-01 7.92948008e-01 9.02356803e-01
 8.91904831e-01 8.65590334e-01 8.65590334e-01 9.27666843e-01
 1.05453014e+00 1.05454099e+00 4.76718038e-01 7.92948008e-01
 1.34284151e+00 8.91904831e-01 8.20492148e-01 2.05734106e+03
 9.50650871e-01 1.53164327e+00 7.70997703e-01 4.77129340e-01
 6.50227726e-01 1.12306881e+00 4.77129340e-01 1.28501546e+00
 5.99624217e-01 6.02402866e-01 5.22951901e-01 7.24203348e-01
 5.09783924e-01 9.46474195e-01 4.65591222e-01 3.01927567e+00
 5.12922108e-01 1.03589213e+00 6.00654781e-01 5.22951901e-01
 6.06507361e-01 4.94629115e-01 1.41493356e+00 1.06832695e+00
 6.02402866e-01 5.82359731e-01 7.27913082e-01 9.52654660e-01
 7.92948008e-01 6.02402866e-01 4.76718038e-01 6.02402866e-01
 1.50492105e+01 1.41493356e+00 5.95887184e-01 6.71023667e-01
 2.43924022e+00 1.05000913e+00 9.27666843e-01 1.33656800e+00
 5.12922108e-01 1.14395275e+01 3.01927567e+00 9.46474195e-01
 1.44661474e+00 9.27666843e-01 7.92948008e-01 1.70104778e+00
 7.25752831e-01 5.28560281e-01 1.34127247e+00 4.65591222e-01
 1.66128743e+00 1.02879248e+03 7.25752831e-01 1.27766943e+00
 4.77129340e-01 7.76181996e-01 1.76933193e+00 1.02455819e+00
 7.92948008e-01 5.12922108e-01 8.65590334e-01 5.12922108e-01
 1.96258140e+00 2.43924022e+00 1.12110019e+00 9.52654660e-01
 9.46474195e-01 7.75631905e-01 7.92948008e-01 4.96250302e-01
 9.64701116e-01 8.27227974e+00 8.42809677e-01 4.94270849e+00
 8.65590334e-01 9.14657116e-01 5.95887184e-01 6.50227726e-01
 9.52654660e-01 1.27766943e+00 1.02455819e+00 6.31226480e-01
 9.86402333e-01 1.02455819e+00 5.22951901e-01 1.02455819e+00
 5.24849415e-01 1.66128743e+00 9.14657116e-01 6.02402866e-01
 1.24919450e+00 8.65590334e-01 7.24203348e-01 1.76893711e+00
 8.65590334e-01 1.70104778e+00 9.59717810e-01 7.92948008e-01
 1.08184218e+00 9.52654660e-01 1.56235433e+00 8.28585207e-01
 1.03589213e+00 1.03589213e+00 1.03901637e+00 1.24919450e+00
 6.02402866e-01 1.96258140e+00 6.83577538e-01 1.43825805e+00
 3.09418164e+03 1.25988531e+01 1.96391714e+00 9.14657116e-01
 1.24932957e+00 9.60350811e-01 1.03589213e+00 1.27766943e+00
 1.08805304e+01 7.92948008e-01 5.12922108e-01 2.43924022e+00
 1.35154712e+00 6.50227726e-01 6.50227726e-01 2.10481143e+00
 1.03589213e+00 4.77129340e-01 1.74555200e+03 6.71023667e-01
 1.70104778e+00 5.94191253e-01 9.22452748e-01 7.25752831e-01
 1.21349390e+03 9.14657116e-01 1.21751404e+00 5.62730312e+00
 8.13303769e-01 7.76181996e-01 3.07516670e+00 7.70963192e-01
 1.02543294e+00 7.92948008e-01 2.30634117e+00 9.46474195e-01
 4.94629115e-01 1.44415927e+00 9.14657116e-01 8.91904831e-01
 9.27666843e-01 6.71023667e-01 2.43924022e+00 2.43924022e+00
 1.96258140e+00 2.43924022e+00 7.76181996e-01 5.12922108e-01
 1.01064992e+00 2.43924022e+00 7.26601779e-01 1.38927388e+00
 1.44661474e+00 5.94191253e-01 2.43924022e+00 1.41493356e+00
 2.42985034e+00 1.91124403e+00 4.62292731e-01 1.03901625e+00
 1.42680585e+00 9.52654660e-01 7.24203348e-01 9.14657116e-01
 9.50650871e-01 1.24919450e+00 7.25752831e-01 5.22951901e-01
 1.16409576e+00 3.21206832e+00 9.79604431e+02 8.42809677e-01
 1.56235433e+00 1.20374262e+00 5.27321994e-01 3.01927567e+00
 9.52654660e-01 1.86056364e+00 5.12922108e-01 5.29285967e-01
 1.16409576e+00 6.02402866e-01 8.41222942e-01 7.25752831e-01
 1.02455819e+00 9.64701116e-01 6.53552830e-01 6.71023667e-01
 7.92948008e-01 5.12922108e-01 2.43924022e+00 1.53164327e+00
 8.65590334e-01 3.01927567e+00 1.66101170e+00 7.92948008e-01
 2.43924022e+00 8.79401684e-01 1.45478928e+00 1.27766943e+00
 3.01927567e+00 3.01927567e+00 8.28585207e-01 9.83619869e-01
 1.20374262e+00 6.33972347e-01 5.09783924e-01 1.11034393e+00
 5.12922108e-01 1.04690540e+00 7.92948008e-01 1.09814537e+00
 6.02402866e-01 4.76718038e-01 1.09883404e+00 1.11034393e+00
 2.43924022e+00 4.77129340e-01 9.93782938e-01 2.43924022e+00
 1.27103174e+00 5.09783924e-01 1.48238063e+00 1.06884480e+00
 4.77129340e-01 7.26601779e-01 6.33972347e-01 7.25752831e-01
 9.46474195e-01 1.56235421e+00 1.56532574e+00 6.33972347e-01
 5.09984314e-01 7.92948008e-01 5.64570725e-01 1.33656800e+00
 1.56235433e+00 7.76181996e-01 1.12531519e+00 1.03589213e+00
 4.76718038e-01 1.06832695e+00 1.27766943e+00 1.06832695e+00
 1.03589213e+00 9.64701116e-01 6.09991431e-01 9.02356803e-01
 1.27766943e+00 7.92948008e-01 1.12909138e+00 1.63007236e+00
 1.19013262e+00 8.65590334e-01 1.05453014e+00 1.22790754e+00
 1.39707530e+00 4.78037238e-01 1.13324678e+00 1.24919450e+00
 4.76573080e-01 1.03589213e+00 2.66941571e+00 1.20374262e+00
 5.12922108e-01 9.50650871e-01 7.92948008e-01 1.03901637e+00
 1.56532574e+00 7.26601779e-01 1.11034393e+00 9.14657116e-01
 9.42823827e-01 8.83049011e-01 5.84187686e-01 5.94191253e-01
 1.23138283e+02 8.91904831e-01 1.23138283e+02 1.44624364e+00
 7.70963192e-01 4.77129340e-01 1.01064992e+00 1.05453014e+00
 1.01064992e+00 7.96173889e+02 5.66882491e-01 6.50227726e-01
 4.65591222e-01 7.92948008e-01 1.02455819e+00 7.76181996e-01
 9.52654660e-01 1.27766943e+00 5.94191253e-01 4.94629115e-01
 1.30627346e+00 6.33972347e-01 3.07516670e+00 8.65590453e-01
 8.65590334e-01 8.91904831e-01 6.71023667e-01 4.65591222e-01
 1.19013262e+00 9.33765531e-01 8.42809677e-01 4.96890575e-01
 6.71023667e-01 4.73513079e+00 1.69065213e+00 7.25752831e-01
 7.25752831e-01 7.25752831e-01 7.76181996e-01 6.64387226e-01
 1.05454099e+00 5.94191253e-01 7.25752831e-01 7.24203348e-01
 1.13324678e+00 7.49653041e-01 7.25752831e-01 6.71023667e-01
 5.51723003e-01 6.72318280e-01 1.00197577e+00 1.42395592e+00
 9.46474195e-01 1.50290906e+00 9.64701116e-01 9.46474195e-01
 9.46474195e-01 5.09984314e-01 9.93782938e-01 1.51333034e+00
 1.90700471e+00 1.51333034e+00 7.25752831e-01 1.69065213e+00
 3.55051804e+01 7.92948008e-01 5.12922108e-01 9.46474195e-01
 8.20492148e-01 6.53552830e-01 5.72022021e-01 8.64934623e-01
 9.46474195e-01 4.96890575e-01 6.50227726e-01 1.06832695e+00
 1.42355108e+00 9.46474195e-01 1.00197577e+00 5.59749901e-01
 6.72631741e-01 9.46474195e-01 9.50650871e-01 6.50227726e-01
 5.72022021e-01 2.39125347e+00 1.27715600e+00 5.22951901e-01
 7.92948008e-01 5.88854492e-01 9.46474195e-01 7.25752831e-01
 5.52330494e-01 9.46474195e-01 3.01927567e+00 5.94191253e-01
 9.46474195e-01 9.93782938e-01 7.92948008e-01 1.39660239e+00
 1.98855734e+00 6.71023667e-01 5.59749901e-01 5.12922108e-01
 9.52654660e-01 9.93782938e-01 6.72318280e-01 5.06967068e-01
 9.27666843e-01 1.34043205e+00 5.59749901e-01 7.76181996e-01
 7.25752831e-01 1.27766943e+00 1.11034393e+00 1.96258140e+00
 1.40602744e+00 5.51723003e-01 1.02455819e+00 7.76181996e-01
 5.09984314e-01 6.31226480e-01 8.65590334e-01 6.50227726e-01
 7.27913082e-01 4.65591222e-01 6.50227726e-01 6.50227726e-01
 1.36192429e+00 6.50227726e-01 1.27766943e+00 5.24849415e-01
 9.93782938e-01 1.33886111e+00 5.75870633e-01 7.92948008e-01
 1.38927388e+00 5.22951901e-01 5.09984314e-01 8.91904831e-01
 9.93782938e-01 1.27766943e+00 7.92948008e-01 6.50227726e-01
 8.65590334e-01 1.55688477e+00 9.50650871e-01 7.92948008e-01
 1.39707530e+00 6.50227726e-01 9.50650871e-01 1.00791407e+00
 5.95929980e-01 9.27666843e-01 6.97219491e-01 6.71023667e-01
 1.17344737e+00 6.50227726e-01 6.50227726e-01 1.15457690e+00
 1.16281853e+02 9.50650871e-01 8.65590453e-01 9.50650871e-01
 7.76181996e-01 1.69762897e+00 1.90972102e+00 1.39707530e+00
 6.64387226e-01 9.14657116e-01 1.00791407e+00 1.39707530e+00
 9.50650871e-01 8.91904831e-01 8.65590334e-01 5.22951901e-01
 1.14945376e+00 1.06832695e+00 1.44103181e+00 6.50227726e-01
 6.50227726e-01 7.62975454e-01 7.62975454e-01 7.25752831e-01
 1.39355814e+00 1.73837602e+00 1.06832695e+00 1.00791407e+00
 1.06832695e+00 1.26288891e+00 1.51590931e+00 7.62975454e-01
 4.94270849e+00 1.19013262e+00 6.50227726e-01 1.27766943e+00
 7.92948008e-01 1.06832695e+00 7.92948008e-01 9.50650871e-01
 1.41493356e+00 7.26601779e-01 1.03589213e+00 8.79401684e-01
 7.92948008e-01 7.92948008e-01 6.71023667e-01 8.79401684e-01
 7.76181996e-01 7.76181996e-01 1.58309484e+00 7.76181996e-01
 1.06832695e+00 1.05453014e+00 1.19013262e+00 6.50227726e-01
 7.76181996e-01 5.01089239e+00 1.51590931e+00 6.64387226e-01
 1.55688477e+00 9.52654660e-01 6.71023667e-01 1.19013262e+00
 1.19013262e+00 6.71023667e-01 7.76181996e-01 7.26601779e-01
 1.06832695e+00 6.71023667e-01 6.71023667e-01 6.31226480e-01
 1.06832683e+00 7.76182055e-01 7.62975454e-01 6.71023667e-01
 7.26601779e-01 1.21819222e+00 6.71023667e-01 7.92948008e-01
 7.92948008e-01 1.03589213e+00 6.71023667e-01 7.27913082e-01
 6.64387226e-01 6.71023667e-01 1.06832695e+00 1.33656800e+00
 1.06832695e+00 2.43924022e+00 6.71023667e-01 6.64387226e-01
 7.26601779e-01 7.92948008e-01 6.71023667e-01 7.92948008e-01
 7.92948008e-01 9.14657116e-01 7.92948008e-01 7.30213881e-01
 6.71023667e-01 6.71023667e-01 7.76181996e-01 4.65591222e-01
 1.06832695e+00 6.71023667e-01 1.24919450e+00 6.64387226e-01
 1.36192429e+00 8.91904831e-01 8.91904831e-01 7.70963192e-01
 7.92948008e-01 7.92948008e-01 7.92948008e-01 7.92948008e-01
 8.91904831e-01 7.92948008e-01 1.27766943e+00 1.27766943e+00
 1.27766943e+00 1.27766943e+00 4.67463398e+00 7.92948008e-01
 1.17344737e+00 8.91904831e-01 7.92948008e-01 8.91904831e-01
 9.67222393e-01 1.26288891e+00 1.27766943e+00 8.65590334e-01
 2.04577246e+03 8.65590334e-01 1.36192465e+00 5.24823666e-01
 8.65590274e-01]
2025-06-06 15:07:38,264 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        ... 0.79999954 0.8        0.8       ]
2025-06-06 15:07:38,313 - ERROR - An error occurred while processing file nw_graph_encoded_1749044768.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:38,314 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:38,314 - INFO - 
--- Processing file: nw_graph_encoded_1749044828.dot ---
2025-06-06 15:07:38,314 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot
2025-06-06 15:07:38,314 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot file.
2025-06-06 15:07:38,344 - INFO - Parsed 715 nodes.
2025-06-06 15:07:38,372 - INFO - Parsed 1521 edges.
2025-06-06 15:07:38,997 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:38,997 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:39,004 - DEBUG - Initial node features tensor shape: torch.Size([715, 19])
2025-06-06 15:07:39,011 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:39,028 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 19])
2025-06-06 15:07:39,029 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-06 15:07:39,030 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:39,056 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:39,059 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:39,063 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 2])
2025-06-06 15:07:39,067 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:39,067 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 20])
2025-06-06 15:07:39,068 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 22])
2025-06-06 15:07:39,068 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:39,068 - INFO - Performing online update...
2025-06-06 15:07:39,068 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:39,070 - DEBUG - Updated RunningStats: new_mean=[ 3.92450558e-10 -4.49332685e-10 -2.85837147e-09  2.23548567e-09
 -2.50877883e-08  1.36671725e-08 -9.45658567e-09 -2.27766818e-09
 -2.90980545e-09  1.02416445e-09  1.62197213e-09 -1.47015824e-09
  3.62465648e-09 -3.30331972e-09  9.49908776e-10  6.83697910e-10
 -3.79267466e-09  1.12171328e-09 -4.58970583e-09], new_M2=[198529.00524653 198529.00520079 198529.00029387 198529.00434399
 198528.99842432 198528.99840361 198528.99591954 198528.99817993
 198528.99321324 198528.99841888 198529.00184664 198528.99392332
 198528.99281064 158737.99670453 158738.00005229 158737.99886596
 158737.99998547 198529.00019199 198529.00766474], new_n=198529
2025-06-06 15:07:39,071 - DEBUG - Updated RunningStats: new_mean=[ 1.41478857e+00  5.48623589e+00  1.10331509e-10  2.49515433e-10
  1.44758352e-10 -1.57200765e-10 -1.24290548e-09  1.84611569e-10
  2.99270788e-10 -1.88353995e-10  3.09611209e-10 -3.45604089e-09
 -8.54895149e-10  2.28737758e-10  2.89329939e-10 -1.48169242e-10
 -1.48169242e-10 -1.48169242e-10 -1.48169242e-10 -1.48169242e-10
 -1.48169242e-10 -8.19810182e-11], new_M2=[ 109905.78637273 1903495.64960567  426761.99899158  426762.00584223
  426762.00579394  426761.99334414  426762.00038665  426761.99908672
  426762.00164839  426761.99931478  426761.99396614  426762.00861671
  426762.00110397  426761.99992136  426762.00185637  426761.99457574
  426761.99457574  426761.99457574  426761.99457574  426761.99457574
  426761.99457574  426761.99896373], new_n=426762
2025-06-06 15:07:39,072 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89418724 0.89418725 0.89418725 0.89418725 1.
 1.00000002]
2025-06-06 15:07:39,072 - DEBUG - Calculated standard deviation: [0.50747822 2.11194728 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:39,073 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:39,073 - DEBUG - Online update step: 1/50
2025-06-06 15:07:39,073 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,073 - DEBUG - Online update step: 2/50
2025-06-06 15:07:39,073 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,073 - DEBUG - Online update step: 3/50
2025-06-06 15:07:39,073 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,073 - DEBUG - Online update step: 4/50
2025-06-06 15:07:39,073 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,074 - DEBUG - Online update step: 5/50
2025-06-06 15:07:39,074 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,074 - DEBUG - Online update step: 6/50
2025-06-06 15:07:39,074 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,074 - DEBUG - Online update step: 7/50
2025-06-06 15:07:39,074 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,074 - DEBUG - Online update step: 8/50
2025-06-06 15:07:39,074 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,074 - DEBUG - Online update step: 9/50
2025-06-06 15:07:39,074 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,075 - DEBUG - Online update step: 10/50
2025-06-06 15:07:39,075 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,075 - DEBUG - Online update step: 11/50
2025-06-06 15:07:39,075 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,075 - DEBUG - Online update step: 12/50
2025-06-06 15:07:39,075 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,075 - DEBUG - Online update step: 13/50
2025-06-06 15:07:39,075 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,075 - DEBUG - Online update step: 14/50
2025-06-06 15:07:39,076 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,076 - DEBUG - Online update step: 15/50
2025-06-06 15:07:39,076 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,076 - DEBUG - Online update step: 16/50
2025-06-06 15:07:39,076 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,076 - DEBUG - Online update step: 17/50
2025-06-06 15:07:39,076 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,076 - DEBUG - Online update step: 18/50
2025-06-06 15:07:39,076 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,076 - DEBUG - Online update step: 19/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,077 - DEBUG - Online update step: 20/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,077 - DEBUG - Online update step: 21/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,077 - DEBUG - Online update step: 22/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,077 - DEBUG - Online update step: 23/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,077 - DEBUG - Online update step: 24/50
2025-06-06 15:07:39,077 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 25/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 26/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 27/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 28/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 29/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 30/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,078 - DEBUG - Online update step: 31/50
2025-06-06 15:07:39,078 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 32/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 33/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 34/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 35/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 36/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 37/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 38/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 39/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 40/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 41/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,079 - DEBUG - Online update step: 42/50
2025-06-06 15:07:39,079 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 43/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 44/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 45/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 46/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 47/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 48/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 49/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - DEBUG - Online update step: 50/50
2025-06-06 15:07:39,080 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:39,080 - WARNING - No successful steps during online update.
2025-06-06 15:07:39,104 - DEBUG - Current node mean: [-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], current edge mean: [ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:07:39,105 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2368
2025-06-06 15:07:39,105 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:07:39,105 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:07:39,105 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:07:39,106 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:07:39,110 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:07:39,111 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:07:39,112 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:07:39,112 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:07:39,113 - INFO - Optimizer and scheduler reset.
2025-06-06 15:07:39,113 - DEBUG - Updated reference mean: node=[-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], edge=[ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:07:39,118 - DEBUG - Updated reference std: node=[1.0007    1.0007    1.0007    1.0007    1.0007    1.0007    1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007    1.0007001 1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007   ], edge=[0.5073971 1.7682712 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289]
2025-06-06 15:07:39,118 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:39,118 - INFO - Running anomaly detection...
2025-06-06 15:07:39,118 - INFO - Starting anomaly detection.
2025-06-06 15:07:39,895 - DEBUG - Node reconstruction errors: [6.5327001e-01 6.5327001e-01 8.5738885e-01 6.5327001e-01 8.5738885e-01
 6.5327001e-01 6.5327001e-01 6.5327001e-01 7.1131152e-01 6.5327001e-01
 6.5327001e-01 4.5874968e+00 7.1131152e-01 6.5327001e-01 6.5327001e-01
 6.5327001e-01 6.5327001e-01 1.6580204e+00 6.5327001e-01 6.5327001e-01
 6.5327001e-01 6.5327001e-01 1.4793946e+00 5.5415452e-01 5.5415452e-01
 5.5415452e-01 5.5415452e-01 5.5415452e-01 7.0706934e-01 7.0706934e-01
 1.4815538e+00 7.0706934e-01 7.0706934e-01 5.5415452e-01 1.4793946e+00
 1.4793946e+00 1.4793946e+00 5.5415452e-01 7.0706934e-01 5.5415452e-01
 1.5509186e+00 7.0706934e-01 5.5415452e-01 7.0706934e-01 7.0706934e-01
 5.4451257e-01 5.5415452e-01 5.5415452e-01 4.4437742e+00 5.5415452e-01
 5.5415452e-01 5.5415452e-01 5.5415452e-01 5.5415452e-01 5.5415452e-01
 5.5415452e-01 1.4550767e+00 4.8787901e-01 5.4706591e-01 4.8787901e-01
 5.4706591e-01 5.4706591e-01 5.4706591e-01 5.4706591e-01 5.4706591e-01
 5.4706591e-01 5.4706591e-01 5.4706591e-01 1.3177716e+00 4.8787901e-01
 5.4706591e-01 5.5233228e-01 1.3177716e+00 5.4706591e-01 5.4706591e-01
 4.9656603e-01 5.4706591e-01 4.7585928e-01 1.3988179e+00 4.9682251e-01
 6.3674283e-01 4.7585928e-01 4.9682251e-01 5.4706591e-01 5.4706591e-01
 4.8787901e-01 5.4706591e-01 5.4706591e-01 5.4706591e-01 5.5415452e-01
 6.1860782e-01 5.5415452e-01 5.4706591e-01 5.4706591e-01 4.8787901e-01
 5.4706591e-01 5.4706591e-01 5.4706591e-01 4.8787901e-01 4.8787901e-01
 5.4706591e-01 5.4706591e-01 1.3177716e+00 5.5233228e-01 4.8787901e-01
 5.4706591e-01 4.8787901e-01 5.4706591e-01 5.4706591e-01 5.4706591e-01
 6.1860782e-01 1.3314263e+00 4.8787901e-01 4.8787901e-01 1.1394367e+00
 1.5480734e+00 1.7218554e+00 5.7786685e-01 5.4706591e-01 2.0121758e+00
 1.3314263e+00 1.4795010e+00 2.7803235e+03 1.2408650e+00 1.5556409e+00
 1.2113632e+00 6.8661940e-01 8.1224811e-01 1.4984885e+00 6.8661940e-01
 1.7557282e+00 6.5242815e-01 9.2110807e-01 5.9812218e-01 1.1270279e+00
 6.4221472e-01 1.3689519e+00 5.9502196e-01 3.9087729e+00 6.2579489e-01
 5.5415452e-01 8.5001737e-01 5.9812218e-01 9.5081443e-01 6.6106451e-01
 1.5556409e+00 1.8154080e+00 9.2110807e-01 9.4977832e-01 5.7787943e-01
 1.4229177e+00 5.4706591e-01 9.2110807e-01 5.7786685e-01 9.2110807e-01
 2.0864120e+01 1.5556409e+00 7.7393335e-01 6.9425315e-01 3.2076027e+00
 1.4781221e+00 1.2160853e+00 1.5090227e+00 7.8671414e-01 1.8780279e+01
 3.9087729e+00 1.0325457e+00 2.6755924e+00 1.2160853e+00 5.4706591e-01
 1.6236604e+00 5.5782825e-01 6.9046962e-01 1.2332464e+00 5.9502196e-01
 1.9155695e+00 6.5327001e-01 8.6639771e+02 1.0593036e+00 1.3314263e+00
 6.8661940e-01 6.5430164e-01 2.5236721e+00 1.6191497e+00 8.4349132e-01
 5.4706591e-01 7.8671414e-01 4.8787901e-01 7.8671414e-01 2.5882223e+00
 3.2076027e+00 1.5717702e+00 1.4229177e+00 1.3689519e+00 1.5884863e+00
 5.4706591e-01 8.2013899e-01 1.2599334e+00 1.7590469e+01 9.0960872e-01
 5.7490053e+00 4.8787901e-01 1.3429580e+00 7.7393335e-01 8.1224811e-01
 1.4229177e+00 1.3177716e+00 1.6191497e+00 4.8611093e-01 7.9920399e-01
 1.6191497e+00 5.9812218e-01 6.5327001e-01 1.6191497e+00 6.8683791e-01
 1.9155695e+00 1.3429580e+00 9.2110807e-01 1.5090227e+00 4.8787901e-01
 1.1270279e+00 2.0364604e+00 4.8787901e-01 1.6236604e+00 1.4418582e+00
 6.5843087e-01 1.3695595e+00 1.4229177e+00 2.0719757e+00 1.2323598e+00
 5.5415452e-01 5.5415452e-01 1.1323893e+00 1.5090227e+00 9.2110807e-01
 2.5882223e+00 1.1570342e+00 2.2207725e+00 3.8548997e+03 2.0558203e+01
 2.4126592e+00 6.5242815e-01 2.0190229e+00 1.6720622e+00 5.5415452e-01
 1.3177716e+00 1.9676798e+01 5.4706591e-01 7.8671414e-01 3.2076027e+00
 1.5226110e+00 8.1224811e-01 8.1224811e-01 2.8552094e+00 5.5415452e-01
 6.8661940e-01 2.6601240e+03 4.6914798e-01 1.6236604e+00 8.5555500e-01
 1.2960861e+00 1.0593036e+00 9.9296887e+02 1.3429580e+00 1.6973361e+00
 9.5446367e+00 1.4433039e+00 6.5430164e-01 4.5244594e+00 1.7604085e+00
 1.0731267e+00 5.4706591e-01 1.6880819e+00 1.3689519e+00 6.2579489e-01
 2.0445120e+00 6.2579489e-01 6.3674283e-01 1.2160853e+00 5.3157449e-01
 3.2076027e+00 3.2076027e+00 2.5882223e+00 3.2076027e+00 6.5430164e-01
 7.8671414e-01 1.5178257e+00 3.2076027e+00 4.6170953e-01 2.4091568e+00
 2.6755924e+00 8.5555500e-01 3.2076027e+00 1.8959790e+00 3.8534362e+00
 2.8110640e+00 8.2542264e-01 1.0162401e+00 1.9448659e+00 1.4229177e+00
 1.1270279e+00 1.3429580e+00 1.2408650e+00 1.5713809e+00 1.0593036e+00
 5.9812218e-01 1.3026719e+00 2.9076900e+00 8.5063354e+02 9.0960872e-01
 2.0719757e+00 1.6769304e+00 8.8261634e-01 3.9087729e+00 1.4229177e+00
 2.4215896e+00 7.8671414e-01 9.1717762e-01 1.4011704e+00 9.2110807e-01
 1.2703604e+00 1.0593036e+00 1.6191497e+00 1.2599334e+00 6.7010993e-01
 6.3686872e-01 5.4706591e-01 6.5327001e-01 7.8671414e-01 3.2076027e+00
 1.7406088e+00 4.8787901e-01 3.9087729e+00 1.4545611e+00 5.4706591e-01
 3.2076027e+00 1.4976758e+00 1.9652126e+00 1.3177716e+00 3.9087729e+00
 3.9087729e+00 1.2751073e+00 4.7951087e-01 1.6769304e+00 9.6322513e-01
 6.4221472e-01 7.0706934e-01 6.5242815e-01 1.2664028e+00 5.4706591e-01
 2.2060997e+00 9.2110807e-01 5.7786685e-01 6.5327001e-01 1.2114773e+00
 7.4718004e-01 3.2076027e+00 6.8661940e-01 1.3680500e+00 1.4442375e+00
 1.7536466e+00 6.5242815e-01 2.4854615e+00 1.1394367e+00 6.8661940e-01
 4.6170953e-01 9.6322513e-01 1.0593036e+00 1.3689519e+00 2.0719757e+00
 1.8664910e+00 9.6322513e-01 5.7605249e-01 5.4706591e-01 8.1666309e-01
 1.5074511e+00 2.0719757e+00 6.5430164e-01 1.8864622e+00 5.5415452e-01
 5.7786685e-01 1.2265166e+00 1.3177716e+00 1.2070189e+00 5.5415452e-01
 1.2599334e+00 1.0784192e+00 6.1860782e-01 1.3177716e+00 5.4706591e-01
 1.8171029e+00 2.2175756e+00 1.2070189e+00 4.8787901e-01 1.5480734e+00
 1.9719362e+00 1.5344608e+00 7.7796090e-01 1.0325457e+00 1.5090227e+00
 6.7651355e-01 5.5415452e-01 2.2265708e+00 1.6769304e+00 7.8671414e-01
 1.0974088e+00 6.5327001e-01 5.4706591e-01 1.1323893e+00 1.8664910e+00
 4.6170953e-01 7.0706934e-01 1.3429580e+00 1.1860310e+00 1.9922078e+00
 8.4972161e-01 8.5555500e-01 4.1634344e+02 6.3674283e-01 4.1634344e+02
 2.3260241e+00 1.7604085e+00 6.8661940e-01 1.5178257e+00 1.5480734e+00
 1.5178257e+00 1.1064417e+03 7.2509468e-01 8.1224811e-01 5.9502196e-01
 5.4706591e-01 1.6191497e+00 6.5430164e-01 1.4229177e+00 1.3177716e+00
 8.5555500e-01 6.6106451e-01 1.0731267e+00 9.6322513e-01 4.5244594e+00
 4.8787901e-01 4.8787901e-01 6.3674283e-01 4.6914798e-01 5.9502196e-01
 1.1973646e+00 1.2440863e+00 9.0960872e-01 5.5249518e-01 4.6914798e-01
 5.8798914e+00 1.6234074e+00 1.0593036e+00 1.0593036e+00 1.0593036e+00
 6.5430164e-01 5.2428657e-01 1.7218554e+00 8.5555500e-01 1.0593036e+00
 1.1270279e+00 1.0479746e+00 1.5967137e+00 1.0593036e+00 6.3686872e-01
 6.2204725e-01 7.4868774e-01 1.5433193e+00 1.5896837e+00 1.3689519e+00
 2.0566638e+00 1.0162401e+00 1.3689519e+00 1.3689519e+00 5.7605249e-01
 1.3680500e+00 1.6952597e+00 1.5090227e+00 1.6952597e+00 6.8408012e-01
 1.5226110e+00 3.1574745e+01 5.4706591e-01 7.8671414e-01 1.3689519e+00
 1.4795010e+00 5.7187265e-01 5.3502351e-01 1.3572143e+00 1.3689519e+00
 5.5249518e-01 8.1224811e-01 1.2265166e+00 1.5681149e+00 1.3689519e+00
 1.1096681e+00 5.4912817e-01 6.7010993e-01 1.3689519e+00 1.2408650e+00
 8.1224811e-01 5.3502351e-01 1.9516064e+00 2.1739144e+00 5.9812218e-01
 5.4706591e-01 9.3879759e-01 1.3689519e+00 1.0593036e+00 7.7932185e-01
 1.3689519e+00 3.9087729e+00 8.5555500e-01 1.3689519e+00 1.3680500e+00
 5.4706591e-01 1.8281673e+00 1.6525265e+00 6.3686872e-01 5.4912817e-01
 7.8671414e-01 1.4229177e+00 1.3680500e+00 7.4868774e-01 7.0301062e-01
 1.2160853e+00 1.5666609e+00 5.4912817e-01 6.5430164e-01 1.0593036e+00
 1.3177716e+00 7.0706934e-01 2.5882223e+00 1.8570967e+00 6.2204725e-01
 6.5327001e-01 1.6191497e+00 6.5430164e-01 5.7605249e-01 4.8611093e-01
 4.8787901e-01 8.1224811e-01 5.7787943e-01 5.9502196e-01 8.1224811e-01
 8.1224811e-01 6.5327001e-01 8.1224811e-01 1.3177716e+00 6.8683791e-01
 1.3680500e+00 1.0974088e+00 6.4726114e-01 5.4706591e-01 2.4091568e+00
 5.9812218e-01 5.3305924e-01 6.3674283e-01 1.3680500e+00 1.3177716e+00
 5.4706591e-01 8.1224811e-01 4.8787901e-01 1.8154080e+00 1.2408650e+00
 5.4706591e-01 1.5717702e+00 8.1224811e-01 1.2408650e+00 1.1465578e+00
 5.4217905e-01 1.0378516e+00 9.8396158e-01 4.6914798e-01 5.5233228e-01
 8.1224811e-01 8.1224811e-01 1.0170089e+00 4.1394962e+02 1.2408650e+00
 4.8787901e-01 1.2408650e+00 6.5430164e-01 1.5717702e+00 1.5762279e+00
 1.5344608e+00 5.2428657e-01 1.3429580e+00 1.1818689e+00 1.5717702e+00
 1.2408650e+00 6.3674283e-01 4.8787901e-01 5.9812218e-01 1.1041527e+00
 1.2265166e+00 1.9033356e+00 8.1224811e-01 8.1224811e-01 5.7187265e-01
 7.4515164e-01 1.0593036e+00 1.2070189e+00 1.7996424e+00 1.2265166e+00
 1.1465578e+00 1.2070189e+00 1.5416642e+00 1.7453214e+00 7.4515164e-01
 5.6505561e+00 1.2070189e+00 8.1224811e-01 1.3177716e+00 5.4706591e-01
 1.2265166e+00 5.4706591e-01 1.2408650e+00 1.8959790e+00 4.6170953e-01
 5.5415452e-01 1.4976758e+00 5.4706591e-01 5.4706591e-01 6.3686872e-01
 1.4976758e+00 6.5430164e-01 6.5430164e-01 2.5589330e+00 6.5430164e-01
 1.2265166e+00 1.5480734e+00 1.1973646e+00 8.1224811e-01 5.9844697e-01
 5.7002802e+00 1.7453214e+00 4.6914798e-01 1.8154080e+00 1.4229177e+00
 4.6914798e-01 1.1973646e+00 1.1973646e+00 6.3686872e-01 5.9844697e-01
 4.6170953e-01 1.2265166e+00 6.3686872e-01 4.6914798e-01 4.8611093e-01
 1.2265166e+00 5.9844697e-01 7.4515164e-01 6.3686872e-01 4.6170953e-01
 1.7940491e+00 6.3686872e-01 5.4706591e-01 5.4706591e-01 5.5415452e-01
 6.3686872e-01 5.7787943e-01 5.2428657e-01 4.6914798e-01 1.2265166e+00
 1.5074511e+00 1.2265166e+00 3.2076027e+00 4.6914798e-01 5.2428657e-01
 4.6170953e-01 5.4706591e-01 4.6914798e-01 5.4706591e-01 5.4706591e-01
 1.3429580e+00 5.4706591e-01 9.9936968e-01 6.3686872e-01 4.6914798e-01
 6.5430164e-01 5.9502196e-01 1.2070189e+00 6.3686872e-01 1.5713809e+00
 5.2428657e-01 6.5327001e-01 6.5843087e-01 6.3674283e-01 1.7604085e+00
 4.7951087e-01 4.7951087e-01 5.4886574e-01 5.4706591e-01 6.3674283e-01
 5.4706591e-01 1.3177716e+00 1.3177716e+00 1.3177716e+00 1.3177716e+00
 5.9247851e+00 5.4706591e-01 5.5233228e-01 6.3674283e-01 5.4706591e-01
 6.3674283e-01 6.5843087e-01 1.5416642e+00 1.3177716e+00 4.8787901e-01
 2.7901934e+03 4.8787901e-01 1.6580204e+00 7.7408284e-01 4.8787895e-01]
2025-06-06 15:07:39,895 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:07:39,965 - ERROR - An error occurred while processing file nw_graph_encoded_1749044828.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:39,966 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:39,966 - INFO - 
--- Processing file: nw_graph_encoded_1749044888.dot ---
2025-06-06 15:07:39,966 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot
2025-06-06 15:07:39,966 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot file.
2025-06-06 15:07:39,985 - INFO - Parsed 731 nodes.
2025-06-06 15:07:40,009 - INFO - Parsed 1560 edges.
2025-06-06 15:07:40,534 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:40,534 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:40,541 - DEBUG - Initial node features tensor shape: torch.Size([731, 19])
2025-06-06 15:07:40,552 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:40,568 - DEBUG - Node features tensor shape after scaling: torch.Size([731, 19])
2025-06-06 15:07:40,570 - DEBUG - Edge index tensor shape: torch.Size([2, 1560])
2025-06-06 15:07:40,570 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:40,583 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:40,584 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:40,586 - DEBUG - Shape of encoded categorical edge features: torch.Size([1560, 2])
2025-06-06 15:07:40,588 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:40,588 - DEBUG - Shape of scaled numerical edge features: torch.Size([1560, 20])
2025-06-06 15:07:40,589 - DEBUG - Final edge attributes tensor shape: torch.Size([1560, 22])
2025-06-06 15:07:40,589 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:40,589 - INFO - Performing online update...
2025-06-06 15:07:40,589 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:40,590 - DEBUG - Updated RunningStats: new_mean=[ 4.21596867e-10 -4.78270318e-10 -2.86142096e-09  2.21786203e-09
 -2.49993415e-08  1.36084709e-08 -9.47603601e-09 -2.27993151e-09
 -2.91603146e-09  1.04235589e-09  1.61878876e-09 -1.46125007e-09
  3.64336607e-09 -3.27011258e-09  8.89402309e-10  7.08560109e-10
 -3.79999919e-09  1.11297102e-09 -4.56389426e-09], new_M2=[199260.00527184 199260.00522611 199260.0002512  199260.00438155
 199259.998439   199259.99839187 199259.99592639 199259.99812856
 199259.99322536 199259.99845744 199260.00185318 199259.99395455
 199259.9927934  159468.99669201 159469.00005758 159468.99887091
 159469.0000247  199260.0002367  199260.00768573], new_n=199260
2025-06-06 15:07:40,591 - DEBUG - Updated RunningStats: new_mean=[ 1.41483277e+00  5.48439025e+00  1.08549227e-10  2.48660551e-10
  1.43260413e-10 -1.58959669e-10 -1.25036672e-09  2.01022527e-10
  2.92818722e-10 -1.77554535e-10  2.98740299e-10 -3.44613645e-09
 -8.53664847e-10  2.64103271e-10  2.85119006e-10 -1.47386880e-10
 -1.47386880e-10 -1.47386880e-10 -1.47386880e-10 -1.47386880e-10
 -1.47386880e-10 -8.22412419e-11], new_M2=[ 110307.68447103 1908790.13320122  428321.99902323  428322.00584481
  428322.00578603  428321.99325245  428322.00037946  428321.99913042
  428322.00165154  428321.99929705  428321.99400441  428322.00862453
  428322.00109819  428321.99988972  428322.00188027  428321.99460491
  428321.99460491  428321.99460491  428321.99460491  428321.99460491
  428321.99460491  428321.99896042], new_n=428322
2025-06-06 15:07:40,591 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.8945983  0.89459831 0.8945983  0.89459831 1.
 1.00000002]
2025-06-06 15:07:40,591 - DEBUG - Calculated standard deviation: [0.50747855 2.11102754 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:40,591 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:40,591 - DEBUG - Online update step: 1/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 2/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 3/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 4/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 5/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 6/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 7/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 8/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 9/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 10/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 11/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 12/50
2025-06-06 15:07:40,592 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,592 - DEBUG - Online update step: 13/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 14/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 15/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 16/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 17/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 18/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 19/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 20/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 21/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 22/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 23/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 24/50
2025-06-06 15:07:40,593 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,593 - DEBUG - Online update step: 25/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 26/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 27/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 28/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 29/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 30/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 31/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 32/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 33/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 34/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 35/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 36/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,594 - DEBUG - Online update step: 37/50
2025-06-06 15:07:40,594 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 38/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 39/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 40/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 41/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 42/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 43/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 44/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 45/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 46/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 47/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 48/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 49/50
2025-06-06 15:07:40,595 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,595 - DEBUG - Online update step: 50/50
2025-06-06 15:07:40,596 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:40,596 - WARNING - No successful steps during online update.
2025-06-06 15:07:40,610 - DEBUG - Current node mean: [ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], current edge mean: [ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:07:40,610 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2392
2025-06-06 15:07:40,611 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:07:40,611 - DEBUG - Updated reference mean: node=[ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], edge=[ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:07:40,611 - DEBUG - Updated reference std: node=[1.0006847 1.0006847 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847], edge=[0.50758785 1.7720196  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207 ]
2025-06-06 15:07:40,611 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:40,611 - INFO - Running anomaly detection...
2025-06-06 15:07:40,612 - INFO - Starting anomaly detection.
2025-06-06 15:07:41,822 - DEBUG - Node reconstruction errors: [1.8714415e+00 3.8671423e+02 9.9025553e-01 7.6679593e-01 7.6679593e-01
 9.7348183e-01 7.6679593e-01 9.7348183e-01 9.7348183e-01 6.1136812e-01
 6.1136812e-01 7.9162860e-01 6.1136812e-01 7.9162860e-01 6.1136812e-01
 6.1136812e-01 6.1136812e-01 6.4958239e-01 6.1136812e-01 6.1136812e-01
 4.4842834e+00 6.4958239e-01 1.6271577e+00 6.1136812e-01 6.1136812e-01
 6.1136812e-01 1.5744514e+00 6.1136812e-01 6.1136812e-01 6.1136812e-01
 1.6271577e+00 1.4163373e+00 5.4586446e-01 5.4586446e-01 5.4586446e-01
 5.4586446e-01 9.7348183e-01 5.4586446e-01 6.7175281e-01 6.7175281e-01
 1.4560599e+00 6.7175281e-01 6.7175281e-01 5.4586446e-01 2.1789138e+00
 1.4163373e+00 1.4163373e+00 5.4586446e-01 6.7175281e-01 5.4586446e-01
 1.4655049e+00 6.7175281e-01 5.4586446e-01 6.7175281e-01 6.7175281e-01
 5.2410430e-01 5.4586446e-01 5.4586446e-01 4.3639302e+00 5.4586446e-01
 5.4586446e-01 5.4586446e-01 5.4586446e-01 5.4586446e-01 5.4586446e-01
 5.4586446e-01 1.4045302e+00 4.9167195e-01 5.6641465e-01 4.9167195e-01
 5.6641465e-01 5.6641465e-01 7.6679605e-01 5.6641477e-01 5.6641465e-01
 5.6641465e-01 5.6641465e-01 5.6641465e-01 5.6641465e-01 1.2819116e+00
 4.9167195e-01 5.6641465e-01 5.2680540e-01 1.2819116e+00 5.6641465e-01
 5.6641465e-01 5.0205749e-01 5.6641465e-01 4.6038809e-01 1.3255463e+00
 5.0237763e-01 6.3227403e-01 4.6038809e-01 5.0237763e-01 5.6641465e-01
 5.6641465e-01 4.9167195e-01 5.6641465e-01 5.6641465e-01 5.6641465e-01
 5.4586446e-01 8.0460650e-01 5.4586446e-01 5.6641465e-01 5.6641465e-01
 4.9167195e-01 5.6641465e-01 5.6641465e-01 5.6641465e-01 4.9167195e-01
 4.9167195e-01 5.6641465e-01 5.6641465e-01 1.2819116e+00 5.2680540e-01
 4.9167195e-01 5.6641465e-01 4.9167195e-01 5.6641465e-01 5.6641465e-01
 5.6641465e-01 5.9969306e-01 1.2817765e+00 4.9167195e-01 4.9167195e-01
 1.1060433e+00 1.5642601e+00 1.7390727e+00 5.8161199e-01 5.6641465e-01
 2.0378160e+00 1.2817765e+00 1.4774250e+00 2.8544709e+03 7.6679593e-01
 1.2481487e+00 1.5685551e+00 1.2451217e+00 7.2290301e-01 8.5334516e-01
 1.5085688e+00 7.2290301e-01 1.6518762e+00 6.5460670e-01 9.6570265e-01
 6.3026327e-01 1.1625984e+00 6.6363323e-01 1.3901120e+00 6.1092550e-01
 3.7890835e+00 6.0450387e-01 5.4586446e-01 9.2460531e-01 6.3026327e-01
 9.7111148e-01 8.2060844e-01 1.5365095e+00 1.7735887e+00 9.6570265e-01
 9.6746206e-01 5.7982761e-01 1.4521159e+00 5.6641465e-01 9.6570265e-01
 5.8161199e-01 9.6570265e-01 2.0302702e+01 1.5685551e+00 7.9773009e-01
 6.3972104e-01 3.1295922e+00 1.4575583e+00 1.2382873e+00 1.4919024e+00
 7.6679593e-01 8.2498080e-01 1.8250259e+01 3.7890835e+00 1.0239407e+00
 1.8925135e+00 1.2382873e+00 5.6641465e-01 1.6534843e+00 5.5987573e-01
 7.3072898e-01 1.2023216e+00 6.1092550e-01 1.9058577e+00 6.1136812e-01
 8.7337451e+02 1.0946474e+00 1.2817765e+00 7.2290301e-01 6.6414529e-01
 2.5531702e+00 1.6392728e+00 7.6679593e-01 5.6641465e-01 8.2498080e-01
 4.9167195e-01 8.2498080e-01 2.5484278e+00 3.1295922e+00 1.5248394e+00
 1.4521159e+00 1.1595510e+00 1.5800768e+00 5.6641465e-01 8.5031670e-01
 1.2871493e+00 1.7132336e+01 9.2667240e-01 5.6851406e+00 4.9167195e-01
 1.3631130e+00 7.9773009e-01 8.5334516e-01 1.4521159e+00 1.2819116e+00
 1.6392730e+00 5.0371283e-01 1.2235602e+00 1.6392728e+00 6.3026327e-01
 6.1136812e-01 1.6392728e+00 6.8248469e-01 1.9058577e+00 1.3631130e+00
 9.6570265e-01 1.4919024e+00 4.9167195e-01 1.1625986e+00 2.0402744e+00
 4.9167195e-01 1.6534843e+00 1.4595774e+00 6.1755222e-01 1.3411713e+00
 1.4521159e+00 2.0584235e+00 1.2076693e+00 5.4586446e-01 5.4586446e-01
 1.1539158e+00 1.4919024e+00 9.6570265e-01 2.5484278e+00 1.1493738e+00
 2.2123597e+00 3.9540083e+03 1.9886635e+01 2.4192235e+00 6.5460670e-01
 2.0471408e+00 1.6744260e+00 5.4586446e-01 1.2819116e+00 1.9066540e+01
 5.6641465e-01 8.2498080e-01 3.1295922e+00 1.4874378e+00 8.5334516e-01
 8.5334516e-01 2.8000152e+00 5.4586446e-01 7.2290301e-01 2.7366711e+03
 4.6240234e-01 1.6534843e+00 9.0230322e-01 1.2444729e+00 1.0946474e+00
 1.0366088e+03 1.3631130e+00 9.7348183e-01 1.7293868e+00 9.3567257e+00
 1.4396619e+00 6.6414529e-01 4.3728704e+00 1.2515901e+00 1.0764830e+00
 5.6641465e-01 1.7064241e+00 1.3901120e+00 6.0450387e-01 2.0458064e+00
 6.0450387e-01 6.3227403e-01 1.2382873e+00 5.0264692e-01 3.1295922e+00
 3.1295922e+00 2.5484278e+00 3.1295922e+00 6.6414529e-01 8.2498080e-01
 1.5439992e+00 3.1295922e+00 4.7046691e-01 2.4004934e+00 2.6282835e+00
 9.0230322e-01 3.1295922e+00 1.9324244e+00 3.7451344e+00 2.8058836e+00
 7.8218412e-01 1.0138409e+00 1.9337130e+00 1.4521159e+00 1.1625986e+00
 1.3631130e+00 1.0850981e+00 1.5887489e+00 1.0946474e+00 6.3026327e-01
 1.2696002e+00 2.9014106e+00 8.5095135e+02 9.2667240e-01 2.0584235e+00
 1.6807353e+00 8.4983844e-01 3.7890835e+00 1.4521159e+00 2.3724971e+00
 8.2498080e-01 9.5064813e-01 9.9025553e-01 1.3795539e+00 9.6570265e-01
 1.2675480e+00 1.0946474e+00 1.6392728e+00 1.2871493e+00 6.1838078e-01
 5.9711367e-01 5.6641465e-01 6.1136812e-01 8.2498080e-01 3.1295922e+00
 1.7793999e+00 4.9167195e-01 3.7890835e+00 1.4138771e+00 5.6641465e-01
 3.1295922e+00 1.4901308e+00 1.9442486e+00 1.2819116e+00 3.7890835e+00
 3.7890835e+00 1.3021983e+00 4.6616209e-01 1.6807353e+00 9.8668402e-01
 6.6363341e-01 1.4655049e+00 6.5460670e-01 1.2804155e+00 5.6641465e-01
 2.1799977e+00 9.6570253e-01 5.8161181e-01 6.1136800e-01 1.2127436e+00
 6.9504929e-01 3.1295922e+00 7.2290301e-01 1.3770180e+00 1.6464943e+00
 1.6912059e+00 6.5460670e-01 2.4636073e+00 1.1060433e+00 7.2290301e-01
 4.7046691e-01 9.8668402e-01 1.0946474e+00 1.3901120e+00 2.0584235e+00
 1.9049891e+00 9.8668402e-01 5.5589491e-01 5.6641465e-01 9.3343014e-01
 1.5115570e+00 2.0584235e+00 6.6414529e-01 1.8956918e+00 5.4586446e-01
 5.8161199e-01 1.2094715e+00 1.3651187e+00 1.1675001e+00 5.4586446e-01
 1.2871493e+00 1.1038506e+00 5.9969306e-01 1.2819116e+00 5.6641465e-01
 1.8187112e+00 2.2031176e+00 1.1675001e+00 4.9167195e-01 1.5642601e+00
 1.9816898e+00 1.5071274e+00 1.0193605e+00 1.0239407e+00 1.4919024e+00
 6.9100899e-01 5.4586446e-01 2.2323165e+00 1.6807353e+00 8.2498080e-01
 1.0718558e+00 6.1136812e-01 5.6641465e-01 1.1539158e+00 1.9049891e+00
 4.7046691e-01 6.7175281e-01 1.3631130e+00 7.8208935e-01 1.9764398e+00
 8.7539333e-01 9.0230322e-01 3.9301410e+02 6.3227403e-01 3.9301410e+02
 2.3652401e+00 1.7528008e+00 7.2290301e-01 1.5439992e+00 1.5642601e+00
 1.5439992e+00 1.1439016e+03 7.0315629e-01 8.5334510e-01 6.1092550e-01
 5.6641465e-01 1.6392728e+00 6.6414529e-01 1.4521159e+00 1.2819116e+00
 9.0230322e-01 6.8507493e-01 1.0764830e+00 9.8668402e-01 4.3728704e+00
 4.9167195e-01 4.9167195e-01 6.3227403e-01 4.6240234e-01 6.1092550e-01
 1.1736757e+00 1.2152647e+00 9.2667240e-01 5.6668162e-01 4.6240234e-01
 5.8129501e+00 1.6238817e+00 1.0946474e+00 1.0946474e+00 1.0946474e+00
 6.6414529e-01 5.5082852e-01 1.7390727e+00 9.0230322e-01 1.0946474e+00
 1.1625986e+00 1.0480425e+00 1.5947638e+00 1.0946474e+00 6.7022467e-01
 6.4524478e-01 7.6924747e-01 1.5354165e+00 1.5690809e+00 1.3901120e+00
 2.0804017e+00 1.0138409e+00 1.3901120e+00 1.3901120e+00 6.3069993e-01
 1.3770180e+00 1.7127788e+00 1.4919024e+00 1.7127788e+00 6.3069993e-01
 1.4874378e+00 3.2440430e+01 5.6641465e-01 8.2498080e-01 1.3901120e+00
 1.4774250e+00 5.4572660e-01 5.6440991e-01 1.3400381e+00 1.3901120e+00
 5.6668162e-01 8.5334516e-01 1.2094715e+00 1.5538640e+00 1.3901120e+00
 1.1270981e+00 5.6962430e-01 6.1838078e-01 1.3901122e+00 1.2481486e+00
 8.5334516e-01 5.6440991e-01 1.9714215e+00 2.1179636e+00 6.3026327e-01
 5.6641465e-01 9.4684488e-01 1.3901120e+00 1.0946474e+00 7.9381108e-01
 1.3901120e+00 3.7890835e+00 9.0230322e-01 1.3901120e+00 1.3770180e+00
 5.6641465e-01 1.8551152e+00 1.5962473e+00 6.7022467e-01 5.6962430e-01
 8.2498080e-01 1.4521159e+00 1.3770180e+00 7.6924747e-01 6.8214875e-01
 1.2382873e+00 1.5702034e+00 5.6962430e-01 6.6414529e-01 1.0946474e+00
 1.2819116e+00 1.4655049e+00 2.5484278e+00 1.8733521e+00 6.4524478e-01
 6.1136812e-01 1.6392728e+00 6.6414529e-01 6.3069993e-01 5.0371283e-01
 4.9167195e-01 8.5334516e-01 5.7982761e-01 6.1092550e-01 8.5334516e-01
 8.5334516e-01 6.1136812e-01 8.5334516e-01 1.2819116e+00 6.8248469e-01
 1.3770180e+00 1.0718558e+00 6.8684441e-01 5.6641465e-01 2.4004934e+00
 6.3026327e-01 5.3351343e-01 6.3227403e-01 1.3770180e+00 1.2819116e+00
 5.6641465e-01 8.5334516e-01 4.9167195e-01 1.7686039e+00 1.2481487e+00
 5.6641465e-01 1.5248394e+00 8.5334516e-01 1.2481487e+00 1.1489757e+00
 5.5262017e-01 1.0239407e+00 8.1334662e-01 4.6240234e-01 5.2680540e-01
 8.5334510e-01 8.5334510e-01 1.0066243e+00 3.9100171e+02 1.2066584e+00
 4.9167195e-01 1.2481487e+00 6.6414529e-01 1.5248394e+00 1.5717860e+00
 1.5071274e+00 5.5082852e-01 1.3631130e+00 1.1391730e+00 1.5248394e+00
 1.2481487e+00 6.3227403e-01 4.9167195e-01 6.3026327e-01 1.0944116e+00
 1.2094715e+00 1.8735815e+00 8.5334516e-01 8.5334516e-01 5.4572660e-01
 7.6440448e-01 1.0946474e+00 1.1675001e+00 1.7692137e+00 1.2094715e+00
 1.1489757e+00 1.1675001e+00 1.5502057e+00 1.7571361e+00 7.6440448e-01
 5.6044626e+00 1.1675001e+00 8.5334516e-01 1.2819116e+00 5.6641465e-01
 1.2094715e+00 5.6641465e-01 1.2481487e+00 1.9324244e+00 4.7046691e-01
 5.4586446e-01 1.4901308e+00 5.6641465e-01 5.6641465e-01 6.7022467e-01
 1.4901308e+00 6.6414529e-01 6.6414529e-01 2.5848317e+00 6.6414529e-01
 1.2094715e+00 1.5642601e+00 1.1736757e+00 8.5334516e-01 5.6809652e-01
 5.9139800e+00 1.7571361e+00 4.6240234e-01 1.7735887e+00 1.4521159e+00
 4.6240234e-01 1.1736757e+00 1.1736757e+00 6.7022467e-01 5.6809652e-01
 7.6679593e-01 4.7046691e-01 1.2094715e+00 6.7022467e-01 4.6240240e-01
 5.0371283e-01 1.2094715e+00 5.6809652e-01 7.6440448e-01 6.7022467e-01
 5.0264698e-01 1.7755347e+00 6.7022467e-01 5.6641465e-01 5.6641465e-01
 5.4586446e-01 6.7022467e-01 5.7982761e-01 5.5082852e-01 4.6240234e-01
 1.2094715e+00 1.5115570e+00 1.2094715e+00 3.1295922e+00 4.6240234e-01
 5.5082852e-01 4.7046691e-01 5.6641465e-01 4.6240234e-01 5.6641465e-01
 5.6641465e-01 1.3631130e+00 5.6641465e-01 1.0198998e+00 6.7022467e-01
 4.6240234e-01 6.6414529e-01 6.1092550e-01 1.1675001e+00 5.0264698e-01
 1.5887489e+00 5.5082852e-01 6.1136812e-01 6.1755222e-01 6.3227403e-01
 1.7528008e+00 4.6616209e-01 4.6616209e-01 5.1045829e-01 5.6641465e-01
 6.3227403e-01 5.6641465e-01 1.2819116e+00 1.2819116e+00 1.2819116e+00
 1.2819116e+00 5.8941064e+00 5.6641465e-01 5.2680540e-01 6.3227403e-01
 5.6641465e-01 6.3227403e-01 8.0460650e-01 1.5502057e+00 1.2819116e+00
 4.9167195e-01 2.8711484e+03 4.9167195e-01 1.5744514e+00 7.9426628e-01
 4.9167192e-01]
2025-06-06 15:07:41,823 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:07:41,938 - ERROR - An error occurred while processing file nw_graph_encoded_1749044888.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:41,939 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:41,939 - INFO - 
--- Processing file: nw_graph_encoded_1749044948.dot ---
2025-06-06 15:07:41,939 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot
2025-06-06 15:07:41,939 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot file.
2025-06-06 15:07:41,963 - INFO - Parsed 762 nodes.
2025-06-06 15:07:41,990 - INFO - Parsed 1622 edges.
2025-06-06 15:07:42,585 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:42,585 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:42,592 - DEBUG - Initial node features tensor shape: torch.Size([762, 19])
2025-06-06 15:07:42,598 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:42,603 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 19])
2025-06-06 15:07:42,604 - DEBUG - Edge index tensor shape: torch.Size([2, 1622])
2025-06-06 15:07:42,604 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:42,617 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:42,619 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:42,622 - DEBUG - Shape of encoded categorical edge features: torch.Size([1622, 2])
2025-06-06 15:07:42,623 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:42,624 - DEBUG - Shape of scaled numerical edge features: torch.Size([1622, 20])
2025-06-06 15:07:42,624 - DEBUG - Final edge attributes tensor shape: torch.Size([1622, 22])
2025-06-06 15:07:42,624 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:42,624 - INFO - Performing online update...
2025-06-06 15:07:42,624 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:42,625 - DEBUG - Updated RunningStats: new_mean=[ 4.00472385e-10 -4.56929934e-10 -2.84098445e-09  2.19466238e-09
 -2.48433144e-08  1.35225084e-08 -9.40447543e-09 -2.29791607e-09
 -2.89803157e-09  1.04315280e-09  1.55183180e-09 -1.46633648e-09
  3.60877603e-09 -3.28055353e-09  8.70956229e-10  7.38937732e-10
 -3.79863436e-09  1.11487712e-09 -4.52900079e-09], new_M2=[200022.00522103 200022.00517529 200022.0002218  200022.00436179
 200021.99846875 200021.99841832 200021.9959909  200021.99809398
 200021.99326128 200021.99846858 200022.00183043 200021.99391958
 200021.99284829 160230.99668057 160231.00008639 160230.99890008
 160231.00001859 200022.00022902 200022.00765044], new_n=200022
2025-06-06 15:07:42,626 - DEBUG - Updated RunningStats: new_mean=[ 1.41484938e+00  5.48247911e+00  1.10403968e-10  2.52876402e-10
  1.47594665e-10 -1.60519360e-10 -1.22935929e-09  2.12867507e-10
  2.87172166e-10 -1.62112104e-10  2.98488400e-10 -3.41592519e-09
 -8.54193928e-10  2.30424070e-10  2.71282590e-10 -1.47526726e-10
 -1.47526726e-10 -1.47526726e-10 -1.47526726e-10 -1.47526726e-10
 -1.47526726e-10 -8.48165182e-11], new_M2=[ 110722.63564557 1914362.01516247  429943.99902448  429944.00595869
  429944.0059016   429943.99316995  429944.00037434  429943.99915598
  429944.00167458  429943.99928363  429943.99406877  429944.00857441
  429944.00111087  429943.9998953   429944.00183483  429943.99457136
  429943.99457136  429943.99457136  429943.99457136  429943.99457136
  429943.99457136  429943.99889388], new_n=429944
2025-06-06 15:07:42,626 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89502339 0.8950234  0.89502339 0.8950234  1.
 1.00000002]
2025-06-06 15:07:42,627 - DEBUG - Calculated standard deviation: [0.50747221 2.11011482 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:42,627 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:42,627 - DEBUG - Online update step: 1/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 2/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 3/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 4/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 5/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 6/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 7/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 8/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,627 - DEBUG - Online update step: 9/50
2025-06-06 15:07:42,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 10/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 11/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 12/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 13/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 14/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 15/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 16/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 17/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 18/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 19/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 20/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 21/50
2025-06-06 15:07:42,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,628 - DEBUG - Online update step: 22/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 23/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 24/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 25/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 26/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 27/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 28/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 29/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 30/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 31/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 32/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 33/50
2025-06-06 15:07:42,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,629 - DEBUG - Online update step: 34/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 35/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 36/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 37/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 38/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 39/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 40/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 41/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 42/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 43/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 44/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 45/50
2025-06-06 15:07:42,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,630 - DEBUG - Online update step: 46/50
2025-06-06 15:07:42,631 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,631 - DEBUG - Online update step: 47/50
2025-06-06 15:07:42,631 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,631 - DEBUG - Online update step: 48/50
2025-06-06 15:07:42,631 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,631 - DEBUG - Online update step: 49/50
2025-06-06 15:07:42,631 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,631 - DEBUG - Online update step: 50/50
2025-06-06 15:07:42,631 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:42,631 - WARNING - No successful steps during online update.
2025-06-06 15:07:42,644 - DEBUG - Current node mean: [-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], current edge mean: [ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:07:42,644 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2392
2025-06-06 15:07:42,644 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:07:42,645 - DEBUG - Updated reference mean: node=[-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], edge=[ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:07:42,645 - DEBUG - Updated reference std: node=[1.0006567 1.0006567 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568], edge=[0.5059302 1.7836741 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084]
2025-06-06 15:07:42,645 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:42,645 - INFO - Running anomaly detection...
2025-06-06 15:07:42,646 - INFO - Starting anomaly detection.
2025-06-06 15:07:43,654 - DEBUG - Node reconstruction errors: [1.0296363e+00 1.0296363e+00 1.0296363e+00 8.1406915e-01 8.1406915e-01
 1.1237891e+00 8.1406915e-01 8.1406915e-01 8.1406915e-01 8.1406915e-01
 8.1406915e-01 8.1406915e-01 8.1406915e-01 8.1406915e-01 1.0332489e+00
 8.1406915e-01 8.1406915e-01 8.1406915e-01 1.7632079e+00 4.0254950e+02
 8.1406915e-01 6.9824582e-01 6.5381259e-01 1.8001494e+00 6.5381259e-01
 8.5516649e-01 1.8001494e+00 5.6660491e-01 5.6660491e-01 7.2167766e-01
 5.6660491e-01 7.2167766e-01 5.6660491e-01 8.1406915e-01 5.6660491e-01
 5.6660491e-01 5.6726402e-01 5.6660491e-01 5.6660491e-01 4.5659337e+00
 6.0308200e-01 2.2749054e+00 5.6660491e-01 5.6660491e-01 5.6660491e-01
 1.4776878e+00 5.6660491e-01 5.6660491e-01 8.1406915e-01 5.6660491e-01
 1.5004216e+00 1.3515596e+00 5.4626542e-01 5.4626542e-01 5.4626542e-01
 5.3900689e-01 8.5516649e-01 5.4626542e-01 6.4705843e-01 6.4705843e-01
 8.1406915e-01 1.4950484e+00 6.4705843e-01 6.4705843e-01 5.4626542e-01
 1.9456584e+00 1.3515596e+00 1.3515596e+00 5.4626542e-01 6.4705843e-01
 5.4626542e-01 1.3645238e+00 6.4705843e-01 5.3900689e-01 6.4705843e-01
 6.4705843e-01 5.0331259e-01 5.4626542e-01 5.4626542e-01 4.4536886e+00
 5.4626542e-01 5.4626542e-01 5.4626542e-01 5.4626542e-01 5.4626542e-01
 5.4626542e-01 5.4626542e-01 1.3551658e+00 5.1482081e-01 5.9950024e-01
 5.1447701e-01 5.9950024e-01 5.9950024e-01 6.5381259e-01 5.9950024e-01
 5.9950024e-01 5.9950024e-01 5.9950024e-01 5.9950024e-01 5.9950024e-01
 1.2567161e+00 5.1447701e-01 5.9950024e-01 5.0185215e-01 1.2567161e+00
 5.9950024e-01 6.8262529e-01 5.1542759e-01 5.9950024e-01 4.5849821e-01
 1.2975068e+00 5.1562434e-01 6.4171267e-01 4.5849821e-01 5.1562434e-01
 5.9950024e-01 5.9950024e-01 5.1447701e-01 5.9950024e-01 5.9950024e-01
 5.1482081e-01 5.4626542e-01 6.8262529e-01 5.4626542e-01 5.9950024e-01
 8.1406915e-01 5.9950024e-01 5.1447701e-01 5.9950024e-01 5.9950024e-01
 5.9950024e-01 5.1482081e-01 5.1447701e-01 5.9950024e-01 5.9950024e-01
 1.2567161e+00 5.0185215e-01 5.1447701e-01 5.9950024e-01 5.1447701e-01
 5.9950024e-01 5.9950024e-01 5.9950024e-01 5.8977062e-01 1.2374010e+00
 5.1447701e-01 5.1447701e-01 1.1035076e+00 1.6039106e+00 1.7765539e+00
 5.9768468e-01 5.1482081e-01 2.1020215e+00 1.2374010e+00 1.5548222e+00
 2.9611021e+03 6.5381259e-01 1.2913539e+00 8.1406915e-01 1.6371113e+00
 1.2614292e+00 7.7141416e-01 8.9419276e-01 1.5465841e+00 7.7141416e-01
 1.6743565e+00 6.6703945e-01 1.0041468e+00 6.8103862e-01 1.1826979e+00
 6.9952661e-01 1.4431934e+00 7.0974517e-01 3.5014439e+00 5.9043539e-01
 5.4626542e-01 9.2761946e-01 6.8103862e-01 1.0023485e+00 7.0974517e-01
 1.5553063e+00 1.7345079e+00 1.0041468e+00 9.8714620e-01 5.9583080e-01
 1.5073172e+00 5.9950024e-01 1.0041468e+00 5.9768468e-01 1.0041468e+00
 2.0530777e+01 1.6371113e+00 8.2852632e-01 6.4820784e-01 2.9231515e+00
 1.5207976e+00 1.2984835e+00 1.5218030e+00 6.5381259e-01 8.7293124e-01
 1.8657251e+01 3.5014439e+00 1.0189205e+00 1.8696703e+00 1.2984835e+00
 5.9950024e-01 1.7380729e+00 5.7374883e-01 7.8331548e-01 1.2516292e+00
 7.0974517e-01 1.9416959e+00 5.6660491e-01 9.0595929e+02 1.1182562e+00
 1.2374010e+00 7.7141416e-01 6.8672162e-01 2.6374879e+00 1.6793911e+00
 6.5381259e-01 5.9950024e-01 8.7293124e-01 5.1447701e-01 8.7293124e-01
 2.4154873e+00 2.9231515e+00 1.5147492e+00 1.5073172e+00 1.6115321e+00
 1.6546880e+00 5.1482081e-01 8.9205569e-01 1.3519195e+00 1.7666250e+01
 9.4550705e-01 5.7576327e+00 5.1447701e-01 1.3644561e+00 8.2852632e-01
 8.9419276e-01 1.5073172e+00 1.2567161e+00 1.6793911e+00 5.4514933e-01
 1.1844279e+00 1.6793911e+00 6.8103862e-01 5.6660491e-01 1.6793911e+00
 6.8510520e-01 1.9416959e+00 1.3644561e+00 1.0041468e+00 1.5469196e+00
 5.1447701e-01 1.1826979e+00 2.1013513e+00 5.1447701e-01 1.7380729e+00
 1.4536884e+00 5.7986021e-01 1.3844908e+00 1.5073172e+00 1.9870735e+00
 1.1649455e+00 5.4626542e-01 5.4626542e-01 1.2211748e+00 1.5218030e+00
 1.0041468e+00 2.4154873e+00 1.1467527e+00 2.2232316e+00 4.0973633e+03
 2.0243912e+01 2.4841383e+00 6.6703945e-01 2.1130784e+00 1.6504253e+00
 5.4626542e-01 1.2567161e+00 1.9566210e+01 5.9950024e-01 8.7293124e-01
 2.9231515e+00 1.4948560e+00 8.9419276e-01 8.9419276e-01 2.6383009e+00
 5.4626542e-01 7.7141416e-01 2.8363218e+03 4.6875674e-01 1.7380729e+00
 9.4635344e-01 1.1594148e+00 1.1182562e+00 1.0784102e+03 1.3644561e+00
 8.5516649e-01 1.8079449e+00 9.4987459e+00 1.4289393e+00 6.8672174e-01
 4.1716509e+00 1.3182369e+00 1.1122209e+00 5.9950024e-01 1.7144257e+00
 1.4431934e+00 5.9043539e-01 2.0919259e+00 5.9043539e-01 6.4171267e-01
 1.2984835e+00 5.1992643e-01 2.9231515e+00 2.9231515e+00 2.4154873e+00
 2.9231515e+00 6.8672162e-01 8.7293124e-01 1.5985420e+00 2.9231515e+00
 5.0648844e-01 2.3776586e+00 2.6045291e+00 9.4635344e-01 2.9231515e+00
 2.0158691e+00 2.4220014e+00 2.8179901e+00 8.0162412e-01 1.0493243e+00
 1.9782645e+00 1.5073172e+00 1.1826979e+00 1.3644561e+00 1.1076791e+00
 1.6573366e+00 1.1182562e+00 6.8103862e-01 1.4898449e+00 2.9249189e+00
 8.7939557e+02 9.4550705e-01 1.9870735e+00 1.6487907e+00 8.0511087e-01
 3.5014439e+00 1.5073172e+00 2.2372530e+00 8.7293124e-01 9.8908603e-01
 1.9883947e+00 1.4494845e+00 1.0041468e+00 8.1406915e-01 1.2513300e+00
 1.1182562e+00 1.6793911e+00 1.3519195e+00 6.3460332e-01 5.1992643e-01
 5.9950024e-01 5.6660491e-01 8.7293124e-01 2.9231515e+00 1.8645887e+00
 5.1447701e-01 3.5014439e+00 1.4411026e+00 5.9950024e-01 2.9231515e+00
 1.5578778e+00 1.9647208e+00 1.2567161e+00 3.5014439e+00 3.5014439e+00
 1.2861083e+00 4.6390709e-01 1.6487907e+00 1.0078804e+00 6.9952661e-01
 1.3645238e+00 6.6703945e-01 1.3414901e+00 5.9950024e-01 2.2079921e+00
 1.0041468e+00 5.9768468e-01 5.6660491e-01 1.2611418e+00 6.4287853e-01
 2.9231515e+00 7.7141416e-01 1.4176644e+00 1.5886716e+00 1.6499598e+00
 6.6703945e-01 2.4568813e+00 1.1035076e+00 7.7141416e-01 5.0648844e-01
 1.0078804e+00 1.1182562e+00 1.5371575e+00 1.9870735e+00 8.9492655e-01
 1.9955950e+00 1.0078804e+00 1.0332489e+00 6.5368748e-01 5.9950024e-01
 8.6159354e-01 1.6042038e+00 1.9870735e+00 6.8672162e-01 1.9282098e+00
 5.4626542e-01 5.9768468e-01 1.2288837e+00 1.8392884e+00 1.1482264e+00
 5.4626542e-01 1.3519195e+00 1.1342465e+00 5.8977062e-01 1.2567161e+00
 5.9950024e-01 1.7853205e+00 2.2251930e+00 1.1482264e+00 5.1447701e-01
 1.6039106e+00 2.0107791e+00 1.5263680e+00 1.0258261e+00 1.0189205e+00
 1.5469196e+00 8.0404037e-01 5.4626542e-01 2.2735627e+00 1.6487907e+00
 8.7293124e-01 1.0731063e+00 5.6660491e-01 5.9950024e-01 1.2211748e+00
 1.9955950e+00 5.0648844e-01 6.4705843e-01 1.3644561e+00 8.0404037e-01
 2.0207207e+00 9.0170920e-01 9.4635344e-01 4.0864999e+02 1.3511400e+00
 4.0864999e+02 2.4520240e+00 1.8172728e+00 7.7141416e-01 1.5985420e+00
 1.6039106e+00 1.5985420e+00 1.1832201e+03 6.7884606e-01 8.9419276e-01
 6.4192986e-01 5.9950024e-01 1.6793911e+00 6.8672162e-01 1.5073172e+00
 1.2567161e+00 9.4635344e-01 7.2320485e-01 1.1122209e+00 1.0078804e+00
 4.1716509e+00 5.1482081e-01 5.1447701e-01 6.4171267e-01 4.6875674e-01
 6.4192986e-01 1.1732086e+00 2.1980674e+00 9.4550705e-01 5.9796983e-01
 4.6875674e-01 5.9085088e+00 1.6820678e+00 1.1182562e+00 1.1182562e+00
 1.1182562e+00 6.8672162e-01 5.9614772e-01 1.7765539e+00 9.4635344e-01
 1.1182562e+00 1.1826979e+00 1.0948474e+00 1.6721832e+00 1.1182562e+00
 7.1441841e-01 6.8200159e-01 8.0010694e-01 1.5371575e+00 1.9323237e+00
 1.4431934e+00 2.1576018e+00 1.0493243e+00 1.4431934e+00 1.4431934e+00
 5.7188624e-01 1.4176644e+00 1.7843720e+00 1.5469196e+00 1.7843720e+00
 5.7188624e-01 1.4948560e+00 3.2699551e+01 5.9950024e-01 8.7293124e-01
 1.4431934e+00 1.5548222e+00 5.2472115e-01 6.1365074e-01 1.4285095e+00
 1.4431934e+00 5.9796983e-01 8.9419276e-01 1.2288840e+00 1.5547510e+00
 1.4431934e+00 1.1826799e+00 6.1098868e-01 6.3460332e-01 1.4431934e+00
 1.2913539e+00 8.9419276e-01 6.1365074e-01 1.9985443e+00 2.1502154e+00
 6.8103862e-01 5.9950024e-01 9.6745962e-01 1.4431934e+00 1.1182562e+00
 8.1799299e-01 1.4431934e+00 3.5014439e+00 9.4635344e-01 1.4431934e+00
 1.4176644e+00 5.9950024e-01 1.9258094e+00 1.5631305e+00 7.1441841e-01
 6.5368748e-01 8.7293124e-01 1.1844279e+00 1.4176644e+00 8.0010694e-01
 6.6612864e-01 1.2984835e+00 1.6231900e+00 6.1098868e-01 6.8672162e-01
 1.1182562e+00 1.2567161e+00 1.3645238e+00 2.4154873e+00 1.9269298e+00
 6.8200159e-01 5.6660491e-01 1.6793911e+00 6.8672162e-01 1.7632079e+00
 6.5368748e-01 5.4514933e-01 5.1447701e-01 8.9419276e-01 1.0296363e+00
 6.4820784e-01 7.0974517e-01 8.9419276e-01 8.9419276e-01 5.6660491e-01
 8.9419276e-01 1.2567161e+00 6.8510520e-01 1.4176644e+00 1.0731063e+00
 7.4059582e-01 5.9950024e-01 2.3776586e+00 6.8103862e-01 5.5258733e-01
 6.4171267e-01 1.4176644e+00 1.2567161e+00 6.0448188e-01 8.9419276e-01
 5.1447701e-01 1.7288322e+00 1.2913539e+00 5.1482081e-01 2.0453711e+00
 8.9419276e-01 1.2913539e+00 1.1859831e+00 5.8179933e-01 1.0189205e+00
 7.6065552e-01 4.6875674e-01 5.0185215e-01 8.9419276e-01 8.9419276e-01
 8.1406915e-01 1.0215744e+00 4.0667471e+02 1.6809506e+00 5.1447701e-01
 1.2913539e+00 6.8672162e-01 2.0453711e+00 1.5439736e+00 1.5263680e+00
 5.9614772e-01 1.3644561e+00 1.1213629e+00 1.5147492e+00 1.2913539e+00
 6.4171267e-01 5.1447701e-01 6.8103862e-01 1.1125358e+00 1.2288837e+00
 2.0008969e+00 8.9419276e-01 8.9419276e-01 5.2472115e-01 7.9345304e-01
 1.1182562e+00 1.1482264e+00 1.7726370e+00 1.2288837e+00 1.1859831e+00
 1.1732086e+00 1.6097912e+00 1.8047154e+00 7.9345304e-01 5.7062616e+00
 1.1482264e+00 8.9419276e-01 1.2567161e+00 5.1482081e-01 1.2288837e+00
 5.1482081e-01 1.2913539e+00 2.0158691e+00 5.0648844e-01 5.4626542e-01
 1.5578778e+00 5.9950024e-01 5.9950024e-01 7.1441841e-01 1.5578778e+00
 6.8672162e-01 6.8672162e-01 2.6623046e+00 6.8672162e-01 8.1406915e-01
 1.2288837e+00 1.6039106e+00 1.1731275e+00 8.9419276e-01 5.3900200e-01
 5.8496718e+00 1.8047154e+00 4.6875674e-01 1.7345079e+00 1.5073173e+00
 4.6875674e-01 1.1731277e+00 1.1731275e+00 5.1992643e-01 5.3900200e-01
 6.5381259e-01 5.0648844e-01 1.2288837e+00 7.1441841e-01 4.6875674e-01
 5.4514933e-01 1.2288837e+00 8.1406915e-01 5.3900200e-01 7.9345304e-01
 7.1441841e-01 4.7571093e-01 1.7101296e+00 7.1441841e-01 5.9950024e-01
 5.9950024e-01 5.3900689e-01 7.1441841e-01 5.9583080e-01 5.9614772e-01
 4.6875674e-01 1.2288837e+00 1.5684662e+00 1.2288837e+00 2.9231515e+00
 4.6875674e-01 5.9614772e-01 5.0648844e-01 5.9950024e-01 4.6875674e-01
 5.9950024e-01 5.9950024e-01 1.3644561e+00 5.9950024e-01 1.0346982e+00
 7.1441841e-01 4.6875674e-01 8.5003966e-01 6.4192986e-01 1.1732086e+00
 4.7571093e-01 1.6573366e+00 5.1992643e-01 5.6660491e-01 5.7986021e-01
 6.4171267e-01 1.8172728e+00 5.1482081e-01 4.6390709e-01 5.1482081e-01
 5.9950024e-01 6.4171267e-01 5.9950024e-01 1.2567161e+00 1.2567161e+00
 1.2567161e+00 1.2567161e+00 6.0623069e+00 5.9950024e-01 5.0185215e-01
 6.4171267e-01 5.9950024e-01 6.4171267e-01 7.9238641e-01 1.6097912e+00
 1.2567161e+00 5.1482081e-01 2.9760225e+03 5.1447701e-01 1.4776881e+00
 8.2200795e-01 5.1482081e-01]
2025-06-06 15:07:43,655 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 ... 0.8 0.8 0.8]
2025-06-06 15:07:43,686 - ERROR - An error occurred while processing file nw_graph_encoded_1749044948.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:43,687 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:43,687 - INFO - 
--- Processing file: nw_graph_encoded_1749045008.dot ---
2025-06-06 15:07:43,688 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot
2025-06-06 15:07:43,688 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot file.
2025-06-06 15:07:43,714 - INFO - Parsed 780 nodes.
2025-06-06 15:07:43,740 - INFO - Parsed 1667 edges.
2025-06-06 15:07:44,368 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:44,368 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:44,375 - DEBUG - Initial node features tensor shape: torch.Size([780, 19])
2025-06-06 15:07:44,385 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:44,397 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 19])
2025-06-06 15:07:44,399 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-06 15:07:44,399 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:44,424 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:44,429 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:44,436 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 2])
2025-06-06 15:07:44,438 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:44,446 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 20])
2025-06-06 15:07:44,452 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 22])
2025-06-06 15:07:44,452 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:44,452 - INFO - Performing online update...
2025-06-06 15:07:44,452 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:44,453 - DEBUG - Updated RunningStats: new_mean=[ 3.79548433e-10 -4.35786677e-10 -2.77221486e-09  2.20880799e-09
 -2.47438441e-08  1.32834218e-08 -9.45536176e-09 -2.26780354e-09
 -2.90948211e-09  1.03757949e-09  1.62290618e-09 -1.47622434e-09
  3.64811374e-09 -3.28675212e-09  9.01708852e-10  7.22338862e-10
 -3.79055760e-09  1.10423877e-09 -4.52276210e-09], new_M2=[200802.00518506 200802.00513933 200802.00021946 200802.0043736
 200801.99851081 200801.99841226 200801.99596202 200801.9981499
 200801.99324002 200801.99847109 200802.00180773 200801.99390838
 200801.99279524 161010.99668005 161011.00007069 161010.9988851
 161011.00001019 200802.00022791 200802.00766592], new_n=200802
2025-06-06 15:07:44,454 - DEBUG - Updated RunningStats: new_mean=[ 1.41486894e+00  5.48051602e+00  1.04286204e-10  2.50319284e-10
  1.43734671e-10 -1.64973415e-10 -1.22099449e-09  2.20862525e-10
  2.66911632e-10 -1.54253096e-10  2.97760639e-10 -3.37450249e-09
 -8.52343478e-10  1.72085313e-10  2.67999360e-10 -1.47789032e-10
 -1.47789032e-10 -1.47789032e-10 -1.47789032e-10 -1.47789032e-10
 -1.47789032e-10 -8.57438188e-11], new_M2=[ 111148.73706185 1920104.89947201  431610.99901509  431611.00588924
  431611.00579739  431610.99303266  431611.00036139  431610.99917805
  431611.00167418  431610.99926964  431610.99404185  431611.00850619
  431611.00111115  431610.99994908  431611.00181738  431610.99455598
  431610.99455598  431610.99455598  431610.99455598  431610.99455598
  431610.99455598  431610.99889564], new_n=431611
2025-06-06 15:07:44,454 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89545497 0.89545498 0.89545498 0.89545498 1.
 1.00000002]
2025-06-06 15:07:44,455 - DEBUG - Calculated standard deviation: [0.50746491 2.10919254 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:44,459 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:44,459 - DEBUG - Online update step: 1/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 2/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 3/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 4/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 5/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 6/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 7/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 8/50
2025-06-06 15:07:44,459 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,459 - DEBUG - Online update step: 9/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 10/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 11/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 12/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 13/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 14/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 15/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 16/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 17/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 18/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 19/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 20/50
2025-06-06 15:07:44,460 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,460 - DEBUG - Online update step: 21/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 22/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 23/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 24/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 25/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 26/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 27/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 28/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 29/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 30/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 31/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 32/50
2025-06-06 15:07:44,461 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,461 - DEBUG - Online update step: 33/50
2025-06-06 15:07:44,462 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,462 - DEBUG - Online update step: 34/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 35/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 36/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 37/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 38/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 39/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 40/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 41/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 42/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 43/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,466 - DEBUG - Online update step: 44/50
2025-06-06 15:07:44,466 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 45/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 46/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 47/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 48/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 49/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - DEBUG - Online update step: 50/50
2025-06-06 15:07:44,467 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:07:44,467 - WARNING - No successful steps during online update.
2025-06-06 15:07:44,486 - DEBUG - Current node mean: [-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], current edge mean: [ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:07:44,486 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2400
2025-06-06 15:07:44,487 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:07:44,487 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:07:44,487 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:07:44,487 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:07:44,487 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:07:44,488 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:07:44,493 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:07:44,493 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:07:44,493 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:07:44,493 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:07:44,493 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:07:44,494 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:07:44,494 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:07:44,494 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:07:44,494 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:07:44,494 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:07:44,495 - INFO - Optimizer and scheduler reset.
2025-06-06 15:07:44,495 - DEBUG - Updated reference mean: node=[-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], edge=[ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:07:44,496 - DEBUG - Updated reference std: node=[1.0006416 1.0006416 1.0006416 1.0006417 1.0006417 1.0006416 1.0006416
 1.0006417 1.0006416 1.0006417 1.0006416 1.0006416 1.0006416 1.0006416
 1.0006416 1.0006416 1.0006416 1.0006416 1.0006417], edge=[0.505705 1.785948 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003  ]
2025-06-06 15:07:44,496 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:07:44,496 - INFO - Running anomaly detection...
2025-06-06 15:07:44,496 - INFO - Starting anomaly detection.
2025-06-06 15:07:45,105 - DEBUG - Node reconstruction errors: [4.6684594e+00 1.0969391e+00 1.1784455e+00 1.0969391e+00 1.0969391e+00
 1.0969391e+00 1.0969391e+00 8.2066208e-01 9.4464391e-01 1.0413643e+00
 8.2066208e-01 8.2066208e-01 8.2066208e-01 1.0958319e+00 8.2066208e-01
 8.2066208e-01 8.2066208e-01 2.0890384e+00 2.5608706e+00 2.0890384e+00
 8.2066208e-01 8.2066208e-01 3.6147032e+00 6.9291296e+02 8.2066208e-01
 8.3087617e-01 6.0205311e-01 1.9064084e+00 6.0205311e-01 1.9064084e+00
 1.9064084e+00 4.3723047e-01 4.3723047e-01 5.3548634e-01 4.3723047e-01
 5.3548634e-01 4.3723047e-01 9.4464391e-01 4.3723047e-01 4.3723047e-01
 5.1093268e-01 4.3723047e-01 4.3723047e-01 3.1191385e+00 6.1320674e-01
 2.2032325e+00 4.3723047e-01 4.3723047e-01 4.3723047e-01 1.3992476e+00
 4.3723047e-01 4.3723047e-01 8.2066208e-01 4.3723047e-01 1.7820776e+00
 1.3060786e+00 3.3659074e-01 3.3659074e-01 3.3659074e-01 6.8469507e-01
 6.8182474e-01 3.3659074e-01 4.3875849e-01 4.3875849e-01 8.2066208e-01
 2.5336094e+00 4.3875849e-01 4.3875849e-01 3.3659074e-01 1.8850170e+00
 1.3060786e+00 1.3060786e+00 3.3659074e-01 4.3875849e-01 3.3659074e-01
 1.4231288e+00 4.3875846e-01 5.5886739e-01 4.3875849e-01 4.3875849e-01
 3.6158299e-01 6.8469507e-01 3.3659074e-01 3.0607069e+00 3.3659074e-01
 3.3659074e-01 3.3659074e-01 3.3659074e-01 3.3659074e-01 3.3659074e-01
 3.3659074e-01 1.0969391e+00 1.2284740e+00 5.2981675e-01 2.7782807e-01
 3.0903196e-01 2.7782807e-01 2.7782807e-01 6.0205311e-01 2.7782807e-01
 2.7782807e-01 2.7782807e-01 2.7782807e-01 2.7782807e-01 2.7782807e-01
 1.1510756e+00 3.0903196e-01 2.7782807e-01 3.8718995e-01 1.9425005e+00
 2.7782807e-01 7.5780469e-01 2.8937501e-01 2.7782807e-01 3.3396488e-01
 1.4843357e+00 2.8938603e-01 3.8519564e-01 3.3396488e-01 2.8938603e-01
 2.7782807e-01 2.7782807e-01 3.0903196e-01 2.7782807e-01 2.7782807e-01
 5.2981675e-01 3.3659074e-01 9.0845329e-01 3.3659074e-01 2.7782807e-01
 2.0890384e+00 2.7782807e-01 3.0903196e-01 2.7782807e-01 2.7782807e-01
 2.7782807e-01 5.2981675e-01 3.0903196e-01 2.7782807e-01 2.7782807e-01
 1.1510756e+00 1.0969391e+00 3.8718995e-01 3.0903196e-01 2.7782807e-01
 1.0969391e+00 3.0903196e-01 2.7782807e-01 2.7782807e-01 2.7782807e-01
 4.1158223e-01 1.2381546e+00 3.0903196e-01 3.0903196e-01 1.1655118e+00
 1.0969390e+00 1.0287119e+00 1.1112242e+00 8.0029976e-01 5.2981675e-01
 1.3751498e+00 1.2381546e+00 2.1158488e+00 1.9255814e+03 6.0205311e-01
 1.0079331e+00 8.2066208e-01 1.8099142e+00 4.4649389e-01 3.5741141e-01
 1.1784455e+00 2.7907953e-01 1.0021266e+00 3.5741141e-01 1.8283585e+00
 7.3925447e-01 3.4891978e-01 3.1617144e-01 1.4303614e+00 3.7623721e-01
 7.3925447e-01 1.0078436e+00 6.8891567e-01 1.4787537e+00 5.4478621e-01
 3.3659074e-01 1.0130478e+00 3.1617144e-01 9.6008301e-01 6.8891567e-01
 1.7609339e+00 1.6140274e+00 3.4891978e-01 8.8428175e-01 3.8230830e-01
 1.0282935e+00 2.7782807e-01 3.4891978e-01 5.1248580e-01 3.4891978e-01
 9.9802980e+00 1.4622357e+00 5.0726265e-01 6.1401993e-01 1.1712162e+00
 2.4034896e+00 1.0030024e+00 1.8099142e+00 8.3087617e-01 3.4382167e-01
 6.9354682e+00 1.4787537e+00 1.4392459e+00 2.1468439e+00 1.0030024e+00
 2.7782807e-01 1.4062213e+00 4.0528649e-01 3.0112097e-01 2.5036020e+00
 6.8891567e-01 1.7470087e+00 4.3723047e-01 1.8013810e+03 3.3681956e-01
 1.2381546e+00 3.5741141e-01 3.7326390e-01 1.7392582e+00 1.0576211e+00
 6.0205311e-01 2.7782807e-01 3.4382164e-01 3.0903193e-01 3.4382167e-01
 9.1565245e-01 1.1712162e+00 1.4162525e+00 1.0282935e+00 1.9360604e+00
 1.9680954e+00 5.2981675e-01 8.7377375e-01 1.0229651e+00 7.4051628e+00
 4.4934213e-01 4.4921117e+00 3.0903196e-01 4.2085969e-01 5.0726265e-01
 2.7907953e-01 1.0282935e+00 1.6152936e+00 1.0576211e+00 3.1510338e-01
 1.4057013e+00 1.0576211e+00 3.1617144e-01 4.3723047e-01 1.0576211e+00
 7.4723786e-01 1.7470087e+00 4.2085969e-01 3.4891978e-01 1.6789614e+00
 4.6342454e+00 3.0903196e-01 3.7623721e-01 1.8918923e+00 3.0903196e-01
 1.4062213e+00 4.8818633e-01 4.5917884e-01 2.3083081e+00 1.0282935e+00
 7.0481509e-01 1.3911365e+00 3.3659074e-01 3.3659074e-01 1.0510705e+00
 1.4645650e+00 3.4891978e-01 9.1565245e-01 6.4915490e-01 1.8813583e+00
 2.4544531e+03 7.2897000e+00 1.7520597e+00 4.4870311e-01 1.3386310e+00
 7.3946995e-01 3.3659074e-01 1.1510756e+00 4.6648326e+00 2.7782807e-01
 3.4382167e-01 1.1712162e+00 1.4352576e+00 2.7907953e-01 2.7907953e-01
 1.0275122e+00 3.3659074e-01 3.5741141e-01 1.8941761e+03 3.5335037e-01
 1.4062213e+00 3.0662495e-01 1.1638886e+00 3.3681956e-01 2.2682808e+03
 4.2085963e-01 1.9064082e+00 1.2720649e+00 4.4590831e+00 7.4965090e-01
 3.7326390e-01 2.4606595e+00 2.7245657e+00 1.2088538e+00 2.7782807e-01
 1.6280781e+00 1.0078436e+00 5.4478621e-01 1.7583132e+00 5.4478621e-01
 3.8519564e-01 1.0030024e+00 5.2104425e-01 1.1712162e+00 1.1712162e+00
 9.1565245e-01 1.1712162e+00 3.7326390e-01 3.4382167e-01 1.0781904e+00
 1.1712162e+00 3.0241042e-01 1.3610424e+00 1.9409324e+00 3.0662495e-01
 1.1712162e+00 1.3662261e+00 2.0032139e+00 1.9203162e+00 9.2951506e-01
 1.1770370e+00 1.6886703e+00 1.0282935e+00 3.7623721e-01 4.2085969e-01
 1.4756314e+00 1.3127030e+00 3.3681956e-01 3.1617144e-01 2.8206480e+00
 2.5016279e+00 1.7292665e+03 4.4934213e-01 7.0481509e-01 5.4049158e-01
 7.1814770e-01 1.4787537e+00 1.0282935e+00 1.2210124e+00 3.4382167e-01
 4.1351962e-01 2.0890384e+00 3.1374245e+00 3.4891978e-01 8.2066208e-01
 8.6723280e-01 3.3681956e-01 1.0576211e+00 1.0229651e+00 6.1270982e-01
 5.2104425e-01 2.7782807e-01 4.3723047e-01 3.4382167e-01 1.1712162e+00
 1.3745269e+00 3.0903196e-01 1.4787537e+00 2.6910396e+00 2.7782807e-01
 1.1712162e+00 3.1953185e+00 1.6325963e+00 1.1510756e+00 1.4787537e+00
 1.4787537e+00 1.0971659e+00 3.5947922e-01 5.4049158e-01 6.6001749e-01
 7.3925447e-01 1.4231288e+00 4.4870311e-01 1.1837777e+00 2.7782807e-01
 1.8249547e+00 3.4891978e-01 5.1248580e-01 4.3723047e-01 1.2214305e+00
 4.8712707e-01 1.1712162e+00 3.5741141e-01 1.0021639e+00 1.6490434e+00
 1.4493630e+00 4.4870311e-01 2.0548747e+00 1.1655118e+00 3.5741141e-01
 3.0241042e-01 6.6001749e-01 3.3681956e-01 1.7876246e+00 7.0481509e-01
 9.4464391e-01 1.4145173e+00 6.6001749e-01 1.0413643e+00 6.3551694e-01
 2.7782807e-01 9.6257001e-01 1.8283585e+00 7.0481509e-01 3.7326390e-01
 1.1976433e+00 3.3659074e-01 5.1248580e-01 1.0577493e+00 1.8353745e+00
 1.1988736e+00 3.3659074e-01 1.4318054e+00 5.0406408e-01 4.1158223e-01
 1.1510756e+00 2.7782807e-01 7.5598568e-01 1.9530660e+00 1.1988736e+00
 3.0903196e-01 1.0287119e+00 1.4392120e+00 1.3268265e+00 1.3248119e+00
 1.4392459e+00 1.8099142e+00 7.5950152e-01 3.3659074e-01 2.3646259e+00
 5.4049158e-01 3.4382167e-01 1.1754684e+00 4.3723047e-01 2.7782807e-01
 1.4318054e+00 1.4145173e+00 3.0241042e-01 4.3875849e-01 4.2085969e-01
 7.5950152e-01 1.8602110e+00 5.7935095e-01 3.0662495e-01 6.8307892e+02
 1.6152936e+00 6.8307892e+02 1.6006131e+00 1.8840940e+00 3.5741141e-01
 1.0781904e+00 1.0287119e+00 1.0781904e+00 9.7829791e+02 8.7377375e-01
 2.7907953e-01 4.9701029e-01 2.7782807e-01 1.0576211e+00 3.7326390e-01
 1.0282935e+00 1.1510756e+00 3.0662495e-01 4.9809557e-01 1.2088538e+00
 6.6001749e-01 2.4606595e+00 5.2981675e-01 3.0903196e-01 3.8519564e-01
 3.5335037e-01 4.9701029e-01 1.2428581e+00 1.4142395e+00 2.9422359e+00
 4.4934213e-01 4.3885452e-01 3.5335037e-01 4.1450491e+00 1.4042767e+00
 3.3681956e-01 3.3681956e-01 3.3681956e-01 3.7326390e-01 2.7143815e-01
 1.1112242e+00 3.0662495e-01 3.3681956e-01 3.7623721e-01 1.0893290e+00
 1.8983347e+00 3.3681956e-01 2.5938663e-01 4.4181386e-01 4.3761745e-01
 1.6467584e+00 1.9883469e+00 1.0078436e+00 1.5502542e+00 1.1770370e+00
 1.0078436e+00 1.0078436e+00 5.4620510e-01 1.0021639e+00 1.3719646e+00
 1.8099142e+00 1.3719646e+00 5.4620510e-01 1.4352576e+00 5.0034706e+01
 2.7782807e-01 3.4382167e-01 1.0078436e+00 1.0969391e+00 2.1158488e+00
 4.5465323e-01 2.8562680e-01 2.3254097e+00 1.0078436e+00 4.3885446e-01
 2.7907953e-01 1.0577493e+00 1.6510915e+00 1.0078436e+00 1.0309843e+00
 6.9949418e-01 6.1270982e-01 1.0078436e+00 1.0079331e+00 2.7907953e-01
 2.8562680e-01 2.3122108e+00 2.2419853e+00 3.1617144e-01 2.7782807e-01
 5.4313141e-01 1.0078436e+00 3.3681956e-01 9.3983459e-01 1.0078436e+00
 1.4787537e+00 3.0662495e-01 1.0078436e+00 1.0021639e+00 2.7782807e-01
 1.3614097e+00 1.4204614e+00 2.5938663e-01 7.4775010e-01 3.4382167e-01
 1.4057013e+00 1.0021639e+00 4.3761745e-01 7.4410522e-01 1.0030024e+00
 1.4205925e+00 3.5091686e-01 3.7326390e-01 3.3681956e-01 1.1510756e+00
 1.4231288e+00 9.1565245e-01 1.3794494e+00 1.4303614e+00 4.4181386e-01
 4.3723047e-01 1.0576211e+00 3.7326390e-01 3.6147032e+00 7.4775010e-01
 3.1510338e-01 3.0903196e-01 2.7907953e-01 1.0969391e+00 7.3358834e-01
 6.8891567e-01 2.7907953e-01 2.7907953e-01 4.3723047e-01 2.7907953e-01
 1.1510756e+00 7.4723786e-01 1.0021639e+00 1.1754684e+00 2.7137130e-01
 2.7782807e-01 1.3610424e+00 3.1617144e-01 4.4906008e-01 3.8519564e-01
 1.0021639e+00 1.1510756e+00 6.5623766e-01 2.7907953e-01 3.0903196e-01
 1.7203906e+00 1.0079331e+00 5.2981675e-01 2.1690421e+00 2.7907953e-01
 1.0079331e+00 1.0326308e+00 4.0102437e-01 1.7733090e+00 1.0219916e+00
 3.5335037e-01 3.8718995e-01 2.7907953e-01 2.7907953e-01 9.4464391e-01
 1.4318054e+00 6.6462018e+02 1.7890677e+00 3.0903196e-01 1.0079331e+00
 3.7326390e-01 1.8416451e+00 1.7490718e+00 1.3268265e+00 2.7143815e-01
 4.2085969e-01 1.1311916e+00 1.4162525e+00 1.0079331e+00 3.8519564e-01
 3.0903196e-01 3.1617144e-01 1.0935301e+00 1.0577493e+00 1.9615719e+00
 2.7907953e-01 2.7907953e-01 4.5465323e-01 3.9545026e-01 3.3681956e-01
 1.1988736e+00 1.4709548e+00 1.0577493e+00 1.0326308e+00 1.4142395e+00
 1.2781712e+00 1.3902681e+00 3.9545026e-01 4.5325055e+00 1.1988736e+00
 2.7907953e-01 1.1510756e+00 5.2981675e-01 1.0577493e+00 5.2981675e-01
 1.0079331e+00 1.3662261e+00 3.0241042e-01 3.3659074e-01 2.1035123e+00
 2.7782807e-01 2.7782807e-01 2.5938663e-01 2.1035123e+00 3.7326390e-01
 3.7326390e-01 1.0969391e+00 1.7352265e+00 3.7326390e-01 9.4464391e-01
 1.0577493e+00 1.0287119e+00 1.1142644e+00 2.7907953e-01 7.3358834e-01
 1.4303614e+00 4.9050426e+00 1.3902681e+00 6.4958245e-01 1.8549253e+00
 1.0282936e+00 3.5335040e-01 1.5348769e+00 1.1142644e+00 5.2104425e-01
 4.4741625e-01 6.0205311e-01 8.0518520e-01 1.0577493e+00 2.5938663e-01
 3.5335037e-01 3.1510338e-01 1.5348769e+00 8.2066208e-01 4.4741625e-01
 3.9545026e-01 2.5938663e-01 4.2619866e-01 1.0543985e+00 2.5938663e-01
 2.7782807e-01 2.7782807e-01 5.5886745e-01 2.5938663e-01 3.8230830e-01
 2.7143815e-01 3.5335037e-01 1.0577493e+00 1.3820751e+00 1.0577493e+00
 1.4303614e+00 1.1712162e+00 3.5335037e-01 2.7143815e-01 3.0241042e-01
 2.7782807e-01 3.5335037e-01 2.7782807e-01 2.7782807e-01 4.2085969e-01
 2.7782807e-01 5.9967726e-01 2.5938663e-01 3.5335037e-01 1.2497904e+00
 4.9701029e-01 1.5348769e+00 4.2619866e-01 1.3127030e+00 5.2104425e-01
 4.3723047e-01 1.0411683e+00 3.8519564e-01 1.8840940e+00 5.2981675e-01
 3.5947922e-01 1.0969391e+00 5.2981675e-01 2.7782807e-01 3.8519564e-01
 6.5623766e-01 1.1510756e+00 1.1510756e+00 1.1510756e+00 1.1510756e+00
 4.1249399e+00 2.7782807e-01 6.8469507e-01 3.8519564e-01 2.7782807e-01
 3.8519564e-01 9.0845329e-01 1.2781712e+00 1.1510756e+00 5.2981675e-01
 1.9295580e+03 7.5780469e-01 1.3992476e+00 9.3746465e-01 5.2981675e-01]
2025-06-06 15:07:45,108 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 ... 0.19999999 0.19999999 0.19999999]
2025-06-06 15:07:45,177 - ERROR - An error occurred while processing file nw_graph_encoded_1749045008.dot: module 'datetime' has no attribute 'now'
2025-06-06 15:07:45,178 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 410, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 17, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^^^^^
AttributeError: module 'datetime' has no attribute 'now'

2025-06-06 15:07:45,178 - INFO - 
--- Processing file: nw_graph_encoded_1749046127.dot ---
2025-06-06 15:07:45,178 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot
2025-06-06 15:07:45,178 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot file.
2025-06-06 15:07:45,199 - INFO - Parsed 799 nodes.
2025-06-06 15:07:45,218 - INFO - Parsed 1718 edges.
2025-06-06 15:07:45,731 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:07:45,732 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:07:45,737 - DEBUG - Initial node features tensor shape: torch.Size([799, 19])
2025-06-06 15:07:45,744 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:07:45,750 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 19])
2025-06-06 15:07:45,752 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-06 15:07:45,752 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:07:45,972 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:07:45,974 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:07:45,975 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 2])
2025-06-06 15:07:45,977 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:07:45,981 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 20])
2025-06-06 15:07:45,988 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 22])
2025-06-06 15:07:45,988 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:07:45,988 - INFO - Performing online update...
2025-06-06 15:07:45,988 - INFO - Starting online update for 50 steps.
2025-06-06 15:07:45,989 - DEBUG - Updated RunningStats: new_mean=[ 3.65885305e-10 -4.21900662e-10 -2.87638601e-09  2.20933011e-09
 -2.46694300e-08  1.33437906e-08 -9.33052107e-09 -2.23512613e-09
 -2.89070745e-09  1.03804995e-09  1.74005858e-09 -1.44339500e-09
  3.62197683e-09 -3.26278653e-09  8.91556776e-10  7.29639227e-10
 -3.80280889e-09  1.08314161e-09 -4.55502484e-09], new_M2=[201601.00514268 201601.00509694 201601.00023859 201601.00442037
 201600.99854519 201600.99840548 201600.99600416 201600.99816372
 201600.99318175 201600.99843682 201601.00183422 201600.99391868
 201600.99279694 161809.99667376 161810.00009013 161809.99888559
 161810.00000065 201601.00020196 201601.0076998 ], new_n=201601
2025-06-06 15:07:45,990 - DEBUG - Updated RunningStats: new_mean=[ 1.41489030e+00  5.47850479e+00  9.72937587e-11  2.48780648e-10
  1.40575833e-10 -1.58958373e-10 -1.21235867e-09  2.02092951e-10
  2.75519832e-10 -1.68173403e-10  2.96515644e-10 -3.34415506e-09
 -8.53399429e-10  1.24670253e-10  2.68690604e-10 -1.51868535e-10
 -1.51868535e-10 -1.51868535e-10 -1.51868535e-10 -1.51868535e-10
 -1.51868535e-10 -8.27353396e-11], new_M2=[ 111591.36181054 1926006.03282036  433328.99894004  433329.00587729
  433329.0057573   433328.99318474  433329.00033293  433328.99913492
  433329.00167777  433328.99928746  433328.99415344  433329.00846064
  433329.00112089  433328.9999936   433329.0017675   433328.99445562
  433328.99445562  433328.99445562  433328.99445562  433328.99445562
  433328.99445562  433328.99893863], new_n=433329
2025-06-06 15:07:45,990 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.89589339 0.8958934  0.8958934  0.8958934  1.
 1.00000002]
2025-06-06 15:07:45,990 - DEBUG - Calculated standard deviation: [0.50746537 2.10823949 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-06 15:07:45,990 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:07:45,990 - DEBUG - Online update step: 1/50
2025-06-06 15:07:45,997 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:07:46,004 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:07:46,018 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:07:46,019 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:07:46,019 - DEBUG - Applied edge dropout: 43 edges dropped.
2025-06-06 15:07:46,019 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:07:46,020 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:07:46,020 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:07:46,020 - DEBUG - Applied edge dropout: 96 edges dropped.
2025-06-06 15:07:46,025 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:07:46,033 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:07:46,033 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:07:46,034 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:07:46,034 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:07:46,034 - DEBUG - Applied edge dropout: 63 edges dropped.
2025-06-06 15:07:46,035 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:07:46,036 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:46,815 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:47,078 - DEBUG - Edge anomaly scores shape: torch.Size([12907, 1])
2025-06-06 15:07:47,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:47,131 - DEBUG - Node reconstruction loss: 31.9773
2025-06-06 15:07:47,132 - ERROR - Error during loss calculation: Target size (torch.Size([12907, 22])) must be the same as input size (torch.Size([12907]))
2025-06-06 15:07:47,167 - DEBUG - Online update step: 2/50
2025-06-06 15:07:47,174 - DEBUG - Applied edge dropout: 42 edges dropped.
2025-06-06 15:07:47,182 - DEBUG - Applied edge dropout: 95 edges dropped.
2025-06-06 15:07:47,219 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:07:47,226 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:07:47,265 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:07:47,273 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:07:47,281 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:07:47,288 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:07:47,316 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:07:47,326 - DEBUG - Applied edge dropout: 58 edges dropped.
2025-06-06 15:07:47,326 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:07:47,356 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:07:47,356 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:07:47,357 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:07:47,357 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:07:47,380 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:07:47,396 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:48,946 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:49,063 - DEBUG - Edge anomaly scores shape: torch.Size([12858, 1])
2025-06-06 15:07:49,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:49,129 - DEBUG - Node reconstruction loss: 32.7457
2025-06-06 15:07:49,129 - ERROR - Error during loss calculation: Target size (torch.Size([12858, 22])) must be the same as input size (torch.Size([12858]))
2025-06-06 15:07:49,158 - DEBUG - Online update step: 3/50
2025-06-06 15:07:49,194 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:07:49,201 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:07:49,211 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:07:49,219 - DEBUG - Applied edge dropout: 69 edges dropped.
2025-06-06 15:07:49,251 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:07:49,288 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:07:49,298 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:07:49,334 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:07:49,342 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:07:49,379 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:07:49,387 - DEBUG - Applied edge dropout: 33 edges dropped.
2025-06-06 15:07:49,392 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:07:49,392 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:07:49,393 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:07:49,399 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:07:49,399 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:07:49,417 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:51,397 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:51,603 - DEBUG - Edge anomaly scores shape: torch.Size([12798, 1])
2025-06-06 15:07:51,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:51,666 - DEBUG - Node reconstruction loss: 32.6101
2025-06-06 15:07:51,666 - ERROR - Error during loss calculation: Target size (torch.Size([12798, 22])) must be the same as input size (torch.Size([12798]))
2025-06-06 15:07:51,683 - DEBUG - Online update step: 4/50
2025-06-06 15:07:51,684 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:07:51,689 - DEBUG - Applied edge dropout: 89 edges dropped.
2025-06-06 15:07:51,690 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:07:51,699 - DEBUG - Applied edge dropout: 82 edges dropped.
2025-06-06 15:07:51,699 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:07:51,734 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:07:51,770 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:07:51,799 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:07:51,813 - DEBUG - Applied edge dropout: 32 edges dropped.
2025-06-06 15:07:51,849 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:07:51,860 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:07:51,867 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:07:51,874 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:07:51,881 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:07:51,881 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:07:51,910 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:07:51,927 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:53,026 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:53,166 - DEBUG - Edge anomaly scores shape: torch.Size([12815, 1])
2025-06-06 15:07:53,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:53,219 - DEBUG - Node reconstruction loss: 33.2961
2025-06-06 15:07:53,219 - ERROR - Error during loss calculation: Target size (torch.Size([12815, 22])) must be the same as input size (torch.Size([12815]))
2025-06-06 15:07:53,228 - DEBUG - Online update step: 5/50
2025-06-06 15:07:53,236 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:07:53,239 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:07:53,248 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:07:53,271 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:07:53,271 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:07:53,271 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:07:53,272 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:07:53,276 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:07:53,297 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:07:53,297 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:07:53,311 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:07:53,312 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:07:53,312 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:07:53,312 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:07:53,313 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:07:53,313 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:07:53,314 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:54,116 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:54,357 - DEBUG - Edge anomaly scores shape: torch.Size([12809, 1])
2025-06-06 15:07:54,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:54,378 - DEBUG - Node reconstruction loss: 33.0890
2025-06-06 15:07:54,380 - ERROR - Error during loss calculation: Target size (torch.Size([12809, 22])) must be the same as input size (torch.Size([12809]))
2025-06-06 15:07:54,408 - DEBUG - Online update step: 6/50
2025-06-06 15:07:54,438 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:07:54,439 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:07:54,439 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:07:54,446 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:07:54,454 - DEBUG - Applied edge dropout: 41 edges dropped.
2025-06-06 15:07:54,462 - DEBUG - Applied edge dropout: 62 edges dropped.
2025-06-06 15:07:54,492 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:07:54,493 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:07:54,494 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:07:54,500 - DEBUG - Applied edge dropout: 130 edges dropped.
2025-06-06 15:07:54,506 - DEBUG - Applied edge dropout: 66 edges dropped.
2025-06-06 15:07:54,533 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:07:54,545 - DEBUG - Applied edge dropout: 120 edges dropped.
2025-06-06 15:07:54,576 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:07:54,582 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:07:54,611 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:07:54,628 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:56,463 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:56,542 - DEBUG - Edge anomaly scores shape: torch.Size([12820, 1])
2025-06-06 15:07:56,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:56,543 - DEBUG - Node reconstruction loss: 32.7593
2025-06-06 15:07:56,543 - ERROR - Error during loss calculation: Target size (torch.Size([12820, 22])) must be the same as input size (torch.Size([12820]))
2025-06-06 15:07:56,559 - DEBUG - Online update step: 7/50
2025-06-06 15:07:56,561 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:07:56,561 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:07:56,562 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:07:56,562 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:07:56,562 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:07:56,563 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:07:56,563 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:07:56,563 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:07:56,563 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:07:56,565 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:07:56,565 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:07:56,569 - DEBUG - Applied edge dropout: 82 edges dropped.
2025-06-06 15:07:56,594 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:07:56,602 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:07:56,602 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:07:56,602 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:07:56,609 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:57,581 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:57,732 - DEBUG - Edge anomaly scores shape: torch.Size([12802, 1])
2025-06-06 15:07:57,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:57,774 - DEBUG - Node reconstruction loss: 32.3762
2025-06-06 15:07:57,774 - ERROR - Error during loss calculation: Target size (torch.Size([12802, 22])) must be the same as input size (torch.Size([12802]))
2025-06-06 15:07:57,796 - DEBUG - Online update step: 8/50
2025-06-06 15:07:57,804 - DEBUG - Applied edge dropout: 68 edges dropped.
2025-06-06 15:07:57,853 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:07:57,884 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-06 15:07:57,891 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:07:57,891 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:07:57,892 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:07:57,892 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:07:57,893 - DEBUG - Applied edge dropout: 90 edges dropped.
2025-06-06 15:07:57,893 - DEBUG - Applied edge dropout: 33 edges dropped.
2025-06-06 15:07:57,894 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:07:57,894 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:07:57,894 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:07:57,894 - DEBUG - Applied edge dropout: 153 edges dropped.
2025-06-06 15:07:57,895 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:07:57,895 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:07:57,896 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:07:57,897 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:07:59,048 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:07:59,101 - DEBUG - Edge anomaly scores shape: torch.Size([12825, 1])
2025-06-06 15:07:59,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:07:59,102 - DEBUG - Node reconstruction loss: 33.2150
2025-06-06 15:07:59,102 - ERROR - Error during loss calculation: Target size (torch.Size([12825, 22])) must be the same as input size (torch.Size([12825]))
2025-06-06 15:07:59,123 - DEBUG - Online update step: 9/50
2025-06-06 15:07:59,136 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:07:59,136 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:07:59,168 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:07:59,168 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:07:59,172 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:07:59,172 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:07:59,185 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:07:59,194 - DEBUG - Applied edge dropout: 34 edges dropped.
2025-06-06 15:07:59,194 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:07:59,204 - DEBUG - Applied edge dropout: 76 edges dropped.
2025-06-06 15:07:59,204 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:07:59,218 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:07:59,225 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:07:59,225 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:07:59,233 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:07:59,267 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:07:59,284 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:00,470 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:00,533 - DEBUG - Edge anomaly scores shape: torch.Size([12831, 1])
2025-06-06 15:08:00,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:00,534 - DEBUG - Node reconstruction loss: 33.4759
2025-06-06 15:08:00,535 - ERROR - Error during loss calculation: Target size (torch.Size([12831, 22])) must be the same as input size (torch.Size([12831]))
2025-06-06 15:08:00,552 - DEBUG - Online update step: 10/50
2025-06-06 15:08:00,580 - DEBUG - Applied edge dropout: 172 edges dropped.
2025-06-06 15:08:00,587 - DEBUG - Applied edge dropout: 31 edges dropped.
2025-06-06 15:08:00,593 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:08:00,593 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:08:00,593 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:08:00,605 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:08:00,606 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-06 15:08:00,606 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:00,638 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:08:00,645 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:08:00,652 - DEBUG - Applied edge dropout: 70 edges dropped.
2025-06-06 15:08:00,682 - DEBUG - Applied edge dropout: 149 edges dropped.
2025-06-06 15:08:00,713 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:08:00,720 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-06 15:08:00,728 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:08:00,769 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:08:00,784 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:02,902 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:03,111 - DEBUG - Edge anomaly scores shape: torch.Size([12830, 1])
2025-06-06 15:08:03,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:03,175 - DEBUG - Node reconstruction loss: 33.3547
2025-06-06 15:08:03,175 - ERROR - Error during loss calculation: Target size (torch.Size([12830, 22])) must be the same as input size (torch.Size([12830]))
2025-06-06 15:08:03,198 - DEBUG - Online update step: 11/50
2025-06-06 15:08:03,203 - DEBUG - Applied edge dropout: 129 edges dropped.
2025-06-06 15:08:03,211 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:08:03,211 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:03,251 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:08:03,287 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:08:03,295 - DEBUG - Applied edge dropout: 107 edges dropped.
2025-06-06 15:08:03,314 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:08:03,317 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:08:03,321 - DEBUG - Applied edge dropout: 64 edges dropped.
2025-06-06 15:08:03,356 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:08:03,356 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:08:03,356 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:08:03,357 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:03,364 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:08:03,395 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:08:03,402 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-06 15:08:03,405 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:05,443 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:05,624 - DEBUG - Edge anomaly scores shape: torch.Size([12817, 1])
2025-06-06 15:08:05,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:05,646 - DEBUG - Node reconstruction loss: 33.1629
2025-06-06 15:08:05,646 - ERROR - Error during loss calculation: Target size (torch.Size([12817, 22])) must be the same as input size (torch.Size([12817]))
2025-06-06 15:08:05,659 - DEBUG - Online update step: 12/50
2025-06-06 15:08:05,663 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:08:05,668 - DEBUG - Applied edge dropout: 159 edges dropped.
2025-06-06 15:08:05,669 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:08:05,669 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:05,670 - DEBUG - Applied edge dropout: 134 edges dropped.
2025-06-06 15:08:05,670 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:08:05,670 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:08:05,671 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-06 15:08:05,671 - DEBUG - Applied edge dropout: 165 edges dropped.
2025-06-06 15:08:05,672 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:08:05,672 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-06 15:08:05,677 - DEBUG - Applied edge dropout: 78 edges dropped.
2025-06-06 15:08:05,677 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-06 15:08:05,682 - DEBUG - Applied edge dropout: 115 edges dropped.
2025-06-06 15:08:05,682 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:08:05,683 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:08:05,684 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:07,777 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:07,873 - DEBUG - Edge anomaly scores shape: torch.Size([12805, 1])
2025-06-06 15:08:07,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:07,923 - DEBUG - Node reconstruction loss: 32.7004
2025-06-06 15:08:07,923 - ERROR - Error during loss calculation: Target size (torch.Size([12805, 22])) must be the same as input size (torch.Size([12805]))
2025-06-06 15:08:07,945 - DEBUG - Online update step: 13/50
2025-06-06 15:08:07,952 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:08:07,952 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:08:07,953 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:07,953 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:07,997 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:08:08,005 - DEBUG - Applied edge dropout: 46 edges dropped.
2025-06-06 15:08:08,011 - DEBUG - Applied edge dropout: 49 edges dropped.
2025-06-06 15:08:08,050 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:08:08,057 - DEBUG - Applied edge dropout: 107 edges dropped.
2025-06-06 15:08:08,057 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:08:08,094 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-06 15:08:08,133 - DEBUG - Applied edge dropout: 162 edges dropped.
2025-06-06 15:08:08,174 - DEBUG - Applied edge dropout: 138 edges dropped.
2025-06-06 15:08:08,182 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-06 15:08:08,195 - DEBUG - Applied edge dropout: 121 edges dropped.
2025-06-06 15:08:08,202 - DEBUG - Applied edge dropout: 107 edges dropped.
2025-06-06 15:08:08,223 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:09,783 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:09,881 - DEBUG - Edge anomaly scores shape: torch.Size([12840, 1])
2025-06-06 15:08:09,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:09,882 - DEBUG - Node reconstruction loss: 32.7848
2025-06-06 15:08:09,882 - ERROR - Error during loss calculation: Target size (torch.Size([12840, 22])) must be the same as input size (torch.Size([12840]))
2025-06-06 15:08:09,895 - DEBUG - Online update step: 14/50
2025-06-06 15:08:09,896 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:09,901 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:08:09,936 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:08:09,943 - DEBUG - Applied edge dropout: 81 edges dropped.
2025-06-06 15:08:09,944 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:08:09,944 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:09,951 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:08:09,979 - DEBUG - Applied edge dropout: 176 edges dropped.
2025-06-06 15:08:10,013 - DEBUG - Applied edge dropout: 179 edges dropped.
2025-06-06 15:08:10,020 - DEBUG - Applied edge dropout: 103 edges dropped.
2025-06-06 15:08:10,022 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:10,064 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:08:10,073 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:08:10,119 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:08:10,127 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:08:10,140 - DEBUG - Applied edge dropout: 63 edges dropped.
2025-06-06 15:08:10,154 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:11,885 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:12,124 - DEBUG - Edge anomaly scores shape: torch.Size([12811, 1])
2025-06-06 15:08:12,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:12,189 - DEBUG - Node reconstruction loss: 32.9261
2025-06-06 15:08:12,190 - ERROR - Error during loss calculation: Target size (torch.Size([12811, 22])) must be the same as input size (torch.Size([12811]))
2025-06-06 15:08:12,224 - DEBUG - Online update step: 15/50
2025-06-06 15:08:12,225 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:08:12,225 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:12,231 - DEBUG - Applied edge dropout: 120 edges dropped.
2025-06-06 15:08:12,266 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:08:12,302 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:08:12,310 - DEBUG - Applied edge dropout: 61 edges dropped.
2025-06-06 15:08:12,310 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:08:12,338 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:08:12,341 - DEBUG - Applied edge dropout: 88 edges dropped.
2025-06-06 15:08:12,353 - DEBUG - Applied edge dropout: 55 edges dropped.
2025-06-06 15:08:12,359 - DEBUG - Applied edge dropout: 135 edges dropped.
2025-06-06 15:08:12,384 - DEBUG - Applied edge dropout: 148 edges dropped.
2025-06-06 15:08:12,385 - DEBUG - Applied edge dropout: 23 edges dropped.
2025-06-06 15:08:12,386 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:08:12,388 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:08:12,422 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-06 15:08:12,439 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:14,182 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:14,377 - DEBUG - Edge anomaly scores shape: torch.Size([12771, 1])
2025-06-06 15:08:14,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:14,460 - DEBUG - Node reconstruction loss: 33.1820
2025-06-06 15:08:14,460 - ERROR - Error during loss calculation: Target size (torch.Size([12771, 22])) must be the same as input size (torch.Size([12771]))
2025-06-06 15:08:14,482 - DEBUG - Online update step: 16/50
2025-06-06 15:08:14,483 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-06 15:08:14,484 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:08:14,488 - DEBUG - Applied edge dropout: 71 edges dropped.
2025-06-06 15:08:14,497 - DEBUG - Applied edge dropout: 115 edges dropped.
2025-06-06 15:08:14,505 - DEBUG - Applied edge dropout: 85 edges dropped.
2025-06-06 15:08:14,531 - DEBUG - Applied edge dropout: 168 edges dropped.
2025-06-06 15:08:14,566 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:08:14,573 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:08:14,575 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:08:14,614 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:08:14,619 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:08:14,627 - DEBUG - Applied edge dropout: 45 edges dropped.
2025-06-06 15:08:14,659 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:08:14,664 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:08:14,696 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:08:14,696 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:08:14,711 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:16,647 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:16,821 - DEBUG - Edge anomaly scores shape: torch.Size([12829, 1])
2025-06-06 15:08:16,866 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:16,882 - DEBUG - Node reconstruction loss: 32.3205
2025-06-06 15:08:16,882 - ERROR - Error during loss calculation: Target size (torch.Size([12829, 22])) must be the same as input size (torch.Size([12829]))
2025-06-06 15:08:16,892 - DEBUG - Online update step: 17/50
2025-06-06 15:08:16,893 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:08:16,898 - DEBUG - Applied edge dropout: 124 edges dropped.
2025-06-06 15:08:16,930 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-06 15:08:16,938 - DEBUG - Applied edge dropout: 25 edges dropped.
2025-06-06 15:08:16,971 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:08:16,972 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:08:16,978 - DEBUG - Applied edge dropout: 37 edges dropped.
2025-06-06 15:08:16,985 - DEBUG - Applied edge dropout: 102 edges dropped.
2025-06-06 15:08:16,990 - DEBUG - Applied edge dropout: 114 edges dropped.
2025-06-06 15:08:17,027 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:08:17,027 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:17,028 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:08:17,037 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:08:17,066 - DEBUG - Applied edge dropout: 132 edges dropped.
2025-06-06 15:08:17,074 - DEBUG - Applied edge dropout: 73 edges dropped.
2025-06-06 15:08:17,103 - DEBUG - Applied edge dropout: 167 edges dropped.
2025-06-06 15:08:17,130 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:19,484 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:19,690 - DEBUG - Edge anomaly scores shape: torch.Size([12820, 1])
2025-06-06 15:08:19,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:19,752 - DEBUG - Node reconstruction loss: 32.9859
2025-06-06 15:08:19,752 - ERROR - Error during loss calculation: Target size (torch.Size([12820, 22])) must be the same as input size (torch.Size([12820]))
2025-06-06 15:08:19,760 - DEBUG - Online update step: 18/50
2025-06-06 15:08:19,763 - DEBUG - Applied edge dropout: 146 edges dropped.
2025-06-06 15:08:19,769 - DEBUG - Applied edge dropout: 145 edges dropped.
2025-06-06 15:08:19,769 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:08:19,770 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:08:19,776 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:08:19,822 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:08:19,859 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:08:19,862 - DEBUG - Applied edge dropout: 54 edges dropped.
2025-06-06 15:08:19,889 - DEBUG - Applied edge dropout: 183 edges dropped.
2025-06-06 15:08:19,899 - DEBUG - Applied edge dropout: 91 edges dropped.
2025-06-06 15:08:19,905 - DEBUG - Applied edge dropout: 97 edges dropped.
2025-06-06 15:08:19,938 - DEBUG - Applied edge dropout: 151 edges dropped.
2025-06-06 15:08:19,968 - DEBUG - Applied edge dropout: 164 edges dropped.
2025-06-06 15:08:19,977 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:08:19,978 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:08:19,978 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:19,996 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:22,306 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:22,517 - DEBUG - Edge anomaly scores shape: torch.Size([12816, 1])
2025-06-06 15:08:22,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:22,604 - DEBUG - Node reconstruction loss: 32.5921
2025-06-06 15:08:22,604 - ERROR - Error during loss calculation: Target size (torch.Size([12816, 22])) must be the same as input size (torch.Size([12816]))
2025-06-06 15:08:22,612 - DEBUG - Online update step: 19/50
2025-06-06 15:08:22,647 - DEBUG - Applied edge dropout: 158 edges dropped.
2025-06-06 15:08:22,655 - DEBUG - Applied edge dropout: 140 edges dropped.
2025-06-06 15:08:22,655 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-06 15:08:22,656 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:22,689 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:08:22,728 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:08:22,728 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:08:22,735 - DEBUG - Applied edge dropout: 139 edges dropped.
2025-06-06 15:08:22,742 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:08:22,785 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:08:22,792 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-06 15:08:22,792 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:08:22,801 - DEBUG - Applied edge dropout: 93 edges dropped.
2025-06-06 15:08:22,812 - DEBUG - Applied edge dropout: 52 edges dropped.
2025-06-06 15:08:22,850 - DEBUG - Applied edge dropout: 147 edges dropped.
2025-06-06 15:08:22,857 - DEBUG - Applied edge dropout: 28 edges dropped.
2025-06-06 15:08:22,877 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:24,397 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:24,581 - DEBUG - Edge anomaly scores shape: torch.Size([12898, 1])
2025-06-06 15:08:24,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:24,588 - DEBUG - Node reconstruction loss: 32.9538
2025-06-06 15:08:24,588 - ERROR - Error during loss calculation: Target size (torch.Size([12898, 22])) must be the same as input size (torch.Size([12898]))
2025-06-06 15:08:24,592 - DEBUG - Online update step: 20/50
2025-06-06 15:08:24,593 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:24,594 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-06 15:08:24,605 - DEBUG - Applied edge dropout: 157 edges dropped.
2025-06-06 15:08:24,605 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:08:24,609 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-06 15:08:24,619 - DEBUG - Applied edge dropout: 67 edges dropped.
2025-06-06 15:08:24,619 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:24,623 - DEBUG - Applied edge dropout: 161 edges dropped.
2025-06-06 15:08:24,624 - DEBUG - Applied edge dropout: 141 edges dropped.
2025-06-06 15:08:24,625 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:08:24,626 - DEBUG - Applied edge dropout: 128 edges dropped.
2025-06-06 15:08:24,626 - DEBUG - Applied edge dropout: 40 edges dropped.
2025-06-06 15:08:24,627 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:08:24,628 - DEBUG - Applied edge dropout: 156 edges dropped.
2025-06-06 15:08:24,628 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:08:24,629 - DEBUG - Applied edge dropout: 170 edges dropped.
2025-06-06 15:08:24,631 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:25,478 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:25,513 - DEBUG - Edge anomaly scores shape: torch.Size([12849, 1])
2025-06-06 15:08:25,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:25,514 - DEBUG - Node reconstruction loss: 32.6675
2025-06-06 15:08:25,515 - ERROR - Error during loss calculation: Target size (torch.Size([12849, 22])) must be the same as input size (torch.Size([12849]))
2025-06-06 15:08:25,518 - DEBUG - Online update step: 21/50
2025-06-06 15:08:25,519 - DEBUG - Applied edge dropout: 80 edges dropped.
2025-06-06 15:08:25,520 - DEBUG - Applied edge dropout: 171 edges dropped.
2025-06-06 15:08:25,520 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-06 15:08:25,521 - DEBUG - Applied edge dropout: 61 edges dropped.
2025-06-06 15:08:25,521 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-06 15:08:25,521 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:08:25,522 - DEBUG - Applied edge dropout: 127 edges dropped.
2025-06-06 15:08:25,522 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:08:25,523 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:08:25,523 - DEBUG - Applied edge dropout: 125 edges dropped.
2025-06-06 15:08:25,524 - DEBUG - Applied edge dropout: 142 edges dropped.
2025-06-06 15:08:25,524 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-06 15:08:25,524 - DEBUG - Applied edge dropout: 38 edges dropped.
2025-06-06 15:08:25,524 - DEBUG - Applied edge dropout: 86 edges dropped.
2025-06-06 15:08:25,525 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-06 15:08:25,525 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-06 15:08:25,526 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:08:26,851 - DEBUG - Node anomaly scores shape: torch.Size([7019, 1])
2025-06-06 15:08:26,933 - DEBUG - Edge anomaly scores shape: torch.Size([12904, 1])
2025-06-06 15:08:27,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:08:27,020 - DEBUG - Node reconstruction loss: 32.1770
2025-06-06 15:08:27,020 - ERROR - Error during loss calculation: Target size (torch.Size([12904, 22])) must be the same as input size (torch.Size([12904]))
2025-06-06 15:08:27,039 - DEBUG - Online update step: 22/50
2025-06-06 15:08:27,042 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:08:27,043 - DEBUG - Applied edge dropout: 174 edges dropped.
2025-06-06 15:08:27,043 - DEBUG - Applied edge dropout: 39 edges dropped.
2025-06-06 15:08:27,043 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-06 15:08:27,043 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-06 15:08:27,044 - DEBUG - Applied edge dropout: 111 edges dropped.
2025-06-06 15:08:27,044 - DEBUG - Applied edge dropout: 100 edges dropped.
2025-06-06 15:08:27,045 - DEBUG - Applied edge dropout: 175 edges dropped.
2025-06-06 15:08:27,045 - DEBUG - Applied edge dropout: 59 edges dropped.
2025-06-06 15:08:27,045 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:08:27,046 - DEBUG - Applied edge dropout: 143 edges dropped.
2025-06-06 15:08:27,049 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-06 15:08:27,049 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:08:27,049 - DEBUG - Applied edge dropout: 160 edges dropped.
2025-06-06 15:08:27,049 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-06 15:08:27,050 - DEBUG - Applied edge dropout: 150 edges dropped.
2025-06-06 15:08:27,051 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
