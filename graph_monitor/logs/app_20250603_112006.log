2025-06-03 11:20:06,429 - INFO - Application logging to file: logs/app_20250603_112006.log
2025-06-03 11:20:06,429 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 11:20:06,429 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-03 11:20:06,429 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-03 11:20:06,429 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 11:20:06,429 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot file.
2025-06-03 11:20:06,431 - INFO - Parsed 89 nodes.
2025-06-03 11:20:06,432 - INFO - Parsed 133 edges.
2025-06-03 11:20:06,437 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:06,437 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:06,439 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-03 11:20:06,440 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:06,440 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-03 11:20:06,441 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-03 11:20:06,441 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:06,442 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:06,442 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 11:20:06,443 - DEBUG - Shape of encoded categorical edge features: torch.Size([133, 2])
2025-06-03 11:20:06,443 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:06,443 - DEBUG - Shape of scaled numerical edge features: torch.Size([133, 20])
2025-06-03 11:20:06,443 - DEBUG - Final edge attributes tensor shape: torch.Size([133, 22])
2025-06-03 11:20:06,443 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:06,443 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 11:20:06,444 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-03 11:20:06,487 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-03 11:20:06,488 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-03 11:20:06,490 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 11:20:06,490 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-03 11:20:06,490 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-03 11:20:06,490 - INFO - RunningStats initialized.
2025-06-03 11:20:06,490 - INFO - RunningStats initialized.
2025-06-03 11:20:06,490 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 11:20:06,491 - INFO - Using device: cpu
2025-06-03 11:20:06,491 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=22)
2025-06-03 11:20:06,491 - INFO - Performing initial training for 100 epochs...
2025-06-03 11:20:06,499 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,500 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,557 - INFO - Epoch 1/100, Loss: 16.7937
2025-06-03 11:20:06,565 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,566 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,566 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,706 - INFO - Epoch 2/100, Loss: 16.5618
2025-06-03 11:20:06,725 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,727 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,776 - INFO - Epoch 3/100, Loss: 15.4080
2025-06-03 11:20:06,781 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,783 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,790 - INFO - Epoch 4/100, Loss: 14.8843
2025-06-03 11:20:06,795 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,796 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,828 - INFO - Epoch 5/100, Loss: 12.8461
2025-06-03 11:20:06,833 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,834 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,840 - INFO - Epoch 6/100, Loss: 12.4258
2025-06-03 11:20:06,846 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,847 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,854 - INFO - Epoch 7/100, Loss: 12.5960
2025-06-03 11:20:06,859 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,860 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,867 - INFO - Epoch 8/100, Loss: 11.4343
2025-06-03 11:20:06,873 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,873 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,880 - INFO - Epoch 9/100, Loss: 10.9873
2025-06-03 11:20:06,885 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,886 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,893 - INFO - Epoch 10/100, Loss: 10.8305
2025-06-03 11:20:06,899 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,899 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,906 - INFO - Epoch 11/100, Loss: 9.8216
2025-06-03 11:20:06,912 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,916 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:06,947 - INFO - Epoch 12/100, Loss: 9.1682
2025-06-03 11:20:06,959 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:06,960 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:06,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,040 - INFO - Epoch 13/100, Loss: 8.8219
2025-06-03 11:20:07,048 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,048 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,055 - INFO - Epoch 14/100, Loss: 7.6562
2025-06-03 11:20:07,060 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,060 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,067 - INFO - Epoch 15/100, Loss: 8.3005
2025-06-03 11:20:07,072 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,072 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,081 - INFO - Epoch 16/100, Loss: 7.6607
2025-06-03 11:20:07,086 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,086 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,094 - INFO - Epoch 17/100, Loss: 6.5384
2025-06-03 11:20:07,099 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,099 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,106 - INFO - Epoch 18/100, Loss: 7.2000
2025-06-03 11:20:07,113 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,114 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,154 - INFO - Epoch 19/100, Loss: 6.3365
2025-06-03 11:20:07,176 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,183 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,242 - INFO - Epoch 20/100, Loss: 6.2587
2025-06-03 11:20:07,247 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,248 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,248 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,254 - INFO - Epoch 21/100, Loss: 7.2152
2025-06-03 11:20:07,258 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,259 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,265 - INFO - Epoch 22/100, Loss: 6.1956
2025-06-03 11:20:07,270 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,271 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,277 - INFO - Epoch 23/100, Loss: 5.6916
2025-06-03 11:20:07,286 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,287 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,294 - INFO - Epoch 24/100, Loss: 6.3887
2025-06-03 11:20:07,299 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,299 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,306 - INFO - Epoch 25/100, Loss: 5.3509
2025-06-03 11:20:07,311 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,311 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,312 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,319 - INFO - Epoch 26/100, Loss: 5.2515
2025-06-03 11:20:07,336 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,337 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,439 - INFO - Epoch 27/100, Loss: 5.1302
2025-06-03 11:20:07,457 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,457 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,466 - INFO - Epoch 28/100, Loss: 5.7265
2025-06-03 11:20:07,471 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,472 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,481 - INFO - Epoch 29/100, Loss: 4.8596
2025-06-03 11:20:07,486 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,486 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,493 - INFO - Epoch 30/100, Loss: 5.7225
2025-06-03 11:20:07,498 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,498 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,504 - INFO - Epoch 31/100, Loss: 5.1498
2025-06-03 11:20:07,509 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,510 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,516 - INFO - Epoch 32/100, Loss: 4.2669
2025-06-03 11:20:07,525 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,526 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,526 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,580 - INFO - Epoch 33/100, Loss: 4.1815
2025-06-03 11:20:07,667 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,667 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,674 - INFO - Epoch 34/100, Loss: 4.4484
2025-06-03 11:20:07,682 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,682 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,688 - INFO - Epoch 35/100, Loss: 5.0067
2025-06-03 11:20:07,693 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,694 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,701 - INFO - Epoch 36/100, Loss: 4.2032
2025-06-03 11:20:07,706 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,706 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,712 - INFO - Epoch 37/100, Loss: 4.6592
2025-06-03 11:20:07,717 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,717 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,723 - INFO - Epoch 38/100, Loss: 4.2437
2025-06-03 11:20:07,729 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,730 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,805 - INFO - Epoch 39/100, Loss: 4.9837
2025-06-03 11:20:07,831 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,834 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,916 - INFO - Epoch 40/100, Loss: 4.0703
2025-06-03 11:20:07,921 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,922 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,922 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:07,930 - INFO - Epoch 41/100, Loss: 4.4676
2025-06-03 11:20:07,943 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:07,944 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:07,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,019 - INFO - Epoch 42/100, Loss: 3.9564
2025-06-03 11:20:08,054 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,055 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,061 - INFO - Epoch 43/100, Loss: 4.0889
2025-06-03 11:20:08,069 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,070 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,070 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,076 - INFO - Epoch 44/100, Loss: 4.6499
2025-06-03 11:20:08,082 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,083 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,123 - INFO - Epoch 45/100, Loss: 4.0295
2025-06-03 11:20:08,128 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,128 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,129 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,182 - INFO - Epoch 46/100, Loss: 3.9187
2025-06-03 11:20:08,214 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,218 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,256 - INFO - Epoch 47/100, Loss: 4.0128
2025-06-03 11:20:08,260 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,261 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,298 - INFO - Epoch 48/100, Loss: 3.7549
2025-06-03 11:20:08,302 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,303 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,379 - INFO - Epoch 49/100, Loss: 3.5498
2025-06-03 11:20:08,384 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,385 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,442 - INFO - Epoch 50/100, Loss: 3.7959
2025-06-03 11:20:08,459 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,461 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,546 - INFO - Epoch 51/100, Loss: 3.3411
2025-06-03 11:20:08,550 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,551 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,557 - INFO - Epoch 52/100, Loss: 3.3500
2025-06-03 11:20:08,563 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,564 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,570 - INFO - Epoch 53/100, Loss: 3.3663
2025-06-03 11:20:08,575 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,576 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,582 - INFO - Epoch 54/100, Loss: 3.2713
2025-06-03 11:20:08,588 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,590 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,668 - INFO - Epoch 55/100, Loss: 3.2821
2025-06-03 11:20:08,684 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,688 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,750 - INFO - Epoch 56/100, Loss: 3.4014
2025-06-03 11:20:08,754 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,755 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,803 - INFO - Epoch 57/100, Loss: 3.4498
2025-06-03 11:20:08,813 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,814 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,870 - INFO - Epoch 58/100, Loss: 3.1020
2025-06-03 11:20:08,887 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,889 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,930 - INFO - Epoch 59/100, Loss: 3.0678
2025-06-03 11:20:08,935 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,935 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,936 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,942 - INFO - Epoch 60/100, Loss: 3.2521
2025-06-03 11:20:08,947 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,947 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,955 - INFO - Epoch 61/100, Loss: 3.1489
2025-06-03 11:20:08,960 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,961 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,974 - INFO - Epoch 62/100, Loss: 2.9786
2025-06-03 11:20:08,982 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:08,982 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:08,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:08,994 - INFO - Epoch 63/100, Loss: 3.4601
2025-06-03 11:20:09,002 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,003 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,012 - INFO - Epoch 64/100, Loss: 3.3356
2025-06-03 11:20:09,020 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,021 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,106 - INFO - Epoch 65/100, Loss: 2.8878
2025-06-03 11:20:09,119 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,120 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,132 - INFO - Epoch 66/100, Loss: 2.9706
2025-06-03 11:20:09,140 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,141 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,141 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,149 - INFO - Epoch 67/100, Loss: 3.0308
2025-06-03 11:20:09,154 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,154 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,162 - INFO - Epoch 68/100, Loss: 3.0539
2025-06-03 11:20:09,167 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,167 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,176 - INFO - Epoch 69/100, Loss: 3.1353
2025-06-03 11:20:09,182 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,182 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,230 - INFO - Epoch 70/100, Loss: 3.1909
2025-06-03 11:20:09,242 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,244 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,317 - INFO - Epoch 71/100, Loss: 3.1720
2025-06-03 11:20:09,329 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,330 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,337 - INFO - Epoch 72/100, Loss: 3.2384
2025-06-03 11:20:09,341 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,342 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,350 - INFO - Epoch 73/100, Loss: 3.2788
2025-06-03 11:20:09,355 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,355 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,362 - INFO - Epoch 74/100, Loss: 3.0093
2025-06-03 11:20:09,367 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,368 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,374 - INFO - Epoch 75/100, Loss: 2.7359
2025-06-03 11:20:09,379 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,380 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,380 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,386 - INFO - Epoch 76/100, Loss: 2.8009
2025-06-03 11:20:09,391 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,391 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,398 - INFO - Epoch 77/100, Loss: 3.3021
2025-06-03 11:20:09,403 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,403 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,410 - INFO - Epoch 78/100, Loss: 2.6201
2025-06-03 11:20:09,414 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,415 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,421 - INFO - Epoch 79/100, Loss: 2.8173
2025-06-03 11:20:09,426 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,426 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,433 - INFO - Epoch 80/100, Loss: 2.8220
2025-06-03 11:20:09,447 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,448 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,527 - INFO - Epoch 81/100, Loss: 2.9882
2025-06-03 11:20:09,536 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,537 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,544 - INFO - Epoch 82/100, Loss: 2.5770
2025-06-03 11:20:09,550 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,550 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,557 - INFO - Epoch 83/100, Loss: 3.0254
2025-06-03 11:20:09,561 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,562 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,571 - INFO - Epoch 84/100, Loss: 2.7628
2025-06-03 11:20:09,576 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,578 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,585 - INFO - Epoch 85/100, Loss: 2.7301
2025-06-03 11:20:09,590 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,591 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,597 - INFO - Epoch 86/100, Loss: 2.5638
2025-06-03 11:20:09,602 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,602 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,608 - INFO - Epoch 87/100, Loss: 2.6644
2025-06-03 11:20:09,613 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,614 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,614 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,620 - INFO - Epoch 88/100, Loss: 2.6815
2025-06-03 11:20:09,624 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,625 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,631 - INFO - Epoch 89/100, Loss: 2.9206
2025-06-03 11:20:09,635 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,636 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,672 - INFO - Epoch 90/100, Loss: 2.5516
2025-06-03 11:20:09,681 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,684 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,712 - INFO - Epoch 91/100, Loss: 2.5640
2025-06-03 11:20:09,722 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,726 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,763 - INFO - Epoch 92/100, Loss: 2.6942
2025-06-03 11:20:09,768 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,769 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,775 - INFO - Epoch 93/100, Loss: 2.6180
2025-06-03 11:20:09,783 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,783 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,790 - INFO - Epoch 94/100, Loss: 2.6236
2025-06-03 11:20:09,796 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,796 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,804 - INFO - Epoch 95/100, Loss: 2.4622
2025-06-03 11:20:09,809 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,809 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,821 - INFO - Epoch 96/100, Loss: 2.8590
2025-06-03 11:20:09,830 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,831 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,846 - INFO - Epoch 97/100, Loss: 2.2966
2025-06-03 11:20:09,890 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,892 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,893 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,955 - INFO - Epoch 98/100, Loss: 2.3335
2025-06-03 11:20:09,960 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,961 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,967 - INFO - Epoch 99/100, Loss: 2.5020
2025-06-03 11:20:09,972 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:20:09,973 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:20:09,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:09,980 - INFO - Epoch 100/100, Loss: 2.4000
2025-06-03 11:20:09,980 - INFO - Initial training complete.
2025-06-03 11:20:09,986 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 52
2025-06-03 11:20:09,987 - INFO - Starting or resuming online updates from step: 52
2025-06-03 11:20:09,987 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-03 11:20:09,987 - INFO - Running anomaly detection...
2025-06-03 11:20:09,987 - INFO - Starting anomaly detection.
2025-06-03 11:20:09,991 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112009_update_1.json
2025-06-03 11:20:09,991 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:09,999 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112009_update_1.pth and as latest_checkpoint.pth
2025-06-03 11:20:09,999 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.2522
2025-06-03 11:20:09,999 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-03 11:20:09,999 - WARNING -   Node ID: 162.159.61.3, Recon Error: 161.8831, MLP Score: 0.0000
2025-06-03 11:20:09,999 - WARNING -   Node ID: 192.168.27.10, Recon Error: 160.3587, MLP Score: 0.0000
2025-06-03 11:20:09,999 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-03 11:20:09,999 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.6501, MLP Score: 1.0000
2025-06-03 11:20:10,000 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 3.4893, MLP Score: 1.0000
2025-06-03 11:20:10,000 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.0219, MLP Score: 0.9865
2025-06-03 11:20:10,000 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:20:10,000 - INFO - Performing visualization of node and edge features.
2025-06-03 11:20:10,000 - INFO - Starting visualization of node features.
2025-06-03 11:20:10,000 - INFO - Graph has 89 nodes and 30 features.
2025-06-03 11:20:10,000 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:20:10,000 - INFO - Calculating feature statistics:
2025-06-03 11:20:10,000 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-3.0974324e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.24637975), 'max': np.float32(4.0978065)}
2025-06-03 11:20:10,000 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(3.0974324e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.0978065), 'max': np.float32(0.24637975)}
2025-06-03 11:20:10,000 - INFO - - server_score: {'name': 'server_score', 'unique': 7, 'mean': np.float32(-4.0182908e-08), 'std': np.float32(1.0), 'min': np.float32(-2.074784), 'max': np.float32(5.473159)}
2025-06-03 11:20:10,000 - INFO - - client_score: {'name': 'client_score', 'unique': 7, 'mean': np.float32(2.6788605e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.22028041), 'max': np.float32(5.79706)}
2025-06-03 11:20:10,000 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(-7.0320088e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3142697), 'max': np.float32(3.1819806)}
2025-06-03 11:20:10,001 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 8, 'mean': np.float32(-2.0091454e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29732358), 'max': np.float32(4.185126)}
2025-06-03 11:20:10,001 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-5.221124), 'max': np.float32(0.2736628)}
2025-06-03 11:20:10,001 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(2.059374e-08), 'std': np.float32(1.0), 'min': np.float32(-0.23076923), 'max': np.float32(5.7596154)}
2025-06-03 11:20:10,001 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.0113316), 'max': np.float32(8.045326)}
2025-06-03 11:20:10,001 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 6, 'mean': np.float32(-1.0045726e-09), 'std': np.float32(1.0), 'min': np.float32(-0.21546301), 'max': np.float32(5.572582)}
2025-06-03 11:20:10,001 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 6, 'mean': np.float32(3.7504048e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6095707), 'max': np.float32(0.5887556)}
2025-06-03 11:20:10,001 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(-9.376012e-09), 'std': np.float32(1.0), 'min': np.float32(-0.26886642), 'max': np.float32(3.719319)}
2025-06-03 11:20:10,001 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(1.4566304e-08), 'std': np.float32(1.0), 'min': np.float32(-4.09878), 'max': np.float32(0.24397503)}
2025-06-03 11:20:10,001 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(-1.3645446e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.5060302), 'max': np.float32(1.3409579)}
2025-06-03 11:20:10,001 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(-1.6240591e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3339475), 'max': np.float32(1.5135604)}
2025-06-03 11:20:10,001 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(3.6499472e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0945183), 'max': np.float32(1.7363071)}
2025-06-03 11:20:10,001 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(3.4825185e-08), 'std': np.float32(1.0), 'min': np.float32(-1.727558), 'max': np.float32(1.0981954)}
2025-06-03 11:20:10,001 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 8, 'mean': np.float32(2.6788605e-09), 'std': np.float32(1.0), 'min': np.float32(-3.920728), 'max': np.float32(0.30587068)}
2025-06-03 11:20:10,002 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 8, 'mean': np.float32(-1.6073162e-08), 'std': np.float32(1.0), 'min': np.float32(-2.183282), 'max': np.float32(2.0620248)}
2025-06-03 11:20:10,002 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,002 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:10,004 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-03 11:20:10,022 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b45457a40>
2025-06-03 11:20:10,189 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:20:10,249 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:20:10,277 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:20:11,532 - INFO - Node feature visualization saved to vis/node_features_20250603_112010.png
2025-06-03 11:20:11,532 - INFO - Finished visualization of node features.
2025-06-03 11:20:11,532 - INFO - Performing additional feature analysis:
2025-06-03 11:20:11,532 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:20:11,533 - INFO - Starting visualization of edge features.
2025-06-03 11:20:11,533 - INFO - Graph has 133 edges and 22 edge features.
2025-06-03 11:20:11,533 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:20:11,533 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:20:11,533 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-03 11:20:11,533 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 11:20:11,533 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot file.
2025-06-03 11:20:11,535 - INFO - Parsed 129 nodes.
2025-06-03 11:20:11,537 - INFO - Parsed 186 edges.
2025-06-03 11:20:11,546 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:11,546 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:11,549 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-03 11:20:11,550 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:11,550 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-03 11:20:11,550 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-03 11:20:11,550 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:11,552 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:11,552 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 11:20:11,552 - DEBUG - Shape of encoded categorical edge features: torch.Size([186, 2])
2025-06-03 11:20:11,553 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:11,553 - DEBUG - Shape of scaled numerical edge features: torch.Size([186, 20])
2025-06-03 11:20:11,553 - DEBUG - Final edge attributes tensor shape: torch.Size([186, 22])
2025-06-03 11:20:11,553 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:11,553 - INFO - Performing online update...
2025-06-03 11:20:11,553 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:11,553 - DEBUG - Updated RunningStats: new_mean=0.629324350470082, new_var=61200000000011.94, new_n=6150
2025-06-03 11:20:11,554 - DEBUG - Updated RunningStats: new_mean=0.6293557976602161, new_var=61500000000007.02, new_n=6180
2025-06-03 11:20:11,554 - DEBUG - Updated RunningStats: new_mean=0.8393944273124185, new_var=32640000000021.215, new_n=3286
2025-06-03 11:20:11,554 - DEBUG - Updated RunningStats: new_mean=0.8406180781455438, new_var=32860000000002.086, new_n=3308
2025-06-03 11:20:11,554 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:11,554 - DEBUG - Online update step: 1/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 2/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 3/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 4/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 5/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 6/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 7/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 8/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 9/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 10/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 11/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 12/50
2025-06-03 11:20:11,554 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,554 - DEBUG - Online update step: 13/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 14/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 15/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 16/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 17/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 18/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 19/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 20/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 21/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 22/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 23/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 24/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 25/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 26/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 27/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 28/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 29/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 30/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 31/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 32/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 33/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,555 - DEBUG - Online update step: 34/50
2025-06-03 11:20:11,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 35/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 36/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 37/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 38/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 39/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 40/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 41/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 42/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 43/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 44/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 45/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 46/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 47/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 48/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 49/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - DEBUG - Online update step: 50/50
2025-06-03 11:20:11,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,556 - WARNING - No successful steps during online update.
2025-06-03 11:20:11,557 - DEBUG - Current node mean: [-2.0330267e-08  2.0330267e-08 -2.2178472e-08 -2.0330267e-08
 -2.2178472e-08 -1.1089236e-08 -3.3267710e-08  1.8482060e-08
  3.6964121e-09 -1.2937442e-08 -1.1089236e-08  1.8482060e-08
 -3.3729759e-08 -1.1089236e-08 -1.1089236e-08 -1.1089236e-08
 -2.5874884e-08  0.0000000e+00  0.0000000e+00  2.7723090e-09
  0.0000000e+00  0.0000000e+00 -1.1551288e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.23655915e+00  3.46774197e+00 -2.56364063e-09  0.00000000e+00
  5.12728127e-09  7.69092168e-09  2.56364063e-09 -1.79454851e-08
 -1.53818434e-08  3.20455085e-09  6.40910169e-09  3.84546084e-09
  1.02545625e-08 -2.56364068e-08  1.02545625e-08 -2.56364063e-09
 -2.56364063e-09 -2.56364063e-09 -2.56364063e-09 -2.56364063e-09
 -2.56364063e-09  7.69092168e-09]
2025-06-03 11:20:11,557 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:11,557 - INFO - Running anomaly detection...
2025-06-03 11:20:11,557 - INFO - Starting anomaly detection.
2025-06-03 11:20:11,566 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112011_update_2.json
2025-06-03 11:20:11,566 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:11,572 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112011_update_2.pth and as latest_checkpoint.pth
2025-06-03 11:20:11,573 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.2989
2025-06-03 11:20:11,573 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-03 11:20:11,573 - WARNING -   Node ID: 8.8.8.8, Recon Error: 244.4900, MLP Score: 0.0000
2025-06-03 11:20:11,573 - WARNING -   Node ID: 192.168.27.10, Recon Error: 249.6964, MLP Score: 0.0000
2025-06-03 11:20:11,573 - WARNING -   Node ID: 162.159.61.3, Recon Error: 248.2969, MLP Score: 0.0000
2025-06-03 11:20:11,573 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 11:20:11,573 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 3.6338, MLP Score: 1.0000
2025-06-03 11:20:11,573 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.5944, MLP Score: 1.0000
2025-06-03 11:20:11,573 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.0947, MLP Score: 0.9989
2025-06-03 11:20:11,573 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3433, MLP Score: 1.0000
2025-06-03 11:20:11,573 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-03 11:20:11,573 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-03 11:20:11,573 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot file.
2025-06-03 11:20:11,576 - INFO - Parsed 177 nodes.
2025-06-03 11:20:11,580 - INFO - Parsed 256 edges.
2025-06-03 11:20:11,597 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:11,597 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:11,600 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-03 11:20:11,601 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:11,602 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-03 11:20:11,602 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-03 11:20:11,602 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:11,603 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:11,604 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:11,604 - DEBUG - Shape of encoded categorical edge features: torch.Size([256, 2])
2025-06-03 11:20:11,605 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:11,605 - DEBUG - Shape of scaled numerical edge features: torch.Size([256, 20])
2025-06-03 11:20:11,605 - DEBUG - Final edge attributes tensor shape: torch.Size([256, 22])
2025-06-03 11:20:11,605 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:11,605 - INFO - Performing online update...
2025-06-03 11:20:11,605 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:11,606 - DEBUG - Updated RunningStats: new_mean=0.6263154314825218, new_var=61800000000011.83, new_n=6210
2025-06-03 11:20:11,606 - DEBUG - Updated RunningStats: new_mean=0.6263578093500575, new_var=62100000000007.01, new_n=6240
2025-06-03 11:20:11,606 - DEBUG - Updated RunningStats: new_mean=0.8367442500188395, new_var=33080000000026.574, new_n=3330
2025-06-03 11:20:11,606 - DEBUG - Updated RunningStats: new_mean=0.8380705451028082, new_var=33300000000003.066, new_n=3352
2025-06-03 11:20:11,606 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:11,606 - DEBUG - Online update step: 1/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 2/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 3/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 4/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 5/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 6/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 7/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,606 - DEBUG - Online update step: 8/50
2025-06-03 11:20:11,606 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 9/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 10/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 11/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 12/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 13/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 14/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 15/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 16/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 17/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 18/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 19/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 20/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 21/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 22/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 23/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 24/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 25/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 26/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 27/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 28/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 29/50
2025-06-03 11:20:11,607 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,607 - DEBUG - Online update step: 30/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 31/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 32/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 33/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 34/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 35/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 36/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 37/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 38/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 39/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 40/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 41/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 42/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 43/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 44/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 45/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 46/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 47/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 48/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 49/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - DEBUG - Online update step: 50/50
2025-06-03 11:20:11,608 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,608 - WARNING - No successful steps during online update.
2025-06-03 11:20:11,609 - DEBUG - Current node mean: [-2.0204965e-08  2.0204965e-08 -3.2327943e-08 -2.0878463e-08
  6.1961892e-08 -3.0980946e-08  2.9633947e-08 -2.1551962e-08
 -2.6939952e-09 -5.3879905e-09  1.3469976e-09  4.1756927e-08
 -8.7554843e-09 -1.3469976e-08 -3.7715932e-08  2.6939952e-09
 -2.6939952e-08  0.0000000e+00  0.0000000e+00  1.3469976e-08
  0.0000000e+00  0.0000000e+00  1.6163971e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.2421875e+00  4.3515625e+00  9.3132257e-09  0.0000000e+00
  0.0000000e+00  3.7252903e-09 -5.5879354e-09  0.0000000e+00
  9.3132257e-09  0.0000000e+00  3.7252903e-09  7.4505806e-09
  0.0000000e+00 -5.5879354e-09  7.4505806e-09  3.7252903e-09
  3.7252903e-09  3.7252903e-09  3.7252903e-09  3.7252903e-09
  3.7252903e-09  5.1222742e-09]
2025-06-03 11:20:11,609 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.4371
2025-06-03 11:20:11,609 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 11:20:11,609 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:11,609 - INFO - Running anomaly detection...
2025-06-03 11:20:11,610 - INFO - Starting anomaly detection.
2025-06-03 11:20:11,615 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112011_update_3.json
2025-06-03 11:20:11,615 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:11,622 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112011_update_3.pth and as latest_checkpoint.pth
2025-06-03 11:20:11,622 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.3537
2025-06-03 11:20:11,622 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-03 11:20:11,622 - WARNING -   Node ID: 192.168.27.10, Recon Error: 288.8123, MLP Score: 0.0000
2025-06-03 11:20:11,622 - WARNING -   Node ID: 162.159.61.3, Recon Error: 284.2096, MLP Score: 0.0000
2025-06-03 11:20:11,622 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:20:11,622 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.0582, MLP Score: 1.0000
2025-06-03 11:20:11,622 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.9244, MLP Score: 1.0000
2025-06-03 11:20:11,622 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.2545, MLP Score: 1.0000
2025-06-03 11:20:11,622 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.2913, MLP Score: 1.0000
2025-06-03 11:20:11,622 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.6103, MLP Score: 1.0000
2025-06-03 11:20:11,622 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-03 11:20:11,622 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-03 11:20:11,622 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot file.
2025-06-03 11:20:11,628 - INFO - Parsed 256 nodes.
2025-06-03 11:20:11,633 - INFO - Parsed 395 edges.
2025-06-03 11:20:11,667 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:11,667 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:11,673 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-03 11:20:11,674 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:11,674 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-03 11:20:11,674 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-03 11:20:11,674 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:11,677 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:11,677 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:11,677 - DEBUG - Shape of encoded categorical edge features: torch.Size([395, 2])
2025-06-03 11:20:11,678 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:11,678 - DEBUG - Shape of scaled numerical edge features: torch.Size([395, 20])
2025-06-03 11:20:11,678 - DEBUG - Final edge attributes tensor shape: torch.Size([395, 22])
2025-06-03 11:20:11,678 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:11,678 - INFO - Performing online update...
2025-06-03 11:20:11,679 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:11,679 - DEBUG - Updated RunningStats: new_mean=0.6233608820260574, new_var=62400000000011.71, new_n=6270
2025-06-03 11:20:11,679 - DEBUG - Updated RunningStats: new_mean=0.6234142775612176, new_var=62700000000006.99, new_n=6300
2025-06-03 11:20:11,679 - DEBUG - Updated RunningStats: new_mean=0.8343519877228579, new_var=33520000000028.125, new_n=3374
2025-06-03 11:20:11,679 - DEBUG - Updated RunningStats: new_mean=0.8356313271295767, new_var=33740000000002.547, new_n=3396
2025-06-03 11:20:11,679 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:11,679 - DEBUG - Online update step: 1/50
2025-06-03 11:20:11,679 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,679 - DEBUG - Online update step: 2/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 3/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 4/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 5/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 6/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 7/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 8/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 9/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 10/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 11/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 12/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 13/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 14/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 15/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 16/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 17/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 18/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 19/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 20/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 21/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 22/50
2025-06-03 11:20:11,680 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,680 - DEBUG - Online update step: 23/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 24/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 25/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 26/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 27/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 28/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 29/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 30/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 31/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 32/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 33/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 34/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 35/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 36/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 37/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 38/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 39/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 40/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 41/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 42/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 43/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 44/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,681 - DEBUG - Online update step: 45/50
2025-06-03 11:20:11,681 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - DEBUG - Online update step: 46/50
2025-06-03 11:20:11,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - DEBUG - Online update step: 47/50
2025-06-03 11:20:11,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - DEBUG - Online update step: 48/50
2025-06-03 11:20:11,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - DEBUG - Online update step: 49/50
2025-06-03 11:20:11,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - DEBUG - Online update step: 50/50
2025-06-03 11:20:11,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,682 - WARNING - No successful steps during online update.
2025-06-03 11:20:11,682 - DEBUG - Current node mean: [ 1.8626451e-08 -1.8626451e-08  5.2154064e-08  3.9115548e-08
 -1.8626451e-08 -3.9115548e-08 -1.8626451e-08  3.5390258e-08
  0.0000000e+00  7.4505806e-09  3.1664968e-08 -1.1175871e-08
 -2.0489097e-08 -9.3132257e-09 -1.6763806e-08 -2.9802322e-08
 -3.3527613e-08  0.0000000e+00  0.0000000e+00 -4.6566129e-09
  0.0000000e+00  0.0000000e+00 -4.6566129e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.3265823e+00  4.5645571e+00  1.2071827e-09 -9.6574615e-09
  3.6215480e-09  4.8287307e-09  7.2430959e-09 -6.6395049e-09
 -3.6215480e-09  0.0000000e+00 -4.8287307e-09 -4.8287307e-09
 -2.4143654e-09  4.8287307e-09  9.6574615e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.8287307e-09]
2025-06-03 11:20:11,682 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.1926
2025-06-03 11:20:11,682 - WARNING - Feature drift detected (2 consecutive)
2025-06-03 11:20:11,683 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:11,683 - INFO - Running anomaly detection...
2025-06-03 11:20:11,683 - INFO - Starting anomaly detection.
2025-06-03 11:20:11,689 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112011_update_4.json
2025-06-03 11:20:11,689 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:11,696 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112011_update_4.pth and as latest_checkpoint.pth
2025-06-03 11:20:11,696 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.3476
2025-06-03 11:20:11,696 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-03 11:20:11,696 - WARNING -   Node ID: 192.168.27.10, Recon Error: 395.4370, MLP Score: 0.0000
2025-06-03 11:20:11,696 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:20:11,696 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.2998, MLP Score: 1.0000
2025-06-03 11:20:11,696 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.8523, MLP Score: 1.0000
2025-06-03 11:20:11,696 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.8719, MLP Score: 1.0000
2025-06-03 11:20:11,696 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.6084, MLP Score: 1.0000
2025-06-03 11:20:11,696 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.2857, MLP Score: 1.0000
2025-06-03 11:20:11,696 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-03 11:20:11,696 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-03 11:20:11,696 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot file.
2025-06-03 11:20:11,702 - INFO - Parsed 300 nodes.
2025-06-03 11:20:11,708 - INFO - Parsed 503 edges.
2025-06-03 11:20:11,907 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:11,908 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:11,914 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-03 11:20:11,915 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:11,916 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-03 11:20:11,916 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-03 11:20:11,916 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:11,922 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:11,922 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:11,923 - DEBUG - Shape of encoded categorical edge features: torch.Size([503, 2])
2025-06-03 11:20:11,924 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:11,925 - DEBUG - Shape of scaled numerical edge features: torch.Size([503, 20])
2025-06-03 11:20:11,925 - DEBUG - Final edge attributes tensor shape: torch.Size([503, 22])
2025-06-03 11:20:11,925 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:11,925 - INFO - Performing online update...
2025-06-03 11:20:11,925 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:11,926 - DEBUG - Updated RunningStats: new_mean=0.6204597075267321, new_var=63000000000011.6, new_n=6330
2025-06-03 11:20:11,926 - DEBUG - Updated RunningStats: new_mean=0.6205254236721476, new_var=63300000000007.0, new_n=6360
2025-06-03 11:20:11,926 - DEBUG - Updated RunningStats: new_mean=0.8320099330273566, new_var=33960000000028.688, new_n=3418
2025-06-03 11:20:11,926 - DEBUG - Updated RunningStats: new_mean=0.8332663408778522, new_var=34180000000002.348, new_n=3440
2025-06-03 11:20:11,926 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:11,927 - DEBUG - Online update step: 1/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 2/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 3/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 4/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 5/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 6/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 7/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 8/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 9/50
2025-06-03 11:20:11,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,927 - DEBUG - Online update step: 10/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 11/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 12/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 13/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 14/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 15/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 16/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 17/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 18/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 19/50
2025-06-03 11:20:11,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,928 - DEBUG - Online update step: 20/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 21/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 22/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 23/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 24/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 25/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 26/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 27/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,929 - DEBUG - Online update step: 28/50
2025-06-03 11:20:11,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 29/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 30/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 31/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 32/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 33/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 34/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 35/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 36/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 37/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 38/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 39/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 40/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 41/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 42/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 43/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 44/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 45/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 46/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 47/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 48/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 49/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - DEBUG - Online update step: 50/50
2025-06-03 11:20:11,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:11,930 - WARNING - No successful steps during online update.
2025-06-03 11:20:11,931 - DEBUG - Current node mean: [-1.9073486e-08  2.2252401e-08 -2.7020773e-08 -2.5431316e-08
  1.8278758e-08  1.5099843e-08 -1.7484028e-08  2.5431316e-08
 -1.5894572e-09  9.5367430e-09  0.0000000e+00  1.2715658e-08
 -2.5431316e-08 -6.3578289e-09 -2.3841858e-08  1.2715658e-08
  2.8610229e-08  0.0000000e+00  0.0000000e+00 -6.3578289e-09
  0.0000000e+00  0.0000000e+00  1.6490619e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.3638171e+00  4.6421471e+00  8.0578841e-09  0.0000000e+00
  3.7919454e-09  7.5838908e-09  9.4798640e-09  4.0289421e-09
  3.7919454e-09 -3.7919454e-09 -1.1375837e-08  1.8959727e-09
  4.7399318e-10 -1.7063755e-08  1.8959728e-08 -5.6879186e-09
 -5.6879186e-09 -5.6879186e-09 -5.6879186e-09 -5.6879186e-09
 -5.6879186e-09  3.7919454e-09]
2025-06-03 11:20:11,931 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0784
2025-06-03 11:20:11,931 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:11,931 - INFO - Running anomaly detection...
2025-06-03 11:20:11,931 - INFO - Starting anomaly detection.
2025-06-03 11:20:11,937 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112011_update_5.json
2025-06-03 11:20:11,937 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:11,943 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112011_update_5.pth and as latest_checkpoint.pth
2025-06-03 11:20:11,943 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.3019
2025-06-03 11:20:11,943 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:11,943 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:20:11,943 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.9091, MLP Score: 1.0000
2025-06-03 11:20:11,943 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.0601, MLP Score: 1.0000
2025-06-03 11:20:11,944 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.2189, MLP Score: 1.0000
2025-06-03 11:20:11,944 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.9327, MLP Score: 1.0000
2025-06-03 11:20:11,944 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7778, MLP Score: 1.0000
2025-06-03 11:20:11,944 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-03 11:20:11,944 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-03 11:20:11,944 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot file.
2025-06-03 11:20:11,950 - INFO - Parsed 366 nodes.
2025-06-03 11:20:11,956 - INFO - Parsed 657 edges.
2025-06-03 11:20:12,031 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:12,031 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:12,038 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-03 11:20:12,039 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:12,039 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-03 11:20:12,039 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-03 11:20:12,039 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:12,042 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:12,043 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:12,044 - DEBUG - Shape of encoded categorical edge features: torch.Size([657, 2])
2025-06-03 11:20:12,044 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:12,044 - DEBUG - Shape of scaled numerical edge features: torch.Size([657, 20])
2025-06-03 11:20:12,045 - DEBUG - Final edge attributes tensor shape: torch.Size([657, 22])
2025-06-03 11:20:12,045 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:12,045 - INFO - Performing online update...
2025-06-03 11:20:12,045 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:12,045 - DEBUG - Updated RunningStats: new_mean=0.6176121587771461, new_var=63600000000011.5, new_n=6390
2025-06-03 11:20:12,045 - DEBUG - Updated RunningStats: new_mean=0.6176896734686539, new_var=63900000000006.99, new_n=6420
2025-06-03 11:20:12,045 - DEBUG - Updated RunningStats: new_mean=0.8297464850568297, new_var=34400000000029.605, new_n=3462
2025-06-03 11:20:12,046 - DEBUG - Updated RunningStats: new_mean=0.8309706933316647, new_var=34620000000002.07, new_n=3484
2025-06-03 11:20:12,046 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:12,046 - DEBUG - Online update step: 1/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 2/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 3/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 4/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 5/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 6/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 7/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 8/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 9/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 10/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 11/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 12/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 13/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 14/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 15/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 16/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 17/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 18/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 19/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 20/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,046 - DEBUG - Online update step: 21/50
2025-06-03 11:20:12,046 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 22/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 23/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 24/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 25/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 26/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 27/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 28/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 29/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 30/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 31/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 32/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 33/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 34/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 35/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 36/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 37/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 38/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 39/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 40/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 41/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 42/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 43/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 44/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 45/50
2025-06-03 11:20:12,047 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,047 - DEBUG - Online update step: 46/50
2025-06-03 11:20:12,048 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,048 - DEBUG - Online update step: 47/50
2025-06-03 11:20:12,048 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,048 - DEBUG - Online update step: 48/50
2025-06-03 11:20:12,048 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,048 - DEBUG - Online update step: 49/50
2025-06-03 11:20:12,048 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,048 - DEBUG - Online update step: 50/50
2025-06-03 11:20:12,048 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:12,048 - WARNING - No successful steps during online update.
2025-06-03 11:20:12,048 - DEBUG - Current node mean: [-1.69368395e-08  1.69368395e-08 -5.21133492e-09 -1.30283375e-08
 -1.04226698e-08 -1.36797542e-08 -2.80109251e-08 -2.60566746e-09
 -2.60566746e-09 -1.17255041e-08  3.38736790e-08  2.14967564e-08
  5.21133492e-09  2.08453397e-08  2.86623436e-08 -4.03878460e-08
  2.27995915e-08  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  2.58938204e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.3805175e+00  4.7656012e+00  4.3546771e-09 -2.7216732e-10
  2.8123956e-09 -1.6783652e-09  8.7093541e-09  1.4515591e-09
  5.8062364e-09  5.4433467e-09  8.7093541e-09 -5.8062364e-09
 -7.2577953e-09 -1.7237264e-09 -2.9031182e-09 -1.4515591e-09
 -1.4515591e-09 -1.4515591e-09 -1.4515591e-09 -1.4515591e-09
 -1.4515591e-09 -2.9031182e-09]
2025-06-03 11:20:12,048 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0582
2025-06-03 11:20:12,048 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:12,049 - INFO - Running anomaly detection...
2025-06-03 11:20:12,049 - INFO - Starting anomaly detection.
2025-06-03 11:20:12,056 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112012_update_6.json
2025-06-03 11:20:12,056 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:12,062 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112012_update_6.pth and as latest_checkpoint.pth
2025-06-03 11:20:12,062 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.3351
2025-06-03 11:20:12,062 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:12,062 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 11:20:12,062 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.5428, MLP Score: 1.0000
2025-06-03 11:20:12,062 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.8602, MLP Score: 1.0000
2025-06-03 11:20:12,062 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.9523, MLP Score: 1.0000
2025-06-03 11:20:12,062 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.6335, MLP Score: 1.0000
2025-06-03 11:20:12,062 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.0618, MLP Score: 1.0000
2025-06-03 11:20:12,062 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:20:12,062 - INFO - Performing visualization of node and edge features.
2025-06-03 11:20:12,062 - INFO - Starting visualization of node features.
2025-06-03 11:20:12,062 - INFO - Graph has 366 nodes and 30 features.
2025-06-03 11:20:12,062 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:20:12,063 - INFO - Calculating feature statistics:
2025-06-03 11:20:12,063 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-0.15107578), 'max': np.float32(6.6863217)}
2025-06-03 11:20:12,063 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(1.30283375e-08), 'std': np.float32(1.0), 'min': np.float32(-6.6863217), 'max': np.float32(0.15107578)}
2025-06-03 11:20:12,063 - INFO - - server_score: {'name': 'server_score', 'unique': 10, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4653895), 'max': np.float32(4.9267626)}
2025-06-03 11:20:12,063 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.11681133), 'max': np.float32(11.080514)}
2025-06-03 11:20:12,063 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.567014), 'max': np.float32(3.9940214)}
2025-06-03 11:20:12,063 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 10, 'mean': np.float32(-1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-0.568302), 'max': np.float32(2.0543187)}
2025-06-03 11:20:12,063 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 10, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6313567), 'max': np.float32(0.5527793)}
2025-06-03 11:20:12,063 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(1.042267e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12357184), 'max': np.float32(10.518145)}
2025-06-03 11:20:12,063 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(-1.3028337e-09), 'std': np.float32(1.0), 'min': np.float32(-3.615443), 'max': np.float32(14.461772)}
2025-06-03 11:20:12,063 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(-1.1725504e-08), 'std': np.float32(1.0), 'min': np.float32(-0.12860057), 'max': np.float32(8.708076)}
2025-06-03 11:20:12,063 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 10, 'mean': np.float32(4.169068e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2291522), 'max': np.float32(0.83115166)}
2025-06-03 11:20:12,064 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 5, 'mean': np.float32(5.211335e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.14717494), 'max': np.float32(7.050298)}
2025-06-03 11:20:12,064 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(1.4331172e-08), 'std': np.float32(0.99999994), 'min': np.float32(-5.8913436), 'max': np.float32(0.17400593)}
2025-06-03 11:20:12,064 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2045138), 'max': np.float32(2.5324697)}
2025-06-03 11:20:12,064 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(-1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5098004), 'max': np.float32(1.2227579)}
2025-06-03 11:20:12,064 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8442478), 'max': np.float32(3.5091558)}
2025-06-03 11:20:12,064 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-3.477314), 'max': np.float32(0.8536967)}
2025-06-03 11:20:12,064 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 9, 'mean': np.float32(1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-5.5407624), 'max': np.float32(0.200816)}
2025-06-03 11:20:12,064 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 10, 'mean': np.float32(2.084534e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0776258), 'max': np.float32(3.238297)}
2025-06-03 11:20:12,064 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,064 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,065 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,065 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,065 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:12,076 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b40203e30>
2025-06-03 11:20:12,214 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:20:12,270 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:20:12,297 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:20:13,575 - INFO - Node feature visualization saved to vis/node_features_20250603_112012.png
2025-06-03 11:20:13,575 - INFO - Finished visualization of node features.
2025-06-03 11:20:13,575 - INFO - Performing additional feature analysis:
2025-06-03 11:20:13,575 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:20:13,575 - INFO - Starting visualization of edge features.
2025-06-03 11:20:13,575 - INFO - Graph has 657 edges and 22 edge features.
2025-06-03 11:20:13,575 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:20:13,575 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:20:13,575 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-03 11:20:13,575 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-03 11:20:13,576 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot file.
2025-06-03 11:20:13,583 - INFO - Parsed 392 nodes.
2025-06-03 11:20:13,590 - INFO - Parsed 753 edges.
2025-06-03 11:20:13,678 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:13,679 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:13,686 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-03 11:20:13,687 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:13,687 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-03 11:20:13,688 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-03 11:20:13,688 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:13,692 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:13,693 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:13,693 - DEBUG - Shape of encoded categorical edge features: torch.Size([753, 2])
2025-06-03 11:20:13,694 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:13,694 - DEBUG - Shape of scaled numerical edge features: torch.Size([753, 20])
2025-06-03 11:20:13,694 - DEBUG - Final edge attributes tensor shape: torch.Size([753, 22])
2025-06-03 11:20:13,694 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:13,694 - INFO - Performing online update...
2025-06-03 11:20:13,695 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:13,695 - DEBUG - Updated RunningStats: new_mean=0.6148166982487817, new_var=64200000000011.39, new_n=6450
2025-06-03 11:20:13,695 - DEBUG - Updated RunningStats: new_mean=0.6149061704645626, new_var=64500000000006.99, new_n=6480
2025-06-03 11:20:13,695 - DEBUG - Updated RunningStats: new_mean=0.8275328908506241, new_var=34840000000030.047, new_n=3506
2025-06-03 11:20:13,695 - DEBUG - Updated RunningStats: new_mean=0.8287356386127611, new_var=35060000000001.926, new_n=3528
2025-06-03 11:20:13,695 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:13,695 - DEBUG - Online update step: 1/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 2/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 3/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 4/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 5/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 6/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 7/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 8/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 9/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 10/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 11/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 12/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 13/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 14/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 15/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 16/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 17/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 18/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 19/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 20/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 21/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 22/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,696 - DEBUG - Online update step: 23/50
2025-06-03 11:20:13,696 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 24/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 25/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 26/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 27/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 28/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 29/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 30/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 31/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 32/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 33/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 34/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 35/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 36/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 37/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 38/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 39/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 40/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 41/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 42/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 43/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 44/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 45/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,697 - DEBUG - Online update step: 46/50
2025-06-03 11:20:13,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,698 - DEBUG - Online update step: 47/50
2025-06-03 11:20:13,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,698 - DEBUG - Online update step: 48/50
2025-06-03 11:20:13,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,698 - DEBUG - Online update step: 49/50
2025-06-03 11:20:13,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,698 - DEBUG - Online update step: 50/50
2025-06-03 11:20:13,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,698 - WARNING - No successful steps during online update.
2025-06-03 11:20:13,698 - DEBUG - Current node mean: [ 2.4328427e-08 -2.4328427e-08  2.0679163e-08 -4.8656852e-09
  2.9194112e-08  4.8656852e-09 -5.8388224e-08 -1.9462741e-08
  9.7313704e-09  2.0679163e-08  1.2164214e-08  0.0000000e+00
  2.4328427e-08  3.4668009e-08 -9.7313704e-09 -9.7313704e-09
  2.4328427e-08  0.0000000e+00  0.0000000e+00 -3.5276219e-08
  0.0000000e+00  0.0000000e+00 -7.2985280e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4037185e+00  4.8247013e+00  0.0000000e+00 -6.3324990e-09
 -5.0659992e-09  1.2664998e-09 -2.5329996e-09 -2.5329996e-09
 -7.5989988e-09  6.3324990e-09 -8.8654986e-09  2.5329996e-09
  3.1662495e-09  2.0263997e-08 -1.7730997e-08 -1.5831247e-09
 -1.5831247e-09 -1.5831247e-09 -1.5831247e-09 -1.5831247e-09
 -1.5831247e-09  6.3324990e-10]
2025-06-03 11:20:13,698 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0466
2025-06-03 11:20:13,699 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:13,699 - INFO - Running anomaly detection...
2025-06-03 11:20:13,699 - INFO - Starting anomaly detection.
2025-06-03 11:20:13,706 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112013_update_7.json
2025-06-03 11:20:13,707 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:13,713 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112013_update_7.pth and as latest_checkpoint.pth
2025-06-03 11:20:13,713 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.3446
2025-06-03 11:20:13,713 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:13,713 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:20:13,713 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.4237, MLP Score: 1.0000
2025-06-03 11:20:13,713 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.8047, MLP Score: 1.0000
2025-06-03 11:20:13,713 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.8402, MLP Score: 1.0000
2025-06-03 11:20:13,713 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.5667, MLP Score: 1.0000
2025-06-03 11:20:13,713 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 5.6306, MLP Score: 1.0000
2025-06-03 11:20:13,713 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-03 11:20:13,713 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-03 11:20:13,713 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot file.
2025-06-03 11:20:13,722 - INFO - Parsed 419 nodes.
2025-06-03 11:20:13,730 - INFO - Parsed 833 edges.
2025-06-03 11:20:13,836 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:13,836 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:13,845 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-03 11:20:13,847 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:13,848 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-03 11:20:13,849 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-03 11:20:13,849 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:13,854 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:13,855 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:13,857 - DEBUG - Shape of encoded categorical edge features: torch.Size([833, 2])
2025-06-03 11:20:13,858 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:13,859 - DEBUG - Shape of scaled numerical edge features: torch.Size([833, 20])
2025-06-03 11:20:13,859 - DEBUG - Final edge attributes tensor shape: torch.Size([833, 22])
2025-06-03 11:20:13,859 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:13,859 - INFO - Performing online update...
2025-06-03 11:20:13,859 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:13,860 - DEBUG - Updated RunningStats: new_mean=0.6120725014587654, new_var=64800000000011.29, new_n=6510
2025-06-03 11:20:13,860 - DEBUG - Updated RunningStats: new_mean=0.6121735011744525, new_var=65100000000007.0, new_n=6540
2025-06-03 11:20:13,860 - DEBUG - Updated RunningStats: new_mean=0.8253684069093514, new_var=35280000000030.3, new_n=3550
2025-06-03 11:20:13,860 - DEBUG - Updated RunningStats: new_mean=0.8265545209695615, new_var=35500000000001.83, new_n=3572
2025-06-03 11:20:13,861 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:13,861 - DEBUG - Online update step: 1/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 2/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 3/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 4/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 5/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 6/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 7/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 8/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 9/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 10/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 11/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 12/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 13/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 14/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 15/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 16/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 17/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 18/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,861 - DEBUG - Online update step: 19/50
2025-06-03 11:20:13,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 20/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 21/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 22/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 23/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 24/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 25/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 26/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 27/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 28/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 29/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 30/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 31/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 32/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 33/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 34/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 35/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 36/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 37/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 38/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 39/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 40/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,862 - DEBUG - Online update step: 41/50
2025-06-03 11:20:13,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 42/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 43/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 44/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 45/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 46/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 47/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 48/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 49/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - DEBUG - Online update step: 50/50
2025-06-03 11:20:13,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:13,863 - WARNING - No successful steps during online update.
2025-06-03 11:20:13,864 - DEBUG - Current node mean: [ 7.96625343e-09 -7.96625343e-09  1.59325069e-08 -9.10428977e-09
 -9.10428977e-09 -1.82085795e-08 -2.27607231e-08 -1.47944705e-08
 -1.59325069e-08 -2.27607244e-09  1.13803615e-08 -2.04846504e-08
  2.27607244e-09  1.19493802e-08 -4.15383212e-08  7.96625343e-09
  2.27607244e-09  0.00000000e+00  0.00000000e+00  2.04846504e-08
  0.00000000e+00  0.00000000e+00 -3.18650137e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4177670e+00  4.8607445e+00 -1.4310839e-09 -1.7173006e-09
  7.4416362e-09 -5.7243355e-10  0.0000000e+00  2.0750717e-09
  0.0000000e+00 -3.4346013e-09 -2.2468017e-08  1.1448671e-09
 -4.2932515e-09 -1.0590021e-08 -2.2897342e-09  2.2897342e-09
  2.2897342e-09  2.2897342e-09  2.2897342e-09  2.2897342e-09
  2.2897342e-09  5.7243355e-10]
2025-06-03 11:20:13,864 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0280
2025-06-03 11:20:13,864 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:13,865 - INFO - Running anomaly detection...
2025-06-03 11:20:13,865 - INFO - Starting anomaly detection.
2025-06-03 11:20:13,902 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112013_update_8.json
2025-06-03 11:20:13,902 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:13,908 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112013_update_8.pth and as latest_checkpoint.pth
2025-06-03 11:20:13,908 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.3225
2025-06-03 11:20:13,908 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:13,908 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:20:13,908 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.4034, MLP Score: 1.0000
2025-06-03 11:20:13,909 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.4916, MLP Score: 1.0000
2025-06-03 11:20:13,909 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8325, MLP Score: 1.0000
2025-06-03 11:20:13,909 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.8306, MLP Score: 1.0000
2025-06-03 11:20:13,909 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.0488, MLP Score: 1.0000
2025-06-03 11:20:13,909 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-03 11:20:13,909 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-03 11:20:13,909 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot file.
2025-06-03 11:20:13,917 - INFO - Parsed 439 nodes.
2025-06-03 11:20:13,926 - INFO - Parsed 919 edges.
2025-06-03 11:20:14,044 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:14,044 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:14,053 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-03 11:20:14,055 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:14,055 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-03 11:20:14,056 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-03 11:20:14,056 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:14,061 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:14,063 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:14,064 - DEBUG - Shape of encoded categorical edge features: torch.Size([919, 2])
2025-06-03 11:20:14,065 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:14,065 - DEBUG - Shape of scaled numerical edge features: torch.Size([919, 20])
2025-06-03 11:20:14,065 - DEBUG - Final edge attributes tensor shape: torch.Size([919, 22])
2025-06-03 11:20:14,065 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:14,065 - INFO - Performing online update...
2025-06-03 11:20:14,065 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:14,066 - DEBUG - Updated RunningStats: new_mean=0.6093781883668383, new_var=65400000000011.19, new_n=6570
2025-06-03 11:20:14,066 - DEBUG - Updated RunningStats: new_mean=0.6094903597859606, new_var=65700000000007.0, new_n=6600
2025-06-03 11:20:14,066 - DEBUG - Updated RunningStats: new_mean=0.8232458147915624, new_var=35720000000030.2, new_n=3594
2025-06-03 11:20:14,066 - DEBUG - Updated RunningStats: new_mean=0.8244287018052543, new_var=35940000000001.82, new_n=3616
2025-06-03 11:20:14,067 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:14,067 - DEBUG - Online update step: 1/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 2/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 3/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 4/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 5/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 6/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 7/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 8/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 9/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 10/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 11/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 12/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 13/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 14/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 15/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 16/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 17/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 18/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 19/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 20/50
2025-06-03 11:20:14,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,067 - DEBUG - Online update step: 21/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 22/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 23/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 24/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 25/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 26/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 27/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 28/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 29/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 30/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 31/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 32/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 33/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 34/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 35/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 36/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 37/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 38/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 39/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 40/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 41/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 42/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 43/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,068 - DEBUG - Online update step: 44/50
2025-06-03 11:20:14,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 45/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 46/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 47/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 48/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 49/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - DEBUG - Online update step: 50/50
2025-06-03 11:20:14,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,069 - WARNING - No successful steps during online update.
2025-06-03 11:20:14,069 - DEBUG - Current node mean: [ 2.9327115e-08 -2.8240924e-08 -2.8512472e-09  1.4120462e-08
 -3.2585683e-09  0.0000000e+00  1.0861895e-09  9.2326102e-09
 -1.1948083e-08 -2.4982358e-08  0.0000000e+00 -3.8016630e-08
  9.7757047e-09 -2.2266883e-08 -1.2491179e-08 -5.2680186e-08
 -1.7379032e-08  0.0000000e+00  0.0000000e+00  3.8831271e-08
  0.0000000e+00  0.0000000e+00  9.5041575e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4417845e+00  4.8509250e+00  0.0000000e+00 -2.0754609e-09
  0.0000000e+00  1.0377305e-09 -2.0754609e-09 -3.1131915e-09
  2.5943263e-09  2.8537588e-09 -1.2452766e-08  1.5565957e-09
  9.8584394e-09 -8.3018437e-09 -1.4528227e-08  2.0754609e-09
  2.0754609e-09  2.0754609e-09  2.0754609e-09  2.0754609e-09
  2.0754609e-09  0.0000000e+00]
2025-06-03 11:20:14,070 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0477
2025-06-03 11:20:14,070 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:14,070 - INFO - Running anomaly detection...
2025-06-03 11:20:14,070 - INFO - Starting anomaly detection.
2025-06-03 11:20:14,139 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112014_update_9.json
2025-06-03 11:20:14,140 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:14,148 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112014_update_9.pth and as latest_checkpoint.pth
2025-06-03 11:20:14,148 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.2801
2025-06-03 11:20:14,148 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:14,148 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:20:14,148 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.4769, MLP Score: 1.0000
2025-06-03 11:20:14,148 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8002, MLP Score: 1.0000
2025-06-03 11:20:14,148 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.6364, MLP Score: 1.0000
2025-06-03 11:20:14,148 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.0509, MLP Score: 1.0000
2025-06-03 11:20:14,148 - WARNING -   Source: 192.168.27.10, Target: 142.250.197.78, Recon Error: 1.4889, MLP Score: 1.0000
2025-06-03 11:20:14,148 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-03 11:20:14,148 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-03 11:20:14,148 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot file.
2025-06-03 11:20:14,160 - INFO - Parsed 511 nodes.
2025-06-03 11:20:14,172 - INFO - Parsed 1044 edges.
2025-06-03 11:20:14,339 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:14,339 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:14,350 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-03 11:20:14,352 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:14,354 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-03 11:20:14,355 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-03 11:20:14,355 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:14,361 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:14,362 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:14,363 - DEBUG - Shape of encoded categorical edge features: torch.Size([1044, 2])
2025-06-03 11:20:14,365 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:14,365 - DEBUG - Shape of scaled numerical edge features: torch.Size([1044, 20])
2025-06-03 11:20:14,365 - DEBUG - Final edge attributes tensor shape: torch.Size([1044, 22])
2025-06-03 11:20:14,365 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:14,365 - INFO - Performing online update...
2025-06-03 11:20:14,365 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:14,366 - DEBUG - Updated RunningStats: new_mean=0.6067324848623322, new_var=66000000000011.09, new_n=6630
2025-06-03 11:20:14,366 - DEBUG - Updated RunningStats: new_mean=0.6068551040156314, new_var=66300000000007.0, new_n=6660
2025-06-03 11:20:14,366 - DEBUG - Updated RunningStats: new_mean=0.8211634981946004, new_var=36160000000030.12, new_n=3638
2025-06-03 11:20:14,366 - DEBUG - Updated RunningStats: new_mean=0.8223545049278319, new_var=36380000000001.94, new_n=3660
2025-06-03 11:20:14,366 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:14,366 - DEBUG - Online update step: 1/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 2/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 3/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 4/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 5/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 6/50
2025-06-03 11:20:14,366 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,366 - DEBUG - Online update step: 7/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 8/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 9/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 10/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 11/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 12/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 13/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 14/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 15/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 16/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 17/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 18/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 19/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 20/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 21/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 22/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 23/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 24/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 25/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 26/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 27/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 28/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,367 - DEBUG - Online update step: 29/50
2025-06-03 11:20:14,367 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 30/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 31/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 32/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 33/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 34/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 35/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 36/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 37/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 38/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 39/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 40/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 41/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 42/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 43/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 44/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 45/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 46/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 47/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 48/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 49/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - DEBUG - Online update step: 50/50
2025-06-03 11:20:14,368 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,368 - WARNING - No successful steps during online update.
2025-06-03 11:20:14,369 - DEBUG - Current node mean: [-1.4697036e-08  1.5163609e-08 -1.4930322e-08  0.0000000e+00
 -3.3593224e-08  3.3593224e-08 -4.4790966e-08  1.0264596e-08
  1.5863467e-08  1.4930322e-08 -1.1197741e-08 -3.7325805e-09
  4.1991530e-08  1.8662902e-08  2.4261773e-08 -1.4930322e-08
 -2.2395483e-08  0.0000000e+00  0.0000000e+00  5.5988707e-09
  0.0000000e+00  0.0000000e+00  2.9860644e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4061303e+00  4.8524904e+00  2.6262583e-09  0.0000000e+00
  2.7404434e-09  0.0000000e+00  7.3078490e-09 -1.3702217e-09
 -7.3078490e-09 -1.2331996e-08 -5.8234422e-09 -5.0241464e-09
  7.6504048e-09  9.5915524e-09 -1.4615698e-08 -2.7404434e-09
 -2.7404434e-09 -2.7404434e-09 -2.7404434e-09 -2.7404434e-09
 -2.7404434e-09 -1.8269622e-09]
2025-06-03 11:20:14,369 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0702
2025-06-03 11:20:14,370 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:14,370 - INFO - Running anomaly detection...
2025-06-03 11:20:14,370 - INFO - Starting anomaly detection.
2025-06-03 11:20:14,402 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112014_update_10.json
2025-06-03 11:20:14,402 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:14,408 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112014_update_10.pth and as latest_checkpoint.pth
2025-06-03 11:20:14,408 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.2600
2025-06-03 11:20:14,408 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:14,408 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:20:14,408 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 1.4435, MLP Score: 1.0000
2025-06-03 11:20:14,408 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 2.8333, MLP Score: 1.0000
2025-06-03 11:20:14,408 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.4348, MLP Score: 1.0000
2025-06-03 11:20:14,409 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 6.1827, MLP Score: 1.0000
2025-06-03 11:20:14,409 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.5318, MLP Score: 1.0000
2025-06-03 11:20:14,409 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-03 11:20:14,409 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-03 11:20:14,409 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot file.
2025-06-03 11:20:14,421 - INFO - Parsed 547 nodes.
2025-06-03 11:20:14,433 - INFO - Parsed 1118 edges.
2025-06-03 11:20:14,620 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:14,620 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:14,631 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-03 11:20:14,633 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:14,633 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-03 11:20:14,634 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-03 11:20:14,634 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:14,640 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:14,641 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:14,642 - DEBUG - Shape of encoded categorical edge features: torch.Size([1118, 2])
2025-06-03 11:20:14,644 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:14,644 - DEBUG - Shape of scaled numerical edge features: torch.Size([1118, 20])
2025-06-03 11:20:14,645 - DEBUG - Final edge attributes tensor shape: torch.Size([1118, 22])
2025-06-03 11:20:14,645 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:14,645 - INFO - Performing online update...
2025-06-03 11:20:14,645 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:14,645 - DEBUG - Updated RunningStats: new_mean=0.6041337806745475, new_var=66600000000011.0, new_n=6690
2025-06-03 11:20:14,646 - DEBUG - Updated RunningStats: new_mean=0.604266723779516, new_var=66900000000007.0, new_n=6720
2025-06-03 11:20:14,646 - DEBUG - Updated RunningStats: new_mean=0.8191511262873202, new_var=36600000000030.41, new_n=3682
2025-06-03 11:20:14,646 - DEBUG - Updated RunningStats: new_mean=0.8203305608730967, new_var=36820000000001.88, new_n=3704
2025-06-03 11:20:14,646 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:14,646 - DEBUG - Online update step: 1/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 2/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 3/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 4/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 5/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 6/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 7/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 8/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,646 - DEBUG - Online update step: 9/50
2025-06-03 11:20:14,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 10/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 11/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 12/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 13/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 14/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 15/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 16/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 17/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 18/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 19/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 20/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 21/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 22/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 23/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 24/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 25/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 26/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 27/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 28/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 29/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 30/50
2025-06-03 11:20:14,647 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,647 - DEBUG - Online update step: 31/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 32/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 33/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 34/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 35/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 36/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 37/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 38/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 39/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 40/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 41/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 42/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 43/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 44/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 45/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 46/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 47/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 48/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 49/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - DEBUG - Online update step: 50/50
2025-06-03 11:20:14,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:14,648 - WARNING - No successful steps during online update.
2025-06-03 11:20:14,649 - DEBUG - Current node mean: [ 2.4408484e-08 -2.4408484e-08  3.8356188e-08 -2.6151946e-08
 -1.5691167e-08  2.7895410e-08  6.9738526e-09 -2.0921558e-08
 -3.1382335e-08 -8.7173158e-09  6.9738526e-09  1.7434632e-08
 -2.6151946e-08 -8.7173158e-10 -6.9738526e-09  1.6562899e-08
 -1.4383571e-08  0.0000000e+00  0.0000000e+00  2.3100887e-08
  0.0000000e+00  0.0000000e+00 -1.7434632e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4025044e+00  4.8944545e+00  1.7060363e-09 -8.5301816e-10
  0.0000000e+00  8.5301816e-10  8.5301819e-09  5.5446181e-09
  1.7060363e-09  4.2650909e-09 -6.3976362e-09  7.6771638e-09
  0.0000000e+00 -8.5301816e-10  5.9711271e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.5590545e-09]
2025-06-03 11:20:14,649 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0219
2025-06-03 11:20:14,650 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:14,650 - INFO - Running anomaly detection...
2025-06-03 11:20:14,650 - INFO - Starting anomaly detection.
2025-06-03 11:20:14,680 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112014_update_11.json
2025-06-03 11:20:14,680 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:14,692 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112014_update_11.pth and as latest_checkpoint.pth
2025-06-03 11:20:14,692 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.2421
2025-06-03 11:20:14,692 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:14,692 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 11:20:14,692 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.9939, MLP Score: 1.0000
2025-06-03 11:20:14,693 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.0368, MLP Score: 1.0000
2025-06-03 11:20:14,693 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.7537, MLP Score: 1.0000
2025-06-03 11:20:14,693 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.5134, MLP Score: 1.0000
2025-06-03 11:20:14,693 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4424, MLP Score: 1.0000
2025-06-03 11:20:14,693 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:20:14,693 - INFO - Performing visualization of node and edge features.
2025-06-03 11:20:14,693 - INFO - Starting visualization of node features.
2025-06-03 11:20:14,693 - INFO - Graph has 547 nodes and 30 features.
2025-06-03 11:20:14,693 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:20:14,693 - INFO - Calculating feature statistics:
2025-06-03 11:20:14,693 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(1.7434632e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.12311414), 'max': np.float32(8.2043)}
2025-06-03 11:20:14,693 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-1.7434632e-08), 'std': np.float32(1.0000001), 'min': np.float32(-8.2043), 'max': np.float32(0.12311414)}
2025-06-03 11:20:14,693 - INFO - - server_score: {'name': 'server_score', 'unique': 11, 'mean': np.float32(3.1818203e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4430053), 'max': np.float32(4.351648)}
2025-06-03 11:20:14,694 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(6.9738526e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09511919), 'max': np.float32(13.263146)}
2025-06-03 11:20:14,694 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-2.0921558e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64926356), 'max': np.float32(3.5786788)}
2025-06-03 11:20:14,694 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 12, 'mean': np.float32(2.9638873e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6530039), 'max': np.float32(2.8253858)}
2025-06-03 11:20:14,694 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 11, 'mean': np.float32(-3.0510605e-09), 'std': np.float32(1.0), 'min': np.float32(-2.2739558), 'max': np.float32(0.6377714)}
2025-06-03 11:20:14,694 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 7, 'mean': np.float32(-5.2303895e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09997174), 'max': np.float32(13.921706)}
2025-06-03 11:20:14,694 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-6.9738526e-09), 'std': np.float32(1.0), 'min': np.float32(-3.9443693), 'max': np.float32(15.563497)}
2025-06-03 11:20:14,694 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.10418314), 'max': np.float32(10.671389)}
2025-06-03 11:20:14,694 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 12, 'mean': np.float32(2.1357422e-08), 'std': np.float32(1.0), 'min': np.float32(-2.042388), 'max': np.float32(0.9379485)}
2025-06-03 11:20:14,694 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-1.7434632e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11823206), 'max': np.float32(9.141702)}
2025-06-03 11:20:14,694 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-6.9738526e-09), 'std': np.float32(0.99999994), 'min': np.float32(-6.840797), 'max': np.float32(0.14908338)}
2025-06-03 11:20:14,694 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3379294), 'max': np.float32(2.591279)}
2025-06-03 11:20:14,694 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5481575), 'max': np.float32(1.3595055)}
2025-06-03 11:20:14,694 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-0.77910113), 'max': np.float32(3.8437746)}
2025-06-03 11:20:14,694 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(-1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-3.7928014), 'max': np.float32(0.7891658)}
2025-06-03 11:20:14,694 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,694 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 10, 'mean': np.float32(2.266502e-08), 'std': np.float32(1.0), 'min': np.float32(-6.472329), 'max': np.float32(0.17130168)}
2025-06-03 11:20:14,695 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 10, 'mean': np.float32(-1.7434632e-08), 'std': np.float32(1.0), 'min': np.float32(-3.543924), 'max': np.float32(3.657931)}
2025-06-03 11:20:14,695 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,695 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:14,706 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b3a5b7470>
2025-06-03 11:20:15,006 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:20:15,062 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:20:15,090 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:20:16,298 - INFO - Node feature visualization saved to vis/node_features_20250603_112015.png
2025-06-03 11:20:16,298 - INFO - Finished visualization of node features.
2025-06-03 11:20:16,298 - INFO - Performing additional feature analysis:
2025-06-03 11:20:16,298 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:20:16,299 - INFO - Starting visualization of edge features.
2025-06-03 11:20:16,299 - INFO - Graph has 1118 edges and 22 edge features.
2025-06-03 11:20:16,299 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:20:16,299 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:20:16,299 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-03 11:20:16,299 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-03 11:20:16,299 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot file.
2025-06-03 11:20:16,310 - INFO - Parsed 640 nodes.
2025-06-03 11:20:16,323 - INFO - Parsed 1300 edges.
2025-06-03 11:20:16,588 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:16,588 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:16,601 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-03 11:20:16,603 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:16,603 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-03 11:20:16,605 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-03 11:20:16,605 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:16,612 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:16,613 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:16,615 - DEBUG - Shape of encoded categorical edge features: torch.Size([1300, 2])
2025-06-03 11:20:16,617 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:16,617 - DEBUG - Shape of scaled numerical edge features: torch.Size([1300, 20])
2025-06-03 11:20:16,617 - DEBUG - Final edge attributes tensor shape: torch.Size([1300, 22])
2025-06-03 11:20:16,617 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:16,618 - INFO - Performing online update...
2025-06-03 11:20:16,618 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:16,618 - DEBUG - Updated RunningStats: new_mean=0.60158109391167, new_var=67200000000010.91, new_n=6750
2025-06-03 11:20:16,618 - DEBUG - Updated RunningStats: new_mean=0.6017237823796178, new_var=67500000000007.01, new_n=6780
2025-06-03 11:20:16,619 - DEBUG - Updated RunningStats: new_mean=0.8171918156614387, new_var=37040000000030.77, new_n=3726
2025-06-03 11:20:16,619 - DEBUG - Updated RunningStats: new_mean=0.8183553043021481, new_var=37260000000001.79, new_n=3748
2025-06-03 11:20:16,619 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:16,619 - DEBUG - Online update step: 1/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 2/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 3/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 4/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 5/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 6/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 7/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 8/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 9/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 10/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,619 - DEBUG - Online update step: 11/50
2025-06-03 11:20:16,619 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 12/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 13/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 14/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 15/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 16/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 17/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 18/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 19/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 20/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 21/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 22/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 23/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 24/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 25/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 26/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 27/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 28/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 29/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 30/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 31/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 32/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 33/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,620 - DEBUG - Online update step: 34/50
2025-06-03 11:20:16,620 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 35/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 36/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 37/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 38/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 39/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 40/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 41/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 42/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 43/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 44/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 45/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 46/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 47/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 48/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 49/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - DEBUG - Online update step: 50/50
2025-06-03 11:20:16,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,621 - WARNING - No successful steps during online update.
2025-06-03 11:20:16,622 - DEBUG - Current node mean: [-2.6822089e-08  2.6822089e-08  1.3411045e-08  8.5681675e-09
  7.5250867e-08 -2.3096799e-08 -1.1920929e-08  8.1956388e-09
  1.2293458e-08  1.3411045e-08 -9.6857544e-09  4.4703485e-09
 -7.4505806e-09  1.9371509e-08 -1.1920929e-08  7.4505807e-10
  3.7252903e-09  0.0000000e+00  0.0000000e+00  2.9802323e-09
  0.0000000e+00  0.0000000e+00  7.0780515e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4076923e+00  4.9446154e+00 -1.4671913e-09 -2.9343825e-09
  5.8687650e-09  1.4671913e-09  5.8687650e-09 -2.9343825e-09
 -1.8339891e-09 -1.1737530e-08 -8.8031475e-09 -1.1737530e-08
  1.4671913e-09 -1.3938317e-08  1.4671913e-08  5.1351692e-09
  5.1351692e-09  5.1351692e-09  5.1351692e-09  5.1351692e-09
  5.1351692e-09 -1.4671913e-09]
2025-06-03 11:20:16,622 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0267
2025-06-03 11:20:16,622 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:16,622 - INFO - Running anomaly detection...
2025-06-03 11:20:16,623 - INFO - Starting anomaly detection.
2025-06-03 11:20:16,637 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112016_update_12.json
2025-06-03 11:20:16,638 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:16,644 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112016_update_12.pth and as latest_checkpoint.pth
2025-06-03 11:20:16,644 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.2053
2025-06-03 11:20:16,644 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:16,644 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 11:20:16,644 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.1888, MLP Score: 1.0000
2025-06-03 11:20:16,644 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.1674, MLP Score: 1.0000
2025-06-03 11:20:16,644 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2552, MLP Score: 1.0000
2025-06-03 11:20:16,645 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.0888, MLP Score: 1.0000
2025-06-03 11:20:16,645 - WARNING -   Source: 192.168.27.13, Target: 35.213.7.90, Recon Error: 1.3753, MLP Score: 1.0000
2025-06-03 11:20:16,645 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-03 11:20:16,645 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-03 11:20:16,645 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot file.
2025-06-03 11:20:16,659 - INFO - Parsed 653 nodes.
2025-06-03 11:20:16,674 - INFO - Parsed 1355 edges.
2025-06-03 11:20:16,958 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:16,958 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:16,970 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-03 11:20:16,972 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:16,972 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-03 11:20:16,973 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-03 11:20:16,973 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:16,980 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:16,981 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:16,982 - DEBUG - Shape of encoded categorical edge features: torch.Size([1355, 2])
2025-06-03 11:20:16,984 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:16,984 - DEBUG - Shape of scaled numerical edge features: torch.Size([1355, 20])
2025-06-03 11:20:16,984 - DEBUG - Final edge attributes tensor shape: torch.Size([1355, 22])
2025-06-03 11:20:16,984 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:16,984 - INFO - Performing online update...
2025-06-03 11:20:16,984 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:16,985 - DEBUG - Updated RunningStats: new_mean=0.5990730167974707, new_var=67800000000010.81, new_n=6810
2025-06-03 11:20:16,985 - DEBUG - Updated RunningStats: new_mean=0.5992254107109011, new_var=68100000000007.016, new_n=6840
2025-06-03 11:20:16,985 - DEBUG - Updated RunningStats: new_mean=0.8152667979124599, new_var=37480000000030.73, new_n=3770
2025-06-03 11:20:16,985 - DEBUG - Updated RunningStats: new_mean=0.8164267091464935, new_var=37700000000001.79, new_n=3792
2025-06-03 11:20:16,985 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:16,985 - DEBUG - Online update step: 1/50
2025-06-03 11:20:16,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,985 - DEBUG - Online update step: 2/50
2025-06-03 11:20:16,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,985 - DEBUG - Online update step: 3/50
2025-06-03 11:20:16,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,985 - DEBUG - Online update step: 4/50
2025-06-03 11:20:16,985 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,985 - DEBUG - Online update step: 5/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 6/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 7/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 8/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 9/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 10/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 11/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 12/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 13/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 14/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 15/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 16/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 17/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 18/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 19/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 20/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 21/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 22/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 23/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 24/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 25/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 26/50
2025-06-03 11:20:16,986 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,986 - DEBUG - Online update step: 27/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 28/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 29/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 30/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 31/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 32/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 33/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 34/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 35/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 36/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 37/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 38/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 39/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 40/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 41/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 42/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 43/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 44/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 45/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 46/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,987 - DEBUG - Online update step: 47/50
2025-06-03 11:20:16,987 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,988 - DEBUG - Online update step: 48/50
2025-06-03 11:20:16,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,988 - DEBUG - Online update step: 49/50
2025-06-03 11:20:16,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,988 - DEBUG - Online update step: 50/50
2025-06-03 11:20:16,988 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:16,988 - WARNING - No successful steps during online update.
2025-06-03 11:20:16,988 - DEBUG - Current node mean: [ 4.38135217e-09 -4.38135217e-09 -1.89858600e-08 -2.92090139e-08
 -1.75254087e-08  2.48276617e-08 -1.31440565e-08 -1.02231548e-08
 -2.48276617e-08 -2.59230006e-08  4.52739712e-08 -1.09533804e-08
  2.09939799e-09 -2.19067608e-08  2.82962329e-08 -3.65112673e-09
 -9.49293000e-09  0.00000000e+00  0.00000000e+00 -1.02231548e-08
  0.00000000e+00  0.00000000e+00 -4.74646491e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4169742e+00  4.9431734e+00 -1.4076373e-09  5.8944813e-09
  2.9912295e-09 -5.2786403e-10 -6.3343681e-09 -1.3372555e-08
 -1.7595467e-09  1.0557281e-09  2.5689381e-08  3.5190935e-09
 -2.1114561e-09 -2.1114561e-09 -5.6305494e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.2229122e-09]
2025-06-03 11:20:16,988 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0185
2025-06-03 11:20:16,989 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:16,989 - INFO - Running anomaly detection...
2025-06-03 11:20:16,989 - INFO - Starting anomaly detection.
2025-06-03 11:20:16,998 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112016_update_13.json
2025-06-03 11:20:16,998 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:17,004 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112016_update_13.pth and as latest_checkpoint.pth
2025-06-03 11:20:17,004 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.2086
2025-06-03 11:20:17,005 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:17,005 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:20:17,005 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.3148, MLP Score: 1.0000
2025-06-03 11:20:17,005 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.1664, MLP Score: 1.0000
2025-06-03 11:20:17,005 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2843, MLP Score: 1.0000
2025-06-03 11:20:17,005 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.3974, MLP Score: 1.0000
2025-06-03 11:20:17,005 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.3950, MLP Score: 1.0000
2025-06-03 11:20:17,005 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-03 11:20:17,005 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-03 11:20:17,005 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot file.
2025-06-03 11:20:17,019 - INFO - Parsed 693 nodes.
2025-06-03 11:20:17,034 - INFO - Parsed 1448 edges.
2025-06-03 11:20:17,345 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:17,345 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:17,357 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-03 11:20:17,359 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:17,359 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-03 11:20:17,360 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-03 11:20:17,360 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:17,367 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:17,368 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:17,369 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-03 11:20:17,370 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:17,370 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-03 11:20:17,371 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-03 11:20:17,371 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:17,371 - INFO - Performing online update...
2025-06-03 11:20:17,371 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:17,371 - DEBUG - Updated RunningStats: new_mean=0.5966087058479653, new_var=68400000000010.73, new_n=6870
2025-06-03 11:20:17,371 - DEBUG - Updated RunningStats: new_mean=0.5967703670533542, new_var=68700000000007.016, new_n=6900
2025-06-03 11:20:17,372 - DEBUG - Updated RunningStats: new_mean=0.8133942839711412, new_var=37920000000030.97, new_n=3814
2025-06-03 11:20:17,372 - DEBUG - Updated RunningStats: new_mean=0.8145415977259148, new_var=38140000000001.73, new_n=3836
2025-06-03 11:20:17,372 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:17,372 - DEBUG - Online update step: 1/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 2/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 3/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 4/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 5/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 6/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 7/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 8/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 9/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 10/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,372 - DEBUG - Online update step: 11/50
2025-06-03 11:20:17,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 12/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 13/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 14/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 15/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 16/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 17/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 18/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 19/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 20/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 21/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 22/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 23/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 24/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 25/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 26/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 27/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 28/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 29/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 30/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 31/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,373 - DEBUG - Online update step: 32/50
2025-06-03 11:20:17,373 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 33/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 34/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 35/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 36/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 37/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 38/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 39/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 40/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 41/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 42/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 43/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 44/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 45/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 46/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 47/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 48/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 49/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - DEBUG - Online update step: 50/50
2025-06-03 11:20:17,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,374 - WARNING - No successful steps during online update.
2025-06-03 11:20:17,375 - DEBUG - Current node mean: [-8.0849016e-09  8.0849016e-09 -3.8532296e-08  1.3761534e-09
  2.4770761e-08  2.6146916e-08 -3.5779991e-08 -1.4105573e-08
  3.4403835e-09 -7.5688442e-09  2.2018455e-08  2.8211145e-08
 -2.7523068e-08 -8.2569205e-09 -2.2018455e-08 -3.3715757e-08
  2.2018455e-08  0.0000000e+00  0.0000000e+00 -2.3394609e-08
  0.0000000e+00  0.0000000e+00 -4.1284602e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.41919887e+00  4.97651911e+00  4.61030414e-09  0.00000000e+00
 -1.97584460e-09 -3.95168920e-09 -3.95168920e-09 -3.95168920e-09
  1.64653713e-09  3.95168920e-09  1.02085300e-08 -1.25136825e-08
  0.00000000e+00 -3.95168920e-09  2.63445954e-09  1.97584460e-09
  1.97584460e-09  1.97584460e-09  1.97584460e-09  1.97584460e-09
  1.97584460e-09 -6.58614885e-10]
2025-06-03 11:20:17,375 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0183
2025-06-03 11:20:17,375 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:17,375 - INFO - Running anomaly detection...
2025-06-03 11:20:17,376 - INFO - Starting anomaly detection.
2025-06-03 11:20:17,384 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112017_update_14.json
2025-06-03 11:20:17,385 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:17,391 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112017_update_14.pth and as latest_checkpoint.pth
2025-06-03 11:20:17,391 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.1959
2025-06-03 11:20:17,391 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:17,391 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:20:17,391 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.4001, MLP Score: 1.0000
2025-06-03 11:20:17,391 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.2535, MLP Score: 1.0000
2025-06-03 11:20:17,391 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.5356, MLP Score: 1.0000
2025-06-03 11:20:17,391 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6670, MLP Score: 1.0000
2025-06-03 11:20:17,391 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4270, MLP Score: 1.0000
2025-06-03 11:20:17,391 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-03 11:20:17,391 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-03 11:20:17,391 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot file.
2025-06-03 11:20:17,406 - INFO - Parsed 700 nodes.
2025-06-03 11:20:17,420 - INFO - Parsed 1476 edges.
2025-06-03 11:20:17,747 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:17,747 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:17,760 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-03 11:20:17,761 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:17,761 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-03 11:20:17,762 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-03 11:20:17,762 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:17,770 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:17,771 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:17,772 - DEBUG - Shape of encoded categorical edge features: torch.Size([1476, 2])
2025-06-03 11:20:17,773 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:17,773 - DEBUG - Shape of scaled numerical edge features: torch.Size([1476, 20])
2025-06-03 11:20:17,773 - DEBUG - Final edge attributes tensor shape: torch.Size([1476, 22])
2025-06-03 11:20:17,773 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:17,773 - INFO - Performing online update...
2025-06-03 11:20:17,774 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:17,774 - DEBUG - Updated RunningStats: new_mean=0.5941869455418662, new_var=69000000000010.64, new_n=6930
2025-06-03 11:20:17,774 - DEBUG - Updated RunningStats: new_mean=0.5943576319042239, new_var=69300000000007.02, new_n=6960
2025-06-03 11:20:17,775 - DEBUG - Updated RunningStats: new_mean=0.8115551951961598, new_var=38360000000030.93, new_n=3858
2025-06-03 11:20:17,775 - DEBUG - Updated RunningStats: new_mean=0.8126996291589975, new_var=38580000000001.734, new_n=3880
2025-06-03 11:20:17,775 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:17,775 - DEBUG - Online update step: 1/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 2/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 3/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 4/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 5/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 6/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 7/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 8/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 9/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 10/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 11/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 12/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 13/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,775 - DEBUG - Online update step: 14/50
2025-06-03 11:20:17,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 15/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 16/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 17/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 18/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 19/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 20/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 21/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 22/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 23/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 24/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 25/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 26/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 27/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 28/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 29/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 30/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 31/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 32/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 33/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 34/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,776 - DEBUG - Online update step: 35/50
2025-06-03 11:20:17,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 36/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 37/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 38/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 39/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 40/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 41/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 42/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 43/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 44/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 45/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 46/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 47/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 48/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 49/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - DEBUG - Online update step: 50/50
2025-06-03 11:20:17,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:17,777 - WARNING - No successful steps during online update.
2025-06-03 11:20:17,778 - DEBUG - Current node mean: [-1.9073486e-08  1.9073486e-08 -2.0435879e-08 -1.9073486e-08
  6.1307635e-09  1.9073486e-08 -2.4523054e-08  2.5885445e-08
  0.0000000e+00  2.7247837e-09  1.3283321e-08  9.5367430e-09
 -2.7929033e-08 -1.4986311e-08 -1.6348702e-08 -2.1798270e-08
  8.1743510e-09  0.0000000e+00  0.0000000e+00 -1.6348702e-08
  0.0000000e+00  0.0000000e+00  1.3623919e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4214092e+00  4.9769650e+00 -1.2922416e-09  3.2306040e-09
  1.9383624e-09 -4.5228457e-09 -3.8767247e-09 -3.2306040e-09
  3.2306040e-09  5.1689666e-09  2.5844833e-09 -5.1689666e-09
 -2.5844833e-09 -1.2922416e-08 -5.1689666e-09  2.5844833e-09
  2.5844833e-09  2.5844833e-09  2.5844833e-09  2.5844833e-09
  2.5844833e-09 -2.5844833e-09]
2025-06-03 11:20:17,778 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0044
2025-06-03 11:20:17,778 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:17,778 - INFO - Running anomaly detection...
2025-06-03 11:20:17,779 - INFO - Starting anomaly detection.
2025-06-03 11:20:17,787 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112017_update_15.json
2025-06-03 11:20:17,788 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:17,794 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112017_update_15.pth and as latest_checkpoint.pth
2025-06-03 11:20:17,794 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.1955
2025-06-03 11:20:17,794 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:17,794 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:20:17,795 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9496, MLP Score: 1.0000
2025-06-03 11:20:17,795 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.3740, MLP Score: 1.0000
2025-06-03 11:20:17,795 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4665, MLP Score: 1.0000
2025-06-03 11:20:17,795 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6516, MLP Score: 1.0000
2025-06-03 11:20:17,795 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4281, MLP Score: 1.0000
2025-06-03 11:20:17,795 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-03 11:20:17,795 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-03 11:20:17,795 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot file.
2025-06-03 11:20:17,810 - INFO - Parsed 715 nodes.
2025-06-03 11:20:17,826 - INFO - Parsed 1521 edges.
2025-06-03 11:20:18,161 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:18,161 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:18,174 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-03 11:20:18,175 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:18,175 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-03 11:20:18,177 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-03 11:20:18,177 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:18,184 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:18,185 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:18,187 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 2])
2025-06-03 11:20:18,188 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:18,188 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 20])
2025-06-03 11:20:18,188 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 22])
2025-06-03 11:20:18,188 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:18,188 - INFO - Performing online update...
2025-06-03 11:20:18,189 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:18,189 - DEBUG - Updated RunningStats: new_mean=0.5918067407759258, new_var=69600000000010.555, new_n=6990
2025-06-03 11:20:18,189 - DEBUG - Updated RunningStats: new_mean=0.5919860994423002, new_var=69900000000007.03, new_n=7020
2025-06-03 11:20:18,190 - DEBUG - Updated RunningStats: new_mean=0.8097601640206243, new_var=38800000000030.97, new_n=3902
2025-06-03 11:20:18,190 - DEBUG - Updated RunningStats: new_mean=0.8108986764271441, new_var=39020000000001.73, new_n=3924
2025-06-03 11:20:18,190 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:18,190 - DEBUG - Online update step: 1/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 2/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 3/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 4/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 5/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 6/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 7/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 8/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 9/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 10/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 11/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 12/50
2025-06-03 11:20:18,190 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,190 - DEBUG - Online update step: 13/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 14/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 15/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 16/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 17/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 18/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 19/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 20/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 21/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 22/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 23/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 24/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 25/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 26/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 27/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 28/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 29/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 30/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 31/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 32/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 33/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,191 - DEBUG - Online update step: 34/50
2025-06-03 11:20:18,191 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 35/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 36/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 37/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 38/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 39/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 40/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 41/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 42/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 43/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 44/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 45/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 46/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 47/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 48/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 49/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - DEBUG - Online update step: 50/50
2025-06-03 11:20:18,192 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:20:18,192 - WARNING - No successful steps during online update.
2025-06-03 11:20:18,193 - DEBUG - Current node mean: [-2.6009300e-08  2.6009300e-08 -1.2671197e-08 -1.0003577e-08
 -2.7009657e-08  1.5255454e-08  2.3174954e-08 -7.6694091e-09
  1.8673344e-08  9.3366719e-09  3.2678351e-08 -6.6690511e-09
 -2.5008942e-08 -5.0684790e-08  3.0010732e-08 -1.2671197e-08
 -2.6009300e-08  0.0000000e+00  0.0000000e+00  1.0253666e-08
  0.0000000e+00  0.0000000e+00  9.3366719e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4234056e+00  4.9861932e+00  0.0000000e+00  1.2540097e-09
  1.2540097e-09  0.0000000e+00 -8.7780672e-09 -5.0160387e-09
  1.2540097e-09  3.7620289e-09  1.1286087e-08  3.7620289e-09
  6.2700484e-10  1.7242632e-08 -3.7620289e-09  3.7620289e-09
  3.7620289e-09  3.7620289e-09  3.7620289e-09  3.7620289e-09
  3.7620289e-09 -1.2540097e-09]
2025-06-03 11:20:18,193 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0052
2025-06-03 11:20:18,193 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:20:18,193 - INFO - Running anomaly detection...
2025-06-03 11:20:18,193 - INFO - Starting anomaly detection.
2025-06-03 11:20:18,202 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112018_update_16.json
2025-06-03 11:20:18,202 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:18,209 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112018_update_16.pth and as latest_checkpoint.pth
2025-06-03 11:20:18,209 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.1845
2025-06-03 11:20:18,209 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:20:18,209 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:20:18,209 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9523, MLP Score: 1.0000
2025-06-03 11:20:18,209 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.5631, MLP Score: 1.0000
2025-06-03 11:20:18,209 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4844, MLP Score: 1.0000
2025-06-03 11:20:18,209 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.8534, MLP Score: 1.0000
2025-06-03 11:20:18,209 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4409, MLP Score: 1.0000
2025-06-03 11:20:18,209 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:20:18,209 - INFO - Performing visualization of node and edge features.
2025-06-03 11:20:18,209 - INFO - Starting visualization of node features.
2025-06-03 11:20:18,210 - INFO - Graph has 715 nodes and 30 features.
2025-06-03 11:20:18,210 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:20:18,210 - INFO - Calculating feature statistics:
2025-06-03 11:20:18,210 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-2.4008584e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10990211), 'max': np.float32(9.343332)}
2025-06-03 11:20:18,210 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(2.4008584e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.343332), 'max': np.float32(0.10990211)}
2025-06-03 11:20:18,210 - INFO - - server_score: {'name': 'server_score', 'unique': 12, 'mean': np.float32(-1.6005723e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4258256), 'max': np.float32(3.20116)}
2025-06-03 11:20:18,210 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-5.335241e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08440674), 'max': np.float32(15.0549135)}
2025-06-03 11:20:18,210 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-1.0670482e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65705806), 'max': np.float32(3.4821181)}
2025-06-03 11:20:18,210 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 14, 'mean': np.float32(1.0670482e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.6625487), 'max': np.float32(2.8217363)}
2025-06-03 11:20:18,210 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 13, 'mean': np.float32(1.0670482e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8603718), 'max': np.float32(0.64904284)}
2025-06-03 11:20:18,210 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-8.0028615e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08956751), 'max': np.float32(16.683014)}
2025-06-03 11:20:18,210 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.3338102e-08), 'std': np.float32(1.0), 'min': np.float32(-4.2490306), 'max': np.float32(16.674225)}
2025-06-03 11:20:18,211 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(9.336672e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.088753484), 'max': np.float32(12.425848)}
2025-06-03 11:20:18,211 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0191054), 'max': np.float32(0.95447576)}
2025-06-03 11:20:18,211 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-6.002146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.10323927), 'max': np.float32(10.45955)}
2025-06-03 11:20:18,211 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.5005366e-08), 'std': np.float32(1.0), 'min': np.float32(-7.8406706), 'max': np.float32(0.13005851)}
2025-06-03 11:20:18,211 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-4.8017167e-08), 'std': np.float32(1.0), 'min': np.float32(-1.89119), 'max': np.float32(2.6003509)}
2025-06-03 11:20:18,211 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5437796), 'max': np.float32(1.9436969)}
2025-06-03 11:20:18,211 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-1.8673344e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2804745), 'max': np.float32(3.7169163)}
2025-06-03 11:20:18,211 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(-1.6005723e-08), 'std': np.float32(1.0), 'min': np.float32(-3.639823), 'max': np.float32(1.3070177)}
2025-06-03 11:20:18,211 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,211 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,211 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(1.9340249e-08), 'std': np.float32(1.0), 'min': np.float32(-7.3598647), 'max': np.float32(0.16105923)}
2025-06-03 11:20:18,211 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,211 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(-4.0014307e-09), 'std': np.float32(0.99999994), 'min': np.float32(-3.9357996), 'max': np.float32(4.1536803)}
2025-06-03 11:20:18,212 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,212 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:20:18,224 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b3b6997c0>
2025-06-03 11:20:18,528 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:20:18,585 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:20:18,615 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:20:19,827 - INFO - Node feature visualization saved to vis/node_features_20250603_112018.png
2025-06-03 11:20:19,827 - INFO - Finished visualization of node features.
2025-06-03 11:20:19,827 - INFO - Performing additional feature analysis:
2025-06-03 11:20:19,827 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:20:19,827 - INFO - Starting visualization of edge features.
2025-06-03 11:20:19,827 - INFO - Graph has 1521 edges and 22 edge features.
2025-06-03 11:20:19,828 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:20:19,828 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:20:19,828 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-03 11:20:19,828 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-03 11:20:19,828 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot file.
2025-06-03 11:20:19,841 - INFO - Parsed 723 nodes.
2025-06-03 11:20:19,855 - INFO - Parsed 1547 edges.
2025-06-03 11:20:20,205 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:20,206 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:20,218 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-03 11:20:20,220 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:20,220 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-03 11:20:20,221 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-03 11:20:20,221 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:20,229 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:20,230 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:20,232 - DEBUG - Shape of encoded categorical edge features: torch.Size([1547, 2])
2025-06-03 11:20:20,233 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:20,233 - DEBUG - Shape of scaled numerical edge features: torch.Size([1547, 20])
2025-06-03 11:20:20,233 - DEBUG - Final edge attributes tensor shape: torch.Size([1547, 22])
2025-06-03 11:20:20,233 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:20,233 - INFO - Performing online update...
2025-06-03 11:20:20,234 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:20,234 - DEBUG - Updated RunningStats: new_mean=0.5894670096591232, new_var=70200000000010.47, new_n=7050
2025-06-03 11:20:20,234 - DEBUG - Updated RunningStats: new_mean=0.5896547416742629, new_var=70500000000007.03, new_n=7080
2025-06-03 11:20:20,235 - DEBUG - Updated RunningStats: new_mean=0.8080035604544362, new_var=39240000000030.94, new_n=3946
2025-06-03 11:20:20,235 - DEBUG - Updated RunningStats: new_mean=0.8091378719978038, new_var=39460000000001.734, new_n=3968
2025-06-03 11:20:20,235 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:20,235 - DEBUG - Online update step: 1/50
2025-06-03 11:20:20,237 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:20,550 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:20,577 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:20,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:20,828 - DEBUG - Step 1: Loss=22.9665
2025-06-03 11:20:20,828 - DEBUG - Online update step: 2/50
2025-06-03 11:20:20,830 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:21,130 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:21,152 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:21,153 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:21,371 - DEBUG - Step 2: Loss=17.8397
2025-06-03 11:20:21,372 - DEBUG - Online update step: 3/50
2025-06-03 11:20:21,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:21,651 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:21,676 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:21,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:21,880 - DEBUG - Step 3: Loss=14.8746
2025-06-03 11:20:21,880 - DEBUG - Online update step: 4/50
2025-06-03 11:20:21,885 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:22,195 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:22,220 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:22,221 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:22,449 - DEBUG - Step 4: Loss=13.5746
2025-06-03 11:20:22,450 - DEBUG - Online update step: 5/50
2025-06-03 11:20:22,451 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:22,699 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:22,723 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:22,723 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:22,940 - DEBUG - Step 5: Loss=12.4427
2025-06-03 11:20:22,940 - DEBUG - Online update step: 6/50
2025-06-03 11:20:22,942 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:23,210 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:23,234 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:23,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:23,460 - DEBUG - Step 6: Loss=12.0672
2025-06-03 11:20:23,460 - DEBUG - Online update step: 7/50
2025-06-03 11:20:23,462 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:23,733 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:23,756 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:23,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:23,951 - DEBUG - Step 7: Loss=13.2155
2025-06-03 11:20:23,951 - DEBUG - Online update step: 8/50
2025-06-03 11:20:23,956 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:24,240 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:24,262 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:24,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:24,481 - DEBUG - Step 8: Loss=11.5804
2025-06-03 11:20:24,481 - DEBUG - Online update step: 9/50
2025-06-03 11:20:24,483 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:24,764 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:24,786 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:24,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:25,058 - DEBUG - Step 9: Loss=11.4619
2025-06-03 11:20:25,059 - DEBUG - Online update step: 10/50
2025-06-03 11:20:25,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:25,341 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:25,369 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:25,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:25,583 - DEBUG - Step 10: Loss=10.6478
2025-06-03 11:20:25,584 - DEBUG - Online update step: 11/50
2025-06-03 11:20:25,586 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:25,859 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:25,883 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:25,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:26,107 - DEBUG - Step 11: Loss=9.8692
2025-06-03 11:20:26,107 - DEBUG - Online update step: 12/50
2025-06-03 11:20:26,109 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:26,408 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:26,434 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:26,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:26,671 - DEBUG - Step 12: Loss=8.3363
2025-06-03 11:20:26,671 - DEBUG - Online update step: 13/50
2025-06-03 11:20:26,672 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:26,947 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:26,973 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:26,974 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:27,198 - DEBUG - Step 13: Loss=7.9591
2025-06-03 11:20:27,199 - DEBUG - Online update step: 14/50
2025-06-03 11:20:27,201 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:27,474 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:27,498 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:27,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:27,725 - DEBUG - Step 14: Loss=8.1872
2025-06-03 11:20:27,725 - DEBUG - Online update step: 15/50
2025-06-03 11:20:27,727 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:27,990 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:28,017 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:28,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:28,276 - DEBUG - Step 15: Loss=7.6350
2025-06-03 11:20:28,276 - DEBUG - Online update step: 16/50
2025-06-03 11:20:28,278 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:28,565 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:28,590 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:28,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:28,814 - DEBUG - Step 16: Loss=6.1664
2025-06-03 11:20:28,814 - DEBUG - Online update step: 17/50
2025-06-03 11:20:28,816 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:29,101 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:29,125 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:29,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:29,353 - DEBUG - Step 17: Loss=5.3000
2025-06-03 11:20:29,353 - DEBUG - Online update step: 18/50
2025-06-03 11:20:29,356 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:29,643 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:29,667 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:29,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:29,896 - DEBUG - Step 18: Loss=5.3733
2025-06-03 11:20:29,896 - DEBUG - Online update step: 19/50
2025-06-03 11:20:29,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:30,179 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:30,204 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:30,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:30,453 - DEBUG - Step 19: Loss=5.2736
2025-06-03 11:20:30,454 - DEBUG - Online update step: 20/50
2025-06-03 11:20:30,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:30,747 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:30,772 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:30,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:31,005 - DEBUG - Step 20: Loss=5.4752
2025-06-03 11:20:31,006 - DEBUG - Online update step: 21/50
2025-06-03 11:20:31,007 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:31,295 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:31,320 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:31,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:31,568 - DEBUG - Step 21: Loss=5.0020
2025-06-03 11:20:31,568 - DEBUG - Online update step: 22/50
2025-06-03 11:20:31,569 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:31,860 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:31,884 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:31,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:32,114 - DEBUG - Step 22: Loss=6.3832
2025-06-03 11:20:32,114 - DEBUG - Online update step: 23/50
2025-06-03 11:20:32,116 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:32,383 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:32,406 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:32,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:32,666 - DEBUG - Step 23: Loss=4.6364
2025-06-03 11:20:32,666 - DEBUG - Online update step: 24/50
2025-06-03 11:20:32,668 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:33,026 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:33,048 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:33,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:33,304 - DEBUG - Step 24: Loss=4.4315
2025-06-03 11:20:33,304 - DEBUG - Online update step: 25/50
2025-06-03 11:20:33,306 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:33,594 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:33,618 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:33,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:33,873 - DEBUG - Step 25: Loss=3.8974
2025-06-03 11:20:33,873 - DEBUG - Online update step: 26/50
2025-06-03 11:20:33,875 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:34,187 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:34,213 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:34,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:34,542 - DEBUG - Step 26: Loss=3.6215
2025-06-03 11:20:34,543 - DEBUG - Online update step: 27/50
2025-06-03 11:20:34,548 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:34,860 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:34,884 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:34,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:35,131 - DEBUG - Step 27: Loss=4.7904
2025-06-03 11:20:35,132 - DEBUG - Online update step: 28/50
2025-06-03 11:20:35,133 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:35,424 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:35,450 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:35,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:35,875 - DEBUG - Step 28: Loss=4.7453
2025-06-03 11:20:35,876 - DEBUG - Online update step: 29/50
2025-06-03 11:20:35,880 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:36,241 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:36,264 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:36,265 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:36,616 - DEBUG - Step 29: Loss=3.5274
2025-06-03 11:20:36,616 - DEBUG - Online update step: 30/50
2025-06-03 11:20:36,618 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:36,946 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:36,981 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:36,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:37,247 - DEBUG - Step 30: Loss=3.1935
2025-06-03 11:20:37,248 - DEBUG - Online update step: 31/50
2025-06-03 11:20:37,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:37,542 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:37,566 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:37,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:37,824 - DEBUG - Step 31: Loss=4.0220
2025-06-03 11:20:37,825 - DEBUG - Online update step: 32/50
2025-06-03 11:20:37,827 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:38,119 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:38,141 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:38,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:38,381 - DEBUG - Step 32: Loss=2.6740
2025-06-03 11:20:38,381 - DEBUG - Online update step: 33/50
2025-06-03 11:20:38,383 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:38,641 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:38,666 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:38,667 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:38,927 - DEBUG - Step 33: Loss=2.7610
2025-06-03 11:20:38,928 - DEBUG - Online update step: 34/50
2025-06-03 11:20:38,929 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:39,219 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:39,247 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:39,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:39,498 - DEBUG - Step 34: Loss=2.3908
2025-06-03 11:20:39,498 - DEBUG - Online update step: 35/50
2025-06-03 11:20:39,500 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:39,804 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:39,827 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:39,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:40,091 - DEBUG - Step 35: Loss=2.4761
2025-06-03 11:20:40,091 - DEBUG - Online update step: 36/50
2025-06-03 11:20:40,094 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:40,484 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:40,511 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:40,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:40,889 - DEBUG - Step 36: Loss=2.5376
2025-06-03 11:20:40,889 - DEBUG - Online update step: 37/50
2025-06-03 11:20:40,891 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:41,187 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:41,214 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:41,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:41,468 - DEBUG - Step 37: Loss=2.7740
2025-06-03 11:20:41,468 - DEBUG - Online update step: 38/50
2025-06-03 11:20:41,471 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:41,772 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:41,795 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:41,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:42,073 - DEBUG - Step 38: Loss=2.7035
2025-06-03 11:20:42,073 - DEBUG - Online update step: 39/50
2025-06-03 11:20:42,075 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:42,348 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:42,373 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:42,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:42,631 - DEBUG - Step 39: Loss=2.4611
2025-06-03 11:20:42,632 - DEBUG - Online update step: 40/50
2025-06-03 11:20:42,637 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:42,926 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:42,951 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:42,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:43,235 - DEBUG - Step 40: Loss=2.5803
2025-06-03 11:20:43,236 - DEBUG - Online update step: 41/50
2025-06-03 11:20:43,237 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:43,536 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:43,561 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:43,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:43,846 - DEBUG - Step 41: Loss=2.2662
2025-06-03 11:20:43,847 - DEBUG - Online update step: 42/50
2025-06-03 11:20:43,848 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:44,111 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:44,136 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:44,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:44,417 - DEBUG - Step 42: Loss=2.1835
2025-06-03 11:20:44,418 - DEBUG - Online update step: 43/50
2025-06-03 11:20:44,419 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:44,819 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:44,857 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:44,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:45,320 - DEBUG - Step 43: Loss=2.7302
2025-06-03 11:20:45,321 - DEBUG - Online update step: 44/50
2025-06-03 11:20:45,324 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:45,681 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:45,711 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:45,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:46,112 - DEBUG - Step 44: Loss=3.1273
2025-06-03 11:20:46,113 - DEBUG - Online update step: 45/50
2025-06-03 11:20:46,118 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:46,521 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:46,552 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:46,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:47,035 - DEBUG - Step 45: Loss=2.3058
2025-06-03 11:20:47,035 - DEBUG - Online update step: 46/50
2025-06-03 11:20:47,041 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:47,452 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:47,481 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:47,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:47,934 - DEBUG - Step 46: Loss=2.0162
2025-06-03 11:20:47,934 - DEBUG - Online update step: 47/50
2025-06-03 11:20:47,937 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:48,317 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:48,347 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:48,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:48,745 - DEBUG - Step 47: Loss=2.9268
2025-06-03 11:20:48,745 - DEBUG - Online update step: 48/50
2025-06-03 11:20:48,749 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:49,255 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:49,283 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:49,284 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:49,713 - DEBUG - Step 48: Loss=2.8311
2025-06-03 11:20:49,713 - DEBUG - Online update step: 49/50
2025-06-03 11:20:49,721 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:50,828 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:50,852 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:50,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:51,268 - DEBUG - Step 49: Loss=2.2275
2025-06-03 11:20:51,269 - DEBUG - Online update step: 50/50
2025-06-03 11:20:51,271 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:51,603 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:51,632 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:51,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:52,037 - DEBUG - Step 50: Loss=1.8977
2025-06-03 11:20:52,038 - INFO - Online update finished. Average loss: 6.1274, Learning rate: 0.002927
2025-06-03 11:20:52,039 - DEBUG - Current node mean: [-2.3742929e-08  2.3742929e-08 -8.9035987e-09  2.3742929e-08
  4.6166808e-09 -3.8747142e-08  2.6381032e-08  5.2762066e-09
 -9.7280060e-09 -6.5952581e-09 -5.1443013e-08  5.2762066e-09
  2.9019136e-08  1.7147672e-08 -1.0552413e-08  5.2762066e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.3742929e-08
  0.0000000e+00  0.0000000e+00 -2.6381033e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4292178e+00  4.9864254e+00  6.1646693e-10  3.6988015e-09
  6.1646693e-10 -1.8494007e-09  4.9317355e-09  1.2329339e-09
  0.0000000e+00  7.3976030e-09  1.7261074e-08  8.6305372e-09
 -8.6305372e-09  1.3562272e-08 -3.3905680e-09 -1.2329339e-09
 -1.2329339e-09 -1.2329339e-09 -1.2329339e-09 -1.2329339e-09
 -1.2329339e-09  1.2329339e-09]
2025-06-03 11:20:52,039 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0115
2025-06-03 11:20:52,040 - INFO - Online update complete. Loss: 6.1274
2025-06-03 11:20:52,040 - INFO - Running anomaly detection...
2025-06-03 11:20:52,040 - INFO - Starting anomaly detection.
2025-06-03 11:20:52,053 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112052_update_17.json
2025-06-03 11:20:52,054 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:20:52,082 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112052_update_17.pth and as latest_checkpoint.pth
2025-06-03 11:20:52,082 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 1.0000
2025-06-03 11:20:52,082 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:20:52,082 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 8.6540, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Node ID: 183.81.34.26, Recon Error: 3.5073, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.9281, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 11.2985, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Node ID: 1.1.1.1, Recon Error: 3.0738, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:20:52,082 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.9146, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.4457, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.0861, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 2.0843, MLP Score: 1.0000
2025-06-03 11:20:52,082 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 6.1315, MLP Score: 1.0000
2025-06-03 11:20:52,082 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-03 11:20:52,082 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-03 11:20:52,082 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot file.
2025-06-03 11:20:52,100 - INFO - Parsed 730 nodes.
2025-06-03 11:20:52,119 - INFO - Parsed 1559 edges.
2025-06-03 11:20:52,534 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:20:52,534 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:20:52,548 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-03 11:20:52,553 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:20:52,553 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-03 11:20:52,555 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-03 11:20:52,555 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:20:52,563 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:20:52,564 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:20:52,566 - DEBUG - Shape of encoded categorical edge features: torch.Size([1559, 2])
2025-06-03 11:20:52,567 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:20:52,567 - DEBUG - Shape of scaled numerical edge features: torch.Size([1559, 20])
2025-06-03 11:20:52,567 - DEBUG - Final edge attributes tensor shape: torch.Size([1559, 22])
2025-06-03 11:20:52,567 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:20:52,567 - INFO - Performing online update...
2025-06-03 11:20:52,568 - INFO - Starting online update for 50 steps.
2025-06-03 11:20:52,568 - DEBUG - Updated RunningStats: new_mean=0.5871667469733187, new_var=70800000000010.39, new_n=7110
2025-06-03 11:20:52,568 - DEBUG - Updated RunningStats: new_mean=0.5873625487301176, new_var=71100000000007.03, new_n=7140
2025-06-03 11:20:52,569 - DEBUG - Updated RunningStats: new_mean=0.8062829459531706, new_var=39680000000030.87, new_n=3990
2025-06-03 11:20:52,569 - DEBUG - Updated RunningStats: new_mean=0.8074155280364973, new_var=39900000000001.76, new_n=4012
2025-06-03 11:20:52,569 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:20:52,569 - DEBUG - Online update step: 1/50
2025-06-03 11:20:52,570 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:52,886 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:20:52,913 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:20:52,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:53,229 - DEBUG - Step 1: Loss=1.7492
2025-06-03 11:20:53,229 - DEBUG - Online update step: 2/50
2025-06-03 11:20:53,231 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:53,514 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:20:53,541 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:20:53,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:53,870 - DEBUG - Step 2: Loss=1.8945
2025-06-03 11:20:53,870 - DEBUG - Online update step: 3/50
2025-06-03 11:20:53,872 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:54,154 - DEBUG - Node anomaly scores shape: torch.Size([7697, 1])
2025-06-03 11:20:54,177 - DEBUG - Edge anomaly scores shape: torch.Size([15422, 1])
2025-06-03 11:20:54,178 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:54,516 - DEBUG - Step 3: Loss=1.8739
2025-06-03 11:20:54,517 - DEBUG - Online update step: 4/50
2025-06-03 11:20:54,518 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:54,804 - DEBUG - Node anomaly scores shape: torch.Size([7879, 1])
2025-06-03 11:20:54,829 - DEBUG - Edge anomaly scores shape: torch.Size([15826, 1])
2025-06-03 11:20:54,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:55,262 - DEBUG - Step 4: Loss=1.5369
2025-06-03 11:20:55,262 - DEBUG - Online update step: 5/50
2025-06-03 11:20:55,264 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:55,623 - DEBUG - Node anomaly scores shape: torch.Size([7971, 1])
2025-06-03 11:20:55,658 - DEBUG - Edge anomaly scores shape: torch.Size([16037, 1])
2025-06-03 11:20:55,659 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:56,446 - DEBUG - Step 5: Loss=1.5732
2025-06-03 11:20:56,447 - DEBUG - Online update step: 6/50
2025-06-03 11:20:56,448 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:56,775 - DEBUG - Node anomaly scores shape: torch.Size([7971, 1])
2025-06-03 11:20:56,802 - DEBUG - Edge anomaly scores shape: torch.Size([16037, 1])
2025-06-03 11:20:56,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:57,254 - DEBUG - Step 6: Loss=1.7504
2025-06-03 11:20:57,255 - DEBUG - Online update step: 7/50
2025-06-03 11:20:57,256 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:57,799 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:20:57,883 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:20:57,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:58,330 - DEBUG - Step 7: Loss=1.4580
2025-06-03 11:20:58,331 - DEBUG - Online update step: 8/50
2025-06-03 11:20:58,332 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:58,622 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:20:58,650 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:20:58,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:59,037 - DEBUG - Step 8: Loss=1.4939
2025-06-03 11:20:59,037 - DEBUG - Online update step: 9/50
2025-06-03 11:20:59,038 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:59,318 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:20:59,343 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:20:59,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:20:59,696 - DEBUG - Step 9: Loss=1.6370
2025-06-03 11:20:59,696 - DEBUG - Online update step: 10/50
2025-06-03 11:20:59,698 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:20:59,995 - DEBUG - Node anomaly scores shape: torch.Size([8134, 1])
2025-06-03 11:21:00,019 - DEBUG - Edge anomaly scores shape: torch.Size([16475, 1])
2025-06-03 11:21:00,020 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:00,478 - DEBUG - Step 10: Loss=1.7627
2025-06-03 11:21:00,478 - DEBUG - Online update step: 11/50
2025-06-03 11:21:00,479 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:00,751 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:21:00,779 - DEBUG - Edge anomaly scores shape: torch.Size([15570, 1])
2025-06-03 11:21:00,780 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:01,170 - DEBUG - Step 11: Loss=1.5104
2025-06-03 11:21:01,170 - DEBUG - Online update step: 12/50
2025-06-03 11:21:01,172 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:01,465 - DEBUG - Node anomaly scores shape: torch.Size([8024, 1])
2025-06-03 11:21:01,491 - DEBUG - Edge anomaly scores shape: torch.Size([16213, 1])
2025-06-03 11:21:01,492 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:01,932 - DEBUG - Step 12: Loss=1.3127
2025-06-03 11:21:01,932 - DEBUG - Online update step: 13/50
2025-06-03 11:21:01,935 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:02,233 - DEBUG - Node anomaly scores shape: torch.Size([8024, 1])
2025-06-03 11:21:02,258 - DEBUG - Edge anomaly scores shape: torch.Size([16213, 1])
2025-06-03 11:21:02,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:02,675 - DEBUG - Step 13: Loss=2.2044
2025-06-03 11:21:02,676 - DEBUG - Online update step: 14/50
2025-06-03 11:21:02,677 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:02,940 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:21:02,964 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:21:02,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:03,546 - DEBUG - Step 14: Loss=1.9570
2025-06-03 11:21:03,547 - DEBUG - Online update step: 15/50
2025-06-03 11:21:03,550 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:03,882 - DEBUG - Node anomaly scores shape: torch.Size([8261, 1])
2025-06-03 11:21:03,908 - DEBUG - Edge anomaly scores shape: torch.Size([16684, 1])
2025-06-03 11:21:03,908 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:04,389 - DEBUG - Step 15: Loss=1.6513
2025-06-03 11:21:04,389 - DEBUG - Online update step: 16/50
2025-06-03 11:21:04,390 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:04,665 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:21:04,687 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:21:04,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:05,124 - DEBUG - Step 16: Loss=1.2328
2025-06-03 11:21:05,125 - DEBUG - Online update step: 17/50
2025-06-03 11:21:05,126 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:05,423 - DEBUG - Node anomaly scores shape: torch.Size([7690, 1])
2025-06-03 11:21:05,448 - DEBUG - Edge anomaly scores shape: torch.Size([15394, 1])
2025-06-03 11:21:05,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:05,838 - DEBUG - Step 17: Loss=1.3735
2025-06-03 11:21:05,838 - DEBUG - Online update step: 18/50
2025-06-03 11:21:05,840 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:06,140 - DEBUG - Node anomaly scores shape: torch.Size([8024, 1])
2025-06-03 11:21:06,165 - DEBUG - Edge anomaly scores shape: torch.Size([16213, 1])
2025-06-03 11:21:06,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:06,607 - DEBUG - Step 18: Loss=1.3568
2025-06-03 11:21:06,607 - DEBUG - Online update step: 19/50
2025-06-03 11:21:06,609 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:06,914 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:06,939 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:06,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:07,449 - DEBUG - Step 19: Loss=1.7029
2025-06-03 11:21:07,449 - DEBUG - Online update step: 20/50
2025-06-03 11:21:07,451 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:07,703 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:21:07,729 - DEBUG - Edge anomaly scores shape: torch.Size([15570, 1])
2025-06-03 11:21:07,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:08,180 - DEBUG - Step 20: Loss=1.3687
2025-06-03 11:21:08,181 - DEBUG - Online update step: 21/50
2025-06-03 11:21:08,183 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:08,442 - DEBUG - Node anomaly scores shape: torch.Size([7690, 1])
2025-06-03 11:21:08,468 - DEBUG - Edge anomaly scores shape: torch.Size([15394, 1])
2025-06-03 11:21:08,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:08,904 - DEBUG - Step 21: Loss=1.2761
2025-06-03 11:21:08,904 - DEBUG - Online update step: 22/50
2025-06-03 11:21:08,906 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:09,210 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:09,235 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:09,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:09,745 - DEBUG - Step 22: Loss=1.1823
2025-06-03 11:21:09,746 - DEBUG - Online update step: 23/50
2025-06-03 11:21:09,748 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:10,014 - DEBUG - Node anomaly scores shape: torch.Size([7667, 1])
2025-06-03 11:21:10,039 - DEBUG - Edge anomaly scores shape: torch.Size([15323, 1])
2025-06-03 11:21:10,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:10,466 - DEBUG - Step 23: Loss=1.3555
2025-06-03 11:21:10,466 - DEBUG - Online update step: 24/50
2025-06-03 11:21:10,467 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:10,745 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:10,771 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:10,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:11,277 - DEBUG - Step 24: Loss=1.4052
2025-06-03 11:21:11,277 - DEBUG - Online update step: 25/50
2025-06-03 11:21:11,279 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:11,582 - DEBUG - Node anomaly scores shape: torch.Size([8134, 1])
2025-06-03 11:21:11,608 - DEBUG - Edge anomaly scores shape: torch.Size([16475, 1])
2025-06-03 11:21:11,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:12,095 - DEBUG - Step 25: Loss=1.1041
2025-06-03 11:21:12,096 - DEBUG - Online update step: 26/50
2025-06-03 11:21:12,097 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:12,374 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:12,397 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:12,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:12,873 - DEBUG - Step 26: Loss=1.0931
2025-06-03 11:21:12,873 - DEBUG - Online update step: 27/50
2025-06-03 11:21:12,876 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:13,182 - DEBUG - Node anomaly scores shape: torch.Size([8261, 1])
2025-06-03 11:21:13,208 - DEBUG - Edge anomaly scores shape: torch.Size([16684, 1])
2025-06-03 11:21:13,209 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:13,637 - DEBUG - Step 27: Loss=1.2202
2025-06-03 11:21:13,637 - DEBUG - Online update step: 28/50
2025-06-03 11:21:13,639 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:13,899 - DEBUG - Node anomaly scores shape: torch.Size([7667, 1])
2025-06-03 11:21:13,922 - DEBUG - Edge anomaly scores shape: torch.Size([15323, 1])
2025-06-03 11:21:13,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:14,372 - DEBUG - Step 28: Loss=1.1494
2025-06-03 11:21:14,373 - DEBUG - Online update step: 29/50
2025-06-03 11:21:14,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:14,665 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:14,692 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:14,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:15,139 - DEBUG - Step 29: Loss=1.1394
2025-06-03 11:21:15,139 - DEBUG - Online update step: 30/50
2025-06-03 11:21:15,141 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:15,413 - DEBUG - Node anomaly scores shape: torch.Size([7843, 1])
2025-06-03 11:21:15,439 - DEBUG - Edge anomaly scores shape: torch.Size([15752, 1])
2025-06-03 11:21:15,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:15,949 - DEBUG - Step 30: Loss=1.1224
2025-06-03 11:21:15,950 - DEBUG - Online update step: 31/50
2025-06-03 11:21:15,951 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:16,217 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:21:16,245 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:21:16,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:16,665 - DEBUG - Step 31: Loss=1.1777
2025-06-03 11:21:16,666 - DEBUG - Online update step: 32/50
2025-06-03 11:21:16,667 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:16,962 - DEBUG - Node anomaly scores shape: torch.Size([8024, 1])
2025-06-03 11:21:16,988 - DEBUG - Edge anomaly scores shape: torch.Size([16213, 1])
2025-06-03 11:21:16,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:17,506 - DEBUG - Step 32: Loss=1.1457
2025-06-03 11:21:17,506 - DEBUG - Online update step: 33/50
2025-06-03 11:21:17,510 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:17,932 - DEBUG - Node anomaly scores shape: torch.Size([8024, 1])
2025-06-03 11:21:17,958 - DEBUG - Edge anomaly scores shape: torch.Size([16213, 1])
2025-06-03 11:21:17,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:18,476 - DEBUG - Step 33: Loss=1.0192
2025-06-03 11:21:18,477 - DEBUG - Online update step: 34/50
2025-06-03 11:21:18,478 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:18,770 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:18,795 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:18,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:19,273 - DEBUG - Step 34: Loss=1.0652
2025-06-03 11:21:19,273 - DEBUG - Online update step: 35/50
2025-06-03 11:21:19,275 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:19,571 - DEBUG - Node anomaly scores shape: torch.Size([7971, 1])
2025-06-03 11:21:19,599 - DEBUG - Edge anomaly scores shape: torch.Size([16037, 1])
2025-06-03 11:21:19,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:20,060 - DEBUG - Step 35: Loss=1.3089
2025-06-03 11:21:20,060 - DEBUG - Online update step: 36/50
2025-06-03 11:21:20,062 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:20,344 - DEBUG - Node anomaly scores shape: torch.Size([7879, 1])
2025-06-03 11:21:20,369 - DEBUG - Edge anomaly scores shape: torch.Size([15826, 1])
2025-06-03 11:21:20,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:20,807 - DEBUG - Step 36: Loss=1.2785
2025-06-03 11:21:20,807 - DEBUG - Online update step: 37/50
2025-06-03 11:21:20,808 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:21,107 - DEBUG - Node anomaly scores shape: torch.Size([7998, 1])
2025-06-03 11:21:21,132 - DEBUG - Edge anomaly scores shape: torch.Size([16117, 1])
2025-06-03 11:21:21,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:21,580 - DEBUG - Step 37: Loss=1.0609
2025-06-03 11:21:21,580 - DEBUG - Online update step: 38/50
2025-06-03 11:21:21,581 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:21,852 - DEBUG - Node anomaly scores shape: torch.Size([7660, 1])
2025-06-03 11:21:21,876 - DEBUG - Edge anomaly scores shape: torch.Size([15311, 1])
2025-06-03 11:21:21,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:22,312 - DEBUG - Step 38: Loss=1.3078
2025-06-03 11:21:22,313 - DEBUG - Online update step: 39/50
2025-06-03 11:21:22,314 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:22,606 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:22,631 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:22,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:23,069 - DEBUG - Step 39: Loss=1.5391
2025-06-03 11:21:23,069 - DEBUG - Online update step: 40/50
2025-06-03 11:21:23,071 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:23,334 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:21:23,360 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:21:23,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:23,793 - DEBUG - Step 40: Loss=1.1894
2025-06-03 11:21:23,794 - DEBUG - Online update step: 41/50
2025-06-03 11:21:23,795 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:24,087 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:24,113 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:24,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:24,540 - DEBUG - Step 41: Loss=1.3184
2025-06-03 11:21:24,540 - DEBUG - Online update step: 42/50
2025-06-03 11:21:24,542 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:24,840 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:24,868 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:24,869 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:25,465 - DEBUG - Step 42: Loss=2.0481
2025-06-03 11:21:25,465 - DEBUG - Online update step: 43/50
2025-06-03 11:21:25,470 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:25,792 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:21:25,815 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:21:25,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:26,257 - DEBUG - Step 43: Loss=1.7660
2025-06-03 11:21:26,258 - DEBUG - Online update step: 44/50
2025-06-03 11:21:26,261 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:26,588 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:26,614 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:26,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:27,097 - DEBUG - Step 44: Loss=1.1663
2025-06-03 11:21:27,097 - DEBUG - Online update step: 45/50
2025-06-03 11:21:27,098 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:27,376 - DEBUG - Node anomaly scores shape: torch.Size([7675, 1])
2025-06-03 11:21:27,397 - DEBUG - Edge anomaly scores shape: torch.Size([15349, 1])
2025-06-03 11:21:27,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:27,798 - DEBUG - Step 45: Loss=1.1995
2025-06-03 11:21:27,798 - DEBUG - Online update step: 46/50
2025-06-03 11:21:27,801 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:28,090 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:28,115 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:28,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:28,560 - DEBUG - Step 46: Loss=1.4024
2025-06-03 11:21:28,560 - DEBUG - Online update step: 47/50
2025-06-03 11:21:28,562 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:28,835 - DEBUG - Node anomaly scores shape: torch.Size([8090, 1])
2025-06-03 11:21:28,861 - DEBUG - Edge anomaly scores shape: torch.Size([16367, 1])
2025-06-03 11:21:28,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:29,333 - DEBUG - Step 47: Loss=1.0962
2025-06-03 11:21:29,333 - DEBUG - Online update step: 48/50
2025-06-03 11:21:29,334 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:29,590 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:21:29,615 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:21:29,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:30,056 - DEBUG - Step 48: Loss=1.1454
2025-06-03 11:21:30,056 - DEBUG - Online update step: 49/50
2025-06-03 11:21:30,059 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:30,344 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:21:30,369 - DEBUG - Edge anomaly scores shape: torch.Size([15570, 1])
2025-06-03 11:21:30,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:30,802 - DEBUG - Step 49: Loss=1.3150
2025-06-03 11:21:30,802 - DEBUG - Online update step: 50/50
2025-06-03 11:21:30,804 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:31,090 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:21:31,115 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:21:31,116 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:31,571 - DEBUG - Step 50: Loss=1.0926
2025-06-03 11:21:31,571 - INFO - Online update finished. Average loss: 1.4018, Learning rate: 0.002714
2025-06-03 11:21:31,572 - DEBUG - Current node mean: [-5.2256128e-09  5.2256128e-09  5.2256128e-09  1.3064032e-09
 -2.6128064e-09 -3.7885691e-08 -1.3064032e-09  1.6983241e-08
  1.0451226e-08 -2.6128064e-09 -2.4168459e-08  1.0451226e-08
  1.4370435e-08 -3.7885691e-08 -3.5599488e-08  1.6983241e-08
 -1.6983241e-08  0.0000000e+00  0.0000000e+00 -1.8942846e-08
  0.0000000e+00  0.0000000e+00  2.8740869e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4271970e+00  4.9826813e+00 -1.2234437e-09  2.4468874e-09
  0.0000000e+00 -2.4468874e-09  2.4468874e-09  6.1172184e-10
 -4.8937747e-09 -4.5879136e-09  2.4468873e-08  9.7875494e-09
 -3.6703309e-09 -8.5641059e-09 -7.3406619e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.8937747e-09]
2025-06-03 11:21:31,572 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0040
2025-06-03 11:21:31,572 - INFO - Online update complete. Loss: 1.4018
2025-06-03 11:21:31,572 - INFO - Running anomaly detection...
2025-06-03 11:21:31,572 - INFO - Starting anomaly detection.
2025-06-03 11:21:31,582 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112131_update_18.json
2025-06-03 11:21:31,582 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:21:31,600 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112131_update_18.pth and as latest_checkpoint.pth
2025-06-03 11:21:31,600 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.0000
2025-06-03 11:21:31,600 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 11:21:31,600 - WARNING -   Node ID: 210.245.26.100, Recon Error: 1.6505, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Node ID: 183.81.34.26, Recon Error: 1.6815, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Node ID: ff02::2, Recon Error: 1.5678, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.1533, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 4.1685, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:21:31,600 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.8173, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.7392, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.1053, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.6439, MLP Score: 1.0000
2025-06-03 11:21:31,600 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 2.1999, MLP Score: 1.0000
2025-06-03 11:21:31,600 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-03 11:21:31,600 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-03 11:21:31,600 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot file.
2025-06-03 11:21:31,616 - INFO - Parsed 736 nodes.
2025-06-03 11:21:31,634 - INFO - Parsed 1571 edges.
2025-06-03 11:21:32,010 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:21:32,011 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:21:32,024 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-03 11:21:32,026 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:21:32,026 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-03 11:21:32,027 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-03 11:21:32,027 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:21:32,035 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:21:32,036 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:21:32,037 - DEBUG - Shape of encoded categorical edge features: torch.Size([1571, 2])
2025-06-03 11:21:32,039 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:21:32,039 - DEBUG - Shape of scaled numerical edge features: torch.Size([1571, 20])
2025-06-03 11:21:32,039 - DEBUG - Final edge attributes tensor shape: torch.Size([1571, 22])
2025-06-03 11:21:32,039 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:21:32,039 - INFO - Performing online update...
2025-06-03 11:21:32,039 - INFO - Starting online update for 50 steps.
2025-06-03 11:21:32,040 - DEBUG - Updated RunningStats: new_mean=0.5849049648568678, new_var=71400000000010.31, new_n=7170
2025-06-03 11:21:32,040 - DEBUG - Updated RunningStats: new_mean=0.5851085443551466, new_var=71700000000007.05, new_n=7200
2025-06-03 11:21:32,040 - DEBUG - Updated RunningStats: new_mean=0.8045975181399427, new_var=40120000000030.72, new_n=4034
2025-06-03 11:21:32,041 - DEBUG - Updated RunningStats: new_mean=0.8057309825665128, new_var=40340000000001.805, new_n=4056
2025-06-03 11:21:32,041 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:21:32,041 - DEBUG - Online update step: 1/50
2025-06-03 11:21:32,042 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:32,412 - DEBUG - Node anomaly scores shape: torch.Size([8450, 1])
2025-06-03 11:21:32,442 - DEBUG - Edge anomaly scores shape: torch.Size([17137, 1])
2025-06-03 11:21:32,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:32,935 - DEBUG - Step 1: Loss=1.1540
2025-06-03 11:21:32,935 - DEBUG - Online update step: 2/50
2025-06-03 11:21:32,937 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:33,242 - DEBUG - Node anomaly scores shape: torch.Size([8176, 1])
2025-06-03 11:21:33,270 - DEBUG - Edge anomaly scores shape: torch.Size([16478, 1])
2025-06-03 11:21:33,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:33,784 - DEBUG - Step 2: Loss=1.2956
2025-06-03 11:21:33,785 - DEBUG - Online update step: 3/50
2025-06-03 11:21:33,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:34,065 - DEBUG - Node anomaly scores shape: torch.Size([7773, 1])
2025-06-03 11:21:34,089 - DEBUG - Edge anomaly scores shape: torch.Size([15610, 1])
2025-06-03 11:21:34,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:34,494 - DEBUG - Step 3: Loss=1.0327
2025-06-03 11:21:34,494 - DEBUG - Online update step: 4/50
2025-06-03 11:21:34,496 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:34,807 - DEBUG - Node anomaly scores shape: torch.Size([8060, 1])
2025-06-03 11:21:34,837 - DEBUG - Edge anomaly scores shape: torch.Size([16308, 1])
2025-06-03 11:21:34,838 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:35,280 - DEBUG - Step 4: Loss=1.1411
2025-06-03 11:21:35,280 - DEBUG - Online update step: 5/50
2025-06-03 11:21:35,282 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:35,543 - DEBUG - Node anomaly scores shape: torch.Size([7718, 1])
2025-06-03 11:21:35,571 - DEBUG - Edge anomaly scores shape: torch.Size([15472, 1])
2025-06-03 11:21:35,572 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:35,997 - DEBUG - Step 5: Loss=1.2232
2025-06-03 11:21:35,998 - DEBUG - Online update step: 6/50
2025-06-03 11:21:35,999 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:36,285 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:21:36,309 - DEBUG - Edge anomaly scores shape: torch.Size([15539, 1])
2025-06-03 11:21:36,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:36,798 - DEBUG - Step 6: Loss=1.0969
2025-06-03 11:21:36,799 - DEBUG - Online update step: 7/50
2025-06-03 11:21:36,801 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:37,114 - DEBUG - Node anomaly scores shape: torch.Size([8570, 1])
2025-06-03 11:21:37,140 - DEBUG - Edge anomaly scores shape: torch.Size([17543, 1])
2025-06-03 11:21:37,141 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:37,633 - DEBUG - Step 7: Loss=0.9650
2025-06-03 11:21:37,633 - DEBUG - Online update step: 8/50
2025-06-03 11:21:37,635 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:37,919 - DEBUG - Node anomaly scores shape: torch.Size([7849, 1])
2025-06-03 11:21:37,943 - DEBUG - Edge anomaly scores shape: torch.Size([15764, 1])
2025-06-03 11:21:37,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:38,411 - DEBUG - Step 8: Loss=1.0157
2025-06-03 11:21:38,411 - DEBUG - Online update step: 9/50
2025-06-03 11:21:38,413 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:38,744 - DEBUG - Node anomaly scores shape: torch.Size([8068, 1])
2025-06-03 11:21:38,768 - DEBUG - Edge anomaly scores shape: torch.Size([16279, 1])
2025-06-03 11:21:38,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:39,229 - DEBUG - Step 9: Loss=0.9100
2025-06-03 11:21:39,229 - DEBUG - Online update step: 10/50
2025-06-03 11:21:39,231 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:39,555 - DEBUG - Node anomaly scores shape: torch.Size([8407, 1])
2025-06-03 11:21:39,587 - DEBUG - Edge anomaly scores shape: torch.Size([17105, 1])
2025-06-03 11:21:39,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:40,097 - DEBUG - Step 10: Loss=1.0192
2025-06-03 11:21:40,097 - DEBUG - Online update step: 11/50
2025-06-03 11:21:40,099 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:40,382 - DEBUG - Node anomaly scores shape: torch.Size([7951, 1])
2025-06-03 11:21:40,407 - DEBUG - Edge anomaly scores shape: torch.Size([15951, 1])
2025-06-03 11:21:40,408 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:40,867 - DEBUG - Step 11: Loss=0.9662
2025-06-03 11:21:40,867 - DEBUG - Online update step: 12/50
2025-06-03 11:21:40,869 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:41,161 - DEBUG - Node anomaly scores shape: torch.Size([7998, 1])
2025-06-03 11:21:41,188 - DEBUG - Edge anomaly scores shape: torch.Size([16117, 1])
2025-06-03 11:21:41,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:41,625 - DEBUG - Step 12: Loss=0.8744
2025-06-03 11:21:41,625 - DEBUG - Online update step: 13/50
2025-06-03 11:21:41,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:41,891 - DEBUG - Node anomaly scores shape: torch.Size([7833, 1])
2025-06-03 11:21:41,916 - DEBUG - Edge anomaly scores shape: torch.Size([15786, 1])
2025-06-03 11:21:41,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:42,354 - DEBUG - Step 13: Loss=0.9029
2025-06-03 11:21:42,354 - DEBUG - Online update step: 14/50
2025-06-03 11:21:42,356 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:42,649 - DEBUG - Node anomaly scores shape: torch.Size([7926, 1])
2025-06-03 11:21:42,675 - DEBUG - Edge anomaly scores shape: torch.Size([15968, 1])
2025-06-03 11:21:42,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:43,179 - DEBUG - Step 14: Loss=0.8998
2025-06-03 11:21:43,179 - DEBUG - Online update step: 15/50
2025-06-03 11:21:43,182 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:43,503 - DEBUG - Node anomaly scores shape: torch.Size([8037, 1])
2025-06-03 11:21:43,530 - DEBUG - Edge anomaly scores shape: torch.Size([16237, 1])
2025-06-03 11:21:43,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:43,997 - DEBUG - Step 15: Loss=0.8697
2025-06-03 11:21:43,997 - DEBUG - Online update step: 16/50
2025-06-03 11:21:44,000 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:44,299 - DEBUG - Node anomaly scores shape: torch.Size([8274, 1])
2025-06-03 11:21:44,328 - DEBUG - Edge anomaly scores shape: torch.Size([16708, 1])
2025-06-03 11:21:44,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:44,848 - DEBUG - Step 16: Loss=0.8914
2025-06-03 11:21:44,849 - DEBUG - Online update step: 17/50
2025-06-03 11:21:44,850 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:45,136 - DEBUG - Node anomaly scores shape: torch.Size([8304, 1])
2025-06-03 11:21:45,162 - DEBUG - Edge anomaly scores shape: torch.Size([16807, 1])
2025-06-03 11:21:45,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:45,629 - DEBUG - Step 17: Loss=0.8318
2025-06-03 11:21:45,629 - DEBUG - Online update step: 18/50
2025-06-03 11:21:45,631 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:45,932 - DEBUG - Node anomaly scores shape: torch.Size([7900, 1])
2025-06-03 11:21:45,958 - DEBUG - Edge anomaly scores shape: torch.Size([15876, 1])
2025-06-03 11:21:45,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:46,386 - DEBUG - Step 18: Loss=1.1813
2025-06-03 11:21:46,387 - DEBUG - Online update step: 19/50
2025-06-03 11:21:46,389 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:46,715 - DEBUG - Node anomaly scores shape: torch.Size([8478, 1])
2025-06-03 11:21:46,742 - DEBUG - Edge anomaly scores shape: torch.Size([17293, 1])
2025-06-03 11:21:46,743 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:47,223 - DEBUG - Step 19: Loss=1.1522
2025-06-03 11:21:47,224 - DEBUG - Online update step: 20/50
2025-06-03 11:21:47,226 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:47,528 - DEBUG - Node anomaly scores shape: torch.Size([8438, 1])
2025-06-03 11:21:47,555 - DEBUG - Edge anomaly scores shape: torch.Size([17141, 1])
2025-06-03 11:21:47,556 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:48,193 - DEBUG - Step 20: Loss=0.8396
2025-06-03 11:21:48,193 - DEBUG - Online update step: 21/50
2025-06-03 11:21:48,195 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:48,489 - DEBUG - Node anomaly scores shape: torch.Size([7984, 1])
2025-06-03 11:21:48,516 - DEBUG - Edge anomaly scores shape: torch.Size([16061, 1])
2025-06-03 11:21:48,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:49,002 - DEBUG - Step 21: Loss=1.1591
2025-06-03 11:21:49,002 - DEBUG - Online update step: 22/50
2025-06-03 11:21:49,004 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:49,283 - DEBUG - Node anomaly scores shape: torch.Size([7957, 1])
2025-06-03 11:21:49,308 - DEBUG - Edge anomaly scores shape: torch.Size([15963, 1])
2025-06-03 11:21:49,309 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:49,737 - DEBUG - Step 22: Loss=1.8287
2025-06-03 11:21:49,737 - DEBUG - Online update step: 23/50
2025-06-03 11:21:49,738 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:50,043 - DEBUG - Node anomaly scores shape: torch.Size([8357, 1])
2025-06-03 11:21:50,066 - DEBUG - Edge anomaly scores shape: torch.Size([16955, 1])
2025-06-03 11:21:50,067 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:50,561 - DEBUG - Step 23: Loss=1.6884
2025-06-03 11:21:50,561 - DEBUG - Online update step: 24/50
2025-06-03 11:21:50,563 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:50,817 - DEBUG - Node anomaly scores shape: torch.Size([7667, 1])
2025-06-03 11:21:50,838 - DEBUG - Edge anomaly scores shape: torch.Size([15323, 1])
2025-06-03 11:21:50,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:51,223 - DEBUG - Step 24: Loss=1.2008
2025-06-03 11:21:51,223 - DEBUG - Online update step: 25/50
2025-06-03 11:21:51,225 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:51,535 - DEBUG - Node anomaly scores shape: torch.Size([8120, 1])
2025-06-03 11:21:51,561 - DEBUG - Edge anomaly scores shape: torch.Size([16484, 1])
2025-06-03 11:21:51,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:52,011 - DEBUG - Step 25: Loss=0.8508
2025-06-03 11:21:52,011 - DEBUG - Online update step: 26/50
2025-06-03 11:21:52,012 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:52,296 - DEBUG - Node anomaly scores shape: torch.Size([8133, 1])
2025-06-03 11:21:52,323 - DEBUG - Edge anomaly scores shape: torch.Size([16490, 1])
2025-06-03 11:21:52,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:52,804 - DEBUG - Step 26: Loss=1.4907
2025-06-03 11:21:52,804 - DEBUG - Online update step: 27/50
2025-06-03 11:21:52,806 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:53,123 - DEBUG - Node anomaly scores shape: torch.Size([8387, 1])
2025-06-03 11:21:53,149 - DEBUG - Edge anomaly scores shape: torch.Size([17019, 1])
2025-06-03 11:21:53,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:53,679 - DEBUG - Step 27: Loss=2.0466
2025-06-03 11:21:53,680 - DEBUG - Online update step: 28/50
2025-06-03 11:21:53,682 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:53,942 - DEBUG - Node anomaly scores shape: torch.Size([7879, 1])
2025-06-03 11:21:53,967 - DEBUG - Edge anomaly scores shape: torch.Size([15847, 1])
2025-06-03 11:21:53,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:54,424 - DEBUG - Step 28: Loss=1.7865
2025-06-03 11:21:54,424 - DEBUG - Online update step: 29/50
2025-06-03 11:21:54,427 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:54,724 - DEBUG - Node anomaly scores shape: torch.Size([7696, 1])
2025-06-03 11:21:54,750 - DEBUG - Edge anomaly scores shape: torch.Size([15406, 1])
2025-06-03 11:21:54,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:55,208 - DEBUG - Step 29: Loss=1.0209
2025-06-03 11:21:55,208 - DEBUG - Online update step: 30/50
2025-06-03 11:21:55,210 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:55,516 - DEBUG - Node anomaly scores shape: torch.Size([8111, 1])
2025-06-03 11:21:55,542 - DEBUG - Edge anomaly scores shape: torch.Size([16417, 1])
2025-06-03 11:21:55,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:56,009 - DEBUG - Step 30: Loss=0.9562
2025-06-03 11:21:56,009 - DEBUG - Online update step: 31/50
2025-06-03 11:21:56,011 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:56,313 - DEBUG - Node anomaly scores shape: torch.Size([8226, 1])
2025-06-03 11:21:56,339 - DEBUG - Edge anomaly scores shape: torch.Size([16638, 1])
2025-06-03 11:21:56,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:56,863 - DEBUG - Step 31: Loss=1.1152
2025-06-03 11:21:56,864 - DEBUG - Online update step: 32/50
2025-06-03 11:21:56,866 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:57,185 - DEBUG - Node anomaly scores shape: torch.Size([8820, 1])
2025-06-03 11:21:57,213 - DEBUG - Edge anomaly scores shape: torch.Size([17999, 1])
2025-06-03 11:21:57,214 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:57,753 - DEBUG - Step 32: Loss=1.0397
2025-06-03 11:21:57,753 - DEBUG - Online update step: 33/50
2025-06-03 11:21:57,755 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:58,056 - DEBUG - Node anomaly scores shape: torch.Size([7984, 1])
2025-06-03 11:21:58,081 - DEBUG - Edge anomaly scores shape: torch.Size([16061, 1])
2025-06-03 11:21:58,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:58,545 - DEBUG - Step 33: Loss=0.9309
2025-06-03 11:21:58,545 - DEBUG - Online update step: 34/50
2025-06-03 11:21:58,547 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:58,795 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:21:58,819 - DEBUG - Edge anomaly scores shape: torch.Size([15539, 1])
2025-06-03 11:21:58,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:21:59,242 - DEBUG - Step 34: Loss=0.8445
2025-06-03 11:21:59,242 - DEBUG - Online update step: 35/50
2025-06-03 11:21:59,244 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:21:59,545 - DEBUG - Node anomaly scores shape: torch.Size([8223, 1])
2025-06-03 11:21:59,568 - DEBUG - Edge anomaly scores shape: torch.Size([16644, 1])
2025-06-03 11:21:59,569 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:00,029 - DEBUG - Step 35: Loss=1.0715
2025-06-03 11:22:00,029 - DEBUG - Online update step: 36/50
2025-06-03 11:22:00,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:00,325 - DEBUG - Node anomaly scores shape: torch.Size([8323, 1])
2025-06-03 11:22:00,351 - DEBUG - Edge anomaly scores shape: torch.Size([16928, 1])
2025-06-03 11:22:00,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:00,852 - DEBUG - Step 36: Loss=1.2367
2025-06-03 11:22:00,852 - DEBUG - Online update step: 37/50
2025-06-03 11:22:00,854 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:01,140 - DEBUG - Node anomaly scores shape: torch.Size([8047, 1])
2025-06-03 11:22:01,163 - DEBUG - Edge anomaly scores shape: torch.Size([16222, 1])
2025-06-03 11:22:01,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:01,632 - DEBUG - Step 37: Loss=1.0300
2025-06-03 11:22:01,633 - DEBUG - Online update step: 38/50
2025-06-03 11:22:01,634 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:01,944 - DEBUG - Node anomaly scores shape: torch.Size([8315, 1])
2025-06-03 11:22:01,970 - DEBUG - Edge anomaly scores shape: torch.Size([16855, 1])
2025-06-03 11:22:01,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:02,504 - DEBUG - Step 38: Loss=0.8945
2025-06-03 11:22:02,504 - DEBUG - Online update step: 39/50
2025-06-03 11:22:02,505 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:02,811 - DEBUG - Node anomaly scores shape: torch.Size([8407, 1])
2025-06-03 11:22:02,840 - DEBUG - Edge anomaly scores shape: torch.Size([17105, 1])
2025-06-03 11:22:02,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:03,360 - DEBUG - Step 39: Loss=1.1051
2025-06-03 11:22:03,360 - DEBUG - Online update step: 40/50
2025-06-03 11:22:03,362 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:03,657 - DEBUG - Node anomaly scores shape: torch.Size([8309, 1])
2025-06-03 11:22:03,681 - DEBUG - Edge anomaly scores shape: torch.Size([16885, 1])
2025-06-03 11:22:03,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:04,170 - DEBUG - Step 40: Loss=1.1277
2025-06-03 11:22:04,170 - DEBUG - Online update step: 41/50
2025-06-03 11:22:04,172 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:04,426 - DEBUG - Node anomaly scores shape: torch.Size([7833, 1])
2025-06-03 11:22:04,451 - DEBUG - Edge anomaly scores shape: torch.Size([15786, 1])
2025-06-03 11:22:04,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:04,912 - DEBUG - Step 41: Loss=0.9823
2025-06-03 11:22:04,913 - DEBUG - Online update step: 42/50
2025-06-03 11:22:04,916 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:05,360 - DEBUG - Node anomaly scores shape: torch.Size([8321, 1])
2025-06-03 11:22:05,390 - DEBUG - Edge anomaly scores shape: torch.Size([16865, 1])
2025-06-03 11:22:05,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:05,959 - DEBUG - Step 42: Loss=0.9722
2025-06-03 11:22:05,959 - DEBUG - Online update step: 43/50
2025-06-03 11:22:05,961 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:06,255 - DEBUG - Node anomaly scores shape: torch.Size([8140, 1])
2025-06-03 11:22:06,281 - DEBUG - Edge anomaly scores shape: torch.Size([16404, 1])
2025-06-03 11:22:06,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:06,765 - DEBUG - Step 43: Loss=1.1492
2025-06-03 11:22:06,765 - DEBUG - Online update step: 44/50
2025-06-03 11:22:06,767 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:07,061 - DEBUG - Node anomaly scores shape: torch.Size([8268, 1])
2025-06-03 11:22:07,087 - DEBUG - Edge anomaly scores shape: torch.Size([16689, 1])
2025-06-03 11:22:07,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:07,552 - DEBUG - Step 44: Loss=1.1334
2025-06-03 11:22:07,552 - DEBUG - Online update step: 45/50
2025-06-03 11:22:07,553 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:07,819 - DEBUG - Node anomaly scores shape: torch.Size([7833, 1])
2025-06-03 11:22:07,843 - DEBUG - Edge anomaly scores shape: torch.Size([15786, 1])
2025-06-03 11:22:07,844 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:08,275 - DEBUG - Step 45: Loss=0.8765
2025-06-03 11:22:08,276 - DEBUG - Online update step: 46/50
2025-06-03 11:22:08,277 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:08,539 - DEBUG - Node anomaly scores shape: torch.Size([7786, 1])
2025-06-03 11:22:08,563 - DEBUG - Edge anomaly scores shape: torch.Size([15665, 1])
2025-06-03 11:22:08,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:09,050 - DEBUG - Step 46: Loss=1.0455
2025-06-03 11:22:09,050 - DEBUG - Online update step: 47/50
2025-06-03 11:22:09,051 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:09,308 - DEBUG - Node anomaly scores shape: torch.Size([7697, 1])
2025-06-03 11:22:09,335 - DEBUG - Edge anomaly scores shape: torch.Size([15422, 1])
2025-06-03 11:22:09,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:09,807 - DEBUG - Step 47: Loss=1.4387
2025-06-03 11:22:09,807 - DEBUG - Online update step: 48/50
2025-06-03 11:22:09,810 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:10,115 - DEBUG - Node anomaly scores shape: torch.Size([8268, 1])
2025-06-03 11:22:10,142 - DEBUG - Edge anomaly scores shape: torch.Size([16689, 1])
2025-06-03 11:22:10,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:10,647 - DEBUG - Step 48: Loss=1.1543
2025-06-03 11:22:10,647 - DEBUG - Online update step: 49/50
2025-06-03 11:22:10,649 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:10,930 - DEBUG - Node anomaly scores shape: torch.Size([7886, 1])
2025-06-03 11:22:10,956 - DEBUG - Edge anomaly scores shape: torch.Size([15875, 1])
2025-06-03 11:22:10,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:11,433 - DEBUG - Step 49: Loss=0.8704
2025-06-03 11:22:11,434 - DEBUG - Online update step: 50/50
2025-06-03 11:22:11,436 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:11,735 - DEBUG - Node anomaly scores shape: torch.Size([8134, 1])
2025-06-03 11:22:11,760 - DEBUG - Edge anomaly scores shape: torch.Size([16475, 1])
2025-06-03 11:22:11,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:12,240 - DEBUG - Step 50: Loss=0.9423
2025-06-03 11:22:12,240 - INFO - Online update finished. Average loss: 1.1050, Learning rate: 0.002382
2025-06-03 11:22:12,240 - DEBUG - Current node mean: [-2.0732051e-08  2.0732051e-08  2.5915062e-08  2.2027804e-08
 -5.5069509e-09 -4.4703484e-08 -4.5351358e-09 -1.1985716e-08
  1.2957531e-08  1.0366025e-08  3.4337457e-08  0.0000000e+00
 -2.2675680e-08  4.5351358e-09  5.1830124e-08  5.1830127e-09
  4.5351358e-09  0.0000000e+00  0.0000000e+00  1.3605408e-08
  0.0000000e+00  0.0000000e+00 -5.1830127e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4252069e+00  4.9700828e+00 -3.0352461e-09  2.4281968e-09
 -6.0704919e-10  1.2140984e-09  0.0000000e+00  0.0000000e+00
 -3.6422954e-09 -6.0704921e-09  8.4986889e-09  9.7127870e-09
 -2.4281968e-09  1.3962132e-08  1.2140984e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4281968e-09]
2025-06-03 11:22:12,240 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0071
2025-06-03 11:22:12,245 - INFO - Online update complete. Loss: 1.1050
2025-06-03 11:22:12,245 - INFO - Running anomaly detection...
2025-06-03 11:22:12,246 - INFO - Starting anomaly detection.
2025-06-03 11:22:12,257 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112212_update_19.json
2025-06-03 11:22:12,257 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:22:12,276 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112212_update_19.pth and as latest_checkpoint.pth
2025-06-03 11:22:12,277 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.0000
2025-06-03 11:22:12,277 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-03 11:22:12,277 - WARNING -   Node ID: 210.245.26.100, Recon Error: 1.0319, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.4816, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Node ID: 183.81.34.26, Recon Error: 0.7005, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Node ID: ff02::2, Recon Error: 1.0787, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.6245, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:22:12,277 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.7926, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.8994, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.0894, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.2533, MLP Score: 1.0000
2025-06-03 11:22:12,277 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 1.5033, MLP Score: 1.0000
2025-06-03 11:22:12,277 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-03 11:22:12,277 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-03 11:22:12,277 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot file.
2025-06-03 11:22:12,293 - INFO - Parsed 762 nodes.
2025-06-03 11:22:12,311 - INFO - Parsed 1619 edges.
2025-06-03 11:22:12,712 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:22:12,712 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:22:12,726 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-03 11:22:12,727 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:22:12,727 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-03 11:22:12,728 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-03 11:22:12,728 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:22:12,736 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:22:12,737 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:22:12,738 - DEBUG - Shape of encoded categorical edge features: torch.Size([1619, 2])
2025-06-03 11:22:12,740 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:22:12,740 - DEBUG - Shape of scaled numerical edge features: torch.Size([1619, 20])
2025-06-03 11:22:12,740 - DEBUG - Final edge attributes tensor shape: torch.Size([1619, 22])
2025-06-03 11:22:12,740 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:22:12,740 - INFO - Performing online update...
2025-06-03 11:22:12,740 - INFO - Starting online update for 50 steps.
2025-06-03 11:22:12,741 - DEBUG - Updated RunningStats: new_mean=0.5826807080521277, new_var=72000000000010.23, new_n=7230
2025-06-03 11:22:12,741 - DEBUG - Updated RunningStats: new_mean=0.5828917353664695, new_var=72300000000007.05, new_n=7260
2025-06-03 11:22:12,741 - DEBUG - Updated RunningStats: new_mean=0.802952621091102, new_var=40560000000030.72, new_n=4078
2025-06-03 11:22:12,741 - DEBUG - Updated RunningStats: new_mean=0.8040823971798885, new_var=40780000000001.83, new_n=4100
2025-06-03 11:22:12,742 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:22:12,742 - DEBUG - Online update step: 1/50
2025-06-03 11:22:12,743 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:13,089 - DEBUG - Node anomaly scores shape: torch.Size([8067, 1])
2025-06-03 11:22:13,117 - DEBUG - Edge anomaly scores shape: torch.Size([16308, 1])
2025-06-03 11:22:13,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:13,572 - DEBUG - Step 1: Loss=0.9587
2025-06-03 11:22:13,573 - DEBUG - Online update step: 2/50
2025-06-03 11:22:13,575 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:13,884 - DEBUG - Node anomaly scores shape: torch.Size([8285, 1])
2025-06-03 11:22:13,911 - DEBUG - Edge anomaly scores shape: torch.Size([16742, 1])
2025-06-03 11:22:13,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:14,411 - DEBUG - Step 2: Loss=0.8451
2025-06-03 11:22:14,411 - DEBUG - Online update step: 3/50
2025-06-03 11:22:14,414 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:14,699 - DEBUG - Node anomaly scores shape: torch.Size([7737, 1])
2025-06-03 11:22:14,724 - DEBUG - Edge anomaly scores shape: torch.Size([15515, 1])
2025-06-03 11:22:14,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:15,193 - DEBUG - Step 3: Loss=0.9394
2025-06-03 11:22:15,193 - DEBUG - Online update step: 4/50
2025-06-03 11:22:15,195 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:15,532 - DEBUG - Node anomaly scores shape: torch.Size([8482, 1])
2025-06-03 11:22:15,558 - DEBUG - Edge anomaly scores shape: torch.Size([17197, 1])
2025-06-03 11:22:15,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:16,075 - DEBUG - Step 4: Loss=0.9752
2025-06-03 11:22:16,075 - DEBUG - Online update step: 5/50
2025-06-03 11:22:16,077 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:16,401 - DEBUG - Node anomaly scores shape: torch.Size([8714, 1])
2025-06-03 11:22:16,429 - DEBUG - Edge anomaly scores shape: torch.Size([17766, 1])
2025-06-03 11:22:16,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:16,933 - DEBUG - Step 5: Loss=0.9170
2025-06-03 11:22:16,933 - DEBUG - Online update step: 6/50
2025-06-03 11:22:16,934 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:17,235 - DEBUG - Node anomaly scores shape: torch.Size([8413, 1])
2025-06-03 11:22:17,261 - DEBUG - Edge anomaly scores shape: torch.Size([17067, 1])
2025-06-03 11:22:17,262 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:17,681 - DEBUG - Step 6: Loss=0.9506
2025-06-03 11:22:17,682 - DEBUG - Online update step: 7/50
2025-06-03 11:22:17,684 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:17,980 - DEBUG - Node anomaly scores shape: torch.Size([8252, 1])
2025-06-03 11:22:18,006 - DEBUG - Edge anomaly scores shape: torch.Size([16686, 1])
2025-06-03 11:22:18,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:18,486 - DEBUG - Step 7: Loss=0.8552
2025-06-03 11:22:18,486 - DEBUG - Online update step: 8/50
2025-06-03 11:22:18,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:18,789 - DEBUG - Node anomaly scores shape: torch.Size([8262, 1])
2025-06-03 11:22:18,818 - DEBUG - Edge anomaly scores shape: torch.Size([16723, 1])
2025-06-03 11:22:18,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:19,321 - DEBUG - Step 8: Loss=0.9645
2025-06-03 11:22:19,322 - DEBUG - Online update step: 9/50
2025-06-03 11:22:19,324 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:19,659 - DEBUG - Node anomaly scores shape: torch.Size([8573, 1])
2025-06-03 11:22:19,687 - DEBUG - Edge anomaly scores shape: torch.Size([17532, 1])
2025-06-03 11:22:19,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:20,214 - DEBUG - Step 9: Loss=1.1336
2025-06-03 11:22:20,215 - DEBUG - Online update step: 10/50
2025-06-03 11:22:20,217 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:20,516 - DEBUG - Node anomaly scores shape: torch.Size([8120, 1])
2025-06-03 11:22:20,541 - DEBUG - Edge anomaly scores shape: torch.Size([16436, 1])
2025-06-03 11:22:20,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:20,965 - DEBUG - Step 10: Loss=0.9223
2025-06-03 11:22:20,965 - DEBUG - Online update step: 11/50
2025-06-03 11:22:20,967 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:21,263 - DEBUG - Node anomaly scores shape: torch.Size([8150, 1])
2025-06-03 11:22:21,289 - DEBUG - Edge anomaly scores shape: torch.Size([16489, 1])
2025-06-03 11:22:21,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:21,779 - DEBUG - Step 11: Loss=0.8410
2025-06-03 11:22:21,780 - DEBUG - Online update step: 12/50
2025-06-03 11:22:21,781 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:22,140 - DEBUG - Node anomaly scores shape: torch.Size([8572, 1])
2025-06-03 11:22:22,166 - DEBUG - Edge anomaly scores shape: torch.Size([17409, 1])
2025-06-03 11:22:22,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:22,692 - DEBUG - Step 12: Loss=0.8746
2025-06-03 11:22:22,692 - DEBUG - Online update step: 13/50
2025-06-03 11:22:22,693 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:22,994 - DEBUG - Node anomaly scores shape: torch.Size([8060, 1])
2025-06-03 11:22:23,018 - DEBUG - Edge anomaly scores shape: torch.Size([16215, 1])
2025-06-03 11:22:23,019 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:23,586 - DEBUG - Step 13: Loss=0.7915
2025-06-03 11:22:23,587 - DEBUG - Online update step: 14/50
2025-06-03 11:22:23,592 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:23,902 - DEBUG - Node anomaly scores shape: torch.Size([8004, 1])
2025-06-03 11:22:23,927 - DEBUG - Edge anomaly scores shape: torch.Size([16061, 1])
2025-06-03 11:22:23,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:24,480 - DEBUG - Step 14: Loss=0.7435
2025-06-03 11:22:24,481 - DEBUG - Online update step: 15/50
2025-06-03 11:22:24,482 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:24,797 - DEBUG - Node anomaly scores shape: torch.Size([8073, 1])
2025-06-03 11:22:24,823 - DEBUG - Edge anomaly scores shape: torch.Size([16300, 1])
2025-06-03 11:22:24,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:25,320 - DEBUG - Step 15: Loss=0.7862
2025-06-03 11:22:25,320 - DEBUG - Online update step: 16/50
2025-06-03 11:22:25,322 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:25,625 - DEBUG - Node anomaly scores shape: torch.Size([8181, 1])
2025-06-03 11:22:25,651 - DEBUG - Edge anomaly scores shape: torch.Size([16573, 1])
2025-06-03 11:22:25,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:26,127 - DEBUG - Step 16: Loss=0.7849
2025-06-03 11:22:26,127 - DEBUG - Online update step: 17/50
2025-06-03 11:22:26,128 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:26,433 - DEBUG - Node anomaly scores shape: torch.Size([8126, 1])
2025-06-03 11:22:26,460 - DEBUG - Edge anomaly scores shape: torch.Size([16448, 1])
2025-06-03 11:22:26,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:26,966 - DEBUG - Step 17: Loss=0.8629
2025-06-03 11:22:26,966 - DEBUG - Online update step: 18/50
2025-06-03 11:22:26,969 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:27,275 - DEBUG - Node anomaly scores shape: torch.Size([8296, 1])
2025-06-03 11:22:27,305 - DEBUG - Edge anomaly scores shape: torch.Size([16830, 1])
2025-06-03 11:22:27,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:27,809 - DEBUG - Step 18: Loss=0.8353
2025-06-03 11:22:27,810 - DEBUG - Online update step: 19/50
2025-06-03 11:22:27,812 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:28,141 - DEBUG - Node anomaly scores shape: torch.Size([8510, 1])
2025-06-03 11:22:28,166 - DEBUG - Edge anomaly scores shape: torch.Size([17266, 1])
2025-06-03 11:22:28,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:28,637 - DEBUG - Step 19: Loss=0.7635
2025-06-03 11:22:28,637 - DEBUG - Online update step: 20/50
2025-06-03 11:22:28,639 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:28,938 - DEBUG - Node anomaly scores shape: torch.Size([8275, 1])
2025-06-03 11:22:28,964 - DEBUG - Edge anomaly scores shape: torch.Size([16757, 1])
2025-06-03 11:22:28,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:29,458 - DEBUG - Step 20: Loss=0.7671
2025-06-03 11:22:29,458 - DEBUG - Online update step: 21/50
2025-06-03 11:22:29,461 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:29,737 - DEBUG - Node anomaly scores shape: torch.Size([7855, 1])
2025-06-03 11:22:29,761 - DEBUG - Edge anomaly scores shape: torch.Size([15836, 1])
2025-06-03 11:22:29,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:30,236 - DEBUG - Step 21: Loss=0.9215
2025-06-03 11:22:30,237 - DEBUG - Online update step: 22/50
2025-06-03 11:22:30,239 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:30,548 - DEBUG - Node anomaly scores shape: torch.Size([8507, 1])
2025-06-03 11:22:30,575 - DEBUG - Edge anomaly scores shape: torch.Size([17379, 1])
2025-06-03 11:22:30,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:31,120 - DEBUG - Step 22: Loss=0.8840
2025-06-03 11:22:31,120 - DEBUG - Online update step: 23/50
2025-06-03 11:22:31,121 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:31,455 - DEBUG - Node anomaly scores shape: torch.Size([8928, 1])
2025-06-03 11:22:31,484 - DEBUG - Edge anomaly scores shape: torch.Size([18202, 1])
2025-06-03 11:22:31,485 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:32,007 - DEBUG - Step 23: Loss=0.7634
2025-06-03 11:22:32,007 - DEBUG - Online update step: 24/50
2025-06-03 11:22:32,009 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:32,304 - DEBUG - Node anomaly scores shape: torch.Size([8410, 1])
2025-06-03 11:22:32,329 - DEBUG - Edge anomaly scores shape: torch.Size([17122, 1])
2025-06-03 11:22:32,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:32,819 - DEBUG - Step 24: Loss=0.7615
2025-06-03 11:22:32,819 - DEBUG - Online update step: 25/50
2025-06-03 11:22:32,821 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:33,122 - DEBUG - Node anomaly scores shape: torch.Size([8335, 1])
2025-06-03 11:22:33,149 - DEBUG - Edge anomaly scores shape: torch.Size([16985, 1])
2025-06-03 11:22:33,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:33,659 - DEBUG - Step 25: Loss=0.7971
2025-06-03 11:22:33,659 - DEBUG - Online update step: 26/50
2025-06-03 11:22:33,661 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:33,960 - DEBUG - Node anomaly scores shape: torch.Size([7833, 1])
2025-06-03 11:22:33,985 - DEBUG - Edge anomaly scores shape: torch.Size([15763, 1])
2025-06-03 11:22:33,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:34,471 - DEBUG - Step 26: Loss=0.7937
2025-06-03 11:22:34,471 - DEBUG - Online update step: 27/50
2025-06-03 11:22:34,474 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:34,782 - DEBUG - Node anomaly scores shape: torch.Size([8323, 1])
2025-06-03 11:22:34,808 - DEBUG - Edge anomaly scores shape: torch.Size([16928, 1])
2025-06-03 11:22:34,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:35,301 - DEBUG - Step 27: Loss=0.8589
2025-06-03 11:22:35,301 - DEBUG - Online update step: 28/50
2025-06-03 11:22:35,303 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:35,636 - DEBUG - Node anomaly scores shape: torch.Size([8948, 1])
2025-06-03 11:22:35,665 - DEBUG - Edge anomaly scores shape: torch.Size([18327, 1])
2025-06-03 11:22:35,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:36,210 - DEBUG - Step 28: Loss=0.8476
2025-06-03 11:22:36,210 - DEBUG - Online update step: 29/50
2025-06-03 11:22:36,213 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:36,532 - DEBUG - Node anomaly scores shape: torch.Size([8736, 1])
2025-06-03 11:22:36,560 - DEBUG - Edge anomaly scores shape: torch.Size([17824, 1])
2025-06-03 11:22:36,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:37,087 - DEBUG - Step 29: Loss=0.7655
2025-06-03 11:22:37,087 - DEBUG - Online update step: 30/50
2025-06-03 11:22:37,088 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:37,392 - DEBUG - Node anomaly scores shape: torch.Size([8681, 1])
2025-06-03 11:22:37,420 - DEBUG - Edge anomaly scores shape: torch.Size([17742, 1])
2025-06-03 11:22:37,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:37,919 - DEBUG - Step 30: Loss=0.7417
2025-06-03 11:22:37,919 - DEBUG - Online update step: 31/50
2025-06-03 11:22:37,921 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:38,265 - DEBUG - Node anomaly scores shape: torch.Size([7795, 1])
2025-06-03 11:22:38,295 - DEBUG - Edge anomaly scores shape: torch.Size([15654, 1])
2025-06-03 11:22:38,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:38,850 - DEBUG - Step 31: Loss=0.8152
2025-06-03 11:22:38,850 - DEBUG - Online update step: 32/50
2025-06-03 11:22:38,853 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:39,332 - DEBUG - Node anomaly scores shape: torch.Size([8008, 1])
2025-06-03 11:22:39,371 - DEBUG - Edge anomaly scores shape: torch.Size([16194, 1])
2025-06-03 11:22:39,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:39,906 - DEBUG - Step 32: Loss=0.8296
2025-06-03 11:22:39,906 - DEBUG - Online update step: 33/50
2025-06-03 11:22:39,907 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:40,216 - DEBUG - Node anomaly scores shape: torch.Size([8513, 1])
2025-06-03 11:22:40,242 - DEBUG - Edge anomaly scores shape: torch.Size([17356, 1])
2025-06-03 11:22:40,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:40,843 - DEBUG - Step 33: Loss=0.7463
2025-06-03 11:22:40,843 - DEBUG - Online update step: 34/50
2025-06-03 11:22:40,846 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:41,125 - DEBUG - Node anomaly scores shape: torch.Size([8150, 1])
2025-06-03 11:22:41,150 - DEBUG - Edge anomaly scores shape: torch.Size([16504, 1])
2025-06-03 11:22:41,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:41,731 - DEBUG - Step 34: Loss=0.7601
2025-06-03 11:22:41,732 - DEBUG - Online update step: 35/50
2025-06-03 11:22:41,734 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:42,073 - DEBUG - Node anomaly scores shape: torch.Size([8043, 1])
2025-06-03 11:22:42,101 - DEBUG - Edge anomaly scores shape: torch.Size([16201, 1])
2025-06-03 11:22:42,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:42,552 - DEBUG - Step 35: Loss=0.7491
2025-06-03 11:22:42,552 - DEBUG - Online update step: 36/50
2025-06-03 11:22:42,554 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:42,887 - DEBUG - Node anomaly scores shape: torch.Size([8755, 1])
2025-06-03 11:22:42,914 - DEBUG - Edge anomaly scores shape: torch.Size([17964, 1])
2025-06-03 11:22:42,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:43,454 - DEBUG - Step 36: Loss=0.9501
2025-06-03 11:22:43,454 - DEBUG - Online update step: 37/50
2025-06-03 11:22:43,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:43,886 - DEBUG - Node anomaly scores shape: torch.Size([7722, 1])
2025-06-03 11:22:43,912 - DEBUG - Edge anomaly scores shape: torch.Size([15454, 1])
2025-06-03 11:22:43,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:44,326 - DEBUG - Step 37: Loss=1.0271
2025-06-03 11:22:44,326 - DEBUG - Online update step: 38/50
2025-06-03 11:22:44,328 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:44,609 - DEBUG - Node anomaly scores shape: torch.Size([7773, 1])
2025-06-03 11:22:44,634 - DEBUG - Edge anomaly scores shape: torch.Size([15610, 1])
2025-06-03 11:22:44,635 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:45,217 - DEBUG - Step 38: Loss=0.8165
2025-06-03 11:22:45,218 - DEBUG - Online update step: 39/50
2025-06-03 11:22:45,227 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:45,703 - DEBUG - Node anomaly scores shape: torch.Size([8808, 1])
2025-06-03 11:22:45,729 - DEBUG - Edge anomaly scores shape: torch.Size([18007, 1])
2025-06-03 11:22:45,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:46,401 - DEBUG - Step 39: Loss=0.8733
2025-06-03 11:22:46,401 - DEBUG - Online update step: 40/50
2025-06-03 11:22:46,404 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:46,743 - DEBUG - Node anomaly scores shape: torch.Size([8906, 1])
2025-06-03 11:22:46,767 - DEBUG - Edge anomaly scores shape: torch.Size([18228, 1])
2025-06-03 11:22:46,768 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:47,389 - DEBUG - Step 40: Loss=0.9053
2025-06-03 11:22:47,389 - DEBUG - Online update step: 41/50
2025-06-03 11:22:47,390 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:47,726 - DEBUG - Node anomaly scores shape: torch.Size([8613, 1])
2025-06-03 11:22:47,754 - DEBUG - Edge anomaly scores shape: torch.Size([17653, 1])
2025-06-03 11:22:47,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:48,320 - DEBUG - Step 41: Loss=0.8454
2025-06-03 11:22:48,320 - DEBUG - Online update step: 42/50
2025-06-03 11:22:48,322 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:48,631 - DEBUG - Node anomaly scores shape: torch.Size([8099, 1])
2025-06-03 11:22:48,657 - DEBUG - Edge anomaly scores shape: torch.Size([16380, 1])
2025-06-03 11:22:48,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:49,171 - DEBUG - Step 42: Loss=0.8176
2025-06-03 11:22:49,171 - DEBUG - Online update step: 43/50
2025-06-03 11:22:49,175 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:49,509 - DEBUG - Node anomaly scores shape: torch.Size([8364, 1])
2025-06-03 11:22:49,536 - DEBUG - Edge anomaly scores shape: torch.Size([16940, 1])
2025-06-03 11:22:49,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:50,040 - DEBUG - Step 43: Loss=0.8682
2025-06-03 11:22:50,040 - DEBUG - Online update step: 44/50
2025-06-03 11:22:50,041 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:50,350 - DEBUG - Node anomaly scores shape: torch.Size([8421, 1])
2025-06-03 11:22:50,376 - DEBUG - Edge anomaly scores shape: torch.Size([17145, 1])
2025-06-03 11:22:50,377 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:50,895 - DEBUG - Step 44: Loss=0.8482
2025-06-03 11:22:50,895 - DEBUG - Online update step: 45/50
2025-06-03 11:22:50,897 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:51,199 - DEBUG - Node anomaly scores shape: torch.Size([8245, 1])
2025-06-03 11:22:51,227 - DEBUG - Edge anomaly scores shape: torch.Size([16726, 1])
2025-06-03 11:22:51,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:51,772 - DEBUG - Step 45: Loss=0.7917
2025-06-03 11:22:51,772 - DEBUG - Online update step: 46/50
2025-06-03 11:22:51,774 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:52,068 - DEBUG - Node anomaly scores shape: torch.Size([8321, 1])
2025-06-03 11:22:52,092 - DEBUG - Edge anomaly scores shape: torch.Size([16865, 1])
2025-06-03 11:22:52,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:52,504 - DEBUG - Step 46: Loss=0.7699
2025-06-03 11:22:52,505 - DEBUG - Online update step: 47/50
2025-06-03 11:22:52,507 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:52,785 - DEBUG - Node anomaly scores shape: torch.Size([8060, 1])
2025-06-03 11:22:52,812 - DEBUG - Edge anomaly scores shape: torch.Size([16260, 1])
2025-06-03 11:22:52,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:53,273 - DEBUG - Step 47: Loss=0.7910
2025-06-03 11:22:53,274 - DEBUG - Online update step: 48/50
2025-06-03 11:22:53,275 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:53,562 - DEBUG - Node anomaly scores shape: torch.Size([8143, 1])
2025-06-03 11:22:53,587 - DEBUG - Edge anomaly scores shape: torch.Size([16476, 1])
2025-06-03 11:22:53,587 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:54,097 - DEBUG - Step 48: Loss=0.7314
2025-06-03 11:22:54,097 - DEBUG - Online update step: 49/50
2025-06-03 11:22:54,099 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:54,390 - DEBUG - Node anomaly scores shape: torch.Size([8099, 1])
2025-06-03 11:22:54,415 - DEBUG - Edge anomaly scores shape: torch.Size([16380, 1])
2025-06-03 11:22:54,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:54,899 - DEBUG - Step 49: Loss=0.7395
2025-06-03 11:22:54,899 - DEBUG - Online update step: 50/50
2025-06-03 11:22:54,900 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:55,173 - DEBUG - Node anomaly scores shape: torch.Size([8107, 1])
2025-06-03 11:22:55,198 - DEBUG - Edge anomaly scores shape: torch.Size([16406, 1])
2025-06-03 11:22:55,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:55,626 - DEBUG - Step 50: Loss=0.7733
2025-06-03 11:22:55,626 - INFO - Online update finished. Average loss: 0.8419, Learning rate: 0.001964
2025-06-03 11:22:55,627 - DEBUG - Current node mean: [-6.4454369e-08  6.4454369e-08 -6.8834760e-09  7.5092466e-09
 -6.0699740e-08 -5.0061644e-08 -2.1901970e-08 -2.2840625e-08
 -1.6270034e-08  4.1300858e-08  1.8773116e-09 -7.1963613e-09
  8.1350171e-09 -8.7607877e-09  3.0036986e-08 -8.7607877e-09
  1.3766952e-08  0.0000000e+00  0.0000000e+00 -1.5644265e-08
  0.0000000e+00  0.0000000e+00 -2.3779281e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.42001235e+00  4.97591114e+00  1.17810295e-09 -1.47262869e-09
 -1.47262869e-09 -1.17810295e-09 -8.83577211e-10 -1.17810295e-09
  0.00000000e+00 -8.24672064e-09  1.76715442e-08 -3.53430885e-09
 -2.35620590e-09  1.17810295e-08  7.06861769e-09  1.17810295e-09
  1.17810295e-09  1.17810295e-09  1.17810295e-09  1.17810295e-09
  1.17810295e-09  0.00000000e+00]
2025-06-03 11:22:55,627 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0102
2025-06-03 11:22:55,632 - INFO - Online update complete. Loss: 0.8419
2025-06-03 11:22:55,632 - INFO - Running anomaly detection...
2025-06-03 11:22:55,632 - INFO - Starting anomaly detection.
2025-06-03 11:22:55,643 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112255_update_20.json
2025-06-03 11:22:55,643 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:22:55,662 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112255_update_20.pth and as latest_checkpoint.pth
2025-06-03 11:22:55,662 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.0000
2025-06-03 11:22:55,663 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-03 11:22:55,663 - WARNING -   Node ID: 210.245.26.100, Recon Error: 0.6145, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.7020, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING -   Node ID: 183.81.34.26, Recon Error: 0.4741, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING -   Node ID: ff02::2, Recon Error: 0.8203, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.9020, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:22:55,663 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.2638, MLP Score: 0.9998
2025-06-03 11:22:55,663 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6943, MLP Score: 0.9986
2025-06-03 11:22:55,663 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7479, MLP Score: 0.9996
2025-06-03 11:22:55,663 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.0239, MLP Score: 1.0000
2025-06-03 11:22:55,663 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 1.7806, MLP Score: 1.0000
2025-06-03 11:22:55,663 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-03 11:22:55,663 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-03 11:22:55,663 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot file.
2025-06-03 11:22:55,680 - INFO - Parsed 768 nodes.
2025-06-03 11:22:55,698 - INFO - Parsed 1644 edges.
2025-06-03 11:22:56,108 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:22:56,109 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:22:56,122 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-03 11:22:56,124 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:22:56,124 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-03 11:22:56,125 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-03 11:22:56,125 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:22:56,134 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:22:56,135 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:22:56,136 - DEBUG - Shape of encoded categorical edge features: torch.Size([1644, 2])
2025-06-03 11:22:56,138 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:22:56,138 - DEBUG - Shape of scaled numerical edge features: torch.Size([1644, 20])
2025-06-03 11:22:56,138 - DEBUG - Final edge attributes tensor shape: torch.Size([1644, 22])
2025-06-03 11:22:56,138 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:22:56,138 - INFO - Performing online update...
2025-06-03 11:22:56,139 - INFO - Starting online update for 50 steps.
2025-06-03 11:22:56,139 - DEBUG - Updated RunningStats: new_mean=0.5804930039257898, new_var=72600000000010.16, new_n=7290
2025-06-03 11:22:56,139 - DEBUG - Updated RunningStats: new_mean=0.5807112542033749, new_var=72900000000007.05, new_n=7320
2025-06-03 11:22:56,139 - DEBUG - Updated RunningStats: new_mean=0.8013438351584922, new_var=41000000000030.72, new_n=4122
2025-06-03 11:22:56,139 - DEBUG - Updated RunningStats: new_mean=0.8024688733970596, new_var=41220000000001.836, new_n=4144
2025-06-03 11:22:56,140 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:22:56,140 - DEBUG - Online update step: 1/50
2025-06-03 11:22:56,141 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:56,479 - DEBUG - Node anomaly scores shape: torch.Size([8348, 1])
2025-06-03 11:22:56,506 - DEBUG - Edge anomaly scores shape: torch.Size([17025, 1])
2025-06-03 11:22:56,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:57,038 - DEBUG - Step 1: Loss=0.8152
2025-06-03 11:22:57,038 - DEBUG - Online update step: 2/50
2025-06-03 11:22:57,040 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:57,355 - DEBUG - Node anomaly scores shape: torch.Size([8648, 1])
2025-06-03 11:22:57,383 - DEBUG - Edge anomaly scores shape: torch.Size([17728, 1])
2025-06-03 11:22:57,384 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:57,923 - DEBUG - Step 2: Loss=0.7571
2025-06-03 11:22:57,923 - DEBUG - Online update step: 3/50
2025-06-03 11:22:57,925 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:58,271 - DEBUG - Node anomaly scores shape: torch.Size([8764, 1])
2025-06-03 11:22:58,300 - DEBUG - Edge anomaly scores shape: torch.Size([17935, 1])
2025-06-03 11:22:58,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:58,826 - DEBUG - Step 3: Loss=0.7384
2025-06-03 11:22:58,827 - DEBUG - Online update step: 4/50
2025-06-03 11:22:58,828 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:22:59,126 - DEBUG - Node anomaly scores shape: torch.Size([8438, 1])
2025-06-03 11:22:59,156 - DEBUG - Edge anomaly scores shape: torch.Size([17194, 1])
2025-06-03 11:22:59,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:22:59,725 - DEBUG - Step 4: Loss=0.7395
2025-06-03 11:22:59,725 - DEBUG - Online update step: 5/50
2025-06-03 11:22:59,727 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:00,058 - DEBUG - Node anomaly scores shape: torch.Size([9109, 1])
2025-06-03 11:23:00,087 - DEBUG - Edge anomaly scores shape: torch.Size([18657, 1])
2025-06-03 11:23:00,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:00,638 - DEBUG - Step 5: Loss=0.7171
2025-06-03 11:23:00,639 - DEBUG - Online update step: 6/50
2025-06-03 11:23:00,640 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:00,979 - DEBUG - Node anomaly scores shape: torch.Size([8620, 1])
2025-06-03 11:23:01,007 - DEBUG - Edge anomaly scores shape: torch.Size([17479, 1])
2025-06-03 11:23:01,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:01,490 - DEBUG - Step 6: Loss=0.7488
2025-06-03 11:23:01,491 - DEBUG - Online update step: 7/50
2025-06-03 11:23:01,492 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:01,802 - DEBUG - Node anomaly scores shape: torch.Size([8309, 1])
2025-06-03 11:23:01,829 - DEBUG - Edge anomaly scores shape: torch.Size([16864, 1])
2025-06-03 11:23:01,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:02,263 - DEBUG - Step 7: Loss=0.7360
2025-06-03 11:23:02,263 - DEBUG - Online update step: 8/50
2025-06-03 11:23:02,265 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:02,552 - DEBUG - Node anomaly scores shape: torch.Size([8178, 1])
2025-06-03 11:23:02,579 - DEBUG - Edge anomaly scores shape: torch.Size([16574, 1])
2025-06-03 11:23:02,580 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:03,023 - DEBUG - Step 8: Loss=0.7504
2025-06-03 11:23:03,023 - DEBUG - Online update step: 9/50
2025-06-03 11:23:03,026 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:03,352 - DEBUG - Node anomaly scores shape: torch.Size([8712, 1])
2025-06-03 11:23:03,380 - DEBUG - Edge anomaly scores shape: torch.Size([17742, 1])
2025-06-03 11:23:03,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:03,940 - DEBUG - Step 9: Loss=0.7071
2025-06-03 11:23:03,940 - DEBUG - Online update step: 10/50
2025-06-03 11:23:03,942 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:04,291 - DEBUG - Node anomaly scores shape: torch.Size([8486, 1])
2025-06-03 11:23:04,320 - DEBUG - Edge anomaly scores shape: torch.Size([17211, 1])
2025-06-03 11:23:04,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:04,896 - DEBUG - Step 10: Loss=0.8618
2025-06-03 11:23:04,896 - DEBUG - Online update step: 11/50
2025-06-03 11:23:04,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:05,324 - DEBUG - Node anomaly scores shape: torch.Size([8711, 1])
2025-06-03 11:23:05,363 - DEBUG - Edge anomaly scores shape: torch.Size([17817, 1])
2025-06-03 11:23:05,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:06,100 - DEBUG - Step 11: Loss=0.8227
2025-06-03 11:23:06,101 - DEBUG - Online update step: 12/50
2025-06-03 11:23:06,104 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:06,465 - DEBUG - Node anomaly scores shape: torch.Size([8267, 1])
2025-06-03 11:23:06,500 - DEBUG - Edge anomaly scores shape: torch.Size([16833, 1])
2025-06-03 11:23:06,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:07,087 - DEBUG - Step 12: Loss=0.8051
2025-06-03 11:23:07,088 - DEBUG - Online update step: 13/50
2025-06-03 11:23:07,089 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:07,424 - DEBUG - Node anomaly scores shape: torch.Size([8730, 1])
2025-06-03 11:23:07,449 - DEBUG - Edge anomaly scores shape: torch.Size([17805, 1])
2025-06-03 11:23:07,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:07,986 - DEBUG - Step 13: Loss=0.7425
2025-06-03 11:23:07,986 - DEBUG - Online update step: 14/50
2025-06-03 11:23:07,988 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:08,311 - DEBUG - Node anomaly scores shape: torch.Size([8186, 1])
2025-06-03 11:23:08,337 - DEBUG - Edge anomaly scores shape: torch.Size([16638, 1])
2025-06-03 11:23:08,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:08,807 - DEBUG - Step 14: Loss=0.7942
2025-06-03 11:23:08,807 - DEBUG - Online update step: 15/50
2025-06-03 11:23:08,809 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:09,120 - DEBUG - Node anomaly scores shape: torch.Size([7924, 1])
2025-06-03 11:23:09,145 - DEBUG - Edge anomaly scores shape: torch.Size([15960, 1])
2025-06-03 11:23:09,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:09,617 - DEBUG - Step 15: Loss=0.8669
2025-06-03 11:23:09,617 - DEBUG - Online update step: 16/50
2025-06-03 11:23:09,619 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:09,951 - DEBUG - Node anomaly scores shape: torch.Size([8519, 1])
2025-06-03 11:23:09,980 - DEBUG - Edge anomaly scores shape: torch.Size([17264, 1])
2025-06-03 11:23:09,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:10,508 - DEBUG - Step 16: Loss=0.7612
2025-06-03 11:23:10,509 - DEBUG - Online update step: 17/50
2025-06-03 11:23:10,512 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:11,843 - DEBUG - Node anomaly scores shape: torch.Size([8419, 1])
2025-06-03 11:23:11,963 - DEBUG - Edge anomaly scores shape: torch.Size([17098, 1])
2025-06-03 11:23:12,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:13,651 - DEBUG - Step 17: Loss=0.7568
2025-06-03 11:23:13,651 - DEBUG - Online update step: 18/50
2025-06-03 11:23:13,654 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:14,045 - DEBUG - Node anomaly scores shape: torch.Size([8753, 1])
2025-06-03 11:23:14,075 - DEBUG - Edge anomaly scores shape: torch.Size([17917, 1])
2025-06-03 11:23:14,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:14,602 - DEBUG - Step 18: Loss=0.7218
2025-06-03 11:23:14,603 - DEBUG - Online update step: 19/50
2025-06-03 11:23:14,605 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:14,971 - DEBUG - Node anomaly scores shape: torch.Size([8815, 1])
2025-06-03 11:23:15,003 - DEBUG - Edge anomaly scores shape: torch.Size([18030, 1])
2025-06-03 11:23:15,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:15,576 - DEBUG - Step 19: Loss=0.6881
2025-06-03 11:23:15,576 - DEBUG - Online update step: 20/50
2025-06-03 11:23:15,579 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:16,436 - DEBUG - Node anomaly scores shape: torch.Size([8482, 1])
2025-06-03 11:23:16,484 - DEBUG - Edge anomaly scores shape: torch.Size([17210, 1])
2025-06-03 11:23:16,485 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:17,030 - DEBUG - Step 20: Loss=0.7470
2025-06-03 11:23:17,030 - DEBUG - Online update step: 21/50
2025-06-03 11:23:17,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:17,319 - DEBUG - Node anomaly scores shape: torch.Size([8171, 1])
2025-06-03 11:23:17,345 - DEBUG - Edge anomaly scores shape: torch.Size([16506, 1])
2025-06-03 11:23:17,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:17,841 - DEBUG - Step 21: Loss=0.7634
2025-06-03 11:23:17,841 - DEBUG - Online update step: 22/50
2025-06-03 11:23:17,843 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:18,187 - DEBUG - Node anomaly scores shape: torch.Size([8927, 1])
2025-06-03 11:23:18,223 - DEBUG - Edge anomaly scores shape: torch.Size([18239, 1])
2025-06-03 11:23:18,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:18,758 - DEBUG - Step 22: Loss=0.7604
2025-06-03 11:23:18,759 - DEBUG - Online update step: 23/50
2025-06-03 11:23:18,761 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:19,082 - DEBUG - Node anomaly scores shape: torch.Size([8338, 1])
2025-06-03 11:23:19,109 - DEBUG - Edge anomaly scores shape: torch.Size([16841, 1])
2025-06-03 11:23:19,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:19,596 - DEBUG - Step 23: Loss=0.6965
2025-06-03 11:23:19,596 - DEBUG - Online update step: 24/50
2025-06-03 11:23:19,597 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:19,932 - DEBUG - Node anomaly scores shape: torch.Size([8711, 1])
2025-06-03 11:23:19,961 - DEBUG - Edge anomaly scores shape: torch.Size([17817, 1])
2025-06-03 11:23:19,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:20,498 - DEBUG - Step 24: Loss=0.7500
2025-06-03 11:23:20,498 - DEBUG - Online update step: 25/50
2025-06-03 11:23:20,500 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:20,801 - DEBUG - Node anomaly scores shape: torch.Size([8498, 1])
2025-06-03 11:23:20,828 - DEBUG - Edge anomaly scores shape: torch.Size([17366, 1])
2025-06-03 11:23:20,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:21,345 - DEBUG - Step 25: Loss=0.7080
2025-06-03 11:23:21,345 - DEBUG - Online update step: 26/50
2025-06-03 11:23:21,348 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:21,694 - DEBUG - Node anomaly scores shape: torch.Size([8830, 1])
2025-06-03 11:23:21,724 - DEBUG - Edge anomaly scores shape: torch.Size([18147, 1])
2025-06-03 11:23:21,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:22,257 - DEBUG - Step 26: Loss=0.6987
2025-06-03 11:23:22,258 - DEBUG - Online update step: 27/50
2025-06-03 11:23:22,260 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:22,559 - DEBUG - Node anomaly scores shape: torch.Size([8384, 1])
2025-06-03 11:23:22,584 - DEBUG - Edge anomaly scores shape: torch.Size([17107, 1])
2025-06-03 11:23:22,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:23,097 - DEBUG - Step 27: Loss=0.7202
2025-06-03 11:23:23,098 - DEBUG - Online update step: 28/50
2025-06-03 11:23:23,100 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:23,442 - DEBUG - Node anomaly scores shape: torch.Size([8681, 1])
2025-06-03 11:23:23,470 - DEBUG - Edge anomaly scores shape: torch.Size([17759, 1])
2025-06-03 11:23:23,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:24,006 - DEBUG - Step 28: Loss=0.7205
2025-06-03 11:23:24,006 - DEBUG - Online update step: 29/50
2025-06-03 11:23:24,007 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:24,345 - DEBUG - Node anomaly scores shape: torch.Size([8720, 1])
2025-06-03 11:23:24,371 - DEBUG - Edge anomaly scores shape: torch.Size([17870, 1])
2025-06-03 11:23:24,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:24,899 - DEBUG - Step 29: Loss=0.7318
2025-06-03 11:23:24,899 - DEBUG - Online update step: 30/50
2025-06-03 11:23:24,901 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:25,202 - DEBUG - Node anomaly scores shape: torch.Size([8271, 1])
2025-06-03 11:23:25,228 - DEBUG - Edge anomaly scores shape: torch.Size([16814, 1])
2025-06-03 11:23:25,229 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:25,759 - DEBUG - Step 30: Loss=0.7978
2025-06-03 11:23:25,759 - DEBUG - Online update step: 31/50
2025-06-03 11:23:25,762 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:26,506 - DEBUG - Node anomaly scores shape: torch.Size([8684, 1])
2025-06-03 11:23:26,595 - DEBUG - Edge anomaly scores shape: torch.Size([17721, 1])
2025-06-03 11:23:26,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:27,698 - DEBUG - Step 31: Loss=0.7002
2025-06-03 11:23:27,698 - DEBUG - Online update step: 32/50
2025-06-03 11:23:27,699 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:28,000 - DEBUG - Node anomaly scores shape: torch.Size([8257, 1])
2025-06-03 11:23:28,025 - DEBUG - Edge anomaly scores shape: torch.Size([16783, 1])
2025-06-03 11:23:28,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:28,522 - DEBUG - Step 32: Loss=0.9514
2025-06-03 11:23:28,522 - DEBUG - Online update step: 33/50
2025-06-03 11:23:28,524 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:28,797 - DEBUG - Node anomaly scores shape: torch.Size([8026, 1])
2025-06-03 11:23:28,823 - DEBUG - Edge anomaly scores shape: torch.Size([16134, 1])
2025-06-03 11:23:28,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:29,247 - DEBUG - Step 33: Loss=1.0444
2025-06-03 11:23:29,248 - DEBUG - Online update step: 34/50
2025-06-03 11:23:29,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:29,598 - DEBUG - Node anomaly scores shape: torch.Size([9084, 1])
2025-06-03 11:23:29,627 - DEBUG - Edge anomaly scores shape: torch.Size([18689, 1])
2025-06-03 11:23:29,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:30,221 - DEBUG - Step 34: Loss=0.8254
2025-06-03 11:23:30,221 - DEBUG - Online update step: 35/50
2025-06-03 11:23:30,223 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:30,515 - DEBUG - Node anomaly scores shape: torch.Size([8397, 1])
2025-06-03 11:23:30,543 - DEBUG - Edge anomaly scores shape: torch.Size([17126, 1])
2025-06-03 11:23:30,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:30,986 - DEBUG - Step 35: Loss=0.7235
2025-06-03 11:23:30,986 - DEBUG - Online update step: 36/50
2025-06-03 11:23:30,988 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:31,323 - DEBUG - Node anomaly scores shape: torch.Size([8492, 1])
2025-06-03 11:23:31,352 - DEBUG - Edge anomaly scores shape: torch.Size([17341, 1])
2025-06-03 11:23:31,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:31,844 - DEBUG - Step 36: Loss=0.8141
2025-06-03 11:23:31,844 - DEBUG - Online update step: 37/50
2025-06-03 11:23:31,847 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:32,166 - DEBUG - Node anomaly scores shape: torch.Size([8504, 1])
2025-06-03 11:23:32,193 - DEBUG - Edge anomaly scores shape: torch.Size([17336, 1])
2025-06-03 11:23:32,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:32,765 - DEBUG - Step 37: Loss=0.8288
2025-06-03 11:23:32,765 - DEBUG - Online update step: 38/50
2025-06-03 11:23:32,767 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:33,123 - DEBUG - Node anomaly scores shape: torch.Size([9346, 1])
2025-06-03 11:23:33,154 - DEBUG - Edge anomaly scores shape: torch.Size([19352, 1])
2025-06-03 11:23:33,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:33,697 - DEBUG - Step 38: Loss=0.7416
2025-06-03 11:23:33,697 - DEBUG - Online update step: 39/50
2025-06-03 11:23:33,698 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:34,021 - DEBUG - Node anomaly scores shape: torch.Size([8987, 1])
2025-06-03 11:23:34,048 - DEBUG - Edge anomaly scores shape: torch.Size([18449, 1])
2025-06-03 11:23:34,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:34,613 - DEBUG - Step 39: Loss=0.8650
2025-06-03 11:23:34,613 - DEBUG - Online update step: 40/50
2025-06-03 11:23:34,615 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:34,890 - DEBUG - Node anomaly scores shape: torch.Size([7897, 1])
2025-06-03 11:23:34,915 - DEBUG - Edge anomaly scores shape: torch.Size([15919, 1])
2025-06-03 11:23:34,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:35,398 - DEBUG - Step 40: Loss=1.0159
2025-06-03 11:23:35,398 - DEBUG - Online update step: 41/50
2025-06-03 11:23:35,401 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:35,719 - DEBUG - Node anomaly scores shape: torch.Size([8306, 1])
2025-06-03 11:23:35,745 - DEBUG - Edge anomaly scores shape: torch.Size([16781, 1])
2025-06-03 11:23:35,746 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:36,241 - DEBUG - Step 41: Loss=0.9044
2025-06-03 11:23:36,241 - DEBUG - Online update step: 42/50
2025-06-03 11:23:36,243 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:36,527 - DEBUG - Node anomaly scores shape: torch.Size([7915, 1])
2025-06-03 11:23:36,552 - DEBUG - Edge anomaly scores shape: torch.Size([15921, 1])
2025-06-03 11:23:36,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:36,989 - DEBUG - Step 42: Loss=0.7491
2025-06-03 11:23:36,989 - DEBUG - Online update step: 43/50
2025-06-03 11:23:36,990 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:37,323 - DEBUG - Node anomaly scores shape: torch.Size([8697, 1])
2025-06-03 11:23:37,350 - DEBUG - Edge anomaly scores shape: torch.Size([17756, 1])
2025-06-03 11:23:37,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:37,901 - DEBUG - Step 43: Loss=0.7538
2025-06-03 11:23:37,901 - DEBUG - Online update step: 44/50
2025-06-03 11:23:37,904 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:38,191 - DEBUG - Node anomaly scores shape: torch.Size([8209, 1])
2025-06-03 11:23:38,214 - DEBUG - Edge anomaly scores shape: torch.Size([16616, 1])
2025-06-03 11:23:38,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:38,649 - DEBUG - Step 44: Loss=0.8004
2025-06-03 11:23:38,650 - DEBUG - Online update step: 45/50
2025-06-03 11:23:38,651 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:38,976 - DEBUG - Node anomaly scores shape: torch.Size([8826, 1])
2025-06-03 11:23:39,002 - DEBUG - Edge anomaly scores shape: torch.Size([18028, 1])
2025-06-03 11:23:39,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:39,543 - DEBUG - Step 45: Loss=0.7445
2025-06-03 11:23:39,544 - DEBUG - Online update step: 46/50
2025-06-03 11:23:39,545 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:39,862 - DEBUG - Node anomaly scores shape: torch.Size([8672, 1])
2025-06-03 11:23:39,890 - DEBUG - Edge anomaly scores shape: torch.Size([17638, 1])
2025-06-03 11:23:39,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:40,371 - DEBUG - Step 46: Loss=0.6972
2025-06-03 11:23:40,372 - DEBUG - Online update step: 47/50
2025-06-03 11:23:40,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:40,694 - DEBUG - Node anomaly scores shape: torch.Size([8651, 1])
2025-06-03 11:23:40,728 - DEBUG - Edge anomaly scores shape: torch.Size([17696, 1])
2025-06-03 11:23:40,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:41,670 - DEBUG - Step 47: Loss=0.7485
2025-06-03 11:23:41,670 - DEBUG - Online update step: 48/50
2025-06-03 11:23:41,672 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:41,992 - DEBUG - Node anomaly scores shape: torch.Size([8424, 1])
2025-06-03 11:23:42,017 - DEBUG - Edge anomaly scores shape: torch.Size([17172, 1])
2025-06-03 11:23:42,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:42,520 - DEBUG - Step 48: Loss=0.7766
2025-06-03 11:23:42,520 - DEBUG - Online update step: 49/50
2025-06-03 11:23:42,522 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:42,881 - DEBUG - Node anomaly scores shape: torch.Size([7750, 1])
2025-06-03 11:23:42,906 - DEBUG - Edge anomaly scores shape: torch.Size([15516, 1])
2025-06-03 11:23:42,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:43,441 - DEBUG - Step 49: Loss=0.6940
2025-06-03 11:23:43,441 - DEBUG - Online update step: 50/50
2025-06-03 11:23:43,444 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:43,776 - DEBUG - Node anomaly scores shape: torch.Size([8692, 1])
2025-06-03 11:23:43,812 - DEBUG - Edge anomaly scores shape: torch.Size([17690, 1])
2025-06-03 11:23:43,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:44,420 - DEBUG - Step 50: Loss=0.8126
2025-06-03 11:23:44,421 - INFO - Online update finished. Average loss: 0.7763, Learning rate: 0.001500
2025-06-03 11:23:44,421 - DEBUG - Current node mean: [ 2.2351742e-08 -2.2351742e-08 -2.4835268e-08 -9.9341078e-09
 -5.5879354e-09 -1.8626451e-08  5.1533181e-08  1.4901161e-08
  0.0000000e+00 -9.9341078e-09 -4.5324366e-08  2.7318796e-08
 -2.4835268e-08 -4.8428774e-08 -1.3038516e-08 -2.1109978e-08
  3.7252903e-09  0.0000000e+00  0.0000000e+00 -1.7384687e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4209245e+00  4.9805355e+00  0.0000000e+00 -2.3203754e-09
 -5.2208446e-09 -1.4502347e-09 -4.6407509e-09  4.6407509e-09
  5.8009388e-09  1.1601877e-09 -2.9004694e-09 -6.9611263e-09
  2.3203754e-09  2.2043567e-08  9.2815018e-09  2.0303286e-09
  2.0303286e-09  2.0303286e-09  2.0303286e-09  2.0303286e-09
  2.0303286e-09  2.9004693e-10]
2025-06-03 11:23:44,421 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0026
2025-06-03 11:23:44,422 - INFO - Online update complete. Loss: 0.7763
2025-06-03 11:23:44,422 - INFO - Running anomaly detection...
2025-06-03 11:23:44,422 - INFO - Starting anomaly detection.
2025-06-03 11:23:44,432 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112344_update_21.json
2025-06-03 11:23:44,432 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:23:44,450 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112344_update_21.pth and as latest_checkpoint.pth
2025-06-03 11:23:44,450 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.0000
2025-06-03 11:23:44,450 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:23:44,450 - WARNING -   Node ID: 210.245.26.100, Recon Error: 0.5026, MLP Score: 1.0000
2025-06-03 11:23:44,450 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1234, MLP Score: 1.0000
2025-06-03 11:23:44,450 - WARNING -   Node ID: ff02::2, Recon Error: 0.7909, MLP Score: 1.0000
2025-06-03 11:23:44,450 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.7327, MLP Score: 1.0000
2025-06-03 11:23:44,450 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 2.1665, MLP Score: 1.0000
2025-06-03 11:23:44,450 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:23:44,450 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.1848, MLP Score: 0.9997
2025-06-03 11:23:44,451 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6039, MLP Score: 0.9978
2025-06-03 11:23:44,451 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.5070, MLP Score: 0.9998
2025-06-03 11:23:44,451 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.8507, MLP Score: 1.0000
2025-06-03 11:23:44,451 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 1.6914, MLP Score: 1.0000
2025-06-03 11:23:44,451 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:23:44,451 - INFO - Performing visualization of node and edge features.
2025-06-03 11:23:44,451 - INFO - Starting visualization of node features.
2025-06-03 11:23:44,451 - INFO - Graph has 768 nodes and 30 features.
2025-06-03 11:23:44,451 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:23:44,451 - INFO - Calculating feature statistics:
2025-06-03 11:23:44,451 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.105997965), 'max': np.float32(9.687259)}
2025-06-03 11:23:44,451 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-9.687259), 'max': np.float32(0.105997965)}
2025-06-03 11:23:44,451 - INFO - - server_score: {'name': 'server_score', 'unique': 12, 'mean': np.float32(-2.4835268e-08), 'std': np.float32(1.0), 'min': np.float32(-2.392051), 'max': np.float32(3.151221)}
2025-06-03 11:23:44,451 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-2.483527e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.0812269), 'max': np.float32(15.652091)}
2025-06-03 11:23:44,452 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.65296793), 'max': np.float32(3.5086863)}
2025-06-03 11:23:44,452 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.6578672), 'max': np.float32(2.843299)}
2025-06-03 11:23:44,452 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 13, 'mean': np.float32(4.4703484e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.87836), 'max': np.float32(0.64384365)}
2025-06-03 11:23:44,452 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08533779), 'max': np.float32(18.204733)}
2025-06-03 11:23:44,452 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-4.346172e-09), 'std': np.float32(1.0), 'min': np.float32(-4.30874), 'max': np.float32(16.876358)}
2025-06-03 11:23:44,452 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(-5.5879354e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08556566), 'max': np.float32(12.881147)}
2025-06-03 11:23:44,452 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-3.973643e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0214314), 'max': np.float32(0.93711716)}
2025-06-03 11:23:44,452 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(3.1664968e-08), 'std': np.float32(1.0), 'min': np.float32(-0.09957739), 'max': np.float32(10.844884)}
2025-06-03 11:23:44,452 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-6.829699e-09), 'std': np.float32(1.0), 'min': np.float32(-7.791958), 'max': np.float32(0.13066833)}
2025-06-03 11:23:44,452 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-2.1631608), 'max': np.float32(2.4454253)}
2025-06-03 11:23:44,452 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-2.3769374), 'max': np.float32(2.230049)}
2025-06-03 11:23:44,452 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-2.2351742e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4336612), 'max': np.float32(3.3249848)}
2025-06-03 11:23:44,452 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(2.2351742e-08), 'std': np.float32(1.0), 'min': np.float32(-3.2294397), 'max': np.float32(1.4613175)}
2025-06-03 11:23:44,453 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(3.7252903e-09), 'std': np.float32(0.99999994), 'min': np.float32(-7.3491983), 'max': np.float32(0.15944108)}
2025-06-03 11:23:44,453 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(2.483527e-09), 'std': np.float32(1.0), 'min': np.float32(-4.0183797), 'max': np.float32(4.2381268)}
2025-06-03 11:23:44,453 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,453 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:23:44,468 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b399fe000>
2025-06-03 11:23:44,796 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:23:44,858 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:23:44,890 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:23:46,215 - INFO - Node feature visualization saved to vis/node_features_20250603_112344.png
2025-06-03 11:23:46,215 - INFO - Finished visualization of node features.
2025-06-03 11:23:46,215 - INFO - Performing additional feature analysis:
2025-06-03 11:23:46,215 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:23:46,215 - INFO - Starting visualization of edge features.
2025-06-03 11:23:46,215 - INFO - Graph has 1644 edges and 22 edge features.
2025-06-03 11:23:46,215 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:23:46,215 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:23:46,215 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-03 11:23:46,215 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-03 11:23:46,215 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot file.
2025-06-03 11:23:46,231 - INFO - Parsed 780 nodes.
2025-06-03 11:23:46,248 - INFO - Parsed 1667 edges.
2025-06-03 11:23:46,694 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:23:46,694 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:23:46,709 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-03 11:23:46,711 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:23:46,711 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-03 11:23:46,712 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-03 11:23:46,712 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:23:46,722 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:23:46,723 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:23:46,725 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 2])
2025-06-03 11:23:46,726 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:23:46,727 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 20])
2025-06-03 11:23:46,727 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 22])
2025-06-03 11:23:46,727 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:23:46,727 - INFO - Performing online update...
2025-06-03 11:23:46,727 - INFO - Starting online update for 50 steps.
2025-06-03 11:23:46,728 - DEBUG - Updated RunningStats: new_mean=0.5783410041897947, new_var=73200000000010.08, new_n=7350
2025-06-03 11:23:46,728 - DEBUG - Updated RunningStats: new_mean=0.5785662021479941, new_var=73500000000007.06, new_n=7380
2025-06-03 11:23:46,728 - DEBUG - Updated RunningStats: new_mean=0.7997659943277359, new_var=41440000000030.63, new_n=4166
2025-06-03 11:23:46,728 - DEBUG - Updated RunningStats: new_mean=0.8008889174790007, new_var=41660000000001.86, new_n=4188
2025-06-03 11:23:46,728 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:23:46,728 - DEBUG - Online update step: 1/50
2025-06-03 11:23:46,729 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:47,073 - DEBUG - Node anomaly scores shape: torch.Size([9339, 1])
2025-06-03 11:23:47,106 - DEBUG - Edge anomaly scores shape: torch.Size([19302, 1])
2025-06-03 11:23:47,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:47,680 - DEBUG - Step 1: Loss=0.8629
2025-06-03 11:23:47,681 - DEBUG - Online update step: 2/50
2025-06-03 11:23:47,682 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:47,977 - DEBUG - Node anomaly scores shape: torch.Size([8294, 1])
2025-06-03 11:23:48,002 - DEBUG - Edge anomaly scores shape: torch.Size([16848, 1])
2025-06-03 11:23:48,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:48,485 - DEBUG - Step 2: Loss=0.7940
2025-06-03 11:23:48,485 - DEBUG - Online update step: 3/50
2025-06-03 11:23:48,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:48,796 - DEBUG - Node anomaly scores shape: torch.Size([8557, 1])
2025-06-03 11:23:48,823 - DEBUG - Edge anomaly scores shape: torch.Size([17356, 1])
2025-06-03 11:23:48,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:49,307 - DEBUG - Step 3: Loss=0.7700
2025-06-03 11:23:49,307 - DEBUG - Online update step: 4/50
2025-06-03 11:23:49,308 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:49,633 - DEBUG - Node anomaly scores shape: torch.Size([8996, 1])
2025-06-03 11:23:49,660 - DEBUG - Edge anomaly scores shape: torch.Size([18516, 1])
2025-06-03 11:23:49,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:50,206 - DEBUG - Step 4: Loss=0.7407
2025-06-03 11:23:50,207 - DEBUG - Online update step: 5/50
2025-06-03 11:23:50,209 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:50,539 - DEBUG - Node anomaly scores shape: torch.Size([9015, 1])
2025-06-03 11:23:50,569 - DEBUG - Edge anomaly scores shape: torch.Size([18421, 1])
2025-06-03 11:23:50,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:51,100 - DEBUG - Step 5: Loss=0.7673
2025-06-03 11:23:51,100 - DEBUG - Online update step: 6/50
2025-06-03 11:23:51,103 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:51,441 - DEBUG - Node anomaly scores shape: torch.Size([8690, 1])
2025-06-03 11:23:51,470 - DEBUG - Edge anomaly scores shape: torch.Size([17788, 1])
2025-06-03 11:23:51,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:51,988 - DEBUG - Step 6: Loss=0.7950
2025-06-03 11:23:51,989 - DEBUG - Online update step: 7/50
2025-06-03 11:23:51,991 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:52,283 - DEBUG - Node anomaly scores shape: torch.Size([8232, 1])
2025-06-03 11:23:52,310 - DEBUG - Edge anomaly scores shape: torch.Size([16748, 1])
2025-06-03 11:23:52,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:52,822 - DEBUG - Step 7: Loss=0.7340
2025-06-03 11:23:52,822 - DEBUG - Online update step: 8/50
2025-06-03 11:23:52,824 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:53,165 - DEBUG - Node anomaly scores shape: torch.Size([9436, 1])
2025-06-03 11:23:53,197 - DEBUG - Edge anomaly scores shape: torch.Size([19477, 1])
2025-06-03 11:23:53,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:53,891 - DEBUG - Step 8: Loss=0.7209
2025-06-03 11:23:53,891 - DEBUG - Online update step: 9/50
2025-06-03 11:23:53,894 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:54,204 - DEBUG - Node anomaly scores shape: torch.Size([8565, 1])
2025-06-03 11:23:54,230 - DEBUG - Edge anomaly scores shape: torch.Size([17512, 1])
2025-06-03 11:23:54,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:54,775 - DEBUG - Step 9: Loss=0.7046
2025-06-03 11:23:54,776 - DEBUG - Online update step: 10/50
2025-06-03 11:23:54,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:55,229 - DEBUG - Node anomaly scores shape: torch.Size([8876, 1])
2025-06-03 11:23:55,273 - DEBUG - Edge anomaly scores shape: torch.Size([18068, 1])
2025-06-03 11:23:55,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:56,166 - DEBUG - Step 10: Loss=0.7525
2025-06-03 11:23:56,166 - DEBUG - Online update step: 11/50
2025-06-03 11:23:56,168 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:56,486 - DEBUG - Node anomaly scores shape: torch.Size([8555, 1])
2025-06-03 11:23:56,515 - DEBUG - Edge anomaly scores shape: torch.Size([17448, 1])
2025-06-03 11:23:56,516 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:57,032 - DEBUG - Step 11: Loss=0.6908
2025-06-03 11:23:57,033 - DEBUG - Online update step: 12/50
2025-06-03 11:23:57,035 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:57,326 - DEBUG - Node anomaly scores shape: torch.Size([8123, 1])
2025-06-03 11:23:57,352 - DEBUG - Edge anomaly scores shape: torch.Size([16337, 1])
2025-06-03 11:23:57,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:57,866 - DEBUG - Step 12: Loss=0.6888
2025-06-03 11:23:57,867 - DEBUG - Online update step: 13/50
2025-06-03 11:23:57,872 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:58,197 - DEBUG - Node anomaly scores shape: torch.Size([8404, 1])
2025-06-03 11:23:58,224 - DEBUG - Edge anomaly scores shape: torch.Size([17087, 1])
2025-06-03 11:23:58,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:58,703 - DEBUG - Step 13: Loss=0.7519
2025-06-03 11:23:58,703 - DEBUG - Online update step: 14/50
2025-06-03 11:23:58,704 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:59,030 - DEBUG - Node anomaly scores shape: torch.Size([8865, 1])
2025-06-03 11:23:59,058 - DEBUG - Edge anomaly scores shape: torch.Size([18217, 1])
2025-06-03 11:23:59,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:23:59,596 - DEBUG - Step 14: Loss=0.7189
2025-06-03 11:23:59,596 - DEBUG - Online update step: 15/50
2025-06-03 11:23:59,598 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:23:59,895 - DEBUG - Node anomaly scores shape: torch.Size([8532, 1])
2025-06-03 11:23:59,922 - DEBUG - Edge anomaly scores shape: torch.Size([17396, 1])
2025-06-03 11:23:59,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:00,424 - DEBUG - Step 15: Loss=0.7051
2025-06-03 11:24:00,424 - DEBUG - Online update step: 16/50
2025-06-03 11:24:00,427 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:00,775 - DEBUG - Node anomaly scores shape: torch.Size([8706, 1])
2025-06-03 11:24:00,804 - DEBUG - Edge anomaly scores shape: torch.Size([17899, 1])
2025-06-03 11:24:00,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:01,367 - DEBUG - Step 16: Loss=0.7200
2025-06-03 11:24:01,367 - DEBUG - Online update step: 17/50
2025-06-03 11:24:01,369 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:01,681 - DEBUG - Node anomaly scores shape: torch.Size([8525, 1])
2025-06-03 11:24:01,709 - DEBUG - Edge anomaly scores shape: torch.Size([17417, 1])
2025-06-03 11:24:01,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:02,176 - DEBUG - Step 17: Loss=0.6831
2025-06-03 11:24:02,177 - DEBUG - Online update step: 18/50
2025-06-03 11:24:02,179 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:02,491 - DEBUG - Node anomaly scores shape: torch.Size([8213, 1])
2025-06-03 11:24:02,516 - DEBUG - Edge anomaly scores shape: torch.Size([16651, 1])
2025-06-03 11:24:02,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:03,017 - DEBUG - Step 18: Loss=0.6723
2025-06-03 11:24:03,018 - DEBUG - Online update step: 19/50
2025-06-03 11:24:03,019 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:03,330 - DEBUG - Node anomaly scores shape: torch.Size([8784, 1])
2025-06-03 11:24:03,357 - DEBUG - Edge anomaly scores shape: torch.Size([17984, 1])
2025-06-03 11:24:03,358 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:03,897 - DEBUG - Step 19: Loss=0.6864
2025-06-03 11:24:03,897 - DEBUG - Online update step: 20/50
2025-06-03 11:24:03,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:04,209 - DEBUG - Node anomaly scores shape: torch.Size([8562, 1])
2025-06-03 11:24:04,237 - DEBUG - Edge anomaly scores shape: torch.Size([17529, 1])
2025-06-03 11:24:04,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:04,778 - DEBUG - Step 20: Loss=0.6635
2025-06-03 11:24:04,778 - DEBUG - Online update step: 21/50
2025-06-03 11:24:04,781 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:05,096 - DEBUG - Node anomaly scores shape: torch.Size([8730, 1])
2025-06-03 11:24:05,125 - DEBUG - Edge anomaly scores shape: torch.Size([17857, 1])
2025-06-03 11:24:05,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:05,616 - DEBUG - Step 21: Loss=0.7157
2025-06-03 11:24:05,617 - DEBUG - Online update step: 22/50
2025-06-03 11:24:05,618 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:05,915 - DEBUG - Node anomaly scores shape: torch.Size([8474, 1])
2025-06-03 11:24:05,941 - DEBUG - Edge anomaly scores shape: torch.Size([17300, 1])
2025-06-03 11:24:05,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:06,445 - DEBUG - Step 22: Loss=0.7861
2025-06-03 11:24:06,446 - DEBUG - Online update step: 23/50
2025-06-03 11:24:06,448 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:06,790 - DEBUG - Node anomaly scores shape: torch.Size([9648, 1])
2025-06-03 11:24:06,821 - DEBUG - Edge anomaly scores shape: torch.Size([19969, 1])
2025-06-03 11:24:06,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:07,338 - DEBUG - Step 23: Loss=0.6709
2025-06-03 11:24:07,338 - DEBUG - Online update step: 24/50
2025-06-03 11:24:07,340 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:07,669 - DEBUG - Node anomaly scores shape: torch.Size([8666, 1])
2025-06-03 11:24:07,696 - DEBUG - Edge anomaly scores shape: torch.Size([17776, 1])
2025-06-03 11:24:07,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:08,244 - DEBUG - Step 24: Loss=0.7176
2025-06-03 11:24:08,245 - DEBUG - Online update step: 25/50
2025-06-03 11:24:08,247 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:08,533 - DEBUG - Node anomaly scores shape: torch.Size([8402, 1])
2025-06-03 11:24:08,562 - DEBUG - Edge anomaly scores shape: torch.Size([17065, 1])
2025-06-03 11:24:08,563 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:09,068 - DEBUG - Step 25: Loss=0.7171
2025-06-03 11:24:09,069 - DEBUG - Online update step: 26/50
2025-06-03 11:24:09,070 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:09,423 - DEBUG - Node anomaly scores shape: torch.Size([8877, 1])
2025-06-03 11:24:09,458 - DEBUG - Edge anomaly scores shape: torch.Size([18262, 1])
2025-06-03 11:24:09,462 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:09,998 - DEBUG - Step 26: Loss=0.6973
2025-06-03 11:24:09,999 - DEBUG - Online update step: 27/50
2025-06-03 11:24:10,001 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:10,313 - DEBUG - Node anomaly scores shape: torch.Size([8375, 1])
2025-06-03 11:24:10,341 - DEBUG - Edge anomaly scores shape: torch.Size([16945, 1])
2025-06-03 11:24:10,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:10,783 - DEBUG - Step 27: Loss=0.6634
2025-06-03 11:24:10,784 - DEBUG - Online update step: 28/50
2025-06-03 11:24:10,786 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:11,118 - DEBUG - Node anomaly scores shape: torch.Size([8787, 1])
2025-06-03 11:24:11,147 - DEBUG - Edge anomaly scores shape: torch.Size([17972, 1])
2025-06-03 11:24:11,148 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:11,698 - DEBUG - Step 28: Loss=0.7219
2025-06-03 11:24:11,698 - DEBUG - Online update step: 29/50
2025-06-03 11:24:11,700 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:12,057 - DEBUG - Node anomaly scores shape: torch.Size([8776, 1])
2025-06-03 11:24:12,087 - DEBUG - Edge anomaly scores shape: torch.Size([17908, 1])
2025-06-03 11:24:12,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:12,602 - DEBUG - Step 29: Loss=0.7012
2025-06-03 11:24:12,602 - DEBUG - Online update step: 30/50
2025-06-03 11:24:12,604 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:13,357 - DEBUG - Node anomaly scores shape: torch.Size([8863, 1])
2025-06-03 11:24:13,390 - DEBUG - Edge anomaly scores shape: torch.Size([18167, 1])
2025-06-03 11:24:13,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:13,999 - DEBUG - Step 30: Loss=0.6771
2025-06-03 11:24:13,999 - DEBUG - Online update step: 31/50
2025-06-03 11:24:14,002 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:14,448 - DEBUG - Node anomaly scores shape: torch.Size([8918, 1])
2025-06-03 11:24:14,478 - DEBUG - Edge anomaly scores shape: torch.Size([18198, 1])
2025-06-03 11:24:14,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:15,340 - DEBUG - Step 31: Loss=0.7262
2025-06-03 11:24:15,340 - DEBUG - Online update step: 32/50
2025-06-03 11:24:15,342 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:15,736 - DEBUG - Node anomaly scores shape: torch.Size([8216, 1])
2025-06-03 11:24:15,772 - DEBUG - Edge anomaly scores shape: torch.Size([16658, 1])
2025-06-03 11:24:15,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:16,260 - DEBUG - Step 32: Loss=0.7452
2025-06-03 11:24:16,261 - DEBUG - Online update step: 33/50
2025-06-03 11:24:16,262 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:16,587 - DEBUG - Node anomaly scores shape: torch.Size([9113, 1])
2025-06-03 11:24:16,616 - DEBUG - Edge anomaly scores shape: torch.Size([18666, 1])
2025-06-03 11:24:16,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:17,298 - DEBUG - Step 33: Loss=0.6656
2025-06-03 11:24:17,298 - DEBUG - Online update step: 34/50
2025-06-03 11:24:17,321 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:17,655 - DEBUG - Node anomaly scores shape: torch.Size([8532, 1])
2025-06-03 11:24:17,683 - DEBUG - Edge anomaly scores shape: torch.Size([17396, 1])
2025-06-03 11:24:17,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:18,224 - DEBUG - Step 34: Loss=0.7304
2025-06-03 11:24:18,224 - DEBUG - Online update step: 35/50
2025-06-03 11:24:18,226 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:18,575 - DEBUG - Node anomaly scores shape: torch.Size([8997, 1])
2025-06-03 11:24:18,606 - DEBUG - Edge anomaly scores shape: torch.Size([18520, 1])
2025-06-03 11:24:18,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:19,142 - DEBUG - Step 35: Loss=0.7601
2025-06-03 11:24:19,143 - DEBUG - Online update step: 36/50
2025-06-03 11:24:19,144 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:19,482 - DEBUG - Node anomaly scores shape: torch.Size([8869, 1])
2025-06-03 11:24:19,509 - DEBUG - Edge anomaly scores shape: torch.Size([18152, 1])
2025-06-03 11:24:19,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:20,082 - DEBUG - Step 36: Loss=0.7180
2025-06-03 11:24:20,083 - DEBUG - Online update step: 37/50
2025-06-03 11:24:20,084 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:20,431 - DEBUG - Node anomaly scores shape: torch.Size([8791, 1])
2025-06-03 11:24:20,461 - DEBUG - Edge anomaly scores shape: torch.Size([18008, 1])
2025-06-03 11:24:20,462 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:21,017 - DEBUG - Step 37: Loss=0.6633
2025-06-03 11:24:21,018 - DEBUG - Online update step: 38/50
2025-06-03 11:24:21,019 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:21,361 - DEBUG - Node anomaly scores shape: torch.Size([9038, 1])
2025-06-03 11:24:21,388 - DEBUG - Edge anomaly scores shape: torch.Size([18445, 1])
2025-06-03 11:24:21,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:21,906 - DEBUG - Step 38: Loss=0.7314
2025-06-03 11:24:21,906 - DEBUG - Online update step: 39/50
2025-06-03 11:24:21,907 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:22,239 - DEBUG - Node anomaly scores shape: torch.Size([8426, 1])
2025-06-03 11:24:22,267 - DEBUG - Edge anomaly scores shape: torch.Size([17159, 1])
2025-06-03 11:24:22,268 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:22,807 - DEBUG - Step 39: Loss=0.7033
2025-06-03 11:24:22,807 - DEBUG - Online update step: 40/50
2025-06-03 11:24:22,809 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:23,127 - DEBUG - Node anomaly scores shape: torch.Size([8622, 1])
2025-06-03 11:24:23,155 - DEBUG - Edge anomaly scores shape: torch.Size([17539, 1])
2025-06-03 11:24:23,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:23,659 - DEBUG - Step 40: Loss=0.6929
2025-06-03 11:24:23,659 - DEBUG - Online update step: 41/50
2025-06-03 11:24:23,661 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:24,010 - DEBUG - Node anomaly scores shape: torch.Size([9041, 1])
2025-06-03 11:24:24,038 - DEBUG - Edge anomaly scores shape: torch.Size([18558, 1])
2025-06-03 11:24:24,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:24,594 - DEBUG - Step 41: Loss=0.6781
2025-06-03 11:24:24,594 - DEBUG - Online update step: 42/50
2025-06-03 11:24:24,596 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:24,917 - DEBUG - Node anomaly scores shape: torch.Size([8882, 1])
2025-06-03 11:24:24,944 - DEBUG - Edge anomaly scores shape: torch.Size([18276, 1])
2025-06-03 11:24:24,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:25,523 - DEBUG - Step 42: Loss=0.6522
2025-06-03 11:24:25,523 - DEBUG - Online update step: 43/50
2025-06-03 11:24:25,525 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:25,841 - DEBUG - Node anomaly scores shape: torch.Size([8341, 1])
2025-06-03 11:24:25,864 - DEBUG - Edge anomaly scores shape: torch.Size([17012, 1])
2025-06-03 11:24:25,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:26,378 - DEBUG - Step 43: Loss=0.6787
2025-06-03 11:24:26,378 - DEBUG - Online update step: 44/50
2025-06-03 11:24:26,380 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:26,709 - DEBUG - Node anomaly scores shape: torch.Size([8482, 1])
2025-06-03 11:24:26,736 - DEBUG - Edge anomaly scores shape: torch.Size([17236, 1])
2025-06-03 11:24:26,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:27,257 - DEBUG - Step 44: Loss=0.6670
2025-06-03 11:24:27,257 - DEBUG - Online update step: 45/50
2025-06-03 11:24:27,259 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:27,623 - DEBUG - Node anomaly scores shape: torch.Size([9398, 1])
2025-06-03 11:24:27,652 - DEBUG - Edge anomaly scores shape: torch.Size([19355, 1])
2025-06-03 11:24:27,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:28,238 - DEBUG - Step 45: Loss=0.6804
2025-06-03 11:24:28,238 - DEBUG - Online update step: 46/50
2025-06-03 11:24:28,240 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:28,584 - DEBUG - Node anomaly scores shape: torch.Size([8654, 1])
2025-06-03 11:24:28,610 - DEBUG - Edge anomaly scores shape: torch.Size([17590, 1])
2025-06-03 11:24:28,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:29,183 - DEBUG - Step 46: Loss=0.6671
2025-06-03 11:24:29,183 - DEBUG - Online update step: 47/50
2025-06-03 11:24:29,185 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:29,532 - DEBUG - Node anomaly scores shape: torch.Size([8827, 1])
2025-06-03 11:24:29,560 - DEBUG - Edge anomaly scores shape: torch.Size([18079, 1])
2025-06-03 11:24:29,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:31,148 - DEBUG - Step 47: Loss=0.6595
2025-06-03 11:24:31,148 - DEBUG - Online update step: 48/50
2025-06-03 11:24:31,189 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:33,325 - DEBUG - Node anomaly scores shape: torch.Size([8948, 1])
2025-06-03 11:24:33,501 - DEBUG - Edge anomaly scores shape: torch.Size([18300, 1])
2025-06-03 11:24:33,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:34,776 - DEBUG - Step 48: Loss=0.6939
2025-06-03 11:24:34,776 - DEBUG - Online update step: 49/50
2025-06-03 11:24:34,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:35,093 - DEBUG - Node anomaly scores shape: torch.Size([8420, 1])
2025-06-03 11:24:35,119 - DEBUG - Edge anomaly scores shape: torch.Size([17157, 1])
2025-06-03 11:24:35,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:35,734 - DEBUG - Step 49: Loss=0.6782
2025-06-03 11:24:35,734 - DEBUG - Online update step: 50/50
2025-06-03 11:24:35,736 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:36,104 - DEBUG - Node anomaly scores shape: torch.Size([8067, 1])
2025-06-03 11:24:36,130 - DEBUG - Edge anomaly scores shape: torch.Size([16283, 1])
2025-06-03 11:24:36,130 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:36,586 - DEBUG - Step 50: Loss=0.7361
2025-06-03 11:24:36,586 - INFO - Online update finished. Average loss: 0.7124, Learning rate: 0.001037
2025-06-03 11:24:36,587 - DEBUG - Current node mean: [-7.3359563e-09  7.3359563e-09 -6.1132970e-09  2.4453188e-09
  2.4453188e-09 -2.6898507e-08 -3.0566486e-08  9.7812753e-09
 -6.1132971e-10  0.0000000e+00  1.9562551e-08 -9.7812753e-09
  3.9125101e-08 -3.8895852e-08  2.3612609e-08  2.4453188e-09
  4.8906377e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  3.4845794e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4199160e+00  4.9742050e+00  5.1488116e-09  5.7209015e-10
  5.7209015e-10 -1.1441803e-09  5.4348566e-09  8.5813529e-10
 -2.2883606e-09 -9.1534424e-09 -6.8650823e-09  5.1488116e-09
 -7.4371722e-09 -2.4027788e-08 -6.8650823e-09  5.7209015e-10
  5.7209015e-10  5.7209015e-10  5.7209015e-10  5.7209015e-10
  5.7209015e-10 -2.2883606e-09]
2025-06-03 11:24:36,588 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0036
2025-06-03 11:24:36,595 - INFO - Online update complete. Loss: 0.7124
2025-06-03 11:24:36,595 - INFO - Running anomaly detection...
2025-06-03 11:24:36,596 - INFO - Starting anomaly detection.
2025-06-03 11:24:36,610 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112436_update_22.json
2025-06-03 11:24:36,610 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:24:36,633 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112436_update_22.pth and as latest_checkpoint.pth
2025-06-03 11:24:36,633 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.0000
2025-06-03 11:24:36,634 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-03 11:24:36,634 - WARNING -   Node ID: 210.245.26.100, Recon Error: 0.3771, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.7214, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Node ID: ff02::2, Recon Error: 0.7278, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.2251, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.5323, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:24:36,634 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.1630, MLP Score: 0.9999
2025-06-03 11:24:36,634 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6129, MLP Score: 0.9993
2025-06-03 11:24:36,634 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.3089, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.8980, MLP Score: 1.0000
2025-06-03 11:24:36,634 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.2122, MLP Score: 1.0000
2025-06-03 11:24:36,634 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-03 11:24:36,634 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-03 11:24:36,634 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot file.
2025-06-03 11:24:36,651 - INFO - Parsed 799 nodes.
2025-06-03 11:24:36,669 - INFO - Parsed 1718 edges.
2025-06-03 11:24:37,127 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:24:37,127 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:24:37,141 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-03 11:24:37,143 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:24:37,143 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-03 11:24:37,144 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-03 11:24:37,144 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:24:37,153 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:24:37,155 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:24:37,156 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 2])
2025-06-03 11:24:37,157 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:24:37,158 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 20])
2025-06-03 11:24:37,158 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 22])
2025-06-03 11:24:37,158 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:24:37,158 - INFO - Performing online update...
2025-06-03 11:24:37,158 - INFO - Starting online update for 50 steps.
2025-06-03 11:24:37,159 - DEBUG - Updated RunningStats: new_mean=0.5762238288540763, new_var=73800000000010.0, new_n=7410
2025-06-03 11:24:37,159 - DEBUG - Updated RunningStats: new_mean=0.5764557086816251, new_var=74100000000007.06, new_n=7440
2025-06-03 11:24:37,159 - DEBUG - Updated RunningStats: new_mean=0.7982223912562838, new_var=41880000000030.586, new_n=4210
2025-06-03 11:24:37,159 - DEBUG - Updated RunningStats: new_mean=0.799341484511941, new_var=42100000000001.87, new_n=4232
2025-06-03 11:24:37,159 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:24:37,159 - DEBUG - Online update step: 1/50
2025-06-03 11:24:37,160 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:37,507 - DEBUG - Node anomaly scores shape: torch.Size([8135, 1])
2025-06-03 11:24:37,535 - DEBUG - Edge anomaly scores shape: torch.Size([16506, 1])
2025-06-03 11:24:37,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:38,122 - DEBUG - Step 1: Loss=0.7544
2025-06-03 11:24:38,122 - DEBUG - Online update step: 2/50
2025-06-03 11:24:38,125 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:38,531 - DEBUG - Node anomaly scores shape: torch.Size([7893, 1])
2025-06-03 11:24:38,759 - DEBUG - Edge anomaly scores shape: torch.Size([15893, 1])
2025-06-03 11:24:38,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:39,395 - DEBUG - Step 2: Loss=0.7342
2025-06-03 11:24:39,395 - DEBUG - Online update step: 3/50
2025-06-03 11:24:39,398 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:39,779 - DEBUG - Node anomaly scores shape: torch.Size([8799, 1])
2025-06-03 11:24:39,862 - DEBUG - Edge anomaly scores shape: torch.Size([18098, 1])
2025-06-03 11:24:39,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:40,924 - DEBUG - Step 3: Loss=0.6711
2025-06-03 11:24:40,925 - DEBUG - Online update step: 4/50
2025-06-03 11:24:40,929 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:41,850 - DEBUG - Node anomaly scores shape: torch.Size([8880, 1])
2025-06-03 11:24:41,996 - DEBUG - Edge anomaly scores shape: torch.Size([18132, 1])
2025-06-03 11:24:42,048 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:43,615 - DEBUG - Step 4: Loss=0.6796
2025-06-03 11:24:43,615 - DEBUG - Online update step: 5/50
2025-06-03 11:24:43,617 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:44,076 - DEBUG - Node anomaly scores shape: torch.Size([9493, 1])
2025-06-03 11:24:44,113 - DEBUG - Edge anomaly scores shape: torch.Size([19590, 1])
2025-06-03 11:24:44,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:44,855 - DEBUG - Step 5: Loss=0.6760
2025-06-03 11:24:44,856 - DEBUG - Online update step: 6/50
2025-06-03 11:24:44,858 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:45,248 - DEBUG - Node anomaly scores shape: torch.Size([8792, 1])
2025-06-03 11:24:45,297 - DEBUG - Edge anomaly scores shape: torch.Size([18013, 1])
2025-06-03 11:24:45,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:46,290 - DEBUG - Step 6: Loss=0.6833
2025-06-03 11:24:46,290 - DEBUG - Online update step: 7/50
2025-06-03 11:24:46,292 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:46,614 - DEBUG - Node anomaly scores shape: torch.Size([8705, 1])
2025-06-03 11:24:46,639 - DEBUG - Edge anomaly scores shape: torch.Size([17762, 1])
2025-06-03 11:24:46,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:47,250 - DEBUG - Step 7: Loss=0.6536
2025-06-03 11:24:47,250 - DEBUG - Online update step: 8/50
2025-06-03 11:24:47,253 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:47,548 - DEBUG - Node anomaly scores shape: torch.Size([8504, 1])
2025-06-03 11:24:47,574 - DEBUG - Edge anomaly scores shape: torch.Size([17351, 1])
2025-06-03 11:24:47,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:48,150 - DEBUG - Step 8: Loss=0.6626
2025-06-03 11:24:48,150 - DEBUG - Online update step: 9/50
2025-06-03 11:24:48,153 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:48,478 - DEBUG - Node anomaly scores shape: torch.Size([8848, 1])
2025-06-03 11:24:48,504 - DEBUG - Edge anomaly scores shape: torch.Size([18127, 1])
2025-06-03 11:24:48,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:49,110 - DEBUG - Step 9: Loss=0.6610
2025-06-03 11:24:49,110 - DEBUG - Online update step: 10/50
2025-06-03 11:24:49,111 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:49,494 - DEBUG - Node anomaly scores shape: torch.Size([9112, 1])
2025-06-03 11:24:49,526 - DEBUG - Edge anomaly scores shape: torch.Size([18715, 1])
2025-06-03 11:24:49,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:50,103 - DEBUG - Step 10: Loss=0.6705
2025-06-03 11:24:50,103 - DEBUG - Online update step: 11/50
2025-06-03 11:24:50,105 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:50,407 - DEBUG - Node anomaly scores shape: torch.Size([8426, 1])
2025-06-03 11:24:50,435 - DEBUG - Edge anomaly scores shape: torch.Size([17058, 1])
2025-06-03 11:24:50,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:50,935 - DEBUG - Step 11: Loss=0.6658
2025-06-03 11:24:50,935 - DEBUG - Online update step: 12/50
2025-06-03 11:24:50,937 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:51,263 - DEBUG - Node anomaly scores shape: torch.Size([8737, 1])
2025-06-03 11:24:51,290 - DEBUG - Edge anomaly scores shape: torch.Size([17806, 1])
2025-06-03 11:24:51,291 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:51,932 - DEBUG - Step 12: Loss=0.6658
2025-06-03 11:24:51,932 - DEBUG - Online update step: 13/50
2025-06-03 11:24:51,933 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:52,239 - DEBUG - Node anomaly scores shape: torch.Size([8509, 1])
2025-06-03 11:24:52,272 - DEBUG - Edge anomaly scores shape: torch.Size([17255, 1])
2025-06-03 11:24:52,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:52,924 - DEBUG - Step 13: Loss=0.6632
2025-06-03 11:24:52,925 - DEBUG - Online update step: 14/50
2025-06-03 11:24:52,928 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:53,396 - DEBUG - Node anomaly scores shape: torch.Size([8879, 1])
2025-06-03 11:24:53,424 - DEBUG - Edge anomaly scores shape: torch.Size([18255, 1])
2025-06-03 11:24:53,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:54,037 - DEBUG - Step 14: Loss=0.6573
2025-06-03 11:24:54,038 - DEBUG - Online update step: 15/50
2025-06-03 11:24:54,043 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:54,497 - DEBUG - Node anomaly scores shape: torch.Size([8514, 1])
2025-06-03 11:24:54,523 - DEBUG - Edge anomaly scores shape: torch.Size([17361, 1])
2025-06-03 11:24:54,524 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:55,043 - DEBUG - Step 15: Loss=0.6631
2025-06-03 11:24:55,043 - DEBUG - Online update step: 16/50
2025-06-03 11:24:55,046 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:55,406 - DEBUG - Node anomaly scores shape: torch.Size([9518, 1])
2025-06-03 11:24:55,435 - DEBUG - Edge anomaly scores shape: torch.Size([19654, 1])
2025-06-03 11:24:55,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:56,012 - DEBUG - Step 16: Loss=0.6539
2025-06-03 11:24:56,012 - DEBUG - Online update step: 17/50
2025-06-03 11:24:56,016 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:56,376 - DEBUG - Node anomaly scores shape: torch.Size([9171, 1])
2025-06-03 11:24:56,406 - DEBUG - Edge anomaly scores shape: torch.Size([18939, 1])
2025-06-03 11:24:56,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:57,082 - DEBUG - Step 17: Loss=0.6696
2025-06-03 11:24:57,082 - DEBUG - Online update step: 18/50
2025-06-03 11:24:57,084 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:57,394 - DEBUG - Node anomaly scores shape: torch.Size([8366, 1])
2025-06-03 11:24:57,424 - DEBUG - Edge anomaly scores shape: torch.Size([16958, 1])
2025-06-03 11:24:57,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:57,996 - DEBUG - Step 18: Loss=0.6704
2025-06-03 11:24:57,996 - DEBUG - Online update step: 19/50
2025-06-03 11:24:57,998 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:58,325 - DEBUG - Node anomaly scores shape: torch.Size([8506, 1])
2025-06-03 11:24:58,352 - DEBUG - Edge anomaly scores shape: torch.Size([17247, 1])
2025-06-03 11:24:58,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:58,888 - DEBUG - Step 19: Loss=0.6657
2025-06-03 11:24:58,888 - DEBUG - Online update step: 20/50
2025-06-03 11:24:58,890 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:24:59,190 - DEBUG - Node anomaly scores shape: torch.Size([8336, 1])
2025-06-03 11:24:59,215 - DEBUG - Edge anomaly scores shape: torch.Size([16958, 1])
2025-06-03 11:24:59,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:24:59,749 - DEBUG - Step 20: Loss=0.6664
2025-06-03 11:24:59,750 - DEBUG - Online update step: 21/50
2025-06-03 11:24:59,752 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:00,232 - DEBUG - Node anomaly scores shape: torch.Size([9363, 1])
2025-06-03 11:25:00,260 - DEBUG - Edge anomaly scores shape: torch.Size([19295, 1])
2025-06-03 11:25:00,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:00,903 - DEBUG - Step 21: Loss=0.6580
2025-06-03 11:25:00,903 - DEBUG - Online update step: 22/50
2025-06-03 11:25:00,905 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:01,264 - DEBUG - Node anomaly scores shape: torch.Size([9077, 1])
2025-06-03 11:25:01,299 - DEBUG - Edge anomaly scores shape: torch.Size([18712, 1])
2025-06-03 11:25:01,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:01,936 - DEBUG - Step 22: Loss=0.6601
2025-06-03 11:25:01,936 - DEBUG - Online update step: 23/50
2025-06-03 11:25:01,938 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:02,266 - DEBUG - Node anomaly scores shape: torch.Size([8992, 1])
2025-06-03 11:25:02,295 - DEBUG - Edge anomaly scores shape: torch.Size([18507, 1])
2025-06-03 11:25:02,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:02,873 - DEBUG - Step 23: Loss=0.6661
2025-06-03 11:25:02,874 - DEBUG - Online update step: 24/50
2025-06-03 11:25:02,875 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:03,262 - DEBUG - Node anomaly scores shape: torch.Size([10078, 1])
2025-06-03 11:25:03,298 - DEBUG - Edge anomaly scores shape: torch.Size([20944, 1])
2025-06-03 11:25:03,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:04,210 - DEBUG - Step 24: Loss=0.6540
2025-06-03 11:25:04,210 - DEBUG - Online update step: 25/50
2025-06-03 11:25:04,217 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:04,830 - DEBUG - Node anomaly scores shape: torch.Size([8114, 1])
2025-06-03 11:25:04,869 - DEBUG - Edge anomaly scores shape: torch.Size([16419, 1])
2025-06-03 11:25:04,871 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:05,942 - DEBUG - Step 25: Loss=0.6759
2025-06-03 11:25:05,942 - DEBUG - Online update step: 26/50
2025-06-03 11:25:05,947 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:06,691 - DEBUG - Node anomaly scores shape: torch.Size([9033, 1])
2025-06-03 11:25:06,777 - DEBUG - Edge anomaly scores shape: torch.Size([18593, 1])
2025-06-03 11:25:06,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:08,358 - DEBUG - Step 26: Loss=0.6731
2025-06-03 11:25:08,359 - DEBUG - Online update step: 27/50
2025-06-03 11:25:08,363 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:08,834 - DEBUG - Node anomaly scores shape: torch.Size([9177, 1])
2025-06-03 11:25:08,880 - DEBUG - Edge anomaly scores shape: torch.Size([18864, 1])
2025-06-03 11:25:08,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:09,702 - DEBUG - Step 27: Loss=0.6556
2025-06-03 11:25:09,703 - DEBUG - Online update step: 28/50
2025-06-03 11:25:09,707 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:10,158 - DEBUG - Node anomaly scores shape: torch.Size([9214, 1])
2025-06-03 11:25:10,195 - DEBUG - Edge anomaly scores shape: torch.Size([18973, 1])
2025-06-03 11:25:10,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:10,988 - DEBUG - Step 28: Loss=0.6539
2025-06-03 11:25:10,988 - DEBUG - Online update step: 29/50
2025-06-03 11:25:10,995 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:11,421 - DEBUG - Node anomaly scores shape: torch.Size([8855, 1])
2025-06-03 11:25:11,454 - DEBUG - Edge anomaly scores shape: torch.Size([18173, 1])
2025-06-03 11:25:11,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:12,176 - DEBUG - Step 29: Loss=0.6818
2025-06-03 11:25:12,176 - DEBUG - Online update step: 30/50
2025-06-03 11:25:12,181 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:12,871 - DEBUG - Node anomaly scores shape: torch.Size([9985, 1])
2025-06-03 11:25:12,933 - DEBUG - Edge anomaly scores shape: torch.Size([20848, 1])
2025-06-03 11:25:12,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:14,353 - DEBUG - Step 30: Loss=0.6617
2025-06-03 11:25:14,353 - DEBUG - Online update step: 31/50
2025-06-03 11:25:14,359 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:15,077 - DEBUG - Node anomaly scores shape: torch.Size([8870, 1])
2025-06-03 11:25:15,106 - DEBUG - Edge anomaly scores shape: torch.Size([18257, 1])
2025-06-03 11:25:15,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:15,797 - DEBUG - Step 31: Loss=0.6548
2025-06-03 11:25:15,797 - DEBUG - Online update step: 32/50
2025-06-03 11:25:15,799 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:16,145 - DEBUG - Node anomaly scores shape: torch.Size([9162, 1])
2025-06-03 11:25:16,172 - DEBUG - Edge anomaly scores shape: torch.Size([18966, 1])
2025-06-03 11:25:16,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:16,739 - DEBUG - Step 32: Loss=0.6558
2025-06-03 11:25:16,739 - DEBUG - Online update step: 33/50
2025-06-03 11:25:16,741 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:17,028 - DEBUG - Node anomaly scores shape: torch.Size([8575, 1])
2025-06-03 11:25:17,053 - DEBUG - Edge anomaly scores shape: torch.Size([17499, 1])
2025-06-03 11:25:17,054 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:17,574 - DEBUG - Step 33: Loss=0.6813
2025-06-03 11:25:17,575 - DEBUG - Online update step: 34/50
2025-06-03 11:25:17,576 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:17,834 - DEBUG - Node anomaly scores shape: torch.Size([7974, 1])
2025-06-03 11:25:17,861 - DEBUG - Edge anomaly scores shape: torch.Size([16052, 1])
2025-06-03 11:25:17,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:18,307 - DEBUG - Step 34: Loss=0.6635
2025-06-03 11:25:18,307 - DEBUG - Online update step: 35/50
2025-06-03 11:25:18,308 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:18,645 - DEBUG - Node anomaly scores shape: torch.Size([8818, 1])
2025-06-03 11:25:18,670 - DEBUG - Edge anomaly scores shape: torch.Size([18046, 1])
2025-06-03 11:25:18,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:19,217 - DEBUG - Step 35: Loss=0.6633
2025-06-03 11:25:19,217 - DEBUG - Online update step: 36/50
2025-06-03 11:25:19,221 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:19,638 - DEBUG - Node anomaly scores shape: torch.Size([9682, 1])
2025-06-03 11:25:19,666 - DEBUG - Edge anomaly scores shape: torch.Size([20045, 1])
2025-06-03 11:25:19,667 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:20,393 - DEBUG - Step 36: Loss=0.6544
2025-06-03 11:25:20,393 - DEBUG - Online update step: 37/50
2025-06-03 11:25:20,396 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:20,739 - DEBUG - Node anomaly scores shape: torch.Size([8905, 1])
2025-06-03 11:25:20,766 - DEBUG - Edge anomaly scores shape: torch.Size([18303, 1])
2025-06-03 11:25:20,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:21,403 - DEBUG - Step 37: Loss=0.6548
2025-06-03 11:25:21,403 - DEBUG - Online update step: 38/50
2025-06-03 11:25:21,407 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:21,887 - DEBUG - Node anomaly scores shape: torch.Size([9837, 1])
2025-06-03 11:25:21,917 - DEBUG - Edge anomaly scores shape: torch.Size([20386, 1])
2025-06-03 11:25:21,918 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:22,555 - DEBUG - Step 38: Loss=0.6520
2025-06-03 11:25:22,555 - DEBUG - Online update step: 39/50
2025-06-03 11:25:22,557 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:22,901 - DEBUG - Node anomaly scores shape: torch.Size([9306, 1])
2025-06-03 11:25:22,934 - DEBUG - Edge anomaly scores shape: torch.Size([19166, 1])
2025-06-03 11:25:22,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:23,475 - DEBUG - Step 39: Loss=0.6612
2025-06-03 11:25:23,475 - DEBUG - Online update step: 40/50
2025-06-03 11:25:23,476 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:23,797 - DEBUG - Node anomaly scores shape: torch.Size([9061, 1])
2025-06-03 11:25:23,828 - DEBUG - Edge anomaly scores shape: torch.Size([18587, 1])
2025-06-03 11:25:23,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:24,362 - DEBUG - Step 40: Loss=0.6400
2025-06-03 11:25:24,363 - DEBUG - Online update step: 41/50
2025-06-03 11:25:24,364 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:24,700 - DEBUG - Node anomaly scores shape: torch.Size([9139, 1])
2025-06-03 11:25:24,731 - DEBUG - Edge anomaly scores shape: torch.Size([18833, 1])
2025-06-03 11:25:24,731 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:25,250 - DEBUG - Step 41: Loss=0.6576
2025-06-03 11:25:25,251 - DEBUG - Online update step: 42/50
2025-06-03 11:25:25,252 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:25,526 - DEBUG - Node anomaly scores shape: torch.Size([7840, 1])
2025-06-03 11:25:25,551 - DEBUG - Edge anomaly scores shape: torch.Size([15779, 1])
2025-06-03 11:25:25,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:26,000 - DEBUG - Step 42: Loss=0.6855
2025-06-03 11:25:26,000 - DEBUG - Online update step: 43/50
2025-06-03 11:25:26,002 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:26,337 - DEBUG - Node anomaly scores shape: torch.Size([8577, 1])
2025-06-03 11:25:26,363 - DEBUG - Edge anomaly scores shape: torch.Size([17563, 1])
2025-06-03 11:25:26,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:26,866 - DEBUG - Step 43: Loss=0.6402
2025-06-03 11:25:26,866 - DEBUG - Online update step: 44/50
2025-06-03 11:25:26,869 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:27,163 - DEBUG - Node anomaly scores shape: torch.Size([7862, 1])
2025-06-03 11:25:27,186 - DEBUG - Edge anomaly scores shape: torch.Size([15790, 1])
2025-06-03 11:25:27,187 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:27,678 - DEBUG - Step 44: Loss=0.6594
2025-06-03 11:25:27,678 - DEBUG - Online update step: 45/50
2025-06-03 11:25:27,679 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:27,973 - DEBUG - Node anomaly scores shape: torch.Size([8485, 1])
2025-06-03 11:25:27,998 - DEBUG - Edge anomaly scores shape: torch.Size([17197, 1])
2025-06-03 11:25:27,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:28,525 - DEBUG - Step 45: Loss=0.6480
2025-06-03 11:25:28,525 - DEBUG - Online update step: 46/50
2025-06-03 11:25:28,527 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:28,856 - DEBUG - Node anomaly scores shape: torch.Size([8615, 1])
2025-06-03 11:25:28,883 - DEBUG - Edge anomaly scores shape: torch.Size([17611, 1])
2025-06-03 11:25:28,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:29,406 - DEBUG - Step 46: Loss=0.6709
2025-06-03 11:25:29,406 - DEBUG - Online update step: 47/50
2025-06-03 11:25:29,408 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:29,734 - DEBUG - Node anomaly scores shape: torch.Size([8897, 1])
2025-06-03 11:25:29,772 - DEBUG - Edge anomaly scores shape: torch.Size([18265, 1])
2025-06-03 11:25:29,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:30,365 - DEBUG - Step 47: Loss=0.6612
2025-06-03 11:25:30,365 - DEBUG - Online update step: 48/50
2025-06-03 11:25:30,367 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:30,665 - DEBUG - Node anomaly scores shape: torch.Size([8116, 1])
2025-06-03 11:25:30,691 - DEBUG - Edge anomaly scores shape: torch.Size([16379, 1])
2025-06-03 11:25:30,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:31,279 - DEBUG - Step 48: Loss=0.6543
2025-06-03 11:25:31,279 - DEBUG - Online update step: 49/50
2025-06-03 11:25:31,281 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:31,642 - DEBUG - Node anomaly scores shape: torch.Size([9047, 1])
2025-06-03 11:25:31,673 - DEBUG - Edge anomaly scores shape: torch.Size([18688, 1])
2025-06-03 11:25:31,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:32,324 - DEBUG - Step 49: Loss=0.6713
2025-06-03 11:25:32,324 - DEBUG - Online update step: 50/50
2025-06-03 11:25:32,327 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:32,675 - DEBUG - Node anomaly scores shape: torch.Size([8719, 1])
2025-06-03 11:25:32,705 - DEBUG - Edge anomaly scores shape: torch.Size([17870, 1])
2025-06-03 11:25:32,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:33,403 - DEBUG - Step 50: Loss=0.6768
2025-06-03 11:25:33,404 - INFO - Online update finished. Average loss: 0.6667, Learning rate: 0.000619
2025-06-03 11:25:33,404 - DEBUG - Current node mean: [ 1.6113395e-08 -1.6113395e-08 -2.5662075e-08 -6.5647168e-09
  1.4323018e-08  3.1629998e-08  1.4696014e-08  2.3871698e-08
  1.4323018e-08 -2.6855659e-08  2.0887736e-08 -1.2532642e-08
  5.9679244e-09  3.5807546e-09 -2.7452453e-08 -1.9544952e-08
  1.2681840e-08  0.0000000e+00  0.0000000e+00 -2.6258867e-08
  0.0000000e+00  0.0000000e+00 -4.0581885e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4202561e+00  4.9732246e+00 -1.1102146e-09  1.1102146e-09
 -2.2204292e-09 -1.1102146e-09 -5.5510729e-10 -3.8857508e-09
  4.9959654e-09  4.4408583e-09  5.5510729e-10  3.8857508e-09
 -8.0490556e-09 -6.6612875e-09  1.5543003e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.2204292e-09]
2025-06-03 11:25:33,404 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0007
2025-06-03 11:25:33,405 - INFO - Online update complete. Loss: 0.6667
2025-06-03 11:25:33,405 - INFO - Running anomaly detection...
2025-06-03 11:25:33,405 - INFO - Starting anomaly detection.
2025-06-03 11:25:33,424 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112533_update_23.json
2025-06-03 11:25:33,425 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:25:33,448 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112533_update_23.pth and as latest_checkpoint.pth
2025-06-03 11:25:33,448 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.0002
2025-06-03 11:25:33,448 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 11:25:33,449 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 2.3943, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1581, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Node ID: ff02::2, Recon Error: 0.6902, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.1489, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.8148, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:25:33,449 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.1243, MLP Score: 0.9997
2025-06-03 11:25:33,449 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.3420, MLP Score: 0.9995
2025-06-03 11:25:33,449 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.9046, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.2104, MLP Score: 1.0000
2025-06-03 11:25:33,449 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 4.6412, MLP Score: 0.9979
2025-06-03 11:25:33,449 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-03 11:25:33,449 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-03 11:25:33,449 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot file.
2025-06-03 11:25:33,469 - INFO - Parsed 805 nodes.
2025-06-03 11:25:33,488 - INFO - Parsed 1734 edges.
2025-06-03 11:25:33,926 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:25:33,926 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:25:33,939 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-03 11:25:33,940 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:25:33,940 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-03 11:25:33,941 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-03 11:25:33,941 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:25:33,950 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:25:33,951 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:25:33,952 - DEBUG - Shape of encoded categorical edge features: torch.Size([1734, 2])
2025-06-03 11:25:33,954 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:25:33,954 - DEBUG - Shape of scaled numerical edge features: torch.Size([1734, 20])
2025-06-03 11:25:33,954 - DEBUG - Final edge attributes tensor shape: torch.Size([1734, 22])
2025-06-03 11:25:33,955 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:25:33,955 - INFO - Performing online update...
2025-06-03 11:25:33,955 - INFO - Starting online update for 50 steps.
2025-06-03 11:25:33,955 - DEBUG - Updated RunningStats: new_mean=0.5741406255233481, new_var=74400000000009.92, new_n=7470
2025-06-03 11:25:33,955 - DEBUG - Updated RunningStats: new_mean=0.5743789712841433, new_var=74700000000007.08, new_n=7500
2025-06-03 11:25:33,956 - DEBUG - Updated RunningStats: new_mean=0.7967110436556327, new_var=42320000000030.59, new_n=4254
2025-06-03 11:25:33,956 - DEBUG - Updated RunningStats: new_mean=0.7978258559800412, new_var=42540000000001.88, new_n=4276
2025-06-03 11:25:33,956 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:25:33,956 - DEBUG - Online update step: 1/50
2025-06-03 11:25:33,957 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:34,349 - DEBUG - Node anomaly scores shape: torch.Size([9163, 1])
2025-06-03 11:25:34,387 - DEBUG - Edge anomaly scores shape: torch.Size([18758, 1])
2025-06-03 11:25:34,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:35,096 - DEBUG - Step 1: Loss=0.6386
2025-06-03 11:25:35,097 - DEBUG - Online update step: 2/50
2025-06-03 11:25:35,099 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:35,486 - DEBUG - Node anomaly scores shape: torch.Size([9173, 1])
2025-06-03 11:25:35,521 - DEBUG - Edge anomaly scores shape: torch.Size([18858, 1])
2025-06-03 11:25:35,522 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:36,245 - DEBUG - Step 2: Loss=0.6417
2025-06-03 11:25:36,245 - DEBUG - Online update step: 3/50
2025-06-03 11:25:36,247 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:36,597 - DEBUG - Node anomaly scores shape: torch.Size([8435, 1])
2025-06-03 11:25:36,629 - DEBUG - Edge anomaly scores shape: torch.Size([17097, 1])
2025-06-03 11:25:36,631 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:37,340 - DEBUG - Step 3: Loss=0.6576
2025-06-03 11:25:37,341 - DEBUG - Online update step: 4/50
2025-06-03 11:25:37,344 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:37,782 - DEBUG - Node anomaly scores shape: torch.Size([9608, 1])
2025-06-03 11:25:37,817 - DEBUG - Edge anomaly scores shape: torch.Size([19873, 1])
2025-06-03 11:25:37,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:38,572 - DEBUG - Step 4: Loss=0.6544
2025-06-03 11:25:38,572 - DEBUG - Online update step: 5/50
2025-06-03 11:25:38,575 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:38,959 - DEBUG - Node anomaly scores shape: torch.Size([8822, 1])
2025-06-03 11:25:38,997 - DEBUG - Edge anomaly scores shape: torch.Size([18046, 1])
2025-06-03 11:25:38,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:39,586 - DEBUG - Step 5: Loss=0.6551
2025-06-03 11:25:39,586 - DEBUG - Online update step: 6/50
2025-06-03 11:25:39,588 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:39,940 - DEBUG - Node anomaly scores shape: torch.Size([8564, 1])
2025-06-03 11:25:39,972 - DEBUG - Edge anomaly scores shape: torch.Size([17506, 1])
2025-06-03 11:25:39,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:40,617 - DEBUG - Step 6: Loss=0.6571
2025-06-03 11:25:40,617 - DEBUG - Online update step: 7/50
2025-06-03 11:25:40,621 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:41,016 - DEBUG - Node anomaly scores shape: torch.Size([8948, 1])
2025-06-03 11:25:41,049 - DEBUG - Edge anomaly scores shape: torch.Size([18420, 1])
2025-06-03 11:25:41,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:41,724 - DEBUG - Step 7: Loss=0.6533
2025-06-03 11:25:41,724 - DEBUG - Online update step: 8/50
2025-06-03 11:25:41,727 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:42,078 - DEBUG - Node anomaly scores shape: torch.Size([8505, 1])
2025-06-03 11:25:42,110 - DEBUG - Edge anomaly scores shape: torch.Size([17331, 1])
2025-06-03 11:25:42,111 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:42,795 - DEBUG - Step 8: Loss=0.6449
2025-06-03 11:25:42,796 - DEBUG - Online update step: 9/50
2025-06-03 11:25:42,797 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:43,140 - DEBUG - Node anomaly scores shape: torch.Size([8182, 1])
2025-06-03 11:25:43,170 - DEBUG - Edge anomaly scores shape: torch.Size([16532, 1])
2025-06-03 11:25:43,171 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:43,719 - DEBUG - Step 9: Loss=0.6537
2025-06-03 11:25:43,719 - DEBUG - Online update step: 10/50
2025-06-03 11:25:43,721 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:44,122 - DEBUG - Node anomaly scores shape: torch.Size([8826, 1])
2025-06-03 11:25:44,156 - DEBUG - Edge anomaly scores shape: torch.Size([18171, 1])
2025-06-03 11:25:44,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:44,871 - DEBUG - Step 10: Loss=0.6688
2025-06-03 11:25:44,872 - DEBUG - Online update step: 11/50
2025-06-03 11:25:44,874 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:45,222 - DEBUG - Node anomaly scores shape: torch.Size([8307, 1])
2025-06-03 11:25:45,252 - DEBUG - Edge anomaly scores shape: torch.Size([16906, 1])
2025-06-03 11:25:45,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:45,835 - DEBUG - Step 11: Loss=0.6427
2025-06-03 11:25:45,836 - DEBUG - Online update step: 12/50
2025-06-03 11:25:45,838 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:46,227 - DEBUG - Node anomaly scores shape: torch.Size([9044, 1])
2025-06-03 11:25:46,261 - DEBUG - Edge anomaly scores shape: torch.Size([18590, 1])
2025-06-03 11:25:46,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:46,931 - DEBUG - Step 12: Loss=0.6512
2025-06-03 11:25:46,931 - DEBUG - Online update step: 13/50
2025-06-03 11:25:46,933 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:47,260 - DEBUG - Node anomaly scores shape: torch.Size([9433, 1])
2025-06-03 11:25:47,287 - DEBUG - Edge anomaly scores shape: torch.Size([19486, 1])
2025-06-03 11:25:47,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:47,752 - DEBUG - Step 13: Loss=0.6514
2025-06-03 11:25:47,752 - DEBUG - Online update step: 14/50
2025-06-03 11:25:47,754 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:48,056 - DEBUG - Node anomaly scores shape: torch.Size([9015, 1])
2025-06-03 11:25:48,084 - DEBUG - Edge anomaly scores shape: torch.Size([18532, 1])
2025-06-03 11:25:48,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:48,581 - DEBUG - Step 14: Loss=0.6449
2025-06-03 11:25:48,581 - DEBUG - Online update step: 15/50
2025-06-03 11:25:48,582 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:48,864 - DEBUG - Node anomaly scores shape: torch.Size([8276, 1])
2025-06-03 11:25:48,889 - DEBUG - Edge anomaly scores shape: torch.Size([16695, 1])
2025-06-03 11:25:48,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:49,370 - DEBUG - Step 15: Loss=0.6551
2025-06-03 11:25:49,370 - DEBUG - Online update step: 16/50
2025-06-03 11:25:49,372 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:49,669 - DEBUG - Node anomaly scores shape: torch.Size([8664, 1])
2025-06-03 11:25:49,701 - DEBUG - Edge anomaly scores shape: torch.Size([17704, 1])
2025-06-03 11:25:49,702 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:50,196 - DEBUG - Step 16: Loss=0.6520
2025-06-03 11:25:50,196 - DEBUG - Online update step: 17/50
2025-06-03 11:25:50,197 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:50,547 - DEBUG - Node anomaly scores shape: torch.Size([9618, 1])
2025-06-03 11:25:50,578 - DEBUG - Edge anomaly scores shape: torch.Size([19873, 1])
2025-06-03 11:25:50,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:51,117 - DEBUG - Step 17: Loss=0.6442
2025-06-03 11:25:51,117 - DEBUG - Online update step: 18/50
2025-06-03 11:25:51,120 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:51,439 - DEBUG - Node anomaly scores shape: torch.Size([9083, 1])
2025-06-03 11:25:51,465 - DEBUG - Edge anomaly scores shape: torch.Size([18592, 1])
2025-06-03 11:25:51,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:51,958 - DEBUG - Step 18: Loss=0.6445
2025-06-03 11:25:51,958 - DEBUG - Online update step: 19/50
2025-06-03 11:25:51,959 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:52,256 - DEBUG - Node anomaly scores shape: torch.Size([9037, 1])
2025-06-03 11:25:52,282 - DEBUG - Edge anomaly scores shape: torch.Size([18522, 1])
2025-06-03 11:25:52,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:52,852 - DEBUG - Step 19: Loss=0.6485
2025-06-03 11:25:52,852 - DEBUG - Online update step: 20/50
2025-06-03 11:25:52,854 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:53,218 - DEBUG - Node anomaly scores shape: torch.Size([9757, 1])
2025-06-03 11:25:53,250 - DEBUG - Edge anomaly scores shape: torch.Size([20196, 1])
2025-06-03 11:25:53,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:53,843 - DEBUG - Step 20: Loss=0.6436
2025-06-03 11:25:53,844 - DEBUG - Online update step: 21/50
2025-06-03 11:25:53,846 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:54,179 - DEBUG - Node anomaly scores shape: torch.Size([9237, 1])
2025-06-03 11:25:54,207 - DEBUG - Edge anomaly scores shape: torch.Size([19008, 1])
2025-06-03 11:25:54,208 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:54,798 - DEBUG - Step 21: Loss=0.6429
2025-06-03 11:25:54,798 - DEBUG - Online update step: 22/50
2025-06-03 11:25:54,800 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:55,091 - DEBUG - Node anomaly scores shape: torch.Size([8623, 1])
2025-06-03 11:25:55,116 - DEBUG - Edge anomaly scores shape: torch.Size([17595, 1])
2025-06-03 11:25:55,116 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:55,654 - DEBUG - Step 22: Loss=0.6685
2025-06-03 11:25:55,654 - DEBUG - Online update step: 23/50
2025-06-03 11:25:55,656 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:55,971 - DEBUG - Node anomaly scores shape: torch.Size([8667, 1])
2025-06-03 11:25:56,003 - DEBUG - Edge anomaly scores shape: torch.Size([17742, 1])
2025-06-03 11:25:56,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:56,570 - DEBUG - Step 23: Loss=0.6851
2025-06-03 11:25:56,570 - DEBUG - Online update step: 24/50
2025-06-03 11:25:56,572 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:56,922 - DEBUG - Node anomaly scores shape: torch.Size([9595, 1])
2025-06-03 11:25:56,950 - DEBUG - Edge anomaly scores shape: torch.Size([19979, 1])
2025-06-03 11:25:56,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:57,560 - DEBUG - Step 24: Loss=0.6529
2025-06-03 11:25:57,560 - DEBUG - Online update step: 25/50
2025-06-03 11:25:57,563 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:57,869 - DEBUG - Node anomaly scores shape: torch.Size([8822, 1])
2025-06-03 11:25:57,900 - DEBUG - Edge anomaly scores shape: torch.Size([18127, 1])
2025-06-03 11:25:57,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:58,478 - DEBUG - Step 25: Loss=0.6410
2025-06-03 11:25:58,479 - DEBUG - Online update step: 26/50
2025-06-03 11:25:58,480 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:58,762 - DEBUG - Node anomaly scores shape: torch.Size([8461, 1])
2025-06-03 11:25:58,787 - DEBUG - Edge anomaly scores shape: torch.Size([17250, 1])
2025-06-03 11:25:58,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:25:59,241 - DEBUG - Step 26: Loss=0.6699
2025-06-03 11:25:59,241 - DEBUG - Online update step: 27/50
2025-06-03 11:25:59,243 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:25:59,560 - DEBUG - Node anomaly scores shape: torch.Size([8969, 1])
2025-06-03 11:25:59,586 - DEBUG - Edge anomaly scores shape: torch.Size([18473, 1])
2025-06-03 11:25:59,587 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:00,105 - DEBUG - Step 27: Loss=0.6504
2025-06-03 11:26:00,105 - DEBUG - Online update step: 28/50
2025-06-03 11:26:00,107 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:00,421 - DEBUG - Node anomaly scores shape: torch.Size([9188, 1])
2025-06-03 11:26:00,447 - DEBUG - Edge anomaly scores shape: torch.Size([18960, 1])
2025-06-03 11:26:00,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:01,067 - DEBUG - Step 28: Loss=0.6420
2025-06-03 11:26:01,067 - DEBUG - Online update step: 29/50
2025-06-03 11:26:01,070 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:01,376 - DEBUG - Node anomaly scores shape: torch.Size([8960, 1])
2025-06-03 11:26:01,403 - DEBUG - Edge anomaly scores shape: torch.Size([18419, 1])
2025-06-03 11:26:01,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:01,980 - DEBUG - Step 29: Loss=0.6451
2025-06-03 11:26:01,980 - DEBUG - Online update step: 30/50
2025-06-03 11:26:01,983 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:02,273 - DEBUG - Node anomaly scores shape: torch.Size([8722, 1])
2025-06-03 11:26:02,299 - DEBUG - Edge anomaly scores shape: torch.Size([17798, 1])
2025-06-03 11:26:02,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:02,805 - DEBUG - Step 30: Loss=0.6488
2025-06-03 11:26:02,805 - DEBUG - Online update step: 31/50
2025-06-03 11:26:02,807 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:03,140 - DEBUG - Node anomaly scores shape: torch.Size([9395, 1])
2025-06-03 11:26:03,171 - DEBUG - Edge anomaly scores shape: torch.Size([19414, 1])
2025-06-03 11:26:03,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:03,817 - DEBUG - Step 31: Loss=0.6520
2025-06-03 11:26:03,818 - DEBUG - Online update step: 32/50
2025-06-03 11:26:03,820 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:04,152 - DEBUG - Node anomaly scores shape: torch.Size([9056, 1])
2025-06-03 11:26:04,182 - DEBUG - Edge anomaly scores shape: torch.Size([18579, 1])
2025-06-03 11:26:04,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:04,792 - DEBUG - Step 32: Loss=0.6479
2025-06-03 11:26:04,792 - DEBUG - Online update step: 33/50
2025-06-03 11:26:04,795 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:05,126 - DEBUG - Node anomaly scores shape: torch.Size([8976, 1])
2025-06-03 11:26:05,156 - DEBUG - Edge anomaly scores shape: torch.Size([18388, 1])
2025-06-03 11:26:05,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:05,731 - DEBUG - Step 33: Loss=0.6542
2025-06-03 11:26:05,732 - DEBUG - Online update step: 34/50
2025-06-03 11:26:05,735 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:06,107 - DEBUG - Node anomaly scores shape: torch.Size([9449, 1])
2025-06-03 11:26:06,144 - DEBUG - Edge anomaly scores shape: torch.Size([19600, 1])
2025-06-03 11:26:06,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:06,785 - DEBUG - Step 34: Loss=0.6379
2025-06-03 11:26:06,785 - DEBUG - Online update step: 35/50
2025-06-03 11:26:06,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:07,231 - DEBUG - Node anomaly scores shape: torch.Size([9703, 1])
2025-06-03 11:26:07,268 - DEBUG - Edge anomaly scores shape: torch.Size([20131, 1])
2025-06-03 11:26:07,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:08,254 - DEBUG - Step 35: Loss=0.6321
2025-06-03 11:26:08,255 - DEBUG - Online update step: 36/50
2025-06-03 11:26:08,261 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:09,113 - DEBUG - Node anomaly scores shape: torch.Size([8901, 1])
2025-06-03 11:26:09,154 - DEBUG - Edge anomaly scores shape: torch.Size([18272, 1])
2025-06-03 11:26:09,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:09,768 - DEBUG - Step 36: Loss=0.6464
2025-06-03 11:26:09,768 - DEBUG - Online update step: 37/50
2025-06-03 11:26:09,770 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:10,138 - DEBUG - Node anomaly scores shape: torch.Size([8969, 1])
2025-06-03 11:26:10,173 - DEBUG - Edge anomaly scores shape: torch.Size([18462, 1])
2025-06-03 11:26:10,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:10,828 - DEBUG - Step 37: Loss=0.6394
2025-06-03 11:26:10,828 - DEBUG - Online update step: 38/50
2025-06-03 11:26:10,831 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:11,254 - DEBUG - Node anomaly scores shape: torch.Size([9499, 1])
2025-06-03 11:26:11,288 - DEBUG - Edge anomaly scores shape: torch.Size([19714, 1])
2025-06-03 11:26:11,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:11,974 - DEBUG - Step 38: Loss=0.6482
2025-06-03 11:26:11,974 - DEBUG - Online update step: 39/50
2025-06-03 11:26:11,976 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:12,391 - DEBUG - Node anomaly scores shape: torch.Size([9685, 1])
2025-06-03 11:26:12,431 - DEBUG - Edge anomaly scores shape: torch.Size([20140, 1])
2025-06-03 11:26:12,433 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:13,179 - DEBUG - Step 39: Loss=0.6238
2025-06-03 11:26:13,179 - DEBUG - Online update step: 40/50
2025-06-03 11:26:13,182 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:13,557 - DEBUG - Node anomaly scores shape: torch.Size([9331, 1])
2025-06-03 11:26:13,591 - DEBUG - Edge anomaly scores shape: torch.Size([19318, 1])
2025-06-03 11:26:13,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:14,354 - DEBUG - Step 40: Loss=0.6455
2025-06-03 11:26:14,354 - DEBUG - Online update step: 41/50
2025-06-03 11:26:14,356 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:14,713 - DEBUG - Node anomaly scores shape: torch.Size([8631, 1])
2025-06-03 11:26:14,744 - DEBUG - Edge anomaly scores shape: torch.Size([17673, 1])
2025-06-03 11:26:14,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:15,407 - DEBUG - Step 41: Loss=0.6402
2025-06-03 11:26:15,407 - DEBUG - Online update step: 42/50
2025-06-03 11:26:15,409 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:15,807 - DEBUG - Node anomaly scores shape: torch.Size([9227, 1])
2025-06-03 11:26:15,840 - DEBUG - Edge anomaly scores shape: torch.Size([18984, 1])
2025-06-03 11:26:15,841 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:16,501 - DEBUG - Step 42: Loss=0.6403
2025-06-03 11:26:16,502 - DEBUG - Online update step: 43/50
2025-06-03 11:26:16,505 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:16,956 - DEBUG - Node anomaly scores shape: torch.Size([8943, 1])
2025-06-03 11:26:16,993 - DEBUG - Edge anomaly scores shape: torch.Size([18399, 1])
2025-06-03 11:26:16,994 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:17,694 - DEBUG - Step 43: Loss=0.6360
2025-06-03 11:26:17,694 - DEBUG - Online update step: 44/50
2025-06-03 11:26:17,696 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:18,063 - DEBUG - Node anomaly scores shape: torch.Size([8756, 1])
2025-06-03 11:26:18,097 - DEBUG - Edge anomaly scores shape: torch.Size([17999, 1])
2025-06-03 11:26:18,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:18,787 - DEBUG - Step 44: Loss=0.6378
2025-06-03 11:26:18,787 - DEBUG - Online update step: 45/50
2025-06-03 11:26:18,790 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:19,122 - DEBUG - Node anomaly scores shape: torch.Size([8491, 1])
2025-06-03 11:26:19,147 - DEBUG - Edge anomaly scores shape: torch.Size([17221, 1])
2025-06-03 11:26:19,148 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:19,696 - DEBUG - Step 45: Loss=0.6489
2025-06-03 11:26:19,696 - DEBUG - Online update step: 46/50
2025-06-03 11:26:19,698 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:20,003 - DEBUG - Node anomaly scores shape: torch.Size([8698, 1])
2025-06-03 11:26:20,027 - DEBUG - Edge anomaly scores shape: torch.Size([17691, 1])
2025-06-03 11:26:20,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:20,503 - DEBUG - Step 46: Loss=0.6461
2025-06-03 11:26:20,503 - DEBUG - Online update step: 47/50
2025-06-03 11:26:20,505 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:20,834 - DEBUG - Node anomaly scores shape: torch.Size([9301, 1])
2025-06-03 11:26:20,861 - DEBUG - Edge anomaly scores shape: torch.Size([19289, 1])
2025-06-03 11:26:20,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:21,395 - DEBUG - Step 47: Loss=0.6341
2025-06-03 11:26:21,395 - DEBUG - Online update step: 48/50
2025-06-03 11:26:21,397 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:21,697 - DEBUG - Node anomaly scores shape: torch.Size([8694, 1])
2025-06-03 11:26:21,725 - DEBUG - Edge anomaly scores shape: torch.Size([17785, 1])
2025-06-03 11:26:21,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:22,222 - DEBUG - Step 48: Loss=0.6472
2025-06-03 11:26:22,223 - DEBUG - Online update step: 49/50
2025-06-03 11:26:22,224 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:22,569 - DEBUG - Node anomaly scores shape: torch.Size([9472, 1])
2025-06-03 11:26:22,596 - DEBUG - Edge anomaly scores shape: torch.Size([19564, 1])
2025-06-03 11:26:22,597 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:23,264 - DEBUG - Step 49: Loss=0.6318
2025-06-03 11:26:23,264 - DEBUG - Online update step: 50/50
2025-06-03 11:26:23,266 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:23,602 - DEBUG - Node anomaly scores shape: torch.Size([9476, 1])
2025-06-03 11:26:23,630 - DEBUG - Edge anomaly scores shape: torch.Size([19625, 1])
2025-06-03 11:26:23,631 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:24,179 - DEBUG - Step 50: Loss=0.6319
2025-06-03 11:26:24,179 - INFO - Online update finished. Average loss: 0.6474, Learning rate: 0.000287
2025-06-03 11:26:24,180 - DEBUG - Current node mean: [ 1.1254541e-08 -1.1254541e-08  2.6063150e-08  4.7387543e-09
  7.1081314e-09 -1.1846886e-09 -8.2928198e-09 -1.6585640e-08
 -4.7387543e-09  1.7770329e-09  1.1846886e-08 -1.1846886e-08
  2.0139707e-08 -7.1081314e-09  4.9756920e-08  1.8955017e-08
  2.3693771e-09  0.0000000e+00  0.0000000e+00 -2.4878460e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4175317e+00  4.9780855e+00 -5.4998517e-10 -5.4998517e-09
  0.0000000e+00  0.0000000e+00  6.5998225e-09  0.0000000e+00
 -2.1999407e-09  1.6499556e-09 -1.2649659e-08  6.5998225e-09
  6.5998225e-09  1.2099674e-08 -1.3199645e-08  1.0999703e-09
  1.0999703e-09  1.0999703e-09  1.0999703e-09  1.0999703e-09
  1.0999703e-09  3.8498964e-09]
2025-06-03 11:26:24,180 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0054
2025-06-03 11:26:24,185 - INFO - Online update complete. Loss: 0.6474
2025-06-03 11:26:24,185 - INFO - Running anomaly detection...
2025-06-03 11:26:24,186 - INFO - Starting anomaly detection.
2025-06-03 11:26:24,197 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112624_update_24.json
2025-06-03 11:26:24,197 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:26:24,215 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112624_update_24.pth and as latest_checkpoint.pth
2025-06-03 11:26:24,216 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.0001
2025-06-03 11:26:24,216 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-03 11:26:24,216 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 2.0030, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.9559, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Node ID: ff02::2, Recon Error: 0.7835, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.8476, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.6977, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:26:24,216 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.9312, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.9709, MLP Score: 0.9996
2025-06-03 11:26:24,216 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6029, MLP Score: 1.0000
2025-06-03 11:26:24,216 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.4364, MLP Score: 0.9999
2025-06-03 11:26:24,216 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 4.5880, MLP Score: 0.9973
2025-06-03 11:26:24,216 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-03 11:26:24,216 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-03 11:26:24,216 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot file.
2025-06-03 11:26:24,232 - INFO - Parsed 818 nodes.
2025-06-03 11:26:24,248 - INFO - Parsed 1761 edges.
2025-06-03 11:26:24,707 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:26:24,707 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:26:24,721 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-03 11:26:24,723 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:26:24,723 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-03 11:26:24,724 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-03 11:26:24,724 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:26:24,732 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:26:24,733 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:26:24,735 - DEBUG - Shape of encoded categorical edge features: torch.Size([1761, 2])
2025-06-03 11:26:24,736 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:26:24,736 - DEBUG - Shape of scaled numerical edge features: torch.Size([1761, 20])
2025-06-03 11:26:24,737 - DEBUG - Final edge attributes tensor shape: torch.Size([1761, 22])
2025-06-03 11:26:24,737 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:26:24,737 - INFO - Performing online update...
2025-06-03 11:26:24,737 - INFO - Starting online update for 50 steps.
2025-06-03 11:26:24,737 - DEBUG - Updated RunningStats: new_mean=0.5720906088536835, new_var=75000000000009.86, new_n=7530
2025-06-03 11:26:24,737 - DEBUG - Updated RunningStats: new_mean=0.5723351731014353, new_var=75300000000007.08, new_n=7560
2025-06-03 11:26:24,738 - DEBUG - Updated RunningStats: new_mean=0.795231597138351, new_var=42760000000030.625, new_n=4298
2025-06-03 11:26:24,738 - DEBUG - Updated RunningStats: new_mean=0.7963408925587724, new_var=42980000000001.875, new_n=4320
2025-06-03 11:26:24,738 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:26:24,738 - DEBUG - Online update step: 1/50
2025-06-03 11:26:24,739 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:25,113 - DEBUG - Node anomaly scores shape: torch.Size([10039, 1])
2025-06-03 11:26:25,148 - DEBUG - Edge anomaly scores shape: torch.Size([20903, 1])
2025-06-03 11:26:25,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:25,811 - DEBUG - Step 1: Loss=0.6222
2025-06-03 11:26:25,812 - DEBUG - Online update step: 2/50
2025-06-03 11:26:25,814 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:26,127 - DEBUG - Node anomaly scores shape: torch.Size([9147, 1])
2025-06-03 11:26:26,157 - DEBUG - Edge anomaly scores shape: torch.Size([18896, 1])
2025-06-03 11:26:26,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:26,649 - DEBUG - Step 2: Loss=0.6326
2025-06-03 11:26:26,649 - DEBUG - Online update step: 3/50
2025-06-03 11:26:26,650 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:26,983 - DEBUG - Node anomaly scores shape: torch.Size([9608, 1])
2025-06-03 11:26:27,011 - DEBUG - Edge anomaly scores shape: torch.Size([19802, 1])
2025-06-03 11:26:27,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:27,599 - DEBUG - Step 3: Loss=0.6390
2025-06-03 11:26:27,599 - DEBUG - Online update step: 4/50
2025-06-03 11:26:27,601 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:27,933 - DEBUG - Node anomaly scores shape: torch.Size([9086, 1])
2025-06-03 11:26:27,959 - DEBUG - Edge anomaly scores shape: torch.Size([18702, 1])
2025-06-03 11:26:27,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:28,559 - DEBUG - Step 4: Loss=0.6273
2025-06-03 11:26:28,559 - DEBUG - Online update step: 5/50
2025-06-03 11:26:28,561 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:28,853 - DEBUG - Node anomaly scores shape: torch.Size([8660, 1])
2025-06-03 11:26:28,879 - DEBUG - Edge anomaly scores shape: torch.Size([17656, 1])
2025-06-03 11:26:28,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:29,425 - DEBUG - Step 5: Loss=0.6281
2025-06-03 11:26:29,425 - DEBUG - Online update step: 6/50
2025-06-03 11:26:29,427 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:29,772 - DEBUG - Node anomaly scores shape: torch.Size([9799, 1])
2025-06-03 11:26:29,804 - DEBUG - Edge anomaly scores shape: torch.Size([20356, 1])
2025-06-03 11:26:29,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:30,401 - DEBUG - Step 6: Loss=0.6366
2025-06-03 11:26:30,401 - DEBUG - Online update step: 7/50
2025-06-03 11:26:30,403 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:30,741 - DEBUG - Node anomaly scores shape: torch.Size([9724, 1])
2025-06-03 11:26:30,771 - DEBUG - Edge anomaly scores shape: torch.Size([20165, 1])
2025-06-03 11:26:30,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:31,373 - DEBUG - Step 7: Loss=0.6212
2025-06-03 11:26:31,373 - DEBUG - Online update step: 8/50
2025-06-03 11:26:31,375 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:31,763 - DEBUG - Node anomaly scores shape: torch.Size([10614, 1])
2025-06-03 11:26:31,795 - DEBUG - Edge anomaly scores shape: torch.Size([22304, 1])
2025-06-03 11:26:31,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:32,460 - DEBUG - Step 8: Loss=0.6362
2025-06-03 11:26:32,460 - DEBUG - Online update step: 9/50
2025-06-03 11:26:32,463 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:32,805 - DEBUG - Node anomaly scores shape: torch.Size([8888, 1])
2025-06-03 11:26:32,835 - DEBUG - Edge anomaly scores shape: torch.Size([18205, 1])
2025-06-03 11:26:32,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:33,494 - DEBUG - Step 9: Loss=0.6580
2025-06-03 11:26:33,494 - DEBUG - Online update step: 10/50
2025-06-03 11:26:33,497 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:33,889 - DEBUG - Node anomaly scores shape: torch.Size([9676, 1])
2025-06-03 11:26:33,919 - DEBUG - Edge anomaly scores shape: torch.Size([20025, 1])
2025-06-03 11:26:33,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:34,485 - DEBUG - Step 10: Loss=0.6343
2025-06-03 11:26:34,485 - DEBUG - Online update step: 11/50
2025-06-03 11:26:34,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:34,846 - DEBUG - Node anomaly scores shape: torch.Size([9148, 1])
2025-06-03 11:26:34,879 - DEBUG - Edge anomaly scores shape: torch.Size([18962, 1])
2025-06-03 11:26:34,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:35,501 - DEBUG - Step 11: Loss=0.6413
2025-06-03 11:26:35,501 - DEBUG - Online update step: 12/50
2025-06-03 11:26:35,503 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:35,858 - DEBUG - Node anomaly scores shape: torch.Size([9508, 1])
2025-06-03 11:26:35,889 - DEBUG - Edge anomaly scores shape: torch.Size([19657, 1])
2025-06-03 11:26:35,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:36,580 - DEBUG - Step 12: Loss=0.6433
2025-06-03 11:26:36,580 - DEBUG - Online update step: 13/50
2025-06-03 11:26:36,584 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:36,938 - DEBUG - Node anomaly scores shape: torch.Size([9164, 1])
2025-06-03 11:26:36,970 - DEBUG - Edge anomaly scores shape: torch.Size([18826, 1])
2025-06-03 11:26:36,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:37,616 - DEBUG - Step 13: Loss=0.6293
2025-06-03 11:26:37,616 - DEBUG - Online update step: 14/50
2025-06-03 11:26:37,618 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:37,957 - DEBUG - Node anomaly scores shape: torch.Size([8940, 1])
2025-06-03 11:26:37,994 - DEBUG - Edge anomaly scores shape: torch.Size([18266, 1])
2025-06-03 11:26:37,995 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:38,590 - DEBUG - Step 14: Loss=0.6222
2025-06-03 11:26:38,591 - DEBUG - Online update step: 15/50
2025-06-03 11:26:38,592 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:38,959 - DEBUG - Node anomaly scores shape: torch.Size([9030, 1])
2025-06-03 11:26:38,992 - DEBUG - Edge anomaly scores shape: torch.Size([18678, 1])
2025-06-03 11:26:38,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:39,674 - DEBUG - Step 15: Loss=0.6302
2025-06-03 11:26:39,674 - DEBUG - Online update step: 16/50
2025-06-03 11:26:39,677 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:40,078 - DEBUG - Node anomaly scores shape: torch.Size([9517, 1])
2025-06-03 11:26:40,113 - DEBUG - Edge anomaly scores shape: torch.Size([19637, 1])
2025-06-03 11:26:40,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:40,843 - DEBUG - Step 16: Loss=0.6358
2025-06-03 11:26:40,844 - DEBUG - Online update step: 17/50
2025-06-03 11:26:40,846 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:41,217 - DEBUG - Node anomaly scores shape: torch.Size([8816, 1])
2025-06-03 11:26:41,248 - DEBUG - Edge anomaly scores shape: torch.Size([18167, 1])
2025-06-03 11:26:41,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:41,820 - DEBUG - Step 17: Loss=0.6410
2025-06-03 11:26:41,820 - DEBUG - Online update step: 18/50
2025-06-03 11:26:41,824 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:42,228 - DEBUG - Node anomaly scores shape: torch.Size([9480, 1])
2025-06-03 11:26:42,263 - DEBUG - Edge anomaly scores shape: torch.Size([19609, 1])
2025-06-03 11:26:42,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:42,937 - DEBUG - Step 18: Loss=0.6372
2025-06-03 11:26:42,937 - DEBUG - Online update step: 19/50
2025-06-03 11:26:42,939 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:43,295 - DEBUG - Node anomaly scores shape: torch.Size([8847, 1])
2025-06-03 11:26:43,328 - DEBUG - Edge anomaly scores shape: torch.Size([18135, 1])
2025-06-03 11:26:43,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:43,926 - DEBUG - Step 19: Loss=0.6343
2025-06-03 11:26:43,927 - DEBUG - Online update step: 20/50
2025-06-03 11:26:43,930 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:44,314 - DEBUG - Node anomaly scores shape: torch.Size([9125, 1])
2025-06-03 11:26:44,348 - DEBUG - Edge anomaly scores shape: torch.Size([18768, 1])
2025-06-03 11:26:44,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:45,058 - DEBUG - Step 20: Loss=0.6315
2025-06-03 11:26:45,058 - DEBUG - Online update step: 21/50
2025-06-03 11:26:45,062 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:45,471 - DEBUG - Node anomaly scores shape: torch.Size([9311, 1])
2025-06-03 11:26:45,504 - DEBUG - Edge anomaly scores shape: torch.Size([19102, 1])
2025-06-03 11:26:45,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:46,192 - DEBUG - Step 21: Loss=0.6397
2025-06-03 11:26:46,192 - DEBUG - Online update step: 22/50
2025-06-03 11:26:46,195 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:46,561 - DEBUG - Node anomaly scores shape: torch.Size([8961, 1])
2025-06-03 11:26:46,596 - DEBUG - Edge anomaly scores shape: torch.Size([18452, 1])
2025-06-03 11:26:46,597 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:47,209 - DEBUG - Step 22: Loss=0.6380
2025-06-03 11:26:47,210 - DEBUG - Online update step: 23/50
2025-06-03 11:26:47,212 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:47,508 - DEBUG - Node anomaly scores shape: torch.Size([8735, 1])
2025-06-03 11:26:47,538 - DEBUG - Edge anomaly scores shape: torch.Size([17894, 1])
2025-06-03 11:26:47,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:47,998 - DEBUG - Step 23: Loss=0.6386
2025-06-03 11:26:47,998 - DEBUG - Online update step: 24/50
2025-06-03 11:26:48,000 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:48,288 - DEBUG - Node anomaly scores shape: torch.Size([8524, 1])
2025-06-03 11:26:48,312 - DEBUG - Edge anomaly scores shape: torch.Size([17378, 1])
2025-06-03 11:26:48,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:48,849 - DEBUG - Step 24: Loss=0.6376
2025-06-03 11:26:48,849 - DEBUG - Online update step: 25/50
2025-06-03 11:26:48,851 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:49,157 - DEBUG - Node anomaly scores shape: torch.Size([8664, 1])
2025-06-03 11:26:49,183 - DEBUG - Edge anomaly scores shape: torch.Size([17666, 1])
2025-06-03 11:26:49,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:49,785 - DEBUG - Step 25: Loss=0.6332
2025-06-03 11:26:49,785 - DEBUG - Online update step: 26/50
2025-06-03 11:26:49,786 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:50,130 - DEBUG - Node anomaly scores shape: torch.Size([9747, 1])
2025-06-03 11:26:50,157 - DEBUG - Edge anomaly scores shape: torch.Size([20220, 1])
2025-06-03 11:26:50,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:50,744 - DEBUG - Step 26: Loss=0.6317
2025-06-03 11:26:50,744 - DEBUG - Online update step: 27/50
2025-06-03 11:26:50,745 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:51,038 - DEBUG - Node anomaly scores shape: torch.Size([8251, 1])
2025-06-03 11:26:51,065 - DEBUG - Edge anomaly scores shape: torch.Size([16775, 1])
2025-06-03 11:26:51,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:51,578 - DEBUG - Step 27: Loss=0.6504
2025-06-03 11:26:51,578 - DEBUG - Online update step: 28/50
2025-06-03 11:26:51,580 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:51,919 - DEBUG - Node anomaly scores shape: torch.Size([9145, 1])
2025-06-03 11:26:51,945 - DEBUG - Edge anomaly scores shape: torch.Size([18808, 1])
2025-06-03 11:26:51,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:52,488 - DEBUG - Step 28: Loss=0.6460
2025-06-03 11:26:52,488 - DEBUG - Online update step: 29/50
2025-06-03 11:26:52,489 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:52,835 - DEBUG - Node anomaly scores shape: torch.Size([9659, 1])
2025-06-03 11:26:52,865 - DEBUG - Edge anomaly scores shape: torch.Size([20070, 1])
2025-06-03 11:26:52,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:53,383 - DEBUG - Step 29: Loss=0.6446
2025-06-03 11:26:53,383 - DEBUG - Online update step: 30/50
2025-06-03 11:26:53,384 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:53,693 - DEBUG - Node anomaly scores shape: torch.Size([8875, 1])
2025-06-03 11:26:53,724 - DEBUG - Edge anomaly scores shape: torch.Size([18191, 1])
2025-06-03 11:26:53,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:54,315 - DEBUG - Step 30: Loss=0.6328
2025-06-03 11:26:54,315 - DEBUG - Online update step: 31/50
2025-06-03 11:26:54,316 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:54,638 - DEBUG - Node anomaly scores shape: torch.Size([9141, 1])
2025-06-03 11:26:54,667 - DEBUG - Edge anomaly scores shape: torch.Size([18740, 1])
2025-06-03 11:26:54,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:55,235 - DEBUG - Step 31: Loss=0.6427
2025-06-03 11:26:55,235 - DEBUG - Online update step: 32/50
2025-06-03 11:26:55,237 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:55,589 - DEBUG - Node anomaly scores shape: torch.Size([9859, 1])
2025-06-03 11:26:55,621 - DEBUG - Edge anomaly scores shape: torch.Size([20531, 1])
2025-06-03 11:26:55,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:56,192 - DEBUG - Step 32: Loss=0.6309
2025-06-03 11:26:56,192 - DEBUG - Online update step: 33/50
2025-06-03 11:26:56,193 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:56,523 - DEBUG - Node anomaly scores shape: torch.Size([9475, 1])
2025-06-03 11:26:56,554 - DEBUG - Edge anomaly scores shape: torch.Size([19724, 1])
2025-06-03 11:26:56,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:57,169 - DEBUG - Step 33: Loss=0.6300
2025-06-03 11:26:57,169 - DEBUG - Online update step: 34/50
2025-06-03 11:26:57,171 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:57,517 - DEBUG - Node anomaly scores shape: torch.Size([9751, 1])
2025-06-03 11:26:57,546 - DEBUG - Edge anomaly scores shape: torch.Size([20236, 1])
2025-06-03 11:26:57,547 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:58,127 - DEBUG - Step 34: Loss=0.6250
2025-06-03 11:26:58,127 - DEBUG - Online update step: 35/50
2025-06-03 11:26:58,130 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:58,468 - DEBUG - Node anomaly scores shape: torch.Size([9025, 1])
2025-06-03 11:26:58,498 - DEBUG - Edge anomaly scores shape: torch.Size([18532, 1])
2025-06-03 11:26:58,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:58,993 - DEBUG - Step 35: Loss=0.6363
2025-06-03 11:26:58,993 - DEBUG - Online update step: 36/50
2025-06-03 11:26:58,996 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:26:59,323 - DEBUG - Node anomaly scores shape: torch.Size([8901, 1])
2025-06-03 11:26:59,354 - DEBUG - Edge anomaly scores shape: torch.Size([18255, 1])
2025-06-03 11:26:59,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:26:59,904 - DEBUG - Step 36: Loss=0.6314
2025-06-03 11:26:59,905 - DEBUG - Online update step: 37/50
2025-06-03 11:26:59,907 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:00,234 - DEBUG - Node anomaly scores shape: torch.Size([9111, 1])
2025-06-03 11:27:00,264 - DEBUG - Edge anomaly scores shape: torch.Size([18711, 1])
2025-06-03 11:27:00,265 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:00,805 - DEBUG - Step 37: Loss=0.6291
2025-06-03 11:27:00,805 - DEBUG - Online update step: 38/50
2025-06-03 11:27:00,806 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:01,180 - DEBUG - Node anomaly scores shape: torch.Size([9683, 1])
2025-06-03 11:27:01,209 - DEBUG - Edge anomaly scores shape: torch.Size([20001, 1])
2025-06-03 11:27:01,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:01,828 - DEBUG - Step 38: Loss=0.6265
2025-06-03 11:27:01,828 - DEBUG - Online update step: 39/50
2025-06-03 11:27:01,829 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:02,138 - DEBUG - Node anomaly scores shape: torch.Size([8779, 1])
2025-06-03 11:27:02,171 - DEBUG - Edge anomaly scores shape: torch.Size([17949, 1])
2025-06-03 11:27:02,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:02,737 - DEBUG - Step 39: Loss=0.6425
2025-06-03 11:27:02,737 - DEBUG - Online update step: 40/50
2025-06-03 11:27:02,739 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:03,112 - DEBUG - Node anomaly scores shape: torch.Size([9881, 1])
2025-06-03 11:27:03,145 - DEBUG - Edge anomaly scores shape: torch.Size([20502, 1])
2025-06-03 11:27:03,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:03,868 - DEBUG - Step 40: Loss=0.6255
2025-06-03 11:27:03,868 - DEBUG - Online update step: 41/50
2025-06-03 11:27:03,871 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:04,216 - DEBUG - Node anomaly scores shape: torch.Size([8968, 1])
2025-06-03 11:27:04,245 - DEBUG - Edge anomaly scores shape: torch.Size([18403, 1])
2025-06-03 11:27:04,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:04,880 - DEBUG - Step 41: Loss=0.6389
2025-06-03 11:27:04,880 - DEBUG - Online update step: 42/50
2025-06-03 11:27:04,883 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:05,249 - DEBUG - Node anomaly scores shape: torch.Size([9110, 1])
2025-06-03 11:27:05,280 - DEBUG - Edge anomaly scores shape: torch.Size([18826, 1])
2025-06-03 11:27:05,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:05,953 - DEBUG - Step 42: Loss=0.6305
2025-06-03 11:27:05,953 - DEBUG - Online update step: 43/50
2025-06-03 11:27:05,956 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:06,313 - DEBUG - Node anomaly scores shape: torch.Size([8731, 1])
2025-06-03 11:27:06,348 - DEBUG - Edge anomaly scores shape: torch.Size([17895, 1])
2025-06-03 11:27:06,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:06,954 - DEBUG - Step 43: Loss=0.6365
2025-06-03 11:27:06,954 - DEBUG - Online update step: 44/50
2025-06-03 11:27:06,956 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:07,357 - DEBUG - Node anomaly scores shape: torch.Size([9391, 1])
2025-06-03 11:27:07,391 - DEBUG - Edge anomaly scores shape: torch.Size([19377, 1])
2025-06-03 11:27:07,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:08,129 - DEBUG - Step 44: Loss=0.6248
2025-06-03 11:27:08,129 - DEBUG - Online update step: 45/50
2025-06-03 11:27:08,133 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:08,518 - DEBUG - Node anomaly scores shape: torch.Size([9199, 1])
2025-06-03 11:27:08,552 - DEBUG - Edge anomaly scores shape: torch.Size([18988, 1])
2025-06-03 11:27:08,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:09,317 - DEBUG - Step 45: Loss=0.6269
2025-06-03 11:27:09,317 - DEBUG - Online update step: 46/50
2025-06-03 11:27:09,319 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:09,704 - DEBUG - Node anomaly scores shape: torch.Size([9285, 1])
2025-06-03 11:27:09,738 - DEBUG - Edge anomaly scores shape: torch.Size([19167, 1])
2025-06-03 11:27:09,739 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:10,478 - DEBUG - Step 46: Loss=0.6222
2025-06-03 11:27:10,479 - DEBUG - Online update step: 47/50
2025-06-03 11:27:10,482 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:10,887 - DEBUG - Node anomaly scores shape: torch.Size([9262, 1])
2025-06-03 11:27:10,925 - DEBUG - Edge anomaly scores shape: torch.Size([19088, 1])
2025-06-03 11:27:10,926 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:11,609 - DEBUG - Step 47: Loss=0.6471
2025-06-03 11:27:11,610 - DEBUG - Online update step: 48/50
2025-06-03 11:27:11,611 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:11,978 - DEBUG - Node anomaly scores shape: torch.Size([8722, 1])
2025-06-03 11:27:12,010 - DEBUG - Edge anomaly scores shape: torch.Size([17842, 1])
2025-06-03 11:27:12,011 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:12,619 - DEBUG - Step 48: Loss=0.6446
2025-06-03 11:27:12,619 - DEBUG - Online update step: 49/50
2025-06-03 11:27:12,621 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:12,964 - DEBUG - Node anomaly scores shape: torch.Size([8283, 1])
2025-06-03 11:27:12,995 - DEBUG - Edge anomaly scores shape: torch.Size([16718, 1])
2025-06-03 11:27:12,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:13,646 - DEBUG - Step 49: Loss=0.6378
2025-06-03 11:27:13,646 - DEBUG - Online update step: 50/50
2025-06-03 11:27:13,648 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:14,065 - DEBUG - Node anomaly scores shape: torch.Size([9056, 1])
2025-06-03 11:27:14,096 - DEBUG - Edge anomaly scores shape: torch.Size([18558, 1])
2025-06-03 11:27:14,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:14,687 - DEBUG - Step 50: Loss=0.6248
2025-06-03 11:27:14,687 - INFO - Online update finished. Average loss: 0.6346, Learning rate: 0.000074
2025-06-03 11:27:14,688 - DEBUG - Current node mean: [ 2.3317220e-08 -2.3317220e-08  3.0312385e-08  5.8293054e-10
  1.9819637e-08  5.8293050e-09 -2.6814803e-08  9.3268886e-09
 -5.2463744e-09  8.1610274e-09 -3.6141692e-08 -1.8945242e-08
  1.0638482e-08 -1.2824471e-08 -4.6634443e-09  1.7487915e-08
 -2.2151360e-08  0.0000000e+00  0.0000000e+00  3.6141692e-08
  0.0000000e+00  0.0000000e+00  2.5648943e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4168086e+00  4.9852357e+00 -4.3324215e-09  1.6246581e-09
  3.7908690e-09 -1.6246581e-09  2.7077636e-09 -2.1662108e-09
 -1.6246581e-09 -4.3324215e-09  2.8160741e-08 -4.7385860e-09
  1.0831054e-09  2.7077636e-09 -2.1662108e-09  2.4369873e-09
  2.4369873e-09  2.4369873e-09  2.4369873e-09  2.4369873e-09
  2.4369873e-09  0.0000000e+00]
2025-06-03 11:27:14,688 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0040
2025-06-03 11:27:14,688 - INFO - Online update complete. Loss: 0.6346
2025-06-03 11:27:14,689 - INFO - Running anomaly detection...
2025-06-03 11:27:14,689 - INFO - Starting anomaly detection.
2025-06-03 11:27:14,705 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112714_update_25.json
2025-06-03 11:27:14,705 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:27:14,723 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112714_update_25.pth and as latest_checkpoint.pth
2025-06-03 11:27:14,723 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.0001
2025-06-03 11:27:14,723 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 11:27:14,723 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 2.1887, MLP Score: 1.0000
2025-06-03 11:27:14,723 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1592, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.8852, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.7658, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.1862, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:27:14,724 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.6389, MLP Score: 0.9998
2025-06-03 11:27:14,724 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.6232, MLP Score: 0.9998
2025-06-03 11:27:14,724 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.3353, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.3391, MLP Score: 1.0000
2025-06-03 11:27:14,724 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 4.5051, MLP Score: 0.9989
2025-06-03 11:27:14,724 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-03 11:27:14,724 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-03 11:27:14,724 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot file.
2025-06-03 11:27:14,739 - INFO - Parsed 836 nodes.
2025-06-03 11:27:14,755 - INFO - Parsed 1786 edges.
2025-06-03 11:27:15,184 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:27:15,184 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:27:15,198 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-03 11:27:15,199 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:27:15,199 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-03 11:27:15,200 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-03 11:27:15,200 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:27:15,209 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:27:15,210 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:27:15,211 - DEBUG - Shape of encoded categorical edge features: torch.Size([1786, 2])
2025-06-03 11:27:15,212 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:27:15,213 - DEBUG - Shape of scaled numerical edge features: torch.Size([1786, 20])
2025-06-03 11:27:15,213 - DEBUG - Final edge attributes tensor shape: torch.Size([1786, 22])
2025-06-03 11:27:15,213 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:27:15,213 - INFO - Performing online update...
2025-06-03 11:27:15,213 - INFO - Starting online update for 50 steps.
2025-06-03 11:27:15,214 - DEBUG - Updated RunningStats: new_mean=0.5700729787508851, new_var=75600000000009.78, new_n=7590
2025-06-03 11:27:15,214 - DEBUG - Updated RunningStats: new_mean=0.5703235279311236, new_var=75900000000007.1, new_n=7620
2025-06-03 11:27:15,214 - DEBUG - Updated RunningStats: new_mean=0.7937809560223777, new_var=43200000000030.625, new_n=4342
2025-06-03 11:27:15,214 - DEBUG - Updated RunningStats: new_mean=0.7948860019036301, new_var=43420000000001.89, new_n=4364
2025-06-03 11:27:15,214 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:27:15,214 - DEBUG - Online update step: 1/50
2025-06-03 11:27:15,215 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:15,574 - DEBUG - Node anomaly scores shape: torch.Size([9701, 1])
2025-06-03 11:27:15,605 - DEBUG - Edge anomaly scores shape: torch.Size([20113, 1])
2025-06-03 11:27:15,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:16,155 - DEBUG - Step 1: Loss=0.6293
2025-06-03 11:27:16,156 - DEBUG - Online update step: 2/50
2025-06-03 11:27:16,158 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:16,523 - DEBUG - Node anomaly scores shape: torch.Size([9985, 1])
2025-06-03 11:27:16,551 - DEBUG - Edge anomaly scores shape: torch.Size([20743, 1])
2025-06-03 11:27:16,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:17,139 - DEBUG - Step 2: Loss=0.6414
2025-06-03 11:27:17,139 - DEBUG - Online update step: 3/50
2025-06-03 11:27:17,141 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:17,474 - DEBUG - Node anomaly scores shape: torch.Size([9400, 1])
2025-06-03 11:27:17,501 - DEBUG - Edge anomaly scores shape: torch.Size([19445, 1])
2025-06-03 11:27:17,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:18,089 - DEBUG - Step 3: Loss=0.6302
2025-06-03 11:27:18,089 - DEBUG - Online update step: 4/50
2025-06-03 11:27:18,091 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:18,443 - DEBUG - Node anomaly scores shape: torch.Size([9651, 1])
2025-06-03 11:27:18,471 - DEBUG - Edge anomaly scores shape: torch.Size([19950, 1])
2025-06-03 11:27:18,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:19,048 - DEBUG - Step 4: Loss=0.6276
2025-06-03 11:27:19,048 - DEBUG - Online update step: 5/50
2025-06-03 11:27:19,050 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:19,383 - DEBUG - Node anomaly scores shape: torch.Size([9594, 1])
2025-06-03 11:27:19,412 - DEBUG - Edge anomaly scores shape: torch.Size([19937, 1])
2025-06-03 11:27:19,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:19,992 - DEBUG - Step 5: Loss=0.6488
2025-06-03 11:27:19,992 - DEBUG - Online update step: 6/50
2025-06-03 11:27:19,994 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:20,293 - DEBUG - Node anomaly scores shape: torch.Size([9105, 1])
2025-06-03 11:27:20,320 - DEBUG - Edge anomaly scores shape: torch.Size([18801, 1])
2025-06-03 11:27:20,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:20,886 - DEBUG - Step 6: Loss=0.6356
2025-06-03 11:27:20,887 - DEBUG - Online update step: 7/50
2025-06-03 11:27:20,889 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:21,248 - DEBUG - Node anomaly scores shape: torch.Size([9892, 1])
2025-06-03 11:27:21,281 - DEBUG - Edge anomaly scores shape: torch.Size([20644, 1])
2025-06-03 11:27:21,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:21,909 - DEBUG - Step 7: Loss=0.6262
2025-06-03 11:27:21,910 - DEBUG - Online update step: 8/50
2025-06-03 11:27:21,911 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:22,275 - DEBUG - Node anomaly scores shape: torch.Size([10610, 1])
2025-06-03 11:27:22,307 - DEBUG - Edge anomaly scores shape: torch.Size([22260, 1])
2025-06-03 11:27:22,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:22,963 - DEBUG - Step 8: Loss=0.6359
2025-06-03 11:27:22,963 - DEBUG - Online update step: 9/50
2025-06-03 11:27:22,966 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:23,297 - DEBUG - Node anomaly scores shape: torch.Size([9030, 1])
2025-06-03 11:27:23,326 - DEBUG - Edge anomaly scores shape: torch.Size([18486, 1])
2025-06-03 11:27:23,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:23,878 - DEBUG - Step 9: Loss=0.6310
2025-06-03 11:27:23,879 - DEBUG - Online update step: 10/50
2025-06-03 11:27:23,882 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:24,213 - DEBUG - Node anomaly scores shape: torch.Size([8777, 1])
2025-06-03 11:27:24,240 - DEBUG - Edge anomaly scores shape: torch.Size([18018, 1])
2025-06-03 11:27:24,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:24,775 - DEBUG - Step 10: Loss=0.6601
2025-06-03 11:27:24,775 - DEBUG - Online update step: 11/50
2025-06-03 11:27:24,777 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:25,161 - DEBUG - Node anomaly scores shape: torch.Size([10173, 1])
2025-06-03 11:27:25,191 - DEBUG - Edge anomaly scores shape: torch.Size([21301, 1])
2025-06-03 11:27:25,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:25,757 - DEBUG - Step 11: Loss=0.6298
2025-06-03 11:27:25,757 - DEBUG - Online update step: 12/50
2025-06-03 11:27:25,759 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:26,069 - DEBUG - Node anomaly scores shape: torch.Size([8934, 1])
2025-06-03 11:27:26,096 - DEBUG - Edge anomaly scores shape: torch.Size([18313, 1])
2025-06-03 11:27:26,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:26,678 - DEBUG - Step 12: Loss=0.6271
2025-06-03 11:27:26,679 - DEBUG - Online update step: 13/50
2025-06-03 11:27:26,680 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:27,029 - DEBUG - Node anomaly scores shape: torch.Size([9351, 1])
2025-06-03 11:27:27,057 - DEBUG - Edge anomaly scores shape: torch.Size([19275, 1])
2025-06-03 11:27:27,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:27,620 - DEBUG - Step 13: Loss=0.6318
2025-06-03 11:27:27,621 - DEBUG - Online update step: 14/50
2025-06-03 11:27:27,622 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:27,971 - DEBUG - Node anomaly scores shape: torch.Size([9869, 1])
2025-06-03 11:27:28,001 - DEBUG - Edge anomaly scores shape: torch.Size([20618, 1])
2025-06-03 11:27:28,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:28,650 - DEBUG - Step 14: Loss=0.6270
2025-06-03 11:27:28,650 - DEBUG - Online update step: 15/50
2025-06-03 11:27:28,653 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:29,009 - DEBUG - Node anomaly scores shape: torch.Size([9390, 1])
2025-06-03 11:27:29,039 - DEBUG - Edge anomaly scores shape: torch.Size([19487, 1])
2025-06-03 11:27:29,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:29,653 - DEBUG - Step 15: Loss=0.6292
2025-06-03 11:27:29,653 - DEBUG - Online update step: 16/50
2025-06-03 11:27:29,656 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:29,987 - DEBUG - Node anomaly scores shape: torch.Size([8915, 1])
2025-06-03 11:27:30,016 - DEBUG - Edge anomaly scores shape: torch.Size([18182, 1])
2025-06-03 11:27:30,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:30,540 - DEBUG - Step 16: Loss=0.6440
2025-06-03 11:27:30,540 - DEBUG - Online update step: 17/50
2025-06-03 11:27:30,543 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:30,903 - DEBUG - Node anomaly scores shape: torch.Size([9388, 1])
2025-06-03 11:27:30,933 - DEBUG - Edge anomaly scores shape: torch.Size([19293, 1])
2025-06-03 11:27:30,934 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:31,551 - DEBUG - Step 17: Loss=0.6276
2025-06-03 11:27:31,551 - DEBUG - Online update step: 18/50
2025-06-03 11:27:31,553 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:31,923 - DEBUG - Node anomaly scores shape: torch.Size([9510, 1])
2025-06-03 11:27:31,956 - DEBUG - Edge anomaly scores shape: torch.Size([19706, 1])
2025-06-03 11:27:31,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:32,613 - DEBUG - Step 18: Loss=0.6278
2025-06-03 11:27:32,613 - DEBUG - Online update step: 19/50
2025-06-03 11:27:32,615 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:32,955 - DEBUG - Node anomaly scores shape: torch.Size([9290, 1])
2025-06-03 11:27:32,987 - DEBUG - Edge anomaly scores shape: torch.Size([19129, 1])
2025-06-03 11:27:32,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:33,624 - DEBUG - Step 19: Loss=0.6300
2025-06-03 11:27:33,624 - DEBUG - Online update step: 20/50
2025-06-03 11:27:33,626 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:34,023 - DEBUG - Node anomaly scores shape: torch.Size([9858, 1])
2025-06-03 11:27:34,064 - DEBUG - Edge anomaly scores shape: torch.Size([20518, 1])
2025-06-03 11:27:34,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:34,816 - DEBUG - Step 20: Loss=0.6274
2025-06-03 11:27:34,816 - DEBUG - Online update step: 21/50
2025-06-03 11:27:34,818 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:35,202 - DEBUG - Node anomaly scores shape: torch.Size([9608, 1])
2025-06-03 11:27:35,237 - DEBUG - Edge anomaly scores shape: torch.Size([19914, 1])
2025-06-03 11:27:35,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:35,909 - DEBUG - Step 21: Loss=0.6448
2025-06-03 11:27:35,909 - DEBUG - Online update step: 22/50
2025-06-03 11:27:35,911 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:36,364 - DEBUG - Node anomaly scores shape: torch.Size([10271, 1])
2025-06-03 11:27:36,404 - DEBUG - Edge anomaly scores shape: torch.Size([21461, 1])
2025-06-03 11:27:36,405 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:37,208 - DEBUG - Step 22: Loss=0.6218
2025-06-03 11:27:37,209 - DEBUG - Online update step: 23/50
2025-06-03 11:27:37,211 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:37,648 - DEBUG - Node anomaly scores shape: torch.Size([9464, 1])
2025-06-03 11:27:37,688 - DEBUG - Edge anomaly scores shape: torch.Size([19583, 1])
2025-06-03 11:27:37,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:38,497 - DEBUG - Step 23: Loss=0.6301
2025-06-03 11:27:38,497 - DEBUG - Online update step: 24/50
2025-06-03 11:27:38,499 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:38,889 - DEBUG - Node anomaly scores shape: torch.Size([8775, 1])
2025-06-03 11:27:38,928 - DEBUG - Edge anomaly scores shape: torch.Size([17894, 1])
2025-06-03 11:27:38,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:39,588 - DEBUG - Step 24: Loss=0.6273
2025-06-03 11:27:39,588 - DEBUG - Online update step: 25/50
2025-06-03 11:27:39,590 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:39,948 - DEBUG - Node anomaly scores shape: torch.Size([8696, 1])
2025-06-03 11:27:39,988 - DEBUG - Edge anomaly scores shape: torch.Size([17769, 1])
2025-06-03 11:27:39,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:40,778 - DEBUG - Step 25: Loss=0.6262
2025-06-03 11:27:40,778 - DEBUG - Online update step: 26/50
2025-06-03 11:27:40,780 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:41,198 - DEBUG - Node anomaly scores shape: torch.Size([9378, 1])
2025-06-03 11:27:41,232 - DEBUG - Edge anomaly scores shape: torch.Size([19456, 1])
2025-06-03 11:27:41,233 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:41,936 - DEBUG - Step 26: Loss=0.6182
2025-06-03 11:27:41,937 - DEBUG - Online update step: 27/50
2025-06-03 11:27:41,939 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:42,298 - DEBUG - Node anomaly scores shape: torch.Size([8818, 1])
2025-06-03 11:27:42,327 - DEBUG - Edge anomaly scores shape: torch.Size([18141, 1])
2025-06-03 11:27:42,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:42,851 - DEBUG - Step 27: Loss=0.6237
2025-06-03 11:27:42,851 - DEBUG - Online update step: 28/50
2025-06-03 11:27:42,852 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:43,198 - DEBUG - Node anomaly scores shape: torch.Size([9576, 1])
2025-06-03 11:27:43,226 - DEBUG - Edge anomaly scores shape: torch.Size([19849, 1])
2025-06-03 11:27:43,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:43,841 - DEBUG - Step 28: Loss=0.6350
2025-06-03 11:27:43,842 - DEBUG - Online update step: 29/50
2025-06-03 11:27:43,844 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:44,196 - DEBUG - Node anomaly scores shape: torch.Size([9983, 1])
2025-06-03 11:27:44,229 - DEBUG - Edge anomaly scores shape: torch.Size([20681, 1])
2025-06-03 11:27:44,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:44,807 - DEBUG - Step 29: Loss=0.6338
2025-06-03 11:27:44,807 - DEBUG - Online update step: 30/50
2025-06-03 11:27:44,809 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:45,147 - DEBUG - Node anomaly scores shape: torch.Size([9867, 1])
2025-06-03 11:27:45,181 - DEBUG - Edge anomaly scores shape: torch.Size([20481, 1])
2025-06-03 11:27:45,182 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:45,748 - DEBUG - Step 30: Loss=0.6215
2025-06-03 11:27:45,748 - DEBUG - Online update step: 31/50
2025-06-03 11:27:45,750 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:46,057 - DEBUG - Node anomaly scores shape: torch.Size([9269, 1])
2025-06-03 11:27:46,085 - DEBUG - Edge anomaly scores shape: torch.Size([19110, 1])
2025-06-03 11:27:46,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:46,625 - DEBUG - Step 31: Loss=0.6264
2025-06-03 11:27:46,625 - DEBUG - Online update step: 32/50
2025-06-03 11:27:46,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:46,927 - DEBUG - Node anomaly scores shape: torch.Size([8970, 1])
2025-06-03 11:27:46,953 - DEBUG - Edge anomaly scores shape: torch.Size([18350, 1])
2025-06-03 11:27:46,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:47,479 - DEBUG - Step 32: Loss=0.6291
2025-06-03 11:27:47,479 - DEBUG - Online update step: 33/50
2025-06-03 11:27:47,481 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:47,826 - DEBUG - Node anomaly scores shape: torch.Size([9342, 1])
2025-06-03 11:27:47,857 - DEBUG - Edge anomaly scores shape: torch.Size([19274, 1])
2025-06-03 11:27:47,857 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:48,404 - DEBUG - Step 33: Loss=0.6171
2025-06-03 11:27:48,405 - DEBUG - Online update step: 34/50
2025-06-03 11:27:48,407 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:48,758 - DEBUG - Node anomaly scores shape: torch.Size([10178, 1])
2025-06-03 11:27:48,788 - DEBUG - Edge anomaly scores shape: torch.Size([21240, 1])
2025-06-03 11:27:48,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:49,402 - DEBUG - Step 34: Loss=0.6214
2025-06-03 11:27:49,402 - DEBUG - Online update step: 35/50
2025-06-03 11:27:49,404 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:49,728 - DEBUG - Node anomaly scores shape: torch.Size([9408, 1])
2025-06-03 11:27:49,757 - DEBUG - Edge anomaly scores shape: torch.Size([19449, 1])
2025-06-03 11:27:49,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:50,289 - DEBUG - Step 35: Loss=0.6293
2025-06-03 11:27:50,289 - DEBUG - Online update step: 36/50
2025-06-03 11:27:50,291 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:50,628 - DEBUG - Node anomaly scores shape: torch.Size([9362, 1])
2025-06-03 11:27:50,656 - DEBUG - Edge anomaly scores shape: torch.Size([19327, 1])
2025-06-03 11:27:50,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:51,306 - DEBUG - Step 36: Loss=0.6308
2025-06-03 11:27:51,306 - DEBUG - Online update step: 37/50
2025-06-03 11:27:51,308 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:51,791 - DEBUG - Node anomaly scores shape: torch.Size([10286, 1])
2025-06-03 11:27:51,821 - DEBUG - Edge anomaly scores shape: torch.Size([21615, 1])
2025-06-03 11:27:51,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:52,552 - DEBUG - Step 37: Loss=0.6214
2025-06-03 11:27:52,553 - DEBUG - Online update step: 38/50
2025-06-03 11:27:52,556 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:52,927 - DEBUG - Node anomaly scores shape: torch.Size([8957, 1])
2025-06-03 11:27:52,959 - DEBUG - Edge anomaly scores shape: torch.Size([18360, 1])
2025-06-03 11:27:52,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:53,645 - DEBUG - Step 38: Loss=0.6270
2025-06-03 11:27:53,645 - DEBUG - Online update step: 39/50
2025-06-03 11:27:53,650 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:54,139 - DEBUG - Node anomaly scores shape: torch.Size([10246, 1])
2025-06-03 11:27:54,171 - DEBUG - Edge anomaly scores shape: torch.Size([21317, 1])
2025-06-03 11:27:54,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:54,878 - DEBUG - Step 39: Loss=0.6151
2025-06-03 11:27:54,878 - DEBUG - Online update step: 40/50
2025-06-03 11:27:54,881 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:55,267 - DEBUG - Node anomaly scores shape: torch.Size([9999, 1])
2025-06-03 11:27:55,299 - DEBUG - Edge anomaly scores shape: torch.Size([20925, 1])
2025-06-03 11:27:55,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:55,910 - DEBUG - Step 40: Loss=0.6251
2025-06-03 11:27:55,910 - DEBUG - Online update step: 41/50
2025-06-03 11:27:55,912 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:56,246 - DEBUG - Node anomaly scores shape: torch.Size([9382, 1])
2025-06-03 11:27:56,274 - DEBUG - Edge anomaly scores shape: torch.Size([19398, 1])
2025-06-03 11:27:56,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:56,881 - DEBUG - Step 41: Loss=0.6363
2025-06-03 11:27:56,882 - DEBUG - Online update step: 42/50
2025-06-03 11:27:56,886 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:57,213 - DEBUG - Node anomaly scores shape: torch.Size([9054, 1])
2025-06-03 11:27:57,242 - DEBUG - Edge anomaly scores shape: torch.Size([18659, 1])
2025-06-03 11:27:57,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:57,793 - DEBUG - Step 42: Loss=0.6199
2025-06-03 11:27:57,794 - DEBUG - Online update step: 43/50
2025-06-03 11:27:57,796 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:58,157 - DEBUG - Node anomaly scores shape: torch.Size([9611, 1])
2025-06-03 11:27:58,187 - DEBUG - Edge anomaly scores shape: torch.Size([19845, 1])
2025-06-03 11:27:58,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:27:58,848 - DEBUG - Step 43: Loss=0.6375
2025-06-03 11:27:58,849 - DEBUG - Online update step: 44/50
2025-06-03 11:27:58,851 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:27:59,264 - DEBUG - Node anomaly scores shape: torch.Size([10401, 1])
2025-06-03 11:27:59,297 - DEBUG - Edge anomaly scores shape: torch.Size([21695, 1])
2025-06-03 11:27:59,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:00,108 - DEBUG - Step 44: Loss=0.6239
2025-06-03 11:28:00,108 - DEBUG - Online update step: 45/50
2025-06-03 11:28:00,111 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:00,563 - DEBUG - Node anomaly scores shape: torch.Size([9926, 1])
2025-06-03 11:28:00,601 - DEBUG - Edge anomaly scores shape: torch.Size([20767, 1])
2025-06-03 11:28:00,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:01,277 - DEBUG - Step 45: Loss=0.6396
2025-06-03 11:28:01,278 - DEBUG - Online update step: 46/50
2025-06-03 11:28:01,279 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:01,652 - DEBUG - Node anomaly scores shape: torch.Size([9687, 1])
2025-06-03 11:28:01,693 - DEBUG - Edge anomaly scores shape: torch.Size([20074, 1])
2025-06-03 11:28:01,695 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:02,393 - DEBUG - Step 46: Loss=0.6229
2025-06-03 11:28:02,393 - DEBUG - Online update step: 47/50
2025-06-03 11:28:02,396 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:02,779 - DEBUG - Node anomaly scores shape: torch.Size([9149, 1])
2025-06-03 11:28:02,814 - DEBUG - Edge anomaly scores shape: torch.Size([18779, 1])
2025-06-03 11:28:02,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:03,678 - DEBUG - Step 47: Loss=0.6352
2025-06-03 11:28:03,678 - DEBUG - Online update step: 48/50
2025-06-03 11:28:03,683 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:04,302 - DEBUG - Node anomaly scores shape: torch.Size([9408, 1])
2025-06-03 11:28:04,347 - DEBUG - Edge anomaly scores shape: torch.Size([19434, 1])
2025-06-03 11:28:04,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:05,338 - DEBUG - Step 48: Loss=0.6271
2025-06-03 11:28:05,339 - DEBUG - Online update step: 49/50
2025-06-03 11:28:05,343 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:05,955 - DEBUG - Node anomaly scores shape: torch.Size([9992, 1])
2025-06-03 11:28:06,012 - DEBUG - Edge anomaly scores shape: torch.Size([20709, 1])
2025-06-03 11:28:06,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:07,113 - DEBUG - Step 49: Loss=0.6266
2025-06-03 11:28:07,114 - DEBUG - Online update step: 50/50
2025-06-03 11:28:07,120 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:07,692 - DEBUG - Node anomaly scores shape: torch.Size([8972, 1])
2025-06-03 11:28:07,735 - DEBUG - Edge anomaly scores shape: torch.Size([18405, 1])
2025-06-03 11:28:07,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:08,711 - DEBUG - Step 50: Loss=0.6316
2025-06-03 11:28:08,711 - INFO - Online update finished. Average loss: 0.6299, Learning rate: 0.003000
2025-06-03 11:28:08,713 - DEBUG - Current node mean: [-5.5326801e-08  5.5326801e-08  1.3689105e-08 -7.1297421e-09
 -7.9853111e-09 -2.2815174e-09 -4.7911868e-08 -8.0566087e-09
  9.6964490e-09  1.6541001e-08  6.8445525e-09  2.7948589e-08
  8.5556906e-10  6.8445525e-09  1.8252139e-08  9.1260697e-09
  1.0266829e-08  0.0000000e+00  0.0000000e+00 -5.1334146e-09
  0.0000000e+00  0.0000000e+00  3.0800486e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4137738e+00  4.9904814e+00  0.0000000e+00  0.0000000e+00
 -2.1358888e-09 -2.1358888e-09 -2.1358888e-09 -1.0679444e-09
  0.0000000e+00  3.2038332e-09  2.1358888e-08  5.3397220e-10
  2.6698610e-09  1.2815333e-08  1.3349305e-09  1.3349305e-09
  1.3349305e-09  1.3349305e-09  1.3349305e-09  1.3349305e-09
  1.3349305e-09  1.0679444e-09]
2025-06-03 11:28:08,713 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0060
2025-06-03 11:28:08,726 - INFO - Online update complete. Loss: 0.6299
2025-06-03 11:28:08,726 - INFO - Running anomaly detection...
2025-06-03 11:28:08,727 - INFO - Starting anomaly detection.
2025-06-03 11:28:08,757 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112808_update_26.json
2025-06-03 11:28:08,758 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:28:08,791 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112808_update_26.pth and as latest_checkpoint.pth
2025-06-03 11:28:08,791 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.0000
2025-06-03 11:28:08,791 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-03 11:28:08,792 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 2.0688, MLP Score: 1.0000
2025-06-03 11:28:08,792 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2536, MLP Score: 1.0000
2025-06-03 11:28:08,792 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.8772, MLP Score: 1.0000
2025-06-03 11:28:08,792 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.7019, MLP Score: 1.0000
2025-06-03 11:28:08,792 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.0769, MLP Score: 1.0000
2025-06-03 11:28:08,792 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:28:08,792 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8592, MLP Score: 0.9994
2025-06-03 11:28:08,792 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.3524, MLP Score: 0.9998
2025-06-03 11:28:08,792 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.4380, MLP Score: 0.9992
2025-06-03 11:28:08,792 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 4.4581, MLP Score: 0.9978
2025-06-03 11:28:08,792 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 6.7030, MLP Score: 0.9993
2025-06-03 11:28:08,793 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:28:08,793 - INFO - Performing visualization of node and edge features.
2025-06-03 11:28:08,793 - INFO - Starting visualization of node features.
2025-06-03 11:28:08,793 - INFO - Graph has 836 nodes and 30 features.
2025-06-03 11:28:08,793 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:28:08,793 - INFO - Calculating feature statistics:
2025-06-03 11:28:08,793 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-3.9926558e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10739667), 'max': np.float32(9.535928)}
2025-06-03 11:28:08,793 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(3.9926558e-08), 'std': np.float32(1.0), 'min': np.float32(-9.535928), 'max': np.float32(0.10739667)}
2025-06-03 11:28:08,794 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3503828), 'max': np.float32(3.121739)}
2025-06-03 11:28:08,794 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-9.12607e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.07962472), 'max': np.float32(16.384254)}
2025-06-03 11:28:08,794 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.6385997), 'max': np.float32(3.4839435)}
2025-06-03 11:28:08,794 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 15, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.64624476), 'max': np.float32(2.8718174)}
2025-06-03 11:28:08,794 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(-3.650428e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8944967), 'max': np.float32(0.6317122)}
2025-06-03 11:28:08,794 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-6.8445525e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08299356), 'max': np.float32(18.016819)}
2025-06-03 11:28:08,794 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(3.4222762e-09), 'std': np.float32(1.0), 'min': np.float32(-4.44375), 'max': np.float32(17.409042)}
2025-06-03 11:28:08,794 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(2.0533658e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.08901521), 'max': np.float32(12.176297)}
2025-06-03 11:28:08,795 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-2.0395062), 'max': np.float32(0.9129791)}
2025-06-03 11:28:08,795 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(1.4829864e-08), 'std': np.float32(1.0), 'min': np.float32(-0.1015617), 'max': np.float32(10.528828)}
2025-06-03 11:28:08,795 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(2.851897e-09), 'std': np.float32(1.0), 'min': np.float32(-7.8218985), 'max': np.float32(0.12999508)}
2025-06-03 11:28:08,795 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-2.3932526), 'max': np.float32(2.2174292)}
2025-06-03 11:28:08,795 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.135334), 'max': np.float32(2.476465)}
2025-06-03 11:28:08,795 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(2.2815174e-09), 'std': np.float32(1.0), 'min': np.float32(-1.5880083), 'max': np.float32(2.9164724)}
2025-06-03 11:28:08,795 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.8107755), 'max': np.float32(1.6221251)}
2025-06-03 11:28:08,796 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,796 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,796 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(-6.8445525e-09), 'std': np.float32(1.0), 'min': np.float32(-7.1788135), 'max': np.float32(0.16000512)}
2025-06-03 11:28:08,796 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,796 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,796 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(3.422276e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.9661887), 'max': np.float32(4.1211643)}
2025-06-03 11:28:08,796 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,796 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,797 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,797 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,797 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,797 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,797 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:28:08,820 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b39c6c680>
2025-06-03 11:28:09,374 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:28:09,442 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:28:09,477 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:28:10,918 - INFO - Node feature visualization saved to vis/node_features_20250603_112809.png
2025-06-03 11:28:10,918 - INFO - Finished visualization of node features.
2025-06-03 11:28:10,918 - INFO - Performing additional feature analysis:
2025-06-03 11:28:10,919 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:28:10,919 - INFO - Starting visualization of edge features.
2025-06-03 11:28:10,919 - INFO - Graph has 1786 edges and 22 edge features.
2025-06-03 11:28:10,919 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:28:10,919 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:28:10,919 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-03 11:28:10,919 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-03 11:28:10,919 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot file.
2025-06-03 11:28:10,936 - INFO - Parsed 845 nodes.
2025-06-03 11:28:10,954 - INFO - Parsed 1818 edges.
2025-06-03 11:28:11,473 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:28:11,474 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:28:11,490 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-03 11:28:11,492 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:28:11,492 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-03 11:28:11,494 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-03 11:28:11,494 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:28:11,505 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:28:11,507 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:28:11,508 - DEBUG - Shape of encoded categorical edge features: torch.Size([1818, 2])
2025-06-03 11:28:11,510 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:28:11,510 - DEBUG - Shape of scaled numerical edge features: torch.Size([1818, 20])
2025-06-03 11:28:11,510 - DEBUG - Final edge attributes tensor shape: torch.Size([1818, 22])
2025-06-03 11:28:11,510 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:28:11,511 - INFO - Performing online update...
2025-06-03 11:28:11,511 - INFO - Starting online update for 50 steps.
2025-06-03 11:28:11,511 - DEBUG - Updated RunningStats: new_mean=0.5680869650815907, new_var=76200000000009.72, new_n=7650
2025-06-03 11:28:11,511 - DEBUG - Updated RunningStats: new_mean=0.5683432988952926, new_var=76500000000007.1, new_n=7680
2025-06-03 11:28:11,512 - DEBUG - Updated RunningStats: new_mean=0.7923606825149799, new_var=43640000000030.625, new_n=4386
2025-06-03 11:28:11,512 - DEBUG - Updated RunningStats: new_mean=0.7934602784664656, new_var=43860000000001.89, new_n=4408
2025-06-03 11:28:11,512 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:28:11,512 - DEBUG - Online update step: 1/50
2025-06-03 11:28:11,516 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:12,105 - DEBUG - Node anomaly scores shape: torch.Size([10188, 1])
2025-06-03 11:28:12,146 - DEBUG - Edge anomaly scores shape: torch.Size([21205, 1])
2025-06-03 11:28:12,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:12,992 - DEBUG - Step 1: Loss=0.6164
2025-06-03 11:28:12,992 - DEBUG - Online update step: 2/50
2025-06-03 11:28:12,995 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:13,510 - DEBUG - Node anomaly scores shape: torch.Size([9212, 1])
2025-06-03 11:28:13,539 - DEBUG - Edge anomaly scores shape: torch.Size([18951, 1])
2025-06-03 11:28:13,540 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:14,358 - DEBUG - Step 2: Loss=0.6679
2025-06-03 11:28:14,359 - DEBUG - Online update step: 3/50
2025-06-03 11:28:14,361 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:14,875 - DEBUG - Node anomaly scores shape: torch.Size([9961, 1])
2025-06-03 11:28:14,911 - DEBUG - Edge anomaly scores shape: torch.Size([20718, 1])
2025-06-03 11:28:14,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:15,809 - DEBUG - Step 3: Loss=0.6439
2025-06-03 11:28:15,810 - DEBUG - Online update step: 4/50
2025-06-03 11:28:15,811 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:16,256 - DEBUG - Node anomaly scores shape: torch.Size([8963, 1])
2025-06-03 11:28:16,283 - DEBUG - Edge anomaly scores shape: torch.Size([18309, 1])
2025-06-03 11:28:16,284 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:16,867 - DEBUG - Step 4: Loss=0.6754
2025-06-03 11:28:16,867 - DEBUG - Online update step: 5/50
2025-06-03 11:28:16,870 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:17,215 - DEBUG - Node anomaly scores shape: torch.Size([9126, 1])
2025-06-03 11:28:17,248 - DEBUG - Edge anomaly scores shape: torch.Size([18707, 1])
2025-06-03 11:28:17,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:17,815 - DEBUG - Step 5: Loss=0.6399
2025-06-03 11:28:17,815 - DEBUG - Online update step: 6/50
2025-06-03 11:28:17,817 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:18,204 - DEBUG - Node anomaly scores shape: torch.Size([9186, 1])
2025-06-03 11:28:18,237 - DEBUG - Edge anomaly scores shape: torch.Size([18801, 1])
2025-06-03 11:28:18,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:18,806 - DEBUG - Step 6: Loss=0.6870
2025-06-03 11:28:18,806 - DEBUG - Online update step: 7/50
2025-06-03 11:28:18,809 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:19,097 - DEBUG - Node anomaly scores shape: torch.Size([8686, 1])
2025-06-03 11:28:19,122 - DEBUG - Edge anomaly scores shape: torch.Size([17798, 1])
2025-06-03 11:28:19,123 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:19,678 - DEBUG - Step 7: Loss=0.6392
2025-06-03 11:28:19,678 - DEBUG - Online update step: 8/50
2025-06-03 11:28:19,680 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:19,984 - DEBUG - Node anomaly scores shape: torch.Size([8552, 1])
2025-06-03 11:28:20,011 - DEBUG - Edge anomaly scores shape: torch.Size([17451, 1])
2025-06-03 11:28:20,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:20,505 - DEBUG - Step 8: Loss=0.6969
2025-06-03 11:28:20,506 - DEBUG - Online update step: 9/50
2025-06-03 11:28:20,508 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:20,843 - DEBUG - Node anomaly scores shape: torch.Size([9109, 1])
2025-06-03 11:28:20,871 - DEBUG - Edge anomaly scores shape: torch.Size([18795, 1])
2025-06-03 11:28:20,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:21,439 - DEBUG - Step 9: Loss=0.6313
2025-06-03 11:28:21,439 - DEBUG - Online update step: 10/50
2025-06-03 11:28:21,442 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:21,791 - DEBUG - Node anomaly scores shape: torch.Size([9204, 1])
2025-06-03 11:28:21,821 - DEBUG - Edge anomaly scores shape: torch.Size([18908, 1])
2025-06-03 11:28:21,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:22,396 - DEBUG - Step 10: Loss=0.6828
2025-06-03 11:28:22,397 - DEBUG - Online update step: 11/50
2025-06-03 11:28:22,398 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:22,750 - DEBUG - Node anomaly scores shape: torch.Size([9342, 1])
2025-06-03 11:28:22,782 - DEBUG - Edge anomaly scores shape: torch.Size([19340, 1])
2025-06-03 11:28:22,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:23,411 - DEBUG - Step 11: Loss=0.6389
2025-06-03 11:28:23,412 - DEBUG - Online update step: 12/50
2025-06-03 11:28:23,415 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:23,774 - DEBUG - Node anomaly scores shape: torch.Size([9114, 1])
2025-06-03 11:28:23,801 - DEBUG - Edge anomaly scores shape: torch.Size([18655, 1])
2025-06-03 11:28:23,802 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:24,391 - DEBUG - Step 12: Loss=0.7112
2025-06-03 11:28:24,391 - DEBUG - Online update step: 13/50
2025-06-03 11:28:24,393 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:24,772 - DEBUG - Node anomaly scores shape: torch.Size([9431, 1])
2025-06-03 11:28:24,804 - DEBUG - Edge anomaly scores shape: torch.Size([19530, 1])
2025-06-03 11:28:24,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:25,453 - DEBUG - Step 13: Loss=0.6887
2025-06-03 11:28:25,453 - DEBUG - Online update step: 14/50
2025-06-03 11:28:25,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:25,811 - DEBUG - Node anomaly scores shape: torch.Size([9042, 1])
2025-06-03 11:28:25,839 - DEBUG - Edge anomaly scores shape: torch.Size([18588, 1])
2025-06-03 11:28:25,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:26,465 - DEBUG - Step 14: Loss=0.6333
2025-06-03 11:28:26,465 - DEBUG - Online update step: 15/50
2025-06-03 11:28:26,467 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:26,865 - DEBUG - Node anomaly scores shape: torch.Size([9729, 1])
2025-06-03 11:28:26,896 - DEBUG - Edge anomaly scores shape: torch.Size([20231, 1])
2025-06-03 11:28:26,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:27,574 - DEBUG - Step 15: Loss=0.6270
2025-06-03 11:28:27,575 - DEBUG - Online update step: 16/50
2025-06-03 11:28:27,577 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:27,959 - DEBUG - Node anomaly scores shape: torch.Size([9184, 1])
2025-06-03 11:28:27,992 - DEBUG - Edge anomaly scores shape: torch.Size([18835, 1])
2025-06-03 11:28:27,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:28,749 - DEBUG - Step 16: Loss=0.8708
2025-06-03 11:28:28,749 - DEBUG - Online update step: 17/50
2025-06-03 11:28:28,752 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:29,203 - DEBUG - Node anomaly scores shape: torch.Size([10126, 1])
2025-06-03 11:28:29,238 - DEBUG - Edge anomaly scores shape: torch.Size([21107, 1])
2025-06-03 11:28:29,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:29,936 - DEBUG - Step 17: Loss=0.8011
2025-06-03 11:28:29,936 - DEBUG - Online update step: 18/50
2025-06-03 11:28:29,938 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:30,315 - DEBUG - Node anomaly scores shape: torch.Size([8680, 1])
2025-06-03 11:28:30,346 - DEBUG - Edge anomaly scores shape: torch.Size([17733, 1])
2025-06-03 11:28:30,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:31,017 - DEBUG - Step 18: Loss=0.8070
2025-06-03 11:28:31,017 - DEBUG - Online update step: 19/50
2025-06-03 11:28:31,019 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:31,504 - DEBUG - Node anomaly scores shape: torch.Size([10185, 1])
2025-06-03 11:28:31,542 - DEBUG - Edge anomaly scores shape: torch.Size([21269, 1])
2025-06-03 11:28:31,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:32,382 - DEBUG - Step 19: Loss=0.7321
2025-06-03 11:28:32,382 - DEBUG - Online update step: 20/50
2025-06-03 11:28:32,385 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:32,822 - DEBUG - Node anomaly scores shape: torch.Size([9275, 1])
2025-06-03 11:28:32,857 - DEBUG - Edge anomaly scores shape: torch.Size([19125, 1])
2025-06-03 11:28:32,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:33,652 - DEBUG - Step 20: Loss=0.8263
2025-06-03 11:28:33,652 - DEBUG - Online update step: 21/50
2025-06-03 11:28:33,656 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:34,144 - DEBUG - Node anomaly scores shape: torch.Size([10008, 1])
2025-06-03 11:28:34,185 - DEBUG - Edge anomaly scores shape: torch.Size([20885, 1])
2025-06-03 11:28:34,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:34,929 - DEBUG - Step 21: Loss=0.8416
2025-06-03 11:28:34,929 - DEBUG - Online update step: 22/50
2025-06-03 11:28:34,931 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:35,392 - DEBUG - Node anomaly scores shape: torch.Size([9172, 1])
2025-06-03 11:28:35,427 - DEBUG - Edge anomaly scores shape: torch.Size([18920, 1])
2025-06-03 11:28:35,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:36,143 - DEBUG - Step 22: Loss=0.7752
2025-06-03 11:28:36,143 - DEBUG - Online update step: 23/50
2025-06-03 11:28:36,145 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:36,596 - DEBUG - Node anomaly scores shape: torch.Size([9365, 1])
2025-06-03 11:28:36,643 - DEBUG - Edge anomaly scores shape: torch.Size([19352, 1])
2025-06-03 11:28:36,645 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:37,428 - DEBUG - Step 23: Loss=0.6964
2025-06-03 11:28:37,429 - DEBUG - Online update step: 24/50
2025-06-03 11:28:37,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:37,911 - DEBUG - Node anomaly scores shape: torch.Size([9808, 1])
2025-06-03 11:28:37,951 - DEBUG - Edge anomaly scores shape: torch.Size([20472, 1])
2025-06-03 11:28:37,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:38,706 - DEBUG - Step 24: Loss=0.6982
2025-06-03 11:28:38,707 - DEBUG - Online update step: 25/50
2025-06-03 11:28:38,709 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:39,173 - DEBUG - Node anomaly scores shape: torch.Size([9760, 1])
2025-06-03 11:28:39,214 - DEBUG - Edge anomaly scores shape: torch.Size([20155, 1])
2025-06-03 11:28:39,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:39,952 - DEBUG - Step 25: Loss=0.6540
2025-06-03 11:28:39,953 - DEBUG - Online update step: 26/50
2025-06-03 11:28:39,955 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:40,370 - DEBUG - Node anomaly scores shape: torch.Size([9796, 1])
2025-06-03 11:28:40,408 - DEBUG - Edge anomaly scores shape: torch.Size([20421, 1])
2025-06-03 11:28:40,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:41,309 - DEBUG - Step 26: Loss=0.6618
2025-06-03 11:28:41,309 - DEBUG - Online update step: 27/50
2025-06-03 11:28:41,313 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:41,727 - DEBUG - Node anomaly scores shape: torch.Size([9505, 1])
2025-06-03 11:28:41,774 - DEBUG - Edge anomaly scores shape: torch.Size([19698, 1])
2025-06-03 11:28:41,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:42,491 - DEBUG - Step 27: Loss=0.6607
2025-06-03 11:28:42,492 - DEBUG - Online update step: 28/50
2025-06-03 11:28:42,494 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:42,935 - DEBUG - Node anomaly scores shape: torch.Size([10112, 1])
2025-06-03 11:28:42,974 - DEBUG - Edge anomaly scores shape: torch.Size([21200, 1])
2025-06-03 11:28:42,975 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:43,817 - DEBUG - Step 28: Loss=0.6329
2025-06-03 11:28:43,817 - DEBUG - Online update step: 29/50
2025-06-03 11:28:43,819 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:44,330 - DEBUG - Node anomaly scores shape: torch.Size([10564, 1])
2025-06-03 11:28:44,371 - DEBUG - Edge anomaly scores shape: torch.Size([22074, 1])
2025-06-03 11:28:44,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:45,293 - DEBUG - Step 29: Loss=0.9299
2025-06-03 11:28:45,293 - DEBUG - Online update step: 30/50
2025-06-03 11:28:45,295 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:45,654 - DEBUG - Node anomaly scores shape: torch.Size([8452, 1])
2025-06-03 11:28:45,687 - DEBUG - Edge anomaly scores shape: torch.Size([17214, 1])
2025-06-03 11:28:45,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:46,330 - DEBUG - Step 30: Loss=0.9288
2025-06-03 11:28:46,330 - DEBUG - Online update step: 31/50
2025-06-03 11:28:46,335 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:46,754 - DEBUG - Node anomaly scores shape: torch.Size([10004, 1])
2025-06-03 11:28:46,785 - DEBUG - Edge anomaly scores shape: torch.Size([20934, 1])
2025-06-03 11:28:46,786 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:47,442 - DEBUG - Step 31: Loss=0.6171
2025-06-03 11:28:47,443 - DEBUG - Online update step: 32/50
2025-06-03 11:28:47,444 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:47,779 - DEBUG - Node anomaly scores shape: torch.Size([9509, 1])
2025-06-03 11:28:47,813 - DEBUG - Edge anomaly scores shape: torch.Size([19735, 1])
2025-06-03 11:28:47,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:48,473 - DEBUG - Step 32: Loss=0.8551
2025-06-03 11:28:48,474 - DEBUG - Online update step: 33/50
2025-06-03 11:28:48,476 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:48,800 - DEBUG - Node anomaly scores shape: torch.Size([8833, 1])
2025-06-03 11:28:48,829 - DEBUG - Edge anomaly scores shape: torch.Size([18084, 1])
2025-06-03 11:28:48,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:49,367 - DEBUG - Step 33: Loss=1.0289
2025-06-03 11:28:49,367 - DEBUG - Online update step: 34/50
2025-06-03 11:28:49,370 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:49,778 - DEBUG - Node anomaly scores shape: torch.Size([10391, 1])
2025-06-03 11:28:49,817 - DEBUG - Edge anomaly scores shape: torch.Size([21747, 1])
2025-06-03 11:28:49,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:50,610 - DEBUG - Step 34: Loss=0.8151
2025-06-03 11:28:50,610 - DEBUG - Online update step: 35/50
2025-06-03 11:28:50,611 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:51,032 - DEBUG - Node anomaly scores shape: torch.Size([10700, 1])
2025-06-03 11:28:51,064 - DEBUG - Edge anomaly scores shape: torch.Size([22445, 1])
2025-06-03 11:28:51,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:51,734 - DEBUG - Step 35: Loss=0.6825
2025-06-03 11:28:51,734 - DEBUG - Online update step: 36/50
2025-06-03 11:28:51,737 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:52,127 - DEBUG - Node anomaly scores shape: torch.Size([10236, 1])
2025-06-03 11:28:52,159 - DEBUG - Edge anomaly scores shape: torch.Size([21461, 1])
2025-06-03 11:28:52,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:52,780 - DEBUG - Step 36: Loss=1.1172
2025-06-03 11:28:52,780 - DEBUG - Online update step: 37/50
2025-06-03 11:28:52,782 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:53,135 - DEBUG - Node anomaly scores shape: torch.Size([10010, 1])
2025-06-03 11:28:53,165 - DEBUG - Edge anomaly scores shape: torch.Size([20755, 1])
2025-06-03 11:28:53,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:53,772 - DEBUG - Step 37: Loss=1.3442
2025-06-03 11:28:53,772 - DEBUG - Online update step: 38/50
2025-06-03 11:28:53,775 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:54,116 - DEBUG - Node anomaly scores shape: torch.Size([9405, 1])
2025-06-03 11:28:54,144 - DEBUG - Edge anomaly scores shape: torch.Size([19491, 1])
2025-06-03 11:28:54,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:54,739 - DEBUG - Step 38: Loss=1.0642
2025-06-03 11:28:54,739 - DEBUG - Online update step: 39/50
2025-06-03 11:28:54,742 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:55,075 - DEBUG - Node anomaly scores shape: torch.Size([9011, 1])
2025-06-03 11:28:55,103 - DEBUG - Edge anomaly scores shape: torch.Size([18521, 1])
2025-06-03 11:28:55,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:55,705 - DEBUG - Step 39: Loss=0.6967
2025-06-03 11:28:55,705 - DEBUG - Online update step: 40/50
2025-06-03 11:28:55,710 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:56,071 - DEBUG - Node anomaly scores shape: torch.Size([9414, 1])
2025-06-03 11:28:56,100 - DEBUG - Edge anomaly scores shape: torch.Size([19405, 1])
2025-06-03 11:28:56,101 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:56,646 - DEBUG - Step 40: Loss=0.7424
2025-06-03 11:28:56,646 - DEBUG - Online update step: 41/50
2025-06-03 11:28:56,649 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:57,028 - DEBUG - Node anomaly scores shape: torch.Size([9822, 1])
2025-06-03 11:28:57,056 - DEBUG - Edge anomaly scores shape: torch.Size([20335, 1])
2025-06-03 11:28:57,057 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:57,705 - DEBUG - Step 41: Loss=0.7001
2025-06-03 11:28:57,706 - DEBUG - Online update step: 42/50
2025-06-03 11:28:57,707 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:58,085 - DEBUG - Node anomaly scores shape: torch.Size([9755, 1])
2025-06-03 11:28:58,118 - DEBUG - Edge anomaly scores shape: torch.Size([20328, 1])
2025-06-03 11:28:58,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:58,782 - DEBUG - Step 42: Loss=0.6583
2025-06-03 11:28:58,782 - DEBUG - Online update step: 43/50
2025-06-03 11:28:58,784 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:28:59,154 - DEBUG - Node anomaly scores shape: torch.Size([9790, 1])
2025-06-03 11:28:59,185 - DEBUG - Edge anomaly scores shape: torch.Size([20392, 1])
2025-06-03 11:28:59,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:28:59,819 - DEBUG - Step 43: Loss=0.6526
2025-06-03 11:28:59,819 - DEBUG - Online update step: 44/50
2025-06-03 11:28:59,822 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:00,195 - DEBUG - Node anomaly scores shape: torch.Size([9390, 1])
2025-06-03 11:29:00,227 - DEBUG - Edge anomaly scores shape: torch.Size([19357, 1])
2025-06-03 11:29:00,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:00,888 - DEBUG - Step 44: Loss=0.6901
2025-06-03 11:29:00,889 - DEBUG - Online update step: 45/50
2025-06-03 11:29:00,893 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:01,288 - DEBUG - Node anomaly scores shape: torch.Size([9695, 1])
2025-06-03 11:29:01,319 - DEBUG - Edge anomaly scores shape: torch.Size([20100, 1])
2025-06-03 11:29:01,320 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:02,018 - DEBUG - Step 45: Loss=0.7135
2025-06-03 11:29:02,019 - DEBUG - Online update step: 46/50
2025-06-03 11:29:02,021 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:02,367 - DEBUG - Node anomaly scores shape: torch.Size([9594, 1])
2025-06-03 11:29:02,397 - DEBUG - Edge anomaly scores shape: torch.Size([19910, 1])
2025-06-03 11:29:02,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:03,079 - DEBUG - Step 46: Loss=0.6149
2025-06-03 11:29:03,079 - DEBUG - Online update step: 47/50
2025-06-03 11:29:03,082 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:03,478 - DEBUG - Node anomaly scores shape: torch.Size([10211, 1])
2025-06-03 11:29:03,511 - DEBUG - Edge anomaly scores shape: torch.Size([21397, 1])
2025-06-03 11:29:03,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:04,181 - DEBUG - Step 47: Loss=1.1208
2025-06-03 11:29:04,182 - DEBUG - Online update step: 48/50
2025-06-03 11:29:04,185 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:04,568 - DEBUG - Node anomaly scores shape: torch.Size([9872, 1])
2025-06-03 11:29:04,603 - DEBUG - Edge anomaly scores shape: torch.Size([20558, 1])
2025-06-03 11:29:04,604 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:05,277 - DEBUG - Step 48: Loss=1.3197
2025-06-03 11:29:05,277 - DEBUG - Online update step: 49/50
2025-06-03 11:29:05,279 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:05,655 - DEBUG - Node anomaly scores shape: torch.Size([9786, 1])
2025-06-03 11:29:05,689 - DEBUG - Edge anomaly scores shape: torch.Size([20346, 1])
2025-06-03 11:29:05,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:06,371 - DEBUG - Step 49: Loss=0.9266
2025-06-03 11:29:06,372 - DEBUG - Online update step: 50/50
2025-06-03 11:29:06,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:06,719 - DEBUG - Node anomaly scores shape: torch.Size([8996, 1])
2025-06-03 11:29:06,752 - DEBUG - Edge anomaly scores shape: torch.Size([18451, 1])
2025-06-03 11:29:06,753 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:07,469 - DEBUG - Step 50: Loss=0.9442
2025-06-03 11:29:07,470 - INFO - Online update finished. Average loss: 0.7740, Learning rate: 0.002982
2025-06-03 11:29:07,471 - DEBUG - Current node mean: [ 3.1601044e-08 -3.1601044e-08  3.6115477e-08  3.3858261e-09
 -2.2572173e-08 -2.4829390e-08  2.9343825e-08 -1.1286087e-09
  1.3543304e-08  1.7493434e-08  2.0314955e-08  1.3543304e-08
 -4.1194216e-08  4.5144346e-09  2.2572173e-09  1.6364826e-08
 -4.5144346e-09  0.0000000e+00  0.0000000e+00  3.4563641e-09
  0.0000000e+00  0.0000000e+00 -2.7086609e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4174918e+00  4.9939494e+00  1.0491467e-09  2.0982933e-09
  1.0491467e-09 -5.2457332e-09 -4.1965866e-09 -2.0982933e-09
  2.6228666e-09  1.0491467e-09  8.3931733e-09  2.0982933e-09
  4.1965866e-09 -1.4688053e-08  1.3638907e-08 -2.0982933e-09
 -2.0982933e-09 -2.0982933e-09 -2.0982933e-09 -2.0982933e-09
 -2.0982933e-09 -1.0491467e-09]
2025-06-03 11:29:07,471 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0073
2025-06-03 11:29:07,472 - INFO - Online update complete. Loss: 0.7740
2025-06-03 11:29:07,472 - INFO - Running anomaly detection...
2025-06-03 11:29:07,473 - INFO - Starting anomaly detection.
2025-06-03 11:29:07,491 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_112907_update_27.json
2025-06-03 11:29:07,492 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:29:07,532 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_112907_update_27.pth and as latest_checkpoint.pth
2025-06-03 11:29:07,532 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.0000
2025-06-03 11:29:07,533 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 11:29:07,533 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.8289, MLP Score: 1.0000
2025-06-03 11:29:07,533 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1671, MLP Score: 1.0000
2025-06-03 11:29:07,533 - WARNING -   Node ID: ff02::2, Recon Error: 0.8688, MLP Score: 1.0000
2025-06-03 11:29:07,533 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.6497, MLP Score: 1.0000
2025-06-03 11:29:07,533 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.4475, MLP Score: 1.0000
2025-06-03 11:29:07,533 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:29:07,533 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8918, MLP Score: 0.9997
2025-06-03 11:29:07,533 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.9817, MLP Score: 0.9999
2025-06-03 11:29:07,533 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.4169, MLP Score: 0.9980
2025-06-03 11:29:07,533 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.2767, MLP Score: 0.9978
2025-06-03 11:29:07,533 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 6.9853, MLP Score: 0.9992
2025-06-03 11:29:07,533 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-03 11:29:07,533 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-03 11:29:07,533 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot file.
2025-06-03 11:29:07,554 - INFO - Parsed 866 nodes.
2025-06-03 11:29:07,576 - INFO - Parsed 1848 edges.
2025-06-03 11:29:08,099 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:29:08,099 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:29:08,114 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-03 11:29:08,115 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:29:08,115 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-03 11:29:08,117 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-03 11:29:08,117 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:29:08,133 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:29:08,134 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:29:08,135 - DEBUG - Shape of encoded categorical edge features: torch.Size([1848, 2])
2025-06-03 11:29:08,137 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:29:08,137 - DEBUG - Shape of scaled numerical edge features: torch.Size([1848, 20])
2025-06-03 11:29:08,137 - DEBUG - Final edge attributes tensor shape: torch.Size([1848, 22])
2025-06-03 11:29:08,137 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:29:08,137 - INFO - Performing online update...
2025-06-03 11:29:08,137 - INFO - Starting online update for 50 steps.
2025-06-03 11:29:08,138 - DEBUG - Updated RunningStats: new_mean=0.566131846364552, new_var=76800000000009.66, new_n=7710
2025-06-03 11:29:08,138 - DEBUG - Updated RunningStats: new_mean=0.5663937358348217, new_var=77100000000007.11, new_n=7740
2025-06-03 11:29:08,138 - DEBUG - Updated RunningStats: new_mean=0.790964636695305, new_var=44080000000030.55, new_n=4430
2025-06-03 11:29:08,138 - DEBUG - Updated RunningStats: new_mean=0.7920624553356646, new_var=44300000000001.92, new_n=4452
2025-06-03 11:29:08,138 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:29:08,138 - DEBUG - Online update step: 1/50
2025-06-03 11:29:08,139 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:08,583 - DEBUG - Node anomaly scores shape: torch.Size([10069, 1])
2025-06-03 11:29:08,623 - DEBUG - Edge anomaly scores shape: torch.Size([20960, 1])
2025-06-03 11:29:08,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:09,447 - DEBUG - Step 1: Loss=0.9328
2025-06-03 11:29:09,448 - DEBUG - Online update step: 2/50
2025-06-03 11:29:09,451 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:09,845 - DEBUG - Node anomaly scores shape: torch.Size([9391, 1])
2025-06-03 11:29:09,878 - DEBUG - Edge anomaly scores shape: torch.Size([19374, 1])
2025-06-03 11:29:09,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:10,557 - DEBUG - Step 2: Loss=1.0257
2025-06-03 11:29:10,557 - DEBUG - Online update step: 3/50
2025-06-03 11:29:10,559 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:11,007 - DEBUG - Node anomaly scores shape: torch.Size([9972, 1])
2025-06-03 11:29:11,045 - DEBUG - Edge anomaly scores shape: torch.Size([20681, 1])
2025-06-03 11:29:11,046 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:11,729 - DEBUG - Step 3: Loss=1.0081
2025-06-03 11:29:11,730 - DEBUG - Online update step: 4/50
2025-06-03 11:29:11,733 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:12,109 - DEBUG - Node anomaly scores shape: torch.Size([8985, 1])
2025-06-03 11:29:12,142 - DEBUG - Edge anomaly scores shape: torch.Size([18418, 1])
2025-06-03 11:29:12,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:12,816 - DEBUG - Step 4: Loss=0.6903
2025-06-03 11:29:12,816 - DEBUG - Online update step: 5/50
2025-06-03 11:29:12,819 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:13,201 - DEBUG - Node anomaly scores shape: torch.Size([9078, 1])
2025-06-03 11:29:13,237 - DEBUG - Edge anomaly scores shape: torch.Size([18679, 1])
2025-06-03 11:29:13,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:13,912 - DEBUG - Step 5: Loss=0.9988
2025-06-03 11:29:13,912 - DEBUG - Online update step: 6/50
2025-06-03 11:29:13,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:14,354 - DEBUG - Node anomaly scores shape: torch.Size([10242, 1])
2025-06-03 11:29:14,391 - DEBUG - Edge anomaly scores shape: torch.Size([21344, 1])
2025-06-03 11:29:14,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:15,146 - DEBUG - Step 6: Loss=1.4292
2025-06-03 11:29:15,147 - DEBUG - Online update step: 7/50
2025-06-03 11:29:15,150 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:15,524 - DEBUG - Node anomaly scores shape: torch.Size([9196, 1])
2025-06-03 11:29:15,558 - DEBUG - Edge anomaly scores shape: torch.Size([18960, 1])
2025-06-03 11:29:15,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:16,209 - DEBUG - Step 7: Loss=1.1852
2025-06-03 11:29:16,210 - DEBUG - Online update step: 8/50
2025-06-03 11:29:16,212 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:16,571 - DEBUG - Node anomaly scores shape: torch.Size([8772, 1])
2025-06-03 11:29:16,605 - DEBUG - Edge anomaly scores shape: torch.Size([17939, 1])
2025-06-03 11:29:16,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:17,256 - DEBUG - Step 8: Loss=1.0835
2025-06-03 11:29:17,257 - DEBUG - Online update step: 9/50
2025-06-03 11:29:17,259 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:17,642 - DEBUG - Node anomaly scores shape: torch.Size([9217, 1])
2025-06-03 11:29:17,679 - DEBUG - Edge anomaly scores shape: torch.Size([18970, 1])
2025-06-03 11:29:17,680 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:18,388 - DEBUG - Step 9: Loss=1.0642
2025-06-03 11:29:18,388 - DEBUG - Online update step: 10/50
2025-06-03 11:29:18,390 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:18,784 - DEBUG - Node anomaly scores shape: torch.Size([9375, 1])
2025-06-03 11:29:18,816 - DEBUG - Edge anomaly scores shape: torch.Size([19327, 1])
2025-06-03 11:29:18,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:19,399 - DEBUG - Step 10: Loss=0.8242
2025-06-03 11:29:19,399 - DEBUG - Online update step: 11/50
2025-06-03 11:29:19,401 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:19,721 - DEBUG - Node anomaly scores shape: torch.Size([9589, 1])
2025-06-03 11:29:19,749 - DEBUG - Edge anomaly scores shape: torch.Size([19861, 1])
2025-06-03 11:29:19,749 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:20,327 - DEBUG - Step 11: Loss=0.8813
2025-06-03 11:29:20,327 - DEBUG - Online update step: 12/50
2025-06-03 11:29:20,329 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:20,672 - DEBUG - Node anomaly scores shape: torch.Size([9749, 1])
2025-06-03 11:29:20,700 - DEBUG - Edge anomaly scores shape: torch.Size([20099, 1])
2025-06-03 11:29:20,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:21,202 - DEBUG - Step 12: Loss=1.3488
2025-06-03 11:29:21,202 - DEBUG - Online update step: 13/50
2025-06-03 11:29:21,205 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:21,537 - DEBUG - Node anomaly scores shape: torch.Size([9599, 1])
2025-06-03 11:29:21,566 - DEBUG - Edge anomaly scores shape: torch.Size([19776, 1])
2025-06-03 11:29:21,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:22,142 - DEBUG - Step 13: Loss=1.4011
2025-06-03 11:29:22,143 - DEBUG - Online update step: 14/50
2025-06-03 11:29:22,145 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:22,503 - DEBUG - Node anomaly scores shape: torch.Size([10219, 1])
2025-06-03 11:29:22,535 - DEBUG - Edge anomaly scores shape: torch.Size([21243, 1])
2025-06-03 11:29:22,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:23,150 - DEBUG - Step 14: Loss=0.7624
2025-06-03 11:29:23,150 - DEBUG - Online update step: 15/50
2025-06-03 11:29:23,151 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:23,486 - DEBUG - Node anomaly scores shape: torch.Size([9589, 1])
2025-06-03 11:29:23,514 - DEBUG - Edge anomaly scores shape: torch.Size([19807, 1])
2025-06-03 11:29:23,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:24,083 - DEBUG - Step 15: Loss=0.7470
2025-06-03 11:29:24,083 - DEBUG - Online update step: 16/50
2025-06-03 11:29:24,085 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:24,422 - DEBUG - Node anomaly scores shape: torch.Size([9782, 1])
2025-06-03 11:29:24,452 - DEBUG - Edge anomaly scores shape: torch.Size([20369, 1])
2025-06-03 11:29:24,453 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:25,046 - DEBUG - Step 16: Loss=0.9532
2025-06-03 11:29:25,046 - DEBUG - Online update step: 17/50
2025-06-03 11:29:25,048 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:25,426 - DEBUG - Node anomaly scores shape: torch.Size([10466, 1])
2025-06-03 11:29:25,458 - DEBUG - Edge anomaly scores shape: torch.Size([21882, 1])
2025-06-03 11:29:25,459 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:26,088 - DEBUG - Step 17: Loss=0.7619
2025-06-03 11:29:26,088 - DEBUG - Online update step: 18/50
2025-06-03 11:29:26,090 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:26,416 - DEBUG - Node anomaly scores shape: torch.Size([9161, 1])
2025-06-03 11:29:26,446 - DEBUG - Edge anomaly scores shape: torch.Size([18866, 1])
2025-06-03 11:29:26,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:27,026 - DEBUG - Step 18: Loss=0.6290
2025-06-03 11:29:27,027 - DEBUG - Online update step: 19/50
2025-06-03 11:29:27,029 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:27,400 - DEBUG - Node anomaly scores shape: torch.Size([10550, 1])
2025-06-03 11:29:27,432 - DEBUG - Edge anomaly scores shape: torch.Size([22067, 1])
2025-06-03 11:29:27,433 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:28,097 - DEBUG - Step 19: Loss=0.7667
2025-06-03 11:29:28,097 - DEBUG - Online update step: 20/50
2025-06-03 11:29:28,100 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:28,436 - DEBUG - Node anomaly scores shape: torch.Size([9350, 1])
2025-06-03 11:29:28,463 - DEBUG - Edge anomaly scores shape: torch.Size([19317, 1])
2025-06-03 11:29:28,464 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:28,982 - DEBUG - Step 20: Loss=0.6999
2025-06-03 11:29:28,982 - DEBUG - Online update step: 21/50
2025-06-03 11:29:28,984 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:29,296 - DEBUG - Node anomaly scores shape: torch.Size([9075, 1])
2025-06-03 11:29:29,323 - DEBUG - Edge anomaly scores shape: torch.Size([18625, 1])
2025-06-03 11:29:29,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:29,856 - DEBUG - Step 21: Loss=0.6695
2025-06-03 11:29:29,857 - DEBUG - Online update step: 22/50
2025-06-03 11:29:29,860 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:30,215 - DEBUG - Node anomaly scores shape: torch.Size([9654, 1])
2025-06-03 11:29:30,245 - DEBUG - Edge anomaly scores shape: torch.Size([20010, 1])
2025-06-03 11:29:30,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:30,895 - DEBUG - Step 22: Loss=0.7483
2025-06-03 11:29:30,896 - DEBUG - Online update step: 23/50
2025-06-03 11:29:30,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:31,421 - DEBUG - Node anomaly scores shape: torch.Size([9921, 1])
2025-06-03 11:29:31,464 - DEBUG - Edge anomaly scores shape: torch.Size([20634, 1])
2025-06-03 11:29:31,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:32,174 - DEBUG - Step 23: Loss=0.6541
2025-06-03 11:29:32,174 - DEBUG - Online update step: 24/50
2025-06-03 11:29:32,178 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:32,572 - DEBUG - Node anomaly scores shape: torch.Size([9651, 1])
2025-06-03 11:29:32,602 - DEBUG - Edge anomaly scores shape: torch.Size([20110, 1])
2025-06-03 11:29:32,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:33,228 - DEBUG - Step 24: Loss=0.7047
2025-06-03 11:29:33,228 - DEBUG - Online update step: 25/50
2025-06-03 11:29:33,231 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:33,566 - DEBUG - Node anomaly scores shape: torch.Size([9344, 1])
2025-06-03 11:29:33,604 - DEBUG - Edge anomaly scores shape: torch.Size([19182, 1])
2025-06-03 11:29:33,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:34,202 - DEBUG - Step 25: Loss=0.7255
2025-06-03 11:29:34,202 - DEBUG - Online update step: 26/50
2025-06-03 11:29:34,206 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:34,602 - DEBUG - Node anomaly scores shape: torch.Size([10528, 1])
2025-06-03 11:29:34,636 - DEBUG - Edge anomaly scores shape: torch.Size([22056, 1])
2025-06-03 11:29:34,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:35,286 - DEBUG - Step 26: Loss=0.6376
2025-06-03 11:29:35,287 - DEBUG - Online update step: 27/50
2025-06-03 11:29:35,289 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:35,624 - DEBUG - Node anomaly scores shape: torch.Size([9066, 1])
2025-06-03 11:29:35,653 - DEBUG - Edge anomaly scores shape: torch.Size([18595, 1])
2025-06-03 11:29:35,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:36,245 - DEBUG - Step 27: Loss=0.7074
2025-06-03 11:29:36,245 - DEBUG - Online update step: 28/50
2025-06-03 11:29:36,247 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:36,638 - DEBUG - Node anomaly scores shape: torch.Size([9820, 1])
2025-06-03 11:29:36,678 - DEBUG - Edge anomaly scores shape: torch.Size([20388, 1])
2025-06-03 11:29:36,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:37,428 - DEBUG - Step 28: Loss=0.6633
2025-06-03 11:29:37,429 - DEBUG - Online update step: 29/50
2025-06-03 11:29:37,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:37,838 - DEBUG - Node anomaly scores shape: torch.Size([10441, 1])
2025-06-03 11:29:37,879 - DEBUG - Edge anomaly scores shape: torch.Size([21814, 1])
2025-06-03 11:29:37,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:38,649 - DEBUG - Step 29: Loss=0.6522
2025-06-03 11:29:38,649 - DEBUG - Online update step: 30/50
2025-06-03 11:29:38,651 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:39,013 - DEBUG - Node anomaly scores shape: torch.Size([9501, 1])
2025-06-03 11:29:39,050 - DEBUG - Edge anomaly scores shape: torch.Size([19633, 1])
2025-06-03 11:29:39,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:39,790 - DEBUG - Step 30: Loss=0.7099
2025-06-03 11:29:39,790 - DEBUG - Online update step: 31/50
2025-06-03 11:29:39,792 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:40,223 - DEBUG - Node anomaly scores shape: torch.Size([10195, 1])
2025-06-03 11:29:40,262 - DEBUG - Edge anomaly scores shape: torch.Size([21333, 1])
2025-06-03 11:29:40,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:41,119 - DEBUG - Step 31: Loss=0.6228
2025-06-03 11:29:41,119 - DEBUG - Online update step: 32/50
2025-06-03 11:29:41,123 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:41,529 - DEBUG - Node anomaly scores shape: torch.Size([9460, 1])
2025-06-03 11:29:41,576 - DEBUG - Edge anomaly scores shape: torch.Size([19466, 1])
2025-06-03 11:29:41,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:42,320 - DEBUG - Step 32: Loss=0.7100
2025-06-03 11:29:42,320 - DEBUG - Online update step: 33/50
2025-06-03 11:29:42,322 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:42,724 - DEBUG - Node anomaly scores shape: torch.Size([9003, 1])
2025-06-03 11:29:42,758 - DEBUG - Edge anomaly scores shape: torch.Size([18597, 1])
2025-06-03 11:29:42,759 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:43,511 - DEBUG - Step 33: Loss=0.7237
2025-06-03 11:29:43,512 - DEBUG - Online update step: 34/50
2025-06-03 11:29:43,515 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:43,995 - DEBUG - Node anomaly scores shape: torch.Size([9438, 1])
2025-06-03 11:29:44,030 - DEBUG - Edge anomaly scores shape: torch.Size([19536, 1])
2025-06-03 11:29:44,031 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:44,796 - DEBUG - Step 34: Loss=0.6389
2025-06-03 11:29:44,796 - DEBUG - Online update step: 35/50
2025-06-03 11:29:44,800 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:45,288 - DEBUG - Node anomaly scores shape: torch.Size([10860, 1])
2025-06-03 11:29:45,334 - DEBUG - Edge anomaly scores shape: torch.Size([22872, 1])
2025-06-03 11:29:45,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:46,516 - DEBUG - Step 35: Loss=0.7805
2025-06-03 11:29:46,517 - DEBUG - Online update step: 36/50
2025-06-03 11:29:46,519 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:47,045 - DEBUG - Node anomaly scores shape: torch.Size([9931, 1])
2025-06-03 11:29:47,084 - DEBUG - Edge anomaly scores shape: torch.Size([20758, 1])
2025-06-03 11:29:47,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:47,861 - DEBUG - Step 36: Loss=0.9308
2025-06-03 11:29:47,861 - DEBUG - Online update step: 37/50
2025-06-03 11:29:47,865 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:48,210 - DEBUG - Node anomaly scores shape: torch.Size([9735, 1])
2025-06-03 11:29:48,241 - DEBUG - Edge anomaly scores shape: torch.Size([20055, 1])
2025-06-03 11:29:48,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:48,860 - DEBUG - Step 37: Loss=0.6544
2025-06-03 11:29:48,861 - DEBUG - Online update step: 38/50
2025-06-03 11:29:48,863 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:49,211 - DEBUG - Node anomaly scores shape: torch.Size([10056, 1])
2025-06-03 11:29:49,241 - DEBUG - Edge anomaly scores shape: torch.Size([21015, 1])
2025-06-03 11:29:49,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:49,843 - DEBUG - Step 38: Loss=0.7030
2025-06-03 11:29:49,844 - DEBUG - Online update step: 39/50
2025-06-03 11:29:49,845 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:50,167 - DEBUG - Node anomaly scores shape: torch.Size([9451, 1])
2025-06-03 11:29:50,196 - DEBUG - Edge anomaly scores shape: torch.Size([19572, 1])
2025-06-03 11:29:50,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:50,737 - DEBUG - Step 39: Loss=0.7902
2025-06-03 11:29:50,737 - DEBUG - Online update step: 40/50
2025-06-03 11:29:50,740 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:51,107 - DEBUG - Node anomaly scores shape: torch.Size([9995, 1])
2025-06-03 11:29:51,136 - DEBUG - Edge anomaly scores shape: torch.Size([20780, 1])
2025-06-03 11:29:51,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:51,746 - DEBUG - Step 40: Loss=0.7214
2025-06-03 11:29:51,746 - DEBUG - Online update step: 41/50
2025-06-03 11:29:51,748 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:52,128 - DEBUG - Node anomaly scores shape: torch.Size([9590, 1])
2025-06-03 11:29:52,160 - DEBUG - Edge anomaly scores shape: torch.Size([19928, 1])
2025-06-03 11:29:52,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:52,732 - DEBUG - Step 41: Loss=0.6177
2025-06-03 11:29:52,733 - DEBUG - Online update step: 42/50
2025-06-03 11:29:52,735 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:53,078 - DEBUG - Node anomaly scores shape: torch.Size([9559, 1])
2025-06-03 11:29:53,108 - DEBUG - Edge anomaly scores shape: torch.Size([19755, 1])
2025-06-03 11:29:53,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:53,658 - DEBUG - Step 42: Loss=0.9870
2025-06-03 11:29:53,658 - DEBUG - Online update step: 43/50
2025-06-03 11:29:53,660 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:54,000 - DEBUG - Node anomaly scores shape: torch.Size([9630, 1])
2025-06-03 11:29:54,030 - DEBUG - Edge anomaly scores shape: torch.Size([19890, 1])
2025-06-03 11:29:54,031 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:54,576 - DEBUG - Step 43: Loss=1.3365
2025-06-03 11:29:54,576 - DEBUG - Online update step: 44/50
2025-06-03 11:29:54,577 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:54,875 - DEBUG - Node anomaly scores shape: torch.Size([8779, 1])
2025-06-03 11:29:54,900 - DEBUG - Edge anomaly scores shape: torch.Size([17893, 1])
2025-06-03 11:29:54,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:55,462 - DEBUG - Step 44: Loss=0.9679
2025-06-03 11:29:55,462 - DEBUG - Online update step: 45/50
2025-06-03 11:29:55,464 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:55,843 - DEBUG - Node anomaly scores shape: torch.Size([10437, 1])
2025-06-03 11:29:55,879 - DEBUG - Edge anomaly scores shape: torch.Size([21784, 1])
2025-06-03 11:29:55,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:56,627 - DEBUG - Step 45: Loss=0.6744
2025-06-03 11:29:56,627 - DEBUG - Online update step: 46/50
2025-06-03 11:29:56,629 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:56,959 - DEBUG - Node anomaly scores shape: torch.Size([9019, 1])
2025-06-03 11:29:56,987 - DEBUG - Edge anomaly scores shape: torch.Size([18541, 1])
2025-06-03 11:29:56,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:29:57,767 - DEBUG - Step 46: Loss=0.7788
2025-06-03 11:29:57,767 - DEBUG - Online update step: 47/50
2025-06-03 11:29:57,775 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:29:58,519 - DEBUG - Node anomaly scores shape: torch.Size([10180, 1])
2025-06-03 11:29:58,550 - DEBUG - Edge anomaly scores shape: torch.Size([21258, 1])
2025-06-03 11:29:58,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:00,579 - DEBUG - Step 47: Loss=0.7908
2025-06-03 11:30:00,579 - DEBUG - Online update step: 48/50
2025-06-03 11:30:00,660 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:03,000 - DEBUG - Node anomaly scores shape: torch.Size([9662, 1])
2025-06-03 11:30:03,203 - DEBUG - Edge anomaly scores shape: torch.Size([19997, 1])
2025-06-03 11:30:03,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:05,060 - DEBUG - Step 48: Loss=0.8657
2025-06-03 11:30:05,060 - DEBUG - Online update step: 49/50
2025-06-03 11:30:05,063 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:05,531 - DEBUG - Node anomaly scores shape: torch.Size([9292, 1])
2025-06-03 11:30:05,574 - DEBUG - Edge anomaly scores shape: torch.Size([19187, 1])
2025-06-03 11:30:05,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:06,606 - DEBUG - Step 49: Loss=0.8499
2025-06-03 11:30:06,606 - DEBUG - Online update step: 50/50
2025-06-03 11:30:06,612 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:07,205 - DEBUG - Node anomaly scores shape: torch.Size([9167, 1])
2025-06-03 11:30:07,249 - DEBUG - Edge anomaly scores shape: torch.Size([18903, 1])
2025-06-03 11:30:07,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:08,197 - DEBUG - Step 50: Loss=0.6342
2025-06-03 11:30:08,197 - INFO - Online update finished. Average loss: 0.8369, Learning rate: 0.002927
2025-06-03 11:30:08,198 - DEBUG - Current node mean: [-5.1758306e-08  5.1758306e-08 -4.1021210e-08 -1.4316127e-08
 -3.6340939e-08 -1.0461785e-08 -1.7619849e-08  1.3214887e-08
  1.4316127e-08 -1.2664266e-08 -1.2113646e-08  3.1935976e-08
 -3.3037217e-09  3.3037217e-09  2.0372950e-08 -1.1012405e-08
  3.0834734e-08  0.0000000e+00  0.0000000e+00 -5.5062027e-10
  0.0000000e+00  0.0000000e+00  2.7531014e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4117966e+00  4.9886365e+00  1.0321151e-09  4.6445177e-09
  5.1605753e-10  5.1605753e-10 -4.1284602e-09 -1.0321151e-09
  0.0000000e+00  5.1605753e-10  2.5802876e-08 -5.1605755e-09
  0.0000000e+00 -8.7729779e-09 -1.3933553e-08  2.0642301e-09
  2.0642301e-09  2.0642301e-09  2.0642301e-09  2.0642301e-09
  2.0642301e-09  4.1284602e-09]
2025-06-03 11:30:08,198 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0112
2025-06-03 11:30:08,199 - INFO - Online update complete. Loss: 0.8369
2025-06-03 11:30:08,199 - INFO - Running anomaly detection...
2025-06-03 11:30:08,200 - INFO - Starting anomaly detection.
2025-06-03 11:30:08,248 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113008_update_28.json
2025-06-03 11:30:08,248 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:30:08,281 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113008_update_28.pth and as latest_checkpoint.pth
2025-06-03 11:30:08,282 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.0000
2025-06-03 11:30:08,282 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 11:30:08,282 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.4293, MLP Score: 1.0000
2025-06-03 11:30:08,282 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.7468, MLP Score: 1.0000
2025-06-03 11:30:08,282 - WARNING -   Node ID: ff02::2, Recon Error: 0.5299, MLP Score: 1.0000
2025-06-03 11:30:08,282 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0057, MLP Score: 1.0000
2025-06-03 11:30:08,282 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9318, MLP Score: 1.0000
2025-06-03 11:30:08,282 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:30:08,282 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.4162, MLP Score: 0.9999
2025-06-03 11:30:08,282 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.8866, MLP Score: 1.0000
2025-06-03 11:30:08,283 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.3953, MLP Score: 1.0000
2025-06-03 11:30:08,283 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3661, MLP Score: 0.9997
2025-06-03 11:30:08,283 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.0996, MLP Score: 0.9998
2025-06-03 11:30:08,283 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-03 11:30:08,283 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-03 11:30:08,283 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot file.
2025-06-03 11:30:08,311 - INFO - Parsed 894 nodes.
2025-06-03 11:30:08,341 - INFO - Parsed 1887 edges.
2025-06-03 11:30:09,093 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:30:09,093 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:30:09,113 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-03 11:30:09,116 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:30:09,121 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-03 11:30:09,129 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-03 11:30:09,129 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:30:09,141 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:30:09,142 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:30:09,144 - DEBUG - Shape of encoded categorical edge features: torch.Size([1887, 2])
2025-06-03 11:30:09,146 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:30:09,150 - DEBUG - Shape of scaled numerical edge features: torch.Size([1887, 20])
2025-06-03 11:30:09,153 - DEBUG - Final edge attributes tensor shape: torch.Size([1887, 22])
2025-06-03 11:30:09,153 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:30:09,153 - INFO - Performing online update...
2025-06-03 11:30:09,154 - INFO - Starting online update for 50 steps.
2025-06-03 11:30:09,154 - DEBUG - Updated RunningStats: new_mean=0.5642068874355969, new_var=77400000000009.6, new_n=7770
2025-06-03 11:30:09,155 - DEBUG - Updated RunningStats: new_mean=0.5644741218758148, new_var=77700000000007.11, new_n=7800
2025-06-03 11:30:09,155 - DEBUG - Updated RunningStats: new_mean=0.7897534445525788, new_var=44520000000036.85, new_n=4474
2025-06-03 11:30:09,155 - DEBUG - Updated RunningStats: new_mean=0.7909334395509784, new_var=44740000000002.87, new_n=4496
2025-06-03 11:30:09,155 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:30:09,155 - DEBUG - Online update step: 1/50
2025-06-03 11:30:09,157 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:09,801 - DEBUG - Node anomaly scores shape: torch.Size([9109, 1])
2025-06-03 11:30:09,849 - DEBUG - Edge anomaly scores shape: torch.Size([18688, 1])
2025-06-03 11:30:09,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:10,935 - DEBUG - Step 1: Loss=0.6535
2025-06-03 11:30:10,935 - DEBUG - Online update step: 2/50
2025-06-03 11:30:10,938 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:11,590 - DEBUG - Node anomaly scores shape: torch.Size([9160, 1])
2025-06-03 11:30:11,638 - DEBUG - Edge anomaly scores shape: torch.Size([18903, 1])
2025-06-03 11:30:11,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:12,762 - DEBUG - Step 2: Loss=0.6785
2025-06-03 11:30:12,763 - DEBUG - Online update step: 3/50
2025-06-03 11:30:12,769 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:13,546 - DEBUG - Node anomaly scores shape: torch.Size([10753, 1])
2025-06-03 11:30:13,598 - DEBUG - Edge anomaly scores shape: torch.Size([22522, 1])
2025-06-03 11:30:13,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:15,010 - DEBUG - Step 3: Loss=0.6720
2025-06-03 11:30:15,011 - DEBUG - Online update step: 4/50
2025-06-03 11:30:15,013 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:15,569 - DEBUG - Node anomaly scores shape: torch.Size([8845, 1])
2025-06-03 11:30:15,607 - DEBUG - Edge anomaly scores shape: torch.Size([18041, 1])
2025-06-03 11:30:15,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:16,389 - DEBUG - Step 4: Loss=0.6835
2025-06-03 11:30:16,389 - DEBUG - Online update step: 5/50
2025-06-03 11:30:16,393 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:17,005 - DEBUG - Node anomaly scores shape: torch.Size([10761, 1])
2025-06-03 11:30:17,047 - DEBUG - Edge anomaly scores shape: torch.Size([22507, 1])
2025-06-03 11:30:17,048 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:17,970 - DEBUG - Step 5: Loss=0.6674
2025-06-03 11:30:17,971 - DEBUG - Online update step: 6/50
2025-06-03 11:30:17,974 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:18,517 - DEBUG - Node anomaly scores shape: torch.Size([9375, 1])
2025-06-03 11:30:18,556 - DEBUG - Edge anomaly scores shape: torch.Size([19270, 1])
2025-06-03 11:30:18,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:19,400 - DEBUG - Step 6: Loss=0.7336
2025-06-03 11:30:19,401 - DEBUG - Online update step: 7/50
2025-06-03 11:30:19,405 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:19,945 - DEBUG - Node anomaly scores shape: torch.Size([9779, 1])
2025-06-03 11:30:19,982 - DEBUG - Edge anomaly scores shape: torch.Size([20284, 1])
2025-06-03 11:30:19,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:20,864 - DEBUG - Step 7: Loss=0.6529
2025-06-03 11:30:20,864 - DEBUG - Online update step: 8/50
2025-06-03 11:30:20,866 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:21,418 - DEBUG - Node anomaly scores shape: torch.Size([10306, 1])
2025-06-03 11:30:21,456 - DEBUG - Edge anomaly scores shape: torch.Size([21418, 1])
2025-06-03 11:30:21,459 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:22,349 - DEBUG - Step 8: Loss=0.7258
2025-06-03 11:30:22,351 - DEBUG - Online update step: 9/50
2025-06-03 11:30:22,353 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:22,966 - DEBUG - Node anomaly scores shape: torch.Size([10710, 1])
2025-06-03 11:30:23,011 - DEBUG - Edge anomaly scores shape: torch.Size([22575, 1])
2025-06-03 11:30:23,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:23,887 - DEBUG - Step 9: Loss=0.7637
2025-06-03 11:30:23,888 - DEBUG - Online update step: 10/50
2025-06-03 11:30:23,892 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:24,495 - DEBUG - Node anomaly scores shape: torch.Size([11097, 1])
2025-06-03 11:30:24,542 - DEBUG - Edge anomaly scores shape: torch.Size([23345, 1])
2025-06-03 11:30:24,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:25,502 - DEBUG - Step 10: Loss=0.6473
2025-06-03 11:30:25,502 - DEBUG - Online update step: 11/50
2025-06-03 11:30:25,504 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:26,061 - DEBUG - Node anomaly scores shape: torch.Size([10592, 1])
2025-06-03 11:30:26,114 - DEBUG - Edge anomaly scores shape: torch.Size([22090, 1])
2025-06-03 11:30:26,117 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:26,987 - DEBUG - Step 11: Loss=0.9501
2025-06-03 11:30:26,988 - DEBUG - Online update step: 12/50
2025-06-03 11:30:26,992 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:27,513 - DEBUG - Node anomaly scores shape: torch.Size([9437, 1])
2025-06-03 11:30:27,553 - DEBUG - Edge anomaly scores shape: torch.Size([19412, 1])
2025-06-03 11:30:27,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:28,297 - DEBUG - Step 12: Loss=1.1504
2025-06-03 11:30:28,298 - DEBUG - Online update step: 13/50
2025-06-03 11:30:28,301 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:28,844 - DEBUG - Node anomaly scores shape: torch.Size([9981, 1])
2025-06-03 11:30:28,890 - DEBUG - Edge anomaly scores shape: torch.Size([20622, 1])
2025-06-03 11:30:28,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:29,849 - DEBUG - Step 13: Loss=0.8725
2025-06-03 11:30:29,850 - DEBUG - Online update step: 14/50
2025-06-03 11:30:29,853 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:30,365 - DEBUG - Node anomaly scores shape: torch.Size([8968, 1])
2025-06-03 11:30:30,400 - DEBUG - Edge anomaly scores shape: torch.Size([18420, 1])
2025-06-03 11:30:30,401 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:31,195 - DEBUG - Step 14: Loss=0.6872
2025-06-03 11:30:31,195 - DEBUG - Online update step: 15/50
2025-06-03 11:30:31,199 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:31,758 - DEBUG - Node anomaly scores shape: torch.Size([9235, 1])
2025-06-03 11:30:31,803 - DEBUG - Edge anomaly scores shape: torch.Size([18994, 1])
2025-06-03 11:30:31,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:32,654 - DEBUG - Step 15: Loss=0.7364
2025-06-03 11:30:32,654 - DEBUG - Online update step: 16/50
2025-06-03 11:30:32,660 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:33,282 - DEBUG - Node anomaly scores shape: torch.Size([9630, 1])
2025-06-03 11:30:33,335 - DEBUG - Edge anomaly scores shape: torch.Size([19956, 1])
2025-06-03 11:30:33,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:34,384 - DEBUG - Step 16: Loss=0.6531
2025-06-03 11:30:34,385 - DEBUG - Online update step: 17/50
2025-06-03 11:30:34,390 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:35,030 - DEBUG - Node anomaly scores shape: torch.Size([9965, 1])
2025-06-03 11:30:35,078 - DEBUG - Edge anomaly scores shape: torch.Size([20662, 1])
2025-06-03 11:30:35,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:36,219 - DEBUG - Step 17: Loss=0.8448
2025-06-03 11:30:36,220 - DEBUG - Online update step: 18/50
2025-06-03 11:30:36,227 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:36,912 - DEBUG - Node anomaly scores shape: torch.Size([9852, 1])
2025-06-03 11:30:36,962 - DEBUG - Edge anomaly scores shape: torch.Size([20477, 1])
2025-06-03 11:30:36,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:38,057 - DEBUG - Step 18: Loss=0.9423
2025-06-03 11:30:38,057 - DEBUG - Online update step: 19/50
2025-06-03 11:30:38,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:38,801 - DEBUG - Node anomaly scores shape: torch.Size([10737, 1])
2025-06-03 11:30:38,859 - DEBUG - Edge anomaly scores shape: torch.Size([22484, 1])
2025-06-03 11:30:38,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:40,183 - DEBUG - Step 19: Loss=0.6646
2025-06-03 11:30:40,184 - DEBUG - Online update step: 20/50
2025-06-03 11:30:40,186 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:40,795 - DEBUG - Node anomaly scores shape: torch.Size([9153, 1])
2025-06-03 11:30:40,841 - DEBUG - Edge anomaly scores shape: torch.Size([18778, 1])
2025-06-03 11:30:40,844 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:41,997 - DEBUG - Step 20: Loss=0.7745
2025-06-03 11:30:41,997 - DEBUG - Online update step: 21/50
2025-06-03 11:30:42,002 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:42,647 - DEBUG - Node anomaly scores shape: torch.Size([9724, 1])
2025-06-03 11:30:42,700 - DEBUG - Edge anomaly scores shape: torch.Size([20158, 1])
2025-06-03 11:30:42,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:43,730 - DEBUG - Step 21: Loss=0.8315
2025-06-03 11:30:43,730 - DEBUG - Online update step: 22/50
2025-06-03 11:30:43,733 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:44,132 - DEBUG - Node anomaly scores shape: torch.Size([8820, 1])
2025-06-03 11:30:44,169 - DEBUG - Edge anomaly scores shape: torch.Size([18110, 1])
2025-06-03 11:30:44,170 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:44,989 - DEBUG - Step 22: Loss=0.7901
2025-06-03 11:30:44,990 - DEBUG - Online update step: 23/50
2025-06-03 11:30:44,992 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:45,527 - DEBUG - Node anomaly scores shape: torch.Size([9182, 1])
2025-06-03 11:30:45,568 - DEBUG - Edge anomaly scores shape: torch.Size([18851, 1])
2025-06-03 11:30:45,569 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:46,377 - DEBUG - Step 23: Loss=0.6515
2025-06-03 11:30:46,377 - DEBUG - Online update step: 24/50
2025-06-03 11:30:46,380 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:46,951 - DEBUG - Node anomaly scores shape: torch.Size([10007, 1])
2025-06-03 11:30:46,991 - DEBUG - Edge anomaly scores shape: torch.Size([20778, 1])
2025-06-03 11:30:46,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:47,869 - DEBUG - Step 24: Loss=1.3007
2025-06-03 11:30:47,870 - DEBUG - Online update step: 25/50
2025-06-03 11:30:47,873 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:48,374 - DEBUG - Node anomaly scores shape: torch.Size([9399, 1])
2025-06-03 11:30:48,411 - DEBUG - Edge anomaly scores shape: torch.Size([19373, 1])
2025-06-03 11:30:48,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:49,205 - DEBUG - Step 25: Loss=1.5116
2025-06-03 11:30:49,205 - DEBUG - Online update step: 26/50
2025-06-03 11:30:49,208 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:49,732 - DEBUG - Node anomaly scores shape: torch.Size([9735, 1])
2025-06-03 11:30:49,768 - DEBUG - Edge anomaly scores shape: torch.Size([20188, 1])
2025-06-03 11:30:49,770 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:50,612 - DEBUG - Step 26: Loss=1.3332
2025-06-03 11:30:50,613 - DEBUG - Online update step: 27/50
2025-06-03 11:30:50,617 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:51,079 - DEBUG - Node anomaly scores shape: torch.Size([9199, 1])
2025-06-03 11:30:51,113 - DEBUG - Edge anomaly scores shape: torch.Size([19004, 1])
2025-06-03 11:30:51,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:51,887 - DEBUG - Step 27: Loss=0.7207
2025-06-03 11:30:51,887 - DEBUG - Online update step: 28/50
2025-06-03 11:30:51,889 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:52,396 - DEBUG - Node anomaly scores shape: torch.Size([9929, 1])
2025-06-03 11:30:52,433 - DEBUG - Edge anomaly scores shape: torch.Size([20640, 1])
2025-06-03 11:30:52,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:53,307 - DEBUG - Step 28: Loss=0.7910
2025-06-03 11:30:53,307 - DEBUG - Online update step: 29/50
2025-06-03 11:30:53,312 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:53,803 - DEBUG - Node anomaly scores shape: torch.Size([9432, 1])
2025-06-03 11:30:53,838 - DEBUG - Edge anomaly scores shape: torch.Size([19478, 1])
2025-06-03 11:30:53,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:54,779 - DEBUG - Step 29: Loss=0.9709
2025-06-03 11:30:54,779 - DEBUG - Online update step: 30/50
2025-06-03 11:30:54,783 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:55,385 - DEBUG - Node anomaly scores shape: torch.Size([9808, 1])
2025-06-03 11:30:55,422 - DEBUG - Edge anomaly scores shape: torch.Size([20425, 1])
2025-06-03 11:30:55,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:56,348 - DEBUG - Step 30: Loss=1.5628
2025-06-03 11:30:56,348 - DEBUG - Online update step: 31/50
2025-06-03 11:30:56,351 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:56,919 - DEBUG - Node anomaly scores shape: torch.Size([10108, 1])
2025-06-03 11:30:56,957 - DEBUG - Edge anomaly scores shape: torch.Size([21063, 1])
2025-06-03 11:30:56,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:57,980 - DEBUG - Step 31: Loss=0.7637
2025-06-03 11:30:57,980 - DEBUG - Online update step: 32/50
2025-06-03 11:30:57,985 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:30:58,601 - DEBUG - Node anomaly scores shape: torch.Size([10319, 1])
2025-06-03 11:30:58,658 - DEBUG - Edge anomaly scores shape: torch.Size([21524, 1])
2025-06-03 11:30:58,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:30:59,620 - DEBUG - Step 32: Loss=0.6793
2025-06-03 11:30:59,621 - DEBUG - Online update step: 33/50
2025-06-03 11:30:59,624 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:00,244 - DEBUG - Node anomaly scores shape: torch.Size([10433, 1])
2025-06-03 11:31:00,297 - DEBUG - Edge anomaly scores shape: torch.Size([21846, 1])
2025-06-03 11:31:00,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:01,437 - DEBUG - Step 33: Loss=0.9720
2025-06-03 11:31:01,437 - DEBUG - Online update step: 34/50
2025-06-03 11:31:01,441 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:02,057 - DEBUG - Node anomaly scores shape: torch.Size([9787, 1])
2025-06-03 11:31:02,101 - DEBUG - Edge anomaly scores shape: torch.Size([20252, 1])
2025-06-03 11:31:02,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:03,099 - DEBUG - Step 34: Loss=0.8431
2025-06-03 11:31:03,100 - DEBUG - Online update step: 35/50
2025-06-03 11:31:03,104 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:03,763 - DEBUG - Node anomaly scores shape: torch.Size([9945, 1])
2025-06-03 11:31:03,809 - DEBUG - Edge anomaly scores shape: torch.Size([20650, 1])
2025-06-03 11:31:03,812 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:05,026 - DEBUG - Step 35: Loss=0.6488
2025-06-03 11:31:05,026 - DEBUG - Online update step: 36/50
2025-06-03 11:31:05,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:05,641 - DEBUG - Node anomaly scores shape: torch.Size([8803, 1])
2025-06-03 11:31:05,686 - DEBUG - Edge anomaly scores shape: torch.Size([17958, 1])
2025-06-03 11:31:05,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:06,758 - DEBUG - Step 36: Loss=0.6744
2025-06-03 11:31:06,758 - DEBUG - Online update step: 37/50
2025-06-03 11:31:06,761 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:07,262 - DEBUG - Node anomaly scores shape: torch.Size([10492, 1])
2025-06-03 11:31:07,300 - DEBUG - Edge anomaly scores shape: torch.Size([21895, 1])
2025-06-03 11:31:07,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:08,129 - DEBUG - Step 37: Loss=0.6298
2025-06-03 11:31:08,129 - DEBUG - Online update step: 38/50
2025-06-03 11:31:08,131 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:08,570 - DEBUG - Node anomaly scores shape: torch.Size([9870, 1])
2025-06-03 11:31:08,605 - DEBUG - Edge anomaly scores shape: torch.Size([20467, 1])
2025-06-03 11:31:08,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:09,352 - DEBUG - Step 38: Loss=0.6207
2025-06-03 11:31:09,352 - DEBUG - Online update step: 39/50
2025-06-03 11:31:09,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:09,855 - DEBUG - Node anomaly scores shape: torch.Size([11381, 1])
2025-06-03 11:31:09,897 - DEBUG - Edge anomaly scores shape: torch.Size([23971, 1])
2025-06-03 11:31:09,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:10,911 - DEBUG - Step 39: Loss=0.6534
2025-06-03 11:31:10,912 - DEBUG - Online update step: 40/50
2025-06-03 11:31:10,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:11,322 - DEBUG - Node anomaly scores shape: torch.Size([9975, 1])
2025-06-03 11:31:11,362 - DEBUG - Edge anomaly scores shape: torch.Size([20768, 1])
2025-06-03 11:31:11,363 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:12,170 - DEBUG - Step 40: Loss=0.6260
2025-06-03 11:31:12,171 - DEBUG - Online update step: 41/50
2025-06-03 11:31:12,173 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:12,569 - DEBUG - Node anomaly scores shape: torch.Size([9637, 1])
2025-06-03 11:31:12,605 - DEBUG - Edge anomaly scores shape: torch.Size([19949, 1])
2025-06-03 11:31:12,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:13,379 - DEBUG - Step 41: Loss=0.6457
2025-06-03 11:31:13,380 - DEBUG - Online update step: 42/50
2025-06-03 11:31:13,382 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:13,810 - DEBUG - Node anomaly scores shape: torch.Size([9767, 1])
2025-06-03 11:31:13,846 - DEBUG - Edge anomaly scores shape: torch.Size([20247, 1])
2025-06-03 11:31:13,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:14,645 - DEBUG - Step 42: Loss=0.6247
2025-06-03 11:31:14,645 - DEBUG - Online update step: 43/50
2025-06-03 11:31:14,648 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:15,039 - DEBUG - Node anomaly scores shape: torch.Size([9536, 1])
2025-06-03 11:31:15,075 - DEBUG - Edge anomaly scores shape: torch.Size([19623, 1])
2025-06-03 11:31:15,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:15,873 - DEBUG - Step 43: Loss=0.6541
2025-06-03 11:31:15,874 - DEBUG - Online update step: 44/50
2025-06-03 11:31:15,877 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:16,386 - DEBUG - Node anomaly scores shape: torch.Size([11159, 1])
2025-06-03 11:31:16,431 - DEBUG - Edge anomaly scores shape: torch.Size([23529, 1])
2025-06-03 11:31:16,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:17,351 - DEBUG - Step 44: Loss=0.6332
2025-06-03 11:31:17,352 - DEBUG - Online update step: 45/50
2025-06-03 11:31:17,355 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:17,863 - DEBUG - Node anomaly scores shape: torch.Size([11013, 1])
2025-06-03 11:31:17,904 - DEBUG - Edge anomaly scores shape: torch.Size([23119, 1])
2025-06-03 11:31:17,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:18,839 - DEBUG - Step 45: Loss=0.8161
2025-06-03 11:31:18,839 - DEBUG - Online update step: 46/50
2025-06-03 11:31:18,841 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:19,289 - DEBUG - Node anomaly scores shape: torch.Size([10316, 1])
2025-06-03 11:31:19,327 - DEBUG - Edge anomaly scores shape: torch.Size([21578, 1])
2025-06-03 11:31:19,328 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:20,036 - DEBUG - Step 46: Loss=0.8798
2025-06-03 11:31:20,037 - DEBUG - Online update step: 47/50
2025-06-03 11:31:20,039 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:20,393 - DEBUG - Node anomaly scores shape: torch.Size([10110, 1])
2025-06-03 11:31:20,426 - DEBUG - Edge anomaly scores shape: torch.Size([21146, 1])
2025-06-03 11:31:20,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:21,096 - DEBUG - Step 47: Loss=0.6629
2025-06-03 11:31:21,097 - DEBUG - Online update step: 48/50
2025-06-03 11:31:21,099 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:21,448 - DEBUG - Node anomaly scores shape: torch.Size([10371, 1])
2025-06-03 11:31:21,489 - DEBUG - Edge anomaly scores shape: torch.Size([21688, 1])
2025-06-03 11:31:21,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:22,192 - DEBUG - Step 48: Loss=0.7215
2025-06-03 11:31:22,192 - DEBUG - Online update step: 49/50
2025-06-03 11:31:22,198 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:22,507 - DEBUG - Node anomaly scores shape: torch.Size([9414, 1])
2025-06-03 11:31:22,535 - DEBUG - Edge anomaly scores shape: torch.Size([19489, 1])
2025-06-03 11:31:22,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:23,192 - DEBUG - Step 49: Loss=0.7161
2025-06-03 11:31:23,192 - DEBUG - Online update step: 50/50
2025-06-03 11:31:23,194 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:23,535 - DEBUG - Node anomaly scores shape: torch.Size([9403, 1])
2025-06-03 11:31:23,566 - DEBUG - Edge anomaly scores shape: torch.Size([19431, 1])
2025-06-03 11:31:23,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:24,152 - DEBUG - Step 50: Loss=0.6883
2025-06-03 11:31:24,152 - INFO - Online update finished. Average loss: 0.7954, Learning rate: 0.002837
2025-06-03 11:31:24,153 - DEBUG - Current node mean: [-1.2800998e-08  1.2800998e-08 -4.0536491e-08 -4.2669992e-09
 -3.3069245e-08  1.0667498e-08  3.0935745e-08  8.5339984e-09
  8.5339984e-09 -1.8134747e-08  2.5601995e-08  7.4672482e-09
 -6.4004988e-09  4.2669992e-09 -2.3468495e-08 -1.0667498e-08
  8.5339984e-09  0.0000000e+00  0.0000000e+00  2.9868993e-08
  0.0000000e+00  0.0000000e+00  1.5201184e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4091150e+00  5.6857448e+00  3.0323508e-09  5.0539178e-10
 -5.0539178e-10  4.0431343e-09  6.0647016e-09 -3.0323508e-09
 -7.0754851e-09  2.5269589e-09  2.0721064e-08 -3.0323508e-09
  2.0215671e-09  2.9312725e-08 -6.0647016e-09  1.0107836e-09
  1.0107836e-09  1.0107836e-09  1.0107836e-09  1.0107836e-09
  1.0107836e-09  0.0000000e+00]
2025-06-03 11:31:24,153 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.3921
2025-06-03 11:31:24,153 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 11:31:24,164 - INFO - Online update complete. Loss: 0.7954
2025-06-03 11:31:24,164 - INFO - Running anomaly detection...
2025-06-03 11:31:24,165 - INFO - Starting anomaly detection.
2025-06-03 11:31:24,181 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113124_update_29.json
2025-06-03 11:31:24,181 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:31:24,207 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113124_update_29.pth and as latest_checkpoint.pth
2025-06-03 11:31:24,208 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.0000
2025-06-03 11:31:24,208 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-03 11:31:24,208 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.3672, MLP Score: 1.0000
2025-06-03 11:31:24,208 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.0823, MLP Score: 1.0000
2025-06-03 11:31:24,208 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.2046, MLP Score: 1.0000
2025-06-03 11:31:24,208 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.4708, MLP Score: 1.0000
2025-06-03 11:31:24,208 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.4663, MLP Score: 1.0000
2025-06-03 11:31:24,208 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:31:24,208 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.3165, MLP Score: 0.9997
2025-06-03 11:31:24,208 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.9433, MLP Score: 0.9998
2025-06-03 11:31:24,208 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.8632, MLP Score: 0.9965
2025-06-03 11:31:24,208 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3089, MLP Score: 0.9998
2025-06-03 11:31:24,208 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.0501, MLP Score: 0.9997
2025-06-03 11:31:24,208 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-03 11:31:24,208 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-03 11:31:24,208 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot file.
2025-06-03 11:31:24,225 - INFO - Parsed 901 nodes.
2025-06-03 11:31:24,242 - INFO - Parsed 1907 edges.
2025-06-03 11:31:24,742 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:31:24,742 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:31:24,757 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-03 11:31:24,759 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:31:24,759 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-03 11:31:24,760 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-03 11:31:24,760 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:31:24,769 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:31:24,770 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:31:24,772 - DEBUG - Shape of encoded categorical edge features: torch.Size([1907, 2])
2025-06-03 11:31:24,773 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:31:24,773 - DEBUG - Shape of scaled numerical edge features: torch.Size([1907, 20])
2025-06-03 11:31:24,773 - DEBUG - Final edge attributes tensor shape: torch.Size([1907, 22])
2025-06-03 11:31:24,773 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:31:24,773 - INFO - Performing online update...
2025-06-03 11:31:24,774 - INFO - Starting online update for 50 steps.
2025-06-03 11:31:24,774 - DEBUG - Updated RunningStats: new_mean=0.5623113857701344, new_var=78000000000009.52, new_n=7830
2025-06-03 11:31:24,774 - DEBUG - Updated RunningStats: new_mean=0.5625838044663706, new_var=78300000000007.12, new_n=7860
2025-06-03 11:31:24,774 - DEBUG - Updated RunningStats: new_mean=0.7886526575124572, new_var=44960000000036.86, new_n=4518
2025-06-03 11:31:24,775 - DEBUG - Updated RunningStats: new_mean=0.789826302000413, new_var=45180000000002.87, new_n=4540
2025-06-03 11:31:24,775 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:31:24,775 - DEBUG - Online update step: 1/50
2025-06-03 11:31:24,776 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:25,157 - DEBUG - Node anomaly scores shape: torch.Size([9357, 1])
2025-06-03 11:31:25,186 - DEBUG - Edge anomaly scores shape: torch.Size([19395, 1])
2025-06-03 11:31:25,187 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:25,849 - DEBUG - Step 1: Loss=0.6429
2025-06-03 11:31:25,850 - DEBUG - Online update step: 2/50
2025-06-03 11:31:25,852 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:26,194 - DEBUG - Node anomaly scores shape: torch.Size([9865, 1])
2025-06-03 11:31:26,224 - DEBUG - Edge anomaly scores shape: torch.Size([20553, 1])
2025-06-03 11:31:26,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:26,911 - DEBUG - Step 2: Loss=0.7249
2025-06-03 11:31:26,911 - DEBUG - Online update step: 3/50
2025-06-03 11:31:26,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:27,281 - DEBUG - Node anomaly scores shape: torch.Size([10377, 1])
2025-06-03 11:31:27,314 - DEBUG - Edge anomaly scores shape: torch.Size([21518, 1])
2025-06-03 11:31:27,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:28,037 - DEBUG - Step 3: Loss=0.7057
2025-06-03 11:31:28,037 - DEBUG - Online update step: 4/50
2025-06-03 11:31:28,038 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:28,423 - DEBUG - Node anomaly scores shape: torch.Size([10675, 1])
2025-06-03 11:31:28,457 - DEBUG - Edge anomaly scores shape: torch.Size([22295, 1])
2025-06-03 11:31:28,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:29,188 - DEBUG - Step 4: Loss=0.6692
2025-06-03 11:31:29,188 - DEBUG - Online update step: 5/50
2025-06-03 11:31:29,190 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:29,526 - DEBUG - Node anomaly scores shape: torch.Size([9459, 1])
2025-06-03 11:31:29,554 - DEBUG - Edge anomaly scores shape: torch.Size([19464, 1])
2025-06-03 11:31:29,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:30,168 - DEBUG - Step 5: Loss=0.7853
2025-06-03 11:31:30,168 - DEBUG - Online update step: 6/50
2025-06-03 11:31:30,171 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:30,521 - DEBUG - Node anomaly scores shape: torch.Size([10172, 1])
2025-06-03 11:31:30,553 - DEBUG - Edge anomaly scores shape: torch.Size([21225, 1])
2025-06-03 11:31:30,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:31,303 - DEBUG - Step 6: Loss=0.7816
2025-06-03 11:31:31,303 - DEBUG - Online update step: 7/50
2025-06-03 11:31:31,306 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:31,733 - DEBUG - Node anomaly scores shape: torch.Size([10671, 1])
2025-06-03 11:31:31,765 - DEBUG - Edge anomaly scores shape: torch.Size([22233, 1])
2025-06-03 11:31:31,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:32,511 - DEBUG - Step 7: Loss=0.6261
2025-06-03 11:31:32,511 - DEBUG - Online update step: 8/50
2025-06-03 11:31:32,513 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:32,857 - DEBUG - Node anomaly scores shape: torch.Size([9329, 1])
2025-06-03 11:31:32,888 - DEBUG - Edge anomaly scores shape: torch.Size([19122, 1])
2025-06-03 11:31:32,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:33,568 - DEBUG - Step 8: Loss=0.8288
2025-06-03 11:31:33,568 - DEBUG - Online update step: 9/50
2025-06-03 11:31:33,571 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:33,914 - DEBUG - Node anomaly scores shape: torch.Size([8900, 1])
2025-06-03 11:31:33,943 - DEBUG - Edge anomaly scores shape: torch.Size([18251, 1])
2025-06-03 11:31:33,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:34,585 - DEBUG - Step 9: Loss=0.8984
2025-06-03 11:31:34,585 - DEBUG - Online update step: 10/50
2025-06-03 11:31:34,588 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:34,973 - DEBUG - Node anomaly scores shape: torch.Size([10224, 1])
2025-06-03 11:31:35,005 - DEBUG - Edge anomaly scores shape: torch.Size([21229, 1])
2025-06-03 11:31:35,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:35,700 - DEBUG - Step 10: Loss=0.7117
2025-06-03 11:31:35,700 - DEBUG - Online update step: 11/50
2025-06-03 11:31:35,702 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:36,181 - DEBUG - Node anomaly scores shape: torch.Size([11656, 1])
2025-06-03 11:31:36,222 - DEBUG - Edge anomaly scores shape: torch.Size([24604, 1])
2025-06-03 11:31:36,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:37,120 - DEBUG - Step 11: Loss=0.6544
2025-06-03 11:31:37,121 - DEBUG - Online update step: 12/50
2025-06-03 11:31:37,123 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:37,547 - DEBUG - Node anomaly scores shape: torch.Size([10346, 1])
2025-06-03 11:31:37,583 - DEBUG - Edge anomaly scores shape: torch.Size([21560, 1])
2025-06-03 11:31:37,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:38,381 - DEBUG - Step 12: Loss=0.8516
2025-06-03 11:31:38,381 - DEBUG - Online update step: 13/50
2025-06-03 11:31:38,383 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:38,754 - DEBUG - Node anomaly scores shape: torch.Size([9216, 1])
2025-06-03 11:31:38,787 - DEBUG - Edge anomaly scores shape: torch.Size([18873, 1])
2025-06-03 11:31:38,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:39,584 - DEBUG - Step 13: Loss=0.7807
2025-06-03 11:31:39,584 - DEBUG - Online update step: 14/50
2025-06-03 11:31:39,586 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:40,047 - DEBUG - Node anomaly scores shape: torch.Size([9953, 1])
2025-06-03 11:31:40,083 - DEBUG - Edge anomaly scores shape: torch.Size([20519, 1])
2025-06-03 11:31:40,084 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:40,952 - DEBUG - Step 14: Loss=0.6858
2025-06-03 11:31:40,952 - DEBUG - Online update step: 15/50
2025-06-03 11:31:40,955 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:41,304 - DEBUG - Node anomaly scores shape: torch.Size([8419, 1])
2025-06-03 11:31:41,335 - DEBUG - Edge anomaly scores shape: torch.Size([17051, 1])
2025-06-03 11:31:41,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:42,136 - DEBUG - Step 15: Loss=0.7139
2025-06-03 11:31:42,136 - DEBUG - Online update step: 16/50
2025-06-03 11:31:42,138 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:42,539 - DEBUG - Node anomaly scores shape: torch.Size([9716, 1])
2025-06-03 11:31:42,576 - DEBUG - Edge anomaly scores shape: torch.Size([20211, 1])
2025-06-03 11:31:42,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:43,413 - DEBUG - Step 16: Loss=0.6877
2025-06-03 11:31:43,413 - DEBUG - Online update step: 17/50
2025-06-03 11:31:43,417 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:43,845 - DEBUG - Node anomaly scores shape: torch.Size([10505, 1])
2025-06-03 11:31:43,876 - DEBUG - Edge anomaly scores shape: torch.Size([21817, 1])
2025-06-03 11:31:43,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:44,587 - DEBUG - Step 17: Loss=0.6962
2025-06-03 11:31:44,587 - DEBUG - Online update step: 18/50
2025-06-03 11:31:44,590 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:44,957 - DEBUG - Node anomaly scores shape: torch.Size([10078, 1])
2025-06-03 11:31:44,989 - DEBUG - Edge anomaly scores shape: torch.Size([21091, 1])
2025-06-03 11:31:44,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:45,708 - DEBUG - Step 18: Loss=0.6879
2025-06-03 11:31:45,709 - DEBUG - Online update step: 19/50
2025-06-03 11:31:45,710 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:46,045 - DEBUG - Node anomaly scores shape: torch.Size([9105, 1])
2025-06-03 11:31:46,073 - DEBUG - Edge anomaly scores shape: torch.Size([18704, 1])
2025-06-03 11:31:46,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:46,733 - DEBUG - Step 19: Loss=0.7271
2025-06-03 11:31:46,733 - DEBUG - Online update step: 20/50
2025-06-03 11:31:46,734 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:47,059 - DEBUG - Node anomaly scores shape: torch.Size([8937, 1])
2025-06-03 11:31:47,086 - DEBUG - Edge anomaly scores shape: torch.Size([18357, 1])
2025-06-03 11:31:47,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:47,704 - DEBUG - Step 20: Loss=0.7074
2025-06-03 11:31:47,704 - DEBUG - Online update step: 21/50
2025-06-03 11:31:47,706 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:48,064 - DEBUG - Node anomaly scores shape: torch.Size([9804, 1])
2025-06-03 11:31:48,092 - DEBUG - Edge anomaly scores shape: torch.Size([20253, 1])
2025-06-03 11:31:48,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:48,784 - DEBUG - Step 21: Loss=0.6515
2025-06-03 11:31:48,785 - DEBUG - Online update step: 22/50
2025-06-03 11:31:48,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:49,174 - DEBUG - Node anomaly scores shape: torch.Size([10623, 1])
2025-06-03 11:31:49,205 - DEBUG - Edge anomaly scores shape: torch.Size([22314, 1])
2025-06-03 11:31:49,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:49,895 - DEBUG - Step 22: Loss=0.7789
2025-06-03 11:31:49,895 - DEBUG - Online update step: 23/50
2025-06-03 11:31:49,897 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:50,236 - DEBUG - Node anomaly scores shape: torch.Size([9639, 1])
2025-06-03 11:31:50,265 - DEBUG - Edge anomaly scores shape: torch.Size([19991, 1])
2025-06-03 11:31:50,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:50,972 - DEBUG - Step 23: Loss=0.8187
2025-06-03 11:31:50,973 - DEBUG - Online update step: 24/50
2025-06-03 11:31:50,974 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:51,327 - DEBUG - Node anomaly scores shape: torch.Size([9955, 1])
2025-06-03 11:31:51,356 - DEBUG - Edge anomaly scores shape: torch.Size([20716, 1])
2025-06-03 11:31:51,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:52,105 - DEBUG - Step 24: Loss=0.6172
2025-06-03 11:31:52,105 - DEBUG - Online update step: 25/50
2025-06-03 11:31:52,108 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:52,495 - DEBUG - Node anomaly scores shape: torch.Size([10376, 1])
2025-06-03 11:31:52,527 - DEBUG - Edge anomaly scores shape: torch.Size([21585, 1])
2025-06-03 11:31:52,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:53,207 - DEBUG - Step 25: Loss=0.6701
2025-06-03 11:31:53,207 - DEBUG - Online update step: 26/50
2025-06-03 11:31:53,208 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:53,605 - DEBUG - Node anomaly scores shape: torch.Size([10966, 1])
2025-06-03 11:31:53,643 - DEBUG - Edge anomaly scores shape: torch.Size([23061, 1])
2025-06-03 11:31:53,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:54,418 - DEBUG - Step 26: Loss=0.6607
2025-06-03 11:31:54,419 - DEBUG - Online update step: 27/50
2025-06-03 11:31:54,421 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:54,775 - DEBUG - Node anomaly scores shape: torch.Size([10270, 1])
2025-06-03 11:31:54,807 - DEBUG - Edge anomaly scores shape: torch.Size([21425, 1])
2025-06-03 11:31:54,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:55,486 - DEBUG - Step 27: Loss=0.6609
2025-06-03 11:31:55,487 - DEBUG - Online update step: 28/50
2025-06-03 11:31:55,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:55,827 - DEBUG - Node anomaly scores shape: torch.Size([9949, 1])
2025-06-03 11:31:55,859 - DEBUG - Edge anomaly scores shape: torch.Size([20600, 1])
2025-06-03 11:31:55,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:56,566 - DEBUG - Step 28: Loss=0.6629
2025-06-03 11:31:56,566 - DEBUG - Online update step: 29/50
2025-06-03 11:31:56,567 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:56,955 - DEBUG - Node anomaly scores shape: torch.Size([10592, 1])
2025-06-03 11:31:56,990 - DEBUG - Edge anomaly scores shape: torch.Size([22178, 1])
2025-06-03 11:31:56,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:57,707 - DEBUG - Step 29: Loss=0.6914
2025-06-03 11:31:57,707 - DEBUG - Online update step: 30/50
2025-06-03 11:31:57,709 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:58,111 - DEBUG - Node anomaly scores shape: torch.Size([11026, 1])
2025-06-03 11:31:58,146 - DEBUG - Edge anomaly scores shape: torch.Size([23146, 1])
2025-06-03 11:31:58,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:31:58,954 - DEBUG - Step 30: Loss=0.6664
2025-06-03 11:31:58,954 - DEBUG - Online update step: 31/50
2025-06-03 11:31:58,957 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:31:59,340 - DEBUG - Node anomaly scores shape: torch.Size([9993, 1])
2025-06-03 11:31:59,378 - DEBUG - Edge anomaly scores shape: torch.Size([20852, 1])
2025-06-03 11:31:59,379 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:00,133 - DEBUG - Step 31: Loss=0.6450
2025-06-03 11:32:00,133 - DEBUG - Online update step: 32/50
2025-06-03 11:32:00,135 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:00,484 - DEBUG - Node anomaly scores shape: torch.Size([9552, 1])
2025-06-03 11:32:00,517 - DEBUG - Edge anomaly scores shape: torch.Size([19782, 1])
2025-06-03 11:32:00,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:01,228 - DEBUG - Step 32: Loss=0.6987
2025-06-03 11:32:01,228 - DEBUG - Online update step: 33/50
2025-06-03 11:32:01,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:01,573 - DEBUG - Node anomaly scores shape: torch.Size([8921, 1])
2025-06-03 11:32:01,606 - DEBUG - Edge anomaly scores shape: torch.Size([18288, 1])
2025-06-03 11:32:01,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:02,302 - DEBUG - Step 33: Loss=0.6377
2025-06-03 11:32:02,302 - DEBUG - Online update step: 34/50
2025-06-03 11:32:02,305 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:02,748 - DEBUG - Node anomaly scores shape: torch.Size([10967, 1])
2025-06-03 11:32:02,785 - DEBUG - Edge anomaly scores shape: torch.Size([23083, 1])
2025-06-03 11:32:02,786 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:03,637 - DEBUG - Step 34: Loss=0.6981
2025-06-03 11:32:03,637 - DEBUG - Online update step: 35/50
2025-06-03 11:32:03,639 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:04,034 - DEBUG - Node anomaly scores shape: torch.Size([9602, 1])
2025-06-03 11:32:04,071 - DEBUG - Edge anomaly scores shape: torch.Size([19729, 1])
2025-06-03 11:32:04,072 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:04,985 - DEBUG - Step 35: Loss=0.7323
2025-06-03 11:32:04,985 - DEBUG - Online update step: 36/50
2025-06-03 11:32:04,988 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:05,393 - DEBUG - Node anomaly scores shape: torch.Size([9135, 1])
2025-06-03 11:32:05,430 - DEBUG - Edge anomaly scores shape: torch.Size([18834, 1])
2025-06-03 11:32:05,431 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:06,267 - DEBUG - Step 36: Loss=0.6443
2025-06-03 11:32:06,267 - DEBUG - Online update step: 37/50
2025-06-03 11:32:06,269 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:06,717 - DEBUG - Node anomaly scores shape: torch.Size([10404, 1])
2025-06-03 11:32:06,755 - DEBUG - Edge anomaly scores shape: torch.Size([21711, 1])
2025-06-03 11:32:06,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:07,580 - DEBUG - Step 37: Loss=0.9062
2025-06-03 11:32:07,580 - DEBUG - Online update step: 38/50
2025-06-03 11:32:07,582 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:08,040 - DEBUG - Node anomaly scores shape: torch.Size([10272, 1])
2025-06-03 11:32:08,080 - DEBUG - Edge anomaly scores shape: torch.Size([21504, 1])
2025-06-03 11:32:08,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:08,986 - DEBUG - Step 38: Loss=1.0510
2025-06-03 11:32:08,986 - DEBUG - Online update step: 39/50
2025-06-03 11:32:08,990 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:09,458 - DEBUG - Node anomaly scores shape: torch.Size([10424, 1])
2025-06-03 11:32:09,496 - DEBUG - Edge anomaly scores shape: torch.Size([21809, 1])
2025-06-03 11:32:09,497 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:10,342 - DEBUG - Step 39: Loss=0.9218
2025-06-03 11:32:10,342 - DEBUG - Online update step: 40/50
2025-06-03 11:32:10,344 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:10,720 - DEBUG - Node anomaly scores shape: torch.Size([9107, 1])
2025-06-03 11:32:10,755 - DEBUG - Edge anomaly scores shape: torch.Size([18734, 1])
2025-06-03 11:32:10,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:11,452 - DEBUG - Step 40: Loss=0.6524
2025-06-03 11:32:11,452 - DEBUG - Online update step: 41/50
2025-06-03 11:32:11,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:11,890 - DEBUG - Node anomaly scores shape: torch.Size([10062, 1])
2025-06-03 11:32:11,926 - DEBUG - Edge anomaly scores shape: torch.Size([20950, 1])
2025-06-03 11:32:11,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:12,711 - DEBUG - Step 41: Loss=0.6892
2025-06-03 11:32:12,711 - DEBUG - Online update step: 42/50
2025-06-03 11:32:12,713 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:13,134 - DEBUG - Node anomaly scores shape: torch.Size([10046, 1])
2025-06-03 11:32:13,171 - DEBUG - Edge anomaly scores shape: torch.Size([20848, 1])
2025-06-03 11:32:13,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:14,056 - DEBUG - Step 42: Loss=0.6652
2025-06-03 11:32:14,056 - DEBUG - Online update step: 43/50
2025-06-03 11:32:14,058 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:14,508 - DEBUG - Node anomaly scores shape: torch.Size([10479, 1])
2025-06-03 11:32:14,547 - DEBUG - Edge anomaly scores shape: torch.Size([21938, 1])
2025-06-03 11:32:14,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:15,432 - DEBUG - Step 43: Loss=0.7131
2025-06-03 11:32:15,433 - DEBUG - Online update step: 44/50
2025-06-03 11:32:15,436 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:15,863 - DEBUG - Node anomaly scores shape: torch.Size([10231, 1])
2025-06-03 11:32:15,895 - DEBUG - Edge anomaly scores shape: torch.Size([21288, 1])
2025-06-03 11:32:15,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:16,507 - DEBUG - Step 44: Loss=0.7379
2025-06-03 11:32:16,508 - DEBUG - Online update step: 45/50
2025-06-03 11:32:16,510 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:16,832 - DEBUG - Node anomaly scores shape: torch.Size([9054, 1])
2025-06-03 11:32:16,859 - DEBUG - Edge anomaly scores shape: torch.Size([18709, 1])
2025-06-03 11:32:16,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:17,420 - DEBUG - Step 45: Loss=0.6477
2025-06-03 11:32:17,420 - DEBUG - Online update step: 46/50
2025-06-03 11:32:17,422 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:17,798 - DEBUG - Node anomaly scores shape: torch.Size([11076, 1])
2025-06-03 11:32:17,831 - DEBUG - Edge anomaly scores shape: torch.Size([23314, 1])
2025-06-03 11:32:17,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:18,540 - DEBUG - Step 46: Loss=0.6413
2025-06-03 11:32:18,540 - DEBUG - Online update step: 47/50
2025-06-03 11:32:18,542 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:18,900 - DEBUG - Node anomaly scores shape: torch.Size([10359, 1])
2025-06-03 11:32:18,931 - DEBUG - Edge anomaly scores shape: torch.Size([21679, 1])
2025-06-03 11:32:18,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:19,636 - DEBUG - Step 47: Loss=0.6478
2025-06-03 11:32:19,636 - DEBUG - Online update step: 48/50
2025-06-03 11:32:19,639 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:19,995 - DEBUG - Node anomaly scores shape: torch.Size([10119, 1])
2025-06-03 11:32:20,024 - DEBUG - Edge anomaly scores shape: torch.Size([21085, 1])
2025-06-03 11:32:20,025 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:20,651 - DEBUG - Step 48: Loss=0.6309
2025-06-03 11:32:20,651 - DEBUG - Online update step: 49/50
2025-06-03 11:32:20,654 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:21,031 - DEBUG - Node anomaly scores shape: torch.Size([10436, 1])
2025-06-03 11:32:21,061 - DEBUG - Edge anomaly scores shape: torch.Size([21767, 1])
2025-06-03 11:32:21,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:21,776 - DEBUG - Step 49: Loss=0.6853
2025-06-03 11:32:21,776 - DEBUG - Online update step: 50/50
2025-06-03 11:32:21,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:22,125 - DEBUG - Node anomaly scores shape: torch.Size([10017, 1])
2025-06-03 11:32:22,155 - DEBUG - Edge anomaly scores shape: torch.Size([20841, 1])
2025-06-03 11:32:22,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:22,877 - DEBUG - Step 50: Loss=0.6839
2025-06-03 11:32:22,877 - INFO - Online update finished. Average loss: 0.7155, Learning rate: 0.002714
2025-06-03 11:32:22,878 - DEBUG - Current node mean: [-8.4676968e-09  8.4676968e-09 -6.3507724e-09 -4.2338484e-09
  3.7046173e-09  1.5876932e-08  3.1753864e-08  5.8215415e-09
  8.4676968e-09  1.6538470e-08 -1.0584621e-09 -2.1169241e-08
 -3.0695400e-08 -2.1169242e-09  7.4092346e-09 -3.4929247e-08
 -2.1169242e-09  0.0000000e+00  0.0000000e+00 -2.0110779e-08
  0.0000000e+00  0.0000000e+00 -1.7993855e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4074463e+00  5.6885161e+00  3.5006398e-09  1.0001828e-09
 -1.0001828e-09 -1.0001828e-09  4.0007313e-09 -2.0003657e-09
  2.3754343e-09  0.0000000e+00  0.0000000e+00  4.0007313e-09
  4.0007313e-09 -5.0009139e-09  1.2002194e-08 -1.0001828e-09
 -1.0001828e-09 -1.0001828e-09 -1.0001828e-09 -1.0001828e-09
 -1.0001828e-09 -1.0001828e-09]
2025-06-03 11:32:22,879 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0033
2025-06-03 11:32:22,879 - INFO - Online update complete. Loss: 0.7155
2025-06-03 11:32:22,879 - INFO - Running anomaly detection...
2025-06-03 11:32:22,880 - INFO - Starting anomaly detection.
2025-06-03 11:32:22,901 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113222_update_30.json
2025-06-03 11:32:22,901 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:32:22,927 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113222_update_30.pth and as latest_checkpoint.pth
2025-06-03 11:32:22,927 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.0007
2025-06-03 11:32:22,927 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:32:22,927 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.7108, MLP Score: 1.0000
2025-06-03 11:32:22,927 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.4170, MLP Score: 1.0000
2025-06-03 11:32:22,927 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2200, MLP Score: 1.0000
2025-06-03 11:32:22,927 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.2359, MLP Score: 1.0000
2025-06-03 11:32:22,927 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.3266, MLP Score: 1.0000
2025-06-03 11:32:22,927 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:32:22,927 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.2937, MLP Score: 1.0000
2025-06-03 11:32:22,928 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.9195, MLP Score: 1.0000
2025-06-03 11:32:22,928 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 2.9511, MLP Score: 0.9981
2025-06-03 11:32:22,928 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3228, MLP Score: 0.9999
2025-06-03 11:32:22,928 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.0670, MLP Score: 0.9999
2025-06-03 11:32:22,928 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-03 11:32:22,928 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-03 11:32:22,928 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot file.
2025-06-03 11:32:22,947 - INFO - Parsed 914 nodes.
2025-06-03 11:32:22,965 - INFO - Parsed 1945 edges.
2025-06-03 11:32:23,523 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:32:23,523 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:32:23,539 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-03 11:32:23,540 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:32:23,540 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-03 11:32:23,541 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-03 11:32:23,541 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:32:23,551 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:32:23,552 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:32:23,554 - DEBUG - Shape of encoded categorical edge features: torch.Size([1945, 2])
2025-06-03 11:32:23,555 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:32:23,556 - DEBUG - Shape of scaled numerical edge features: torch.Size([1945, 20])
2025-06-03 11:32:23,556 - DEBUG - Final edge attributes tensor shape: torch.Size([1945, 22])
2025-06-03 11:32:23,556 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:32:23,556 - INFO - Performing online update...
2025-06-03 11:32:23,556 - INFO - Starting online update for 50 steps.
2025-06-03 11:32:23,556 - DEBUG - Updated RunningStats: new_mean=0.5604447025310723, new_var=78600000000009.45, new_n=7890
2025-06-03 11:32:23,557 - DEBUG - Updated RunningStats: new_mean=0.5607221093292957, new_var=78900000000007.12, new_n=7920
2025-06-03 11:32:23,557 - DEBUG - Updated RunningStats: new_mean=0.787573009496999, new_var=45400000000036.805, new_n=4562
2025-06-03 11:32:23,557 - DEBUG - Updated RunningStats: new_mean=0.7887404579664516, new_var=45620000000002.88, new_n=4584
2025-06-03 11:32:23,557 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:32:23,557 - DEBUG - Online update step: 1/50
2025-06-03 11:32:23,558 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:23,940 - DEBUG - Node anomaly scores shape: torch.Size([10028, 1])
2025-06-03 11:32:23,971 - DEBUG - Edge anomaly scores shape: torch.Size([20828, 1])
2025-06-03 11:32:23,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:24,776 - DEBUG - Step 1: Loss=0.6482
2025-06-03 11:32:24,776 - DEBUG - Online update step: 2/50
2025-06-03 11:32:24,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:25,137 - DEBUG - Node anomaly scores shape: torch.Size([9720, 1])
2025-06-03 11:32:25,170 - DEBUG - Edge anomaly scores shape: torch.Size([20208, 1])
2025-06-03 11:32:25,171 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:25,893 - DEBUG - Step 2: Loss=0.6207
2025-06-03 11:32:25,894 - DEBUG - Online update step: 3/50
2025-06-03 11:32:25,896 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:26,350 - DEBUG - Node anomaly scores shape: torch.Size([10801, 1])
2025-06-03 11:32:26,385 - DEBUG - Edge anomaly scores shape: torch.Size([22709, 1])
2025-06-03 11:32:26,386 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:27,228 - DEBUG - Step 3: Loss=0.6982
2025-06-03 11:32:27,228 - DEBUG - Online update step: 4/50
2025-06-03 11:32:27,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:27,572 - DEBUG - Node anomaly scores shape: torch.Size([8709, 1])
2025-06-03 11:32:27,603 - DEBUG - Edge anomaly scores shape: torch.Size([17741, 1])
2025-06-03 11:32:27,604 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:28,262 - DEBUG - Step 4: Loss=0.6981
2025-06-03 11:32:28,262 - DEBUG - Online update step: 5/50
2025-06-03 11:32:28,264 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:28,617 - DEBUG - Node anomaly scores shape: torch.Size([9322, 1])
2025-06-03 11:32:28,649 - DEBUG - Edge anomaly scores shape: torch.Size([19084, 1])
2025-06-03 11:32:28,650 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:29,368 - DEBUG - Step 5: Loss=0.6353
2025-06-03 11:32:29,368 - DEBUG - Online update step: 6/50
2025-06-03 11:32:29,371 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:29,812 - DEBUG - Node anomaly scores shape: torch.Size([10370, 1])
2025-06-03 11:32:29,846 - DEBUG - Edge anomaly scores shape: torch.Size([21596, 1])
2025-06-03 11:32:29,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:30,660 - DEBUG - Step 6: Loss=0.8664
2025-06-03 11:32:30,660 - DEBUG - Online update step: 7/50
2025-06-03 11:32:30,663 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:31,088 - DEBUG - Node anomaly scores shape: torch.Size([10207, 1])
2025-06-03 11:32:31,126 - DEBUG - Edge anomaly scores shape: torch.Size([21386, 1])
2025-06-03 11:32:31,128 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:31,984 - DEBUG - Step 7: Loss=0.9382
2025-06-03 11:32:31,984 - DEBUG - Online update step: 8/50
2025-06-03 11:32:31,988 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:32,387 - DEBUG - Node anomaly scores shape: torch.Size([9522, 1])
2025-06-03 11:32:32,423 - DEBUG - Edge anomaly scores shape: torch.Size([19561, 1])
2025-06-03 11:32:32,424 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:33,253 - DEBUG - Step 8: Loss=0.7109
2025-06-03 11:32:33,253 - DEBUG - Online update step: 9/50
2025-06-03 11:32:33,257 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:33,707 - DEBUG - Node anomaly scores shape: torch.Size([9742, 1])
2025-06-03 11:32:33,743 - DEBUG - Edge anomaly scores shape: torch.Size([20153, 1])
2025-06-03 11:32:33,744 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:34,610 - DEBUG - Step 9: Loss=0.7049
2025-06-03 11:32:34,611 - DEBUG - Online update step: 10/50
2025-06-03 11:32:34,613 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:35,118 - DEBUG - Node anomaly scores shape: torch.Size([11096, 1])
2025-06-03 11:32:35,158 - DEBUG - Edge anomaly scores shape: torch.Size([23251, 1])
2025-06-03 11:32:35,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:36,046 - DEBUG - Step 10: Loss=0.7741
2025-06-03 11:32:36,046 - DEBUG - Online update step: 11/50
2025-06-03 11:32:36,049 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:36,404 - DEBUG - Node anomaly scores shape: torch.Size([9777, 1])
2025-06-03 11:32:36,433 - DEBUG - Edge anomaly scores shape: torch.Size([20218, 1])
2025-06-03 11:32:36,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:37,009 - DEBUG - Step 11: Loss=0.7250
2025-06-03 11:32:37,009 - DEBUG - Online update step: 12/50
2025-06-03 11:32:37,012 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:37,387 - DEBUG - Node anomaly scores shape: torch.Size([10384, 1])
2025-06-03 11:32:37,418 - DEBUG - Edge anomaly scores shape: torch.Size([21570, 1])
2025-06-03 11:32:37,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:38,089 - DEBUG - Step 12: Loss=0.6328
2025-06-03 11:32:38,090 - DEBUG - Online update step: 13/50
2025-06-03 11:32:38,091 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:38,403 - DEBUG - Node anomaly scores shape: torch.Size([9042, 1])
2025-06-03 11:32:38,428 - DEBUG - Edge anomaly scores shape: torch.Size([18569, 1])
2025-06-03 11:32:38,429 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:39,051 - DEBUG - Step 13: Loss=0.6579
2025-06-03 11:32:39,052 - DEBUG - Online update step: 14/50
2025-06-03 11:32:39,053 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:39,409 - DEBUG - Node anomaly scores shape: torch.Size([10338, 1])
2025-06-03 11:32:39,440 - DEBUG - Edge anomaly scores shape: torch.Size([21524, 1])
2025-06-03 11:32:39,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:40,076 - DEBUG - Step 14: Loss=0.6606
2025-06-03 11:32:40,076 - DEBUG - Online update step: 15/50
2025-06-03 11:32:40,078 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:40,444 - DEBUG - Node anomaly scores shape: torch.Size([10482, 1])
2025-06-03 11:32:40,477 - DEBUG - Edge anomaly scores shape: torch.Size([21866, 1])
2025-06-03 11:32:40,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:41,185 - DEBUG - Step 15: Loss=0.6527
2025-06-03 11:32:41,185 - DEBUG - Online update step: 16/50
2025-06-03 11:32:41,186 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:41,539 - DEBUG - Node anomaly scores shape: torch.Size([10283, 1])
2025-06-03 11:32:41,569 - DEBUG - Edge anomaly scores shape: torch.Size([21464, 1])
2025-06-03 11:32:41,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:42,268 - DEBUG - Step 16: Loss=0.6429
2025-06-03 11:32:42,269 - DEBUG - Online update step: 17/50
2025-06-03 11:32:42,271 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:42,616 - DEBUG - Node anomaly scores shape: torch.Size([10248, 1])
2025-06-03 11:32:42,646 - DEBUG - Edge anomaly scores shape: torch.Size([21215, 1])
2025-06-03 11:32:42,647 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:43,362 - DEBUG - Step 17: Loss=0.6569
2025-06-03 11:32:43,362 - DEBUG - Online update step: 18/50
2025-06-03 11:32:43,364 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:43,709 - DEBUG - Node anomaly scores shape: torch.Size([9939, 1])
2025-06-03 11:32:43,739 - DEBUG - Edge anomaly scores shape: torch.Size([20619, 1])
2025-06-03 11:32:43,740 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:44,429 - DEBUG - Step 18: Loss=0.6662
2025-06-03 11:32:44,429 - DEBUG - Online update step: 19/50
2025-06-03 11:32:44,431 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:44,858 - DEBUG - Node anomaly scores shape: torch.Size([11667, 1])
2025-06-03 11:32:44,894 - DEBUG - Edge anomaly scores shape: torch.Size([24684, 1])
2025-06-03 11:32:44,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:45,645 - DEBUG - Step 19: Loss=0.6564
2025-06-03 11:32:45,646 - DEBUG - Online update step: 20/50
2025-06-03 11:32:45,647 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:46,000 - DEBUG - Node anomaly scores shape: torch.Size([10199, 1])
2025-06-03 11:32:46,031 - DEBUG - Edge anomaly scores shape: torch.Size([21210, 1])
2025-06-03 11:32:46,033 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:46,724 - DEBUG - Step 20: Loss=0.6301
2025-06-03 11:32:46,724 - DEBUG - Online update step: 21/50
2025-06-03 11:32:46,727 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:47,162 - DEBUG - Node anomaly scores shape: torch.Size([10906, 1])
2025-06-03 11:32:47,197 - DEBUG - Edge anomaly scores shape: torch.Size([22894, 1])
2025-06-03 11:32:47,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:47,929 - DEBUG - Step 21: Loss=0.6277
2025-06-03 11:32:47,929 - DEBUG - Online update step: 22/50
2025-06-03 11:32:47,931 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:48,277 - DEBUG - Node anomaly scores shape: torch.Size([9841, 1])
2025-06-03 11:32:48,305 - DEBUG - Edge anomaly scores shape: torch.Size([20406, 1])
2025-06-03 11:32:48,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:49,048 - DEBUG - Step 22: Loss=0.6444
2025-06-03 11:32:49,049 - DEBUG - Online update step: 23/50
2025-06-03 11:32:49,051 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:49,392 - DEBUG - Node anomaly scores shape: torch.Size([9240, 1])
2025-06-03 11:32:49,420 - DEBUG - Edge anomaly scores shape: torch.Size([18983, 1])
2025-06-03 11:32:49,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:49,948 - DEBUG - Step 23: Loss=0.6214
2025-06-03 11:32:49,948 - DEBUG - Online update step: 24/50
2025-06-03 11:32:49,951 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:50,333 - DEBUG - Node anomaly scores shape: torch.Size([10110, 1])
2025-06-03 11:32:50,365 - DEBUG - Edge anomaly scores shape: torch.Size([21054, 1])
2025-06-03 11:32:50,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:51,114 - DEBUG - Step 24: Loss=0.7538
2025-06-03 11:32:51,114 - DEBUG - Online update step: 25/50
2025-06-03 11:32:51,116 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:51,472 - DEBUG - Node anomaly scores shape: torch.Size([9824, 1])
2025-06-03 11:32:51,504 - DEBUG - Edge anomaly scores shape: torch.Size([20447, 1])
2025-06-03 11:32:51,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:52,228 - DEBUG - Step 25: Loss=0.6886
2025-06-03 11:32:52,228 - DEBUG - Online update step: 26/50
2025-06-03 11:32:52,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:52,557 - DEBUG - Node anomaly scores shape: torch.Size([9095, 1])
2025-06-03 11:32:52,585 - DEBUG - Edge anomaly scores shape: torch.Size([18734, 1])
2025-06-03 11:32:52,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:53,223 - DEBUG - Step 26: Loss=0.6719
2025-06-03 11:32:53,223 - DEBUG - Online update step: 27/50
2025-06-03 11:32:53,226 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:53,680 - DEBUG - Node anomaly scores shape: torch.Size([10493, 1])
2025-06-03 11:32:53,718 - DEBUG - Edge anomaly scores shape: torch.Size([21878, 1])
2025-06-03 11:32:53,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:54,455 - DEBUG - Step 27: Loss=0.6619
2025-06-03 11:32:54,456 - DEBUG - Online update step: 28/50
2025-06-03 11:32:54,458 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:54,921 - DEBUG - Node anomaly scores shape: torch.Size([11021, 1])
2025-06-03 11:32:54,959 - DEBUG - Edge anomaly scores shape: torch.Size([23147, 1])
2025-06-03 11:32:54,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:55,887 - DEBUG - Step 28: Loss=0.6223
2025-06-03 11:32:55,888 - DEBUG - Online update step: 29/50
2025-06-03 11:32:55,890 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:56,287 - DEBUG - Node anomaly scores shape: torch.Size([9913, 1])
2025-06-03 11:32:56,324 - DEBUG - Edge anomaly scores shape: torch.Size([20585, 1])
2025-06-03 11:32:56,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:57,068 - DEBUG - Step 29: Loss=0.8132
2025-06-03 11:32:57,068 - DEBUG - Online update step: 30/50
2025-06-03 11:32:57,071 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:57,604 - DEBUG - Node anomaly scores shape: torch.Size([11545, 1])
2025-06-03 11:32:57,652 - DEBUG - Edge anomaly scores shape: torch.Size([24367, 1])
2025-06-03 11:32:57,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:58,626 - DEBUG - Step 30: Loss=0.8665
2025-06-03 11:32:58,626 - DEBUG - Online update step: 31/50
2025-06-03 11:32:58,628 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:32:59,053 - DEBUG - Node anomaly scores shape: torch.Size([10053, 1])
2025-06-03 11:32:59,091 - DEBUG - Edge anomaly scores shape: torch.Size([20880, 1])
2025-06-03 11:32:59,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:32:59,891 - DEBUG - Step 31: Loss=0.6203
2025-06-03 11:32:59,891 - DEBUG - Online update step: 32/50
2025-06-03 11:32:59,895 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:00,394 - DEBUG - Node anomaly scores shape: torch.Size([10691, 1])
2025-06-03 11:33:00,432 - DEBUG - Edge anomaly scores shape: torch.Size([22307, 1])
2025-06-03 11:33:00,433 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:01,245 - DEBUG - Step 32: Loss=0.7151
2025-06-03 11:33:01,245 - DEBUG - Online update step: 33/50
2025-06-03 11:33:01,247 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:01,641 - DEBUG - Node anomaly scores shape: torch.Size([9487, 1])
2025-06-03 11:33:01,679 - DEBUG - Edge anomaly scores shape: torch.Size([19566, 1])
2025-06-03 11:33:01,680 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:02,444 - DEBUG - Step 33: Loss=0.7770
2025-06-03 11:33:02,444 - DEBUG - Online update step: 34/50
2025-06-03 11:33:02,447 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:02,926 - DEBUG - Node anomaly scores shape: torch.Size([10062, 1])
2025-06-03 11:33:02,963 - DEBUG - Edge anomaly scores shape: torch.Size([20877, 1])
2025-06-03 11:33:02,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:03,634 - DEBUG - Step 34: Loss=0.6722
2025-06-03 11:33:03,635 - DEBUG - Online update step: 35/50
2025-06-03 11:33:03,637 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:03,963 - DEBUG - Node anomaly scores shape: torch.Size([9525, 1])
2025-06-03 11:33:03,991 - DEBUG - Edge anomaly scores shape: torch.Size([19747, 1])
2025-06-03 11:33:03,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:04,638 - DEBUG - Step 35: Loss=0.6588
2025-06-03 11:33:04,638 - DEBUG - Online update step: 36/50
2025-06-03 11:33:04,640 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:05,028 - DEBUG - Node anomaly scores shape: torch.Size([10891, 1])
2025-06-03 11:33:05,059 - DEBUG - Edge anomaly scores shape: torch.Size([22918, 1])
2025-06-03 11:33:05,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:05,742 - DEBUG - Step 36: Loss=0.7550
2025-06-03 11:33:05,743 - DEBUG - Online update step: 37/50
2025-06-03 11:33:05,744 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:06,092 - DEBUG - Node anomaly scores shape: torch.Size([10477, 1])
2025-06-03 11:33:06,123 - DEBUG - Edge anomaly scores shape: torch.Size([21892, 1])
2025-06-03 11:33:06,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:06,785 - DEBUG - Step 37: Loss=0.6653
2025-06-03 11:33:06,786 - DEBUG - Online update step: 38/50
2025-06-03 11:33:06,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:07,121 - DEBUG - Node anomaly scores shape: torch.Size([9676, 1])
2025-06-03 11:33:07,154 - DEBUG - Edge anomaly scores shape: torch.Size([20017, 1])
2025-06-03 11:33:07,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:07,732 - DEBUG - Step 38: Loss=0.6670
2025-06-03 11:33:07,733 - DEBUG - Online update step: 39/50
2025-06-03 11:33:07,734 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:08,082 - DEBUG - Node anomaly scores shape: torch.Size([9836, 1])
2025-06-03 11:33:08,112 - DEBUG - Edge anomaly scores shape: torch.Size([20397, 1])
2025-06-03 11:33:08,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:08,813 - DEBUG - Step 39: Loss=0.7217
2025-06-03 11:33:08,813 - DEBUG - Online update step: 40/50
2025-06-03 11:33:08,815 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:09,146 - DEBUG - Node anomaly scores shape: torch.Size([9248, 1])
2025-06-03 11:33:09,177 - DEBUG - Edge anomaly scores shape: torch.Size([19053, 1])
2025-06-03 11:33:09,178 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:09,845 - DEBUG - Step 40: Loss=0.6350
2025-06-03 11:33:09,845 - DEBUG - Online update step: 41/50
2025-06-03 11:33:09,848 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:10,215 - DEBUG - Node anomaly scores shape: torch.Size([9655, 1])
2025-06-03 11:33:10,242 - DEBUG - Edge anomaly scores shape: torch.Size([20009, 1])
2025-06-03 11:33:10,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:10,957 - DEBUG - Step 41: Loss=0.8080
2025-06-03 11:33:10,958 - DEBUG - Online update step: 42/50
2025-06-03 11:33:10,960 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:11,334 - DEBUG - Node anomaly scores shape: torch.Size([10174, 1])
2025-06-03 11:33:11,366 - DEBUG - Edge anomaly scores shape: torch.Size([21220, 1])
2025-06-03 11:33:11,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:12,007 - DEBUG - Step 42: Loss=0.8376
2025-06-03 11:33:12,007 - DEBUG - Online update step: 43/50
2025-06-03 11:33:12,008 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:12,438 - DEBUG - Node anomaly scores shape: torch.Size([11213, 1])
2025-06-03 11:33:12,470 - DEBUG - Edge anomaly scores shape: torch.Size([23538, 1])
2025-06-03 11:33:12,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:13,197 - DEBUG - Step 43: Loss=0.7140
2025-06-03 11:33:13,198 - DEBUG - Online update step: 44/50
2025-06-03 11:33:13,200 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:13,592 - DEBUG - Node anomaly scores shape: torch.Size([10774, 1])
2025-06-03 11:33:13,627 - DEBUG - Edge anomaly scores shape: torch.Size([22417, 1])
2025-06-03 11:33:13,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:14,369 - DEBUG - Step 44: Loss=0.7004
2025-06-03 11:33:14,369 - DEBUG - Online update step: 45/50
2025-06-03 11:33:14,372 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:14,740 - DEBUG - Node anomaly scores shape: torch.Size([10080, 1])
2025-06-03 11:33:14,772 - DEBUG - Edge anomaly scores shape: torch.Size([20961, 1])
2025-06-03 11:33:14,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:15,475 - DEBUG - Step 45: Loss=0.6883
2025-06-03 11:33:15,476 - DEBUG - Online update step: 46/50
2025-06-03 11:33:15,478 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:15,878 - DEBUG - Node anomaly scores shape: torch.Size([10467, 1])
2025-06-03 11:33:15,909 - DEBUG - Edge anomaly scores shape: torch.Size([21849, 1])
2025-06-03 11:33:15,910 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:16,619 - DEBUG - Step 46: Loss=0.6968
2025-06-03 11:33:16,620 - DEBUG - Online update step: 47/50
2025-06-03 11:33:16,621 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:16,995 - DEBUG - Node anomaly scores shape: torch.Size([10291, 1])
2025-06-03 11:33:17,026 - DEBUG - Edge anomaly scores shape: torch.Size([21387, 1])
2025-06-03 11:33:17,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:17,836 - DEBUG - Step 47: Loss=0.7641
2025-06-03 11:33:17,836 - DEBUG - Online update step: 48/50
2025-06-03 11:33:17,838 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:18,221 - DEBUG - Node anomaly scores shape: torch.Size([10116, 1])
2025-06-03 11:33:18,256 - DEBUG - Edge anomaly scores shape: torch.Size([21035, 1])
2025-06-03 11:33:18,257 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:18,968 - DEBUG - Step 48: Loss=0.7305
2025-06-03 11:33:18,968 - DEBUG - Online update step: 49/50
2025-06-03 11:33:18,970 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:19,442 - DEBUG - Node anomaly scores shape: torch.Size([11320, 1])
2025-06-03 11:33:19,477 - DEBUG - Edge anomaly scores shape: torch.Size([23892, 1])
2025-06-03 11:33:19,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:20,228 - DEBUG - Step 49: Loss=0.6612
2025-06-03 11:33:20,229 - DEBUG - Online update step: 50/50
2025-06-03 11:33:20,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:20,681 - DEBUG - Node anomaly scores shape: torch.Size([10519, 1])
2025-06-03 11:33:20,722 - DEBUG - Edge anomaly scores shape: torch.Size([22005, 1])
2025-06-03 11:33:20,723 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:21,610 - DEBUG - Step 50: Loss=0.6439
2025-06-03 11:33:21,610 - INFO - Online update finished. Average loss: 0.6996, Learning rate: 0.002561
2025-06-03 11:33:21,611 - DEBUG - Current node mean: [-2.6085183e-09  2.6085183e-09 -3.1302221e-08  1.9824739e-08
 -1.0694925e-08 -2.0085592e-08  2.7650294e-08 -9.9123696e-09
 -4.1736294e-09  8.5428979e-09 -3.6519257e-08 -2.9541470e-08
 -2.3998370e-08  2.6085184e-08 -7.3038513e-09 -1.4607703e-08
 -3.1302221e-08  0.0000000e+00  0.0000000e+00  1.6433665e-08
  0.0000000e+00  0.0000000e+00 -1.4607703e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4118252e+00  5.6848330e+00 -9.8064201e-10 -3.9225680e-09
  1.9612840e-09 -9.8064201e-10 -2.9419258e-09 -9.8064201e-10
  9.8064201e-10  8.8257774e-09  2.2187024e-08  1.9612840e-09
 -2.9419258e-09  7.8451361e-09 -1.3728988e-08 -7.3548145e-10
 -7.3548145e-10 -7.3548145e-10 -7.3548145e-10 -7.3548145e-10
 -7.3548145e-10  7.3548145e-10]
2025-06-03 11:33:21,612 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0087
2025-06-03 11:33:21,620 - INFO - Online update complete. Loss: 0.6996
2025-06-03 11:33:21,620 - INFO - Running anomaly detection...
2025-06-03 11:33:21,621 - INFO - Starting anomaly detection.
2025-06-03 11:33:21,648 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113321_update_31.json
2025-06-03 11:33:21,648 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:33:21,679 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113321_update_31.pth and as latest_checkpoint.pth
2025-06-03 11:33:21,679 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.0000
2025-06-03 11:33:21,679 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:33:21,679 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.3996, MLP Score: 1.0000
2025-06-03 11:33:21,679 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.1472, MLP Score: 1.0000
2025-06-03 11:33:21,680 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.9660, MLP Score: 1.0000
2025-06-03 11:33:21,680 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.7443, MLP Score: 1.0000
2025-06-03 11:33:21,680 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1055, MLP Score: 1.0000
2025-06-03 11:33:21,680 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:33:21,680 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.9174, MLP Score: 0.9996
2025-06-03 11:33:21,680 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7579, MLP Score: 0.9999
2025-06-03 11:33:21,680 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.1167, MLP Score: 0.9771
2025-06-03 11:33:21,680 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3459, MLP Score: 0.9995
2025-06-03 11:33:21,680 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.1279, MLP Score: 0.9998
2025-06-03 11:33:21,680 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:33:21,680 - INFO - Performing visualization of node and edge features.
2025-06-03 11:33:21,680 - INFO - Starting visualization of node features.
2025-06-03 11:33:21,680 - INFO - Graph has 914 nodes and 30 features.
2025-06-03 11:33:21,680 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:33:21,680 - INFO - Calculating feature statistics:
2025-06-03 11:33:21,681 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11311445), 'max': np.float32(9.018767)}
2025-06-03 11:33:21,681 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-9.018767), 'max': np.float32(0.11311445)}
2025-06-03 11:33:21,681 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(-2.5041777e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2995923), 'max': np.float32(3.0884836)}
2025-06-03 11:33:21,681 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07977894), 'max': np.float32(17.155695)}
2025-06-03 11:33:21,681 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(1.0), 'min': np.float32(-0.62225133), 'max': np.float32(3.5596437)}
2025-06-03 11:33:21,681 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 15, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.62891865), 'max': np.float32(2.9409304)}
2025-06-03 11:33:21,681 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9485755), 'max': np.float32(0.61286527)}
2025-06-03 11:33:21,681 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-6.260444e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0835437), 'max': np.float32(18.616604)}
2025-06-03 11:33:21,682 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-4.1414895), 'max': np.float32(20.358973)}
2025-06-03 11:33:21,682 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.0976973), 'max': np.float32(10.889753)}
2025-06-03 11:33:21,682 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-5.0083553e-08), 'std': np.float32(1.0), 'min': np.float32(-2.046151), 'max': np.float32(0.8907357)}
2025-06-03 11:33:21,682 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10794602), 'max': np.float32(9.769954)}
2025-06-03 11:33:21,682 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-9.390666e-09), 'std': np.float32(1.0), 'min': np.float32(-7.627586), 'max': np.float32(0.13302284)}
2025-06-03 11:33:21,682 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.2145884), 'max': np.float32(2.0248365)}
2025-06-03 11:33:21,682 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(1.6694518e-08), 'std': np.float32(1.0), 'min': np.float32(-1.93445), 'max': np.float32(2.2855513)}
2025-06-03 11:33:21,682 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(-1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4036233), 'max': np.float32(2.6719344)}
2025-06-03 11:33:21,682 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(-1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5599065), 'max': np.float32(1.4289318)}
2025-06-03 11:33:21,682 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,682 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 12, 'mean': np.float32(1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-7.0711026), 'max': np.float32(0.15982148)}
2025-06-03 11:33:21,683 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 14, 'mean': np.float32(-1.6694518e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.9609456), 'max': np.float32(4.1400523)}
2025-06-03 11:33:21,683 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,683 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,684 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:33:21,699 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b39ac70b0>
2025-06-03 11:33:21,843 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:33:22,093 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:33:22,121 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:33:23,296 - INFO - Node feature visualization saved to vis/node_features_20250603_113322.png
2025-06-03 11:33:23,297 - INFO - Finished visualization of node features.
2025-06-03 11:33:23,297 - INFO - Performing additional feature analysis:
2025-06-03 11:33:23,297 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:33:23,297 - INFO - Starting visualization of edge features.
2025-06-03 11:33:23,297 - INFO - Graph has 1945 edges and 22 edge features.
2025-06-03 11:33:23,297 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:33:23,297 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:33:23,297 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-03 11:33:23,297 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-03 11:33:23,297 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot file.
2025-06-03 11:33:23,316 - INFO - Parsed 918 nodes.
2025-06-03 11:33:23,334 - INFO - Parsed 1958 edges.
2025-06-03 11:33:23,889 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:33:23,889 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:33:23,904 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-03 11:33:23,906 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:33:23,906 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-03 11:33:23,907 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-03 11:33:23,907 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:33:23,916 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:33:23,917 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:33:23,919 - DEBUG - Shape of encoded categorical edge features: torch.Size([1958, 2])
2025-06-03 11:33:23,920 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:33:23,920 - DEBUG - Shape of scaled numerical edge features: torch.Size([1958, 20])
2025-06-03 11:33:23,920 - DEBUG - Final edge attributes tensor shape: torch.Size([1958, 22])
2025-06-03 11:33:23,921 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:33:23,921 - INFO - Performing online update...
2025-06-03 11:33:23,921 - INFO - Starting online update for 50 steps.
2025-06-03 11:33:23,921 - DEBUG - Updated RunningStats: new_mean=0.5586061768459976, new_var=79200000000009.39, new_n=7950
2025-06-03 11:33:23,921 - DEBUG - Updated RunningStats: new_mean=0.5588884039230068, new_var=79500000000007.14, new_n=7980
2025-06-03 11:33:23,922 - DEBUG - Updated RunningStats: new_mean=0.7865135159283744, new_var=45840000000036.77, new_n=4606
2025-06-03 11:33:23,922 - DEBUG - Updated RunningStats: new_mean=0.7876754133380232, new_var=46060000000002.9, new_n=4628
2025-06-03 11:33:23,922 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:33:23,922 - DEBUG - Online update step: 1/50
2025-06-03 11:33:23,923 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:24,430 - DEBUG - Node anomaly scores shape: torch.Size([11020, 1])
2025-06-03 11:33:24,475 - DEBUG - Edge anomaly scores shape: torch.Size([23055, 1])
2025-06-03 11:33:24,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:25,359 - DEBUG - Step 1: Loss=0.6094
2025-06-03 11:33:25,360 - DEBUG - Online update step: 2/50
2025-06-03 11:33:25,363 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:25,809 - DEBUG - Node anomaly scores shape: torch.Size([9834, 1])
2025-06-03 11:33:25,846 - DEBUG - Edge anomaly scores shape: torch.Size([20470, 1])
2025-06-03 11:33:25,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:26,686 - DEBUG - Step 2: Loss=0.6365
2025-06-03 11:33:26,687 - DEBUG - Online update step: 3/50
2025-06-03 11:33:26,690 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:27,099 - DEBUG - Node anomaly scores shape: torch.Size([9398, 1])
2025-06-03 11:33:27,134 - DEBUG - Edge anomaly scores shape: torch.Size([19308, 1])
2025-06-03 11:33:27,135 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:27,791 - DEBUG - Step 3: Loss=0.6258
2025-06-03 11:33:27,791 - DEBUG - Online update step: 4/50
2025-06-03 11:33:27,794 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:28,153 - DEBUG - Node anomaly scores shape: torch.Size([10033, 1])
2025-06-03 11:33:28,183 - DEBUG - Edge anomaly scores shape: torch.Size([20741, 1])
2025-06-03 11:33:28,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:28,832 - DEBUG - Step 4: Loss=0.6180
2025-06-03 11:33:28,832 - DEBUG - Online update step: 5/50
2025-06-03 11:33:28,833 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:29,160 - DEBUG - Node anomaly scores shape: torch.Size([9381, 1])
2025-06-03 11:33:29,188 - DEBUG - Edge anomaly scores shape: torch.Size([19243, 1])
2025-06-03 11:33:29,189 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:29,776 - DEBUG - Step 5: Loss=0.6864
2025-06-03 11:33:29,776 - DEBUG - Online update step: 6/50
2025-06-03 11:33:29,777 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:30,184 - DEBUG - Node anomaly scores shape: torch.Size([10856, 1])
2025-06-03 11:33:30,219 - DEBUG - Edge anomaly scores shape: torch.Size([22680, 1])
2025-06-03 11:33:30,219 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:31,023 - DEBUG - Step 6: Loss=0.6231
2025-06-03 11:33:31,023 - DEBUG - Online update step: 7/50
2025-06-03 11:33:31,026 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:31,366 - DEBUG - Node anomaly scores shape: torch.Size([9387, 1])
2025-06-03 11:33:31,394 - DEBUG - Edge anomaly scores shape: torch.Size([19304, 1])
2025-06-03 11:33:31,395 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:32,012 - DEBUG - Step 7: Loss=0.6776
2025-06-03 11:33:32,013 - DEBUG - Online update step: 8/50
2025-06-03 11:33:32,014 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:32,412 - DEBUG - Node anomaly scores shape: torch.Size([11080, 1])
2025-06-03 11:33:32,447 - DEBUG - Edge anomaly scores shape: torch.Size([23227, 1])
2025-06-03 11:33:32,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:33,239 - DEBUG - Step 8: Loss=0.7022
2025-06-03 11:33:33,239 - DEBUG - Online update step: 9/50
2025-06-03 11:33:33,241 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:33,580 - DEBUG - Node anomaly scores shape: torch.Size([9824, 1])
2025-06-03 11:33:33,616 - DEBUG - Edge anomaly scores shape: torch.Size([20477, 1])
2025-06-03 11:33:33,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:34,261 - DEBUG - Step 9: Loss=0.6329
2025-06-03 11:33:34,262 - DEBUG - Online update step: 10/50
2025-06-03 11:33:34,263 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:34,600 - DEBUG - Node anomaly scores shape: torch.Size([9649, 1])
2025-06-03 11:33:34,629 - DEBUG - Edge anomaly scores shape: torch.Size([19956, 1])
2025-06-03 11:33:34,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:35,210 - DEBUG - Step 10: Loss=0.8634
2025-06-03 11:33:35,210 - DEBUG - Online update step: 11/50
2025-06-03 11:33:35,212 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:35,605 - DEBUG - Node anomaly scores shape: torch.Size([10479, 1])
2025-06-03 11:33:35,635 - DEBUG - Edge anomaly scores shape: torch.Size([21888, 1])
2025-06-03 11:33:35,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:36,280 - DEBUG - Step 11: Loss=1.0183
2025-06-03 11:33:36,280 - DEBUG - Online update step: 12/50
2025-06-03 11:33:36,282 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:36,630 - DEBUG - Node anomaly scores shape: torch.Size([9987, 1])
2025-06-03 11:33:36,659 - DEBUG - Edge anomaly scores shape: torch.Size([20827, 1])
2025-06-03 11:33:36,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:37,286 - DEBUG - Step 12: Loss=0.8303
2025-06-03 11:33:37,286 - DEBUG - Online update step: 13/50
2025-06-03 11:33:37,288 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:37,638 - DEBUG - Node anomaly scores shape: torch.Size([9784, 1])
2025-06-03 11:33:37,670 - DEBUG - Edge anomaly scores shape: torch.Size([20132, 1])
2025-06-03 11:33:37,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:38,423 - DEBUG - Step 13: Loss=0.6599
2025-06-03 11:33:38,423 - DEBUG - Online update step: 14/50
2025-06-03 11:33:38,425 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:38,812 - DEBUG - Node anomaly scores shape: torch.Size([10900, 1])
2025-06-03 11:33:38,845 - DEBUG - Edge anomaly scores shape: torch.Size([22823, 1])
2025-06-03 11:33:38,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:39,605 - DEBUG - Step 14: Loss=0.6720
2025-06-03 11:33:39,605 - DEBUG - Online update step: 15/50
2025-06-03 11:33:39,607 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:39,991 - DEBUG - Node anomaly scores shape: torch.Size([10621, 1])
2025-06-03 11:33:40,026 - DEBUG - Edge anomaly scores shape: torch.Size([22281, 1])
2025-06-03 11:33:40,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:40,862 - DEBUG - Step 15: Loss=0.6860
2025-06-03 11:33:40,862 - DEBUG - Online update step: 16/50
2025-06-03 11:33:40,865 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:41,309 - DEBUG - Node anomaly scores shape: torch.Size([11434, 1])
2025-06-03 11:33:41,344 - DEBUG - Edge anomaly scores shape: torch.Size([24059, 1])
2025-06-03 11:33:41,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:42,189 - DEBUG - Step 16: Loss=0.6329
2025-06-03 11:33:42,189 - DEBUG - Online update step: 17/50
2025-06-03 11:33:42,191 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:42,529 - DEBUG - Node anomaly scores shape: torch.Size([9181, 1])
2025-06-03 11:33:42,563 - DEBUG - Edge anomaly scores shape: torch.Size([18924, 1])
2025-06-03 11:33:42,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:43,288 - DEBUG - Step 17: Loss=0.6416
2025-06-03 11:33:43,289 - DEBUG - Online update step: 18/50
2025-06-03 11:33:43,291 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:43,795 - DEBUG - Node anomaly scores shape: torch.Size([11941, 1])
2025-06-03 11:33:43,835 - DEBUG - Edge anomaly scores shape: torch.Size([25196, 1])
2025-06-03 11:33:43,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:44,758 - DEBUG - Step 18: Loss=0.6424
2025-06-03 11:33:44,758 - DEBUG - Online update step: 19/50
2025-06-03 11:33:44,762 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:45,228 - DEBUG - Node anomaly scores shape: torch.Size([10855, 1])
2025-06-03 11:33:45,266 - DEBUG - Edge anomaly scores shape: torch.Size([22720, 1])
2025-06-03 11:33:45,267 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:46,176 - DEBUG - Step 19: Loss=0.6407
2025-06-03 11:33:46,176 - DEBUG - Online update step: 20/50
2025-06-03 11:33:46,179 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:46,694 - DEBUG - Node anomaly scores shape: torch.Size([11392, 1])
2025-06-03 11:33:46,734 - DEBUG - Edge anomaly scores shape: torch.Size([24042, 1])
2025-06-03 11:33:46,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:47,702 - DEBUG - Step 20: Loss=0.6218
2025-06-03 11:33:47,703 - DEBUG - Online update step: 21/50
2025-06-03 11:33:47,705 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:48,146 - DEBUG - Node anomaly scores shape: torch.Size([9715, 1])
2025-06-03 11:33:48,189 - DEBUG - Edge anomaly scores shape: torch.Size([20047, 1])
2025-06-03 11:33:48,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:49,068 - DEBUG - Step 21: Loss=0.6307
2025-06-03 11:33:49,069 - DEBUG - Online update step: 22/50
2025-06-03 11:33:49,071 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:49,506 - DEBUG - Node anomaly scores shape: torch.Size([10068, 1])
2025-06-03 11:33:49,544 - DEBUG - Edge anomaly scores shape: torch.Size([20939, 1])
2025-06-03 11:33:49,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:50,409 - DEBUG - Step 22: Loss=0.6548
2025-06-03 11:33:50,409 - DEBUG - Online update step: 23/50
2025-06-03 11:33:50,411 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:50,882 - DEBUG - Node anomaly scores shape: torch.Size([10406, 1])
2025-06-03 11:33:50,919 - DEBUG - Edge anomaly scores shape: torch.Size([21755, 1])
2025-06-03 11:33:50,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:51,766 - DEBUG - Step 23: Loss=0.6367
2025-06-03 11:33:51,767 - DEBUG - Online update step: 24/50
2025-06-03 11:33:51,769 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:52,133 - DEBUG - Node anomaly scores shape: torch.Size([10289, 1])
2025-06-03 11:33:52,165 - DEBUG - Edge anomaly scores shape: torch.Size([21455, 1])
2025-06-03 11:33:52,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:52,841 - DEBUG - Step 24: Loss=0.6785
2025-06-03 11:33:52,842 - DEBUG - Online update step: 25/50
2025-06-03 11:33:52,844 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:53,193 - DEBUG - Node anomaly scores shape: torch.Size([10170, 1])
2025-06-03 11:33:53,227 - DEBUG - Edge anomaly scores shape: torch.Size([21180, 1])
2025-06-03 11:33:53,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:53,856 - DEBUG - Step 25: Loss=0.6723
2025-06-03 11:33:53,856 - DEBUG - Online update step: 26/50
2025-06-03 11:33:53,859 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:54,201 - DEBUG - Node anomaly scores shape: torch.Size([9702, 1])
2025-06-03 11:33:54,229 - DEBUG - Edge anomaly scores shape: torch.Size([20028, 1])
2025-06-03 11:33:54,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:54,884 - DEBUG - Step 26: Loss=0.6465
2025-06-03 11:33:54,884 - DEBUG - Online update step: 27/50
2025-06-03 11:33:54,886 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:55,291 - DEBUG - Node anomaly scores shape: torch.Size([11004, 1])
2025-06-03 11:33:55,325 - DEBUG - Edge anomaly scores shape: torch.Size([23180, 1])
2025-06-03 11:33:55,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:56,035 - DEBUG - Step 27: Loss=0.6454
2025-06-03 11:33:56,036 - DEBUG - Online update step: 28/50
2025-06-03 11:33:56,037 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:56,422 - DEBUG - Node anomaly scores shape: torch.Size([11079, 1])
2025-06-03 11:33:56,455 - DEBUG - Edge anomaly scores shape: torch.Size([23289, 1])
2025-06-03 11:33:56,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:57,115 - DEBUG - Step 28: Loss=0.6119
2025-06-03 11:33:57,115 - DEBUG - Online update step: 29/50
2025-06-03 11:33:57,118 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:57,482 - DEBUG - Node anomaly scores shape: torch.Size([10236, 1])
2025-06-03 11:33:57,511 - DEBUG - Edge anomaly scores shape: torch.Size([21287, 1])
2025-06-03 11:33:57,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:58,215 - DEBUG - Step 29: Loss=0.6129
2025-06-03 11:33:58,216 - DEBUG - Online update step: 30/50
2025-06-03 11:33:58,217 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:58,602 - DEBUG - Node anomaly scores shape: torch.Size([11033, 1])
2025-06-03 11:33:58,636 - DEBUG - Edge anomaly scores shape: torch.Size([23123, 1])
2025-06-03 11:33:58,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:33:59,432 - DEBUG - Step 30: Loss=0.6645
2025-06-03 11:33:59,432 - DEBUG - Online update step: 31/50
2025-06-03 11:33:59,434 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:33:59,773 - DEBUG - Node anomaly scores shape: torch.Size([9820, 1])
2025-06-03 11:33:59,805 - DEBUG - Edge anomaly scores shape: torch.Size([20214, 1])
2025-06-03 11:33:59,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:00,464 - DEBUG - Step 31: Loss=0.6703
2025-06-03 11:34:00,465 - DEBUG - Online update step: 32/50
2025-06-03 11:34:00,467 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:00,822 - DEBUG - Node anomaly scores shape: torch.Size([10391, 1])
2025-06-03 11:34:00,854 - DEBUG - Edge anomaly scores shape: torch.Size([21634, 1])
2025-06-03 11:34:00,855 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:01,518 - DEBUG - Step 32: Loss=0.6162
2025-06-03 11:34:01,518 - DEBUG - Online update step: 33/50
2025-06-03 11:34:01,520 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:01,907 - DEBUG - Node anomaly scores shape: torch.Size([10807, 1])
2025-06-03 11:34:01,938 - DEBUG - Edge anomaly scores shape: torch.Size([22647, 1])
2025-06-03 11:34:01,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:02,624 - DEBUG - Step 33: Loss=0.6064
2025-06-03 11:34:02,624 - DEBUG - Online update step: 34/50
2025-06-03 11:34:02,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:02,986 - DEBUG - Node anomaly scores shape: torch.Size([10475, 1])
2025-06-03 11:34:03,019 - DEBUG - Edge anomaly scores shape: torch.Size([21785, 1])
2025-06-03 11:34:03,020 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:03,703 - DEBUG - Step 34: Loss=0.6382
2025-06-03 11:34:03,704 - DEBUG - Online update step: 35/50
2025-06-03 11:34:03,706 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:04,049 - DEBUG - Node anomaly scores shape: torch.Size([9800, 1])
2025-06-03 11:34:04,082 - DEBUG - Edge anomaly scores shape: torch.Size([20258, 1])
2025-06-03 11:34:04,084 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:04,747 - DEBUG - Step 35: Loss=0.6151
2025-06-03 11:34:04,747 - DEBUG - Online update step: 36/50
2025-06-03 11:34:04,749 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:05,126 - DEBUG - Node anomaly scores shape: torch.Size([10227, 1])
2025-06-03 11:34:05,158 - DEBUG - Edge anomaly scores shape: torch.Size([21277, 1])
2025-06-03 11:34:05,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:05,843 - DEBUG - Step 36: Loss=0.6197
2025-06-03 11:34:05,843 - DEBUG - Online update step: 37/50
2025-06-03 11:34:05,845 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:06,211 - DEBUG - Node anomaly scores shape: torch.Size([10200, 1])
2025-06-03 11:34:06,245 - DEBUG - Edge anomaly scores shape: torch.Size([21251, 1])
2025-06-03 11:34:06,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:06,965 - DEBUG - Step 37: Loss=0.6333
2025-06-03 11:34:06,966 - DEBUG - Online update step: 38/50
2025-06-03 11:34:06,967 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:07,302 - DEBUG - Node anomaly scores shape: torch.Size([9500, 1])
2025-06-03 11:34:07,336 - DEBUG - Edge anomaly scores shape: torch.Size([19602, 1])
2025-06-03 11:34:07,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:07,988 - DEBUG - Step 38: Loss=0.6797
2025-06-03 11:34:07,988 - DEBUG - Online update step: 39/50
2025-06-03 11:34:07,991 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:08,430 - DEBUG - Node anomaly scores shape: torch.Size([10768, 1])
2025-06-03 11:34:08,465 - DEBUG - Edge anomaly scores shape: torch.Size([22500, 1])
2025-06-03 11:34:08,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:09,287 - DEBUG - Step 39: Loss=0.7002
2025-06-03 11:34:09,287 - DEBUG - Online update step: 40/50
2025-06-03 11:34:09,290 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:09,695 - DEBUG - Node anomaly scores shape: torch.Size([10308, 1])
2025-06-03 11:34:09,732 - DEBUG - Edge anomaly scores shape: torch.Size([21455, 1])
2025-06-03 11:34:09,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:10,519 - DEBUG - Step 40: Loss=0.6446
2025-06-03 11:34:10,519 - DEBUG - Online update step: 41/50
2025-06-03 11:34:10,521 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:10,925 - DEBUG - Node anomaly scores shape: torch.Size([10301, 1])
2025-06-03 11:34:10,962 - DEBUG - Edge anomaly scores shape: torch.Size([21299, 1])
2025-06-03 11:34:10,963 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:11,792 - DEBUG - Step 41: Loss=0.6470
2025-06-03 11:34:11,792 - DEBUG - Online update step: 42/50
2025-06-03 11:34:11,794 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:12,262 - DEBUG - Node anomaly scores shape: torch.Size([10310, 1])
2025-06-03 11:34:12,300 - DEBUG - Edge anomaly scores shape: torch.Size([21478, 1])
2025-06-03 11:34:12,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:13,246 - DEBUG - Step 42: Loss=0.6612
2025-06-03 11:34:13,247 - DEBUG - Online update step: 43/50
2025-06-03 11:34:13,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:13,773 - DEBUG - Node anomaly scores shape: torch.Size([10780, 1])
2025-06-03 11:34:13,812 - DEBUG - Edge anomaly scores shape: torch.Size([22597, 1])
2025-06-03 11:34:13,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:14,749 - DEBUG - Step 43: Loss=0.6468
2025-06-03 11:34:14,749 - DEBUG - Online update step: 44/50
2025-06-03 11:34:14,751 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:15,285 - DEBUG - Node anomaly scores shape: torch.Size([11568, 1])
2025-06-03 11:34:15,328 - DEBUG - Edge anomaly scores shape: torch.Size([24356, 1])
2025-06-03 11:34:15,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:16,096 - DEBUG - Step 44: Loss=0.6243
2025-06-03 11:34:16,096 - DEBUG - Online update step: 45/50
2025-06-03 11:34:16,098 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:16,441 - DEBUG - Node anomaly scores shape: torch.Size([9821, 1])
2025-06-03 11:34:16,470 - DEBUG - Edge anomaly scores shape: torch.Size([20419, 1])
2025-06-03 11:34:16,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:17,175 - DEBUG - Step 45: Loss=0.6642
2025-06-03 11:34:17,175 - DEBUG - Online update step: 46/50
2025-06-03 11:34:17,177 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:17,544 - DEBUG - Node anomaly scores shape: torch.Size([10450, 1])
2025-06-03 11:34:17,578 - DEBUG - Edge anomaly scores shape: torch.Size([21907, 1])
2025-06-03 11:34:17,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:18,274 - DEBUG - Step 46: Loss=0.6357
2025-06-03 11:34:18,275 - DEBUG - Online update step: 47/50
2025-06-03 11:34:18,276 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:18,600 - DEBUG - Node anomaly scores shape: torch.Size([9910, 1])
2025-06-03 11:34:18,631 - DEBUG - Edge anomaly scores shape: torch.Size([20411, 1])
2025-06-03 11:34:18,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:19,286 - DEBUG - Step 47: Loss=0.6234
2025-06-03 11:34:19,286 - DEBUG - Online update step: 48/50
2025-06-03 11:34:19,288 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:19,668 - DEBUG - Node anomaly scores shape: torch.Size([10621, 1])
2025-06-03 11:34:19,701 - DEBUG - Edge anomaly scores shape: torch.Size([22115, 1])
2025-06-03 11:34:19,702 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:20,311 - DEBUG - Step 48: Loss=0.6672
2025-06-03 11:34:20,312 - DEBUG - Online update step: 49/50
2025-06-03 11:34:20,313 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:20,660 - DEBUG - Node anomaly scores shape: torch.Size([9984, 1])
2025-06-03 11:34:20,689 - DEBUG - Edge anomaly scores shape: torch.Size([20744, 1])
2025-06-03 11:34:20,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:21,342 - DEBUG - Step 49: Loss=0.6753
2025-06-03 11:34:21,342 - DEBUG - Online update step: 50/50
2025-06-03 11:34:21,343 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:21,702 - DEBUG - Node anomaly scores shape: torch.Size([10007, 1])
2025-06-03 11:34:21,733 - DEBUG - Edge anomaly scores shape: torch.Size([20737, 1])
2025-06-03 11:34:21,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:22,312 - DEBUG - Step 50: Loss=0.6094
2025-06-03 11:34:22,312 - INFO - Online update finished. Average loss: 0.6611, Learning rate: 0.002382
2025-06-03 11:34:22,312 - DEBUG - Current node mean: [-8.3108871e-09  8.3108871e-09 -4.1554435e-09 -4.1554435e-09
  1.2466331e-08 -3.4282412e-08 -8.3108871e-09  1.2466331e-08
 -4.6748743e-09 -3.0126966e-08  6.4409377e-08 -3.1165829e-08
  2.2854939e-08 -9.3497485e-09  2.5452092e-08  3.8957286e-09
  5.9734502e-09  0.0000000e+00  0.0000000e+00  1.4284337e-08
  0.0000000e+00  0.0000000e+00  2.0777218e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4101124e+00  5.6848826e+00 -9.7413111e-10 -9.7413111e-10
  4.8706555e-10  1.9482622e-09 -5.8447864e-09 -3.8965244e-09
  7.7930489e-09  2.4353277e-09  4.1400572e-09 -9.7413111e-10
 -4.8706554e-09  3.4094587e-09  5.8447864e-09  2.9223932e-09
  2.9223932e-09  2.9223932e-09  2.9223932e-09  2.9223932e-09
  2.9223932e-09  0.0000000e+00]
2025-06-03 11:34:22,313 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0034
2025-06-03 11:34:22,324 - INFO - Online update complete. Loss: 0.6611
2025-06-03 11:34:22,324 - INFO - Running anomaly detection...
2025-06-03 11:34:22,325 - INFO - Starting anomaly detection.
2025-06-03 11:34:22,338 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113422_update_32.json
2025-06-03 11:34:22,338 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:34:22,356 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113422_update_32.pth and as latest_checkpoint.pth
2025-06-03 11:34:22,356 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.0000
2025-06-03 11:34:22,356 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:34:22,356 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.4821, MLP Score: 1.0000
2025-06-03 11:34:22,356 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.2586, MLP Score: 1.0000
2025-06-03 11:34:22,356 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2988, MLP Score: 1.0000
2025-06-03 11:34:22,357 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0361, MLP Score: 1.0000
2025-06-03 11:34:22,357 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.4683, MLP Score: 1.0000
2025-06-03 11:34:22,357 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:34:22,357 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8380, MLP Score: 0.9999
2025-06-03 11:34:22,357 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.8815, MLP Score: 1.0000
2025-06-03 11:34:22,357 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.1220, MLP Score: 0.9881
2025-06-03 11:34:22,357 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3257, MLP Score: 0.9985
2025-06-03 11:34:22,357 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.1046, MLP Score: 0.9975
2025-06-03 11:34:22,357 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-03 11:34:22,357 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-03 11:34:22,357 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot file.
2025-06-03 11:34:22,377 - INFO - Parsed 922 nodes.
2025-06-03 11:34:22,394 - INFO - Parsed 1981 edges.
2025-06-03 11:34:22,948 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:34:22,949 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:34:22,963 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-03 11:34:22,965 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:34:22,965 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-03 11:34:22,966 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-03 11:34:22,966 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:34:22,976 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:34:22,977 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:34:22,979 - DEBUG - Shape of encoded categorical edge features: torch.Size([1981, 2])
2025-06-03 11:34:22,980 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:34:22,980 - DEBUG - Shape of scaled numerical edge features: torch.Size([1981, 20])
2025-06-03 11:34:22,981 - DEBUG - Final edge attributes tensor shape: torch.Size([1981, 22])
2025-06-03 11:34:22,981 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:34:22,981 - INFO - Performing online update...
2025-06-03 11:34:22,981 - INFO - Starting online update for 50 steps.
2025-06-03 11:34:22,981 - DEBUG - Updated RunningStats: new_mean=0.5567951889267418, new_var=79800000000009.33, new_n=8010
2025-06-03 11:34:22,981 - DEBUG - Updated RunningStats: new_mean=0.5570820616445279, new_var=80100000000007.14, new_n=8040
2025-06-03 11:34:22,982 - DEBUG - Updated RunningStats: new_mean=0.7854738023180661, new_var=46280000000036.7, new_n=4650
2025-06-03 11:34:22,982 - DEBUG - Updated RunningStats: new_mean=0.7866304635161668, new_var=46500000000002.92, new_n=4672
2025-06-03 11:34:22,982 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:34:22,982 - DEBUG - Online update step: 1/50
2025-06-03 11:34:22,983 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:23,402 - DEBUG - Node anomaly scores shape: torch.Size([10700, 1])
2025-06-03 11:34:23,440 - DEBUG - Edge anomaly scores shape: torch.Size([22478, 1])
2025-06-03 11:34:23,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:24,193 - DEBUG - Step 1: Loss=0.7810
2025-06-03 11:34:24,193 - DEBUG - Online update step: 2/50
2025-06-03 11:34:24,195 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:24,593 - DEBUG - Node anomaly scores shape: torch.Size([10491, 1])
2025-06-03 11:34:24,631 - DEBUG - Edge anomaly scores shape: torch.Size([21977, 1])
2025-06-03 11:34:24,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:25,337 - DEBUG - Step 2: Loss=0.8566
2025-06-03 11:34:25,337 - DEBUG - Online update step: 3/50
2025-06-03 11:34:25,339 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:25,784 - DEBUG - Node anomaly scores shape: torch.Size([11616, 1])
2025-06-03 11:34:25,820 - DEBUG - Edge anomaly scores shape: torch.Size([24580, 1])
2025-06-03 11:34:25,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:26,671 - DEBUG - Step 3: Loss=0.6776
2025-06-03 11:34:26,671 - DEBUG - Online update step: 4/50
2025-06-03 11:34:26,672 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:27,107 - DEBUG - Node anomaly scores shape: torch.Size([11023, 1])
2025-06-03 11:34:27,143 - DEBUG - Edge anomaly scores shape: torch.Size([23155, 1])
2025-06-03 11:34:27,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:27,925 - DEBUG - Step 4: Loss=0.6643
2025-06-03 11:34:27,926 - DEBUG - Online update step: 5/50
2025-06-03 11:34:27,928 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:28,358 - DEBUG - Node anomaly scores shape: torch.Size([10787, 1])
2025-06-03 11:34:28,397 - DEBUG - Edge anomaly scores shape: torch.Size([22619, 1])
2025-06-03 11:34:28,397 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:29,130 - DEBUG - Step 5: Loss=0.7100
2025-06-03 11:34:29,130 - DEBUG - Online update step: 6/50
2025-06-03 11:34:29,133 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:29,617 - DEBUG - Node anomaly scores shape: torch.Size([11402, 1])
2025-06-03 11:34:29,660 - DEBUG - Edge anomaly scores shape: torch.Size([23992, 1])
2025-06-03 11:34:29,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:30,463 - DEBUG - Step 6: Loss=0.6698
2025-06-03 11:34:30,463 - DEBUG - Online update step: 7/50
2025-06-03 11:34:30,465 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:30,859 - DEBUG - Node anomaly scores shape: torch.Size([10179, 1])
2025-06-03 11:34:30,895 - DEBUG - Edge anomaly scores shape: torch.Size([21232, 1])
2025-06-03 11:34:30,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:31,715 - DEBUG - Step 7: Loss=0.7132
2025-06-03 11:34:31,715 - DEBUG - Online update step: 8/50
2025-06-03 11:34:31,718 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:32,210 - DEBUG - Node anomaly scores shape: torch.Size([10904, 1])
2025-06-03 11:34:32,255 - DEBUG - Edge anomaly scores shape: torch.Size([22789, 1])
2025-06-03 11:34:32,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:33,212 - DEBUG - Step 8: Loss=0.7173
2025-06-03 11:34:33,213 - DEBUG - Online update step: 9/50
2025-06-03 11:34:33,216 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:33,719 - DEBUG - Node anomaly scores shape: torch.Size([11086, 1])
2025-06-03 11:34:33,763 - DEBUG - Edge anomaly scores shape: torch.Size([23361, 1])
2025-06-03 11:34:33,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:34,707 - DEBUG - Step 9: Loss=0.6540
2025-06-03 11:34:34,707 - DEBUG - Online update step: 10/50
2025-06-03 11:34:34,709 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:35,147 - DEBUG - Node anomaly scores shape: torch.Size([10179, 1])
2025-06-03 11:34:35,185 - DEBUG - Edge anomaly scores shape: torch.Size([21195, 1])
2025-06-03 11:34:35,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:35,929 - DEBUG - Step 10: Loss=0.6497
2025-06-03 11:34:35,929 - DEBUG - Online update step: 11/50
2025-06-03 11:34:35,931 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:36,296 - DEBUG - Node anomaly scores shape: torch.Size([10445, 1])
2025-06-03 11:34:36,329 - DEBUG - Edge anomaly scores shape: torch.Size([21594, 1])
2025-06-03 11:34:36,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:36,939 - DEBUG - Step 11: Loss=0.6188
2025-06-03 11:34:36,939 - DEBUG - Online update step: 12/50
2025-06-03 11:34:36,941 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:37,339 - DEBUG - Node anomaly scores shape: torch.Size([11413, 1])
2025-06-03 11:34:37,376 - DEBUG - Edge anomaly scores shape: torch.Size([23927, 1])
2025-06-03 11:34:37,377 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:38,029 - DEBUG - Step 12: Loss=0.6938
2025-06-03 11:34:38,029 - DEBUG - Online update step: 13/50
2025-06-03 11:34:38,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:38,408 - DEBUG - Node anomaly scores shape: torch.Size([11107, 1])
2025-06-03 11:34:38,440 - DEBUG - Edge anomaly scores shape: torch.Size([23254, 1])
2025-06-03 11:34:38,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:39,209 - DEBUG - Step 13: Loss=0.6413
2025-06-03 11:34:39,210 - DEBUG - Online update step: 14/50
2025-06-03 11:34:39,211 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:39,521 - DEBUG - Node anomaly scores shape: torch.Size([8942, 1])
2025-06-03 11:34:39,547 - DEBUG - Edge anomaly scores shape: torch.Size([18303, 1])
2025-06-03 11:34:39,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:40,115 - DEBUG - Step 14: Loss=0.6490
2025-06-03 11:34:40,115 - DEBUG - Online update step: 15/50
2025-06-03 11:34:40,116 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:40,509 - DEBUG - Node anomaly scores shape: torch.Size([10712, 1])
2025-06-03 11:34:40,542 - DEBUG - Edge anomaly scores shape: torch.Size([22420, 1])
2025-06-03 11:34:40,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:41,258 - DEBUG - Step 15: Loss=0.6602
2025-06-03 11:34:41,259 - DEBUG - Online update step: 16/50
2025-06-03 11:34:41,260 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:41,662 - DEBUG - Node anomaly scores shape: torch.Size([11206, 1])
2025-06-03 11:34:41,699 - DEBUG - Edge anomaly scores shape: torch.Size([23520, 1])
2025-06-03 11:34:41,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:42,391 - DEBUG - Step 16: Loss=0.6222
2025-06-03 11:34:42,391 - DEBUG - Online update step: 17/50
2025-06-03 11:34:42,393 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:42,736 - DEBUG - Node anomaly scores shape: torch.Size([10021, 1])
2025-06-03 11:34:42,766 - DEBUG - Edge anomaly scores shape: torch.Size([20684, 1])
2025-06-03 11:34:42,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:43,398 - DEBUG - Step 17: Loss=0.7916
2025-06-03 11:34:43,398 - DEBUG - Online update step: 18/50
2025-06-03 11:34:43,400 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:43,786 - DEBUG - Node anomaly scores shape: torch.Size([10542, 1])
2025-06-03 11:34:43,819 - DEBUG - Edge anomaly scores shape: torch.Size([21899, 1])
2025-06-03 11:34:43,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:44,502 - DEBUG - Step 18: Loss=0.9296
2025-06-03 11:34:44,502 - DEBUG - Online update step: 19/50
2025-06-03 11:34:44,504 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:44,942 - DEBUG - Node anomaly scores shape: torch.Size([11588, 1])
2025-06-03 11:34:44,978 - DEBUG - Edge anomaly scores shape: torch.Size([24467, 1])
2025-06-03 11:34:44,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:45,740 - DEBUG - Step 19: Loss=0.7521
2025-06-03 11:34:45,740 - DEBUG - Online update step: 20/50
2025-06-03 11:34:45,741 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:46,089 - DEBUG - Node anomaly scores shape: torch.Size([10125, 1])
2025-06-03 11:34:46,119 - DEBUG - Edge anomaly scores shape: torch.Size([20988, 1])
2025-06-03 11:34:46,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:46,728 - DEBUG - Step 20: Loss=0.6724
2025-06-03 11:34:46,728 - DEBUG - Online update step: 21/50
2025-06-03 11:34:46,730 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:47,108 - DEBUG - Node anomaly scores shape: torch.Size([10799, 1])
2025-06-03 11:34:47,142 - DEBUG - Edge anomaly scores shape: torch.Size([22638, 1])
2025-06-03 11:34:47,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:47,798 - DEBUG - Step 21: Loss=0.7013
2025-06-03 11:34:47,799 - DEBUG - Online update step: 22/50
2025-06-03 11:34:47,800 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:48,202 - DEBUG - Node anomaly scores shape: torch.Size([11400, 1])
2025-06-03 11:34:48,237 - DEBUG - Edge anomaly scores shape: torch.Size([23927, 1])
2025-06-03 11:34:48,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:49,010 - DEBUG - Step 22: Loss=0.6866
2025-06-03 11:34:49,010 - DEBUG - Online update step: 23/50
2025-06-03 11:34:49,012 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:49,418 - DEBUG - Node anomaly scores shape: torch.Size([11395, 1])
2025-06-03 11:34:49,453 - DEBUG - Edge anomaly scores shape: torch.Size([24065, 1])
2025-06-03 11:34:49,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:50,208 - DEBUG - Step 23: Loss=0.6334
2025-06-03 11:34:50,208 - DEBUG - Online update step: 24/50
2025-06-03 11:34:50,210 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:50,561 - DEBUG - Node anomaly scores shape: torch.Size([9874, 1])
2025-06-03 11:34:50,592 - DEBUG - Edge anomaly scores shape: torch.Size([20400, 1])
2025-06-03 11:34:50,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:51,253 - DEBUG - Step 24: Loss=0.6566
2025-06-03 11:34:51,253 - DEBUG - Online update step: 25/50
2025-06-03 11:34:51,255 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:51,642 - DEBUG - Node anomaly scores shape: torch.Size([10506, 1])
2025-06-03 11:34:51,677 - DEBUG - Edge anomaly scores shape: torch.Size([22006, 1])
2025-06-03 11:34:51,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:52,309 - DEBUG - Step 25: Loss=0.6453
2025-06-03 11:34:52,310 - DEBUG - Online update step: 26/50
2025-06-03 11:34:52,311 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:52,661 - DEBUG - Node anomaly scores shape: torch.Size([9926, 1])
2025-06-03 11:34:52,695 - DEBUG - Edge anomaly scores shape: torch.Size([20483, 1])
2025-06-03 11:34:52,696 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:53,404 - DEBUG - Step 26: Loss=0.6252
2025-06-03 11:34:53,405 - DEBUG - Online update step: 27/50
2025-06-03 11:34:53,407 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:53,857 - DEBUG - Node anomaly scores shape: torch.Size([11316, 1])
2025-06-03 11:34:53,897 - DEBUG - Edge anomaly scores shape: torch.Size([23953, 1])
2025-06-03 11:34:53,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:54,655 - DEBUG - Step 27: Loss=0.6373
2025-06-03 11:34:54,655 - DEBUG - Online update step: 28/50
2025-06-03 11:34:54,657 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:55,059 - DEBUG - Node anomaly scores shape: torch.Size([10602, 1])
2025-06-03 11:34:55,098 - DEBUG - Edge anomaly scores shape: torch.Size([22149, 1])
2025-06-03 11:34:55,099 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:55,842 - DEBUG - Step 28: Loss=0.6608
2025-06-03 11:34:55,843 - DEBUG - Online update step: 29/50
2025-06-03 11:34:55,845 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:56,266 - DEBUG - Node anomaly scores shape: torch.Size([10287, 1])
2025-06-03 11:34:56,307 - DEBUG - Edge anomaly scores shape: torch.Size([21347, 1])
2025-06-03 11:34:56,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:57,051 - DEBUG - Step 29: Loss=0.6327
2025-06-03 11:34:57,052 - DEBUG - Online update step: 30/50
2025-06-03 11:34:57,054 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:57,540 - DEBUG - Node anomaly scores shape: torch.Size([11121, 1])
2025-06-03 11:34:57,581 - DEBUG - Edge anomaly scores shape: torch.Size([23368, 1])
2025-06-03 11:34:57,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:58,421 - DEBUG - Step 30: Loss=0.6419
2025-06-03 11:34:58,421 - DEBUG - Online update step: 31/50
2025-06-03 11:34:58,424 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:34:58,913 - DEBUG - Node anomaly scores shape: torch.Size([11141, 1])
2025-06-03 11:34:58,956 - DEBUG - Edge anomaly scores shape: torch.Size([23371, 1])
2025-06-03 11:34:58,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:34:59,765 - DEBUG - Step 31: Loss=0.6434
2025-06-03 11:34:59,765 - DEBUG - Online update step: 32/50
2025-06-03 11:34:59,767 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:00,222 - DEBUG - Node anomaly scores shape: torch.Size([10687, 1])
2025-06-03 11:35:00,273 - DEBUG - Edge anomaly scores shape: torch.Size([22286, 1])
2025-06-03 11:35:00,274 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:01,026 - DEBUG - Step 32: Loss=0.6112
2025-06-03 11:35:01,027 - DEBUG - Online update step: 33/50
2025-06-03 11:35:01,029 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:01,467 - DEBUG - Node anomaly scores shape: torch.Size([10601, 1])
2025-06-03 11:35:01,506 - DEBUG - Edge anomaly scores shape: torch.Size([22192, 1])
2025-06-03 11:35:01,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:02,331 - DEBUG - Step 33: Loss=0.7133
2025-06-03 11:35:02,331 - DEBUG - Online update step: 34/50
2025-06-03 11:35:02,333 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:02,729 - DEBUG - Node anomaly scores shape: torch.Size([9737, 1])
2025-06-03 11:35:02,765 - DEBUG - Edge anomaly scores shape: torch.Size([20208, 1])
2025-06-03 11:35:02,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:03,416 - DEBUG - Step 34: Loss=0.8039
2025-06-03 11:35:03,416 - DEBUG - Online update step: 35/50
2025-06-03 11:35:03,420 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:03,926 - DEBUG - Node anomaly scores shape: torch.Size([11374, 1])
2025-06-03 11:35:03,958 - DEBUG - Edge anomaly scores shape: torch.Size([24021, 1])
2025-06-03 11:35:03,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:04,593 - DEBUG - Step 35: Loss=0.6961
2025-06-03 11:35:04,593 - DEBUG - Online update step: 36/50
2025-06-03 11:35:04,595 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:04,945 - DEBUG - Node anomaly scores shape: torch.Size([10776, 1])
2025-06-03 11:35:04,975 - DEBUG - Edge anomaly scores shape: torch.Size([22505, 1])
2025-06-03 11:35:04,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:05,581 - DEBUG - Step 36: Loss=0.6403
2025-06-03 11:35:05,581 - DEBUG - Online update step: 37/50
2025-06-03 11:35:05,584 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:05,904 - DEBUG - Node anomaly scores shape: torch.Size([9595, 1])
2025-06-03 11:35:05,933 - DEBUG - Edge anomaly scores shape: torch.Size([19796, 1])
2025-06-03 11:35:05,934 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:06,476 - DEBUG - Step 37: Loss=0.6515
2025-06-03 11:35:06,476 - DEBUG - Online update step: 38/50
2025-06-03 11:35:06,479 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:06,863 - DEBUG - Node anomaly scores shape: torch.Size([10322, 1])
2025-06-03 11:35:06,891 - DEBUG - Edge anomaly scores shape: torch.Size([21477, 1])
2025-06-03 11:35:06,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:07,494 - DEBUG - Step 38: Loss=0.6624
2025-06-03 11:35:07,494 - DEBUG - Online update step: 39/50
2025-06-03 11:35:07,496 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:07,896 - DEBUG - Node anomaly scores shape: torch.Size([11160, 1])
2025-06-03 11:35:07,927 - DEBUG - Edge anomaly scores shape: torch.Size([23422, 1])
2025-06-03 11:35:07,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:08,601 - DEBUG - Step 39: Loss=0.6415
2025-06-03 11:35:08,601 - DEBUG - Online update step: 40/50
2025-06-03 11:35:08,604 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:08,953 - DEBUG - Node anomaly scores shape: torch.Size([10130, 1])
2025-06-03 11:35:08,982 - DEBUG - Edge anomaly scores shape: torch.Size([21105, 1])
2025-06-03 11:35:08,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:09,554 - DEBUG - Step 40: Loss=0.6240
2025-06-03 11:35:09,555 - DEBUG - Online update step: 41/50
2025-06-03 11:35:09,557 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:09,962 - DEBUG - Node anomaly scores shape: torch.Size([10894, 1])
2025-06-03 11:35:09,995 - DEBUG - Edge anomaly scores shape: torch.Size([22878, 1])
2025-06-03 11:35:09,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:10,612 - DEBUG - Step 41: Loss=0.7357
2025-06-03 11:35:10,612 - DEBUG - Online update step: 42/50
2025-06-03 11:35:10,614 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:10,951 - DEBUG - Node anomaly scores shape: torch.Size([9518, 1])
2025-06-03 11:35:10,979 - DEBUG - Edge anomaly scores shape: torch.Size([19596, 1])
2025-06-03 11:35:10,980 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:11,526 - DEBUG - Step 42: Loss=0.7669
2025-06-03 11:35:11,526 - DEBUG - Online update step: 43/50
2025-06-03 11:35:11,528 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:11,907 - DEBUG - Node anomaly scores shape: torch.Size([11029, 1])
2025-06-03 11:35:11,940 - DEBUG - Edge anomaly scores shape: torch.Size([23138, 1])
2025-06-03 11:35:11,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:12,563 - DEBUG - Step 43: Loss=0.6231
2025-06-03 11:35:12,563 - DEBUG - Online update step: 44/50
2025-06-03 11:35:12,565 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:13,030 - DEBUG - Node anomaly scores shape: torch.Size([12536, 1])
2025-06-03 11:35:13,070 - DEBUG - Edge anomaly scores shape: torch.Size([26597, 1])
2025-06-03 11:35:13,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:13,742 - DEBUG - Step 44: Loss=0.6560
2025-06-03 11:35:13,742 - DEBUG - Online update step: 45/50
2025-06-03 11:35:13,744 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:14,136 - DEBUG - Node anomaly scores shape: torch.Size([11437, 1])
2025-06-03 11:35:14,173 - DEBUG - Edge anomaly scores shape: torch.Size([23994, 1])
2025-06-03 11:35:14,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:14,756 - DEBUG - Step 45: Loss=0.7012
2025-06-03 11:35:14,757 - DEBUG - Online update step: 46/50
2025-06-03 11:35:14,758 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:15,190 - DEBUG - Node anomaly scores shape: torch.Size([12081, 1])
2025-06-03 11:35:15,231 - DEBUG - Edge anomaly scores shape: torch.Size([25554, 1])
2025-06-03 11:35:15,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:16,005 - DEBUG - Step 46: Loss=0.7275
2025-06-03 11:35:16,006 - DEBUG - Online update step: 47/50
2025-06-03 11:35:16,008 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:16,399 - DEBUG - Node anomaly scores shape: torch.Size([11262, 1])
2025-06-03 11:35:16,437 - DEBUG - Edge anomaly scores shape: torch.Size([23690, 1])
2025-06-03 11:35:16,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:17,137 - DEBUG - Step 47: Loss=0.6445
2025-06-03 11:35:17,137 - DEBUG - Online update step: 48/50
2025-06-03 11:35:17,139 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:17,509 - DEBUG - Node anomaly scores shape: torch.Size([10911, 1])
2025-06-03 11:35:17,541 - DEBUG - Edge anomaly scores shape: torch.Size([22794, 1])
2025-06-03 11:35:17,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:18,194 - DEBUG - Step 48: Loss=0.6256
2025-06-03 11:35:18,194 - DEBUG - Online update step: 49/50
2025-06-03 11:35:18,196 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:18,531 - DEBUG - Node anomaly scores shape: torch.Size([9568, 1])
2025-06-03 11:35:18,560 - DEBUG - Edge anomaly scores shape: torch.Size([19755, 1])
2025-06-03 11:35:18,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:19,182 - DEBUG - Step 49: Loss=0.6612
2025-06-03 11:35:19,182 - DEBUG - Online update step: 50/50
2025-06-03 11:35:19,185 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:19,608 - DEBUG - Node anomaly scores shape: torch.Size([11253, 1])
2025-06-03 11:35:19,642 - DEBUG - Edge anomaly scores shape: torch.Size([23579, 1])
2025-06-03 11:35:19,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:20,336 - DEBUG - Step 50: Loss=0.6540
2025-06-03 11:35:20,336 - INFO - Online update finished. Average loss: 0.6826, Learning rate: 0.002181
2025-06-03 11:35:20,337 - DEBUG - Current node mean: [-2.4824494e-08  2.4824494e-08  3.1030618e-09 -6.2061236e-09
 -1.1119305e-08  2.6376025e-08 -1.0343539e-08  2.0687079e-09
 -5.1717697e-09  1.6549663e-08  3.3616502e-08 -7.2404776e-09
 -2.9479088e-08  6.5293593e-09  1.3575895e-08  8.2748315e-09
 -9.8263619e-09  0.0000000e+00  0.0000000e+00 -2.6893202e-08
  0.0000000e+00  0.0000000e+00 -6.2061236e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4124180e+00  5.6789498e+00  9.6282116e-10  1.4442316e-09
  2.8884632e-09 -4.8141058e-10  1.4442316e-09  4.8141056e-09
 -9.6282116e-10  0.0000000e+00 -3.8512846e-09  3.8512846e-09
  4.0919899e-09  1.2516675e-08 -1.0109622e-08 -9.6282116e-10
 -9.6282116e-10 -9.6282116e-10 -9.6282116e-10 -9.6282116e-10
 -9.6282116e-10 -9.6282116e-10]
2025-06-03 11:35:20,337 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0046
2025-06-03 11:35:20,341 - INFO - Online update complete. Loss: 0.6826
2025-06-03 11:35:20,341 - INFO - Running anomaly detection...
2025-06-03 11:35:20,342 - INFO - Starting anomaly detection.
2025-06-03 11:35:20,355 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113520_update_33.json
2025-06-03 11:35:20,355 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:35:20,376 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113520_update_33.pth and as latest_checkpoint.pth
2025-06-03 11:35:20,377 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.0000
2025-06-03 11:35:20,377 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:35:20,377 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.8872, MLP Score: 1.0000
2025-06-03 11:35:20,377 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.6837, MLP Score: 1.0000
2025-06-03 11:35:20,377 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 0.6601, MLP Score: 1.0000
2025-06-03 11:35:20,377 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0045, MLP Score: 1.0000
2025-06-03 11:35:20,377 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.5708, MLP Score: 1.0000
2025-06-03 11:35:20,377 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:35:20,377 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8297, MLP Score: 0.9996
2025-06-03 11:35:20,377 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.9368, MLP Score: 0.9999
2025-06-03 11:35:20,377 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.2936, MLP Score: 0.9928
2025-06-03 11:35:20,377 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3911, MLP Score: 0.9988
2025-06-03 11:35:20,377 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.2129, MLP Score: 0.9991
2025-06-03 11:35:20,377 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-03 11:35:20,377 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-03 11:35:20,377 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot file.
2025-06-03 11:35:20,397 - INFO - Parsed 934 nodes.
2025-06-03 11:35:20,417 - INFO - Parsed 2007 edges.
2025-06-03 11:35:20,965 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:35:20,965 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:35:20,980 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-03 11:35:20,982 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:35:20,982 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-03 11:35:20,983 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-03 11:35:20,983 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:35:20,993 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:35:20,995 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:35:20,997 - DEBUG - Shape of encoded categorical edge features: torch.Size([2007, 2])
2025-06-03 11:35:20,998 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:35:20,999 - DEBUG - Shape of scaled numerical edge features: torch.Size([2007, 20])
2025-06-03 11:35:20,999 - DEBUG - Final edge attributes tensor shape: torch.Size([2007, 22])
2025-06-03 11:35:20,999 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:35:20,999 - INFO - Performing online update...
2025-06-03 11:35:20,999 - INFO - Starting online update for 50 steps.
2025-06-03 11:35:21,000 - DEBUG - Updated RunningStats: new_mean=0.5550111246099565, new_var=80400000000009.28, new_n=8070
2025-06-03 11:35:21,000 - DEBUG - Updated RunningStats: new_mean=0.5553024635511573, new_var=80700000000007.16, new_n=8100
2025-06-03 11:35:21,000 - DEBUG - Updated RunningStats: new_mean=0.7844549842585405, new_var=46720000000036.72, new_n=4694
2025-06-03 11:35:21,000 - DEBUG - Updated RunningStats: new_mean=0.7856052095081786, new_var=46940000000002.93, new_n=4716
2025-06-03 11:35:21,000 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:35:21,000 - DEBUG - Online update step: 1/50
2025-06-03 11:35:21,002 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:21,426 - DEBUG - Node anomaly scores shape: torch.Size([11145, 1])
2025-06-03 11:35:21,467 - DEBUG - Edge anomaly scores shape: torch.Size([23505, 1])
2025-06-03 11:35:21,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:22,234 - DEBUG - Step 1: Loss=0.6151
2025-06-03 11:35:22,234 - DEBUG - Online update step: 2/50
2025-06-03 11:35:22,236 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:22,674 - DEBUG - Node anomaly scores shape: torch.Size([11111, 1])
2025-06-03 11:35:22,716 - DEBUG - Edge anomaly scores shape: torch.Size([23405, 1])
2025-06-03 11:35:22,717 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:23,535 - DEBUG - Step 2: Loss=0.6520
2025-06-03 11:35:23,535 - DEBUG - Online update step: 3/50
2025-06-03 11:35:23,538 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:24,183 - DEBUG - Node anomaly scores shape: torch.Size([11159, 1])
2025-06-03 11:35:24,223 - DEBUG - Edge anomaly scores shape: torch.Size([23399, 1])
2025-06-03 11:35:24,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:25,046 - DEBUG - Step 3: Loss=0.6434
2025-06-03 11:35:25,046 - DEBUG - Online update step: 4/50
2025-06-03 11:35:25,048 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:25,523 - DEBUG - Node anomaly scores shape: torch.Size([11115, 1])
2025-06-03 11:35:25,564 - DEBUG - Edge anomaly scores shape: torch.Size([23294, 1])
2025-06-03 11:35:25,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:26,371 - DEBUG - Step 4: Loss=0.6313
2025-06-03 11:35:26,371 - DEBUG - Online update step: 5/50
2025-06-03 11:35:26,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:26,891 - DEBUG - Node anomaly scores shape: torch.Size([11436, 1])
2025-06-03 11:35:26,938 - DEBUG - Edge anomaly scores shape: torch.Size([24076, 1])
2025-06-03 11:35:26,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:27,859 - DEBUG - Step 5: Loss=0.6099
2025-06-03 11:35:27,860 - DEBUG - Online update step: 6/50
2025-06-03 11:35:27,861 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:28,180 - DEBUG - Node anomaly scores shape: torch.Size([9314, 1])
2025-06-03 11:35:28,205 - DEBUG - Edge anomaly scores shape: torch.Size([19158, 1])
2025-06-03 11:35:28,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:28,771 - DEBUG - Step 6: Loss=0.6483
2025-06-03 11:35:28,771 - DEBUG - Online update step: 7/50
2025-06-03 11:35:28,772 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:29,085 - DEBUG - Node anomaly scores shape: torch.Size([9274, 1])
2025-06-03 11:35:29,113 - DEBUG - Edge anomaly scores shape: torch.Size([19074, 1])
2025-06-03 11:35:29,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:29,673 - DEBUG - Step 7: Loss=0.6355
2025-06-03 11:35:29,673 - DEBUG - Online update step: 8/50
2025-06-03 11:35:29,676 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:30,044 - DEBUG - Node anomaly scores shape: torch.Size([10233, 1])
2025-06-03 11:35:30,075 - DEBUG - Edge anomaly scores shape: torch.Size([21210, 1])
2025-06-03 11:35:30,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:30,674 - DEBUG - Step 8: Loss=0.6119
2025-06-03 11:35:30,675 - DEBUG - Online update step: 9/50
2025-06-03 11:35:30,676 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:31,043 - DEBUG - Node anomaly scores shape: torch.Size([10582, 1])
2025-06-03 11:35:31,075 - DEBUG - Edge anomaly scores shape: torch.Size([22200, 1])
2025-06-03 11:35:31,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:31,686 - DEBUG - Step 9: Loss=0.6247
2025-06-03 11:35:31,687 - DEBUG - Online update step: 10/50
2025-06-03 11:35:31,689 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:32,067 - DEBUG - Node anomaly scores shape: torch.Size([10876, 1])
2025-06-03 11:35:32,102 - DEBUG - Edge anomaly scores shape: torch.Size([22708, 1])
2025-06-03 11:35:32,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:32,827 - DEBUG - Step 10: Loss=0.6259
2025-06-03 11:35:32,827 - DEBUG - Online update step: 11/50
2025-06-03 11:35:32,829 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:33,163 - DEBUG - Node anomaly scores shape: torch.Size([9429, 1])
2025-06-03 11:35:33,191 - DEBUG - Edge anomaly scores shape: torch.Size([19344, 1])
2025-06-03 11:35:33,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:33,770 - DEBUG - Step 11: Loss=0.6282
2025-06-03 11:35:33,770 - DEBUG - Online update step: 12/50
2025-06-03 11:35:33,773 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:34,082 - DEBUG - Node anomaly scores shape: torch.Size([9128, 1])
2025-06-03 11:35:34,107 - DEBUG - Edge anomaly scores shape: torch.Size([18721, 1])
2025-06-03 11:35:34,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:34,687 - DEBUG - Step 12: Loss=0.6498
2025-06-03 11:35:34,688 - DEBUG - Online update step: 13/50
2025-06-03 11:35:34,689 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:35,042 - DEBUG - Node anomaly scores shape: torch.Size([9966, 1])
2025-06-03 11:35:35,070 - DEBUG - Edge anomaly scores shape: torch.Size([20743, 1])
2025-06-03 11:35:35,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:35,645 - DEBUG - Step 13: Loss=0.6420
2025-06-03 11:35:35,645 - DEBUG - Online update step: 14/50
2025-06-03 11:35:35,647 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:36,027 - DEBUG - Node anomaly scores shape: torch.Size([10415, 1])
2025-06-03 11:35:36,058 - DEBUG - Edge anomaly scores shape: torch.Size([21701, 1])
2025-06-03 11:35:36,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:36,694 - DEBUG - Step 14: Loss=0.6196
2025-06-03 11:35:36,695 - DEBUG - Online update step: 15/50
2025-06-03 11:35:36,696 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:37,090 - DEBUG - Node anomaly scores shape: torch.Size([11217, 1])
2025-06-03 11:35:37,125 - DEBUG - Edge anomaly scores shape: torch.Size([23593, 1])
2025-06-03 11:35:37,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:37,763 - DEBUG - Step 15: Loss=0.6094
2025-06-03 11:35:37,763 - DEBUG - Online update step: 16/50
2025-06-03 11:35:37,765 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:38,123 - DEBUG - Node anomaly scores shape: torch.Size([10586, 1])
2025-06-03 11:35:38,154 - DEBUG - Edge anomaly scores shape: torch.Size([22157, 1])
2025-06-03 11:35:38,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:38,854 - DEBUG - Step 16: Loss=0.6520
2025-06-03 11:35:38,855 - DEBUG - Online update step: 17/50
2025-06-03 11:35:38,856 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:39,253 - DEBUG - Node anomaly scores shape: torch.Size([10866, 1])
2025-06-03 11:35:39,284 - DEBUG - Edge anomaly scores shape: torch.Size([22824, 1])
2025-06-03 11:35:39,285 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:39,955 - DEBUG - Step 17: Loss=0.6352
2025-06-03 11:35:39,955 - DEBUG - Online update step: 18/50
2025-06-03 11:35:39,957 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:40,321 - DEBUG - Node anomaly scores shape: torch.Size([10707, 1])
2025-06-03 11:35:40,354 - DEBUG - Edge anomaly scores shape: torch.Size([22418, 1])
2025-06-03 11:35:40,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:41,002 - DEBUG - Step 18: Loss=0.6132
2025-06-03 11:35:41,002 - DEBUG - Online update step: 19/50
2025-06-03 11:35:41,004 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:41,415 - DEBUG - Node anomaly scores shape: torch.Size([11251, 1])
2025-06-03 11:35:41,448 - DEBUG - Edge anomaly scores shape: torch.Size([23590, 1])
2025-06-03 11:35:41,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:42,154 - DEBUG - Step 19: Loss=0.6153
2025-06-03 11:35:42,154 - DEBUG - Online update step: 20/50
2025-06-03 11:35:42,157 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:42,532 - DEBUG - Node anomaly scores shape: torch.Size([10862, 1])
2025-06-03 11:35:42,564 - DEBUG - Edge anomaly scores shape: torch.Size([22617, 1])
2025-06-03 11:35:42,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:43,260 - DEBUG - Step 20: Loss=0.6458
2025-06-03 11:35:43,260 - DEBUG - Online update step: 21/50
2025-06-03 11:35:43,263 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:43,618 - DEBUG - Node anomaly scores shape: torch.Size([10063, 1])
2025-06-03 11:35:43,650 - DEBUG - Edge anomaly scores shape: torch.Size([20972, 1])
2025-06-03 11:35:43,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:44,303 - DEBUG - Step 21: Loss=0.6207
2025-06-03 11:35:44,303 - DEBUG - Online update step: 22/50
2025-06-03 11:35:44,305 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:44,703 - DEBUG - Node anomaly scores shape: torch.Size([11209, 1])
2025-06-03 11:35:44,737 - DEBUG - Edge anomaly scores shape: torch.Size([23485, 1])
2025-06-03 11:35:44,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:45,539 - DEBUG - Step 22: Loss=0.6405
2025-06-03 11:35:45,539 - DEBUG - Online update step: 23/50
2025-06-03 11:35:45,542 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:45,934 - DEBUG - Node anomaly scores shape: torch.Size([10381, 1])
2025-06-03 11:35:45,968 - DEBUG - Edge anomaly scores shape: torch.Size([21668, 1])
2025-06-03 11:35:45,969 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:46,668 - DEBUG - Step 23: Loss=0.6287
2025-06-03 11:35:46,668 - DEBUG - Online update step: 24/50
2025-06-03 11:35:46,670 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:47,119 - DEBUG - Node anomaly scores shape: torch.Size([11235, 1])
2025-06-03 11:35:47,156 - DEBUG - Edge anomaly scores shape: torch.Size([23683, 1])
2025-06-03 11:35:47,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:47,979 - DEBUG - Step 24: Loss=0.6037
2025-06-03 11:35:47,979 - DEBUG - Online update step: 25/50
2025-06-03 11:35:47,982 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:48,478 - DEBUG - Node anomaly scores shape: torch.Size([11592, 1])
2025-06-03 11:35:48,520 - DEBUG - Edge anomaly scores shape: torch.Size([24498, 1])
2025-06-03 11:35:48,521 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:49,507 - DEBUG - Step 25: Loss=0.6065
2025-06-03 11:35:49,508 - DEBUG - Online update step: 26/50
2025-06-03 11:35:49,510 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:49,970 - DEBUG - Node anomaly scores shape: torch.Size([11135, 1])
2025-06-03 11:35:50,010 - DEBUG - Edge anomaly scores shape: torch.Size([23391, 1])
2025-06-03 11:35:50,011 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:50,914 - DEBUG - Step 26: Loss=0.6124
2025-06-03 11:35:50,914 - DEBUG - Online update step: 27/50
2025-06-03 11:35:50,916 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:51,345 - DEBUG - Node anomaly scores shape: torch.Size([10873, 1])
2025-06-03 11:35:51,384 - DEBUG - Edge anomaly scores shape: torch.Size([22743, 1])
2025-06-03 11:35:51,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:52,188 - DEBUG - Step 27: Loss=0.6110
2025-06-03 11:35:52,188 - DEBUG - Online update step: 28/50
2025-06-03 11:35:52,190 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:52,563 - DEBUG - Node anomaly scores shape: torch.Size([11015, 1])
2025-06-03 11:35:52,594 - DEBUG - Edge anomaly scores shape: torch.Size([23168, 1])
2025-06-03 11:35:52,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:53,283 - DEBUG - Step 28: Loss=0.7013
2025-06-03 11:35:53,284 - DEBUG - Online update step: 29/50
2025-06-03 11:35:53,286 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:53,631 - DEBUG - Node anomaly scores shape: torch.Size([10059, 1])
2025-06-03 11:35:53,662 - DEBUG - Edge anomaly scores shape: torch.Size([20945, 1])
2025-06-03 11:35:53,663 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:54,305 - DEBUG - Step 29: Loss=0.6844
2025-06-03 11:35:54,305 - DEBUG - Online update step: 30/50
2025-06-03 11:35:54,306 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:54,643 - DEBUG - Node anomaly scores shape: torch.Size([10094, 1])
2025-06-03 11:35:54,674 - DEBUG - Edge anomaly scores shape: torch.Size([21101, 1])
2025-06-03 11:35:54,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:55,356 - DEBUG - Step 30: Loss=0.6156
2025-06-03 11:35:55,357 - DEBUG - Online update step: 31/50
2025-06-03 11:35:55,358 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:55,698 - DEBUG - Node anomaly scores shape: torch.Size([10040, 1])
2025-06-03 11:35:55,727 - DEBUG - Edge anomaly scores shape: torch.Size([20765, 1])
2025-06-03 11:35:55,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:56,272 - DEBUG - Step 31: Loss=0.6338
2025-06-03 11:35:56,272 - DEBUG - Online update step: 32/50
2025-06-03 11:35:56,273 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:56,675 - DEBUG - Node anomaly scores shape: torch.Size([11468, 1])
2025-06-03 11:35:56,708 - DEBUG - Edge anomaly scores shape: torch.Size([24120, 1])
2025-06-03 11:35:56,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:57,390 - DEBUG - Step 32: Loss=0.6426
2025-06-03 11:35:57,390 - DEBUG - Online update step: 33/50
2025-06-03 11:35:57,393 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:57,726 - DEBUG - Node anomaly scores shape: torch.Size([9742, 1])
2025-06-03 11:35:57,754 - DEBUG - Edge anomaly scores shape: torch.Size([19952, 1])
2025-06-03 11:35:57,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:58,394 - DEBUG - Step 33: Loss=0.6517
2025-06-03 11:35:58,394 - DEBUG - Online update step: 34/50
2025-06-03 11:35:58,396 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:58,744 - DEBUG - Node anomaly scores shape: torch.Size([10492, 1])
2025-06-03 11:35:58,774 - DEBUG - Edge anomaly scores shape: torch.Size([21832, 1])
2025-06-03 11:35:58,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:35:59,433 - DEBUG - Step 34: Loss=0.6203
2025-06-03 11:35:59,433 - DEBUG - Online update step: 35/50
2025-06-03 11:35:59,435 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:35:59,768 - DEBUG - Node anomaly scores shape: torch.Size([10320, 1])
2025-06-03 11:35:59,798 - DEBUG - Edge anomaly scores shape: torch.Size([21464, 1])
2025-06-03 11:35:59,799 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:00,392 - DEBUG - Step 35: Loss=0.6342
2025-06-03 11:36:00,392 - DEBUG - Online update step: 36/50
2025-06-03 11:36:00,394 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:00,735 - DEBUG - Node anomaly scores shape: torch.Size([9946, 1])
2025-06-03 11:36:00,768 - DEBUG - Edge anomaly scores shape: torch.Size([20604, 1])
2025-06-03 11:36:00,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:01,376 - DEBUG - Step 36: Loss=0.6368
2025-06-03 11:36:01,377 - DEBUG - Online update step: 37/50
2025-06-03 11:36:01,379 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:01,752 - DEBUG - Node anomaly scores shape: torch.Size([10486, 1])
2025-06-03 11:36:01,784 - DEBUG - Edge anomaly scores shape: torch.Size([21847, 1])
2025-06-03 11:36:01,785 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:02,461 - DEBUG - Step 37: Loss=0.5894
2025-06-03 11:36:02,461 - DEBUG - Online update step: 38/50
2025-06-03 11:36:02,463 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:02,813 - DEBUG - Node anomaly scores shape: torch.Size([10335, 1])
2025-06-03 11:36:02,845 - DEBUG - Edge anomaly scores shape: torch.Size([21476, 1])
2025-06-03 11:36:02,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:03,529 - DEBUG - Step 38: Loss=0.6376
2025-06-03 11:36:03,529 - DEBUG - Online update step: 39/50
2025-06-03 11:36:03,532 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:03,926 - DEBUG - Node anomaly scores shape: torch.Size([11045, 1])
2025-06-03 11:36:03,960 - DEBUG - Edge anomaly scores shape: torch.Size([23117, 1])
2025-06-03 11:36:03,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:04,672 - DEBUG - Step 39: Loss=0.6269
2025-06-03 11:36:04,672 - DEBUG - Online update step: 40/50
2025-06-03 11:36:04,674 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:05,040 - DEBUG - Node anomaly scores shape: torch.Size([10396, 1])
2025-06-03 11:36:05,071 - DEBUG - Edge anomaly scores shape: torch.Size([21609, 1])
2025-06-03 11:36:05,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:05,705 - DEBUG - Step 40: Loss=0.6164
2025-06-03 11:36:05,706 - DEBUG - Online update step: 41/50
2025-06-03 11:36:05,707 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:06,039 - DEBUG - Node anomaly scores shape: torch.Size([9556, 1])
2025-06-03 11:36:06,072 - DEBUG - Edge anomaly scores shape: torch.Size([19767, 1])
2025-06-03 11:36:06,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:06,715 - DEBUG - Step 41: Loss=0.6829
2025-06-03 11:36:06,716 - DEBUG - Online update step: 42/50
2025-06-03 11:36:06,717 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:07,086 - DEBUG - Node anomaly scores shape: torch.Size([10155, 1])
2025-06-03 11:36:07,116 - DEBUG - Edge anomaly scores shape: torch.Size([21073, 1])
2025-06-03 11:36:07,117 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:07,871 - DEBUG - Step 42: Loss=0.6916
2025-06-03 11:36:07,871 - DEBUG - Online update step: 43/50
2025-06-03 11:36:07,873 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:08,277 - DEBUG - Node anomaly scores shape: torch.Size([10478, 1])
2025-06-03 11:36:08,311 - DEBUG - Edge anomaly scores shape: torch.Size([21834, 1])
2025-06-03 11:36:08,312 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:09,118 - DEBUG - Step 43: Loss=0.6293
2025-06-03 11:36:09,118 - DEBUG - Online update step: 44/50
2025-06-03 11:36:09,120 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:09,536 - DEBUG - Node anomaly scores shape: torch.Size([10896, 1])
2025-06-03 11:36:09,572 - DEBUG - Edge anomaly scores shape: torch.Size([22862, 1])
2025-06-03 11:36:09,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:10,380 - DEBUG - Step 44: Loss=0.6239
2025-06-03 11:36:10,380 - DEBUG - Online update step: 45/50
2025-06-03 11:36:10,383 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:10,790 - DEBUG - Node anomaly scores shape: torch.Size([10438, 1])
2025-06-03 11:36:10,826 - DEBUG - Edge anomaly scores shape: torch.Size([21771, 1])
2025-06-03 11:36:10,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:11,608 - DEBUG - Step 45: Loss=0.6222
2025-06-03 11:36:11,608 - DEBUG - Online update step: 46/50
2025-06-03 11:36:11,611 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:11,992 - DEBUG - Node anomaly scores shape: torch.Size([9440, 1])
2025-06-03 11:36:12,028 - DEBUG - Edge anomaly scores shape: torch.Size([19471, 1])
2025-06-03 11:36:12,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:12,809 - DEBUG - Step 46: Loss=0.6264
2025-06-03 11:36:12,809 - DEBUG - Online update step: 47/50
2025-06-03 11:36:12,813 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:13,304 - DEBUG - Node anomaly scores shape: torch.Size([10758, 1])
2025-06-03 11:36:13,344 - DEBUG - Edge anomaly scores shape: torch.Size([22542, 1])
2025-06-03 11:36:13,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:14,168 - DEBUG - Step 47: Loss=0.6262
2025-06-03 11:36:14,168 - DEBUG - Online update step: 48/50
2025-06-03 11:36:14,171 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:14,639 - DEBUG - Node anomaly scores shape: torch.Size([10840, 1])
2025-06-03 11:36:14,677 - DEBUG - Edge anomaly scores shape: torch.Size([22645, 1])
2025-06-03 11:36:14,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:15,474 - DEBUG - Step 48: Loss=0.6515
2025-06-03 11:36:15,475 - DEBUG - Online update step: 49/50
2025-06-03 11:36:15,478 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:15,903 - DEBUG - Node anomaly scores shape: torch.Size([10286, 1])
2025-06-03 11:36:15,945 - DEBUG - Edge anomaly scores shape: torch.Size([21408, 1])
2025-06-03 11:36:15,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:16,582 - DEBUG - Step 49: Loss=0.6136
2025-06-03 11:36:16,583 - DEBUG - Online update step: 50/50
2025-06-03 11:36:16,584 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:16,926 - DEBUG - Node anomaly scores shape: torch.Size([10527, 1])
2025-06-03 11:36:16,955 - DEBUG - Edge anomaly scores shape: torch.Size([22048, 1])
2025-06-03 11:36:16,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:17,519 - DEBUG - Step 50: Loss=0.6202
2025-06-03 11:36:17,519 - INFO - Online update finished. Average loss: 0.6322, Learning rate: 0.001964
2025-06-03 11:36:17,519 - DEBUG - Current node mean: [ 4.0842583e-09 -4.0842583e-09 -1.2252775e-08 -2.4505550e-08
 -1.8379163e-08  8.6790486e-09 -2.6037148e-08  4.0842583e-09
  2.0421291e-08 -7.1474520e-09  3.6247794e-08  1.0210646e-08
 -1.2252775e-08  1.0210646e-08  5.1053228e-10  6.1263874e-09
  1.0210646e-08  0.0000000e+00  0.0000000e+00  1.3018574e-08
  0.0000000e+00  0.0000000e+00 -3.8800454e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4110613e+00  5.6831093e+00 -4.7517403e-09 -2.8510443e-09
 -3.8013925e-09  9.5034813e-10 -5.2269145e-09 -8.5531333e-09
 -2.1382833e-09 -4.2765667e-09 -5.2269145e-09 -9.5034813e-10
 -5.2269145e-09  2.8510443e-09  8.0779587e-09  3.8013925e-09
  3.8013925e-09  3.8013925e-09  3.8013925e-09  3.8013925e-09
  3.8013925e-09  0.0000000e+00]
2025-06-03 11:36:17,520 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0027
2025-06-03 11:36:17,520 - INFO - Online update complete. Loss: 0.6322
2025-06-03 11:36:17,520 - INFO - Running anomaly detection...
2025-06-03 11:36:17,520 - INFO - Starting anomaly detection.
2025-06-03 11:36:17,540 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113617_update_34.json
2025-06-03 11:36:17,541 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:36:17,559 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113617_update_34.pth and as latest_checkpoint.pth
2025-06-03 11:36:17,559 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.0000
2025-06-03 11:36:17,559 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:36:17,559 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.2651, MLP Score: 1.0000
2025-06-03 11:36:17,559 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.0891, MLP Score: 1.0000
2025-06-03 11:36:17,559 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.0644, MLP Score: 1.0000
2025-06-03 11:36:17,559 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.6336, MLP Score: 1.0000
2025-06-03 11:36:17,559 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1370, MLP Score: 1.0000
2025-06-03 11:36:17,559 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:36:17,559 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5574, MLP Score: 0.9995
2025-06-03 11:36:17,559 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7733, MLP Score: 0.9996
2025-06-03 11:36:17,560 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.0092, MLP Score: 0.9999
2025-06-03 11:36:17,560 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.5902, MLP Score: 0.9947
2025-06-03 11:36:17,560 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.3926, MLP Score: 0.9976
2025-06-03 11:36:17,560 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-03 11:36:17,560 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-03 11:36:17,560 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot file.
2025-06-03 11:36:17,577 - INFO - Parsed 944 nodes.
2025-06-03 11:36:17,596 - INFO - Parsed 2034 edges.
2025-06-03 11:36:18,178 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:36:18,178 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:36:18,193 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-03 11:36:18,195 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:36:18,195 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-03 11:36:18,196 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-03 11:36:18,196 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:36:18,206 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:36:18,207 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:36:18,209 - DEBUG - Shape of encoded categorical edge features: torch.Size([2034, 2])
2025-06-03 11:36:18,210 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:36:18,210 - DEBUG - Shape of scaled numerical edge features: torch.Size([2034, 20])
2025-06-03 11:36:18,210 - DEBUG - Final edge attributes tensor shape: torch.Size([2034, 22])
2025-06-03 11:36:18,211 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:36:18,211 - INFO - Performing online update...
2025-06-03 11:36:18,211 - INFO - Starting online update for 50 steps.
2025-06-03 11:36:18,211 - DEBUG - Updated RunningStats: new_mean=0.5532533769641338, new_var=81000000000009.22, new_n=8130
2025-06-03 11:36:18,211 - DEBUG - Updated RunningStats: new_mean=0.5535490228374575, new_var=81300000000007.16, new_n=8160
2025-06-03 11:36:18,212 - DEBUG - Updated RunningStats: new_mean=0.7834556749488568, new_var=47160000000036.75, new_n=4738
2025-06-03 11:36:18,212 - DEBUG - Updated RunningStats: new_mean=0.7845985901948358, new_var=47380000000002.92, new_n=4760
2025-06-03 11:36:18,212 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:36:18,212 - DEBUG - Online update step: 1/50
2025-06-03 11:36:18,213 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:18,620 - DEBUG - Node anomaly scores shape: torch.Size([10863, 1])
2025-06-03 11:36:18,656 - DEBUG - Edge anomaly scores shape: torch.Size([22781, 1])
2025-06-03 11:36:18,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:19,330 - DEBUG - Step 1: Loss=0.6249
2025-06-03 11:36:19,330 - DEBUG - Online update step: 2/50
2025-06-03 11:36:19,332 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:19,763 - DEBUG - Node anomaly scores shape: torch.Size([11297, 1])
2025-06-03 11:36:19,798 - DEBUG - Edge anomaly scores shape: torch.Size([23764, 1])
2025-06-03 11:36:19,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:20,529 - DEBUG - Step 2: Loss=0.6096
2025-06-03 11:36:20,529 - DEBUG - Online update step: 3/50
2025-06-03 11:36:20,535 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:20,899 - DEBUG - Node anomaly scores shape: torch.Size([10766, 1])
2025-06-03 11:36:20,930 - DEBUG - Edge anomaly scores shape: torch.Size([22546, 1])
2025-06-03 11:36:20,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:21,597 - DEBUG - Step 3: Loss=0.6866
2025-06-03 11:36:21,598 - DEBUG - Online update step: 4/50
2025-06-03 11:36:21,601 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:21,993 - DEBUG - Node anomaly scores shape: torch.Size([11300, 1])
2025-06-03 11:36:22,029 - DEBUG - Edge anomaly scores shape: torch.Size([23817, 1])
2025-06-03 11:36:22,030 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:22,716 - DEBUG - Step 4: Loss=0.6765
2025-06-03 11:36:22,716 - DEBUG - Online update step: 5/50
2025-06-03 11:36:22,719 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:23,090 - DEBUG - Node anomaly scores shape: torch.Size([10901, 1])
2025-06-03 11:36:23,124 - DEBUG - Edge anomaly scores shape: torch.Size([22809, 1])
2025-06-03 11:36:23,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:23,866 - DEBUG - Step 5: Loss=0.6023
2025-06-03 11:36:23,866 - DEBUG - Online update step: 6/50
2025-06-03 11:36:23,869 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:24,282 - DEBUG - Node anomaly scores shape: torch.Size([11509, 1])
2025-06-03 11:36:24,317 - DEBUG - Edge anomaly scores shape: torch.Size([24327, 1])
2025-06-03 11:36:24,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:25,131 - DEBUG - Step 6: Loss=0.6454
2025-06-03 11:36:25,131 - DEBUG - Online update step: 7/50
2025-06-03 11:36:25,133 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:25,492 - DEBUG - Node anomaly scores shape: torch.Size([10370, 1])
2025-06-03 11:36:25,524 - DEBUG - Edge anomaly scores shape: torch.Size([21519, 1])
2025-06-03 11:36:25,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:26,156 - DEBUG - Step 7: Loss=0.6816
2025-06-03 11:36:26,156 - DEBUG - Online update step: 8/50
2025-06-03 11:36:26,158 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:26,506 - DEBUG - Node anomaly scores shape: torch.Size([10626, 1])
2025-06-03 11:36:26,537 - DEBUG - Edge anomaly scores shape: torch.Size([22268, 1])
2025-06-03 11:36:26,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:27,209 - DEBUG - Step 8: Loss=0.6210
2025-06-03 11:36:27,210 - DEBUG - Online update step: 9/50
2025-06-03 11:36:27,212 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:27,564 - DEBUG - Node anomaly scores shape: torch.Size([10163, 1])
2025-06-03 11:36:27,594 - DEBUG - Edge anomaly scores shape: torch.Size([21127, 1])
2025-06-03 11:36:27,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:28,248 - DEBUG - Step 9: Loss=0.6826
2025-06-03 11:36:28,249 - DEBUG - Online update step: 10/50
2025-06-03 11:36:28,251 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:28,684 - DEBUG - Node anomaly scores shape: torch.Size([11837, 1])
2025-06-03 11:36:28,721 - DEBUG - Edge anomaly scores shape: torch.Size([24943, 1])
2025-06-03 11:36:28,721 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:29,436 - DEBUG - Step 10: Loss=0.7137
2025-06-03 11:36:29,436 - DEBUG - Online update step: 11/50
2025-06-03 11:36:29,438 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:29,848 - DEBUG - Node anomaly scores shape: torch.Size([11606, 1])
2025-06-03 11:36:29,883 - DEBUG - Edge anomaly scores shape: torch.Size([24478, 1])
2025-06-03 11:36:29,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:30,626 - DEBUG - Step 11: Loss=0.6364
2025-06-03 11:36:30,626 - DEBUG - Online update step: 12/50
2025-06-03 11:36:30,628 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:30,988 - DEBUG - Node anomaly scores shape: torch.Size([10348, 1])
2025-06-03 11:36:31,021 - DEBUG - Edge anomaly scores shape: torch.Size([21645, 1])
2025-06-03 11:36:31,022 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:31,793 - DEBUG - Step 12: Loss=0.6747
2025-06-03 11:36:31,793 - DEBUG - Online update step: 13/50
2025-06-03 11:36:31,798 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:32,264 - DEBUG - Node anomaly scores shape: torch.Size([11266, 1])
2025-06-03 11:36:32,301 - DEBUG - Edge anomaly scores shape: torch.Size([23643, 1])
2025-06-03 11:36:32,302 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:33,080 - DEBUG - Step 13: Loss=0.6645
2025-06-03 11:36:33,081 - DEBUG - Online update step: 14/50
2025-06-03 11:36:33,082 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:33,462 - DEBUG - Node anomaly scores shape: torch.Size([10683, 1])
2025-06-03 11:36:33,499 - DEBUG - Edge anomaly scores shape: torch.Size([22361, 1])
2025-06-03 11:36:33,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:34,272 - DEBUG - Step 14: Loss=0.6489
2025-06-03 11:36:34,272 - DEBUG - Online update step: 15/50
2025-06-03 11:36:34,274 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:34,703 - DEBUG - Node anomaly scores shape: torch.Size([10924, 1])
2025-06-03 11:36:34,740 - DEBUG - Edge anomaly scores shape: torch.Size([22975, 1])
2025-06-03 11:36:34,741 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:35,555 - DEBUG - Step 15: Loss=0.6228
2025-06-03 11:36:35,556 - DEBUG - Online update step: 16/50
2025-06-03 11:36:35,558 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:35,925 - DEBUG - Node anomaly scores shape: torch.Size([9929, 1])
2025-06-03 11:36:35,958 - DEBUG - Edge anomaly scores shape: torch.Size([20713, 1])
2025-06-03 11:36:35,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:36,600 - DEBUG - Step 16: Loss=0.6507
2025-06-03 11:36:36,601 - DEBUG - Online update step: 17/50
2025-06-03 11:36:36,603 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:37,074 - DEBUG - Node anomaly scores shape: torch.Size([11110, 1])
2025-06-03 11:36:37,114 - DEBUG - Edge anomaly scores shape: torch.Size([23391, 1])
2025-06-03 11:36:37,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:38,025 - DEBUG - Step 17: Loss=0.6250
2025-06-03 11:36:38,025 - DEBUG - Online update step: 18/50
2025-06-03 11:36:38,028 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:38,449 - DEBUG - Node anomaly scores shape: torch.Size([10602, 1])
2025-06-03 11:36:38,488 - DEBUG - Edge anomaly scores shape: torch.Size([22128, 1])
2025-06-03 11:36:38,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:39,307 - DEBUG - Step 18: Loss=0.6552
2025-06-03 11:36:39,308 - DEBUG - Online update step: 19/50
2025-06-03 11:36:39,310 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:39,720 - DEBUG - Node anomaly scores shape: torch.Size([10530, 1])
2025-06-03 11:36:39,758 - DEBUG - Edge anomaly scores shape: torch.Size([21970, 1])
2025-06-03 11:36:39,759 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:40,541 - DEBUG - Step 19: Loss=0.6520
2025-06-03 11:36:40,542 - DEBUG - Online update step: 20/50
2025-06-03 11:36:40,543 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:40,897 - DEBUG - Node anomaly scores shape: torch.Size([10728, 1])
2025-06-03 11:36:40,928 - DEBUG - Edge anomaly scores shape: torch.Size([22495, 1])
2025-06-03 11:36:40,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:41,525 - DEBUG - Step 20: Loss=0.6174
2025-06-03 11:36:41,526 - DEBUG - Online update step: 21/50
2025-06-03 11:36:41,527 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:41,911 - DEBUG - Node anomaly scores shape: torch.Size([11428, 1])
2025-06-03 11:36:41,945 - DEBUG - Edge anomaly scores shape: torch.Size([24039, 1])
2025-06-03 11:36:41,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:42,632 - DEBUG - Step 21: Loss=0.7080
2025-06-03 11:36:42,633 - DEBUG - Online update step: 22/50
2025-06-03 11:36:42,634 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:42,971 - DEBUG - Node anomaly scores shape: torch.Size([10244, 1])
2025-06-03 11:36:43,002 - DEBUG - Edge anomaly scores shape: torch.Size([21320, 1])
2025-06-03 11:36:43,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:43,622 - DEBUG - Step 22: Loss=0.7840
2025-06-03 11:36:43,622 - DEBUG - Online update step: 23/50
2025-06-03 11:36:43,624 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:43,959 - DEBUG - Node anomaly scores shape: torch.Size([10047, 1])
2025-06-03 11:36:43,987 - DEBUG - Edge anomaly scores shape: torch.Size([20937, 1])
2025-06-03 11:36:43,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:44,585 - DEBUG - Step 23: Loss=0.6854
2025-06-03 11:36:44,585 - DEBUG - Online update step: 24/50
2025-06-03 11:36:44,587 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:45,005 - DEBUG - Node anomaly scores shape: torch.Size([11945, 1])
2025-06-03 11:36:45,045 - DEBUG - Edge anomaly scores shape: torch.Size([25281, 1])
2025-06-03 11:36:45,046 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:45,802 - DEBUG - Step 24: Loss=0.6229
2025-06-03 11:36:45,802 - DEBUG - Online update step: 25/50
2025-06-03 11:36:45,804 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:46,202 - DEBUG - Node anomaly scores shape: torch.Size([11209, 1])
2025-06-03 11:36:46,236 - DEBUG - Edge anomaly scores shape: torch.Size([23551, 1])
2025-06-03 11:36:46,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:46,962 - DEBUG - Step 25: Loss=0.6470
2025-06-03 11:36:46,962 - DEBUG - Online update step: 26/50
2025-06-03 11:36:46,965 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:47,326 - DEBUG - Node anomaly scores shape: torch.Size([10671, 1])
2025-06-03 11:36:47,357 - DEBUG - Edge anomaly scores shape: torch.Size([22184, 1])
2025-06-03 11:36:47,358 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:47,969 - DEBUG - Step 26: Loss=0.6226
2025-06-03 11:36:47,969 - DEBUG - Online update step: 27/50
2025-06-03 11:36:47,971 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:48,320 - DEBUG - Node anomaly scores shape: torch.Size([10620, 1])
2025-06-03 11:36:48,351 - DEBUG - Edge anomaly scores shape: torch.Size([22138, 1])
2025-06-03 11:36:48,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:48,947 - DEBUG - Step 27: Loss=0.6620
2025-06-03 11:36:48,947 - DEBUG - Online update step: 28/50
2025-06-03 11:36:48,949 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:49,264 - DEBUG - Node anomaly scores shape: torch.Size([9509, 1])
2025-06-03 11:36:49,292 - DEBUG - Edge anomaly scores shape: torch.Size([19532, 1])
2025-06-03 11:36:49,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:49,911 - DEBUG - Step 28: Loss=0.7027
2025-06-03 11:36:49,911 - DEBUG - Online update step: 29/50
2025-06-03 11:36:49,914 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:50,364 - DEBUG - Node anomaly scores shape: torch.Size([12075, 1])
2025-06-03 11:36:50,397 - DEBUG - Edge anomaly scores shape: torch.Size([25647, 1])
2025-06-03 11:36:50,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:51,186 - DEBUG - Step 29: Loss=0.5976
2025-06-03 11:36:51,187 - DEBUG - Online update step: 30/50
2025-06-03 11:36:51,189 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:51,609 - DEBUG - Node anomaly scores shape: torch.Size([11668, 1])
2025-06-03 11:36:51,645 - DEBUG - Edge anomaly scores shape: torch.Size([24692, 1])
2025-06-03 11:36:51,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:52,375 - DEBUG - Step 30: Loss=0.6570
2025-06-03 11:36:52,375 - DEBUG - Online update step: 31/50
2025-06-03 11:36:52,377 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:52,697 - DEBUG - Node anomaly scores shape: torch.Size([9258, 1])
2025-06-03 11:36:52,731 - DEBUG - Edge anomaly scores shape: torch.Size([18977, 1])
2025-06-03 11:36:52,732 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:53,286 - DEBUG - Step 31: Loss=0.6662
2025-06-03 11:36:53,286 - DEBUG - Online update step: 32/50
2025-06-03 11:36:53,289 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:53,700 - DEBUG - Node anomaly scores shape: torch.Size([11041, 1])
2025-06-03 11:36:53,733 - DEBUG - Edge anomaly scores shape: torch.Size([23185, 1])
2025-06-03 11:36:53,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:54,437 - DEBUG - Step 32: Loss=0.6643
2025-06-03 11:36:54,437 - DEBUG - Online update step: 33/50
2025-06-03 11:36:54,440 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:54,858 - DEBUG - Node anomaly scores shape: torch.Size([11364, 1])
2025-06-03 11:36:54,892 - DEBUG - Edge anomaly scores shape: torch.Size([24003, 1])
2025-06-03 11:36:54,893 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:55,653 - DEBUG - Step 33: Loss=0.6066
2025-06-03 11:36:55,654 - DEBUG - Online update step: 34/50
2025-06-03 11:36:55,656 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:56,076 - DEBUG - Node anomaly scores shape: torch.Size([11539, 1])
2025-06-03 11:36:56,111 - DEBUG - Edge anomaly scores shape: torch.Size([24323, 1])
2025-06-03 11:36:56,112 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:56,812 - DEBUG - Step 34: Loss=0.6165
2025-06-03 11:36:56,813 - DEBUG - Online update step: 35/50
2025-06-03 11:36:56,815 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:57,175 - DEBUG - Node anomaly scores shape: torch.Size([10549, 1])
2025-06-03 11:36:57,206 - DEBUG - Edge anomaly scores shape: torch.Size([21992, 1])
2025-06-03 11:36:57,207 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:57,933 - DEBUG - Step 35: Loss=0.6062
2025-06-03 11:36:57,933 - DEBUG - Online update step: 36/50
2025-06-03 11:36:57,935 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:58,414 - DEBUG - Node anomaly scores shape: torch.Size([12023, 1])
2025-06-03 11:36:58,454 - DEBUG - Edge anomaly scores shape: torch.Size([25344, 1])
2025-06-03 11:36:58,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:36:59,293 - DEBUG - Step 36: Loss=0.6154
2025-06-03 11:36:59,293 - DEBUG - Online update step: 37/50
2025-06-03 11:36:59,295 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:36:59,663 - DEBUG - Node anomaly scores shape: torch.Size([9795, 1])
2025-06-03 11:36:59,694 - DEBUG - Edge anomaly scores shape: torch.Size([20279, 1])
2025-06-03 11:36:59,695 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:00,384 - DEBUG - Step 37: Loss=0.6079
2025-06-03 11:37:00,384 - DEBUG - Online update step: 38/50
2025-06-03 11:37:00,386 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:00,860 - DEBUG - Node anomaly scores shape: torch.Size([11272, 1])
2025-06-03 11:37:00,901 - DEBUG - Edge anomaly scores shape: torch.Size([23747, 1])
2025-06-03 11:37:00,902 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:01,893 - DEBUG - Step 38: Loss=0.5929
2025-06-03 11:37:01,894 - DEBUG - Online update step: 39/50
2025-06-03 11:37:01,897 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:02,381 - DEBUG - Node anomaly scores shape: torch.Size([10960, 1])
2025-06-03 11:37:02,425 - DEBUG - Edge anomaly scores shape: torch.Size([22920, 1])
2025-06-03 11:37:02,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:03,301 - DEBUG - Step 39: Loss=0.6107
2025-06-03 11:37:03,301 - DEBUG - Online update step: 40/50
2025-06-03 11:37:03,303 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:03,719 - DEBUG - Node anomaly scores shape: torch.Size([9841, 1])
2025-06-03 11:37:03,755 - DEBUG - Edge anomaly scores shape: torch.Size([20423, 1])
2025-06-03 11:37:03,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:04,451 - DEBUG - Step 40: Loss=0.6031
2025-06-03 11:37:04,451 - DEBUG - Online update step: 41/50
2025-06-03 11:37:04,453 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:04,833 - DEBUG - Node anomaly scores shape: torch.Size([10513, 1])
2025-06-03 11:37:04,863 - DEBUG - Edge anomaly scores shape: torch.Size([21982, 1])
2025-06-03 11:37:04,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:05,459 - DEBUG - Step 41: Loss=0.6095
2025-06-03 11:37:05,459 - DEBUG - Online update step: 42/50
2025-06-03 11:37:05,460 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:05,785 - DEBUG - Node anomaly scores shape: torch.Size([9736, 1])
2025-06-03 11:37:05,815 - DEBUG - Edge anomaly scores shape: torch.Size([20161, 1])
2025-06-03 11:37:05,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:06,418 - DEBUG - Step 42: Loss=0.6097
2025-06-03 11:37:06,419 - DEBUG - Online update step: 43/50
2025-06-03 11:37:06,421 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:06,822 - DEBUG - Node anomaly scores shape: torch.Size([10785, 1])
2025-06-03 11:37:06,854 - DEBUG - Edge anomaly scores shape: torch.Size([22605, 1])
2025-06-03 11:37:06,855 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:07,490 - DEBUG - Step 43: Loss=0.6243
2025-06-03 11:37:07,490 - DEBUG - Online update step: 44/50
2025-06-03 11:37:07,492 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:07,840 - DEBUG - Node anomaly scores shape: torch.Size([10003, 1])
2025-06-03 11:37:07,871 - DEBUG - Edge anomaly scores shape: torch.Size([20862, 1])
2025-06-03 11:37:07,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:08,513 - DEBUG - Step 44: Loss=0.6504
2025-06-03 11:37:08,513 - DEBUG - Online update step: 45/50
2025-06-03 11:37:08,516 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:08,940 - DEBUG - Node anomaly scores shape: torch.Size([11364, 1])
2025-06-03 11:37:08,975 - DEBUG - Edge anomaly scores shape: torch.Size([23797, 1])
2025-06-03 11:37:08,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:09,662 - DEBUG - Step 45: Loss=0.6239
2025-06-03 11:37:09,662 - DEBUG - Online update step: 46/50
2025-06-03 11:37:09,664 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:10,070 - DEBUG - Node anomaly scores shape: torch.Size([11394, 1])
2025-06-03 11:37:10,105 - DEBUG - Edge anomaly scores shape: torch.Size([24050, 1])
2025-06-03 11:37:10,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:10,847 - DEBUG - Step 46: Loss=0.6132
2025-06-03 11:37:10,847 - DEBUG - Online update step: 47/50
2025-06-03 11:37:10,849 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:11,212 - DEBUG - Node anomaly scores shape: torch.Size([10742, 1])
2025-06-03 11:37:11,246 - DEBUG - Edge anomaly scores shape: torch.Size([22568, 1])
2025-06-03 11:37:11,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:11,884 - DEBUG - Step 47: Loss=0.6289
2025-06-03 11:37:11,884 - DEBUG - Online update step: 48/50
2025-06-03 11:37:11,886 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:12,273 - DEBUG - Node anomaly scores shape: torch.Size([11131, 1])
2025-06-03 11:37:12,308 - DEBUG - Edge anomaly scores shape: torch.Size([23361, 1])
2025-06-03 11:37:12,309 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:13,002 - DEBUG - Step 48: Loss=0.6440
2025-06-03 11:37:13,002 - DEBUG - Online update step: 49/50
2025-06-03 11:37:13,003 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:13,388 - DEBUG - Node anomaly scores shape: torch.Size([11091, 1])
2025-06-03 11:37:13,421 - DEBUG - Edge anomaly scores shape: torch.Size([23249, 1])
2025-06-03 11:37:13,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:14,144 - DEBUG - Step 49: Loss=0.6368
2025-06-03 11:37:14,144 - DEBUG - Online update step: 50/50
2025-06-03 11:37:14,146 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:14,534 - DEBUG - Node anomaly scores shape: torch.Size([11058, 1])
2025-06-03 11:37:14,568 - DEBUG - Edge anomaly scores shape: torch.Size([23181, 1])
2025-06-03 11:37:14,569 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:15,250 - DEBUG - Step 50: Loss=0.6164
2025-06-03 11:37:15,250 - INFO - Online update finished. Average loss: 0.6426, Learning rate: 0.001735
2025-06-03 11:37:15,251 - DEBUG - Current node mean: [ 6.0614891e-09 -6.0614891e-09 -1.5153723e-09 -1.8184467e-08
  3.8894555e-08 -6.0109770e-08  5.7584149e-08  9.0922336e-09
 -1.6163971e-08 -1.6163971e-08 -5.0512412e-09 -1.2122978e-08
 -6.0614891e-09  6.0614891e-09 -1.0102482e-08 -3.0307445e-09
 -3.0307445e-09  0.0000000e+00  0.0000000e+00 -1.6163971e-08
  0.0000000e+00  0.0000000e+00  1.0102482e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4105211e+00  5.6882987e+00 -2.3443321e-09 -1.4065993e-09
 -4.6886641e-09  2.3443321e-09  0.0000000e+00  4.6886641e-09
 -3.7509316e-09  4.6886645e-10  4.6886641e-09 -9.8461950e-09
 -2.1098989e-09 -6.5641301e-09  2.6256521e-08  1.4065993e-09
  1.4065993e-09  1.4065993e-09  1.4065993e-09  1.4065993e-09
  1.4065993e-09 -9.3773289e-10]
2025-06-03 11:37:15,252 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0024
2025-06-03 11:37:15,257 - INFO - Online update complete. Loss: 0.6426
2025-06-03 11:37:15,257 - INFO - Running anomaly detection...
2025-06-03 11:37:15,258 - INFO - Starting anomaly detection.
2025-06-03 11:37:15,276 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113715_update_35.json
2025-06-03 11:37:15,276 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:37:15,303 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113715_update_35.pth and as latest_checkpoint.pth
2025-06-03 11:37:15,303 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.0000
2025-06-03 11:37:15,303 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:37:15,303 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.2577, MLP Score: 1.0000
2025-06-03 11:37:15,303 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.0981, MLP Score: 1.0000
2025-06-03 11:37:15,303 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.3104, MLP Score: 1.0000
2025-06-03 11:37:15,303 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.2024, MLP Score: 1.0000
2025-06-03 11:37:15,303 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.5616, MLP Score: 1.0000
2025-06-03 11:37:15,303 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:37:15,304 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.6372, MLP Score: 1.0000
2025-06-03 11:37:15,304 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7256, MLP Score: 0.9996
2025-06-03 11:37:15,304 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.9909, MLP Score: 0.9998
2025-06-03 11:37:15,304 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.8542, MLP Score: 0.9931
2025-06-03 11:37:15,304 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4469, MLP Score: 0.9986
2025-06-03 11:37:15,304 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-03 11:37:15,304 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-03 11:37:15,304 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot file.
2025-06-03 11:37:15,321 - INFO - Parsed 957 nodes.
2025-06-03 11:37:15,340 - INFO - Parsed 2059 edges.
2025-06-03 11:37:15,928 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:37:15,928 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:37:15,944 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-03 11:37:15,945 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:37:15,945 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-03 11:37:15,946 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-03 11:37:15,947 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:37:15,956 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:37:15,957 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:37:15,959 - DEBUG - Shape of encoded categorical edge features: torch.Size([2059, 2])
2025-06-03 11:37:15,961 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:37:15,961 - DEBUG - Shape of scaled numerical edge features: torch.Size([2059, 20])
2025-06-03 11:37:15,961 - DEBUG - Final edge attributes tensor shape: torch.Size([2059, 22])
2025-06-03 11:37:15,961 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:37:15,961 - INFO - Performing online update...
2025-06-03 11:37:15,961 - INFO - Starting online update for 50 steps.
2025-06-03 11:37:15,962 - DEBUG - Updated RunningStats: new_mean=0.5515213707393724, new_var=81600000000009.16, new_n=8190
2025-06-03 11:37:15,962 - DEBUG - Updated RunningStats: new_mean=0.5518211631120211, new_var=81900000000007.17, new_n=8220
2025-06-03 11:37:15,962 - DEBUG - Updated RunningStats: new_mean=0.7824750421212798, new_var=47600000000036.79, new_n=4782
2025-06-03 11:37:15,962 - DEBUG - Updated RunningStats: new_mean=0.7836104469856217, new_var=47820000000002.914, new_n=4804
2025-06-03 11:37:15,962 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:37:15,962 - DEBUG - Online update step: 1/50
2025-06-03 11:37:15,964 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:16,316 - DEBUG - Node anomaly scores shape: torch.Size([10186, 1])
2025-06-03 11:37:16,348 - DEBUG - Edge anomaly scores shape: torch.Size([21182, 1])
2025-06-03 11:37:16,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:17,027 - DEBUG - Step 1: Loss=0.6223
2025-06-03 11:37:17,027 - DEBUG - Online update step: 2/50
2025-06-03 11:37:17,029 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:17,464 - DEBUG - Node anomaly scores shape: torch.Size([11331, 1])
2025-06-03 11:37:17,499 - DEBUG - Edge anomaly scores shape: torch.Size([23848, 1])
2025-06-03 11:37:17,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:18,240 - DEBUG - Step 2: Loss=0.6271
2025-06-03 11:37:18,240 - DEBUG - Online update step: 3/50
2025-06-03 11:37:18,242 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:18,624 - DEBUG - Node anomaly scores shape: torch.Size([10528, 1])
2025-06-03 11:37:18,659 - DEBUG - Edge anomaly scores shape: torch.Size([21894, 1])
2025-06-03 11:37:18,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:19,354 - DEBUG - Step 3: Loss=0.6027
2025-06-03 11:37:19,354 - DEBUG - Online update step: 4/50
2025-06-03 11:37:19,356 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:19,788 - DEBUG - Node anomaly scores shape: torch.Size([11156, 1])
2025-06-03 11:37:19,824 - DEBUG - Edge anomaly scores shape: torch.Size([23501, 1])
2025-06-03 11:37:19,825 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:20,643 - DEBUG - Step 4: Loss=0.5978
2025-06-03 11:37:20,643 - DEBUG - Online update step: 5/50
2025-06-03 11:37:20,645 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:21,049 - DEBUG - Node anomaly scores shape: torch.Size([10772, 1])
2025-06-03 11:37:21,083 - DEBUG - Edge anomaly scores shape: torch.Size([22601, 1])
2025-06-03 11:37:21,084 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:21,878 - DEBUG - Step 5: Loss=0.6211
2025-06-03 11:37:21,879 - DEBUG - Online update step: 6/50
2025-06-03 11:37:21,882 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:22,307 - DEBUG - Node anomaly scores shape: torch.Size([10251, 1])
2025-06-03 11:37:22,343 - DEBUG - Edge anomaly scores shape: torch.Size([21376, 1])
2025-06-03 11:37:22,343 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:23,083 - DEBUG - Step 6: Loss=0.6023
2025-06-03 11:37:23,083 - DEBUG - Online update step: 7/50
2025-06-03 11:37:23,085 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:23,481 - DEBUG - Node anomaly scores shape: torch.Size([10020, 1])
2025-06-03 11:37:23,517 - DEBUG - Edge anomaly scores shape: torch.Size([20715, 1])
2025-06-03 11:37:23,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:24,315 - DEBUG - Step 7: Loss=0.6049
2025-06-03 11:37:24,315 - DEBUG - Online update step: 8/50
2025-06-03 11:37:24,317 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:24,794 - DEBUG - Node anomaly scores shape: torch.Size([11358, 1])
2025-06-03 11:37:24,839 - DEBUG - Edge anomaly scores shape: torch.Size([23777, 1])
2025-06-03 11:37:24,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:25,702 - DEBUG - Step 8: Loss=0.6232
2025-06-03 11:37:25,702 - DEBUG - Online update step: 9/50
2025-06-03 11:37:25,704 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:26,153 - DEBUG - Node anomaly scores shape: torch.Size([10576, 1])
2025-06-03 11:37:26,190 - DEBUG - Edge anomaly scores shape: torch.Size([22078, 1])
2025-06-03 11:37:26,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:27,093 - DEBUG - Step 9: Loss=0.6046
2025-06-03 11:37:27,093 - DEBUG - Online update step: 10/50
2025-06-03 11:37:27,095 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:27,553 - DEBUG - Node anomaly scores shape: torch.Size([10711, 1])
2025-06-03 11:37:27,591 - DEBUG - Edge anomaly scores shape: torch.Size([22395, 1])
2025-06-03 11:37:27,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:28,481 - DEBUG - Step 10: Loss=0.5947
2025-06-03 11:37:28,481 - DEBUG - Online update step: 11/50
2025-06-03 11:37:28,484 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:28,826 - DEBUG - Node anomaly scores shape: torch.Size([9486, 1])
2025-06-03 11:37:28,857 - DEBUG - Edge anomaly scores shape: torch.Size([19582, 1])
2025-06-03 11:37:28,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:29,438 - DEBUG - Step 11: Loss=0.6134
2025-06-03 11:37:29,438 - DEBUG - Online update step: 12/50
2025-06-03 11:37:29,440 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:29,885 - DEBUG - Node anomaly scores shape: torch.Size([12579, 1])
2025-06-03 11:37:29,924 - DEBUG - Edge anomaly scores shape: torch.Size([26816, 1])
2025-06-03 11:37:29,925 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:30,799 - DEBUG - Step 12: Loss=0.5868
2025-06-03 11:37:30,799 - DEBUG - Online update step: 13/50
2025-06-03 11:37:30,801 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:31,200 - DEBUG - Node anomaly scores shape: torch.Size([10946, 1])
2025-06-03 11:37:31,234 - DEBUG - Edge anomaly scores shape: torch.Size([22897, 1])
2025-06-03 11:37:31,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:31,999 - DEBUG - Step 13: Loss=0.5981
2025-06-03 11:37:31,999 - DEBUG - Online update step: 14/50
2025-06-03 11:37:32,001 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:32,431 - DEBUG - Node anomaly scores shape: torch.Size([11287, 1])
2025-06-03 11:37:32,466 - DEBUG - Edge anomaly scores shape: torch.Size([23832, 1])
2025-06-03 11:37:32,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:33,217 - DEBUG - Step 14: Loss=0.6047
2025-06-03 11:37:33,218 - DEBUG - Online update step: 15/50
2025-06-03 11:37:33,219 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:33,640 - DEBUG - Node anomaly scores shape: torch.Size([11255, 1])
2025-06-03 11:37:33,681 - DEBUG - Edge anomaly scores shape: torch.Size([23744, 1])
2025-06-03 11:37:33,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:34,402 - DEBUG - Step 15: Loss=0.6117
2025-06-03 11:37:34,402 - DEBUG - Online update step: 16/50
2025-06-03 11:37:34,404 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:34,783 - DEBUG - Node anomaly scores shape: torch.Size([11093, 1])
2025-06-03 11:37:34,817 - DEBUG - Edge anomaly scores shape: torch.Size([23209, 1])
2025-06-03 11:37:34,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:35,503 - DEBUG - Step 16: Loss=0.5885
2025-06-03 11:37:35,503 - DEBUG - Online update step: 17/50
2025-06-03 11:37:35,504 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:35,923 - DEBUG - Node anomaly scores shape: torch.Size([11259, 1])
2025-06-03 11:37:35,954 - DEBUG - Edge anomaly scores shape: torch.Size([23598, 1])
2025-06-03 11:37:35,955 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:36,624 - DEBUG - Step 17: Loss=0.5900
2025-06-03 11:37:36,624 - DEBUG - Online update step: 18/50
2025-06-03 11:37:36,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:36,994 - DEBUG - Node anomaly scores shape: torch.Size([10430, 1])
2025-06-03 11:37:37,025 - DEBUG - Edge anomaly scores shape: torch.Size([21719, 1])
2025-06-03 11:37:37,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:37,640 - DEBUG - Step 18: Loss=0.6073
2025-06-03 11:37:37,641 - DEBUG - Online update step: 19/50
2025-06-03 11:37:37,643 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:38,028 - DEBUG - Node anomaly scores shape: torch.Size([10882, 1])
2025-06-03 11:37:38,061 - DEBUG - Edge anomaly scores shape: torch.Size([22799, 1])
2025-06-03 11:37:38,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:38,673 - DEBUG - Step 19: Loss=0.6006
2025-06-03 11:37:38,673 - DEBUG - Online update step: 20/50
2025-06-03 11:37:38,675 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:39,016 - DEBUG - Node anomaly scores shape: torch.Size([10327, 1])
2025-06-03 11:37:39,047 - DEBUG - Edge anomaly scores shape: torch.Size([21432, 1])
2025-06-03 11:37:39,047 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:39,674 - DEBUG - Step 20: Loss=0.6585
2025-06-03 11:37:39,675 - DEBUG - Online update step: 21/50
2025-06-03 11:37:39,677 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:40,050 - DEBUG - Node anomaly scores shape: torch.Size([10919, 1])
2025-06-03 11:37:40,082 - DEBUG - Edge anomaly scores shape: torch.Size([22854, 1])
2025-06-03 11:37:40,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:40,744 - DEBUG - Step 21: Loss=0.6935
2025-06-03 11:37:40,745 - DEBUG - Online update step: 22/50
2025-06-03 11:37:40,747 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:41,083 - DEBUG - Node anomaly scores shape: torch.Size([9841, 1])
2025-06-03 11:37:41,117 - DEBUG - Edge anomaly scores shape: torch.Size([20384, 1])
2025-06-03 11:37:41,117 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:41,693 - DEBUG - Step 22: Loss=0.6026
2025-06-03 11:37:41,694 - DEBUG - Online update step: 23/50
2025-06-03 11:37:41,695 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:42,065 - DEBUG - Node anomaly scores shape: torch.Size([10790, 1])
2025-06-03 11:37:42,097 - DEBUG - Edge anomaly scores shape: torch.Size([22636, 1])
2025-06-03 11:37:42,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:42,801 - DEBUG - Step 23: Loss=0.6184
2025-06-03 11:37:42,802 - DEBUG - Online update step: 24/50
2025-06-03 11:37:42,803 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:43,188 - DEBUG - Node anomaly scores shape: torch.Size([10997, 1])
2025-06-03 11:37:43,224 - DEBUG - Edge anomaly scores shape: torch.Size([23042, 1])
2025-06-03 11:37:43,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:43,942 - DEBUG - Step 24: Loss=0.6545
2025-06-03 11:37:43,942 - DEBUG - Online update step: 25/50
2025-06-03 11:37:43,944 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:44,353 - DEBUG - Node anomaly scores shape: torch.Size([11145, 1])
2025-06-03 11:37:44,389 - DEBUG - Edge anomaly scores shape: torch.Size([23459, 1])
2025-06-03 11:37:44,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:45,170 - DEBUG - Step 25: Loss=0.6302
2025-06-03 11:37:45,171 - DEBUG - Online update step: 26/50
2025-06-03 11:37:45,173 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:45,539 - DEBUG - Node anomaly scores shape: torch.Size([10263, 1])
2025-06-03 11:37:45,570 - DEBUG - Edge anomaly scores shape: torch.Size([21320, 1])
2025-06-03 11:37:45,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:46,342 - DEBUG - Step 26: Loss=0.5932
2025-06-03 11:37:46,343 - DEBUG - Online update step: 27/50
2025-06-03 11:37:46,345 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:46,793 - DEBUG - Node anomaly scores shape: torch.Size([10839, 1])
2025-06-03 11:37:46,833 - DEBUG - Edge anomaly scores shape: torch.Size([22565, 1])
2025-06-03 11:37:46,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:47,670 - DEBUG - Step 27: Loss=0.6156
2025-06-03 11:37:47,671 - DEBUG - Online update step: 28/50
2025-06-03 11:37:47,674 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:48,185 - DEBUG - Node anomaly scores shape: torch.Size([12141, 1])
2025-06-03 11:37:48,226 - DEBUG - Edge anomaly scores shape: torch.Size([25709, 1])
2025-06-03 11:37:48,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:49,156 - DEBUG - Step 28: Loss=0.5925
2025-06-03 11:37:49,157 - DEBUG - Online update step: 29/50
2025-06-03 11:37:49,159 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:49,580 - DEBUG - Node anomaly scores shape: torch.Size([9719, 1])
2025-06-03 11:37:49,615 - DEBUG - Edge anomaly scores shape: torch.Size([20141, 1])
2025-06-03 11:37:49,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:50,319 - DEBUG - Step 29: Loss=0.6223
2025-06-03 11:37:50,320 - DEBUG - Online update step: 30/50
2025-06-03 11:37:50,322 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:50,848 - DEBUG - Node anomaly scores shape: torch.Size([12133, 1])
2025-06-03 11:37:50,891 - DEBUG - Edge anomaly scores shape: torch.Size([25666, 1])
2025-06-03 11:37:50,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:51,832 - DEBUG - Step 30: Loss=0.5964
2025-06-03 11:37:51,832 - DEBUG - Online update step: 31/50
2025-06-03 11:37:51,834 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:52,249 - DEBUG - Node anomaly scores shape: torch.Size([10078, 1])
2025-06-03 11:37:52,286 - DEBUG - Edge anomaly scores shape: torch.Size([20988, 1])
2025-06-03 11:37:52,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:52,984 - DEBUG - Step 31: Loss=0.5970
2025-06-03 11:37:52,985 - DEBUG - Online update step: 32/50
2025-06-03 11:37:52,986 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:53,314 - DEBUG - Node anomaly scores shape: torch.Size([9991, 1])
2025-06-03 11:37:53,341 - DEBUG - Edge anomaly scores shape: torch.Size([20741, 1])
2025-06-03 11:37:53,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:53,969 - DEBUG - Step 32: Loss=0.6801
2025-06-03 11:37:53,969 - DEBUG - Online update step: 33/50
2025-06-03 11:37:53,971 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:54,329 - DEBUG - Node anomaly scores shape: torch.Size([10347, 1])
2025-06-03 11:37:54,360 - DEBUG - Edge anomaly scores shape: torch.Size([21577, 1])
2025-06-03 11:37:54,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:55,061 - DEBUG - Step 33: Loss=0.7075
2025-06-03 11:37:55,062 - DEBUG - Online update step: 34/50
2025-06-03 11:37:55,064 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:55,391 - DEBUG - Node anomaly scores shape: torch.Size([9272, 1])
2025-06-03 11:37:55,419 - DEBUG - Edge anomaly scores shape: torch.Size([19065, 1])
2025-06-03 11:37:55,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:55,991 - DEBUG - Step 34: Loss=0.6082
2025-06-03 11:37:55,991 - DEBUG - Online update step: 35/50
2025-06-03 11:37:55,993 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:56,321 - DEBUG - Node anomaly scores shape: torch.Size([9708, 1])
2025-06-03 11:37:56,351 - DEBUG - Edge anomaly scores shape: torch.Size([20075, 1])
2025-06-03 11:37:56,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:56,952 - DEBUG - Step 35: Loss=0.6432
2025-06-03 11:37:56,952 - DEBUG - Online update step: 36/50
2025-06-03 11:37:56,954 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:57,280 - DEBUG - Node anomaly scores shape: torch.Size([9671, 1])
2025-06-03 11:37:57,307 - DEBUG - Edge anomaly scores shape: torch.Size([20067, 1])
2025-06-03 11:37:57,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:57,885 - DEBUG - Step 36: Loss=0.6372
2025-06-03 11:37:57,885 - DEBUG - Online update step: 37/50
2025-06-03 11:37:57,887 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:58,240 - DEBUG - Node anomaly scores shape: torch.Size([10523, 1])
2025-06-03 11:37:58,271 - DEBUG - Edge anomaly scores shape: torch.Size([21874, 1])
2025-06-03 11:37:58,272 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:58,939 - DEBUG - Step 37: Loss=0.6250
2025-06-03 11:37:58,939 - DEBUG - Online update step: 38/50
2025-06-03 11:37:58,941 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:37:59,278 - DEBUG - Node anomaly scores shape: torch.Size([9944, 1])
2025-06-03 11:37:59,307 - DEBUG - Edge anomaly scores shape: torch.Size([20619, 1])
2025-06-03 11:37:59,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:37:59,887 - DEBUG - Step 38: Loss=0.5919
2025-06-03 11:37:59,887 - DEBUG - Online update step: 39/50
2025-06-03 11:37:59,889 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:00,265 - DEBUG - Node anomaly scores shape: torch.Size([10687, 1])
2025-06-03 11:38:00,295 - DEBUG - Edge anomaly scores shape: torch.Size([22315, 1])
2025-06-03 11:38:00,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:00,987 - DEBUG - Step 39: Loss=0.6950
2025-06-03 11:38:00,987 - DEBUG - Online update step: 40/50
2025-06-03 11:38:00,990 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:01,421 - DEBUG - Node anomaly scores shape: torch.Size([11858, 1])
2025-06-03 11:38:01,456 - DEBUG - Edge anomaly scores shape: torch.Size([25029, 1])
2025-06-03 11:38:01,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:02,162 - DEBUG - Step 40: Loss=0.7557
2025-06-03 11:38:02,162 - DEBUG - Online update step: 41/50
2025-06-03 11:38:02,165 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:02,544 - DEBUG - Node anomaly scores shape: torch.Size([10693, 1])
2025-06-03 11:38:02,577 - DEBUG - Edge anomaly scores shape: torch.Size([22450, 1])
2025-06-03 11:38:02,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:03,289 - DEBUG - Step 41: Loss=0.6680
2025-06-03 11:38:03,290 - DEBUG - Online update step: 42/50
2025-06-03 11:38:03,292 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:03,636 - DEBUG - Node anomaly scores shape: torch.Size([10401, 1])
2025-06-03 11:38:03,668 - DEBUG - Edge anomaly scores shape: torch.Size([21681, 1])
2025-06-03 11:38:03,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:04,299 - DEBUG - Step 42: Loss=0.6797
2025-06-03 11:38:04,299 - DEBUG - Online update step: 43/50
2025-06-03 11:38:04,302 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:04,702 - DEBUG - Node anomaly scores shape: torch.Size([11193, 1])
2025-06-03 11:38:04,735 - DEBUG - Edge anomaly scores shape: torch.Size([23494, 1])
2025-06-03 11:38:04,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:05,432 - DEBUG - Step 43: Loss=0.6662
2025-06-03 11:38:05,432 - DEBUG - Online update step: 44/50
2025-06-03 11:38:05,434 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:05,818 - DEBUG - Node anomaly scores shape: torch.Size([11245, 1])
2025-06-03 11:38:05,854 - DEBUG - Edge anomaly scores shape: torch.Size([23648, 1])
2025-06-03 11:38:05,855 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:06,536 - DEBUG - Step 44: Loss=0.6372
2025-06-03 11:38:06,536 - DEBUG - Online update step: 45/50
2025-06-03 11:38:06,538 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:06,909 - DEBUG - Node anomaly scores shape: torch.Size([10898, 1])
2025-06-03 11:38:06,942 - DEBUG - Edge anomaly scores shape: torch.Size([22736, 1])
2025-06-03 11:38:06,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:07,562 - DEBUG - Step 45: Loss=0.6185
2025-06-03 11:38:07,562 - DEBUG - Online update step: 46/50
2025-06-03 11:38:07,564 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:07,972 - DEBUG - Node anomaly scores shape: torch.Size([11362, 1])
2025-06-03 11:38:08,012 - DEBUG - Edge anomaly scores shape: torch.Size([23838, 1])
2025-06-03 11:38:08,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:08,713 - DEBUG - Step 46: Loss=0.6921
2025-06-03 11:38:08,713 - DEBUG - Online update step: 47/50
2025-06-03 11:38:08,715 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:09,083 - DEBUG - Node anomaly scores shape: torch.Size([10479, 1])
2025-06-03 11:38:09,116 - DEBUG - Edge anomaly scores shape: torch.Size([21867, 1])
2025-06-03 11:38:09,116 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:09,743 - DEBUG - Step 47: Loss=0.7161
2025-06-03 11:38:09,743 - DEBUG - Online update step: 48/50
2025-06-03 11:38:09,746 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:10,221 - DEBUG - Node anomaly scores shape: torch.Size([12181, 1])
2025-06-03 11:38:10,261 - DEBUG - Edge anomaly scores shape: torch.Size([25757, 1])
2025-06-03 11:38:10,262 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:11,106 - DEBUG - Step 48: Loss=0.6167
2025-06-03 11:38:11,106 - DEBUG - Online update step: 49/50
2025-06-03 11:38:11,108 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:11,533 - DEBUG - Node anomaly scores shape: torch.Size([11380, 1])
2025-06-03 11:38:11,572 - DEBUG - Edge anomaly scores shape: torch.Size([24023, 1])
2025-06-03 11:38:11,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:12,336 - DEBUG - Step 49: Loss=0.6277
2025-06-03 11:38:12,336 - DEBUG - Online update step: 50/50
2025-06-03 11:38:12,339 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:12,775 - DEBUG - Node anomaly scores shape: torch.Size([11105, 1])
2025-06-03 11:38:12,812 - DEBUG - Edge anomaly scores shape: torch.Size([23338, 1])
2025-06-03 11:38:12,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:13,702 - DEBUG - Step 50: Loss=0.6526
2025-06-03 11:38:13,702 - INFO - Online update finished. Average loss: 0.6299, Learning rate: 0.001500
2025-06-03 11:38:13,703 - DEBUG - Current node mean: [-2.98957481e-08  2.98957481e-08 -1.64426606e-08 -1.89339726e-08
 -4.24768736e-08  1.22074297e-08  8.47046167e-09 -3.98609945e-09
  5.48088686e-09 -8.96872354e-09 -1.02766631e-08  2.98957459e-09
 -1.42004799e-08 -9.71611769e-09  1.39513485e-08  1.39513485e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  2.39165967e-08
  0.00000000e+00  0.00000000e+00  4.58401459e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4123361e+00  5.6940260e+00 -9.2634705e-10 -2.7790412e-09
  4.6317354e-09 -9.2634705e-10  1.8526941e-09  0.0000000e+00
 -6.0212559e-09 -3.2422147e-09 -7.8739504e-09 -3.7053882e-09
 -4.6317354e-09  1.1116165e-08  5.5580824e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -9.2634705e-10]
2025-06-03 11:38:13,704 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0036
2025-06-03 11:38:13,705 - INFO - Online update complete. Loss: 0.6299
2025-06-03 11:38:13,705 - INFO - Running anomaly detection...
2025-06-03 11:38:13,705 - INFO - Starting anomaly detection.
2025-06-03 11:38:13,729 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113813_update_36.json
2025-06-03 11:38:13,730 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:38:13,766 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113813_update_36.pth and as latest_checkpoint.pth
2025-06-03 11:38:13,766 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.0000
2025-06-03 11:38:13,766 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:38:13,767 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.0704, MLP Score: 1.0000
2025-06-03 11:38:13,767 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9534, MLP Score: 1.0000
2025-06-03 11:38:13,767 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2057, MLP Score: 1.0000
2025-06-03 11:38:13,767 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.3378, MLP Score: 1.0000
2025-06-03 11:38:13,767 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1813, MLP Score: 1.0000
2025-06-03 11:38:13,767 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:38:13,767 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.6025, MLP Score: 0.9999
2025-06-03 11:38:13,767 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.6769, MLP Score: 0.9996
2025-06-03 11:38:13,767 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.9831, MLP Score: 0.9998
2025-06-03 11:38:13,767 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.1342, MLP Score: 0.9911
2025-06-03 11:38:13,767 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4209, MLP Score: 0.9989
2025-06-03 11:38:13,767 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:38:13,767 - INFO - Performing visualization of node and edge features.
2025-06-03 11:38:13,767 - INFO - Starting visualization of node features.
2025-06-03 11:38:13,768 - INFO - Graph has 957 nodes and 30 features.
2025-06-03 11:38:13,768 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:38:13,768 - INFO - Calculating feature statistics:
2025-06-03 11:38:13,768 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11045059), 'max': np.float32(9.233398)}
2025-06-03 11:38:13,768 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-9.233398), 'max': np.float32(0.11045059)}
2025-06-03 11:38:13,768 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(-2.3916597e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.2690923), 'max': np.float32(3.0300078)}
2025-06-03 11:38:13,768 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-0.07773751), 'max': np.float32(17.528582)}
2025-06-03 11:38:13,768 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-4.3847095e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.6302327), 'max': np.float32(3.543696)}
2025-06-03 11:38:13,769 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(7.972199e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.63696367), 'max': np.float32(2.9310646)}
2025-06-03 11:38:13,769 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(1.1958298e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9721506), 'max': np.float32(0.62131685)}
2025-06-03 11:38:13,769 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(3.9860995e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081632435), 'max': np.float32(19.050344)}
2025-06-03 11:38:13,769 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.14600365e-08), 'std': np.float32(0.99999994), 'min': np.float32(-4.202085), 'max': np.float32(20.64691)}
2025-06-03 11:38:13,769 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(4.9826245e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.095424734), 'max': np.float32(11.145133)}
2025-06-03 11:38:13,769 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-7.972199e-09), 'std': np.float32(1.0), 'min': np.float32(-2.037222), 'max': np.float32(0.88103837)}
2025-06-03 11:38:13,769 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(8.9687235e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10546514), 'max': np.float32(9.99889)}
2025-06-03 11:38:13,769 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-5.979149e-09), 'std': np.float32(1.0), 'min': np.float32(-7.80796), 'max': np.float32(0.12994833)}
2025-06-03 11:38:13,769 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(-7.972199e-09), 'std': np.float32(1.0), 'min': np.float32(-2.4225495), 'max': np.float32(1.917514)}
2025-06-03 11:38:13,770 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8217037), 'max': np.float32(2.5205786)}
2025-06-03 11:38:13,770 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5393881), 'max': np.float32(2.5217385)}
2025-06-03 11:38:13,770 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(-3.9860995e-09), 'std': np.float32(1.0), 'min': np.float32(-2.4071383), 'max': np.float32(1.5780227)}
2025-06-03 11:38:13,770 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,770 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,770 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(1.7937447e-08), 'std': np.float32(0.99999994), 'min': np.float32(-7.242859), 'max': np.float32(0.15562817)}
2025-06-03 11:38:13,770 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,770 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,770 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(3.7867945e-08), 'std': np.float32(1.0), 'min': np.float32(-4.0823574), 'max': np.float32(4.2654023)}
2025-06-03 11:38:13,771 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,771 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,771 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,771 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,771 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,772 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,772 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:38:13,789 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b399a7410>
2025-06-03 11:38:13,950 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:38:14,167 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:38:14,193 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:38:15,359 - INFO - Node feature visualization saved to vis/node_features_20250603_113814.png
2025-06-03 11:38:15,359 - INFO - Finished visualization of node features.
2025-06-03 11:38:15,359 - INFO - Performing additional feature analysis:
2025-06-03 11:38:15,359 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:38:15,359 - INFO - Starting visualization of edge features.
2025-06-03 11:38:15,359 - INFO - Graph has 2059 edges and 22 edge features.
2025-06-03 11:38:15,359 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:38:15,359 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:38:15,359 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-03 11:38:15,359 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-03 11:38:15,359 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot file.
2025-06-03 11:38:15,376 - INFO - Parsed 962 nodes.
2025-06-03 11:38:15,394 - INFO - Parsed 2098 edges.
2025-06-03 11:38:15,997 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:38:15,997 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:38:16,012 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-03 11:38:16,014 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:38:16,014 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-03 11:38:16,015 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-03 11:38:16,015 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:38:16,025 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:38:16,026 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:38:16,028 - DEBUG - Shape of encoded categorical edge features: torch.Size([2098, 2])
2025-06-03 11:38:16,030 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:38:16,030 - DEBUG - Shape of scaled numerical edge features: torch.Size([2098, 20])
2025-06-03 11:38:16,030 - DEBUG - Final edge attributes tensor shape: torch.Size([2098, 22])
2025-06-03 11:38:16,030 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:38:16,030 - INFO - Performing online update...
2025-06-03 11:38:16,030 - INFO - Starting online update for 50 steps.
2025-06-03 11:38:16,031 - DEBUG - Updated RunningStats: new_mean=0.5498145407084551, new_var=82200000000009.11, new_n=8250
2025-06-03 11:38:16,031 - DEBUG - Updated RunningStats: new_mean=0.550118338562181, new_var=82500000000007.17, new_n=8280
2025-06-03 11:38:16,031 - DEBUG - Updated RunningStats: new_mean=0.7815114413067783, new_var=48040000000036.75, new_n=4826
2025-06-03 11:38:16,031 - DEBUG - Updated RunningStats: new_mean=0.7826397306800311, new_var=48260000000002.91, new_n=4848
2025-06-03 11:38:16,031 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:38:16,031 - DEBUG - Online update step: 1/50
2025-06-03 11:38:16,033 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:16,469 - DEBUG - Node anomaly scores shape: torch.Size([11166, 1])
2025-06-03 11:38:16,517 - DEBUG - Edge anomaly scores shape: torch.Size([23352, 1])
2025-06-03 11:38:16,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:17,279 - DEBUG - Step 1: Loss=0.6194
2025-06-03 11:38:17,280 - DEBUG - Online update step: 2/50
2025-06-03 11:38:17,281 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:17,639 - DEBUG - Node anomaly scores shape: torch.Size([10545, 1])
2025-06-03 11:38:17,674 - DEBUG - Edge anomaly scores shape: torch.Size([21933, 1])
2025-06-03 11:38:17,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:18,253 - DEBUG - Step 2: Loss=0.6056
2025-06-03 11:38:18,254 - DEBUG - Online update step: 3/50
2025-06-03 11:38:18,256 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:18,609 - DEBUG - Node anomaly scores shape: torch.Size([10459, 1])
2025-06-03 11:38:18,640 - DEBUG - Edge anomaly scores shape: torch.Size([21785, 1])
2025-06-03 11:38:18,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:19,304 - DEBUG - Step 3: Loss=0.5917
2025-06-03 11:38:19,304 - DEBUG - Online update step: 4/50
2025-06-03 11:38:19,305 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:19,710 - DEBUG - Node anomaly scores shape: torch.Size([11359, 1])
2025-06-03 11:38:19,746 - DEBUG - Edge anomaly scores shape: torch.Size([23979, 1])
2025-06-03 11:38:19,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:20,407 - DEBUG - Step 4: Loss=0.5953
2025-06-03 11:38:20,407 - DEBUG - Online update step: 5/50
2025-06-03 11:38:20,409 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:20,793 - DEBUG - Node anomaly scores shape: torch.Size([11015, 1])
2025-06-03 11:38:20,825 - DEBUG - Edge anomaly scores shape: torch.Size([23073, 1])
2025-06-03 11:38:20,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:21,450 - DEBUG - Step 5: Loss=0.5770
2025-06-03 11:38:21,451 - DEBUG - Online update step: 6/50
2025-06-03 11:38:21,452 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:21,814 - DEBUG - Node anomaly scores shape: torch.Size([10915, 1])
2025-06-03 11:38:21,847 - DEBUG - Edge anomaly scores shape: torch.Size([22902, 1])
2025-06-03 11:38:21,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:22,509 - DEBUG - Step 6: Loss=0.5955
2025-06-03 11:38:22,509 - DEBUG - Online update step: 7/50
2025-06-03 11:38:22,510 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:22,835 - DEBUG - Node anomaly scores shape: torch.Size([9779, 1])
2025-06-03 11:38:22,865 - DEBUG - Edge anomaly scores shape: torch.Size([20179, 1])
2025-06-03 11:38:22,866 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:23,507 - DEBUG - Step 7: Loss=0.5898
2025-06-03 11:38:23,507 - DEBUG - Online update step: 8/50
2025-06-03 11:38:23,509 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:23,919 - DEBUG - Node anomaly scores shape: torch.Size([11240, 1])
2025-06-03 11:38:23,952 - DEBUG - Edge anomaly scores shape: torch.Size([23651, 1])
2025-06-03 11:38:23,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:24,652 - DEBUG - Step 8: Loss=0.6054
2025-06-03 11:38:24,652 - DEBUG - Online update step: 9/50
2025-06-03 11:38:24,654 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:25,077 - DEBUG - Node anomaly scores shape: torch.Size([11353, 1])
2025-06-03 11:38:25,113 - DEBUG - Edge anomaly scores shape: torch.Size([23943, 1])
2025-06-03 11:38:25,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:25,807 - DEBUG - Step 9: Loss=0.5906
2025-06-03 11:38:25,807 - DEBUG - Online update step: 10/50
2025-06-03 11:38:25,809 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:26,158 - DEBUG - Node anomaly scores shape: torch.Size([10225, 1])
2025-06-03 11:38:26,189 - DEBUG - Edge anomaly scores shape: torch.Size([21408, 1])
2025-06-03 11:38:26,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:26,730 - DEBUG - Step 10: Loss=0.5865
2025-06-03 11:38:26,731 - DEBUG - Online update step: 11/50
2025-06-03 11:38:26,732 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:27,080 - DEBUG - Node anomaly scores shape: torch.Size([10213, 1])
2025-06-03 11:38:27,114 - DEBUG - Edge anomaly scores shape: torch.Size([21328, 1])
2025-06-03 11:38:27,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:27,713 - DEBUG - Step 11: Loss=0.5786
2025-06-03 11:38:27,714 - DEBUG - Online update step: 12/50
2025-06-03 11:38:27,716 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:28,116 - DEBUG - Node anomaly scores shape: torch.Size([10906, 1])
2025-06-03 11:38:28,151 - DEBUG - Edge anomaly scores shape: torch.Size([22898, 1])
2025-06-03 11:38:28,152 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:28,760 - DEBUG - Step 12: Loss=0.5939
2025-06-03 11:38:28,760 - DEBUG - Online update step: 13/50
2025-06-03 11:38:28,761 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:29,137 - DEBUG - Node anomaly scores shape: torch.Size([10618, 1])
2025-06-03 11:38:29,171 - DEBUG - Edge anomaly scores shape: torch.Size([22172, 1])
2025-06-03 11:38:29,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:29,775 - DEBUG - Step 13: Loss=0.5925
2025-06-03 11:38:29,775 - DEBUG - Online update step: 14/50
2025-06-03 11:38:29,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:30,220 - DEBUG - Node anomaly scores shape: torch.Size([11924, 1])
2025-06-03 11:38:30,258 - DEBUG - Edge anomaly scores shape: torch.Size([25147, 1])
2025-06-03 11:38:30,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:30,972 - DEBUG - Step 14: Loss=0.5768
2025-06-03 11:38:30,972 - DEBUG - Online update step: 15/50
2025-06-03 11:38:30,974 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:31,320 - DEBUG - Node anomaly scores shape: torch.Size([9789, 1])
2025-06-03 11:38:31,351 - DEBUG - Edge anomaly scores shape: torch.Size([20303, 1])
2025-06-03 11:38:31,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:32,006 - DEBUG - Step 15: Loss=0.5960
2025-06-03 11:38:32,006 - DEBUG - Online update step: 16/50
2025-06-03 11:38:32,009 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:32,463 - DEBUG - Node anomaly scores shape: torch.Size([12063, 1])
2025-06-03 11:38:32,500 - DEBUG - Edge anomaly scores shape: torch.Size([25600, 1])
2025-06-03 11:38:32,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:33,265 - DEBUG - Step 16: Loss=0.5857
2025-06-03 11:38:33,265 - DEBUG - Online update step: 17/50
2025-06-03 11:38:33,268 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:33,658 - DEBUG - Node anomaly scores shape: torch.Size([10848, 1])
2025-06-03 11:38:33,693 - DEBUG - Edge anomaly scores shape: torch.Size([22836, 1])
2025-06-03 11:38:33,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:34,397 - DEBUG - Step 17: Loss=0.5885
2025-06-03 11:38:34,398 - DEBUG - Online update step: 18/50
2025-06-03 11:38:34,399 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:34,791 - DEBUG - Node anomaly scores shape: torch.Size([11131, 1])
2025-06-03 11:38:34,830 - DEBUG - Edge anomaly scores shape: torch.Size([23450, 1])
2025-06-03 11:38:34,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:35,541 - DEBUG - Step 18: Loss=0.5962
2025-06-03 11:38:35,541 - DEBUG - Online update step: 19/50
2025-06-03 11:38:35,543 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:35,898 - DEBUG - Node anomaly scores shape: torch.Size([9905, 1])
2025-06-03 11:38:35,935 - DEBUG - Edge anomaly scores shape: torch.Size([20464, 1])
2025-06-03 11:38:35,936 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:36,584 - DEBUG - Step 19: Loss=0.5991
2025-06-03 11:38:36,585 - DEBUG - Online update step: 20/50
2025-06-03 11:38:36,587 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:36,971 - DEBUG - Node anomaly scores shape: torch.Size([10443, 1])
2025-06-03 11:38:37,002 - DEBUG - Edge anomaly scores shape: torch.Size([21875, 1])
2025-06-03 11:38:37,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:37,747 - DEBUG - Step 20: Loss=0.5966
2025-06-03 11:38:37,748 - DEBUG - Online update step: 21/50
2025-06-03 11:38:37,749 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:38,180 - DEBUG - Node anomaly scores shape: torch.Size([10914, 1])
2025-06-03 11:38:38,216 - DEBUG - Edge anomaly scores shape: torch.Size([22928, 1])
2025-06-03 11:38:38,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:39,012 - DEBUG - Step 21: Loss=0.5783
2025-06-03 11:38:39,012 - DEBUG - Online update step: 22/50
2025-06-03 11:38:39,014 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:39,514 - DEBUG - Node anomaly scores shape: torch.Size([11835, 1])
2025-06-03 11:38:39,553 - DEBUG - Edge anomaly scores shape: torch.Size([24838, 1])
2025-06-03 11:38:39,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:40,441 - DEBUG - Step 22: Loss=0.5886
2025-06-03 11:38:40,442 - DEBUG - Online update step: 23/50
2025-06-03 11:38:40,443 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:40,863 - DEBUG - Node anomaly scores shape: torch.Size([10527, 1])
2025-06-03 11:38:40,903 - DEBUG - Edge anomaly scores shape: torch.Size([21830, 1])
2025-06-03 11:38:40,904 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:41,661 - DEBUG - Step 23: Loss=0.5864
2025-06-03 11:38:41,661 - DEBUG - Online update step: 24/50
2025-06-03 11:38:41,663 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:42,120 - DEBUG - Node anomaly scores shape: torch.Size([10788, 1])
2025-06-03 11:38:42,158 - DEBUG - Edge anomaly scores shape: torch.Size([22555, 1])
2025-06-03 11:38:42,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:43,012 - DEBUG - Step 24: Loss=0.5730
2025-06-03 11:38:43,012 - DEBUG - Online update step: 25/50
2025-06-03 11:38:43,015 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:43,556 - DEBUG - Node anomaly scores shape: torch.Size([12175, 1])
2025-06-03 11:38:43,601 - DEBUG - Edge anomaly scores shape: torch.Size([25819, 1])
2025-06-03 11:38:43,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:44,638 - DEBUG - Step 25: Loss=0.5709
2025-06-03 11:38:44,638 - DEBUG - Online update step: 26/50
2025-06-03 11:38:44,641 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:45,136 - DEBUG - Node anomaly scores shape: torch.Size([11482, 1])
2025-06-03 11:38:45,169 - DEBUG - Edge anomaly scores shape: torch.Size([24151, 1])
2025-06-03 11:38:45,170 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:45,890 - DEBUG - Step 26: Loss=0.6151
2025-06-03 11:38:45,890 - DEBUG - Online update step: 27/50
2025-06-03 11:38:45,892 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:46,240 - DEBUG - Node anomaly scores shape: torch.Size([10473, 1])
2025-06-03 11:38:46,270 - DEBUG - Edge anomaly scores shape: torch.Size([21828, 1])
2025-06-03 11:38:46,272 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:46,897 - DEBUG - Step 27: Loss=0.6005
2025-06-03 11:38:46,897 - DEBUG - Online update step: 28/50
2025-06-03 11:38:46,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:47,297 - DEBUG - Node anomaly scores shape: torch.Size([10986, 1])
2025-06-03 11:38:47,329 - DEBUG - Edge anomaly scores shape: torch.Size([23099, 1])
2025-06-03 11:38:47,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:48,079 - DEBUG - Step 28: Loss=0.5780
2025-06-03 11:38:48,079 - DEBUG - Online update step: 29/50
2025-06-03 11:38:48,082 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:48,477 - DEBUG - Node anomaly scores shape: torch.Size([10953, 1])
2025-06-03 11:38:48,514 - DEBUG - Edge anomaly scores shape: torch.Size([22864, 1])
2025-06-03 11:38:48,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:49,247 - DEBUG - Step 29: Loss=0.5784
2025-06-03 11:38:49,248 - DEBUG - Online update step: 30/50
2025-06-03 11:38:49,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:49,696 - DEBUG - Node anomaly scores shape: torch.Size([11858, 1])
2025-06-03 11:38:49,734 - DEBUG - Edge anomaly scores shape: torch.Size([24989, 1])
2025-06-03 11:38:49,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:50,511 - DEBUG - Step 30: Loss=0.6082
2025-06-03 11:38:50,512 - DEBUG - Online update step: 31/50
2025-06-03 11:38:50,513 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:50,914 - DEBUG - Node anomaly scores shape: torch.Size([11760, 1])
2025-06-03 11:38:50,953 - DEBUG - Edge anomaly scores shape: torch.Size([24871, 1])
2025-06-03 11:38:50,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:51,791 - DEBUG - Step 31: Loss=0.5815
2025-06-03 11:38:51,791 - DEBUG - Online update step: 32/50
2025-06-03 11:38:51,793 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:52,269 - DEBUG - Node anomaly scores shape: torch.Size([11727, 1])
2025-06-03 11:38:52,316 - DEBUG - Edge anomaly scores shape: torch.Size([24710, 1])
2025-06-03 11:38:52,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:53,339 - DEBUG - Step 32: Loss=0.5789
2025-06-03 11:38:53,339 - DEBUG - Online update step: 33/50
2025-06-03 11:38:53,341 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:53,765 - DEBUG - Node anomaly scores shape: torch.Size([9612, 1])
2025-06-03 11:38:53,802 - DEBUG - Edge anomaly scores shape: torch.Size([19833, 1])
2025-06-03 11:38:53,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:54,572 - DEBUG - Step 33: Loss=0.5875
2025-06-03 11:38:54,572 - DEBUG - Online update step: 34/50
2025-06-03 11:38:54,574 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:54,958 - DEBUG - Node anomaly scores shape: torch.Size([9541, 1])
2025-06-03 11:38:54,992 - DEBUG - Edge anomaly scores shape: torch.Size([19647, 1])
2025-06-03 11:38:54,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:55,714 - DEBUG - Step 34: Loss=0.6031
2025-06-03 11:38:55,714 - DEBUG - Online update step: 35/50
2025-06-03 11:38:55,718 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:56,177 - DEBUG - Node anomaly scores shape: torch.Size([10562, 1])
2025-06-03 11:38:56,216 - DEBUG - Edge anomaly scores shape: torch.Size([22088, 1])
2025-06-03 11:38:56,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:56,977 - DEBUG - Step 35: Loss=0.5766
2025-06-03 11:38:56,978 - DEBUG - Online update step: 36/50
2025-06-03 11:38:56,980 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:57,452 - DEBUG - Node anomaly scores shape: torch.Size([11312, 1])
2025-06-03 11:38:57,493 - DEBUG - Edge anomaly scores shape: torch.Size([23831, 1])
2025-06-03 11:38:57,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:38:58,453 - DEBUG - Step 36: Loss=0.5751
2025-06-03 11:38:58,453 - DEBUG - Online update step: 37/50
2025-06-03 11:38:58,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:38:58,943 - DEBUG - Node anomaly scores shape: torch.Size([11677, 1])
2025-06-03 11:38:58,989 - DEBUG - Edge anomaly scores shape: torch.Size([24602, 1])
2025-06-03 11:38:58,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:00,027 - DEBUG - Step 37: Loss=0.5806
2025-06-03 11:39:00,027 - DEBUG - Online update step: 38/50
2025-06-03 11:39:00,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:00,421 - DEBUG - Node anomaly scores shape: torch.Size([10433, 1])
2025-06-03 11:39:00,455 - DEBUG - Edge anomaly scores shape: torch.Size([21803, 1])
2025-06-03 11:39:00,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:01,168 - DEBUG - Step 38: Loss=0.5878
2025-06-03 11:39:01,169 - DEBUG - Online update step: 39/50
2025-06-03 11:39:01,171 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:01,563 - DEBUG - Node anomaly scores shape: torch.Size([10637, 1])
2025-06-03 11:39:01,595 - DEBUG - Edge anomaly scores shape: torch.Size([22329, 1])
2025-06-03 11:39:01,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:02,282 - DEBUG - Step 39: Loss=0.5832
2025-06-03 11:39:02,282 - DEBUG - Online update step: 40/50
2025-06-03 11:39:02,284 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:02,668 - DEBUG - Node anomaly scores shape: torch.Size([10845, 1])
2025-06-03 11:39:02,700 - DEBUG - Edge anomaly scores shape: torch.Size([22735, 1])
2025-06-03 11:39:02,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:03,414 - DEBUG - Step 40: Loss=0.5829
2025-06-03 11:39:03,414 - DEBUG - Online update step: 41/50
2025-06-03 11:39:03,415 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:03,780 - DEBUG - Node anomaly scores shape: torch.Size([10611, 1])
2025-06-03 11:39:03,811 - DEBUG - Edge anomaly scores shape: torch.Size([22205, 1])
2025-06-03 11:39:03,811 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:04,515 - DEBUG - Step 41: Loss=0.5890
2025-06-03 11:39:04,515 - DEBUG - Online update step: 42/50
2025-06-03 11:39:04,518 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:04,850 - DEBUG - Node anomaly scores shape: torch.Size([10233, 1])
2025-06-03 11:39:04,879 - DEBUG - Edge anomaly scores shape: torch.Size([21230, 1])
2025-06-03 11:39:04,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:05,531 - DEBUG - Step 42: Loss=0.5709
2025-06-03 11:39:05,532 - DEBUG - Online update step: 43/50
2025-06-03 11:39:05,534 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:05,965 - DEBUG - Node anomaly scores shape: torch.Size([11611, 1])
2025-06-03 11:39:06,003 - DEBUG - Edge anomaly scores shape: torch.Size([24472, 1])
2025-06-03 11:39:06,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:06,788 - DEBUG - Step 43: Loss=0.5675
2025-06-03 11:39:06,788 - DEBUG - Online update step: 44/50
2025-06-03 11:39:06,791 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:07,156 - DEBUG - Node anomaly scores shape: torch.Size([10353, 1])
2025-06-03 11:39:07,187 - DEBUG - Edge anomaly scores shape: torch.Size([21586, 1])
2025-06-03 11:39:07,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:07,833 - DEBUG - Step 44: Loss=0.5789
2025-06-03 11:39:07,833 - DEBUG - Online update step: 45/50
2025-06-03 11:39:07,835 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:08,248 - DEBUG - Node anomaly scores shape: torch.Size([11692, 1])
2025-06-03 11:39:08,285 - DEBUG - Edge anomaly scores shape: torch.Size([24513, 1])
2025-06-03 11:39:08,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:09,036 - DEBUG - Step 45: Loss=0.5833
2025-06-03 11:39:09,036 - DEBUG - Online update step: 46/50
2025-06-03 11:39:09,038 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:09,368 - DEBUG - Node anomaly scores shape: torch.Size([9128, 1])
2025-06-03 11:39:09,395 - DEBUG - Edge anomaly scores shape: torch.Size([18776, 1])
2025-06-03 11:39:09,396 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:10,011 - DEBUG - Step 46: Loss=0.5874
2025-06-03 11:39:10,011 - DEBUG - Online update step: 47/50
2025-06-03 11:39:10,012 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:10,414 - DEBUG - Node anomaly scores shape: torch.Size([11479, 1])
2025-06-03 11:39:10,449 - DEBUG - Edge anomaly scores shape: torch.Size([24231, 1])
2025-06-03 11:39:10,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:11,200 - DEBUG - Step 47: Loss=0.5685
2025-06-03 11:39:11,201 - DEBUG - Online update step: 48/50
2025-06-03 11:39:11,202 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:11,553 - DEBUG - Node anomaly scores shape: torch.Size([10794, 1])
2025-06-03 11:39:11,585 - DEBUG - Edge anomaly scores shape: torch.Size([22548, 1])
2025-06-03 11:39:11,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:12,203 - DEBUG - Step 48: Loss=0.5875
2025-06-03 11:39:12,203 - DEBUG - Online update step: 49/50
2025-06-03 11:39:12,205 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:12,533 - DEBUG - Node anomaly scores shape: torch.Size([9904, 1])
2025-06-03 11:39:12,563 - DEBUG - Edge anomaly scores shape: torch.Size([20502, 1])
2025-06-03 11:39:12,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:13,163 - DEBUG - Step 49: Loss=0.5856
2025-06-03 11:39:13,163 - DEBUG - Online update step: 50/50
2025-06-03 11:39:13,165 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:13,504 - DEBUG - Node anomaly scores shape: torch.Size([10298, 1])
2025-06-03 11:39:13,534 - DEBUG - Edge anomaly scores shape: torch.Size([21446, 1])
2025-06-03 11:39:13,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:14,232 - DEBUG - Step 50: Loss=0.5708
2025-06-03 11:39:14,232 - INFO - Online update finished. Average loss: 0.5873, Learning rate: 0.001266
2025-06-03 11:39:14,233 - DEBUG - Current node mean: [ 1.1896145e-08 -1.1896145e-08 -6.9394179e-09 -1.1648309e-08
 -7.9307636e-09 -1.9826909e-09  6.5924475e-08 -2.0074745e-08
 -1.7348545e-09  9.9134541e-09 -1.7844219e-08  3.1723054e-08
  1.8339891e-08  1.9826909e-09  7.9307636e-09 -4.9567273e-10
 -1.0409127e-08  0.0000000e+00  0.0000000e+00  8.4264364e-09
  0.0000000e+00  0.0000000e+00 -1.2391818e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4180171e+00  5.6916113e+00 -9.0912711e-10  3.1819447e-09
  1.3636906e-09 -4.0910719e-09 -1.8182542e-09 -1.8182542e-09
 -9.0912711e-10 -3.6365084e-09  1.6137006e-08 -5.4547624e-09
  0.0000000e+00 -9.5458343e-09  9.5458343e-09 -2.3864586e-09
 -2.3864586e-09 -2.3864586e-09 -2.3864586e-09 -2.3864586e-09
 -2.3864586e-09  9.0912711e-10]
2025-06-03 11:39:14,233 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0112
2025-06-03 11:39:14,240 - INFO - Online update complete. Loss: 0.5873
2025-06-03 11:39:14,240 - INFO - Running anomaly detection...
2025-06-03 11:39:14,240 - INFO - Starting anomaly detection.
2025-06-03 11:39:14,253 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_113914_update_37.json
2025-06-03 11:39:14,254 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:39:14,273 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_113914_update_37.pth and as latest_checkpoint.pth
2025-06-03 11:39:14,273 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.0000
2025-06-03 11:39:14,273 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:39:14,273 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.0993, MLP Score: 1.0000
2025-06-03 11:39:14,273 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9673, MLP Score: 1.0000
2025-06-03 11:39:14,273 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.0183, MLP Score: 1.0000
2025-06-03 11:39:14,273 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.5811, MLP Score: 1.0000
2025-06-03 11:39:14,273 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.2203, MLP Score: 1.0000
2025-06-03 11:39:14,273 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:39:14,273 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.6094, MLP Score: 0.9997
2025-06-03 11:39:14,273 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7583, MLP Score: 0.9995
2025-06-03 11:39:14,274 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.0015, MLP Score: 0.9997
2025-06-03 11:39:14,274 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4187, MLP Score: 0.9932
2025-06-03 11:39:14,274 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4792, MLP Score: 0.9970
2025-06-03 11:39:14,274 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-03 11:39:14,274 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-03 11:39:14,274 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot file.
2025-06-03 11:39:14,292 - INFO - Parsed 985 nodes.
2025-06-03 11:39:14,311 - INFO - Parsed 2150 edges.
2025-06-03 11:39:14,954 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:39:14,954 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:39:14,970 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-03 11:39:14,972 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:39:14,972 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-03 11:39:14,973 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-03 11:39:14,973 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:39:14,984 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:39:14,985 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:39:14,987 - DEBUG - Shape of encoded categorical edge features: torch.Size([2150, 2])
2025-06-03 11:39:14,988 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:39:14,988 - DEBUG - Shape of scaled numerical edge features: torch.Size([2150, 20])
2025-06-03 11:39:14,988 - DEBUG - Final edge attributes tensor shape: torch.Size([2150, 22])
2025-06-03 11:39:14,989 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:39:14,989 - INFO - Performing online update...
2025-06-03 11:39:14,989 - INFO - Starting online update for 50 steps.
2025-06-03 11:39:14,989 - DEBUG - Updated RunningStats: new_mean=0.54813235178631, new_var=82800000000009.05, new_n=8310
2025-06-03 11:39:14,989 - DEBUG - Updated RunningStats: new_mean=0.5484399874249838, new_var=83100000000007.19, new_n=8340
2025-06-03 11:39:14,990 - DEBUG - Updated RunningStats: new_mean=0.7805664906736599, new_var=48480000000036.84, new_n=4870
2025-06-03 11:39:14,990 - DEBUG - Updated RunningStats: new_mean=0.7816862357564213, new_var=48700000000002.88, new_n=4892
2025-06-03 11:39:14,990 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:39:14,990 - DEBUG - Online update step: 1/50
2025-06-03 11:39:14,991 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:15,375 - DEBUG - Node anomaly scores shape: torch.Size([10858, 1])
2025-06-03 11:39:15,412 - DEBUG - Edge anomaly scores shape: torch.Size([22933, 1])
2025-06-03 11:39:15,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:16,225 - DEBUG - Step 1: Loss=0.5693
2025-06-03 11:39:16,225 - DEBUG - Online update step: 2/50
2025-06-03 11:39:16,227 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:16,771 - DEBUG - Node anomaly scores shape: torch.Size([12342, 1])
2025-06-03 11:39:16,814 - DEBUG - Edge anomaly scores shape: torch.Size([26215, 1])
2025-06-03 11:39:16,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:17,911 - DEBUG - Step 2: Loss=0.5861
2025-06-03 11:39:17,911 - DEBUG - Online update step: 3/50
2025-06-03 11:39:17,913 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:18,462 - DEBUG - Node anomaly scores shape: torch.Size([11557, 1])
2025-06-03 11:39:18,506 - DEBUG - Edge anomaly scores shape: torch.Size([24373, 1])
2025-06-03 11:39:18,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:19,486 - DEBUG - Step 3: Loss=0.5870
2025-06-03 11:39:19,486 - DEBUG - Online update step: 4/50
2025-06-03 11:39:19,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:19,912 - DEBUG - Node anomaly scores shape: torch.Size([10477, 1])
2025-06-03 11:39:19,950 - DEBUG - Edge anomaly scores shape: torch.Size([21900, 1])
2025-06-03 11:39:19,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:20,763 - DEBUG - Step 4: Loss=0.5921
2025-06-03 11:39:20,763 - DEBUG - Online update step: 5/50
2025-06-03 11:39:20,765 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:21,168 - DEBUG - Node anomaly scores shape: torch.Size([11843, 1])
2025-06-03 11:39:21,203 - DEBUG - Edge anomaly scores shape: torch.Size([24986, 1])
2025-06-03 11:39:21,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:21,921 - DEBUG - Step 5: Loss=0.5867
2025-06-03 11:39:21,921 - DEBUG - Online update step: 6/50
2025-06-03 11:39:21,922 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:22,254 - DEBUG - Node anomaly scores shape: torch.Size([9812, 1])
2025-06-03 11:39:22,286 - DEBUG - Edge anomaly scores shape: torch.Size([20304, 1])
2025-06-03 11:39:22,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:22,937 - DEBUG - Step 6: Loss=0.5865
2025-06-03 11:39:22,938 - DEBUG - Online update step: 7/50
2025-06-03 11:39:22,941 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:23,307 - DEBUG - Node anomaly scores shape: torch.Size([10577, 1])
2025-06-03 11:39:23,338 - DEBUG - Edge anomaly scores shape: torch.Size([21980, 1])
2025-06-03 11:39:23,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:24,082 - DEBUG - Step 7: Loss=0.5877
2025-06-03 11:39:24,083 - DEBUG - Online update step: 8/50
2025-06-03 11:39:24,084 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:24,435 - DEBUG - Node anomaly scores shape: torch.Size([10666, 1])
2025-06-03 11:39:24,466 - DEBUG - Edge anomaly scores shape: torch.Size([22256, 1])
2025-06-03 11:39:24,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:25,179 - DEBUG - Step 8: Loss=0.5817
2025-06-03 11:39:25,179 - DEBUG - Online update step: 9/50
2025-06-03 11:39:25,181 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:25,553 - DEBUG - Node anomaly scores shape: torch.Size([11193, 1])
2025-06-03 11:39:25,588 - DEBUG - Edge anomaly scores shape: torch.Size([23534, 1])
2025-06-03 11:39:25,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:26,330 - DEBUG - Step 9: Loss=0.5863
2025-06-03 11:39:26,330 - DEBUG - Online update step: 10/50
2025-06-03 11:39:26,332 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:26,712 - DEBUG - Node anomaly scores shape: torch.Size([10985, 1])
2025-06-03 11:39:26,745 - DEBUG - Edge anomaly scores shape: torch.Size([23125, 1])
2025-06-03 11:39:26,746 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:27,513 - DEBUG - Step 10: Loss=0.5828
2025-06-03 11:39:27,514 - DEBUG - Online update step: 11/50
2025-06-03 11:39:27,516 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:27,851 - DEBUG - Node anomaly scores shape: torch.Size([9835, 1])
2025-06-03 11:39:27,884 - DEBUG - Edge anomaly scores shape: torch.Size([20434, 1])
2025-06-03 11:39:27,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:28,509 - DEBUG - Step 11: Loss=0.5776
2025-06-03 11:39:28,509 - DEBUG - Online update step: 12/50
2025-06-03 11:39:28,511 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:28,893 - DEBUG - Node anomaly scores shape: torch.Size([11202, 1])
2025-06-03 11:39:28,929 - DEBUG - Edge anomaly scores shape: torch.Size([23454, 1])
2025-06-03 11:39:28,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:29,670 - DEBUG - Step 12: Loss=0.5934
2025-06-03 11:39:29,670 - DEBUG - Online update step: 13/50
2025-06-03 11:39:29,672 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:30,116 - DEBUG - Node anomaly scores shape: torch.Size([12001, 1])
2025-06-03 11:39:30,153 - DEBUG - Edge anomaly scores shape: torch.Size([25410, 1])
2025-06-03 11:39:30,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:30,925 - DEBUG - Step 13: Loss=0.5726
2025-06-03 11:39:30,925 - DEBUG - Online update step: 14/50
2025-06-03 11:39:30,927 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:31,244 - DEBUG - Node anomaly scores shape: torch.Size([9567, 1])
2025-06-03 11:39:31,271 - DEBUG - Edge anomaly scores shape: torch.Size([19672, 1])
2025-06-03 11:39:31,272 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:31,852 - DEBUG - Step 14: Loss=0.5729
2025-06-03 11:39:31,852 - DEBUG - Online update step: 15/50
2025-06-03 11:39:31,854 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:32,228 - DEBUG - Node anomaly scores shape: torch.Size([10933, 1])
2025-06-03 11:39:32,262 - DEBUG - Edge anomaly scores shape: torch.Size([22972, 1])
2025-06-03 11:39:32,262 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:32,994 - DEBUG - Step 15: Loss=0.5809
2025-06-03 11:39:32,994 - DEBUG - Online update step: 16/50
2025-06-03 11:39:32,996 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:33,437 - DEBUG - Node anomaly scores shape: torch.Size([11736, 1])
2025-06-03 11:39:33,474 - DEBUG - Edge anomaly scores shape: torch.Size([24655, 1])
2025-06-03 11:39:33,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:34,351 - DEBUG - Step 16: Loss=0.5790
2025-06-03 11:39:34,351 - DEBUG - Online update step: 17/50
2025-06-03 11:39:34,353 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:34,817 - DEBUG - Node anomaly scores shape: torch.Size([12249, 1])
2025-06-03 11:39:34,861 - DEBUG - Edge anomaly scores shape: torch.Size([25949, 1])
2025-06-03 11:39:34,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:35,726 - DEBUG - Step 17: Loss=0.5839
2025-06-03 11:39:35,726 - DEBUG - Online update step: 18/50
2025-06-03 11:39:35,728 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:36,135 - DEBUG - Node anomaly scores shape: torch.Size([11566, 1])
2025-06-03 11:39:36,171 - DEBUG - Edge anomaly scores shape: torch.Size([24444, 1])
2025-06-03 11:39:36,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:36,982 - DEBUG - Step 18: Loss=0.5717
2025-06-03 11:39:36,982 - DEBUG - Online update step: 19/50
2025-06-03 11:39:36,984 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:37,382 - DEBUG - Node anomaly scores shape: torch.Size([11561, 1])
2025-06-03 11:39:37,421 - DEBUG - Edge anomaly scores shape: torch.Size([24269, 1])
2025-06-03 11:39:37,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:38,305 - DEBUG - Step 19: Loss=0.5799
2025-06-03 11:39:38,306 - DEBUG - Online update step: 20/50
2025-06-03 11:39:38,309 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:38,744 - DEBUG - Node anomaly scores shape: torch.Size([10904, 1])
2025-06-03 11:39:38,782 - DEBUG - Edge anomaly scores shape: torch.Size([22981, 1])
2025-06-03 11:39:38,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:39,571 - DEBUG - Step 20: Loss=0.5906
2025-06-03 11:39:39,572 - DEBUG - Online update step: 21/50
2025-06-03 11:39:39,574 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:40,075 - DEBUG - Node anomaly scores shape: torch.Size([11613, 1])
2025-06-03 11:39:40,114 - DEBUG - Edge anomaly scores shape: torch.Size([24592, 1])
2025-06-03 11:39:40,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:41,053 - DEBUG - Step 21: Loss=0.5945
2025-06-03 11:39:41,053 - DEBUG - Online update step: 22/50
2025-06-03 11:39:41,055 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:41,495 - DEBUG - Node anomaly scores shape: torch.Size([10957, 1])
2025-06-03 11:39:41,535 - DEBUG - Edge anomaly scores shape: torch.Size([22843, 1])
2025-06-03 11:39:41,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:42,431 - DEBUG - Step 22: Loss=0.5726
2025-06-03 11:39:42,431 - DEBUG - Online update step: 23/50
2025-06-03 11:39:42,433 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:42,933 - DEBUG - Node anomaly scores shape: torch.Size([11667, 1])
2025-06-03 11:39:42,975 - DEBUG - Edge anomaly scores shape: torch.Size([24598, 1])
2025-06-03 11:39:42,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:44,052 - DEBUG - Step 23: Loss=0.5760
2025-06-03 11:39:44,052 - DEBUG - Online update step: 24/50
2025-06-03 11:39:44,054 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:44,599 - DEBUG - Node anomaly scores shape: torch.Size([10959, 1])
2025-06-03 11:39:44,650 - DEBUG - Edge anomaly scores shape: torch.Size([23003, 1])
2025-06-03 11:39:44,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:45,626 - DEBUG - Step 24: Loss=0.5850
2025-06-03 11:39:45,626 - DEBUG - Online update step: 25/50
2025-06-03 11:39:45,628 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:46,111 - DEBUG - Node anomaly scores shape: torch.Size([10843, 1])
2025-06-03 11:39:46,155 - DEBUG - Edge anomaly scores shape: torch.Size([22738, 1])
2025-06-03 11:39:46,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:47,046 - DEBUG - Step 25: Loss=0.5814
2025-06-03 11:39:47,046 - DEBUG - Online update step: 26/50
2025-06-03 11:39:47,048 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:47,552 - DEBUG - Node anomaly scores shape: torch.Size([11985, 1])
2025-06-03 11:39:47,596 - DEBUG - Edge anomaly scores shape: torch.Size([25504, 1])
2025-06-03 11:39:47,597 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:48,571 - DEBUG - Step 26: Loss=0.5833
2025-06-03 11:39:48,571 - DEBUG - Online update step: 27/50
2025-06-03 11:39:48,574 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:48,924 - DEBUG - Node anomaly scores shape: torch.Size([10348, 1])
2025-06-03 11:39:48,956 - DEBUG - Edge anomaly scores shape: torch.Size([21531, 1])
2025-06-03 11:39:48,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:49,564 - DEBUG - Step 27: Loss=0.5789
2025-06-03 11:39:49,564 - DEBUG - Online update step: 28/50
2025-06-03 11:39:49,565 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:49,951 - DEBUG - Node anomaly scores shape: torch.Size([11288, 1])
2025-06-03 11:39:49,984 - DEBUG - Edge anomaly scores shape: torch.Size([23770, 1])
2025-06-03 11:39:49,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:50,763 - DEBUG - Step 28: Loss=0.5788
2025-06-03 11:39:50,763 - DEBUG - Online update step: 29/50
2025-06-03 11:39:50,764 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:51,121 - DEBUG - Node anomaly scores shape: torch.Size([10546, 1])
2025-06-03 11:39:51,154 - DEBUG - Edge anomaly scores shape: torch.Size([22087, 1])
2025-06-03 11:39:51,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:51,853 - DEBUG - Step 29: Loss=0.5845
2025-06-03 11:39:51,854 - DEBUG - Online update step: 30/50
2025-06-03 11:39:51,856 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:52,272 - DEBUG - Node anomaly scores shape: torch.Size([11511, 1])
2025-06-03 11:39:52,304 - DEBUG - Edge anomaly scores shape: torch.Size([24233, 1])
2025-06-03 11:39:52,304 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:53,048 - DEBUG - Step 30: Loss=0.5749
2025-06-03 11:39:53,048 - DEBUG - Online update step: 31/50
2025-06-03 11:39:53,051 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:53,419 - DEBUG - Node anomaly scores shape: torch.Size([11309, 1])
2025-06-03 11:39:53,453 - DEBUG - Edge anomaly scores shape: torch.Size([23843, 1])
2025-06-03 11:39:53,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:54,207 - DEBUG - Step 31: Loss=0.5728
2025-06-03 11:39:54,207 - DEBUG - Online update step: 32/50
2025-06-03 11:39:54,209 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:54,583 - DEBUG - Node anomaly scores shape: torch.Size([11475, 1])
2025-06-03 11:39:54,621 - DEBUG - Edge anomaly scores shape: torch.Size([24091, 1])
2025-06-03 11:39:54,622 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:55,311 - DEBUG - Step 32: Loss=0.5868
2025-06-03 11:39:55,311 - DEBUG - Online update step: 33/50
2025-06-03 11:39:55,314 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:55,669 - DEBUG - Node anomaly scores shape: torch.Size([11095, 1])
2025-06-03 11:39:55,703 - DEBUG - Edge anomaly scores shape: torch.Size([23336, 1])
2025-06-03 11:39:55,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:56,429 - DEBUG - Step 33: Loss=0.5692
2025-06-03 11:39:56,429 - DEBUG - Online update step: 34/50
2025-06-03 11:39:56,431 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:56,754 - DEBUG - Node anomaly scores shape: torch.Size([9747, 1])
2025-06-03 11:39:56,781 - DEBUG - Edge anomaly scores shape: torch.Size([20203, 1])
2025-06-03 11:39:56,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:57,406 - DEBUG - Step 34: Loss=0.5774
2025-06-03 11:39:57,406 - DEBUG - Online update step: 35/50
2025-06-03 11:39:57,408 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:57,763 - DEBUG - Node anomaly scores shape: torch.Size([10075, 1])
2025-06-03 11:39:57,792 - DEBUG - Edge anomaly scores shape: torch.Size([20891, 1])
2025-06-03 11:39:57,792 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:58,449 - DEBUG - Step 35: Loss=0.5786
2025-06-03 11:39:58,449 - DEBUG - Online update step: 36/50
2025-06-03 11:39:58,451 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:39:58,891 - DEBUG - Node anomaly scores shape: torch.Size([11944, 1])
2025-06-03 11:39:58,930 - DEBUG - Edge anomaly scores shape: torch.Size([25267, 1])
2025-06-03 11:39:58,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:39:59,683 - DEBUG - Step 36: Loss=0.5737
2025-06-03 11:39:59,683 - DEBUG - Online update step: 37/50
2025-06-03 11:39:59,685 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:00,009 - DEBUG - Node anomaly scores shape: torch.Size([9616, 1])
2025-06-03 11:40:00,038 - DEBUG - Edge anomaly scores shape: torch.Size([20001, 1])
2025-06-03 11:40:00,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:00,725 - DEBUG - Step 37: Loss=0.5655
2025-06-03 11:40:00,725 - DEBUG - Online update step: 38/50
2025-06-03 11:40:00,727 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:01,105 - DEBUG - Node anomaly scores shape: torch.Size([11258, 1])
2025-06-03 11:40:01,140 - DEBUG - Edge anomaly scores shape: torch.Size([23525, 1])
2025-06-03 11:40:01,141 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:01,974 - DEBUG - Step 38: Loss=0.5797
2025-06-03 11:40:01,975 - DEBUG - Online update step: 39/50
2025-06-03 11:40:01,976 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:02,388 - DEBUG - Node anomaly scores shape: torch.Size([11507, 1])
2025-06-03 11:40:02,425 - DEBUG - Edge anomaly scores shape: torch.Size([24262, 1])
2025-06-03 11:40:02,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:03,328 - DEBUG - Step 39: Loss=0.5800
2025-06-03 11:40:03,328 - DEBUG - Online update step: 40/50
2025-06-03 11:40:03,331 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:03,733 - DEBUG - Node anomaly scores shape: torch.Size([10747, 1])
2025-06-03 11:40:03,771 - DEBUG - Edge anomaly scores shape: torch.Size([22491, 1])
2025-06-03 11:40:03,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:04,559 - DEBUG - Step 40: Loss=0.5824
2025-06-03 11:40:04,559 - DEBUG - Online update step: 41/50
2025-06-03 11:40:04,561 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:04,999 - DEBUG - Node anomaly scores shape: torch.Size([11497, 1])
2025-06-03 11:40:05,038 - DEBUG - Edge anomaly scores shape: torch.Size([24200, 1])
2025-06-03 11:40:05,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:05,994 - DEBUG - Step 41: Loss=0.5832
2025-06-03 11:40:05,995 - DEBUG - Online update step: 42/50
2025-06-03 11:40:05,997 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:06,423 - DEBUG - Node anomaly scores shape: torch.Size([10993, 1])
2025-06-03 11:40:06,460 - DEBUG - Edge anomaly scores shape: torch.Size([23130, 1])
2025-06-03 11:40:06,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:07,275 - DEBUG - Step 42: Loss=0.5750
2025-06-03 11:40:07,275 - DEBUG - Online update step: 43/50
2025-06-03 11:40:07,277 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:07,763 - DEBUG - Node anomaly scores shape: torch.Size([12053, 1])
2025-06-03 11:40:07,805 - DEBUG - Edge anomaly scores shape: torch.Size([25578, 1])
2025-06-03 11:40:07,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:08,764 - DEBUG - Step 43: Loss=0.5890
2025-06-03 11:40:08,764 - DEBUG - Online update step: 44/50
2025-06-03 11:40:08,767 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:09,162 - DEBUG - Node anomaly scores shape: torch.Size([11545, 1])
2025-06-03 11:40:09,196 - DEBUG - Edge anomaly scores shape: torch.Size([24336, 1])
2025-06-03 11:40:09,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:09,897 - DEBUG - Step 44: Loss=0.5676
2025-06-03 11:40:09,898 - DEBUG - Online update step: 45/50
2025-06-03 11:40:09,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:10,314 - DEBUG - Node anomaly scores shape: torch.Size([12139, 1])
2025-06-03 11:40:10,350 - DEBUG - Edge anomaly scores shape: torch.Size([25751, 1])
2025-06-03 11:40:10,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:11,145 - DEBUG - Step 45: Loss=0.5735
2025-06-03 11:40:11,146 - DEBUG - Online update step: 46/50
2025-06-03 11:40:11,147 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:11,515 - DEBUG - Node anomaly scores shape: torch.Size([11593, 1])
2025-06-03 11:40:11,549 - DEBUG - Edge anomaly scores shape: torch.Size([24473, 1])
2025-06-03 11:40:11,550 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:12,307 - DEBUG - Step 46: Loss=0.5656
2025-06-03 11:40:12,308 - DEBUG - Online update step: 47/50
2025-06-03 11:40:12,310 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:12,639 - DEBUG - Node anomaly scores shape: torch.Size([10283, 1])
2025-06-03 11:40:12,670 - DEBUG - Edge anomaly scores shape: torch.Size([21333, 1])
2025-06-03 11:40:12,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:13,358 - DEBUG - Step 47: Loss=0.5851
2025-06-03 11:40:13,358 - DEBUG - Online update step: 48/50
2025-06-03 11:40:13,359 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:13,715 - DEBUG - Node anomaly scores shape: torch.Size([10894, 1])
2025-06-03 11:40:13,748 - DEBUG - Edge anomaly scores shape: torch.Size([22840, 1])
2025-06-03 11:40:13,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:14,492 - DEBUG - Step 48: Loss=0.5968
2025-06-03 11:40:14,492 - DEBUG - Online update step: 49/50
2025-06-03 11:40:14,493 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:14,879 - DEBUG - Node anomaly scores shape: torch.Size([11199, 1])
2025-06-03 11:40:14,914 - DEBUG - Edge anomaly scores shape: torch.Size([23449, 1])
2025-06-03 11:40:14,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:15,656 - DEBUG - Step 49: Loss=0.5773
2025-06-03 11:40:15,656 - DEBUG - Online update step: 50/50
2025-06-03 11:40:15,657 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:16,031 - DEBUG - Node anomaly scores shape: torch.Size([11315, 1])
2025-06-03 11:40:16,064 - DEBUG - Edge anomaly scores shape: torch.Size([23766, 1])
2025-06-03 11:40:16,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:16,697 - DEBUG - Step 50: Loss=0.5695
2025-06-03 11:40:16,697 - INFO - Online update finished. Average loss: 0.5801, Learning rate: 0.001037
2025-06-03 11:40:16,697 - DEBUG - Current node mean: [ 2.9045919e-09 -2.9045919e-09  3.1950510e-08 -9.6819726e-09
 -3.6307398e-08 -4.1148382e-08 -1.4522959e-08  1.9363946e-09
  8.7137755e-09  1.9363946e-09  1.5733205e-08 -9.6819726e-09
  3.9696090e-08  7.2614798e-10  2.7109524e-08  9.6819726e-09
  7.7455784e-09  0.0000000e+00  0.0000000e+00  9.6819726e-09
  0.0000000e+00  0.0000000e+00  5.8091838e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4181396e+00  5.7032557e+00  1.7742778e-09  2.2178472e-09
 -3.9921249e-09 -1.3307083e-09 -4.1030175e-09  1.0645667e-08
  8.8713892e-10  2.2178472e-09  3.5485557e-09 -5.3228333e-09
 -8.8713892e-10 -3.5485557e-09  4.4356945e-09  8.8713892e-10
  8.8713892e-10  8.8713892e-10  8.8713892e-10  8.8713892e-10
  8.8713892e-10  1.7742778e-09]
2025-06-03 11:40:16,698 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0054
2025-06-03 11:40:16,698 - INFO - Online update complete. Loss: 0.5801
2025-06-03 11:40:16,698 - INFO - Running anomaly detection...
2025-06-03 11:40:16,698 - INFO - Starting anomaly detection.
2025-06-03 11:40:16,729 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114016_update_38.json
2025-06-03 11:40:16,729 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:40:16,754 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114016_update_38.pth and as latest_checkpoint.pth
2025-06-03 11:40:16,754 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.0000
2025-06-03 11:40:16,754 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:40:16,755 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.9599, MLP Score: 1.0000
2025-06-03 11:40:16,755 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.8775, MLP Score: 1.0000
2025-06-03 11:40:16,755 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.0055, MLP Score: 1.0000
2025-06-03 11:40:16,755 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.8795, MLP Score: 1.0000
2025-06-03 11:40:16,755 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.2604, MLP Score: 1.0000
2025-06-03 11:40:16,755 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:40:16,755 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5579, MLP Score: 0.9994
2025-06-03 11:40:16,755 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8051, MLP Score: 0.9995
2025-06-03 11:40:16,755 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.8960, MLP Score: 0.9998
2025-06-03 11:40:16,755 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.6767, MLP Score: 0.9949
2025-06-03 11:40:16,755 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4873, MLP Score: 0.9985
2025-06-03 11:40:16,755 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-03 11:40:16,755 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-03 11:40:16,755 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot file.
2025-06-03 11:40:16,773 - INFO - Parsed 994 nodes.
2025-06-03 11:40:16,792 - INFO - Parsed 2170 edges.
2025-06-03 11:40:17,426 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:40:17,426 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:40:17,442 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-03 11:40:17,444 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:40:17,444 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-03 11:40:17,445 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-03 11:40:17,445 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:40:17,456 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:40:17,457 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:40:17,459 - DEBUG - Shape of encoded categorical edge features: torch.Size([2170, 2])
2025-06-03 11:40:17,460 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:40:17,460 - DEBUG - Shape of scaled numerical edge features: torch.Size([2170, 20])
2025-06-03 11:40:17,461 - DEBUG - Final edge attributes tensor shape: torch.Size([2170, 22])
2025-06-03 11:40:17,461 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:40:17,461 - INFO - Performing online update...
2025-06-03 11:40:17,461 - INFO - Starting online update for 50 steps.
2025-06-03 11:40:17,461 - DEBUG - Updated RunningStats: new_mean=0.546474252712344, new_var=83400000000008.98, new_n=8370
2025-06-03 11:40:17,461 - DEBUG - Updated RunningStats: new_mean=0.5467856024045339, new_var=83700000000007.2, new_n=8400
2025-06-03 11:40:17,462 - DEBUG - Updated RunningStats: new_mean=0.779636444653685, new_var=48920000000036.86, new_n=4914
2025-06-03 11:40:17,462 - DEBUG - Updated RunningStats: new_mean=0.7807498303676429, new_var=49140000000002.89, new_n=4936
2025-06-03 11:40:17,462 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:40:17,462 - DEBUG - Online update step: 1/50
2025-06-03 11:40:17,463 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:17,820 - DEBUG - Node anomaly scores shape: torch.Size([10554, 1])
2025-06-03 11:40:17,855 - DEBUG - Edge anomaly scores shape: torch.Size([22072, 1])
2025-06-03 11:40:17,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:18,550 - DEBUG - Step 1: Loss=0.5600
2025-06-03 11:40:18,550 - DEBUG - Online update step: 2/50
2025-06-03 11:40:18,553 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:18,979 - DEBUG - Node anomaly scores shape: torch.Size([11371, 1])
2025-06-03 11:40:19,014 - DEBUG - Edge anomaly scores shape: torch.Size([23896, 1])
2025-06-03 11:40:19,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:19,746 - DEBUG - Step 2: Loss=0.5721
2025-06-03 11:40:19,747 - DEBUG - Online update step: 3/50
2025-06-03 11:40:19,748 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:20,200 - DEBUG - Node anomaly scores shape: torch.Size([12474, 1])
2025-06-03 11:40:20,240 - DEBUG - Edge anomaly scores shape: torch.Size([26491, 1])
2025-06-03 11:40:20,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:21,056 - DEBUG - Step 3: Loss=0.5732
2025-06-03 11:40:21,057 - DEBUG - Online update step: 4/50
2025-06-03 11:40:21,058 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:21,463 - DEBUG - Node anomaly scores shape: torch.Size([11170, 1])
2025-06-03 11:40:21,497 - DEBUG - Edge anomaly scores shape: torch.Size([23567, 1])
2025-06-03 11:40:21,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:22,198 - DEBUG - Step 4: Loss=0.5649
2025-06-03 11:40:22,198 - DEBUG - Online update step: 5/50
2025-06-03 11:40:22,200 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:22,560 - DEBUG - Node anomaly scores shape: torch.Size([10539, 1])
2025-06-03 11:40:22,589 - DEBUG - Edge anomaly scores shape: torch.Size([21941, 1])
2025-06-03 11:40:22,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:23,325 - DEBUG - Step 5: Loss=0.5637
2025-06-03 11:40:23,326 - DEBUG - Online update step: 6/50
2025-06-03 11:40:23,328 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:23,744 - DEBUG - Node anomaly scores shape: torch.Size([11556, 1])
2025-06-03 11:40:23,779 - DEBUG - Edge anomaly scores shape: torch.Size([24337, 1])
2025-06-03 11:40:23,780 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:24,572 - DEBUG - Step 6: Loss=0.5613
2025-06-03 11:40:24,572 - DEBUG - Online update step: 7/50
2025-06-03 11:40:24,574 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:24,993 - DEBUG - Node anomaly scores shape: torch.Size([11357, 1])
2025-06-03 11:40:25,061 - DEBUG - Edge anomaly scores shape: torch.Size([23745, 1])
2025-06-03 11:40:25,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:25,838 - DEBUG - Step 7: Loss=0.5586
2025-06-03 11:40:25,838 - DEBUG - Online update step: 8/50
2025-06-03 11:40:25,840 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:26,212 - DEBUG - Node anomaly scores shape: torch.Size([10785, 1])
2025-06-03 11:40:26,246 - DEBUG - Edge anomaly scores shape: torch.Size([22444, 1])
2025-06-03 11:40:26,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:26,955 - DEBUG - Step 8: Loss=0.5772
2025-06-03 11:40:26,955 - DEBUG - Online update step: 9/50
2025-06-03 11:40:26,957 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:27,348 - DEBUG - Node anomaly scores shape: torch.Size([10898, 1])
2025-06-03 11:40:27,382 - DEBUG - Edge anomaly scores shape: torch.Size([22840, 1])
2025-06-03 11:40:27,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:28,058 - DEBUG - Step 9: Loss=0.5606
2025-06-03 11:40:28,059 - DEBUG - Online update step: 10/50
2025-06-03 11:40:28,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:28,466 - DEBUG - Node anomaly scores shape: torch.Size([11645, 1])
2025-06-03 11:40:28,502 - DEBUG - Edge anomaly scores shape: torch.Size([24551, 1])
2025-06-03 11:40:28,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:29,217 - DEBUG - Step 10: Loss=0.5678
2025-06-03 11:40:29,217 - DEBUG - Online update step: 11/50
2025-06-03 11:40:29,219 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:29,678 - DEBUG - Node anomaly scores shape: torch.Size([12023, 1])
2025-06-03 11:40:29,717 - DEBUG - Edge anomaly scores shape: torch.Size([25477, 1])
2025-06-03 11:40:29,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:30,519 - DEBUG - Step 11: Loss=0.5586
2025-06-03 11:40:30,519 - DEBUG - Online update step: 12/50
2025-06-03 11:40:30,521 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:30,907 - DEBUG - Node anomaly scores shape: torch.Size([11394, 1])
2025-06-03 11:40:30,942 - DEBUG - Edge anomaly scores shape: torch.Size([24010, 1])
2025-06-03 11:40:30,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:31,729 - DEBUG - Step 12: Loss=0.5684
2025-06-03 11:40:31,730 - DEBUG - Online update step: 13/50
2025-06-03 11:40:31,732 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:32,072 - DEBUG - Node anomaly scores shape: torch.Size([10141, 1])
2025-06-03 11:40:32,103 - DEBUG - Edge anomaly scores shape: torch.Size([21122, 1])
2025-06-03 11:40:32,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:32,751 - DEBUG - Step 13: Loss=0.5705
2025-06-03 11:40:32,751 - DEBUG - Online update step: 14/50
2025-06-03 11:40:32,753 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:33,193 - DEBUG - Node anomaly scores shape: torch.Size([11867, 1])
2025-06-03 11:40:33,231 - DEBUG - Edge anomaly scores shape: torch.Size([25196, 1])
2025-06-03 11:40:33,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:33,947 - DEBUG - Step 14: Loss=0.5728
2025-06-03 11:40:33,947 - DEBUG - Online update step: 15/50
2025-06-03 11:40:33,949 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:34,361 - DEBUG - Node anomaly scores shape: torch.Size([11309, 1])
2025-06-03 11:40:34,401 - DEBUG - Edge anomaly scores shape: torch.Size([23787, 1])
2025-06-03 11:40:34,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:35,232 - DEBUG - Step 15: Loss=0.5572
2025-06-03 11:40:35,233 - DEBUG - Online update step: 16/50
2025-06-03 11:40:35,236 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:35,630 - DEBUG - Node anomaly scores shape: torch.Size([10588, 1])
2025-06-03 11:40:35,664 - DEBUG - Edge anomaly scores shape: torch.Size([22126, 1])
2025-06-03 11:40:35,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:36,280 - DEBUG - Step 16: Loss=0.5807
2025-06-03 11:40:36,280 - DEBUG - Online update step: 17/50
2025-06-03 11:40:36,282 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:36,711 - DEBUG - Node anomaly scores shape: torch.Size([11574, 1])
2025-06-03 11:40:36,746 - DEBUG - Edge anomaly scores shape: torch.Size([24393, 1])
2025-06-03 11:40:36,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:37,462 - DEBUG - Step 17: Loss=0.5623
2025-06-03 11:40:37,462 - DEBUG - Online update step: 18/50
2025-06-03 11:40:37,465 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:37,897 - DEBUG - Node anomaly scores shape: torch.Size([11535, 1])
2025-06-03 11:40:37,932 - DEBUG - Edge anomaly scores shape: torch.Size([24364, 1])
2025-06-03 11:40:37,933 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:38,716 - DEBUG - Step 18: Loss=0.5608
2025-06-03 11:40:38,716 - DEBUG - Online update step: 19/50
2025-06-03 11:40:38,719 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:39,109 - DEBUG - Node anomaly scores shape: torch.Size([11262, 1])
2025-06-03 11:40:39,145 - DEBUG - Edge anomaly scores shape: torch.Size([23633, 1])
2025-06-03 11:40:39,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:39,847 - DEBUG - Step 19: Loss=0.5609
2025-06-03 11:40:39,847 - DEBUG - Online update step: 20/50
2025-06-03 11:40:39,850 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:40,201 - DEBUG - Node anomaly scores shape: torch.Size([10523, 1])
2025-06-03 11:40:40,232 - DEBUG - Edge anomaly scores shape: torch.Size([21859, 1])
2025-06-03 11:40:40,233 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:40,902 - DEBUG - Step 20: Loss=0.5599
2025-06-03 11:40:40,902 - DEBUG - Online update step: 21/50
2025-06-03 11:40:40,904 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:41,219 - DEBUG - Node anomaly scores shape: torch.Size([9583, 1])
2025-06-03 11:40:41,248 - DEBUG - Edge anomaly scores shape: torch.Size([19737, 1])
2025-06-03 11:40:41,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:41,892 - DEBUG - Step 21: Loss=0.5711
2025-06-03 11:40:41,892 - DEBUG - Online update step: 22/50
2025-06-03 11:40:41,894 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:42,283 - DEBUG - Node anomaly scores shape: torch.Size([10728, 1])
2025-06-03 11:40:42,317 - DEBUG - Edge anomaly scores shape: torch.Size([22528, 1])
2025-06-03 11:40:42,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:43,002 - DEBUG - Step 22: Loss=0.5506
2025-06-03 11:40:43,003 - DEBUG - Online update step: 23/50
2025-06-03 11:40:43,004 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:43,368 - DEBUG - Node anomaly scores shape: torch.Size([10626, 1])
2025-06-03 11:40:43,401 - DEBUG - Edge anomaly scores shape: torch.Size([22191, 1])
2025-06-03 11:40:43,401 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:44,090 - DEBUG - Step 23: Loss=0.5577
2025-06-03 11:40:44,090 - DEBUG - Online update step: 24/50
2025-06-03 11:40:44,092 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:44,465 - DEBUG - Node anomaly scores shape: torch.Size([10569, 1])
2025-06-03 11:40:44,499 - DEBUG - Edge anomaly scores shape: torch.Size([22086, 1])
2025-06-03 11:40:44,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:45,193 - DEBUG - Step 24: Loss=0.5562
2025-06-03 11:40:45,193 - DEBUG - Online update step: 25/50
2025-06-03 11:40:45,195 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:45,620 - DEBUG - Node anomaly scores shape: torch.Size([11417, 1])
2025-06-03 11:40:45,655 - DEBUG - Edge anomaly scores shape: torch.Size([24102, 1])
2025-06-03 11:40:45,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:46,437 - DEBUG - Step 25: Loss=0.5558
2025-06-03 11:40:46,438 - DEBUG - Online update step: 26/50
2025-06-03 11:40:46,439 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:46,842 - DEBUG - Node anomaly scores shape: torch.Size([11156, 1])
2025-06-03 11:40:46,878 - DEBUG - Edge anomaly scores shape: torch.Size([23349, 1])
2025-06-03 11:40:46,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:47,557 - DEBUG - Step 26: Loss=0.5588
2025-06-03 11:40:47,558 - DEBUG - Online update step: 27/50
2025-06-03 11:40:47,560 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:47,977 - DEBUG - Node anomaly scores shape: torch.Size([11786, 1])
2025-06-03 11:40:48,014 - DEBUG - Edge anomaly scores shape: torch.Size([24876, 1])
2025-06-03 11:40:48,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:48,739 - DEBUG - Step 27: Loss=0.5496
2025-06-03 11:40:48,739 - DEBUG - Online update step: 28/50
2025-06-03 11:40:48,741 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:49,103 - DEBUG - Node anomaly scores shape: torch.Size([10768, 1])
2025-06-03 11:40:49,136 - DEBUG - Edge anomaly scores shape: torch.Size([22510, 1])
2025-06-03 11:40:49,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:49,788 - DEBUG - Step 28: Loss=0.5566
2025-06-03 11:40:49,788 - DEBUG - Online update step: 29/50
2025-06-03 11:40:49,790 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:50,180 - DEBUG - Node anomaly scores shape: torch.Size([11104, 1])
2025-06-03 11:40:50,214 - DEBUG - Edge anomaly scores shape: torch.Size([23260, 1])
2025-06-03 11:40:50,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:50,877 - DEBUG - Step 29: Loss=0.5573
2025-06-03 11:40:50,878 - DEBUG - Online update step: 30/50
2025-06-03 11:40:50,880 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:51,296 - DEBUG - Node anomaly scores shape: torch.Size([11545, 1])
2025-06-03 11:40:51,335 - DEBUG - Edge anomaly scores shape: torch.Size([24312, 1])
2025-06-03 11:40:51,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:51,991 - DEBUG - Step 30: Loss=0.5485
2025-06-03 11:40:51,991 - DEBUG - Online update step: 31/50
2025-06-03 11:40:51,994 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:52,356 - DEBUG - Node anomaly scores shape: torch.Size([10436, 1])
2025-06-03 11:40:52,388 - DEBUG - Edge anomaly scores shape: torch.Size([21789, 1])
2025-06-03 11:40:52,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:53,059 - DEBUG - Step 31: Loss=0.5473
2025-06-03 11:40:53,059 - DEBUG - Online update step: 32/50
2025-06-03 11:40:53,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:53,468 - DEBUG - Node anomaly scores shape: torch.Size([11807, 1])
2025-06-03 11:40:53,505 - DEBUG - Edge anomaly scores shape: torch.Size([24945, 1])
2025-06-03 11:40:53,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:54,252 - DEBUG - Step 32: Loss=0.5524
2025-06-03 11:40:54,252 - DEBUG - Online update step: 33/50
2025-06-03 11:40:54,254 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:54,681 - DEBUG - Node anomaly scores shape: torch.Size([11990, 1])
2025-06-03 11:40:54,719 - DEBUG - Edge anomaly scores shape: torch.Size([25372, 1])
2025-06-03 11:40:54,720 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:55,522 - DEBUG - Step 33: Loss=0.5501
2025-06-03 11:40:55,522 - DEBUG - Online update step: 34/50
2025-06-03 11:40:55,524 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:56,114 - DEBUG - Node anomaly scores shape: torch.Size([11658, 1])
2025-06-03 11:40:56,205 - DEBUG - Edge anomaly scores shape: torch.Size([24597, 1])
2025-06-03 11:40:56,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:57,157 - DEBUG - Step 34: Loss=0.5459
2025-06-03 11:40:57,158 - DEBUG - Online update step: 35/50
2025-06-03 11:40:57,159 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:57,544 - DEBUG - Node anomaly scores shape: torch.Size([11216, 1])
2025-06-03 11:40:57,581 - DEBUG - Edge anomaly scores shape: torch.Size([23682, 1])
2025-06-03 11:40:57,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:58,252 - DEBUG - Step 35: Loss=0.5523
2025-06-03 11:40:58,252 - DEBUG - Online update step: 36/50
2025-06-03 11:40:58,254 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:58,648 - DEBUG - Node anomaly scores shape: torch.Size([11261, 1])
2025-06-03 11:40:58,683 - DEBUG - Edge anomaly scores shape: torch.Size([23653, 1])
2025-06-03 11:40:58,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:40:59,424 - DEBUG - Step 36: Loss=0.5480
2025-06-03 11:40:59,424 - DEBUG - Online update step: 37/50
2025-06-03 11:40:59,426 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:40:59,855 - DEBUG - Node anomaly scores shape: torch.Size([11961, 1])
2025-06-03 11:40:59,894 - DEBUG - Edge anomaly scores shape: torch.Size([25244, 1])
2025-06-03 11:40:59,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:00,709 - DEBUG - Step 37: Loss=0.5428
2025-06-03 11:41:00,709 - DEBUG - Online update step: 38/50
2025-06-03 11:41:00,711 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:01,092 - DEBUG - Node anomaly scores shape: torch.Size([10653, 1])
2025-06-03 11:41:01,127 - DEBUG - Edge anomaly scores shape: torch.Size([22358, 1])
2025-06-03 11:41:01,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:01,755 - DEBUG - Step 38: Loss=0.5622
2025-06-03 11:41:01,755 - DEBUG - Online update step: 39/50
2025-06-03 11:41:01,757 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:02,126 - DEBUG - Node anomaly scores shape: torch.Size([10647, 1])
2025-06-03 11:41:02,159 - DEBUG - Edge anomaly scores shape: torch.Size([22135, 1])
2025-06-03 11:41:02,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:02,781 - DEBUG - Step 39: Loss=0.5519
2025-06-03 11:41:02,781 - DEBUG - Online update step: 40/50
2025-06-03 11:41:02,783 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:03,134 - DEBUG - Node anomaly scores shape: torch.Size([10496, 1])
2025-06-03 11:41:03,167 - DEBUG - Edge anomaly scores shape: torch.Size([21913, 1])
2025-06-03 11:41:03,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:03,777 - DEBUG - Step 40: Loss=0.5749
2025-06-03 11:41:03,777 - DEBUG - Online update step: 41/50
2025-06-03 11:41:03,780 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:04,214 - DEBUG - Node anomaly scores shape: torch.Size([11169, 1])
2025-06-03 11:41:04,250 - DEBUG - Edge anomaly scores shape: torch.Size([23536, 1])
2025-06-03 11:41:04,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:04,891 - DEBUG - Step 41: Loss=0.5630
2025-06-03 11:41:04,891 - DEBUG - Online update step: 42/50
2025-06-03 11:41:04,892 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:05,249 - DEBUG - Node anomaly scores shape: torch.Size([10518, 1])
2025-06-03 11:41:05,282 - DEBUG - Edge anomaly scores shape: torch.Size([22012, 1])
2025-06-03 11:41:05,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:05,944 - DEBUG - Step 42: Loss=0.5711
2025-06-03 11:41:05,944 - DEBUG - Online update step: 43/50
2025-06-03 11:41:05,946 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:06,376 - DEBUG - Node anomaly scores shape: torch.Size([11478, 1])
2025-06-03 11:41:06,414 - DEBUG - Edge anomaly scores shape: torch.Size([24109, 1])
2025-06-03 11:41:06,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:07,063 - DEBUG - Step 43: Loss=0.5567
2025-06-03 11:41:07,064 - DEBUG - Online update step: 44/50
2025-06-03 11:41:07,065 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:07,497 - DEBUG - Node anomaly scores shape: torch.Size([11575, 1])
2025-06-03 11:41:07,531 - DEBUG - Edge anomaly scores shape: torch.Size([24459, 1])
2025-06-03 11:41:07,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:08,226 - DEBUG - Step 44: Loss=0.5473
2025-06-03 11:41:08,227 - DEBUG - Online update step: 45/50
2025-06-03 11:41:08,228 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:08,621 - DEBUG - Node anomaly scores shape: torch.Size([11546, 1])
2025-06-03 11:41:08,657 - DEBUG - Edge anomaly scores shape: torch.Size([24385, 1])
2025-06-03 11:41:08,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:09,359 - DEBUG - Step 45: Loss=0.5645
2025-06-03 11:41:09,359 - DEBUG - Online update step: 46/50
2025-06-03 11:41:09,361 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:09,709 - DEBUG - Node anomaly scores shape: torch.Size([10270, 1])
2025-06-03 11:41:09,741 - DEBUG - Edge anomaly scores shape: torch.Size([21381, 1])
2025-06-03 11:41:09,741 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:10,347 - DEBUG - Step 46: Loss=0.5572
2025-06-03 11:41:10,347 - DEBUG - Online update step: 47/50
2025-06-03 11:41:10,349 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:10,745 - DEBUG - Node anomaly scores shape: torch.Size([10898, 1])
2025-06-03 11:41:10,781 - DEBUG - Edge anomaly scores shape: torch.Size([22922, 1])
2025-06-03 11:41:10,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:11,484 - DEBUG - Step 47: Loss=0.5640
2025-06-03 11:41:11,484 - DEBUG - Online update step: 48/50
2025-06-03 11:41:11,485 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:11,876 - DEBUG - Node anomaly scores shape: torch.Size([11297, 1])
2025-06-03 11:41:11,912 - DEBUG - Edge anomaly scores shape: torch.Size([23796, 1])
2025-06-03 11:41:11,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:12,605 - DEBUG - Step 48: Loss=0.5592
2025-06-03 11:41:12,606 - DEBUG - Online update step: 49/50
2025-06-03 11:41:12,608 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:12,970 - DEBUG - Node anomaly scores shape: torch.Size([10630, 1])
2025-06-03 11:41:13,004 - DEBUG - Edge anomaly scores shape: torch.Size([22237, 1])
2025-06-03 11:41:13,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:13,712 - DEBUG - Step 49: Loss=0.5611
2025-06-03 11:41:13,713 - DEBUG - Online update step: 50/50
2025-06-03 11:41:13,715 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:14,066 - DEBUG - Node anomaly scores shape: torch.Size([10375, 1])
2025-06-03 11:41:14,098 - DEBUG - Edge anomaly scores shape: torch.Size([21630, 1])
2025-06-03 11:41:14,099 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:14,680 - DEBUG - Step 50: Loss=0.5546
2025-06-03 11:41:14,681 - INFO - Online update finished. Average loss: 0.5600, Learning rate: 0.000820
2025-06-03 11:41:14,681 - DEBUG - Current node mean: [-1.1513171e-08  1.1513171e-08  2.4945203e-08  1.6310326e-08
  5.0849838e-08 -1.1513171e-08 -2.5904635e-08 -7.6754469e-09
  1.5350894e-08  1.0553740e-08  4.2214960e-08 -9.5943087e-10
 -8.3950207e-09 -1.5350894e-08  1.7269755e-08 -1.5350894e-08
  2.3026342e-08  0.0000000e+00  0.0000000e+00 -1.1513171e-08
  0.0000000e+00  0.0000000e+00 -2.5904635e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4179723e+00  5.7064514e+00 -2.6368876e-09  8.7896251e-10
  8.7896251e-10 -1.7579250e-09  1.7579250e-09  3.5158501e-09
  2.6368876e-09  1.7579250e-09 -2.2633284e-08 -7.0317001e-09
  3.5158501e-09  1.7579250e-09 -4.8342939e-09 -1.7579250e-09
 -1.7579250e-09 -1.7579250e-09 -1.7579250e-09 -1.7579250e-09
 -1.7579250e-09 -1.7579250e-09]
2025-06-03 11:41:14,682 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0015
2025-06-03 11:41:14,686 - INFO - Online update complete. Loss: 0.5600
2025-06-03 11:41:14,686 - INFO - Running anomaly detection...
2025-06-03 11:41:14,686 - INFO - Starting anomaly detection.
2025-06-03 11:41:14,700 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114114_update_39.json
2025-06-03 11:41:14,701 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:41:14,718 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114114_update_39.pth and as latest_checkpoint.pth
2025-06-03 11:41:14,718 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.0000
2025-06-03 11:41:14,718 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:41:14,718 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.4004, MLP Score: 1.0000
2025-06-03 11:41:14,718 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.3147, MLP Score: 1.0000
2025-06-03 11:41:14,718 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.3516, MLP Score: 1.0000
2025-06-03 11:41:14,718 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.6770, MLP Score: 1.0000
2025-06-03 11:41:14,719 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.2638, MLP Score: 1.0000
2025-06-03 11:41:14,719 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:41:14,719 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.1856, MLP Score: 0.9992
2025-06-03 11:41:14,719 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.9892, MLP Score: 0.9998
2025-06-03 11:41:14,719 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.3620, MLP Score: 0.9947
2025-06-03 11:41:14,719 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4529, MLP Score: 0.9972
2025-06-03 11:41:14,719 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3504, MLP Score: 0.9973
2025-06-03 11:41:14,719 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-03 11:41:14,719 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-03 11:41:14,719 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot file.
2025-06-03 11:41:14,738 - INFO - Parsed 996 nodes.
2025-06-03 11:41:14,758 - INFO - Parsed 2181 edges.
2025-06-03 11:41:15,430 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:41:15,430 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:41:15,447 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-03 11:41:15,449 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:41:15,449 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-03 11:41:15,451 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-03 11:41:15,451 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:41:15,466 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:41:15,467 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:41:15,468 - DEBUG - Shape of encoded categorical edge features: torch.Size([2181, 2])
2025-06-03 11:41:15,470 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:41:15,470 - DEBUG - Shape of scaled numerical edge features: torch.Size([2181, 20])
2025-06-03 11:41:15,470 - DEBUG - Final edge attributes tensor shape: torch.Size([2181, 22])
2025-06-03 11:41:15,470 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:41:15,470 - INFO - Performing online update...
2025-06-03 11:41:15,471 - INFO - Starting online update for 50 steps.
2025-06-03 11:41:15,471 - DEBUG - Updated RunningStats: new_mean=0.5448397461483205, new_var=84000000000008.94, new_n=8430
2025-06-03 11:41:15,471 - DEBUG - Updated RunningStats: new_mean=0.545154681427865, new_var=84300000000007.2, new_n=8460
2025-06-03 11:41:15,471 - DEBUG - Updated RunningStats: new_mean=0.7787221663181233, new_var=49360000000036.805, new_n=4958
2025-06-03 11:41:15,471 - DEBUG - Updated RunningStats: new_mean=0.7798299285305851, new_var=49580000000002.9, new_n=4980
2025-06-03 11:41:15,471 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:41:15,471 - DEBUG - Online update step: 1/50
2025-06-03 11:41:15,473 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:15,935 - DEBUG - Node anomaly scores shape: torch.Size([12159, 1])
2025-06-03 11:41:15,977 - DEBUG - Edge anomaly scores shape: torch.Size([25770, 1])
2025-06-03 11:41:15,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:16,700 - DEBUG - Step 1: Loss=0.5534
2025-06-03 11:41:16,700 - DEBUG - Online update step: 2/50
2025-06-03 11:41:16,702 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:17,741 - DEBUG - Node anomaly scores shape: torch.Size([12445, 1])
2025-06-03 11:41:17,780 - DEBUG - Edge anomaly scores shape: torch.Size([26429, 1])
2025-06-03 11:41:17,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:18,568 - DEBUG - Step 2: Loss=0.5754
2025-06-03 11:41:18,569 - DEBUG - Online update step: 3/50
2025-06-03 11:41:18,571 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:18,977 - DEBUG - Node anomaly scores shape: torch.Size([11090, 1])
2025-06-03 11:41:19,013 - DEBUG - Edge anomaly scores shape: torch.Size([23216, 1])
2025-06-03 11:41:19,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:19,696 - DEBUG - Step 3: Loss=0.5675
2025-06-03 11:41:19,696 - DEBUG - Online update step: 4/50
2025-06-03 11:41:19,698 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:20,067 - DEBUG - Node anomaly scores shape: torch.Size([11200, 1])
2025-06-03 11:41:20,105 - DEBUG - Edge anomaly scores shape: torch.Size([23526, 1])
2025-06-03 11:41:20,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:20,829 - DEBUG - Step 4: Loss=0.5509
2025-06-03 11:41:20,829 - DEBUG - Online update step: 5/50
2025-06-03 11:41:20,830 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:21,239 - DEBUG - Node anomaly scores shape: torch.Size([11326, 1])
2025-06-03 11:41:21,277 - DEBUG - Edge anomaly scores shape: torch.Size([23837, 1])
2025-06-03 11:41:21,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:21,915 - DEBUG - Step 5: Loss=0.5626
2025-06-03 11:41:21,915 - DEBUG - Online update step: 6/50
2025-06-03 11:41:21,917 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:22,290 - DEBUG - Node anomaly scores shape: torch.Size([11121, 1])
2025-06-03 11:41:22,321 - DEBUG - Edge anomaly scores shape: torch.Size([23273, 1])
2025-06-03 11:41:22,322 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:22,999 - DEBUG - Step 6: Loss=0.5590
2025-06-03 11:41:22,999 - DEBUG - Online update step: 7/50
2025-06-03 11:41:23,001 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:23,469 - DEBUG - Node anomaly scores shape: torch.Size([12249, 1])
2025-06-03 11:41:23,510 - DEBUG - Edge anomaly scores shape: torch.Size([26005, 1])
2025-06-03 11:41:23,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:24,257 - DEBUG - Step 7: Loss=0.5553
2025-06-03 11:41:24,257 - DEBUG - Online update step: 8/50
2025-06-03 11:41:24,260 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:24,670 - DEBUG - Node anomaly scores shape: torch.Size([11070, 1])
2025-06-03 11:41:24,706 - DEBUG - Edge anomaly scores shape: torch.Size([23129, 1])
2025-06-03 11:41:24,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:25,335 - DEBUG - Step 8: Loss=0.5549
2025-06-03 11:41:25,335 - DEBUG - Online update step: 9/50
2025-06-03 11:41:25,336 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:25,770 - DEBUG - Node anomaly scores shape: torch.Size([11873, 1])
2025-06-03 11:41:25,808 - DEBUG - Edge anomaly scores shape: torch.Size([25098, 1])
2025-06-03 11:41:25,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:26,525 - DEBUG - Step 9: Loss=0.5540
2025-06-03 11:41:26,525 - DEBUG - Online update step: 10/50
2025-06-03 11:41:26,527 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:26,895 - DEBUG - Node anomaly scores shape: torch.Size([10550, 1])
2025-06-03 11:41:26,928 - DEBUG - Edge anomaly scores shape: torch.Size([22213, 1])
2025-06-03 11:41:26,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:27,526 - DEBUG - Step 10: Loss=0.5567
2025-06-03 11:41:27,526 - DEBUG - Online update step: 11/50
2025-06-03 11:41:27,528 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:27,929 - DEBUG - Node anomaly scores shape: torch.Size([11027, 1])
2025-06-03 11:41:27,964 - DEBUG - Edge anomaly scores shape: torch.Size([23188, 1])
2025-06-03 11:41:27,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:28,643 - DEBUG - Step 11: Loss=0.5519
2025-06-03 11:41:28,643 - DEBUG - Online update step: 12/50
2025-06-03 11:41:28,645 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:29,106 - DEBUG - Node anomaly scores shape: torch.Size([12556, 1])
2025-06-03 11:41:29,148 - DEBUG - Edge anomaly scores shape: torch.Size([26715, 1])
2025-06-03 11:41:29,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:29,929 - DEBUG - Step 12: Loss=0.5564
2025-06-03 11:41:29,929 - DEBUG - Online update step: 13/50
2025-06-03 11:41:29,932 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:30,358 - DEBUG - Node anomaly scores shape: torch.Size([11735, 1])
2025-06-03 11:41:30,397 - DEBUG - Edge anomaly scores shape: torch.Size([24891, 1])
2025-06-03 11:41:30,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:31,171 - DEBUG - Step 13: Loss=0.5672
2025-06-03 11:41:31,172 - DEBUG - Online update step: 14/50
2025-06-03 11:41:31,174 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:31,568 - DEBUG - Node anomaly scores shape: torch.Size([11428, 1])
2025-06-03 11:41:31,606 - DEBUG - Edge anomaly scores shape: torch.Size([24092, 1])
2025-06-03 11:41:31,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:32,352 - DEBUG - Step 14: Loss=0.5421
2025-06-03 11:41:32,352 - DEBUG - Online update step: 15/50
2025-06-03 11:41:32,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:32,723 - DEBUG - Node anomaly scores shape: torch.Size([10724, 1])
2025-06-03 11:41:32,760 - DEBUG - Edge anomaly scores shape: torch.Size([22578, 1])
2025-06-03 11:41:32,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:33,431 - DEBUG - Step 15: Loss=0.5611
2025-06-03 11:41:33,431 - DEBUG - Online update step: 16/50
2025-06-03 11:41:33,433 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:33,857 - DEBUG - Node anomaly scores shape: torch.Size([11443, 1])
2025-06-03 11:41:33,894 - DEBUG - Edge anomaly scores shape: torch.Size([24116, 1])
2025-06-03 11:41:33,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:34,616 - DEBUG - Step 16: Loss=0.5601
2025-06-03 11:41:34,616 - DEBUG - Online update step: 17/50
2025-06-03 11:41:34,619 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:35,036 - DEBUG - Node anomaly scores shape: torch.Size([11012, 1])
2025-06-03 11:41:35,079 - DEBUG - Edge anomaly scores shape: torch.Size([23024, 1])
2025-06-03 11:41:35,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:35,859 - DEBUG - Step 17: Loss=0.5621
2025-06-03 11:41:35,859 - DEBUG - Online update step: 18/50
2025-06-03 11:41:35,861 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:36,301 - DEBUG - Node anomaly scores shape: torch.Size([12212, 1])
2025-06-03 11:41:36,341 - DEBUG - Edge anomaly scores shape: torch.Size([25808, 1])
2025-06-03 11:41:36,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:37,158 - DEBUG - Step 18: Loss=0.5709
2025-06-03 11:41:37,158 - DEBUG - Online update step: 19/50
2025-06-03 11:41:37,160 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:37,576 - DEBUG - Node anomaly scores shape: torch.Size([11218, 1])
2025-06-03 11:41:37,613 - DEBUG - Edge anomaly scores shape: torch.Size([23654, 1])
2025-06-03 11:41:37,614 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:38,361 - DEBUG - Step 19: Loss=0.5577
2025-06-03 11:41:38,361 - DEBUG - Online update step: 20/50
2025-06-03 11:41:38,364 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:38,747 - DEBUG - Node anomaly scores shape: torch.Size([11497, 1])
2025-06-03 11:41:38,783 - DEBUG - Edge anomaly scores shape: torch.Size([24262, 1])
2025-06-03 11:41:38,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:39,484 - DEBUG - Step 20: Loss=0.5600
2025-06-03 11:41:39,484 - DEBUG - Online update step: 21/50
2025-06-03 11:41:39,486 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:39,915 - DEBUG - Node anomaly scores shape: torch.Size([11667, 1])
2025-06-03 11:41:39,952 - DEBUG - Edge anomaly scores shape: torch.Size([24677, 1])
2025-06-03 11:41:39,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:40,710 - DEBUG - Step 21: Loss=0.5560
2025-06-03 11:41:40,710 - DEBUG - Online update step: 22/50
2025-06-03 11:41:40,711 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:41,059 - DEBUG - Node anomaly scores shape: torch.Size([10275, 1])
2025-06-03 11:41:41,091 - DEBUG - Edge anomaly scores shape: torch.Size([21484, 1])
2025-06-03 11:41:41,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:41,688 - DEBUG - Step 22: Loss=0.5534
2025-06-03 11:41:41,688 - DEBUG - Online update step: 23/50
2025-06-03 11:41:41,690 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:42,095 - DEBUG - Node anomaly scores shape: torch.Size([11424, 1])
2025-06-03 11:41:42,132 - DEBUG - Edge anomaly scores shape: torch.Size([24042, 1])
2025-06-03 11:41:42,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:42,789 - DEBUG - Step 23: Loss=0.5687
2025-06-03 11:41:42,789 - DEBUG - Online update step: 24/50
2025-06-03 11:41:42,791 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:43,153 - DEBUG - Node anomaly scores shape: torch.Size([10724, 1])
2025-06-03 11:41:43,187 - DEBUG - Edge anomaly scores shape: torch.Size([22519, 1])
2025-06-03 11:41:43,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:43,862 - DEBUG - Step 24: Loss=0.5661
2025-06-03 11:41:43,862 - DEBUG - Online update step: 25/50
2025-06-03 11:41:43,864 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:44,267 - DEBUG - Node anomaly scores shape: torch.Size([11722, 1])
2025-06-03 11:41:44,300 - DEBUG - Edge anomaly scores shape: torch.Size([24872, 1])
2025-06-03 11:41:44,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:44,987 - DEBUG - Step 25: Loss=0.5651
2025-06-03 11:41:44,987 - DEBUG - Online update step: 26/50
2025-06-03 11:41:44,990 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:45,460 - DEBUG - Node anomaly scores shape: torch.Size([12623, 1])
2025-06-03 11:41:45,504 - DEBUG - Edge anomaly scores shape: torch.Size([26779, 1])
2025-06-03 11:41:45,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:46,228 - DEBUG - Step 26: Loss=0.5546
2025-06-03 11:41:46,228 - DEBUG - Online update step: 27/50
2025-06-03 11:41:46,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:46,618 - DEBUG - Node anomaly scores shape: torch.Size([10578, 1])
2025-06-03 11:41:46,648 - DEBUG - Edge anomaly scores shape: torch.Size([22104, 1])
2025-06-03 11:41:46,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:47,297 - DEBUG - Step 27: Loss=0.5488
2025-06-03 11:41:47,297 - DEBUG - Online update step: 28/50
2025-06-03 11:41:47,299 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:47,667 - DEBUG - Node anomaly scores shape: torch.Size([10930, 1])
2025-06-03 11:41:47,701 - DEBUG - Edge anomaly scores shape: torch.Size([23009, 1])
2025-06-03 11:41:47,702 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:48,363 - DEBUG - Step 28: Loss=0.5758
2025-06-03 11:41:48,364 - DEBUG - Online update step: 29/50
2025-06-03 11:41:48,366 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:48,853 - DEBUG - Node anomaly scores shape: torch.Size([13027, 1])
2025-06-03 11:41:48,896 - DEBUG - Edge anomaly scores shape: torch.Size([27757, 1])
2025-06-03 11:41:48,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:49,704 - DEBUG - Step 29: Loss=0.5434
2025-06-03 11:41:49,704 - DEBUG - Online update step: 30/50
2025-06-03 11:41:49,705 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:50,084 - DEBUG - Node anomaly scores shape: torch.Size([10760, 1])
2025-06-03 11:41:50,118 - DEBUG - Edge anomaly scores shape: torch.Size([22602, 1])
2025-06-03 11:41:50,119 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:50,786 - DEBUG - Step 30: Loss=0.5495
2025-06-03 11:41:50,786 - DEBUG - Online update step: 31/50
2025-06-03 11:41:50,787 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:51,274 - DEBUG - Node anomaly scores shape: torch.Size([13131, 1])
2025-06-03 11:41:51,317 - DEBUG - Edge anomaly scores shape: torch.Size([28113, 1])
2025-06-03 11:41:51,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:52,139 - DEBUG - Step 31: Loss=0.5420
2025-06-03 11:41:52,139 - DEBUG - Online update step: 32/50
2025-06-03 11:41:52,142 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:52,546 - DEBUG - Node anomaly scores shape: torch.Size([11545, 1])
2025-06-03 11:41:52,581 - DEBUG - Edge anomaly scores shape: torch.Size([24292, 1])
2025-06-03 11:41:52,582 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:53,279 - DEBUG - Step 32: Loss=0.5562
2025-06-03 11:41:53,280 - DEBUG - Online update step: 33/50
2025-06-03 11:41:53,282 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:53,691 - DEBUG - Node anomaly scores shape: torch.Size([11102, 1])
2025-06-03 11:41:53,728 - DEBUG - Edge anomaly scores shape: torch.Size([23318, 1])
2025-06-03 11:41:53,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:54,372 - DEBUG - Step 33: Loss=0.5530
2025-06-03 11:41:54,372 - DEBUG - Online update step: 34/50
2025-06-03 11:41:54,374 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:54,834 - DEBUG - Node anomaly scores shape: torch.Size([12565, 1])
2025-06-03 11:41:54,874 - DEBUG - Edge anomaly scores shape: torch.Size([26645, 1])
2025-06-03 11:41:54,875 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:55,543 - DEBUG - Step 34: Loss=0.5489
2025-06-03 11:41:55,544 - DEBUG - Online update step: 35/50
2025-06-03 11:41:55,545 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:55,967 - DEBUG - Node anomaly scores shape: torch.Size([11627, 1])
2025-06-03 11:41:56,006 - DEBUG - Edge anomaly scores shape: torch.Size([24708, 1])
2025-06-03 11:41:56,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:56,715 - DEBUG - Step 35: Loss=0.5640
2025-06-03 11:41:56,716 - DEBUG - Online update step: 36/50
2025-06-03 11:41:56,718 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:57,095 - DEBUG - Node anomaly scores shape: torch.Size([10898, 1])
2025-06-03 11:41:57,130 - DEBUG - Edge anomaly scores shape: torch.Size([22829, 1])
2025-06-03 11:41:57,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:57,776 - DEBUG - Step 36: Loss=0.5616
2025-06-03 11:41:57,776 - DEBUG - Online update step: 37/50
2025-06-03 11:41:57,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:58,236 - DEBUG - Node anomaly scores shape: torch.Size([12640, 1])
2025-06-03 11:41:58,277 - DEBUG - Edge anomaly scores shape: torch.Size([26968, 1])
2025-06-03 11:41:58,278 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:41:59,057 - DEBUG - Step 37: Loss=0.5356
2025-06-03 11:41:59,057 - DEBUG - Online update step: 38/50
2025-06-03 11:41:59,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:41:59,486 - DEBUG - Node anomaly scores shape: torch.Size([11882, 1])
2025-06-03 11:41:59,525 - DEBUG - Edge anomaly scores shape: torch.Size([25209, 1])
2025-06-03 11:41:59,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:00,187 - DEBUG - Step 38: Loss=0.5411
2025-06-03 11:42:00,187 - DEBUG - Online update step: 39/50
2025-06-03 11:42:00,188 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:00,569 - DEBUG - Node anomaly scores shape: torch.Size([10870, 1])
2025-06-03 11:42:00,605 - DEBUG - Edge anomaly scores shape: torch.Size([22858, 1])
2025-06-03 11:42:00,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:01,340 - DEBUG - Step 39: Loss=0.5332
2025-06-03 11:42:01,341 - DEBUG - Online update step: 40/50
2025-06-03 11:42:01,343 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:01,803 - DEBUG - Node anomaly scores shape: torch.Size([11978, 1])
2025-06-03 11:42:01,841 - DEBUG - Edge anomaly scores shape: torch.Size([25364, 1])
2025-06-03 11:42:01,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:02,623 - DEBUG - Step 40: Loss=0.5431
2025-06-03 11:42:02,623 - DEBUG - Online update step: 41/50
2025-06-03 11:42:02,626 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:03,043 - DEBUG - Node anomaly scores shape: torch.Size([11648, 1])
2025-06-03 11:42:03,079 - DEBUG - Edge anomaly scores shape: torch.Size([24546, 1])
2025-06-03 11:42:03,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:03,838 - DEBUG - Step 41: Loss=0.5437
2025-06-03 11:42:03,838 - DEBUG - Online update step: 42/50
2025-06-03 11:42:03,840 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:04,258 - DEBUG - Node anomaly scores shape: torch.Size([11134, 1])
2025-06-03 11:42:04,294 - DEBUG - Edge anomaly scores shape: torch.Size([23493, 1])
2025-06-03 11:42:04,295 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:04,964 - DEBUG - Step 42: Loss=0.5453
2025-06-03 11:42:04,964 - DEBUG - Online update step: 43/50
2025-06-03 11:42:04,966 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:05,461 - DEBUG - Node anomaly scores shape: torch.Size([12483, 1])
2025-06-03 11:42:05,502 - DEBUG - Edge anomaly scores shape: torch.Size([26567, 1])
2025-06-03 11:42:05,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:06,273 - DEBUG - Step 43: Loss=0.5508
2025-06-03 11:42:06,273 - DEBUG - Online update step: 44/50
2025-06-03 11:42:06,275 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:06,631 - DEBUG - Node anomaly scores shape: torch.Size([10080, 1])
2025-06-03 11:42:06,667 - DEBUG - Edge anomaly scores shape: torch.Size([20928, 1])
2025-06-03 11:42:06,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:07,346 - DEBUG - Step 44: Loss=0.5589
2025-06-03 11:42:07,346 - DEBUG - Online update step: 45/50
2025-06-03 11:42:07,349 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:07,734 - DEBUG - Node anomaly scores shape: torch.Size([10278, 1])
2025-06-03 11:42:07,768 - DEBUG - Edge anomaly scores shape: torch.Size([21457, 1])
2025-06-03 11:42:07,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:08,342 - DEBUG - Step 45: Loss=0.5518
2025-06-03 11:42:08,342 - DEBUG - Online update step: 46/50
2025-06-03 11:42:08,344 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:08,738 - DEBUG - Node anomaly scores shape: torch.Size([10657, 1])
2025-06-03 11:42:08,773 - DEBUG - Edge anomaly scores shape: torch.Size([22323, 1])
2025-06-03 11:42:08,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:09,399 - DEBUG - Step 46: Loss=0.5428
2025-06-03 11:42:09,399 - DEBUG - Online update step: 47/50
2025-06-03 11:42:09,402 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:09,801 - DEBUG - Node anomaly scores shape: torch.Size([10803, 1])
2025-06-03 11:42:09,836 - DEBUG - Edge anomaly scores shape: torch.Size([22655, 1])
2025-06-03 11:42:09,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:10,487 - DEBUG - Step 47: Loss=0.5590
2025-06-03 11:42:10,487 - DEBUG - Online update step: 48/50
2025-06-03 11:42:10,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:10,923 - DEBUG - Node anomaly scores shape: torch.Size([11582, 1])
2025-06-03 11:42:10,961 - DEBUG - Edge anomaly scores shape: torch.Size([24548, 1])
2025-06-03 11:42:10,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:11,675 - DEBUG - Step 48: Loss=0.5584
2025-06-03 11:42:11,676 - DEBUG - Online update step: 49/50
2025-06-03 11:42:11,678 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:12,096 - DEBUG - Node anomaly scores shape: torch.Size([11329, 1])
2025-06-03 11:42:12,132 - DEBUG - Edge anomaly scores shape: torch.Size([23967, 1])
2025-06-03 11:42:12,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:12,795 - DEBUG - Step 49: Loss=0.5606
2025-06-03 11:42:12,795 - DEBUG - Online update step: 50/50
2025-06-03 11:42:12,797 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:13,163 - DEBUG - Node anomaly scores shape: torch.Size([11145, 1])
2025-06-03 11:42:13,199 - DEBUG - Edge anomaly scores shape: torch.Size([23435, 1])
2025-06-03 11:42:13,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:13,860 - DEBUG - Step 50: Loss=0.5593
2025-06-03 11:42:13,860 - INFO - Online update finished. Average loss: 0.5554, Learning rate: 0.000619
2025-06-03 11:42:13,861 - DEBUG - Current node mean: [-2.8725129e-09  2.8725129e-09 -1.5320069e-08  5.7450258e-09
  3.8300172e-09 -1.5320069e-08 -1.9150086e-08 -1.1430208e-08
 -1.7235077e-08 -1.1490052e-08 -2.2980103e-08 -4.4045198e-08
  1.5080694e-08 -1.7235077e-08  7.6600344e-09  5.7450258e-09
  9.5750430e-09  0.0000000e+00  0.0000000e+00 -2.6091993e-08
  0.0000000e+00  0.0000000e+00 -1.5080694e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4204494e+00  5.7028885e+00  0.0000000e+00  5.2471765e-09
 -2.6235882e-09  8.7452939e-10  8.7452939e-10  0.0000000e+00
  1.7490588e-09  3.4981176e-09  7.6521323e-09  0.0000000e+00
  1.7490588e-09  2.5798617e-08  8.7452939e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-03 11:42:13,861 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0049
2025-06-03 11:42:13,862 - INFO - Online update complete. Loss: 0.5554
2025-06-03 11:42:13,862 - INFO - Running anomaly detection...
2025-06-03 11:42:13,862 - INFO - Starting anomaly detection.
2025-06-03 11:42:13,888 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114213_update_40.json
2025-06-03 11:42:13,888 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:42:13,912 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114213_update_40.pth and as latest_checkpoint.pth
2025-06-03 11:42:13,912 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.0000
2025-06-03 11:42:13,912 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:42:13,912 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.9996, MLP Score: 1.0000
2025-06-03 11:42:13,912 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9155, MLP Score: 1.0000
2025-06-03 11:42:13,913 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.0752, MLP Score: 1.0000
2025-06-03 11:42:13,913 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0456, MLP Score: 1.0000
2025-06-03 11:42:13,913 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.0340, MLP Score: 1.0000
2025-06-03 11:42:13,913 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:42:13,913 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2040, MLP Score: 0.9995
2025-06-03 11:42:13,913 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.9922, MLP Score: 0.9999
2025-06-03 11:42:13,913 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4284, MLP Score: 0.9969
2025-06-03 11:42:13,913 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4746, MLP Score: 0.9976
2025-06-03 11:42:13,913 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3862, MLP Score: 0.9972
2025-06-03 11:42:13,913 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-03 11:42:13,913 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-03 11:42:13,913 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot file.
2025-06-03 11:42:13,940 - INFO - Parsed 1002 nodes.
2025-06-03 11:42:13,965 - INFO - Parsed 2201 edges.
2025-06-03 11:42:14,647 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:42:14,647 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:42:14,664 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-03 11:42:14,665 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:42:14,665 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-03 11:42:14,667 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-03 11:42:14,667 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:42:14,684 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:42:14,684 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:42:14,686 - DEBUG - Shape of encoded categorical edge features: torch.Size([2201, 2])
2025-06-03 11:42:14,687 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:42:14,687 - DEBUG - Shape of scaled numerical edge features: torch.Size([2201, 20])
2025-06-03 11:42:14,688 - DEBUG - Final edge attributes tensor shape: torch.Size([2201, 22])
2025-06-03 11:42:14,688 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:42:14,688 - INFO - Performing online update...
2025-06-03 11:42:14,688 - INFO - Starting online update for 50 steps.
2025-06-03 11:42:14,688 - DEBUG - Updated RunningStats: new_mean=0.5432283398046788, new_var=84600000000008.89, new_n=8490
2025-06-03 11:42:14,688 - DEBUG - Updated RunningStats: new_mean=0.5435467245220995, new_var=84900000000007.22, new_n=8520
2025-06-03 11:42:14,689 - DEBUG - Updated RunningStats: new_mean=0.7778248310022082, new_var=49800000000036.78, new_n=5002
2025-06-03 11:42:14,689 - DEBUG - Updated RunningStats: new_mean=0.7789259838146472, new_var=50020000000002.89, new_n=5024
2025-06-03 11:42:14,689 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:42:14,689 - DEBUG - Online update step: 1/50
2025-06-03 11:42:14,690 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:15,076 - DEBUG - Node anomaly scores shape: torch.Size([11147, 1])
2025-06-03 11:42:15,117 - DEBUG - Edge anomaly scores shape: torch.Size([23416, 1])
2025-06-03 11:42:15,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:15,828 - DEBUG - Step 1: Loss=0.5652
2025-06-03 11:42:15,828 - DEBUG - Online update step: 2/50
2025-06-03 11:42:15,831 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:16,244 - DEBUG - Node anomaly scores shape: torch.Size([11520, 1])
2025-06-03 11:42:16,281 - DEBUG - Edge anomaly scores shape: torch.Size([24330, 1])
2025-06-03 11:42:16,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:17,033 - DEBUG - Step 2: Loss=0.5495
2025-06-03 11:42:17,033 - DEBUG - Online update step: 3/50
2025-06-03 11:42:17,035 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:17,463 - DEBUG - Node anomaly scores shape: torch.Size([11875, 1])
2025-06-03 11:42:17,500 - DEBUG - Edge anomaly scores shape: torch.Size([25059, 1])
2025-06-03 11:42:17,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:18,175 - DEBUG - Step 3: Loss=0.5523
2025-06-03 11:42:18,175 - DEBUG - Online update step: 4/50
2025-06-03 11:42:18,176 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:18,504 - DEBUG - Node anomaly scores shape: torch.Size([9259, 1])
2025-06-03 11:42:18,533 - DEBUG - Edge anomaly scores shape: torch.Size([19123, 1])
2025-06-03 11:42:18,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:19,165 - DEBUG - Step 4: Loss=0.5484
2025-06-03 11:42:19,165 - DEBUG - Online update step: 5/50
2025-06-03 11:42:19,168 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:19,575 - DEBUG - Node anomaly scores shape: torch.Size([11066, 1])
2025-06-03 11:42:19,611 - DEBUG - Edge anomaly scores shape: torch.Size([23240, 1])
2025-06-03 11:42:19,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:20,227 - DEBUG - Step 5: Loss=0.5444
2025-06-03 11:42:20,227 - DEBUG - Online update step: 6/50
2025-06-03 11:42:20,229 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:20,590 - DEBUG - Node anomaly scores shape: torch.Size([10579, 1])
2025-06-03 11:42:20,624 - DEBUG - Edge anomaly scores shape: torch.Size([22179, 1])
2025-06-03 11:42:20,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:21,301 - DEBUG - Step 6: Loss=0.5659
2025-06-03 11:42:21,302 - DEBUG - Online update step: 7/50
2025-06-03 11:42:21,303 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:21,710 - DEBUG - Node anomaly scores shape: torch.Size([11206, 1])
2025-06-03 11:42:21,746 - DEBUG - Edge anomaly scores shape: torch.Size([23678, 1])
2025-06-03 11:42:21,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:22,479 - DEBUG - Step 7: Loss=0.5541
2025-06-03 11:42:22,479 - DEBUG - Online update step: 8/50
2025-06-03 11:42:22,480 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:22,854 - DEBUG - Node anomaly scores shape: torch.Size([11069, 1])
2025-06-03 11:42:22,890 - DEBUG - Edge anomaly scores shape: torch.Size([23302, 1])
2025-06-03 11:42:22,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:23,556 - DEBUG - Step 8: Loss=0.5413
2025-06-03 11:42:23,556 - DEBUG - Online update step: 9/50
2025-06-03 11:42:23,558 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:23,957 - DEBUG - Node anomaly scores shape: torch.Size([11165, 1])
2025-06-03 11:42:23,992 - DEBUG - Edge anomaly scores shape: torch.Size([23473, 1])
2025-06-03 11:42:23,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:24,649 - DEBUG - Step 9: Loss=0.5542
2025-06-03 11:42:24,649 - DEBUG - Online update step: 10/50
2025-06-03 11:42:24,651 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:25,003 - DEBUG - Node anomaly scores shape: torch.Size([10283, 1])
2025-06-03 11:42:25,035 - DEBUG - Edge anomaly scores shape: torch.Size([21532, 1])
2025-06-03 11:42:25,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:25,686 - DEBUG - Step 10: Loss=0.5459
2025-06-03 11:42:25,686 - DEBUG - Online update step: 11/50
2025-06-03 11:42:25,688 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:26,146 - DEBUG - Node anomaly scores shape: torch.Size([12215, 1])
2025-06-03 11:42:26,181 - DEBUG - Edge anomaly scores shape: torch.Size([25847, 1])
2025-06-03 11:42:26,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:26,865 - DEBUG - Step 11: Loss=0.5406
2025-06-03 11:42:26,865 - DEBUG - Online update step: 12/50
2025-06-03 11:42:26,867 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:27,292 - DEBUG - Node anomaly scores shape: torch.Size([11924, 1])
2025-06-03 11:42:27,330 - DEBUG - Edge anomaly scores shape: torch.Size([25246, 1])
2025-06-03 11:42:27,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:28,027 - DEBUG - Step 12: Loss=0.5341
2025-06-03 11:42:28,027 - DEBUG - Online update step: 13/50
2025-06-03 11:42:28,029 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:28,398 - DEBUG - Node anomaly scores shape: torch.Size([10636, 1])
2025-06-03 11:42:28,433 - DEBUG - Edge anomaly scores shape: torch.Size([22216, 1])
2025-06-03 11:42:28,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:29,094 - DEBUG - Step 13: Loss=0.5427
2025-06-03 11:42:29,094 - DEBUG - Online update step: 14/50
2025-06-03 11:42:29,096 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:29,526 - DEBUG - Node anomaly scores shape: torch.Size([11728, 1])
2025-06-03 11:42:29,563 - DEBUG - Edge anomaly scores shape: torch.Size([24790, 1])
2025-06-03 11:42:29,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:30,321 - DEBUG - Step 14: Loss=0.5413
2025-06-03 11:42:30,322 - DEBUG - Online update step: 15/50
2025-06-03 11:42:30,323 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:30,784 - DEBUG - Node anomaly scores shape: torch.Size([11993, 1])
2025-06-03 11:42:30,825 - DEBUG - Edge anomaly scores shape: torch.Size([25481, 1])
2025-06-03 11:42:30,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:31,582 - DEBUG - Step 15: Loss=0.5441
2025-06-03 11:42:31,582 - DEBUG - Online update step: 16/50
2025-06-03 11:42:31,585 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:32,022 - DEBUG - Node anomaly scores shape: torch.Size([11617, 1])
2025-06-03 11:42:32,060 - DEBUG - Edge anomaly scores shape: torch.Size([24572, 1])
2025-06-03 11:42:32,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:32,746 - DEBUG - Step 16: Loss=0.5365
2025-06-03 11:42:32,746 - DEBUG - Online update step: 17/50
2025-06-03 11:42:32,747 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:33,186 - DEBUG - Node anomaly scores shape: torch.Size([11460, 1])
2025-06-03 11:42:33,224 - DEBUG - Edge anomaly scores shape: torch.Size([24122, 1])
2025-06-03 11:42:33,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:33,974 - DEBUG - Step 17: Loss=0.5307
2025-06-03 11:42:33,974 - DEBUG - Online update step: 18/50
2025-06-03 11:42:33,976 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:34,324 - DEBUG - Node anomaly scores shape: torch.Size([10379, 1])
2025-06-03 11:42:34,356 - DEBUG - Edge anomaly scores shape: torch.Size([21674, 1])
2025-06-03 11:42:34,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:35,002 - DEBUG - Step 18: Loss=0.5538
2025-06-03 11:42:35,002 - DEBUG - Online update step: 19/50
2025-06-03 11:42:35,004 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:35,461 - DEBUG - Node anomaly scores shape: torch.Size([11486, 1])
2025-06-03 11:42:35,503 - DEBUG - Edge anomaly scores shape: torch.Size([24169, 1])
2025-06-03 11:42:35,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:36,305 - DEBUG - Step 19: Loss=0.5369
2025-06-03 11:42:36,306 - DEBUG - Online update step: 20/50
2025-06-03 11:42:36,308 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:36,670 - DEBUG - Node anomaly scores shape: torch.Size([10033, 1])
2025-06-03 11:42:36,706 - DEBUG - Edge anomaly scores shape: torch.Size([20817, 1])
2025-06-03 11:42:36,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:37,384 - DEBUG - Step 20: Loss=0.5408
2025-06-03 11:42:37,384 - DEBUG - Online update step: 21/50
2025-06-03 11:42:37,386 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:37,860 - DEBUG - Node anomaly scores shape: torch.Size([12092, 1])
2025-06-03 11:42:37,900 - DEBUG - Edge anomaly scores shape: torch.Size([25623, 1])
2025-06-03 11:42:37,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:38,584 - DEBUG - Step 21: Loss=0.5345
2025-06-03 11:42:38,585 - DEBUG - Online update step: 22/50
2025-06-03 11:42:38,587 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:39,051 - DEBUG - Node anomaly scores shape: torch.Size([12304, 1])
2025-06-03 11:42:39,091 - DEBUG - Edge anomaly scores shape: torch.Size([26039, 1])
2025-06-03 11:42:39,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:39,843 - DEBUG - Step 22: Loss=0.5467
2025-06-03 11:42:39,843 - DEBUG - Online update step: 23/50
2025-06-03 11:42:39,845 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:40,254 - DEBUG - Node anomaly scores shape: torch.Size([11605, 1])
2025-06-03 11:42:40,287 - DEBUG - Edge anomaly scores shape: torch.Size([24452, 1])
2025-06-03 11:42:40,288 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:41,057 - DEBUG - Step 23: Loss=0.5359
2025-06-03 11:42:41,057 - DEBUG - Online update step: 24/50
2025-06-03 11:42:41,059 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:41,506 - DEBUG - Node anomaly scores shape: torch.Size([12071, 1])
2025-06-03 11:42:41,545 - DEBUG - Edge anomaly scores shape: torch.Size([25576, 1])
2025-06-03 11:42:41,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:42,228 - DEBUG - Step 24: Loss=0.5329
2025-06-03 11:42:42,228 - DEBUG - Online update step: 25/50
2025-06-03 11:42:42,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:42,669 - DEBUG - Node anomaly scores shape: torch.Size([11499, 1])
2025-06-03 11:42:42,706 - DEBUG - Edge anomaly scores shape: torch.Size([24361, 1])
2025-06-03 11:42:42,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:43,429 - DEBUG - Step 25: Loss=0.5343
2025-06-03 11:42:43,429 - DEBUG - Online update step: 26/50
2025-06-03 11:42:43,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:43,857 - DEBUG - Node anomaly scores shape: torch.Size([11614, 1])
2025-06-03 11:42:43,895 - DEBUG - Edge anomaly scores shape: torch.Size([24574, 1])
2025-06-03 11:42:43,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:44,581 - DEBUG - Step 26: Loss=0.5403
2025-06-03 11:42:44,581 - DEBUG - Online update step: 27/50
2025-06-03 11:42:44,582 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:45,020 - DEBUG - Node anomaly scores shape: torch.Size([12071, 1])
2025-06-03 11:42:45,059 - DEBUG - Edge anomaly scores shape: torch.Size([25605, 1])
2025-06-03 11:42:45,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:45,816 - DEBUG - Step 27: Loss=0.5494
2025-06-03 11:42:45,817 - DEBUG - Online update step: 28/50
2025-06-03 11:42:45,819 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:46,210 - DEBUG - Node anomaly scores shape: torch.Size([10921, 1])
2025-06-03 11:42:46,244 - DEBUG - Edge anomaly scores shape: torch.Size([22851, 1])
2025-06-03 11:42:46,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:46,902 - DEBUG - Step 28: Loss=0.5387
2025-06-03 11:42:46,902 - DEBUG - Online update step: 29/50
2025-06-03 11:42:46,904 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:47,301 - DEBUG - Node anomaly scores shape: torch.Size([10833, 1])
2025-06-03 11:42:47,337 - DEBUG - Edge anomaly scores shape: torch.Size([22695, 1])
2025-06-03 11:42:47,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:47,969 - DEBUG - Step 29: Loss=0.5472
2025-06-03 11:42:47,969 - DEBUG - Online update step: 30/50
2025-06-03 11:42:47,972 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:48,380 - DEBUG - Node anomaly scores shape: torch.Size([11227, 1])
2025-06-03 11:42:48,415 - DEBUG - Edge anomaly scores shape: torch.Size([23654, 1])
2025-06-03 11:42:48,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:49,084 - DEBUG - Step 30: Loss=0.5566
2025-06-03 11:42:49,084 - DEBUG - Online update step: 31/50
2025-06-03 11:42:49,085 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:49,514 - DEBUG - Node anomaly scores shape: torch.Size([11472, 1])
2025-06-03 11:42:49,550 - DEBUG - Edge anomaly scores shape: torch.Size([24319, 1])
2025-06-03 11:42:49,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:50,164 - DEBUG - Step 31: Loss=0.5404
2025-06-03 11:42:50,165 - DEBUG - Online update step: 32/50
2025-06-03 11:42:50,166 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:50,634 - DEBUG - Node anomaly scores shape: torch.Size([12172, 1])
2025-06-03 11:42:50,674 - DEBUG - Edge anomaly scores shape: torch.Size([25926, 1])
2025-06-03 11:42:50,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:51,430 - DEBUG - Step 32: Loss=0.5510
2025-06-03 11:42:51,430 - DEBUG - Online update step: 33/50
2025-06-03 11:42:51,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:51,839 - DEBUG - Node anomaly scores shape: torch.Size([11248, 1])
2025-06-03 11:42:51,876 - DEBUG - Edge anomaly scores shape: torch.Size([23622, 1])
2025-06-03 11:42:51,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:52,579 - DEBUG - Step 33: Loss=0.5386
2025-06-03 11:42:52,579 - DEBUG - Online update step: 34/50
2025-06-03 11:42:52,581 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:53,002 - DEBUG - Node anomaly scores shape: torch.Size([11507, 1])
2025-06-03 11:42:53,044 - DEBUG - Edge anomaly scores shape: torch.Size([24329, 1])
2025-06-03 11:42:53,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:53,779 - DEBUG - Step 34: Loss=0.5325
2025-06-03 11:42:53,779 - DEBUG - Online update step: 35/50
2025-06-03 11:42:53,781 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:54,207 - DEBUG - Node anomaly scores shape: torch.Size([11741, 1])
2025-06-03 11:42:54,244 - DEBUG - Edge anomaly scores shape: torch.Size([24846, 1])
2025-06-03 11:42:54,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:54,949 - DEBUG - Step 35: Loss=0.5387
2025-06-03 11:42:54,949 - DEBUG - Online update step: 36/50
2025-06-03 11:42:54,951 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:55,397 - DEBUG - Node anomaly scores shape: torch.Size([11920, 1])
2025-06-03 11:42:55,437 - DEBUG - Edge anomaly scores shape: torch.Size([25165, 1])
2025-06-03 11:42:55,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:56,204 - DEBUG - Step 36: Loss=0.5555
2025-06-03 11:42:56,204 - DEBUG - Online update step: 37/50
2025-06-03 11:42:56,206 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:56,639 - DEBUG - Node anomaly scores shape: torch.Size([11732, 1])
2025-06-03 11:42:56,678 - DEBUG - Edge anomaly scores shape: torch.Size([24852, 1])
2025-06-03 11:42:56,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:57,401 - DEBUG - Step 37: Loss=0.5352
2025-06-03 11:42:57,401 - DEBUG - Online update step: 38/50
2025-06-03 11:42:57,403 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:57,777 - DEBUG - Node anomaly scores shape: torch.Size([10959, 1])
2025-06-03 11:42:57,814 - DEBUG - Edge anomaly scores shape: torch.Size([23065, 1])
2025-06-03 11:42:57,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:58,468 - DEBUG - Step 38: Loss=0.5295
2025-06-03 11:42:58,468 - DEBUG - Online update step: 39/50
2025-06-03 11:42:58,471 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:42:58,930 - DEBUG - Node anomaly scores shape: torch.Size([12268, 1])
2025-06-03 11:42:58,970 - DEBUG - Edge anomaly scores shape: torch.Size([26071, 1])
2025-06-03 11:42:58,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:42:59,658 - DEBUG - Step 39: Loss=0.5374
2025-06-03 11:42:59,658 - DEBUG - Online update step: 40/50
2025-06-03 11:42:59,660 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:00,013 - DEBUG - Node anomaly scores shape: torch.Size([10074, 1])
2025-06-03 11:43:00,044 - DEBUG - Edge anomaly scores shape: torch.Size([20927, 1])
2025-06-03 11:43:00,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:00,667 - DEBUG - Step 40: Loss=0.5434
2025-06-03 11:43:00,667 - DEBUG - Online update step: 41/50
2025-06-03 11:43:00,669 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:01,110 - DEBUG - Node anomaly scores shape: torch.Size([11492, 1])
2025-06-03 11:43:01,148 - DEBUG - Edge anomaly scores shape: torch.Size([24184, 1])
2025-06-03 11:43:01,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:01,844 - DEBUG - Step 41: Loss=0.5513
2025-06-03 11:43:01,844 - DEBUG - Online update step: 42/50
2025-06-03 11:43:01,846 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:02,227 - DEBUG - Node anomaly scores shape: torch.Size([11104, 1])
2025-06-03 11:43:02,262 - DEBUG - Edge anomaly scores shape: torch.Size([23327, 1])
2025-06-03 11:43:02,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:02,924 - DEBUG - Step 42: Loss=0.5310
2025-06-03 11:43:02,924 - DEBUG - Online update step: 43/50
2025-06-03 11:43:02,925 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:03,306 - DEBUG - Node anomaly scores shape: torch.Size([10916, 1])
2025-06-03 11:43:03,340 - DEBUG - Edge anomaly scores shape: torch.Size([22938, 1])
2025-06-03 11:43:03,341 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:04,058 - DEBUG - Step 43: Loss=0.5402
2025-06-03 11:43:04,058 - DEBUG - Online update step: 44/50
2025-06-03 11:43:04,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:04,499 - DEBUG - Node anomaly scores shape: torch.Size([12204, 1])
2025-06-03 11:43:04,539 - DEBUG - Edge anomaly scores shape: torch.Size([25943, 1])
2025-06-03 11:43:04,540 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:05,247 - DEBUG - Step 44: Loss=0.5339
2025-06-03 11:43:05,247 - DEBUG - Online update step: 45/50
2025-06-03 11:43:05,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:05,672 - DEBUG - Node anomaly scores shape: torch.Size([11994, 1])
2025-06-03 11:43:05,710 - DEBUG - Edge anomaly scores shape: torch.Size([25404, 1])
2025-06-03 11:43:05,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:06,485 - DEBUG - Step 45: Loss=0.5464
2025-06-03 11:43:06,485 - DEBUG - Online update step: 46/50
2025-06-03 11:43:06,487 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:06,892 - DEBUG - Node anomaly scores shape: torch.Size([11449, 1])
2025-06-03 11:43:06,930 - DEBUG - Edge anomaly scores shape: torch.Size([24164, 1])
2025-06-03 11:43:06,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:07,656 - DEBUG - Step 46: Loss=0.5388
2025-06-03 11:43:07,656 - DEBUG - Online update step: 47/50
2025-06-03 11:43:07,658 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:08,140 - DEBUG - Node anomaly scores shape: torch.Size([12696, 1])
2025-06-03 11:43:08,183 - DEBUG - Edge anomaly scores shape: torch.Size([26974, 1])
2025-06-03 11:43:08,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:08,950 - DEBUG - Step 47: Loss=0.5514
2025-06-03 11:43:08,950 - DEBUG - Online update step: 48/50
2025-06-03 11:43:08,953 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:09,395 - DEBUG - Node anomaly scores shape: torch.Size([12261, 1])
2025-06-03 11:43:09,435 - DEBUG - Edge anomaly scores shape: torch.Size([26012, 1])
2025-06-03 11:43:09,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:10,155 - DEBUG - Step 48: Loss=0.5424
2025-06-03 11:43:10,155 - DEBUG - Online update step: 49/50
2025-06-03 11:43:10,158 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:10,625 - DEBUG - Node anomaly scores shape: torch.Size([12565, 1])
2025-06-03 11:43:10,665 - DEBUG - Edge anomaly scores shape: torch.Size([26688, 1])
2025-06-03 11:43:10,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:11,352 - DEBUG - Step 49: Loss=0.5366
2025-06-03 11:43:11,353 - DEBUG - Online update step: 50/50
2025-06-03 11:43:11,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:11,769 - DEBUG - Node anomaly scores shape: torch.Size([11661, 1])
2025-06-03 11:43:11,803 - DEBUG - Edge anomaly scores shape: torch.Size([24691, 1])
2025-06-03 11:43:11,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:12,487 - DEBUG - Step 50: Loss=0.5390
2025-06-03 11:43:12,487 - INFO - Online update finished. Average loss: 0.5430, Learning rate: 0.000440
2025-06-03 11:43:12,487 - DEBUG - Current node mean: [-2.4746040e-08  2.4746040e-08 -7.6141662e-09  6.6623955e-09
 -1.2373020e-08  3.4263749e-08  2.8553123e-08 -9.5177075e-09
 -1.4276562e-09  3.8070831e-09 -1.0469479e-08  1.5228332e-08
  1.6893932e-08 -1.9035415e-08 -3.0456665e-08 -1.9035415e-09
  2.9504895e-08  0.0000000e+00  0.0000000e+00  1.5109361e-08
  0.0000000e+00  0.0000000e+00  4.7588538e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4257156e+00  5.7010450e+00 -2.5997482e-09 -2.5997482e-09
  8.6658275e-10  8.6658275e-10  1.7331655e-09 -1.0398993e-08
 -5.1994964e-09  1.7331655e-09  1.1265576e-08  5.1994964e-09
  1.7331655e-09  8.6658275e-10 -6.0660792e-09 -1.7331655e-09
 -1.7331655e-09 -1.7331655e-09 -1.7331655e-09 -1.7331655e-09
 -1.7331655e-09  1.7331655e-09]
2025-06-03 11:43:12,488 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0104
2025-06-03 11:43:12,488 - INFO - Online update complete. Loss: 0.5430
2025-06-03 11:43:12,488 - INFO - Running anomaly detection...
2025-06-03 11:43:12,488 - INFO - Starting anomaly detection.
2025-06-03 11:43:12,503 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114312_update_41.json
2025-06-03 11:43:12,503 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:43:12,524 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114312_update_41.pth and as latest_checkpoint.pth
2025-06-03 11:43:12,525 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.0000
2025-06-03 11:43:12,525 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:43:12,525 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.9989, MLP Score: 1.0000
2025-06-03 11:43:12,525 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9417, MLP Score: 1.0000
2025-06-03 11:43:12,525 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1956, MLP Score: 1.0000
2025-06-03 11:43:12,525 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0662, MLP Score: 1.0000
2025-06-03 11:43:12,525 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1262, MLP Score: 1.0000
2025-06-03 11:43:12,525 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:43:12,525 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5330, MLP Score: 0.9997
2025-06-03 11:43:12,525 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2495, MLP Score: 0.9994
2025-06-03 11:43:12,525 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.0319, MLP Score: 0.9998
2025-06-03 11:43:12,525 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4488, MLP Score: 0.9969
2025-06-03 11:43:12,525 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4841, MLP Score: 0.9972
2025-06-03 11:43:12,525 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:43:12,525 - INFO - Performing visualization of node and edge features.
2025-06-03 11:43:12,525 - INFO - Starting visualization of node features.
2025-06-03 11:43:12,526 - INFO - Graph has 1002 nodes and 30 features.
2025-06-03 11:43:12,526 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:43:12,526 - INFO - Calculating feature statistics:
2025-06-03 11:43:12,526 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.9035415e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10779948), 'max': np.float32(9.4549055)}
2025-06-03 11:43:12,526 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.9035415e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.4549055), 'max': np.float32(0.10779948)}
2025-06-03 11:43:12,526 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-7.614166e-09), 'std': np.float32(0.99999994), 'min': np.float32(-2.2951245), 'max': np.float32(3.1844404)}
2025-06-03 11:43:12,526 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(2.8553124e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.075687245), 'max': np.float32(18.128239)}
2025-06-03 11:43:12,526 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-1.142125e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64128727), 'max': np.float32(3.517741)}
2025-06-03 11:43:12,526 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(3.807083e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64773375), 'max': np.float32(2.8945014)}
2025-06-03 11:43:12,527 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(2.28425e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.920527), 'max': np.float32(0.63164884)}
2025-06-03 11:43:12,527 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.07882985), 'max': np.float32(20.457922)}
2025-06-03 11:43:12,527 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-9.5177075e-09), 'std': np.float32(1.0000001), 'min': np.float32(-4.263898), 'max': np.float32(20.942154)}
2025-06-03 11:43:12,527 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(1.6655989e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.09322403), 'max': np.float32(11.406229)}
2025-06-03 11:43:12,527 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.003119), 'max': np.float32(0.9216695)}
2025-06-03 11:43:12,527 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(9.5177075e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.103043675), 'max': np.float32(10.232957)}
2025-06-03 11:43:12,527 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(1.5704218e-08), 'std': np.float32(0.99999994), 'min': np.float32(-7.992366), 'max': np.float32(0.12694868)}
2025-06-03 11:43:12,527 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3828843), 'max': np.float32(1.8222367)}
2025-06-03 11:43:12,527 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(-1.5228332e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7219405), 'max': np.float32(2.4828484)}
2025-06-03 11:43:12,527 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4587957), 'max': np.float32(2.3851652)}
2025-06-03 11:43:12,527 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.0456665e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683), 'max': np.float32(1.4947592)}
2025-06-03 11:43:12,528 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(9.5177075e-09), 'std': np.float32(1.0), 'min': np.float32(-7.408522), 'max': np.float32(0.15208052)}
2025-06-03 11:43:12,528 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.9035415e-09), 'std': np.float32(1.0), 'min': np.float32(-4.1356325), 'max': np.float32(4.347513)}
2025-06-03 11:43:12,528 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,528 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,529 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,529 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:43:12,543 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x764b39a955e0>
2025-06-03 11:43:12,842 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:43:12,901 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:43:12,930 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:43:14,172 - INFO - Node feature visualization saved to vis/node_features_20250603_114313.png
2025-06-03 11:43:14,172 - INFO - Finished visualization of node features.
2025-06-03 11:43:14,172 - INFO - Performing additional feature analysis:
2025-06-03 11:43:14,172 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:43:14,172 - INFO - Starting visualization of edge features.
2025-06-03 11:43:14,172 - INFO - Graph has 2201 edges and 22 edge features.
2025-06-03 11:43:14,172 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:43:14,172 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:43:14,172 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-03 11:43:14,172 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-03 11:43:14,172 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot file.
2025-06-03 11:43:14,197 - INFO - Parsed 1003 nodes.
2025-06-03 11:43:14,219 - INFO - Parsed 2202 edges.
2025-06-03 11:43:14,946 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:43:14,946 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:43:14,964 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:43:14,965 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:43:14,965 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:43:14,967 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:43:14,967 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:43:14,978 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:43:14,980 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:43:14,982 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:43:14,983 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:43:14,984 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:43:14,984 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:43:14,984 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:43:14,984 - INFO - Performing online update...
2025-06-03 11:43:14,984 - INFO - Starting online update for 50 steps.
2025-06-03 11:43:14,985 - DEBUG - Updated RunningStats: new_mean=0.5416395430331739, new_var=85200000000008.83, new_n=8550
2025-06-03 11:43:14,985 - DEBUG - Updated RunningStats: new_mean=0.5419612554615728, new_var=85500000000007.22, new_n=8580
2025-06-03 11:43:14,985 - DEBUG - Updated RunningStats: new_mean=0.7769417599463448, new_var=50240000000036.734, new_n=5046
2025-06-03 11:43:14,985 - DEBUG - Updated RunningStats: new_mean=0.7780377654739238, new_var=50460000000002.914, new_n=5068
2025-06-03 11:43:14,985 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:43:14,985 - DEBUG - Online update step: 1/50
2025-06-03 11:43:14,987 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:15,432 - DEBUG - Node anomaly scores shape: torch.Size([10882, 1])
2025-06-03 11:43:15,470 - DEBUG - Edge anomaly scores shape: torch.Size([22776, 1])
2025-06-03 11:43:15,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:16,148 - DEBUG - Step 1: Loss=0.5412
2025-06-03 11:43:16,149 - DEBUG - Online update step: 2/50
2025-06-03 11:43:16,150 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:16,605 - DEBUG - Node anomaly scores shape: torch.Size([12172, 1])
2025-06-03 11:43:16,644 - DEBUG - Edge anomaly scores shape: torch.Size([25910, 1])
2025-06-03 11:43:16,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:17,352 - DEBUG - Step 2: Loss=0.5293
2025-06-03 11:43:17,352 - DEBUG - Online update step: 3/50
2025-06-03 11:43:17,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:17,813 - DEBUG - Node anomaly scores shape: torch.Size([12237, 1])
2025-06-03 11:43:17,852 - DEBUG - Edge anomaly scores shape: torch.Size([25899, 1])
2025-06-03 11:43:17,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:18,573 - DEBUG - Step 3: Loss=0.5336
2025-06-03 11:43:18,573 - DEBUG - Online update step: 4/50
2025-06-03 11:43:18,575 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:18,935 - DEBUG - Node anomaly scores shape: torch.Size([10356, 1])
2025-06-03 11:43:18,967 - DEBUG - Edge anomaly scores shape: torch.Size([21637, 1])
2025-06-03 11:43:18,967 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:19,512 - DEBUG - Step 4: Loss=0.5453
2025-06-03 11:43:19,512 - DEBUG - Online update step: 5/50
2025-06-03 11:43:19,513 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:19,970 - DEBUG - Node anomaly scores shape: torch.Size([12588, 1])
2025-06-03 11:43:20,011 - DEBUG - Edge anomaly scores shape: torch.Size([26762, 1])
2025-06-03 11:43:20,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:20,738 - DEBUG - Step 5: Loss=0.5385
2025-06-03 11:43:20,738 - DEBUG - Online update step: 6/50
2025-06-03 11:43:20,740 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:21,154 - DEBUG - Node anomaly scores shape: torch.Size([11534, 1])
2025-06-03 11:43:21,190 - DEBUG - Edge anomaly scores shape: torch.Size([24337, 1])
2025-06-03 11:43:21,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:21,838 - DEBUG - Step 6: Loss=0.5296
2025-06-03 11:43:21,838 - DEBUG - Online update step: 7/50
2025-06-03 11:43:21,841 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:22,300 - DEBUG - Node anomaly scores shape: torch.Size([11692, 1])
2025-06-03 11:43:22,338 - DEBUG - Edge anomaly scores shape: torch.Size([24675, 1])
2025-06-03 11:43:22,339 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:23,041 - DEBUG - Step 7: Loss=0.5531
2025-06-03 11:43:23,042 - DEBUG - Online update step: 8/50
2025-06-03 11:43:23,044 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:23,480 - DEBUG - Node anomaly scores shape: torch.Size([12161, 1])
2025-06-03 11:43:23,522 - DEBUG - Edge anomaly scores shape: torch.Size([25902, 1])
2025-06-03 11:43:23,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:24,313 - DEBUG - Step 8: Loss=0.5306
2025-06-03 11:43:24,313 - DEBUG - Online update step: 9/50
2025-06-03 11:43:24,315 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:24,723 - DEBUG - Node anomaly scores shape: torch.Size([11257, 1])
2025-06-03 11:43:24,757 - DEBUG - Edge anomaly scores shape: torch.Size([23692, 1])
2025-06-03 11:43:24,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:25,450 - DEBUG - Step 9: Loss=0.5332
2025-06-03 11:43:25,450 - DEBUG - Online update step: 10/50
2025-06-03 11:43:25,452 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:25,908 - DEBUG - Node anomaly scores shape: torch.Size([12185, 1])
2025-06-03 11:43:25,947 - DEBUG - Edge anomaly scores shape: torch.Size([25886, 1])
2025-06-03 11:43:25,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:26,583 - DEBUG - Step 10: Loss=0.5363
2025-06-03 11:43:26,583 - DEBUG - Online update step: 11/50
2025-06-03 11:43:26,585 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:26,996 - DEBUG - Node anomaly scores shape: torch.Size([11130, 1])
2025-06-03 11:43:27,032 - DEBUG - Edge anomaly scores shape: torch.Size([23418, 1])
2025-06-03 11:43:27,033 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:27,690 - DEBUG - Step 11: Loss=0.5398
2025-06-03 11:43:27,690 - DEBUG - Online update step: 12/50
2025-06-03 11:43:27,693 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:28,158 - DEBUG - Node anomaly scores shape: torch.Size([12355, 1])
2025-06-03 11:43:28,193 - DEBUG - Edge anomaly scores shape: torch.Size([26325, 1])
2025-06-03 11:43:28,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:28,922 - DEBUG - Step 12: Loss=0.5386
2025-06-03 11:43:28,922 - DEBUG - Online update step: 13/50
2025-06-03 11:43:28,924 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:29,303 - DEBUG - Node anomaly scores shape: torch.Size([10746, 1])
2025-06-03 11:43:29,335 - DEBUG - Edge anomaly scores shape: torch.Size([22508, 1])
2025-06-03 11:43:29,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:29,939 - DEBUG - Step 13: Loss=0.5378
2025-06-03 11:43:29,940 - DEBUG - Online update step: 14/50
2025-06-03 11:43:29,941 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:30,293 - DEBUG - Node anomaly scores shape: torch.Size([10328, 1])
2025-06-03 11:43:30,326 - DEBUG - Edge anomaly scores shape: torch.Size([21573, 1])
2025-06-03 11:43:30,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:30,938 - DEBUG - Step 14: Loss=0.5363
2025-06-03 11:43:30,939 - DEBUG - Online update step: 15/50
2025-06-03 11:43:30,940 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:31,328 - DEBUG - Node anomaly scores shape: torch.Size([10855, 1])
2025-06-03 11:43:31,363 - DEBUG - Edge anomaly scores shape: torch.Size([22835, 1])
2025-06-03 11:43:31,365 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:32,106 - DEBUG - Step 15: Loss=0.5415
2025-06-03 11:43:32,106 - DEBUG - Online update step: 16/50
2025-06-03 11:43:32,107 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:32,550 - DEBUG - Node anomaly scores shape: torch.Size([11959, 1])
2025-06-03 11:43:32,590 - DEBUG - Edge anomaly scores shape: torch.Size([25367, 1])
2025-06-03 11:43:32,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:33,317 - DEBUG - Step 16: Loss=0.5396
2025-06-03 11:43:33,317 - DEBUG - Online update step: 17/50
2025-06-03 11:43:33,320 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:33,742 - DEBUG - Node anomaly scores shape: torch.Size([10848, 1])
2025-06-03 11:43:33,778 - DEBUG - Edge anomaly scores shape: torch.Size([22784, 1])
2025-06-03 11:43:33,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:34,489 - DEBUG - Step 17: Loss=0.5387
2025-06-03 11:43:34,489 - DEBUG - Online update step: 18/50
2025-06-03 11:43:34,491 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:34,923 - DEBUG - Node anomaly scores shape: torch.Size([11842, 1])
2025-06-03 11:43:34,964 - DEBUG - Edge anomaly scores shape: torch.Size([25167, 1])
2025-06-03 11:43:34,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:35,680 - DEBUG - Step 18: Loss=0.5327
2025-06-03 11:43:35,680 - DEBUG - Online update step: 19/50
2025-06-03 11:43:35,682 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:36,172 - DEBUG - Node anomaly scores shape: torch.Size([12901, 1])
2025-06-03 11:43:36,214 - DEBUG - Edge anomaly scores shape: torch.Size([27588, 1])
2025-06-03 11:43:36,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:36,945 - DEBUG - Step 19: Loss=0.5304
2025-06-03 11:43:36,945 - DEBUG - Online update step: 20/50
2025-06-03 11:43:36,946 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:37,385 - DEBUG - Node anomaly scores shape: torch.Size([12278, 1])
2025-06-03 11:43:37,425 - DEBUG - Edge anomaly scores shape: torch.Size([26036, 1])
2025-06-03 11:43:37,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:38,129 - DEBUG - Step 20: Loss=0.5374
2025-06-03 11:43:38,129 - DEBUG - Online update step: 21/50
2025-06-03 11:43:38,132 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:38,569 - DEBUG - Node anomaly scores shape: torch.Size([11929, 1])
2025-06-03 11:43:38,608 - DEBUG - Edge anomaly scores shape: torch.Size([25267, 1])
2025-06-03 11:43:38,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:39,305 - DEBUG - Step 21: Loss=0.5326
2025-06-03 11:43:39,305 - DEBUG - Online update step: 22/50
2025-06-03 11:43:39,307 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:39,699 - DEBUG - Node anomaly scores shape: torch.Size([10839, 1])
2025-06-03 11:43:39,734 - DEBUG - Edge anomaly scores shape: torch.Size([22786, 1])
2025-06-03 11:43:39,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:40,403 - DEBUG - Step 22: Loss=0.5352
2025-06-03 11:43:40,403 - DEBUG - Online update step: 23/50
2025-06-03 11:43:40,405 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:40,750 - DEBUG - Node anomaly scores shape: torch.Size([10232, 1])
2025-06-03 11:43:40,783 - DEBUG - Edge anomaly scores shape: torch.Size([21275, 1])
2025-06-03 11:43:40,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:41,377 - DEBUG - Step 23: Loss=0.5402
2025-06-03 11:43:41,377 - DEBUG - Online update step: 24/50
2025-06-03 11:43:41,378 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:41,745 - DEBUG - Node anomaly scores shape: torch.Size([10497, 1])
2025-06-03 11:43:41,778 - DEBUG - Edge anomaly scores shape: torch.Size([21916, 1])
2025-06-03 11:43:41,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:42,389 - DEBUG - Step 24: Loss=0.5403
2025-06-03 11:43:42,389 - DEBUG - Online update step: 25/50
2025-06-03 11:43:42,390 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:42,729 - DEBUG - Node anomaly scores shape: torch.Size([9832, 1])
2025-06-03 11:43:42,762 - DEBUG - Edge anomaly scores shape: torch.Size([20344, 1])
2025-06-03 11:43:42,763 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:43,324 - DEBUG - Step 25: Loss=0.5415
2025-06-03 11:43:43,324 - DEBUG - Online update step: 26/50
2025-06-03 11:43:43,325 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:43,786 - DEBUG - Node anomaly scores shape: torch.Size([12405, 1])
2025-06-03 11:43:43,825 - DEBUG - Edge anomaly scores shape: torch.Size([26382, 1])
2025-06-03 11:43:43,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:44,453 - DEBUG - Step 26: Loss=0.5382
2025-06-03 11:43:44,453 - DEBUG - Online update step: 27/50
2025-06-03 11:43:44,455 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:44,902 - DEBUG - Node anomaly scores shape: torch.Size([11828, 1])
2025-06-03 11:43:44,939 - DEBUG - Edge anomaly scores shape: torch.Size([25040, 1])
2025-06-03 11:43:44,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:45,592 - DEBUG - Step 27: Loss=0.5354
2025-06-03 11:43:45,592 - DEBUG - Online update step: 28/50
2025-06-03 11:43:45,594 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:45,988 - DEBUG - Node anomaly scores shape: torch.Size([11063, 1])
2025-06-03 11:43:46,023 - DEBUG - Edge anomaly scores shape: torch.Size([23163, 1])
2025-06-03 11:43:46,024 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:46,651 - DEBUG - Step 28: Loss=0.5388
2025-06-03 11:43:46,651 - DEBUG - Online update step: 29/50
2025-06-03 11:43:46,653 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:47,147 - DEBUG - Node anomaly scores shape: torch.Size([12979, 1])
2025-06-03 11:43:47,190 - DEBUG - Edge anomaly scores shape: torch.Size([27674, 1])
2025-06-03 11:43:47,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:48,008 - DEBUG - Step 29: Loss=0.5397
2025-06-03 11:43:48,009 - DEBUG - Online update step: 30/50
2025-06-03 11:43:48,011 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:48,427 - DEBUG - Node anomaly scores shape: torch.Size([10815, 1])
2025-06-03 11:43:48,463 - DEBUG - Edge anomaly scores shape: torch.Size([22678, 1])
2025-06-03 11:43:48,464 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:49,100 - DEBUG - Step 30: Loss=0.5337
2025-06-03 11:43:49,100 - DEBUG - Online update step: 31/50
2025-06-03 11:43:49,102 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:49,568 - DEBUG - Node anomaly scores shape: torch.Size([12287, 1])
2025-06-03 11:43:49,609 - DEBUG - Edge anomaly scores shape: torch.Size([25995, 1])
2025-06-03 11:43:49,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:50,401 - DEBUG - Step 31: Loss=0.5233
2025-06-03 11:43:50,401 - DEBUG - Online update step: 32/50
2025-06-03 11:43:50,403 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:50,786 - DEBUG - Node anomaly scores shape: torch.Size([10932, 1])
2025-06-03 11:43:50,821 - DEBUG - Edge anomaly scores shape: torch.Size([22887, 1])
2025-06-03 11:43:50,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:51,486 - DEBUG - Step 32: Loss=0.5345
2025-06-03 11:43:51,486 - DEBUG - Online update step: 33/50
2025-06-03 11:43:51,488 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:51,933 - DEBUG - Node anomaly scores shape: torch.Size([12018, 1])
2025-06-03 11:43:51,973 - DEBUG - Edge anomaly scores shape: torch.Size([25544, 1])
2025-06-03 11:43:51,974 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:52,653 - DEBUG - Step 33: Loss=0.5331
2025-06-03 11:43:52,653 - DEBUG - Online update step: 34/50
2025-06-03 11:43:52,655 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:53,081 - DEBUG - Node anomaly scores shape: torch.Size([11369, 1])
2025-06-03 11:43:53,119 - DEBUG - Edge anomaly scores shape: torch.Size([23903, 1])
2025-06-03 11:43:53,119 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:53,780 - DEBUG - Step 34: Loss=0.5446
2025-06-03 11:43:53,780 - DEBUG - Online update step: 35/50
2025-06-03 11:43:53,782 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:54,113 - DEBUG - Node anomaly scores shape: torch.Size([9918, 1])
2025-06-03 11:43:54,146 - DEBUG - Edge anomaly scores shape: torch.Size([20666, 1])
2025-06-03 11:43:54,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:54,693 - DEBUG - Step 35: Loss=0.5522
2025-06-03 11:43:54,694 - DEBUG - Online update step: 36/50
2025-06-03 11:43:54,695 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:55,075 - DEBUG - Node anomaly scores shape: torch.Size([10564, 1])
2025-06-03 11:43:55,110 - DEBUG - Edge anomaly scores shape: torch.Size([22052, 1])
2025-06-03 11:43:55,111 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:55,742 - DEBUG - Step 36: Loss=0.5447
2025-06-03 11:43:55,743 - DEBUG - Online update step: 37/50
2025-06-03 11:43:55,745 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:56,273 - DEBUG - Node anomaly scores shape: torch.Size([13474, 1])
2025-06-03 11:43:56,318 - DEBUG - Edge anomaly scores shape: torch.Size([28932, 1])
2025-06-03 11:43:56,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:57,086 - DEBUG - Step 37: Loss=0.5392
2025-06-03 11:43:57,086 - DEBUG - Online update step: 38/50
2025-06-03 11:43:57,088 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:57,510 - DEBUG - Node anomaly scores shape: torch.Size([12402, 1])
2025-06-03 11:43:57,551 - DEBUG - Edge anomaly scores shape: torch.Size([26276, 1])
2025-06-03 11:43:57,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:58,240 - DEBUG - Step 38: Loss=0.5351
2025-06-03 11:43:58,241 - DEBUG - Online update step: 39/50
2025-06-03 11:43:58,243 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:58,619 - DEBUG - Node anomaly scores shape: torch.Size([11050, 1])
2025-06-03 11:43:58,654 - DEBUG - Edge anomaly scores shape: torch.Size([23143, 1])
2025-06-03 11:43:58,655 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:43:59,244 - DEBUG - Step 39: Loss=0.5396
2025-06-03 11:43:59,244 - DEBUG - Online update step: 40/50
2025-06-03 11:43:59,246 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:43:59,704 - DEBUG - Node anomaly scores shape: torch.Size([12073, 1])
2025-06-03 11:43:59,744 - DEBUG - Edge anomaly scores shape: torch.Size([25631, 1])
2025-06-03 11:43:59,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:00,442 - DEBUG - Step 40: Loss=0.5439
2025-06-03 11:44:00,442 - DEBUG - Online update step: 41/50
2025-06-03 11:44:00,444 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:00,943 - DEBUG - Node anomaly scores shape: torch.Size([12956, 1])
2025-06-03 11:44:00,987 - DEBUG - Edge anomaly scores shape: torch.Size([27769, 1])
2025-06-03 11:44:00,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:01,707 - DEBUG - Step 41: Loss=0.5212
2025-06-03 11:44:01,707 - DEBUG - Online update step: 42/50
2025-06-03 11:44:01,709 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:02,157 - DEBUG - Node anomaly scores shape: torch.Size([12409, 1])
2025-06-03 11:44:02,197 - DEBUG - Edge anomaly scores shape: torch.Size([26420, 1])
2025-06-03 11:44:02,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:02,906 - DEBUG - Step 42: Loss=0.5266
2025-06-03 11:44:02,906 - DEBUG - Online update step: 43/50
2025-06-03 11:44:02,907 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:03,290 - DEBUG - Node anomaly scores shape: torch.Size([10901, 1])
2025-06-03 11:44:03,326 - DEBUG - Edge anomaly scores shape: torch.Size([22934, 1])
2025-06-03 11:44:03,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:03,986 - DEBUG - Step 43: Loss=0.5297
2025-06-03 11:44:03,986 - DEBUG - Online update step: 44/50
2025-06-03 11:44:03,988 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:04,332 - DEBUG - Node anomaly scores shape: torch.Size([9555, 1])
2025-06-03 11:44:04,362 - DEBUG - Edge anomaly scores shape: torch.Size([19740, 1])
2025-06-03 11:44:04,363 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:04,919 - DEBUG - Step 44: Loss=0.5433
2025-06-03 11:44:04,919 - DEBUG - Online update step: 45/50
2025-06-03 11:44:04,921 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:05,345 - DEBUG - Node anomaly scores shape: torch.Size([11224, 1])
2025-06-03 11:44:05,382 - DEBUG - Edge anomaly scores shape: torch.Size([23587, 1])
2025-06-03 11:44:05,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:06,011 - DEBUG - Step 45: Loss=0.5313
2025-06-03 11:44:06,011 - DEBUG - Online update step: 46/50
2025-06-03 11:44:06,014 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:06,366 - DEBUG - Node anomaly scores shape: torch.Size([10420, 1])
2025-06-03 11:44:06,398 - DEBUG - Edge anomaly scores shape: torch.Size([21701, 1])
2025-06-03 11:44:06,399 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:07,049 - DEBUG - Step 46: Loss=0.5476
2025-06-03 11:44:07,049 - DEBUG - Online update step: 47/50
2025-06-03 11:44:07,051 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:07,501 - DEBUG - Node anomaly scores shape: torch.Size([12259, 1])
2025-06-03 11:44:07,542 - DEBUG - Edge anomaly scores shape: torch.Size([25902, 1])
2025-06-03 11:44:07,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:08,228 - DEBUG - Step 47: Loss=0.5296
2025-06-03 11:44:08,228 - DEBUG - Online update step: 48/50
2025-06-03 11:44:08,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:08,601 - DEBUG - Node anomaly scores shape: torch.Size([11031, 1])
2025-06-03 11:44:08,638 - DEBUG - Edge anomaly scores shape: torch.Size([23071, 1])
2025-06-03 11:44:08,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:09,309 - DEBUG - Step 48: Loss=0.5456
2025-06-03 11:44:09,309 - DEBUG - Online update step: 49/50
2025-06-03 11:44:09,311 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:09,736 - DEBUG - Node anomaly scores shape: torch.Size([11652, 1])
2025-06-03 11:44:09,773 - DEBUG - Edge anomaly scores shape: torch.Size([24531, 1])
2025-06-03 11:44:09,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:10,478 - DEBUG - Step 49: Loss=0.5420
2025-06-03 11:44:10,478 - DEBUG - Online update step: 50/50
2025-06-03 11:44:10,481 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:10,955 - DEBUG - Node anomaly scores shape: torch.Size([12102, 1])
2025-06-03 11:44:10,996 - DEBUG - Edge anomaly scores shape: torch.Size([25611, 1])
2025-06-03 11:44:10,997 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:11,792 - DEBUG - Step 50: Loss=0.5286
2025-06-03 11:44:11,792 - INFO - Online update finished. Average loss: 0.5371, Learning rate: 0.000287
2025-06-03 11:44:11,793 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:44:11,793 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0012
2025-06-03 11:44:11,794 - INFO - Online update complete. Loss: 0.5371
2025-06-03 11:44:11,794 - INFO - Running anomaly detection...
2025-06-03 11:44:11,794 - INFO - Starting anomaly detection.
2025-06-03 11:44:11,822 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114411_update_42.json
2025-06-03 11:44:11,823 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:44:11,843 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114411_update_42.pth and as latest_checkpoint.pth
2025-06-03 11:44:11,843 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.0000
2025-06-03 11:44:11,843 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:44:11,843 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.9675, MLP Score: 1.0000
2025-06-03 11:44:11,843 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9032, MLP Score: 1.0000
2025-06-03 11:44:11,843 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.1905, MLP Score: 1.0000
2025-06-03 11:44:11,843 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.0954, MLP Score: 1.0000
2025-06-03 11:44:11,843 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1357, MLP Score: 1.0000
2025-06-03 11:44:11,843 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:44:11,844 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5341, MLP Score: 0.9995
2025-06-03 11:44:11,844 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2525, MLP Score: 0.9996
2025-06-03 11:44:11,844 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.0358, MLP Score: 0.9999
2025-06-03 11:44:11,844 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4527, MLP Score: 0.9976
2025-06-03 11:44:11,844 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4977, MLP Score: 0.9985
2025-06-03 11:44:11,844 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-03 11:44:11,844 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-03 11:44:11,844 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot file.
2025-06-03 11:44:11,871 - INFO - Parsed 1003 nodes.
2025-06-03 11:44:11,895 - INFO - Parsed 2202 edges.
2025-06-03 11:44:12,646 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:44:12,646 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:44:12,664 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:44:12,665 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:44:12,666 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:44:12,667 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:44:12,667 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:44:12,679 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:44:12,680 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:44:12,682 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:44:12,684 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:44:12,684 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:44:12,684 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:44:12,684 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:44:12,684 - INFO - Performing online update...
2025-06-03 11:44:12,685 - INFO - Starting online update for 50 steps.
2025-06-03 11:44:12,685 - DEBUG - Updated RunningStats: new_mean=0.5400728887184254, new_var=85800000000008.78, new_n=8610
2025-06-03 11:44:12,685 - DEBUG - Updated RunningStats: new_mean=0.5403978068046645, new_var=86100000000007.23, new_n=8640
2025-06-03 11:44:12,685 - DEBUG - Updated RunningStats: new_mean=0.7760745330896491, new_var=50680000000036.71, new_n=5090
2025-06-03 11:44:12,685 - DEBUG - Updated RunningStats: new_mean=0.7771648372767809, new_var=50900000000002.92, new_n=5112
2025-06-03 11:44:12,685 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:44:12,686 - DEBUG - Online update step: 1/50
2025-06-03 11:44:12,687 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:13,156 - DEBUG - Node anomaly scores shape: torch.Size([11792, 1])
2025-06-03 11:44:13,201 - DEBUG - Edge anomaly scores shape: torch.Size([24892, 1])
2025-06-03 11:44:13,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:13,971 - DEBUG - Step 1: Loss=0.5360
2025-06-03 11:44:13,971 - DEBUG - Online update step: 2/50
2025-06-03 11:44:13,973 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:14,350 - DEBUG - Node anomaly scores shape: torch.Size([10717, 1])
2025-06-03 11:44:14,388 - DEBUG - Edge anomaly scores shape: torch.Size([22461, 1])
2025-06-03 11:44:14,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:15,410 - DEBUG - Step 2: Loss=0.5357
2025-06-03 11:44:15,410 - DEBUG - Online update step: 3/50
2025-06-03 11:44:15,412 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:16,157 - DEBUG - Node anomaly scores shape: torch.Size([12056, 1])
2025-06-03 11:44:16,210 - DEBUG - Edge anomaly scores shape: torch.Size([25587, 1])
2025-06-03 11:44:16,212 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:17,225 - DEBUG - Step 3: Loss=0.5337
2025-06-03 11:44:17,225 - DEBUG - Online update step: 4/50
2025-06-03 11:44:17,228 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:17,822 - DEBUG - Node anomaly scores shape: torch.Size([11516, 1])
2025-06-03 11:44:17,877 - DEBUG - Edge anomaly scores shape: torch.Size([24356, 1])
2025-06-03 11:44:17,878 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:18,957 - DEBUG - Step 4: Loss=0.5378
2025-06-03 11:44:18,957 - DEBUG - Online update step: 5/50
2025-06-03 11:44:18,960 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:19,662 - DEBUG - Node anomaly scores shape: torch.Size([11754, 1])
2025-06-03 11:44:19,717 - DEBUG - Edge anomaly scores shape: torch.Size([24831, 1])
2025-06-03 11:44:19,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:20,785 - DEBUG - Step 5: Loss=0.5338
2025-06-03 11:44:20,785 - DEBUG - Online update step: 6/50
2025-06-03 11:44:20,788 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:21,380 - DEBUG - Node anomaly scores shape: torch.Size([10406, 1])
2025-06-03 11:44:21,440 - DEBUG - Edge anomaly scores shape: torch.Size([21735, 1])
2025-06-03 11:44:21,442 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:22,381 - DEBUG - Step 6: Loss=0.5359
2025-06-03 11:44:22,382 - DEBUG - Online update step: 7/50
2025-06-03 11:44:22,384 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:23,056 - DEBUG - Node anomaly scores shape: torch.Size([10398, 1])
2025-06-03 11:44:23,093 - DEBUG - Edge anomaly scores shape: torch.Size([21710, 1])
2025-06-03 11:44:23,095 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:23,930 - DEBUG - Step 7: Loss=0.5381
2025-06-03 11:44:23,931 - DEBUG - Online update step: 8/50
2025-06-03 11:44:23,935 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:24,566 - DEBUG - Node anomaly scores shape: torch.Size([11016, 1])
2025-06-03 11:44:24,610 - DEBUG - Edge anomaly scores shape: torch.Size([23095, 1])
2025-06-03 11:44:24,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:25,670 - DEBUG - Step 8: Loss=0.5428
2025-06-03 11:44:25,670 - DEBUG - Online update step: 9/50
2025-06-03 11:44:25,674 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:26,398 - DEBUG - Node anomaly scores shape: torch.Size([13149, 1])
2025-06-03 11:44:26,441 - DEBUG - Edge anomaly scores shape: torch.Size([28160, 1])
2025-06-03 11:44:26,442 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:27,465 - DEBUG - Step 9: Loss=0.5255
2025-06-03 11:44:27,465 - DEBUG - Online update step: 10/50
2025-06-03 11:44:27,467 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:28,066 - DEBUG - Node anomaly scores shape: torch.Size([12908, 1])
2025-06-03 11:44:28,108 - DEBUG - Edge anomaly scores shape: torch.Size([27586, 1])
2025-06-03 11:44:28,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:29,102 - DEBUG - Step 10: Loss=0.5300
2025-06-03 11:44:29,102 - DEBUG - Online update step: 11/50
2025-06-03 11:44:29,107 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:29,698 - DEBUG - Node anomaly scores shape: torch.Size([12015, 1])
2025-06-03 11:44:29,738 - DEBUG - Edge anomaly scores shape: torch.Size([25443, 1])
2025-06-03 11:44:29,739 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:30,559 - DEBUG - Step 11: Loss=0.5366
2025-06-03 11:44:30,560 - DEBUG - Online update step: 12/50
2025-06-03 11:44:30,561 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:30,977 - DEBUG - Node anomaly scores shape: torch.Size([11397, 1])
2025-06-03 11:44:31,016 - DEBUG - Edge anomaly scores shape: torch.Size([24136, 1])
2025-06-03 11:44:31,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:31,876 - DEBUG - Step 12: Loss=0.5422
2025-06-03 11:44:31,876 - DEBUG - Online update step: 13/50
2025-06-03 11:44:31,879 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:32,465 - DEBUG - Node anomaly scores shape: torch.Size([12962, 1])
2025-06-03 11:44:32,526 - DEBUG - Edge anomaly scores shape: torch.Size([27743, 1])
2025-06-03 11:44:32,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:33,281 - DEBUG - Step 13: Loss=0.5273
2025-06-03 11:44:33,281 - DEBUG - Online update step: 14/50
2025-06-03 11:44:33,283 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:33,858 - DEBUG - Node anomaly scores shape: torch.Size([11958, 1])
2025-06-03 11:44:33,900 - DEBUG - Edge anomaly scores shape: torch.Size([25326, 1])
2025-06-03 11:44:33,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:34,642 - DEBUG - Step 14: Loss=0.5261
2025-06-03 11:44:34,642 - DEBUG - Online update step: 15/50
2025-06-03 11:44:34,643 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:35,107 - DEBUG - Node anomaly scores shape: torch.Size([12212, 1])
2025-06-03 11:44:35,148 - DEBUG - Edge anomaly scores shape: torch.Size([25814, 1])
2025-06-03 11:44:35,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:35,945 - DEBUG - Step 15: Loss=0.5367
2025-06-03 11:44:35,946 - DEBUG - Online update step: 16/50
2025-06-03 11:44:35,948 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:36,371 - DEBUG - Node anomaly scores shape: torch.Size([11595, 1])
2025-06-03 11:44:36,411 - DEBUG - Edge anomaly scores shape: torch.Size([24520, 1])
2025-06-03 11:44:36,412 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:37,154 - DEBUG - Step 16: Loss=0.5384
2025-06-03 11:44:37,154 - DEBUG - Online update step: 17/50
2025-06-03 11:44:37,156 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:37,546 - DEBUG - Node anomaly scores shape: torch.Size([11000, 1])
2025-06-03 11:44:37,583 - DEBUG - Edge anomaly scores shape: torch.Size([23045, 1])
2025-06-03 11:44:37,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:38,379 - DEBUG - Step 17: Loss=0.5278
2025-06-03 11:44:38,379 - DEBUG - Online update step: 18/50
2025-06-03 11:44:38,383 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:38,981 - DEBUG - Node anomaly scores shape: torch.Size([12319, 1])
2025-06-03 11:44:39,017 - DEBUG - Edge anomaly scores shape: torch.Size([26315, 1])
2025-06-03 11:44:39,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:39,961 - DEBUG - Step 18: Loss=0.5469
2025-06-03 11:44:39,961 - DEBUG - Online update step: 19/50
2025-06-03 11:44:39,963 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:40,524 - DEBUG - Node anomaly scores shape: torch.Size([11913, 1])
2025-06-03 11:44:40,574 - DEBUG - Edge anomaly scores shape: torch.Size([25230, 1])
2025-06-03 11:44:40,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:41,491 - DEBUG - Step 19: Loss=0.5201
2025-06-03 11:44:41,491 - DEBUG - Online update step: 20/50
2025-06-03 11:44:41,494 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:42,102 - DEBUG - Node anomaly scores shape: torch.Size([11932, 1])
2025-06-03 11:44:42,143 - DEBUG - Edge anomaly scores shape: torch.Size([25197, 1])
2025-06-03 11:44:42,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:43,011 - DEBUG - Step 20: Loss=0.5456
2025-06-03 11:44:43,011 - DEBUG - Online update step: 21/50
2025-06-03 11:44:43,014 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:43,556 - DEBUG - Node anomaly scores shape: torch.Size([12093, 1])
2025-06-03 11:44:43,598 - DEBUG - Edge anomaly scores shape: torch.Size([25815, 1])
2025-06-03 11:44:43,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:44,520 - DEBUG - Step 21: Loss=0.5281
2025-06-03 11:44:44,520 - DEBUG - Online update step: 22/50
2025-06-03 11:44:44,523 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:45,023 - DEBUG - Node anomaly scores shape: torch.Size([12992, 1])
2025-06-03 11:44:45,067 - DEBUG - Edge anomaly scores shape: torch.Size([27797, 1])
2025-06-03 11:44:45,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:45,853 - DEBUG - Step 22: Loss=0.5381
2025-06-03 11:44:45,853 - DEBUG - Online update step: 23/50
2025-06-03 11:44:45,855 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:46,304 - DEBUG - Node anomaly scores shape: torch.Size([11987, 1])
2025-06-03 11:44:46,344 - DEBUG - Edge anomaly scores shape: torch.Size([25311, 1])
2025-06-03 11:44:46,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:47,086 - DEBUG - Step 23: Loss=0.5442
2025-06-03 11:44:47,087 - DEBUG - Online update step: 24/50
2025-06-03 11:44:47,090 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:47,491 - DEBUG - Node anomaly scores shape: torch.Size([11212, 1])
2025-06-03 11:44:47,530 - DEBUG - Edge anomaly scores shape: torch.Size([23524, 1])
2025-06-03 11:44:47,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:48,163 - DEBUG - Step 24: Loss=0.5417
2025-06-03 11:44:48,164 - DEBUG - Online update step: 25/50
2025-06-03 11:44:48,165 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:48,605 - DEBUG - Node anomaly scores shape: torch.Size([11925, 1])
2025-06-03 11:44:48,645 - DEBUG - Edge anomaly scores shape: torch.Size([25143, 1])
2025-06-03 11:44:48,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:49,433 - DEBUG - Step 25: Loss=0.5340
2025-06-03 11:44:49,433 - DEBUG - Online update step: 26/50
2025-06-03 11:44:49,438 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:49,953 - DEBUG - Node anomaly scores shape: torch.Size([11336, 1])
2025-06-03 11:44:49,994 - DEBUG - Edge anomaly scores shape: torch.Size([24017, 1])
2025-06-03 11:44:49,995 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:50,691 - DEBUG - Step 26: Loss=0.5413
2025-06-03 11:44:50,691 - DEBUG - Online update step: 27/50
2025-06-03 11:44:50,693 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:51,083 - DEBUG - Node anomaly scores shape: torch.Size([10385, 1])
2025-06-03 11:44:51,120 - DEBUG - Edge anomaly scores shape: torch.Size([21667, 1])
2025-06-03 11:44:51,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:51,813 - DEBUG - Step 27: Loss=0.5388
2025-06-03 11:44:51,813 - DEBUG - Online update step: 28/50
2025-06-03 11:44:51,815 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:52,301 - DEBUG - Node anomaly scores shape: torch.Size([12529, 1])
2025-06-03 11:44:52,343 - DEBUG - Edge anomaly scores shape: torch.Size([26580, 1])
2025-06-03 11:44:52,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:53,173 - DEBUG - Step 28: Loss=0.5372
2025-06-03 11:44:53,174 - DEBUG - Online update step: 29/50
2025-06-03 11:44:53,176 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:53,603 - DEBUG - Node anomaly scores shape: torch.Size([11588, 1])
2025-06-03 11:44:53,643 - DEBUG - Edge anomaly scores shape: torch.Size([24519, 1])
2025-06-03 11:44:53,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:54,385 - DEBUG - Step 29: Loss=0.5301
2025-06-03 11:44:54,385 - DEBUG - Online update step: 30/50
2025-06-03 11:44:54,387 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:54,836 - DEBUG - Node anomaly scores shape: torch.Size([11701, 1])
2025-06-03 11:44:54,876 - DEBUG - Edge anomaly scores shape: torch.Size([24816, 1])
2025-06-03 11:44:54,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:55,573 - DEBUG - Step 30: Loss=0.5267
2025-06-03 11:44:55,573 - DEBUG - Online update step: 31/50
2025-06-03 11:44:55,575 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:55,966 - DEBUG - Node anomaly scores shape: torch.Size([10527, 1])
2025-06-03 11:44:56,004 - DEBUG - Edge anomaly scores shape: torch.Size([22010, 1])
2025-06-03 11:44:56,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:56,730 - DEBUG - Step 31: Loss=0.5282
2025-06-03 11:44:56,730 - DEBUG - Online update step: 32/50
2025-06-03 11:44:56,732 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:57,305 - DEBUG - Node anomaly scores shape: torch.Size([12266, 1])
2025-06-03 11:44:57,347 - DEBUG - Edge anomaly scores shape: torch.Size([26226, 1])
2025-06-03 11:44:57,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:58,307 - DEBUG - Step 32: Loss=0.5394
2025-06-03 11:44:58,307 - DEBUG - Online update step: 33/50
2025-06-03 11:44:58,310 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:44:58,877 - DEBUG - Node anomaly scores shape: torch.Size([11645, 1])
2025-06-03 11:44:58,926 - DEBUG - Edge anomaly scores shape: torch.Size([24679, 1])
2025-06-03 11:44:58,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:44:59,864 - DEBUG - Step 33: Loss=0.5439
2025-06-03 11:44:59,864 - DEBUG - Online update step: 34/50
2025-06-03 11:44:59,868 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:00,438 - DEBUG - Node anomaly scores shape: torch.Size([11019, 1])
2025-06-03 11:45:00,475 - DEBUG - Edge anomaly scores shape: torch.Size([23191, 1])
2025-06-03 11:45:00,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:01,405 - DEBUG - Step 34: Loss=0.5280
2025-06-03 11:45:01,405 - DEBUG - Online update step: 35/50
2025-06-03 11:45:01,408 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:02,340 - DEBUG - Node anomaly scores shape: torch.Size([12651, 1])
2025-06-03 11:45:02,408 - DEBUG - Edge anomaly scores shape: torch.Size([27002, 1])
2025-06-03 11:45:02,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:03,620 - DEBUG - Step 35: Loss=0.5260
2025-06-03 11:45:03,621 - DEBUG - Online update step: 36/50
2025-06-03 11:45:03,627 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:04,290 - DEBUG - Node anomaly scores shape: torch.Size([12577, 1])
2025-06-03 11:45:04,334 - DEBUG - Edge anomaly scores shape: torch.Size([26874, 1])
2025-06-03 11:45:04,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:05,076 - DEBUG - Step 36: Loss=0.5261
2025-06-03 11:45:05,077 - DEBUG - Online update step: 37/50
2025-06-03 11:45:05,078 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:05,453 - DEBUG - Node anomaly scores shape: torch.Size([9788, 1])
2025-06-03 11:45:05,486 - DEBUG - Edge anomaly scores shape: torch.Size([20286, 1])
2025-06-03 11:45:05,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:06,102 - DEBUG - Step 37: Loss=0.5384
2025-06-03 11:45:06,102 - DEBUG - Online update step: 38/50
2025-06-03 11:45:06,105 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:06,460 - DEBUG - Node anomaly scores shape: torch.Size([10466, 1])
2025-06-03 11:45:06,494 - DEBUG - Edge anomaly scores shape: torch.Size([21915, 1])
2025-06-03 11:45:06,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:07,175 - DEBUG - Step 38: Loss=0.5337
2025-06-03 11:45:07,175 - DEBUG - Online update step: 39/50
2025-06-03 11:45:07,178 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:07,689 - DEBUG - Node anomaly scores shape: torch.Size([12057, 1])
2025-06-03 11:45:07,729 - DEBUG - Edge anomaly scores shape: torch.Size([25502, 1])
2025-06-03 11:45:07,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:08,529 - DEBUG - Step 39: Loss=0.5289
2025-06-03 11:45:08,529 - DEBUG - Online update step: 40/50
2025-06-03 11:45:08,532 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:09,001 - DEBUG - Node anomaly scores shape: torch.Size([12123, 1])
2025-06-03 11:45:09,043 - DEBUG - Edge anomaly scores shape: torch.Size([25790, 1])
2025-06-03 11:45:09,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:09,778 - DEBUG - Step 40: Loss=0.5407
2025-06-03 11:45:09,778 - DEBUG - Online update step: 41/50
2025-06-03 11:45:09,780 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:10,174 - DEBUG - Node anomaly scores shape: torch.Size([10969, 1])
2025-06-03 11:45:10,209 - DEBUG - Edge anomaly scores shape: torch.Size([23079, 1])
2025-06-03 11:45:10,209 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:10,922 - DEBUG - Step 41: Loss=0.5316
2025-06-03 11:45:10,922 - DEBUG - Online update step: 42/50
2025-06-03 11:45:10,925 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:11,425 - DEBUG - Node anomaly scores shape: torch.Size([11713, 1])
2025-06-03 11:45:11,464 - DEBUG - Edge anomaly scores shape: torch.Size([24760, 1])
2025-06-03 11:45:11,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:12,212 - DEBUG - Step 42: Loss=0.5277
2025-06-03 11:45:12,213 - DEBUG - Online update step: 43/50
2025-06-03 11:45:12,216 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:12,694 - DEBUG - Node anomaly scores shape: torch.Size([11564, 1])
2025-06-03 11:45:12,733 - DEBUG - Edge anomaly scores shape: torch.Size([24373, 1])
2025-06-03 11:45:12,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:13,414 - DEBUG - Step 43: Loss=0.5422
2025-06-03 11:45:13,414 - DEBUG - Online update step: 44/50
2025-06-03 11:45:13,416 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:14,027 - DEBUG - Node anomaly scores shape: torch.Size([12235, 1])
2025-06-03 11:45:14,100 - DEBUG - Edge anomaly scores shape: torch.Size([26058, 1])
2025-06-03 11:45:14,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:15,230 - DEBUG - Step 44: Loss=0.5241
2025-06-03 11:45:15,230 - DEBUG - Online update step: 45/50
2025-06-03 11:45:15,232 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:15,876 - DEBUG - Node anomaly scores shape: torch.Size([11727, 1])
2025-06-03 11:45:15,917 - DEBUG - Edge anomaly scores shape: torch.Size([24774, 1])
2025-06-03 11:45:15,918 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:16,826 - DEBUG - Step 45: Loss=0.5323
2025-06-03 11:45:16,826 - DEBUG - Online update step: 46/50
2025-06-03 11:45:16,828 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:17,291 - DEBUG - Node anomaly scores shape: torch.Size([10845, 1])
2025-06-03 11:45:17,330 - DEBUG - Edge anomaly scores shape: torch.Size([22699, 1])
2025-06-03 11:45:17,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:18,179 - DEBUG - Step 46: Loss=0.5299
2025-06-03 11:45:18,179 - DEBUG - Online update step: 47/50
2025-06-03 11:45:18,181 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:18,732 - DEBUG - Node anomaly scores shape: torch.Size([10854, 1])
2025-06-03 11:45:18,774 - DEBUG - Edge anomaly scores shape: torch.Size([22726, 1])
2025-06-03 11:45:18,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:19,681 - DEBUG - Step 47: Loss=0.5350
2025-06-03 11:45:19,682 - DEBUG - Online update step: 48/50
2025-06-03 11:45:19,684 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:20,238 - DEBUG - Node anomaly scores shape: torch.Size([11812, 1])
2025-06-03 11:45:20,288 - DEBUG - Edge anomaly scores shape: torch.Size([25096, 1])
2025-06-03 11:45:20,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:21,280 - DEBUG - Step 48: Loss=0.5265
2025-06-03 11:45:21,280 - DEBUG - Online update step: 49/50
2025-06-03 11:45:21,284 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:21,976 - DEBUG - Node anomaly scores shape: torch.Size([12336, 1])
2025-06-03 11:45:22,042 - DEBUG - Edge anomaly scores shape: torch.Size([26227, 1])
2025-06-03 11:45:22,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:23,509 - DEBUG - Step 49: Loss=0.5332
2025-06-03 11:45:23,510 - DEBUG - Online update step: 50/50
2025-06-03 11:45:23,513 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:24,420 - DEBUG - Node anomaly scores shape: torch.Size([11685, 1])
2025-06-03 11:45:24,472 - DEBUG - Edge anomaly scores shape: torch.Size([24529, 1])
2025-06-03 11:45:24,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:25,286 - DEBUG - Step 50: Loss=0.5350
2025-06-03 11:45:25,286 - INFO - Online update finished. Average loss: 0.5342, Learning rate: 0.000164
2025-06-03 11:45:25,287 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:45:25,287 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:45:25,288 - INFO - Online update complete. Loss: 0.5342
2025-06-03 11:45:25,288 - INFO - Running anomaly detection...
2025-06-03 11:45:25,288 - INFO - Starting anomaly detection.
2025-06-03 11:45:25,315 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114525_update_43.json
2025-06-03 11:45:25,315 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:45:25,335 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114525_update_43.pth and as latest_checkpoint.pth
2025-06-03 11:45:25,335 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.0000
2025-06-03 11:45:25,336 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:45:25,336 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.1073, MLP Score: 1.0000
2025-06-03 11:45:25,336 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.0511, MLP Score: 1.0000
2025-06-03 11:45:25,336 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2912, MLP Score: 1.0000
2025-06-03 11:45:25,336 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.9357, MLP Score: 1.0000
2025-06-03 11:45:25,336 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1971, MLP Score: 1.0000
2025-06-03 11:45:25,336 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:45:25,336 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5408, MLP Score: 0.9998
2025-06-03 11:45:25,336 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2622, MLP Score: 0.9996
2025-06-03 11:45:25,336 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.0368, MLP Score: 0.9999
2025-06-03 11:45:25,336 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4407, MLP Score: 0.9959
2025-06-03 11:45:25,337 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4846, MLP Score: 0.9975
2025-06-03 11:45:25,337 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-03 11:45:25,337 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-03 11:45:25,337 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot file.
2025-06-03 11:45:25,363 - INFO - Parsed 1003 nodes.
2025-06-03 11:45:25,384 - INFO - Parsed 2202 edges.
2025-06-03 11:45:26,105 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:45:26,105 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:45:26,124 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:45:26,126 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:45:26,126 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:45:26,128 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:45:26,128 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:45:26,139 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:45:26,140 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:45:26,142 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:45:26,144 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:45:26,145 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:45:26,145 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:45:26,145 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:45:26,145 - INFO - Performing online update...
2025-06-03 11:45:26,145 - INFO - Starting online update for 50 steps.
2025-06-03 11:45:26,146 - DEBUG - Updated RunningStats: new_mean=0.538527918200421, new_var=86400000000008.73, new_n=8670
2025-06-03 11:45:26,146 - DEBUG - Updated RunningStats: new_mean=0.5388559229568171, new_var=86700000000007.23, new_n=8700
2025-06-03 11:45:26,146 - DEBUG - Updated RunningStats: new_mean=0.7752221710485727, new_var=51120000000036.695, new_n=5134
2025-06-03 11:45:26,146 - DEBUG - Updated RunningStats: new_mean=0.7763068077765636, new_var=51340000000002.93, new_n=5156
2025-06-03 11:45:26,146 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:45:26,146 - DEBUG - Online update step: 1/50
2025-06-03 11:45:26,148 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:26,757 - DEBUG - Node anomaly scores shape: torch.Size([13070, 1])
2025-06-03 11:45:26,800 - DEBUG - Edge anomaly scores shape: torch.Size([28000, 1])
2025-06-03 11:45:26,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:27,718 - DEBUG - Step 1: Loss=0.5373
2025-06-03 11:45:27,719 - DEBUG - Online update step: 2/50
2025-06-03 11:45:27,720 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:28,218 - DEBUG - Node anomaly scores shape: torch.Size([12128, 1])
2025-06-03 11:45:28,260 - DEBUG - Edge anomaly scores shape: torch.Size([25803, 1])
2025-06-03 11:45:28,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:29,018 - DEBUG - Step 2: Loss=0.5444
2025-06-03 11:45:29,019 - DEBUG - Online update step: 3/50
2025-06-03 11:45:29,021 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:29,472 - DEBUG - Node anomaly scores shape: torch.Size([10889, 1])
2025-06-03 11:45:29,510 - DEBUG - Edge anomaly scores shape: torch.Size([22929, 1])
2025-06-03 11:45:29,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:30,380 - DEBUG - Step 3: Loss=0.5417
2025-06-03 11:45:30,380 - DEBUG - Online update step: 4/50
2025-06-03 11:45:30,383 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:30,877 - DEBUG - Node anomaly scores shape: torch.Size([11491, 1])
2025-06-03 11:45:30,920 - DEBUG - Edge anomaly scores shape: torch.Size([24259, 1])
2025-06-03 11:45:30,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:31,752 - DEBUG - Step 4: Loss=0.5352
2025-06-03 11:45:31,752 - DEBUG - Online update step: 5/50
2025-06-03 11:45:31,755 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:32,433 - DEBUG - Node anomaly scores shape: torch.Size([11988, 1])
2025-06-03 11:45:32,477 - DEBUG - Edge anomaly scores shape: torch.Size([25454, 1])
2025-06-03 11:45:32,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:33,377 - DEBUG - Step 5: Loss=0.5336
2025-06-03 11:45:33,377 - DEBUG - Online update step: 6/50
2025-06-03 11:45:33,379 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:33,878 - DEBUG - Node anomaly scores shape: torch.Size([12137, 1])
2025-06-03 11:45:33,918 - DEBUG - Edge anomaly scores shape: torch.Size([25816, 1])
2025-06-03 11:45:33,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:34,792 - DEBUG - Step 6: Loss=0.5311
2025-06-03 11:45:34,792 - DEBUG - Online update step: 7/50
2025-06-03 11:45:34,798 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:35,338 - DEBUG - Node anomaly scores shape: torch.Size([12261, 1])
2025-06-03 11:45:35,402 - DEBUG - Edge anomaly scores shape: torch.Size([26092, 1])
2025-06-03 11:45:35,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:37,985 - DEBUG - Step 7: Loss=0.5361
2025-06-03 11:45:37,986 - DEBUG - Online update step: 8/50
2025-06-03 11:45:38,074 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:40,664 - DEBUG - Node anomaly scores shape: torch.Size([12051, 1])
2025-06-03 11:45:40,821 - DEBUG - Edge anomaly scores shape: torch.Size([25482, 1])
2025-06-03 11:45:40,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:45,091 - DEBUG - Step 8: Loss=0.5394
2025-06-03 11:45:45,091 - DEBUG - Online update step: 9/50
2025-06-03 11:45:45,094 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:47,219 - DEBUG - Node anomaly scores shape: torch.Size([11332, 1])
2025-06-03 11:45:47,335 - DEBUG - Edge anomaly scores shape: torch.Size([23886, 1])
2025-06-03 11:45:47,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:48,916 - DEBUG - Step 9: Loss=0.5431
2025-06-03 11:45:48,917 - DEBUG - Online update step: 10/50
2025-06-03 11:45:48,920 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:49,569 - DEBUG - Node anomaly scores shape: torch.Size([11856, 1])
2025-06-03 11:45:49,622 - DEBUG - Edge anomaly scores shape: torch.Size([25065, 1])
2025-06-03 11:45:49,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:50,570 - DEBUG - Step 10: Loss=0.5360
2025-06-03 11:45:50,570 - DEBUG - Online update step: 11/50
2025-06-03 11:45:50,573 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:51,312 - DEBUG - Node anomaly scores shape: torch.Size([12459, 1])
2025-06-03 11:45:51,377 - DEBUG - Edge anomaly scores shape: torch.Size([26599, 1])
2025-06-03 11:45:51,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:52,727 - DEBUG - Step 11: Loss=0.5325
2025-06-03 11:45:52,727 - DEBUG - Online update step: 12/50
2025-06-03 11:45:52,731 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:53,483 - DEBUG - Node anomaly scores shape: torch.Size([12393, 1])
2025-06-03 11:45:53,574 - DEBUG - Edge anomaly scores shape: torch.Size([26440, 1])
2025-06-03 11:45:53,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:54,959 - DEBUG - Step 12: Loss=0.5364
2025-06-03 11:45:54,959 - DEBUG - Online update step: 13/50
2025-06-03 11:45:54,962 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:55,680 - DEBUG - Node anomaly scores shape: torch.Size([12477, 1])
2025-06-03 11:45:55,735 - DEBUG - Edge anomaly scores shape: torch.Size([26564, 1])
2025-06-03 11:45:55,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:56,847 - DEBUG - Step 13: Loss=0.5346
2025-06-03 11:45:56,848 - DEBUG - Online update step: 14/50
2025-06-03 11:45:56,850 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:57,393 - DEBUG - Node anomaly scores shape: torch.Size([10959, 1])
2025-06-03 11:45:57,441 - DEBUG - Edge anomaly scores shape: torch.Size([22961, 1])
2025-06-03 11:45:57,445 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:58,425 - DEBUG - Step 14: Loss=0.5304
2025-06-03 11:45:58,425 - DEBUG - Online update step: 15/50
2025-06-03 11:45:58,429 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:45:58,953 - DEBUG - Node anomaly scores shape: torch.Size([11006, 1])
2025-06-03 11:45:58,999 - DEBUG - Edge anomaly scores shape: torch.Size([23112, 1])
2025-06-03 11:45:59,001 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:45:59,997 - DEBUG - Step 15: Loss=0.5309
2025-06-03 11:45:59,997 - DEBUG - Online update step: 16/50
2025-06-03 11:46:00,003 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:00,692 - DEBUG - Node anomaly scores shape: torch.Size([12575, 1])
2025-06-03 11:46:00,744 - DEBUG - Edge anomaly scores shape: torch.Size([26928, 1])
2025-06-03 11:46:00,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:01,959 - DEBUG - Step 16: Loss=0.5329
2025-06-03 11:46:01,960 - DEBUG - Online update step: 17/50
2025-06-03 11:46:01,969 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:02,603 - DEBUG - Node anomaly scores shape: torch.Size([11185, 1])
2025-06-03 11:46:02,650 - DEBUG - Edge anomaly scores shape: torch.Size([23580, 1])
2025-06-03 11:46:02,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:03,783 - DEBUG - Step 17: Loss=0.5331
2025-06-03 11:46:03,783 - DEBUG - Online update step: 18/50
2025-06-03 11:46:03,786 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:04,423 - DEBUG - Node anomaly scores shape: torch.Size([12784, 1])
2025-06-03 11:46:04,471 - DEBUG - Edge anomaly scores shape: torch.Size([27252, 1])
2025-06-03 11:46:04,473 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:05,390 - DEBUG - Step 18: Loss=0.5398
2025-06-03 11:46:05,390 - DEBUG - Online update step: 19/50
2025-06-03 11:46:05,392 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:05,806 - DEBUG - Node anomaly scores shape: torch.Size([10664, 1])
2025-06-03 11:46:05,843 - DEBUG - Edge anomaly scores shape: torch.Size([22308, 1])
2025-06-03 11:46:05,844 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:06,618 - DEBUG - Step 19: Loss=0.5263
2025-06-03 11:46:06,619 - DEBUG - Online update step: 20/50
2025-06-03 11:46:06,621 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:07,078 - DEBUG - Node anomaly scores shape: torch.Size([11670, 1])
2025-06-03 11:46:07,114 - DEBUG - Edge anomaly scores shape: torch.Size([24693, 1])
2025-06-03 11:46:07,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:07,839 - DEBUG - Step 20: Loss=0.5255
2025-06-03 11:46:07,839 - DEBUG - Online update step: 21/50
2025-06-03 11:46:07,841 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:08,317 - DEBUG - Node anomaly scores shape: torch.Size([11628, 1])
2025-06-03 11:46:08,353 - DEBUG - Edge anomaly scores shape: torch.Size([24589, 1])
2025-06-03 11:46:08,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:09,159 - DEBUG - Step 21: Loss=0.5297
2025-06-03 11:46:09,159 - DEBUG - Online update step: 22/50
2025-06-03 11:46:09,161 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:09,564 - DEBUG - Node anomaly scores shape: torch.Size([10971, 1])
2025-06-03 11:46:09,602 - DEBUG - Edge anomaly scores shape: torch.Size([23118, 1])
2025-06-03 11:46:09,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:10,321 - DEBUG - Step 22: Loss=0.5304
2025-06-03 11:46:10,321 - DEBUG - Online update step: 23/50
2025-06-03 11:46:10,323 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:10,877 - DEBUG - Node anomaly scores shape: torch.Size([12680, 1])
2025-06-03 11:46:10,930 - DEBUG - Edge anomaly scores shape: torch.Size([27030, 1])
2025-06-03 11:46:10,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:11,905 - DEBUG - Step 23: Loss=0.5358
2025-06-03 11:46:11,906 - DEBUG - Online update step: 24/50
2025-06-03 11:46:11,911 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:12,852 - DEBUG - Node anomaly scores shape: torch.Size([12250, 1])
2025-06-03 11:46:12,896 - DEBUG - Edge anomaly scores shape: torch.Size([26093, 1])
2025-06-03 11:46:12,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:13,729 - DEBUG - Step 24: Loss=0.5348
2025-06-03 11:46:13,730 - DEBUG - Online update step: 25/50
2025-06-03 11:46:13,737 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:14,545 - DEBUG - Node anomaly scores shape: torch.Size([12270, 1])
2025-06-03 11:46:14,593 - DEBUG - Edge anomaly scores shape: torch.Size([26132, 1])
2025-06-03 11:46:14,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:16,098 - DEBUG - Step 25: Loss=0.5394
2025-06-03 11:46:16,099 - DEBUG - Online update step: 26/50
2025-06-03 11:46:16,168 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:16,798 - DEBUG - Node anomaly scores shape: torch.Size([10633, 1])
2025-06-03 11:46:16,835 - DEBUG - Edge anomaly scores shape: torch.Size([22376, 1])
2025-06-03 11:46:16,835 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:17,508 - DEBUG - Step 26: Loss=0.5379
2025-06-03 11:46:17,509 - DEBUG - Online update step: 27/50
2025-06-03 11:46:17,513 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:18,261 - DEBUG - Node anomaly scores shape: torch.Size([11849, 1])
2025-06-03 11:46:18,296 - DEBUG - Edge anomaly scores shape: torch.Size([25048, 1])
2025-06-03 11:46:18,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:19,651 - DEBUG - Step 27: Loss=0.5337
2025-06-03 11:46:19,651 - DEBUG - Online update step: 28/50
2025-06-03 11:46:19,659 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:20,375 - DEBUG - Node anomaly scores shape: torch.Size([11218, 1])
2025-06-03 11:46:20,426 - DEBUG - Edge anomaly scores shape: torch.Size([23609, 1])
2025-06-03 11:46:20,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:21,234 - DEBUG - Step 28: Loss=0.5287
2025-06-03 11:46:21,235 - DEBUG - Online update step: 29/50
2025-06-03 11:46:21,238 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:22,391 - DEBUG - Node anomaly scores shape: torch.Size([12925, 1])
2025-06-03 11:46:22,660 - DEBUG - Edge anomaly scores shape: torch.Size([27617, 1])
2025-06-03 11:46:22,713 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:27,967 - DEBUG - Step 29: Loss=0.5415
2025-06-03 11:46:27,968 - DEBUG - Online update step: 30/50
2025-06-03 11:46:28,086 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:30,562 - DEBUG - Node anomaly scores shape: torch.Size([12232, 1])
2025-06-03 11:46:30,670 - DEBUG - Edge anomaly scores shape: torch.Size([26056, 1])
2025-06-03 11:46:30,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:31,973 - DEBUG - Step 30: Loss=0.5294
2025-06-03 11:46:31,974 - DEBUG - Online update step: 31/50
2025-06-03 11:46:31,977 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:32,668 - DEBUG - Node anomaly scores shape: torch.Size([12830, 1])
2025-06-03 11:46:32,721 - DEBUG - Edge anomaly scores shape: torch.Size([27434, 1])
2025-06-03 11:46:32,722 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:33,737 - DEBUG - Step 31: Loss=0.5379
2025-06-03 11:46:33,737 - DEBUG - Online update step: 32/50
2025-06-03 11:46:33,739 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:34,296 - DEBUG - Node anomaly scores shape: torch.Size([11779, 1])
2025-06-03 11:46:34,342 - DEBUG - Edge anomaly scores shape: torch.Size([24983, 1])
2025-06-03 11:46:34,343 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:35,350 - DEBUG - Step 32: Loss=0.5347
2025-06-03 11:46:35,350 - DEBUG - Online update step: 33/50
2025-06-03 11:46:35,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:35,883 - DEBUG - Node anomaly scores shape: torch.Size([12028, 1])
2025-06-03 11:46:35,928 - DEBUG - Edge anomaly scores shape: torch.Size([25441, 1])
2025-06-03 11:46:35,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:37,007 - DEBUG - Step 33: Loss=0.5348
2025-06-03 11:46:37,008 - DEBUG - Online update step: 34/50
2025-06-03 11:46:37,010 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:37,537 - DEBUG - Node anomaly scores shape: torch.Size([12094, 1])
2025-06-03 11:46:37,574 - DEBUG - Edge anomaly scores shape: torch.Size([25693, 1])
2025-06-03 11:46:37,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:38,382 - DEBUG - Step 34: Loss=0.5288
2025-06-03 11:46:38,382 - DEBUG - Online update step: 35/50
2025-06-03 11:46:38,385 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:38,811 - DEBUG - Node anomaly scores shape: torch.Size([11837, 1])
2025-06-03 11:46:38,847 - DEBUG - Edge anomaly scores shape: torch.Size([25075, 1])
2025-06-03 11:46:38,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:39,539 - DEBUG - Step 35: Loss=0.5340
2025-06-03 11:46:39,539 - DEBUG - Online update step: 36/50
2025-06-03 11:46:39,542 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:40,000 - DEBUG - Node anomaly scores shape: torch.Size([12779, 1])
2025-06-03 11:46:40,043 - DEBUG - Edge anomaly scores shape: torch.Size([27332, 1])
2025-06-03 11:46:40,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:40,777 - DEBUG - Step 36: Loss=0.5211
2025-06-03 11:46:40,777 - DEBUG - Online update step: 37/50
2025-06-03 11:46:40,780 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:41,196 - DEBUG - Node anomaly scores shape: torch.Size([11747, 1])
2025-06-03 11:46:41,232 - DEBUG - Edge anomaly scores shape: torch.Size([24824, 1])
2025-06-03 11:46:41,233 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:41,902 - DEBUG - Step 37: Loss=0.5326
2025-06-03 11:46:41,902 - DEBUG - Online update step: 38/50
2025-06-03 11:46:41,904 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:42,335 - DEBUG - Node anomaly scores shape: torch.Size([12843, 1])
2025-06-03 11:46:42,375 - DEBUG - Edge anomaly scores shape: torch.Size([27466, 1])
2025-06-03 11:46:42,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:43,091 - DEBUG - Step 38: Loss=0.5270
2025-06-03 11:46:43,091 - DEBUG - Online update step: 39/50
2025-06-03 11:46:43,093 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:43,738 - DEBUG - Node anomaly scores shape: torch.Size([12788, 1])
2025-06-03 11:46:43,779 - DEBUG - Edge anomaly scores shape: torch.Size([27227, 1])
2025-06-03 11:46:43,780 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:44,607 - DEBUG - Step 39: Loss=0.5390
2025-06-03 11:46:44,607 - DEBUG - Online update step: 40/50
2025-06-03 11:46:44,610 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:45,024 - DEBUG - Node anomaly scores shape: torch.Size([12123, 1])
2025-06-03 11:46:45,062 - DEBUG - Edge anomaly scores shape: torch.Size([25610, 1])
2025-06-03 11:46:45,063 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:45,795 - DEBUG - Step 40: Loss=0.5333
2025-06-03 11:46:45,795 - DEBUG - Online update step: 41/50
2025-06-03 11:46:45,797 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:46,181 - DEBUG - Node anomaly scores shape: torch.Size([11484, 1])
2025-06-03 11:46:46,219 - DEBUG - Edge anomaly scores shape: torch.Size([24335, 1])
2025-06-03 11:46:46,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:46,980 - DEBUG - Step 41: Loss=0.5407
2025-06-03 11:46:46,980 - DEBUG - Online update step: 42/50
2025-06-03 11:46:46,981 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:47,321 - DEBUG - Node anomaly scores shape: torch.Size([9922, 1])
2025-06-03 11:46:47,352 - DEBUG - Edge anomaly scores shape: torch.Size([20666, 1])
2025-06-03 11:46:47,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:47,982 - DEBUG - Step 42: Loss=0.5393
2025-06-03 11:46:47,982 - DEBUG - Online update step: 43/50
2025-06-03 11:46:47,984 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:48,440 - DEBUG - Node anomaly scores shape: torch.Size([12465, 1])
2025-06-03 11:46:48,481 - DEBUG - Edge anomaly scores shape: torch.Size([26600, 1])
2025-06-03 11:46:48,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:49,494 - DEBUG - Step 43: Loss=0.5260
2025-06-03 11:46:49,494 - DEBUG - Online update step: 44/50
2025-06-03 11:46:49,497 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:49,933 - DEBUG - Node anomaly scores shape: torch.Size([11700, 1])
2025-06-03 11:46:49,970 - DEBUG - Edge anomaly scores shape: torch.Size([24824, 1])
2025-06-03 11:46:49,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:50,749 - DEBUG - Step 44: Loss=0.5300
2025-06-03 11:46:50,749 - DEBUG - Online update step: 45/50
2025-06-03 11:46:50,751 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:51,196 - DEBUG - Node anomaly scores shape: torch.Size([11945, 1])
2025-06-03 11:46:51,235 - DEBUG - Edge anomaly scores shape: torch.Size([25409, 1])
2025-06-03 11:46:51,236 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:52,029 - DEBUG - Step 45: Loss=0.5394
2025-06-03 11:46:52,029 - DEBUG - Online update step: 46/50
2025-06-03 11:46:52,031 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:52,472 - DEBUG - Node anomaly scores shape: torch.Size([11616, 1])
2025-06-03 11:46:52,509 - DEBUG - Edge anomaly scores shape: torch.Size([24468, 1])
2025-06-03 11:46:52,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:53,220 - DEBUG - Step 46: Loss=0.5351
2025-06-03 11:46:53,220 - DEBUG - Online update step: 47/50
2025-06-03 11:46:53,223 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:53,632 - DEBUG - Node anomaly scores shape: torch.Size([11398, 1])
2025-06-03 11:46:53,669 - DEBUG - Edge anomaly scores shape: torch.Size([23991, 1])
2025-06-03 11:46:53,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:54,476 - DEBUG - Step 47: Loss=0.5409
2025-06-03 11:46:54,477 - DEBUG - Online update step: 48/50
2025-06-03 11:46:54,479 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:54,977 - DEBUG - Node anomaly scores shape: torch.Size([11888, 1])
2025-06-03 11:46:55,025 - DEBUG - Edge anomaly scores shape: torch.Size([25187, 1])
2025-06-03 11:46:55,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:55,843 - DEBUG - Step 48: Loss=0.5241
2025-06-03 11:46:55,843 - DEBUG - Online update step: 49/50
2025-06-03 11:46:55,845 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:56,240 - DEBUG - Node anomaly scores shape: torch.Size([10201, 1])
2025-06-03 11:46:56,278 - DEBUG - Edge anomaly scores shape: torch.Size([21329, 1])
2025-06-03 11:46:56,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:56,946 - DEBUG - Step 49: Loss=0.5361
2025-06-03 11:46:56,947 - DEBUG - Online update step: 50/50
2025-06-03 11:46:56,950 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:57,522 - DEBUG - Node anomaly scores shape: torch.Size([12339, 1])
2025-06-03 11:46:57,569 - DEBUG - Edge anomaly scores shape: torch.Size([26312, 1])
2025-06-03 11:46:57,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:46:58,496 - DEBUG - Step 50: Loss=0.5313
2025-06-03 11:46:58,497 - INFO - Online update finished. Average loss: 0.5342, Learning rate: 0.000074
2025-06-03 11:46:58,498 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:46:58,498 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:46:58,524 - INFO - Online update complete. Loss: 0.5342
2025-06-03 11:46:58,524 - INFO - Running anomaly detection...
2025-06-03 11:46:58,524 - INFO - Starting anomaly detection.
2025-06-03 11:46:58,542 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114658_update_44.json
2025-06-03 11:46:58,543 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:46:58,568 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114658_update_44.pth and as latest_checkpoint.pth
2025-06-03 11:46:58,569 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.0000
2025-06-03 11:46:58,569 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:46:58,569 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.0685, MLP Score: 1.0000
2025-06-03 11:46:58,569 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.0056, MLP Score: 1.0000
2025-06-03 11:46:58,569 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2371, MLP Score: 1.0000
2025-06-03 11:46:58,569 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.7851, MLP Score: 1.0000
2025-06-03 11:46:58,569 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.2034, MLP Score: 1.0000
2025-06-03 11:46:58,569 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:46:58,569 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5341, MLP Score: 0.9992
2025-06-03 11:46:58,569 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2545, MLP Score: 0.9994
2025-06-03 11:46:58,569 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.0371, MLP Score: 0.9998
2025-06-03 11:46:58,569 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4535, MLP Score: 0.9962
2025-06-03 11:46:58,569 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4900, MLP Score: 0.9971
2025-06-03 11:46:58,569 - INFO - 
--- Processing file: nw_graph_encoded_1748870685.dot (Timestamp: 2025-06-02 15:24:45) ---
2025-06-03 11:46:58,570 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-03 11:46:58,570 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot file.
2025-06-03 11:46:58,598 - INFO - Parsed 1003 nodes.
2025-06-03 11:46:58,625 - INFO - Parsed 2202 edges.
2025-06-03 11:46:59,348 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:46:59,348 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:46:59,365 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:46:59,366 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:46:59,367 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:46:59,368 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:46:59,368 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:46:59,378 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:46:59,380 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:46:59,381 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:46:59,383 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:46:59,387 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:46:59,395 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:46:59,395 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:46:59,395 - INFO - Performing online update...
2025-06-03 11:46:59,395 - INFO - Starting online update for 50 steps.
2025-06-03 11:46:59,396 - DEBUG - Updated RunningStats: new_mean=0.5370041843873004, new_var=87000000000008.69, new_n=8730
2025-06-03 11:46:59,396 - DEBUG - Updated RunningStats: new_mean=0.5373351608022592, new_var=87300000000007.25, new_n=8760
2025-06-03 11:46:59,397 - DEBUG - Updated RunningStats: new_mean=0.7743842948815243, new_var=51560000000036.68, new_n=5178
2025-06-03 11:46:59,397 - DEBUG - Updated RunningStats: new_mean=0.7754632987748312, new_var=51780000000002.94, new_n=5200
2025-06-03 11:46:59,397 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:46:59,397 - DEBUG - Online update step: 1/50
2025-06-03 11:46:59,399 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:46:59,929 - DEBUG - Node anomaly scores shape: torch.Size([11395, 1])
2025-06-03 11:46:59,976 - DEBUG - Edge anomaly scores shape: torch.Size([24125, 1])
2025-06-03 11:46:59,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:00,905 - DEBUG - Step 1: Loss=0.5425
2025-06-03 11:47:00,905 - DEBUG - Online update step: 2/50
2025-06-03 11:47:00,908 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:01,362 - DEBUG - Node anomaly scores shape: torch.Size([10258, 1])
2025-06-03 11:47:01,402 - DEBUG - Edge anomaly scores shape: torch.Size([21420, 1])
2025-06-03 11:47:01,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:02,191 - DEBUG - Step 2: Loss=0.5322
2025-06-03 11:47:02,191 - DEBUG - Online update step: 3/50
2025-06-03 11:47:02,194 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:02,804 - DEBUG - Node anomaly scores shape: torch.Size([13398, 1])
2025-06-03 11:47:02,854 - DEBUG - Edge anomaly scores shape: torch.Size([28727, 1])
2025-06-03 11:47:02,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:03,884 - DEBUG - Step 3: Loss=0.5374
2025-06-03 11:47:03,884 - DEBUG - Online update step: 4/50
2025-06-03 11:47:03,887 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:04,387 - DEBUG - Node anomaly scores shape: torch.Size([11420, 1])
2025-06-03 11:47:04,430 - DEBUG - Edge anomaly scores shape: torch.Size([24110, 1])
2025-06-03 11:47:04,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:05,269 - DEBUG - Step 4: Loss=0.5415
2025-06-03 11:47:05,269 - DEBUG - Online update step: 5/50
2025-06-03 11:47:05,271 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:05,698 - DEBUG - Node anomaly scores shape: torch.Size([11583, 1])
2025-06-03 11:47:05,734 - DEBUG - Edge anomaly scores shape: torch.Size([24494, 1])
2025-06-03 11:47:05,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:06,437 - DEBUG - Step 5: Loss=0.5321
2025-06-03 11:47:06,438 - DEBUG - Online update step: 6/50
2025-06-03 11:47:06,440 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:06,894 - DEBUG - Node anomaly scores shape: torch.Size([12124, 1])
2025-06-03 11:47:06,929 - DEBUG - Edge anomaly scores shape: torch.Size([25765, 1])
2025-06-03 11:47:06,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:07,662 - DEBUG - Step 6: Loss=0.5377
2025-06-03 11:47:07,662 - DEBUG - Online update step: 7/50
2025-06-03 11:47:07,665 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:08,121 - DEBUG - Node anomaly scores shape: torch.Size([12938, 1])
2025-06-03 11:47:08,159 - DEBUG - Edge anomaly scores shape: torch.Size([27687, 1])
2025-06-03 11:47:08,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:08,944 - DEBUG - Step 7: Loss=0.5280
2025-06-03 11:47:08,944 - DEBUG - Online update step: 8/50
2025-06-03 11:47:08,947 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:09,384 - DEBUG - Node anomaly scores shape: torch.Size([12467, 1])
2025-06-03 11:47:09,420 - DEBUG - Edge anomaly scores shape: torch.Size([26704, 1])
2025-06-03 11:47:09,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:10,150 - DEBUG - Step 8: Loss=0.5094
2025-06-03 11:47:10,150 - DEBUG - Online update step: 9/50
2025-06-03 11:47:10,153 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:10,713 - DEBUG - Node anomaly scores shape: torch.Size([12325, 1])
2025-06-03 11:47:10,753 - DEBUG - Edge anomaly scores shape: torch.Size([26306, 1])
2025-06-03 11:47:10,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:11,880 - DEBUG - Step 9: Loss=0.5398
2025-06-03 11:47:11,880 - DEBUG - Online update step: 10/50
2025-06-03 11:47:11,897 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:12,573 - DEBUG - Node anomaly scores shape: torch.Size([13414, 1])
2025-06-03 11:47:12,615 - DEBUG - Edge anomaly scores shape: torch.Size([28831, 1])
2025-06-03 11:47:12,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:13,429 - DEBUG - Step 10: Loss=0.5202
2025-06-03 11:47:13,429 - DEBUG - Online update step: 11/50
2025-06-03 11:47:13,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:13,917 - DEBUG - Node anomaly scores shape: torch.Size([12039, 1])
2025-06-03 11:47:13,955 - DEBUG - Edge anomaly scores shape: torch.Size([25631, 1])
2025-06-03 11:47:13,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:14,674 - DEBUG - Step 11: Loss=0.5293
2025-06-03 11:47:14,674 - DEBUG - Online update step: 12/50
2025-06-03 11:47:14,676 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:15,278 - DEBUG - Node anomaly scores shape: torch.Size([11902, 1])
2025-06-03 11:47:15,353 - DEBUG - Edge anomaly scores shape: torch.Size([25211, 1])
2025-06-03 11:47:15,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:16,612 - DEBUG - Step 12: Loss=0.5424
2025-06-03 11:47:16,613 - DEBUG - Online update step: 13/50
2025-06-03 11:47:16,621 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:17,336 - DEBUG - Node anomaly scores shape: torch.Size([11300, 1])
2025-06-03 11:47:17,382 - DEBUG - Edge anomaly scores shape: torch.Size([23917, 1])
2025-06-03 11:47:17,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:18,485 - DEBUG - Step 13: Loss=0.5301
2025-06-03 11:47:18,485 - DEBUG - Online update step: 14/50
2025-06-03 11:47:18,489 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:19,217 - DEBUG - Node anomaly scores shape: torch.Size([11736, 1])
2025-06-03 11:47:19,285 - DEBUG - Edge anomaly scores shape: torch.Size([24939, 1])
2025-06-03 11:47:19,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:20,553 - DEBUG - Step 14: Loss=0.5328
2025-06-03 11:47:20,554 - DEBUG - Online update step: 15/50
2025-06-03 11:47:20,557 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:21,246 - DEBUG - Node anomaly scores shape: torch.Size([11461, 1])
2025-06-03 11:47:21,310 - DEBUG - Edge anomaly scores shape: torch.Size([24094, 1])
2025-06-03 11:47:21,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:22,636 - DEBUG - Step 15: Loss=0.5329
2025-06-03 11:47:22,637 - DEBUG - Online update step: 16/50
2025-06-03 11:47:22,642 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:23,466 - DEBUG - Node anomaly scores shape: torch.Size([11574, 1])
2025-06-03 11:47:23,567 - DEBUG - Edge anomaly scores shape: torch.Size([24348, 1])
2025-06-03 11:47:23,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:25,072 - DEBUG - Step 16: Loss=0.5403
2025-06-03 11:47:25,072 - DEBUG - Online update step: 17/50
2025-06-03 11:47:25,078 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:26,052 - DEBUG - Node anomaly scores shape: torch.Size([12823, 1])
2025-06-03 11:47:26,207 - DEBUG - Edge anomaly scores shape: torch.Size([27401, 1])
2025-06-03 11:47:26,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:27,862 - DEBUG - Step 17: Loss=0.5309
2025-06-03 11:47:27,862 - DEBUG - Online update step: 18/50
2025-06-03 11:47:27,865 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:28,872 - DEBUG - Node anomaly scores shape: torch.Size([12982, 1])
2025-06-03 11:47:28,957 - DEBUG - Edge anomaly scores shape: torch.Size([27746, 1])
2025-06-03 11:47:28,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:30,355 - DEBUG - Step 18: Loss=0.5213
2025-06-03 11:47:30,356 - DEBUG - Online update step: 19/50
2025-06-03 11:47:30,359 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:31,014 - DEBUG - Node anomaly scores shape: torch.Size([12116, 1])
2025-06-03 11:47:31,067 - DEBUG - Edge anomaly scores shape: torch.Size([25896, 1])
2025-06-03 11:47:31,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:32,066 - DEBUG - Step 19: Loss=0.5311
2025-06-03 11:47:32,066 - DEBUG - Online update step: 20/50
2025-06-03 11:47:32,070 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:32,610 - DEBUG - Node anomaly scores shape: torch.Size([11941, 1])
2025-06-03 11:47:32,651 - DEBUG - Edge anomaly scores shape: torch.Size([25176, 1])
2025-06-03 11:47:32,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:33,603 - DEBUG - Step 20: Loss=0.5369
2025-06-03 11:47:33,603 - DEBUG - Online update step: 21/50
2025-06-03 11:47:33,607 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:34,190 - DEBUG - Node anomaly scores shape: torch.Size([12154, 1])
2025-06-03 11:47:34,229 - DEBUG - Edge anomaly scores shape: torch.Size([25890, 1])
2025-06-03 11:47:34,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:34,874 - DEBUG - Step 21: Loss=0.5288
2025-06-03 11:47:34,875 - DEBUG - Online update step: 22/50
2025-06-03 11:47:34,878 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:35,358 - DEBUG - Node anomaly scores shape: torch.Size([11349, 1])
2025-06-03 11:47:35,392 - DEBUG - Edge anomaly scores shape: torch.Size([23960, 1])
2025-06-03 11:47:35,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:36,216 - DEBUG - Step 22: Loss=0.5434
2025-06-03 11:47:36,216 - DEBUG - Online update step: 23/50
2025-06-03 11:47:36,218 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:36,593 - DEBUG - Node anomaly scores shape: torch.Size([11004, 1])
2025-06-03 11:47:36,624 - DEBUG - Edge anomaly scores shape: torch.Size([23214, 1])
2025-06-03 11:47:36,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:37,522 - DEBUG - Step 23: Loss=0.5257
2025-06-03 11:47:37,523 - DEBUG - Online update step: 24/50
2025-06-03 11:47:37,526 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:38,207 - DEBUG - Node anomaly scores shape: torch.Size([12493, 1])
2025-06-03 11:47:38,269 - DEBUG - Edge anomaly scores shape: torch.Size([26626, 1])
2025-06-03 11:47:38,272 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:39,402 - DEBUG - Step 24: Loss=0.5411
2025-06-03 11:47:39,402 - DEBUG - Online update step: 25/50
2025-06-03 11:47:39,406 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:40,132 - DEBUG - Node anomaly scores shape: torch.Size([13306, 1])
2025-06-03 11:47:40,199 - DEBUG - Edge anomaly scores shape: torch.Size([28605, 1])
2025-06-03 11:47:40,201 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:41,198 - DEBUG - Step 25: Loss=0.5355
2025-06-03 11:47:41,198 - DEBUG - Online update step: 26/50
2025-06-03 11:47:41,200 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:41,710 - DEBUG - Node anomaly scores shape: torch.Size([12255, 1])
2025-06-03 11:47:41,744 - DEBUG - Edge anomaly scores shape: torch.Size([26067, 1])
2025-06-03 11:47:41,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:42,712 - DEBUG - Step 26: Loss=0.5375
2025-06-03 11:47:42,713 - DEBUG - Online update step: 27/50
2025-06-03 11:47:42,715 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:43,248 - DEBUG - Node anomaly scores shape: torch.Size([11236, 1])
2025-06-03 11:47:43,313 - DEBUG - Edge anomaly scores shape: torch.Size([23694, 1])
2025-06-03 11:47:43,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:44,094 - DEBUG - Step 27: Loss=0.5389
2025-06-03 11:47:44,095 - DEBUG - Online update step: 28/50
2025-06-03 11:47:44,096 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:44,622 - DEBUG - Node anomaly scores shape: torch.Size([13499, 1])
2025-06-03 11:47:44,671 - DEBUG - Edge anomaly scores shape: torch.Size([28963, 1])
2025-06-03 11:47:44,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:45,678 - DEBUG - Step 28: Loss=0.5354
2025-06-03 11:47:45,679 - DEBUG - Online update step: 29/50
2025-06-03 11:47:45,681 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:46,176 - DEBUG - Node anomaly scores shape: torch.Size([11149, 1])
2025-06-03 11:47:46,233 - DEBUG - Edge anomaly scores shape: torch.Size([23522, 1])
2025-06-03 11:47:46,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:47,461 - DEBUG - Step 29: Loss=0.5401
2025-06-03 11:47:47,461 - DEBUG - Online update step: 30/50
2025-06-03 11:47:47,465 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:48,234 - DEBUG - Node anomaly scores shape: torch.Size([11937, 1])
2025-06-03 11:47:48,301 - DEBUG - Edge anomaly scores shape: torch.Size([25189, 1])
2025-06-03 11:47:48,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:49,637 - DEBUG - Step 30: Loss=0.5357
2025-06-03 11:47:49,638 - DEBUG - Online update step: 31/50
2025-06-03 11:47:49,645 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:50,399 - DEBUG - Node anomaly scores shape: torch.Size([11929, 1])
2025-06-03 11:47:50,475 - DEBUG - Edge anomaly scores shape: torch.Size([25282, 1])
2025-06-03 11:47:50,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:51,841 - DEBUG - Step 31: Loss=0.5283
2025-06-03 11:47:51,842 - DEBUG - Online update step: 32/50
2025-06-03 11:47:51,848 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:52,754 - DEBUG - Node anomaly scores shape: torch.Size([11995, 1])
2025-06-03 11:47:52,825 - DEBUG - Edge anomaly scores shape: torch.Size([25435, 1])
2025-06-03 11:47:52,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:54,919 - DEBUG - Step 32: Loss=0.5304
2025-06-03 11:47:54,919 - DEBUG - Online update step: 33/50
2025-06-03 11:47:54,929 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:47:56,269 - DEBUG - Node anomaly scores shape: torch.Size([12901, 1])
2025-06-03 11:47:56,426 - DEBUG - Edge anomaly scores shape: torch.Size([27490, 1])
2025-06-03 11:47:56,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:47:59,467 - DEBUG - Step 33: Loss=0.5375
2025-06-03 11:47:59,467 - DEBUG - Online update step: 34/50
2025-06-03 11:47:59,472 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:00,637 - DEBUG - Node anomaly scores shape: torch.Size([13017, 1])
2025-06-03 11:48:00,714 - DEBUG - Edge anomaly scores shape: torch.Size([27788, 1])
2025-06-03 11:48:00,717 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:03,349 - DEBUG - Step 34: Loss=0.5205
2025-06-03 11:48:03,350 - DEBUG - Online update step: 35/50
2025-06-03 11:48:03,444 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:04,457 - DEBUG - Node anomaly scores shape: torch.Size([10586, 1])
2025-06-03 11:48:04,506 - DEBUG - Edge anomaly scores shape: torch.Size([22242, 1])
2025-06-03 11:48:04,508 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:05,551 - DEBUG - Step 35: Loss=0.5300
2025-06-03 11:48:05,551 - DEBUG - Online update step: 36/50
2025-06-03 11:48:05,559 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:06,184 - DEBUG - Node anomaly scores shape: torch.Size([10294, 1])
2025-06-03 11:48:06,231 - DEBUG - Edge anomaly scores shape: torch.Size([21520, 1])
2025-06-03 11:48:06,234 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:07,153 - DEBUG - Step 36: Loss=0.5436
2025-06-03 11:48:07,154 - DEBUG - Online update step: 37/50
2025-06-03 11:48:07,159 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:07,769 - DEBUG - Node anomaly scores shape: torch.Size([10832, 1])
2025-06-03 11:48:07,840 - DEBUG - Edge anomaly scores shape: torch.Size([22737, 1])
2025-06-03 11:48:07,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:08,969 - DEBUG - Step 37: Loss=0.5439
2025-06-03 11:48:08,970 - DEBUG - Online update step: 38/50
2025-06-03 11:48:08,976 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:09,978 - DEBUG - Node anomaly scores shape: torch.Size([11368, 1])
2025-06-03 11:48:10,030 - DEBUG - Edge anomaly scores shape: torch.Size([24030, 1])
2025-06-03 11:48:10,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:11,516 - DEBUG - Step 38: Loss=0.5445
2025-06-03 11:48:11,516 - DEBUG - Online update step: 39/50
2025-06-03 11:48:11,522 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:13,694 - DEBUG - Node anomaly scores shape: torch.Size([12005, 1])
2025-06-03 11:48:13,974 - DEBUG - Edge anomaly scores shape: torch.Size([25552, 1])
2025-06-03 11:48:14,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:19,324 - DEBUG - Step 39: Loss=0.5252
2025-06-03 11:48:19,324 - DEBUG - Online update step: 40/50
2025-06-03 11:48:19,427 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:22,078 - DEBUG - Node anomaly scores shape: torch.Size([12532, 1])
2025-06-03 11:48:22,267 - DEBUG - Edge anomaly scores shape: torch.Size([26765, 1])
2025-06-03 11:48:22,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:23,315 - DEBUG - Step 40: Loss=0.5183
2025-06-03 11:48:23,315 - DEBUG - Online update step: 41/50
2025-06-03 11:48:23,318 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:23,849 - DEBUG - Node anomaly scores shape: torch.Size([11499, 1])
2025-06-03 11:48:23,895 - DEBUG - Edge anomaly scores shape: torch.Size([24365, 1])
2025-06-03 11:48:23,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:24,859 - DEBUG - Step 41: Loss=0.5304
2025-06-03 11:48:24,859 - DEBUG - Online update step: 42/50
2025-06-03 11:48:24,861 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:25,434 - DEBUG - Node anomaly scores shape: torch.Size([11897, 1])
2025-06-03 11:48:25,481 - DEBUG - Edge anomaly scores shape: torch.Size([25117, 1])
2025-06-03 11:48:25,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:26,516 - DEBUG - Step 42: Loss=0.5282
2025-06-03 11:48:26,516 - DEBUG - Online update step: 43/50
2025-06-03 11:48:26,518 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:27,071 - DEBUG - Node anomaly scores shape: torch.Size([12099, 1])
2025-06-03 11:48:27,130 - DEBUG - Edge anomaly scores shape: torch.Size([25609, 1])
2025-06-03 11:48:27,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:30,956 - DEBUG - Step 43: Loss=0.5454
2025-06-03 11:48:30,956 - DEBUG - Online update step: 44/50
2025-06-03 11:48:30,962 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:33,349 - DEBUG - Node anomaly scores shape: torch.Size([11202, 1])
2025-06-03 11:48:33,461 - DEBUG - Edge anomaly scores shape: torch.Size([23704, 1])
2025-06-03 11:48:33,513 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:34,738 - DEBUG - Step 44: Loss=0.5394
2025-06-03 11:48:34,738 - DEBUG - Online update step: 45/50
2025-06-03 11:48:34,740 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:35,382 - DEBUG - Node anomaly scores shape: torch.Size([11661, 1])
2025-06-03 11:48:35,455 - DEBUG - Edge anomaly scores shape: torch.Size([24611, 1])
2025-06-03 11:48:35,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:36,629 - DEBUG - Step 45: Loss=0.5429
2025-06-03 11:48:36,630 - DEBUG - Online update step: 46/50
2025-06-03 11:48:36,632 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:37,450 - DEBUG - Node anomaly scores shape: torch.Size([13130, 1])
2025-06-03 11:48:37,513 - DEBUG - Edge anomaly scores shape: torch.Size([27991, 1])
2025-06-03 11:48:37,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:38,547 - DEBUG - Step 46: Loss=0.5295
2025-06-03 11:48:38,548 - DEBUG - Online update step: 47/50
2025-06-03 11:48:38,554 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:39,111 - DEBUG - Node anomaly scores shape: torch.Size([10844, 1])
2025-06-03 11:48:39,164 - DEBUG - Edge anomaly scores shape: torch.Size([22808, 1])
2025-06-03 11:48:39,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:39,993 - DEBUG - Step 47: Loss=0.5398
2025-06-03 11:48:39,994 - DEBUG - Online update step: 48/50
2025-06-03 11:48:39,997 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:40,610 - DEBUG - Node anomaly scores shape: torch.Size([13331, 1])
2025-06-03 11:48:40,653 - DEBUG - Edge anomaly scores shape: torch.Size([28562, 1])
2025-06-03 11:48:40,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:41,923 - DEBUG - Step 48: Loss=0.5281
2025-06-03 11:48:41,924 - DEBUG - Online update step: 49/50
2025-06-03 11:48:41,932 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:42,534 - DEBUG - Node anomaly scores shape: torch.Size([11318, 1])
2025-06-03 11:48:42,572 - DEBUG - Edge anomaly scores shape: torch.Size([23923, 1])
2025-06-03 11:48:42,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:45,376 - DEBUG - Step 49: Loss=0.5412
2025-06-03 11:48:45,376 - DEBUG - Online update step: 50/50
2025-06-03 11:48:45,494 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:48,004 - DEBUG - Node anomaly scores shape: torch.Size([13875, 1])
2025-06-03 11:48:48,131 - DEBUG - Edge anomaly scores shape: torch.Size([29842, 1])
2025-06-03 11:48:48,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:49,051 - DEBUG - Step 50: Loss=0.5296
2025-06-03 11:48:49,051 - INFO - Online update finished. Average loss: 0.5337, Learning rate: 0.000019
2025-06-03 11:48:49,052 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  0.0000000e+00
 -1.5213150e-08  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -4.3309458e-09  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  8.6618923e-10 -5.1971352e-09  2.2520920e-08 -3.4647569e-09
 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09
 -3.4647569e-09  0.0000000e+00]
2025-06-03 11:48:49,052 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:48:49,053 - INFO - Online update complete. Loss: 0.5337
2025-06-03 11:48:49,054 - INFO - Running anomaly detection...
2025-06-03 11:48:49,054 - INFO - Starting anomaly detection.
2025-06-03 11:48:49,097 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_114849_update_45.json
2025-06-03 11:48:49,098 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:48:49,117 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_114849_update_45.pth and as latest_checkpoint.pth
2025-06-03 11:48:49,117 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870685.dot): 0.0000
2025-06-03 11:48:49,117 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 11:48:49,117 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 1.0811, MLP Score: 1.0000
2025-06-03 11:48:49,117 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 1.0252, MLP Score: 1.0000
2025-06-03 11:48:49,117 - WARNING -   Node ID: fe80::a425:e54:93a8:261c, Recon Error: 1.2779, MLP Score: 1.0000
2025-06-03 11:48:49,117 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.7993, MLP Score: 1.0000
2025-06-03 11:48:49,118 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.1772, MLP Score: 1.0000
2025-06-03 11:48:49,118 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 11:48:49,118 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.5405, MLP Score: 0.9999
2025-06-03 11:48:49,118 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2565, MLP Score: 0.9995
2025-06-03 11:48:49,118 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.0285, MLP Score: 0.9998
2025-06-03 11:48:49,118 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.4355, MLP Score: 0.9946
2025-06-03 11:48:49,118 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 5.4902, MLP Score: 0.9948
2025-06-03 11:48:49,118 - INFO - 
--- Processing file: nw_graph_encoded_1748870715.dot (Timestamp: 2025-06-02 15:25:15) ---
2025-06-03 11:48:49,118 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-03 11:48:49,118 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot file.
2025-06-03 11:48:49,141 - INFO - Parsed 1003 nodes.
2025-06-03 11:48:49,162 - INFO - Parsed 2202 edges.
2025-06-03 11:48:49,860 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:48:49,861 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:48:49,878 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:48:49,879 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:48:49,879 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:48:49,881 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:48:49,881 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:48:49,891 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:48:49,892 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:48:49,894 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:48:49,896 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:48:49,896 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:48:49,896 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:48:49,896 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:48:49,896 - INFO - Performing online update...
2025-06-03 11:48:49,897 - INFO - Starting online update for 50 steps.
2025-06-03 11:48:49,897 - DEBUG - Updated RunningStats: new_mean=0.53550125240098, new_var=87600000000008.62, new_n=8790
2025-06-03 11:48:49,897 - DEBUG - Updated RunningStats: new_mean=0.5358350892892599, new_var=87900000000007.25, new_n=8820
2025-06-03 11:48:49,898 - DEBUG - Updated RunningStats: new_mean=0.7735605384200868, new_var=52000000000036.664, new_n=5222
2025-06-03 11:48:49,898 - DEBUG - Updated RunningStats: new_mean=0.7746339447677885, new_var=52220000000002.95, new_n=5244
2025-06-03 11:48:49,898 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:48:49,898 - DEBUG - Online update step: 1/50
2025-06-03 11:48:49,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:50,384 - DEBUG - Node anomaly scores shape: torch.Size([12697, 1])
2025-06-03 11:48:50,434 - DEBUG - Edge anomaly scores shape: torch.Size([27076, 1])
2025-06-03 11:48:50,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:51,328 - DEBUG - Step 1: Loss=0.5266
2025-06-03 11:48:51,329 - DEBUG - Online update step: 2/50
2025-06-03 11:48:51,331 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:51,808 - DEBUG - Node anomaly scores shape: torch.Size([12033, 1])
2025-06-03 11:48:51,849 - DEBUG - Edge anomaly scores shape: torch.Size([25520, 1])
2025-06-03 11:48:51,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:52,713 - DEBUG - Step 2: Loss=0.5313
2025-06-03 11:48:52,713 - DEBUG - Online update step: 3/50
2025-06-03 11:48:52,716 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:53,272 - DEBUG - Node anomaly scores shape: torch.Size([12750, 1])
2025-06-03 11:48:53,318 - DEBUG - Edge anomaly scores shape: torch.Size([27154, 1])
2025-06-03 11:48:53,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:54,263 - DEBUG - Step 3: Loss=0.5262
2025-06-03 11:48:54,263 - DEBUG - Online update step: 4/50
2025-06-03 11:48:54,267 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:54,851 - DEBUG - Node anomaly scores shape: torch.Size([12517, 1])
2025-06-03 11:48:54,900 - DEBUG - Edge anomaly scores shape: torch.Size([26839, 1])
2025-06-03 11:48:54,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:56,159 - DEBUG - Step 4: Loss=0.5393
2025-06-03 11:48:56,159 - DEBUG - Online update step: 5/50
2025-06-03 11:48:56,163 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:48:56,716 - DEBUG - Node anomaly scores shape: torch.Size([12336, 1])
2025-06-03 11:48:56,763 - DEBUG - Edge anomaly scores shape: torch.Size([26318, 1])
2025-06-03 11:48:56,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:48:58,251 - DEBUG - Step 5: Loss=0.5410
2025-06-03 11:48:58,251 - DEBUG - Online update step: 6/50
2025-06-03 11:48:58,333 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:01,364 - DEBUG - Node anomaly scores shape: torch.Size([11329, 1])
2025-06-03 11:49:01,642 - DEBUG - Edge anomaly scores shape: torch.Size([23959, 1])
2025-06-03 11:49:01,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:06,049 - DEBUG - Step 6: Loss=0.5337
2025-06-03 11:49:06,049 - DEBUG - Online update step: 7/50
2025-06-03 11:49:06,052 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:06,533 - DEBUG - Node anomaly scores shape: torch.Size([11150, 1])
2025-06-03 11:49:06,575 - DEBUG - Edge anomaly scores shape: torch.Size([23472, 1])
2025-06-03 11:49:06,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:07,733 - DEBUG - Step 7: Loss=0.5474
2025-06-03 11:49:07,733 - DEBUG - Online update step: 8/50
2025-06-03 11:49:07,746 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:09,195 - DEBUG - Node anomaly scores shape: torch.Size([12354, 1])
2025-06-03 11:49:09,422 - DEBUG - Edge anomaly scores shape: torch.Size([26264, 1])
2025-06-03 11:49:09,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:12,468 - DEBUG - Step 8: Loss=0.5366
2025-06-03 11:49:12,468 - DEBUG - Online update step: 9/50
2025-06-03 11:49:12,473 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:13,847 - DEBUG - Node anomaly scores shape: torch.Size([13242, 1])
2025-06-03 11:49:13,886 - DEBUG - Edge anomaly scores shape: torch.Size([28364, 1])
2025-06-03 11:49:13,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:15,403 - DEBUG - Step 9: Loss=0.5300
2025-06-03 11:49:15,403 - DEBUG - Online update step: 10/50
2025-06-03 11:49:15,507 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:16,558 - DEBUG - Node anomaly scores shape: torch.Size([11908, 1])
2025-06-03 11:49:16,720 - DEBUG - Edge anomaly scores shape: torch.Size([25200, 1])
2025-06-03 11:49:16,753 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:20,703 - DEBUG - Step 10: Loss=0.5274
2025-06-03 11:49:20,703 - DEBUG - Online update step: 11/50
2025-06-03 11:49:20,794 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:21,710 - DEBUG - Node anomaly scores shape: torch.Size([12110, 1])
2025-06-03 11:49:21,817 - DEBUG - Edge anomaly scores shape: torch.Size([25728, 1])
2025-06-03 11:49:21,833 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:24,865 - DEBUG - Step 11: Loss=0.5335
2025-06-03 11:49:24,865 - DEBUG - Online update step: 12/50
2025-06-03 11:49:24,951 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:27,016 - DEBUG - Node anomaly scores shape: torch.Size([12001, 1])
2025-06-03 11:49:27,058 - DEBUG - Edge anomaly scores shape: torch.Size([25524, 1])
2025-06-03 11:49:27,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:29,029 - DEBUG - Step 12: Loss=0.5386
2025-06-03 11:49:29,033 - DEBUG - Online update step: 13/50
2025-06-03 11:49:29,042 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:31,436 - DEBUG - Node anomaly scores shape: torch.Size([12748, 1])
2025-06-03 11:49:31,718 - DEBUG - Edge anomaly scores shape: torch.Size([27294, 1])
2025-06-03 11:49:31,825 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:35,937 - DEBUG - Step 13: Loss=0.5321
2025-06-03 11:49:35,937 - DEBUG - Online update step: 14/50
2025-06-03 11:49:36,030 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:37,016 - DEBUG - Node anomaly scores shape: torch.Size([12487, 1])
2025-06-03 11:49:37,069 - DEBUG - Edge anomaly scores shape: torch.Size([26558, 1])
2025-06-03 11:49:37,070 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:38,933 - DEBUG - Step 14: Loss=0.5370
2025-06-03 11:49:38,934 - DEBUG - Online update step: 15/50
2025-06-03 11:49:39,007 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:41,424 - DEBUG - Node anomaly scores shape: torch.Size([11621, 1])
2025-06-03 11:49:41,643 - DEBUG - Edge anomaly scores shape: torch.Size([24584, 1])
2025-06-03 11:49:41,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:44,641 - DEBUG - Step 15: Loss=0.5385
2025-06-03 11:49:44,642 - DEBUG - Online update step: 16/50
2025-06-03 11:49:44,720 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:46,444 - DEBUG - Node anomaly scores shape: torch.Size([11765, 1])
2025-06-03 11:49:46,612 - DEBUG - Edge anomaly scores shape: torch.Size([24829, 1])
2025-06-03 11:49:46,663 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:50,135 - DEBUG - Step 16: Loss=0.5263
2025-06-03 11:49:50,136 - DEBUG - Online update step: 17/50
2025-06-03 11:49:50,246 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:49:52,915 - DEBUG - Node anomaly scores shape: torch.Size([12701, 1])
2025-06-03 11:49:53,199 - DEBUG - Edge anomaly scores shape: torch.Size([27102, 1])
2025-06-03 11:49:53,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:49:57,604 - DEBUG - Step 17: Loss=0.5406
2025-06-03 11:49:57,605 - DEBUG - Online update step: 18/50
2025-06-03 11:49:57,698 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:00,086 - DEBUG - Node anomaly scores shape: torch.Size([10880, 1])
2025-06-03 11:50:00,333 - DEBUG - Edge anomaly scores shape: torch.Size([22851, 1])
2025-06-03 11:50:00,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:03,961 - DEBUG - Step 18: Loss=0.5482
2025-06-03 11:50:03,961 - DEBUG - Online update step: 19/50
2025-06-03 11:50:04,071 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:06,086 - DEBUG - Node anomaly scores shape: torch.Size([13065, 1])
2025-06-03 11:50:06,327 - DEBUG - Edge anomaly scores shape: torch.Size([27962, 1])
2025-06-03 11:50:06,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:10,569 - DEBUG - Step 19: Loss=0.5295
2025-06-03 11:50:10,570 - DEBUG - Online update step: 20/50
2025-06-03 11:50:10,672 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:13,121 - DEBUG - Node anomaly scores shape: torch.Size([12081, 1])
2025-06-03 11:50:13,315 - DEBUG - Edge anomaly scores shape: torch.Size([25556, 1])
2025-06-03 11:50:13,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:16,026 - DEBUG - Step 20: Loss=0.5325
2025-06-03 11:50:16,029 - DEBUG - Online update step: 21/50
2025-06-03 11:50:16,123 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:17,788 - DEBUG - Node anomaly scores shape: torch.Size([12829, 1])
2025-06-03 11:50:17,958 - DEBUG - Edge anomaly scores shape: torch.Size([27480, 1])
2025-06-03 11:50:18,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:19,780 - DEBUG - Step 21: Loss=0.5246
2025-06-03 11:50:19,781 - DEBUG - Online update step: 22/50
2025-06-03 11:50:19,847 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:21,672 - DEBUG - Node anomaly scores shape: torch.Size([10961, 1])
2025-06-03 11:50:21,705 - DEBUG - Edge anomaly scores shape: torch.Size([23083, 1])
2025-06-03 11:50:21,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:22,348 - DEBUG - Step 22: Loss=0.5319
2025-06-03 11:50:22,348 - DEBUG - Online update step: 23/50
2025-06-03 11:50:22,350 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:22,766 - DEBUG - Node anomaly scores shape: torch.Size([11850, 1])
2025-06-03 11:50:22,805 - DEBUG - Edge anomaly scores shape: torch.Size([25141, 1])
2025-06-03 11:50:22,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:23,569 - DEBUG - Step 23: Loss=0.5251
2025-06-03 11:50:23,569 - DEBUG - Online update step: 24/50
2025-06-03 11:50:23,571 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:24,071 - DEBUG - Node anomaly scores shape: torch.Size([13112, 1])
2025-06-03 11:50:24,141 - DEBUG - Edge anomaly scores shape: torch.Size([28120, 1])
2025-06-03 11:50:24,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:26,220 - DEBUG - Step 24: Loss=0.5361
2025-06-03 11:50:26,220 - DEBUG - Online update step: 25/50
2025-06-03 11:50:26,227 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:27,564 - DEBUG - Node anomaly scores shape: torch.Size([12091, 1])
2025-06-03 11:50:27,732 - DEBUG - Edge anomaly scores shape: torch.Size([25793, 1])
2025-06-03 11:50:27,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:30,040 - DEBUG - Step 25: Loss=0.5342
2025-06-03 11:50:30,040 - DEBUG - Online update step: 26/50
2025-06-03 11:50:30,123 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:31,154 - DEBUG - Node anomaly scores shape: torch.Size([12698, 1])
2025-06-03 11:50:31,219 - DEBUG - Edge anomaly scores shape: torch.Size([27122, 1])
2025-06-03 11:50:31,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:32,309 - DEBUG - Step 26: Loss=0.5263
2025-06-03 11:50:32,309 - DEBUG - Online update step: 27/50
2025-06-03 11:50:32,311 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:32,803 - DEBUG - Node anomaly scores shape: torch.Size([12388, 1])
2025-06-03 11:50:32,860 - DEBUG - Edge anomaly scores shape: torch.Size([26428, 1])
2025-06-03 11:50:32,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:33,873 - DEBUG - Step 27: Loss=0.5354
2025-06-03 11:50:33,873 - DEBUG - Online update step: 28/50
2025-06-03 11:50:33,878 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:34,452 - DEBUG - Node anomaly scores shape: torch.Size([12882, 1])
2025-06-03 11:50:34,500 - DEBUG - Edge anomaly scores shape: torch.Size([27531, 1])
2025-06-03 11:50:34,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:35,430 - DEBUG - Step 28: Loss=0.5246
2025-06-03 11:50:35,430 - DEBUG - Online update step: 29/50
2025-06-03 11:50:35,432 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:35,899 - DEBUG - Node anomaly scores shape: torch.Size([10355, 1])
2025-06-03 11:50:35,946 - DEBUG - Edge anomaly scores shape: torch.Size([21620, 1])
2025-06-03 11:50:35,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:36,864 - DEBUG - Step 29: Loss=0.5361
2025-06-03 11:50:36,864 - DEBUG - Online update step: 30/50
2025-06-03 11:50:36,866 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:37,304 - DEBUG - Node anomaly scores shape: torch.Size([11064, 1])
2025-06-03 11:50:37,337 - DEBUG - Edge anomaly scores shape: torch.Size([23274, 1])
2025-06-03 11:50:37,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:37,998 - DEBUG - Step 30: Loss=0.5254
2025-06-03 11:50:37,999 - DEBUG - Online update step: 31/50
2025-06-03 11:50:38,001 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:38,459 - DEBUG - Node anomaly scores shape: torch.Size([12737, 1])
2025-06-03 11:50:38,500 - DEBUG - Edge anomaly scores shape: torch.Size([27230, 1])
2025-06-03 11:50:38,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:39,389 - DEBUG - Step 31: Loss=0.5356
2025-06-03 11:50:39,389 - DEBUG - Online update step: 32/50
2025-06-03 11:50:39,391 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:39,844 - DEBUG - Node anomaly scores shape: torch.Size([13039, 1])
2025-06-03 11:50:39,883 - DEBUG - Edge anomaly scores shape: torch.Size([27916, 1])
2025-06-03 11:50:39,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:40,649 - DEBUG - Step 32: Loss=0.5313
2025-06-03 11:50:40,649 - DEBUG - Online update step: 33/50
2025-06-03 11:50:40,652 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:41,054 - DEBUG - Node anomaly scores shape: torch.Size([11690, 1])
2025-06-03 11:50:41,090 - DEBUG - Edge anomaly scores shape: torch.Size([24773, 1])
2025-06-03 11:50:41,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:41,780 - DEBUG - Step 33: Loss=0.5326
2025-06-03 11:50:41,780 - DEBUG - Online update step: 34/50
2025-06-03 11:50:41,782 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:42,238 - DEBUG - Node anomaly scores shape: torch.Size([12809, 1])
2025-06-03 11:50:42,276 - DEBUG - Edge anomaly scores shape: torch.Size([27365, 1])
2025-06-03 11:50:42,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:43,174 - DEBUG - Step 34: Loss=0.5290
2025-06-03 11:50:43,174 - DEBUG - Online update step: 35/50
2025-06-03 11:50:43,180 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:43,727 - DEBUG - Node anomaly scores shape: torch.Size([12165, 1])
2025-06-03 11:50:43,769 - DEBUG - Edge anomaly scores shape: torch.Size([25795, 1])
2025-06-03 11:50:43,770 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:44,550 - DEBUG - Step 35: Loss=0.5356
2025-06-03 11:50:44,550 - DEBUG - Online update step: 36/50
2025-06-03 11:50:44,552 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:45,369 - DEBUG - Node anomaly scores shape: torch.Size([12817, 1])
2025-06-03 11:50:45,414 - DEBUG - Edge anomaly scores shape: torch.Size([27420, 1])
2025-06-03 11:50:45,414 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:46,407 - DEBUG - Step 36: Loss=0.5292
2025-06-03 11:50:46,407 - DEBUG - Online update step: 37/50
2025-06-03 11:50:46,409 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:46,873 - DEBUG - Node anomaly scores shape: torch.Size([12667, 1])
2025-06-03 11:50:46,912 - DEBUG - Edge anomaly scores shape: torch.Size([26961, 1])
2025-06-03 11:50:46,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:47,839 - DEBUG - Step 37: Loss=0.5351
2025-06-03 11:50:47,839 - DEBUG - Online update step: 38/50
2025-06-03 11:50:47,843 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:48,290 - DEBUG - Node anomaly scores shape: torch.Size([12141, 1])
2025-06-03 11:50:48,329 - DEBUG - Edge anomaly scores shape: torch.Size([25655, 1])
2025-06-03 11:50:48,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:49,113 - DEBUG - Step 38: Loss=0.5270
2025-06-03 11:50:49,113 - DEBUG - Online update step: 39/50
2025-06-03 11:50:49,115 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:49,508 - DEBUG - Node anomaly scores shape: torch.Size([10903, 1])
2025-06-03 11:50:49,541 - DEBUG - Edge anomaly scores shape: torch.Size([22805, 1])
2025-06-03 11:50:49,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:50,235 - DEBUG - Step 39: Loss=0.5441
2025-06-03 11:50:50,235 - DEBUG - Online update step: 40/50
2025-06-03 11:50:50,237 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:50,690 - DEBUG - Node anomaly scores shape: torch.Size([11971, 1])
2025-06-03 11:50:50,727 - DEBUG - Edge anomaly scores shape: torch.Size([25312, 1])
2025-06-03 11:50:50,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:51,520 - DEBUG - Step 40: Loss=0.5418
2025-06-03 11:50:51,520 - DEBUG - Online update step: 41/50
2025-06-03 11:50:51,523 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:51,969 - DEBUG - Node anomaly scores shape: torch.Size([11783, 1])
2025-06-03 11:50:52,006 - DEBUG - Edge anomaly scores shape: torch.Size([24918, 1])
2025-06-03 11:50:52,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:52,752 - DEBUG - Step 41: Loss=0.5458
2025-06-03 11:50:52,752 - DEBUG - Online update step: 42/50
2025-06-03 11:50:52,754 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:53,210 - DEBUG - Node anomaly scores shape: torch.Size([11753, 1])
2025-06-03 11:50:53,249 - DEBUG - Edge anomaly scores shape: torch.Size([24863, 1])
2025-06-03 11:50:53,250 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:54,036 - DEBUG - Step 42: Loss=0.5287
2025-06-03 11:50:54,036 - DEBUG - Online update step: 43/50
2025-06-03 11:50:54,038 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:54,477 - DEBUG - Node anomaly scores shape: torch.Size([11744, 1])
2025-06-03 11:50:54,516 - DEBUG - Edge anomaly scores shape: torch.Size([24880, 1])
2025-06-03 11:50:54,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:50:55,359 - DEBUG - Step 43: Loss=0.5315
2025-06-03 11:50:55,359 - DEBUG - Online update step: 44/50
2025-06-03 11:50:55,361 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 11:50:55,856 - DEBUG - Node anomaly scores shape: torch.Size([11385, 1])
2025-06-03 11:50:55,896 - DEBUG - Edge anomaly scores shape: torch.Size([24037, 1])
2025-06-03 11:50:55,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
