2025-06-06 15:41:41,637 - INFO - Application logging to file: logs/app_20250606_154141.log
2025-06-06 15:41:41,637 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-06 15:41:41,637 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-06 15:41:41,637 - INFO - Train Mode: train, Visualization Path: vis
2025-06-06 15:41:41,637 - INFO - Found 23 files to process.
2025-06-06 15:41:41,637 - INFO - 
--- Processing file: nw_graph_encoded_1749044168.dot ---
2025-06-06 15:41:41,637 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot
2025-06-06 15:41:41,637 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044168.dot file.
2025-06-06 15:41:41,637 - INFO - Parsed 20 nodes.
2025-06-06 15:41:41,638 - INFO - Parsed 27 edges.
2025-06-06 15:41:41,638 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,638 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,638 - DEBUG - Initial node features tensor shape: torch.Size([20, 19])
2025-06-06 15:41:41,639 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,640 - DEBUG - Node features tensor shape after scaling: torch.Size([20, 19])
2025-06-06 15:41:41,640 - DEBUG - Edge index tensor shape: torch.Size([2, 27])
2025-06-06 15:41:41,640 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,640 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:41:41,640 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-06 15:41:41,641 - DEBUG - Shape of encoded categorical edge features: torch.Size([27, 2])
2025-06-06 15:41:41,641 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,641 - DEBUG - Shape of scaled numerical edge features: torch.Size([27, 20])
2025-06-06 15:41:41,641 - DEBUG - Final edge attributes tensor shape: torch.Size([27, 22])
2025-06-06 15:41:41,641 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,641 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-06 15:41:41,641 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-06 15:41:41,677 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-06 15:41:41,679 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-06 15:41:41,681 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-06 15:41:41,681 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-06 15:41:41,681 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-06 15:41:41,681 - INFO - RunningStats initialized.
2025-06-06 15:41:41,681 - INFO - RunningStats initialized.
2025-06-06 15:41:41,681 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-06 15:41:41,682 - INFO - Using device: cpu
2025-06-06 15:41:41,682 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-06 15:41:41,682 - ERROR - Error loading model or running stats during initial setup: name 'os' is not defined
2025-06-06 15:41:41,682 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 369, in monitor_new_files
    start_epoch = load_checkpoint(gnn_model, gnn_model.optimizer, gnn_model.scheduler,
                  ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 93, in load_checkpoint
    filepath = os.path.join(model_save_path, filename)
               ^^
NameError: name 'os' is not defined. Did you forget to import 'os'

2025-06-06 15:41:41,682 - ERROR - Cannot proceed without a working model. Skipping this file.
2025-06-06 15:41:41,682 - INFO - 
--- Processing file: nw_graph_encoded_1749044228.dot ---
2025-06-06 15:41:41,682 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot
2025-06-06 15:41:41,682 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044228.dot file.
2025-06-06 15:41:41,683 - INFO - Parsed 49 nodes.
2025-06-06 15:41:41,684 - INFO - Parsed 66 edges.
2025-06-06 15:41:41,685 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,685 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,685 - DEBUG - Initial node features tensor shape: torch.Size([49, 19])
2025-06-06 15:41:41,686 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,686 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 19])
2025-06-06 15:41:41,686 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-06 15:41:41,686 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,687 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-06 15:41:41,687 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:41,687 - DEBUG - Shape of encoded categorical edge features: torch.Size([66, 2])
2025-06-06 15:41:41,688 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,688 - DEBUG - Shape of scaled numerical edge features: torch.Size([66, 20])
2025-06-06 15:41:41,688 - DEBUG - Final edge attributes tensor shape: torch.Size([66, 22])
2025-06-06 15:41:41,688 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,688 - INFO - Performing online update...
2025-06-06 15:41:41,688 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,688 - DEBUG - Initialized RunningStats with first batch: mean=[-3.76330346e-09  4.37151413e-09  6.08210661e-09 -1.82463198e-09
 -6.08210661e-09  4.86568529e-09  2.43284264e-09  3.64926397e-09
  1.27724239e-08  1.03395812e-08  9.73137058e-09 -1.15560026e-08
  3.64926397e-09 -3.04105330e-08  1.21642132e-09 -7.90673859e-09
  8.05879126e-09  1.06436866e-08 -1.94627412e-08], M2=[48.99999891 48.99999891 49.00000008 48.99999808 48.99999733 49.00000349
 49.00000321 49.00000157 49.0000008  48.99999987 48.9999992  48.99999829
 49.00000074 49.0000001  48.99999963 49.00000195 49.00000153 49.00000134
 49.00000365], n=49
2025-06-06 15:41:41,689 - DEBUG - Initialized RunningStats with first batch: mean=[ 1.36363636e-01  3.10606061e+00  1.40403934e-09  0.00000000e+00
  1.89086705e-09  4.09217495e-09  7.96563020e-09  2.08842032e-09
 -2.42708307e-09 -7.76102146e-10  6.09592958e-09  1.02608641e-08
 -1.26998533e-10  1.21918592e-08 -5.41860407e-09  3.80995599e-09
  3.80995599e-09  3.80995599e-09  3.80995599e-09  3.80995599e-09
  3.80995599e-09  1.69331377e-09], M2=[  7.77272727 306.25757576  65.99999913  65.99999922  66.00000101
  66.00000274  65.99999731  65.99999867  66.00000022  66.00000049
  66.00000279  65.99999825  65.9999992   65.99999966  65.99999808
  66.00000372  66.00000372  66.00000372  66.00000372  66.00000372
  66.00000372  66.00000052], n=66
2025-06-06 15:41:41,689 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999998 0.99999997 1.00000004
 1.00000003 1.00000002 1.00000001 1.         0.99999999 0.99999998
 1.00000001 1.         1.         1.00000002 1.00000002 1.00000001
 1.00000004]
2025-06-06 15:41:41,689 - DEBUG - Calculated standard deviation: [0.34317429 2.15412774 0.99999999 0.99999999 1.00000001 1.00000002
 0.99999998 0.99999999 1.         1.         1.00000002 0.99999999
 0.99999999 1.         0.99999999 1.00000003 1.00000003 1.00000003
 1.00000003 1.00000003 1.00000003 1.        ]
2025-06-06 15:41:41,689 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,689 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,689 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,689 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,690 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,690 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,691 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,691 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,692 - DEBUG - Current node mean: [-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], current edge mean: [ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:41:41,692 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0000
2025-06-06 15:41:41,692 - DEBUG - Updated reference mean: node=[-3.8925482e-08  3.8925482e-08 -9.7313704e-09 -1.7029899e-08
 -2.9194112e-08 -1.9462741e-08  0.0000000e+00  1.7029899e-08
  2.6761269e-08 -5.4738960e-09  0.0000000e+00 -1.4597056e-08
  1.4597056e-08 -2.4328427e-08  1.7029899e-08 -9.7313704e-09
  0.0000000e+00  0.0000000e+00 -1.9462741e-08], edge=[ 1.3636364e-01  3.1060605e+00  9.9341078e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  2.5286820e-08 -3.6124028e-09
  7.2248056e-09  9.9341078e-09  3.2511625e-08  2.1674417e-08
 -1.1740309e-08  9.9341078e-09 -3.6124028e-08  3.6124028e-09
  3.6124028e-09  3.6124028e-09  3.6124028e-09  3.6124028e-09
  3.6124028e-09 -3.6124028e-09]
2025-06-06 15:41:41,692 - DEBUG - Updated reference std: node=[1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363 1.010363
 1.010363 1.010363 1.010363], edge=[0.345804  2.1706347 1.0076629 1.0076629 1.007663  1.007663  1.0076629
 1.0076629 1.0076629 1.0076629 1.007663  1.0076629 1.0076629 1.0076629
 1.0076629 1.007663  1.007663  1.007663  1.007663  1.007663  1.007663
 1.0076629]
2025-06-06 15:41:41,693 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,693 - INFO - Running anomaly detection...
2025-06-06 15:41:41,693 - INFO - Starting anomaly detection.
2025-06-06 15:41:41,707 - DEBUG - Node reconstruction errors: [ 6.826957   4.9489765  4.8929167  6.36364    4.95724    5.8054876
  7.0314827  7.8218594  5.6121874  6.9718676  5.5097647  5.7864356
 15.693509   6.9299574  5.76512   14.574638  20.402786   5.6232896
  5.8073025 11.020134   5.5744705  6.47419    5.0902348  5.787499
  5.1563506  5.677779  18.785645   5.653306   5.533484   5.820169
  5.1311836 16.61446    5.806734   5.6383653  5.7707224  5.7538514
  5.727911   5.1396394  4.880248   5.6629524  5.7617383  5.769988
  5.546015  14.766346   5.6042156  5.5874414  6.8775706  6.4314895
  5.6446385]
2025-06-06 15:41:41,707 - DEBUG - Edge reconstruction errors: [0.7996399  0.7999476  0.7999637  0.7999885  0.79994154 0.7999074
 0.79996973 0.7999936  0.799975   0.79989    0.7136194  0.7639568
 0.79978454 0.7995068  0.7851853  0.79160225 0.79969907 0.78248996
 0.7984721  0.79557204 0.7810926  0.7308377  0.6867383  0.7331223
 0.7514098  0.7600204  0.19999999 0.52595556 0.6835308  0.79423416
 0.7927059  0.7994133  0.45232904 0.64871013 0.69835246 0.7228293
 0.08237678 0.60027814 0.6777605  0.19956267 0.67165124 0.19814855
 0.7999994  0.7210568  0.79841083 0.7066774  0.7611059  0.7053991
 0.7928928  0.5505181  0.685223   0.58388174 0.63156766 0.14718622
 0.7321687  0.79923415 0.79950136 0.798357   0.7999929  0.7794569
 0.7899839  0.79994845 0.7957928  0.7930629  0.7989259  0.79812807]
2025-06-06 15:41:41,708 - ERROR - An error occurred while processing file nw_graph_encoded_1749044228.dot: name 'datetime' is not defined
2025-06-06 15:41:41,709 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:41,709 - INFO - 
--- Processing file: nw_graph_encoded_1749044288.dot ---
2025-06-06 15:41:41,709 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot
2025-06-06 15:41:41,709 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044288.dot file.
2025-06-06 15:41:41,710 - INFO - Parsed 65 nodes.
2025-06-06 15:41:41,710 - INFO - Parsed 89 edges.
2025-06-06 15:41:41,713 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,713 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,713 - DEBUG - Initial node features tensor shape: torch.Size([65, 19])
2025-06-06 15:41:41,714 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,714 - DEBUG - Node features tensor shape after scaling: torch.Size([65, 19])
2025-06-06 15:41:41,714 - DEBUG - Edge index tensor shape: torch.Size([2, 89])
2025-06-06 15:41:41,714 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,715 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:41,715 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:41,715 - DEBUG - Shape of encoded categorical edge features: torch.Size([89, 2])
2025-06-06 15:41:41,715 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,716 - DEBUG - Shape of scaled numerical edge features: torch.Size([89, 20])
2025-06-06 15:41:41,716 - DEBUG - Final edge attributes tensor shape: torch.Size([89, 22])
2025-06-06 15:41:41,716 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,716 - INFO - Performing online update...
2025-06-06 15:41:41,716 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,716 - DEBUG - Updated RunningStats: new_mean=[-3.90501922e-09  4.29715504e-09 -2.28745896e-09 -6.27417313e-09
 -5.75132537e-09  2.61423881e-10  1.28097701e-08  2.61423881e-10
  5.48990149e-09  7.84271642e-10  2.14367582e-08 -8.10414030e-09
  1.72539761e-08 -1.51625851e-08  1.17640746e-09  1.82996716e-09
  1.89532313e-09  1.00648194e-08 -1.35940418e-08], new_M2=[113.9999971  113.9999971  113.99999572 113.99999326 113.99999948
 114.00000674 113.99999949 114.00000473 113.999999   114.00000497
 114.00000037 114.00000044 113.99999944 113.9999993  113.99999943
 114.00000069 114.00000014 114.00000036 114.00000542], new_n=114
2025-06-06 15:41:41,717 - DEBUG - Updated RunningStats: new_mean=[ 6.83870968e-01  3.18064516e+00  8.14156186e-10  3.60511964e-10
  1.60352717e-09  1.99633500e-09 -2.13603339e-09 -2.51457095e-09
 -3.45490633e-09 -1.17166388e-09  2.40341310e-09  2.35027513e-09
  3.01027490e-09  1.01904715e-08 -4.99909924e-09 -9.01279911e-11
 -9.01279911e-11 -9.01279911e-11 -9.01279911e-11 -9.01279911e-11
 -9.01279911e-11 -1.95277314e-09], new_M2=[ 51.50967742 694.94193548 154.99999941 154.99999998 155.00000441
 155.00000462 154.99999567 154.99999586 154.99999812 155.00000068
 155.00000057 154.99999931 154.99999981 154.99999826 154.99999737
 154.9999983  154.9999983  154.9999983  154.9999983  154.9999983
 154.9999983  154.99999444], new_n=155
2025-06-06 15:41:41,717 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 0.99999998 0.99999997 1.         1.00000003
 1.         1.00000002 1.         1.00000002 1.         1.
 1.         1.         1.         1.         1.         1.
 1.00000002]
2025-06-06 15:41:41,717 - DEBUG - Calculated standard deviation: [0.57647246 2.11742682 1.         1.         1.00000001 1.00000001
 0.99999999 0.99999999 0.99999999 1.         1.         1.
 1.         0.99999999 0.99999999 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 0.99999998]
2025-06-06 15:41:41,717 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,717 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,717 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,717 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,718 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,718 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,719 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,719 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,720 - DEBUG - Current node mean: [-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], current edge mean: [ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:41:41,720 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7043
2025-06-06 15:41:41,720 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:41:41,720 - DEBUG - Updated reference mean: node=[-2.9343825e-08  2.9343825e-08 -3.3928799e-08 -3.6679783e-08
  4.4015739e-08 -1.8339891e-08  2.8426831e-08 -4.4015739e-08
  3.6679781e-09 -2.5675847e-08  1.8339891e-08  3.6679783e-08
  3.6679783e-08  0.0000000e+00  0.0000000e+00  7.3359563e-09
  7.3359563e-09 -1.1003935e-08 -2.0173880e-08], edge=[ 1.0898876e+00  3.2359550e+00  5.3577209e-09 -1.0715442e-08
  1.0715442e-08  1.0715442e-08 -1.6073162e-08  2.6788605e-09
 -1.0715442e-08  8.0365812e-09 -1.0715442e-08  0.0000000e+00
  1.3394303e-08 -2.6788605e-09 -1.0715442e-08 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09 -5.3577209e-09
 -5.3577209e-09 -5.3577209e-09]
2025-06-06 15:41:41,720 - DEBUG - Updated reference std: node=[1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822
 1.0077822 1.0077822 1.0077822 1.0077822 1.0077822], edge=[0.32475337 2.0999053  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658  1.0056658  1.0056658
 1.0056658  1.0056658  1.0056658  1.0056658 ]
2025-06-06 15:41:41,720 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,720 - INFO - Running anomaly detection...
2025-06-06 15:41:41,720 - INFO - Starting anomaly detection.
2025-06-06 15:41:41,723 - DEBUG - Node reconstruction errors: [ 5.435236   5.207452   5.4912324  5.52053    5.4842286  7.0487556
 15.159262   5.693956   4.7780185  5.6412396  4.639943   5.677636
  5.622279   7.750005   5.478302  15.316754   4.7987366  5.222313
  5.5121503 18.419497   5.5594673 10.205087   4.8204064  5.714662
  6.204576   5.6213675  9.350476   4.8074846  5.4978676  5.701715
  5.704167   5.7791457  6.7079544  5.4621964 16.621183   6.825421
 15.091133   5.722908   5.625336   5.4396887  9.000192   6.8005805
  4.7461233  6.7916813  5.290387   5.489272   5.482314   7.012282
  5.633013   6.714522   9.684568  17.662231   5.628598   4.571687
  8.038287   5.5929227  5.5253205  4.513267   6.084212   5.526757
  4.561668   5.97623    3.0583813  5.6363063  5.4603024]
2025-06-06 15:41:41,723 - DEBUG - Edge reconstruction errors: [0.6403508  0.64628005 0.60079587 0.7999943  0.74078846 0.75716573
 0.7996916  0.7672343  0.7342555  0.78971577 0.5817274  0.6005242
 0.793377   0.6950407  0.7663429  0.58775306 0.551265   0.5975159
 0.38445133 0.7060526  0.79969114 0.79963255 0.6400702  0.7032005
 0.7966012  0.7982029  0.7855976  0.79284686 0.79970646 0.7674423
 0.7974421  0.70878375 0.18384326 0.19559538 0.54247296 0.4445915
 0.57559437 0.6557474  0.6253119  0.19999999 0.24826676 0.39693797
 0.782231   0.5690529  0.78176236 0.5987862  0.29197443 0.53153944
 0.5502715  0.19369793 0.17223263 0.33842862 0.53253627 0.19996566
 0.58269346 0.19984907 0.79999447 0.6562808  0.79491276 0.62707067
 0.69240624 0.4955965  0.77201563 0.19506764 0.37957892 0.2598486
 0.38069674 0.02366394 0.7898457  0.5112425  0.7984891  0.51421154
 0.37805384 0.75362235 0.79893345 0.7977137  0.7937527  0.7946805
 0.7993898  0.793822   0.7998646  0.79994583 0.7999934  0.7975993
 0.7960979  0.7986404  0.7996865  0.79966    0.799995  ]
2025-06-06 15:41:41,724 - ERROR - An error occurred while processing file nw_graph_encoded_1749044288.dot: name 'datetime' is not defined
2025-06-06 15:41:41,725 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:41,725 - INFO - 
--- Processing file: nw_graph_encoded_1749044348.dot ---
2025-06-06 15:41:41,725 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot
2025-06-06 15:41:41,725 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044348.dot file.
2025-06-06 15:41:41,726 - INFO - Parsed 77 nodes.
2025-06-06 15:41:41,727 - INFO - Parsed 106 edges.
2025-06-06 15:41:41,730 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,730 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,731 - DEBUG - Initial node features tensor shape: torch.Size([77, 19])
2025-06-06 15:41:41,731 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,731 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 19])
2025-06-06 15:41:41,731 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-06 15:41:41,731 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,732 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:41,732 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:41,733 - DEBUG - Shape of encoded categorical edge features: torch.Size([106, 2])
2025-06-06 15:41:41,733 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,733 - DEBUG - Shape of scaled numerical edge features: torch.Size([106, 20])
2025-06-06 15:41:41,733 - DEBUG - Final edge attributes tensor shape: torch.Size([106, 22])
2025-06-06 15:41:41,733 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,733 - INFO - Performing online update...
2025-06-06 15:41:41,733 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,734 - DEBUG - Updated RunningStats: new_mean=[-2.52578583e-09  2.83785203e-09  7.21653094e-09 -3.58876133e-09
 -1.24826481e-09  1.56033102e-10  1.04542178e-08  1.32628136e-09
  3.27669513e-09 -3.82281099e-09  6.24132406e-09 -3.43272823e-09
  1.15464495e-08 -7.64562197e-09 -6.94347302e-09  2.80859583e-09
  6.67041509e-09  1.07467799e-08 -9.36198609e-09], new_M2=[190.99999926 190.99999926 190.99999296 190.9999893  191.00000108
 191.00000916 191.00000201 191.00000235 191.00000348 190.99999873
 190.99999693 190.99999827 190.99999369 191.00000134 191.00000509
 191.00000224 191.00000049 190.99999847 191.00000631], new_n=191
2025-06-06 15:41:41,734 - DEBUG - Updated RunningStats: new_mean=[ 8.62068966e-01  3.26819923e+00  2.58879129e-09 -7.06520574e-10
  3.24312569e-09  2.06336122e-09 -8.88057110e-10 -5.79846431e-10
 -4.36869682e-09  1.08119058e-09 -5.99472002e-10 -2.28269928e-09
  2.67978258e-09 -6.28018288e-10 -1.14185143e-08 -4.53172287e-10
 -4.53172287e-10 -4.53172287e-10 -4.53172287e-10 -4.53172287e-10
 -4.53172287e-10  1.24890000e-10], new_M2=[  77.03448276 1139.22605364  261.0000066   260.9999946   261.00001265
  261.00001052  260.99999672  261.00000114  260.99999669  260.99999973
  260.99999185  261.00000245  261.00000034  261.00000071  260.99999655
  260.99999755  260.99999755  260.99999755  260.99999755  260.99999755
  260.99999755  260.99999886], new_n=261
2025-06-06 15:41:41,734 - DEBUG - Calculated standard deviation: [1.         1.         0.99999998 0.99999997 1.         1.00000002
 1.00000001 1.00000001 1.00000001 1.         0.99999999 1.
 0.99999998 1.         1.00000001 1.00000001 1.         1.
 1.00000002]
2025-06-06 15:41:41,734 - DEBUG - Calculated standard deviation: [0.54327827 2.08922253 1.00000001 0.99999999 1.00000002 1.00000002
 0.99999999 1.         0.99999999 1.         0.99999998 1.
 1.         1.         0.99999999 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:41,735 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,735 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,735 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,735 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,736 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,736 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,737 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,737 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,737 - DEBUG - Current node mean: [-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], current edge mean: [ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:41:41,737 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4796
2025-06-06 15:41:41,737 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:41:41,738 - DEBUG - Updated reference mean: node=[-6.19269036e-09  6.19269036e-09  3.25116254e-08 -2.47707614e-08
  0.00000000e+00 -1.23853807e-08  1.85780706e-08  2.47707614e-08
  0.00000000e+00  0.00000000e+00 -3.09634522e-08  1.23853807e-08
 -6.19269036e-09 -1.47076396e-08 -4.10265741e-08  1.23853807e-08
  1.85780706e-08  6.19269036e-09  6.96677649e-09], edge=[ 1.12264156e+00  3.39622641e+00  0.00000000e+00  1.01215436e-08
  4.49846382e-09  0.00000000e+00 -1.68692393e-09  1.12461596e-09
  8.99692765e-09  6.74769574e-09 -8.99692765e-09 -1.12461596e-08
 -1.34953915e-08 -1.57446234e-08 -2.24923191e-08 -2.24923191e-09
 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09 -2.24923191e-09
 -2.24923191e-09  0.00000000e+00]
2025-06-06 15:41:41,738 - DEBUG - Updated reference std: node=[1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575], edge=[0.3573135 2.0502229 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506]
2025-06-06 15:41:41,738 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,738 - INFO - Running anomaly detection...
2025-06-06 15:41:41,738 - INFO - Starting anomaly detection.
2025-06-06 15:41:41,742 - DEBUG - Node reconstruction errors: [ 6.6697536  6.034093   6.0966096  6.1887116  6.38149    6.753574
  6.1703124  5.926634   6.2326164  6.3725777  6.3494935  7.8260827
 16.058582   6.1893306  6.5168953  5.7600727  6.4433303  5.7427077
  6.4909525  8.959503   8.68073   16.561888  18.935349   9.652074
  5.976031   6.495143   6.055005   6.3602066 20.788681   6.3930016
 11.904905   5.9925904  6.516423   7.1368794  6.1621437  6.402299
 10.372627   5.585895   6.3478193  6.524582   6.529934   6.48551
  7.6586056  6.3090186 17.144365   7.7441173 16.157633   6.5282016
  6.390477   6.267991  10.633797   6.9012566  5.940012   7.754141
  6.1348925  6.3846908  6.345148   8.06971    6.426406   7.608092
 11.6900015 19.759056   6.424305   5.1177373  9.209017   6.3407035
  7.18696    6.2094517  5.0547013  6.6106744  6.5645285  6.3734117
  5.097734   6.6099677  3.5586338  6.3522015  6.199326 ]
2025-06-06 15:41:41,742 - DEBUG - Edge reconstruction errors: [0.78275394 0.77895916 0.7685737  0.19999999 0.7472789  0.7683065
 0.7999592  0.78376204 0.7441011  0.79653484 0.77834475 0.7570937
 0.7993869  0.7550047  0.76434267 0.33041123 0.39989704 0.7955414
 0.79917276 0.7153391  0.64010733 0.7404414  0.75604    0.6964423
 0.67452526 0.6982323  0.7999858  0.7005317  0.72937244 0.7992671
 0.7974027  0.7186488  0.7391583  0.79847974 0.7993155  0.7925733
 0.7945888  0.79989004 0.7650154  0.79902434 0.7483051  0.1819328
 0.1992405  0.6093446  0.56435484 0.6765055  0.69646466 0.70282626
 0.19999999 0.37024632 0.42660996 0.7777605  0.0387373  0.6239681
 0.6069164  0.33857125 0.66682273 0.66985726 0.1866715  0.19973505
 0.5098774  0.5998737  0.19995195 0.28456777 0.42838538 0.19838113
 0.79999626 0.7146289  0.7980358  0.6987958  0.7253273  0.6356218
 0.7841087  0.23722798 0.51216686 0.42425603 0.45877498 0.10927778
 0.79243314 0.5939874  0.7994575  0.600361   0.4646882  0.47893748
 0.06288379 0.27928948 0.49300423 0.7955092  0.7991528  0.6634201
 0.7652898  0.79781806 0.79735416 0.7910111  0.79363364 0.7989836
 0.79756427 0.7999464  0.79997694 0.7999965  0.799391   0.7989743
 0.799628   0.7999469  0.7994993  0.7999866 ]
2025-06-06 15:41:41,743 - ERROR - An error occurred while processing file nw_graph_encoded_1749044348.dot: name 'datetime' is not defined
2025-06-06 15:41:41,744 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:41,744 - INFO - 
--- Processing file: nw_graph_encoded_1749044408.dot ---
2025-06-06 15:41:41,744 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot
2025-06-06 15:41:41,744 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044408.dot file.
2025-06-06 15:41:41,745 - INFO - Parsed 131 nodes.
2025-06-06 15:41:41,747 - INFO - Parsed 188 edges.
2025-06-06 15:41:41,756 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,756 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,757 - DEBUG - Initial node features tensor shape: torch.Size([131, 19])
2025-06-06 15:41:41,757 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,757 - DEBUG - Node features tensor shape after scaling: torch.Size([131, 19])
2025-06-06 15:41:41,758 - DEBUG - Edge index tensor shape: torch.Size([2, 188])
2025-06-06 15:41:41,758 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,759 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:41,759 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-06 15:41:41,759 - DEBUG - Shape of encoded categorical edge features: torch.Size([188, 2])
2025-06-06 15:41:41,760 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,760 - DEBUG - Shape of scaled numerical edge features: torch.Size([188, 20])
2025-06-06 15:41:41,760 - DEBUG - Final edge attributes tensor shape: torch.Size([188, 22])
2025-06-06 15:41:41,760 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,760 - INFO - Performing online update...
2025-06-06 15:41:41,760 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,761 - DEBUG - Updated RunningStats: new_mean=[-6.44984268e-10  8.85045676e-10  3.72529030e-09 -1.98990662e-09
 -4.44258222e-09 -1.00883638e-08  6.29365814e-09 -3.28565977e-09
  2.42953715e-09  5.09045879e-10  8.14473407e-09 -6.33993504e-09
  8.88516444e-09 -1.48548843e-08 -4.11864393e-09  1.22633780e-09
  2.91544458e-09  1.63704527e-09 -1.48086074e-08], new_M2=[321.99999523 321.99999523 321.99999863 321.99999455 321.99999856
 322.00000751 321.99999311 321.99999082 322.00001621 322.00000323
 322.00000185 321.99998759 321.99999512 322.0000072  322.00000962
 322.00000456 322.00000147 322.00000846 322.00001679], new_n=322
2025-06-06 15:41:41,761 - DEBUG - Updated RunningStats: new_mean=[ 1.01781737e+00  3.35857461e+00  1.55514276e-09 -1.49758329e-09
  2.64436496e-09  2.07473364e-09  4.41626320e-09 -2.30549007e-09
 -2.82209927e-09  5.10516189e-09  1.54321603e-09 -4.85619126e-09
  2.58758332e-09  1.29016178e-09 -5.60038074e-09  2.21422461e-10
  2.21422461e-10  2.21422461e-10  2.21422461e-10  2.21422461e-10
  2.21422461e-10 -3.50542350e-10], new_M2=[ 127.85746102 1905.26948775  449.00001597  448.9999865   449.00001748
  449.00001113  448.99999754  448.99999349  448.99999944  448.99999695
  449.00000829  449.00000971  448.99999991  449.00000464  449.00001413
  449.00000039  449.00000039  449.00000039  449.00000039  449.00000039
  449.00000039  448.9999978 ], new_n=449
2025-06-06 15:41:41,761 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999999 1.         1.00000001
 0.99999999 0.99999999 1.00000003 1.00000001 1.         0.99999998
 0.99999999 1.00000001 1.00000001 1.00000001 1.         1.00000001
 1.00000003]
2025-06-06 15:41:41,761 - DEBUG - Calculated standard deviation: [0.53362955 2.05994221 1.00000002 0.99999998 1.00000002 1.00000001
 1.         0.99999999 1.         1.         1.00000001 1.00000001
 1.         1.00000001 1.00000002 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:41,761 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,761 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,761 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,761 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,761 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,762 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,762 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,763 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,763 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,764 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,764 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,764 - DEBUG - Current node mean: [-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], current edge mean: [ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:41:41,764 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.4052
2025-06-06 15:41:41,764 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:41:41,764 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:41:41,764 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:41:41,765 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:41:41,766 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:41:41,767 - INFO - Optimizer and scheduler reset.
2025-06-06 15:41:41,767 - DEBUG - Updated reference mean: node=[-3.6399783e-09  7.2799566e-09 -2.1839870e-08 -1.4559913e-08
 -1.2739924e-08 -5.4599674e-08  2.5479848e-08  1.4559913e-08
 -1.4559913e-08  1.2739924e-08  1.8199891e-08 -2.1839870e-08
 -2.5479848e-08 -4.0039762e-08 -7.2799566e-09 -3.6399783e-09
 -2.1839870e-08 -7.2799566e-09 -1.4559913e-08], edge=[ 1.2340425e+00  3.4840426e+00  5.0727356e-09 -2.5363678e-09
  0.0000000e+00  2.5363678e-09  1.5218207e-08 -2.5363678e-09
 -7.6091036e-09  1.0145471e-08  0.0000000e+00 -1.0145471e-08
 -5.0727356e-09 -7.6091036e-09 -7.6091036e-09 -5.0727356e-09
 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09 -5.0727356e-09
 -5.0727356e-09 -6.3409198e-09]
2025-06-06 15:41:41,767 - DEBUG - Updated reference std: node=[1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388
 1.0038388 1.0038388 1.0038388 1.0038388 1.0038388], edge=[0.43694445 2.0172415  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026702  1.0026703  1.0026702  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703  1.0026703  1.0026703
 1.0026703  1.0026703  1.0026703  1.0026703 ]
2025-06-06 15:41:41,767 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,767 - INFO - Running anomaly detection...
2025-06-06 15:41:41,767 - INFO - Starting anomaly detection.
2025-06-06 15:41:41,771 - DEBUG - Node reconstruction errors: [14.534077  10.568157  14.640283  13.663094   9.047254  13.867737
 10.397591  10.021645  13.657109  13.587842   9.938199  13.339841
 14.96425   14.96425   13.648766  18.162922  10.019645  29.30395
 18.772022  19.426058  15.573226  13.574547  12.821293  13.709315
 13.702884  13.800767  11.9883795 23.26531   14.964254  13.433917
 13.859748  23.797935  14.294413  17.047178  13.6335    15.932087
 13.875028  14.629589  13.64117   13.5764065 12.624434  13.42218
 20.586477  13.650635  23.38062   16.172552  15.606866  13.767367
 15.311424  14.6147785 13.770754  31.018597  13.676241  13.348505
 14.419248  18.20103   32.053375  18.466537  18.190058  10.278577
 14.619019  13.700141  13.72273   14.944134  13.652226  15.179254
 13.652205  14.6327915 14.56639   10.580805  15.08582   19.512821
 15.697614  19.382202  13.6521635 13.690266  24.247816  15.163759
 14.336001  14.697444  12.5269375 13.876242  17.90913   13.256821
 13.46477   23.380219  14.54117   13.651229  20.943638  22.04498
 23.379591  10.428848   9.941947  13.785931  12.199444  19.538227
 10.021471  16.94822   14.488869  19.500242  19.470325  13.794187
 19.483948  10.158415  13.463748  10.428847   8.899129  13.899996
 13.62928    9.919284  13.5494    10.428845  10.2705145  9.984608
 10.279805  19.553534  10.301105  22.402319  14.496986  14.79232
 10.368808  14.989324  14.989324  14.79214   19.460028  19.46699
 19.448675  14.577954  14.772302  15.951984  19.454855 ]
2025-06-06 15:41:41,772 - DEBUG - Edge reconstruction errors: [0.19999963 0.19670957 0.19999784 0.19999987 0.19984418 0.8
 0.19995874 0.19999582 0.19997269 0.19999951 0.19999927 0.199987
 0.19999748 0.19999892 0.19999951 0.19997686 0.19999999 0.19999987
 0.19999951 0.19999999 0.19968075 0.19999927 0.19999999 0.19999999
 0.19999963 0.19999939 0.19999927 0.19998139 0.19999951 0.19999963
 0.19993037 0.19998854 0.19999295 0.19999415 0.7727376  0.19999474
 0.19999999 0.1999914  0.195018   0.19999999 0.19999999 0.19999999
 0.19999999 0.19999987 0.19999999 0.19999617 0.19999427 0.1999957
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999796 0.19999987 0.19999951 0.19999892 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999987 0.19999999
 0.19999951 0.19999999 0.19881588 0.19659817 0.19999915 0.19999927
 0.19999999 0.19999999 0.19999856 0.8        0.19999999 0.19999999
 0.19999999 0.19999999 0.19999975 0.19999951 0.19879764 0.19999999
 0.19999558 0.19999951 0.19999987 0.19999999 0.19999963 0.19999617
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999 0.19999927
 0.19999999 0.19999975 0.19999999 0.19999987 0.19999856 0.19999903
 0.19999999 0.19999999 0.19968897 0.09841174 0.21124017 0.19999903
 0.19999355 0.8        0.19999999 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999951 0.19998246 0.19999999 0.19999951
 0.19999987 0.19999999 0.19999951 0.19999975 0.19999737 0.19999987
 0.1999889  0.19999927 0.19999856 0.19998878 0.19999903 0.1999889
 0.19999987 0.19999915 0.19999593 0.19997495 0.19999999 0.19999593
 0.19999903 0.19998246 0.19999987 0.19999844 0.1999864  0.19999784
 0.19998509 0.1999951  0.19996947 0.19999975 0.19999546 0.19999999
 0.19999999 0.19999927 0.19999081 0.19999963 0.19999617 0.10100508
 0.12725163 0.19923705 0.19418913 0.19999701 0.19997662 0.19999987
 0.19999975 0.19999987 0.19999999 0.19999987 0.19999999 0.19999987
 0.1999988  0.19998342 0.19999999 0.19999975 0.19999927 0.19999999
 0.19999999 0.19999987 0.19999844 0.19999808 0.19999999 0.19999999
 0.19999999 0.19999987 0.67008424 0.18208617 0.05831957 0.2355339
 0.13788444 0.12523144]
2025-06-06 15:41:41,772 - ERROR - An error occurred while processing file nw_graph_encoded_1749044408.dot: name 'datetime' is not defined
2025-06-06 15:41:41,773 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:41,773 - INFO - 
--- Processing file: nw_graph_encoded_1749044468.dot ---
2025-06-06 15:41:41,773 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot
2025-06-06 15:41:41,773 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044468.dot file.
2025-06-06 15:41:41,776 - INFO - Parsed 258 nodes.
2025-06-06 15:41:41,780 - INFO - Parsed 397 edges.
2025-06-06 15:41:41,812 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,812 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,813 - DEBUG - Initial node features tensor shape: torch.Size([258, 19])
2025-06-06 15:41:41,814 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,814 - DEBUG - Node features tensor shape after scaling: torch.Size([258, 19])
2025-06-06 15:41:41,815 - DEBUG - Edge index tensor shape: torch.Size([2, 397])
2025-06-06 15:41:41,815 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,817 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:41,817 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:41,818 - DEBUG - Shape of encoded categorical edge features: torch.Size([397, 2])
2025-06-06 15:41:41,818 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,818 - DEBUG - Shape of scaled numerical edge features: torch.Size([397, 20])
2025-06-06 15:41:41,818 - DEBUG - Final edge attributes tensor shape: torch.Size([397, 22])
2025-06-06 15:41:41,818 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,818 - INFO - Performing online update...
2025-06-06 15:41:41,819 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,819 - DEBUG - Updated RunningStats: new_mean=[ 1.55755672e-10  2.34436372e-10 -7.28358482e-09 -5.72281665e-09
 -7.39919728e-09  7.70749717e-10  9.35176323e-09  2.13240755e-09
  1.34881200e-09  9.76282975e-10 -3.08299887e-09 -7.21935568e-09
  1.43873280e-09 -2.82608230e-09 -4.47034836e-09 -5.52370630e-10
 -3.82805693e-09  1.45679725e-09 -7.81026380e-09], new_M2=[579.99999143 579.99999133 580.00000413 579.99996606 579.99999334
 580.00000764 579.99999452 579.99999339 580.00002839 579.99999643
 579.9999921  579.99999108 579.99999403 580.00000041 579.99999386
 580.0000112  580.00000608 580.00001307 580.00001297], new_n=580
2025-06-06 15:41:41,819 - DEBUG - Updated RunningStats: new_mean=[ 1.16193853e+00  3.91843972e+00  2.26273681e-09  3.49383572e-10
  1.89388188e-09  3.40129517e-10  3.87514406e-09 -2.60407039e-09
 -1.90003979e-09  5.65646362e-09  5.06392889e-10 -5.48111820e-09
  1.15314468e-09 -2.19510309e-09 -2.29197825e-09  8.96095243e-10
  8.96095243e-10  8.96095243e-10  8.96095243e-10  8.96095243e-10
  8.96095243e-10  2.47141747e-10], new_M2=[ 236.8144208  4125.37234043  846.00002633  846.00002244  846.00003338
  845.99997859  845.99998299  845.99998938  845.99999038  845.99999217
  846.00003061  846.0000252   846.00000333  846.00000551  846.00000533
  846.00001671  846.00001671  846.00001671  846.00001671  846.00001671
  846.00001671  846.00000252], new_n=846
2025-06-06 15:41:41,819 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         0.99999997 0.99999999 1.00000001
 1.         0.99999999 1.00000002 1.         0.99999999 0.99999999
 0.99999999 1.         0.99999999 1.00000001 1.00000001 1.00000001
 1.00000001]
2025-06-06 15:41:41,820 - DEBUG - Calculated standard deviation: [0.52907701 2.20824062 1.00000002 1.00000001 1.00000002 0.99999999
 0.99999999 0.99999999 0.99999999 1.         1.00000002 1.00000001
 1.         1.         1.         1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 1.        ]
2025-06-06 15:41:41,820 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,820 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,820 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,821 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,821 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,822 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,822 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,822 - DEBUG - Current node mean: [ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], current edge mean: [ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:41:41,822 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.3081
2025-06-06 15:41:41,822 - WARNING - Feature drift detected (1 consecutive)
2025-06-06 15:41:41,823 - DEBUG - Updated reference mean: node=[ 4.0660534e-08 -3.8812328e-08 -9.2410302e-09 -2.2178472e-08
 -1.1089236e-08  1.4785648e-08 -6.4687211e-09  1.3861546e-08
  0.0000000e+00  3.5115914e-08 -2.0330267e-08 -2.0330267e-08
 -2.7723091e-08  1.6633855e-08  1.6633855e-08 -1.1089236e-08
  3.6964121e-09  0.0000000e+00  7.3928241e-09], edge=[ 1.3249370e+00  4.5516372e+00  6.0055059e-09 -4.8044044e-09
  9.0082590e-09 -4.8044044e-09  4.8044044e-09 -6.6060561e-09
  8.4077083e-09  2.4022022e-09  1.5614315e-08 -2.4022022e-09
 -6.0055059e-09 -1.2011012e-08 -7.2066069e-09 -4.8044044e-09
 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09 -4.8044044e-09
 -4.8044044e-09 -8.4077083e-09]
2025-06-06 15:41:41,823 - DEBUG - Updated reference std: node=[1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436 1.0019436 1.0019436
 1.0019436 1.0019437 1.0019436 1.0019436 1.0019436], edge=[0.47429672 2.2020373  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618  1.0012618  1.0012618
 1.0012618  1.0012618  1.0012618  1.0012618 ]
2025-06-06 15:41:41,823 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,823 - INFO - Running anomaly detection...
2025-06-06 15:41:41,823 - INFO - Starting anomaly detection.
2025-06-06 15:41:41,829 - DEBUG - Node reconstruction errors: [23.444918 25.01373  23.674973 20.241035 25.207987 25.007889 25.088913
 25.521307 20.284786 20.226809 20.015976 36.549496 25.555359 28.114502
 20.058884 28.106836 28.083857 25.656631 18.682592 20.767347 25.745375
 20.589188 25.241846 20.628155 25.232668 25.541498 19.371    19.87734
 20.089209 23.607113 20.107395 20.229008 25.564213 27.878174 29.104345
 31.553865 20.526615 20.188162 20.562922 20.2372   20.545975 27.883574
 26.704857 19.575356 27.57106  25.369064 20.471857 29.513222 19.532173
 25.808975 28.876272 20.55709  20.553913 25.046412 20.233038 20.348671
 22.92039  25.265926 20.144983 25.669703 20.136541 20.513481 20.771748
 20.642725 20.313494 20.428207 20.820732 20.34057  20.613613 20.556051
 20.236635 27.521696 20.538977 20.128942 25.746632 25.398615 19.48254
 20.556297 20.238611 26.128773 25.588837 25.527405 19.794153 19.859089
 24.920162 46.168274 19.54302  19.968569 20.606953 20.066036 25.522139
 20.106752 20.116743 20.318777 27.454065 26.840601 20.779652 20.502691
 22.759808 25.46281  23.127907 27.854652 25.081211 20.414167 20.230124
 28.885794 20.294672 20.009106 19.738174 20.429869 20.660843 20.913969
 29.989107 25.522167 20.233456 28.173597 23.591883 21.038643 30.639725
 29.387808 20.237753 45.86854  25.120892 19.83825  23.130192 27.60606
 39.390106 20.021358 20.69209  25.087729 20.5608   20.237747 19.055904
 20.431679 28.844505 28.684486 25.243568 20.037989 29.379766 42.67035
 27.993393 21.137806 20.239151 20.297306 27.448914 20.00847  20.128164
 20.083433 20.466778 20.553373 21.058985 20.128202 20.134056 20.292374
 20.783546 20.22543  28.236732 20.234728 27.55479  20.117271 20.61707
 20.002378 27.929804 20.284786 19.354067 20.55709  29.521906 19.93577
 25.09955  24.655249 20.814785 25.575863 20.121895 28.926022 24.284327
 20.405247 20.229599 20.129349 20.346909 20.532564 21.146612 20.301346
 20.604477 20.236637 20.617306 20.064318 20.290276 20.549639 20.24265
 45.733177 20.275501 25.590927 20.608698 20.407866 20.595024 20.617031
 23.67608  25.538496 20.122822 20.921402 15.616361 20.61423  20.59109
 20.364939 25.597532 20.240047 20.520132 23.558313 20.292374 25.599998
 23.34176  20.580448 20.23327  20.072876 23.558315 20.113811 19.58065
 20.13526  27.647387 20.135107 20.126266 25.00995  20.292374 25.590937
 29.555157 20.22972  20.126488 20.384409 20.231781 20.918926 25.030228
 20.570152 20.614094 20.128288 23.01504  20.23159  20.568283 20.080988
 20.231714 28.18895  25.61595  20.234838 20.611578 19.92811  20.61883
 20.054825 20.292374 24.92826  20.551075 22.87477  25.136053 20.313494
 20.274704 20.0211   27.629267 19.95204  20.236307 25.538214]
2025-06-06 15:41:41,831 - DEBUG - Edge reconstruction errors: [0.099361   0.13055593 0.1861425  0.552746   0.44947052 0.07604694
 0.59452903 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999784 0.19999999 0.19999987 0.19999999 0.19999868 0.19999641
 0.1999963  0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999582 0.19999987 0.19999975 0.19999892 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999999 0.19999892 0.19999999 0.19999999 0.19999999 0.19999868
 0.19999951 0.19999999 0.19999999 0.19999784 0.19955516 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999892 0.19999999 0.19999987
 0.19999987 0.18307436 0.19999999 0.19998461 0.19999951 0.19999999
 0.19999999 0.19999868 0.19999915 0.19999367 0.1999895  0.8
 0.19999999 0.19999999 0.19999975 0.19999999 0.19999999 0.19999999
 0.19999927 0.19999999 0.19999999 0.19999987 0.19999939 0.13809627
 0.19999987 0.19999963 0.19999677 0.1999982  0.19999677 0.19999868
 0.19999987 0.19999856 0.19999975 0.19999987 0.1999982  0.1999982
 0.19999713 0.19999915 0.19999856 0.19999999 0.19999999 0.19999987
 0.8        0.19999796 0.19999975 0.19999832 0.19999999 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999999 0.19999963 0.19999951
 0.19999272 0.8        0.19999999 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999617
 0.19998115 0.19999999 0.19984287 0.19887257 0.19999963 0.19999975
 0.19999653 0.19999999 0.19999999 0.19999677 0.19999272 0.19997698
 0.19982588 0.19999963 0.19999868 0.1999802  0.19999975 0.19999939
 0.19998592 0.19999808 0.19999975 0.19999999 0.19999975 0.19999999
 0.19999975 0.19999915 0.19999272 0.19999975 0.19999999 0.19999999
 0.19999999 0.19999641 0.19999999 0.19999379 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999856 0.19999963 0.19999975 0.19999963 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999975 0.19999963 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999951 0.1999901  0.19999999 0.19999975
 0.19999999 0.19999999 0.19999903 0.19998783 0.19999379 0.19989938
 0.19999999 0.19999999 0.19999975 0.19999987 0.1999982  0.19997317
 0.19999689 0.19994253 0.1999982  0.19997317 0.19999975 0.19999975
 0.19999975 0.19999808 0.19999987 0.19999892 0.19999987 0.19999796
 0.19999999 0.19999987 0.19993919 0.199233   0.19999796 0.19997352
 0.19999999 0.19999951 0.19999975 0.19999987 0.19999975 0.19996291
 0.19977903 0.19999999 0.19999951 0.19999975 0.19999999 0.19999963
 0.19999975 0.19999701 0.1999616  0.19979525 0.19999963 0.19999975
 0.19999999 0.19999999 0.19996184 0.19999999 0.19994587 0.7978826
 0.19997615 0.19999903 0.19999379 0.19999021 0.19999248 0.8
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999963 0.1999889  0.19999999 0.19999892 0.19999999 0.19999999
 0.19999999 0.19999975 0.19999593 0.19999987 0.19999427 0.19999987
 0.19999808 0.19999939 0.19999987 0.1999976  0.19999999 0.19999999
 0.19999975 0.19999748 0.19957983 0.19999987 0.19999951 0.19999129
 0.19999987 0.19999963 0.19999439 0.19999963 0.19999558 0.19999856
 0.19998068 0.19999999 0.19999975 0.1999957  0.19999999 0.19999999
 0.19999975 0.1999957  0.19999987 0.19999915 0.19998652 0.19991487
 0.19999999 0.19999987 0.19999999 0.19999999 0.19999737 0.19999212
 0.19999963 0.19999999 0.19990689 0.19926012 0.19999999 0.19999999
 0.19999963 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999951 0.19999868 0.19998258 0.19999999 0.19999737 0.19996649
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999975 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999975 0.19999999 0.19999999 0.19999999 0.19999963 0.19999951
 0.19999999 0.19999999 0.19999987 0.1999951  0.19999987 0.19999808
 0.19999963 0.1999988  0.19999951 0.19999951 0.19999999 0.19999975
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999
 0.19999963 0.19999963 0.19999963 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999892 0.19999999 0.19999951 0.19999951 0.19999951
 0.19999963 0.19999999 0.19999999 0.19999975 0.19999963 0.19999951
 0.19999963 0.19999999 0.19999999 0.19999725 0.19999987 0.19999999
 0.19999975 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999951 0.19999999 0.19999999 0.19999999
 0.19999963 0.19999999 0.19999951 0.19999963 0.19999999 0.19999999
 0.19999963]
2025-06-06 15:41:41,832 - ERROR - An error occurred while processing file nw_graph_encoded_1749044468.dot: name 'datetime' is not defined
2025-06-06 15:41:41,833 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:41,833 - INFO - 
--- Processing file: nw_graph_encoded_1749044528.dot ---
2025-06-06 15:41:41,833 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot
2025-06-06 15:41:41,833 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044528.dot file.
2025-06-06 15:41:41,837 - INFO - Parsed 365 nodes.
2025-06-06 15:41:41,843 - INFO - Parsed 656 edges.
2025-06-06 15:41:41,916 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:41,916 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:41,919 - DEBUG - Initial node features tensor shape: torch.Size([365, 19])
2025-06-06 15:41:41,921 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:41,922 - DEBUG - Node features tensor shape after scaling: torch.Size([365, 19])
2025-06-06 15:41:41,922 - DEBUG - Edge index tensor shape: torch.Size([2, 656])
2025-06-06 15:41:41,922 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:41,926 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:41,926 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:41,927 - DEBUG - Shape of encoded categorical edge features: torch.Size([656, 2])
2025-06-06 15:41:41,928 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:41,928 - DEBUG - Shape of scaled numerical edge features: torch.Size([656, 20])
2025-06-06 15:41:41,928 - DEBUG - Final edge attributes tensor shape: torch.Size([656, 22])
2025-06-06 15:41:41,928 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:41,928 - INFO - Performing online update...
2025-06-06 15:41:41,928 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:41,929 - DEBUG - Updated RunningStats: new_mean=[ 3.56464947e-09 -3.16748228e-09 -6.45716985e-09 -2.53477425e-09
  2.52294793e-09  4.32054832e-09 -6.54679117e-09  1.84490567e-09
  8.27842289e-10  5.10896955e-09  2.69640060e-09 -4.19440093e-09
 -7.88421227e-10  4.38362202e-09 -3.46905340e-09 -3.39021128e-10
 -7.58461221e-09  1.44650657e-09 -1.00602549e-08], new_M2=[944.99999157 944.99999134 945.00001828 944.99998346 944.99998883
 944.99998871 944.99998599 945.00000337 945.00003147 945.00001633
 945.00000075 944.99998793 945.00002691 944.99998148 944.99998496
 945.0000052  945.00001674 944.99998454 945.00002454], new_n=945
2025-06-06 15:41:41,929 - DEBUG - Updated RunningStats: new_mean=[ 1.25765646e+00  4.28761651e+00 -2.99564060e-11 -5.42083063e-10
  1.26033925e-09 -6.09378405e-10 -9.57335819e-10 -4.70389207e-10
 -7.43271526e-10  2.66933667e-10 -1.60346217e-09 -1.37154223e-09
  1.55106752e-09 -5.52220962e-09 -2.03068005e-09  1.37388681e-09
  1.37388681e-09  1.37388681e-09  1.37388681e-09  1.37388681e-09
  1.37388681e-09 -4.28768016e-10], new_M2=[ 417.28695073 7027.74966711 1501.99999287 1501.9999764  1502.00004876
 1501.99995557 1501.99998953 1502.0000141  1501.99998456 1502.00000067
 1501.9999894  1502.00000755 1501.99999931 1502.00001357 1501.99997549
 1502.00005719 1502.00005719 1502.00005719 1502.00005719 1502.00005719
 1502.00005719 1501.99996955], new_n=1502
2025-06-06 15:41:41,930 - DEBUG - Calculated standard deviation: [1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 1.         1.00000002 1.00000001 1.         0.99999999
 1.00000001 0.99999999 0.99999999 1.         1.00000001 0.99999999
 1.00000001]
2025-06-06 15:41:41,930 - DEBUG - Calculated standard deviation: [0.52708716 2.16308296 1.         0.99999999 1.00000002 0.99999999
 1.         1.         0.99999999 1.         1.         1.
 1.         1.         0.99999999 1.00000002 1.00000002 1.00000002
 1.00000002 1.00000002 1.00000002 0.99999999]
2025-06-06 15:41:41,930 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:41,930 - DEBUG - Online update step: 1/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 2/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 3/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 4/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 5/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 6/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 7/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 8/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 9/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 10/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 11/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 12/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 13/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 14/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,930 - DEBUG - Online update step: 15/50
2025-06-06 15:41:41,930 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 16/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 17/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 18/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 19/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 20/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 21/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 22/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 23/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 24/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 25/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 26/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 27/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 28/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 29/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 30/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 31/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 32/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 33/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 34/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 35/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,931 - DEBUG - Online update step: 36/50
2025-06-06 15:41:41,931 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 37/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 38/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 39/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 40/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 41/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 42/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 43/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 44/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 45/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 46/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 47/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 48/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 49/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - DEBUG - Online update step: 50/50
2025-06-06 15:41:41,932 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:41,932 - WARNING - No successful steps during online update.
2025-06-06 15:41:41,933 - DEBUG - Current node mean: [ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], current edge mean: [ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:41:41,933 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2342
2025-06-06 15:41:41,933 - WARNING - Feature drift detected (2 consecutive)
2025-06-06 15:41:41,934 - DEBUG - Updated reference mean: node=[ 3.3966483e-08 -3.3966483e-08 -3.1353675e-08 -3.3966483e-08
  1.5676838e-08  1.5676838e-08 -3.1353675e-08 -1.3064032e-09
  1.3064032e-09  3.9192094e-09  2.0902451e-08 -1.6983241e-08
 -1.1104427e-08 -1.3717234e-08 -2.8740869e-08  1.4370435e-08
 -4.5724109e-09 -4.7030515e-08  2.6128064e-09], edge=[ 1.3810976e+00  4.7637196e+00  7.2688588e-10 -4.3613153e-09
  0.0000000e+00 -1.4537718e-09 -5.0882014e-09  1.8172148e-09
  8.7226306e-09  7.2688588e-10 -4.3613153e-09  4.3613153e-09
 -1.4537718e-09 -2.0352806e-08 -2.0352806e-08 -1.4537718e-09
 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09 -1.4537718e-09
 -1.4537718e-09  2.9075435e-09]
2025-06-06 15:41:41,934 - DEBUG - Updated reference std: node=[1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727
 1.0013727 1.0013727 1.0013727 1.0013727 1.0013727], edge=[0.4984336 2.0070016 1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763  1.000763  1.000763  1.000763  1.000763  1.000763  1.000763
 1.000763 ]
2025-06-06 15:41:41,934 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:41,934 - INFO - Running anomaly detection...
2025-06-06 15:41:41,934 - INFO - Starting anomaly detection.
2025-06-06 15:41:42,155 - DEBUG - Node reconstruction errors: [22.444687 22.148102 22.53258  22.537357 22.53907  22.549208 22.53784
 22.504683 22.546589 22.022657 22.55558  22.52339  22.289465 22.411463
 22.23884  22.43549  26.905218 29.299503 22.23093  22.74141  21.662443
 22.488234 27.07837  22.538933 24.239822 27.072262 22.529364 28.863623
 22.741117 28.991943 28.989426 22.46968  22.497257 22.834055 28.975784
 22.487051 28.759605 22.475876 22.323904 22.471586 22.382858 27.132488
 29.001225 25.827091 25.827091 25.827091 28.856186 21.878035 30.158157
 22.461767 22.461767 22.496681 22.61218  28.923223 22.31983  29.24761
 22.33277  22.41494  22.468733 22.451553 22.437965 22.434454 24.244114
 22.480375 22.315262 22.450642 22.498146 29.620285 27.095999 27.080618
 27.467178 27.316753 27.09181  23.223494 29.432302 27.330257 27.35343
 22.273903 29.322767 27.348206 22.495695 21.143559 22.596481 42.602642
 29.360634 31.289612 28.831459 31.279814 25.918058 31.200243 28.386282
 21.631104 22.631304 24.112411 29.485098 24.132755 27.636475 28.288324
 29.260607 29.349756 28.742432 22.288387 23.761816 27.546127 22.06077
 29.017212 28.964497 30.759436 22.31024  29.659876 30.867437 33.441746
 23.969105 22.773787 31.210224 22.489742 24.24734  29.564678 35.89096
 22.425999 29.028673 27.61695  27.17304  23.081884 30.641901 22.327795
 28.964848 28.756771 32.15303  23.292143 22.556976 23.292147 27.399002
 22.765123 22.748468 25.742249 29.23317  22.347662 28.754948 22.59281
 23.753128 23.793512 23.697607 28.94581  23.346146 23.728582 31.131079
 31.129501 23.29215  22.504953 29.007105 22.699364 24.240412 22.917048
 28.558697 29.210314 23.717567 24.13886  22.497719 28.71984  29.32107
 27.785269 22.43521  22.67007  27.03988  28.912218 54.943687 22.459011
 28.934654 22.417158 24.418892 22.594542 29.275639 28.980665 22.488754
 31.116522 30.472975 33.50174  23.68072  31.107264 26.364737 32.567223
 22.743986 26.067526 29.620104 27.296432 23.204702 22.491356 31.675095
 23.232122 22.877657 22.76554  23.220295 21.99474  24.192581 23.760668
 32.67974  29.350586 28.942993 31.224064 26.989325 24.150976 33.11833
 32.101803 22.50617  55.591385 28.929438 22.482204 28.50532  22.74722
 27.2379   29.035847 46.972824 22.769592 23.411657 21.82408  27.32265
 22.62189  23.29215  22.506159 21.098215 23.222013 32.33094  31.338713
 29.219315 23.655367 22.46538  31.766142 48.206356 34.04046  29.484482
 22.477846 23.723324 31.142748 22.91891  29.149902 28.989782 24.239414
 28.720444 24.722052 27.015024 22.731789 23.605911 30.547174 24.38958
 29.071875 31.119318 22.641935 30.530287 24.899925 22.148466 24.142624
 28.984756 31.08711  22.578596 28.857092 22.438536 23.29215  31.791729
 28.977665 27.274094 22.560074 28.799467 29.043316 29.3288   22.497698
 27.381882 33.325294 26.600336 31.168392 23.887548 22.17698  23.974741
 31.147997 22.50074  24.733444 22.968145 24.13275  22.504969 24.136738
 31.1404   23.952866 31.136578 22.48038  53.825817 23.90113  30.303583
 24.136948 24.030605 22.427618 22.50385  24.120659 31.416925 27.061693
 27.676289 29.223225 22.46575  22.476105 23.76067  20.851845 31.168682
 24.125008 31.014494 29.348963 28.854177 23.291162 27.615177 22.575336
 32.748627 27.313387 24.133276 22.759369 22.438124 33.30986  22.946947
 28.854464 29.125586 30.391338 22.656387 22.481604 30.557735 22.103043
 22.575336 31.158688 22.728241 31.366318 22.500433 22.483276 24.260212
 22.500362 23.760668 30.448355 24.11687  22.14008  24.140957 22.63685
 25.88389  22.460165 22.49976  25.806011 24.134817 22.60154  22.537758
 23.001953 22.544964 31.318256 31.202396 22.50313  24.138    30.994665
 24.143854 23.994581 22.575336 44.89142  30.315058 24.247864 31.891489
 28.924208 27.075998 27.341965 28.817598 29.230553 28.860785 22.474121
 29.207811]
2025-06-06 15:41:42,159 - DEBUG - Edge reconstruction errors: [0.46652606 0.04615355 0.54233706 0.77420926 0.77420986 0.34572697
 0.7702643  0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999963 0.19999844 0.19999999 0.19999987 0.19999999
 0.19999737 0.19999582 0.1999945  0.19999999 0.19999999 0.19999999
 0.19999605 0.19999999 0.19999999 0.19999999 0.1999827  0.19999975
 0.19999927 0.19999808 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999903 0.19999999 0.19999999
 0.19999975 0.33279416 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999975 0.19999999 0.12205851
 0.19999999 0.19999999 0.1999566  0.1999982  0.19999999 0.19999999
 0.19999927 0.19999999 0.19999975 0.19999987 0.19996792 0.8
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999915 0.19999999 0.19999999 0.19999987 0.19999403 0.19999999
 0.19999999 0.19999951 0.19999212 0.19999486 0.19998592 0.1999628
 0.19999164 0.19999605 0.19999999 0.19948786 0.19999987 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999939 0.19999522 0.19999832
 0.19999999 0.19999987 0.19999868 0.19999832 0.19999999 0.19999176
 0.19991249 0.19999951 0.19993538 0.19851053 0.19999892 0.19999975
 0.19996232 0.19913566 0.19999999 0.19996077 0.1998542  0.19999975
 0.19999868 0.1999982  0.19999987 0.19999999 0.19999987 0.19999999
 0.19999987 0.19999737 0.19999999 0.19999999 0.19999784 0.19996148
 0.19999999 0.199987   0.1997559  0.19999987 0.19999796 0.19996506
 0.19999987 0.19999975 0.19999617 0.19998187 0.19999248 0.19998854
 0.1999945  0.19998652 0.19999999 0.19999987 0.19999653 0.19999987
 0.19999963 0.19999987 0.19999212 0.19984466 0.19999999 0.19999987
 0.19999892 0.19997674 0.19999474 0.19999951 0.19999951 0.19999939
 0.19999367 0.19999415 0.19999999 0.19999021 0.19998842 0.19999605
 0.19999176 0.19999713 0.19999069 0.19998354 0.1999566  0.79999995
 0.1999889  0.19999033 0.19999021 0.19999546 0.19999999 0.19996232
 0.19999868 0.19999951 0.19999856 0.19999355 0.19596654 0.19995517
 0.1999864  0.19999999 0.19999999 0.19999903 0.8        0.19999939
 0.19999999 0.19999975 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999 0.19999868
 0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999975
 0.19999999 0.19999796 0.19998151 0.19999987 0.19999999 0.19999987
 0.19999999 0.19999999 0.19999951 0.19999951 0.19999963 0.1999976
 0.19999999 0.19999999 0.19999844 0.19999999 0.19999987 0.19999653
 0.19996113 0.19999999 0.19999999 0.19999999 0.19999987 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999975 0.19999868 0.19998723 0.19999999 0.19999951
 0.19999796 0.19995672 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999 0.19999999
 0.19999892 0.19999999 0.19999999 0.19999903 0.19999951 0.19999999
 0.19999963 0.1999914  0.19999987 0.19999987 0.19999999 0.19999999
 0.19999987 0.19999999 0.19999999 0.19999963 0.19998723 0.19999999
 0.19999999 0.19999999 0.19999772 0.19997376 0.19999987 0.19999999
 0.19999939 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999665 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999617 0.19999999 0.19999987
 0.19999307 0.19999999 0.19999892 0.1999622  0.19999999 0.19999832
 0.19996446 0.19999999 0.19999999 0.19999892 0.19999975 0.19999713
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999975 0.19999117
 0.19999987 0.19999486 0.19999975 0.19998914 0.19999987 0.19999987
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999987
 0.19999999 0.19999987 0.19999796 0.19996494 0.19999975 0.19998986
 0.19999999 0.19999987 0.19999987 0.19999987 0.19999987 0.19999975
 0.19999772 0.19999999 0.19999915 0.1999827  0.19999999 0.19999999
 0.19999999 0.19999987 0.19999999 0.19999963 0.19999951 0.19999558
 0.19999987 0.19999987 0.19999999 0.19999999 0.19999975 0.19999796
 0.19999999 0.19999999 0.19999999 0.19999987 0.19999951 0.19997936
 0.19999844 0.19998187 0.19999987 0.19999987 0.19999677 0.19999832
 0.19997913 0.19999999 0.19999999 0.19999999 0.1999926  0.19999999
 0.19999987 0.1999988  0.19998807 0.19999999 0.19999379 0.19998759
 0.8        0.19999999 0.19999999 0.19999927 0.19999987 0.19999999
 0.19999999 0.19999975 0.1999852  0.19999999 0.19999975 0.19999999
 0.19999999 0.19999999 0.19999915 0.1999827  0.19999975 0.19998878
 0.19999975 0.19999999 0.19999999 0.19999999 0.19999951 0.19999987
 0.19999999 0.19999939 0.19997698 0.8        0.19999999 0.19999307
 0.19981563 0.19999975 0.19999903 0.1999672  0.19999975 0.19999987
 0.19999737 0.19999999 0.19999987 0.19999593 0.19999999 0.19999939
 0.19998795 0.19999963 0.19999999 0.19999999 0.19999903 0.19999963
 0.19999057 0.19999999 0.19999892 0.19999915 0.19997746 0.19946182
 0.19999999 0.19999963 0.19999999 0.19999999 0.19999129 0.19999129
 0.19999808 0.19999999 0.1999914  0.19994622 0.19999999 0.19999987
 0.19999868 0.19999999 0.19999915 0.19999999 0.19999999 0.19999939
 0.19999999 0.19999617 0.19999975 0.1999951  0.19999999 0.19997245
 0.19907564 0.19999999 0.19999999 0.19999999 0.19999975 0.19999439
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999915
 0.19996887 0.19999999 0.19999987 0.19999677 0.19999999 0.19999999
 0.19999593 0.19985014 0.19999987 0.19999951 0.19998986 0.19973743
 0.19999677 0.19999999 0.19999999 0.19999272 0.19990748 0.1999932
 0.19979835 0.1999988  0.19996315 0.19999999 0.19998664 0.19957018
 0.19999534 0.19999987 0.19999987 0.19999999 0.19999975 0.19999498
 0.19999999 0.19996661 0.19928265 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19999999 0.1999982
 0.19999796 0.19999939 0.1999945  0.19983476 0.19999999 0.19999999
 0.19999486 0.19995159 0.19999999 0.19999999 0.19999963 0.19999737
 0.19999999 0.19999999 0.19999748 0.19999748 0.1999982  0.19999999
 0.19999999 0.19999999 0.1999976  0.19999653 0.19999796 0.19999999
 0.19999927 0.19997436 0.19999999 0.19999236 0.19976294 0.19999808
 0.19999975 0.19999164 0.19999975 0.19999987 0.19999784 0.19999999
 0.19999999 0.1999945  0.19980264 0.19999999 0.19999999 0.19999963
 0.19999999 0.19999999 0.19999999 0.19999963 0.19999999 0.19999987
 0.19999999 0.19999868 0.19996995 0.19999999 0.19997925 0.19937062
 0.19999999 0.19999832 0.19996554 0.19999737 0.19999999 0.19999748
 0.19995612 0.19999999 0.19999951 0.19999951 0.19999081 0.19999999
 0.19999999 0.19999808 0.19993395 0.19999999 0.19999534 0.1998623
 0.19999999 0.19999939 0.19999439 0.1999262  0.19999999 0.19999951
 0.19999999 0.19999999 0.19999927 0.19999546 0.19999999 0.19999999
 0.19999796 0.19999892 0.19999987 0.19999999 0.19999999 0.19999987
 0.19999999 0.19999999 0.19999939 0.19999987 0.19999987 0.19999987
 0.19999987 0.19999999 0.19999999 0.19999593 0.19999617 0.19999331
 0.19999999 0.19999987 0.19999868 0.19999474 0.19984704 0.19999999
 0.19999439 0.19999999 0.19999999 0.19976974 0.19999999 0.19999999
 0.19999987 0.19999844 0.19999987 0.19999999 0.19997519 0.19919491
 0.19999915 0.19997734 0.19999987 0.19999999 0.19999987 0.19999367
 0.19999999 0.19999665 0.19999987 0.19999534 0.19999987 0.19999868
 0.19999987 0.19999999]
2025-06-06 15:41:42,162 - ERROR - An error occurred while processing file nw_graph_encoded_1749044528.dot: name 'datetime' is not defined
2025-06-06 15:41:42,163 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:42,163 - INFO - 
--- Processing file: nw_graph_encoded_1749044588.dot ---
2025-06-06 15:41:42,163 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot
2025-06-06 15:41:42,163 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044588.dot file.
2025-06-06 15:41:42,173 - INFO - Parsed 422 nodes.
2025-06-06 15:41:42,181 - INFO - Parsed 847 edges.
2025-06-06 15:41:42,280 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:42,280 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:42,283 - DEBUG - Initial node features tensor shape: torch.Size([422, 19])
2025-06-06 15:41:42,284 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:42,284 - DEBUG - Node features tensor shape after scaling: torch.Size([422, 19])
2025-06-06 15:41:42,284 - DEBUG - Edge index tensor shape: torch.Size([2, 847])
2025-06-06 15:41:42,284 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:42,288 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:42,289 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:42,290 - DEBUG - Shape of encoded categorical edge features: torch.Size([847, 2])
2025-06-06 15:41:42,290 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:42,290 - DEBUG - Shape of scaled numerical edge features: torch.Size([847, 20])
2025-06-06 15:41:42,291 - DEBUG - Final edge attributes tensor shape: torch.Size([847, 22])
2025-06-06 15:41:42,291 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:42,291 - INFO - Performing online update...
2025-06-06 15:41:42,291 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:42,291 - DEBUG - Updated RunningStats: new_mean=[ 2.52962745e-09 -2.12426027e-09 -6.09890248e-09 -4.49650987e-10
  1.13366552e-09 -7.23801831e-09 -8.64620087e-09  1.24812213e-09
  2.00026560e-09  5.89179051e-09  1.39146542e-08 -8.50249139e-10
 -1.28627434e-09  3.21023553e-09 -4.11226266e-09 -6.52947736e-09
 -3.68986325e-09 -8.63534282e-11 -8.39348509e-09], new_M2=[1366.99994687 1366.99994646 1367.00000784 1366.99999695 1366.99999366
 1366.99998163 1366.99995823 1367.00001505 1367.00003354 1367.00003672
 1366.99999813 1366.99999058 1366.99999517 1367.00001087 1367.00001019
 1366.99998064 1367.00002172 1367.00001332 1367.00001729], new_n=1367
2025-06-06 15:41:42,292 - DEBUG - Updated RunningStats: new_mean=[ 1.31885909e+00  4.49510430e+00  7.24931937e-10 -3.25754751e-10
  4.94306692e-10  1.41334470e-10  4.86346194e-10 -8.50887467e-10
  8.09914131e-10 -5.76872859e-10  1.12462950e-10 -3.28831159e-09
  1.50234741e-09 -9.51939337e-09 -1.12242410e-09  7.09741943e-10
  7.09741943e-10  7.09741943e-10  7.09741943e-10  7.09741943e-10
  7.09741943e-10 -2.53961586e-10], new_M2=[  648.17454236 10161.19369945  2349.00002915  2349.00000915
  2349.00004322  2348.99999694  2348.99997364  2349.00001998
  2348.99999893  2349.00000629  2348.99999161  2349.00004552
  2348.99999584  2349.00002899  2348.99997131  2349.0000342
  2349.0000342   2349.0000342   2349.0000342   2349.0000342
  2349.0000342   2348.9999548 ], new_n=2349
2025-06-06 15:41:42,292 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         1.         0.99999999
 0.99999998 1.00000001 1.00000001 1.00000001 1.         1.
 1.         1.         1.         0.99999999 1.00000001 1.
 1.00000001]
2025-06-06 15:41:42,292 - DEBUG - Calculated standard deviation: [0.52529646 2.07984446 1.00000001 1.         1.00000001 1.
 0.99999999 1.         1.         1.         1.         1.00000001
 1.         1.00000001 0.99999999 1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 0.99999999]
2025-06-06 15:41:42,292 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:42,292 - DEBUG - Online update step: 1/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 2/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 3/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 4/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 5/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 6/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 7/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 8/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 9/50
2025-06-06 15:41:42,292 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,292 - DEBUG - Online update step: 10/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 11/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 12/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 13/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 14/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 15/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 16/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 17/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 18/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 19/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 20/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 21/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 22/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 23/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 24/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 25/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 26/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 27/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 28/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 29/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 30/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 31/50
2025-06-06 15:41:42,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,293 - DEBUG - Online update step: 32/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 33/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 34/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 35/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 36/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 37/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 38/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 39/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 40/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 41/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 42/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 43/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 44/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 45/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 46/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 47/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 48/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 49/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - DEBUG - Online update step: 50/50
2025-06-06 15:41:42,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,294 - WARNING - No successful steps during online update.
2025-06-06 15:41:42,295 - DEBUG - Current node mean: [ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], current edge mean: [ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:41:42,295 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.2066
2025-06-06 15:41:42,295 - WARNING - Feature drift detected (3 consecutive)
2025-06-06 15:41:42,295 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-06 15:41:42,295 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-06 15:41:42,295 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-06 15:41:42,295 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-06 15:41:42,296 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-06 15:41:42,297 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-06 15:41:42,297 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-06 15:41:42,297 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-06 15:41:42,297 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-06 15:41:42,297 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-06 15:41:42,297 - INFO - Optimizer and scheduler reset.
2025-06-06 15:41:42,297 - DEBUG - Updated reference mean: node=[ 3.1073512e-08 -3.0508538e-08 -4.5197837e-09  3.8418161e-08
 -3.8418161e-08 -2.9378592e-08 -2.9378592e-08 -9.0395673e-09
  2.2598918e-09 -1.5819243e-08  2.4858808e-08  2.2598918e-09
 -2.6271241e-08 -2.2598918e-08 -2.7118700e-08 -4.1807997e-08
  1.1864432e-08  1.3559350e-08  1.7231674e-08], edge=[ 1.4273908e+00  4.8630462e+00  1.1259437e-09  4.5037747e-09
  2.2518873e-09 -2.2518873e-09  6.1926904e-09 -4.5037747e-09
  2.8148592e-10 -5.0667466e-09  9.0075494e-09 -6.7556623e-09
 -2.2518873e-09 -2.2237389e-08 -9.0075494e-09 -3.3778311e-09
 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09 -3.3778311e-09
 -3.3778311e-09  0.0000000e+00]
2025-06-06 15:41:42,298 - DEBUG - Updated reference std: node=[1.0011868 1.0011868 1.001187  1.001187  1.001187  1.001187  1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187  1.0011868 1.001187
 1.001187  1.001187  1.001187  1.001187  1.001187 ], edge=[0.5044536 1.8686519 1.0005909 1.0005909 1.0005908 1.0005909 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005909 1.0005908 1.0005908
 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908 1.0005908
 1.0005908]
2025-06-06 15:41:42,298 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:42,298 - INFO - Running anomaly detection...
2025-06-06 15:41:42,298 - INFO - Starting anomaly detection.
2025-06-06 15:41:42,307 - DEBUG - Node reconstruction errors: [22.198349 22.211794 25.728338 25.752466 25.92345  25.922327 22.0975
 26.880651 22.248957 22.787762 21.313854 24.89059  21.41137  20.765026
 25.183374 25.79628  22.637276 25.002424 22.23072  22.287094 22.645851
 22.68519  22.467533 22.632044 22.285202 28.426233 28.426392 21.093063
 21.034908 21.313395 27.58784  22.635742 28.387484 21.297203 20.92272
 27.978365 21.412653 21.285513 21.249393 27.954144 21.322199 27.994352
 20.855425 21.26571  21.304682 21.129774 21.444855 24.791021 21.092196
 29.342356 26.532501 20.58649  25.725967 21.146803 27.39385  20.563215
 24.684158 27.989273 22.002678 24.5096   28.023329 27.530058 21.061396
 27.549223 27.552689 20.738224 20.599035 21.41898  21.742529 27.543547
 20.789371 27.37013  27.566393 27.562208 20.743118 22.19961  21.228321
 24.639572 27.563547 24.04296  22.623003 24.04296  22.623615 28.416508
 27.466825 27.455688 29.169806 27.493595 27.61332  27.96522  20.941956
 27.519526 27.526419 27.791767 27.56695  20.752548 27.59105  21.43106
 25.435797 20.777573 22.086319 29.455168 20.538433 20.659967 20.77727
 20.58542  31.875116 24.561543 24.554077 25.124996 24.589275 21.297169
 24.517136 26.607376 24.9954   24.05448  20.698877 29.043377 24.59588
 20.909298 19.681791 24.95607  26.810707 29.057402 28.734337 27.192928
 28.724777 24.092083 29.540411 22.953798 22.817028 21.013119 26.091066
 25.464594 21.422583 23.84297  25.011799 27.959486 25.702131 22.623613
 27.113544 20.126467 20.821215 29.513615 19.547709 27.181461 27.540833
 27.179895 27.96423  25.691076 26.73341  25.756508 29.209421 19.881016
 19.279375 29.059313 20.90927  21.988394 26.246157 25.759842 30.798552
 19.080828 26.83053  23.938683 24.669292 24.558603 27.839064 19.013565
 27.528427 24.433174 27.098783 18.803795 27.956505 18.803795 23.328453
 20.533741 19.898466 20.946442 26.80211  20.274878 24.56723  19.636333
 19.68334  18.696041 18.712488 28.697462 18.817068 18.738804 29.065786
 28.731712 18.803797 20.198639 22.637537 26.810968 21.037533 21.95871
 18.892838 23.632484 29.03374  21.229239 21.221893 20.178707 22.459772
 29.06573  24.02171  19.588087 19.144337 24.522837 26.757563 39.56329
 20.724249 26.778223 25.194906 20.111359 21.789669 20.355799 29.065283
 26.81515  20.798246 28.71638  26.732744 27.771908 18.696913 28.716854
 21.069275 29.646723 21.045755 22.189373 25.693842 27.20014  18.723505
 20.984444 25.956825 27.296865 18.748985 18.956335 18.754114 18.738401
 27.892433 21.614996 18.7652   29.606197 25.78524  27.57288  28.334253
 21.182474 25.730562 20.170433 33.17712  28.912523 20.203445 43.398632
 29.391476 20.777727 23.914314 21.022827 30.250216 28.192913 30.06682
 20.670536 18.914846 20.61941  27.206951 22.63146  27.530209 18.803795
 20.203392 19.34243  20.368183 31.080267 28.979267 26.472351 21.15555
 21.065445 27.189617 46.557556 25.897545 28.266123 20.766853 25.786352
 19.937332 29.045649 18.852621 27.183739 27.160025 21.96079  23.533106
 20.08792  24.946112 19.213102 25.96417  20.48854  29.701345 21.283865
 26.836864 27.24425  20.530985 28.72429  23.5393   20.20473  21.430777
 26.80203  29.435072 24.585892 26.712505 20.722906 18.803793 29.43751
 26.804533 23.752594 21.27091  26.6514   23.30748  29.091732 21.420528
 24.366987 29.775429 24.62837  28.766146 21.12     20.143661 24.94987
 21.42524  29.050552 20.590456 20.098555 18.929266 21.413723 20.198694
 22.188597 28.72735  25.906397 21.99996  28.729164 20.773182 39.89405
 21.379095 29.338915 22.624876 22.07115  30.526531 20.502842 20.598484
 21.386581 28.884363 24.384762 23.361647 29.477787 22.641752 19.98134
 27.552475 18.765198 22.489624 28.747238 21.415041 29.115568 29.0728
 27.182388 18.79927  24.343958 24.585695 29.73537  26.241562 22.214737
 20.51979  20.46139  29.768946 20.76682  27.043955 27.167494 25.7556
 20.633133 21.251123 27.868954 20.96115  20.380974 27.384464 21.037958
 30.072266 20.207285 20.015257 22.01516  20.195007 18.7652   28.144615
 22.207415 27.657856 22.63387  20.52532  23.355583 20.715845 20.18573
 24.01519  22.215906 20.501991 28.29746  28.775333 21.270655 28.733463
 29.28267  25.18306  20.195044 22.196552 28.65356  21.411766 22.235907
 21.213795 27.162382 22.570868 25.00552  31.61637  28.541124 21.990602
 28.876207 29.381891 24.557085 24.251917 27.168522 26.502295 27.195736
 20.755484 29.87644 ]
2025-06-06 15:41:42,309 - DEBUG - Edge reconstruction errors: [0.19912064 0.19959378 0.1995359  0.19977784 0.19959807 0.19962794
 0.19951814 0.79999876 0.19999975 0.7771513  0.78505015 0.75539637
 0.7981827  0.7933946  0.78581554 0.6984695  0.5269853  0.64176506
 0.0928697  0.1466555  0.16236436 0.13998622 0.124075   0.6090608
 0.79022646 0.7904338  0.6897606  0.6407956  0.7790536  0.7019333
 0.72191894 0.746837   0.79962546 0.5474285  0.6515677  0.7982303
 0.79388183 0.7759307  0.5717201  0.68509996 0.71362704 0.64552057
 0.77600443 0.19999999 0.75321585 0.7480243  0.7938515  0.7430273
 0.7295001  0.05163801 0.69715136 0.73366445 0.75406677 0.7709715
 0.7446014  0.72132665 0.7087716  0.72643185 0.7627611  0.7443947
 0.7826754  0.7664247  0.7793766  0.7531496  0.7401988  0.6493886
 0.52651155 0.79630184 0.78217334 0.75797284 0.77087075 0.19999999
 0.7120733  0.7579061  0.73399264 0.79242456 0.75617766 0.6375054
 0.7388734  0.7987524  0.7959275  0.75304955 0.782081   0.18625736
 0.7497207  0.79582727 0.78814965 0.7808159  0.79896605 0.7982625
 0.78609097 0.75917864 0.6860832  0.7182224  0.76924986 0.6843011
 0.77509713 0.79760504 0.79053223 0.7837053  0.78680104 0.78104985
 0.7570374  0.7961379  0.7858503  0.7832275  0.74758273 0.7970305
 0.790698   0.7797759  0.79349035 0.78837067 0.77121365 0.7773467
 0.7855085  0.76555246 0.7377671  0.7985588  0.7976832  0.7905441
 0.788545   0.789845   0.7633986  0.7864825  0.7505443  0.7468004
 0.7965392  0.7859859  0.75897133 0.77768886 0.7960027  0.7865175
 0.7521363  0.7838213  0.77154195 0.758303   0.79385674 0.78156054
 0.75368    0.79637486 0.78708607 0.7904106  0.77535856 0.7883145
 0.79873604 0.79743046 0.78279895 0.7882072  0.73656523 0.7800941
 0.7627271  0.75295496 0.7843186  0.7665845  0.76944524 0.7589595
 0.7975811  0.7967796  0.7802664  0.79006565 0.7639104  0.7707399
 0.7980222  0.7940798  0.78867435 0.78658676 0.7659232  0.7972591
 0.7944783  0.8        0.76752436 0.78810155 0.7878203  0.76922774
 0.7650474  0.7920834  0.7853736  0.76455534 0.78607553 0.7767671
 0.7497888  0.7651312  0.7702068  0.78627163 0.7750689  0.76596755
 0.79661244 0.792538   0.78253496 0.68997395 0.19999987 0.7579528
 0.7971695  0.7974875  0.78529197 0.7790133  0.7706068  0.7772974
 0.7558675  0.7656037  0.78776646 0.61016333 0.7777251  0.7808691
 0.77291185 0.7538673  0.7623848  0.797794   0.7953193  0.66544515
 0.78309786 0.7961792  0.79063517 0.7803629  0.787919   0.31061837
 0.79570204 0.7683126  0.794709   0.78733313 0.7862514  0.7880459
 0.7944648  0.7901034  0.7935379  0.7831116  0.7967029  0.79067326
 0.7984848  0.79688233 0.79372424 0.7947842  0.78027415 0.7984797
 0.7972997  0.45443854 0.79699177 0.79733765 0.714787   0.79885805
 0.7977117  0.79840547 0.7984315  0.7963009  0.79689294 0.79225934
 0.79209775 0.7965161  0.7969879  0.797139   0.7943104  0.7977869
 0.79453176 0.7896949  0.78355247 0.7958625  0.79648846 0.1269731
 0.09035367 0.1754412  0.8        0.7382864  0.77070487 0.75583833
 0.7446177  0.7133507  0.788835   0.7836986  0.7424277  0.7904604
 0.66628206 0.76335996 0.79726756 0.7924893  0.8        0.7799184
 0.7976646  0.7832524  0.6709164  0.7568509  0.7703923  0.794673
 0.7137001  0.7599598  0.74662113 0.7893708  0.79974675 0.79913443
 0.71793956 0.7994475  0.7990777  0.7932161  0.7931021  0.79864573
 0.79615676 0.7547464  0.77460855 0.74799734 0.7981872  0.7999514
 0.79992217 0.7907758  0.79856783 0.79606265 0.7895674  0.79923314
 0.79908603 0.14359736 0.77909005 0.76778877 0.79656786 0.7876759
 0.7197772  0.7530091  0.7978151  0.7945167  0.7712587  0.19312054
 0.79588014 0.77987665 0.7904895  0.79859275 0.79646796 0.7610542
 0.7975239  0.79893714 0.7982709  0.22001594 0.78725547 0.77975506
 0.7801052  0.778948   0.79924786 0.7985976  0.73551464 0.77747554
 0.79905206 0.79817045 0.7876053  0.7989584  0.79728544 0.7941445
 0.7908315  0.7960795  0.7949553  0.7817574  0.77219605 0.7682921
 0.79921097 0.79820013 0.7867987  0.7926137  0.7989156  0.7986821
 0.7266425  0.7465385  0.79326683 0.7357735  0.61785764 0.7924444
 0.7986267  0.7967455  0.771308   0.73523444 0.74758494 0.78255606
 0.7042084  0.56796515 0.77911144 0.7981965  0.79565215 0.7165697
 0.773372   0.78133684 0.7821275  0.79671705 0.79187065 0.777745
 0.79066354 0.79904944 0.7988866  0.7955704  0.7989537  0.798814
 0.7865268  0.79891986 0.79823554 0.7423562  0.7982446  0.7950465
 0.7921782  0.7971841  0.79454637 0.793835   0.75578594 0.79944813
 0.79834193 0.7921539  0.7897828  0.7961049  0.7917732  0.77761763
 0.79430807 0.78682715 0.79676634 0.79315907 0.7821859  0.76854354
 0.7990263  0.79740095 0.7894903  0.7989553  0.79699033 0.7899767
 0.7990429  0.7976276  0.7974861  0.7931536  0.60959125 0.77278006
 0.79944724 0.7993364  0.7935041  0.7989192  0.79815817 0.7949797
 0.79830253 0.79580456 0.7730979  0.76951    0.7833788  0.78821033
 0.79976755 0.7994423  0.7869948  0.79400986 0.79854757 0.7973032
 0.7868034  0.7831707  0.7993129  0.79837674 0.79054683 0.798899
 0.79725236 0.79421234 0.799713   0.7994392  0.79442877 0.7838161
 0.7887183  0.79742837 0.7909162  0.7840766  0.7982367  0.7947621
 0.799694   0.7991242  0.38074845 0.797819   0.7967401  0.7941462
 0.7984173  0.7979596  0.7992298  0.7984477  0.79259247 0.7950412
 0.78993726 0.72920114 0.60294425 0.7878325  0.6490668  0.7964204
 0.7793898  0.7862648  0.7875546  0.7186296  0.7936196  0.74049556
 0.78649855 0.7845672  0.78981584 0.73373747 0.7867491  0.792498
 0.7975316  0.7907076  0.78369635 0.7853262  0.7936277  0.7740297
 0.6563548  0.7834079  0.7911544  0.7683254  0.79036593 0.7931335
 0.79314876 0.7931858  0.77459854 0.79210746 0.78024143 0.19999999
 0.04274029 0.65210325 0.79999995 0.69090176 0.79481447 0.79013145
 0.16022378 0.77854514 0.6411296  0.8        0.04421216 0.03496116
 0.18503773 0.07543516 0.13009459 0.18158895 0.57647    0.6954894
 0.34231073 0.76857024 0.39802098 0.6841125  0.7340797  0.7869966
 0.78060955 0.7930202  0.7557294  0.7602074  0.7473059  0.65018797
 0.77064854 0.7360267  0.65627396 0.6325197  0.7797723  0.7742696
 0.79999906 0.72730863 0.74233997 0.7119558  0.7581572  0.789732
 0.78474075 0.7484386  0.74894494 0.6856908  0.44187433 0.77531934
 0.75913566 0.4905362  0.7600277  0.7352249  0.6567571  0.01641262
 0.03631377 0.67741114 0.7592522  0.7224735  0.7742528  0.74604297
 0.66439474 0.79495955 0.7954582  0.79332113 0.78768766 0.17115545
 0.40421432 0.64712155 0.697553   0.67482984 0.77021945 0.7985732
 0.7986453  0.31465164 0.79011804 0.7800095  0.7700097  0.0752576
 0.72488624 0.11856788 0.78357345 0.76954937 0.5670884  0.08224159
 0.7555541  0.68373126 0.74474376 0.6912461  0.5768529  0.7471426
 0.7327516  0.25558686 0.6501659  0.565567   0.7599093  0.7369483
 0.39426756 0.359913   0.7184593  0.47038054 0.6139792  0.65545183
 0.7791131  0.7782134  0.5836295  0.7831775  0.7701135  0.6323136
 0.7064136  0.7635605  0.7517956  0.66850346 0.76944137 0.78662986
 0.78973824 0.7623134  0.31319034 0.5988991  0.79357666 0.7902872
 0.70465136 0.6603791  0.7715116  0.755777   0.5904249  0.54781234
 0.74707747 0.6901143  0.7610751  0.6543551  0.6574905  0.6337451
 0.7643884  0.7015838  0.73001605 0.7942516  0.7935654  0.09476173
 0.54932106 0.08674353 0.14556879 0.31213278 0.7768198  0.45286718
 0.79894    0.7992991  0.6027854  0.6708422  0.66509026 0.6065597
 0.53925335 0.37046656 0.1774739  0.6311053  0.7955953  0.7942101
 0.683493   0.26330495 0.70133716 0.71753514 0.57765186 0.63290334
 0.69456214 0.6945734  0.6708771  0.38933927 0.5125098  0.6360547
 0.77712935 0.7385469  0.66895634 0.68935955 0.6718116  0.4895243
 0.7801084  0.7802181  0.26930368 0.77437496 0.7620661  0.75593174
 0.7886187  0.7864     0.7729711  0.76211584 0.72363806 0.5910597
 0.2230637  0.788847   0.78882945 0.6721451  0.7788051  0.77891797
 0.3162325  0.7560736  0.6954607  0.71332026 0.757936   0.36739445
 0.66544414 0.56453335 0.64730567 0.6470881  0.77298284 0.76061696
 0.6363116  0.7472145  0.7317761  0.6955514  0.73578703 0.7014404
 0.6748788  0.75035167 0.7601715  0.7364837  0.6341381  0.5736743
 0.75860196 0.72932076 0.18587083 0.6403083  0.7756439  0.77323455
 0.576205   0.68550885 0.5996238  0.774102   0.7517646  0.79656994
 0.79585284 0.36648843 0.6886102  0.6216715  0.08798915 0.66942084
 0.7478577  0.7248484  0.79417694 0.78006846 0.5971223  0.77118886
 0.7677333  0.6824374  0.77563334 0.62406427 0.76095146 0.7350391
 0.6318046  0.6484198  0.69113284 0.61195135 0.7107095  0.7734693
 0.7704547  0.23312736 0.12721533 0.15906489 0.22390711 0.78552634
 0.7910127  0.7681404  0.79017556 0.7859102  0.67937136 0.24217093
 0.61118865 0.05706584 0.05706584 0.6894574  0.785612   0.77916807
 0.645946   0.6985501  0.7288622  0.68459487 0.64569163 0.6928563
 0.5806419  0.7266145  0.6883088  0.04484838 0.6883975  0.7986214
 0.79895633 0.6647205  0.7143662  0.51175827 0.6701643  0.49204162
 0.3549625  0.17184156 0.34800783 0.7528428  0.68856907 0.68108654
 0.70778656 0.7531553  0.7409252  0.29777378 0.7857412  0.78542805
 0.7773731  0.76305884 0.6836414  0.59552    0.7510392  0.7924481
 0.79264265 0.6970161  0.13278055 0.62860346 0.5355189  0.71804047
 0.6304811  0.739111   0.7297039  0.69157493 0.50206757 0.3220195
 0.67475    0.7067585  0.76138324 0.7554938  0.743327   0.7106102
 0.7972705  0.7916773  0.79360706 0.79096097 0.78841347 0.7905557
 0.7852132  0.7791987  0.52830034 0.77453494 0.55718553 0.6747317
 0.6786425  0.55155873 0.6847719  0.6942595  0.6856075  0.6991249
 0.19999677]
2025-06-06 15:41:42,310 - ERROR - An error occurred while processing file nw_graph_encoded_1749044588.dot: name 'datetime' is not defined
2025-06-06 15:41:42,311 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:42,311 - INFO - 
--- Processing file: nw_graph_encoded_1749044648.dot ---
2025-06-06 15:41:42,311 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot
2025-06-06 15:41:42,311 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044648.dot file.
2025-06-06 15:41:42,317 - INFO - Parsed 512 nodes.
2025-06-06 15:41:42,326 - INFO - Parsed 1046 edges.
2025-06-06 15:41:42,484 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:42,484 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:42,487 - DEBUG - Initial node features tensor shape: torch.Size([512, 19])
2025-06-06 15:41:42,488 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:42,488 - DEBUG - Node features tensor shape after scaling: torch.Size([512, 19])
2025-06-06 15:41:42,489 - DEBUG - Edge index tensor shape: torch.Size([2, 1046])
2025-06-06 15:41:42,489 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:42,494 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:42,495 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:42,496 - DEBUG - Shape of encoded categorical edge features: torch.Size([1046, 2])
2025-06-06 15:41:42,497 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:42,497 - DEBUG - Shape of scaled numerical edge features: torch.Size([1046, 20])
2025-06-06 15:41:42,497 - DEBUG - Final edge attributes tensor shape: torch.Size([1046, 22])
2025-06-06 15:41:42,497 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:42,497 - INFO - Performing online update...
2025-06-06 15:41:42,497 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:42,498 - DEBUG - Updated RunningStats: new_mean=[-7.21167827e-10 -2.87773223e-09 -6.83201190e-09 -2.75580283e-10
  5.86847221e-09 -4.40928453e-09 -3.70493775e-09  2.77562875e-11
  1.88742755e-09  5.77330780e-09  1.16298845e-08 -3.64796921e-10
  1.03094782e-09  4.11189573e-09 -5.13293059e-09 -6.30935110e-09
 -4.30098544e-09  9.93154661e-10  3.12456493e-09], new_M2=[1878.99998654 1878.99998401 1879.00000702 1878.999997   1879.00000057
 1878.99996356 1878.99996001 1879.0000074  1879.00003607 1879.00006604
 1878.99998168 1878.99999394 1879.00000977 1879.00000371 1878.9999767
 1878.99999499 1879.00000776 1878.99998435 1878.9999797 ], new_n=1879
2025-06-06 15:41:42,498 - DEBUG - Updated RunningStats: new_mean=[ 1.34550810e+00  4.60412371e+00  1.61026908e-10  8.94246266e-11
  8.90431479e-11  3.79449226e-10  1.25868709e-09 -1.74045192e-09
  1.30992955e-09 -2.00590972e-09  4.95879550e-10 -2.90452799e-09
  8.69754471e-10 -8.73714993e-09 -1.94658763e-09  4.58918971e-10
  4.58918971e-10  4.58918971e-10  4.58918971e-10  4.58918971e-10
  4.58918971e-10 -1.50714122e-10], new_M2=[  915.71899853 14097.94226804  3394.99998574  3395.00006329
  3394.99999446  3395.00004036  3394.99997285  3394.99997966
  3394.99998371  3395.00002416  3394.9999554   3395.0000596
  3394.99999797  3395.00004882  3394.9999472   3395.00001719
  3395.00001719  3395.00001719  3395.00001719  3395.00001719
  3395.00001719  3394.99997058], new_n=3395
2025-06-06 15:41:42,498 - DEBUG - Calculated standard deviation: [1.         1.         1.         1.         1.         0.99999999
 0.99999999 1.         1.00000001 1.00000002 1.         1.
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:41:42,498 - DEBUG - Calculated standard deviation: [0.5193513  2.03778319 1.         1.00000001 1.         1.00000001
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.00000001 0.99999999 1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:42,498 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:42,499 - DEBUG - Online update step: 1/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 2/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 3/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 4/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 5/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 6/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 7/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 8/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 9/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 10/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 11/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 12/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 13/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 14/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 15/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 16/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 17/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 18/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 19/50
2025-06-06 15:41:42,499 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,499 - DEBUG - Online update step: 20/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 21/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 22/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 23/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 24/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 25/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 26/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 27/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 28/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 29/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 30/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 31/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 32/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 33/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 34/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 35/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 36/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 37/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 38/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 39/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 40/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,500 - DEBUG - Online update step: 41/50
2025-06-06 15:41:42,500 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 42/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 43/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 44/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 45/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 46/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 47/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 48/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 49/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - DEBUG - Online update step: 50/50
2025-06-06 15:41:42,501 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,501 - WARNING - No successful steps during online update.
2025-06-06 15:41:42,502 - DEBUG - Current node mean: [-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], current edge mean: [ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:41:42,502 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1201
2025-06-06 15:41:42,502 - DEBUG - Updated reference mean: node=[-1.4901161e-08  1.4901161e-08 -6.5192580e-09 -2.0256266e-08
  2.2817403e-08  1.5366822e-08 -1.1641532e-08 -7.6834112e-09
 -1.3969839e-08 -1.0710210e-08 -2.3283064e-10 -3.7252903e-08
  2.8871000e-08 -2.1420419e-08  2.7939677e-09 -1.8626451e-08
  1.8626451e-09  2.6077032e-08  2.9802322e-08], edge=[ 1.40535378e+00  4.84894848e+00 -4.55867255e-09  4.55867261e-10
 -2.05140260e-09 -3.87487153e-09  5.47040724e-09 -1.59553544e-08
 -2.73520362e-09 -3.64693808e-09 -9.11734521e-10 -3.19107074e-09
  5.69834091e-09  5.35644018e-09 -1.09408145e-08 -4.55867255e-09
 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09 -4.55867255e-09
 -4.55867255e-09  1.09408145e-08]
2025-06-06 15:41:42,502 - DEBUG - Updated reference std: node=[1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978 1.000978
 1.000978 1.000978 1.000978], edge=[0.50084144 1.9184657  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784  1.0004784  1.0004784
 1.0004784  1.0004784  1.0004784  1.0004784 ]
2025-06-06 15:41:42,502 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:42,502 - INFO - Running anomaly detection...
2025-06-06 15:41:42,502 - INFO - Starting anomaly detection.
2025-06-06 15:41:42,515 - DEBUG - Node reconstruction errors: [26.730942 26.726711 24.352676 26.71374  26.715973 26.72722  30.971464
 25.99239  26.00477  25.521658 28.654066 25.979208 25.982677 26.724752
 24.620567 25.984879 25.999004 26.009317 25.980637 25.984344 25.983768
 25.9775   26.147194 24.801123 26.004112 26.374458 26.008692 30.233116
 25.98381  25.9743   24.806015 25.539423 26.003254 29.244858 24.790325
 25.61882  25.879316 26.0111   28.801964 24.825668 30.265076 29.200397
 31.946264 31.949623 27.317717 27.327875 27.497385 28.951097 23.630423
 29.75733  24.820612 32.642124 25.586615 23.132147 25.995752 26.66909
 31.197355 25.984632 31.390997 25.991125 24.831985 26.913124 26.001816
 28.60197  25.292156 31.75924  31.928865 32.653625 32.67506  26.688004
 32.74282  32.581516 26.523483 32.636898 30.619038 33.93108  30.517319
 29.95483  24.083344 22.913267 23.122288 25.980246 29.915157 30.252916
 31.157143 29.938135 22.858898 31.70893  23.250563 26.685438 29.952063
 30.220108 23.055641 25.592464 29.597479 30.95683  26.723083 23.488592
 29.634062 22.801783 23.054253 23.117264 30.210604 23.003044 24.174028
 26.883041 28.809982 28.140001 31.813229 32.447197 23.505283 27.322252
 24.281342 29.436022 29.289465 27.634377 29.629423 25.551216 31.763453
 26.968012 29.6566   29.24813  22.899721 29.265564 29.266882 23.578726
 25.127356 22.60517  24.147057 23.49494  29.262066 23.622757 29.096033
 30.50155  30.498165 23.582882 31.938135 23.064905 27.039387 29.27808
 27.436636 25.745983 27.436636 25.984068 29.869883 32.04253  29.185978
 30.392065 26.013372 32.350113 30.42316  30.552105 29.60817  22.848751
 29.239305 30.45982  32.512238 30.503891 23.599949 30.518314 24.579271
 28.293585 28.558796 23.604603 32.145477 22.530005 26.048021 27.540258
 23.54196  23.610586 22.582727 37.839016 24.841246 27.569391 27.555557
 33.909374 25.880564 27.54517  24.155518 27.488934 29.697285 27.853651
 27.136072 22.643236 31.646038 27.562716 23.751808 21.982786 27.844604
 31.908428 31.949621 31.378881 30.242281 31.376947 27.466839 32.01615
 27.429214 31.461481 22.859049 28.766748 28.275934 24.222794 26.91414
 27.928299 26.036047 31.631178 31.954844 32.70929  31.896479 23.97605
 23.751026 36.225266 21.684866 31.948683 29.579994 29.891027 29.606651
 29.00318  29.069923 27.324675 32.78307  21.897438 23.11203  31.943806
 25.965593 29.882118 23.750046 24.71211  29.361017 27.33703  36.175823
 21.413204 29.911798 26.18346  27.321518 27.52994  31.118402 22.288975
 29.24506  27.400076 26.033493 31.170443 21.159496 29.59939  21.15949
 26.516092 24.152157 22.007044 25.09088  24.425646 29.79551  23.225702
 27.538137 22.771448 21.684328 22.13689  21.083672 26.6276   33.137768
 25.917261 22.189674 21.110445 31.978662 31.950815 21.159498 23.74075
 26.712185 26.02879  29.877972 29.891466 22.88334  24.686361 21.2447
 25.95658  32.18624  24.038977 25.005053 23.766788 24.769659 31.665466
 26.017553 22.745583 21.472654 26.403053 28.628672 44.602573 23.573614
 31.570621 31.16119  23.1161   24.556145 22.379433 31.64601  29.89527
 23.632902 31.966711 30.48259  31.279888 21.068058 31.952543 23.614883
 32.851505 22.88791  25.838345 29.003489 30.161142 26.423347 21.076395
 23.844336 27.513865 29.343416 21.102606 22.29583  21.159494 21.091417
 25.998074 30.682999 24.317438 21.137707 32.244877 29.314356 29.170008
 30.509811 25.612267 31.601374 24.056507 27.318476 22.073284 36.465267
 32.429596 23.140331 51.623913 33.178577 23.614365 26.200811 22.86236
 33.155434 31.449284 25.999762 36.6102   22.609552 21.27142  22.550219
 30.172691 25.288462 30.775711 21.1595   24.178526 29.470331 22.229013
 33.522423 31.869587 29.575077 24.107872 23.804958 31.413162 49.41452
 31.259619 30.825928 23.605427 27.363127 21.883997 32.780487 21.24672
 31.07411  30.449303 24.688656 26.284441 23.188684 31.572546 21.522163
 28.986046 22.307446 26.968012 32.943977 24.111624 30.498356 29.556961
 23.43958  24.606281 31.477234 26.751873 22.199823 24.22016  29.881445
 32.19515  27.552448 29.791967 23.573166 21.159494 32.270805 29.885334
 26.90953  23.074076 28.518652 25.416971 31.695927 23.240421 26.79687
 33.222713 26.005167 27.92317  31.971895 25.188177 22.098232 28.177635
 24.27439  31.661894 22.590204 23.203033 21.304617 25.349659 26.699295
 24.810354 24.137724 24.904728 31.44156  27.487976 25.60632  37.530735
 23.610676 48.35332  25.182468 32.182728 25.320477 29.326069 33.509144
 22.501703 22.595497 24.200592 32.11679  26.70984  30.771067 26.680166
 32.020847 25.299938 22.109066 30.484777 21.137709 27.666815 31.98789
 25.327713 31.760447 31.674574 30.811438 21.159498 27.52216  26.231697
 27.537462 32.95046  35.772144 24.931662 24.136507 22.430702 32.870922
 22.609535 30.014654 28.947346 30.232914 28.752316 22.550205 25.127356
 24.08158  31.506248 22.87226  27.859118 30.226032 22.882856 32.909206
 23.75851  27.435116 25.265802 24.171663 21.13771  31.405584 29.671162
 30.481266 25.730045 23.439926 32.51604  23.561295 23.626337 27.400578
 24.935974 23.440628 29.839947 32.45864  29.992445 31.38001  32.80154
 26.904102 23.615726 25.743738 31.632198 23.185095 25.382776 24.112665
 31.425367 32.66435  31.160395 36.780083 31.458149 24.714062 32.339455
 31.917719 27.557524 27.278038 30.21906  29.602633 30.249435 24.34761
 32.304684]
2025-06-06 15:41:42,515 - DEBUG - Edge reconstruction errors: [0.19996494 0.19998044 0.19998223 ... 0.7721831  0.19999975 0.79999936]
2025-06-06 15:41:42,516 - ERROR - An error occurred while processing file nw_graph_encoded_1749044648.dot: name 'datetime' is not defined
2025-06-06 15:41:42,517 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:42,517 - INFO - 
--- Processing file: nw_graph_encoded_1749044708.dot ---
2025-06-06 15:41:42,517 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot
2025-06-06 15:41:42,517 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044708.dot file.
2025-06-06 15:41:42,525 - INFO - Parsed 640 nodes.
2025-06-06 15:41:42,537 - INFO - Parsed 1302 edges.
2025-06-06 15:41:42,777 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:42,777 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:42,782 - DEBUG - Initial node features tensor shape: torch.Size([640, 19])
2025-06-06 15:41:42,784 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:42,784 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 19])
2025-06-06 15:41:42,785 - DEBUG - Edge index tensor shape: torch.Size([2, 1302])
2025-06-06 15:41:42,785 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:42,792 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:42,793 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:42,794 - DEBUG - Shape of encoded categorical edge features: torch.Size([1302, 2])
2025-06-06 15:41:42,796 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:42,796 - DEBUG - Shape of scaled numerical edge features: torch.Size([1302, 20])
2025-06-06 15:41:42,796 - DEBUG - Final edge attributes tensor shape: torch.Size([1302, 22])
2025-06-06 15:41:42,796 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:42,796 - INFO - Performing online update...
2025-06-06 15:41:42,797 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:42,797 - DEBUG - Updated RunningStats: new_mean=[-6.44420503e-10 -2.04011035e-09 -6.42128244e-09  1.38274967e-09
 -2.93409129e-09  1.36648203e-09 -3.81658782e-09  6.74367755e-10
  2.56732988e-09  4.15860116e-09  5.65818209e-09  1.50253868e-09
 -1.45521463e-09  2.80690789e-09  2.29965320e-09 -6.77676742e-09
  1.51769717e-10 -1.00471183e-09  3.95155843e-09], new_M2=[2518.99992428 2518.99992175 2518.99999908 2519.00001744 2518.99994028
 2518.99994169 2518.99996106 2519.00003845 2518.99998813 2519.00001677
 2518.99995669 2519.00005278 2518.99999083 2519.00001757 2518.99996309
 2519.00000894 2519.0000176  2519.00000646 2518.99997711], new_n=2519
2025-06-06 15:41:42,798 - DEBUG - Updated RunningStats: new_mean=[ 1.36299766e+00  4.69853098e+00  4.70692650e-10 -2.86826397e-10
  2.07927877e-10  4.51281318e-10  1.05289009e-09 -1.23916513e-09
 -1.47093002e-10 -1.30810472e-09  2.03169150e-10  2.34783240e-10
  3.13592689e-10 -9.16887769e-09 -1.87154298e-09  4.89042872e-10
  4.89042872e-10  4.89042872e-10  4.89042872e-10  4.89042872e-10
  4.89042872e-10 -4.72257205e-10], new_M2=[ 1246.08899297 18561.11986374  4697.00003621  4696.99997324
  4697.00007506  4697.00010614  4696.99999277  4696.99996495
  4696.99999679  4697.00001863  4696.99991651  4697.00000249
  4696.9999947   4697.00007798  4696.99996485  4697.00005069
  4697.00005069  4697.00005069  4697.00005069  4697.00005069
  4697.00005069  4696.99991041], new_n=4697
2025-06-06 15:41:42,798 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         0.99999999 0.99999999
 0.99999999 1.00000001 1.         1.         0.99999999 1.00000001
 1.         1.         0.99999999 1.         1.         1.
 1.        ]
2025-06-06 15:41:42,798 - DEBUG - Calculated standard deviation: [0.51506762 1.98788752 1.         1.         1.00000001 1.00000001
 1.         1.         1.         1.         0.99999999 1.
 1.         1.00000001 1.         1.00000001 1.00000001 1.00000001
 1.00000001 1.00000001 1.00000001 0.99999999]
2025-06-06 15:41:42,798 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:42,798 - DEBUG - Online update step: 1/50
2025-06-06 15:41:42,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,798 - DEBUG - Online update step: 2/50
2025-06-06 15:41:42,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 3/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 4/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 5/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 6/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 7/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 8/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 9/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 10/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 11/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 12/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 13/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 14/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 15/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 16/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 17/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 18/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 19/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 20/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 21/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 22/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 23/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 24/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 25/50
2025-06-06 15:41:42,799 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,799 - DEBUG - Online update step: 26/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 27/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 28/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 29/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 30/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 31/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 32/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 33/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 34/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 35/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 36/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 37/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 38/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 39/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 40/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 41/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 42/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 43/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 44/50
2025-06-06 15:41:42,800 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,800 - DEBUG - Online update step: 45/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - DEBUG - Online update step: 46/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - DEBUG - Online update step: 47/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - DEBUG - Online update step: 48/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - DEBUG - Online update step: 49/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - DEBUG - Online update step: 50/50
2025-06-06 15:41:42,801 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:42,801 - WARNING - No successful steps during online update.
2025-06-06 15:41:42,802 - DEBUG - Current node mean: [-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], current edge mean: [ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:41:42,802 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1238
2025-06-06 15:41:42,802 - DEBUG - Updated reference mean: node=[-3.1292437e-08  3.1292437e-08  5.9604646e-09  1.0430813e-08
 -8.9406971e-09  3.8743018e-08 -3.3527613e-08  1.3411045e-08
  1.1920929e-08 -5.9604646e-09 -1.5646219e-08 -3.7252903e-09
 -4.4703485e-09 -5.9604646e-09  4.4703484e-08 -1.1920929e-08
 -5.9604646e-09 -5.9604646e-09  2.9802322e-08], edge=[ 1.4086021e+00  4.9447002e+00  1.4649375e-09  5.4935156e-10
 -1.4649375e-09 -5.4935159e-09  2.1974063e-09 -7.3246875e-09
 -2.5636406e-09  1.4649375e-09  1.4649375e-09  5.8597500e-09
 -1.4649375e-09 -4.3948125e-09 -1.2451969e-08  1.4649375e-09
  1.4649375e-09  1.4649375e-09  1.4649375e-09  1.4649375e-09
  1.4649375e-09  0.0000000e+00]
2025-06-06 15:41:42,802 - DEBUG - Updated reference std: node=[1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007823 1.0007821 1.0007821
 1.0007821 1.0007821 1.0007821 1.0007821 1.0007821], edge=[0.5010547 1.8293908 1.0003842 1.0003842 1.0003843 1.0003843 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842 1.0003842
 1.0003842]
2025-06-06 15:41:42,802 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:42,802 - INFO - Running anomaly detection...
2025-06-06 15:41:42,802 - INFO - Starting anomaly detection.
2025-06-06 15:41:42,816 - DEBUG - Node reconstruction errors: [28.795853 43.25353  28.711737 28.41704  28.813374 28.747116 28.630651
 28.750738 28.771193 28.77045  28.48413  31.708431 28.501596 28.109568
 28.10961  28.039907 28.106104 27.847303 27.90104  27.878595 28.089895
 27.96321  28.032738 28.144934 28.128334 27.866661 31.503366 11.863373
 28.077164 12.720437 36.42724  12.629639 36.14332  12.720437 12.629639
 28.111666 28.136282 28.12879  28.093727 27.930885 28.044012 27.74178
 28.798353 28.109426 28.068933 28.478846 28.115414 28.093618 27.86585
 28.053707 28.455318 28.08842  28.136099 28.116587 28.49515  28.138504
 28.011536 28.136581 28.137943 28.119808 32.114113 36.132862 28.247652
 28.470667 37.815334 34.93706  34.352406 31.83064  31.138348 36.132416
 36.16057  38.093395 44.563038 38.137074 36.367447 29.26568  30.74154
 27.1156   36.79144  27.875048 37.460445 27.84784  29.998503 28.868376
 27.84304  30.575119 35.121655 35.01657  25.571402 28.444557 28.81336
 30.616371 27.386333 35.360237 32.25573  36.147438 36.37804  26.606464
 33.690655 35.885925 33.31022  28.081    26.487173 28.738104 29.99383
 42.457703 38.492752 32.01579  31.108324 25.561138 14.816303 35.376556
 37.1449   30.331486 33.75353  25.5714   37.583096 32.506577 35.335968
 31.48936  37.35528  26.589987 28.60143  39.765125 35.009056 38.198513
 57.797413 27.981497 35.300976 30.482843 31.449305 38.65562  37.06946
 27.865902 28.428679 32.000507 30.327665 25.637547 28.37933  36.812374
 37.23955  37.465702 33.289074 31.53694  30.136845 37.49297  32.97822
 32.074932 38.943825 28.434998 29.406513 31.09183  27.128212 37.281525
 28.130606 32.953545 27.895601 31.490244 34.611244 28.900414 34.519062
 32.037704 37.88513  29.342665 26.275301 36.336517 28.567055 27.838507
 34.32036  27.797405 35.100025 29.23783  31.708431 34.686165 34.68462
 25.813297 31.130287 28.697994 35.349274 37.001213 26.199759 25.627283
 26.8696   35.978893 38.988808 37.73048  35.23903  29.291578 37.07345
 26.377968 28.161438 34.33687  28.11967  28.450964 25.561134 38.521152
 30.28148  26.55255  25.60578  27.11847  44.99117  30.877296 36.091038
 26.828691 30.733566 27.98553  63.014206 27.542307 37.54905  43.16412
 26.704254 31.291729 29.105295 32.590435 37.126965 29.632019 38.72085
 35.141388 34.717625 37.86642  29.414345 36.20029  35.25303  30.87914
 25.522781 25.561132 26.728716 25.532978 31.47343  28.155376 36.97954
 25.50818  31.647486 33.86532  31.023903 26.853455 25.561134 38.399
 28.581919 37.10367  35.48738  37.761566 35.95073  37.230698 26.46551
 27.517391 35.683872 37.879284 29.807884 28.858633 39.154987 39.133873
 54.877197 30.623943 25.80518  27.19788  30.828276 25.530828 37.251984
 29.396742 28.07749  30.043634 40.160496 29.141813 30.27686  29.770206
 34.618122 37.51474  35.229645 30.90362  31.546772 28.05118  25.561134
 37.191986 28.317322 25.568548 28.14541  26.599419 30.507189 38.21626
 39.509712 25.54516  26.553646 26.454414 31.502222 27.214375 32.51731
 27.670185 30.19281  36.895355 28.085886 30.065218 26.622513 28.751629
 35.629776 25.561134 30.623266 33.832245 25.561134 37.23159  29.966406
 36.53232  35.663246 30.674759 31.610924 32.390045 28.005346 33.546356
 26.753536 36.08851  32.512074 32.07596  28.100628 30.425768 36.319714
 25.747892 31.311157 34.13437  31.579689 38.598698 31.5031   38.712967
 37.464386 27.481369 32.454876 28.023483 27.778284 26.12124  37.90196
 31.307402 28.47522  37.36763  33.590572 36.22319  34.96594  33.797718
 37.87676  30.76327  42.86266  28.952368 28.290514 38.184925 31.391108
 37.755226 36.412933 30.915583 29.345587 33.815132 33.30897  34.224678
 26.832579 39.335426 36.17877  32.26773  37.06585  32.634388 27.879103
 36.97559  34.92874  36.978138 39.295532 32.81485  26.15066  31.577097
 28.14431  34.607895 34.025085 37.22479  28.085266 26.651823 32.27636
 34.440125 32.477005 29.17369  28.417753 28.374353 32.148182 28.970484
 32.526714 38.920547 40.054832 32.071648 32.690037 29.00088  44.440704
 39.301056 26.581457 29.80456  27.972477 31.50222  31.324417 34.32845
 26.8539   26.525187 29.65924  37.620037 31.920359 29.778507 27.415392
 33.46144  33.252304 35.691895 38.710278 35.092472 38.17844  37.47073
 35.13788  33.541927 27.309692 33.842308 36.75646  38.07679  36.658455
 26.521816 35.02718  56.96923  29.60262  28.068417 33.4879   37.285168
 35.22018  31.086206 30.139244 33.572372 31.760363 26.992245 36.33572
 35.133995 35.132416 33.94357  27.991882 32.311832 33.5659   33.997665
 27.334276 29.155602 40.16575  34.43505  27.393583 28.106117 27.316076
 33.564716 26.587732 35.87688  33.563725 25.571404 26.869297 33.55148
 33.878613 31.708431 36.37348  38.82566  29.279226 31.261044 28.39768
 34.83596  33.85899  32.0863   33.937748 33.66164  37.275757 28.867102
 31.292612 27.90294  39.510494 25.608213 36.26926  32.50144  33.065693
 33.081165 31.217697 28.461985 28.501474 26.959848 35.844204 33.451595
 27.0345   26.95591  26.773596 27.70967  33.926273 33.86317  35.683804
 27.387245 31.503536 33.86488  28.90597  28.9306   36.177753 33.83385
 27.850765 29.614548 26.97327  27.984121 39.754875 34.101902 31.5325
 37.565926 26.830475 34.09219  35.97599  35.556034 37.94848  34.287666
 30.869268 27.034822 26.839066 38.076508 28.515427 34.103653 28.50476
 35.044403 31.334225 39.66693  31.750555 37.827587 31.336712 29.323753
 38.315704 37.967346 38.15516  33.583427 28.485863 28.682514 38.72081
 36.325054 38.896584 30.28318  27.17395  33.51658  31.00963  27.975473
 36.32124  40.00983  38.8151   35.845615 38.743687 37.036858 36.589813
 30.798038 39.154785 39.011887 27.053345 28.083614 28.088282 38.712147
 31.49562  38.11288  36.04967  28.986313 35.40907  28.105362 31.508368
 27.434322 33.977917 31.462547 31.30471  37.85609  31.290216 36.34211
 34.912548 36.340843 30.288095 34.041523 40.0485   36.609436 29.373497
 37.395447 34.828545 30.888704 38.96775  39.02985  28.99514  34.0716
 31.751198 38.61242  28.969904 30.867708 27.610023 38.782707 35.55044
 30.981928 30.886189 31.21316  29.85375  30.887629 28.11351  28.228483
 28.958715 35.833893 31.32402  30.867943 38.805508 37.351303 38.790985
 28.364508 30.871325 31.322622 31.741413 31.49799  30.865137 28.219791
 28.086586 26.217928 31.51323  31.482502 30.877863 30.871033 32.89834
 32.336067 38.60067  30.883959 37.85515  31.31736  36.175022 36.089127
 32.62736  31.548279 31.539461 31.502062 28.06558  33.454823 31.518673
 39.366497 27.664734 33.59439  39.19773  43.879845 28.234549 33.539318
 27.936749 33.50019  33.634064 38.192333 27.82514  28.154606 43.598297
 27.979517 26.19662  28.055902]
2025-06-06 15:41:42,816 - DEBUG - Edge reconstruction errors: [0.19999999 0.79999965 0.7594569  ... 0.19990069 0.7999854  0.19999999]
2025-06-06 15:41:42,817 - ERROR - An error occurred while processing file nw_graph_encoded_1749044708.dot: name 'datetime' is not defined
2025-06-06 15:41:42,818 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:42,818 - INFO - 
--- Processing file: nw_graph_encoded_1749044768.dot ---
2025-06-06 15:41:42,819 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot
2025-06-06 15:41:42,819 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044768.dot file.
2025-06-06 15:41:42,827 - INFO - Parsed 693 nodes.
2025-06-06 15:41:42,839 - INFO - Parsed 1448 edges.
2025-06-06 15:41:43,125 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:43,125 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:43,129 - DEBUG - Initial node features tensor shape: torch.Size([693, 19])
2025-06-06 15:41:43,130 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:43,131 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 19])
2025-06-06 15:41:43,132 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-06 15:41:43,132 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:43,139 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:43,139 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:43,141 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-06 15:41:43,142 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:43,142 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-06 15:41:43,142 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-06 15:41:43,142 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:43,142 - INFO - Performing online update...
2025-06-06 15:41:43,142 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:43,143 - DEBUG - Updated RunningStats: new_mean=[-1.38683558e-09 -7.18498549e-10 -1.19111866e-08  2.12244123e-10
 -5.75262761e-10  3.32863735e-09 -4.00449498e-09 -7.05160804e-10
  2.12592065e-09  2.95518047e-09  8.23692768e-09  1.56805495e-09
 -8.11862767e-10  1.70491181e-09 -1.06817944e-09 -6.48373903e-09
 -3.03564187e-09 -7.10524897e-10  3.78560010e-09], new_M2=[3211.99991034 3211.99990781 3212.00003317 3212.00000573 3211.99991743
 3211.99994826 3211.99994311 3212.00002054 3212.00003659 3212.00002307
 3211.99995267 3212.00004821 3211.9999918  3212.00002838 3211.99996378
 3212.00002739 3211.99999766 3212.00001033 3211.99994824], new_n=3212
2025-06-06 15:41:43,143 - DEBUG - Updated RunningStats: new_mean=[ 1.37624085e+00  4.76403580e+00  4.84899653e-10 -1.55783640e-10
  2.27497704e-10  2.65771965e-10  1.65453974e-09 -7.67460194e-10
  7.70467669e-10 -3.35454207e-10 -2.82560541e-10 -1.31688972e-09
 -1.38107029e-11 -7.86312088e-09 -1.14833437e-09  3.29024842e-10
  3.29024842e-10  3.29024842e-10  3.29024842e-10  3.29024842e-10
  3.29024842e-10 -3.93578985e-10], new_M2=[ 1620.13116355 23245.85191212  6145.00005731  6145.00001993
  6145.00010458  6145.00007508  6144.99999103  6145.00000529
  6144.9999947   6145.00000106  6144.99993232  6145.00006579
  6144.99998454  6145.00008303  6144.99999139  6145.00000315
  6145.00000315  6145.00000315  6145.00000315  6145.00000315
  6145.00000315  6144.99989019], new_n=6145
2025-06-06 15:41:43,144 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.00000001 1.         0.99999999 0.99999999
 0.99999999 1.         1.00000001 1.         0.99999999 1.00000001
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:41:43,144 - DEBUG - Calculated standard deviation: [0.5134689  1.944965   1.         1.         1.00000001 1.00000001
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.00000001 1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:41:43,144 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:43,144 - DEBUG - Online update step: 1/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 2/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 3/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 4/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 5/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 6/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 7/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 8/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 9/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 10/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 11/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 12/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,144 - DEBUG - Online update step: 13/50
2025-06-06 15:41:43,144 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 14/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 15/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 16/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 17/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 18/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 19/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 20/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 21/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 22/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 23/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 24/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 25/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 26/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 27/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 28/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 29/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 30/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 31/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 32/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 33/50
2025-06-06 15:41:43,145 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,145 - DEBUG - Online update step: 34/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 35/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 36/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 37/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 38/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 39/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 40/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 41/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 42/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 43/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 44/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 45/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 46/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 47/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 48/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 49/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - DEBUG - Online update step: 50/50
2025-06-06 15:41:43,146 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,146 - WARNING - No successful steps during online update.
2025-06-06 15:41:43,147 - DEBUG - Current node mean: [-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], current edge mean: [ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:41:43,147 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1092
2025-06-06 15:41:43,147 - DEBUG - Updated reference mean: node=[-1.1009227e-08  1.1009227e-08 -4.7821331e-08 -4.1284602e-09
  1.2041342e-08  2.1330377e-08 -3.5091912e-08 -1.3761534e-08
  2.0642301e-09  6.8807671e-10  2.3394609e-08  1.6513841e-08
 -1.9266148e-08 -2.4770761e-08 -3.9908450e-08 -2.0642301e-09
 -3.3715757e-08 -2.3394609e-08 -2.7523068e-09], edge=[ 1.4191989e+00  4.9765191e+00  5.2689191e-09  0.0000000e+00
 -3.9516892e-09  2.6344595e-09  2.6344595e-09  2.6344595e-09
  2.6344595e-09  1.3172298e-09  1.6465371e-09 -9.2206083e-09
 -1.0537838e-08  1.3172297e-08 -6.5861488e-10  1.3172298e-09
  1.3172298e-09  1.3172298e-09  1.3172298e-09  1.3172298e-09
  1.3172298e-09 -6.5861488e-10]
2025-06-06 15:41:43,148 - DEBUG - Updated reference std: node=[1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223
 1.0007223 1.0007223 1.0007223 1.0007223 1.0007223], edge=[0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455]
2025-06-06 15:41:43,148 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:43,148 - INFO - Running anomaly detection...
2025-06-06 15:41:43,148 - INFO - Starting anomaly detection.
2025-06-06 15:41:43,160 - DEBUG - Node reconstruction errors: [35.217846 31.36616  31.37155  31.35475  31.33128  31.340069 31.365463
 30.442907 30.665258 30.120184 30.374962 30.538986 30.66734  34.72062
 34.720604 39.329277 34.783253 34.693626 30.682415 30.166227 30.65332
 30.648798 30.62824  34.734936 31.187496 30.666838 34.65864  31.211939
 34.68623  34.68451  13.210834 34.526314 30.682058 45.849754 30.617996
 30.310316 30.707413 30.64242  30.532751 30.66226  30.659353 37.766483
 30.414043 34.123665 30.427893 30.053669 30.05391  29.997173 30.04957
 29.794228 29.850702 29.826439 30.027164 37.382065 29.936771 30.090351
 30.818842 37.420113 29.814112 33.93109  12.359861 30.01443  13.146441
 38.92489  13.067837 38.693558 13.146441 13.067837 30.05382  30.08515
 30.327726 30.037437 29.883314 30.002089 30.676064 35.800148 29.997108
 30.051844 30.010046 30.382874 30.05979  30.036226 29.81412  29.95841
 30.383753 30.028034 30.082645 37.405    30.671688 30.401752 30.086699
 29.915133 30.082321 30.082777 30.06582  34.389606 38.71595  30.165749
 30.400375 40.512012 36.090363 35.538494 33.940006 33.546253 37.271305
 38.751617 40.146423 47.710506 40.83018  37.438515 31.772203 33.128212
 29.1707   38.4299   28.90473  39.212852 30.400307 32.466045 29.888887
 28.952946 33.297607 36.24355  37.624794 27.735651 29.489466 30.698397
 33.31125  29.390291 37.214306 33.425945 37.262257 37.364555 28.713852
 35.268604 38.471386 35.504017 30.023973 28.588892 33.457672 32.461098
 45.052334 41.176323 33.22399  33.558052 27.742033 15.356884 36.453457
 39.263565 32.75246  37.04656  27.735653 40.33876  35.325706 36.41458
 33.918457 39.62257  28.681303 29.650057 43.904716 37.609642 40.18201
 60.76712  29.091629 37.343224 32.87291  33.56491  40.364063 39.88382
 29.813124 29.474134 34.3696   32.747692 27.81642  31.037457 39.088146
 40.00486  40.217674 34.40087  33.97821  32.513615 40.192867 34.92213
 33.310104 48.152603 30.363234 31.95883  32.795055 29.165442 40.040623
 37.41501  35.181293 29.83401  32.75965  35.78276  29.9237   35.6928
 35.303272 40.193054 31.889725 28.36416  37.909115 30.504131 28.948656
 36.764034 29.679434 37.58977  31.78862  34.123657 38.48885  35.823395
 27.983122 32.704582 30.651756 30.606176 36.398327 39.07089  28.280016
 27.800364 29.1771   37.845226 42.223763 40.89846  40.177197 31.84867
 38.889168 28.499704 31.219736 37.424427 35.77722  30.067358 29.495619
 27.742023 40.168777 32.778908 28.607304 27.785599 30.545301 29.137732
 46.72165  33.336132 37.75536  28.896109 35.242252 29.095703 69.07231
 28.696375 39.3299   45.887165 28.781193 33.416515 31.392902 33.768677
 39.829636 30.595787 40.934185 36.258865 37.382877 40.29788  31.977783
 38.785892 36.332867 33.34025  27.697163 27.74203  28.064322 27.707642
 33.574192 29.22143  39.74387  27.681252 33.998417 35.117664 32.43822
 28.922083 27.742023 41.075775 30.859488 39.172485 37.574684 40.39829
 38.483368 39.988525 28.585026 28.672115 36.741    39.612152 32.32198
 29.880827 43.3349   43.353912 59.66875  32.809216 27.9689   28.376883
 32.96039  27.688519 40.01811  31.657711 29.1458   32.467133 43.351887
 31.672781 32.439507 32.287357 35.79012  40.21494  37.88948  33.3635
 33.9779   29.119022 27.742033 39.606194 30.547462 27.729422 39.565083
 30.090797 27.979427 32.67002  39.79736  42.0536   27.703741 27.93733
 34.06542  34.733467 28.394175 34.376144 29.768982 35.35265  32.643208
 38.41297  30.026165 32.291595 28.7052   33.467735 39.418102 34.668114
 27.742033 33.013416 36.0093   27.742033 39.73247  33.435215 37.94985
 38.01772  33.062466 33.956474 34.24831  29.115324 35.733654 28.021038
 37.175236 34.37356  33.62501  30.041006 33.074596 38.217102 27.913118
 33.439095 35.331894 30.625877 33.45943  41.209118 42.04266  41.326958
 30.675928 40.16579  28.56235  34.461864 37.406525 29.719585 28.285648
 40.034164 37.003105 30.375929 40.18371  35.770523 38.7755   37.09603
 36.511795 39.587196 32.89539  30.634119 46.329536 31.570328 29.360844
 40.875782 33.813026 40.392216 37.71303  33.34187  34.64175  31.893236
 36.627155 36.11471  36.93463  28.902033 42.761158 38.767746 34.178425
 39.21532  33.81321  28.907902 39.740486 36.08211  39.74196  41.20448
 35.68153  28.19058  33.19644  30.106667 35.780132 35.82443  39.9859
 37.418797 28.726135 33.45625  36.874805 34.336014 31.467215 30.342812
 30.295128 34.1951   29.998629 33.6628   41.46103  42.95879  33.306835
 33.823536 30.032677 47.143833 41.84016  28.671768 32.318924 29.082909
 33.618473 33.7305   35.51583  28.92379  28.60908  32.160892 40.800995
 33.10562  32.295223 29.40007  35.267277 35.094543 36.722206 40.183533
 36.21198  39.71942  40.176    36.25547  35.7299   35.017345 36.01874
 37.80628  40.176807 37.711163 28.615107 37.807457 58.990936 30.57396
 29.138798 35.677113 38.52841  37.877712 33.469128 31.463951 35.756916
 33.371365 29.040781 37.322777 38.77189  36.250072 36.065456 30.26101
 34.153694 35.751305 36.148796 29.351398 30.146324 43.257668 36.831818
 29.39755  30.050247 29.310476 35.749855 28.678717 37.616074 35.750412
 27.735641 28.940392 35.737495 36.05096  34.123665 37.472473 41.193382
 30.298119 33.55975  29.465265 35.97149  36.034473 33.29704  35.738537
 35.822277 39.419407 30.18088  33.415936 29.024237 42.050064 35.20025
 27.779963 37.58504  33.664684 35.288494 34.21917  33.593834 30.513493
 30.410875 29.020113 38.438446 35.212753 29.0818   28.997187 35.19864
 28.83005  37.400295 35.321915 36.038403 37.625763 29.40481  33.9338
 35.117176 29.930143 33.63924  38.760693 36.010807 37.3092   30.578283
 29.019043 29.884901 42.352615 36.247143 33.95999  39.896725 28.889816
 36.23773  36.986683 38.16148  40.655    35.94756  33.32524  31.05929
 29.081154 28.877234 40.647926 30.869385 36.2478   30.414616 37.080936
 33.460262 42.20508  37.967144 39.907    33.75985  31.869238 40.944004
 39.971264 40.84915  34.60159  30.393442 29.702448 41.28735  37.31332
 40.370747 32.779552 29.221256 35.350056 33.156586 29.085539 37.935986
 42.532043 41.43449  36.860203 41.359528 38.905987 37.8579   32.964176
 48.14812  41.56115  29.101492 37.41501  30.025284 41.335827 33.926346
 40.810696 37.16735  30.109522 33.85507  38.060635 30.047663 33.934868
 29.415293 35.02141  33.577484 33.434746 39.55512  33.415688 37.329132
 36.067314 37.61976  32.783443 35.824455 48.928593 37.877003 30.37108
 38.39948  35.96428  33.348675 41.513542 41.57967  30.055458 35.851627
 34.109497 41.225418 30.000093 33.32466  29.539782 41.404278 38.199795
 33.124905 33.345886 33.956142 32.055927 33.34639  30.054941 30.174017
 29.963192 29.987919 38.42979  33.72294  33.32461  41.427597 39.86268
 41.414536 31.022152 33.327824 33.721382 34.097218 33.92539  33.323933
 30.15226  30.02602  28.355648 33.946198 32.727737 33.335835 33.32797
 33.989414 34.567272 41.21117  33.34241  39.561085 33.71439  35.20146
 38.75656  38.656128 33.806557 33.969913 33.962635 33.933754 29.997192
 35.648327 33.947254 41.895798 37.302563 37.956272 42.047325 46.643566
 30.181725 31.633905 34.54512  29.891039 34.556004 36.032562 39.90752
 37.367207 30.066143 46.633595 29.877174 31.368084 29.515255 29.780443]
2025-06-06 15:41:43,161 - DEBUG - Edge reconstruction errors: [0.19999999 0.7999999  0.74947256 ... 0.19999999 0.7999867  0.19999999]
2025-06-06 15:41:43,162 - ERROR - An error occurred while processing file nw_graph_encoded_1749044768.dot: name 'datetime' is not defined
2025-06-06 15:41:43,163 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:43,163 - INFO - 
--- Processing file: nw_graph_encoded_1749044828.dot ---
2025-06-06 15:41:43,163 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot
2025-06-06 15:41:43,163 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044828.dot file.
2025-06-06 15:41:43,172 - INFO - Parsed 715 nodes.
2025-06-06 15:41:43,185 - INFO - Parsed 1521 edges.
2025-06-06 15:41:43,493 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:43,493 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:43,497 - DEBUG - Initial node features tensor shape: torch.Size([715, 19])
2025-06-06 15:41:43,498 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:43,499 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 19])
2025-06-06 15:41:43,499 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-06 15:41:43,500 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:43,507 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:43,508 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:43,509 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 2])
2025-06-06 15:41:43,511 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:43,511 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 20])
2025-06-06 15:41:43,511 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 22])
2025-06-06 15:41:43,512 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:43,512 - INFO - Performing online update...
2025-06-06 15:41:43,512 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:43,512 - DEBUG - Updated RunningStats: new_mean=[-1.17986499e-09 -5.42144998e-10 -1.56999120e-08 -9.23022017e-10
 -2.77760377e-09  5.20610979e-09 -9.07591873e-10 -1.04729322e-09
  8.58514826e-10  2.66187028e-09  1.28084720e-08  1.60888524e-09
 -1.44951453e-09  4.45668801e-09 -8.50925744e-10 -5.45500795e-09
 -4.80519286e-09 -1.18721691e-09  4.27265279e-09], new_M2=[3926.99984538 3926.99984285 3927.000027   3927.00002203 3926.99994732
 3926.99990299 3926.99993457 3926.99999692 3927.000057   3926.99999877
 3926.99994933 3927.00005612 3927.000031   3927.0000299  3926.99994641
 3927.00002706 3926.99997405 3926.99998262 3926.99992076], new_n=3927
2025-06-06 15:41:43,513 - DEBUG - Updated RunningStats: new_mean=[ 1.38559875e+00  4.80811375e+00  3.12663066e-10 -3.05557001e-10
  2.13521737e-10  2.34987995e-10  1.15006637e-09 -6.53458062e-10
  6.90796462e-10  7.18150114e-10 -4.64013614e-10 -1.49485289e-09
  1.19255090e-10 -2.92055762e-09 -8.24276970e-10  2.94922106e-10
  2.94922106e-10  2.94922106e-10  2.94922106e-10  2.94922106e-10
  2.94922106e-10 -1.63903616e-10], new_M2=[ 2014.17010175 28058.73532481  7665.99999424  7665.99992285
  7666.00009912  7666.00008429  7666.00001712  7665.99998279
  7665.99997992  7665.9999805   7666.00003125  7666.00007573
  7665.99998097  7666.0000879   7666.00002956  7666.00001248
  7666.00001248  7666.00001248  7666.00001248  7666.00001248
  7666.00001248  7665.99989793], new_n=7666
2025-06-06 15:41:43,513 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         0.99999999 0.99999999
 0.99999999 1.         1.00000001 1.         0.99999999 1.00000001
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:41:43,513 - DEBUG - Calculated standard deviation: [0.51258237 1.91315272 1.         0.99999999 1.00000001 1.00000001
 1.         1.         1.         1.         1.         1.
 1.         1.00000001 1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:41:43,513 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:43,513 - DEBUG - Online update step: 1/50
2025-06-06 15:41:43,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,513 - DEBUG - Online update step: 2/50
2025-06-06 15:41:43,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,513 - DEBUG - Online update step: 3/50
2025-06-06 15:41:43,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,513 - DEBUG - Online update step: 4/50
2025-06-06 15:41:43,513 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,513 - DEBUG - Online update step: 5/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 6/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 7/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 8/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 9/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 10/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 11/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 12/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 13/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 14/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 15/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 16/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 17/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 18/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 19/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 20/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 21/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 22/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 23/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 24/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 25/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 26/50
2025-06-06 15:41:43,514 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,514 - DEBUG - Online update step: 27/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 28/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 29/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 30/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 31/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 32/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 33/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 34/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 35/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 36/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 37/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 38/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 39/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 40/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 41/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 42/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 43/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 44/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 45/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 46/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 47/50
2025-06-06 15:41:43,515 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,515 - DEBUG - Online update step: 48/50
2025-06-06 15:41:43,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,516 - DEBUG - Online update step: 49/50
2025-06-06 15:41:43,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,516 - DEBUG - Online update step: 50/50
2025-06-06 15:41:43,516 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,516 - WARNING - No successful steps during online update.
2025-06-06 15:41:43,516 - DEBUG - Current node mean: [-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], current edge mean: [ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:41:43,516 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0931
2025-06-06 15:41:43,517 - DEBUG - Updated reference mean: node=[-2.6676204e-08  2.6676204e-08 -1.3338102e-08 -6.6690511e-09
 -2.8010016e-08  2.1340965e-08  2.2007869e-08 -1.3338102e-08
  1.4671913e-08  8.0028615e-09  4.2681929e-08 -8.0028615e-09
 -2.8010016e-08  2.6676206e-09 -1.4005008e-08 -8.0028615e-09
 -2.4008584e-08  7.3359563e-09  1.2004292e-08], edge=[ 1.4234056e+00  4.9861932e+00  1.8810145e-09  1.8810145e-09
  6.8970527e-09 -5.0160387e-09  0.0000000e+00  2.5080193e-09
 -5.0160387e-09  5.0160387e-09  1.0032077e-08 -6.2700480e-09
 -1.2540097e-09  1.5048116e-08 -4.7025361e-09 -2.5080193e-09
 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09 -2.5080193e-09
 -2.5080193e-09  0.0000000e+00]
2025-06-06 15:41:43,517 - DEBUG - Updated reference std: node=[1.0007    1.0007    1.0007    1.0007    1.0007    1.0007    1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007    1.0007001 1.0007
 1.0007    1.0007    1.0007    1.0007    1.0007   ], edge=[0.5073971 1.7682712 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289]
2025-06-06 15:41:43,517 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:43,517 - INFO - Running anomaly detection...
2025-06-06 15:41:43,517 - INFO - Starting anomaly detection.
2025-06-06 15:41:43,529 - DEBUG - Node reconstruction errors: [35.68821   35.684776  35.937016  31.972319  35.986313  35.701836
 35.700016  35.661163  36.1024    35.6916    35.69452   47.168797
 32.62209   32.52182   35.71368   31.883339  31.888954  39.082176
 31.876633  31.858557  31.88217   32.224003  38.70222   31.248009
 30.729864  30.982534  31.114843  31.256922  35.394997  35.39551
 40.00072   35.46092   35.367523  31.266058  38.592678  38.715096
 38.721935  31.21381   35.40898   31.58605   39.006947  35.33163
 31.609179  35.368633  35.358307  13.6067295 35.091286  31.264944
 46.47694   31.222914  30.918505  31.296087  31.230516  31.145954
 31.271555  31.249887  38.43154   31.03817   34.731243  31.038969
 30.69866   30.700369  30.661451  30.694168  30.454422  30.51163
 30.486383  30.667425  38.04919   30.552841  30.738327  31.3783
 38.092678  30.47406   34.559834  12.878624  30.654612  13.553619
 43.19011   13.487016  39.366253  13.553619  13.487016  30.6989
 30.735214  30.95944   30.682308  30.551926  30.656893  31.259457
 36.464733  30.607943  30.695528  30.652369  30.990309  30.70492
 30.680214  30.474487  30.577501  31.        30.66996   30.731033
 38.07832   31.610249  31.008461  30.736183  30.53284   30.730337
 30.730087  30.712557  35.07942   42.94746   30.78808   31.034218
 40.349174  36.685097  36.13933   34.404358  34.172375  37.824574
 42.94632   40.91281   48.912365  41.573475  38.4361    32.561596
 33.76703   29.91554   39.078884  29.424557  39.845894  30.801908
 33.172775  30.385555  29.544006  33.89771   36.81059   38.336575
 28.589998  36.2989    31.28638   34.218285  30.09251   37.87337
 33.974247  38.5142    39.37602   29.479792  35.893867  39.156696
 36.312187  30.668594  29.360733  34.040844  33.167736  46.564377
 42.51883   33.807438  39.881443  28.59393   15.806159  36.979362
 40.15703   33.42621   37.91858   28.589998  41.88982   36.297493
 36.9427    34.547123  40.282604  30.692846  30.167744  44.63014
 38.320946  40.675037  35.80002   62.30083   29.674631  38.299084
 33.521698  34.342274  40.94123   40.70832   36.390778  30.472977
 29.99754   34.942753  33.420815  28.675165  31.915308  40.834885
 40.801178  41.018414  35.01482   34.576168  33.16311   40.947735
 35.644073  33.917675  49.05531   30.996042  32.74306   33.49002
 29.902254  40.83094   38.085087  36.01807   30.472849  37.00192
 36.38225   30.41987   32.23472   36.29368   35.861958  40.688446
 32.67322   29.142511  39.06771   31.140394  29.539782  37.73873
 30.30116   38.08628   32.57777   39.88413   39.37623   36.39241
 28.833946  33.289154  31.23672   31.220201  36.883724  40.25394
 29.060125  28.659035  29.832191  38.654472  43.548977  41.781204
 40.738983  33.746696  39.55345   29.247728  31.611103  38.096054
 36.454338  30.71635   30.019396  28.593933  40.95389   33.479748
 29.361832  28.63893   31.159876  29.847172  48.1782    35.02601
 38.18021   29.642086  35.833717  29.678696  71.03424   29.303448
 39.95838   47.07827   29.476727  34.197006  32.329933  34.440155
 41.233173  31.04764   43.772427  36.821945  38.751804  40.624218
 38.770626  39.459435  36.86125   35.38027   28.549265  28.593933
 28.710514  28.559654  34.342804  29.768873  40.539722  28.533045
 34.578777  35.761986  33.209484  29.663002  28.593937  41.821228
 31.811142  39.777996  38.939117  41.568043  40.677692  40.785255
 29.360043  29.27799   37.26346   40.194035  33.06261   30.378624
 44.06843   44.099102  61.574757  33.641663  28.819077  29.000189
 34.17643   28.542072  40.813335  32.521027  29.694725  33.16629
 43.60631   32.427425  33.19713   33.021652  36.389175  40.967674
 39.605663  34.01753   34.573456  32.096344  29.667387  28.593927
 40.314632  31.1735    28.58473   40.1992    30.739069  28.666166
 33.494892  41.070236  42.680737  28.557692  28.62252   34.970074
 35.251095  29.016394  35.06218   30.230623  35.79891   34.09732
 38.967045  30.668354  33.178917  29.444088  34.051197  35.692406
 39.97978   35.60669   28.593937  33.66569   36.811375  30.06151
 41.453583  34.316742  38.99052   38.84339   33.714863  34.53712
 34.93792   29.698166  36.539703  28.658573  37.65457   35.062336
 34.458843  30.683163  33.770817  38.78668   28.772995  34.22025
 35.93162   31.214355  34.041214  41.91802   42.671867  42.42026
 31.257004  40.923218  29.122694  35.14485   38.080532  30.379694
 29.071087  41.16832   37.969597  30.978136  41.005177  36.537354
 39.3367    37.758434  37.488106  40.65682   33.63873   31.222826
 47.045826  32.396477  29.909979  42.226448  35.691006  34.431908
 41.105694  38.223663  33.917553  35.324738  32.676952  37.46781
 37.027752  37.716087  29.650127  43.820766  39.440735  34.66324
 39.939167  34.481598  29.426575  40.536896  36.677982  40.53988
 42.676666  36.167225  28.928543  33.819324  30.760279  36.38046
 36.458614  40.78311   38.091534  29.494074  34.014137  37.260582
 35.023666  32.408173  30.96839   30.925003  34.921303  31.401728
 34.180714  42.11993   44.341045  33.91438   34.337208  31.280573
 48.31148   42.486588  29.440834  33.058994  29.666063  34.397022
 34.335583  36.116405  29.671907  29.37647   32.906162  41.469887
 33.750885  33.031025  30.0902    35.914837  35.76719   39.701843
 40.96751   36.77797   40.267906  41.568764  36.81856   36.535023
 35.93081   36.82103   38.27777   40.19221   38.181713  34.86652
 39.32516   60.30538   31.026138  29.688757  36.484932  39.191166
 39.28142   34.08446   32.203236  36.56384   33.993958  29.778946
 37.794632  39.268368  36.81375   36.803917  30.713356  34.916283
 36.55774   36.916985  30.085844  30.613722  44.253254  37.763813
 30.100046  30.69511   29.970388  36.55701   29.447424  38.18923
 36.55594   28.589998  29.684078  36.54437   36.84989   34.731243
 37.98798   41.09671   30.783072  34.155617  29.995676  36.539467
 36.83669   33.883106  37.038055  36.5972    39.94392   30.635967
 34.195633  29.61284   42.679047  35.63984   28.63824   38.170906
 34.21073   35.436066  36.122814  34.750507  34.54464   30.93743
 31.020723  29.765282  39.12169   35.818615  29.819626  29.718506
 35.688744  29.58637   38.074936  35.881092  36.840683  37.99744
 30.124779  34.562885  35.761868  30.427696  34.213566  39.434093
 36.8129    37.98277   31.029953  29.752884  30.503544  43.465622
 37.014515  34.583546  40.783363  29.649706  37.005157  37.463432
 38.864956  42.32455   36.658237  35.02564   31.5922    29.813707
 29.601774  41.835243  31.505367  37.016384  31.024485  37.78878
 34.240818  42.145397  38.531826  40.52674   34.368122  32.649197
 40.71278   40.858868  41.588272  35.095478  31.002995  30.206337
 41.935886  37.785725  41.67564   33.480064  29.96289   36.873814
 33.96213   29.668533  38.302124  43.16481   42.119156  37.341133
 42.50583   39.5451    38.397953  33.77629   48.80303   42.448483
 29.841839  38.084892  30.665321  42.033142  34.55509   41.556393
 37.687126  30.547373  34.45454   38.781475  30.69137   34.557312
 30.103806  35.584026  34.35519   34.216625  40.18545   34.196156
 37.801037  36.66257   38.041206  33.483803  37.114025  49.814247
 38.41711   30.536179  39.378174  36.5324    34.231503  42.16515
 42.224865  30.586676  37.12409   34.697086  41.932224  30.505856
 35.029003  30.188679  42.095585  39.58895   33.929382  33.999443
 34.50416   32.865185  33.999542  30.698627  30.828772  30.575397
 30.493338  39.11246   34.32916   35.023895  42.112953  40.388355
 42.101227  31.910803  35.02452   34.327557  34.685215  34.51871
 35.043743  30.803827  30.668898  29.164785  34.57151   33.34445
 33.988323  34.896183  34.531506  35.268414  42.380035  33.99531
 40.137306  34.319614  35.69679   39.91471   39.34905   34.479176
 35.084717  35.26828   35.623016  30.64003   36.341908  34.571198
 42.541573  37.977173  38.371372  42.675278  47.41359   30.836706
 31.970984  35.045483  30.555712  35.06044   36.822216  40.479992
 38.03947   30.685184  47.79077   30.49438   39.08347   30.15642
 30.399761 ]
2025-06-06 15:41:43,529 - DEBUG - Edge reconstruction errors: [0.19999999 0.7999999  0.7599084  ... 0.19999999 0.7999922  0.19999999]
2025-06-06 15:41:43,531 - ERROR - An error occurred while processing file nw_graph_encoded_1749044828.dot: name 'datetime' is not defined
2025-06-06 15:41:43,532 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:43,532 - INFO - 
--- Processing file: nw_graph_encoded_1749044888.dot ---
2025-06-06 15:41:43,532 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot
2025-06-06 15:41:43,532 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044888.dot file.
2025-06-06 15:41:43,541 - INFO - Parsed 731 nodes.
2025-06-06 15:41:43,555 - INFO - Parsed 1560 edges.
2025-06-06 15:41:43,876 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:43,876 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:43,880 - DEBUG - Initial node features tensor shape: torch.Size([731, 19])
2025-06-06 15:41:43,881 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:43,882 - DEBUG - Node features tensor shape after scaling: torch.Size([731, 19])
2025-06-06 15:41:43,883 - DEBUG - Edge index tensor shape: torch.Size([2, 1560])
2025-06-06 15:41:43,883 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:43,891 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:43,892 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:43,893 - DEBUG - Shape of encoded categorical edge features: torch.Size([1560, 2])
2025-06-06 15:41:43,894 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:43,895 - DEBUG - Shape of scaled numerical edge features: torch.Size([1560, 20])
2025-06-06 15:41:43,895 - DEBUG - Final edge attributes tensor shape: torch.Size([1560, 22])
2025-06-06 15:41:43,895 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:43,895 - INFO - Performing online update...
2025-06-06 15:41:43,895 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:43,896 - DEBUG - Updated RunningStats: new_mean=[ 3.13706552e-10 -1.76547409e-09 -1.38150847e-08 -1.18124813e-09
 -2.49525670e-09  4.02280167e-09 -3.08126964e-09 -1.33720167e-09
  7.99761764e-13  3.18305182e-09  1.09167481e-08  1.50675116e-09
  1.47156165e-10  4.65941204e-09 -3.15665968e-09 -3.42807883e-09
 -4.95962261e-09 -1.19884288e-09  3.98601263e-09], new_M2=[4657.99987069 4657.99986817 4657.99998432 4658.00005959 4657.999962
 4657.99989125 4657.99994142 4657.99994555 4658.00006912 4658.00003733
 4657.99995587 4658.00008735 4658.00001376 4658.00001738 4657.9999517
 4658.00003202 4658.00001329 4658.00002733 4657.99994175], new_n=4658
2025-06-06 15:41:43,896 - DEBUG - Updated RunningStats: new_mean=[ 1.39258617e+00  4.83709083e+00  1.95707960e-10 -2.51389619e-10
  1.32352082e-10  8.70157528e-11  3.99053074e-10  2.50136477e-10
  3.25053761e-10  1.06624246e-09 -8.37891266e-10 -1.36664621e-09
  1.16560431e-11 -7.46188649e-10 -8.31474922e-10  2.56322539e-10
  2.56322539e-10  2.56322539e-10  2.56322539e-10  2.56322539e-10
  2.56322539e-10 -1.62132563e-10], new_M2=[ 2418.052894   32992.14751788  9226.00002589  9225.99992544
  9226.00009122  9225.9999926   9226.00000993  9226.00002649
  9225.99998307  9225.99996277  9226.00006952  9226.00008354
  9225.99997519  9226.00005626  9226.00005346  9226.00004166
  9226.00004166  9226.00004166  9226.00004166  9226.00004166
  9226.00004166  9225.99989463], new_n=9226
2025-06-06 15:41:43,896 - DEBUG - Calculated standard deviation: [0.99999999 0.99999999 1.         1.00000001 1.         0.99999999
 0.99999999 0.99999999 1.00000001 1.         1.         1.00000001
 1.         1.         0.99999999 1.         1.         1.
 0.99999999]
2025-06-06 15:41:43,897 - DEBUG - Calculated standard deviation: [0.51194838 1.89103065 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:41:43,897 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:43,897 - DEBUG - Online update step: 1/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 2/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 3/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 4/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 5/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 6/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 7/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 8/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 9/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 10/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 11/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 12/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 13/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 14/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,897 - DEBUG - Online update step: 15/50
2025-06-06 15:41:43,897 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 16/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 17/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 18/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 19/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 20/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 21/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 22/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 23/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 24/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 25/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 26/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 27/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 28/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 29/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 30/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 31/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 32/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 33/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 34/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 35/50
2025-06-06 15:41:43,898 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,898 - DEBUG - Online update step: 36/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 37/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 38/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 39/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 40/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 41/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 42/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 43/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 44/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 45/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 46/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 47/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 48/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 49/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - DEBUG - Online update step: 50/50
2025-06-06 15:41:43,899 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:43,899 - WARNING - No successful steps during online update.
2025-06-06 15:41:43,900 - DEBUG - Current node mean: [ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], current edge mean: [ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:41:43,900 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0753
2025-06-06 15:41:43,900 - DEBUG - Updated reference mean: node=[ 3.3023092e-08 -3.3023092e-08  5.2184643e-09  1.5655392e-08
  1.8264624e-08 -2.0873857e-08 -1.1741545e-08 -7.1753883e-09
 -1.2067698e-08  1.9569240e-08  2.5440013e-08  3.0006170e-08
 -2.0873857e-08  2.2830781e-08 -2.6092322e-09  7.8276958e-09
  1.0436929e-08 -2.5766166e-08 -3.2615400e-08], edge=[ 1.4269230e+00  4.9794869e+00  2.4453188e-09  1.2226594e-09
  0.0000000e+00 -4.8906377e-09 -9.7812753e-09  4.8906377e-09
  4.8906377e-09  4.8906377e-09 -1.2226594e-09  0.0000000e+00
 -2.4453188e-09  0.0000000e+00 -7.3359563e-09 -2.4453188e-09
 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09 -2.4453188e-09
 -2.4453188e-09 -4.8906377e-09]
2025-06-06 15:41:43,901 - DEBUG - Updated reference std: node=[1.0006847 1.0006847 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006846 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847
 1.0006847 1.0006847 1.0006847 1.0006847 1.0006847], edge=[0.50758785 1.7720196  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207  1.0003207  1.0003207
 1.0003207  1.0003207  1.0003207  1.0003207 ]
2025-06-06 15:41:43,901 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:43,901 - INFO - Running anomaly detection...
2025-06-06 15:41:43,901 - INFO - Starting anomaly detection.
2025-06-06 15:41:43,919 - DEBUG - Node reconstruction errors: [38.403435 34.793884 33.744297 36.87129  31.657785 36.6226   32.517906
 36.65554  36.58201  36.271954 36.26694  35.719353 31.669838 35.76327
 36.27977  36.273834 36.21135  36.63696  36.27015  36.275932 47.895855
 32.25188  39.412773 36.28211  31.542461 31.54923  38.782352 31.536005
 31.498892 31.541021 39.381126 38.41686  30.946661 30.450655 30.699415
 30.77193  36.61022  30.952772 35.20291  35.197906 40.633114 35.25664
 35.176014 30.966486 40.070667 38.43515  38.437054 30.89501  35.217712
 31.257502 38.6955   35.144745 31.280176 35.16193  35.16845  13.764931
 35.72014  30.961496 47.25935  30.91504  30.635614 31.00592  30.925829
 30.852404 30.97786  30.946985 38.17331  30.767197 35.408512 30.767311
 30.448572 30.45061  36.872692 30.41171  30.443851 30.207764 30.26394
 30.23899  30.415575 37.80642  30.287806 30.4903   31.047247 37.847828
 30.22692  35.233215 13.234957 30.402132 13.830457 43.77776  13.785879
 40.06535  13.830457 13.785879 30.449017 30.48728  30.696854 30.431433
 30.308462 30.404757 30.959421 37.496624 30.306374 30.445162 30.399593
 30.703459 30.455153 30.42918  30.22768  30.319609 30.716812 30.418344
 30.482872 37.831112 31.248226 30.721905 30.488272 30.268917 30.482061
 30.481604 30.463087 34.879063 43.575054 30.521578 30.77008  40.540005
 36.516273 35.984787 34.227345 34.844917 37.663563 43.571114 41.11002
 49.498646 32.09769  42.34069  38.21292  33.260468 34.43606  29.709745
 39.154575 29.05834  40.96073  30.412134 33.876244 30.025475 29.251429
 34.55382  36.627083 39.04355  28.43481  36.474545 30.996668 35.156586
 29.87594  38.0929   34.987904 38.892506 39.404022 29.276165 35.92697
 39.85546  36.163948 30.417227 29.164871 33.863335 33.871826 47.359306
 43.215664 33.6719   40.456112 28.426275 15.891049 36.789288 40.101147
 36.87081  34.12676  38.121475 28.43481  42.79524  39.935223 36.752316
 35.21683  40.74569  30.430552 29.822086 45.236065 39.031136 40.474922
 36.322838 62.648876 29.3763   38.026413 34.209034 34.179718 41.17984
 41.54916  36.8766   30.225887 29.657442 35.553352 34.12122  28.498817
 32.529675 40.798454 41.616333 41.532486 34.419353 35.227417 33.848206
 41.727886 35.754974 33.784325 49.848343 30.732502 33.459415 33.375355
 29.705185 41.639904 37.84235  35.877224 30.22504  39.4239   36.221508
 30.06233  31.845825 36.131763 35.669155 40.4888   33.391018 28.93305
 38.83332  30.877357 29.245508 37.534637 30.00501  37.91582  33.287216
 40.49567  39.97819  36.220894 28.648743 33.11414  30.932226 30.945637
 36.685184 40.237736 28.85084  28.46521  29.541946 38.41996  44.0388
 42.62819  40.60365  34.396862 39.822277 29.004066 31.264568 37.85088
 35.959324 30.46745  29.682425 28.426273 41.112526 34.208218 29.142057
 28.465342 30.869263 29.630497 48.99981  35.61788  37.980545 29.45106
 35.73643  29.38191  74.02351  29.054838 36.612976 40.202034 48.13565
 29.214417 34.029575 31.98069  42.48851  41.91655  30.724276 44.133762
 36.644222 39.394238 40.742085 39.399574 40.136436 36.670193 35.923763
 28.36316  28.426275 28.49661  28.374014 34.177353 29.434753 41.353115
 28.3459   35.223602 35.61519  32.88499  29.473068 28.426273 42.60599
 31.469213 40.29716  39.254257 42.250885 40.666706 41.579277 29.16134
 29.017508 38.02914  40.419727 33.776424 30.021141 44.70299  43.989487
 61.59262  33.50178  28.618158 28.777836 33.95913  28.371437 41.620052
 32.366398 29.364695 33.85727  33.528004 43.91979  33.146088 33.014263
 33.742275 36.22593  41.754665 40.189075 36.242565 35.22444  31.739538
 29.337845 28.426285 40.882042 30.879915 28.415428 40.7915   30.491089
 28.453915 32.976578 41.142124 43.35106  28.387245 28.455862 35.401627
 35.844826 28.804237 35.314625 29.867132 39.019356 34.721817 38.996517
 30.416681 32.778664 29.238703 33.873817 36.271694 40.199463 35.37966
 28.42628  34.346962 36.64948  36.698997 41.391006 34.926685 38.8499
 38.58349  34.391804 35.190163 35.191906 29.409039 36.3851   28.435223
 37.475414 35.316616 34.253387 30.432133 34.070694 38.576996 28.569992
 34.050858 35.778862 30.899385 33.864937 42.62975  42.591637 43.054165
 30.95189  41.701183 28.771564 34.953762 37.82834  30.13771  28.852863
 41.363163 37.70653  30.681725 41.833977 36.360428 39.108227 39.171936
 37.531727 40.819534 33.452423 30.911814 47.753128 33.11473  29.588144
 42.89409  36.271027 35.093723 41.85616  38.07973  34.597622 35.118843
 33.39444  39.431854 37.68401  38.467884 29.462877 44.870533 40.120125
 34.889736 40.15108  33.94046  29.064245 41.35312  36.51004  41.352318
 42.401577 36.332893 28.733759 33.669502 30.514212 36.21671  36.723534
 41.591885 37.84328  29.306068 33.868618 37.0321   35.2767   32.07134
 30.685026 30.647654 34.75225  31.062449 34.022243 42.793213 44.95954
 33.78115  34.169296 30.944637 49.10813  43.19854  29.261969 33.773212
 29.365559 34.23274  35.004932 35.959038 29.482897 29.194992 33.621124
 42.167263 33.24844  33.74971  29.862728 36.17333  36.0411   39.513912
 40.761932 36.59879  40.40122  42.246815 36.64076  36.380024 36.380756
 36.65518  38.086304 40.15376  37.994358 34.633106 39.08323  61.16261
 30.701933 29.362707 36.324677 38.838123 39.904594 34.766495 31.975763
 36.40732  33.83276  29.578974 37.57012  39.078247 36.636395 36.598484
 30.34582  34.69173  36.399235 36.73329  29.886793 30.266441 44.86581
 37.40345  29.883    30.444809 29.6868   36.39999  29.2691   38.369358
 36.402725 28.434805 29.492813 36.388557 36.6871   35.408512 37.812828
 41.035927 30.457006 34.812145 29.657085 36.370182 36.67444  33.746296
 36.95051  36.41657  39.741978 30.273226 34.029953 29.309214 43.348354
 39.048256 28.443514 38.018665 34.061916 36.008152 35.990417 34.588512
 34.600494 30.574457 30.739859 29.564974 39.813656 36.053574 29.620949
 29.513939 36.282013 29.3781   37.822765 35.688557 36.67676  37.73984
 29.915    35.22594  35.6139   30.072096 34.032944 40.121014 36.649525
 37.73606  30.707224 29.55205  30.241358 44.125744 36.836704 35.245598
 40.73552  29.450312 36.82586  37.248425 39.570602 42.950916 37.5573
 35.629936 31.244774 29.612192 29.411268 42.47472  31.792955 39.092762
 30.744844 37.76993  34.072865 42.46641  38.321743 40.51299  35.039356
 33.37054  40.979645 40.846344 42.34732  34.903606 30.72424  29.855642
 42.6398   37.56057  41.625744 34.209137 29.768387 37.055138 33.819653
 29.368404 38.0344   43.860626 42.8382   37.12484  43.144146 39.412975
 38.231052 33.618996 49.63086  43.09149  29.645311 37.84248  30.413166
 42.75721  35.20911  42.321842 37.521473 30.239239 35.107357 39.404083
 30.440838 35.21631  29.882257 34.946857 34.190357 34.045357 40.063995
 34.02847  37.577667 36.491184 37.79834  34.212215 37.294357 51.070354
 38.250374 30.193726 39.407974 36.36192  34.86659  42.843666 42.906353
 30.268831 37.300793 36.876392 35.326126 42.6459   30.182299 35.61932
 29.939392 42.80937  40.210552 33.79341  34.704773 35.798298 32.71068
 34.7044   30.44805  30.585962 30.300613 30.169237 39.801983 34.999287
 35.625607 42.830902 40.57924  42.818188 32.52772  35.628998 34.99747
 35.322277 35.16473  35.6248   30.566547 30.417528 28.97212  35.22145
 33.21295  34.69189  35.49073  34.3703   35.496273 43.01841  35.490597
 40.3531   34.98818  36.27197  40.52425  40.04926  33.911434 35.667274
 35.845142 36.172234 30.3686   36.580334 35.233593 43.201492 37.72875
 38.11532  43.339134 48.324894 30.59436  31.60522  34.838287 30.307848
 34.86924  37.816742 40.698986 37.791424 30.424095 48.30205  30.232197
 38.784912 29.88999  30.143152]
2025-06-06 15:41:43,919 - DEBUG - Edge reconstruction errors: [0.19999999 0.7999997  0.7615272  ... 0.19999999 0.7999123  0.19999999]
2025-06-06 15:41:43,921 - ERROR - An error occurred while processing file nw_graph_encoded_1749044888.dot: name 'datetime' is not defined
2025-06-06 15:41:43,922 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:43,922 - INFO - 
--- Processing file: nw_graph_encoded_1749044948.dot ---
2025-06-06 15:41:43,922 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot
2025-06-06 15:41:43,922 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749044948.dot file.
2025-06-06 15:41:43,931 - INFO - Parsed 762 nodes.
2025-06-06 15:41:43,947 - INFO - Parsed 1622 edges.
2025-06-06 15:41:44,311 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:44,311 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:44,316 - DEBUG - Initial node features tensor shape: torch.Size([762, 19])
2025-06-06 15:41:44,317 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:44,317 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 19])
2025-06-06 15:41:44,318 - DEBUG - Edge index tensor shape: torch.Size([2, 1622])
2025-06-06 15:41:44,318 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:44,326 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:44,327 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:44,328 - DEBUG - Shape of encoded categorical edge features: torch.Size([1622, 2])
2025-06-06 15:41:44,330 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:44,330 - DEBUG - Shape of scaled numerical edge features: torch.Size([1622, 20])
2025-06-06 15:41:44,330 - DEBUG - Final edge attributes tensor shape: torch.Size([1622, 22])
2025-06-06 15:41:44,330 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:44,330 - INFO - Performing online update...
2025-06-06 15:41:44,330 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:44,331 - DEBUG - Updated RunningStats: new_mean=[-4.50712014e-10 -7.96950941e-10 -1.15209070e-08 -1.55953574e-09
  9.89745024e-11  2.19805874e-09 -1.33940983e-09 -2.13345038e-09
  2.54996808e-10  2.91149995e-09  7.13853599e-09  9.01767688e-10
 -6.37835682e-10  3.15927986e-09 -3.26856421e-09 -1.72543831e-09
 -4.74622260e-09 -8.03480509e-10  4.07170106e-09], new_M2=[5419.99981988 5419.99981735 5419.99995493 5420.00003984 5419.99999176
 5419.99991769 5420.00000593 5419.99991097 5420.00010504 5420.00004847
 5419.99993312 5420.00005238 5420.00006866 5420.00000594 5419.99998051
 5420.00006119 5420.00000718 5420.00001965 5419.99990646], new_n=5420
2025-06-06 15:41:44,331 - DEBUG - Updated RunningStats: new_mean=[ 1.39657080e+00  4.85813053e+00  2.56185743e-10 -9.53292640e-12
  3.05764607e-10 -1.15786188e-11  9.85028371e-10  7.12250721e-10
  9.64413158e-11  1.49230642e-09 -6.77925009e-10 -4.80195428e-10
 -1.38696601e-10 -1.92995312e-09 -1.21290643e-09  1.90417069e-10
  1.90417069e-10  1.90417069e-10  1.90417069e-10  1.90417069e-10
  1.90417069e-10 -2.52254325e-10], new_M2=[ 2833.95243363 38176.66288717 10848.00002715 10848.00003931
 10848.00020678 10847.9999101  10848.00000481 10848.00005205
 10848.00000611 10847.99994935 10848.00013388 10848.00003342
 10847.99998788 10848.00006184 10848.00000802 10848.00000811
 10848.00000811 10848.00000811 10848.00000811 10848.00000811
 10848.00000811 10847.99982808], new_n=10848
2025-06-06 15:41:44,331 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         1.         0.99999999
 1.         0.99999999 1.00000001 1.         0.99999999 1.
 1.00000001 1.         1.         1.00000001 1.         1.
 0.99999999]
2025-06-06 15:41:44,331 - DEBUG - Calculated standard deviation: [0.51111831 1.87596246 1.         1.         1.00000001 1.
 1.         1.         1.         1.         1.00000001 1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:41:44,332 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:44,332 - DEBUG - Online update step: 1/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 2/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 3/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 4/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 5/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 6/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 7/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 8/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 9/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 10/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 11/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 12/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 13/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 14/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 15/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 16/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 17/50
2025-06-06 15:41:44,332 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,332 - DEBUG - Online update step: 18/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 19/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 20/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 21/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 22/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 23/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 24/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 25/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 26/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 27/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 28/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 29/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 30/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 31/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 32/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 33/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 34/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 35/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 36/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 37/50
2025-06-06 15:41:44,333 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,333 - DEBUG - Online update step: 38/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 39/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 40/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 41/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 42/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 43/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 44/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 45/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 46/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 47/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 48/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 49/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - DEBUG - Online update step: 50/50
2025-06-06 15:41:44,334 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,334 - WARNING - No successful steps during online update.
2025-06-06 15:41:44,335 - DEBUG - Current node mean: [-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], current edge mean: [ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:41:44,335 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0638
2025-06-06 15:41:44,335 - DEBUG - Updated reference mean: node=[-4.7558562e-08  4.7558562e-08  1.2515411e-08 -1.3766952e-08
 -2.5030822e-09  1.5018493e-08  2.5030822e-08 -2.0024657e-08
 -5.0061644e-09  1.0638099e-08 -1.7521575e-08  1.6270034e-08
  3.9110661e-09 -2.8159675e-08  1.0012329e-08  4.3803938e-09
 -3.1288527e-09  1.1263870e-08 -5.0061644e-09], edge=[ 1.4192355e+00  4.9778051e+00  5.8796196e-10  7.3495249e-10
  2.9398100e-09  2.9398098e-10 -4.7036957e-09  3.5277719e-09
  0.0000000e+00  0.0000000e+00  2.5870326e-08  3.5277719e-09
  2.3518478e-09 -1.5287011e-08  9.4073913e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.1759239e-09]
2025-06-06 15:41:44,335 - DEBUG - Updated reference std: node=[1.0006567 1.0006567 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568
 1.0006568 1.0006568 1.0006568 1.0006568 1.0006568], edge=[0.5059302 1.7836741 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084 1.0003084
 1.0003084]
2025-06-06 15:41:44,336 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:44,336 - INFO - Running anomaly detection...
2025-06-06 15:41:44,336 - INFO - Starting anomaly detection.
2025-06-06 15:41:44,382 - DEBUG - Node reconstruction errors: [34.28384  34.291107 34.310154 33.237408 38.161163 43.22956  33.627026
 38.092876 38.049908 38.17044  33.249172 33.23588  38.164196 38.162453
 43.00722  38.097218 38.08507  33.24708  38.906452 35.361446 34.111538
 37.873928 32.18296  40.78397  33.026222 37.185974 40.801685 36.988636
 36.98362  36.15457  32.216755 36.199432 36.997337 38.16171  36.992077
 36.958843 37.31084  36.98754  36.992847 49.063343 33.08697  41.5631
 36.99961  32.128162 32.135246 39.207634 32.13326  32.089108 37.97858
 32.12517  39.908905 38.89226  31.622177 31.143305 31.38226  32.34234
 37.132957 31.62182  35.71731  35.71569  38.09189  41.6156   35.77724
 35.691418 31.641659 41.65918  38.902637 38.909355 31.565157 35.73084
 31.946608 39.1275   35.658405 32.063457 35.69229  35.68316  13.681894
 36.519043 31.635473 48.084904 31.58756  31.320871 31.67689  31.597528
 31.533136 31.648727 31.617315 38.679134 32.179672 36.250362 31.462463
 31.182964 31.184618 37.519276 31.149443 31.178467 30.95673  31.011574
 30.986923 31.150658 38.35476  31.01139  31.221788 31.693445 38.396984
 30.975168 41.689423 13.17272  31.138376 13.78195  44.730095 13.749881
 40.924904 13.78195  13.749881 31.182524 31.21984  31.407934 31.167297
 31.060951 32.058136 31.634502 37.95327  31.043795 31.179213 38.089104
 31.137123 31.405138 31.188984 31.16481  30.976343 31.765541 31.415443
 31.15396  31.214909 38.383747 31.900812 31.41942  31.220383 30.99476
 31.214098 31.213543 31.196903 35.457592 44.36046  31.240768 31.475195
 41.159508 37.428005 36.937084 35.02251  36.723785 38.564335 44.35682
 42.24881  51.385902 32.578587 43.303097 38.268856 38.988293 34.28946
 35.344604 30.519718 40.109188 29.912428 41.87613  31.158499 34.858997
 30.850878 30.164528 35.435814 37.521023 40.686398 29.236109 37.30514
 31.669569 40.692745 30.668232 39.04859  35.640644 39.842274 40.045982
 30.121136 36.904697 40.7459   36.918255 31.15334  30.020348 34.591785
 34.85435  48.248135 44.108932 34.55905  41.441093 29.280945 15.993324
 37.652863 40.795544 37.50716  35.07478  39.55821  29.236116 43.61686
 40.861412 37.61687  36.053272 41.478394 31.142292 30.678968 46.246788
 40.68636  41.20845  37.0502   64.91255  30.277306 38.549297 35.12952
 34.84382  42.11851  42.594757 37.505104 30.974018 30.519852 36.343494
 35.0677   29.37925  33.617867 41.421844 42.64497  42.704136 35.41717
 37.204338 34.775772 42.733063 36.844078 34.671642 50.723236 31.442713
 34.49822  34.169662 30.509306 42.66727  38.389656 36.65311  30.97964
 40.0384   37.156036 30.888226 32.46496  37.067978 36.39103  41.222115
 34.430477 29.809702 40.036064 31.568995 30.15889  38.273476 30.770662
 38.677452 34.33334  41.27954  40.921085 37.136665 29.53142  33.892437
 31.603441 31.62821  37.53796  40.937935 29.735285 29.359825 30.363724
 39.217323 45.941563 43.92382  41.342552 35.233265 40.833527 29.883484
 31.967566 38.39972  38.295654 31.201166 30.539371 29.280935 41.934093
 35.16325  30.003868 29.335144 31.550735 30.44428  51.079178 36.3919
 38.803093 30.272253 36.441864 30.281944 76.86651  29.974516 37.13219
 41.169506 49.30232  30.06667  34.710217 33.110706 43.685017 42.828724
 31.491577 45.09642  37.534836 40.26945  41.438957 40.278675 40.990326
 37.53604  36.922897 29.232943 29.280931 29.438595 29.242798 34.83831
 30.305597 42.398952 29.216806 36.05297  36.6066   34.033688 30.293428
 29.280949 43.60947  39.89866  41.305347 40.31259  43.145245 41.454227
 42.613827 30.02041  29.940609 39.224308 41.353394 34.77871  30.853521
 46.493366 44.858692 63.463013 34.249317 29.513119 29.71547  34.691277
 29.184566 42.649822 33.192856 30.238699 34.826435 41.17812  44.789337
 34.15375  33.234318 33.82424  34.742443 37.160835 42.75824  41.194702
 36.88876  36.06101  32.374664 30.211573 29.28094  41.67627  31.580805
 29.227812 41.72851  31.222492 29.38447  34.119244 41.940742 44.181755
 29.199713 29.359398 36.324142 36.615868 29.739286 36.302322 30.663317
 39.58682  35.552864 39.91867  31.152523 33.967903 30.07695  34.601574
 36.9888   41.1223   35.88053  29.280945 35.269207 37.338802 37.398205
 41.944374 35.754456 39.747753 39.249977 35.312153 36.02173  36.182446
 30.305378 39.967022 29.368189 38.52852  38.357574 36.304604 42.97533
 35.378796 31.166594 34.755707 41.15981  29.461487 34.73106  36.746925
 31.570984 34.59147  43.530235 43.653053 43.882336 31.626532 42.710423
 29.66986  35.51466  38.384995 30.88944  29.734625 42.208565 38.27048
 31.380962 42.85993  37.21272  39.770515 40.15776  38.124012 42.11793
 35.10153  31.582483 48.79368  34.170986 30.46428  43.739826 36.98811
 35.938362 42.83442  39.01134  35.425766 35.654007 34.43424  40.492268
 38.963493 39.48274  30.289625 46.425903 42.90901  35.661816 40.94863
 34.993015 29.915518 42.39924  37.422043 42.398212 44.054623 37.169346
 29.69366  34.424168 31.245329 37.152004 37.59374  42.6267   38.395817
 30.146156 34.731506 37.823627 36.26476  33.192432 32.13034  31.35976
 35.337128 31.772608 34.857704 44.23359  49.704945 34.668427 34.991547
 31.650211 50.046474 44.111095 30.105324 34.77548  30.268192 34.89593
 35.862823 36.91289  30.303646 30.040161 34.63527  43.083866 34.273926
 34.750923 30.65824  37.08779  36.978653 40.50846  42.512623 37.491096
 41.313854 43.140804 37.531483 37.10443  36.93892  37.347523 38.92856
 41.317352 38.832714 35.238247 39.739006 61.868595 31.470497 30.238022
 37.058064 39.89303  40.742607 35.645325 32.730183 37.13177  34.578583
 30.399715 38.34563  40.546497 37.52724  37.308147 31.13472  35.551723
 37.12607  37.41799  30.67189  31.063557 45.806053 38.448334 30.6761
 31.179457 30.495285 37.12585  30.111902 39.26163  37.124763 29.236109
 30.31527  37.11374  37.374866 36.250362 38.68659  41.624603 31.254793
 40.91268  30.520231 41.200077 37.362545 34.621517 37.63059  37.142548
 40.535122 31.064106 34.70878  30.215326 44.180706 39.61345  29.33976
 38.794525 34.905453 36.76357  36.752735 35.384228 38.793262 35.45762
 31.33714  31.436304 30.387339 34.29664  41.418465 37.783028 30.43034
 30.334234 36.995754 30.21612  38.37981  36.410614 37.36624  38.457542
 30.70542  36.06218  36.60405  30.905241 34.74549  40.973644 37.34019
 38.29626  32.892426 30.375212 30.968872 45.32736  37.509228 37.068893
 42.67028  30.279978 37.500256 38.052704 40.48705  43.762863 38.117477
 36.392033 31.880873 30.422438 30.262394 33.205254 43.533237 32.79231
 40.813103 31.441153 38.436142 34.750042 43.60201  40.26202  41.178333
 35.89566  34.410126 41.56988  41.481377 43.305065 35.640583 31.43018
 30.680655 43.533054 38.33629  43.057835 35.16374  30.56934  37.844368
 34.523216 30.270357 38.722702 44.712543 43.73614  37.931698 44.374958
 40.14102  38.97506  34.352455 50.54954  43.914692 30.453629 38.389362
 32.207546 43.65607  37.201244 43.285717 38.417274 30.973122 35.943157
 40.482643 31.175306 36.062515 30.677322 35.895035 34.854782 34.727367
 40.91145  34.708958 38.20755  38.352264 37.40505  38.532345 35.16262
 38.05702  51.860264 38.993816 30.896896 40.049538 37.276215 35.643864
 43.7103   43.776695 32.297813 38.06501  37.504368 36.13833  43.546642
 31.000465 36.379612 30.705225 43.709915 33.233036 41.022697 34.492542
 35.60451  36.529587 33.54462  35.60403  31.182022 31.310781 31.719444
 30.988619 40.68259  35.858402 36.385925 43.729347 41.469093 43.71781
 33.61785  36.39159  35.8566   36.134155 36.001186 36.38526  31.296326
 31.152655 29.847435 36.057564 34.13787  35.59174  36.265057 40.90184
 36.213486 44.242928 36.21633  41.284027 36.981987 36.99049  41.3017
 40.92201  34.97206  36.94739  36.597496 37.177555 31.1193   37.15423
 36.08194  44.03834  38.29076  38.817497 44.17047  49.39675  31.318659
 32.25685  35.579884 31.055683 35.613873 39.433235 41.60733  38.34698
 31.842688 50.169804 30.95715  39.209618 30.668026 31.575487]
2025-06-06 15:41:44,382 - DEBUG - Edge reconstruction errors: [0.19999999 0.7999996  0.7750411  ... 0.19999999 0.7999183  0.19999999]
2025-06-06 15:41:44,387 - ERROR - An error occurred while processing file nw_graph_encoded_1749044948.dot: name 'datetime' is not defined
2025-06-06 15:41:44,388 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:44,388 - INFO - 
--- Processing file: nw_graph_encoded_1749045008.dot ---
2025-06-06 15:41:44,388 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot
2025-06-06 15:41:44,388 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749045008.dot file.
2025-06-06 15:41:44,398 - INFO - Parsed 780 nodes.
2025-06-06 15:41:44,413 - INFO - Parsed 1667 edges.
2025-06-06 15:41:44,810 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:44,810 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:44,814 - DEBUG - Initial node features tensor shape: torch.Size([780, 19])
2025-06-06 15:41:44,816 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:44,816 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 19])
2025-06-06 15:41:44,817 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-06 15:41:44,817 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:44,825 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:44,826 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:44,827 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 2])
2025-06-06 15:41:44,828 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:44,829 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 20])
2025-06-06 15:41:44,829 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 22])
2025-06-06 15:41:44,829 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:44,829 - INFO - Performing online update...
2025-06-06 15:41:44,829 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:44,829 - DEBUG - Updated RunningStats: new_mean=[-1.02130035e-09 -6.93985531e-11 -8.20164719e-09 -6.29093378e-10
  1.82659395e-10 -4.12065175e-09 -4.00212406e-09 -1.17887412e-09
 -5.12527843e-10  2.49594450e-09  8.73760831e-09  2.83602745e-10
  1.17046218e-09  2.14835088e-09 -1.75178772e-09 -1.95299846e-09
 -4.36542436e-09 -9.06687590e-10  3.19173259e-09], new_M2=[6199.99978391 6199.99978139 6199.99995258 6200.00005164 6200.00003381
 6199.99991164 6199.99997705 6199.99996688 6200.00008378 6200.00005098
 6199.99991042 6200.00004119 6200.0000156  6200.00000542 6199.99996481
 6200.0000462  6199.99999877 6200.00001854 6199.99992194], new_n=6200
2025-06-06 15:41:44,830 - DEBUG - Updated RunningStats: new_mean=[ 1.39968038e+00  4.87359169e+00  2.57812497e-11 -6.27685788e-11
  1.51574795e-10 -1.85026759e-10  9.78552638e-10  9.21460934e-10
 -5.76888383e-10  1.54297509e-09 -5.72965238e-10  5.57329923e-10
 -1.70183573e-10 -3.65414812e-09 -1.12844260e-09  1.36356620e-10
  1.36356620e-10  1.36356620e-10  1.36356620e-10  1.36356620e-10
  1.36356620e-10 -2.61931858e-10], new_M2=[ 3260.79872153 43510.02205354 12515.00001775 12514.99996987
 12515.00010257 12514.99977281 12514.99999186 12515.00007412
 12515.00000571 12514.99993536 12515.00010696 12514.99996521
 12514.99998815 12515.00011562 12514.99999057 12514.99999272
 12514.99999272 12514.99999272 12514.99999272 12514.99999272
 12514.99999272 12514.99982984], new_n=12515
2025-06-06 15:41:44,830 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         1.         0.99999999
 1.         1.         1.00000001 1.         0.99999999 1.
 1.         1.         1.         1.         1.         1.
 0.99999999]
2025-06-06 15:41:44,830 - DEBUG - Calculated standard deviation: [0.5104422  1.86457229 1.         1.         1.         0.99999999
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         0.99999999]
2025-06-06 15:41:44,830 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:44,830 - DEBUG - Online update step: 1/50
2025-06-06 15:41:44,830 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,830 - DEBUG - Online update step: 2/50
2025-06-06 15:41:44,830 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,830 - DEBUG - Online update step: 3/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 4/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 5/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 6/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 7/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 8/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 9/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 10/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 11/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 12/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 13/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 14/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 15/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 16/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 17/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 18/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 19/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 20/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 21/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 22/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,831 - DEBUG - Online update step: 23/50
2025-06-06 15:41:44,831 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 24/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 25/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 26/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 27/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 28/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 29/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 30/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 31/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 32/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 33/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 34/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 35/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 36/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 37/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 38/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 39/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 40/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 41/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 42/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 43/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,832 - DEBUG - Online update step: 44/50
2025-06-06 15:41:44,832 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 45/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 46/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 47/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 48/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 49/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - DEBUG - Online update step: 50/50
2025-06-06 15:41:44,833 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:44,833 - WARNING - No successful steps during online update.
2025-06-06 15:41:44,833 - DEBUG - Current node mean: [-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], current edge mean: [ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:41:44,833 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0540
2025-06-06 15:41:44,834 - DEBUG - Updated reference mean: node=[-9.7812753e-09  9.7812753e-09 -5.5019673e-09  2.4453188e-09
  1.2226594e-09 -2.2007869e-08 -2.4453188e-08  1.7728562e-08
 -2.4453188e-09 -4.8906377e-09  1.5894573e-08 -1.1003935e-08
  2.9343825e-08  8.5586160e-09  1.9562551e-08  1.7117232e-08
  0.0000000e+00 -2.4453188e-09  3.0566486e-08], edge=[ 1.4199160e+00  4.9742050e+00 -1.1441803e-09 -1.1441803e-09
 -1.1441803e-09 -4.0046313e-09  5.7209015e-09  5.7209015e-09
 -4.5767212e-09  3.4325411e-09 -6.8650823e-09  6.8650823e-09
  2.2883606e-09 -2.0595246e-08 -4.5767212e-09 -1.7162706e-09
 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09 -1.7162706e-09
 -1.7162706e-09  3.4325411e-09]
2025-06-06 15:41:44,834 - DEBUG - Updated reference std: node=[1.0006416 1.0006416 1.0006416 1.0006417 1.0006417 1.0006416 1.0006416
 1.0006417 1.0006416 1.0006417 1.0006416 1.0006416 1.0006416 1.0006416
 1.0006416 1.0006416 1.0006416 1.0006416 1.0006417], edge=[0.505705 1.785948 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003   1.0003
 1.0003   1.0003   1.0003   1.0003   1.0003   1.0003  ]
2025-06-06 15:41:44,834 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:44,834 - INFO - Running anomaly detection...
2025-06-06 15:41:44,834 - INFO - Starting anomaly detection.
2025-06-06 15:41:44,847 - DEBUG - Node reconstruction errors: [43.788555 34.22501  43.80328  33.87887  34.21872  34.221706 34.234272
 33.30082  38.74005  43.477833 33.64453  38.384502 38.37744  39.054146
 33.317097 33.312103 38.485245 46.61975  47.660553 46.59322  38.378365
 33.254017 38.82898  35.49583  33.692486 38.483635 32.32022  40.65524
 33.099667 40.68865  40.674953 37.381756 37.378616 36.43548  32.38322
 36.48022  37.395718 38.717926 37.39275  37.38405  37.696205 37.38545
 37.388645 49.64041  33.113647 41.455    37.39999  32.296284 32.30282
 39.46502  32.304947 32.26604  38.30487  32.29356  40.333176 39.159256
 31.840097 31.360071 31.621313 32.723675 37.093063 31.836943 36.059788
 36.05832  38.38463  42.07849  36.105618 36.03372  31.857052 41.70415
 39.17602  39.17888  31.77502  36.0777   32.10147  39.348442 35.9957
 32.04245  36.040188 36.022587 13.777332 37.961716 31.83644  48.579628
 31.8035   31.558496 31.89386  31.814844 31.767935 31.866776 31.832802
 33.89456  38.991947 32.30945  36.724743 31.689768 31.444853 31.446142
 37.876842 31.41202  31.440462 31.238201 31.292902 31.268269 31.409918
 38.68316  31.258657 31.484228 31.891611 40.61973  31.256779 42.2742
 13.368738 31.398157 13.932641 45.101723 13.903489 41.411873 13.932641
 13.903489 31.443102 31.482296 31.654892 31.429533 31.336205 32.2007
 31.851196 38.872284 31.16051  31.439941 46.679066 31.39653  31.617577
 31.45112  31.426712 31.257572 31.888727 31.642216 31.414598 31.477169
 38.705006 33.889435 31.93951  31.639236 31.482733 33.899746 31.234564
 31.474796 31.475723 31.458284 35.81509  44.796936 31.489017 31.703646
 41.742573 33.718227 37.632313 37.187164 36.006237 37.052017 38.76168
 44.793125 42.627205 52.38552  32.6981   43.841488 38.54132  41.57008
 34.88411  35.84254  43.815372 30.791265 40.398853 30.137121 42.115303
 32.138332 35.418648 31.109886 34.459923 30.533716 36.886456 37.6704
 41.120716 29.66625  37.61021  31.888826 41.30702  30.962711 39.37142
 35.769066 39.902386 40.09945  30.457487 37.23941  41.245052 37.357464
 31.414448 30.364933 34.906406 35.414463 48.83076  44.606834 34.785286
 41.81728  29.699171 14.995662 37.843452 41.90106  37.81719  35.599422
 40.30579  29.66626  44.449978 41.2811   37.810036 36.50879  42.074123
 31.364422 30.959656 46.71568  41.12058  41.540688 37.408558 65.77145
 30.631508 38.824608 35.64779  35.272083 42.364937 43.179504 37.861683
 31.255924 30.818945 36.76877  35.58963  29.788918 34.236256 41.84942
 43.22317  43.083347 35.825676 37.5638   37.521618 43.296814 37.24126
 34.883488 51.237576 31.687069 35.09113  34.544754 30.839134 43.244293
 39.56963  37.110554 31.195467 40.284996 37.38445  31.137873 32.586964
 37.300137 36.665833 41.56077  35.024185 30.143705 40.207314 38.055794
 31.795391 30.52786  39.201305 30.935795 38.90765  34.930824 41.714916
 41.334084 37.365345 29.929325 36.7932   31.820013 31.863724 37.7411
 41.440273 30.029287 29.762207 30.607336 39.534454 47.05079  44.693344
 41.73336  35.67275  41.14857  30.203444 32.132698 38.72486  38.460197
 31.463999 30.835331 29.699167 42.14886  35.705868 30.29339  29.749588
 31.78618  30.750555 52.223705 36.79807  38.98146  30.60817  36.907677
 30.636648 78.52714  30.361181 40.710316 41.466724 49.797302 30.338158
 35.12117  33.47219  43.930588 43.322933 31.698868 45.52497  37.735443
 40.76352  41.99619  40.77292  41.487083 37.731068 37.269714 29.647377
 29.620985 29.859465 29.657785 35.26634  30.626379 42.986225 29.629957
 36.51045  36.870537 34.47688  30.628447 29.69918  44.17195  40.054516
 41.71197  40.61288  43.641148 41.77229  43.190723 30.370384 30.32959
 39.241936 41.632195 35.352158 31.12646  46.87082  45.360657 64.74846
 34.7366   29.909752 30.11885  34.991646 29.612122 43.22701  33.6752
 30.548176 35.393803 41.013706 45.95521  34.646523 33.310036 34.243233
 35.320213 37.39155  43.322258 41.60813  37.23492  36.51691  32.498447
 30.525696 29.699177 42.293953 31.604385 29.65825  42.11515  31.485004
 29.787964 36.386547 42.14206  44.644855 29.628202 29.719347 36.770897
 37.00572  30.137503 36.71434  31.859755 39.580357 36.00387  40.212593
 31.41404  34.40243  30.407743 34.91649  37.385822 41.40246  36.18185
 29.699173 35.786945 37.784435 38.070995 42.39799  36.210903 40.037643
 39.48989  35.814686 36.47937  36.59122  30.660696 42.177273 29.79241
 38.791794 38.57616  36.71694  43.338966 35.58756  31.426983 35.45743
 41.64287  29.866333 35.132812 37.01624  31.776968 34.90957  44.03034
 43.707035 44.333458 31.837627 44.17033  29.944971 35.868538 38.70509
 31.171381 30.066936 42.449112 38.542713 31.597502 43.43271  37.569775
 40.030323 40.366978 38.834297 42.5402   35.335186 31.796503 49.37215
 34.79054  30.77272  44.212006 37.384674 36.419975 44.173496 39.329437
 35.83933  35.99763  35.027225 40.92948  39.58961  40.070057 30.625906
 47.205395 43.03952  35.87019  41.60019  35.43669  30.153551 42.98663
 37.62558  42.98534  45.26586  38.09946  29.95918  34.7659   31.508156
 37.382446 37.900593 43.204666 38.718773 30.491032 34.94872  38.006725
 36.676487 33.5544   32.26175  31.602186 35.734077 31.951962 35.071297
 34.1003   44.61743  52.20265  34.88028  35.19054  31.845304 50.59735
 44.621353 30.450796 35.3492   30.62207  35.323452 36.33088  37.16566
 30.637821 30.390211 35.21334  43.59563  34.54007  35.327778 30.892244
 37.431427 37.33123  40.640118 42.983658 37.693436 41.57666  43.63953
 37.73226  37.549282 37.522957 37.789093 39.09793  41.95946  39.009483
 35.530483 39.977573 63.0078   31.678778 30.546198 37.496094 33.768536
 40.142345 41.220814 36.12485  32.987377 37.572666 34.9086   30.735329
 38.47147  40.723785 37.727497 37.670364 32.330627 35.697758 37.568893
 37.82042  30.98175  31.305597 46.31853  38.506447 30.973951 31.441462
 30.74729  37.56667  30.459711 39.5694   37.56975  29.66625  30.635208
 37.556267 37.815613 36.724743 38.86075  42.098293 31.475666 41.53083
 30.82075  41.37144  37.806007 34.833527 38.024902 37.54268  40.845543
 31.309565 35.12756  30.56737  44.643826 39.615593 29.74576  39.031082
 34.3179   35.10493  37.179592 37.224915 35.54211  38.782597 35.916637
 31.545555 31.662725 30.725285 34.226757 42.01029  38.028095 30.765314
 30.662457 37.37943  30.555021 38.699432 36.685116 37.80792  38.57356
 31.015898 36.517834 36.87009  31.154991 35.051006 41.466415 37.785107
 38.612377 32.861073 30.711708 31.211157 45.711697 37.923412 37.402233
 43.579487 30.612728 37.914124 38.20679  41.004288 43.159164 38.32896
 36.795177 32.060295 30.75669  30.558931 33.560005 44.162285 33.200172
 40.91393  31.667658 39.013195 35.157627 43.752686 41.880543 41.695854
 36.363018 35.00459  42.145626 41.970814 43.842213 35.759727 31.641836
 30.963768 44.03105  38.463165 43.270294 35.70395  30.892511 38.081764
 34.98426  30.623625 38.81213  45.187794 44.239655 38.08328  44.763233
 40.592487 39.191948 34.79671  51.752834 44.36989  30.78573  38.716644
 32.321983 44.112183 37.540985 43.824135 38.631012 31.183767 36.308838
 40.971107 31.436264 36.519115 30.925425 36.25582  35.277107 35.122158
 33.90168  41.293404 35.11949  38.713127 38.47754  37.61119  38.640976
 35.701893 38.931965 34.58218  52.51834  39.210552 31.816952 40.578465
 37.499256 36.01576  44.86925  44.252323 32.413975 38.326977 37.85965
 37.85586  44.046883 31.262207 36.783043 30.969017 45.001072 33.306957
 41.48718  34.95373  36.100494 36.862125 33.994076 36.10031  31.438513
 31.57381  31.802382 31.252611 41.191715 36.328106 36.78914  44.232887
 41.723465 44.220936 34.49512  34.236256 36.794956 36.325836 36.57248
 36.457047 36.788807 31.558538 31.409103 30.211798 36.51303  34.387043
 36.088425 36.69105  41.329998 36.894825 44.8196   36.594845 41.553925
 37.338005 37.390675 41.514645 41.41228  35.430973 37.286423 37.010468
 38.904602 37.534676 31.274408 37.812492 37.71127  44.502224 38.600616
 38.8988   44.63342  50.02146  31.581995 33.206814 35.705307 31.336895
 35.74729  41.372055 41.865135 38.668076 31.966934 51.138    36.515636
 39.467445 32.05512  31.68526 ]
2025-06-06 15:41:44,848 - DEBUG - Edge reconstruction errors: [0.19999999 0.7999993  0.76323205 ... 0.19999999 0.79991174 0.19999999]
2025-06-06 15:41:44,850 - ERROR - An error occurred while processing file nw_graph_encoded_1749045008.dot: name 'datetime' is not defined
2025-06-06 15:41:44,851 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:44,851 - INFO - 
--- Processing file: nw_graph_encoded_1749046127.dot ---
2025-06-06 15:41:44,851 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot
2025-06-06 15:41:44,851 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749046127.dot file.
2025-06-06 15:41:44,861 - INFO - Parsed 799 nodes.
2025-06-06 15:41:44,877 - INFO - Parsed 1718 edges.
2025-06-06 15:41:45,265 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:45,265 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:45,269 - DEBUG - Initial node features tensor shape: torch.Size([799, 19])
2025-06-06 15:41:45,271 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:45,271 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 19])
2025-06-06 15:41:45,272 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-06 15:41:45,272 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:45,280 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:45,282 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-06 15:41:45,283 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 2])
2025-06-06 15:41:45,285 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:45,285 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 20])
2025-06-06 15:41:45,285 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 22])
2025-06-06 15:41:45,285 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:45,285 - INFO - Performing online update...
2025-06-06 15:41:45,286 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:45,286 - DEBUG - Updated RunningStats: new_mean=[-1.25493688e-09  2.88751248e-10 -1.05824006e-08 -2.90081899e-10
 -5.19486117e-10 -3.94937191e-10 -1.02871790e-09 -3.61937049e-10
 -2.45372029e-10  2.34301013e-09  1.12998876e-08  1.02832703e-09
  7.00454641e-10  2.21819507e-09 -1.74128979e-09 -1.43730258e-09
 -4.65268745e-09 -1.28480999e-09  1.38174791e-09], new_M2=[6998.99974153 6998.999739   6998.99997171 6999.00009841 6999.00006819
 6998.99990486 6999.00001919 6998.9999807  6999.00002551 6999.00001671
 6998.99993691 6999.00005148 6999.0000173  6998.99999913 6998.99998425
 6999.00004669 6998.99998924 6998.99999259 6998.99995582], new_n=6999
2025-06-06 15:41:45,287 - DEBUG - Updated RunningStats: new_mean=[ 1.40216399e+00  4.88561793e+00 -1.77630392e-10 -7.18215180e-11
  5.44564506e-11  5.23983458e-13  9.75976189e-10  2.65448230e-10
 -2.12957293e-10  9.14301547e-10 -5.05768259e-10  1.00667523e-09
 -2.84672800e-10 -4.63587028e-09 -9.38839309e-10 -2.21432853e-11
 -2.21432853e-11 -2.21432853e-11 -2.21432853e-11 -2.21432853e-11
 -2.21432853e-11 -1.49070738e-10], new_M2=[ 3704.01334926 48985.7859903  14232.9999427  14232.99995791
 14233.00006248 14232.99992489 14232.9999634  14233.00003099
 14233.0000093  14232.99995318 14233.00021855 14232.99991965
 14232.9999979  14233.00016015 14232.99994069 14232.99989236
 14232.99989236 14232.99989236 14232.99989236 14232.99989236
 14232.99989236 14232.99987283], new_n=14233
2025-06-06 15:41:45,287 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.00000001 1.         0.99999999
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.
 1.        ]
2025-06-06 15:41:45,287 - DEBUG - Calculated standard deviation: [0.51013844 1.85518326 1.         1.         1.         1.
 1.         1.         1.         1.         1.00000001 1.
 1.         1.00000001 1.         1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:45,287 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:45,287 - DEBUG - Online update step: 1/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 2/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 3/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 4/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 5/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 6/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 7/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 8/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 9/50
2025-06-06 15:41:45,287 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,287 - DEBUG - Online update step: 10/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 11/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 12/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 13/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 14/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 15/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 16/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 17/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 18/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 19/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 20/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 21/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 22/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 23/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 24/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 25/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 26/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 27/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 28/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 29/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 30/50
2025-06-06 15:41:45,288 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,288 - DEBUG - Online update step: 31/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 32/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 33/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 34/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 35/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 36/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 37/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 38/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 39/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 40/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 41/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 42/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 43/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 44/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 45/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 46/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 47/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 48/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 49/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - DEBUG - Online update step: 50/50
2025-06-06 15:41:45,289 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-06 15:41:45,289 - WARNING - No successful steps during online update.
2025-06-06 15:41:45,290 - DEBUG - Current node mean: [ 1.31294335e-08 -1.31294335e-08 -1.67101888e-08 -6.56471677e-09
  1.13390559e-08  3.16299982e-08  7.75830156e-09  6.56471677e-09
  1.43230183e-08 -2.14845279e-08  1.79037727e-08 -3.58075458e-09
  5.37113198e-09  1.25326416e-08  1.13390559e-08 -1.19358490e-09
  0.00000000e+00 -2.32749056e-08 -3.81947167e-08], current edge mean: [ 1.4202561e+00  4.9732246e+00 -4.4408583e-09  0.0000000e+00
  1.1102146e-09  1.1102146e-09  3.3306438e-09 -6.6612875e-09
  4.4408583e-09 -5.5510729e-09  1.1102146e-09  7.7715017e-09
 -2.2204292e-09 -1.9983862e-08  1.9983862e-08 -2.2204292e-09
 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09
 -2.2204292e-09  2.2204292e-09]
2025-06-06 15:41:45,290 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0472
2025-06-06 15:41:45,290 - DEBUG - Updated reference mean: node=[ 1.31294335e-08 -1.31294335e-08 -1.67101888e-08 -6.56471677e-09
  1.13390559e-08  3.16299982e-08  7.75830156e-09  6.56471677e-09
  1.43230183e-08 -2.14845279e-08  1.79037727e-08 -3.58075458e-09
  5.37113198e-09  1.25326416e-08  1.13390559e-08 -1.19358490e-09
  0.00000000e+00 -2.32749056e-08 -3.81947167e-08], edge=[ 1.4202561e+00  4.9732246e+00 -4.4408583e-09  0.0000000e+00
  1.1102146e-09  1.1102146e-09  3.3306438e-09 -6.6612875e-09
  4.4408583e-09 -5.5510729e-09  1.1102146e-09  7.7715017e-09
 -2.2204292e-09 -1.9983862e-08  1.9983862e-08 -2.2204292e-09
 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09 -2.2204292e-09
 -2.2204292e-09  2.2204292e-09]
2025-06-06 15:41:45,291 - DEBUG - Updated reference std: node=[1.0006263 1.0006263 1.0006263 1.0006264 1.0006264 1.0006263 1.0006264
 1.0006263 1.0006263 1.0006263 1.0006264 1.0006263 1.0006263 1.0006263
 1.0006263 1.0006263 1.0006263 1.0006263 1.0006264], edge=[0.5077014 1.7833711 1.0002911 1.0002911 1.0002911 1.0002912 1.0002911
 1.0002911 1.0002911 1.0002911 1.0002912 1.0002911 1.0002911 1.0002912
 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911 1.0002911
 1.0002912]
2025-06-06 15:41:45,291 - INFO - Online update complete. Loss: 0.0000
2025-06-06 15:41:45,291 - INFO - Running anomaly detection...
2025-06-06 15:41:45,291 - INFO - Starting anomaly detection.
2025-06-06 15:41:45,420 - DEBUG - Node reconstruction errors: [40.23943  38.97747  51.526764 35.724594 42.494804 36.343338 42.47273
 36.415466 40.890385 47.13694  26.771835 46.79511  35.925793 26.731611
 26.770605 26.83626  35.520702 39.899914 46.50009  26.495983 39.808617
 39.55119  39.978275 35.552017 35.547474 39.784817 50.061756 51.360626
 50.012604 39.809814 42.326862 35.410408 29.372065 34.86063  26.811699
 39.65531  34.28811  35.836414 26.202515 35.91455  36.331917 41.03228
 39.120953 39.10574  40.683487 35.020683 40.71358  39.10329  39.763577
 39.081192 38.880608 39.25658  39.095234 39.112484 52.900375 26.200602
 37.31895  39.070053 34.86448  34.874718 44.437565 34.847256 34.777157
 39.44626  34.86114  35.561756 44.42957  34.51306  33.532703 34.044304
 34.81053  31.641678 34.50441  40.371235 40.338108 39.791363 42.91072
 40.418728 40.312725 43.327366 41.948402 44.07901  44.09561  34.42091
 40.40071  25.65835  44.385128 40.327244 25.036116 40.279587 40.347473
 15.918817 39.234737 34.509106 52.282146 34.45444  33.93971  34.58453
 34.473324 34.357224 34.542698 34.496346 35.954235 44.033276 51.28169
 34.734955 38.859447 34.41309  34.231186 34.220844 39.786022 34.12691
 34.224155 33.77539  33.881454 33.82882  34.18539  43.599796 33.545197
 34.293438 34.341057 45.152905 33.807526 45.263996 15.376381 34.16589
 15.903457 48.690155 15.898393 44.84978  15.903457 15.898393 34.219086
 34.271957 34.344532 34.19613  33.95918  34.53258  34.52902  42.58125
 33.1831   34.228207 50.171463 34.162197 34.308506 34.24181  34.20277
 33.816296 33.870514 34.357212 34.187927 34.26753  43.67756  35.944885
 34.39925  34.359684 34.27491  35.955143 33.499302 34.264942 34.2819
 34.252846 39.973404 48.671207 34.02975  34.42574  46.991344 35.585613
 34.527077 34.092125 30.446463 38.00503  36.091923 48.668495 40.23925
 47.396225 35.013824 47.91367  40.298378 42.112473 36.860287 37.739857
 46.81884  33.765736 40.567657 24.424759 43.78367  25.327156 37.440197
 25.165586 36.28832  25.167742 38.039726 34.345898 44.134052 32.721188
 35.84961  34.58661  43.99129  33.85942  39.608738 30.381746 36.062653
 36.502254 33.459743 35.62678  44.705433 42.33068  34.17277  33.245117
 34.131546 37.43111  50.198578 48.612137 30.32551  44.886665 32.781868
 16.889095 34.42427  47.025093 38.379814 37.54321  36.639797 32.75699
 47.869965 41.662464 34.346764 38.39859  47.217907 34.12906  25.192001
 49.601837 44.12054  44.00887  38.856857 72.925476 25.180704 43.61187
 37.433655 39.562687 43.652252 47.337414 39.434505 33.802967 25.13134
 38.50113  37.5264   32.949604 36.410236 47.46735  47.301537 42.8744
 27.716112 38.89831  45.061695 47.327576 34.57691  30.521343 55.172344
 34.393955 37.242294 34.162174 33.837955 47.364563 43.993206 42.05725
 33.922436 41.49363  34.26224  25.196526 26.308743 34.111183 34.781338
 44.204266 37.11637  32.797928 40.60701  38.52281  34.55039  25.146593
 43.235775 32.950428 37.571365 37.030357 45.02655  41.613514 37.661846
 33.144733 37.147877 34.48305  34.511444 34.135372 46.996925 32.581104
 32.84325  33.840744 40.302338 42.999645 50.316265 45.356335 36.963196
 42.25663  33.264133 25.723427 43.703846 34.535057 34.245235 25.143673
 32.840748 42.682228 37.692245 32.73901  32.907623 34.415894 33.619064
 47.027454 38.40674  35.83428  33.621082 41.98958  25.179064 81.530334
 25.09764  35.96227  42.406876 53.235764 33.27687  39.185307 35.886417
 48.845562 46.977123 25.506927 45.735683 34.488926 43.95745  47.37627
 44.01948  44.99656  34.200443 38.587826 32.755478 32.679413 24.986853
 32.75159  39.588768 24.965614 47.05261  32.708332 38.243423 34.049206
 27.176626 33.6461   32.871887 48.378952 42.784374 43.94324  41.060364
 47.377987 43.591743 47.28232  33.465847 25.042305 34.64002  42.46891
 37.422924 25.191576 49.296658 50.176205 71.482056 39.104454 33.03038
 24.98242  42.332047 32.658012 47.326244 37.784657 24.876705 37.312508
 36.18136  49.673805 36.236134 35.543514 38.069336 37.360325 34.281803
 47.357475 44.682728 38.54054  38.354893 25.76344  24.855186 32.81204
 47.17185  34.26958  32.70851  42.632347 34.295986 25.019789 37.28
 42.494293 48.590824 32.67282  25.127893 40.602566 38.623554 24.977686
 35.63991  24.949274 35.2964   37.54843  42.08733  34.18665  36.70354
 33.430084 34.151382 39.100094 42.455605 40.373413 32.856083 37.66357
 42.90796  41.836113 48.18875  37.893585 39.53665  39.087326 37.689594
 38.197983 35.47616  25.236444 47.373062 24.840628 39.959747 35.615837
 35.714333 46.176037 34.2301   34.210747 38.81412  43.27075  32.929462
 39.205135 33.936195 34.415318 34.076694 47.94413  43.719078 48.079792
 34.513565 47.533756 24.465815 40.151623 43.671513 33.595993 33.16609
 43.53189  43.244328 34.300125 47.61638  43.3567   40.964874 39.59455
 43.142593 42.591133 38.722626 34.44293  52.52588  36.88798  25.137177
 48.020393 39.101883 38.183853 47.537983 38.06594  37.11287  40.161884
 37.123302 43.858692 40.70608  43.6119   33.64098  42.655468 43.766098
 34.392895 47.30345  27.536913 24.429197 47.04884  34.511257 47.05097
 41.414318 36.09504  32.297146 34.115063 34.29285  34.263447 36.8262
 47.28027  43.691483 33.31985  30.357967 34.24767  35.60983  36.190132
 34.642    34.294197 40.1333   25.434118 30.340384 35.938    48.10313
 55.769962 30.519178 30.370995 25.34785  54.46787  48.677074 33.49757
 37.41677  25.116968 39.629383 38.217392 34.04597  33.65665  33.425575
 37.280933 47.375065 27.19058  37.379025 33.690403 36.234936 36.29576
 41.401093 38.75978  44.496895 34.398083 42.196915 46.988678 34.479828
 42.587276 41.99453  42.92502  36.24279  47.072723 36.00818  43.122383
 40.6976   64.07557  25.459288 24.849602 42.50366  45.883224 33.735477
 44.511303 37.977722 27.9305   42.657013 34.181694 33.66582  34.818565
 43.18584  34.47191  42.42363  42.192444 25.45949  34.87019  42.628414
 42.787975 34.028725 25.2885   48.70006  41.59264  33.876377 34.226818
 33.652496 42.6443   33.50833  39.392464 42.639355 32.75015  33.652508
 42.607487 42.98921  38.859447 36.01289  47.80524  30.972101 44.44359
 25.134117 40.772903 42.962738 30.36199  39.558376 42.40171  41.911312
 25.261974 39.20527  25.083694 48.58721  35.372147 32.88477  38.016834
 35.361668 30.48107  38.52644  42.23589  30.852545 29.373926 39.54583
 25.372847 34.39275  33.606754 26.783432 44.971527 36.088634 33.73836
 33.607388 39.194183 33.2213   43.661713 34.789318 42.97127  34.597694
 33.956978 38.408043 34.05803  25.24555  34.194263 44.9734   42.9052
 43.504463 25.651217 33.66464  33.43464  49.519848 43.45347  38.64989
 48.57399  38.85978  33.341236 42.94909  34.5802   44.477543 47.747242
 38.121037 38.42581  34.64625  33.726856 33.451263 35.62279  47.520477
 32.87586  41.21898  34.397438 44.829216 39.269367 44.679142 43.540516
 47.747993 38.294945 37.07594  47.31425  47.635204 47.944355 30.954908
 34.333614 25.031199 47.910717 34.800423 45.975277 37.692036 33.896748
 36.636932 43.47885  25.186827 34.786304 49.289444 48.281708 34.38744
 36.357025 48.31886  44.92133  38.019848 38.85853  55.339027 48.120026
 33.7631   43.67582  34.70904  48.043415 38.86457  47.887794 35.812057
 24.922094 37.56268  41.93936  34.220722 38.336586 33.74056  27.852697
 39.572758 39.173084 35.96567  43.808884 39.18357  39.72205  34.830975
 34.481083 34.81682  37.73116  36.847645 36.487953 56.26832  41.11172
 24.77933  36.56452  36.37376  34.24807  37.09004  48.240475 48.11753
 25.606787 36.611828 39.099472 39.43458  38.965275 47.962696 25.286205
 38.39114  33.431652 48.456745 35.537594 44.797703 39.35008  38.025314
 38.093555 37.980988 38.04878  34.2255   34.417385 33.494373 25.284512
 44.695408 38.184406 38.411312 48.26842  42.36382  48.24928  35.32693
 36.4091   38.42601  38.178635 38.3725   38.247055 38.389317 34.404896
 34.165012 33.318066 38.3846   30.156382 38.067944 38.252567 42.938152
 41.43466  48.162746 37.770573 42.439743 38.675976 39.08291  47.736946
 44.825302 27.353098 38.423546 36.33896  38.60502  40.311817 42.8389
 33.97233  42.4993   38.792015 48.361496 43.486767 35.02438  48.585598
 54.150757 34.418526 26.053904 30.884165 33.97112  30.882118 45.237183
 42.722267 43.593685 34.037735 46.702065 40.06827  44.440826 34.394012
 40.14377 ]
2025-06-06 15:41:45,421 - DEBUG - Edge reconstruction errors: [0.19999939 0.19999999 0.7999988  ... 0.19999999 0.79990107 0.19999999]
2025-06-06 15:41:45,423 - ERROR - An error occurred while processing file nw_graph_encoded_1749046127.dot: name 'datetime' is not defined
2025-06-06 15:41:45,424 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow.py", line 429, in monitor_new_files
    save_anomalies_to_file(main_data, anomalies, processed_count, anomaly_log_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/utils.py", line 8, in save_anomalies_to_file
    timestamp = datetime.now().strftime("%Y%m%d_%H%M%S")
                ^^^^^^^^
NameError: name 'datetime' is not defined. Did you forget to import 'datetime'

2025-06-06 15:41:45,424 - INFO - 
--- Processing file: nw_graph_encoded_1749046187.dot ---
2025-06-06 15:41:45,424 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749046187.dot
2025-06-06 15:41:45,424 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749046187.dot file.
2025-06-06 15:41:45,435 - INFO - Parsed 974 nodes.
2025-06-06 15:41:45,453 - INFO - Parsed 2053 edges.
2025-06-06 15:41:46,042 - INFO - Starting NetworkX to PyG conversion.
2025-06-06 15:41:46,042 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-06 15:41:46,047 - DEBUG - Initial node features tensor shape: torch.Size([974, 19])
2025-06-06 15:41:46,048 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-06 15:41:46,049 - DEBUG - Node features tensor shape after scaling: torch.Size([974, 19])
2025-06-06 15:41:46,050 - DEBUG - Edge index tensor shape: torch.Size([2, 2053])
2025-06-06 15:41:46,050 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-06 15:41:46,059 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-06 15:41:46,061 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-06 15:41:46,063 - DEBUG - Shape of encoded categorical edge features: torch.Size([2053, 2])
2025-06-06 15:41:46,065 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-06 15:41:46,065 - DEBUG - Shape of scaled numerical edge features: torch.Size([2053, 20])
2025-06-06 15:41:46,065 - DEBUG - Final edge attributes tensor shape: torch.Size([2053, 22])
2025-06-06 15:41:46,065 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-06 15:41:46,065 - INFO - Performing online update...
2025-06-06 15:41:46,065 - INFO - Starting online update for 50 steps.
2025-06-06 15:41:46,066 - DEBUG - Updated RunningStats: new_mean=[-1.62774114e-09  8.09490210e-10 -1.00297356e-08 -1.58393755e-10
 -2.20536438e-09  6.17688922e-10 -3.07477059e-09 -8.24208214e-10
 -2.30348441e-10  1.54842745e-09  7.93744282e-09  1.89324925e-09
  1.68205758e-11  2.79571987e-09  1.74630283e-09  3.18638942e-09
 -6.95501606e-09 -2.15040549e-09  1.25780528e-09], new_M2=[7972.99970933 7972.99970546 7972.99995003 7973.00006089 7973.00006569
 7972.99997794 7973.00000388 7972.99995341 7973.00002587 7973.00005646
 7972.99995036 7973.00009491 7973.00004391 7972.99999442 7973.00001399
 7972.99997398 7972.99994341 7972.9999849  7972.99989181], new_n=7973
2025-06-06 15:41:46,066 - DEBUG - Updated RunningStats: new_mean=[ 1.39653690e+00  4.97193909e+00 -1.95093147e-10 -1.53717226e-11
 -1.70207192e-11  7.63055221e-11  1.25676598e-09  4.56678477e-10
 -3.80221001e-10  1.16060057e-09 -1.38013559e-10  1.18434438e-09
 -2.22469351e-11 -5.57398219e-09 -1.08239944e-09 -3.19166408e-12
 -3.19166408e-12 -3.19166408e-12 -3.19166408e-12 -3.19166408e-12
 -3.19166408e-12 -9.35373361e-11], new_M2=[ 4203.16468132 61124.17616358 16285.99991974 16285.99997937
 16285.99999536 16286.00001609 16285.99996152 16286.00007718
 16285.99997644 16285.99992406 16286.00027291 16285.99988572
 16285.99998236 16286.00016069 16285.99990056 16285.99991069
 16285.99991069 16285.99991069 16285.99991069 16285.99991069
 16285.99991069 16285.99990819], new_n=16286
2025-06-06 15:41:46,067 - DEBUG - Calculated standard deviation: [0.99999998 0.99999998 1.         1.         1.         1.
 1.         1.         1.         1.         1.         1.00000001
 1.         1.         1.         1.         1.         1.
 0.99999999]
2025-06-06 15:41:46,067 - DEBUG - Calculated standard deviation: [0.50802021 1.93731078 1.         1.         1.         1.
 1.         1.         1.         1.         1.00000001 1.
 1.         1.         1.         1.         1.         1.
 1.         1.         1.         1.        ]
2025-06-06 15:41:46,067 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-06 15:41:46,067 - DEBUG - Online update step: 1/50
2025-06-06 15:41:46,067 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-06 15:41:46,068 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-06 15:41:46,068 - DEBUG - Applied edge dropout: 36 edges dropped.
2025-06-06 15:41:46,068 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:41:46,069 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-06 15:41:46,069 - DEBUG - Applied edge dropout: 163 edges dropped.
2025-06-06 15:41:46,069 - DEBUG - Applied edge dropout: 154 edges dropped.
2025-06-06 15:41:46,070 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-06 15:41:46,070 - DEBUG - Applied edge dropout: 182 edges dropped.
2025-06-06 15:41:46,070 - DEBUG - Applied edge dropout: 152 edges dropped.
2025-06-06 15:41:46,070 - DEBUG - Applied edge dropout: 166 edges dropped.
2025-06-06 15:41:46,070 - DEBUG - Applied edge dropout: 83 edges dropped.
2025-06-06 15:41:46,071 - DEBUG - Applied edge dropout: 116 edges dropped.
2025-06-06 15:41:46,071 - DEBUG - Applied edge dropout: 173 edges dropped.
2025-06-06 15:41:46,071 - DEBUG - Applied edge dropout: 155 edges dropped.
2025-06-06 15:41:46,071 - DEBUG - Applied edge dropout: 74 edges dropped.
2025-06-06 15:41:46,073 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-06 15:41:46,382 - DEBUG - Node anomaly scores shape: torch.Size([7973, 1])
2025-06-06 15:41:46,412 - DEBUG - Edge anomaly scores shape: torch.Size([14556, 1])
2025-06-06 15:41:46,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-06 15:41:46,413 - DEBUG - Node reconstruction loss: 27.7286
2025-06-06 15:41:46,413 - DEBUG - Edge reconstruction loss: 13.1599
2025-06-06 15:41:46,414 - DEBUG - Anomaly regularization loss: 1.8277
