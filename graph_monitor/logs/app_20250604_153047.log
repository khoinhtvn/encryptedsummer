2025-06-04 15:30:47,098 - INFO - Application logging to file: logs/app_20250604_153047.log
2025-06-04 15:30:47,098 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-04 15:30:47,098 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-04 15:30:47,098 - INFO - Train Mode: train, Visualization Path: vis
2025-06-04 15:30:47,102 - INFO - Found 1406 files to process.
2025-06-04 15:30:47,102 - INFO - 
--- Processing file: nw_graph_encoded_1749028219.dot ---
2025-06-04 15:30:47,102 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot
2025-06-04 15:30:47,102 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot file.
2025-06-04 15:30:47,103 - INFO - Parsed 13 nodes.
2025-06-04 15:30:47,103 - INFO - Parsed 15 edges.
2025-06-04 15:30:47,104 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:47,104 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:47,104 - DEBUG - Initial node features tensor shape: torch.Size([13, 19])
2025-06-04 15:30:47,107 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:47,107 - DEBUG - Node features tensor shape after scaling: torch.Size([13, 19])
2025-06-04 15:30:47,107 - DEBUG - Edge index tensor shape: torch.Size([2, 15])
2025-06-04 15:30:47,107 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:47,108 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:30:47,108 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:30:47,108 - DEBUG - Shape of encoded categorical edge features: torch.Size([15, 2])
2025-06-04 15:30:47,109 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:47,109 - DEBUG - Shape of scaled numerical edge features: torch.Size([15, 20])
2025-06-04 15:30:47,109 - DEBUG - Final edge attributes tensor shape: torch.Size([15, 22])
2025-06-04 15:30:47,109 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:47,109 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-04 15:30:47,109 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-04 15:30:47,154 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-04 15:30:47,156 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-04 15:30:47,157 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-04 15:30:47,158 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-04 15:30:47,158 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-04 15:30:47,158 - INFO - RunningStats initialized.
2025-06-04 15:30:47,158 - INFO - RunningStats initialized.
2025-06-04 15:30:47,158 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-04 15:30:47,158 - INFO - Using device: cpu
2025-06-04 15:30:47,159 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-04 15:30:47,184 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 148
2025-06-04 15:30:47,184 - INFO - Resuming online updates from step: 148
2025-06-04 15:30:47,185 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-04 15:30:47,185 - INFO - Performing online update...
2025-06-04 15:30:47,185 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:47,186 - DEBUG - Updated RunningStats: new_mean=[ 5.29908242e-10 -5.12612419e-10 -2.16018869e-09  2.37766450e-09
 -2.72727017e-08  1.46787863e-08 -1.05767155e-08 -2.30728839e-09
 -3.08419462e-09  9.27712178e-10  1.65880152e-09 -1.64029158e-09
  4.04641324e-09 -3.49838379e-09  9.73039163e-10  9.35476794e-10
 -4.02288310e-09  1.45444535e-09 -5.29805734e-09], new_M2=[174894.00516313 174894.00508913 174894.00028706 174894.00398638
 174893.9987251  174893.99837698 174893.99619715 174893.99842423
 174893.99348666 174893.99832535 174894.0018616  174893.99393816
 174893.99275312 139235.99641959 139236.00025012 139235.99905073
 139236.0000566  174894.00043234 174894.00739633], new_n=174894
2025-06-04 15:30:47,187 - DEBUG - Updated RunningStats: new_mean=[ 1.41890316e+00  5.52779930e+00  1.16460175e-10  3.26022039e-10
  1.65886816e-10 -1.58507090e-10 -1.35847351e-09  3.00444392e-10
  3.78867200e-10 -3.14770587e-10  4.82955122e-10 -3.99359166e-09
 -8.81155830e-10  8.50768986e-10  4.09741651e-10 -1.73558577e-10
 -1.73558577e-10 -1.73558577e-10 -1.73558577e-10 -1.73558577e-10
 -1.73558577e-10 -6.55219416e-11], new_M2=[  96842.69913908 1671383.06541125  378084.99911827  378085.00679552
  378085.00562341  378084.99376441  378085.00029367  378084.99924155
  378085.0016942   378084.9993623   378084.99378024  378085.00893435
  378085.00114237  378084.99966043  378085.00194482  378084.99450771
  378084.99450771  378084.99450771  378084.99450771  378084.99450771
  378084.99450771  378084.99962609], new_n=378085
2025-06-04 15:30:47,187 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.8922536  0.89225361 0.89225361 0.89225361 1.
 1.00000002]
2025-06-04 15:30:47,187 - DEBUG - Calculated standard deviation: [0.50610278 2.1025352  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:47,188 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:47,188 - DEBUG - Online update step: 1/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 2/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 3/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 4/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 5/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 6/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,188 - DEBUG - Online update step: 7/50
2025-06-04 15:30:47,188 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 8/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 9/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 10/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 11/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 12/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 13/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,189 - DEBUG - Online update step: 14/50
2025-06-04 15:30:47,189 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 15/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 16/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 17/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 18/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 19/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 20/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 21/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 22/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 23/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 24/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 25/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 26/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 27/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 28/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,190 - DEBUG - Online update step: 29/50
2025-06-04 15:30:47,190 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 30/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 31/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 32/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 33/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 34/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 35/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 36/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 37/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 38/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 39/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 40/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 41/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 42/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 43/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 44/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 45/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 46/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 47/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,191 - DEBUG - Online update step: 48/50
2025-06-04 15:30:47,191 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,192 - DEBUG - Online update step: 49/50
2025-06-04 15:30:47,192 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,192 - DEBUG - Online update step: 50/50
2025-06-04 15:30:47,192 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:47,192 - WARNING - No successful steps during online update.
2025-06-04 15:30:47,192 - DEBUG - Current node mean: [-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], current edge mean: [ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 15:30:47,192 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4084
2025-06-04 15:30:47,192 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:30:47,193 - DEBUG - Updated reference mean: node=[-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], edge=[ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 15:30:47,193 - DEBUG - Updated reference std: node=[1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833
 1.040833 1.040833 1.040833 1.040833 1.040833 0.       0.       0.
 0.       1.040833 1.040833], edge=[0.41403934 1.6124516  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983 ]
2025-06-04 15:30:47,193 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:47,193 - INFO - Running anomaly detection...
2025-06-04 15:30:47,193 - INFO - Starting anomaly detection.
2025-06-04 15:30:47,198 - DEBUG - Node reconstruction errors: [0.19116807 0.09926549 0.09926549 0.19116805 0.2156302  0.3248086
 1.1974084  0.31205615 0.0992655  0.0992655  0.96661335 0.09926549
 1.3718346 ]
2025-06-04 15:30:47,198 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.7999999  0.7999998  0.79999804 0.7999992
 0.7999804  0.7999105  0.7999101  0.79991335 0.7999991  0.8
 0.8        0.8        0.8       ]
2025-06-04 15:30:47,199 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153047_update_1.json
2025-06-04 15:30:47,199 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:47,222 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153047_update_1.pth and as latest_checkpoint.pth
2025-06-04 15:30:47,222 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028219.dot): 1.0000
2025-06-04 15:30:47,222 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-04 15:30:47,222 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:47,225 - INFO - Starting 3D embedding visualization...
2025-06-04 15:30:47,227 - ERROR - Error during 3D t-SNE or plotting: perplexity must be less than n_samples
2025-06-04 15:30:47,231 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 46, in visualize_embeddings_3d
    reduced_embeddings = tsne.fit_transform(embeddings)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 1177, in fit_transform
    self._check_params_vs_input(X)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 862, in _check_params_vs_input
    raise ValueError("perplexity must be less than n_samples")
ValueError: perplexity must be less than n_samples

2025-06-04 15:30:47,231 - INFO - Performing visualization of node and edge features.
2025-06-04 15:30:47,231 - INFO - Starting visualization of node features.
2025-06-04 15:30:47,231 - INFO - Graph has 13 nodes and 19 features.
2025-06-04 15:30:47,231 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:30:47,232 - INFO - Calculating feature statistics:
2025-06-04 15:30:47,234 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 15:30:47,234 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 15:30:47,234 - INFO - - server_score: {'name': 'server_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4013742), 'max': np.float32(2.4682057)}
2025-06-04 15:30:47,234 - INFO - - client_score: {'name': 'client_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.51907015), 'max': np.float32(2.5818622)}
2025-06-04 15:30:47,235 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(1.8339891e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42640144), 'max': np.float32(2.345208)}
2025-06-04 15:30:47,235 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 3, 'mean': np.float32(3.6679783e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42617667), 'max': np.float32(2.4267406)}
2025-06-04 15:30:47,235 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.503131), 'max': np.float32(0.42553222)}
2025-06-04 15:30:47,235 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.4602873), 'max': np.float32(3.1299536)}
2025-06-04 15:30:47,236 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.89260745), 'max': np.float32(3.2516413)}
2025-06-04 15:30:47,236 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.5204165), 'max': np.float32(2.6020825)}
2025-06-04 15:30:47,236 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 3, 'mean': np.float32(-9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7344548), 'max': np.float32(0.63900965)}
2025-06-04 15:30:47,236 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 15:30:47,237 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 15:30:47,237 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:30:47,237 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:30:47,237 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:30:47,237 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:30:47,238 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 5, 'mean': np.float32(-1.432804e-09), 'std': np.float32(0.9999999), 'min': np.float32(-1.9622618), 'max': np.float32(0.6965064)}
2025-06-04 15:30:47,238 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 5, 'mean': np.float32(9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.2277385), 'max': np.float32(1.7117991)}
2025-06-04 15:30:47,247 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-04 15:30:47,275 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b9cd9880>
2025-06-04 15:30:47,427 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:30:47,467 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:30:47,489 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:30:48,564 - INFO - Node feature visualization saved to vis/node_features_20250604_153047.png
2025-06-04 15:30:48,564 - INFO - Finished visualization of node features.
2025-06-04 15:30:48,564 - INFO - Performing additional feature analysis:
2025-06-04 15:30:48,564 - INFO - - Maximum correlation between different features: nan
2025-06-04 15:30:48,565 - INFO - Starting visualization of edge features.
2025-06-04 15:30:48,565 - INFO - Graph has 15 edges and 22 edge features.
2025-06-04 15:30:48,565 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:30:48,565 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:30:48,567 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:30:48,567 - INFO - 
--- Processing file: nw_graph_encoded_1749028234.dot ---
2025-06-04 15:30:48,567 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot
2025-06-04 15:30:48,567 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot file.
2025-06-04 15:30:48,568 - INFO - Parsed 19 nodes.
2025-06-04 15:30:48,568 - INFO - Parsed 25 edges.
2025-06-04 15:30:48,569 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:48,569 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:48,569 - DEBUG - Initial node features tensor shape: torch.Size([19, 19])
2025-06-04 15:30:48,570 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:48,570 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 19])
2025-06-04 15:30:48,570 - DEBUG - Edge index tensor shape: torch.Size([2, 25])
2025-06-04 15:30:48,570 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:48,571 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:30:48,571 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:30:48,571 - DEBUG - Shape of encoded categorical edge features: torch.Size([25, 2])
2025-06-04 15:30:48,571 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:48,571 - DEBUG - Shape of scaled numerical edge features: torch.Size([25, 20])
2025-06-04 15:30:48,572 - DEBUG - Final edge attributes tensor shape: torch.Size([25, 22])
2025-06-04 15:30:48,572 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:48,572 - INFO - Performing online update...
2025-06-04 15:30:48,572 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:48,572 - DEBUG - Updated RunningStats: new_mean=[ 5.31043366e-10 -5.13579038e-10 -2.15954938e-09  2.37638392e-09
 -2.72697392e-08  1.46744657e-08 -1.05776112e-08 -2.30882679e-09
 -3.08592550e-09  9.27781789e-10  1.66117708e-09 -1.63840956e-09
  4.04597370e-09 -3.49800378e-09  9.72933466e-10  9.35375177e-10
 -4.02244611e-09  1.45462813e-09 -5.29662992e-09], new_M2=[174913.00516548 174913.00509149 174913.00028802 174913.00398578
 174912.99872442 174912.99837636 174912.99619893 174912.99842424
 174912.99348668 174912.99832586 174913.00185965 174912.99393892
 174912.99275244 139235.99641959 139236.00025012 139235.99905073
 139236.0000566  174913.0004327  174913.00739762], new_n=174913
2025-06-04 15:30:48,573 - DEBUG - Updated RunningStats: new_mean=[ 1.41881992e+00  5.52760308e+00  1.16206165e-10  3.26261571e-10
  1.65526087e-10 -1.58072956e-10 -1.35883013e-09  2.99872793e-10
  3.78940674e-10 -3.14375384e-10  4.82253226e-10 -3.99399758e-09
 -8.80733030e-10  8.51185650e-10  4.08768729e-10 -1.72998446e-10
 -1.72998446e-10 -1.72998446e-10 -1.72998446e-10 -1.72998446e-10
 -1.72998446e-10 -6.54979046e-11], new_M2=[  96885.67744836 1671663.40667005  378109.99911842  378110.00679525
  378110.00562228  378109.99376465  378110.000294    378109.99924072
  378110.00169397  378109.99936283  378109.99377932  378110.00893543
  378110.00114176  378109.99965923  378110.00194448  378109.99450774
  378109.99450774  378109.99450774  378109.99450774  378109.99450774
  378109.99450774  378109.99962633], new_n=378110
2025-06-04 15:30:48,573 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89220514 0.89220515 0.89220515 0.89220515 1.
 1.00000002]
2025-06-04 15:30:48,573 - DEBUG - Calculated standard deviation: [0.50619833 2.102642   1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:48,573 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:48,573 - DEBUG - Online update step: 1/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 2/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 3/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 4/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 5/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 6/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 7/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 8/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,573 - DEBUG - Online update step: 9/50
2025-06-04 15:30:48,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 10/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 11/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 12/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 13/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 14/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 15/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 16/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 17/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 18/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 19/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 20/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 21/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 22/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 23/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 24/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 25/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 26/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 27/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 28/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 29/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,574 - DEBUG - Online update step: 30/50
2025-06-04 15:30:48,574 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 31/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 32/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 33/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 34/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 35/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 36/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 37/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 38/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 39/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 40/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 41/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 42/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 43/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 44/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 45/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 46/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 47/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 48/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 49/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - DEBUG - Online update step: 50/50
2025-06-04 15:30:48,575 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,575 - WARNING - No successful steps during online update.
2025-06-04 15:30:48,576 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], current edge mean: [ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 15:30:48,576 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4868
2025-06-04 15:30:48,576 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:30:48,576 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], edge=[ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 15:30:48,577 - DEBUG - Updated reference std: node=[1.0274024 1.0274024 1.0274024 1.0274023 1.0274023 1.0274023 1.0274024
 1.0274023 1.0274023 1.0274024 1.0274023 1.0274024 1.0274023 0.
 0.        0.        0.        1.0274024 1.0274024], edge=[0.37416574 1.5832456  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207 ]
2025-06-04 15:30:48,577 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:48,577 - INFO - Running anomaly detection...
2025-06-04 15:30:48,577 - INFO - Starting anomaly detection.
2025-06-04 15:30:48,590 - DEBUG - Node reconstruction errors: [0.07240532 0.07240532 0.07240532 0.07240532 0.07240531 1.1123093
 0.07240532 1.3299029  0.07240532 0.0724053  0.4332166  2.534799
 0.2577527  0.07240531 0.24827231 1.1087005  0.07240532 0.0724053
 0.24827234]
2025-06-04 15:30:48,590 - DEBUG - Edge reconstruction errors: [0.79999965 0.79999965 0.7999997  0.7999997  0.47469142 0.27701104
 0.286802   0.799944   0.79996234 0.7999911  0.79999644 0.7999907
 0.27632225 0.29281443 0.17522633 0.7999965  0.7999964  0.79999804
 0.79999775 0.799998   0.79999715 0.79999703 0.19999999 0.7999891
 0.79998815]
2025-06-04 15:30:48,596 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153048_update_2.json
2025-06-04 15:30:48,596 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:48,617 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153048_update_2.pth and as latest_checkpoint.pth
2025-06-04 15:30:48,617 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028234.dot): 0.9998
2025-06-04 15:30:48,617 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:30:48,617 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.5348, MLP Score: 0.0000
2025-06-04 15:30:48,617 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:48,617 - INFO - 
--- Processing file: nw_graph_encoded_1749028249.dot ---
2025-06-04 15:30:48,617 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot
2025-06-04 15:30:48,617 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot file.
2025-06-04 15:30:48,619 - INFO - Parsed 21 nodes.
2025-06-04 15:30:48,620 - INFO - Parsed 29 edges.
2025-06-04 15:30:48,620 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:48,620 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:48,621 - DEBUG - Initial node features tensor shape: torch.Size([21, 19])
2025-06-04 15:30:48,622 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:48,622 - DEBUG - Node features tensor shape after scaling: torch.Size([21, 19])
2025-06-04 15:30:48,622 - DEBUG - Edge index tensor shape: torch.Size([2, 29])
2025-06-04 15:30:48,622 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:48,623 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:30:48,623 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:30:48,623 - DEBUG - Shape of encoded categorical edge features: torch.Size([29, 2])
2025-06-04 15:30:48,624 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:48,624 - DEBUG - Shape of scaled numerical edge features: torch.Size([29, 20])
2025-06-04 15:30:48,624 - DEBUG - Final edge attributes tensor shape: torch.Size([29, 22])
2025-06-04 15:30:48,624 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:48,624 - INFO - Performing online update...
2025-06-04 15:30:48,624 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:48,625 - DEBUG - Updated RunningStats: new_mean=[ 5.30724072e-10 -5.12835932e-10 -2.16159004e-09  2.37660974e-09
 -2.72664656e-08  1.46720226e-08 -1.05766821e-08 -2.31084953e-09
 -3.08619391e-09  9.29714772e-10  1.66234057e-09 -1.64144978e-09
  4.04548800e-09 -3.49758386e-09  9.72816670e-10  9.35262890e-10
 -4.02196323e-09  1.45155733e-09 -5.29275452e-09], new_M2=[174934.00516418 174934.00509022 174934.00028887 174934.00398562
 174933.99872595 174933.99837654 174933.99619795 174933.99842411
 174933.99348845 174933.99832626 174934.00185774 174933.99393846
 174933.99275397 139235.99641959 139236.00025012 139235.99905073
 139236.0000566  174934.00043252 174934.00739862], new_n=174934
2025-06-04 15:30:48,625 - DEBUG - Updated RunningStats: new_mean=[ 1.41872169e+00  5.52738808e+00  1.15926333e-10  3.26629384e-10
  1.65715352e-10 -1.58011575e-10 -1.35858800e-09  2.99692169e-10
  3.78714580e-10 -3.14469494e-10  4.82324610e-10 -3.99349424e-09
 -8.81414211e-10  8.49583515e-10  4.09052633e-10 -1.73493769e-10
 -1.73493769e-10 -1.73493769e-10 -1.73493769e-10 -1.73493769e-10
 -1.73493769e-10 -6.54928815e-11], new_M2=[  96936.70168906 1671957.10538192  378138.99911754  378139.00679689
  378139.00562244  378138.99376384  378139.00029335  378138.99924076
  378139.00169307  378138.99936228  378138.99378004  378139.00893516
  378139.00114192  378138.99965972  378139.00194481  378138.99450689
  378138.99450689  378138.99450689  378138.99450689  378138.99450689
  378138.99450689  378138.99962601], new_n=378139
2025-06-04 15:30:48,626 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89215158 0.89215159 0.89215159 0.89215159 1.
 1.00000002]
2025-06-04 15:30:48,626 - DEBUG - Calculated standard deviation: [0.50631219 2.10274607 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:48,626 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:48,626 - DEBUG - Online update step: 1/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 2/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 3/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 4/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 5/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 6/50
2025-06-04 15:30:48,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,626 - DEBUG - Online update step: 7/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 8/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 9/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 10/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 11/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 12/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 13/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 14/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 15/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 16/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 17/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 18/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 19/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 20/50
2025-06-04 15:30:48,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,627 - DEBUG - Online update step: 21/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 22/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 23/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 24/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 25/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 26/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 27/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 28/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 29/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 30/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 31/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 32/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 33/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 34/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,628 - DEBUG - Online update step: 35/50
2025-06-04 15:30:48,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 36/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 37/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 38/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 39/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 40/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 41/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 42/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 43/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 44/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 45/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 46/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 47/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 48/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 49/50
2025-06-04 15:30:48,629 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,629 - DEBUG - Online update step: 50/50
2025-06-04 15:30:48,630 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,630 - WARNING - No successful steps during online update.
2025-06-04 15:30:48,630 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], current edge mean: [ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 15:30:48,630 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5296
2025-06-04 15:30:48,630 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:30:48,630 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:30:48,630 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:30:48,631 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:30:48,632 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:30:48,633 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:30:48,633 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:30:48,633 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:30:48,633 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:30:48,633 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:30:48,634 - INFO - Optimizer and scheduler reset.
2025-06-04 15:30:48,634 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], edge=[ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 15:30:48,634 - DEBUG - Updated reference std: node=[1.024695  1.024695  1.024695  1.024695  1.0246952 1.024695  1.024695
 1.024695  1.0246952 1.024695  1.024695  1.024695  1.0246952 0.
 0.        0.        0.        1.024695  1.0246952], edge=[0.3509312 1.5328907 1.0177004 1.0177006 1.0177004 1.0177004 1.0177004
 1.0177004 1.0177004 1.0177004 1.0177006 1.0177004 1.0177004 1.0177006
 1.0177006 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004
 1.0177004]
2025-06-04 15:30:48,635 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:48,635 - INFO - Running anomaly detection...
2025-06-04 15:30:48,635 - INFO - Starting anomaly detection.
2025-06-04 15:30:48,642 - DEBUG - Node reconstruction errors: [  3.7082648   3.7082648   3.708264    3.7082648   3.7082644   3.7082644
   3.7082648 163.82524     3.7082648 371.69595     3.7082644   3.7082644
   8.114548   45.716095    8.033388    3.708264    3.4072795  77.93571
   3.7082644   3.7082644   3.4072795]
2025-06-04 15:30:48,643 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8]
2025-06-04 15:30:48,644 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153048_update_3.json
2025-06-04 15:30:48,644 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:48,654 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153048_update_3.pth and as latest_checkpoint.pth
2025-06-04 15:30:48,654 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028249.dot): 1.0000
2025-06-04 15:30:48,654 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:30:48,655 - WARNING -   Node ID: 192.168.27.10, Recon Error: 371.6960, MLP Score: 0.0000
2025-06-04 15:30:48,655 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:48,655 - INFO - 
--- Processing file: nw_graph_encoded_1749028264.dot ---
2025-06-04 15:30:48,655 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot
2025-06-04 15:30:48,655 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot file.
2025-06-04 15:30:48,657 - INFO - Parsed 31 nodes.
2025-06-04 15:30:48,658 - INFO - Parsed 41 edges.
2025-06-04 15:30:48,660 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:48,660 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:48,661 - DEBUG - Initial node features tensor shape: torch.Size([31, 19])
2025-06-04 15:30:48,662 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:48,662 - DEBUG - Node features tensor shape after scaling: torch.Size([31, 19])
2025-06-04 15:30:48,663 - DEBUG - Edge index tensor shape: torch.Size([2, 41])
2025-06-04 15:30:48,663 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:48,664 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:30:48,664 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:30:48,665 - DEBUG - Shape of encoded categorical edge features: torch.Size([41, 2])
2025-06-04 15:30:48,666 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:48,666 - DEBUG - Shape of scaled numerical edge features: torch.Size([41, 20])
2025-06-04 15:30:48,666 - DEBUG - Final edge attributes tensor shape: torch.Size([41, 22])
2025-06-04 15:30:48,666 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:48,666 - INFO - Performing online update...
2025-06-04 15:30:48,666 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:48,667 - DEBUG - Updated RunningStats: new_mean=[ 5.35016115e-10 -5.16960812e-10 -2.15969535e-09  2.37414466e-09
 -2.72629973e-08  1.46673791e-08 -1.05761708e-08 -2.30890710e-09
 -3.08447607e-09  9.28357715e-10  1.66374937e-09 -1.64405461e-09
  4.04613389e-09 -3.49526084e-09  9.70940978e-10  9.39185175e-10
 -4.01716264e-09  1.45394031e-09 -5.29045410e-09], new_M2=[174965.00516719 174965.00509323 174965.00028944 174965.00398723
 174964.99872427 174964.99837563 174964.99619729 174964.99842297
 174964.99348701 174964.99832468 174965.0018599  174964.99393631
 174964.99275229 139266.99642052 139267.00025105 139266.99905007
 139267.00005593 174965.00043304 174965.00739823], new_n=174965
2025-06-04 15:30:48,667 - DEBUG - Updated RunningStats: new_mean=[ 1.41858110e+00  5.52707705e+00  1.16102157e-10  3.26010326e-10
  1.65510225e-10 -1.58880996e-10 -1.35786937e-09  2.99048943e-10
  3.78831131e-10 -3.14403387e-10  4.82045756e-10 -3.99314009e-09
 -8.82080226e-10  8.49491408e-10  4.08377849e-10 -1.73593167e-10
 -1.73593167e-10 -1.73593167e-10 -1.73593167e-10 -1.73593167e-10
 -1.73593167e-10 -6.54365283e-11], new_M2=[  97010.0306177  1672401.7309747   378179.99911962  378180.0067944
  378180.0056228   378179.99376121  378180.00029185  378179.99924055
  378180.00169372  378179.99936219  378179.99378118  378180.00893587
  378180.00114171  378179.99965962  378180.00194441  378179.99450651
  378179.99450651  378179.99450651  378179.99450651  378179.99450651
  378179.99450651  378179.99962597], new_n=378180
2025-06-04 15:30:48,668 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89217185 0.89217186 0.89217185 0.89217186 1.
 1.00000002]
2025-06-04 15:30:48,668 - DEBUG - Calculated standard deviation: [0.5064762  2.10291164 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:48,668 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:48,668 - DEBUG - Online update step: 1/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 2/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 3/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 4/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 5/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 6/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,668 - DEBUG - Online update step: 7/50
2025-06-04 15:30:48,668 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 8/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 9/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 10/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 11/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 12/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 13/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 14/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 15/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 16/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 17/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 18/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 19/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,669 - DEBUG - Online update step: 20/50
2025-06-04 15:30:48,669 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 21/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 22/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 23/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 24/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 25/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 26/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 27/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 28/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 29/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 30/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 31/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 32/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 33/50
2025-06-04 15:30:48,670 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,670 - DEBUG - Online update step: 34/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 35/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 36/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 37/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 38/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 39/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 40/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 41/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 42/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 43/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 44/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 45/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 46/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 47/50
2025-06-04 15:30:48,671 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,671 - DEBUG - Online update step: 48/50
2025-06-04 15:30:48,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,672 - DEBUG - Online update step: 49/50
2025-06-04 15:30:48,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,672 - DEBUG - Online update step: 50/50
2025-06-04 15:30:48,672 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,672 - WARNING - No successful steps during online update.
2025-06-04 15:30:48,672 - DEBUG - Current node mean: [ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], current edge mean: [ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 15:30:48,672 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5601
2025-06-04 15:30:48,673 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:30:48,673 - DEBUG - Updated reference mean: node=[ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], edge=[ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 15:30:48,673 - DEBUG - Updated reference std: node=[1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653], edge=[0.33129457 1.6372195  1.0124229  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228 ]
2025-06-04 15:30:48,673 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:48,673 - INFO - Running anomaly detection...
2025-06-04 15:30:48,674 - INFO - Starting anomaly detection.
2025-06-04 15:30:48,680 - DEBUG - Node reconstruction errors: [  5.360623    2.061182    2.1555827 120.691635    2.061182    2.1555822
   9.327824   63.98812     7.082712    2.1555822   2.1555827   2.1555827
   2.1555824 673.07355     2.1555822   2.1555827 223.11739     2.1555827
   2.1555827   5.360623    2.1555827   2.1555827   2.1555827   2.1555824
   2.1555822   2.1555822   4.512857    4.512856    2.1555817   2.0611823
   2.155581 ]
2025-06-04 15:30:48,680 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8]
2025-06-04 15:30:48,685 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153048_update_4.json
2025-06-04 15:30:48,686 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:48,695 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153048_update_4.pth and as latest_checkpoint.pth
2025-06-04 15:30:48,695 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028264.dot): 1.0000
2025-06-04 15:30:48,696 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:30:48,696 - WARNING -   Node ID: 192.168.27.10, Recon Error: 673.0735, MLP Score: 0.0000
2025-06-04 15:30:48,696 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:48,696 - INFO - 
--- Processing file: nw_graph_encoded_1749028279.dot ---
2025-06-04 15:30:48,696 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot
2025-06-04 15:30:48,696 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot file.
2025-06-04 15:30:48,699 - INFO - Parsed 41 nodes.
2025-06-04 15:30:48,700 - INFO - Parsed 54 edges.
2025-06-04 15:30:48,702 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:48,702 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:48,702 - DEBUG - Initial node features tensor shape: torch.Size([41, 19])
2025-06-04 15:30:48,703 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:48,704 - DEBUG - Node features tensor shape after scaling: torch.Size([41, 19])
2025-06-04 15:30:48,704 - DEBUG - Edge index tensor shape: torch.Size([2, 54])
2025-06-04 15:30:48,704 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:48,705 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:30:48,705 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:30:48,706 - DEBUG - Shape of encoded categorical edge features: torch.Size([54, 2])
2025-06-04 15:30:48,706 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:48,707 - DEBUG - Shape of scaled numerical edge features: torch.Size([54, 20])
2025-06-04 15:30:48,707 - DEBUG - Final edge attributes tensor shape: torch.Size([54, 22])
2025-06-04 15:30:48,707 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:48,707 - INFO - Performing online update...
2025-06-04 15:30:48,707 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:48,708 - DEBUG - Updated RunningStats: new_mean=[ 5.31548770e-10 -5.13348690e-10 -2.16084974e-09  2.37239640e-09
 -2.72581428e-08  1.46671784e-08 -1.05747148e-08 -2.31109086e-09
 -3.08428561e-09  9.27118463e-10  1.66250813e-09 -1.64520209e-09
  4.03939601e-09 -3.49512315e-09  9.71394681e-10  9.50545079e-10
 -4.02541733e-09  1.45411056e-09 -5.29245023e-09], new_M2=[175006.00516973 175006.00509577 175006.00028902 175006.0039904
 175005.99872055 175005.99837554 175005.99619897 175005.99842001
 175005.99348514 175005.99832362 175006.00186024 175005.99393259
 175005.99275535 139307.9964198  139308.00025033 139307.99905262
 139308.00005605 175006.00042997 175006.00739778], new_n=175006
2025-06-04 15:30:48,708 - DEBUG - Updated RunningStats: new_mean=[ 1.41839708e+00  5.52664753e+00  1.16047416e-10  3.25766799e-10
  1.65762372e-10 -1.59035598e-10 -1.35667582e-09  2.99213081e-10
  3.78742574e-10 -3.14319103e-10  4.81292417e-10 -3.99087348e-09
 -8.81501230e-10  8.49448921e-10  4.11156106e-10 -1.73755518e-10
 -1.73755518e-10 -1.73755518e-10 -1.73755518e-10 -1.73755518e-10
 -1.73755518e-10 -6.54665827e-11], new_M2=[  97105.82577981 1673037.91959478  378233.9991205   378234.00679322
  378234.00562302  378233.99376052  378234.00029006  378233.9992394
  378234.00169491  378233.999363    378233.99378062  378234.00893354
  378234.00114235  378233.99965822  378234.00194509  378233.99450681
  378233.99450681  378233.99450681  378233.99450681  378233.99450681
  378233.99450681  378233.99962533], new_n=378234
2025-06-04 15:30:48,709 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89219863 0.89219865 0.89219864 0.89219865 1.
 1.00000002]
2025-06-04 15:30:48,709 - DEBUG - Calculated standard deviation: [0.50669003 2.10316143 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:48,709 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:48,709 - DEBUG - Online update step: 1/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 2/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 3/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 4/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 5/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 6/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 7/50
2025-06-04 15:30:48,709 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,709 - DEBUG - Online update step: 8/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 9/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 10/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 11/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 12/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 13/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 14/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 15/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 16/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 17/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 18/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 19/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 20/50
2025-06-04 15:30:48,710 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,710 - DEBUG - Online update step: 21/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 22/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 23/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 24/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 25/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 26/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 27/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 28/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 29/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 30/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 31/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 32/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 33/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 34/50
2025-06-04 15:30:48,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,711 - DEBUG - Online update step: 35/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 36/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 37/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 38/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 39/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 40/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 41/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 42/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 43/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 44/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 45/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 46/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 47/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 48/50
2025-06-04 15:30:48,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,712 - DEBUG - Online update step: 49/50
2025-06-04 15:30:48,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,713 - DEBUG - Online update step: 50/50
2025-06-04 15:30:48,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,713 - WARNING - No successful steps during online update.
2025-06-04 15:30:48,713 - DEBUG - Current node mean: [ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], current edge mean: [ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 15:30:48,713 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5435
2025-06-04 15:30:48,713 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:30:48,714 - DEBUG - Updated reference mean: node=[ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], edge=[ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 15:30:48,714 - DEBUG - Updated reference std: node=[1.0124229 1.0124229 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228
 1.0124228 1.0124228 1.0124228 1.0124228 1.0124228 1.0124229 1.0124228
 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228], edge=[0.33904952 1.6681335  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899 ]
2025-06-04 15:30:48,714 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:48,714 - INFO - Running anomaly detection...
2025-06-04 15:30:48,715 - INFO - Starting anomaly detection.
2025-06-04 15:30:48,720 - DEBUG - Node reconstruction errors: [  2.2927175   2.2927175   1.8364704   2.2927175   8.135241    2.2927175
   1.5819318   1.4869446 218.11226     1.5819318   1.4869446   8.863967
  92.84877     2.2927175   7.7980804   2.2927175   1.8364707   1.4869446
   1.4869446   1.4869446   1.4869446 801.76447     1.4869446   2.2927175
   1.4869446 328.4266      1.4869446   1.4869446   2.2927175   1.4869446
   1.4869446   1.4869446   1.4869446   2.2927175   1.4869446   1.4869446
   2.4327369   2.4327366   1.4869446   1.5819318   2.4327364]
2025-06-04 15:30:48,720 - DEBUG - Edge reconstruction errors: [0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8
 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8 0.8]
2025-06-04 15:30:48,722 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153048_update_5.json
2025-06-04 15:30:48,722 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:48,731 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153048_update_5.pth and as latest_checkpoint.pth
2025-06-04 15:30:48,731 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028279.dot): 1.0000
2025-06-04 15:30:48,731 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:30:48,731 - WARNING -   Node ID: 192.168.27.10, Recon Error: 801.7645, MLP Score: 0.0000
2025-06-04 15:30:48,732 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:48,732 - INFO - 
--- Processing file: nw_graph_encoded_1749028294.dot ---
2025-06-04 15:30:48,732 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot
2025-06-04 15:30:48,732 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot file.
2025-06-04 15:30:48,734 - INFO - Parsed 48 nodes.
2025-06-04 15:30:48,736 - INFO - Parsed 62 edges.
2025-06-04 15:30:48,739 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:48,740 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:48,740 - DEBUG - Initial node features tensor shape: torch.Size([48, 19])
2025-06-04 15:30:48,741 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:48,742 - DEBUG - Node features tensor shape after scaling: torch.Size([48, 19])
2025-06-04 15:30:48,742 - DEBUG - Edge index tensor shape: torch.Size([2, 62])
2025-06-04 15:30:48,742 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:48,743 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:48,743 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:48,743 - DEBUG - Shape of encoded categorical edge features: torch.Size([62, 2])
2025-06-04 15:30:48,744 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:48,744 - DEBUG - Shape of scaled numerical edge features: torch.Size([62, 20])
2025-06-04 15:30:48,744 - DEBUG - Final edge attributes tensor shape: torch.Size([62, 22])
2025-06-04 15:30:48,744 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:48,744 - INFO - Performing online update...
2025-06-04 15:30:48,745 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:48,745 - DEBUG - Updated RunningStats: new_mean=[ 5.32169128e-10 -5.13803792e-10 -2.16093821e-09  2.36944756e-09
 -2.72493066e-08  1.46597517e-08 -1.05765821e-08 -2.31267036e-09
 -3.08343989e-09  9.27204739e-10  1.65932832e-09 -1.64100555e-09
  4.03692643e-09 -3.48633344e-09  9.66361422e-10  9.44496059e-10
 -4.01852518e-09  1.44999834e-09 -5.29525520e-09], new_M2=[175054.00517173 175054.00509777 175054.00029317 175054.003986
 175053.998723   175053.99837427 175053.99620345 175053.99841827
 175053.99348786 175053.99832476 175054.00185834 175053.99393355
 175053.99275779 139355.99641503 139356.00025395 139355.99904888
 139356.00005777 175054.00042699 175054.00739565], new_n=175054
2025-06-04 15:30:48,746 - DEBUG - Updated RunningStats: new_mean=[ 1.41834965e+00  5.52625722e+00  1.16199440e-10  3.25811883e-10
  1.65341302e-10 -1.59442826e-10 -1.35710095e-09  2.98908005e-10
  3.79207345e-10 -3.14100180e-10  4.80662074e-10 -3.98863395e-09
 -8.81290288e-10  8.49802080e-10  4.10300916e-10 -1.74145561e-10
 -1.74145561e-10 -1.74145561e-10 -1.74145561e-10 -1.74145561e-10
 -1.74145561e-10 -6.56921945e-11], new_M2=[  97119.98405481 1673669.18706783  378295.9991204   378296.00679325
  378296.00562016  378295.99375831  378296.00029122  378295.99923912
  378296.00169269  378295.9993625   378295.99378064  378296.00893043
  378296.00114081  378295.99966162  378296.00194376  378295.99450504
  378295.99450504  378295.99450504  378295.99450504  378295.99450504
  378295.99450504  378295.99962363], new_n=378296
2025-06-04 15:30:48,746 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89222998 0.89222999 0.89222999 0.89222999 1.
 1.00000002]
2025-06-04 15:30:48,746 - DEBUG - Calculated standard deviation: [0.50668544 2.10338579 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:48,747 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:48,747 - DEBUG - Online update step: 1/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 2/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 3/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 4/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 5/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 6/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 7/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 8/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 9/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 10/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 11/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 12/50
2025-06-04 15:30:48,747 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,747 - DEBUG - Online update step: 13/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 14/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 15/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 16/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 17/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 18/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 19/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 20/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 21/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 22/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 23/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 24/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 25/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,748 - DEBUG - Online update step: 26/50
2025-06-04 15:30:48,748 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 27/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 28/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 29/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 30/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 31/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 32/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 33/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 34/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 35/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 36/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 37/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 38/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 39/50
2025-06-04 15:30:48,749 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,749 - DEBUG - Online update step: 40/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 41/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 42/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 43/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 44/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 45/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 46/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 47/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 48/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 49/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - DEBUG - Online update step: 50/50
2025-06-04 15:30:48,750 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:48,750 - WARNING - No successful steps during online update.
2025-06-04 15:30:48,751 - DEBUG - Current node mean: [ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], current edge mean: [ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 15:30:48,751 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1320
2025-06-04 15:30:48,751 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:30:48,751 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:30:48,751 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:30:48,752 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:30:48,753 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:30:48,754 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:30:48,754 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:30:48,754 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:30:48,754 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:30:48,755 - INFO - Optimizer and scheduler reset.
2025-06-04 15:30:48,755 - DEBUG - Updated reference mean: node=[ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], edge=[ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 15:30:48,755 - DEBUG - Updated reference std: node=[1.0105823 1.0105823 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823
 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105822
 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823], edge=[0.38342166 2.141294   1.0081635  1.0081635  1.0081633  1.0081633
 1.0081635  1.0081635  1.0081633  1.0081635  1.0081635  1.0081633
 1.0081633  1.0081635  1.0081633  1.0081633  1.0081633  1.0081633
 1.0081633  1.0081633  1.0081633  1.0081633 ]
2025-06-04 15:30:48,755 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:48,755 - INFO - Running anomaly detection...
2025-06-04 15:30:48,756 - INFO - Starting anomaly detection.
2025-06-04 15:30:48,760 - DEBUG - Node reconstruction errors: [  5.9844594 349.3787      2.8218875   2.8218875   2.8218875   3.157649
   2.8218875   5.9844594   2.8218873   5.1287518   2.8218875   3.72838
 393.06628     5.1287518   3.72838     9.240959   46.247658    2.8218875
   2.8218875   7.943446    2.8218875   3.157649    3.72838     3.72838
   3.72838     3.7283802 655.8738      3.72838     2.8218875   2.8218875
   3.72838   427.94742     2.8218875   3.72838     3.72838     2.8218875
   3.72838     2.465562    3.72838     3.72838     2.8218875   3.72838
   2.465562    2.9836862   2.465562    2.4655619   5.128751    2.4655619]
2025-06-04 15:30:48,760 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:30:48,762 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153048_update_6.json
2025-06-04 15:30:48,762 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:48,770 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153048_update_6.pth and as latest_checkpoint.pth
2025-06-04 15:30:48,771 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028294.dot): 0.0000
2025-06-04 15:30:48,771 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:30:48,771 - WARNING -   Node ID: 192.168.27.13, Recon Error: 393.0663, MLP Score: 0.0000
2025-06-04 15:30:48,771 - WARNING -   Node ID: 192.168.27.10, Recon Error: 655.8738, MLP Score: 0.0000
2025-06-04 15:30:48,771 - WARNING -   Node ID: 192.168.27.12, Recon Error: 427.9474, MLP Score: 0.0000
2025-06-04 15:30:48,771 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:48,827 - INFO - Starting 3D embedding visualization...
2025-06-04 15:30:49,079 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b8fcff20> <matplotlib.colors.Normalize object at 0x7be7b8fcff20>
2025-06-04 15:30:49,081 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b9b2b830>
2025-06-04 15:30:49,082 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b8fcff20> <matplotlib.colors.Normalize object at 0x7be7b8fcff20>
2025-06-04 15:30:49,084 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b9b2b830>
2025-06-04 15:30:49,087 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b8fa30e0>
2025-06-04 15:30:49,233 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_6_updates_20250604_153048.png
2025-06-04 15:30:49,233 - INFO - Performing visualization of node and edge features.
2025-06-04 15:30:49,233 - INFO - Starting visualization of node features.
2025-06-04 15:30:49,233 - INFO - Graph has 48 nodes and 19 features.
2025-06-04 15:30:49,233 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:30:49,233 - INFO - Calculating feature statistics:
2025-06-04 15:30:49,233 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30681947), 'max': np.float32(3.3146563)}
2025-06-04 15:30:49,233 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3146563), 'max': np.float32(0.30681947)}
2025-06-04 15:30:49,233 - INFO - - server_score: {'name': 'server_score', 'unique': 5, 'mean': np.float32(4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-1.9474404), 'max': np.float32(4.976149)}
2025-06-04 15:30:49,233 - INFO - - client_score: {'name': 'client_score', 'unique': 6, 'mean': np.float32(-2.4835268e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.27038658), 'max': np.float32(5.1146607)}
2025-06-04 15:30:49,234 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(2.4835268e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30151135), 'max': np.float32(3.3166249)}
2025-06-04 15:30:49,234 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 4, 'mean': np.float32(-2.7318796e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29470298), 'max': np.float32(3.9405174)}
2025-06-04 15:30:49,234 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 4, 'mean': np.float32(-1.7384687e-08), 'std': np.float32(1.0), 'min': np.float32(-4.16387), 'max': np.float32(0.28778362)}
2025-06-04 15:30:49,234 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 5, 'mean': np.float32(-2.483527e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2806588), 'max': np.float32(4.6825705)}
2025-06-04 15:30:49,234 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5491934), 'max': np.float32(6.1967735)}
2025-06-04 15:30:49,234 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 5, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.30420706), 'max': np.float32(4.142791)}
2025-06-04 15:30:49,234 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 5, 'mean': np.float32(1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.77095), 'max': np.float32(0.43216652)}
2025-06-04 15:30:49,234 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(-1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.34099716), 'max': np.float32(2.9325757)}
2025-06-04 15:30:49,234 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3166249), 'max': np.float32(0.30151135)}
2025-06-04 15:30:49,234 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(4.4703484e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.2354414), 'max': np.float32(0.8094272)}
2025-06-04 15:30:49,234 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.80942726), 'max': np.float32(1.2354416)}
2025-06-04 15:30:49,234 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503811)}
2025-06-04 15:30:49,234 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503813)}
2025-06-04 15:30:49,234 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 6, 'mean': np.float32(-1.2417634e-08), 'std': np.float32(1.0), 'min': np.float32(-2.7371583), 'max': np.float32(0.4274241)}
2025-06-04 15:30:49,234 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 6, 'mean': np.float32(-3.228585e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8509557), 'max': np.float32(1.5174342)}
2025-06-04 15:30:49,245 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b9a28530>
2025-06-04 15:30:49,476 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:30:49,511 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:30:49,528 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:30:50,615 - INFO - Node feature visualization saved to vis/node_features_20250604_153049.png
2025-06-04 15:30:50,615 - INFO - Finished visualization of node features.
2025-06-04 15:30:50,615 - INFO - Performing additional feature analysis:
2025-06-04 15:30:50,615 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 15:30:50,615 - INFO - Starting visualization of edge features.
2025-06-04 15:30:50,615 - INFO - Graph has 62 edges and 22 edge features.
2025-06-04 15:30:50,615 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:30:50,615 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:30:50,616 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:30:50,616 - INFO - 
--- Processing file: nw_graph_encoded_1749028309.dot ---
2025-06-04 15:30:50,616 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot
2025-06-04 15:30:50,616 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot file.
2025-06-04 15:30:50,619 - INFO - Parsed 52 nodes.
2025-06-04 15:30:50,620 - INFO - Parsed 68 edges.
2025-06-04 15:30:50,621 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:50,621 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:50,622 - DEBUG - Initial node features tensor shape: torch.Size([52, 19])
2025-06-04 15:30:50,622 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:50,622 - DEBUG - Node features tensor shape after scaling: torch.Size([52, 19])
2025-06-04 15:30:50,622 - DEBUG - Edge index tensor shape: torch.Size([2, 68])
2025-06-04 15:30:50,622 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:50,623 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:50,623 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:50,623 - DEBUG - Shape of encoded categorical edge features: torch.Size([68, 2])
2025-06-04 15:30:50,624 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:50,624 - DEBUG - Shape of scaled numerical edge features: torch.Size([68, 20])
2025-06-04 15:30:50,624 - DEBUG - Final edge attributes tensor shape: torch.Size([68, 22])
2025-06-04 15:30:50,624 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:50,624 - INFO - Performing online update...
2025-06-04 15:30:50,624 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:50,625 - DEBUG - Updated RunningStats: new_mean=[ 5.34074718e-10 -5.15565915e-10 -2.15910512e-09  2.36925451e-09
 -2.72422357e-08  1.46513136e-08 -1.05748028e-08 -2.30653732e-09
 -3.08284334e-09  9.23014887e-10  1.66121831e-09 -1.64443274e-09
  4.04389701e-09 -3.49040401e-09  9.71180326e-10  9.51363806e-10
 -4.02209731e-09  1.44514265e-09 -5.29317211e-09], new_M2=[175106.00517434 175106.00510039 175106.00029406 175106.00398991
 175105.99872404 175105.99837748 175105.99620706 175105.99841856
 175105.99348499 175105.99832189 175106.00185461 175105.9939295
 175105.99275675 139407.99641599 139408.00025492 139407.9990473
 139408.0000591  175106.00042469 175106.00739056], new_n=175106
2025-06-04 15:30:50,625 - DEBUG - Updated RunningStats: new_mean=[ 1.41829561e+00  5.52581905e+00  1.15675345e-10  3.24768750e-10
  1.65621729e-10 -1.59163103e-10 -1.35762010e-09  2.99336729e-10
  3.78733054e-10 -3.14979079e-10  4.79630494e-10 -3.99004195e-09
 -8.82170631e-10  8.50062875e-10  4.08494318e-10 -1.74680396e-10
 -1.74680396e-10 -1.74680396e-10 -1.74680396e-10 -1.74680396e-10
 -1.74680396e-10 -6.57542316e-11], new_M2=[  97135.19047267 1674392.77367565  378363.99911779  378364.0067873
  378364.00562237  378363.99376043  378364.00029271  378363.99924259
  378364.00169059  378363.99936138  378363.99377644  378364.00893294
  378364.00114253  378363.99966029  378364.00194468  378363.99450323
  378363.99450323  378363.99450323  378363.99450323  378363.99450323
  378363.99450323  378363.99962389], new_n=378364
2025-06-04 15:30:50,625 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89226391 0.89226393 0.89226392 0.89226393 1.
 1.00000002]
2025-06-04 15:30:50,625 - DEBUG - Calculated standard deviation: [0.50667957 2.10365136 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:50,625 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:50,625 - DEBUG - Online update step: 1/50
2025-06-04 15:30:50,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,625 - DEBUG - Online update step: 2/50
2025-06-04 15:30:50,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,625 - DEBUG - Online update step: 3/50
2025-06-04 15:30:50,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,625 - DEBUG - Online update step: 4/50
2025-06-04 15:30:50,625 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 5/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 6/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 7/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 8/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 9/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 10/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 11/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 12/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 13/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 14/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 15/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 16/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 17/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 18/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 19/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 20/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 21/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 22/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 23/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 24/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 25/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 26/50
2025-06-04 15:30:50,626 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,626 - DEBUG - Online update step: 27/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 28/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 29/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 30/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 31/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 32/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 33/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 34/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 35/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 36/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 37/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 38/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 39/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 40/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 41/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 42/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 43/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 44/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 45/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 46/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 47/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 48/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,627 - DEBUG - Online update step: 49/50
2025-06-04 15:30:50,627 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,628 - DEBUG - Online update step: 50/50
2025-06-04 15:30:50,628 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,628 - WARNING - No successful steps during online update.
2025-06-04 15:30:50,628 - DEBUG - Current node mean: [-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], current edge mean: [ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 15:30:50,628 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1587
2025-06-04 15:30:50,628 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:30:50,628 - DEBUG - Updated reference mean: node=[-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], edge=[ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 15:30:50,629 - DEBUG - Updated reference std: node=[1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563], edge=[0.36770412 2.183625   1.0074351  1.007435   1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.007435   1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351 ]
2025-06-04 15:30:50,629 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:50,629 - INFO - Running anomaly detection...
2025-06-04 15:30:50,629 - INFO - Starting anomaly detection.
2025-06-04 15:30:50,632 - DEBUG - Node reconstruction errors: [  2.7076476   6.534362  375.54282     2.7076476   2.7076476   2.7076476
   2.7076476   3.1085281   2.7076476   6.534362    2.7076476   5.2312965
   2.7076476   3.8226507 405.37018     5.2312965   3.8226507   6.230209
  45.085316    2.7076476   2.7076476   8.208726    2.7076476   3.1085281
   3.822649    3.822649    3.8226507   3.8226507 703.8484      3.8226507
   2.7076476   2.7076476   3.8226507 442.14258     2.7076476   3.8226507
   3.8226507   2.7076476   3.8226507   2.7076476   2.4490376   3.8226507
   3.8226507   2.7076476   3.8226507   2.4490376   4.676082    2.4490376
   2.4490376   5.2312965   2.7076476   2.4490378]
2025-06-04 15:30:50,633 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:30:50,634 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153050_update_7.json
2025-06-04 15:30:50,634 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:50,640 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153050_update_7.pth and as latest_checkpoint.pth
2025-06-04 15:30:50,640 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028309.dot): 0.0000
2025-06-04 15:30:50,640 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:30:50,640 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 375.5428, MLP Score: 0.0000
2025-06-04 15:30:50,640 - WARNING -   Node ID: 192.168.27.13, Recon Error: 405.3702, MLP Score: 0.0000
2025-06-04 15:30:50,641 - WARNING -   Node ID: 192.168.27.10, Recon Error: 703.8484, MLP Score: 0.0000
2025-06-04 15:30:50,641 - WARNING -   Node ID: 192.168.27.12, Recon Error: 442.1426, MLP Score: 0.0000
2025-06-04 15:30:50,641 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:50,641 - INFO - 
--- Processing file: nw_graph_encoded_1749028324.dot ---
2025-06-04 15:30:50,641 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot
2025-06-04 15:30:50,641 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot file.
2025-06-04 15:30:50,642 - INFO - Parsed 54 nodes.
2025-06-04 15:30:50,643 - INFO - Parsed 71 edges.
2025-06-04 15:30:50,645 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:50,645 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:50,645 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 15:30:50,646 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:50,646 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 15:30:50,646 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 15:30:50,647 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:50,647 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:50,648 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:50,648 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 15:30:50,648 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:50,648 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 15:30:50,648 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 15:30:50,649 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:50,649 - INFO - Performing online update...
2025-06-04 15:30:50,649 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:50,649 - DEBUG - Updated RunningStats: new_mean=[ 5.31932151e-10 -5.13280178e-10 -2.15860964e-09  2.36239893e-09
 -2.72338372e-08  1.46542831e-08 -1.05759664e-08 -2.31042011e-09
 -3.08393466e-09  9.23581049e-10  1.66223746e-09 -1.64562721e-09
  4.04639348e-09 -3.51076602e-09  9.65436331e-10  9.53112232e-10
 -4.01881562e-09  1.44053925e-09 -5.28677627e-09], new_M2=[175160.00517516 175160.00510121 175160.00029295 175160.00398958
 175159.99872219 175159.99837785 175159.9962087  175159.99841466
 175159.99348672 175159.99832227 175160.00185851 175159.99392634
 175159.99275709 139461.99641719 139462.0002529  139461.99904554
 139462.00005734 175160.00042636 175160.00738847], new_n=175160
2025-06-04 15:30:50,650 - DEBUG - Updated RunningStats: new_mean=[ 1.41823827e+00  5.52536103e+00  1.16091698e-10  3.25672524e-10
  1.65280572e-10 -1.58892065e-10 -1.35574606e-09  2.98984020e-10
  3.78888409e-10 -3.14969204e-10  4.81548671e-10 -3.98815638e-09
 -8.82098641e-10  8.53959093e-10  4.03692589e-10 -1.75046303e-10
 -1.75046303e-10 -1.75046303e-10 -1.75046303e-10 -1.75046303e-10
 -1.75046303e-10 -6.65294101e-11], new_M2=[  97150.91945512 1675141.34754981  378434.99911964  378435.00679418
  378435.0056216   378434.9937624   378435.00029477  378434.99924191
  378435.00169242  378434.99936234  378434.9937817   378435.00893153
  378435.00114162  378434.99966126  378435.00194405  378434.99450032
  378434.99450032  378434.99450032  378434.99450032  378434.99450032
  378434.99450032  378434.99961903], new_n=378435
2025-06-04 15:30:50,650 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89229913 0.89229914 0.89229914 0.89229914 1.
 1.00000002]
2025-06-04 15:30:50,650 - DEBUG - Calculated standard deviation: [0.50667306 2.10392416 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:50,650 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:50,650 - DEBUG - Online update step: 1/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 2/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 3/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 4/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 5/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 6/50
2025-06-04 15:30:50,650 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,650 - DEBUG - Online update step: 7/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 8/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 9/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 10/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 11/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 12/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 13/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 14/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 15/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 16/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 17/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 18/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 19/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 20/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 21/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 22/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 23/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 24/50
2025-06-04 15:30:50,651 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,651 - DEBUG - Online update step: 25/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 26/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 27/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 28/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 29/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 30/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 31/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 32/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 33/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 34/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 35/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 36/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 37/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 38/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 39/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 40/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 41/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,652 - DEBUG - Online update step: 42/50
2025-06-04 15:30:50,652 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 43/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 44/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 45/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 46/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 47/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 48/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 49/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - DEBUG - Online update step: 50/50
2025-06-04 15:30:50,653 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,653 - WARNING - No successful steps during online update.
2025-06-04 15:30:50,653 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 15:30:50,654 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1601
2025-06-04 15:30:50,654 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:30:50,654 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 15:30:50,654 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071176  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175 ]
2025-06-04 15:30:50,654 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:50,654 - INFO - Running anomaly detection...
2025-06-04 15:30:50,654 - INFO - Starting anomaly detection.
2025-06-04 15:30:50,658 - DEBUG - Node reconstruction errors: [  2.5615263   6.4494467 392.58047     2.5615263   2.5615263   2.5615263
   2.5615263   2.9518597   2.5615263   6.4494467   2.5615263   5.2152205
   2.5615265   3.8218336 421.33807     5.2152205   3.8218336   6.4988213
  47.4305      2.5615263   2.5615263   8.009193    2.5615263   2.9518597
   3.8218336   3.8218336   3.8218327   3.8218336 728.7012      3.8218336
   2.5615263   2.5615263   3.8218336 463.47214     2.5615263   3.8218336
   3.8218336   2.5615263   3.8218336   2.5615263   2.3612332   2.5615265
   3.8218336   3.8218336   2.5615263   3.8218336   2.3612335   4.7277675
   2.3612335   2.9518597   2.3612335   3.6162937   2.5615258   2.3612337]
2025-06-04 15:30:50,658 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 15:30:50,659 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153050_update_8.json
2025-06-04 15:30:50,659 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:50,667 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153050_update_8.pth and as latest_checkpoint.pth
2025-06-04 15:30:50,667 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028324.dot): 0.0000
2025-06-04 15:30:50,667 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:30:50,667 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 392.5805, MLP Score: 0.0000
2025-06-04 15:30:50,667 - WARNING -   Node ID: 192.168.27.13, Recon Error: 421.3381, MLP Score: 0.0000
2025-06-04 15:30:50,667 - WARNING -   Node ID: 192.168.27.10, Recon Error: 728.7012, MLP Score: 0.0000
2025-06-04 15:30:50,667 - WARNING -   Node ID: 192.168.27.12, Recon Error: 463.4721, MLP Score: 0.0000
2025-06-04 15:30:50,667 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:50,667 - INFO - 
--- Processing file: nw_graph_encoded_1749028339.dot ---
2025-06-04 15:30:50,667 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot
2025-06-04 15:30:50,667 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot file.
2025-06-04 15:30:50,669 - INFO - Parsed 54 nodes.
2025-06-04 15:30:50,670 - INFO - Parsed 71 edges.
2025-06-04 15:30:50,672 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:50,672 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:50,673 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 15:30:50,674 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:50,674 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 15:30:50,674 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 15:30:50,674 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:50,675 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:50,675 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:50,676 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 15:30:50,676 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:50,676 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 15:30:50,676 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 15:30:50,676 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:50,676 - INFO - Performing online update...
2025-06-04 15:30:50,677 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:50,677 - DEBUG - Updated RunningStats: new_mean=[ 5.29790905e-10 -5.10995851e-10 -2.15811446e-09  2.35554757e-09
 -2.72254439e-08  1.46572507e-08 -1.05771294e-08 -2.31430051e-09
 -3.08502530e-09  9.24146861e-10  1.66325599e-09 -1.64682095e-09
  4.04888840e-09 -3.53111549e-09  9.59695878e-10  9.55539943e-10
 -4.00873231e-09  1.43593868e-09 -5.28038436e-09], new_M2=[175214.00517597 175214.00510202 175214.00029184 175214.00398926
 175213.99872034 175213.99837822 175213.99621035 175213.99841077
 175213.99348844 175213.99832264 175214.00186242 175213.99392318
 175213.99275744 139515.99641838 139516.00025089 139515.99904758
 139516.00005952 175214.00042804 175214.00738637], new_n=175214
2025-06-04 15:30:50,678 - DEBUG - Updated RunningStats: new_mean=[ 1.41818095e+00  5.52490317e+00  1.15725448e-10  3.24666594e-10
  1.64732859e-10 -1.59157523e-10 -1.35617208e-09  2.99915837e-10
  3.79457073e-10 -3.15116806e-10  4.83466129e-10 -3.99020836e-09
 -8.82221673e-10  8.54133539e-10  3.98892661e-10 -1.75092205e-10
 -1.75092205e-10 -1.75092205e-10 -1.75092205e-10 -1.75092205e-10
 -1.75092205e-10 -6.55327215e-11], new_M2=[  97166.64595013 1675889.76270129  378505.99911857  378506.00678904
  378506.00562069  378505.9937612   378506.00029274  378505.99924151
  378506.001696    378505.99936201  378505.99378696  378506.00893403
  378506.0011429   378505.99966122  378506.00194343  378505.99450077
  378505.99450077  378505.99450077  378505.99450077  378505.99450077
  378505.99450077  378505.9996258 ], new_n=378506
2025-06-04 15:30:50,678 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89233433 0.89233434 0.89233434 0.89233434 1.
 1.00000002]
2025-06-04 15:30:50,678 - DEBUG - Calculated standard deviation: [0.50666654 2.10419672 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:50,678 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:50,678 - DEBUG - Online update step: 1/50
2025-06-04 15:30:50,678 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,678 - DEBUG - Online update step: 2/50
2025-06-04 15:30:50,678 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,678 - DEBUG - Online update step: 3/50
2025-06-04 15:30:50,678 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,678 - DEBUG - Online update step: 4/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 5/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 6/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 7/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 8/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 9/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 10/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 11/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 12/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 13/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 14/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 15/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 16/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 17/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 18/50
2025-06-04 15:30:50,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,679 - DEBUG - Online update step: 19/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 20/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 21/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 22/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 23/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 24/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 25/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 26/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 27/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 28/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 29/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 30/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 31/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 32/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 33/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,680 - DEBUG - Online update step: 34/50
2025-06-04 15:30:50,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 35/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 36/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 37/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 38/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 39/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 40/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 41/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 42/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 43/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 44/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 45/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 46/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 47/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 48/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 49/50
2025-06-04 15:30:50,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,681 - DEBUG - Online update step: 50/50
2025-06-04 15:30:50,682 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,682 - WARNING - No successful steps during online update.
2025-06-04 15:30:50,682 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 15:30:50,682 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1598
2025-06-04 15:30:50,682 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:30:50,682 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:30:50,682 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:30:50,683 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:30:50,684 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:30:50,685 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:30:50,685 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:30:50,685 - INFO - Optimizer and scheduler reset.
2025-06-04 15:30:50,686 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 15:30:50,686 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071176 ]
2025-06-04 15:30:50,686 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:50,686 - INFO - Running anomaly detection...
2025-06-04 15:30:50,686 - INFO - Starting anomaly detection.
2025-06-04 15:30:50,690 - DEBUG - Node reconstruction errors: [  1.9330987   3.969916  273.0378      1.9330987   1.9330987   1.9330984
   1.9330987   2.575021    1.9330987   3.969916    1.9330984   2.3843536
   1.933099    2.2287064 174.9383      2.3843536   2.2287066   8.737992
  34.469345    1.9330987   1.9330987   4.128427    1.9330987   2.575021
   2.228706    2.228706    2.228706    2.2287064 174.29704     2.2287066
   1.9330987   1.9330987   2.2287066 144.53702     1.9330987   2.2287066
   2.2287066   1.9330987   2.2287066   1.9330987   2.697971    1.933099
   2.2287066   2.2287066   1.9330987   2.2287066   2.6979716   7.6002574
   2.6979716   2.575021    2.6979716   2.6884012   1.9330993   2.6979706]
2025-06-04 15:30:50,690 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 15:30:50,691 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153050_update_9.json
2025-06-04 15:30:50,691 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:50,699 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153050_update_9.pth and as latest_checkpoint.pth
2025-06-04 15:30:50,699 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028339.dot): 1.0000
2025-06-04 15:30:50,699 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:30:50,699 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 273.0378, MLP Score: 1.0000
2025-06-04 15:30:50,699 - WARNING -   Node ID: 192.168.27.13, Recon Error: 174.9383, MLP Score: 1.0000
2025-06-04 15:30:50,700 - WARNING -   Node ID: 192.168.27.10, Recon Error: 174.2970, MLP Score: 1.0000
2025-06-04 15:30:50,700 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:50,700 - INFO - 
--- Processing file: nw_graph_encoded_1749028354.dot ---
2025-06-04 15:30:50,700 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot
2025-06-04 15:30:50,700 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot file.
2025-06-04 15:30:50,702 - INFO - Parsed 58 nodes.
2025-06-04 15:30:50,703 - INFO - Parsed 81 edges.
2025-06-04 15:30:50,705 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:50,705 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:50,706 - DEBUG - Initial node features tensor shape: torch.Size([58, 19])
2025-06-04 15:30:50,707 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:50,707 - DEBUG - Node features tensor shape after scaling: torch.Size([58, 19])
2025-06-04 15:30:50,707 - DEBUG - Edge index tensor shape: torch.Size([2, 81])
2025-06-04 15:30:50,707 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:50,708 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:50,708 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:50,709 - DEBUG - Shape of encoded categorical edge features: torch.Size([81, 2])
2025-06-04 15:30:50,709 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:50,709 - DEBUG - Shape of scaled numerical edge features: torch.Size([81, 20])
2025-06-04 15:30:50,709 - DEBUG - Final edge attributes tensor shape: torch.Size([81, 22])
2025-06-04 15:30:50,710 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:50,710 - INFO - Performing online update...
2025-06-04 15:30:50,710 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:50,710 - DEBUG - Updated RunningStats: new_mean=[ 5.31060885e-10 -5.12187033e-10 -2.15901564e-09  2.35782871e-09
 -2.72150744e-08  1.46544408e-08 -1.05756696e-08 -2.31251446e-09
 -3.08400442e-09  9.27411776e-10  1.67103729e-09 -1.64491571e-09
  4.05196947e-09 -3.53402783e-09  9.54957398e-10  9.46381937e-10
 -4.01488729e-09  1.43202662e-09 -5.28050739e-09], new_M2=[175272.00517587 175272.00510193 175272.00029288 175272.00399241
 175271.99872353 175271.99837825 175271.99621006 175271.99840975
 175271.99349261 175271.99831745 175272.00186261 175271.99392637
 175271.99275394 139573.99641875 139574.00025209 139573.99904927
 139574.00006329 175272.00043143 175272.00738454], new_n=175272
2025-06-04 15:30:50,711 - DEBUG - Updated RunningStats: new_mean=[ 1.41811261e+00  5.52438937e+00  1.14796640e-10  3.24400331e-10
  1.63585696e-10 -1.60375609e-10 -1.35546865e-09  3.00958667e-10
  3.79533327e-10 -3.13040799e-10  4.83441409e-10 -3.98925624e-09
 -8.83356397e-10  8.52140237e-10  4.01168913e-10 -1.75103943e-10
 -1.75103943e-10 -1.75103943e-10 -1.75103943e-10 -1.75103943e-10
 -1.75103943e-10 -6.58427858e-11], new_M2=[  97184.11818684 1676711.55071361  378586.99911232  378587.00678972
  378587.00561247  378586.9937537   378587.00029325  378586.9992451
  378587.00169742  378586.99936259  378586.99378739  378587.00893278
  378587.00114328  378586.99966369  378587.00194387  378586.99450165
  378586.99450165  378586.99450165  378586.99450165  378586.99450165
  378586.99450165  378586.99962332], new_n=378587
2025-06-04 15:30:50,711 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.8923721  0.89237212 0.89237211 0.89237212 1.
 1.00000002]
2025-06-04 15:30:50,711 - DEBUG - Calculated standard deviation: [0.50665788 2.1044874  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:50,711 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:50,711 - DEBUG - Online update step: 1/50
2025-06-04 15:30:50,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,711 - DEBUG - Online update step: 2/50
2025-06-04 15:30:50,711 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 3/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 4/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 5/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 6/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 7/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 8/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 9/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 10/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 11/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 12/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 13/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 14/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 15/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,712 - DEBUG - Online update step: 16/50
2025-06-04 15:30:50,712 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 17/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 18/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 19/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 20/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 21/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 22/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 23/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 24/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 25/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 26/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 27/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 28/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 29/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 30/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,713 - DEBUG - Online update step: 31/50
2025-06-04 15:30:50,713 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 32/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 33/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 34/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 35/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 36/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 37/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 38/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 39/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 40/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 41/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 42/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 43/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 44/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 45/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 46/50
2025-06-04 15:30:50,714 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,714 - DEBUG - Online update step: 47/50
2025-06-04 15:30:50,715 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,715 - DEBUG - Online update step: 48/50
2025-06-04 15:30:50,715 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,715 - DEBUG - Online update step: 49/50
2025-06-04 15:30:50,715 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,715 - DEBUG - Online update step: 50/50
2025-06-04 15:30:50,715 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,715 - WARNING - No successful steps during online update.
2025-06-04 15:30:50,715 - DEBUG - Current node mean: [-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], current edge mean: [ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 15:30:50,715 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1409
2025-06-04 15:30:50,715 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:30:50,716 - DEBUG - Updated reference mean: node=[-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], edge=[ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 15:30:50,716 - DEBUG - Updated reference std: node=[1.0087337 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087339 1.0087337 1.0087337 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337], edge=[0.3392985 2.1058414 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306]
2025-06-04 15:30:50,716 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:50,716 - INFO - Running anomaly detection...
2025-06-04 15:30:50,716 - INFO - Starting anomaly detection.
2025-06-04 15:30:50,720 - DEBUG - Node reconstruction errors: [  2.1904664   3.9117777 234.38815     2.1904664   2.1904664   2.1904666
   2.1904664   2.5422575   2.1904664   3.9117777   2.1904666   2.5839813
   2.1904664   2.5111341 137.51097     4.0948305   2.5839813   3.2791493
   2.5111344   9.490069   29.296688    2.1904664   2.1904664   4.9160423
   2.1904664   2.5422575   2.5111344   2.5111341   2.5111341 194.38124
   2.5111344 158.44145     2.5111344   2.1904664   2.1904664   2.5111344
 118.91373     2.190467    2.5111344   3.382512    2.1904664   2.5111341
   2.1904664   2.8728683   4.0948305   2.1904664   2.5111344   2.5111344
   2.1904664   2.5111344   2.8728683   9.191887    2.8728683   2.5422575
   2.8728683   2.813334    2.1904666   2.8728676]
2025-06-04 15:30:50,721 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999]
2025-06-04 15:30:50,721 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153050_update_10.json
2025-06-04 15:30:50,722 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:50,730 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153050_update_10.pth and as latest_checkpoint.pth
2025-06-04 15:30:50,730 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028354.dot): 1.0000
2025-06-04 15:30:50,730 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:30:50,730 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 234.3882, MLP Score: 1.0000
2025-06-04 15:30:50,730 - WARNING -   Node ID: 192.168.209.130, Recon Error: 194.3812, MLP Score: 1.0000
2025-06-04 15:30:50,730 - WARNING -   Node ID: 192.168.27.10, Recon Error: 158.4415, MLP Score: 1.0000
2025-06-04 15:30:50,730 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:50,730 - INFO - 
--- Processing file: nw_graph_encoded_1749028369.dot ---
2025-06-04 15:30:50,730 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot
2025-06-04 15:30:50,730 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot file.
2025-06-04 15:30:50,732 - INFO - Parsed 68 nodes.
2025-06-04 15:30:50,733 - INFO - Parsed 92 edges.
2025-06-04 15:30:50,737 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:50,737 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:50,737 - DEBUG - Initial node features tensor shape: torch.Size([68, 19])
2025-06-04 15:30:50,738 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:50,738 - DEBUG - Node features tensor shape after scaling: torch.Size([68, 19])
2025-06-04 15:30:50,739 - DEBUG - Edge index tensor shape: torch.Size([2, 92])
2025-06-04 15:30:50,739 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:50,740 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:50,740 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:50,740 - DEBUG - Shape of encoded categorical edge features: torch.Size([92, 2])
2025-06-04 15:30:50,741 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:50,741 - DEBUG - Shape of scaled numerical edge features: torch.Size([92, 20])
2025-06-04 15:30:50,741 - DEBUG - Final edge attributes tensor shape: torch.Size([92, 22])
2025-06-04 15:30:50,741 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:50,741 - INFO - Performing online update...
2025-06-04 15:30:50,741 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:50,742 - DEBUG - Updated RunningStats: new_mean=[ 5.31024899e-10 -5.12073382e-10 -2.16200263e-09  2.35614944e-09
 -2.72092790e-08  1.46477378e-08 -1.05702085e-08 -2.31144766e-09
 -3.08395567e-09  9.31216344e-10  1.67888767e-09 -1.64461772e-09
  4.05515717e-09 -3.53486686e-09  9.51357642e-10  9.46524820e-10
 -4.00517175e-09  1.42804001e-09 -5.27370039e-09], new_M2=[175340.00518248 175340.00510855 175340.00029508 175340.00399041
 175339.99872418 175339.99837669 175339.99620775 175339.99840693
 175339.99348565 175339.99831406 175340.00185499 175339.99393281
 175339.99275458 139641.99642639 139642.00026016 139641.9990474
 139642.00006902 175340.00043355 175340.00738232], new_n=175340
2025-06-04 15:30:50,742 - DEBUG - Updated RunningStats: new_mean=[ 1.41802952e+00  5.52382097e+00  1.14276255e-10  3.24508432e-10
  1.62201891e-10 -1.60316970e-10 -1.35427363e-09  3.02248056e-10
  3.79452187e-10 -3.12015418e-10  4.84760246e-10 -3.98570960e-09
 -8.82679419e-10  8.53035020e-10  3.99654835e-10 -1.76173050e-10
 -1.76173050e-10 -1.76173050e-10 -1.76173050e-10 -1.76173050e-10
 -1.76173050e-10 -6.64883675e-11], new_M2=[  97205.34526604 1677626.87296632  378678.99911055  378679.00678958
  378679.00560462  378678.99375392  378679.00029096  378678.99924977
  378679.00169881  378678.99936283  378678.99379423  378679.00892998
  378679.00114259  378678.99966255  378679.00194253  378678.99449416
  378678.99449416  378678.99449416  378678.99449416  378678.99449416
  378678.99449416  378678.99961936], new_n=378679
2025-06-04 15:30:50,743 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89241636 0.89241637 0.89241637 0.89241637 1.
 1.00000002]
2025-06-04 15:30:50,743 - DEBUG - Calculated standard deviation: [0.50665165 2.10480602 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:50,743 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:50,743 - DEBUG - Online update step: 1/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 2/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 3/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 4/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 5/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 6/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 7/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 8/50
2025-06-04 15:30:50,743 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,743 - DEBUG - Online update step: 9/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 10/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 11/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 12/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 13/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 14/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 15/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 16/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 17/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 18/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 19/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 20/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 21/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 22/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 23/50
2025-06-04 15:30:50,744 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,744 - DEBUG - Online update step: 24/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 25/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 26/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 27/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 28/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 29/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 30/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 31/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 32/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 33/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 34/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 35/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 36/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 37/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 38/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,745 - DEBUG - Online update step: 39/50
2025-06-04 15:30:50,745 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 40/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 41/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 42/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 43/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 44/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 45/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 46/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 47/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 48/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 49/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - DEBUG - Online update step: 50/50
2025-06-04 15:30:50,746 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:50,746 - WARNING - No successful steps during online update.
2025-06-04 15:30:50,747 - DEBUG - Current node mean: [ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], current edge mean: [ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 15:30:50,747 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1113
2025-06-04 15:30:50,747 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:30:50,747 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], edge=[ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 15:30:50,748 - DEBUG - Updated reference std: node=[1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351
 1.0074351 1.007435  1.007435  1.007435  1.0074351 1.0074351 1.0074351
 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351], edge=[0.33915523 2.127421   1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054796  1.0054795  1.0054795  1.0054796  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795 ]
2025-06-04 15:30:50,748 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:50,748 - INFO - Running anomaly detection...
2025-06-04 15:30:50,748 - INFO - Starting anomaly detection.
2025-06-04 15:30:50,752 - DEBUG - Node reconstruction errors: [  2.5290444   2.5290444   2.5290444   2.5290444 227.42398     2.5862143
   2.5862136   2.2389815   9.361712    2.3377938   1.9980762   2.3377938
   1.9980762   2.337794    1.9980762   2.914536    2.5290444 114.741066
   2.3377938   2.3377938 173.32526     2.337794  185.51932     2.3377938
   2.3377938   2.2389815   1.9980762   2.4833035   2.5862143   1.9980762
   2.3377938   2.337794    2.5290444   2.4700863   1.9980754  10.89843
   3.131476  134.75438     2.3377938   1.9980762   1.9980762   3.131476
   2.3377938   2.4700863   2.5862143   1.998076    2.5862143   3.6555364
   4.3163867  26.3694      1.9980762   1.9980762   2.2389815   1.9980762
   2.5761445   1.9980758   1.9980762   1.9980762   2.5290444   2.5290444
   2.3377938   1.9980762   1.9980754 222.89784     5.178107    1.9980762
   1.9980762   2.5290444]
2025-06-04 15:30:50,753 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:30:50,754 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153050_update_11.json
2025-06-04 15:30:50,754 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:50,762 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153050_update_11.pth and as latest_checkpoint.pth
2025-06-04 15:30:50,762 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028369.dot): 1.0000
2025-06-04 15:30:50,763 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:30:50,763 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 227.4240, MLP Score: 1.0000
2025-06-04 15:30:50,763 - WARNING -   Node ID: 192.168.27.10, Recon Error: 173.3253, MLP Score: 1.0000
2025-06-04 15:30:50,763 - WARNING -   Node ID: 192.168.209.130, Recon Error: 185.5193, MLP Score: 1.0000
2025-06-04 15:30:50,763 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 222.8978, MLP Score: 1.0000
2025-06-04 15:30:50,763 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:50,766 - INFO - Starting 3D embedding visualization...
2025-06-04 15:30:50,851 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b9148b60> <matplotlib.colors.Normalize object at 0x7be7b9148b60>
2025-06-04 15:30:50,852 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b98db1a0>
2025-06-04 15:30:50,853 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b9148b60> <matplotlib.colors.Normalize object at 0x7be7b9148b60>
2025-06-04 15:30:50,855 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b98db1a0>
2025-06-04 15:30:50,858 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b9cda150>
2025-06-04 15:30:51,037 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_11_updates_20250604_153050.png
2025-06-04 15:30:51,037 - INFO - Performing visualization of node and edge features.
2025-06-04 15:30:51,037 - INFO - Starting visualization of node features.
2025-06-04 15:30:51,037 - INFO - Graph has 68 nodes and 19 features.
2025-06-04 15:30:51,037 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:30:51,037 - INFO - Calculating feature statistics:
2025-06-04 15:30:51,037 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(7.8888505e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3137314), 'max': np.float32(3.2138941)}
2025-06-04 15:30:51,038 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-7.8888505e-09), 'std': np.float32(1.0), 'min': np.float32(-3.2138941), 'max': np.float32(0.3137314)}
2025-06-04 15:30:51,038 - INFO - - server_score: {'name': 'server_score', 'unique': 6, 'mean': np.float32(-3.1336267e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.8689933), 'max': np.float32(5.635342)}
2025-06-04 15:30:51,038 - INFO - - client_score: {'name': 'client_score', 'unique': 7, 'mean': np.float32(8.765389e-10), 'std': np.float32(1.0000001), 'min': np.float32(-0.26787958), 'max': np.float32(5.5366836)}
2025-06-04 15:30:51,038 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(1.0518467e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.31108552), 'max': np.float32(3.2145503)}
2025-06-04 15:30:51,038 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 7, 'mean': np.float32(6.1357723e-09), 'std': np.float32(1.0), 'min': np.float32(-0.28304532), 'max': np.float32(5.020001)}
2025-06-04 15:30:51,038 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 7, 'mean': np.float32(2.1036934e-08), 'std': np.float32(1.0), 'min': np.float32(-5.9950714), 'max': np.float32(0.2521996)}
2025-06-04 15:30:51,038 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(8.765389e-10), 'std': np.float32(1.0), 'min': np.float32(-0.27697536), 'max': np.float32(4.9966354)}
2025-06-04 15:30:51,038 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(-4.9305315e-10), 'std': np.float32(1.0), 'min': np.float32(-1.6947097), 'max': np.float32(6.905309)}
2025-06-04 15:30:51,038 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 6, 'mean': np.float32(-1.0518467e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.29942673), 'max': np.float32(3.9775536)}
2025-06-04 15:30:51,038 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 6, 'mean': np.float32(1.8407317e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6244278), 'max': np.float32(0.47924337)}
2025-06-04 15:30:51,038 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(1.8407317e-08), 'std': np.float32(1.0), 'min': np.float32(-0.33875376), 'max': np.float32(2.951997)}
2025-06-04 15:30:51,038 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(-3.5061556e-09), 'std': np.float32(0.9999999), 'min': np.float32(-3.2145503), 'max': np.float32(0.31108552)}
2025-06-04 15:30:51,039 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 3, 'mean': np.float32(-8.765389e-09), 'std': np.float32(1.0), 'min': np.float32(-1.5975674), 'max': np.float32(1.0202055)}
2025-06-04 15:30:51,039 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 3, 'mean': np.float32(-1.7530779e-08), 'std': np.float32(1.0000001), 'min': np.float32(-1.0050591), 'max': np.float32(1.6276143)}
2025-06-04 15:30:51,039 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 3, 'mean': np.float32(3.1555402e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1954559), 'max': np.float32(1.5136075)}
2025-06-04 15:30:51,039 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 3, 'mean': np.float32(8.765389e-09), 'std': np.float32(1.0), 'min': np.float32(-1.1904813), 'max': np.float32(1.5211649)}
2025-06-04 15:30:51,039 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 6, 'mean': np.float32(-3.5061556e-09), 'std': np.float32(0.99999994), 'min': np.float32(-3.1060073), 'max': np.float32(0.38859296)}
2025-06-04 15:30:51,039 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 6, 'mean': np.float32(2.2790012e-08), 'std': np.float32(1.0000001), 'min': np.float32(-1.8902164), 'max': np.float32(1.6818346)}
2025-06-04 15:30:51,052 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b98f0ec0>
2025-06-04 15:30:51,205 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:30:51,270 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:30:51,306 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:30:52,440 - INFO - Node feature visualization saved to vis/node_features_20250604_153051.png
2025-06-04 15:30:52,440 - INFO - Finished visualization of node features.
2025-06-04 15:30:52,440 - INFO - Performing additional feature analysis:
2025-06-04 15:30:52,440 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 15:30:52,440 - INFO - Starting visualization of edge features.
2025-06-04 15:30:52,440 - INFO - Graph has 92 edges and 22 edge features.
2025-06-04 15:30:52,440 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:30:52,440 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:30:52,440 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:30:52,440 - INFO - 
--- Processing file: nw_graph_encoded_1749028384.dot ---
2025-06-04 15:30:52,440 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028384.dot
2025-06-04 15:30:52,440 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028384.dot file.
2025-06-04 15:30:52,444 - INFO - Parsed 70 nodes.
2025-06-04 15:30:52,445 - INFO - Parsed 95 edges.
2025-06-04 15:30:52,447 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:52,447 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:52,448 - DEBUG - Initial node features tensor shape: torch.Size([70, 19])
2025-06-04 15:30:52,448 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:52,448 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 19])
2025-06-04 15:30:52,448 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-04 15:30:52,449 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:52,449 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:52,449 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:52,450 - DEBUG - Shape of encoded categorical edge features: torch.Size([95, 2])
2025-06-04 15:30:52,450 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:52,450 - DEBUG - Shape of scaled numerical edge features: torch.Size([95, 20])
2025-06-04 15:30:52,450 - DEBUG - Final edge attributes tensor shape: torch.Size([95, 22])
2025-06-04 15:30:52,450 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:52,450 - INFO - Performing online update...
2025-06-04 15:30:52,450 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:52,451 - DEBUG - Updated RunningStats: new_mean=[ 5.32681895e-10 -5.13652991e-10 -2.15816658e-09  2.35529414e-09
 -2.71984207e-08  1.46432516e-08 -1.05693883e-08 -2.31171455e-09
 -3.08117463e-09  9.28975818e-10  1.68756224e-09 -1.64752933e-09
  4.05353890e-09 -3.53320137e-09  9.48684326e-10  9.48525708e-10
 -3.99575798e-09  1.43494577e-09 -5.27499386e-09], new_M2=[175410.00517996 175410.00510602 175410.00029596 175410.00398585
 175409.99872928 175409.99837961 175409.99620965 175409.99840774
 175409.993479   175409.99830958 175410.00185382 175409.99393323
 175409.99275968 139711.99642639 139712.00026856 139711.99904508
 139712.00007281 175410.00043577 175410.00738367], new_n=175410
2025-06-04 15:30:52,451 - DEBUG - Updated RunningStats: new_mean=[ 1.41794315e+00  5.52324869e+00  1.14722138e-10  3.23630397e-10
  1.61325224e-10 -1.59539127e-10 -1.35347417e-09  3.04049529e-10
  3.79039834e-10 -3.11740459e-10  4.85307452e-10 -3.98573772e-09
 -8.84872558e-10  8.51876899e-10  3.92945393e-10 -1.75319925e-10
 -1.75319925e-10 -1.75319925e-10 -1.75319925e-10 -1.75319925e-10
 -1.75319925e-10 -6.78486093e-11], new_M2=[  97227.09115198 1678542.77201976  378773.99911475  378774.00678344
  378774.00560035  378773.99375986  378774.00029363  378773.99925533
  378774.00169806  378773.99936309  378773.99380146  378774.00893011
  378774.001142    378773.99966273  378774.00194315  378773.9944993
  378773.9944993   378773.9944993   378773.9944993   378773.9944993
  378773.9944993   378773.99961168], new_n=378774
2025-06-04 15:30:52,451 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89246188 0.89246189 0.89246189 0.89246189 1.
 1.00000002]
2025-06-04 15:30:52,451 - DEBUG - Calculated standard deviation: [0.50664477 2.10511645 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:52,451 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:52,452 - DEBUG - Online update step: 1/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 2/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 3/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 4/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 5/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 6/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 7/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 8/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 9/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 10/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 11/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 12/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 13/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 14/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 15/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 16/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 17/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 18/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 19/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 20/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 21/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,452 - DEBUG - Online update step: 22/50
2025-06-04 15:30:52,452 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 23/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 24/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 25/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 26/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 27/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 28/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 29/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 30/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 31/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 32/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 33/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 34/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 35/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 36/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 37/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 38/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 39/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 40/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 41/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 42/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 43/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 44/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,453 - DEBUG - Online update step: 45/50
2025-06-04 15:30:52,453 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - DEBUG - Online update step: 46/50
2025-06-04 15:30:52,454 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - DEBUG - Online update step: 47/50
2025-06-04 15:30:52,454 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - DEBUG - Online update step: 48/50
2025-06-04 15:30:52,454 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - DEBUG - Online update step: 49/50
2025-06-04 15:30:52,454 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - DEBUG - Online update step: 50/50
2025-06-04 15:30:52,454 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,454 - WARNING - No successful steps during online update.
2025-06-04 15:30:52,454 - DEBUG - Current node mean: [ 4.4277737e-08 -4.4277737e-08 -3.4059797e-09 -2.3841858e-08
  1.3623919e-08 -4.0871758e-08 -1.3623919e-08 -1.8732889e-08
  1.0217939e-08 -1.7029899e-08  3.7465778e-08 -6.8119594e-09
 -1.7029899e-08  3.4059797e-09  6.8119594e-09  2.7247838e-08
  2.2138869e-08  0.0000000e+00 -2.7247838e-08], current edge mean: [ 1.07368422e+00  3.24210525e+00 -5.01933872e-09 -4.39192105e-09
 -6.27417318e-09  6.27417318e-09  7.52900764e-09  2.50966927e-08
  0.00000000e+00 -5.01933872e-09  2.25870238e-08 -1.75676842e-08
 -2.50966936e-09 -1.00386774e-08 -4.51740476e-08  7.52900764e-09
  7.52900764e-09  7.52900764e-09  7.52900764e-09  7.52900764e-09
  7.52900764e-09 -5.01933872e-09]
2025-06-04 15:30:52,454 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0836
2025-06-04 15:30:52,454 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:30:52,454 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:30:52,454 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:30:52,455 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:30:52,456 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:30:52,456 - INFO - Optimizer and scheduler reset.
2025-06-04 15:30:52,457 - DEBUG - Updated reference mean: node=[ 4.4277737e-08 -4.4277737e-08 -3.4059797e-09 -2.3841858e-08
  1.3623919e-08 -4.0871758e-08 -1.3623919e-08 -1.8732889e-08
  1.0217939e-08 -1.7029899e-08  3.7465778e-08 -6.8119594e-09
 -1.7029899e-08  3.4059797e-09  6.8119594e-09  2.7247838e-08
  2.2138869e-08  0.0000000e+00 -2.7247838e-08], edge=[ 1.07368422e+00  3.24210525e+00 -5.01933872e-09 -4.39192105e-09
 -6.27417318e-09  6.27417318e-09  7.52900764e-09  2.50966927e-08
  0.00000000e+00 -5.01933872e-09  2.25870238e-08 -1.75676842e-08
 -2.50966936e-09 -1.00386774e-08 -4.51740476e-08  7.52900764e-09
  7.52900764e-09  7.52900764e-09  7.52900764e-09  7.52900764e-09
  7.52900764e-09 -5.01933872e-09]
2025-06-04 15:30:52,457 - DEBUG - Updated reference std: node=[1.0072203 1.0072203 1.0072203 1.0072203 1.0072204 1.0072204 1.0072203
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.0072204 1.0072203
 1.0072204 1.0072203 1.0072204 1.0072203 1.0072203], edge=[0.3339673 2.117384  1.005305  1.005305  1.005305  1.005305  1.005305
 1.005305  1.005305  1.005305  1.0053052 1.005305  1.005305  1.005305
 1.005305  1.005305  1.005305  1.005305  1.005305  1.005305  1.005305
 1.005305 ]
2025-06-04 15:30:52,457 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:52,457 - INFO - Running anomaly detection...
2025-06-04 15:30:52,457 - INFO - Starting anomaly detection.
2025-06-04 15:30:52,463 - DEBUG - Node reconstruction errors: [  2.1580763   2.1580763   2.1580763   2.1580763   2.1580763 416.13962
   2.073771    2.0737708   1.4850878   8.123018    1.8069804   1.5035188
   1.8069805   1.503519    1.8069804   2.5260475   3.1944878   2.1580763
 218.48592     1.8069804   1.8069805 372.397       1.8069805 243.17229
   1.8069804   1.8069804   1.4850876   1.503519    2.6975458   2.0737708
   1.5035188   1.8069799   1.8069805   2.1580763   1.9787651   1.5035188
   9.684955    2.4992046 172.53432     1.8069804   1.5035187   1.503519
   2.4992046   1.8069804   1.9787651   2.0737708   1.5035186   2.0737708
   5.4294214   8.374913   95.368805    1.5035188   1.5035188   1.4850878
   1.5035189   2.3170376   1.5035186   1.5035188   1.5035188   2.1580763
   2.1580763   1.8069799   1.5035187   2.1580763   1.5035188 403.82788
   7.1172853   1.5035188   1.5035189   2.158077 ]
2025-06-04 15:30:52,463 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999963 0.19999987
 0.19999987 0.19999987 0.19999987 0.19999987 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.02832991 0.10162604 0.04754037
 0.09432459 0.05557042 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 15:30:52,464 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153052_update_12.json
2025-06-04 15:30:52,464 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:52,471 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153052_update_12.pth and as latest_checkpoint.pth
2025-06-04 15:30:52,471 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028384.dot): 0.0000
2025-06-04 15:30:52,471 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:30:52,471 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 416.1396, MLP Score: 1.0000
2025-06-04 15:30:52,471 - WARNING -   Node ID: 192.168.27.10, Recon Error: 372.3970, MLP Score: 1.0000
2025-06-04 15:30:52,471 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 403.8279, MLP Score: 1.0000
2025-06-04 15:30:52,471 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:52,471 - INFO - 
--- Processing file: nw_graph_encoded_1749028399.dot ---
2025-06-04 15:30:52,471 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028399.dot
2025-06-04 15:30:52,471 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028399.dot file.
2025-06-04 15:30:52,473 - INFO - Parsed 73 nodes.
2025-06-04 15:30:52,474 - INFO - Parsed 98 edges.
2025-06-04 15:30:52,477 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:52,477 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:52,478 - DEBUG - Initial node features tensor shape: torch.Size([73, 19])
2025-06-04 15:30:52,479 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:52,479 - DEBUG - Node features tensor shape after scaling: torch.Size([73, 19])
2025-06-04 15:30:52,479 - DEBUG - Edge index tensor shape: torch.Size([2, 98])
2025-06-04 15:30:52,479 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:52,480 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:52,480 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:30:52,480 - DEBUG - Shape of encoded categorical edge features: torch.Size([98, 2])
2025-06-04 15:30:52,481 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:52,481 - DEBUG - Shape of scaled numerical edge features: torch.Size([98, 20])
2025-06-04 15:30:52,481 - DEBUG - Final edge attributes tensor shape: torch.Size([98, 22])
2025-06-04 15:30:52,481 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:52,481 - INFO - Performing online update...
2025-06-04 15:30:52,482 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:52,482 - DEBUG - Updated RunningStats: new_mean=[ 5.39508258e-10 -5.20402355e-10 -2.16075032e-09  2.36373993e-09
 -2.71840494e-08  1.46414058e-08 -1.05646518e-08 -2.31788576e-09
 -3.08259955e-09  9.17380572e-10  1.69705004e-09 -1.64480601e-09
  4.04879570e-09 -3.51164915e-09  9.47737730e-10  9.44734521e-10
 -4.00020966e-09  1.44190828e-09 -5.27229000e-09], new_M2=[175483.00518458 175483.00511064 175483.00029886 175483.00398928
 175482.99873641 175482.99837468 175482.9962104  175482.99840394
 175482.99347615 175482.99830436 175483.00185528 175482.99393265
 175482.99276681 139784.99643112 139785.00026624 139784.99904548
 139785.00006922 175483.00043418 175483.00738106], new_n=175483
2025-06-04 15:30:52,482 - DEBUG - Updated RunningStats: new_mean=[ 1.41785352e+00  5.52267256e+00  1.14020161e-10  3.23654844e-10
  1.60059339e-10 -1.58297056e-10 -1.35306324e-09  3.04244966e-10
  3.78332170e-10 -3.13001971e-10  4.84532971e-10 -3.98443759e-09
 -8.85941576e-10  8.49926016e-10  3.93158395e-10 -1.74845630e-10
 -1.74845630e-10 -1.74845630e-10 -1.74845630e-10 -1.74845630e-10
 -1.74845630e-10 -6.77327336e-11], new_M2=[  97249.35519912 1679459.24266774  378871.99911056  378872.00678107
  378872.00559213  378871.99376707  378872.0002937   378871.99926109
  378872.00169676  378871.99936235  378871.99380058  378872.00892866
  378872.00114301  378871.9996607   378872.00194767  378871.99450039
  378871.99450039  378871.99450039  378871.99450039  378871.99450039
  378871.99450039  378871.99961001], new_n=378872
2025-06-04 15:30:52,483 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89250931 0.89250932 0.89250932 0.89250932 1.
 1.00000002]
2025-06-04 15:30:52,483 - DEBUG - Calculated standard deviation: [0.50663724 2.10541872 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:52,483 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:52,483 - DEBUG - Online update step: 1/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 2/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 3/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 4/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 5/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 6/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 7/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 8/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 9/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,483 - DEBUG - Online update step: 10/50
2025-06-04 15:30:52,483 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 11/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 12/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 13/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 14/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 15/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 16/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 17/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 18/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 19/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 20/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 21/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 22/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 23/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 24/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 25/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 26/50
2025-06-04 15:30:52,484 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,484 - DEBUG - Online update step: 27/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 28/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 29/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 30/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 31/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 32/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 33/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 34/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 35/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 36/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 37/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 38/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 39/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 40/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 41/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 42/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 43/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,485 - DEBUG - Online update step: 44/50
2025-06-04 15:30:52,485 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 45/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 46/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 47/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 48/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 49/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - DEBUG - Online update step: 50/50
2025-06-04 15:30:52,486 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,486 - WARNING - No successful steps during online update.
2025-06-04 15:30:52,486 - DEBUG - Current node mean: [ 6.5320158e-09 -6.5320158e-09 -4.2458105e-08  0.0000000e+00
  1.4697036e-08 -1.9596047e-08  1.9596047e-08  1.3064032e-08
  1.6330040e-09 -1.4697036e-08  1.4697036e-08 -6.5320158e-09
 -2.6128063e-08  7.1852178e-08  0.0000000e+00 -1.6330040e-08
 -2.2862055e-08  3.9192095e-08 -1.3064032e-08], current edge mean: [ 1.0714285e+00  3.2959185e+00  4.8656852e-09  2.4328426e-09
  2.4328426e-09  1.2164213e-09 -2.4328426e-09  0.0000000e+00
  2.4328426e-09  2.4328426e-09 -6.5686748e-08  1.2164213e-09
 -1.2164213e-09  4.8656852e-09  1.2164213e-09 -4.8656852e-09
 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09
 -4.8656852e-09  1.2164213e-09]
2025-06-04 15:30:52,486 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0576
2025-06-04 15:30:52,487 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:30:52,487 - DEBUG - Updated reference mean: node=[ 6.5320158e-09 -6.5320158e-09 -4.2458105e-08  0.0000000e+00
  1.4697036e-08 -1.9596047e-08  1.9596047e-08  1.3064032e-08
  1.6330040e-09 -1.4697036e-08  1.4697036e-08 -6.5320158e-09
 -2.6128063e-08  7.1852178e-08  0.0000000e+00 -1.6330040e-08
 -2.2862055e-08  3.9192095e-08 -1.3064032e-08], edge=[ 1.0714285e+00  3.2959185e+00  4.8656852e-09  2.4328426e-09
  2.4328426e-09  1.2164213e-09 -2.4328426e-09  0.0000000e+00
  2.4328426e-09  2.4328426e-09 -6.5686748e-08  1.2164213e-09
 -1.2164213e-09  4.8656852e-09  1.2164213e-09 -4.8656852e-09
 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09
 -4.8656852e-09  1.2164213e-09]
2025-06-04 15:30:52,487 - DEBUG - Updated reference std: node=[1.0069206 1.0069206 1.0069206 1.0069206 1.0069206 1.0069205 1.0069205
 1.0069205 1.0069205 1.0069205 1.0069205 1.0069205 1.0069206 1.0069206
 1.0069205 1.0069205 1.0069205 1.0069205 1.0069205], edge=[0.32900977 2.1064906  1.0051414  1.0051414  1.0051414  1.0051415
 1.0051414  1.0051415  1.0051414  1.0051414  1.0051414  1.0051414
 1.0051414  1.0051414  1.0051415  1.0051414  1.0051414  1.0051414
 1.0051414  1.0051414  1.0051414  1.0051414 ]
2025-06-04 15:30:52,487 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:52,487 - INFO - Running anomaly detection...
2025-06-04 15:30:52,487 - INFO - Starting anomaly detection.
2025-06-04 15:30:52,491 - DEBUG - Node reconstruction errors: [  2.787844    2.787844    1.9074622   1.9074622   1.9074622   1.9074622
   1.9074621 433.38348     1.9473261   1.9473261   1.3983724   7.645105
   1.7147044   1.4404429   2.7878454   1.714705    1.4404422   1.7147042
   2.2717493   3.9579825   1.9074622 239.34853     1.714705    1.714705
 380.71567     1.7147042 253.36365     1.7147044   1.7147044   1.398372
   1.4404421   2.4327664   1.9473261   1.4404422   1.7147042   1.7147042
   1.9074621   1.9103801   1.4404421   9.99677     2.1802845 179.7334
   1.7147044   1.4404429   1.4404429   2.1802845   1.714705    1.9103804
   1.9473261   1.4404427   1.9473261   5.440065    8.242842   98.56453
   1.4404421   1.4404421   1.3983724   1.4404429   2.773681    1.4404432
   1.4404422   1.4404422   1.9074621   1.9074621   1.7147042   1.4404422
   1.9074622   1.4404422 421.92947     7.0336723   1.4404421   1.4404421
   1.9074625]
2025-06-04 15:30:52,492 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19924074
 0.19887006 0.19900203 0.19872105 0.19829142 0.1993351  0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.38595656 0.21889007 0.35126424 0.23859358 0.33274046 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:30:52,496 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153052_update_13.json
2025-06-04 15:30:52,496 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:52,504 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153052_update_13.pth and as latest_checkpoint.pth
2025-06-04 15:30:52,504 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028399.dot): 0.0000
2025-06-04 15:30:52,504 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:30:52,504 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 433.3835, MLP Score: 1.0000
2025-06-04 15:30:52,504 - WARNING -   Node ID: 192.168.27.10, Recon Error: 380.7157, MLP Score: 1.0000
2025-06-04 15:30:52,505 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 421.9295, MLP Score: 1.0000
2025-06-04 15:30:52,505 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-04 15:30:52,505 - WARNING -   Source: 192.168.27.10, Target: 192.168.239.101, Recon Error: 0.3860, MLP Score: 0.0000
2025-06-04 15:30:52,505 - WARNING -   Source: 192.168.27.10, Target: 192.168.239.101, Recon Error: 0.3513, MLP Score: 0.0000
2025-06-04 15:30:52,505 - WARNING -   Source: 192.168.27.10, Target: 192.168.239.101, Recon Error: 0.3327, MLP Score: 0.0000
2025-06-04 15:30:52,505 - INFO - 
--- Processing file: nw_graph_encoded_1749028414.dot ---
2025-06-04 15:30:52,505 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028414.dot
2025-06-04 15:30:52,505 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028414.dot file.
2025-06-04 15:30:52,507 - INFO - Parsed 79 nodes.
2025-06-04 15:30:52,509 - INFO - Parsed 109 edges.
2025-06-04 15:30:52,513 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:52,513 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:52,514 - DEBUG - Initial node features tensor shape: torch.Size([79, 19])
2025-06-04 15:30:52,515 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:52,515 - DEBUG - Node features tensor shape after scaling: torch.Size([79, 19])
2025-06-04 15:30:52,515 - DEBUG - Edge index tensor shape: torch.Size([2, 109])
2025-06-04 15:30:52,515 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:52,516 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:52,517 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:30:52,517 - DEBUG - Shape of encoded categorical edge features: torch.Size([109, 2])
2025-06-04 15:30:52,518 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:52,518 - DEBUG - Shape of scaled numerical edge features: torch.Size([109, 20])
2025-06-04 15:30:52,518 - DEBUG - Final edge attributes tensor shape: torch.Size([109, 22])
2025-06-04 15:30:52,518 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:52,518 - INFO - Performing online update...
2025-06-04 15:30:52,518 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:52,519 - DEBUG - Updated RunningStats: new_mean=[ 5.40612909e-10 -5.21059390e-10 -2.16007508e-09  2.36327042e-09
 -2.71650268e-08  1.46422866e-08 -1.05646510e-08 -2.31497546e-09
 -3.08138218e-09  9.20193089e-10  1.69323082e-09 -1.65119553e-09
  4.04018366e-09 -3.50854118e-09  9.36065072e-10  9.46006944e-10
 -4.00689732e-09  1.44898324e-09 -5.27314288e-09], new_M2=[175562.00519212 175562.00511819 175562.000302   175562.00399058
 175561.99873858 175561.99837485 175561.9962073  175561.99840302
 175561.99346748 175561.99830725 175562.00185931 175561.9939318
 175561.99276898 139863.99643502 139864.00026605 139863.99904188
 139864.00006799 175562.00043362 175562.0073778 ], new_n=175562
2025-06-04 15:30:52,519 - DEBUG - Updated RunningStats: new_mean=[ 1.41776765e+00  5.52222407e+00  1.15297182e-10  3.24033585e-10
  1.60146005e-10 -1.57140765e-10 -1.35411291e-09  3.04282790e-10
  3.77596710e-10 -3.14672702e-10  4.84649187e-10 -3.98499462e-09
 -8.86396967e-10  8.44481625e-10  3.93202594e-10 -1.75198362e-10
 -1.75198362e-10 -1.75198362e-10 -1.75198362e-10 -1.75198362e-10
 -1.75198362e-10 -6.74625940e-11], new_M2=[  97274.51978331 1680418.06777652  378980.99911649  378981.00678597
  378981.00559535  378980.99377618  378981.00029328  378980.99926486
  378981.00169737  378980.9993619   378980.99380425  378981.00893163
  378981.00114221  378980.99966025  378981.00194843  378980.99449701
  378980.99449701  378980.99449701  378980.99449701  378980.99449701
  378980.99449701  378980.99961086], new_n=378981
2025-06-04 15:30:52,519 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89256059 0.8925606  0.8925606  0.8925606  1.
 1.00000002]
2025-06-04 15:30:52,520 - DEBUG - Calculated standard deviation: [0.50662991 2.10571675 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:52,520 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:52,520 - DEBUG - Online update step: 1/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 2/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 3/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 4/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 5/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 6/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 7/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 8/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 9/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 10/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 11/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 12/50
2025-06-04 15:30:52,520 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,520 - DEBUG - Online update step: 13/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 14/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 15/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 16/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 17/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 18/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 19/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 20/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 21/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 22/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 23/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 24/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 25/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 26/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 27/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,521 - DEBUG - Online update step: 28/50
2025-06-04 15:30:52,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 29/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 30/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 31/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 32/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 33/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 34/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 35/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 36/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 37/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 38/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 39/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 40/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 41/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 42/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 43/50
2025-06-04 15:30:52,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,522 - DEBUG - Online update step: 44/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 45/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 46/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 47/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 48/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 49/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - DEBUG - Online update step: 50/50
2025-06-04 15:30:52,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,523 - WARNING - No successful steps during online update.
2025-06-04 15:30:52,523 - DEBUG - Current node mean: [ 5.1305264e-08 -5.1305264e-08  7.5448919e-10  0.0000000e+00
  1.2071827e-08  4.8287308e-08 -3.6215479e-08 -6.0359135e-09
 -9.0538697e-09  6.0359135e-09  0.0000000e+00 -6.0359135e-09
 -1.2071827e-08  1.2071827e-08 -4.2251393e-08 -5.6586686e-09
 -5.0928019e-08  1.8107739e-08 -3.0179568e-09], current edge mean: [ 1.1192660e+00  3.9633029e+00  8.7493053e-09  4.3746526e-09
  6.5619794e-09 -4.3746526e-09 -8.7493053e-09  0.0000000e+00
 -1.3123959e-08 -1.3123959e-08  1.3123959e-08 -2.1873263e-09
 -8.7493053e-09 -2.2966928e-08 -2.6247918e-08 -4.3746526e-09
 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09
 -4.3746526e-09  6.5619794e-09]
2025-06-04 15:30:52,524 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7403
2025-06-04 15:30:52,524 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:30:52,524 - DEBUG - Updated reference mean: node=[ 5.1305264e-08 -5.1305264e-08  7.5448919e-10  0.0000000e+00
  1.2071827e-08  4.8287308e-08 -3.6215479e-08 -6.0359135e-09
 -9.0538697e-09  6.0359135e-09  0.0000000e+00 -6.0359135e-09
 -1.2071827e-08  1.2071827e-08 -4.2251393e-08 -5.6586686e-09
 -5.0928019e-08  1.8107739e-08 -3.0179568e-09], edge=[ 1.1192660e+00  3.9633029e+00  8.7493053e-09  4.3746526e-09
  6.5619794e-09 -4.3746526e-09 -8.7493053e-09  0.0000000e+00
 -1.3123959e-08 -1.3123959e-08  1.3123959e-08 -2.1873263e-09
 -8.7493053e-09 -2.2966928e-08 -2.6247918e-08 -4.3746526e-09
 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09
 -4.3746526e-09  6.5619794e-09]
2025-06-04 15:30:52,524 - DEBUG - Updated reference std: node=[1.0063899 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899
 1.0063899 1.0063897 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899
 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899], edge=[0.37822124 2.534673   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619  ]
2025-06-04 15:30:52,524 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:52,524 - INFO - Running anomaly detection...
2025-06-04 15:30:52,525 - INFO - Starting anomaly detection.
2025-06-04 15:30:52,529 - DEBUG - Node reconstruction errors: [  5.2375565   2.4562893   2.4562893   2.4562893   1.7543517   1.7543517
   1.754352    1.754352    1.7543517 419.337       1.9077102   1.9077102
   1.4641442   6.6289907   1.7789648   1.5218804   2.4562893   1.7789648
   1.5218797   1.7789648   2.2095444   3.5005064   6.6061206 266.07938
   2.506269    1.7789648   1.7789648 394.50378     1.7789648 242.92676
   1.7789648   1.7789648   1.4641442   2.4562893   1.5218797   2.9924686
   1.9077102   1.5218797   1.7789648   1.7789648   1.7543517   1.9577669
   1.5218797   7.6843963   1.9056455 228.98108   171.15393     1.7789648
   1.5218799   1.5218797   1.9056455   1.7789648   1.9577669   1.9077102
   1.5218801   1.9077098   5.4822807   8.142983   89.889275    1.5218797
   1.5218797   1.4641442   1.5218804   2.5912929   1.52188     2.4562893
   1.5218797   1.5218797   1.7543517   1.7543517   1.7789648   1.5218804
   1.7543517   1.5218797 409.20953     6.834286    1.5218796   1.5218796
   1.7543522]
2025-06-04 15:30:52,529 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.06599969
 0.19163138 0.18658978 0.19537127 0.15891808 0.11740309 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19783223
 0.19896108 0.19812536 0.19889498 0.19818437 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999]
2025-06-04 15:30:52,530 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153052_update_14.json
2025-06-04 15:30:52,530 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:52,538 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153052_update_14.pth and as latest_checkpoint.pth
2025-06-04 15:30:52,538 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028414.dot): 0.0000
2025-06-04 15:30:52,538 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:30:52,538 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 419.3370, MLP Score: 1.0000
2025-06-04 15:30:52,539 - WARNING -   Node ID: 192.168.27.12, Recon Error: 266.0794, MLP Score: 1.0000
2025-06-04 15:30:52,539 - WARNING -   Node ID: 192.168.27.10, Recon Error: 394.5038, MLP Score: 1.0000
2025-06-04 15:30:52,539 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 409.2095, MLP Score: 1.0000
2025-06-04 15:30:52,539 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:52,539 - INFO - 
--- Processing file: nw_graph_encoded_1749028429.dot ---
2025-06-04 15:30:52,539 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028429.dot
2025-06-04 15:30:52,539 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028429.dot file.
2025-06-04 15:30:52,541 - INFO - Parsed 82 nodes.
2025-06-04 15:30:52,543 - INFO - Parsed 117 edges.
2025-06-04 15:30:52,548 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:52,548 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:52,548 - DEBUG - Initial node features tensor shape: torch.Size([82, 19])
2025-06-04 15:30:52,549 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:52,549 - DEBUG - Node features tensor shape after scaling: torch.Size([82, 19])
2025-06-04 15:30:52,550 - DEBUG - Edge index tensor shape: torch.Size([2, 117])
2025-06-04 15:30:52,550 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:52,551 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:52,551 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:30:52,552 - DEBUG - Shape of encoded categorical edge features: torch.Size([117, 2])
2025-06-04 15:30:52,552 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:52,552 - DEBUG - Shape of scaled numerical edge features: torch.Size([117, 20])
2025-06-04 15:30:52,552 - DEBUG - Final edge attributes tensor shape: torch.Size([117, 22])
2025-06-04 15:30:52,552 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:52,553 - INFO - Performing online update...
2025-06-04 15:30:52,553 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:52,553 - DEBUG - Updated RunningStats: new_mean=[ 5.47926948e-10 -5.27931859e-10 -2.15940599e-09  2.35784042e-09
 -2.71442004e-08  1.46352811e-08 -1.05598885e-08 -2.32407518e-09
 -3.08465210e-09  9.28756247e-10  1.67547288e-09 -1.65347881e-09
  4.03015310e-09 -3.51012702e-09  9.48693010e-10  9.43529203e-10
 -4.01860065e-09  1.44892185e-09 -5.26287606e-09], new_M2=[175644.00519462 175644.00512069 175644.00030609 175644.00399364
 175643.9987431  175643.99837554 175643.99620821 175643.99840247
 175643.99347048 175643.99831106 175644.00185697 175643.99392436
 175643.9927735  139945.99643432 139946.00026615 139945.99904153
 139946.0000724  175644.0004366  175644.00737429], new_n=175644
2025-06-04 15:30:52,554 - DEBUG - Updated RunningStats: new_mean=[ 1.41767300e+00  5.52175427e+00  1.14922116e-10  3.23781265e-10
  1.61256133e-10 -1.56709025e-10 -1.35531640e-09  3.05770983e-10
  3.76168690e-10 -3.14067360e-10  4.83782260e-10 -3.98439611e-09
 -8.87287867e-10  8.44918692e-10  3.97483612e-10 -1.74358153e-10
 -1.74358153e-10 -1.74358153e-10 -1.74358153e-10 -1.74358153e-10
 -1.74358153e-10 -6.81591239e-11], new_M2=[  97301.07441611 1681439.09254075  379097.99911619  379098.00678748
  379098.00560335  379097.99377776  379098.00029408  379097.99926905
  379098.00169841  379097.99936409  379097.99379885  379098.00893294
  379098.00114446  379097.99965791  379098.00195294  379097.99450351
  379097.99450351  379097.99450351  379097.99450351  379097.99450351
  379097.99450351  379097.99960396], new_n=379098
2025-06-04 15:30:52,554 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89261377 0.89261378 0.89261377 0.89261378 1.
 1.00000002]
2025-06-04 15:30:52,554 - DEBUG - Calculated standard deviation: [0.50662086 2.10603131 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:52,554 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:52,554 - DEBUG - Online update step: 1/50
2025-06-04 15:30:52,554 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,554 - DEBUG - Online update step: 2/50
2025-06-04 15:30:52,554 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,554 - DEBUG - Online update step: 3/50
2025-06-04 15:30:52,554 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,554 - DEBUG - Online update step: 4/50
2025-06-04 15:30:52,554 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,554 - DEBUG - Online update step: 5/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 6/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 7/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 8/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 9/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 10/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 11/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 12/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 13/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 14/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 15/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 16/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 17/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 18/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 19/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,555 - DEBUG - Online update step: 20/50
2025-06-04 15:30:52,555 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 21/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 22/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 23/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 24/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 25/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 26/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 27/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 28/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 29/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 30/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 31/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 32/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 33/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 34/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 35/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 36/50
2025-06-04 15:30:52,556 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,556 - DEBUG - Online update step: 37/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 38/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 39/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 40/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 41/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 42/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 43/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 44/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 45/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 46/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 47/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 48/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 49/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - DEBUG - Online update step: 50/50
2025-06-04 15:30:52,557 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:30:52,557 - WARNING - No successful steps during online update.
2025-06-04 15:30:52,558 - DEBUG - Current node mean: [ 3.4890522e-08 -3.4890522e-08  7.2688593e-09 -1.1630174e-08
  2.9075437e-08  1.7445261e-08 -1.1630174e-08 -4.6520697e-08
 -1.0176403e-08  1.1630174e-08 -4.6520697e-08 -1.1630174e-08
 -4.0705611e-08  5.8150871e-09  8.1411223e-08 -1.0176403e-08
 -3.2709867e-08  4.3613153e-09  2.3260348e-08], current edge mean: [ 1.1111112e+00  4.0000000e+00 -8.1510629e-09  8.1510629e-09
  0.0000000e+00  1.6302126e-08 -1.2226594e-08  4.0755315e-09
 -4.0755315e-09 -4.0755315e-09 -8.1510629e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.6302126e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-04 15:30:52,558 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7226
2025-06-04 15:30:52,558 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:30:52,558 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:30:52,558 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:30:52,559 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:30:52,560 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:30:52,561 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:30:52,561 - INFO - Optimizer and scheduler reset.
2025-06-04 15:30:52,561 - DEBUG - Updated reference mean: node=[ 3.4890522e-08 -3.4890522e-08  7.2688593e-09 -1.1630174e-08
  2.9075437e-08  1.7445261e-08 -1.1630174e-08 -4.6520697e-08
 -1.0176403e-08  1.1630174e-08 -4.6520697e-08 -1.1630174e-08
 -4.0705611e-08  5.8150871e-09  8.1411223e-08 -1.0176403e-08
 -3.2709867e-08  4.3613153e-09  2.3260348e-08], edge=[ 1.1111112e+00  4.0000000e+00 -8.1510629e-09  8.1510629e-09
  0.0000000e+00  1.6302126e-08 -1.2226594e-08  4.0755315e-09
 -4.0755315e-09 -4.0755315e-09 -8.1510629e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.6302126e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-04 15:30:52,562 - DEBUG - Updated reference std: node=[1.006154  1.006154  1.006154  1.006154  1.006154  1.006154  1.006154
 1.006154  1.006154  1.006154  1.006154  1.0061538 1.006154  1.006154
 1.006154  1.006154  1.006154  1.006154  1.006154 ], edge=[0.36619616 2.5427382  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011 ]
2025-06-04 15:30:52,562 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:30:52,562 - INFO - Running anomaly detection...
2025-06-04 15:30:52,562 - INFO - Starting anomaly detection.
2025-06-04 15:30:52,566 - DEBUG - Node reconstruction errors: [2.93694305e+00 2.93694305e+00 2.93694305e+00 1.29693375e+01
 2.93694305e+00 2.93694305e+00 2.93694329e+00 1.16665125e+00
 2.09109211e+00 1.16665113e+00 1.16665113e+00 2.09109139e+00
 5.56710510e+02 9.18175638e-01 9.18175638e-01 7.92489529e-01
 7.46650219e+00 1.12428629e+00 6.46266878e-01 2.93694305e+00
 1.12428689e+00 6.46266878e-01 1.12428689e+00 8.60544384e-01
 1.54526341e+00 7.35113287e+00 8.45005676e+02 3.04331565e+00
 1.12428689e+00 1.12428689e+00 1.15013416e+03 1.12428689e+00
 4.55800385e+02 1.12428629e+00 1.12428629e+00 7.92489529e-01
 2.93694305e+00 6.46266878e-01 1.75835896e+00 9.18175638e-01
 6.46266878e-01 1.12428689e+00 1.12428629e+00 1.16665125e+00
 1.50387311e+00 6.46266878e-01 4.31770611e+00 9.96528208e-01
 3.84792389e+02 5.58375000e+02 1.12428689e+00 6.46267414e-01
 6.46267414e-01 9.96528029e-01 1.12428689e+00 1.50387394e+00
 9.18175638e-01 6.46266818e-01 9.18175638e-01 1.38092136e+01
 1.19384575e+01 9.28031387e+01 6.46267414e-01 6.46266878e-01
 7.92489350e-01 6.46266878e-01 2.18309975e+00 6.46266818e-01
 2.93694305e+00 6.46267414e-01 6.46267414e-01 1.16665125e+00
 1.16665113e+00 1.12428689e+00 6.46266878e-01 1.16665113e+00
 6.46266878e-01 5.57752014e+02 1.32683725e+01 6.46267414e-01
 6.46267712e-01 1.16665101e+00]
2025-06-04 15:30:52,566 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.19999999 0.19999999 0.19999999]
2025-06-04 15:30:52,567 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153052_update_15.json
2025-06-04 15:30:52,568 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:30:52,576 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153052_update_15.pth and as latest_checkpoint.pth
2025-06-04 15:30:52,576 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028429.dot): 0.0453
2025-06-04 15:30:52,576 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-04 15:30:52,576 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 556.7105, MLP Score: 0.0000
2025-06-04 15:30:52,576 - WARNING -   Node ID: 192.168.27.12, Recon Error: 845.0057, MLP Score: 0.0000
2025-06-04 15:30:52,576 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1150.1342, MLP Score: 0.0000
2025-06-04 15:30:52,576 - WARNING -   Node ID: 192.168.27.13, Recon Error: 558.3750, MLP Score: 0.0000
2025-06-04 15:30:52,576 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 557.7520, MLP Score: 0.0000
2025-06-04 15:30:52,576 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:30:52,576 - INFO - 
--- Processing file: nw_graph_encoded_1749028444.dot ---
2025-06-04 15:30:52,576 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028444.dot
2025-06-04 15:30:52,577 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028444.dot file.
2025-06-04 15:30:52,579 - INFO - Parsed 86 nodes.
2025-06-04 15:30:52,581 - INFO - Parsed 123 edges.
2025-06-04 15:30:52,587 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:30:52,588 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:30:52,588 - DEBUG - Initial node features tensor shape: torch.Size([86, 19])
2025-06-04 15:30:52,589 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:30:52,589 - DEBUG - Node features tensor shape after scaling: torch.Size([86, 19])
2025-06-04 15:30:52,590 - DEBUG - Edge index tensor shape: torch.Size([2, 123])
2025-06-04 15:30:52,590 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:30:52,591 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:30:52,591 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:30:52,591 - DEBUG - Shape of encoded categorical edge features: torch.Size([123, 2])
2025-06-04 15:30:52,592 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:30:52,592 - DEBUG - Shape of scaled numerical edge features: torch.Size([123, 20])
2025-06-04 15:30:52,592 - DEBUG - Final edge attributes tensor shape: torch.Size([123, 22])
2025-06-04 15:30:52,592 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:30:52,592 - INFO - Performing online update...
2025-06-04 15:30:52,593 - INFO - Starting online update for 50 steps.
2025-06-04 15:30:52,593 - DEBUG - Updated RunningStats: new_mean=[ 5.51550131e-10 -5.31106400e-10 -2.15741646e-09  2.35694091e-09
 -2.71287117e-08  1.46298147e-08 -1.05498025e-08 -2.31852842e-09
 -3.08392687e-09  9.32880697e-10  1.67702720e-09 -1.64656432e-09
  4.02597611e-09 -3.49280679e-09  9.45345676e-10  9.39845212e-10
 -4.01782114e-09  1.44074544e-09 -5.26572741e-09], new_M2=[175730.00519653 175730.00512261 175730.00030587 175730.00399035
 175729.99874344 175729.99837767 175729.99620876 175729.99840359
 175729.99347369 175729.99831316 175730.00185317 175729.99392312
 175729.99277384 140031.99643628 140032.00026795 140031.99903983
 140032.00007233 175730.00044097 175730.00737851], new_n=175730
2025-06-04 15:30:52,594 - DEBUG - Updated RunningStats: new_mean=[ 1.41757972e+00  5.52125805e+00  1.14747312e-10  3.24113394e-10
  1.61223476e-10 -1.56275079e-10 -1.35400251e-09  3.06663983e-10
  3.75634091e-10 -3.14370713e-10  4.84057581e-10 -3.98184245e-09
 -8.87543286e-10  8.47748880e-10  3.97669041e-10 -1.74006894e-10
 -1.74006894e-10 -1.74006894e-10 -1.74006894e-10 -1.74006894e-10
 -1.74006894e-10 -6.78619576e-11], new_M2=[  97329.16302104 1682513.87820826  379220.99911505  379221.00679237
  379221.00560671  379220.9937819   379221.0002897   379220.99926792
  379221.00169646  379220.99936331  379220.99379418  379221.00893097
  379221.00114294  379220.99966083  379221.00195123  379220.9945059
  379220.9945059   379220.9945059   379220.9945059   379220.9945059
  379220.9945059   379220.9996051 ], new_n=379221
2025-06-04 15:30:52,594 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89266948 0.89266949 0.89266949 0.89266949 1.
 1.00000002]
2025-06-04 15:30:52,594 - DEBUG - Calculated standard deviation: [0.5066118  2.10636261 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:30:52,594 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:30:52,594 - DEBUG - Online update step: 1/50
2025-06-04 15:30:52,595 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:52,595 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:52,595 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:52,595 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:52,596 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:52,596 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:52,596 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:52,596 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,596 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:52,597 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:52,597 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:52,597 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:52,597 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:52,597 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:52,598 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:52,598 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:52,599 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:52,632 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:52,634 - DEBUG - Edge anomaly scores shape: torch.Size([1032, 1])
2025-06-04 15:30:52,635 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:52,635 - DEBUG - Node reconstruction loss: 29.6093
2025-06-04 15:30:52,792 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8809
2025-06-04 15:30:52,803 - DEBUG - Step 1: Loss=24.0898
2025-06-04 15:30:52,804 - DEBUG - Online update step: 2/50
2025-06-04 15:30:52,804 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:52,805 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,805 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:52,806 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,806 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:52,806 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,806 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:52,807 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,807 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:52,807 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:52,807 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:52,808 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,808 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,808 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:52,809 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,809 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:52,810 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:52,853 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:52,855 - DEBUG - Edge anomaly scores shape: torch.Size([1028, 1])
2025-06-04 15:30:52,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:52,856 - DEBUG - Node reconstruction loss: 12.4884
2025-06-04 15:30:52,914 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8313
2025-06-04 15:30:52,918 - DEBUG - Step 2: Loss=10.1392
2025-06-04 15:30:52,918 - DEBUG - Online update step: 3/50
2025-06-04 15:30:52,918 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,919 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:52,919 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,919 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:52,920 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,920 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:52,920 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:52,921 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:52,921 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:52,921 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:52,921 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:52,922 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:52,922 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:52,922 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:52,923 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:52,923 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:52,924 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:52,956 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:52,958 - DEBUG - Edge anomaly scores shape: torch.Size([1055, 1])
2025-06-04 15:30:52,959 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:52,959 - DEBUG - Node reconstruction loss: 7.9422
2025-06-04 15:30:53,011 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8595
2025-06-04 15:30:53,023 - DEBUG - Step 3: Loss=6.4476
2025-06-04 15:30:53,023 - DEBUG - Online update step: 4/50
2025-06-04 15:30:53,024 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:53,024 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,025 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,025 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,025 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,026 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:53,026 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,026 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:53,027 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,027 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:53,027 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,027 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,028 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:53,028 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,028 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:53,029 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:53,030 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:53,143 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:53,146 - DEBUG - Edge anomaly scores shape: torch.Size([1040, 1])
2025-06-04 15:30:53,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:53,147 - DEBUG - Node reconstruction loss: 6.0139
2025-06-04 15:30:53,229 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7996
2025-06-04 15:30:53,248 - DEBUG - Step 4: Loss=4.8831
2025-06-04 15:30:53,248 - DEBUG - Online update step: 5/50
2025-06-04 15:30:53,249 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:53,250 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,251 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,251 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:53,252 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:53,253 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,254 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:53,254 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,255 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:53,256 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,256 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:53,257 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,257 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,258 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:53,259 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:53,259 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:53,262 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:53,368 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:53,379 - DEBUG - Edge anomaly scores shape: torch.Size([1035, 1])
2025-06-04 15:30:53,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:53,381 - DEBUG - Node reconstruction loss: 4.4940
2025-06-04 15:30:53,583 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7396
2025-06-04 15:30:53,689 - DEBUG - Step 5: Loss=3.6503
2025-06-04 15:30:53,689 - DEBUG - Online update step: 6/50
2025-06-04 15:30:53,690 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,691 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,691 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,692 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:53,693 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,693 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,694 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,694 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,695 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,696 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,696 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:53,697 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:53,697 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,698 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,698 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:53,699 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,701 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:53,738 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:53,741 - DEBUG - Edge anomaly scores shape: torch.Size([1040, 1])
2025-06-04 15:30:53,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:53,742 - DEBUG - Node reconstruction loss: 3.8618
2025-06-04 15:30:53,883 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7483
2025-06-04 15:30:53,906 - DEBUG - Step 6: Loss=3.1369
2025-06-04 15:30:53,907 - DEBUG - Online update step: 7/50
2025-06-04 15:30:53,908 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:53,908 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:53,909 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:53,910 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:53,911 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:53,911 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:53,912 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:53,913 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,913 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:53,914 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:53,915 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,915 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:53,916 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:53,917 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:53,917 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,918 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:53,920 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:53,964 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:53,967 - DEBUG - Edge anomaly scores shape: torch.Size([1026, 1])
2025-06-04 15:30:53,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:53,968 - DEBUG - Node reconstruction loss: 3.4342
2025-06-04 15:30:54,034 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7081
2025-06-04 15:30:54,044 - DEBUG - Step 7: Loss=2.7896
2025-06-04 15:30:54,044 - DEBUG - Online update step: 8/50
2025-06-04 15:30:54,045 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,046 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:54,047 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:54,048 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:54,048 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,049 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,049 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,049 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,050 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:54,050 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:54,050 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,051 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,051 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,051 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:54,051 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:54,052 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,053 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,085 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,088 - DEBUG - Edge anomaly scores shape: torch.Size([1018, 1])
2025-06-04 15:30:54,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,089 - DEBUG - Node reconstruction loss: 3.1123
2025-06-04 15:30:54,229 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7587
2025-06-04 15:30:54,237 - DEBUG - Step 8: Loss=2.5282
2025-06-04 15:30:54,237 - DEBUG - Online update step: 9/50
2025-06-04 15:30:54,238 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,238 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,238 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,239 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:54,239 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,239 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:54,239 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:30:54,240 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,240 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:54,240 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,240 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,241 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,241 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,241 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,241 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,242 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:54,243 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,282 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,285 - DEBUG - Edge anomaly scores shape: torch.Size([1013, 1])
2025-06-04 15:30:54,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,286 - DEBUG - Node reconstruction loss: 2.8525
2025-06-04 15:30:54,351 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7023
2025-06-04 15:30:54,354 - DEBUG - Step 9: Loss=2.3170
2025-06-04 15:30:54,354 - DEBUG - Online update step: 10/50
2025-06-04 15:30:54,355 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:54,355 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,356 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,356 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,356 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,357 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,357 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,357 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,357 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,358 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:54,358 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,358 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:54,358 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,359 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,359 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,359 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,360 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,391 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,393 - DEBUG - Edge anomaly scores shape: torch.Size([1036, 1])
2025-06-04 15:30:54,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,394 - DEBUG - Node reconstruction loss: 2.9067
2025-06-04 15:30:54,585 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7233
2025-06-04 15:30:54,589 - DEBUG - Step 10: Loss=2.3583
2025-06-04 15:30:54,589 - DEBUG - Online update step: 11/50
2025-06-04 15:30:54,589 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,590 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,590 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:54,590 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:54,591 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:54,591 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,591 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,592 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,592 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,592 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,592 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:54,593 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,593 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,593 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,594 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:54,594 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:54,595 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,629 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,632 - DEBUG - Edge anomaly scores shape: torch.Size([1040, 1])
2025-06-04 15:30:54,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,633 - DEBUG - Node reconstruction loss: 2.4610
2025-06-04 15:30:54,697 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7374
2025-06-04 15:30:54,701 - DEBUG - Step 11: Loss=1.9975
2025-06-04 15:30:54,701 - DEBUG - Online update step: 12/50
2025-06-04 15:30:54,701 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,702 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,702 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,702 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,702 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:54,703 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:54,703 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:54,703 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:54,704 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,704 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,704 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,704 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:54,705 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,705 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:54,705 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:54,705 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,706 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,736 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,739 - DEBUG - Edge anomaly scores shape: torch.Size([1029, 1])
2025-06-04 15:30:54,739 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,739 - DEBUG - Node reconstruction loss: 2.2551
2025-06-04 15:30:54,805 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7498
2025-06-04 15:30:54,817 - DEBUG - Step 12: Loss=1.8301
2025-06-04 15:30:54,818 - DEBUG - Online update step: 13/50
2025-06-04 15:30:54,818 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,819 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,819 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:54,819 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,819 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:54,820 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,820 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:54,820 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,820 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:54,821 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,821 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:54,821 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:54,822 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:54,822 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:54,822 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-04 15:30:54,822 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:54,823 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:54,936 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:54,942 - DEBUG - Edge anomaly scores shape: torch.Size([1036, 1])
2025-06-04 15:30:54,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:54,943 - DEBUG - Node reconstruction loss: 2.1239
2025-06-04 15:30:55,196 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8152
2025-06-04 15:30:55,199 - DEBUG - Step 13: Loss=1.7226
2025-06-04 15:30:55,199 - DEBUG - Online update step: 14/50
2025-06-04 15:30:55,200 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:55,200 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:55,200 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,201 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:55,201 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,201 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,202 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,202 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:55,202 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,202 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,203 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,203 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,203 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:55,203 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,204 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,204 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,205 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:55,236 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:55,238 - DEBUG - Edge anomaly scores shape: torch.Size([1042, 1])
2025-06-04 15:30:55,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:55,239 - DEBUG - Node reconstruction loss: 2.0106
2025-06-04 15:30:55,306 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6960
2025-06-04 15:30:55,314 - DEBUG - Step 14: Loss=1.6306
2025-06-04 15:30:55,314 - DEBUG - Online update step: 15/50
2025-06-04 15:30:55,315 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:55,315 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,316 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:55,317 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:30:55,317 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,318 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,319 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:55,319 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:55,320 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,320 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,321 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,322 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,322 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,323 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,324 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,324 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,326 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:55,364 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:55,367 - DEBUG - Edge anomaly scores shape: torch.Size([1031, 1])
2025-06-04 15:30:55,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:55,369 - DEBUG - Node reconstruction loss: 1.9427
2025-06-04 15:30:55,461 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7808
2025-06-04 15:30:55,496 - DEBUG - Step 15: Loss=1.5736
2025-06-04 15:30:55,496 - DEBUG - Online update step: 16/50
2025-06-04 15:30:55,497 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:55,498 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,498 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,498 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:55,498 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,499 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,499 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,499 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,500 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,500 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,500 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,500 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,501 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,501 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,502 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:55,502 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,503 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:55,574 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:55,577 - DEBUG - Edge anomaly scores shape: torch.Size([1023, 1])
2025-06-04 15:30:55,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:55,578 - DEBUG - Node reconstruction loss: 1.7918
2025-06-04 15:30:55,650 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8036
2025-06-04 15:30:55,653 - DEBUG - Step 16: Loss=1.4513
2025-06-04 15:30:55,653 - DEBUG - Online update step: 17/50
2025-06-04 15:30:55,653 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,654 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:55,654 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,654 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:55,655 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,655 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,655 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:55,655 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,656 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,656 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,656 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,656 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,657 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:55,657 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,657 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,657 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,658 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:55,786 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:55,790 - DEBUG - Edge anomaly scores shape: torch.Size([1024, 1])
2025-06-04 15:30:55,790 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:55,791 - DEBUG - Node reconstruction loss: 1.6461
2025-06-04 15:30:55,877 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7945
2025-06-04 15:30:55,880 - DEBUG - Step 17: Loss=1.3333
2025-06-04 15:30:55,881 - DEBUG - Online update step: 18/50
2025-06-04 15:30:55,881 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:55,882 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,882 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,882 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:55,882 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,883 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,883 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:55,883 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:55,883 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,884 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:55,884 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:55,884 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:55,884 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:55,885 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,885 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:55,885 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:55,886 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:55,917 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:55,919 - DEBUG - Edge anomaly scores shape: torch.Size([1032, 1])
2025-06-04 15:30:55,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:55,920 - DEBUG - Node reconstruction loss: 1.7258
2025-06-04 15:30:56,089 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8013
2025-06-04 15:30:56,116 - DEBUG - Step 18: Loss=1.3979
2025-06-04 15:30:56,116 - DEBUG - Online update step: 19/50
2025-06-04 15:30:56,117 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,117 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:56,117 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,118 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,118 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,118 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,119 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:56,119 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,119 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,119 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,120 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,120 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,120 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,120 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,121 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:56,121 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,122 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:56,156 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:56,159 - DEBUG - Edge anomaly scores shape: torch.Size([1039, 1])
2025-06-04 15:30:56,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:56,160 - DEBUG - Node reconstruction loss: 1.6178
2025-06-04 15:30:56,233 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8343
2025-06-04 15:30:56,236 - DEBUG - Step 19: Loss=1.3104
2025-06-04 15:30:56,236 - DEBUG - Online update step: 20/50
2025-06-04 15:30:56,237 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:56,237 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:56,237 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,238 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,238 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,238 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,239 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,239 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,239 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,239 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,240 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,240 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,240 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,240 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,241 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,241 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,242 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:56,271 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:56,273 - DEBUG - Edge anomaly scores shape: torch.Size([1039, 1])
2025-06-04 15:30:56,274 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:56,274 - DEBUG - Node reconstruction loss: 1.5730
2025-06-04 15:30:56,560 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7925
2025-06-04 15:30:56,563 - DEBUG - Step 20: Loss=1.2742
2025-06-04 15:30:56,564 - DEBUG - Online update step: 21/50
2025-06-04 15:30:56,564 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:56,565 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:56,565 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,565 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:56,565 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,566 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,566 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,566 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,566 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,567 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,567 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,567 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:56,567 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,568 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:56,568 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,568 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,569 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:56,599 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:56,602 - DEBUG - Edge anomaly scores shape: torch.Size([1040, 1])
2025-06-04 15:30:56,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:56,603 - DEBUG - Node reconstruction loss: 1.5645
2025-06-04 15:30:56,657 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8295
2025-06-04 15:30:56,660 - DEBUG - Step 21: Loss=1.2672
2025-06-04 15:30:56,660 - DEBUG - Online update step: 22/50
2025-06-04 15:30:56,661 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,661 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:56,661 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:56,662 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,662 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,662 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,663 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,663 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:56,663 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,663 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,664 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,664 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:56,664 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,665 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:56,665 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,665 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,666 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:56,697 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:56,700 - DEBUG - Edge anomaly scores shape: torch.Size([1038, 1])
2025-06-04 15:30:56,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:56,701 - DEBUG - Node reconstruction loss: 1.4554
2025-06-04 15:30:56,780 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8200
2025-06-04 15:30:56,793 - DEBUG - Step 22: Loss=1.1789
2025-06-04 15:30:56,793 - DEBUG - Online update step: 23/50
2025-06-04 15:30:56,794 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,794 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:56,794 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,795 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,795 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,795 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,795 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,796 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:56,796 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,796 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:56,797 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:56,797 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:56,797 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:56,798 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-04 15:30:56,798 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,798 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,799 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:56,896 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:56,899 - DEBUG - Edge anomaly scores shape: torch.Size([1025, 1])
2025-06-04 15:30:56,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:56,900 - DEBUG - Node reconstruction loss: 1.4146
2025-06-04 15:30:56,977 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7838
2025-06-04 15:30:56,980 - DEBUG - Step 23: Loss=1.1458
2025-06-04 15:30:56,981 - DEBUG - Online update step: 24/50
2025-06-04 15:30:56,981 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:56,982 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:56,982 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,982 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:56,983 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:56,983 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:56,983 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,984 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:56,984 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:56,984 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,985 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:56,985 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,985 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:56,985 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:56,986 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:56,986 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:56,987 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:57,082 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:57,093 - DEBUG - Edge anomaly scores shape: torch.Size([1042, 1])
2025-06-04 15:30:57,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:57,097 - DEBUG - Node reconstruction loss: 1.3015
2025-06-04 15:30:57,182 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8376
2025-06-04 15:30:57,190 - DEBUG - Step 24: Loss=1.0543
2025-06-04 15:30:57,190 - DEBUG - Online update step: 25/50
2025-06-04 15:30:57,191 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:57,192 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,192 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,193 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:57,194 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,194 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,195 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:57,196 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:57,197 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,197 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:57,198 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:57,199 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:57,200 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,201 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:57,202 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:57,203 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,205 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:57,358 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:57,368 - DEBUG - Edge anomaly scores shape: torch.Size([1030, 1])
2025-06-04 15:30:57,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:57,370 - DEBUG - Node reconstruction loss: 1.2686
2025-06-04 15:30:57,594 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8053
2025-06-04 15:30:57,598 - DEBUG - Step 25: Loss=1.0276
2025-06-04 15:30:57,598 - DEBUG - Online update step: 26/50
2025-06-04 15:30:57,599 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:57,599 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:57,599 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,600 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:57,600 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:57,600 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:57,600 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,601 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,601 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:57,601 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:57,601 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,602 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:57,602 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,602 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:57,602 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:57,603 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,604 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:57,634 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:57,636 - DEBUG - Edge anomaly scores shape: torch.Size([1028, 1])
2025-06-04 15:30:57,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:57,637 - DEBUG - Node reconstruction loss: 1.2580
2025-06-04 15:30:57,720 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8374
2025-06-04 15:30:57,723 - DEBUG - Step 26: Loss=1.0190
2025-06-04 15:30:57,723 - DEBUG - Online update step: 27/50
2025-06-04 15:30:57,724 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:57,724 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:30:57,724 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:57,724 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,725 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,725 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:57,725 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,725 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:57,726 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:57,726 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,726 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,726 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,727 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,727 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,727 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:57,727 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:57,728 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:57,759 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:57,761 - DEBUG - Edge anomaly scores shape: torch.Size([1029, 1])
2025-06-04 15:30:57,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:57,762 - DEBUG - Node reconstruction loss: 1.2296
2025-06-04 15:30:57,871 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8063
2025-06-04 15:30:57,889 - DEBUG - Step 27: Loss=0.9960
2025-06-04 15:30:57,889 - DEBUG - Online update step: 28/50
2025-06-04 15:30:57,890 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:57,890 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,890 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:57,891 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:57,891 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:57,891 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:57,892 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,892 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:57,892 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:57,893 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:57,893 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:57,893 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:57,894 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:57,894 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:57,894 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:57,894 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:57,896 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:57,944 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:57,947 - DEBUG - Edge anomaly scores shape: torch.Size([1056, 1])
2025-06-04 15:30:57,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:57,948 - DEBUG - Node reconstruction loss: 1.1576
2025-06-04 15:30:58,042 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8512
2025-06-04 15:30:58,046 - DEBUG - Step 28: Loss=0.9376
2025-06-04 15:30:58,046 - DEBUG - Online update step: 29/50
2025-06-04 15:30:58,047 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,047 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:30:58,047 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,048 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,048 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,048 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,049 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,049 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:58,049 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,049 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,050 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,050 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:58,050 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:58,050 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:58,051 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,051 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,052 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:58,095 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:58,106 - DEBUG - Edge anomaly scores shape: torch.Size([1019, 1])
2025-06-04 15:30:58,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:58,107 - DEBUG - Node reconstruction loss: 1.1105
2025-06-04 15:30:58,239 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8409
2025-06-04 15:30:58,244 - DEBUG - Step 29: Loss=0.8995
2025-06-04 15:30:58,244 - DEBUG - Online update step: 30/50
2025-06-04 15:30:58,245 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,245 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:58,245 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,246 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,246 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:58,246 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,246 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,247 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:58,247 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,247 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:58,248 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:58,248 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,248 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,248 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:58,249 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,249 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,251 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:58,303 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:58,307 - DEBUG - Edge anomaly scores shape: torch.Size([1041, 1])
2025-06-04 15:30:58,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:58,308 - DEBUG - Node reconstruction loss: 1.1255
2025-06-04 15:30:58,494 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8352
2025-06-04 15:30:58,498 - DEBUG - Step 30: Loss=0.9117
2025-06-04 15:30:58,498 - DEBUG - Online update step: 31/50
2025-06-04 15:30:58,498 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,499 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:58,499 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,499 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,500 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,500 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,501 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,501 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,501 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,502 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:58,502 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,502 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:58,503 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,503 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,503 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,504 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,505 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:58,589 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:58,616 - DEBUG - Edge anomaly scores shape: torch.Size([1043, 1])
2025-06-04 15:30:58,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:58,622 - DEBUG - Node reconstruction loss: 1.0853
2025-06-04 15:30:58,699 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8367
2025-06-04 15:30:58,707 - DEBUG - Step 31: Loss=0.8791
2025-06-04 15:30:58,707 - DEBUG - Online update step: 32/50
2025-06-04 15:30:58,708 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,708 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,709 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,710 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,710 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:58,711 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,712 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:58,712 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,713 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:58,714 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:58,714 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:58,715 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,716 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,716 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,717 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,718 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,720 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:58,751 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:58,754 - DEBUG - Edge anomaly scores shape: torch.Size([1037, 1])
2025-06-04 15:30:58,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:58,754 - DEBUG - Node reconstruction loss: 1.0298
2025-06-04 15:30:58,837 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8538
2025-06-04 15:30:58,843 - DEBUG - Step 32: Loss=0.8342
2025-06-04 15:30:58,843 - DEBUG - Online update step: 33/50
2025-06-04 15:30:58,844 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:58,844 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:58,845 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:58,845 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:58,845 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:58,846 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,846 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,846 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:58,847 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,847 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:58,847 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:30:58,848 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:58,848 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:58,848 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:58,848 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:58,849 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:58,850 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:58,926 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:58,930 - DEBUG - Edge anomaly scores shape: torch.Size([1032, 1])
2025-06-04 15:30:58,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:58,931 - DEBUG - Node reconstruction loss: 1.0068
2025-06-04 15:30:59,002 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8445
2025-06-04 15:30:59,005 - DEBUG - Step 33: Loss=0.8155
2025-06-04 15:30:59,005 - DEBUG - Online update step: 34/50
2025-06-04 15:30:59,006 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:59,006 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:59,006 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:59,007 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,007 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,008 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,008 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,008 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:59,009 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:59,009 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:59,009 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:59,009 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,010 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,010 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,010 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:59,011 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:59,012 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:59,059 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:59,072 - DEBUG - Edge anomaly scores shape: torch.Size([1030, 1])
2025-06-04 15:30:59,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:59,079 - DEBUG - Node reconstruction loss: 0.9485
2025-06-04 15:30:59,232 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8636
2025-06-04 15:30:59,236 - DEBUG - Step 34: Loss=0.7683
2025-06-04 15:30:59,236 - DEBUG - Online update step: 35/50
2025-06-04 15:30:59,237 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,237 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,238 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,238 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,238 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,238 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,239 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:59,239 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:59,239 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,240 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:59,240 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,240 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,240 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,241 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,241 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,241 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:59,242 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:59,282 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:59,286 - DEBUG - Edge anomaly scores shape: torch.Size([1045, 1])
2025-06-04 15:30:59,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:59,287 - DEBUG - Node reconstruction loss: 0.9657
2025-06-04 15:30:59,450 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8776
2025-06-04 15:30:59,453 - DEBUG - Step 35: Loss=0.7822
2025-06-04 15:30:59,453 - DEBUG - Online update step: 36/50
2025-06-04 15:30:59,454 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,454 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,455 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:59,455 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:59,455 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:59,456 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,456 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:59,456 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:30:59,457 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,457 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:59,457 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,457 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,458 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,458 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,458 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:59,459 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:30:59,460 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:59,495 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:59,501 - DEBUG - Edge anomaly scores shape: torch.Size([1029, 1])
2025-06-04 15:30:59,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:59,502 - DEBUG - Node reconstruction loss: 0.9110
2025-06-04 15:30:59,664 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9057
2025-06-04 15:30:59,667 - DEBUG - Step 36: Loss=0.7379
2025-06-04 15:30:59,668 - DEBUG - Online update step: 37/50
2025-06-04 15:30:59,668 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,669 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,669 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:59,669 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:30:59,669 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,670 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:30:59,670 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,670 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,671 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:59,671 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,671 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:59,671 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:30:59,672 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:30:59,672 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:59,672 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:59,672 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:30:59,673 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:59,706 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:30:59,709 - DEBUG - Edge anomaly scores shape: torch.Size([1033, 1])
2025-06-04 15:30:59,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:30:59,710 - DEBUG - Node reconstruction loss: 0.9289
2025-06-04 15:30:59,866 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8811
2025-06-04 15:30:59,874 - DEBUG - Step 37: Loss=0.7524
2025-06-04 15:30:59,874 - DEBUG - Online update step: 38/50
2025-06-04 15:30:59,875 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,876 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,877 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:30:59,877 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,878 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:30:59,879 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:30:59,879 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:30:59,880 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:30:59,881 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:59,881 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:30:59,882 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:59,883 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:30:59,883 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:30:59,884 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:30:59,885 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,885 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:30:59,888 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:30:59,986 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:00,002 - DEBUG - Edge anomaly scores shape: torch.Size([1038, 1])
2025-06-04 15:31:00,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:00,008 - DEBUG - Node reconstruction loss: 0.8832
2025-06-04 15:31:00,109 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8423
2025-06-04 15:31:00,113 - DEBUG - Step 38: Loss=0.7154
2025-06-04 15:31:00,113 - DEBUG - Online update step: 39/50
2025-06-04 15:31:00,113 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,114 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:00,114 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,114 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:00,115 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:00,115 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:00,115 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:00,116 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,116 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:00,117 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,117 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:00,117 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:00,118 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,118 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,118 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:00,119 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,120 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:00,154 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:00,157 - DEBUG - Edge anomaly scores shape: torch.Size([1059, 1])
2025-06-04 15:31:00,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:00,158 - DEBUG - Node reconstruction loss: 0.8189
2025-06-04 15:31:00,349 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8572
2025-06-04 15:31:00,498 - DEBUG - Step 39: Loss=0.6633
2025-06-04 15:31:00,499 - DEBUG - Online update step: 40/50
2025-06-04 15:31:00,499 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:00,500 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:00,500 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,500 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,500 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:00,501 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,501 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:00,501 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,502 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:00,502 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:00,502 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,502 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:00,502 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:00,503 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,503 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:00,504 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:00,505 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:00,715 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:00,718 - DEBUG - Edge anomaly scores shape: torch.Size([1033, 1])
2025-06-04 15:31:00,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:00,719 - DEBUG - Node reconstruction loss: 0.9016
2025-06-04 15:31:00,788 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9060
2025-06-04 15:31:00,791 - DEBUG - Step 40: Loss=0.7303
2025-06-04 15:31:00,791 - DEBUG - Online update step: 41/50
2025-06-04 15:31:00,792 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,792 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,793 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,793 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:00,793 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,793 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:00,794 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,794 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,794 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:00,794 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:00,795 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:00,795 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,795 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:00,795 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:00,796 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:00,796 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:00,797 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:00,827 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:00,830 - DEBUG - Edge anomaly scores shape: torch.Size([1049, 1])
2025-06-04 15:31:00,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:00,831 - DEBUG - Node reconstruction loss: 0.8544
2025-06-04 15:31:00,899 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8843
2025-06-04 15:31:00,901 - DEBUG - Step 41: Loss=0.6920
2025-06-04 15:31:00,902 - DEBUG - Online update step: 42/50
2025-06-04 15:31:00,902 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:00,903 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:00,903 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:00,903 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:00,904 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:00,904 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:00,904 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:00,904 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:00,905 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:00,905 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:00,905 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:00,905 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,906 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:00,906 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:00,906 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:00,906 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:00,907 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:00,988 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,008 - DEBUG - Edge anomaly scores shape: torch.Size([1028, 1])
2025-06-04 15:31:01,009 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,009 - DEBUG - Node reconstruction loss: 0.7834
2025-06-04 15:31:01,109 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8641
2025-06-04 15:31:01,112 - DEBUG - Step 42: Loss=0.6345
2025-06-04 15:31:01,112 - DEBUG - Online update step: 43/50
2025-06-04 15:31:01,113 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:01,113 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:01,114 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,114 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,114 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:01,114 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:01,115 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:01,115 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,115 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,116 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,116 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,116 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,117 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,117 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,117 - DEBUG - Applied edge dropout: 24 edges dropped.
2025-06-04 15:31:01,117 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,119 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:01,152 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,154 - DEBUG - Edge anomaly scores shape: torch.Size([1035, 1])
2025-06-04 15:31:01,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,155 - DEBUG - Node reconstruction loss: 0.7381
2025-06-04 15:31:01,303 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8774
2025-06-04 15:31:01,310 - DEBUG - Step 43: Loss=0.5978
2025-06-04 15:31:01,310 - DEBUG - Online update step: 44/50
2025-06-04 15:31:01,311 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,311 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,312 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,312 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,312 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,313 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:01,313 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:01,313 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,313 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,314 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,314 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,314 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,315 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,315 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,315 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:01,315 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,317 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:01,350 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,353 - DEBUG - Edge anomaly scores shape: torch.Size([1042, 1])
2025-06-04 15:31:01,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,356 - DEBUG - Node reconstruction loss: 0.7879
2025-06-04 15:31:01,433 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8750
2025-06-04 15:31:01,442 - DEBUG - Step 44: Loss=0.6382
2025-06-04 15:31:01,442 - DEBUG - Online update step: 45/50
2025-06-04 15:31:01,443 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,444 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:01,444 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,445 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,446 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-04 15:31:01,446 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,447 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,448 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,448 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:01,449 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:01,450 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,450 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,451 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,452 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,452 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:01,453 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:01,456 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:01,496 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,499 - DEBUG - Edge anomaly scores shape: torch.Size([1018, 1])
2025-06-04 15:31:01,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,500 - DEBUG - Node reconstruction loss: 0.7340
2025-06-04 15:31:01,640 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8692
2025-06-04 15:31:01,648 - DEBUG - Step 45: Loss=0.5945
2025-06-04 15:31:01,648 - DEBUG - Online update step: 46/50
2025-06-04 15:31:01,649 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,650 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:01,651 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,652 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,653 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:01,653 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,654 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:01,655 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:01,655 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,656 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,657 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:01,657 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,658 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:01,659 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-04 15:31:01,659 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:01,660 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:01,662 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:01,709 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,713 - DEBUG - Edge anomaly scores shape: torch.Size([1028, 1])
2025-06-04 15:31:01,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,714 - DEBUG - Node reconstruction loss: 0.6892
2025-06-04 15:31:01,799 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8176
2025-06-04 15:31:01,808 - DEBUG - Step 46: Loss=0.5582
2025-06-04 15:31:01,808 - DEBUG - Online update step: 47/50
2025-06-04 15:31:01,809 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,809 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:01,810 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,811 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:01,811 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,812 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:01,813 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,813 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:01,814 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:01,814 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:01,815 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:01,816 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:01,816 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:01,817 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:01,818 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,818 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:01,820 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:01,880 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:01,894 - DEBUG - Edge anomaly scores shape: torch.Size([1041, 1])
2025-06-04 15:31:01,900 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:01,901 - DEBUG - Node reconstruction loss: 0.7335
2025-06-04 15:31:02,020 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8226
2025-06-04 15:31:02,028 - DEBUG - Step 47: Loss=0.5941
2025-06-04 15:31:02,029 - DEBUG - Online update step: 48/50
2025-06-04 15:31:02,030 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,030 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:02,031 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,032 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:02,032 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:02,033 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:02,034 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:02,034 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,035 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:02,036 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:02,036 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:02,037 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,038 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,038 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:02,039 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:02,040 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:02,042 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:02,093 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:02,097 - DEBUG - Edge anomaly scores shape: torch.Size([1039, 1])
2025-06-04 15:31:02,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:02,103 - DEBUG - Node reconstruction loss: 0.6876
2025-06-04 15:31:02,278 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7700
2025-06-04 15:31:02,281 - DEBUG - Step 48: Loss=0.5569
2025-06-04 15:31:02,281 - DEBUG - Online update step: 49/50
2025-06-04 15:31:02,282 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:02,282 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,283 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:02,283 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:02,283 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:02,283 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,284 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:02,284 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:02,284 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,285 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:02,285 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:02,285 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,285 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:02,286 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:02,286 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:02,286 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:02,287 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:02,358 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:02,414 - DEBUG - Edge anomaly scores shape: torch.Size([1035, 1])
2025-06-04 15:31:02,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:02,438 - DEBUG - Node reconstruction loss: 0.6450
2025-06-04 15:31:02,576 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8608
2025-06-04 15:31:02,593 - DEBUG - Step 49: Loss=0.5225
2025-06-04 15:31:02,593 - DEBUG - Online update step: 50/50
2025-06-04 15:31:02,594 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:02,598 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,599 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:02,600 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:02,602 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:02,603 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,604 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:02,605 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:02,606 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,606 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:02,607 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:02,608 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:02,609 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:02,610 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:02,611 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:02,612 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:02,615 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:02,695 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:02,699 - DEBUG - Edge anomaly scores shape: torch.Size([1043, 1])
2025-06-04 15:31:02,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:02,700 - DEBUG - Node reconstruction loss: 0.6959
2025-06-04 15:31:02,784 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8625
2025-06-04 15:31:02,804 - DEBUG - Step 50: Loss=0.5637
2025-06-04 15:31:02,804 - INFO - Online update finished. Average loss: 2.0386, Learning rate: 0.002927
2025-06-04 15:31:02,805 - DEBUG - Current node mean: [ 0.0000000e+00  5.5446181e-09  1.1782314e-08  2.7723091e-08
 -1.1089236e-08  3.3267710e-08  0.0000000e+00  3.3267710e-08
  9.0100043e-09 -1.6633855e-08 -5.5446181e-09  4.4356945e-08
  1.1089236e-08  8.3169269e-08 -5.5446183e-08 -1.1089236e-08
  8.3169276e-09 -3.3267710e-08 -5.5446181e-09], current edge mean: [ 1.1300813e+00  3.9918699e+00  0.0000000e+00 -5.8150871e-09
 -1.6476081e-08  9.6918118e-10  9.6918118e-09 -1.9383624e-09
  3.8767247e-09  1.9383624e-09  1.1630174e-08  7.7534494e-09
 -1.5506899e-08 -7.7534494e-09  5.8150871e-09  9.6918118e-09
  9.6918118e-09  9.6918118e-09  9.6918118e-09  9.6918118e-09
  9.6918118e-09 -7.7534494e-09]
2025-06-04 15:31:02,805 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7261
2025-06-04 15:31:02,805 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:31:02,806 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  5.5446181e-09  1.1782314e-08  2.7723091e-08
 -1.1089236e-08  3.3267710e-08  0.0000000e+00  3.3267710e-08
  9.0100043e-09 -1.6633855e-08 -5.5446181e-09  4.4356945e-08
  1.1089236e-08  8.3169269e-08 -5.5446183e-08 -1.1089236e-08
  8.3169276e-09 -3.3267710e-08 -5.5446181e-09], edge=[ 1.1300813e+00  3.9918699e+00  0.0000000e+00 -5.8150871e-09
 -1.6476081e-08  9.6918118e-10  9.6918118e-09 -1.9383624e-09
  3.8767247e-09  1.9383624e-09  1.1630174e-08  7.7534494e-09
 -1.5506899e-08 -7.7534494e-09  5.8150871e-09  9.6918118e-09
  9.6918118e-09  9.6918118e-09  9.6918118e-09  9.6918118e-09
  9.6918118e-09 -7.7534494e-09]
2025-06-04 15:31:02,810 - DEBUG - Updated reference std: node=[1.0058652 1.0058652 1.0058651 1.0058651 1.0058651 1.0058652 1.0058651
 1.0058652 1.0058652 1.0058652 1.0058651 1.0058651 1.0058651 1.0058652
 1.0058652 1.0058651 1.0058651 1.0058652 1.0058652], edge=[0.3832422 2.5398333 1.00409   1.0040901 1.00409   1.0040901 1.00409
 1.00409   1.00409   1.00409   1.00409   1.00409   1.00409   1.00409
 1.00409   1.00409   1.00409   1.00409   1.00409   1.00409   1.00409
 1.00409  ]
2025-06-04 15:31:02,811 - INFO - Online update complete. Loss: 2.0386
2025-06-04 15:31:02,811 - INFO - Running anomaly detection...
2025-06-04 15:31:02,811 - INFO - Starting anomaly detection.
2025-06-04 15:31:02,905 - DEBUG - Node reconstruction errors: [0.04787367 0.12966815 0.04253041 0.0157335  0.0157335  0.0157335
 0.01573349 0.181578   0.01573349 0.0157335  0.0157335  0.018032
 0.05925069 0.018032   0.018032   0.05925071 1.1216428  0.02187853
 0.02187855 0.03561544 0.13582641 0.04457779 0.02562316 0.0157335
 0.04457769 0.02562323 0.04457769 0.08027518 0.05223124 0.3553712
 2.2928302  0.08725628 0.04457779 0.04457769 2.1470585  0.04457769
 0.8839075  0.04457779 0.04457779 0.03561544 0.0157335  0.02562316
 0.08412661 0.02187852 0.02562323 0.04457779 0.04457778 0.018032
 0.0462516  0.02562316 0.11568782 0.03553371 1.3055476  1.7297404
 0.04457779 0.02562317 0.02562316 0.03553367 0.04457779 0.0462516
 0.02187853 0.02562323 0.02187852 0.23203094 0.14216118 0.59234303
 0.02562316 0.02562316 0.03561544 0.02562323 0.12509942 0.02562323
 0.0157335  0.02562316 0.02562316 0.018032   0.018032   0.04457779
 0.02562323 0.01803201 0.02562323 1.2272207  0.09288412 0.02562316
 0.02562318 0.01803206]
2025-06-04 15:31:02,906 - DEBUG - Edge reconstruction errors: [0.19999999 0.6510265  0.6413149  0.6549597  0.66510195 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.75928855
 0.7600457  0.7905661  0.78490216 0.7680844  0.76564646 0.78914136
 0.7923466  0.7926098  0.7674604  0.7872944  0.7849495  0.79583675
 0.79575294 0.79577833 0.79580045 0.1980204  0.79599535 0.7958434
 0.7979224  0.7980125  0.19356596 0.73848164 0.7697751  0.5907275
 0.7668898  0.5756402  0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.7712052  0.79937726 0.7992741  0.7604876  0.76669616
 0.7658853  0.7637408  0.7640056  0.7906795  0.7866468  0.78644156
 0.7999985  0.79999864 0.7999986  0.7999988  0.7863134  0.7877007
 0.7660205  0.76396614 0.7983815  0.7980342  0.7644494  0.7984911
 0.7992337  0.79933447 0.18872416 0.7848878  0.79823714 0.79807436
 0.7852977  0.79808706 0.798155   0.79696655 0.797866   0.79791456
 0.79798657 0.7978673  0.79815733 0.798171   0.7980391  0.78490186
 0.7997918  0.7998015  0.79977095 0.7998899  0.799897   0.7997792
 0.7997614  0.7999693  0.7999706  0.79996705 0.79996926 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999987 0.19999999 0.19762719 0.7993344
 0.7994076  0.7993609  0.7986435  0.7981939  0.7986329  0.7997786
 0.7998345  0.01323384 0.00474858 0.79748744 0.7989052  0.79983264
 0.8        0.8        0.19999987]
2025-06-04 15:31:02,908 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153102_update_16.json
2025-06-04 15:31:02,908 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:31:02,933 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153102_update_16.pth and as latest_checkpoint.pth
2025-06-04 15:31:02,933 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028444.dot): 0.0000
2025-06-04 15:31:02,933 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:31:02,933 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.2928, MLP Score: 0.0000
2025-06-04 15:31:02,933 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.1471, MLP Score: 0.0000
2025-06-04 15:31:02,933 - WARNING -   Node ID: 192.168.209.128, Recon Error: 1.3055, MLP Score: 0.0000
2025-06-04 15:31:02,933 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7297, MLP Score: 0.0000
2025-06-04 15:31:02,933 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:31:02,938 - INFO - Starting 3D embedding visualization...
2025-06-04 15:31:03,164 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b8e0e240> <matplotlib.colors.Normalize object at 0x7be7b8e0e240>
2025-06-04 15:31:03,166 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b8e0ede0>
2025-06-04 15:31:03,167 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x7be7b8e0e240> <matplotlib.colors.Normalize object at 0x7be7b8e0e240>
2025-06-04 15:31:03,169 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b8e0ede0>
2025-06-04 15:31:03,172 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b8e0c650>
2025-06-04 15:31:03,306 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_16_updates_20250604_153102.png
2025-06-04 15:31:03,306 - INFO - Performing visualization of node and edge features.
2025-06-04 15:31:03,306 - INFO - Starting visualization of node features.
2025-06-04 15:31:03,307 - INFO - Graph has 86 nodes and 19 features.
2025-06-04 15:31:03,307 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:31:03,307 - INFO - Calculating feature statistics:
2025-06-04 15:31:03,307 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-7.62385e-09), 'std': np.float32(1.0), 'min': np.float32(-0.30137107), 'max': np.float32(3.3576283)}
2025-06-04 15:31:03,307 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(7.62385e-09), 'std': np.float32(1.0), 'min': np.float32(-3.3576283), 'max': np.float32(0.30137107)}
2025-06-04 15:31:03,307 - INFO - - server_score: {'name': 'server_score', 'unique': 7, 'mean': np.float32(5.1980793e-09), 'std': np.float32(1.0), 'min': np.float32(-1.9110792), 'max': np.float32(5.387343)}
2025-06-04 15:31:03,307 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(9.703082e-09), 'std': np.float32(1.0), 'min': np.float32(-0.25325322), 'max': np.float32(5.770381)}
2025-06-04 15:31:03,307 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(-6.2376952e-09), 'std': np.float32(1.0), 'min': np.float32(-0.29767027), 'max': np.float32(3.3594217)}
2025-06-04 15:31:03,307 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 7, 'mean': np.float32(3.8812328e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.28678852), 'max': np.float32(4.714926)}
2025-06-04 15:31:03,307 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 7, 'mean': np.float32(2.079232e-09), 'std': np.float32(0.9999999), 'min': np.float32(-6.1361055), 'max': np.float32(0.26449224)}
2025-06-04 15:31:03,307 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 7, 'mean': np.float32(3.7426172e-08), 'std': np.float32(1.0), 'min': np.float32(-0.26090914), 'max': np.float32(5.5563984)}
2025-06-04 15:31:03,307 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(-4.245098e-09), 'std': np.float32(1.0), 'min': np.float32(-1.8507411), 'max': np.float32(7.623291)}
2025-06-04 15:31:03,307 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(-6.9307726e-10), 'std': np.float32(1.0), 'min': np.float32(-0.27052203), 'max': np.float32(4.503442)}
2025-06-04 15:31:03,307 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 7, 'mean': np.float32(-1.3861545e-09), 'std': np.float32(0.9999999), 'min': np.float32(-2.4945657), 'max': np.float32(0.5372434)}
2025-06-04 15:31:03,307 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(3.6040017e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.3202563), 'max': np.float32(3.122499)}
2025-06-04 15:31:03,308 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(6.9307726e-10), 'std': np.float32(1.0), 'min': np.float32(-3.3594217), 'max': np.float32(0.29767027)}
2025-06-04 15:31:03,308 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(4.8515407e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.3944428), 'max': np.float32(1.0813397)}
2025-06-04 15:31:03,308 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(-2.772309e-09), 'std': np.float32(1.0), 'min': np.float32(-1.0439212), 'max': np.float32(2.5674148)}
2025-06-04 15:31:03,308 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(-5.891157e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7998327), 'max': np.float32(1.406564)}
2025-06-04 15:31:03,308 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(1.039616e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7746291), 'max': np.float32(1.4229847)}
2025-06-04 15:31:03,308 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 8, 'mean': np.float32(-2.8416167e-08), 'std': np.float32(1.0), 'min': np.float32(-3.2564967), 'max': np.float32(0.35554487)}
2025-06-04 15:31:03,308 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 8, 'mean': np.float32(-2.079232e-09), 'std': np.float32(1.0), 'min': np.float32(-1.9404645), 'max': np.float32(2.7493563)}
2025-06-04 15:31:03,318 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7be7b8d52270>
2025-06-04 15:31:03,592 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:31:03,625 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:31:03,643 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:31:04,812 - INFO - Node feature visualization saved to vis/node_features_20250604_153103.png
2025-06-04 15:31:04,812 - INFO - Finished visualization of node features.
2025-06-04 15:31:04,812 - INFO - Performing additional feature analysis:
2025-06-04 15:31:04,812 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 15:31:04,812 - INFO - Starting visualization of edge features.
2025-06-04 15:31:04,813 - INFO - Graph has 123 edges and 22 edge features.
2025-06-04 15:31:04,813 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:31:04,813 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:31:04,813 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:31:04,813 - INFO - 
--- Processing file: nw_graph_encoded_1749028459.dot ---
2025-06-04 15:31:04,813 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028459.dot
2025-06-04 15:31:04,813 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028459.dot file.
2025-06-04 15:31:04,817 - INFO - Parsed 105 nodes.
2025-06-04 15:31:04,819 - INFO - Parsed 157 edges.
2025-06-04 15:31:04,825 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:31:04,825 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:31:04,826 - DEBUG - Initial node features tensor shape: torch.Size([105, 19])
2025-06-04 15:31:04,826 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:31:04,827 - DEBUG - Node features tensor shape after scaling: torch.Size([105, 19])
2025-06-04 15:31:04,827 - DEBUG - Edge index tensor shape: torch.Size([2, 157])
2025-06-04 15:31:04,827 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:31:04,828 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:31:04,828 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:31:04,828 - DEBUG - Shape of encoded categorical edge features: torch.Size([157, 2])
2025-06-04 15:31:04,829 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:31:04,829 - DEBUG - Shape of scaled numerical edge features: torch.Size([157, 20])
2025-06-04 15:31:04,829 - DEBUG - Final edge attributes tensor shape: torch.Size([157, 22])
2025-06-04 15:31:04,829 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:31:04,829 - INFO - Performing online update...
2025-06-04 15:31:04,829 - INFO - Starting online update for 50 steps.
2025-06-04 15:31:04,830 - DEBUG - Updated RunningStats: new_mean=[ 5.42290753e-10 -5.21382539e-10 -2.15239937e-09  2.34955893e-09
 -2.71108168e-08  1.46190446e-08 -1.05406213e-08 -2.32324556e-09
 -3.07856838e-09  9.33171078e-10  1.68721212e-09 -1.65032680e-09
  4.02102964e-09 -3.49597525e-09  9.30543979e-10  9.47165281e-10
 -4.01643884e-09  1.44166739e-09 -5.26665074e-09], new_M2=[175835.00520168 175835.00512775 175835.00031549 175835.00399025
 175834.99874204 175834.998385   175834.99621283 175834.99840636
 175834.99347799 175834.99831539 175835.00185322 175834.99392878
 175834.99277103 140136.99643945 140137.00027256 140136.99903701
 140137.00007809 175835.00043795 175835.00737878], new_n=175835
2025-06-04 15:31:04,830 - DEBUG - Updated RunningStats: new_mean=[ 1.41751235e+00  5.52065750e+00  1.14140729e-10  3.22958040e-10
  1.59821309e-10 -1.56387157e-10 -1.35537907e-09  3.09600749e-10
  3.75720138e-10 -3.16172596e-10  4.82836036e-10 -3.97906784e-09
 -8.86640829e-10  8.48507652e-10  3.97146061e-10 -1.73267160e-10
 -1.73267160e-10 -1.73267160e-10 -1.73267160e-10 -1.73267160e-10
 -1.73267160e-10 -6.76767624e-11], new_M2=[  97367.13145464 1683780.60719391  379377.99911507  379378.00678907
  379378.00559661  379377.9937816   379378.00029194  379377.99927292
  379378.00169246  379377.99936343  379377.99378681  379378.00892996
  379378.0011467   379377.99966233  379378.0019562   379377.99451299
  379377.99451299  379377.99451299  379377.99451299  379377.99451299
  379377.99451299  379377.99960526], new_n=379378
2025-06-04 15:31:04,830 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.00000001 0.99999998
 0.99999998 0.89273742 0.89273743 0.89273743 0.89273743 1.
 1.00000002]
2025-06-04 15:31:04,830 - DEBUG - Calculated standard deviation: [0.50660575 2.10671933 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:31:04,831 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:31:04,831 - DEBUG - Online update step: 1/50
2025-06-04 15:31:04,831 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:04,831 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:04,831 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:04,832 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:04,832 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,832 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:04,832 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:04,832 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:04,833 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:04,834 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,834 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:04,834 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:04,861 - DEBUG - Node anomaly scores shape: torch.Size([923, 1])
2025-06-04 15:31:04,864 - DEBUG - Edge anomaly scores shape: torch.Size([1126, 1])
2025-06-04 15:31:04,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:04,864 - DEBUG - Node reconstruction loss: 0.7301
2025-06-04 15:31:04,950 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8457
2025-06-04 15:31:04,954 - DEBUG - Step 1: Loss=0.5914
2025-06-04 15:31:04,954 - DEBUG - Online update step: 2/50
2025-06-04 15:31:04,954 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:04,955 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:04,955 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,955 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:04,956 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:04,956 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:04,956 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:04,956 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:04,957 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:04,957 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:04,957 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:04,957 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:04,958 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:04,958 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:04,958 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:04,958 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:04,959 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:04,994 - DEBUG - Node anomaly scores shape: torch.Size([906, 1])
2025-06-04 15:31:04,996 - DEBUG - Edge anomaly scores shape: torch.Size([1113, 1])
2025-06-04 15:31:04,997 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:04,997 - DEBUG - Node reconstruction loss: 0.6621
2025-06-04 15:31:05,216 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8244
2025-06-04 15:31:05,219 - DEBUG - Step 2: Loss=0.5363
2025-06-04 15:31:05,219 - DEBUG - Online update step: 3/50
2025-06-04 15:31:05,220 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:31:05,220 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,221 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,221 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:05,221 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,222 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:05,222 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,222 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,222 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,223 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:05,223 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,223 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,224 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:05,224 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:05,224 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,224 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:05,226 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:05,260 - DEBUG - Node anomaly scores shape: torch.Size([902, 1])
2025-06-04 15:31:05,262 - DEBUG - Edge anomaly scores shape: torch.Size([1133, 1])
2025-06-04 15:31:05,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:05,263 - DEBUG - Node reconstruction loss: 0.6527
2025-06-04 15:31:05,334 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8625
2025-06-04 15:31:05,337 - DEBUG - Step 3: Loss=0.5287
2025-06-04 15:31:05,337 - DEBUG - Online update step: 4/50
2025-06-04 15:31:05,338 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,338 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:05,338 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:05,338 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:05,339 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,339 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:05,339 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:05,339 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,340 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:05,340 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,340 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:05,340 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,341 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:05,341 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,341 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,341 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:31:05,342 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:05,374 - DEBUG - Node anomaly scores shape: torch.Size([900, 1])
2025-06-04 15:31:05,377 - DEBUG - Edge anomaly scores shape: torch.Size([1101, 1])
2025-06-04 15:31:05,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:05,378 - DEBUG - Node reconstruction loss: 0.5880
2025-06-04 15:31:05,463 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8362
2025-06-04 15:31:05,481 - DEBUG - Step 4: Loss=0.4763
2025-06-04 15:31:05,482 - DEBUG - Online update step: 5/50
2025-06-04 15:31:05,482 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,483 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,483 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,484 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,484 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,484 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:05,485 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:05,485 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,485 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,485 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,487 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,487 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:31:05,487 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,487 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:05,488 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,488 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:05,489 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:05,584 - DEBUG - Node anomaly scores shape: torch.Size([935, 1])
2025-06-04 15:31:05,590 - DEBUG - Edge anomaly scores shape: torch.Size([1147, 1])
2025-06-04 15:31:05,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:05,591 - DEBUG - Node reconstruction loss: 0.5842
2025-06-04 15:31:05,675 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8847
2025-06-04 15:31:05,681 - DEBUG - Step 5: Loss=0.4732
2025-06-04 15:31:05,681 - DEBUG - Online update step: 6/50
2025-06-04 15:31:05,682 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:05,682 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:05,683 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:05,683 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,683 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:05,684 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:05,684 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,684 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,686 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:05,687 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,687 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,687 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,688 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:05,688 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:05,688 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:05,689 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:05,690 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:05,787 - DEBUG - Node anomaly scores shape: torch.Size([935, 1])
2025-06-04 15:31:05,801 - DEBUG - Edge anomaly scores shape: torch.Size([1158, 1])
2025-06-04 15:31:05,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:05,802 - DEBUG - Node reconstruction loss: 0.6025
2025-06-04 15:31:05,924 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8435
2025-06-04 15:31:05,984 - DEBUG - Step 6: Loss=0.4881
2025-06-04 15:31:05,984 - DEBUG - Online update step: 7/50
2025-06-04 15:31:05,984 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,985 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:05,985 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:05,986 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,986 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:05,986 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:05,986 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,987 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:05,987 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:05,987 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:05,988 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:05,988 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,988 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:05,988 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:05,989 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:05,989 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:05,991 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:06,032 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:06,035 - DEBUG - Edge anomaly scores shape: torch.Size([1086, 1])
2025-06-04 15:31:06,035 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:06,036 - DEBUG - Node reconstruction loss: 0.5874
2025-06-04 15:31:06,123 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8860
2025-06-04 15:31:06,126 - DEBUG - Step 7: Loss=0.4758
2025-06-04 15:31:06,126 - DEBUG - Online update step: 8/50
2025-06-04 15:31:06,126 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:06,127 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:06,127 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:06,127 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,128 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:06,128 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:06,128 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:06,129 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:06,129 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:06,129 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:06,129 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:06,130 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:06,130 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,130 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,130 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:06,130 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:06,132 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:06,234 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:06,240 - DEBUG - Edge anomaly scores shape: torch.Size([1083, 1])
2025-06-04 15:31:06,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:06,242 - DEBUG - Node reconstruction loss: 0.5449
2025-06-04 15:31:06,338 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8460
2025-06-04 15:31:06,348 - DEBUG - Step 8: Loss=0.4413
2025-06-04 15:31:06,348 - DEBUG - Online update step: 9/50
2025-06-04 15:31:06,349 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:06,349 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:06,350 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:06,350 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:06,350 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,351 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,351 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:06,351 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,351 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:06,352 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:06,352 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,352 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:06,352 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:06,353 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:06,353 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:06,353 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,354 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:06,447 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:06,459 - DEBUG - Edge anomaly scores shape: torch.Size([1030, 1])
2025-06-04 15:31:06,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:06,463 - DEBUG - Node reconstruction loss: 0.5790
2025-06-04 15:31:06,638 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7788
2025-06-04 15:31:06,690 - DEBUG - Step 9: Loss=0.4690
2025-06-04 15:31:06,690 - DEBUG - Online update step: 10/50
2025-06-04 15:31:06,691 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:06,691 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:06,692 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:06,692 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,692 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,693 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,693 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:06,693 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:06,694 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:06,694 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:06,694 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:06,694 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,695 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:06,695 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:06,695 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,696 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:06,697 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:06,742 - DEBUG - Node anomaly scores shape: torch.Size([923, 1])
2025-06-04 15:31:06,746 - DEBUG - Edge anomaly scores shape: torch.Size([1131, 1])
2025-06-04 15:31:06,746 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:06,747 - DEBUG - Node reconstruction loss: 0.5201
2025-06-04 15:31:06,851 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8703
2025-06-04 15:31:06,868 - DEBUG - Step 10: Loss=0.4213
2025-06-04 15:31:06,868 - DEBUG - Online update step: 11/50
2025-06-04 15:31:06,869 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:06,869 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:06,870 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:06,870 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,870 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:06,871 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:06,871 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:06,871 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:06,872 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:06,872 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:06,872 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:06,873 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:06,876 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-04 15:31:06,876 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:06,877 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:06,877 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:06,878 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:07,008 - DEBUG - Node anomaly scores shape: torch.Size([933, 1])
2025-06-04 15:31:07,015 - DEBUG - Edge anomaly scores shape: torch.Size([1150, 1])
2025-06-04 15:31:07,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:07,016 - DEBUG - Node reconstruction loss: 0.5377
2025-06-04 15:31:07,239 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8494
2025-06-04 15:31:07,242 - DEBUG - Step 11: Loss=0.4356
2025-06-04 15:31:07,243 - DEBUG - Online update step: 12/50
2025-06-04 15:31:07,243 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:07,244 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:07,244 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:07,244 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-04 15:31:07,245 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:07,245 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:07,245 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,246 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:07,246 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:07,246 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:07,247 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:07,247 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:07,247 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,247 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:07,248 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:07,248 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:07,249 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:07,371 - DEBUG - Node anomaly scores shape: torch.Size([933, 1])
2025-06-04 15:31:07,378 - DEBUG - Edge anomaly scores shape: torch.Size([1143, 1])
2025-06-04 15:31:07,380 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:07,382 - DEBUG - Node reconstruction loss: 0.5093
2025-06-04 15:31:07,600 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8468
2025-06-04 15:31:07,605 - DEBUG - Step 12: Loss=0.4126
2025-06-04 15:31:07,605 - DEBUG - Online update step: 13/50
2025-06-04 15:31:07,606 - DEBUG - Applied edge dropout: 19 edges dropped.
2025-06-04 15:31:07,606 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:07,606 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:07,607 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,608 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:07,608 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:07,608 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,609 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:07,609 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:07,609 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:07,610 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:07,610 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:07,610 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:07,610 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:07,611 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,611 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,612 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:07,650 - DEBUG - Node anomaly scores shape: torch.Size([923, 1])
2025-06-04 15:31:07,653 - DEBUG - Edge anomaly scores shape: torch.Size([1135, 1])
2025-06-04 15:31:07,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:07,654 - DEBUG - Node reconstruction loss: 0.5089
2025-06-04 15:31:07,732 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9098
2025-06-04 15:31:07,735 - DEBUG - Step 13: Loss=0.4122
2025-06-04 15:31:07,735 - DEBUG - Online update step: 14/50
2025-06-04 15:31:07,736 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:07,736 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:07,736 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:07,737 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:07,737 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:07,737 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,738 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,738 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:07,738 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:07,738 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:07,739 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:07,739 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:07,739 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:07,739 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:07,740 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:07,740 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:07,741 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:07,774 - DEBUG - Node anomaly scores shape: torch.Size([884, 1])
2025-06-04 15:31:07,776 - DEBUG - Edge anomaly scores shape: torch.Size([1081, 1])
2025-06-04 15:31:07,777 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:07,777 - DEBUG - Node reconstruction loss: 0.5151
2025-06-04 15:31:07,996 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8929
2025-06-04 15:31:08,010 - DEBUG - Step 14: Loss=0.4172
2025-06-04 15:31:08,010 - DEBUG - Online update step: 15/50
2025-06-04 15:31:08,011 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,016 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,016 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:08,017 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,017 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:08,017 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:08,017 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:08,018 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:08,022 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:08,022 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,023 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-04 15:31:08,023 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:08,024 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:08,024 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,024 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,025 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:08,026 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:08,115 - DEBUG - Node anomaly scores shape: torch.Size([900, 1])
2025-06-04 15:31:08,124 - DEBUG - Edge anomaly scores shape: torch.Size([1119, 1])
2025-06-04 15:31:08,128 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:08,130 - DEBUG - Node reconstruction loss: 0.5372
2025-06-04 15:31:08,381 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9239
2025-06-04 15:31:08,387 - DEBUG - Step 15: Loss=0.4352
2025-06-04 15:31:08,388 - DEBUG - Online update step: 16/50
2025-06-04 15:31:08,388 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,389 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,389 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,389 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:08,390 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,390 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:08,393 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:08,394 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:08,395 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:08,395 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:08,396 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,396 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,397 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,398 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,398 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,398 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,400 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:08,467 - DEBUG - Node anomaly scores shape: torch.Size([884, 1])
2025-06-04 15:31:08,471 - DEBUG - Edge anomaly scores shape: torch.Size([1098, 1])
2025-06-04 15:31:08,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:08,472 - DEBUG - Node reconstruction loss: 0.5037
2025-06-04 15:31:08,569 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8541
2025-06-04 15:31:08,572 - DEBUG - Step 16: Loss=0.4080
2025-06-04 15:31:08,572 - DEBUG - Online update step: 17/50
2025-06-04 15:31:08,573 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,573 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:08,574 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:08,574 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:08,574 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,574 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,575 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:08,575 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:08,575 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:08,576 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,576 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:08,576 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,576 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:08,577 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:08,577 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:08,577 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,578 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:08,706 - DEBUG - Node anomaly scores shape: torch.Size([906, 1])
2025-06-04 15:31:08,711 - DEBUG - Edge anomaly scores shape: torch.Size([1110, 1])
2025-06-04 15:31:08,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:08,712 - DEBUG - Node reconstruction loss: 0.4595
2025-06-04 15:31:08,849 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5967
2025-06-04 15:31:08,858 - DEBUG - Step 17: Loss=0.3722
2025-06-04 15:31:08,858 - DEBUG - Online update step: 18/50
2025-06-04 15:31:08,859 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:08,859 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,860 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:08,860 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:08,860 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,861 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:08,861 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:08,861 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:08,861 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,862 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:08,862 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:08,862 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:08,863 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:08,863 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:08,863 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:08,863 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:08,864 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:08,919 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:08,945 - DEBUG - Edge anomaly scores shape: torch.Size([1085, 1])
2025-06-04 15:31:08,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:08,946 - DEBUG - Node reconstruction loss: 0.4612
2025-06-04 15:31:09,256 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5960
2025-06-04 15:31:09,259 - DEBUG - Step 18: Loss=0.3736
2025-06-04 15:31:09,259 - DEBUG - Online update step: 19/50
2025-06-04 15:31:09,260 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:09,260 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:09,261 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:09,261 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,261 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,262 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:09,262 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,262 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:09,262 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,263 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:09,263 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:09,263 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,264 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,264 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:09,264 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:09,264 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:09,266 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:09,303 - DEBUG - Node anomaly scores shape: torch.Size([896, 1])
2025-06-04 15:31:09,306 - DEBUG - Edge anomaly scores shape: torch.Size([1105, 1])
2025-06-04 15:31:09,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:09,306 - DEBUG - Node reconstruction loss: 0.4744
2025-06-04 15:31:09,400 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8235
2025-06-04 15:31:09,403 - DEBUG - Step 19: Loss=0.3843
2025-06-04 15:31:09,403 - DEBUG - Online update step: 20/50
2025-06-04 15:31:09,404 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,404 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:09,405 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,405 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,405 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,406 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,406 - DEBUG - Applied edge dropout: 21 edges dropped.
2025-06-04 15:31:09,406 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:09,406 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,407 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,407 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:09,407 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:09,407 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:09,408 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:09,408 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,408 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:09,409 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:09,442 - DEBUG - Node anomaly scores shape: torch.Size([941, 1])
2025-06-04 15:31:09,445 - DEBUG - Edge anomaly scores shape: torch.Size([1156, 1])
2025-06-04 15:31:09,445 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:09,446 - DEBUG - Node reconstruction loss: 0.4419
2025-06-04 15:31:09,628 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6505
2025-06-04 15:31:09,636 - DEBUG - Step 20: Loss=0.3579
2025-06-04 15:31:09,636 - DEBUG - Online update step: 21/50
2025-06-04 15:31:09,637 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:09,638 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,639 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:09,640 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,640 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,641 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:09,642 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:09,643 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,643 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:09,644 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,645 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:09,645 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,646 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,647 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:09,647 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:09,648 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,650 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:09,692 - DEBUG - Node anomaly scores shape: torch.Size([886, 1])
2025-06-04 15:31:09,696 - DEBUG - Edge anomaly scores shape: torch.Size([1102, 1])
2025-06-04 15:31:09,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:09,697 - DEBUG - Node reconstruction loss: 0.4473
2025-06-04 15:31:09,774 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5906
2025-06-04 15:31:09,781 - DEBUG - Step 21: Loss=0.3623
2025-06-04 15:31:09,781 - DEBUG - Online update step: 22/50
2025-06-04 15:31:09,782 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:09,783 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:09,784 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,784 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:09,785 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:09,786 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:09,786 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:09,787 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:09,788 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,788 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:09,789 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:09,789 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:09,790 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:09,791 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,791 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:09,792 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:09,794 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:09,864 - DEBUG - Node anomaly scores shape: torch.Size([923, 1])
2025-06-04 15:31:09,878 - DEBUG - Edge anomaly scores shape: torch.Size([1132, 1])
2025-06-04 15:31:09,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:09,883 - DEBUG - Node reconstruction loss: 0.4232
2025-06-04 15:31:10,074 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5283
2025-06-04 15:31:10,081 - DEBUG - Step 22: Loss=0.3428
2025-06-04 15:31:10,081 - DEBUG - Online update step: 23/50
2025-06-04 15:31:10,093 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:10,093 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:10,094 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:10,094 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:10,094 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:10,095 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:10,095 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:10,095 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,096 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:10,096 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:10,096 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:10,097 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,097 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,101 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,101 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,102 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,103 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:10,171 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:10,174 - DEBUG - Edge anomaly scores shape: torch.Size([1075, 1])
2025-06-04 15:31:10,175 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:10,175 - DEBUG - Node reconstruction loss: 0.4219
2025-06-04 15:31:10,270 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6691
2025-06-04 15:31:10,273 - DEBUG - Step 23: Loss=0.3417
2025-06-04 15:31:10,273 - DEBUG - Online update step: 24/50
2025-06-04 15:31:10,274 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:10,274 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,274 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,277 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:10,279 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:10,280 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,281 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:10,282 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:10,284 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:10,284 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,285 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:10,285 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:10,286 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,286 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:10,286 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,286 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:10,288 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:10,411 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:10,414 - DEBUG - Edge anomaly scores shape: torch.Size([1093, 1])
2025-06-04 15:31:10,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:10,415 - DEBUG - Node reconstruction loss: 0.4187
2025-06-04 15:31:10,686 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9484
2025-06-04 15:31:10,689 - DEBUG - Step 24: Loss=0.3391
2025-06-04 15:31:10,690 - DEBUG - Online update step: 25/50
2025-06-04 15:31:10,690 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:10,690 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,691 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,691 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:10,691 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:10,691 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:10,692 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:10,692 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,692 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,692 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,693 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:10,693 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,693 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:10,693 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,694 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,694 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:10,695 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:10,730 - DEBUG - Node anomaly scores shape: torch.Size([875, 1])
2025-06-04 15:31:10,733 - DEBUG - Edge anomaly scores shape: torch.Size([1091, 1])
2025-06-04 15:31:10,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:10,734 - DEBUG - Node reconstruction loss: 0.4273
2025-06-04 15:31:10,814 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5186
2025-06-04 15:31:10,818 - DEBUG - Step 25: Loss=0.3462
2025-06-04 15:31:10,818 - DEBUG - Online update step: 26/50
2025-06-04 15:31:10,819 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:10,819 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:10,820 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:10,820 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:10,820 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:10,820 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,821 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:10,821 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:10,821 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,822 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:10,822 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:10,822 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:10,822 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:10,823 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:31:10,824 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:10,824 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:10,825 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:10,860 - DEBUG - Node anomaly scores shape: torch.Size([913, 1])
2025-06-04 15:31:10,863 - DEBUG - Edge anomaly scores shape: torch.Size([1130, 1])
2025-06-04 15:31:10,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:10,864 - DEBUG - Node reconstruction loss: 0.4266
2025-06-04 15:31:11,047 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.9317
2025-06-04 15:31:11,051 - DEBUG - Step 26: Loss=0.3455
2025-06-04 15:31:11,051 - DEBUG - Online update step: 27/50
2025-06-04 15:31:11,052 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:11,052 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:11,052 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,053 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,053 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,053 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,054 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:11,054 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,054 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,054 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:11,055 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,055 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,055 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,056 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,056 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:11,056 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,058 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:11,093 - DEBUG - Node anomaly scores shape: torch.Size([886, 1])
2025-06-04 15:31:11,096 - DEBUG - Edge anomaly scores shape: torch.Size([1106, 1])
2025-06-04 15:31:11,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:11,097 - DEBUG - Node reconstruction loss: 0.4035
2025-06-04 15:31:11,197 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5328
2025-06-04 15:31:11,200 - DEBUG - Step 27: Loss=0.3269
2025-06-04 15:31:11,200 - DEBUG - Online update step: 28/50
2025-06-04 15:31:11,201 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:11,201 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,201 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:11,202 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:11,202 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,202 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,202 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,203 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:11,203 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:11,203 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:11,203 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:11,204 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:11,204 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,204 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,204 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,205 - DEBUG - Applied edge dropout: 26 edges dropped.
2025-06-04 15:31:11,206 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:11,238 - DEBUG - Node anomaly scores shape: torch.Size([902, 1])
2025-06-04 15:31:11,241 - DEBUG - Edge anomaly scores shape: torch.Size([1104, 1])
2025-06-04 15:31:11,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:11,241 - DEBUG - Node reconstruction loss: 0.4255
2025-06-04 15:31:11,439 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6120
2025-06-04 15:31:11,443 - DEBUG - Step 28: Loss=0.3447
2025-06-04 15:31:11,443 - DEBUG - Online update step: 29/50
2025-06-04 15:31:11,444 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,444 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,445 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:11,445 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:11,445 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:11,446 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,446 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:11,446 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,447 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:11,447 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:11,447 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,447 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:11,448 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:11,448 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,448 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:11,449 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:11,450 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:11,485 - DEBUG - Node anomaly scores shape: torch.Size([881, 1])
2025-06-04 15:31:11,488 - DEBUG - Edge anomaly scores shape: torch.Size([1099, 1])
2025-06-04 15:31:11,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:11,489 - DEBUG - Node reconstruction loss: 0.3838
2025-06-04 15:31:11,604 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5177
2025-06-04 15:31:11,612 - DEBUG - Step 29: Loss=0.3109
2025-06-04 15:31:11,612 - DEBUG - Online update step: 30/50
2025-06-04 15:31:11,613 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:11,613 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:11,614 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:11,615 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,615 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:11,616 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,616 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:11,616 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,617 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:11,617 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:11,617 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,617 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:11,618 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,618 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:11,618 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,620 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:31:11,622 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:11,715 - DEBUG - Node anomaly scores shape: torch.Size([884, 1])
2025-06-04 15:31:11,735 - DEBUG - Edge anomaly scores shape: torch.Size([1084, 1])
2025-06-04 15:31:11,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:11,736 - DEBUG - Node reconstruction loss: 0.4134
2025-06-04 15:31:11,856 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6540
2025-06-04 15:31:11,864 - DEBUG - Step 30: Loss=0.3348
2025-06-04 15:31:11,864 - DEBUG - Online update step: 31/50
2025-06-04 15:31:11,865 - DEBUG - Applied edge dropout: 20 edges dropped.
2025-06-04 15:31:11,866 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:11,867 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,867 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,868 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,869 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,869 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:11,870 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:11,871 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:11,871 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,872 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:11,873 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:11,873 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:11,874 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:11,875 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:11,875 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:11,878 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:11,930 - DEBUG - Node anomaly scores shape: torch.Size([933, 1])
2025-06-04 15:31:11,934 - DEBUG - Edge anomaly scores shape: torch.Size([1141, 1])
2025-06-04 15:31:11,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:11,935 - DEBUG - Node reconstruction loss: 0.3765
2025-06-04 15:31:12,121 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.6454
2025-06-04 15:31:12,124 - DEBUG - Step 31: Loss=0.3050
2025-06-04 15:31:12,125 - DEBUG - Online update step: 32/50
2025-06-04 15:31:12,125 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,126 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,126 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:12,126 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:12,127 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,127 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,127 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,127 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,128 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,128 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,128 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:12,128 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,129 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:12,129 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,129 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,130 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:12,131 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:12,253 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:31:12,259 - DEBUG - Edge anomaly scores shape: torch.Size([1039, 1])
2025-06-04 15:31:12,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:12,261 - DEBUG - Node reconstruction loss: 0.3560
2025-06-04 15:31:12,373 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5145
2025-06-04 15:31:12,382 - DEBUG - Step 32: Loss=0.2884
2025-06-04 15:31:12,382 - DEBUG - Online update step: 33/50
2025-06-04 15:31:12,383 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,391 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:12,392 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:12,392 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:12,393 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:12,393 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:12,393 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,394 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:12,394 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,396 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:12,399 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:12,400 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:12,401 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,402 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,402 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,403 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:12,405 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:12,514 - DEBUG - Node anomaly scores shape: torch.Size([884, 1])
2025-06-04 15:31:12,522 - DEBUG - Edge anomaly scores shape: torch.Size([1084, 1])
2025-06-04 15:31:12,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:12,529 - DEBUG - Node reconstruction loss: 0.3869
2025-06-04 15:31:12,671 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7590
2025-06-04 15:31:12,728 - DEBUG - Step 33: Loss=0.3134
2025-06-04 15:31:12,728 - DEBUG - Online update step: 34/50
2025-06-04 15:31:12,729 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:12,730 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:31:12,731 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:12,731 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,732 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,733 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:12,734 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,735 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:12,736 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,736 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,737 - DEBUG - Applied edge dropout: 17 edges dropped.
2025-06-04 15:31:12,738 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:12,738 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:31:12,739 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,740 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,740 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,743 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:12,783 - DEBUG - Node anomaly scores shape: torch.Size([941, 1])
2025-06-04 15:31:12,786 - DEBUG - Edge anomaly scores shape: torch.Size([1161, 1])
2025-06-04 15:31:12,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:12,787 - DEBUG - Node reconstruction loss: 0.4100
2025-06-04 15:31:12,890 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5941
2025-06-04 15:31:12,905 - DEBUG - Step 34: Loss=0.3321
2025-06-04 15:31:12,905 - DEBUG - Online update step: 35/50
2025-06-04 15:31:12,906 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:12,906 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:31:12,907 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:31:12,907 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:31:12,907 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:31:12,907 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:12,913 - DEBUG - Applied edge dropout: 16 edges dropped.
2025-06-04 15:31:12,913 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:31:12,914 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:31:12,914 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:31:12,914 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:31:12,914 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:31:12,915 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:31:12,915 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:31:12,915 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:31:12,915 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:31:12,916 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:31:13,018 - DEBUG - Node anomaly scores shape: torch.Size([872, 1])
2025-06-04 15:31:13,029 - DEBUG - Edge anomaly scores shape: torch.Size([1075, 1])
2025-06-04 15:31:13,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:31:13,030 - DEBUG - Node reconstruction loss: 0.3744
