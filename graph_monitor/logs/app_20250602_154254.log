2025-06-02 15:42:54,333 - INFO - Application logging to file: logs/app_20250602_154254.log
2025-06-02 15:42:54,333 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 15:42:54,334 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: False
2025-06-02 15:42:54,334 - INFO - 
--- Processing file: nw_graph_encoded_1748869125.dot (Timestamp: 2025-06-02 14:58:45) ---
2025-06-02 15:42:54,334 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:42:54,334 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:42:54,335 - INFO - Parsed 7 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:42:54,335 - INFO - Parsed 5 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:42:54,335 - DEBUG - Initial graph - Nodes: 7, Edges: 5
2025-06-02 15:42:54,335 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:54,335 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:54,336 - DEBUG - Initial node features tensor shape: torch.Size([7, 30])
2025-06-02 15:42:54,338 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:54,338 - DEBUG - Node features tensor shape after scaling: torch.Size([7, 30])
2025-06-02 15:42:54,339 - DEBUG - Edge index tensor shape: torch.Size([2, 5])
2025-06-02 15:42:54,339 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:54,339 - DEBUG - Initial edge attributes tensor shape: torch.Size([5, 10])
2025-06-02 15:42:54,340 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:54,340 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([5, 10])
2025-06-02 15:42:54,340 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:54,340 - DEBUG - Type of pytorch_data (initial): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:54,340 - INFO - Initialized main graph with 7 nodes and 5 edges.
2025-06-02 15:42:54,341 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 15:42:54,341 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32
2025-06-02 15:42:54,402 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 15:42:54,403 - DEBUG - Decoder MLP layers initialized.
2025-06-02 15:42:54,403 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 15:42:54,403 - INFO - Optimizer and scheduler initialized.
2025-06-02 15:42:54,403 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 15:42:54,403 - INFO - RunningStats initialized.
2025-06-02 15:42:54,403 - INFO - RunningStats initialized.
2025-06-02 15:42:54,403 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 15:42:54,404 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 15:42:54,404 - INFO - Using device: cpu
2025-06-02 15:42:54,404 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-02 15:42:54,404 - INFO - Performing initial training for 50 epochs...
2025-06-02 15:42:54,408 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,408 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,412 - INFO - Epoch 1/50, Loss: 7.2228
2025-06-02 15:42:54,414 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,414 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,414 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,417 - INFO - Epoch 2/50, Loss: 6.9944
2025-06-02 15:42:54,418 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,418 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,421 - INFO - Epoch 3/50, Loss: 6.7726
2025-06-02 15:42:54,422 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,423 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,423 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,425 - INFO - Epoch 4/50, Loss: 6.5435
2025-06-02 15:42:54,427 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,427 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,430 - INFO - Epoch 5/50, Loss: 6.3116
2025-06-02 15:42:54,431 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,432 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,434 - INFO - Epoch 6/50, Loss: 6.0742
2025-06-02 15:42:54,438 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,438 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,441 - INFO - Epoch 7/50, Loss: 5.8258
2025-06-02 15:42:54,443 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,443 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,446 - INFO - Epoch 8/50, Loss: 5.5672
2025-06-02 15:42:54,447 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,448 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,450 - INFO - Epoch 9/50, Loss: 5.3002
2025-06-02 15:42:54,452 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,452 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,453 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,455 - INFO - Epoch 10/50, Loss: 5.0188
2025-06-02 15:42:54,457 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,457 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,460 - INFO - Epoch 11/50, Loss: 4.7363
2025-06-02 15:42:54,462 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,462 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,462 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,465 - INFO - Epoch 12/50, Loss: 4.4561
2025-06-02 15:42:54,466 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,467 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,470 - INFO - Epoch 13/50, Loss: 4.1672
2025-06-02 15:42:54,471 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,471 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,474 - INFO - Epoch 14/50, Loss: 3.8695
2025-06-02 15:42:54,476 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,476 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,479 - INFO - Epoch 15/50, Loss: 3.6189
2025-06-02 15:42:54,481 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,481 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,484 - INFO - Epoch 16/50, Loss: 3.4412
2025-06-02 15:42:54,486 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,486 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,486 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,490 - INFO - Epoch 17/50, Loss: 3.2439
2025-06-02 15:42:54,493 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,493 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,497 - INFO - Epoch 18/50, Loss: 3.0324
2025-06-02 15:42:54,500 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,500 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,505 - INFO - Epoch 19/50, Loss: 2.8099
2025-06-02 15:42:54,508 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,509 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,514 - INFO - Epoch 20/50, Loss: 2.5853
2025-06-02 15:42:54,516 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,517 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,522 - INFO - Epoch 21/50, Loss: 2.3633
2025-06-02 15:42:54,525 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,525 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,526 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,530 - INFO - Epoch 22/50, Loss: 2.1499
2025-06-02 15:42:54,533 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,533 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,549 - INFO - Epoch 23/50, Loss: 1.9517
2025-06-02 15:42:54,555 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,555 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,556 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,564 - INFO - Epoch 24/50, Loss: 1.7751
2025-06-02 15:42:54,572 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,572 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,580 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,589 - INFO - Epoch 25/50, Loss: 1.6209
2025-06-02 15:42:54,603 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,604 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,625 - INFO - Epoch 26/50, Loss: 1.4951
2025-06-02 15:42:54,636 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,637 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,657 - INFO - Epoch 27/50, Loss: 1.4356
2025-06-02 15:42:54,667 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,668 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,675 - INFO - Epoch 28/50, Loss: 1.4441
2025-06-02 15:42:54,678 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,679 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,686 - INFO - Epoch 29/50, Loss: 1.4608
2025-06-02 15:42:54,689 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,690 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,694 - INFO - Epoch 30/50, Loss: 1.4792
2025-06-02 15:42:54,697 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,698 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,698 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,703 - INFO - Epoch 31/50, Loss: 1.4836
2025-06-02 15:42:54,708 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,709 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,713 - INFO - Epoch 32/50, Loss: 1.4681
2025-06-02 15:42:54,726 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,726 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,731 - INFO - Epoch 33/50, Loss: 1.4348
2025-06-02 15:42:54,734 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,734 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,739 - INFO - Epoch 34/50, Loss: 1.3825
2025-06-02 15:42:54,745 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,745 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,746 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,753 - INFO - Epoch 35/50, Loss: 1.3182
2025-06-02 15:42:54,757 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,757 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,764 - INFO - Epoch 36/50, Loss: 1.2514
2025-06-02 15:42:54,766 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,766 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,824 - INFO - Epoch 37/50, Loss: 1.1834
2025-06-02 15:42:54,850 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,852 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,857 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,883 - INFO - Epoch 38/50, Loss: 1.1286
2025-06-02 15:42:54,887 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,888 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,893 - INFO - Epoch 39/50, Loss: 1.1215
2025-06-02 15:42:54,896 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,897 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,910 - INFO - Epoch 40/50, Loss: 1.1151
2025-06-02 15:42:54,915 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,916 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,920 - INFO - Epoch 41/50, Loss: 1.1078
2025-06-02 15:42:54,923 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,923 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,924 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,930 - INFO - Epoch 42/50, Loss: 1.0986
2025-06-02 15:42:54,934 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,936 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,937 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:54,944 - INFO - Epoch 43/50, Loss: 1.0871
2025-06-02 15:42:54,952 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:54,953 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:54,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,016 - INFO - Epoch 44/50, Loss: 1.1003
2025-06-02 15:42:55,033 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,035 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,066 - INFO - Epoch 45/50, Loss: 1.1146
2025-06-02 15:42:55,078 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,080 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,103 - INFO - Epoch 46/50, Loss: 1.1220
2025-06-02 15:42:55,113 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,114 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,132 - INFO - Epoch 47/50, Loss: 1.1202
2025-06-02 15:42:55,141 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,143 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,168 - INFO - Epoch 48/50, Loss: 1.1091
2025-06-02 15:42:55,187 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,189 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,228 - INFO - Epoch 49/50, Loss: 1.0982
2025-06-02 15:42:55,248 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:42:55,250 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:42:55,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:42:55,280 - INFO - Epoch 50/50, Loss: 1.1059
2025-06-02 15:42:55,280 - INFO - Initial training complete.
2025-06-02 15:42:55,313 - ERROR - Error loading checkpoint from model_checkpoints/latest_checkpoint.pth: 'RunningStats' object is not iterable
2025-06-02 15:42:55,314 - INFO - Starting or resuming online updates from step: 0
2025-06-02 15:42:55,314 - WARNING - Node statistics not found in loaded running stats.
2025-06-02 15:42:55,314 - WARNING - Edge statistics not found in loaded running stats.
2025-06-02 15:42:55,314 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-02 15:42:55,314 - INFO - Running anomaly detection...
2025-06-02 15:42:55,314 - INFO - Starting anomaly detection.
2025-06-02 15:42:55,322 - DEBUG - Node reconstruction errors: [0.19872256 1.5111032  1.3970789  0.25396222 0.25396222 0.2535182
 0.23702285]
2025-06-02 15:42:55,323 - DEBUG - Edge reconstruction errors: [ 7.2954245 43.98708   44.206543  44.889122   5.821832 ]
2025-06-02 15:42:55,324 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154255_update_1.json
2025-06-02 15:42:55,324 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:55,350 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154255_update_1.pth and as latest_checkpoint.pth
2025-06-02 15:42:55,350 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869125.dot): 0.9206
2025-06-02 15:42:55,351 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:42:55,351 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:55,354 - DEBUG - Embedding standard deviations before t-SNE: [1.5377618  0.         0.18233335 0.56533265 0.         0.5007919
 1.0559895  0.8818597  0.70116043 0.61182433 1.4007213  0.96974665
 0.8624533  0.79259574 1.3096148  0.5009963  0.0745958  0.6008004
 0.         1.8987912  0.         1.1910807  0.         0.
 0.59529406 0.22221805 0.         0.62217337 0.39216045 0.
 0.80665445 0.73203826]
2025-06-02 15:42:55,553 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-02 15:42:55,673 - INFO - Embeddings visualization saved to vis/embeddings_1_updates_20250602_154255.png
2025-06-02 15:42:55,673 - INFO - Performing visualization of node and edge features.
2025-06-02 15:42:55,673 - INFO - Starting visualization of node features.
2025-06-02 15:42:55,674 - INFO - Graph has 7 nodes and 30 features.
2025-06-02 15:42:55,674 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:42:55,674 - INFO - Calculating feature statistics:
2025-06-02 15:42:55,674 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,674 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,675 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 2, 'mean': np.float32(3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5811388), 'max': np.float32(0.6324556)}
2025-06-02 15:42:55,675 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,675 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,675 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 2, 'mean': np.float32(2.5714285), 'std': np.float32(0.9035079), 'min': np.float32(2.0), 'max': np.float32(4.0)}
2025-06-02 15:42:55,675 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.4285715), 'std': np.float32(0.9035078), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:42:55,675 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:42:55,675 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 1, 'mean': np.float32(5.0), 'std': np.float32(0.0), 'min': np.float32(5.0), 'max': np.float32(5.0)}
2025-06-02 15:42:55,675 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:42:55,675 - INFO - - service_1: {'name': 'service_1', 'unique': 3, 'mean': np.float32(2.0), 'std': np.float32(0.75592893), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:42:55,675 - INFO - - service_2: {'name': 'service_2', 'unique': 2, 'mean': np.float32(7.142857), 'std': np.float32(2.0995626), 'min': np.float32(2.0), 'max': np.float32(8.0)}
2025-06-02 15:42:55,675 - INFO - - service_3: {'name': 'service_3', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:42:55,675 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:42:55,675 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(6.0), 'std': np.float32(3.1622777), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:42:55,675 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:42:55,676 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:42:55,676 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,676 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,676 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,676 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,676 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,676 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:55,694 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c1b0e5940>
2025-06-02 15:42:55,818 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:42:55,900 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:42:55,935 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:42:57,105 - INFO - Node feature visualization saved to vis/node_features_20250602_154256.png
2025-06-02 15:42:57,105 - INFO - Finished visualization of node features.
2025-06-02 15:42:57,105 - INFO - Performing additional feature analysis:
2025-06-02 15:42:57,105 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:42:57,105 - INFO - Starting visualization of edge features.
2025-06-02 15:42:57,105 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:42:57,105 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:42:57,105 - INFO - Calculating edge feature statistics:
2025-06-02 15:42:57,106 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:42:57,106 - INFO - - count: {'name': 'count', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5), 'max': np.float32(2.0)}
2025-06-02 15:42:57,106 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(292.4), 'std': np.float32(184.64409), 'min': np.float32(53.0), 'max': np.float32(443.0)}
2025-06-02 15:42:57,106 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:57,106 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:57,106 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.9816251), 'max': np.float32(0.66214883)}
2025-06-02 15:42:57,106 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 5, 'mean': np.float32(-2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3328124), 'max': np.float32(1.2915914)}
2025-06-02 15:42:57,106 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 5, 'mean': np.float32(2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.94280905), 'max': np.float32(1.8856181)}
2025-06-02 15:42:57,106 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 5, 'mean': np.float32(-1.1920929e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9906747), 'max': np.float32(1.7452797)}
2025-06-02 15:42:57,106 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.9290494), 'max': np.float32(1.7669864)}
2025-06-02 15:42:57,106 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 4, 'mean': np.float32(4.7683717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0758876), 'max': np.float32(1.2000285)}
2025-06-02 15:42:57,117 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c180e47d0>
2025-06-02 15:42:57,155 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:42:57,166 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c1821b5f0>
2025-06-02 15:42:57,219 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:42:57,297 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:42:57,454 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:42:57,471 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:42:57,478 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:42:58,705 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154257.png
2025-06-02 15:42:58,705 - INFO - Finished visualization of edge features.
2025-06-02 15:42:58,705 - INFO - Performing additional edge feature analysis:
2025-06-02 15:42:58,705 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:42:58,705 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:42:58,706 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:42:58,706 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:42:58,706 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:42:59,013 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154258_summary.png
2025-06-02 15:42:59,207 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154258_pca_3d.png
2025-06-02 15:42:59,384 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154258_pca_variance.png
2025-06-02 15:42:59,384 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:42:59,384 - INFO - 
--- Processing file: nw_graph_encoded_1748869155.dot (Timestamp: 2025-06-02 14:59:15) ---
2025-06-02 15:42:59,385 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:42:59,385 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:42:59,385 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:42:59,387 - INFO - Parsed 19 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:42:59,388 - INFO - Parsed 26 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:42:59,388 - INFO - Processing node updates/additions.
2025-06-02 15:42:59,388 - INFO - Processing edge updates/additions.
2025-06-02 15:42:59,388 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:42:59,388 - INFO - Finished updating NetworkX graph.
2025-06-02 15:42:59,388 - DEBUG - Updated graph - Nodes: 19, Edges: 26
2025-06-02 15:42:59,388 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:59,388 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:59,388 - DEBUG - Initial node features tensor shape: torch.Size([19, 30])
2025-06-02 15:42:59,389 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:59,389 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 30])
2025-06-02 15:42:59,389 - DEBUG - Edge index tensor shape: torch.Size([2, 26])
2025-06-02 15:42:59,389 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:59,389 - DEBUG - Initial edge attributes tensor shape: torch.Size([26, 10])
2025-06-02 15:42:59,390 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:59,390 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([26, 10])
2025-06-02 15:42:59,390 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:59,390 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:59,390 - INFO - Updated main graph to 19 nodes and 26 edges.
2025-06-02 15:42:59,390 - INFO - Performing online update...
2025-06-02 15:42:59,390 - INFO - Starting online update for 25 steps.
2025-06-02 15:42:59,391 - DEBUG - Initialized RunningStats with first batch: mean=1.1263157971072615, var=5.449233648754995, n=30
2025-06-02 15:42:59,391 - DEBUG - Updated RunningStats: new_mean=0.9033028665864676, new_var=177.90182608402392, new_n=60
2025-06-02 15:42:59,391 - DEBUG - Initialized RunningStats with first batch: mean=31.034616081072727, var=8668.326562534163, n=10
2025-06-02 15:42:59,391 - DEBUG - Updated RunningStats: new_mean=26.518711902774292, new_var=127579.09591087713, new_n=20
2025-06-02 15:42:59,391 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:42:59,391 - DEBUG - Online update step: 1/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 2/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 3/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 4/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 5/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 6/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 7/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 8/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 9/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 10/25
2025-06-02 15:42:59,391 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,391 - DEBUG - Online update step: 11/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 12/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 13/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 14/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 15/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 16/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 17/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 18/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 19/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 20/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 21/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 22/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 23/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 24/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - DEBUG - Online update step: 25/25
2025-06-02 15:42:59,392 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,392 - WARNING - No successful steps during online update.
2025-06-02 15:42:59,392 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], current edge mean: [-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:42:59,393 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], edge=[-3.2094810e-08  3.1034616e+02  0.0000000e+00  0.0000000e+00
 -1.3754918e-08 -1.1462432e-08 -9.1699457e-09 -1.3754918e-08
 -6.8774590e-09  9.1699457e-09]
2025-06-02 15:42:59,393 - DEBUG - Updated reference std: node=[0.         0.         1.0274023  1.0274024  0.         0.
 0.         0.         1.0274024  1.0274024  1.0274023  1.0274024
 1.1239029  0.8377078  0.4188539  0.88522637 1.0274024  1.1212983
 1.9209524  2.3804762  0.4188539  0.         1.0274024  1.0274024
 0.         0.         0.         0.         1.0274024  1.0274024 ], edge=[  1.0198039 212.88945     0.          0.          1.0198039   1.0198039
   1.0198039   1.0198039   1.0198039   1.0198039]
2025-06-02 15:42:59,393 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:42:59,393 - INFO - Running anomaly detection...
2025-06-02 15:42:59,393 - INFO - Starting anomaly detection.
2025-06-02 15:42:59,397 - DEBUG - Node reconstruction errors: [0.11593343 1.8903928  0.28318474 0.04734744 0.04734745 0.04179411
 0.27638572 0.06001303 0.06001305 0.05695713 0.06001305 0.08499336
 0.33740482 0.05840217 0.11297076 0.08499347 0.0553628  0.08499337
 0.1502567 ]
2025-06-02 15:42:59,397 - DEBUG - Edge reconstruction errors: [ 5.2507615  7.6075716 44.159256   2.0672042 44.051464  44.166912
 44.453865   5.1389747  2.0672047 58.819874  58.819874   5.5764
  7.1900573  7.459368  43.759995   8.277983  58.249367   2.0492985
 46.247307  43.766228  43.759365  45.690456  44.64783   45.032375
 44.39883   44.1921   ]
2025-06-02 15:42:59,398 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154259_update_2.json
2025-06-02 15:42:59,399 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:59,414 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154259_update_2.pth and as latest_checkpoint.pth
2025-06-02 15:42:59,414 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869155.dot): 0.9635
2025-06-02 15:42:59,414 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:42:59,414 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.8904, MLP Score: 0.5031
2025-06-02 15:42:59,414 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:59,414 - INFO - 
--- Processing file: nw_graph_encoded_1748869185.dot (Timestamp: 2025-06-02 14:59:45) ---
2025-06-02 15:42:59,414 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:42:59,414 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:42:59,414 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:42:59,416 - INFO - Parsed 32 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:42:59,417 - INFO - Parsed 45 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:42:59,417 - INFO - Processing node updates/additions.
2025-06-02 15:42:59,417 - INFO - Processing edge updates/additions.
2025-06-02 15:42:59,418 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:42:59,418 - INFO - Finished updating NetworkX graph.
2025-06-02 15:42:59,418 - DEBUG - Updated graph - Nodes: 32, Edges: 45
2025-06-02 15:42:59,418 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:59,418 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:59,418 - DEBUG - Initial node features tensor shape: torch.Size([32, 30])
2025-06-02 15:42:59,419 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:59,419 - DEBUG - Node features tensor shape after scaling: torch.Size([32, 30])
2025-06-02 15:42:59,419 - DEBUG - Edge index tensor shape: torch.Size([2, 45])
2025-06-02 15:42:59,419 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:59,420 - DEBUG - Initial edge attributes tensor shape: torch.Size([45, 10])
2025-06-02 15:42:59,420 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:59,420 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([45, 10])
2025-06-02 15:42:59,420 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:59,420 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:59,421 - INFO - Updated main graph to 32 nodes and 45 edges.
2025-06-02 15:42:59,421 - INFO - Performing online update...
2025-06-02 15:42:59,421 - INFO - Starting online update for 25 steps.
2025-06-02 15:42:59,421 - DEBUG - Updated RunningStats: new_mean=0.9831046891665598, new_var=10846.83337104342, new_n=90
2025-06-02 15:42:59,421 - DEBUG - Updated RunningStats: new_mean=0.8958028946660067, new_var=976227.2075093095, new_n=120
2025-06-02 15:42:59,421 - DEBUG - Updated RunningStats: new_mean=28.811734042174454, new_var=2652284.438954953, new_n=30
2025-06-02 15:42:59,421 - DEBUG - Updated RunningStats: new_mean=26.55844950795683, new_var=79601675.18801394, new_n=40
2025-06-02 15:42:59,421 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:42:59,421 - DEBUG - Online update step: 1/25
2025-06-02 15:42:59,421 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,421 - DEBUG - Online update step: 2/25
2025-06-02 15:42:59,421 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 3/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 4/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 5/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 6/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 7/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 8/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 9/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 10/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 11/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 12/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 13/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 14/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 15/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 16/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 17/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 18/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 19/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 20/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 21/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 22/25
2025-06-02 15:42:59,422 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,422 - DEBUG - Online update step: 23/25
2025-06-02 15:42:59,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,423 - DEBUG - Online update step: 24/25
2025-06-02 15:42:59,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,423 - DEBUG - Online update step: 25/25
2025-06-02 15:42:59,423 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,423 - WARNING - No successful steps during online update.
2025-06-02 15:42:59,423 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], current edge mean: [ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:42:59,423 - DEBUG - Node drift difference: 0.3282, Edge drift difference: 0.1110
2025-06-02 15:42:59,423 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:42:59,424 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], edge=[ 2.1192763e-08  3.3397778e+02  0.0000000e+00  0.0000000e+00
 -1.3245477e-08 -5.2981908e-09  0.0000000e+00  2.6490954e-09
  1.3245477e-09  0.0000000e+00]
2025-06-02 15:42:59,424 - DEBUG - Updated reference std: node=[0.         0.         1.016001   1.016001   0.         0.
 0.         0.         1.016001   1.016001   1.016001   1.016001
 1.016001   0.73780406 0.33601075 0.89577866 1.016001   1.0757593
 2.206113   1.2374369  0.33601075 0.         1.016001   1.016001
 0.         0.         0.         0.         1.016001   1.016001  ], edge=[  1.0112998 190.90686     0.          0.          1.0112997   1.0112998
   1.0112997   1.0112998   1.0112998   1.0112998]
2025-06-02 15:42:59,424 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:42:59,424 - INFO - Running anomaly detection...
2025-06-02 15:42:59,424 - INFO - Starting anomaly detection.
2025-06-02 15:42:59,426 - DEBUG - Node reconstruction errors: [0.14551379 0.2887646  0.24749702 0.06825852 0.06825852 0.06350712
 0.30225992 0.04404135 0.04404122 0.0476479  0.04404122 0.06799625
 0.40603134 0.11248577 0.02100845 0.06799587 0.04271555 0.06799625
 0.11574046 0.06105684 0.04199587 0.02100845 0.0441624  0.06105685
 0.02100848 0.09103453 0.02100891 0.11403193 0.04199589 0.02100848
 0.06105672 0.04416287]
2025-06-02 15:42:59,426 - DEBUG - Edge reconstruction errors: [ 5.2321906  7.7941103 44.125893   2.2924607  5.0710573 44.105556
 44.119164  44.154144   5.171228   2.2924578 58.564857  58.564857
 46.34927    7.7917814 44.11757   44.27825    5.609861   7.0188966
  7.7720127 44.072075   7.8933277 58.48987    2.2898128 46.312164
  7.791592  44.118996  44.074654  44.07201   44.3086    44.15405
 44.221165  44.12675   44.113716  46.23307   44.433647  44.23547
 44.145535  44.115383  44.123173  44.107338  10.000067  44.11975
 44.122047  44.716366  44.08366  ]
2025-06-02 15:42:59,427 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154259_update_3.json
2025-06-02 15:42:59,427 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:59,433 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154259_update_3.pth and as latest_checkpoint.pth
2025-06-02 15:42:59,433 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869185.dot): 0.9648
2025-06-02 15:42:59,433 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:42:59,433 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4060, MLP Score: 0.4935
2025-06-02 15:42:59,433 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:59,433 - INFO - 
--- Processing file: nw_graph_encoded_1748869215.dot (Timestamp: 2025-06-02 15:00:15) ---
2025-06-02 15:42:59,433 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:42:59,433 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:42:59,433 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:42:59,435 - INFO - Parsed 49 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:42:59,436 - INFO - Parsed 66 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:42:59,436 - INFO - Processing node updates/additions.
2025-06-02 15:42:59,436 - INFO - Processing edge updates/additions.
2025-06-02 15:42:59,437 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:42:59,437 - INFO - Finished updating NetworkX graph.
2025-06-02 15:42:59,437 - DEBUG - Updated graph - Nodes: 49, Edges: 66
2025-06-02 15:42:59,437 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:59,437 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:59,438 - DEBUG - Initial node features tensor shape: torch.Size([49, 30])
2025-06-02 15:42:59,439 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:59,439 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 30])
2025-06-02 15:42:59,439 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-02 15:42:59,439 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:59,439 - DEBUG - Initial edge attributes tensor shape: torch.Size([66, 10])
2025-06-02 15:42:59,440 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:59,440 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([66, 10])
2025-06-02 15:42:59,440 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:59,440 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:59,440 - INFO - Updated main graph to 49 nodes and 66 edges.
2025-06-02 15:42:59,440 - INFO - Performing online update...
2025-06-02 15:42:59,440 - INFO - Starting online update for 25 steps.
2025-06-02 15:42:59,441 - DEBUG - Updated RunningStats: new_mean=0.948070886640343, new_var=117147441.79238482, new_n=150
2025-06-02 15:42:59,441 - DEBUG - Updated RunningStats: new_mean=0.9018458811016488, new_var=17572116280.104534, new_n=180
2025-06-02 15:42:59,441 - DEBUG - Updated RunningStats: new_mean=28.307668419444663, new_var=3184179796.4487815, new_n=50
2025-06-02 15:42:59,441 - DEBUG - Updated RunningStats: new_mean=26.60214037147173, new_var=159209017604.0077, new_n=60
2025-06-02 15:42:59,441 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:42:59,441 - DEBUG - Online update step: 1/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 2/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 3/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 4/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 5/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 6/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 7/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,441 - DEBUG - Online update step: 8/25
2025-06-02 15:42:59,441 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 9/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 10/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 11/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 12/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 13/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 14/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 15/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 16/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 17/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 18/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 19/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 20/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 21/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 22/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 23/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 24/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - DEBUG - Online update step: 25/25
2025-06-02 15:42:59,442 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,442 - WARNING - No successful steps during online update.
2025-06-02 15:42:59,443 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], current edge mean: [-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:42:59,443 - DEBUG - Node drift difference: 0.2913, Edge drift difference: 0.0999
2025-06-02 15:42:59,443 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:42:59,443 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], edge=[-1.4449611e-08  3.5304544e+02  0.0000000e+00  0.0000000e+00
  3.6124028e-09 -3.6124028e-09  9.0310071e-09 -7.2248056e-09
 -7.2248056e-09  0.0000000e+00]
2025-06-02 15:42:59,444 - DEBUG - Updated reference std: node=[0.         0.         1.010363   1.010363   0.         0.
 0.         1.010363   1.010363   1.010363   1.010363   1.010363
 1.6953317  0.61167777 0.30583888 0.81805724 1.010363   1.0346875
 1.9223887  1.3034492  0.30583888 0.         1.010363   1.010363
 0.         0.         0.         0.         1.010363   1.010363  ], edge=[  1.007663  173.69136     0.          0.          1.007663    1.007663
   1.0076629   1.0076629   1.007663    1.007663 ]
2025-06-02 15:42:59,444 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:42:59,444 - INFO - Running anomaly detection...
2025-06-02 15:42:59,444 - INFO - Starting anomaly detection.
2025-06-02 15:42:59,446 - DEBUG - Node reconstruction errors: [0.16500476 0.48146218 0.3592044  0.04441485 0.04441485 0.04618199
 0.31887957 0.03866927 0.03866927 0.04667197 0.03866927 0.04799406
 0.2867234  0.16836222 0.01573802 0.04799379 0.03271326 0.04799406
 0.08691592 0.05252534 0.03673446 0.015738   0.04513598 0.05252534
 0.01713893 0.07020701 0.01713889 0.22268537 0.0367344  0.01713887
 0.05252565 0.04513598 0.04621468 0.07082067 0.08611621 0.01495829
 0.08906465 0.05252534 0.02746466 0.13315049 0.018343   0.01495827
 0.05252539 0.01889304 0.02313716 0.01495829 0.03461299 0.02378873
 0.04779018]
2025-06-02 15:42:59,446 - DEBUG - Edge reconstruction errors: [ 5.228144   7.8398895 44.15513    2.33932    5.237548  44.142467
 44.182304  44.14397   44.142395  44.146614  44.158154   5.286314
  2.3393166 58.57589   58.57589   46.36811    7.865438  44.201237
 44.211533   5.5268693  6.785706  44.141144   7.8285027 44.12852
  7.898277  58.537792   2.3377483 46.348408   7.8383884 44.282722
 44.131355  44.1285    44.24311   44.16738   44.184544  44.156235
 44.14857   46.46783   44.31689   44.289158  44.16592   44.303673
 44.303673  44.141144  44.279842  44.151485  44.195576   8.639876
 44.15219   44.15155   44.423683  44.136005  10.821379  13.627287
  7.842897  44.12747   44.1285    44.12852   44.13077   44.17232
 44.21737   44.149956  44.161457  44.151543  44.238262  44.130234 ]
2025-06-02 15:42:59,447 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154259_update_4.json
2025-06-02 15:42:59,447 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:59,454 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154259_update_4.pth and as latest_checkpoint.pth
2025-06-02 15:42:59,454 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869215.dot): 0.9753
2025-06-02 15:42:59,454 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:42:59,454 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.4815, MLP Score: 0.5381
2025-06-02 15:42:59,454 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.3592, MLP Score: 0.5354
2025-06-02 15:42:59,454 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:59,454 - INFO - 
--- Processing file: nw_graph_encoded_1748869245.dot (Timestamp: 2025-06-02 15:00:45) ---
2025-06-02 15:42:59,454 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:42:59,454 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:42:59,454 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:42:59,456 - INFO - Parsed 54 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:42:59,458 - INFO - Parsed 71 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:42:59,458 - INFO - Processing node updates/additions.
2025-06-02 15:42:59,458 - INFO - Processing edge updates/additions.
2025-06-02 15:42:59,459 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:42:59,459 - INFO - Finished updating NetworkX graph.
2025-06-02 15:42:59,459 - DEBUG - Updated graph - Nodes: 54, Edges: 71
2025-06-02 15:42:59,459 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:59,459 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:59,460 - DEBUG - Initial node features tensor shape: torch.Size([54, 30])
2025-06-02 15:42:59,461 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:59,461 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 30])
2025-06-02 15:42:59,461 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-02 15:42:59,462 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:59,462 - DEBUG - Initial edge attributes tensor shape: torch.Size([71, 10])
2025-06-02 15:42:59,463 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:59,463 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([71, 10])
2025-06-02 15:42:59,463 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:59,463 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:59,463 - INFO - Updated main graph to 54 nodes and 71 edges.
2025-06-02 15:42:59,463 - INFO - Performing online update...
2025-06-02 15:42:59,463 - INFO - Starting online update for 25 steps.
2025-06-02 15:42:59,464 - DEBUG - Updated RunningStats: new_mean=0.9395010550904108, new_var=1800000000176.674, new_n=210
2025-06-02 15:42:59,464 - DEBUG - Updated RunningStats: new_mean=0.9074599084831132, new_var=2100000000011.152, new_n=240
2025-06-02 15:42:59,464 - DEBUG - Updated RunningStats: new_mean=27.72758926003723, new_var=600000107532.0767, new_n=70
2025-06-02 15:42:59,464 - DEBUG - Updated RunningStats: new_mean=26.550317850891304, new_var=700000028422.51, new_n=80
2025-06-02 15:42:59,464 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:42:59,464 - DEBUG - Online update step: 1/25
2025-06-02 15:42:59,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,464 - DEBUG - Online update step: 2/25
2025-06-02 15:42:59,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,464 - DEBUG - Online update step: 3/25
2025-06-02 15:42:59,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 4/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 5/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 6/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 7/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 8/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 9/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 10/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 11/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 12/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 13/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 14/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 15/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 16/25
2025-06-02 15:42:59,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,465 - DEBUG - Online update step: 17/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 18/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 19/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 20/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 21/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 22/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 23/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 24/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - DEBUG - Online update step: 25/25
2025-06-02 15:42:59,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,466 - WARNING - No successful steps during online update.
2025-06-02 15:42:59,467 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], current edge mean: [ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:42:59,467 - DEBUG - Node drift difference: 0.2719, Edge drift difference: 0.0475
2025-06-02 15:42:59,467 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:42:59,467 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:42:59,467 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:42:59,467 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:42:59,467 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:42:59,468 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:42:59,468 - INFO - Optimizer and scheduler reset.
2025-06-02 15:42:59,469 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], edge=[ 0.0000000e+00  3.4480283e+02  0.0000000e+00  0.0000000e+00
 -6.7160162e-09  1.0074024e-08  0.0000000e+00 -1.0074024e-08
 -6.7160162e-09  0.0000000e+00]
2025-06-02 15:42:59,469 - DEBUG - Updated reference std: node=[0.         0.         1.0093899  1.0093899  0.         0.
 0.         1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.7420079  0.58516484 0.47875917 0.7930516  1.0093899  1.0279124
 2.0339537  1.2428693  0.47875917 0.         1.0093899  1.0093899
 0.         0.         0.         0.         1.0093899  1.0093899 ], edge=[  1.0071175 176.04436     0.          0.          1.0071175   1.0071175
   1.0071175   1.0071175   1.0071175   1.0071175]
2025-06-02 15:42:59,470 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:42:59,470 - INFO - Running anomaly detection...
2025-06-02 15:42:59,470 - INFO - Starting anomaly detection.
2025-06-02 15:42:59,473 - DEBUG - Node reconstruction errors: [10.819378   8.094912   9.351129  13.32322   13.32322   12.140291
  9.237403  12.309587  12.309588  13.586643  12.309587  12.259745
  9.481562   7.147649  10.831075  12.259739  15.190755  12.259752
 10.958753  10.289742  10.406138  10.831075  11.781662  10.289743
 10.522996  11.612087  10.522996   9.435485  10.406137  10.522995
  7.885596  11.781661   9.325383  11.712964  11.735201   9.785402
 10.531028  10.289742  10.533208   9.242364  11.890003   9.785402
 10.289743  12.207673  11.8612995  9.885041  15.178289  17.061434
  9.453084  14.4438925 15.186289  11.249018  10.929646   9.524551 ]
2025-06-02 15:42:59,473 - DEBUG - Edge reconstruction errors: [ 5.1796293  7.830525  44.200138   2.2923143  5.2121196 44.133514
 44.172997  44.135014  44.133434  44.13773   44.149437   5.2849226
  2.2903066 58.566673  58.566673  46.358963   7.8553696 44.19161
 44.20235   44.150635   6.177804   6.6103272 44.131416   7.8171644
 44.119473   7.8832455 58.528645   2.2353299 46.339302   7.8282146
 44.272003  44.121773  44.119453  44.233025  44.15865   44.17606
 44.147457  44.139675  46.50967   44.308556  44.279865  44.156483
 44.295506  44.295506  44.131416  44.270535  44.142548  44.18615
  8.63662    8.286102  44.14338   44.142693  44.4202    44.126373
 10.842838  13.618255   7.8317614 44.11843   44.119453  44.119473
 44.12124   44.163567  44.293346  44.141136  44.152718  44.194458
 44.23091   44.121147  44.144108   7.822648  13.22011  ]
2025-06-02 15:42:59,474 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154259_update_5.json
2025-06-02 15:42:59,474 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:59,477 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154259_update_5.pth and as latest_checkpoint.pth
2025-06-02 15:42:59,477 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869245.dot): 0.9973
2025-06-02 15:42:59,477 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:42:59,478 - WARNING -   Node ID: 150.171.28.10, Recon Error: 17.0614, MLP Score: 0.8141
2025-06-02 15:42:59,478 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:59,478 - INFO - 
--- Processing file: nw_graph_encoded_1748869275.dot (Timestamp: 2025-06-02 15:01:15) ---
2025-06-02 15:42:59,478 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:42:59,478 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:42:59,478 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:42:59,481 - INFO - Parsed 62 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:42:59,483 - INFO - Parsed 86 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:42:59,483 - INFO - Processing node updates/additions.
2025-06-02 15:42:59,484 - INFO - Processing edge updates/additions.
2025-06-02 15:42:59,485 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:42:59,485 - INFO - Finished updating NetworkX graph.
2025-06-02 15:42:59,485 - DEBUG - Updated graph - Nodes: 62, Edges: 86
2025-06-02 15:42:59,485 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:42:59,485 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:42:59,486 - DEBUG - Initial node features tensor shape: torch.Size([62, 30])
2025-06-02 15:42:59,487 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:42:59,487 - DEBUG - Node features tensor shape after scaling: torch.Size([62, 30])
2025-06-02 15:42:59,488 - DEBUG - Edge index tensor shape: torch.Size([2, 86])
2025-06-02 15:42:59,488 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:42:59,488 - DEBUG - Initial edge attributes tensor shape: torch.Size([86, 10])
2025-06-02 15:42:59,489 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:42:59,489 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([86, 10])
2025-06-02 15:42:59,489 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:42:59,489 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:42:59,489 - INFO - Updated main graph to 62 nodes and 86 edges.
2025-06-02 15:42:59,490 - INFO - Performing online update...
2025-06-02 15:42:59,490 - INFO - Starting online update for 25 steps.
2025-06-02 15:42:59,490 - DEBUG - Updated RunningStats: new_mean=0.9345282815010671, new_var=2400000000173.375, new_n=270
2025-06-02 15:42:59,490 - DEBUG - Updated RunningStats: new_mean=0.9103535389801057, new_var=2700000000011.498, new_n=300
2025-06-02 15:42:59,490 - DEBUG - Updated RunningStats: new_mean=27.39446859625072, new_var=800000105458.7961, new_n=90
2025-06-02 15:42:59,491 - DEBUG - Updated RunningStats: new_mean=26.5187596297302, new_var=900000029383.9722, new_n=100
2025-06-02 15:42:59,491 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:42:59,491 - DEBUG - Online update step: 1/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 2/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 3/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 4/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 5/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 6/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 7/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 8/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 9/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 10/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 11/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,491 - DEBUG - Online update step: 12/25
2025-06-02 15:42:59,491 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 13/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 14/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 15/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 16/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 17/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 18/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 19/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 20/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 21/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 22/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 23/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 24/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - DEBUG - Online update step: 25/25
2025-06-02 15:42:59,492 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:42:59,492 - WARNING - No successful steps during online update.
2025-06-02 15:42:59,493 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], current edge mean: [-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:42:59,493 - DEBUG - Node drift difference: 0.1437, Edge drift difference: 0.0189
2025-06-02 15:42:59,494 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], edge=[-1.6633855e-08  3.4147675e+02  0.0000000e+00  0.0000000e+00
  4.1584638e-09 -4.1584638e-09  8.3169276e-09  7.6238500e-09
 -7.9703888e-09 -5.5446181e-09]
2025-06-02 15:42:59,494 - DEBUG - Updated reference std: node=[0.         0.         1.0081633  1.0081635  0.         0.
 0.         1.0081633  1.0081635  1.0081635  1.0081635  1.0081635
 1.6936907  0.6759446  0.43783274 0.78254354 1.0081635  0.9907024
 2.051943   1.6149749  0.43783274 0.         1.0081635  1.0081633
 0.         0.         0.         0.         1.0081635  1.0081635 ], edge=[  1.0058651 179.33273     0.          0.          1.0058652   1.0058652
   1.0058652   1.0058652   1.0058651   1.0058651]
2025-06-02 15:42:59,494 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:42:59,494 - INFO - Running anomaly detection...
2025-06-02 15:42:59,494 - INFO - Starting anomaly detection.
2025-06-02 15:42:59,497 - DEBUG - Node reconstruction errors: [10.58412    7.487673   9.123911  13.591975  13.591974  12.368776
  7.4422274 12.132935  12.132935  13.438798  12.132932  10.826304
  9.210582   7.0448213 11.166739  12.158782  15.087394  12.158779
 10.735776  10.617111  10.667003  11.166734  12.030967  10.61711
 10.88921   12.235918  10.88921    9.740704  10.667002  10.88921
  8.025144  12.030965   9.634565  11.818706  11.674367  10.144525
 10.523456  10.617112  10.868506   9.507769  12.319718  10.1445265
 10.617114  12.601809  12.233081  10.160448  15.54182   17.450293
  9.736005  15.107738  15.645899  11.555217  11.4118185  9.860571
  9.284812  10.732621   8.79599    9.200919   8.88754    8.968703
  8.547342  11.803792 ]
2025-06-02 15:42:59,498 - DEBUG - Edge reconstruction errors: [ 5.315791   7.8308725 44.287804   2.2936323  5.2383566 44.1342
 44.17655   44.13582    7.822495  44.134117  44.13878   44.15148
  5.2534485  2.2628026 58.569542  58.569542  46.36133    7.897788
 44.38584   44.208183  44.152763   7.820886  44.13243   44.125065
 44.18415   44.139397   6.4641314  6.6791716 44.131626   7.816572
 44.119064   7.8864827 58.52883    2.2430596 46.34029    7.828403
 44.281986  44.121387  44.192585  44.56428   44.24063   44.161293
 44.18023   44.149246  44.14083   46.71198   44.32263   44.291332
 44.1587    44.461063  44.461063  44.131626  44.281307  44.143894
 44.190517   8.702089   8.324088  44.144844  44.144096  44.445194
 44.12629   11.092397  13.617773   7.832043  44.11796   44.119045
 44.119064  44.120842  44.166588  44.30593   44.14249   44.15493
 44.19966   44.239555  44.120846  44.145695   7.8220463 44.119095
 44.172447  13.219724   2.3483012 58.522938   2.3321152 46.329697
 44.13199    7.8233285]
2025-06-02 15:42:59,499 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154259_update_6.json
2025-06-02 15:42:59,499 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:42:59,502 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154259_update_6.pth and as latest_checkpoint.pth
2025-06-02 15:42:59,502 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869275.dot): 0.9970
2025-06-02 15:42:59,502 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:42:59,502 - WARNING -   Node ID: 150.171.28.10, Recon Error: 17.4503, MLP Score: 0.8160
2025-06-02 15:42:59,502 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:42:59,506 - DEBUG - Embedding standard deviations before t-SNE: [1.2087706  0.10289801 0.80204177 0.80084527 0.         0.7430257
 0.7807929  0.42206123 0.74812317 1.665484   0.9459888  1.6780525
 1.3241909  1.0688523  1.7066358  0.91321445 0.13932677 0.81118524
 0.         0.6252661  0.06797641 0.8343425  0.         0.48357573
 0.43714458 0.81520206 0.0738716  0.83586854 1.1455399  0.
 1.5164847  1.3978108 ]
2025-06-02 15:42:59,644 - INFO - Embeddings visualization saved to vis/embeddings_6_updates_20250602_154259.png
2025-06-02 15:42:59,644 - INFO - Performing visualization of node and edge features.
2025-06-02 15:42:59,644 - INFO - Starting visualization of node features.
2025-06-02 15:42:59,644 - INFO - Graph has 62 nodes and 30 features.
2025-06-02 15:42:59,644 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:42:59,644 - INFO - Calculating feature statistics:
2025-06-02 15:42:59,644 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,644 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,645 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(1.9227304e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1658509), 'max': np.float32(1.8922695)}
2025-06-02 15:42:59,645 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(3.845461e-09), 'std': np.float32(0.99999994), 'min': np.float32(-1.8845364), 'max': np.float32(1.1707802)}
2025-06-02 15:42:59,645 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,645 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,645 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,645 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.2978431e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18257418), 'max': np.float32(5.4772253)}
2025-06-02 15:42:59,645 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-2.4995495e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7679477), 'max': np.float32(1.3021721)}
2025-06-02 15:42:59,645 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0000001), 'min': np.float32(-3.3477669), 'max': np.float32(0.3117721)}
2025-06-02 15:42:59,645 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5117006), 'max': np.float32(1.3328699)}
2025-06-02 15:42:59,645 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(-3.0763687e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.3289211), 'max': np.float32(1.5174078)}
2025-06-02 15:42:59,645 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.983871), 'std': np.float32(1.6799763), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:42:59,646 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.7419355), 'std': np.float32(0.67047125), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:42:59,646 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:42:59,646 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.451613), 'std': np.float32(0.776207), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:42:59,646 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(7.690922e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.3117721), 'max': np.float32(3.3477669)}
2025-06-02 15:42:59,646 - INFO - - service_1: {'name': 'service_1', 'unique': 4, 'mean': np.float32(1.2580645), 'std': np.float32(0.98268044), 'min': np.float32(0.0), 'max': np.float32(3.0)}
2025-06-02 15:42:59,646 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(7.225806), 'std': np.float32(2.0353281), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:42:59,646 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.580645), 'std': np.float32(1.6018978), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:42:59,646 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:42:59,646 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:42:59,646 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-5.7681913e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.3601238), 'max': np.float32(3.699454)}
2025-06-02 15:42:59,646 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(4.806826e-09), 'std': np.float32(1.0), 'min': np.float32(-0.38490018), 'max': np.float32(2.598076)}
2025-06-02 15:42:59,646 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,647 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,647 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,647 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:42:59,647 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(6.7295565e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.6187041), 'max': np.float32(4.672282)}
2025-06-02 15:42:59,647 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 3, 'mean': np.float32(5.864328e-08), 'std': np.float32(1.0), 'min': np.float32(-0.72994643), 'max': np.float32(2.890588)}
2025-06-02 15:42:59,666 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18e55eb0>
2025-06-02 15:42:59,841 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:42:59,906 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:42:59,946 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:01,335 - INFO - Node feature visualization saved to vis/node_features_20250602_154300.png
2025-06-02 15:43:01,335 - INFO - Finished visualization of node features.
2025-06-02 15:43:01,335 - INFO - Performing additional feature analysis:
2025-06-02 15:43:01,335 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:01,336 - INFO - Starting visualization of edge features.
2025-06-02 15:43:01,336 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:43:01,336 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:01,336 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:01,336 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:01,336 - INFO - - count: {'name': 'count', 'unique': 9, 'mean': np.float32(4.505002e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19846956), 'max': np.float32(6.581114)}
2025-06-02 15:43:01,336 - INFO - - dst_port: {'name': 'dst_port', 'unique': 8, 'mean': np.float32(341.47675), 'std': np.float32(178.28705), 'min': np.float32(25.0), 'max': np.float32(587.0)}
2025-06-02 15:43:01,336 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:01,336 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:01,336 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 67, 'mean': np.float32(8.316928e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19461668), 'max': np.float32(9.082401)}
2025-06-02 15:43:01,336 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 76, 'mean': np.float32(-2.5990397e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.22627027), 'max': np.float32(9.036156)}
2025-06-02 15:43:01,336 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 48, 'mean': np.float32(9.010004e-09), 'std': np.float32(1.0), 'min': np.float32(-0.4426339), 'max': np.float32(5.668144)}
2025-06-02 15:43:01,336 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 64, 'mean': np.float32(-1.039616e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.19641176), 'max': np.float32(8.896037)}
2025-06-02 15:43:01,336 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 76, 'mean': np.float32(4.3317328e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.2043706), 'max': np.float32(8.886798)}
2025-06-02 15:43:01,336 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 51, 'mean': np.float32(-3.4653864e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3688732), 'max': np.float32(7.6698503)}
2025-06-02 15:43:01,347 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09f072f0>
2025-06-02 15:43:01,405 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:01,415 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09e29880>
2025-06-02 15:43:01,475 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:01,560 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:01,677 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:01,698 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:01,709 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:02,912 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154301.png
2025-06-02 15:43:02,913 - INFO - Finished visualization of edge features.
2025-06-02 15:43:02,913 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:02,913 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:02,913 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:43:02,913 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:02,913 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:43:02,913 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:03,421 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154302_summary.png
2025-06-02 15:43:03,707 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154302_pca_3d.png
2025-06-02 15:43:03,872 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154302_pca_variance.png
2025-06-02 15:43:03,873 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:03,873 - INFO - 
--- Processing file: nw_graph_encoded_1748869305.dot (Timestamp: 2025-06-02 15:01:45) ---
2025-06-02 15:43:03,873 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:43:03,873 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:43:03,873 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:43:03,875 - INFO - Parsed 70 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:43:03,876 - INFO - Parsed 95 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:43:03,876 - INFO - Processing node updates/additions.
2025-06-02 15:43:03,877 - INFO - Processing edge updates/additions.
2025-06-02 15:43:03,877 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:03,877 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:03,877 - DEBUG - Updated graph - Nodes: 70, Edges: 95
2025-06-02 15:43:03,877 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:03,877 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:03,878 - DEBUG - Initial node features tensor shape: torch.Size([70, 30])
2025-06-02 15:43:03,879 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:03,879 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 30])
2025-06-02 15:43:03,879 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-02 15:43:03,879 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:03,879 - DEBUG - Initial edge attributes tensor shape: torch.Size([95, 10])
2025-06-02 15:43:03,880 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:03,880 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([95, 10])
2025-06-02 15:43:03,880 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:03,880 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:03,880 - INFO - Updated main graph to 70 nodes and 95 edges.
2025-06-02 15:43:03,880 - INFO - Performing online update...
2025-06-02 15:43:03,880 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:03,881 - DEBUG - Updated RunningStats: new_mean=0.9322694510337768, new_var=3000000000173.692, new_n=330
2025-06-02 15:43:03,881 - DEBUG - Updated RunningStats: new_mean=0.911676146017906, new_var=3300000000011.2827, new_n=360
2025-06-02 15:43:03,881 - DEBUG - Updated RunningStats: new_mean=27.299733541448745, new_var=1000000111611.6686, new_n=110
2025-06-02 15:43:03,881 - DEBUG - Updated RunningStats: new_mean=26.526158374749798, new_var=1100000027525.33, new_n=120
2025-06-02 15:43:03,881 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:03,881 - DEBUG - Online update step: 1/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 2/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 3/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 4/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 5/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 6/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 7/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 8/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 9/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 10/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 11/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 12/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 13/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 14/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 15/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 16/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,881 - DEBUG - Online update step: 17/25
2025-06-02 15:43:03,881 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 18/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 19/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 20/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 21/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 22/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 23/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 24/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - DEBUG - Online update step: 25/25
2025-06-02 15:43:03,882 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,882 - WARNING - No successful steps during online update.
2025-06-02 15:43:03,882 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], current edge mean: [ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:43:03,882 - DEBUG - Node drift difference: 0.0664, Edge drift difference: 0.0536
2025-06-02 15:43:03,883 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], edge=[ 2.5096694e-09  3.5109473e+02  0.0000000e+00  0.0000000e+00
  1.1293512e-08  1.2548347e-09  0.0000000e+00  8.7838421e-09
 -2.5096694e-09  2.5096694e-09]
2025-06-02 15:43:03,883 - DEBUG - Updated reference std: node=[0.        0.        1.0072203 1.0072203 0.        0.        0.
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.6233927 0.6409103
 0.4268426 0.8100047 1.0072203 0.9712215 2.0442314 1.5244046 0.4268426
 0.        1.0072203 1.0072203 0.        0.        0.        0.
 1.0072203 1.0072203], edge=[  1.0053052 173.13118     0.          0.          1.005305    1.005305
   1.005305    1.0053052   1.005305    1.005305 ]
2025-06-02 15:43:03,883 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:03,883 - INFO - Running anomaly detection...
2025-06-02 15:43:03,883 - INFO - Starting anomaly detection.
2025-06-02 15:43:03,885 - DEBUG - Node reconstruction errors: [10.462587   7.448823   9.282927  14.028095  14.028103  12.7325945
  7.6740847 12.378272  12.378275  13.682409  12.378275  10.864665
  9.579996   7.091837  11.474067  12.429325  15.368003  12.429317
 10.913758  10.93616   10.941493  11.474067  12.332139   8.222986
 11.180436  12.633516  11.180426  10.124431  10.941494  11.180435
  8.310694  12.332137   9.914195  12.071468  11.891587  10.438153
 10.753575  10.93616   11.179332   9.796009  12.6420355 10.438151
 10.93616   12.934101  12.557895  10.396639  15.886073  17.820164
  9.974764  15.2259    15.810042  11.817751  11.744521  10.153366
  9.431043  10.956907   8.855874   9.345215   8.972815   9.051671
  7.8615656 11.961619   9.819087   9.345215   9.795976   9.431045
 10.956906   9.43104    9.819085   9.819087 ]
2025-06-02 15:43:03,885 - DEBUG - Edge reconstruction errors: [ 5.231227   7.8271885 44.240986   2.2864194  5.1850667 44.131126
 44.163597  44.13244    7.8209753 44.131046  44.135094  44.145836
  7.7312217  2.2539275 58.555504  58.555504  46.35003    7.8719053
 44.313717  44.188553  44.146706   7.8195095 44.12887   44.1222
 44.27485   44.135445  44.134422  44.129696  44.241295  44.12915
  6.016591   6.442722  44.12647    7.8164043 44.118988   7.8624477
 58.525482   2.2285693 46.334446   7.82524   44.236446  44.119827
 44.182083  44.497047  44.209923  44.15382   44.16924   44.144127
 44.136696  46.53057   44.28721   44.25521   44.149303  44.405758
 44.405758  44.12647   44.247505  44.138695  44.173855   8.542029
  9.179448  44.140423  44.139427  44.411606  44.12309   44.133274
 10.547539  13.61819    7.828552  44.118263  44.11897   44.118988
 44.11961   44.157482  44.266785  44.138313  44.148582  44.183613
 44.224792  44.120117  44.14089    7.8204894 44.119015  44.16626
 44.163506  44.156456  44.54973   44.160946  13.222723   2.3365211
 58.521606   2.3264344 46.326958  44.12886    7.8220973]
2025-06-02 15:43:03,886 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154303_update_7.json
2025-06-02 15:43:03,886 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:03,888 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154303_update_7.pth and as latest_checkpoint.pth
2025-06-02 15:43:03,888 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869305.dot): 0.9970
2025-06-02 15:43:03,888 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:43:03,888 - WARNING -   Node ID: 150.171.28.10, Recon Error: 17.8202, MLP Score: 0.8194
2025-06-02 15:43:03,888 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:43:03,888 - INFO - 
--- Processing file: nw_graph_encoded_1748869335.dot (Timestamp: 2025-06-02 15:02:15) ---
2025-06-02 15:43:03,888 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:43:03,888 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:43:03,888 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:43:03,891 - INFO - Parsed 77 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:43:03,893 - INFO - Parsed 106 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:43:03,893 - INFO - Processing node updates/additions.
2025-06-02 15:43:03,894 - INFO - Processing edge updates/additions.
2025-06-02 15:43:03,895 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:03,895 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:03,895 - DEBUG - Updated graph - Nodes: 77, Edges: 106
2025-06-02 15:43:03,895 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:03,895 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:03,897 - DEBUG - Initial node features tensor shape: torch.Size([77, 30])
2025-06-02 15:43:03,898 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:03,898 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 30])
2025-06-02 15:43:03,899 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-02 15:43:03,899 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:03,899 - DEBUG - Initial edge attributes tensor shape: torch.Size([106, 10])
2025-06-02 15:43:03,900 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:03,900 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([106, 10])
2025-06-02 15:43:03,900 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:03,901 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:03,901 - INFO - Updated main graph to 77 nodes and 106 edges.
2025-06-02 15:43:03,901 - INFO - Performing online update...
2025-06-02 15:43:03,901 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:03,902 - DEBUG - Updated RunningStats: new_mean=0.9304583003668586, new_var=3600000000173.2173, new_n=390
2025-06-02 15:43:03,902 - DEBUG - Updated RunningStats: new_mean=0.9137070405847387, new_var=3900000000011.651, new_n=420
2025-06-02 15:43:03,902 - DEBUG - Updated RunningStats: new_mean=27.231475575348608, new_var=1200000115449.8408, new_n=130
2025-06-02 15:43:03,902 - DEBUG - Updated RunningStats: new_mean=26.54140910354053, new_var=1300000026236.8047, new_n=140
2025-06-02 15:43:03,902 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:03,902 - DEBUG - Online update step: 1/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 2/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 3/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 4/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 5/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 6/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,902 - DEBUG - Online update step: 7/25
2025-06-02 15:43:03,902 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 8/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 9/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 10/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 11/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 12/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 13/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 14/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 15/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 16/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 17/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 18/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 19/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 20/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 21/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 22/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 23/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 24/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - DEBUG - Online update step: 25/25
2025-06-02 15:43:03,903 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,903 - WARNING - No successful steps during online update.
2025-06-02 15:43:03,904 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], current edge mean: [-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:43:03,904 - DEBUG - Node drift difference: 0.2246, Edge drift difference: 0.0338
2025-06-02 15:43:03,904 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:43:03,904 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], edge=[-7.87231169e-09  3.56952820e+02  0.00000000e+00  0.00000000e+00
 -2.24923191e-09  4.49846382e-09 -1.34953915e-08 -8.99692765e-09
  1.57446234e-08  1.34953915e-08]
2025-06-02 15:43:03,905 - DEBUG - Updated reference std: node=[0.        0.        1.0065575 1.0065575 0.        0.        0.
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.5757258 0.6142531
 0.408806  0.7838946 1.0065575 1.4196405 2.131927  1.4564773 0.408806
 0.        1.0065575 1.0065575 0.        0.        0.        0.
 1.0065575 1.0065575], edge=[  1.0047506 168.6722      0.          0.          1.0047506   1.0047506
   1.0047506   1.0047506   1.0047506   1.0047506]
2025-06-02 15:43:03,905 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:03,905 - INFO - Running anomaly detection...
2025-06-02 15:43:03,905 - INFO - Starting anomaly detection.
2025-06-02 15:43:03,907 - DEBUG - Node reconstruction errors: [10.413873   7.7650375  9.422331  14.03218   14.032178  12.718301
  7.911288  12.077925  12.077925  13.362765  12.077927  10.670945
  9.552183   7.3813753 11.447049  12.170502  15.049425  12.170502
 10.736888  10.864897  10.85998   11.447048  12.169574   8.163173
 11.168927  12.687022  11.168927   9.636902  10.85998   11.168926
  8.41269   12.169574   9.945104  12.288716  12.089921  10.487792
 10.942891  10.864897  11.12145    9.76993   12.621655  10.487798
 10.864899  12.854569  12.453022  10.407103  15.683285  17.63219
  9.967073  15.487366  16.171457  11.758098  11.834226  10.190462
  9.474862  12.047524   8.89731    9.365251   9.002472   9.212901
  8.928279  11.925208   9.844474   9.365251   9.922368   9.474863
 11.095507   9.474863   9.844474   9.844474   9.230333  10.807597
 11.267579   9.937621  12.114823   9.81087    9.535838 ]
2025-06-02 15:43:03,907 - DEBUG - Edge reconstruction errors: [ 5.204329   7.8506713 44.217358   2.3049624  5.176119  44.154026
 44.17408   44.154858   7.846781  44.153954  44.15658   44.163383
  9.320567   2.2692533 58.608856  58.608856  46.36457    7.8742547
 44.318737  44.18908   44.163795   7.8455467 44.15203   44.147713
 44.393833  44.157402  44.165497  44.165497  44.15676   44.152542
 44.22396   44.15223   44.15855   44.186565  44.186302   5.2539988
 44.207626  44.151985   5.5439143  5.8033133 44.149742   7.8435984
 44.14624    7.8687344 58.5494     2.251838  46.35513    7.849185
 44.26014   44.146538  44.19242   44.551704  44.201912  44.17057
 44.178368  44.164215  44.15834   46.144287  44.267033  44.237404
 44.16599   44.473747  44.473747  44.149742  44.232826  44.159046
 44.181725   8.300057  10.166548  44.161446  44.16009   44.369503
 44.14813   44.154964   9.548579  13.645948   7.8511744 44.145893
 44.146225  44.14624   44.146446  44.171608  44.243538  44.15866
 44.16645   44.190453  44.22785   44.146782  44.160255   7.846156
 44.14626   44.18287   44.173603  44.174034  44.408314  44.171555
 44.162457  44.162457  44.15456   13.248044   2.3509252 58.547558
  2.346051  46.351128  44.152428   7.8480067]
2025-06-02 15:43:03,908 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154303_update_8.json
2025-06-02 15:43:03,908 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:03,914 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154303_update_8.pth and as latest_checkpoint.pth
2025-06-02 15:43:03,914 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869335.dot): 0.9969
2025-06-02 15:43:03,914 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:43:03,914 - WARNING -   Node ID: 150.171.28.10, Recon Error: 17.6322, MLP Score: 0.8230
2025-06-02 15:43:03,914 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 16.1715, MLP Score: 0.5870
2025-06-02 15:43:03,915 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:43:03,915 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-02 15:43:03,915 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:43:03,915 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:43:03,915 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:43:03,919 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:43:03,921 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:43:03,922 - INFO - Processing node updates/additions.
2025-06-02 15:43:03,922 - INFO - Processing edge updates/additions.
2025-06-02 15:43:03,924 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:03,924 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:03,924 - DEBUG - Updated graph - Nodes: 89, Edges: 133
2025-06-02 15:43:03,924 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:03,924 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:03,925 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-02 15:43:03,926 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:03,926 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-02 15:43:03,927 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-02 15:43:03,927 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:03,927 - DEBUG - Initial edge attributes tensor shape: torch.Size([133, 10])
2025-06-02 15:43:03,928 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:03,928 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([133, 10])
2025-06-02 15:43:03,928 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:03,928 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:03,928 - INFO - Updated main graph to 89 nodes and 133 edges.
2025-06-02 15:43:03,928 - INFO - Performing online update...
2025-06-02 15:43:03,928 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:03,929 - DEBUG - Updated RunningStats: new_mean=0.9299467952461821, new_var=4200000000167.249, new_n=450
2025-06-02 15:43:03,929 - DEBUG - Updated RunningStats: new_mean=0.9179123252082413, new_var=4500000000014.057, new_n=480
2025-06-02 15:43:03,929 - DEBUG - Updated RunningStats: new_mean=27.230377825933452, new_var=1400000123381.9688, new_n=150
2025-06-02 15:43:03,929 - DEBUG - Updated RunningStats: new_mean=26.56403471085965, new_var=1500000023501.166, new_n=160
2025-06-02 15:43:03,929 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:03,929 - DEBUG - Online update step: 1/25
2025-06-02 15:43:03,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,929 - DEBUG - Online update step: 2/25
2025-06-02 15:43:03,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,929 - DEBUG - Online update step: 3/25
2025-06-02 15:43:03,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,929 - DEBUG - Online update step: 4/25
2025-06-02 15:43:03,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,929 - DEBUG - Online update step: 5/25
2025-06-02 15:43:03,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,929 - DEBUG - Online update step: 6/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 7/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 8/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 9/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 10/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 11/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 12/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 13/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 14/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 15/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 16/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 17/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 18/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 19/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 20/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 21/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 22/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 23/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 24/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - DEBUG - Online update step: 25/25
2025-06-02 15:43:03,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,930 - WARNING - No successful steps during online update.
2025-06-02 15:43:03,931 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], current edge mean: [-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:43:03,931 - DEBUG - Node drift difference: 0.3056, Edge drift difference: 0.0700
2025-06-02 15:43:03,931 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:43:03,932 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], edge=[-1.43409675e-08  3.68759399e+02  0.00000000e+00  0.00000000e+00
 -8.96310404e-09  0.00000000e+00  0.00000000e+00 -3.58524188e-09
  0.00000000e+00  7.17048376e-09]
2025-06-02 15:43:03,932 - DEBUG - Updated reference std: node=[0.         0.         1.0056658  1.0056658  0.         0.
 0.         1.0056658  1.0056658  1.0056657  1.0056658  1.0056658
 1.5013614  0.5752825  0.46397272 0.7342142  1.0056657  2.2281742
 2.4426517  1.6442397  0.46397272 0.         1.0056658  1.0056658
 0.         0.         0.         0.         1.0056658  1.0056658 ], edge=[  1.0037808 158.66241     0.          0.          1.0037807   1.0037807
   1.0037808   1.0037807   1.0037807   1.0037807]
2025-06-02 15:43:03,932 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:03,933 - INFO - Running anomaly detection...
2025-06-02 15:43:03,933 - INFO - Starting anomaly detection.
2025-06-02 15:43:03,935 - DEBUG - Node reconstruction errors: [10.468481   6.51875    7.5637493 14.20603   13.504206  12.89955
  9.013697  12.4522295 12.4522295 13.748203  12.452228  10.93156
 10.043612   7.620173  11.920548  12.575624  15.563367  12.575624
 10.997933  11.355959  11.245794  11.920548  12.56978    8.420989
 11.646536  12.858213  11.646527   9.990648  11.245794  11.646532
  8.605251  12.569781  10.398701  13.223529  13.017442  10.961813
 11.702412  11.35596   11.6082735 10.199352  13.174714  10.961809
 11.355959  13.382492  12.984033  10.726824  16.3319    18.281048
 10.28452   15.889937  16.723509  12.134049  12.009136  10.653497
  9.631852   8.662674   9.163856   9.7393465  9.229586   9.271544
  8.158792  12.400733  10.260304   7.501534  10.161364   9.631853
 10.560602   9.631852  10.260303  10.260298   9.279103  10.905269
 11.413859  10.088588  12.388568   9.931212   9.82645   10.667913
 10.667917  10.667918  11.075877  10.667913   9.450466  11.041572
  9.960349  10.591689  11.3005495 10.667916  10.667916 ]
2025-06-02 15:43:03,936 - DEBUG - Edge reconstruction errors: [ 5.1703544  7.855685  44.21972    2.2873783  6.0612264 44.15948
 44.179626  44.160355   7.8510504 44.1515    44.18524   44.16207
 44.234745  44.15292   44.162754   5.3292084  7.8539467 44.19087
 44.159412  44.162205  44.191124  44.191124  44.169334  10.183547
  2.2915306 58.669624  58.669624  46.369072   7.8780665 44.383553
 44.195023  44.169724   7.8505917 44.15727   44.15292   44.393513
 44.16276   44.17122   44.17122   44.162086  44.15781   44.232246
 44.157486  44.163963  44.19201   44.191338   5.2451    44.213192
 44.17036   44.164528  44.164528  44.16774   44.16774   44.175987
 44.175987  44.17548   44.17548   44.168533  44.168533  44.161415
 44.161415  44.226547  44.226547   5.6074266  6.089588  44.15473
  7.8487034 44.151627   7.8718815 58.554474   2.2674398 46.360085
  7.8548656 44.260536  44.151867  44.19858   44.56325   44.206078
 44.176064  44.184563  44.169563  44.163677  46.17704   44.27213
 44.242004  44.17109   44.48056   44.48056   44.15473   44.237373
 44.164417  44.186665   8.318671  10.268304  44.166817  44.165493
 44.379787  44.153297  44.160313   9.629893  13.651385   7.856208
 44.151314  44.15161   44.151627  44.151787  44.1773    44.248558
 44.164356  44.17198   44.19552   44.233738  44.152107  44.166042
  7.851049  44.15165   44.18861   44.178215  44.179287  44.165184
 44.411232  44.176723  44.168053  44.168053  44.159832  44.158154
 13.253232   2.38038   58.55282    2.3738573 46.35637   44.157692
  7.8534594]
2025-06-02 15:43:03,937 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154303_update_9.json
2025-06-02 15:43:03,937 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:03,940 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154303_update_9.pth and as latest_checkpoint.pth
2025-06-02 15:43:03,940 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.9964
2025-06-02 15:43:03,941 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-02 15:43:03,941 - WARNING -   Node ID: 23.33.92.35, Recon Error: 16.3319, MLP Score: 0.7727
2025-06-02 15:43:03,941 - WARNING -   Node ID: 150.171.28.10, Recon Error: 18.2810, MLP Score: 0.8381
2025-06-02 15:43:03,941 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 16.7235, MLP Score: 0.6007
2025-06-02 15:43:03,941 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:43:03,941 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-02 15:43:03,941 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:43:03,941 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:43:03,941 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:43:03,948 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:43:03,951 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:43:03,951 - INFO - Processing node updates/additions.
2025-06-02 15:43:03,952 - INFO - Processing edge updates/additions.
2025-06-02 15:43:03,953 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:03,953 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:03,953 - DEBUG - Updated graph - Nodes: 129, Edges: 186
2025-06-02 15:43:03,953 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:03,954 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:03,955 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-02 15:43:03,957 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:03,957 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-02 15:43:03,957 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-02 15:43:03,958 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:03,958 - DEBUG - Initial edge attributes tensor shape: torch.Size([186, 10])
2025-06-02 15:43:03,959 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:03,960 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([186, 10])
2025-06-02 15:43:03,960 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:03,960 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:03,960 - INFO - Updated main graph to 129 nodes and 186 edges.
2025-06-02 15:43:03,960 - INFO - Performing online update...
2025-06-02 15:43:03,960 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:03,961 - DEBUG - Updated RunningStats: new_mean=0.932225735956973, new_var=4800000000168.395, new_n=510
2025-06-02 15:43:03,961 - DEBUG - Updated RunningStats: new_mean=0.9207073983532016, new_var=5100000000014.268, new_n=540
2025-06-02 15:43:03,961 - DEBUG - Updated RunningStats: new_mean=27.594138884434205, new_var=1600000177727.1296, new_n=170
2025-06-02 15:43:03,961 - DEBUG - Updated RunningStats: new_mean=29.05691043393009, new_var=1700000260736.1067, new_n=180
2025-06-02 15:43:03,961 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:03,961 - DEBUG - Online update step: 1/25
2025-06-02 15:43:03,961 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,961 - DEBUG - Online update step: 2/25
2025-06-02 15:43:03,961 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,961 - DEBUG - Online update step: 3/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 4/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 5/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 6/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 7/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 8/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 9/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 10/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 11/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 12/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 13/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 14/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 15/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 16/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 17/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 18/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 19/25
2025-06-02 15:43:03,962 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,962 - DEBUG - Online update step: 20/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - DEBUG - Online update step: 21/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - DEBUG - Online update step: 22/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - DEBUG - Online update step: 23/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - DEBUG - Online update step: 24/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - DEBUG - Online update step: 25/25
2025-06-02 15:43:03,963 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:03,963 - WARNING - No successful steps during online update.
2025-06-02 15:43:03,963 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], current edge mean: [ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:43:03,964 - DEBUG - Node drift difference: 0.0969, Edge drift difference: 0.4538
2025-06-02 15:43:03,964 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:43:03,964 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:43:03,964 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:43:03,965 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:43:03,965 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:43:03,965 - INFO - Optimizer and scheduler reset.
2025-06-02 15:43:03,965 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], edge=[ 2.5636406e-09  4.4075806e+02  0.0000000e+00  0.0000000e+00
 -6.4091017e-09 -1.4100023e-08 -2.5636406e-09  2.5636406e-09
  2.5636406e-09 -8.9727425e-09]
2025-06-02 15:43:03,966 - DEBUG - Updated reference std: node=[0.         0.         1.0038986  1.0038986  0.         0.
 0.         1.0038986  1.0038987  1.0038986  1.0038986  1.0038986
 1.4040276  0.484248   0.43981254 0.7156203  1.0038986  2.3433478
 2.4947863  1.3784312  0.43981254 0.         1.0038986  1.0038986
 0.         0.         0.         0.         1.0038986  1.0038986 ], edge=[  1.002699  532.2214      0.          0.          1.002699    1.002699
   1.002699    1.0026991   1.002699    1.002699 ]
2025-06-02 15:43:03,966 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:03,966 - INFO - Running anomaly detection...
2025-06-02 15:43:03,966 - INFO - Starting anomaly detection.
2025-06-02 15:43:03,987 - DEBUG - Node reconstruction errors: [18.758736   9.241335  10.555026  27.71244   17.055681  24.620646
 10.6849575 23.31733   23.317333  26.33939   23.317333  15.958926
 11.295861  10.928269  23.536612  23.489061  30.427734  23.489063
 22.21094   22.267452  21.974295  23.536612  24.853325  12.645509
 22.535484  25.608889  22.535486  14.156572  21.974295  22.535486
 11.394812  24.853323  21.21339   26.883802  25.980143  22.346956
 22.908823  22.267452  22.837044  20.905113  27.468737  22.346958
 22.267452  26.755838  25.963648  21.635921  33.766697  37.754845
 20.748396  34.032322  34.851536  24.533209  24.311047  21.71524
 19.577965  14.587463  15.34744   20.317959  19.072609  19.046022
 11.465051  26.297565  21.308723  11.887571  21.13159   19.577953
 20.770046  17.649061  21.30872   21.30872   18.641802  15.963581
 23.129465  16.101337  15.286493  16.101337  20.39581   16.392698
 16.392702  16.392702  23.506744  16.3927    19.587702  22.296352
 18.403166  22.420893  17.277897  16.392698  16.3927    19.404072
 20.450518  21.371243  21.371243  18.69827   18.698273  24.12042
 22.116028  18.698273  19.553675  17.988972  18.69827   22.116028
 19.59669   16.392696  18.833845  17.842073  19.63736   11.460062
 22.420893  22.259075  19.323507  23.506744  11.345014  22.420893
 20.450518  19.59668   19.596682  15.75937   18.785618  18.698277
 22.523462  21.371243  21.371243  21.371243  15.759369  18.69827
 12.947603  10.69484   18.698261 ]
2025-06-02 15:43:03,988 - DEBUG - Edge reconstruction errors: [  4.6483808   6.8579063  43.193398    2.0826955  11.030391   43.1572
  43.17196    43.157936    6.8860574  43.15137    43.17346    43.15841
  43.294334   43.15206    43.159016    5.6901846   6.891752   43.212624
  43.18563    44.273983   43.15137    43.268684   43.489677   43.15137
  43.184      43.15137    43.15842    43.280163   43.158985   43.155315
  43.215446   43.159286   43.15867    44.254032   43.158253    6.9123044
  43.157143   43.15959    43.813377   43.813377   43.165573    8.627945
   2.0970063  57.620445   57.620445   45.361797    6.8697305  43.29523
  43.18434    43.16587     6.8814735  43.155205   43.15206    43.309242
  43.15902    43.165222   43.165222   43.158417   43.15566    43.21694
  43.155407   43.160015   43.17044    43.17044    43.17968    43.17821
  43.169636   43.169636    4.4486966  43.19552    43.16383    43.16383
  43.16385    43.160416   43.160416   43.16292    43.16292    43.168938
  43.168938   43.16842    43.16842    43.163536   43.163536   43.157978
  43.157978   43.20532    43.20532    43.435555   43.435555   43.38651
  43.38651    43.15644    43.16494    43.159233   43.15137    43.3788
  43.151745   43.15137    43.151745   43.159916   43.159916   43.158756
  43.15206    43.160137   43.15137    43.15169    43.15845    43.20015
  43.184013   43.200005   43.233147   43.159454   43.1746      5.0548286
   5.0878954  43.152977    6.86844    43.151443    6.883565   57.552906
   2.094268   45.356567    6.857793   43.218468   43.15153    43.18468
  43.44433    43.187374   43.16825    43.177048   43.16332    43.159542
  44.491806   43.230904   43.211582   43.164257   43.373253   43.373253
  43.152977   43.208027   43.16037    43.174786    7.2332783   8.86845
  43.161583   43.16099    43.313305   43.15228    43.157616    8.358839
  12.651387    6.879764   43.151283   43.151432   43.151443   43.151505
  43.170166   43.217903   43.16131    43.165764   43.180504   43.20571
  43.15168    43.162777    6.88126    43.151466   43.17623    43.168457
  43.16918    43.160706   43.332977   43.169144   43.19377    43.19377
  43.15673    43.155807  534.15155    43.171356   12.252524    2.2390566
  57.55207     2.2354264  45.35447    43.15543     6.86053   534.1516   ]
2025-06-02 15:43:03,990 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154303_update_10.json
2025-06-02 15:43:03,990 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:03,994 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154303_update_10.pth and as latest_checkpoint.pth
2025-06-02 15:43:03,994 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.0021
2025-06-02 15:43:03,994 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:43:03,994 - WARNING -   Node ID: 23.33.92.35, Recon Error: 33.7667, MLP Score: 0.0058
2025-06-02 15:43:03,994 - WARNING -   Node ID: 150.171.28.10, Recon Error: 37.7548, MLP Score: 0.0048
2025-06-02 15:43:03,994 - WARNING -   Node ID: ff02::2, Recon Error: 34.0323, MLP Score: 0.0037
2025-06-02 15:43:03,994 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 34.8515, MLP Score: 0.0077
2025-06-02 15:43:03,994 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-02 15:43:03,994 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.1516, MLP Score: 0.0000
2025-06-02 15:43:03,994 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.1516, MLP Score: 0.0000
2025-06-02 15:43:03,995 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-02 15:43:03,995 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:43:03,995 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:43:03,995 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:43:04,003 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:43:04,008 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:43:04,008 - INFO - Processing node updates/additions.
2025-06-02 15:43:04,010 - INFO - Processing edge updates/additions.
2025-06-02 15:43:04,012 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:04,013 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:04,013 - DEBUG - Updated graph - Nodes: 177, Edges: 256
2025-06-02 15:43:04,013 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:04,013 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:04,016 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-02 15:43:04,018 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:04,019 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-02 15:43:04,020 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-02 15:43:04,020 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:04,021 - DEBUG - Initial edge attributes tensor shape: torch.Size([256, 10])
2025-06-02 15:43:04,022 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:04,023 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([256, 10])
2025-06-02 15:43:04,023 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:04,023 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:04,023 - INFO - Updated main graph to 177 nodes and 256 edges.
2025-06-02 15:43:04,023 - INFO - Performing online update...
2025-06-02 15:43:04,024 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:04,024 - DEBUG - Updated RunningStats: new_mean=0.9334048283173413, new_var=5400000000169.0205, new_n=570
2025-06-02 15:43:04,024 - DEBUG - Updated RunningStats: new_mean=0.9222412610521001, new_var=5700000000013.945, new_n=600
2025-06-02 15:43:04,025 - DEBUG - Updated RunningStats: new_mean=30.174165970498258, new_var=1800000231839.238, new_n=190
2025-06-02 15:43:04,025 - DEBUG - Updated RunningStats: new_mean=32.64598704704964, new_var=1900000582512.6309, new_n=200
2025-06-02 15:43:04,025 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:04,025 - DEBUG - Online update step: 1/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 2/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 3/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 4/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 5/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 6/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 7/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,025 - DEBUG - Online update step: 8/25
2025-06-02 15:43:04,025 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 9/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 10/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 11/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 12/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 13/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 14/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 15/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 16/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 17/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 18/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 19/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 20/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 21/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 22/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,026 - DEBUG - Online update step: 23/25
2025-06-02 15:43:04,026 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,027 - DEBUG - Online update step: 24/25
2025-06-02 15:43:04,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,027 - DEBUG - Online update step: 25/25
2025-06-02 15:43:04,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:04,027 - WARNING - No successful steps during online update.
2025-06-02 15:43:04,027 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], current edge mean: [ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:43:04,028 - DEBUG - Node drift difference: 0.0695, Edge drift difference: 0.1167
2025-06-02 15:43:04,028 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], edge=[ 9.3132257e-09  5.0284766e+02  0.0000000e+00  0.0000000e+00
  1.3969839e-08  4.6566129e-09  4.1909516e-09 -3.7252903e-09
  9.3132257e-09 -4.6566129e-10]
2025-06-02 15:43:04,029 - DEBUG - Updated reference std: node=[0.         0.         1.002837   1.0028368  0.         0.
 0.         1.002837   1.002837   1.0028368  1.002837   1.0028368
 1.3349775  0.4166538  0.41433606 0.65556365 1.0028368  2.234172
 2.4678338  1.3320888  0.41433606 0.         1.0028368  1.002837
 0.         0.         0.         0.         1.002837   1.002837  ], edge=[  1.0019588 789.09216     0.          0.          1.0019588   1.0019588
   1.0019588   1.0019588   1.0019588   1.0019588]
2025-06-02 15:43:04,029 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:04,029 - INFO - Running anomaly detection...
2025-06-02 15:43:04,029 - INFO - Starting anomaly detection.
2025-06-02 15:43:04,033 - DEBUG - Node reconstruction errors: [19.602545  10.571566  11.745676  29.384586  17.68907   19.83243
 12.904791  24.391336  24.391336  27.457     24.391336  16.619234
 12.064867  11.53677   24.538994  24.542488  31.56896   24.542494
 23.407907  23.191046  22.98858   24.538998  25.977211  13.128934
 23.43445   27.02423   23.43445   14.570513  22.98858   23.434452
 11.790473  25.977203  21.986744  27.853407  26.955383  23.192081
 23.86057   23.191046  13.889686  21.798265  28.422144  23.192078
 23.191044  23.697302  27.004856  22.563557  34.950817  39.002
 21.639982  34.985813  36.171726  25.512764  25.528248  22.521252
 20.463017  14.687321  16.073729  20.934286  19.962238  19.959856
 12.0264845 27.122725  22.021114  11.654568  22.065275  20.463017
 21.630617  18.44659   22.021114  22.021114  19.45223   16.498728
 24.219988  16.652155  15.671313  16.652155  25.02787   16.92998
 16.92998   16.92998   24.09393   15.90183   20.07923   23.03632
 19.037617  22.95511   17.850286  16.929983  16.92998   19.394146
 20.107008  22.135479  22.135479  18.307304  19.394154  25.218014
 23.08729   19.394152  20.090033  18.552935  19.394152  23.08729
 20.096739  16.929983  19.288666  18.554876  20.107006  11.821994
 22.95511   22.354301  18.20895   24.09393   11.643151  22.95511
 21.00808   20.096739  20.096739  13.550466  19.313972  19.394154
 23.066504  22.135479  22.135479  22.135479  16.191133  19.394154
 13.414852  11.110793  19.394154  23.087297  21.989218  19.313972
 19.288668  12.441232  19.313972  18.492758  24.943184  20.090033
 19.313972  19.313972  19.313972  23.066504  20.096739  19.313972
 23.694963  19.313972  19.313972  19.313972  19.323078  19.313972
 24.272085  11.015514  15.390015  19.313972  15.397494  12.528692
 19.394154  19.313972  20.143385  24.955254  19.313972  12.441182
 19.394154  21.989218  16.191133  13.327389  16.165592  23.087292
 12.441266  19.313972  19.394154  19.394154  20.096739  23.957537
 19.394148  13.073551  19.313972 ]
2025-06-02 15:43:04,035 - DEBUG - Edge reconstruction errors: [  4.6161737   6.875429   43.194202    2.1537733  11.892998   43.170094
  43.181637   43.17074     6.8964357  43.165596   43.180782   43.17048
  43.28335    43.166004   43.171013   43.17207    43.17207     9.526563
   6.9011965  43.21456    43.18573    44.068043   43.165596   43.28445
  43.423195   43.165596   43.189407   43.165596   43.170517   43.415707
  43.198147   43.168526   43.21833    43.171207   43.170723   44.110676
  43.1704      6.91632    43.17117    43.90817    43.170704   43.171238
 534.16547     6.884727    6.881208   43.240288   43.166004   43.213154
 807.87164    43.17138    43.16716    43.273506   43.258083   43.274498
  43.397774   43.186775   11.1662035  43.203476   43.569237   43.170464
  43.192787   43.170925   43.170105   43.32225    43.181515   43.1829
  43.18184    43.1714     43.165596   43.23849     6.90797    43.256344
  43.166004   43.170464   43.170433   43.170486   43.17016    43.17016
  43.17005    43.172203   43.70614    43.70614    43.177357    9.1761675
   2.2111485  57.61031    57.61031    45.372375    6.885963   43.2638
  43.192127   43.177624    6.9075065  43.16839    43.166004   43.27619
  43.171017   43.17544    43.17544    43.17048    43.16879    43.22068
  43.16858    43.171867   43.17925    43.17925    43.18638    43.18468
  43.17858    43.17858     5.002094   43.199078   43.174587   43.174587
  43.17473    43.171986   43.171986   43.174004   43.174004   43.17833
  43.17833    43.177975   43.177975   43.174366   43.174366   43.1698
  43.1698     43.20535    43.20535    43.403088   43.403088   43.581913
  43.581913   43.165596   43.169487   43.176746   43.17114    43.165596
  43.34699    43.166252   43.165596   43.166252   43.171837   43.171837
  43.170826   43.166004   43.185017   43.165596   43.165787   43.17052
  43.199646   43.18873    43.324898   43.22245    43.20128    43.198338
  43.189228   43.184216   43.265034   43.165596   43.245354   43.171013
  43.17043    43.17043    43.182655   43.182655   43.1706     11.166343
  43.17032    43.170567   43.184685    4.9794393   4.9009666  43.166542
   6.8811774  43.16565     6.891265   57.56653     2.1747606  45.369083
   6.875812   43.211258   43.16569    43.189613   43.37941    43.1912
  43.17759    43.18644    43.17367    43.171295   44.03169    43.219048
  43.20745    43.174526   43.3178     43.3178     43.166542   43.204533
  43.172226   43.182106    7.182491    8.594965   43.17259    43.172497
  43.281372   43.166145   43.17037     8.165705   12.665619    6.8787436
  43.17827    43.17827    43.16555    43.165638   43.16565    43.16568
  43.201183   43.21357    43.17363    43.17612    43.185585   43.201405
  43.16578    43.174927    6.8924437  43.16567    43.182228   43.177345
  43.17705    43.18612    43.30253    43.17913    43.246708   43.246708
  43.175377   43.16857   534.16565    43.179813   43.347103   43.347103
  43.186684   43.186684   43.170906   43.185528   43.170296   43.180164
  43.170525   12.26633     2.2505753  57.56603     2.2483456  45.367725
  43.168453    6.8817406 534.1657    534.16547  ]
2025-06-02 15:43:04,036 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154304_update_11.json
2025-06-02 15:43:04,036 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:04,040 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154304_update_11.pth and as latest_checkpoint.pth
2025-06-02 15:43:04,040 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.0021
2025-06-02 15:43:04,040 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:43:04,040 - WARNING -   Node ID: 23.33.92.35, Recon Error: 34.9508, MLP Score: 0.0067
2025-06-02 15:43:04,040 - WARNING -   Node ID: 150.171.28.10, Recon Error: 39.0020, MLP Score: 0.0055
2025-06-02 15:43:04,040 - WARNING -   Node ID: ff02::2, Recon Error: 34.9858, MLP Score: 0.0039
2025-06-02 15:43:04,040 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 36.1717, MLP Score: 0.0079
2025-06-02 15:43:04,040 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:43:04,041 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.1655, MLP Score: 0.0000
2025-06-02 15:43:04,041 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.8716, MLP Score: 0.0000
2025-06-02 15:43:04,041 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.1656, MLP Score: 0.0000
2025-06-02 15:43:04,041 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.1657, MLP Score: 0.0000
2025-06-02 15:43:04,041 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 534.1655, MLP Score: 0.0000
2025-06-02 15:43:04,044 - DEBUG - Embedding standard deviations before t-SNE: [1.2301689  0.0408848  0.8623704  1.1797272  0.         0.8300665
 0.78485394 0.48545384 0.6457277  1.9430945  1.5084978  1.7504125
 1.1962708  0.89881605 1.5265865  1.1988316  0.15951164 0.78892934
 0.         0.9879985  0.17463547 1.3260865  0.         0.26734963
 0.55746806 0.8360163  0.0020631  1.1337447  1.6873543  0.
 1.3158354  1.3359439 ]
2025-06-02 15:43:04,378 - INFO - Embeddings visualization saved to vis/embeddings_11_updates_20250602_154304.png
2025-06-02 15:43:04,378 - INFO - Performing visualization of node and edge features.
2025-06-02 15:43:04,378 - INFO - Starting visualization of node features.
2025-06-02 15:43:04,378 - INFO - Graph has 177 nodes and 30 features.
2025-06-02 15:43:04,378 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:43:04,378 - INFO - Calculating feature statistics:
2025-06-02 15:43:04,379 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,379 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,379 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8533714), 'max': np.float32(0.91034335)}
2025-06-02 15:43:04,379 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.90634286), 'max': np.float32(1.8645692)}
2025-06-02 15:43:04,379 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,379 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,379 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,379 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:43:04,379 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-1.064204), 'max': np.float32(0.9396695)}
2025-06-02 15:43:04,379 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-4.897244), 'max': np.float32(0.21041438)}
2025-06-02 15:43:04,379 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4087965), 'max': np.float32(0.73897755)}
2025-06-02 15:43:04,379 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-0.73631406), 'max': np.float32(2.423313)}
2025-06-02 15:43:04,380 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.661017), 'std': np.float32(1.3312011), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:43:04,380 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9096045), 'std': np.float32(0.4154752), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:43:04,380 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:04,380 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.378531), 'std': np.float32(0.6537092), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:43:04,380 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.21041438), 'max': np.float32(4.897244)}
2025-06-02 15:43:04,380 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(2.118644), 'std': np.float32(2.227852), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:43:04,380 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.717514), 'std': np.float32(2.4608526), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:04,380 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.7118645), 'std': np.float32(1.3283206), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:04,380 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:04,380 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:43:04,380 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.2046888), 'max': np.float32(6.382569)}
2025-06-02 15:43:04,380 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:43:04,380 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,381 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,381 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,381 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:04,381 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-2.3572458e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8935937), 'max': np.float32(5.248779)}
2025-06-02 15:43:04,381 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-0.99771225), 'max': np.float32(4.353653)}
2025-06-02 15:43:04,394 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c188c65a0>
2025-06-02 15:43:04,523 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:43:04,572 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:43:04,597 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:05,943 - INFO - Node feature visualization saved to vis/node_features_20250602_154304.png
2025-06-02 15:43:05,943 - INFO - Finished visualization of node features.
2025-06-02 15:43:05,943 - INFO - Performing additional feature analysis:
2025-06-02 15:43:05,943 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:05,943 - INFO - Starting visualization of edge features.
2025-06-02 15:43:05,944 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:43:05,944 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:05,944 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:05,944 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:05,944 - INFO - - count: {'name': 'count', 'unique': 17, 'mean': np.float32(1.4901161e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11696286), 'max': np.float32(11.802426)}
2025-06-02 15:43:05,944 - INFO - - dst_port: {'name': 'dst_port', 'unique': 11, 'mean': np.float32(502.84766), 'std': np.float32(787.54944), 'min': np.float32(25.0), 'max': np.float32(8090.0)}
2025-06-02 15:43:05,944 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:05,944 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:05,944 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 175, 'mean': np.float32(1.1175871e-08), 'std': np.float32(1.0), 'min': np.float32(-0.20738153), 'max': np.float32(10.820693)}
2025-06-02 15:43:05,944 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 204, 'mean': np.float32(3.7252903e-09), 'std': np.float32(1.0), 'min': np.float32(-0.18580021), 'max': np.float32(11.406377)}
2025-06-02 15:43:05,944 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 100, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.14294389), 'max': np.float32(11.675713)}
2025-06-02 15:43:05,944 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 180, 'mean': np.float32(-1.1175871e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.26953164), 'max': np.float32(7.8537865)}
2025-06-02 15:43:05,944 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 197, 'mean': np.float32(5.5879354e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2646618), 'max': np.float32(8.580755)}
2025-06-02 15:43:05,944 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 104, 'mean': np.float32(-7.450581e-09), 'std': np.float32(1.0), 'min': np.float32(-0.15828094), 'max': np.float32(11.456623)}
2025-06-02 15:43:05,956 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18c850a0>
2025-06-02 15:43:06,028 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:06,038 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c180f82f0>
2025-06-02 15:43:06,107 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:06,201 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:06,370 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:06,394 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:06,403 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:07,604 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154306.png
2025-06-02 15:43:07,605 - INFO - Finished visualization of edge features.
2025-06-02 15:43:07,605 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:07,605 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:07,605 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:43:07,605 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:07,605 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:43:07,605 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:08,159 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154307_summary.png
2025-06-02 15:43:08,338 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154307_pca_3d.png
2025-06-02 15:43:08,524 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154307_pca_variance.png
2025-06-02 15:43:08,524 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:08,524 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-02 15:43:08,524 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:43:08,524 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:43:08,524 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:43:08,533 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:43:08,537 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:43:08,537 - INFO - Processing node updates/additions.
2025-06-02 15:43:08,538 - INFO - Processing edge updates/additions.
2025-06-02 15:43:08,540 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:08,540 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:08,540 - DEBUG - Updated graph - Nodes: 256, Edges: 395
2025-06-02 15:43:08,540 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:08,540 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:08,542 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-02 15:43:08,544 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:08,544 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-02 15:43:08,544 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-02 15:43:08,544 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:08,545 - DEBUG - Initial edge attributes tensor shape: torch.Size([395, 10])
2025-06-02 15:43:08,546 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:08,546 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([395, 10])
2025-06-02 15:43:08,546 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:08,546 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:08,546 - INFO - Updated main graph to 256 nodes and 395 edges.
2025-06-02 15:43:08,546 - INFO - Performing online update...
2025-06-02 15:43:08,546 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:08,546 - DEBUG - Updated RunningStats: new_mean=0.9337999609244829, new_var=6000000000166.255, new_n=630
2025-06-02 15:43:08,547 - DEBUG - Updated RunningStats: new_mean=0.9242769022321714, new_var=6300000000015.69, new_n=660
2025-06-02 15:43:08,547 - DEBUG - Updated RunningStats: new_mean=33.37392370493514, new_var=2000000209004.109, new_n=210
2025-06-02 15:43:08,547 - DEBUG - Updated RunningStats: new_mean=34.78187597358649, new_var=2100000372864.2153, new_n=220
2025-06-02 15:43:08,547 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:08,547 - DEBUG - Online update step: 1/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 2/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 3/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 4/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 5/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 6/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 7/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 8/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 9/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 10/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 11/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 12/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 13/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 14/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 15/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 16/25
2025-06-02 15:43:08,547 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,547 - DEBUG - Online update step: 17/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 18/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 19/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 20/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 21/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 22/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 23/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 24/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - DEBUG - Online update step: 25/25
2025-06-02 15:43:08,548 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,548 - WARNING - No successful steps during online update.
2025-06-02 15:43:08,548 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], current edge mean: [ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:43:08,548 - DEBUG - Node drift difference: 0.2039, Edge drift difference: 0.0298
2025-06-02 15:43:08,548 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:43:08,549 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], edge=[ 1.3279010e-08  4.7932657e+02  0.0000000e+00  0.0000000e+00
  2.4143654e-09 -3.6215480e-09  9.6574615e-09  6.0359135e-09
  0.0000000e+00 -4.8287307e-09]
2025-06-02 15:43:08,549 - DEBUG - Updated reference std: node=[0.         0.         1.0019588  1.0019588  0.         0.
 0.         1.0019588  1.0019588  1.0019588  1.0019588  1.0019588
 1.209687   0.36907077 0.41064274 0.6137592  1.0019588  2.614132
 2.6151161  1.4622234  0.41064274 0.         1.0019588  1.0019588
 0.         0.         0.         0.         1.0019588  1.0019588 ], edge=[  1.0012683 636.47986     0.          0.          1.0012683   1.0012683
   1.0012683   1.0012683   1.0012681   1.0012683]
2025-06-02 15:43:08,549 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:08,549 - INFO - Running anomaly detection...
2025-06-02 15:43:08,549 - INFO - Starting anomaly detection.
2025-06-02 15:43:08,552 - DEBUG - Node reconstruction errors: [20.117592 11.687463 12.496676 30.791954 18.431883 20.763556 13.695703
 25.600433 25.600435 28.592293 25.600431 17.342745 15.351856 11.63681
 25.663637 25.719706 32.994858 25.719707 24.852243 24.272083 24.119314
 25.663637 27.293453 13.651136 24.516302 28.429745 24.516302 14.479079
 24.11932  24.516306 12.220412 27.293459 14.304754 29.279387 28.330675
 24.224943 25.106358 24.272085 14.557898 19.198437 29.67745  24.224943
 24.272085 24.777618 28.290876 23.674292 36.420765 40.68464  22.722069
 32.27147  34.420918 26.826464 26.903217 20.686094 21.545376 15.068257
 17.868725 21.809101 21.244354 21.267927 11.729584 28.197876 22.926508
 11.999081 23.061247 18.917707 22.736603 19.403406 22.926508 22.926508
 20.370653 17.070534 25.467247 17.25586  16.154995 17.255863 25.946749
 17.518969 17.518969 15.851628 25.125154 16.45135  20.863409 24.070137
 18.280512 13.263923 18.46515  17.518969 17.518969 15.856829 21.00326
 13.778475 22.998474 15.730494 20.255768 27.387568 24.0553   20.255775
 20.835697 19.451937 15.856828 24.0553   20.923473 17.518965 20.009098
 19.396954 20.15867  12.466639 23.85254  23.416714 18.995024 25.125154
 13.7018   15.855235 16.549294 15.765471 16.284853 13.380966 15.088059
 20.255768 24.029327 22.998474 15.313622 22.998474 16.780058 20.255774
 14.004793 11.564927 15.856829 24.055305 22.969019 20.186455 20.009098
 13.041775 20.186457 19.34156  25.870323 20.835701 20.186455 20.186457
 20.186455 24.029339 20.92348  20.186455 24.908192 20.186455 20.186455
 20.186457 20.094622 20.186455 25.284657 11.436853 15.85625  20.186457
 15.930237 15.464651 20.255777 15.765525 20.952492 26.00298  20.186455
 13.041769 20.255775 22.969015 16.78006  13.909815 16.52812  24.0553
 10.912116 20.186457 20.255775 20.255775 20.92348  25.9674   20.255777
 13.214313 20.186457 16.010721 20.078802 19.358774 18.524364 22.153614
 19.634645 11.032132 22.153614 16.010721 20.047483 22.0679   20.047483
 19.358782 20.078798 16.010715 22.0679   19.439205 20.92348  22.067902
 20.445854 20.923473 13.314494 24.0553   20.835695 20.255777 13.488788
 24.0553   16.702032 22.998474 22.043741 14.004789 20.835701 20.835701
 23.0691   19.28607  19.358774 16.70203  16.010717 20.952496 16.010721
 16.70203  19.358774 20.255774 22.153614 20.047483 20.047482 19.358782
 20.255775 15.250593 16.010721 20.255775 19.358774 22.943811 22.99847
 20.078802 24.029325 16.702032 16.70203  22.067896 15.196377 20.047482
 20.255777 23.15048  22.153614 20.835697 19.28607  20.186457 19.358774
 20.186455 19.358774 16.010721 19.28607  19.364584 20.923473 20.952496
 19.358774 20.255775 16.70203  16.702036]
2025-06-02 15:43:08,554 - DEBUG - Edge reconstruction errors: [  4.6079764   4.431238    6.9262514  43.228115    2.1717644  11.503939
  43.218033   43.221687   43.218197    6.9364676  43.21656    43.222942
  43.21859    43.270607   43.216755   43.218716   43.219093   43.219093
   8.800173    6.9385386  43.23128    43.2263     43.574867   43.21656
  43.281708   43.304344   43.21656    43.22541    43.246452   43.246452
  43.21656    43.239487   43.239487   43.21854    43.221294   43.221294
  43.32684    43.229836   43.217575   43.23154    43.339188   43.339188
  43.218784   43.218513   43.218513   43.21864    43.218624   43.218624
  43.45795    43.218533    6.947025   43.218914   43.51847    43.218624
  43.220123   43.220123   43.218735  534.2165      6.9271407   6.925729
  43.236477   43.216755   43.229553  807.9189     43.21882    43.217308
  43.261227   43.25509    43.261707   43.310997   43.225105   11.21692
  43.22893    43.36808    43.218575   43.22609    43.21871    43.218483
  43.279873   43.22306    43.25379    43.223206   43.218807   43.21656
  43.2477      6.9430456  43.252728   43.216755   43.229153   43.223343
  43.223255   43.218372   43.218372   43.219276   43.223476   43.22445
  43.216755   43.218174   43.218174   43.218014   43.218014   43.230247
  43.23109    43.23109    43.21816    43.21816    43.220165   43.21816
  43.21816    43.218388   43.218388   43.226234   43.226234   43.218536
  43.22403    43.22403    43.219078   43.223335   43.223335   43.218952
  43.218952   43.22281    43.22281    43.220825   43.220825   43.22068
  43.22068    43.218475   43.21901    43.218746   43.22382    43.26453
  43.26453    43.21854    43.21859    43.22199    43.22199    43.21914
  43.21914    43.248333   43.248333   43.21862    43.219074   43.218018
  43.21854    43.37431    43.37431    43.21985    11.919368    2.2434947
  57.63622    57.63622    45.419548    6.939178   43.269215   43.22442
  43.219902    6.944188   43.217556   43.216755   43.272724   43.22363
  43.220554   43.220554   43.218594   43.221283   43.231422   43.217598
  43.218933   43.222015   43.222015   43.224224   43.224045   43.221775
  43.221775    6.19677    43.227985   43.2201     43.2201     43.2198
  43.219173   43.219173   43.21978    43.21978    43.218838   43.221535
  43.221535   43.221348   43.221348   43.22003    43.22003    43.218742
  43.218742   43.231422   43.231422   43.2818     43.2818     43.426353
  43.426353   43.21656    43.222954   43.217857   43.21972    43.218777
  43.21656    43.22977    43.22977    43.330963   43.253838   43.253838
  43.21688    43.21656    43.22764    43.22764    43.21688    43.218967
  43.218967   43.21865    43.216755   43.223995   43.21656    43.21665
  43.218597   43.23046    43.21912    43.21912    43.225693   43.28089
  43.24005    43.222065   43.222065   43.23054    43.22456    43.22456
  43.2298     43.22518    43.223763   43.244274   43.21656    43.249138
  43.218723   43.21862    43.21862    43.223286   43.223286   43.218616
  11.217015   43.218533   43.218594   43.22381    43.21909    43.22286
  43.21656    43.235275   43.21656    43.22679    43.21862    43.222782
  43.218666   43.2292     43.218727   43.21656    43.22359     6.956586
  43.218594   43.218594   43.21868    43.22074    43.21862    43.216755
  43.22934    43.23742    43.21853    43.218502   43.219612   43.21858
  43.264694   43.21656    43.227333   43.21895    43.21656    43.22358
  43.22358    43.21656    43.35836     6.969364   43.23753    43.21656
  43.222343   43.21874    43.22445    43.2242     43.225216   43.22621
  43.218567   43.218613   43.21863    43.21656    43.25975    43.218754
   4.85742     4.74761    43.21701    43.22114    43.22114     6.9383173
  43.216576    6.9498677  57.616985    2.2909007  45.417995    6.9419184
  43.23502    43.216602   43.225994   43.298054   43.226402   43.22135
  43.22267    43.22013    43.21891    43.64751    43.240555   43.233856
  43.220253   43.34143    43.34143    43.21701    43.233044   43.21897
  43.223133    7.0166154   7.3706512  43.219578   43.219242   43.263237
  43.21681    43.21814     7.2649946  12.716855    6.9292507  43.22181
  43.22181    43.216534   43.216576   43.216576   43.21659    43.229008
  43.234913   43.21894    43.22051    43.22508    43.233498   43.216644
  43.219807   43.219807   43.219246   11.6784     43.21658    43.22421
  43.221386   43.222176   43.224586   43.26319    43.221054   43.251503
  43.251503   43.220947   43.21792   534.2166     43.22218    43.321392
  43.321392   43.223988   43.223988   43.21858    43.22439    43.218395
  43.222095   43.21838    43.218372   43.218372   43.22184    43.218983
  43.21847    12.317205    2.3023849  57.618977    2.3013492  45.417427
  43.21768     6.9354653  57.618385  534.2166    534.2165   ]
2025-06-02 15:43:08,555 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154308_update_12.json
2025-06-02 15:43:08,555 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:08,558 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154308_update_12.pth and as latest_checkpoint.pth
2025-06-02 15:43:08,558 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.0024
2025-06-02 15:43:08,558 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:43:08,558 - WARNING -   Node ID: 150.171.28.12, Recon Error: 32.9949, MLP Score: 0.0076
2025-06-02 15:43:08,558 - WARNING -   Node ID: 23.33.92.35, Recon Error: 36.4208, MLP Score: 0.0071
2025-06-02 15:43:08,558 - WARNING -   Node ID: 150.171.28.10, Recon Error: 40.6846, MLP Score: 0.0060
2025-06-02 15:43:08,558 - WARNING -   Node ID: ff02::2, Recon Error: 32.2715, MLP Score: 0.0028
2025-06-02 15:43:08,558 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 34.4209, MLP Score: 0.0072
2025-06-02 15:43:08,558 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:43:08,558 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2165, MLP Score: 0.0000
2025-06-02 15:43:08,558 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9189, MLP Score: 0.0000
2025-06-02 15:43:08,558 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2166, MLP Score: 0.0000
2025-06-02 15:43:08,559 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.2166, MLP Score: 0.0000
2025-06-02 15:43:08,559 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 534.2165, MLP Score: 0.0000
2025-06-02 15:43:08,559 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-02 15:43:08,559 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:43:08,559 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:43:08,559 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:43:08,568 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:43:08,575 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:43:08,575 - INFO - Processing node updates/additions.
2025-06-02 15:43:08,576 - INFO - Processing edge updates/additions.
2025-06-02 15:43:08,579 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:08,579 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:08,580 - DEBUG - Updated graph - Nodes: 300, Edges: 503
2025-06-02 15:43:08,580 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:08,580 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:08,583 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-02 15:43:08,584 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:08,584 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-02 15:43:08,585 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-02 15:43:08,585 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:08,586 - DEBUG - Initial edge attributes tensor shape: torch.Size([503, 10])
2025-06-02 15:43:08,587 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:08,587 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([503, 10])
2025-06-02 15:43:08,587 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:08,587 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:08,587 - INFO - Updated main graph to 300 nodes and 503 edges.
2025-06-02 15:43:08,587 - INFO - Performing online update...
2025-06-02 15:43:08,587 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:08,588 - DEBUG - Updated RunningStats: new_mean=0.9347527855032551, new_var=6600000000164.882, new_n=690
2025-06-02 15:43:08,588 - DEBUG - Updated RunningStats: new_mean=0.9262884809244796, new_var=6900000000016.829, new_n=720
2025-06-02 15:43:08,588 - DEBUG - Updated RunningStats: new_mean=35.3009109654796, new_var=2200000197808.722, new_n=230
2025-06-02 15:43:08,588 - DEBUG - Updated RunningStats: new_mean=36.21617990654274, new_var=2300000291814.5024, new_n=240
2025-06-02 15:43:08,588 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:08,588 - DEBUG - Online update step: 1/25
2025-06-02 15:43:08,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,588 - DEBUG - Online update step: 2/25
2025-06-02 15:43:08,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,588 - DEBUG - Online update step: 3/25
2025-06-02 15:43:08,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,588 - DEBUG - Online update step: 4/25
2025-06-02 15:43:08,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,588 - DEBUG - Online update step: 5/25
2025-06-02 15:43:08,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 6/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 7/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 8/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 9/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 10/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 11/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 12/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 13/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 14/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 15/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 16/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 17/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 18/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 19/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 20/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 21/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 22/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 23/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 24/25
2025-06-02 15:43:08,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,589 - DEBUG - Online update step: 25/25
2025-06-02 15:43:08,590 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,590 - WARNING - No successful steps during online update.
2025-06-02 15:43:08,590 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], current edge mean: [ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:43:08,590 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0191
2025-06-02 15:43:08,591 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], edge=[ 1.1849830e-08  4.6719681e+02  0.0000000e+00  0.0000000e+00
  5.6879186e-09 -4.7399318e-10 -3.3179524e-09 -2.8439593e-09
  1.8959727e-09 -2.8439593e-09]
2025-06-02 15:43:08,591 - DEBUG - Updated reference std: node=[0.         0.         1.0016708  1.0016708  0.         0.
 0.         1.0016708  1.0016708  1.0016708  1.0016708  1.0016708
 1.1858089  0.34174448 0.39080855 0.5999907  1.0016708  2.8067029
 2.7072284  1.5051417  0.39080855 0.         1.0016708  1.0016708
 0.         0.         0.         0.         1.0016708  1.0016708 ], edge=[  1.0009955 565.6667      0.          0.          1.0009955   1.0009955
   1.0009955   1.0009954   1.0009955   1.0009955]
2025-06-02 15:43:08,591 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:08,591 - INFO - Running anomaly detection...
2025-06-02 15:43:08,591 - INFO - Starting anomaly detection.
2025-06-02 15:43:08,595 - DEBUG - Node reconstruction errors: [20.649197  11.854633  14.0826845 31.560753  15.543299  16.580626
 14.0826845 26.365656  26.365656  29.315437  26.365656  18.001709
 17.508995  11.765016  26.44412   26.614162  33.752686  26.614164
 25.935137  25.095562  24.989368  26.444124  22.729563  14.119892
 25.278467  29.253012  25.278467  14.791511  24.989368  25.278467
 12.624264  28.158611  14.767736  30.12324   29.253008  24.989887
 19.724537  25.09557   14.654252  19.8129    30.506824  24.98989
 25.095562  25.438322  29.084085  24.535133  37.107277  41.375114
 23.539032  32.88664   35.474174  27.645666  27.69223   21.444502
 19.386312  15.483566  18.6264    22.436152  22.10125   22.101248
 11.926727  28.962294  23.605888  12.336564  23.697409  19.386312
 19.231958  18.37968   23.605888  23.605892  20.929253  17.41295
 26.202202  16.496763  16.404226  17.612177  26.563717  16.6739
 16.272522  15.537359  25.735409  16.191845  21.400705  22.77461
 18.847277  13.615839  17.150545  16.272514  16.424332  16.117947
 21.510323  13.609693  23.452448  15.216411  20.733866  28.58089
 24.580767  16.117947  21.34659   19.989489  16.117949  24.580767
 21.426779  17.879635  20.45847   19.860064  20.609083  12.937161
 24.46514   24.037802  19.540068  25.735415  14.13      16.427565
 16.979498  16.117897  16.661306  13.494483  15.407704  20.733866
 24.580767  23.452448  15.61662   23.452448  17.091738  20.733864
 14.351695  11.262858  16.117949  23.617868  23.603563  20.733866
 20.458467  16.630188  16.11795   19.86007   26.46665   21.34659
 20.733864  16.117952  20.733868  24.580769  21.426775  20.733866
 25.554808  20.733866  16.117949  20.733864  20.654837  20.733866
 25.836264  11.121493  15.325945  20.733864  16.232544  13.417757
 20.733866  16.264284  16.117949  26.573225  20.733866  13.490142
 20.733866  23.603563  17.091736  15.392816  15.9644    15.407702
 11.132625  20.733864  15.407702  20.733866  21.426775  27.106197
 16.117947  13.32395   16.117943  16.360434  20.486492  19.788666
 18.951565  13.650166  20.012917  11.224637  22.601383  16.360434
 20.486492  22.58158   20.486492  19.788666  20.48649   15.999075
 22.58158   19.870571  21.426775  22.581585  20.903257  21.426779
 13.602724  24.580767  21.346592  20.733866  13.867837  22.693565
 16.139751  23.452448  22.685062  16.13919   21.34659   15.464538
 23.553478  19.788666  22.581583  17.091736  16.360434  21.426779
 16.360432  17.091736  19.788668  19.870573  22.601383  20.486492
 20.48649   22.581583  20.733866  15.509304  16.360432  20.733866
 19.788666  23.452444  13.602719  20.486492  16.11795   17.091738
 17.091738  22.581583  15.509305  20.486492  20.733866  23.617868
 22.601383  21.346592  19.788668  20.733864  19.78867   16.117949
 19.78867   16.360434  19.788668  18.908773  21.426779  21.426779
 19.788666  20.733866  17.091736  17.091736  19.788668  20.426226
 20.486492  19.788668  15.975263  22.60138   22.60138   19.788666
 19.788666  19.78867   16.170187  22.60138   16.170187  22.581583
 22.601383  22.601383  15.509304  25.400105  16.170187  22.581583
 20.486492  22.581583  18.951563  19.788668  15.509307  20.486492
 23.553478  25.400112  19.78867   23.426065  16.360434  12.745086
 13.650166  20.012917  22.581587  23.55348   20.636906  19.788666
 20.01292   20.426226  19.788666  20.48649   22.581585  19.657434 ]
2025-06-02 15:43:08,596 - DEBUG - Edge reconstruction errors: [  4.541288    4.45403     6.928918   43.239693    2.1873894  11.395711
  43.222305   43.226074   43.22248     6.944147   43.220795   43.227093
  43.222805   43.27738    43.220985   43.222942   43.223324   43.223324
   8.940084    6.946818   43.236107   43.230167   43.57717    43.220795
  43.285435   43.310196   43.220795   43.22969    43.25209    43.25209
  43.220795   43.24524    43.24524    43.222755   43.225536   43.225536
  43.33364    43.233955   43.22183    43.236557   43.349487   43.349487
  43.22301    43.222755   43.222755   43.22286    43.22284    43.22284
  43.480183   43.222748    6.9562445  43.22312    43.51999    43.22285
  43.230885   43.230885   43.22297   534.2207      6.939426    6.9320335
  43.242012   43.27766    43.27766    43.220985   43.23457    43.222652
  43.222652  807.92316    43.223045   43.22152    43.264954   43.258842
  43.265415   43.31441    43.22927    43.224632   43.224632   11.221176
  43.233486   43.222416   43.222416   43.37272    43.22279    43.230457
  43.222935   43.222694   43.283592   43.227234   43.223476   43.223476
  43.25751    43.227383   43.22304    43.22504    43.22504    43.220795
  43.251442   43.224586   43.224586    6.9523973  43.25674    43.22248
  43.22248    43.220985   43.23324    43.22749    43.22741    43.222603
  43.222603   43.22348    43.222355   43.222355   43.22765    43.228664
  43.222626   43.222626   43.220985   43.222412   43.222412   43.222256
  43.222256   43.243668   43.23535    43.23535    43.222397   43.222397
  43.224365   43.222397   43.222397   43.222633   43.222633   43.23057
  43.23057    43.22274    43.2283     43.2283     43.223305   43.227608
  43.227608   43.223198   43.223198   43.226936   43.226936   43.225243
  43.225243   43.224846   43.224846   43.222694   43.223213   43.222958
  43.227993   43.27173    43.27173    43.22738    43.227425   43.22614
  43.22614    43.223354   43.223354   43.25457    43.25457    43.22285
  43.22331     6.964983    6.970501   43.237793   43.237793   43.242714
  43.242714   43.222862   43.221924   43.221924   43.236465   43.236465
  43.222298   43.227493   43.38595    43.38595    43.220795   43.224266
  12.913253    2.1873894  57.640026   57.640026   45.423717    6.9430785
  43.28794    43.228996   43.224327    6.9441223  43.22686    43.220985
  43.320107   43.22781    43.224766   43.224766   43.240154   43.225567
  43.236595   43.22541    43.228508   43.226223   43.226223   43.228508
  43.228256   43.225983   43.225983    9.978082   43.23243    43.224327
  43.224327   43.224068   43.22339    43.22339    43.223156   43.224022
  43.224022   43.227863   43.22576    43.22576    43.22325    43.22558
  43.22558    43.269573   43.23042    43.23042    43.222897   43.222897
  43.223454   43.235725   43.235725   43.224083   43.289886   43.289886
  43.436974   43.436974   43.220795   43.227024   43.222122   43.224125
  43.223003   43.220795   43.233986   43.233986   43.34065    43.260483
  43.260483   43.2211     43.220795   43.2317     43.2317     43.2211
  43.2232     43.2232     43.22288    43.220985   43.22823    43.220795
  43.220882   43.227047   43.234566   43.22336    43.22336    43.229893
  43.22496    43.22496    43.284622   43.244022   43.22622    43.22622
  43.23473    43.228706   43.228706   43.233932   43.229485   43.22445
  43.22445    43.22799    43.25006    43.235603   43.235603   43.220795
  43.25306    43.258724   43.258724   43.222942   43.22283    43.22283
  43.2275     43.2275     43.227074   43.223198   43.223198   11.221176
  43.222748   43.227036   43.24618    43.22277    43.22277    43.22323
  43.22702    43.226265   43.226265   43.220795   43.299137   43.220795
  43.231148   43.222824   43.226933   43.222878   43.263687   43.22295
  43.220795   43.227802    6.955067   43.2228     43.2228     43.237816
  43.225048   43.222828   43.220985   43.223824   43.24267    43.25284
  43.222744   43.222713   43.223812   43.22279    43.268562   43.220795
  43.23217    43.223152   43.220795   43.22771    43.22771    43.220795
  43.36902     6.966545   43.241505   43.220795   43.223297   43.232647
  43.22295    43.22866    43.2284     43.229504   43.230515   43.22735
  43.22745    43.222847   43.220795   43.26433    43.235607   43.23153
  43.222843   43.220795   43.22323    43.227657   43.221626   43.222965
  43.225307   43.247303   43.22831    43.223473   43.227356   43.234673
  43.23776    43.222965   43.230537   43.220795   43.220795   43.25143
  43.22752     6.9551964  43.22898    43.227596   43.225124   43.22294
  43.222893    6.9551964   6.9551964   6.959573   43.228065   43.222958
  43.228893   43.22353    43.22353    43.22292     4.9525747   4.88251
  43.22123    43.23267    43.23267     6.946244   43.220818    6.9606
  57.62121     2.2931664  45.422215    6.9440928  43.23907    43.22084
  43.2302     43.30239    43.23063    43.225563   43.227184   43.2243
  43.22312    43.637455   43.244274   43.2379     43.22445    43.34355
  43.34355    43.22123    43.23705    43.23003    43.227333    7.028941
   7.4110007  43.223763   43.223473   43.267166   43.221043   43.22241
   7.2981873  12.72111     6.936611   43.23765    43.23765    43.267105
  43.22077    43.220814   43.220818   43.22083    43.23342    43.239147
  43.223286   43.224754   43.229187   43.237267   43.22088    43.22402
  43.22402    43.223614   12.030476   43.22082    43.228264   43.22557
  43.226234   43.228798   43.268257   43.225388   43.255177   43.255177
  43.22509    43.31584   534.2208     43.226395   43.33179    43.33179
  43.384136   43.22832    43.22832    43.23401    43.22282    43.2286
  43.222626   43.22634    43.222626   43.222603   43.26727    43.26727
  43.222603   43.22605    43.223183   43.22271    43.224365   43.22458
  43.221924   43.22439    43.22439    43.230614   43.230614   43.223137
  43.223137   43.27755    43.27755    43.22271    43.224224   43.224113
  43.228153   12.321392    2.257038   57.62316     2.2560084  45.421654
  43.221916    6.9338155  57.62259   534.2208    534.2207   ]
2025-06-02 15:43:08,597 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154308_update_13.json
2025-06-02 15:43:08,598 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:08,600 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154308_update_13.pth and as latest_checkpoint.pth
2025-06-02 15:43:08,600 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.0027
2025-06-02 15:43:08,600 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:43:08,600 - WARNING -   Node ID: 150.171.28.12, Recon Error: 33.7527, MLP Score: 0.0084
2025-06-02 15:43:08,601 - WARNING -   Node ID: 23.33.92.35, Recon Error: 37.1073, MLP Score: 0.0078
2025-06-02 15:43:08,601 - WARNING -   Node ID: 150.171.28.10, Recon Error: 41.3751, MLP Score: 0.0067
2025-06-02 15:43:08,601 - WARNING -   Node ID: ff02::2, Recon Error: 32.8866, MLP Score: 0.0030
2025-06-02 15:43:08,601 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 35.4742, MLP Score: 0.0075
2025-06-02 15:43:08,601 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:43:08,601 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2207, MLP Score: 0.0000
2025-06-02 15:43:08,601 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9232, MLP Score: 0.0000
2025-06-02 15:43:08,601 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2208, MLP Score: 0.0000
2025-06-02 15:43:08,601 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.2208, MLP Score: 0.0000
2025-06-02 15:43:08,601 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 534.2207, MLP Score: 0.0000
2025-06-02 15:43:08,601 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-02 15:43:08,601 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:43:08,601 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:43:08,601 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:43:08,617 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:43:08,625 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:43:08,625 - INFO - Processing node updates/additions.
2025-06-02 15:43:08,627 - INFO - Processing edge updates/additions.
2025-06-02 15:43:08,631 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:08,631 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:08,631 - DEBUG - Updated graph - Nodes: 366, Edges: 657
2025-06-02 15:43:08,631 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:08,632 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:08,635 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-02 15:43:08,637 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:08,637 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-02 15:43:08,637 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-02 15:43:08,638 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:08,639 - DEBUG - Initial edge attributes tensor shape: torch.Size([657, 10])
2025-06-02 15:43:08,640 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:08,640 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([657, 10])
2025-06-02 15:43:08,640 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:08,640 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:08,640 - INFO - Updated main graph to 366 nodes and 657 edges.
2025-06-02 15:43:08,640 - INFO - Performing online update...
2025-06-02 15:43:08,641 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:08,641 - DEBUG - Updated RunningStats: new_mean=0.935834391445297, new_var=7200000000163.704, new_n=750
2025-06-02 15:43:08,641 - DEBUG - Updated RunningStats: new_mean=0.9281153465791945, new_var=7500000000017.779, new_n=780
2025-06-02 15:43:08,641 - DEBUG - Updated RunningStats: new_mean=36.59835155798954, new_var=2400000189420.574, new_n=250
2025-06-02 15:43:08,641 - DEBUG - Updated RunningStats: new_mean=37.12717176287948, new_var=2500000222959.7417, new_n=260
2025-06-02 15:43:08,641 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:08,641 - DEBUG - Online update step: 1/25
2025-06-02 15:43:08,641 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,641 - DEBUG - Online update step: 2/25
2025-06-02 15:43:08,641 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,641 - DEBUG - Online update step: 3/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 4/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 5/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 6/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 7/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 8/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 9/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 10/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 11/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 12/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 13/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 14/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 15/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 16/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 17/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 18/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 19/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 20/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 21/25
2025-06-02 15:43:08,642 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,642 - DEBUG - Online update step: 22/25
2025-06-02 15:43:08,643 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,643 - DEBUG - Online update step: 23/25
2025-06-02 15:43:08,643 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,643 - DEBUG - Online update step: 24/25
2025-06-02 15:43:08,643 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,643 - DEBUG - Online update step: 25/25
2025-06-02 15:43:08,643 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,643 - WARNING - No successful steps during online update.
2025-06-02 15:43:08,643 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], current edge mean: [ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:43:08,643 - DEBUG - Node drift difference: 0.0954, Edge drift difference: 0.0168
2025-06-02 15:43:08,644 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], edge=[ 2.1773385e-09  4.5770471e+02  0.0000000e+00  0.0000000e+00
  4.3546771e-09  7.2577953e-09  5.0804569e-09 -1.0160914e-08
  0.0000000e+00  4.3546771e-09]
2025-06-02 15:43:08,644 - DEBUG - Updated reference std: node=[0.         0.         1.0013689  1.0013689  0.         0.
 0.         1.0013689  1.001369   1.0013689  1.001369   1.0013689
 1.1053125  0.31016898 0.38222542 0.589653   1.0013689  2.9452322
 2.8023348  1.5205975  0.38222542 0.         1.001369   1.001369
 0.         0.         0.         0.         1.0013689  1.0013689 ], edge=[  1.0007619 496.47144     0.          0.          1.0007619   1.0007619
   1.000762    1.0007619   1.0007619   1.000762 ]
2025-06-02 15:43:08,644 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:08,644 - INFO - Running anomaly detection...
2025-06-02 15:43:08,644 - INFO - Starting anomaly detection.
2025-06-02 15:43:08,648 - DEBUG - Node reconstruction errors: [20.60651   12.536704  14.757589  32.22894   15.543189  17.04011
 14.757589  26.737644  26.737642  29.630136  26.737642  18.382484
 18.788557  11.775211  27.026201  27.225878  17.450207  27.225883
 26.802544  25.714231  20.51589   27.026203  24.255827  12.142057
 25.89371   29.947475  25.89371   15.213327  25.512995  25.89371
 13.009805  28.465275  14.968986  30.89991   29.947477  26.687925
 20.407694  25.714228  16.034235  20.30898   31.065264  25.584957
 25.714228  26.168766  29.63925   21.521904  37.397717  14.955624
 24.11459   32.398647  36.656868  28.24571   28.55041   22.171473
 20.035408  15.442743  19.434092  22.989157  22.965816  22.965816
 11.863188  25.469154  24.186552  12.703641  24.444458  20.03541
 19.857433  18.958202  24.186552  24.186552  21.671396  17.933302
 27.070967  16.1709    16.419065  18.122194  27.104504  17.126753
 16.109371  15.97999   26.52853   16.647575  22.034208  23.302107
 19.561947  11.488053  17.609966  15.979986  16.10937   15.916925
 22.166267  13.948783  24.09463   15.588851  18.614946  29.70199
 25.292753  16.536556  20.91231   20.675783  16.536556  25.292753
 25.308592  18.375448  10.897718  20.508795  20.41869   13.419735
 25.18191   26.089691  20.062738  24.449957  14.562388  16.930876
 17.469458  16.536522  17.110075  13.873235  15.820316  21.393673
 20.27065   24.094625  16.047903  14.049274  16.08108   21.393673
 14.807583  11.632511  16.536554  24.303093  22.225586  21.393673
 21.023096  17.073599  16.536556  20.508795  25.047108  21.795815
 21.393673  16.536556  21.393673  18.999298  22.032343  21.393677
 26.357262  16.536495  16.536556  21.393675  19.501102  15.8203125
 26.528069  10.897721  15.737848  21.393677  16.69296   13.811644
 21.393679  16.719404  16.536556  27.307226  21.393673  13.947141
 21.393679  22.225586  17.55177   15.808759  16.43963   15.820319
 11.484436  16.536533  15.820316  20.49959   22.032343  23.279459
 16.536556  13.459556  16.536554  16.819036  15.884323  15.884321
 19.535833  14.063924  18.844297  13.610452  23.182034  16.819033
 21.053883  15.755694  21.053888  20.394274  19.57447   15.177555
 23.339287  20.49959   22.032343  23.339293  21.492558  22.032343
 13.427298  25.292753  21.795824  21.393673  14.295245  15.820314
 16.57758   24.09463   21.335258  16.572958  20.056782  15.258718
 17.365107  15.884321  23.339293  16.536554  16.819035  22.032343
 16.819035  17.55177   15.738086  20.49959   13.525004  21.053885
 21.053888  23.339287  21.393673  15.959948  16.819035  21.393673
 15.201495  24.09463   14.049282  15.88432   16.536554  17.55177
 17.551771  23.339287  15.959949  21.053888  21.393677  24.303093
 13.482795  15.949983  20.394268  16.040974  20.394268  16.536556
 15.884278  16.819035  20.394274  18.727913  22.032343  22.032343
 15.73809   15.820317  17.551771  17.55177   20.394274  20.86392
 21.053885  20.394268  15.789701  23.18203   23.18203   20.394268
 20.394274  18.505018  15.789701  23.18203   15.789701  23.339293
 23.182037  23.182037  15.185199  24.950987  15.789701  23.339287
 21.053888  23.339287  19.535833  20.394274  15.9599495 21.053888
 24.207754  25.88391   20.394274  23.922544  13.532639  13.176803
 14.063922  20.564249  18.50494   24.207754  20.316143  20.394274
 20.56425   20.863924  20.394268  21.053888  23.339293  20.165926
 22.320757  20.01697   20.016968  20.01697   20.016968  20.01697
 20.01697   20.016972  20.01697   20.016972  20.016968  20.016972
 20.016968  22.320763  19.277409  18.454477  15.89701   22.321053
 22.320763  22.40877   20.863926  20.863926  15.959949  20.01697
 21.053885  11.557748  20.017406  20.016966  16.28747   15.7897
 17.14081   22.320757  20.01697   15.7897    20.01697   20.016966
 19.51433   21.053888  20.017414  20.017414  20.016968  20.564249
 20.017412  15.7897    20.01697   15.789701  20.016968  23.046062
 15.870868  24.207754  20.016972  19.57447   23.182032  16.110867
 20.564249  23.339287  20.01697   20.01697   20.86392   20.863924
 16.819035  20.016964  20.017418  20.01697   20.01697   35.05687  ]
2025-06-02 15:43:08,652 - DEBUG - Edge reconstruction errors: [4.5287285e+00 4.4337058e+00 6.9344211e+00 4.3243019e+01 2.1774473e+00
 1.0875714e+01 4.3227242e+01 4.3230373e+01 4.3227375e+01 6.9509501e+00
 4.3225975e+01 4.3228172e+01 4.3237881e+01 4.3227798e+01 4.3271446e+01
 4.3226151e+01 4.3232311e+01 4.3228230e+01 4.3228230e+01 8.6209488e+00
 6.9528933e+00 4.3238445e+01 4.3234882e+01 4.3545712e+01 4.3225975e+01
 4.3284248e+01 4.3332985e+01 4.3225975e+01 4.3233784e+01 4.3251137e+01
 4.3251137e+01 4.3225975e+01 4.3244843e+01 4.3244843e+01 4.3227741e+01
 4.3230171e+01 4.3230171e+01 4.3349236e+01 4.3237873e+01 4.3226860e+01
 4.3238510e+01 4.3328926e+01 4.3328926e+01 4.3227959e+01 4.3227699e+01
 4.3227699e+01 4.3227837e+01 4.3227829e+01 4.3227829e+01 4.3926384e+01
 4.3232327e+01 6.9414110e+00 6.9383397e+00 4.3228096e+01 4.3496296e+01
 4.3227825e+01 4.3234581e+01 4.3234581e+01 4.3227905e+01 5.3422595e+02
 6.9507499e+00 6.9378500e+00 4.3242386e+01 4.3269539e+01 4.3269539e+01
 4.3226151e+01 4.3236744e+01 4.3227562e+01 4.3227562e+01 8.0792810e+02
 4.3227982e+01 4.3226658e+01 4.3266075e+01 4.3260597e+01 4.3228951e+01
 4.3228951e+01 4.3266514e+01 4.3310555e+01 4.3229580e+01 4.3229580e+01
 4.3233620e+01 4.3229420e+01 4.3229420e+01 1.1226336e+01 4.3236641e+01
 4.3227459e+01 4.3227459e+01 4.3359924e+01 4.3231426e+01 4.3231426e+01
 4.3227783e+01 4.3234299e+01 4.3227898e+01 4.3227715e+01 4.3231419e+01
 4.3231419e+01 4.3282608e+01 4.3231792e+01 4.3228386e+01 4.3228386e+01
 4.3259487e+01 4.3231930e+01 4.3227974e+01 4.3229771e+01 4.3229771e+01
 4.3225975e+01 4.3254059e+01 4.3229553e+01 4.3229553e+01 6.9586129e+00
 4.3258255e+01 4.3227455e+01 4.3227455e+01 4.3226151e+01 4.3237297e+01
 4.3232075e+01 4.3231995e+01 4.3227592e+01 4.3227592e+01 4.3228409e+01
 4.3227345e+01 4.3227345e+01 4.3232166e+01 4.3227745e+01 4.3227745e+01
 4.3232983e+01 4.3227547e+01 4.3227547e+01 4.3226151e+01 4.3227406e+01
 4.3227406e+01 4.3227257e+01 4.3227257e+01 4.3246834e+01 4.3238808e+01
 4.3238808e+01 4.3227390e+01 4.3227390e+01 4.3229195e+01 4.3227386e+01
 4.3227386e+01 4.3227581e+01 4.3227581e+01 4.3234463e+01 4.3234463e+01
 4.3227753e+01 4.3232574e+01 4.3232574e+01 4.3228203e+01 4.3231953e+01
 4.3231953e+01 4.3228081e+01 4.3228081e+01 4.3231636e+01 4.3231636e+01
 4.3229576e+01 4.3229576e+01 4.3229702e+01 4.3229702e+01 4.3227699e+01
 4.3228176e+01 4.3227940e+01 4.3232468e+01 4.3227470e+01 4.3227470e+01
 4.3265656e+01 4.3265656e+01 4.3231968e+01 4.3232018e+01 4.3230885e+01
 4.3230885e+01 4.3228287e+01 4.3228287e+01 4.3252228e+01 4.3252228e+01
 4.3227814e+01 4.3228207e+01 6.9712510e+00 6.9763093e+00 4.3239677e+01
 4.3239677e+01 4.3259720e+01 4.3259720e+01 1.7364696e-01 4.3227837e+01
 4.3227001e+01 4.3227001e+01 4.3238335e+01 4.3238335e+01 4.3228039e+01
 4.3227707e+01 4.3227707e+01 4.3232109e+01 4.3232109e+01 6.9744048e+00
 4.3227230e+01 4.3231667e+01 4.3493748e+01 4.3493748e+01 4.3225975e+01
 4.3228714e+01 1.4884558e+01 2.1774473e+00 5.7643726e+01 5.7643726e+01
 4.5428669e+01 6.9474769e+00 4.3318283e+01 4.3232609e+01 4.3228752e+01
 6.9509268e+00 4.3231201e+01 4.3226151e+01 4.3311081e+01 4.3232296e+01
 4.3229553e+01 4.3229553e+01 4.3241783e+01 4.3230103e+01 4.3238262e+01
 4.3230011e+01 4.3232822e+01 4.3241169e+01 4.3241169e+01 4.3232727e+01
 4.3232643e+01 4.3230644e+01 4.3230644e+01 1.1191560e+01 4.3235905e+01
 4.3229134e+01 4.3229134e+01 4.3228806e+01 4.3228313e+01 4.3228313e+01
 4.3228130e+01 4.3235184e+01 4.3235184e+01 4.3232517e+01 4.3238258e+01
 4.3238258e+01 4.3228203e+01 4.3237968e+01 4.3237968e+01 4.3270058e+01
 4.3234581e+01 4.3234581e+01 4.3227989e+01 4.3227989e+01 4.3228340e+01
 4.3250328e+01 4.3250328e+01 4.3228828e+01 4.3280125e+01 4.3280125e+01
 4.3405983e+01 4.3405983e+01 4.3225975e+01 4.3231800e+01 4.3227097e+01
 4.3228615e+01 4.3227959e+01 4.3225975e+01 4.3237728e+01 4.3237728e+01
 4.3322132e+01 4.3290314e+01 4.3290314e+01 4.3226265e+01 4.3225975e+01
 4.3235989e+01 4.3235989e+01 4.3226265e+01 4.3227867e+01 4.3236275e+01
 4.3236275e+01 4.3227844e+01 4.3226151e+01 4.3232567e+01 4.3225975e+01
 4.3226051e+01 4.3231655e+01 4.3238426e+01 4.3228241e+01 4.3228241e+01
 4.3234112e+01 4.3229698e+01 4.3229698e+01 4.3283516e+01 4.3247059e+01
 4.3230949e+01 4.3230949e+01 4.3238426e+01 4.3233170e+01 4.3233170e+01
 4.3237827e+01 4.3233559e+01 4.3229256e+01 4.3229256e+01 4.3232368e+01
 4.3249054e+01 4.3237965e+01 4.3237965e+01 4.3225975e+01 4.3255161e+01
 4.3256252e+01 4.3256252e+01 4.3227898e+01 4.3227833e+01 4.3227833e+01
 4.3231972e+01 4.3231972e+01 4.3238617e+01 4.3228115e+01 4.3228115e+01
 1.1226336e+01 4.3231483e+01 4.3231628e+01 4.3248497e+01 4.3233746e+01
 4.3233746e+01 4.3228279e+01 4.3231621e+01 4.3231121e+01 4.3231121e+01
 4.3225975e+01 4.3288647e+01 4.3244602e+01 4.3244602e+01 4.3225975e+01
 4.3234932e+01 4.3227821e+01 4.3231575e+01 4.3227856e+01 4.3262577e+01
 4.3227909e+01 4.3228817e+01 4.3228817e+01 4.3225975e+01 4.3232227e+01
 4.3299648e+01 4.3299648e+01 6.9612331e+00 4.3227806e+01 4.3227806e+01
 4.3241428e+01 4.3229618e+01 4.3227821e+01 4.3226151e+01 4.3228764e+01
 4.3245842e+01 4.3255123e+01 4.3227749e+01 4.3227718e+01 4.3241306e+01
 4.3227791e+01 4.3269012e+01 4.3229973e+01 4.3229973e+01 4.3225975e+01
 4.3229809e+01 4.3229809e+01 4.3234947e+01 4.3234692e+01 4.3234692e+01
 4.3228127e+01 4.3225975e+01 4.3232315e+01 4.3232315e+01 4.3225975e+01
 4.3235634e+01 4.3235634e+01 4.3345509e+01 4.3229210e+01 4.3229210e+01
 6.9743762e+00 4.3244820e+01 4.3225975e+01 4.3228249e+01 4.3236908e+01
 4.3227921e+01 4.3232994e+01 4.3229092e+01 4.3229092e+01 4.3232780e+01
 4.3228188e+01 4.3228188e+01 4.3233601e+01 4.3228802e+01 4.3228802e+01
 4.3234459e+01 4.3228951e+01 4.3228951e+01 4.3231934e+01 4.3232037e+01
 4.3227837e+01 4.3236774e+01 4.3236774e+01 4.3225975e+01 4.3263939e+01
 4.3228539e+01 4.3228539e+01 4.3239296e+01 4.3227818e+01 4.3227818e+01
 4.3243061e+01 4.3227818e+01 4.3239517e+01 4.3239517e+01 4.3225975e+01
 4.3228188e+01 4.3232231e+01 4.3226757e+01 4.3227921e+01 4.3229797e+01
 4.3268543e+01 4.3232773e+01 4.3228428e+01 4.3231884e+01 4.3238487e+01
 4.3240997e+01 4.3227898e+01 4.3234474e+01 4.3225975e+01 4.3225975e+01
 4.3250256e+01 4.3231983e+01 6.9607968e+00 4.3233269e+01 4.3238243e+01
 4.3229622e+01 4.3227898e+01 4.3227844e+01 6.9607968e+00 6.9607968e+00
 6.9658971e+00 4.3232555e+01 4.3227913e+01 4.3233402e+01 4.3228409e+01
 4.3228409e+01 4.3227879e+01 4.3232201e+01 6.9688134e+00 4.3225975e+01
 4.3252266e+01 7.7427645e+00 4.3232250e+01 4.3228260e+01 4.3233292e+01
 4.3247871e+01 4.3247871e+01 4.3233116e+01 4.3233116e+01 4.3226151e+01
 4.3231537e+01 4.3248928e+01 4.3269993e+01 4.3228786e+01 4.3226234e+01
 4.3231674e+01 4.3227779e+01 4.3235199e+01 4.3231621e+01 4.3229923e+01
 4.3229923e+01 4.3227901e+01 5.2499723e+00 4.9836102e+00 4.3226387e+01
 4.3236816e+01 4.3236816e+01 4.3227406e+01 6.9559326e+00 4.3225990e+01
 6.9728746e+00 5.7626362e+01 2.3020160e+00 4.5427261e+01 6.9568734e+00
 4.3242451e+01 4.3226017e+01 4.3228157e+01 4.3234383e+01 4.3298244e+01
 4.3234703e+01 4.3230263e+01 4.3231121e+01 4.3229214e+01 4.3228081e+01
 4.3623127e+01 4.3247780e+01 4.3241497e+01 4.3229286e+01 4.3338936e+01
 4.3338936e+01 4.3226387e+01 4.3240822e+01 4.3404045e+01 4.3231842e+01
 7.0188494e+00 7.3055282e+00 4.3228695e+01 4.3240398e+01 4.3267754e+01
 4.3226200e+01 4.3230171e+01 7.2229333e+00 1.2726314e+01 6.9431543e+00
 4.3241405e+01 4.3241405e+01 4.3408245e+01 4.3225948e+01 4.3225990e+01
 4.3225990e+01 4.3226006e+01 4.3247612e+01 4.3245670e+01 4.3253181e+01
 4.3227982e+01 4.3229462e+01 4.3233658e+01 4.3259190e+01 4.3226051e+01
 4.3236675e+01 4.3236675e+01 4.3230598e+01 4.3228230e+01 1.0834381e+01
 4.3225994e+01 4.3243584e+01 4.3230297e+01 4.3231136e+01 4.3233116e+01
 4.3266464e+01 4.3229858e+01 4.3316605e+01 4.3316605e+01 4.3229961e+01
 4.3299019e+01 5.3422601e+02 4.3236099e+01 4.3313019e+01 4.3313019e+01
 4.3350491e+01 4.3232471e+01 4.3232471e+01 4.3236736e+01 4.3227768e+01
 4.3248997e+01 4.3434429e+01 4.3254131e+01 4.3277695e+01 4.3236778e+01
 4.3268639e+01 4.3268639e+01 4.3237312e+01 4.3250923e+01 4.3228153e+01
 4.3232353e+01 4.3231487e+01 4.3231487e+01 4.3229221e+01 4.3243347e+01
 4.3231033e+01 4.3229084e+01 4.3229084e+01 4.3228477e+01 4.3234245e+01
 4.3234245e+01 4.3236942e+01 4.3228065e+01 4.3228065e+01 4.3234715e+01
 4.3270546e+01 4.3270546e+01 4.3281506e+01 4.3229099e+01 4.3229023e+01
 4.3232635e+01 4.3244167e+01 4.3244167e+01 4.3231770e+01 4.3230766e+01
 4.3230766e+01 4.3247211e+01 4.3229015e+01 4.3229015e+01 4.3232689e+01
 4.3229542e+01 4.3229542e+01 4.3231361e+01 4.3230934e+01 4.3230934e+01
 4.3231689e+01 4.3247936e+01 4.3232533e+01 4.3232533e+01 4.3238617e+01
 4.3227764e+01 4.3278610e+01 4.3227554e+01 4.3229828e+01 4.3232357e+01
 4.3233444e+01 4.3231789e+01 4.3232502e+01 4.3239021e+01 4.3232029e+01
 4.3227970e+01 4.3227970e+01 4.3228004e+01 4.3230934e+01 4.3234512e+01
 4.3230019e+01 4.3231041e+01 4.3227608e+01 4.3436256e+01 4.3237022e+01
 4.3229912e+01 4.3231514e+01 4.3250168e+01 4.3241356e+01 4.3227650e+01
 4.3228279e+01 4.3227806e+01 4.3230469e+01 4.3323284e+01 4.3227627e+01
 4.3228691e+01 4.3229397e+01 4.3228596e+01 4.3228104e+01 4.3227322e+01
 4.8124062e+01 4.3228935e+01 4.3237141e+01 4.3228279e+01 4.3230537e+01
 4.3227654e+01 4.3227848e+01 4.3227577e+01 4.3227966e+01 4.3239761e+01
 1.2326581e+01 2.2378147e+00 5.7628151e+01 2.2368374e+00 4.5426750e+01
 4.3226971e+01 6.9383478e+00 5.7627625e+01 5.3422607e+02 5.3422595e+02
 1.2325987e+01 1.2326104e+01]
2025-06-02 15:43:08,653 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154308_update_14.json
2025-06-02 15:43:08,653 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:08,656 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154308_update_14.pth and as latest_checkpoint.pth
2025-06-02 15:43:08,656 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.0034
2025-06-02 15:43:08,656 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:43:08,656 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.2289, MLP Score: 0.0060
2025-06-02 15:43:08,656 - WARNING -   Node ID: 13.107.5.93, Recon Error: 31.0653, MLP Score: 0.0047
2025-06-02 15:43:08,656 - WARNING -   Node ID: 23.33.92.35, Recon Error: 37.3977, MLP Score: 0.0084
2025-06-02 15:43:08,656 - WARNING -   Node ID: ff02::2, Recon Error: 32.3986, MLP Score: 0.0034
2025-06-02 15:43:08,656 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 36.6569, MLP Score: 0.0075
2025-06-02 15:43:08,656 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:43:08,656 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2260, MLP Score: 0.0000
2025-06-02 15:43:08,656 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9281, MLP Score: 0.0000
2025-06-02 15:43:08,656 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2260, MLP Score: 0.0000
2025-06-02 15:43:08,657 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.2261, MLP Score: 0.0000
2025-06-02 15:43:08,657 - WARNING -   Source: fe80::3674:28:2588:1274, Target: ff02::fb, Recon Error: 534.2260, MLP Score: 0.0000
2025-06-02 15:43:08,657 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-02 15:43:08,657 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:43:08,657 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:43:08,657 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:43:08,668 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:43:08,678 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:43:08,678 - INFO - Processing node updates/additions.
2025-06-02 15:43:08,680 - INFO - Processing edge updates/additions.
2025-06-02 15:43:08,685 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:08,685 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:08,685 - DEBUG - Updated graph - Nodes: 392, Edges: 753
2025-06-02 15:43:08,686 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:08,686 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:08,690 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-02 15:43:08,691 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:08,691 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-02 15:43:08,692 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-02 15:43:08,692 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:08,694 - DEBUG - Initial edge attributes tensor shape: torch.Size([753, 10])
2025-06-02 15:43:08,695 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:08,695 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([753, 10])
2025-06-02 15:43:08,695 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:08,695 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:08,696 - INFO - Updated main graph to 392 nodes and 753 edges.
2025-06-02 15:43:08,696 - INFO - Performing online update...
2025-06-02 15:43:08,696 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:08,696 - DEBUG - Updated RunningStats: new_mean=0.9366923291696736, new_var=7800000000161.547, new_n=810
2025-06-02 15:43:08,696 - DEBUG - Updated RunningStats: new_mean=0.9296538844306128, new_var=8100000000018.608, new_n=840
2025-06-02 15:43:08,696 - DEBUG - Updated RunningStats: new_mean=37.47554815496984, new_var=2600000195733.5986, new_n=270
2025-06-02 15:43:08,696 - DEBUG - Updated RunningStats: new_mean=38.13658056873706, new_var=2700000277599.8237, new_n=280
2025-06-02 15:43:08,697 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:08,697 - DEBUG - Online update step: 1/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 2/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 3/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 4/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 5/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 6/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 7/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 8/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 9/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 10/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 11/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 12/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 13/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 14/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 15/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 16/25
2025-06-02 15:43:08,697 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,697 - DEBUG - Online update step: 17/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 18/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 19/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 20/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 21/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 22/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 23/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 24/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - DEBUG - Online update step: 25/25
2025-06-02 15:43:08,698 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,698 - WARNING - No successful steps during online update.
2025-06-02 15:43:08,698 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], current edge mean: [-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:43:08,699 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0154
2025-06-02 15:43:08,699 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], edge=[-6.3324990e-09  4.6533334e+02  0.0000000e+00  0.0000000e+00
 -2.5329996e-09 -1.2664998e-09 -4.4327493e-09  1.2664998e-09
 -5.0659992e-09  5.6992491e-09]
2025-06-02 15:43:08,699 - DEBUG - Updated reference std: node=[0.         0.         1.0012779  1.0012779  0.         0.
 0.         1.001278   1.0012779  1.0012779  1.0012779  1.0012779
 1.0559748  0.29992953 0.37355423 0.58165294 1.0012779  3.045268
 2.8914173  1.55179    0.37355423 0.         1.0012779  1.0012779
 0.         0.         0.         0.         1.0012779  1.0012779 ], edge=[  1.0006646 552.8399      0.          0.          1.0006647   1.0006647
   1.0006647   1.0006646   1.0006646   1.0006647]
2025-06-02 15:43:08,700 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:08,700 - INFO - Running anomaly detection...
2025-06-02 15:43:08,700 - INFO - Starting anomaly detection.
2025-06-02 15:43:08,704 - DEBUG - Node reconstruction errors: [20.852545  12.392908  15.154288  32.504955  15.56457   17.25849
 15.154288  26.926264  26.926266  29.822727  26.926266  18.634708
 19.455101  11.795624  27.312555  27.510939  17.729322  27.510942
 27.282345  26.01407   20.784088  27.31255   20.026056  12.304645
 26.197868  30.179443  26.19787   14.969492  25.745401  26.197874
 13.212267  28.630583  15.162527  31.191875  30.179443  27.06345
 17.071535  26.014069  14.916592  20.60008   31.42315   25.894894
 26.014069  26.538603  29.981567  21.836096  37.686577  15.209135
 24.392994  32.92593   37.275757  28.558498  28.884615  22.662292
 20.351633  15.663301  19.88641   23.28895   23.435078  23.435078
 12.0144415 25.813698  24.509798  11.748577  24.76547   18.519709
 19.400932  19.252344  24.5098    24.5098    22.010637  18.157799
 27.447725  16.374645  16.626108  18.344671  27.452515  17.32271
 15.590268  16.183165  26.897968  16.153585  11.110142  23.655582
 19.928474  11.6466465 17.817524  15.689053  16.317417  15.991261
 22.461914  14.166903  24.410393  15.800014  18.921516  30.353924
 25.647686  16.732458  21.197338  21.002567  16.732458  25.647686
 25.6703    18.583967  11.065351  20.82716   20.718725  13.620175
 13.610488  26.491587  20.34891   24.800936  14.30433   14.123585
 16.406778  16.73243   17.319204  13.794867  16.037264  21.723349
 20.56852   24.410393  16.291372  14.290262  16.339724  21.723354
 15.044865  11.802415  16.73246   24.652117  22.563648  21.723349
 21.302942  17.315447  16.732458  20.82716   25.392687  22.06938
 19.990746  16.732456  21.72335   19.230347  22.31284   19.990746
 19.99075   16.73241   16.224003  21.72335   19.812008  16.037264
 26.858076  11.065348  15.943746  21.723354  16.953947  13.558695
 21.72335   16.184454  16.732458  27.671383  21.723349  14.136361
 21.723349  22.563656  16.224     16.04139   16.615091  15.503066
 11.626902  16.732439  16.037268  20.811228  22.31284   23.790136
 15.503064  13.521112  15.5030575 17.01401   16.085567  16.08557
 19.832966  14.314144  19.102335  13.816877  15.541721  16.085562
 21.349379  15.938463  21.349379  20.699543  15.30635   15.353973
 23.666866  20.81123   20.568523  23.666868  21.776577  22.31284
 13.614424  25.647686  22.069384  21.723354  13.898587  15.503064
 16.767239  24.410393  21.659765  16.820095  20.336449  15.419508
 17.586222  16.085571  23.666866  15.349217  16.085566  22.31284
 17.01401   17.75235   15.927252  20.811228  13.700888  20.498363
 21.349377  23.666868  21.723354  16.201206  16.085564  21.723354
 15.386441  24.410397  14.290267  16.08557   16.732458  16.224005
 17.75235   23.666866  16.201206  21.349377  21.72335   24.652117
 13.439717  15.419508  20.699543  16.224003  20.699537  16.73246
 16.08553   17.01401   20.699537  19.022427  22.312841  22.31284
 15.927255  16.037268  17.75235   17.752352  20.699537  21.132347
 21.349377  16.085567  15.29991   23.472332  23.472332  20.699537
 15.38644   18.811993  15.461242  23.472332  15.461237  16.085567
 16.312714  15.541728  15.356794  25.30844   15.965016  16.08557
 21.349375  16.617205  19.832964  16.085567  15.438735  19.507347
 15.386439  26.234589  20.699537  24.247742  13.681692  13.394904
 14.314142  10.962675  18.81198   24.55185   20.61423   20.699543
 20.819836  21.132347  16.085567  16.084993  23.666866  20.410828
 19.811188  20.281364  20.28136   20.281366  20.281368  20.281368
 20.281368  20.281366  20.281366  20.281364  20.281368  15.862885
 20.281366  22.66477   11.679712  18.757149  16.07852   22.638945
 22.664774  22.7482    21.132347  21.132347  15.631834  20.281366
 21.349377  11.729168  20.295347  15.862883  15.299913  15.299912
 15.996495  22.664774  20.281368  15.9650135 20.281368  15.862883
 19.811188  21.349375  20.295343  20.295343  20.281359  20.819836
 20.295343  15.2999115 20.281368  15.965012  20.281366  23.358429
 16.063908  24.551846  20.281364  19.868315  23.472324  16.306849
 20.819836  23.666866  20.281368  20.281366  21.132347  21.132347
 17.014006  20.281364  20.295347  20.281364  20.281364  35.6741
 20.460674  16.306845  19.811188  20.46068   18.759184  19.811186
 19.811188  19.811186  18.75918   20.281366  20.460676  22.401789
 15.522504  20.281366  19.608425  19.811186  19.811188  23.587023
 19.811188  16.306845  18.983728  11.202912  16.11117   20.281366
 24.423168  16.306845 ]
2025-06-02 15:43:08,706 - DEBUG - Edge reconstruction errors: [4.4886112e+00 4.4041433e+00 6.9336438e+00 4.3247383e+01 2.1600118e+00
 1.4199630e+01 4.3227173e+01 4.3229988e+01 4.3227299e+01 6.9505229e+00
 4.3226040e+01 4.3227859e+01 4.3235943e+01 4.3236057e+01 4.3268196e+01
 4.3226181e+01 4.3231365e+01 4.3227947e+01 4.3227947e+01 1.0712887e+01
 6.9363093e+00 6.9403934e+00 4.3237465e+01 4.3233185e+01 4.3496170e+01
 4.3226040e+01 4.3228039e+01 4.3275070e+01 4.3320671e+01 4.3226040e+01
 4.3239883e+01 4.3249359e+01 4.3249359e+01 4.3226040e+01 4.3244148e+01
 4.3244148e+01 4.3231369e+01 4.3231037e+01 4.3229622e+01 4.3229622e+01
 4.3334991e+01 4.3236023e+01 4.3226810e+01 4.3237762e+01 4.3321880e+01
 4.3321880e+01 4.3227715e+01 4.3227520e+01 4.3227520e+01 4.3227608e+01
 4.3227585e+01 4.3227585e+01 4.3910427e+01 4.3231361e+01 6.9400244e+00
 6.9430318e+00 4.3227802e+01 4.3453083e+01 4.3231617e+01 4.3233620e+01
 4.3233620e+01 4.3227680e+01 5.3422601e+02 6.9706140e+00 6.9371610e+00
 4.3241753e+01 4.3268127e+01 4.3268127e+01 4.3226181e+01 4.3236259e+01
 4.3227432e+01 4.3227432e+01 8.0792786e+02 4.3227741e+01 4.3226589e+01
 4.3259575e+01 4.3254944e+01 4.3228462e+01 4.3228462e+01 4.3259922e+01
 4.3297089e+01 4.3229092e+01 4.3229092e+01 4.3232468e+01 4.3233833e+01
 4.3233833e+01 1.1226385e+01 4.3235558e+01 4.3227268e+01 4.3227268e+01
 4.3340858e+01 4.3230556e+01 4.3230556e+01 4.3234722e+01 4.3240742e+01
 4.3227654e+01 4.3227482e+01 4.3230377e+01 4.3230377e+01 4.3273674e+01
 4.3230923e+01 4.3228065e+01 4.3228065e+01 4.3265503e+01 4.3231033e+01
 4.3227737e+01 4.3229252e+01 4.3229252e+01 4.3226040e+01 4.3249352e+01
 4.3228931e+01 4.3228931e+01 6.9572682e+00 4.3264084e+01 4.3227310e+01
 4.3227310e+01 4.3226181e+01 4.3235485e+01 4.3231125e+01 4.3231060e+01
 4.3227409e+01 4.3227409e+01 4.3227848e+01 4.3228073e+01 4.3227211e+01
 4.3227211e+01 4.3231239e+01 4.3227554e+01 4.3227554e+01 4.3231995e+01
 4.3227413e+01 4.3227413e+01 4.3226181e+01 4.3227257e+01 4.3227257e+01
 4.3227139e+01 4.3227139e+01 4.3243416e+01 4.3237038e+01 4.3237038e+01
 4.3227879e+01 4.3227249e+01 4.3227249e+01 4.3228741e+01 4.3227249e+01
 4.3227249e+01 4.3227425e+01 4.3227425e+01 4.3233410e+01 4.3233410e+01
 4.3227520e+01 4.3231705e+01 4.3231705e+01 4.3231815e+01 4.3231186e+01
 4.3231186e+01 4.3227856e+01 4.3227856e+01 4.3230717e+01 4.3230717e+01
 4.3226040e+01 4.3229355e+01 4.3229355e+01 4.3229118e+01 4.3229118e+01
 4.3227867e+01 4.3230583e+01 4.3227871e+01 4.3227676e+01 4.3231499e+01
 4.3227333e+01 4.3227333e+01 4.3263824e+01 4.3263824e+01 4.3232052e+01
 4.3231041e+01 4.3231079e+01 4.3230103e+01 4.3230103e+01 4.3228168e+01
 4.3227982e+01 4.3227982e+01 4.3251083e+01 4.3251083e+01 4.3227867e+01
 4.3227592e+01 4.3227936e+01 6.9690442e+00 6.9420142e+00 4.3227455e+01
 4.3238712e+01 4.3238712e+01 4.3257053e+01 4.3257053e+01 1.6871113e-01
 4.3256996e+01 4.3226830e+01 4.3226830e+01 4.3226891e+01 4.3226891e+01
 4.3237682e+01 4.3237682e+01 4.3227764e+01 4.3227524e+01 4.3227524e+01
 4.3230927e+01 4.3230927e+01 6.9717855e+00 8.6773358e+02 6.9426394e+00
 6.9402108e+00 4.3228035e+01 4.3227608e+01 4.3235809e+01 4.3228107e+01
 4.3238640e+01 4.3314384e+01 4.3240532e+01 4.3227791e+01 4.3237358e+01
 4.3234119e+01 4.3233257e+01 4.3227993e+01 4.3231709e+01 4.3227623e+01
 4.3227661e+01 4.3228004e+01 4.3227596e+01 4.3280571e+01 4.3227474e+01
 4.3228432e+01 4.3227161e+01 4.3231068e+01 4.3742729e+01 4.3742729e+01
 4.3226040e+01 4.3228615e+01 1.4027808e+01 2.1600118e+00 5.7640667e+01
 5.7640667e+01 4.5428261e+01 6.9444094e+00 4.3303654e+01 4.3232147e+01
 4.3228661e+01 6.9505057e+00 4.3230602e+01 4.3226181e+01 4.3300751e+01
 4.3231350e+01 4.3229050e+01 4.3229050e+01 4.3240498e+01 4.3229633e+01
 4.3237755e+01 4.3229515e+01 4.3231865e+01 4.3238720e+01 4.3238720e+01
 4.3231861e+01 4.3231682e+01 4.3229969e+01 4.3229969e+01 1.0095700e+01
 4.3234787e+01 4.3228710e+01 4.3228710e+01 4.3228504e+01 4.3228004e+01
 4.3228004e+01 4.3227833e+01 4.3233799e+01 4.3233799e+01 4.3231419e+01
 4.3236565e+01 4.3236565e+01 4.3227901e+01 4.3301785e+01 4.3301785e+01
 4.3263054e+01 4.3233330e+01 4.3233330e+01 4.3227642e+01 4.3227642e+01
 4.3228050e+01 4.3246876e+01 4.3246876e+01 4.3228512e+01 4.3277336e+01
 4.3277336e+01 4.3983719e+01 4.3983719e+01 4.3226040e+01 4.3230793e+01
 4.3227032e+01 4.3228508e+01 4.3227707e+01 4.3226040e+01 4.3236031e+01
 4.3236031e+01 4.3315300e+01 4.3287239e+01 4.3287239e+01 4.3226273e+01
 4.3226040e+01 4.3234333e+01 4.3234333e+01 4.3226273e+01 4.3227634e+01
 4.3234749e+01 4.3234749e+01 4.3227615e+01 4.3226181e+01 4.3231667e+01
 4.3226040e+01 4.3226101e+01 4.3230785e+01 4.3236485e+01 4.3227974e+01
 4.3227974e+01 4.3232922e+01 4.3229195e+01 4.3229195e+01 4.3274456e+01
 4.3243675e+01 4.3230160e+01 4.3230160e+01 4.3236595e+01 4.3232048e+01
 4.3232048e+01 4.3236004e+01 4.3232586e+01 4.3228806e+01 4.3228806e+01
 4.3231480e+01 4.3247780e+01 4.3237083e+01 4.3237083e+01 4.3226040e+01
 4.3250523e+01 4.3271465e+01 4.3271465e+01 4.3227665e+01 4.3227581e+01
 4.3227581e+01 4.3231117e+01 4.3231117e+01 4.3227898e+01 4.3236584e+01
 4.3237000e+01 4.3237000e+01 1.1226385e+01 4.3230625e+01 4.3230774e+01
 4.3245247e+01 4.3241692e+01 4.3241692e+01 4.3227890e+01 4.3230759e+01
 4.3230213e+01 4.3230213e+01 4.3226040e+01 4.3284370e+01 4.3289551e+01
 4.3289551e+01 4.3226040e+01 4.3233833e+01 4.3348808e+01 4.3348808e+01
 4.3227577e+01 4.3230698e+01 4.3227619e+01 4.3258289e+01 4.3227661e+01
 4.3228424e+01 4.3228424e+01 4.3226040e+01 4.3231346e+01 4.3295372e+01
 4.3295372e+01 6.9598722e+00 4.3227562e+01 4.3227562e+01 4.3238960e+01
 4.3229233e+01 4.3227577e+01 4.3226181e+01 4.3228336e+01 4.3242653e+01
 4.3250378e+01 4.3227516e+01 4.3227493e+01 4.3238869e+01 4.3230125e+01
 4.3230125e+01 4.3227551e+01 4.3262268e+01 4.3229431e+01 4.3229431e+01
 4.3226040e+01 4.3229321e+01 4.3229321e+01 4.3234486e+01 4.3233459e+01
 4.3233459e+01 4.3227825e+01 4.3226040e+01 4.3237282e+01 4.3237282e+01
 4.3231300e+01 4.3231300e+01 4.3226040e+01 4.3233974e+01 4.3233974e+01
 4.3336529e+01 4.3228867e+01 4.3228867e+01 6.9717617e+00 4.3241768e+01
 4.3226040e+01 4.3227932e+01 4.3235062e+01 4.3227669e+01 4.3231991e+01
 4.3228657e+01 4.3228657e+01 4.3231800e+01 4.3227932e+01 4.3227932e+01
 4.3232613e+01 4.3228397e+01 4.3228397e+01 4.3233368e+01 4.3228550e+01
 4.3228550e+01 4.3231010e+01 4.3231094e+01 4.3227592e+01 4.3235222e+01
 4.3235222e+01 4.3226040e+01 4.3258888e+01 4.3228222e+01 4.3228222e+01
 4.3237267e+01 4.3227566e+01 4.3227566e+01 4.3250549e+01 4.3227589e+01
 4.3238144e+01 4.3238144e+01 4.3226040e+01 4.3227882e+01 4.3231247e+01
 4.3226669e+01 4.3227673e+01 4.3229431e+01 4.3263184e+01 4.3655006e+01
 4.3655006e+01 4.3231743e+01 4.3228237e+01 4.3228237e+01 4.3228077e+01
 4.3231010e+01 4.3229771e+01 4.3229771e+01 4.3236565e+01 4.3238869e+01
 4.3227535e+01 4.3227535e+01 4.3227676e+01 4.3233391e+01 4.3229267e+01
 4.3229267e+01 4.3226040e+01 4.3243484e+01 4.3243484e+01 4.3226040e+01
 4.3227730e+01 4.3227730e+01 4.3248817e+01 4.3239265e+01 4.3239265e+01
 4.3231133e+01 6.9593992e+00 4.3232231e+01 4.3229691e+01 4.3229691e+01
 4.3236374e+01 4.3229286e+01 4.3227535e+01 4.3227535e+01 4.3227665e+01
 4.3227623e+01 6.9593992e+00 6.9593992e+00 6.9642563e+00 4.3231552e+01
 4.3228523e+01 4.3228523e+01 4.3231720e+01 4.3232201e+01 4.3228111e+01
 4.3228111e+01 4.3227646e+01 4.3231117e+01 4.3230095e+01 4.3230095e+01
 6.9670677e+00 4.3226040e+01 4.3249847e+01 7.7235413e+00 4.3231380e+01
 4.3227955e+01 4.3232384e+01 4.3262321e+01 4.3262321e+01 4.3232430e+01
 4.3232430e+01 4.3226181e+01 4.3230694e+01 4.3246864e+01 4.3263260e+01
 4.3228672e+01 4.3226246e+01 4.3237171e+01 4.3227547e+01 4.3234154e+01
 4.3230759e+01 4.3229279e+01 4.3229279e+01 4.3227669e+01 4.3248569e+01
 4.3248569e+01 4.3227894e+01 4.3227894e+01 4.3229027e+01 4.3229027e+01
 4.3230366e+01 4.3230366e+01 4.3237362e+01 4.3237362e+01 4.3227821e+01
 4.3227821e+01 5.1548109e+00 4.9743733e+00 4.3226372e+01 4.3242729e+01
 4.3242729e+01 4.3227245e+01 6.9553547e+00 4.3226051e+01 6.9727035e+00
 5.7626354e+01 2.2911637e+00 4.5427116e+01 6.9551382e+00 4.3239887e+01
 4.3226070e+01 4.3227894e+01 4.3233166e+01 4.3287773e+01 4.3233475e+01
 4.3229652e+01 4.3230801e+01 4.3228706e+01 4.3227802e+01 4.3545242e+01
 4.3243938e+01 4.3239029e+01 4.3228813e+01 4.3347763e+01 4.3347763e+01
 4.3226372e+01 4.3238392e+01 4.3694561e+01 4.3230988e+01 7.0140343e+00
 7.2955260e+00 4.3228294e+01 4.3238194e+01 4.3261223e+01 4.3226223e+01
 4.3229744e+01 7.2165847e+00 1.2726341e+01 6.9423923e+00 4.3238861e+01
 4.3238861e+01 4.3600746e+01 4.3226021e+01 4.3226051e+01 4.3226051e+01
 4.3226067e+01 4.3368614e+01 4.3243069e+01 4.3249260e+01 4.3227890e+01
 4.3229027e+01 4.3232418e+01 4.3252998e+01 4.3226097e+01 4.3234974e+01
 4.3234974e+01 4.3229958e+01 4.3228134e+01 1.0723733e+01 4.3226055e+01
 4.3240421e+01 4.3229660e+01 4.3230202e+01 4.3239273e+01 4.3261715e+01
 4.3229485e+01 4.3301388e+01 4.3301388e+01 4.3229309e+01 4.3296394e+01
 5.3422614e+02 4.3234596e+01 4.3308456e+01 4.3308456e+01 4.3346813e+01
 4.3231709e+01 4.3231709e+01 4.3235905e+01 4.3227570e+01 4.3266060e+01
 4.3426338e+01 4.3251175e+01 4.3275196e+01 4.3235409e+01 4.3261410e+01
 4.3261410e+01 4.3235954e+01 4.3246445e+01 4.3227848e+01 4.3231426e+01
 4.3238644e+01 4.3238644e+01 4.3228745e+01 4.3250351e+01 4.3230247e+01
 4.3228745e+01 4.3228745e+01 4.3228149e+01 4.3254631e+01 4.3254631e+01
 4.3235725e+01 4.3231209e+01 4.3231209e+01 4.3233116e+01 4.3309475e+01
 4.3309475e+01 4.3278465e+01 4.3228645e+01 4.3228561e+01 4.3231621e+01
 4.3254738e+01 4.3254738e+01 4.3230927e+01 4.3236656e+01 4.3236656e+01
 4.3244232e+01 4.3228611e+01 4.3228611e+01 4.3231758e+01 4.3235462e+01
 4.3235462e+01 4.3230541e+01 4.3237022e+01 4.3237022e+01 4.3230934e+01
 4.3244007e+01 4.3231468e+01 4.3231468e+01 4.3238091e+01 4.3227562e+01
 4.3276833e+01 4.3227367e+01 4.3229404e+01 4.3231373e+01 4.3232353e+01
 4.3228600e+01 4.3228600e+01 4.3230904e+01 4.3231617e+01 4.3238029e+01
 4.3231117e+01 4.3227688e+01 4.3227688e+01 4.3227695e+01 4.3228447e+01
 4.3230511e+01 4.3234043e+01 4.3229412e+01 4.3228512e+01 4.3228512e+01
 4.3230324e+01 4.3227428e+01 4.3394142e+01 4.3247662e+01 4.3229271e+01
 4.3230900e+01 4.3248589e+01 4.3239223e+01 4.3227467e+01 4.3232460e+01
 4.3227615e+01 4.3230110e+01 4.3424980e+01 4.3227448e+01 4.3228310e+01
 4.3229103e+01 4.3228230e+01 4.3227806e+01 4.3227806e+01 4.3227909e+01
 4.3227127e+01 4.8019367e+01 4.3228588e+01 4.3235352e+01 4.3227989e+01
 4.3238380e+01 4.3227467e+01 4.3227657e+01 4.3227409e+01 4.3227711e+01
 4.3232040e+01 4.3232040e+01 4.3268322e+01 4.3228046e+01 4.3360340e+01
 4.3227478e+01 4.3251282e+01 4.3227501e+01 4.3227692e+01 4.3228455e+01
 4.3228455e+01 1.2326535e+01 2.2107222e+00 5.7627831e+01 2.2099185e+00
 4.5426689e+01 4.3226883e+01 6.9369678e+00 5.7627403e+01 5.3422614e+02
 5.3422601e+02 1.2326052e+01 1.2326156e+01]
2025-06-02 15:43:08,708 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154308_update_15.json
2025-06-02 15:43:08,708 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:08,711 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154308_update_15.pth and as latest_checkpoint.pth
2025-06-02 15:43:08,711 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.0041
2025-06-02 15:43:08,711 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:43:08,711 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.5050, MLP Score: 0.0063
2025-06-02 15:43:08,711 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.1919, MLP Score: 0.0054
2025-06-02 15:43:08,711 - WARNING -   Node ID: 13.107.5.93, Recon Error: 31.4231, MLP Score: 0.0049
2025-06-02 15:43:08,711 - WARNING -   Node ID: 23.33.92.35, Recon Error: 37.6866, MLP Score: 0.0087
2025-06-02 15:43:08,711 - WARNING -   Node ID: ff02::2, Recon Error: 32.9259, MLP Score: 0.0036
2025-06-02 15:43:08,711 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:43:08,711 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2260, MLP Score: 0.0000
2025-06-02 15:43:08,711 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9279, MLP Score: 0.0000
2025-06-02 15:43:08,711 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7336, MLP Score: 0.0000
2025-06-02 15:43:08,711 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2261, MLP Score: 0.0000
2025-06-02 15:43:08,711 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.2261, MLP Score: 0.0000
2025-06-02 15:43:08,712 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-02 15:43:08,712 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:43:08,712 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:43:08,712 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:43:08,726 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:43:08,738 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:43:08,738 - INFO - Processing node updates/additions.
2025-06-02 15:43:08,741 - INFO - Processing edge updates/additions.
2025-06-02 15:43:08,748 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:08,748 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:08,749 - DEBUG - Updated graph - Nodes: 419, Edges: 833
2025-06-02 15:43:08,749 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:08,750 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:08,755 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-02 15:43:08,759 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:08,759 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-02 15:43:08,760 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-02 15:43:08,761 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:08,764 - DEBUG - Initial edge attributes tensor shape: torch.Size([833, 10])
2025-06-02 15:43:08,767 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:08,768 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([833, 10])
2025-06-02 15:43:08,768 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:08,768 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:08,769 - INFO - Updated main graph to 419 nodes and 833 edges.
2025-06-02 15:43:08,769 - INFO - Performing online update...
2025-06-02 15:43:08,769 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:08,770 - DEBUG - Updated RunningStats: new_mean=0.9375496702229122, new_var=8400000000160.704, new_n=870
2025-06-02 15:43:08,770 - DEBUG - Updated RunningStats: new_mean=0.9310258721915188, new_var=8700000000019.0625, new_n=900
2025-06-02 15:43:08,770 - DEBUG - Updated RunningStats: new_mean=38.41121438723181, new_var=2800000191889.318, new_n=290
2025-06-02 15:43:08,771 - DEBUG - Updated RunningStats: new_mean=38.90906321110323, new_var=2900000250867.506, new_n=300
2025-06-02 15:43:08,771 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:08,771 - DEBUG - Online update step: 1/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 2/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 3/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 4/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 5/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 6/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 7/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 8/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 9/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 10/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 11/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 12/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,771 - DEBUG - Online update step: 13/25
2025-06-02 15:43:08,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 14/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 15/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 16/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 17/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 18/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 19/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 20/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 21/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 22/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 23/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 24/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - DEBUG - Online update step: 25/25
2025-06-02 15:43:08,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:08,772 - WARNING - No successful steps during online update.
2025-06-02 15:43:08,773 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], current edge mean: [ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:43:08,773 - DEBUG - Node drift difference: 0.0666, Edge drift difference: 0.0078
2025-06-02 15:43:08,774 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], edge=[ 6.8692025e-09  4.6100961e+02  0.0000000e+00  0.0000000e+00
 -5.7243355e-10  2.2897342e-09 -2.2897342e-09  8.0140703e-09
  0.0000000e+00 -5.7243355e-10]
2025-06-02 15:43:08,774 - DEBUG - Updated reference std: node=[0.        0.        1.0011954 1.0011954 0.        0.        0.
 1.0011954 1.0011954 1.0011954 1.0011954 1.0011954 1.0142751 0.3339817
 0.3747156 0.5714724 1.0011954 3.1244435 2.942724  1.5043986 0.3747156
 0.        1.0011954 1.0011955 0.        0.        0.        0.
 1.0011954 1.0011955], edge=[  1.0006008 526.4626      0.          0.          1.0006008   1.0006007
   1.0006008   1.0006008   1.0006008   1.0006008]
2025-06-02 15:43:08,775 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:08,775 - INFO - Running anomaly detection...
2025-06-02 15:43:08,775 - INFO - Starting anomaly detection.
2025-06-02 15:43:08,791 - DEBUG - Node reconstruction errors: [20.575478  11.788458  14.848845  32.601547  15.75469   17.298374
 14.848845  27.010176  27.010176  29.931925  27.010174  18.849558
 18.990894  11.500872  27.448072  27.57626   18.026957  27.576252
 26.92384   26.147596  21.089708  27.448076  20.37295   12.493543
 26.354086  30.332087  26.354078  15.176099  25.85558   26.354086
 12.686765  28.78107   14.545096  31.34032   30.33209   27.369757
 17.139162  26.1476    14.779883  20.883596  31.5989    26.072014
 26.1476    26.851368  30.092533  22.196665  28.748362  14.332006
 24.590893  33.622116  38.03576   28.786669  29.120571  20.001001
 18.850533  15.874115  19.624186  23.536036  23.382847  23.382849
 12.163255  26.151499  24.757338  11.952511  25.009556  18.850534
 19.750954  18.850534  24.757338  24.757341  18.64993   18.273487
 27.727283  16.48414   16.291864  18.45171   27.744265  17.493599
 15.663058  16.296028  27.198736  16.198345  11.313718  24.000305
 20.266022  11.381243  17.953835  15.799571  16.435     15.644667
 22.79814   13.459634  13.221002  15.863742  18.543148  31.091208
 25.980814  16.853075  21.525927  21.325047  16.853071  25.980814
 26.0893    18.726618  11.266123  21.142302  20.338787  13.842091
 13.908862  27.014942  20.639732  25.185028  14.542786  14.340266
 16.532188  16.85306   16.345999  13.584806  15.631103  19.610899
 20.946665  13.2210045 13.851909  13.221006  16.501102  22.3864
 11.431911  11.042405  16.853075  25.028578  22.930809  20.34249
 21.641666  17.590193  16.853071  21.142303  25.766825  22.388262
 20.34249   16.853075  22.068384  19.406504  22.6392    20.34249
 20.342482  16.853037  16.346     22.068388  20.16287   16.169497
 27.15921   11.266124  16.084356  20.342482  17.082151  13.330018
 19.610895  15.689056  16.853075  28.004234  22.068384  14.349772
 19.610895  22.930807  16.345999  16.305897  16.733555  15.631104
 11.765861  16.853056  16.169495  21.16549   22.639202  24.482908
 15.631102  13.452534  15.631098  15.744727  16.2243    16.224302
 20.149282  14.584579  19.458061  14.04568   15.848078  16.224297
 20.87627   16.00583   20.876272  21.04141   14.95251   15.437728
 24.010975  21.165491  20.946667  24.010977  22.106228  20.17933
 13.800442  25.98081   22.388266  22.068388  14.012687  15.631103
 16.350216  24.742561  22.024496  17.099382  20.710543  15.557715
 17.755117  16.2243    24.010977  15.360631  16.224302  22.6392
 16.224298  16.345997  16.067375  21.16549   13.886213  20.080912
 21.686302  24.010977  22.068388  15.1531925 16.224298  22.068388
 15.5104065 24.742561  14.552664  16.224302  16.853071  16.345999
 16.345997  24.010977  15.510405  21.686304  22.068388  25.028576
 13.620817  15.557717  21.041414  16.345995  21.041414  16.853077
 16.224276  17.186605  21.04141   19.36952   22.6392    22.6392
 16.067373  16.1695    16.521883  16.521887  21.041414  21.448946
 21.686302  16.224298  15.428687  13.0229025 23.80092   21.041414
 15.5104065 19.147652  15.613347  23.80092   15.613347  16.224298
 16.63909   15.848065  15.036857  25.67937   16.102343  16.224298
 21.686302  16.78288   20.149284  16.224304  15.550871  19.843485
 15.510401  26.525923  21.041414  24.55311   13.637908  13.631014
 14.58457   10.903048  19.147638  24.923067  20.985493  21.041418
 21.15659   21.448948  16.2243    16.223959  24.010977  20.734869
 15.633152  20.635868  15.530875  20.635868  20.635866  20.63587
 20.63587   15.989386  20.635868  20.63587   20.63587   15.989387
 20.635866  22.161356  11.906803  14.888022  16.264664  23.006325
 23.025896  23.104448  14.989905  21.448946  15.811431  15.530878
 21.686304  11.9206505 20.661325  15.989388  15.428689  15.428691
 16.147287  23.025892  20.635866  16.102343  20.635868  15.989388
 20.151804  21.686302  20.661325  20.661325  20.635868  21.156593
 20.661325  15.428689  15.530879  15.613348  15.530878  23.713886
 16.230907  17.240568  20.63587   16.224302  23.800926  16.515495
 20.376984  24.010977  20.63587   20.63587   21.448946  21.448946
 17.186607  20.635866  20.66133   20.635866  20.635868  36.45654
 20.056826  16.515495  20.151802  20.846487  19.123983  20.1518
 20.151802  20.151802  14.948983  20.635868  20.846489  19.951565
 15.512773  20.63587   19.951565  20.151804  20.151804  23.979029
 20.151806  16.515495  19.309048  11.400517  16.297905  20.635868
 24.831703  16.515495  20.07302   19.349623  15.7018175 15.7018175
 15.7018175 18.86803   19.867117  18.86803   19.349627  22.07453
 15.7018175 19.867117  20.073019  19.349623  15.096499  19.191563
 22.07453   20.846487  15.701823  19.349623  19.867117  15.7018175
 15.7018175 19.61872   20.354675  15.701821  20.846487 ]
2025-06-02 15:43:08,795 - DEBUG - Edge reconstruction errors: [4.5129595e+00 4.4232168e+00 6.9376230e+00 4.3248653e+01 2.1804047e+00
 1.3268213e+01 4.3231464e+01 4.3233597e+01 4.3231552e+01 6.9509320e+00
 4.3230595e+01 4.3232170e+01 4.3239120e+01 4.3238274e+01 4.3260914e+01
 4.3230728e+01 4.3235107e+01 4.3232193e+01 4.3232193e+01 1.0053064e+01
 6.9395242e+00 6.9430943e+00 4.3238976e+01 4.3237095e+01 4.3457539e+01
 4.3230595e+01 4.3232281e+01 4.3272060e+01 4.3304340e+01 4.3230595e+01
 4.3241920e+01 4.3247379e+01 4.3247379e+01 4.3230595e+01 4.3242859e+01
 4.3242859e+01 4.3234516e+01 4.3234840e+01 4.3233555e+01 4.3233555e+01
 4.3336956e+01 4.3239075e+01 4.3233196e+01 4.3238899e+01 4.3299061e+01
 4.3299061e+01 4.3235733e+01 4.3231812e+01 4.3231812e+01 4.3234943e+01
 4.3231922e+01 4.3231922e+01 4.3679317e+01 4.3235134e+01 6.9426179e+00
 6.9496942e+00 4.3232121e+01 4.3423134e+01 4.3247086e+01 4.3236546e+01
 4.3236546e+01 4.3231964e+01 5.3423053e+02 6.9688196e+00 6.9400306e+00
 4.3241272e+01 4.3258770e+01 4.3258770e+01 4.3230728e+01 4.3237656e+01
 4.3231701e+01 4.3231701e+01 8.0793207e+02 4.3232021e+01 4.3231098e+01
 4.3259232e+01 4.3255348e+01 4.3232761e+01 4.3232761e+01 4.3259556e+01
 4.3290852e+01 4.3233158e+01 4.3233158e+01 4.3236031e+01 4.3237053e+01
 4.3237053e+01 1.1230892e+01 4.3237904e+01 4.3231670e+01 4.3231670e+01
 4.3324787e+01 4.3234516e+01 4.3234516e+01 4.3238045e+01 4.3242386e+01
 4.3231968e+01 4.3231842e+01 4.3234604e+01 4.3234604e+01 4.3270897e+01
 4.3234745e+01 4.3232311e+01 4.3232311e+01 4.3277779e+01 4.3234848e+01
 4.3232010e+01 4.3233295e+01 4.3233295e+01 4.3230595e+01 4.3250751e+01
 4.3233215e+01 4.3233215e+01 6.9571509e+00 4.3262688e+01 4.3231644e+01
 4.3231644e+01 4.3230728e+01 4.3238697e+01 4.3239815e+01 4.3239677e+01
 4.3231747e+01 4.3231747e+01 4.3232155e+01 4.3232338e+01 4.3231564e+01
 4.3231564e+01 4.3235008e+01 4.3231838e+01 4.3231838e+01 4.3235558e+01
 4.3231693e+01 4.3231693e+01 4.3230728e+01 4.3231609e+01 4.3231609e+01
 4.3236919e+01 4.3231499e+01 4.3231499e+01 4.3234798e+01 4.3245525e+01
 4.3239620e+01 4.3239620e+01 4.3232170e+01 4.3231590e+01 4.3231590e+01
 4.3232479e+01 4.3232891e+01 4.3231590e+01 4.3231590e+01 4.3231724e+01
 4.3231724e+01 4.3236519e+01 4.3236519e+01 4.3232552e+01 4.3244701e+01
 4.3235233e+01 4.3235233e+01 4.3232368e+01 4.3240616e+01 4.3234795e+01
 4.3234795e+01 4.3232079e+01 4.3232079e+01 4.3232784e+01 4.3234676e+01
 4.3234676e+01 4.3230595e+01 4.3232224e+01 4.3233013e+01 4.3233013e+01
 4.3232185e+01 4.3233284e+01 4.3233284e+01 4.3232159e+01 4.3244564e+01
 4.3235817e+01 4.3235367e+01 4.3235218e+01 4.3231651e+01 4.3231651e+01
 4.3256542e+01 4.3256542e+01 4.3235718e+01 4.3234882e+01 4.3234917e+01
 4.3234127e+01 4.3234127e+01 4.3232372e+01 4.3232246e+01 4.3232246e+01
 4.3232189e+01 4.3247742e+01 4.3247742e+01 4.3232155e+01 4.3231903e+01
 4.3232178e+01 6.9672689e+00 6.9451447e+00 4.3234596e+01 4.3239758e+01
 4.3239758e+01 4.3253242e+01 4.3253242e+01 1.7924832e-01 4.3251945e+01
 4.3231281e+01 4.3231281e+01 4.3231339e+01 4.3231339e+01 4.3238750e+01
 4.3238750e+01 4.3232079e+01 4.3231815e+01 4.3231815e+01 4.3235107e+01
 4.3235107e+01 6.9692221e+00 8.6773700e+02 6.9446712e+00 6.9425478e+00
 4.3232368e+01 4.3231926e+01 4.3239071e+01 4.3232357e+01 4.3239788e+01
 4.3289909e+01 4.3242138e+01 4.3232063e+01 4.3240517e+01 4.3237125e+01
 4.3235943e+01 4.3232262e+01 4.3235371e+01 4.3231941e+01 4.3231968e+01
 4.3232296e+01 4.3231857e+01 4.3276627e+01 4.3234787e+01 4.3232536e+01
 4.3232677e+01 4.3232147e+01 4.3250896e+01 4.3233292e+01 4.3232677e+01
 6.9819851e+00 4.3254524e+01 6.9867735e+00 4.3231457e+01 4.3234520e+01
 4.3827808e+01 4.3827808e+01 4.3230595e+01 4.3232407e+01 1.5689034e+01
 2.1804047e+00 5.7643360e+01 5.7643360e+01 4.5432537e+01 6.9502916e+00
 4.3309162e+01 4.3235046e+01 4.3232430e+01 6.9509144e+00 4.3234226e+01
 4.3230728e+01 4.3289513e+01 4.3235096e+01 4.3233147e+01 4.3233147e+01
 4.3241241e+01 4.3233467e+01 4.3238621e+01 4.3233425e+01 4.3235435e+01
 4.3241467e+01 4.3241467e+01 4.3235332e+01 4.3235313e+01 4.3233917e+01
 4.3233917e+01 9.6406193e+00 4.3237457e+01 4.3232838e+01 4.3232838e+01
 4.3232571e+01 4.3232265e+01 4.3232265e+01 4.3232140e+01 4.3237152e+01
 4.3237152e+01 4.3235321e+01 4.3239243e+01 4.3239243e+01 4.3232193e+01
 4.3289062e+01 4.3289062e+01 4.3262001e+01 4.3236698e+01 4.3236698e+01
 4.3232082e+01 4.3232082e+01 4.3232277e+01 4.3247753e+01 4.3247753e+01
 4.3232590e+01 4.3266144e+01 4.3266144e+01 4.3778656e+01 4.3778656e+01
 4.3230595e+01 4.3239872e+01 4.3231369e+01 4.3232346e+01 4.3235561e+01
 4.3230595e+01 4.3238911e+01 4.3238911e+01 4.3236881e+01 4.3294643e+01
 4.3272697e+01 4.3272697e+01 4.3230812e+01 4.3233322e+01 4.3230728e+01
 4.3237801e+01 4.3237801e+01 4.3235233e+01 4.3230812e+01 4.3242561e+01
 4.3237911e+01 4.3237911e+01 4.3235088e+01 4.3230728e+01 4.3247650e+01
 4.3230595e+01 4.3232712e+01 4.3230659e+01 4.3239239e+01 4.3239475e+01
 4.3232197e+01 4.3232197e+01 4.3236370e+01 4.3233238e+01 4.3233238e+01
 4.3271542e+01 4.3245647e+01 4.3234169e+01 4.3234169e+01 4.3245613e+01
 4.3235744e+01 4.3235744e+01 4.3245449e+01 4.3235905e+01 4.3232933e+01
 4.3232933e+01 4.3240334e+01 4.3245811e+01 4.3238625e+01 4.3238625e+01
 4.3230595e+01 4.3260006e+01 4.3263374e+01 4.3263374e+01 4.3238380e+01
 4.3231934e+01 4.3231934e+01 4.3234856e+01 4.3234856e+01 4.3232185e+01
 4.3239647e+01 4.3239864e+01 4.3239864e+01 1.1230892e+01 4.3234535e+01
 4.3234638e+01 4.3246490e+01 4.3255157e+01 4.3255157e+01 4.3232277e+01
 4.3234638e+01 4.3234341e+01 4.3234341e+01 4.3230595e+01 4.3272263e+01
 4.3274929e+01 4.3274929e+01 4.3230595e+01 4.3236839e+01 4.3315651e+01
 4.3315651e+01 4.3231926e+01 4.3234608e+01 4.3231945e+01 4.3255886e+01
 4.3231972e+01 4.3232628e+01 4.3232628e+01 4.3230595e+01 4.3235023e+01
 4.3279202e+01 4.3279202e+01 6.9596477e+00 4.3231911e+01 4.3231911e+01
 4.3241634e+01 4.3233120e+01 4.3231926e+01 4.3230728e+01 4.3232601e+01
 4.3244797e+01 4.3251434e+01 4.3231869e+01 4.3231846e+01 4.3241547e+01
 4.3239529e+01 4.3239529e+01 4.3231903e+01 4.3261215e+01 4.3233433e+01
 4.3233433e+01 4.3230595e+01 4.3233299e+01 4.3233299e+01 4.3236507e+01
 4.3236763e+01 4.3236763e+01 4.3234871e+01 4.3230595e+01 4.3238747e+01
 4.3238747e+01 4.3235153e+01 4.3235153e+01 4.3232185e+01 4.3230595e+01
 4.3237572e+01 4.3237572e+01 4.3310463e+01 4.3232841e+01 4.3232841e+01
 6.9692011e+00 4.3244080e+01 4.3230595e+01 4.3232231e+01 4.3238472e+01
 4.3231987e+01 4.3235573e+01 4.3232822e+01 4.3232822e+01 4.3235428e+01
 4.3232162e+01 4.3232162e+01 4.3235943e+01 4.3232628e+01 4.3232628e+01
 4.3236534e+01 4.3232716e+01 4.3232716e+01 4.3234859e+01 4.3234932e+01
 4.3231930e+01 4.3238235e+01 4.3238235e+01 4.3230595e+01 4.3257133e+01
 4.3232407e+01 4.3232407e+01 4.3240067e+01 4.3231926e+01 4.3231926e+01
 4.3250458e+01 4.3231911e+01 4.3239868e+01 4.3239868e+01 4.3230595e+01
 4.3232185e+01 4.3235073e+01 4.3231171e+01 4.3231979e+01 4.3233223e+01
 4.3260189e+01 4.3530083e+01 4.3530083e+01 4.3235451e+01 4.3232422e+01
 4.3232422e+01 4.3232361e+01 4.3234806e+01 4.3233841e+01 4.3233841e+01
 4.3239506e+01 4.3241188e+01 4.3231895e+01 4.3231895e+01 4.3231956e+01
 4.3236542e+01 4.3233227e+01 4.3233227e+01 4.3230595e+01 4.3242626e+01
 4.3242626e+01 4.3230595e+01 4.3232136e+01 4.3232136e+01 4.3246647e+01
 4.3240513e+01 4.3240513e+01 4.3234848e+01 6.9590616e+00 4.3235752e+01
 4.3233639e+01 4.3233639e+01 4.3239319e+01 4.3233101e+01 4.3231899e+01
 4.3231899e+01 4.3231964e+01 4.3231922e+01 6.9590616e+00 6.9387703e+00
 6.9391260e+00 6.9629197e+00 4.3235294e+01 4.3232700e+01 4.3232700e+01
 4.3235394e+01 4.3235931e+01 4.3293678e+01 4.3293678e+01 4.3231949e+01
 4.3235111e+01 4.3234283e+01 4.3234283e+01 6.9655085e+00 4.3230595e+01
 4.3248421e+01 7.7209773e+00 4.3235035e+01 4.3232224e+01 4.3235710e+01
 4.3233135e+01 4.3233135e+01 4.3258934e+01 4.3258934e+01 4.3235493e+01
 4.3235493e+01 4.3230728e+01 4.3234577e+01 4.3246147e+01 4.3243355e+01
 4.3243355e+01 4.3261814e+01 4.3232464e+01 4.3230785e+01 4.3240242e+01
 4.3236916e+01 4.3236916e+01 4.3234634e+01 4.3236977e+01 4.3232033e+01
 4.3232033e+01 4.3234631e+01 4.3233456e+01 4.3233456e+01 4.3231964e+01
 4.3249275e+01 4.3249275e+01 4.3232197e+01 4.3232197e+01 4.3233021e+01
 4.3233021e+01 4.3234249e+01 4.3234249e+01 4.3238667e+01 4.3238667e+01
 4.3232105e+01 4.3232105e+01 6.9727602e+00 4.3231922e+01 4.3342716e+01
 4.3235832e+01 4.3231937e+01 6.9867735e+00 4.3235466e+01 4.3234947e+01
 4.3234924e+01 4.3235382e+01 5.1491103e+00 4.9694190e+00 4.3230896e+01
 4.3244957e+01 4.3244957e+01 4.3231617e+01 6.9571857e+00 4.3230606e+01
 6.9710226e+00 5.7630878e+01 2.3004777e+00 4.5431515e+01 6.9570780e+00
 4.3242302e+01 4.3230625e+01 4.3232140e+01 4.3236565e+01 4.3281563e+01
 4.3236759e+01 4.3233639e+01 4.3234032e+01 4.3232933e+01 4.3232101e+01
 4.3521263e+01 4.3246349e+01 4.3241680e+01 4.3232964e+01 4.3363625e+01
 4.3363625e+01 4.3230896e+01 4.3241238e+01 4.3696846e+01 4.3234764e+01
 6.9982324e+00 1.0607139e+01 4.3232555e+01 4.3240860e+01 4.3260334e+01
 4.3230766e+01 4.3233494e+01 7.1300421e+00 1.2730867e+01 6.9461904e+00
 4.3241673e+01 4.3241673e+01 4.3582916e+01 4.3230671e+01 4.3230602e+01
 4.3230606e+01 4.3230621e+01 4.3419239e+01 4.3244377e+01 4.3249783e+01
 4.3231941e+01 4.3233051e+01 4.3236107e+01 4.3254761e+01 4.3230656e+01
 4.3247353e+01 4.3247353e+01 4.3233875e+01 4.3232094e+01 1.2790656e+01
 4.3230606e+01 4.3243362e+01 4.3233681e+01 4.3234367e+01 4.3241730e+01
 4.3258553e+01 4.3233269e+01 4.3387703e+01 4.3387703e+01 4.3233475e+01
 4.3277924e+01 5.3423065e+02 4.3237782e+01 4.3287754e+01 4.3287754e+01
 4.3310844e+01 4.3235115e+01 4.3235115e+01 4.3237831e+01 4.3231865e+01
 4.3264992e+01 4.3365917e+01 4.3249882e+01 4.3264454e+01 4.3238140e+01
 4.3261253e+01 4.3261253e+01 4.3238472e+01 4.3248665e+01 4.3232162e+01
 4.3235119e+01 4.3241692e+01 4.3241692e+01 4.3232918e+01 4.3251217e+01
 4.3234215e+01 4.3232765e+01 4.3232765e+01 4.3232380e+01 4.3253197e+01
 4.3253197e+01 4.3238163e+01 4.3234982e+01 4.3234982e+01 4.3236961e+01
 4.3288506e+01 4.3288506e+01 4.3267136e+01 4.3232838e+01 4.3232792e+01
 4.3235344e+01 4.3255692e+01 4.3255692e+01 4.3234711e+01 4.3239937e+01
 4.3239937e+01 4.3245541e+01 4.3232761e+01 4.3232761e+01 4.3235344e+01
 4.3238716e+01 4.3238716e+01 4.3234444e+01 4.3239933e+01 4.3239933e+01
 4.3234615e+01 4.3246498e+01 4.3245106e+01 4.3245106e+01 4.3238857e+01
 4.3231857e+01 4.3264652e+01 4.3258839e+01 4.3258839e+01 4.3231728e+01
 4.3233280e+01 4.3235157e+01 4.3235901e+01 4.3232750e+01 4.3232750e+01
 4.3234749e+01 4.3235199e+01 4.3239357e+01 4.3234917e+01 4.3232029e+01
 4.3232029e+01 4.3232063e+01 4.3232624e+01 4.3233971e+01 4.3236240e+01
 4.3233494e+01 4.3232689e+01 4.3232689e+01 4.3234196e+01 4.3234413e+01
 4.3234413e+01 4.3231750e+01 4.3233421e+01 4.3233421e+01 4.3384972e+01
 4.3249401e+01 4.3233437e+01 4.3234444e+01 4.3246666e+01 4.3241417e+01
 4.3231781e+01 4.3233742e+01 4.3233742e+01 4.3249256e+01 4.3231884e+01
 4.3233646e+01 4.3233349e+01 4.3233349e+01 4.3363472e+01 4.3231766e+01
 4.3234276e+01 4.3234276e+01 4.3232536e+01 4.3232937e+01 4.3232471e+01
 4.3232079e+01 4.3232079e+01 4.3232071e+01 4.3231586e+01 4.6364849e+01
 4.3232674e+01 4.3238586e+01 4.3232231e+01 4.3241776e+01 4.3231781e+01
 4.3231903e+01 4.3231735e+01 4.3233665e+01 4.3233665e+01 4.3232018e+01
 4.3235931e+01 4.3235931e+01 4.3262184e+01 4.3232330e+01 4.3501324e+01
 4.3231796e+01 4.3252880e+01 4.3231812e+01 4.3232002e+01 4.3232674e+01
 4.3232674e+01 4.3235542e+01 4.3235542e+01 4.3236889e+01 4.3236889e+01
 4.3234795e+01 4.3234795e+01 4.3236092e+01 4.3292038e+01 4.3292038e+01
 4.3237286e+01 4.3237286e+01 4.3273289e+01 4.3265522e+01 4.3265522e+01
 4.3253868e+01 4.3240059e+01 4.3240059e+01 4.3294781e+01 4.3294781e+01
 4.3270622e+01 4.3270622e+01 4.3282997e+01 4.3282997e+01 4.3323284e+01
 4.3323284e+01 1.2331057e+01 2.2384501e+00 5.7632160e+01 2.2377446e+00
 4.5431149e+01 4.3232773e+01 6.9415021e+00 5.7631783e+01 5.3423065e+02
 5.3423053e+02 1.2330611e+01 1.2330706e+01]
2025-06-02 15:43:08,799 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154308_update_16.json
2025-06-02 15:43:08,800 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:08,803 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154308_update_16.pth and as latest_checkpoint.pth
2025-06-02 15:43:08,804 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.0046
2025-06-02 15:43:08,804 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:43:08,804 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.6015, MLP Score: 0.0065
2025-06-02 15:43:08,804 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.3403, MLP Score: 0.0057
2025-06-02 15:43:08,804 - WARNING -   Node ID: 13.107.5.93, Recon Error: 31.5989, MLP Score: 0.0051
2025-06-02 15:43:08,804 - WARNING -   Node ID: ff02::2, Recon Error: 33.6221, MLP Score: 0.0038
2025-06-02 15:43:08,804 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 38.0358, MLP Score: 0.0078
2025-06-02 15:43:08,804 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:43:08,804 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2305, MLP Score: 0.0000
2025-06-02 15:43:08,804 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9321, MLP Score: 0.0000
2025-06-02 15:43:08,804 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7370, MLP Score: 0.0000
2025-06-02 15:43:08,804 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2307, MLP Score: 0.0000
2025-06-02 15:43:08,805 - WARNING -   Source: fe80::eb4e:a54d:8c61:6ce1, Target: ff02::fb, Recon Error: 534.2307, MLP Score: 0.0000
2025-06-02 15:43:08,824 - DEBUG - Embedding standard deviations before t-SNE: [1.3760324  0.01860937 0.9251041  1.6051663  0.         0.68423176
 0.86317074 0.50863296 0.68141586 2.489788   1.9873608  1.9798565
 1.2265898  0.7293793  1.2890582  1.2321569  0.16833366 0.825745
 0.         1.2582914  0.26440227 1.7436703  0.         0.25722364
 0.5828387  0.75642246 0.02484085 1.4542073  2.1935444  0.
 1.2369183  1.2912558 ]
2025-06-02 15:43:09,293 - INFO - Embeddings visualization saved to vis/embeddings_16_updates_20250602_154308.png
2025-06-02 15:43:09,293 - INFO - Performing visualization of node and edge features.
2025-06-02 15:43:09,293 - INFO - Starting visualization of node features.
2025-06-02 15:43:09,294 - INFO - Graph has 419 nodes and 30 features.
2025-06-02 15:43:09,294 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:43:09,294 - INFO - Calculating feature statistics:
2025-06-02 15:43:09,294 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,294 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,294 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.551785), 'max': np.float32(1.4956648)}
2025-06-02 15:43:09,294 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(-3.641716e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4676753), 'max': np.float32(2.5807602)}
2025-06-02 15:43:09,294 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,294 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,294 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,294 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.4141085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.41278455), 'max': np.float32(2.4225714)}
2025-06-02 15:43:09,294 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.13803615e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.2852621), 'max': np.float32(0.77805144)}
2025-06-02 15:43:09,295 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-7.1329055), 'max': np.float32(0.14374286)}
2025-06-02 15:43:09,295 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-3.6133795), 'max': np.float32(1.0095472)}
2025-06-02 15:43:09,295 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(1.820858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9946777), 'max': np.float32(3.6515121)}
2025-06-02 15:43:09,295 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 6, 'mean': np.float32(2.4582338), 'std': np.float32(1.0130639), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 15:43:09,295 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9427207), 'std': np.float32(0.3335829), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:43:09,295 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:09,295 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3436756), 'std': np.float32(0.5707901), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:43:09,295 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.14374286), 'max': np.float32(7.1329055)}
2025-06-02 15:43:09,295 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.4797137), 'std': np.float32(3.120713), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:43:09,295 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.646778), 'std': np.float32(2.9392102), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:09,295 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6062055), 'std': np.float32(1.5026023), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:09,295 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:09,295 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:43:09,296 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(4.09693e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.15512793), 'max': np.float32(12.03211)}
2025-06-02 15:43:09,296 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.3656434e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.17170915), 'max': np.float32(5.823802)}
2025-06-02 15:43:09,296 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,296 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,296 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,296 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:09,296 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-3.1865014e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0751959), 'max': np.float32(8.647978)}
2025-06-02 15:43:09,296 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.9346615e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2040381), 'max': np.float32(4.401428)}
2025-06-02 15:43:09,307 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09ca8f20>
2025-06-02 15:43:09,444 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:43:09,494 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:43:09,521 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:10,847 - INFO - Node feature visualization saved to vis/node_features_20250602_154309.png
2025-06-02 15:43:10,847 - INFO - Finished visualization of node features.
2025-06-02 15:43:10,847 - INFO - Performing additional feature analysis:
2025-06-02 15:43:10,847 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:10,848 - INFO - Starting visualization of edge features.
2025-06-02 15:43:10,848 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:43:10,848 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:10,848 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:10,848 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:10,849 - INFO - - count: {'name': 'count', 'unique': 21, 'mean': np.float32(9.158937e-09), 'std': np.float32(1.0), 'min': np.float32(-0.068577066), 'max': np.float32(19.334204)}
2025-06-02 15:43:10,849 - INFO - - dst_port: {'name': 'dst_port', 'unique': 13, 'mean': np.float32(461.0096), 'std': np.float32(526.1465), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:43:10,849 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:10,849 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:10,849 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 558, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.113668054), 'max': np.float32(19.650415)}
2025-06-02 15:43:10,849 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 595, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.103927135), 'max': np.float32(19.133986)}
2025-06-02 15:43:10,849 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 206, 'mean': np.float32(6.8692025e-09), 'std': np.float32(1.0), 'min': np.float32(-0.087794885), 'max': np.float32(19.02295)}
2025-06-02 15:43:10,849 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 570, 'mean': np.float32(2.2897342e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.10684508), 'max': np.float32(21.271181)}
2025-06-02 15:43:10,849 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 590, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.109008655), 'max': np.float32(21.061152)}
2025-06-02 15:43:10,849 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 222, 'mean': np.float32(-4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10469742), 'max': np.float32(18.49781)}
2025-06-02 15:43:10,859 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c098dcec0>
2025-06-02 15:43:10,935 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:10,945 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c1815b110>
2025-06-02 15:43:11,015 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:11,249 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:11,381 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:11,395 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:11,401 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:12,575 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154311.png
2025-06-02 15:43:12,575 - INFO - Finished visualization of edge features.
2025-06-02 15:43:12,575 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:12,575 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:12,575 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:43:12,576 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:12,576 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:43:12,576 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:12,864 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154312_summary.png
2025-06-02 15:43:13,232 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154312_pca_3d.png
2025-06-02 15:43:13,393 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154312_pca_variance.png
2025-06-02 15:43:13,393 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:13,393 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-02 15:43:13,393 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:43:13,393 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:43:13,393 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:43:13,402 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:43:13,410 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:43:13,410 - INFO - Processing node updates/additions.
2025-06-02 15:43:13,413 - INFO - Processing edge updates/additions.
2025-06-02 15:43:13,417 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:13,417 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:13,418 - DEBUG - Updated graph - Nodes: 439, Edges: 919
2025-06-02 15:43:13,418 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:13,418 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:13,422 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-02 15:43:13,423 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:13,423 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-02 15:43:13,424 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-02 15:43:13,424 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:13,427 - DEBUG - Initial edge attributes tensor shape: torch.Size([919, 10])
2025-06-02 15:43:13,428 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:13,428 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([919, 10])
2025-06-02 15:43:13,428 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:13,429 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:13,429 - INFO - Updated main graph to 439 nodes and 919 edges.
2025-06-02 15:43:13,429 - INFO - Performing online update...
2025-06-02 15:43:13,429 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:13,430 - DEBUG - Updated RunningStats: new_mean=0.9383308154483265, new_var=9000000000159.291, new_n=930
2025-06-02 15:43:13,430 - DEBUG - Updated RunningStats: new_mean=0.9323558082069221, new_var=9300000000019.541, new_n=960
2025-06-02 15:43:13,430 - DEBUG - Updated RunningStats: new_mean=39.167474167402915, new_var=3000000198753.13, new_n=310
2025-06-02 15:43:13,431 - DEBUG - Updated RunningStats: new_mean=39.68736580816862, new_var=3100000275188.3403, new_n=320
2025-06-02 15:43:13,431 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:13,431 - DEBUG - Online update step: 1/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 2/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 3/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 4/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 5/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 6/25
2025-06-02 15:43:13,431 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,431 - DEBUG - Online update step: 7/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 8/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 9/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 10/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 11/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 12/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 13/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 14/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 15/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,432 - DEBUG - Online update step: 16/25
2025-06-02 15:43:13,432 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 17/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 18/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 19/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 20/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 21/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 22/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 23/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 24/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,433 - DEBUG - Online update step: 25/25
2025-06-02 15:43:13,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,434 - WARNING - No successful steps during online update.
2025-06-02 15:43:13,434 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], current edge mean: [ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:43:13,435 - DEBUG - Node drift difference: 0.0619, Edge drift difference: 0.0156
2025-06-02 15:43:13,435 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], edge=[ 1.0377305e-09  4.6919803e+02  0.0000000e+00  0.0000000e+00
 -3.1131915e-09  5.1886526e-09  5.1886523e-10  7.2641133e-09
 -8.3018437e-09 -3.1131915e-09]
2025-06-02 15:43:13,436 - DEBUG - Updated reference std: node=[0.         0.         1.0011408  1.0011408  0.         0.
 0.         1.0011408  1.001141   1.001141   1.0011408  1.001141
 1.003074   0.3264865  0.39457318 0.56690574 1.001141   3.2002099
 2.9714756  1.5429286  0.39457318 0.         1.001141   1.0011408
 0.         0.         0.         0.         1.001141   1.001141  ], edge=[  1.0005445 551.03625     0.          0.          1.0005445   1.0005445
   1.0005445   1.0005445   1.0005445   1.0005445]
2025-06-02 15:43:13,436 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:13,436 - INFO - Running anomaly detection...
2025-06-02 15:43:13,436 - INFO - Starting anomaly detection.
2025-06-02 15:43:13,444 - DEBUG - Node reconstruction errors: [20.865116  11.782382  15.1795435 32.722546  15.389285  16.638618
 15.1795435 27.302376  27.302376  30.237122  27.302376  19.245617
 19.397175  11.651101  27.821993  27.910065  18.52243   27.91006
 27.391352  26.487219  21.550568  27.821993  20.831736  12.74609
 26.758343  30.454037  26.758343  15.053877  26.175758  26.758348
 13.099573  29.111185  14.650609  31.502424  30.454039  28.024925
 16.709013  26.487219  14.907472  12.494858  32.15297   26.442526
 26.48722   27.532354  30.572136  19.630724  29.532738  14.692666
 24.980724  33.39677   38.605537  29.254639  29.34129   20.625866
 19.163332  16.131037  19.40998   23.94324   23.700964  23.700958
 12.343596  26.80765   25.170103  11.750417  25.275822  19.163342
 20.080927  19.163338  25.1701    25.170097  18.965115  18.452692
 28.009117  16.688326  16.44386   18.630959  28.426277  17.705336
 15.854641  16.498653  27.533165  16.384853  11.529102  24.58451
 19.038885  11.574082  18.155735  16.005444  16.641468  15.79387
 23.111029  13.627741  13.49714   15.142582  18.988008  31.608032
 26.336096  17.05937   21.975912  21.648054  17.059366  26.336111
 26.501009  18.91378   11.475628  21.463362  20.680193  14.026366
 14.189347  25.696709  18.503817  25.542814  14.803304  14.06049
 16.73832   17.059343  16.553625  13.828188  15.864066  19.954905
 21.287981  13.497141  14.100203  13.497133  16.7165    22.785913
 11.65145   11.229679  17.059366  23.670061  23.530767  20.684225
 21.945425  16.921999  16.111523  19.089853  26.41061   22.847416
 20.684221  12.963663  19.954906  18.564363  20.526587  20.684221
 20.684221  17.059332  16.553623  22.392256  20.64044   15.394959
 27.498577  11.475629  16.239992  20.684225  17.287289  13.543397
 19.954905  15.871262  17.059368  28.378407  22.39226   14.5412445
 19.954906  23.530771  16.553625  13.632559  16.876326  15.394963
 11.952086  15.394947  16.37065   19.954906  22.944437  24.991716
 15.394963  13.063861  15.394958  15.975736  16.432606  16.432606
 20.466978  14.847799  19.786383  14.29985   16.11753   16.432606
 21.211699  16.197079  21.211699  21.36983   14.947841  15.643156
 24.372688  21.501259  21.287981  24.372688  22.408016  20.526587
 14.047057  23.670057  22.84742   22.39226   14.254339  15.864062
 16.55692   13.497137  22.596962  16.375765  21.17726   15.733461
 17.990887  16.432606  24.372694  15.573532  16.43261   22.94444
 16.432608  16.553627  16.285494  21.501265  13.620073  20.439018
 21.99725   24.372686  22.39226   15.385104  16.432606  22.39226
 15.742359  25.068764  14.820738  16.432606  15.39496   16.553623
 16.553623  24.372688  15.742356  21.99725   22.392256  25.39062
 13.386835  15.320053  21.36983   15.394967  21.36983   16.263107
 15.8598    17.395105  21.36983   19.704554  22.94444   22.944437
 16.2855    16.370646  16.111528  16.738016  21.36983   21.890587
 21.99725   16.432608  15.602262  13.2825575 24.132753  21.369822
 15.7423525 19.56826   15.801419  24.132755  15.801416  16.432608
 16.92311   16.117537  15.225725  26.335102  16.274769  16.43261
 19.464573  17.050823  20.466972  16.43261   15.831753  20.16252
 15.385093  27.203674  21.369822  25.127716  12.877307  13.84461
 14.847804  11.0777445 18.862293  25.277178  21.465525  21.36983
 21.459475  21.890585  16.432608  16.432259  24.372688  21.042698
 15.860548  21.073025  15.7158785 15.7158785 21.073023  21.073023
 21.073023  16.173397  21.073023  21.073025  21.073025  16.173399
 21.073023  22.556635  11.627293  15.062809  16.478033  23.340197
 23.421406  23.49652   15.3190155 21.890585  16.048468  15.715879
 20.439014  13.870886  21.118435  16.173397  15.602262  15.602262
 16.321665  23.4214    21.073025  16.274769  21.073023  16.173397
 19.735155  21.997248  21.118433  21.118433  21.073023  21.459475
 21.11844   15.319018  15.715879  15.801416  15.7158785 24.266287
 16.458986  17.4899    21.073023  15.975736  24.132757  16.755722
 20.698181  24.372688  21.073023  21.073025  21.890587  21.890587
 17.395105  21.073023  21.118433  15.7155695 15.715857  23.877506
 20.408892  16.755724  15.860547  16.010149  15.177295  15.860543
 15.32667   13.687481  15.110641  15.84475   21.187195  20.42483
 15.695911  21.073025  15.715876  20.48523   19.735155  16.405706
 20.485226  15.860543  19.634684  11.616938  16.564903  21.073025
 18.292377  15.860545  20.425892  19.700422  15.973051  15.973049
 15.973055  19.278553  20.320726  19.278553  19.700422  22.506184
 15.973053  20.320723  20.425892  19.700422  15.359828  19.524942
 22.506184  21.187218  15.973052  19.700422  20.320723  15.973053
 15.973053  19.965343  20.65681   15.973054  21.187218  20.425892
 20.425892  19.700422  20.425896  19.700422  11.892158  21.216068
 19.700422  23.504465  12.580368  22.606075  15.287911  18.883118
 15.973053  16.123446  15.973053  15.973053  19.700418  16.123444
 22.606066 ]
2025-06-02 15:43:13,451 - DEBUG - Edge reconstruction errors: [4.48350811e+00 4.40535784e+00 6.93807793e+00 4.32485542e+01
 2.17353463e+00 1.35123043e+01 4.32320786e+01 4.32341728e+01
 4.32321587e+01 6.95172644e+00 4.32312241e+01 4.32327309e+01
 4.32393761e+01 4.32387505e+01 4.32748795e+01 4.32313461e+01
 4.32355461e+01 4.32327652e+01 4.32327652e+01 1.02543926e+01
 6.94001913e+00 6.94342136e+00 4.32395248e+01 4.32373619e+01
 4.34492836e+01 4.32312241e+01 4.32328415e+01 4.32710152e+01
 4.33032532e+01 4.32312241e+01 4.32421722e+01 4.32479172e+01
 4.32479172e+01 4.32312241e+01 4.32436066e+01 4.32436066e+01
 4.32350998e+01 4.32352905e+01 4.32340775e+01 4.32340775e+01
 4.33349266e+01 4.32393570e+01 4.32337418e+01 4.32395210e+01
 4.32994614e+01 4.32994614e+01 4.32361488e+01 4.32323990e+01
 4.32323990e+01 4.32353859e+01 4.32324944e+01 4.32324944e+01
 4.36880722e+01 4.32355728e+01 6.94290781e+00 6.94968033e+00
 4.32326775e+01 4.34158669e+01 4.32470207e+01 4.32427902e+01
 4.32427902e+01 4.32325401e+01 5.34231201e+02 6.96798277e+00
 6.94045973e+00 4.32419968e+01 4.32890701e+01 4.32890701e+01
 4.32313461e+01 4.32383194e+01 4.32341537e+01 4.32341537e+01
 8.07936279e+02 4.32325935e+01 4.32316971e+01 4.32586441e+01
 4.32549057e+01 4.32385330e+01 4.32385330e+01 4.32589493e+01
 4.33047562e+01 4.32450943e+01 4.32450943e+01 4.32364426e+01
 4.32374496e+01 4.32374496e+01 1.12315159e+01 4.32383842e+01
 4.32351418e+01 4.32351418e+01 4.33221970e+01 4.32349625e+01
 4.32349625e+01 4.32383499e+01 4.32426643e+01 4.32360687e+01
 4.32354393e+01 4.32349968e+01 4.32349968e+01 4.32816734e+01
 4.32394867e+01 4.32423325e+01 4.32423325e+01 1.79889306e-01
 4.32763519e+01 4.32401962e+01 4.32357101e+01 4.32338142e+01
 4.32338142e+01 4.32312241e+01 4.32606735e+01 4.32336960e+01
 4.32336960e+01 6.95724201e+00 4.32620392e+01 4.32350388e+01
 4.32350388e+01 4.32313461e+01 4.32389717e+01 4.32400284e+01
 4.32398911e+01 4.32323303e+01 4.32323303e+01 4.32327194e+01
 4.32328949e+01 4.32351494e+01 4.32351494e+01 4.32354584e+01
 4.32350845e+01 4.32350845e+01 4.32360001e+01 4.32345810e+01
 4.32345810e+01 4.32313461e+01 4.32322006e+01 4.32322006e+01
 4.32374115e+01 4.32321014e+01 4.32321014e+01 4.32352600e+01
 4.32455063e+01 4.32399368e+01 4.32399368e+01 4.32327347e+01
 4.32321854e+01 4.32321854e+01 4.32330246e+01 4.32334290e+01
 4.32321854e+01 4.32321854e+01 4.32323112e+01 4.32323112e+01
 4.32369728e+01 4.32369728e+01 4.32331123e+01 4.32447052e+01
 4.32357063e+01 4.32357063e+01 4.32404861e+01 4.32407913e+01
 4.32352829e+01 4.32352829e+01 4.32326546e+01 4.32326546e+01
 4.32333107e+01 4.32351151e+01 4.32351151e+01 4.32312241e+01
 4.32327881e+01 4.32336197e+01 4.32336197e+01 4.32327499e+01
 4.32337875e+01 4.32337875e+01 4.32327194e+01 4.32445793e+01
 4.32362137e+01 4.32357712e+01 4.32356567e+01 4.32322464e+01
 4.32322464e+01 4.32573357e+01 4.32573357e+01 4.32361374e+01
 4.32353249e+01 4.32353592e+01 4.32345924e+01 4.32345924e+01
 4.32329330e+01 4.32328033e+01 4.32328033e+01 4.32327499e+01
 4.32484932e+01 4.32484932e+01 4.32327194e+01 4.32324791e+01
 4.32327499e+01 6.96697140e+00 6.94527674e+00 4.32350082e+01
 4.32602882e+01 4.32602882e+01 4.32327766e+01 4.32784042e+01
 4.32784042e+01 1.82882220e-01 4.32357674e+01 4.32526894e+01
 4.32957420e+01 4.32957420e+01 4.32319336e+01 4.32319336e+01
 4.32393875e+01 4.32393875e+01 4.32360344e+01 4.32323990e+01
 4.32323990e+01 4.32354774e+01 4.32354774e+01 6.96864319e+00
 8.67737427e+02 6.94487572e+00 6.94285297e+00 4.32363663e+01
 4.32324982e+01 4.32360916e+01 4.32360916e+01 4.32393112e+01
 4.32319336e+01 4.32319336e+01 4.32329063e+01 4.32318764e+01
 4.32318764e+01 4.32605515e+01 4.32323303e+01 4.32323303e+01
 4.32312241e+01 4.32912445e+01 4.32424393e+01 4.32358017e+01
 4.32358017e+01 4.32364769e+01 4.32406769e+01 4.32341537e+01
 4.32341537e+01 4.32375526e+01 4.32328072e+01 4.32328072e+01
 4.32365112e+01 4.32342300e+01 4.32342300e+01 4.32328262e+01
 4.32322273e+01 4.32322273e+01 4.32358131e+01 4.32325134e+01
 4.32325401e+01 4.32328453e+01 4.32324486e+01 4.32754097e+01
 4.32318764e+01 4.32318764e+01 4.32352371e+01 4.32331085e+01
 4.32321510e+01 4.32321510e+01 4.32332573e+01 4.32327080e+01
 4.32504082e+01 4.32338104e+01 4.32332230e+01 6.98093176e+00
 4.32546616e+01 6.98552799e+00 4.32343788e+01 4.32343788e+01
 4.32333183e+01 4.33727798e+01 4.33727798e+01 4.32342911e+01
 4.32334976e+01 4.32388496e+01 4.32347488e+01 4.32347488e+01
 4.32422409e+01 4.32329941e+01 4.32328262e+01 4.32320709e+01
 4.32350616e+01 4.38231544e+01 4.38231544e+01 4.32312241e+01
 4.32330399e+01 1.59889603e+01 2.17353463e+00 5.76433945e+01
 5.76433945e+01 4.54330711e+01 6.95016146e+00 4.33066444e+01
 4.32356339e+01 4.32330627e+01 6.95171118e+00 4.32347565e+01
 4.32313461e+01 4.32886162e+01 4.32355385e+01 4.32336731e+01
 4.32336731e+01 4.32417564e+01 4.32340126e+01 4.32393036e+01
 4.32339630e+01 4.32358818e+01 4.32416229e+01 4.32416229e+01
 4.32358093e+01 4.32357674e+01 4.32344131e+01 4.32344131e+01
 1.12747011e+01 4.32379189e+01 4.32333794e+01 4.32333794e+01
 4.32331390e+01 4.32328262e+01 4.32328262e+01 4.32327042e+01
 4.32375145e+01 4.32375145e+01 4.32357254e+01 4.32395744e+01
 4.32395744e+01 4.32327538e+01 4.32884560e+01 4.32884560e+01
 4.32613373e+01 4.32370949e+01 4.32370949e+01 4.32326241e+01
 4.32326241e+01 4.32328377e+01 4.32477837e+01 4.32477837e+01
 4.32331581e+01 4.32669144e+01 4.32669144e+01 4.37758522e+01
 4.37758522e+01 4.32312241e+01 4.32400436e+01 4.32319794e+01
 4.32329712e+01 4.32359886e+01 4.32312241e+01 4.32392273e+01
 4.32392273e+01 4.32375069e+01 4.32949867e+01 4.32735748e+01
 4.32735748e+01 4.32314262e+01 4.32338943e+01 4.32313461e+01
 4.32380981e+01 4.32380981e+01 4.32356796e+01 4.32314262e+01
 4.32428360e+01 4.32382507e+01 4.32382507e+01 4.32355270e+01
 4.32313461e+01 4.32476578e+01 4.32312241e+01 4.32332687e+01
 4.32312813e+01 4.32394905e+01 4.32397346e+01 4.32327652e+01
 4.32327652e+01 4.32367744e+01 4.32337646e+01 4.32337646e+01
 4.32705154e+01 4.32456436e+01 4.32346382e+01 4.32346382e+01
 4.32619400e+01 4.32361526e+01 4.32361526e+01 4.32454605e+01
 4.32363663e+01 4.32334633e+01 4.32334633e+01 4.32406006e+01
 4.32464600e+01 4.32391968e+01 4.32391968e+01 4.32312241e+01
 4.32594070e+01 4.32638168e+01 4.32638168e+01 4.32388954e+01
 4.32325020e+01 4.32325020e+01 4.32353210e+01 4.32353210e+01
 4.32327499e+01 4.32466545e+01 4.32401199e+01 4.32401199e+01
 1.12315159e+01 4.32394066e+01 4.32396126e+01 4.32553978e+01
 4.32546921e+01 4.32546921e+01 4.32328186e+01 4.32478752e+01
 4.32347794e+01 4.32347794e+01 4.32312241e+01 4.32329483e+01
 4.32727547e+01 4.32756577e+01 4.32756577e+01 4.32312241e+01
 4.32372856e+01 4.33166313e+01 4.33166313e+01 4.32324905e+01
 4.32350616e+01 4.32355919e+01 4.32558899e+01 4.32325478e+01
 4.32331696e+01 4.32331696e+01 4.32312241e+01 4.32354813e+01
 4.32798882e+01 4.32798882e+01 6.95975113e+00 4.32324753e+01
 4.32324753e+01 4.32417908e+01 4.32336769e+01 4.32324905e+01
 4.32313461e+01 4.32331352e+01 4.32448196e+01 4.32511711e+01
 4.32324448e+01 4.32324181e+01 4.32417068e+01 4.32396965e+01
 4.32396965e+01 4.32324677e+01 4.32606125e+01 4.32339554e+01
 4.32339554e+01 4.32312241e+01 4.32338333e+01 4.32338333e+01
 4.32371483e+01 4.32371635e+01 4.32371635e+01 4.32353020e+01
 4.32312241e+01 4.32393150e+01 4.32393150e+01 4.32355728e+01
 4.32355728e+01 4.32327499e+01 4.32312241e+01 4.32378693e+01
 4.32378693e+01 4.33106041e+01 4.32334099e+01 4.32334099e+01
 6.96862316e+00 4.32441216e+01 4.32312241e+01 4.32327843e+01
 4.32387314e+01 4.32325554e+01 4.32360115e+01 4.32333565e+01
 4.32333565e+01 4.32358704e+01 4.32327347e+01 4.32327347e+01
 4.32363968e+01 4.32331619e+01 4.32331619e+01 4.32369766e+01
 4.32332573e+01 4.32332573e+01 4.32353096e+01 4.32353745e+01
 4.32324944e+01 4.32385788e+01 4.32385788e+01 4.32312241e+01
 4.32569427e+01 4.32329712e+01 4.32329712e+01 4.32403145e+01
 4.32324905e+01 4.32324905e+01 4.32504578e+01 4.32324867e+01
 4.32403183e+01 4.32403183e+01 4.32312241e+01 4.32327423e+01
 4.32355080e+01 4.32317657e+01 4.32325516e+01 4.32337952e+01
 4.32599869e+01 4.35313873e+01 4.35313873e+01 4.32358742e+01
 4.32329826e+01 4.32329826e+01 4.32329063e+01 4.32352638e+01
 4.32343216e+01 4.32343216e+01 4.32397690e+01 4.32414360e+01
 4.32324638e+01 4.32324638e+01 4.32325363e+01 4.32369881e+01
 4.32337685e+01 4.32337685e+01 4.32312241e+01 4.32433205e+01
 4.32433205e+01 4.32312241e+01 4.32326736e+01 4.32326736e+01
 4.32472763e+01 4.32409973e+01 4.32409973e+01 4.32353172e+01
 6.95894623e+00 4.32361908e+01 4.32341537e+01 4.32341537e+01
 4.32396011e+01 4.32336731e+01 4.32324715e+01 4.32324715e+01
 4.32325363e+01 4.32324982e+01 6.95894623e+00 6.93920469e+00
 6.93954372e+00 6.96262789e+00 4.32357216e+01 4.32332420e+01
 4.32332420e+01 4.32462234e+01 4.32363205e+01 4.32943382e+01
 4.32943382e+01 4.32325249e+01 4.32355118e+01 4.32347107e+01
 4.32347107e+01 6.96530199e+00 4.32312241e+01 4.32487907e+01
 4.34577599e+01 4.34577599e+01 7.73409939e+00 4.32354965e+01
 4.32327843e+01 4.32451897e+01 4.32336845e+01 4.32336845e+01
 4.32588921e+01 4.32588921e+01 4.32360229e+01 4.32360229e+01
 4.32313461e+01 4.32350311e+01 4.32465591e+01 4.32439041e+01
 4.32439041e+01 4.33250618e+01 4.32330894e+01 4.32314034e+01
 4.32404251e+01 4.32428246e+01 4.32428246e+01 4.32350845e+01
 4.32374420e+01 4.32325974e+01 4.32325974e+01 4.32390251e+01
 4.32339439e+01 4.32339439e+01 4.32325363e+01 4.32492180e+01
 4.32492180e+01 4.32327080e+01 4.32327538e+01 4.32327538e+01
 4.32335739e+01 4.32335739e+01 4.32330856e+01 4.32347298e+01
 4.32347298e+01 4.32392693e+01 4.32392693e+01 4.32419357e+01
 4.32419357e+01 6.97220135e+00 4.32324867e+01 4.33443298e+01
 4.32362442e+01 4.32325058e+01 6.98552847e+00 4.32358894e+01
 4.32354088e+01 4.32353897e+01 4.32358246e+01 1.26313925e+01
 4.32351723e+01 4.32313461e+01 4.32351074e+01 4.32326126e+01
 4.32324600e+01 4.32313461e+01 4.32312241e+01 4.32358131e+01
 4.32350883e+01 4.32313461e+01 4.32352486e+01 5.34231445e+02
 4.32444763e+01 4.32327194e+01 5.09526777e+00 4.95671749e+00
 4.32315102e+01 4.32449570e+01 4.32449570e+01 4.32322006e+01
 6.95497417e+00 4.32312355e+01 6.96892548e+00 5.76314926e+01
 2.28868675e+00 4.54321022e+01 6.95392323e+00 4.32424622e+01
 4.32312546e+01 4.32327118e+01 4.32369576e+01 4.32803802e+01
 4.32371597e+01 4.32341499e+01 4.32346497e+01 4.32334518e+01
 4.32326622e+01 4.35059280e+01 4.32462196e+01 4.32418442e+01
 4.32334938e+01 4.33891144e+01 4.33891144e+01 4.32315102e+01
 4.32413940e+01 4.36915359e+01 4.32352257e+01 6.99576950e+00
 1.06623001e+01 4.32330894e+01 4.32410698e+01 4.32597618e+01
 4.32313843e+01 4.32340508e+01 7.13072777e+00 1.27313910e+01
 6.94626856e+00 4.32863693e+01 4.32863693e+01 4.35752106e+01
 4.32312927e+01 4.32312355e+01 4.32312355e+01 4.32312431e+01
 4.34200287e+01 4.32445755e+01 4.32497292e+01 4.32325630e+01
 4.32335968e+01 4.32364922e+01 4.32541351e+01 4.32312775e+01
 4.32589417e+01 4.32589417e+01 4.32343750e+01 4.32327194e+01
 1.28765297e+01 4.32312393e+01 4.32433434e+01 4.32341843e+01
 4.32347946e+01 4.32493896e+01 4.32584953e+01 4.32338371e+01
 4.33814163e+01 4.33814163e+01 4.32339630e+01 4.32791023e+01
 5.34231262e+02 4.32381325e+01 4.32886086e+01 4.32886086e+01
 4.33126450e+01 4.32356148e+01 4.32356148e+01 4.32383881e+01
 4.32324448e+01 4.32641220e+01 4.33679581e+01 4.32501259e+01
 4.32652702e+01 4.32385445e+01 4.32604828e+01 4.32604828e+01
 4.32388840e+01 4.32483940e+01 4.32327156e+01 4.32355728e+01
 4.32417831e+01 4.32417831e+01 4.32334480e+01 4.32509995e+01
 4.32346878e+01 4.32333298e+01 4.32333298e+01 4.32329330e+01
 4.32532272e+01 4.32532272e+01 4.32386093e+01 4.32354355e+01
 4.32354355e+01 4.32372551e+01 4.32893448e+01 4.32893448e+01
 4.32678604e+01 4.32333603e+01 4.32333145e+01 4.32357788e+01
 4.32551346e+01 4.32551346e+01 4.32351761e+01 4.32401161e+01
 4.32401161e+01 4.32456589e+01 4.32332993e+01 4.32332993e+01
 4.32357903e+01 4.32544136e+01 4.32544136e+01 4.32349052e+01
 4.32401733e+01 4.32401733e+01 4.32351036e+01 4.32463379e+01
 4.32450447e+01 4.32450447e+01 4.32395363e+01 4.32324409e+01
 4.32657013e+01 4.32943382e+01 4.32943382e+01 4.32323036e+01
 4.32338295e+01 4.32355881e+01 4.32363205e+01 4.32332878e+01
 4.32332878e+01 4.32352066e+01 4.32356644e+01 4.32399025e+01
 4.32353630e+01 4.32325935e+01 4.32325935e+01 4.32326241e+01
 4.32375259e+01 4.32345390e+01 4.32368698e+01 4.32339935e+01
 4.32332344e+01 4.32332344e+01 4.32346878e+01 4.32348671e+01
 4.32348671e+01 4.32323380e+01 4.32339249e+01 4.32339249e+01
 4.33768806e+01 4.32491684e+01 4.32339325e+01 4.32349701e+01
 4.32472496e+01 4.32416649e+01 4.32323647e+01 4.32342300e+01
 4.32342300e+01 4.32489967e+01 4.32324677e+01 4.32971001e+01
 4.32971001e+01 4.32342339e+01 4.32338600e+01 4.32338600e+01
 4.33658676e+01 4.32323532e+01 4.32347641e+01 4.32347641e+01
 4.32330818e+01 4.32335205e+01 4.32330132e+01 4.32326508e+01
 4.32326508e+01 4.32326584e+01 4.32424545e+01 4.32424545e+01
 4.32321587e+01 4.64244690e+01 4.32332382e+01 4.32388687e+01
 4.32327995e+01 4.32417984e+01 4.32323685e+01 4.32343750e+01
 4.32343750e+01 4.32324905e+01 4.34981499e+01 4.34981499e+01
 4.32323189e+01 4.32341537e+01 4.32341537e+01 4.32325897e+01
 4.32362938e+01 4.32362938e+01 4.32623787e+01 4.32328720e+01
 4.34874916e+01 4.32323837e+01 4.32407150e+01 4.32407150e+01
 4.32524185e+01 4.32323990e+01 4.32354279e+01 4.32354279e+01
 4.32325706e+01 4.32331047e+01 4.32331047e+01 4.32332115e+01
 4.32332115e+01 4.32359581e+01 4.32359581e+01 4.32372589e+01
 4.32372589e+01 4.32353020e+01 4.32353020e+01 4.32364731e+01
 4.32936783e+01 4.32936783e+01 4.32378120e+01 4.32378120e+01
 4.32991486e+01 4.32666321e+01 4.32666321e+01 4.32534294e+01
 4.32405167e+01 4.32405167e+01 4.32962608e+01 4.32962608e+01
 4.32716026e+01 4.32716026e+01 4.32843666e+01 4.32843666e+01
 4.33253212e+01 4.33253212e+01 4.32392464e+01 4.32392464e+01
 4.32868729e+01 4.32868729e+01 4.33937302e+01 4.33937302e+01
 4.32344322e+01 4.32344322e+01 4.32363396e+01 4.32363396e+01
 4.32382698e+01 4.32382698e+01 1.23316460e+01 2.21380687e+00
 5.76327209e+01 2.21290421e+00 4.54317551e+01 4.32333145e+01
 6.94062519e+00 5.76323624e+01 5.34231262e+02 5.34231201e+02
 1.23312340e+01 1.23312330e+01 5.34231506e+02]
2025-06-02 15:43:13,453 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154313_update_17.json
2025-06-02 15:43:13,454 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:13,460 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154313_update_17.pth and as latest_checkpoint.pth
2025-06-02 15:43:13,460 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.0050
2025-06-02 15:43:13,460 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:43:13,460 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.7225, MLP Score: 0.0066
2025-06-02 15:43:13,460 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.5024, MLP Score: 0.0059
2025-06-02 15:43:13,460 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.1530, MLP Score: 0.0052
2025-06-02 15:43:13,460 - WARNING -   Node ID: ff02::2, Recon Error: 33.3968, MLP Score: 0.0043
2025-06-02 15:43:13,460 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 38.6055, MLP Score: 0.0078
2025-06-02 15:43:13,461 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:43:13,461 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2312, MLP Score: 0.0000
2025-06-02 15:43:13,461 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9363, MLP Score: 0.0000
2025-06-02 15:43:13,461 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7374, MLP Score: 0.0000
2025-06-02 15:43:13,461 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2314, MLP Score: 0.0000
2025-06-02 15:43:13,461 - WARNING -   Source: 192.168.27.10, Target: 224.0.0.251, Recon Error: 534.2313, MLP Score: 0.0000
2025-06-02 15:43:13,462 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-02 15:43:13,462 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:43:13,462 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:43:13,462 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:43:13,483 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:43:13,498 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:43:13,498 - INFO - Processing node updates/additions.
2025-06-02 15:43:13,503 - INFO - Processing edge updates/additions.
2025-06-02 15:43:13,511 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:13,513 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:13,513 - DEBUG - Updated graph - Nodes: 511, Edges: 1044
2025-06-02 15:43:13,513 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:13,515 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:13,523 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-02 15:43:13,526 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:13,527 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-02 15:43:13,529 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-02 15:43:13,530 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:13,537 - DEBUG - Initial edge attributes tensor shape: torch.Size([1044, 10])
2025-06-02 15:43:13,542 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:13,548 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1044, 10])
2025-06-02 15:43:13,549 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:13,549 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:13,551 - INFO - Updated main graph to 511 nodes and 1044 edges.
2025-06-02 15:43:13,551 - INFO - Performing online update...
2025-06-02 15:43:13,552 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:13,553 - DEBUG - Updated RunningStats: new_mean=0.939023237065151, new_var=9600000000159.58, new_n=990
2025-06-02 15:43:13,553 - DEBUG - Updated RunningStats: new_mean=0.9331223368345892, new_var=9900000000019.148, new_n=1020
2025-06-02 15:43:13,554 - DEBUG - Updated RunningStats: new_mean=39.91711702253569, new_var=3200000201650.9946, new_n=330
2025-06-02 15:43:13,554 - DEBUG - Updated RunningStats: new_mean=40.43603532013441, new_var=3300000293202.361, new_n=340
2025-06-02 15:43:13,554 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:13,555 - DEBUG - Online update step: 1/25
2025-06-02 15:43:13,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,555 - DEBUG - Online update step: 2/25
2025-06-02 15:43:13,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,555 - DEBUG - Online update step: 3/25
2025-06-02 15:43:13,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,555 - DEBUG - Online update step: 4/25
2025-06-02 15:43:13,555 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,556 - DEBUG - Online update step: 5/25
2025-06-02 15:43:13,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,556 - DEBUG - Online update step: 6/25
2025-06-02 15:43:13,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,556 - DEBUG - Online update step: 7/25
2025-06-02 15:43:13,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,556 - DEBUG - Online update step: 8/25
2025-06-02 15:43:13,556 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,556 - DEBUG - Online update step: 9/25
2025-06-02 15:43:13,557 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,557 - DEBUG - Online update step: 10/25
2025-06-02 15:43:13,557 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,557 - DEBUG - Online update step: 11/25
2025-06-02 15:43:13,557 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,557 - DEBUG - Online update step: 12/25
2025-06-02 15:43:13,557 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,557 - DEBUG - Online update step: 13/25
2025-06-02 15:43:13,557 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,557 - DEBUG - Online update step: 14/25
2025-06-02 15:43:13,558 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,558 - DEBUG - Online update step: 15/25
2025-06-02 15:43:13,558 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,558 - DEBUG - Online update step: 16/25
2025-06-02 15:43:13,558 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,558 - DEBUG - Online update step: 17/25
2025-06-02 15:43:13,558 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,558 - DEBUG - Online update step: 18/25
2025-06-02 15:43:13,558 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,559 - DEBUG - Online update step: 19/25
2025-06-02 15:43:13,559 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,559 - DEBUG - Online update step: 20/25
2025-06-02 15:43:13,559 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,559 - DEBUG - Online update step: 21/25
2025-06-02 15:43:13,559 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,559 - DEBUG - Online update step: 22/25
2025-06-02 15:43:13,559 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,559 - DEBUG - Online update step: 23/25
2025-06-02 15:43:13,559 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,560 - DEBUG - Online update step: 24/25
2025-06-02 15:43:13,560 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,560 - DEBUG - Online update step: 25/25
2025-06-02 15:43:13,560 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,560 - WARNING - No successful steps during online update.
2025-06-02 15:43:13,562 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], current edge mean: [-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:43:13,562 - DEBUG - Node drift difference: 0.0883, Edge drift difference: 0.0063
2025-06-02 15:43:13,564 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], edge=[-4.5674056e-09  4.7269156e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2837028e-09 -4.5674056e-10 -7.3078490e-09
 -1.8269622e-09  1.3702217e-09]
2025-06-02 15:43:13,564 - DEBUG - Updated reference std: node=[0.         0.         1.0009799  1.0009799  0.         0.
 0.         1.0009799  1.0009799  1.0009799  1.0009799  1.0009799
 0.99121654 0.31522512 0.3527915  0.5612344  1.0009799  3.1126812
 2.953794   1.5002859  0.3527915  0.         1.0009799  1.0009799
 0.         0.         0.         0.         1.0009799  1.0009799 ], edge=[  1.0004792 568.60004     0.          0.          1.0004793   1.0004792
   1.0004793   1.0004792   1.0004792   1.0004792]
2025-06-02 15:43:13,565 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:13,565 - INFO - Running anomaly detection...
2025-06-02 15:43:13,565 - INFO - Starting anomaly detection.
2025-06-02 15:43:13,593 - DEBUG - Node reconstruction errors: [20.93951   12.188932  17.362593  33.054123  15.408764  16.938473
 15.906486  27.59174   27.59174   30.521948  27.59174   19.566559
 20.53437   11.707883  28.21503   28.251102  18.918531  28.251108
 27.85507   26.879963  22.025219  28.21503   21.292595  12.547195
 27.188854  30.811562  27.188854  15.410549  26.50397   27.188854
 13.6851845 29.442892  15.031146  31.89002   30.852356  28.6473
 16.2206    26.879963  14.956399  12.71148   32.5977    26.878954
 26.879963  28.153679  30.979057  20.150198  30.205622  14.5480795
 25.417484  32.564373  39.869045  29.683523  29.828396  21.30191
 19.752354  14.451049  20.43624   24.406635  24.28356   24.08182
 12.629956  27.460102  25.656147  12.028141  25.783278  19.752352
 20.675993  19.752356  25.656136  25.656141  19.550756  18.740356
 20.96985   16.951233  16.705244  18.924644  29.070324  18.016088
 15.367635  16.767134  28.064455  16.721148   7.946193  25.26523
 18.977419  11.893139  18.467896  16.268795  16.92149   16.034607
 23.641071  14.011174  13.873251  15.482189  19.526375  32.963852
 26.936825  17.36135   22.505623  19.86898   17.361355  26.936825
 27.113354  19.206078  11.811276  19.641726  20.538881  14.504225
 14.623615  24.88087   19.040913  26.1094    15.26641   14.46576
 17.124943  16.475416  16.929548  13.86715   16.256973  20.503574
 21.794344  13.873257  14.5245075 13.873255  17.000208  23.477343
 11.923578  11.516595  17.361353  24.294838  24.187925  21.291412
 22.380075  16.709202  16.47542   19.660688  27.04198   23.37738
 11.1459255 13.391661  20.561737  18.97795   21.057865  19.904314
 21.291414  17.435558  16.929552  23.008858  21.207628  15.798061
 28.116987  10.821057  16.509644  21.29141   17.562542  13.925803
 20.503572  16.214157  17.361353  28.945597  23.008858  12.766806
 20.503574  24.187922  16.843145  14.035099  17.16187   15.6718645
 10.996939  15.798055  16.638662  20.503574  23.457989  26.085287
 15.195225  12.856605  15.798059  16.331112  16.712042  16.712044
 18.813648  15.179645  20.23968   14.735413  14.290022  16.786072
 20.957651  16.506905  20.244972  19.681744  15.257459  14.977751
 25.043516  22.07593   11.46959   22.547356  10.827714  20.363691
 14.029633  24.29484   19.375362  20.503572  14.664274  16.131632
 16.920315  13.873256  23.252354  16.865068  21.686504  16.010761
 16.247883  16.786074  25.043516  15.912473  16.786072  20.389812
 16.78607   16.929548  16.57176   22.075928  13.967113  20.95765
 22.473078  25.043516  20.503574  15.677838  14.321887  22.9658
 16.036306  25.551891  15.177126  15.736765  15.798061  16.92955
 16.929548  22.547356  15.624335  22.473076  20.503574  26.000893
 13.727741  15.68688   21.94006   15.798062  21.925058  16.475422
 16.133917  16.54513   21.94006   20.286804  23.457989  23.470562
 16.571762  15.671868  16.475422  17.16581   21.925058  22.392363
 22.495218  16.712042  15.896207  13.604618  24.676044  21.925058
 16.036303  20.090187  16.105984  24.676044  16.105984  16.712044
 17.441153  16.616426  14.91335   26.943747  16.537184  16.712042
 19.948141  17.3945    21.011208  16.712044  16.167936  20.652716
 15.8534565 27.821291  21.925062  25.715452  13.08306   14.179961
 15.17965   11.396988  19.395306  25.867453  22.038385  21.925058
 10.797147  22.392365  16.712042  16.711878  25.043516  21.537256
 15.610426  21.551222  15.992804  15.992805  21.551218  21.551218
 21.55122   16.455711  20.830502  21.55122   21.551222  15.538036
 21.551222  23.234163  11.861239  15.308244  17.995962  13.301428
 24.05435   23.334919  15.610331  18.26583   16.36272   15.992808
 19.50706   14.290125  21.608347  16.455711  15.896209  15.89621
 16.647509  24.054354  21.55122   16.537184  21.551222  16.455713
 20.261753  22.495218  21.608347  21.608347  21.55122   21.962996
 21.608347  15.610332  15.992805  16.105984  15.992807  24.858206
 16.754086  15.53825   21.551218  16.247883  24.676044  15.714625
 21.19594   25.043526  21.55122   21.551222  22.392365  22.392359
 16.247883  21.551218  21.608347  15.992665  15.992788  17.576048
 20.895641  15.501546  16.224749  16.444994  15.572335  16.22475
 15.791434  14.121469  15.412675  16.170849  21.629478  20.969278
 15.96727   21.551218  15.992804  11.404827  20.268534  16.814445
 12.545258  16.158934  20.13225   11.904998  16.87139   21.551218
 18.727217  16.158932  15.629918  15.629923  16.300016  16.300016
 16.300016  19.824991  20.801228  19.67322   20.221209  17.159025
 16.300016  20.80123   16.08312   15.629913  15.632578  20.07413
 15.629922  10.322831  16.300018  15.629919  20.801228  16.300018
 16.300018  20.364372  21.130901  16.300014  21.6295    20.870256
 18.659138  20.221209  20.870256  20.202253  12.105847  21.777039
 20.221209  24.084307  12.933575  23.112646  15.58691   19.387922
 16.300014  16.530806  16.300018  16.300018  20.221205  16.530807
 23.112646  20.17671   20.176714  22.220076  23.236204  23.236214
 23.236204  11.006536  22.274382  22.274384  22.274384  19.472137
 15.111009  20.176716  19.472136  20.112371  20.17671   21.38495
 19.499857  20.202251  24.046064  20.20225   20.202251  19.499857
 20.20225   18.025717  19.499859  19.499857  20.900358  23.15549
 13.030376  23.155489  20.90036   20.20225   19.499855  13.030378
 22.274384  20.20225   20.20225   20.202253  20.176714  19.472137
 24.046064  12.523559  20.870258  19.472137  12.528865  20.214563
 20.17671   13.030377  22.391937  23.15549   20.202251  20.17671
 19.472137  20.870256  19.472141  19.499857  19.472141  21.723164
 20.112371  19.472137  19.472136  20.161879  19.472141  19.262077
 20.214558  22.391937  20.112371  18.396585  24.02295   20.176716
 22.391945 ]
2025-06-02 15:43:13,594 - DEBUG - Edge reconstruction errors: [  4.5161834   4.451435    6.9513235 ...  12.342286   12.342283
 534.24255  ]
2025-06-02 15:43:13,597 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154313_update_18.json
2025-06-02 15:43:13,597 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:13,604 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154313_update_18.pth and as latest_checkpoint.pth
2025-06-02 15:43:13,604 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.0046
2025-06-02 15:43:13,605 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:43:13,605 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.0541, MLP Score: 0.0068
2025-06-02 15:43:13,605 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.8116, MLP Score: 0.0043
2025-06-02 15:43:13,605 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.8900, MLP Score: 0.0059
2025-06-02 15:43:13,605 - WARNING -   Node ID: 151.101.0.223, Recon Error: 30.8524, MLP Score: 0.0042
2025-06-02 15:43:13,605 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.5977, MLP Score: 0.0055
2025-06-02 15:43:13,605 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:13,606 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2423, MLP Score: 0.0000
2025-06-02 15:43:13,606 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9448, MLP Score: 0.0000
2025-06-02 15:43:13,606 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0429, MLP Score: 0.0000
2025-06-02 15:43:13,606 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7453, MLP Score: 0.0000
2025-06-02 15:43:13,606 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2425, MLP Score: 0.0000
2025-06-02 15:43:13,607 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-02 15:43:13,607 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:43:13,607 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:43:13,607 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:43:13,626 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:43:13,640 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:43:13,640 - INFO - Processing node updates/additions.
2025-06-02 15:43:13,643 - INFO - Processing edge updates/additions.
2025-06-02 15:43:13,650 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:13,650 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:13,651 - DEBUG - Updated graph - Nodes: 547, Edges: 1118
2025-06-02 15:43:13,651 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:13,651 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:13,657 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-02 15:43:13,659 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:13,659 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-02 15:43:13,660 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-02 15:43:13,661 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:13,663 - DEBUG - Initial edge attributes tensor shape: torch.Size([1118, 10])
2025-06-02 15:43:13,664 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:13,668 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1118, 10])
2025-06-02 15:43:13,669 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:13,669 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:13,670 - INFO - Updated main graph to 547 nodes and 1118 edges.
2025-06-02 15:43:13,670 - INFO - Performing online update...
2025-06-02 15:43:13,670 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:13,671 - DEBUG - Updated RunningStats: new_mean=0.9394032845836933, new_var=10200000000160.22, new_n=1050
2025-06-02 15:43:13,672 - DEBUG - Updated RunningStats: new_mean=0.9337921956015183, new_var=10500000000018.914, new_n=1080
2025-06-02 15:43:13,672 - DEBUG - Updated RunningStats: new_mean=40.6256522762116, new_var=3400000199852.774, new_n=350
2025-06-02 15:43:13,672 - DEBUG - Updated RunningStats: new_mean=41.04298277805461, new_var=3500000273174.6226, new_n=360
2025-06-02 15:43:13,672 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:13,672 - DEBUG - Online update step: 1/25
2025-06-02 15:43:13,672 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,672 - DEBUG - Online update step: 2/25
2025-06-02 15:43:13,672 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,672 - DEBUG - Online update step: 3/25
2025-06-02 15:43:13,672 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,672 - DEBUG - Online update step: 4/25
2025-06-02 15:43:13,672 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,672 - DEBUG - Online update step: 5/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 6/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 7/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 8/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 9/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 10/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 11/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 12/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 13/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 14/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 15/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 16/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 17/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 18/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 19/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 20/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 21/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 22/25
2025-06-02 15:43:13,673 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,673 - DEBUG - Online update step: 23/25
2025-06-02 15:43:13,674 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,674 - DEBUG - Online update step: 24/25
2025-06-02 15:43:13,674 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,674 - DEBUG - Online update step: 25/25
2025-06-02 15:43:13,674 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,674 - WARNING - No successful steps during online update.
2025-06-02 15:43:13,674 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], current edge mean: [ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:43:13,675 - DEBUG - Node drift difference: 0.0277, Edge drift difference: 0.0035
2025-06-02 15:43:13,675 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], edge=[ 1.2795273e-09  4.7072629e+02  0.0000000e+00  0.0000000e+00
 -2.7723090e-09 -1.2795273e-09 -4.2650909e-09 -8.5301816e-10
 -4.2650908e-10 -5.1181090e-09]
2025-06-02 15:43:13,676 - DEBUG - Updated reference std: node=[0.         0.         1.0009154  1.0009153  0.         0.
 0.         1.0009153  1.0009153  1.0009153  1.0009153  1.0009153
 1.0682304  0.30491748 0.34246618 0.56139016 1.0009153  3.063846
 2.9354372  1.4923851  0.34246618 0.         1.0009153  1.0009153
 0.         0.         0.         0.         1.0009153  1.0009153 ], edge=[  1.0004476 549.4924      0.          0.          1.0004475   1.0004475
   1.0004475   1.0004476   1.0004475   1.0004475]
2025-06-02 15:43:13,676 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:13,676 - INFO - Running anomaly detection...
2025-06-02 15:43:13,676 - INFO - Starting anomaly detection.
2025-06-02 15:43:13,715 - DEBUG - Node reconstruction errors: [21.159351  12.444346  17.95384   33.28236   15.292819  16.739378
 16.45862   27.579128  27.579128  30.470964  27.579128  19.615063
 21.527395  11.904525  28.255238  28.276117  18.979074  28.276114
 27.973202  26.964787  22.160175  28.255236  20.127815  12.67729
 27.257511  31.023207  27.257504  15.57504   26.520456  27.257504
 14.073301  29.428015  14.832605  32.148544  31.054789  28.77073
 16.365019  26.964787  14.966153  12.844442  32.552296  26.97602
 26.964787  26.698996  30.940895  19.758276  30.261261  12.004027
 25.480839  33.096508  40.56713   29.643993  30.05446   21.59206
 20.078394  16.07755   20.988775  24.564177  24.693127  24.499334
 12.797553  27.605713  25.803589  12.179113  26.096437  20.078386
 21.00294   20.078388  25.803585  25.803589  19.878292  18.940838
 21.302027  17.157055  16.107985  19.13492   29.159063  18.232489
 15.532445  16.974909  28.463139  16.91197    8.079891  26.631777
 19.298456  12.089794  18.674353  15.479267  17.124859  16.402864
 23.991938  14.286593  14.125673  15.664416  19.759466  33.683964
 27.327625  15.977924  22.715885  20.188997  17.569613  27.327635
 27.516521  16.880314  12.010701  19.95529   20.877287  14.706089
 14.89198   24.598701  18.693327  26.512978  15.534143  14.691754
 17.326988  16.670938  17.133429  13.9176    16.446875  20.838533
 22.137041  14.125676  14.801002  13.542773  17.196873  23.856688
 12.130081  11.288649  17.56961   23.908926  24.354633  21.634085
 22.7082    16.973894  16.670938  19.976936  25.579748  23.58868
 11.330076  13.615412  20.884712  19.208775  21.408932  20.226341
 21.634089  17.644793  17.133432  23.36193   21.4129    15.993358
 28.483215  11.008152  16.745264  21.634085  17.766535  14.198468
 20.838531  15.95      17.569609  29.346199  23.36193   13.007376
 20.838531  24.354631  17.046898  14.311795  17.37149   15.471498
 11.1752    15.993356  16.844437  20.167677  23.804958  26.674612
 15.374043  12.956887  15.99336   16.521996  16.910213  16.910213
 19.152424  15.401762  20.560755  15.02456   13.71131   16.980677
 20.579477  16.704184  19.163046  19.997566  15.446679  15.15776
 25.433681  22.420393  11.330076  22.94001   10.996963  20.70237
 14.301661  24.686779  19.58376   20.838531  14.181203  16.330553
 17.132622  14.12567   23.441534  17.166422  21.884623  16.244432
 16.440252  16.980677  25.433672  15.242414  16.980679  20.718523
 16.980677  17.133432  16.771715  22.4204    14.1852665 20.579475
 22.80765   25.433681  20.838531  15.889669  14.595828  23.313572
 16.237597  25.91109   15.428769  15.821529  15.593282  17.133434
 17.13343   22.94001   15.826066  22.80765   20.838535  26.394005
 13.981824  15.27829   22.278635  15.99336   22.263754  16.67094
 15.821344  16.748167  22.278635  19.292868  23.804958  23.815224
 16.771719  15.867168  16.670942  17.371403  19.997566  20.360224
 22.82683   16.910215  15.224093  13.851428  25.022455  19.997566
 16.23759   18.980404  16.293417  25.022455  16.293417  16.910212
 14.913977  14.158314  15.102507  20.360224  16.739119  16.910215
 20.270899  17.605047  19.152428  16.024652  15.705488  20.981255
 16.06199   27.905478  22.263746  25.851767  13.286986  12.7669935
 15.401763  11.116817  22.779018  23.78171   22.251934  22.263746
 10.978464  22.588884  15.315391  16.910074  22.94001   21.858313
 15.814625  21.726728  16.194555  16.194557  21.726728  21.726728
 21.726728  16.654615  21.01492   21.726732  21.726732  15.07466
 21.726728  23.615849  11.479449  15.509446  18.219574  13.534515
 24.429071  22.94001   15.800689  18.511751  16.565378  16.194557
 19.821934  14.563053  21.792612  16.654615  16.130232  16.130236
 16.840626  24.429075  21.726732  16.739119  21.726727  16.654613
 19.888601  22.82683   21.792612  21.792608  21.726732  22.294502
 21.792612  15.80069   15.183148  16.293415  16.194557  25.019783
 16.918863  15.753348  21.726728  15.920078  11.468703  15.919869
 21.514643  19.997566  20.317787  21.726728  22.588884  22.588884
 16.440252  21.726732  21.792612  16.194435  16.194546  17.46799
 21.22373   13.958699  16.422081  15.987164  15.198619  16.422083
 15.994791  13.982359  15.596881  16.373232  21.94624   21.168787
 16.16137   21.726728  16.194557  11.599804  20.588066  17.046768
 12.7806    16.346615  20.453714  12.086824  17.026966  21.726732
 18.953436  16.346615  15.828445  15.828447  16.440138  16.440136
 16.440138  20.23053   20.980186  20.07291   20.543406  17.38473
 16.440138  20.980186  15.676027  15.828441  15.802587  20.398638
 15.8284445 10.482372  16.440134  15.828441  20.980188  16.440138
 16.440138  20.654255  21.440603  16.440138  21.946268  21.185835
 18.984213  20.543407  21.185831  20.51715   13.794292  22.125374
 19.831966  17.33121   13.154486  23.42432   15.746384  19.692547
 16.440136  16.096443  16.440136  16.440134  20.543406  16.756466
 15.611699  20.479229  20.479225  19.61532   23.615719  23.615719
 23.615719  11.16926   22.674675  22.674671  22.674673  19.788494
 15.347921  20.479225  19.788494  20.287012  20.479225  21.768375
 19.823156  20.51715   24.41868   20.517155  20.51715   19.823156
 20.51715   36.085144  19.823156  19.823156  21.218685  23.539707
 13.243383  23.53971   21.218687  20.51715   19.823156  13.243382
 22.674673  20.51715   20.517153  20.517153  20.479225  19.7885
 23.632557  12.707551  21.18583   19.7885    12.751313  20.520002
 20.479225  13.243383  22.709944  23.53971   20.517155  20.479225
 19.7885    21.185835  19.7885    19.823156  19.788494  21.913166
 20.287012  19.788494  19.788502  20.479198  19.788502  19.558285
 20.520002  22.709944  20.287012  18.752035  24.438395  20.479225
 22.709944  20.287014  19.615318  20.479225  20.287014  20.479225
 20.287014  20.287014  20.479225  19.61532   20.287012  22.437346
 20.287012  22.674675  20.520002  20.479225  19.615322  11.914854
 20.287012  15.347921  20.479227  20.287012  20.287012  19.788502
 19.788494  16.10415   18.56693   19.788502  20.287014  16.104149
 20.287012  16.104149  20.479225  20.287012  19.615326  19.615313
 20.28702  ]
2025-06-02 15:43:13,716 - DEBUG - Edge reconstruction errors: [  4.510515    4.4475765   6.954445  ...  12.344933   12.344927
 534.24524  ]
2025-06-02 15:43:13,726 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154313_update_19.json
2025-06-02 15:43:13,726 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:13,730 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154313_update_19.pth and as latest_checkpoint.pth
2025-06-02 15:43:13,730 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.0043
2025-06-02 15:43:13,730 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:43:13,730 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.2824, MLP Score: 0.0069
2025-06-02 15:43:13,730 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.0232, MLP Score: 0.0043
2025-06-02 15:43:13,730 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.1485, MLP Score: 0.0060
2025-06-02 15:43:13,731 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.0548, MLP Score: 0.0042
2025-06-02 15:43:13,731 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.5523, MLP Score: 0.0056
2025-06-02 15:43:13,731 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:13,731 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2449, MLP Score: 0.0000
2025-06-02 15:43:13,731 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9471, MLP Score: 0.0000
2025-06-02 15:43:13,731 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0455, MLP Score: 0.0000
2025-06-02 15:43:13,731 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7474, MLP Score: 0.0000
2025-06-02 15:43:13,731 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2452, MLP Score: 0.0000
2025-06-02 15:43:13,731 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-02 15:43:13,731 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:43:13,731 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:43:13,731 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:43:13,787 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:43:13,803 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:43:13,803 - INFO - Processing node updates/additions.
2025-06-02 15:43:13,807 - INFO - Processing edge updates/additions.
2025-06-02 15:43:13,813 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:13,814 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:13,814 - DEBUG - Updated graph - Nodes: 640, Edges: 1300
2025-06-02 15:43:13,814 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:13,815 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:13,822 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-02 15:43:13,824 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:13,824 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-02 15:43:13,825 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-02 15:43:13,826 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:13,831 - DEBUG - Initial edge attributes tensor shape: torch.Size([1300, 10])
2025-06-02 15:43:13,832 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:13,832 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1300, 10])
2025-06-02 15:43:13,833 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:13,833 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:13,834 - INFO - Updated main graph to 640 nodes and 1300 edges.
2025-06-02 15:43:13,834 - INFO - Performing online update...
2025-06-02 15:43:13,834 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:13,835 - DEBUG - Updated RunningStats: new_mean=0.9398242755673138, new_var=10800000000161.262, new_n=1110
2025-06-02 15:43:13,835 - DEBUG - Updated RunningStats: new_mean=0.9344638998201199, new_var=11100000000018.777, new_n=1140
2025-06-02 15:43:13,835 - DEBUG - Updated RunningStats: new_mean=41.19303106203751, new_var=3600000195696.4204, new_n=370
2025-06-02 15:43:13,836 - DEBUG - Updated RunningStats: new_mean=41.469599332045526, new_var=3700000234474.8716, new_n=380
2025-06-02 15:43:13,836 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:13,836 - DEBUG - Online update step: 1/25
2025-06-02 15:43:13,836 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,836 - DEBUG - Online update step: 2/25
2025-06-02 15:43:13,836 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,836 - DEBUG - Online update step: 3/25
2025-06-02 15:43:13,836 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,836 - DEBUG - Online update step: 4/25
2025-06-02 15:43:13,836 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,836 - DEBUG - Online update step: 5/25
2025-06-02 15:43:13,836 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,836 - DEBUG - Online update step: 6/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 7/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 8/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 9/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 10/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 11/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 12/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 13/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,837 - DEBUG - Online update step: 14/25
2025-06-02 15:43:13,837 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 15/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 16/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 17/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 18/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 19/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 20/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 21/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 22/25
2025-06-02 15:43:13,838 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,838 - DEBUG - Online update step: 23/25
2025-06-02 15:43:13,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,839 - DEBUG - Online update step: 24/25
2025-06-02 15:43:13,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,839 - DEBUG - Online update step: 25/25
2025-06-02 15:43:13,839 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,839 - WARNING - No successful steps during online update.
2025-06-02 15:43:13,840 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], current edge mean: [-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:43:13,840 - DEBUG - Node drift difference: 0.1134, Edge drift difference: 0.0087
2025-06-02 15:43:13,841 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], edge=[-9.5367430e-09  4.6594769e+02  0.0000000e+00  0.0000000e+00
 -1.4671913e-09  2.9343825e-09  1.4671913e-09 -1.0270338e-08
  1.4671913e-09 -1.4671913e-09]
2025-06-02 15:43:13,842 - DEBUG - Updated reference std: node=[0.         0.         1.0007821  1.0007823  0.         0.
 0.         1.0007821  1.0007821  1.0007821  1.0007821  1.0007821
 1.0366606  0.29277956 0.3543513  0.5707029  1.0007821  3.053545
 2.915992   1.4961315  0.3543513  0.         1.0007821  1.0007821
 0.         0.         0.         0.         1.0007821  1.0007821 ], edge=[  1.0003848 510.02356     0.          0.          1.0003848   1.0003848
   1.0003848   1.0003848   1.0003848   1.0003848]
2025-06-02 15:43:13,842 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:13,842 - INFO - Running anomaly detection...
2025-06-02 15:43:13,842 - INFO - Starting anomaly detection.
2025-06-02 15:43:13,848 - DEBUG - Node reconstruction errors: [21.121426  11.895175  18.99944   33.522636  15.695005  16.691223
 17.470453  27.786522  27.786524  30.696667  27.786522  19.899546
 23.274565  11.865238  28.565655  28.524303  19.359188  28.524303
 28.357775  27.27401   22.680264  28.565664  20.070997  12.989171
 27.60841   31.31162   27.608412  16.01512   26.799906  27.60841
 14.685898  29.70168   15.290453  32.438816  31.348278  21.757044
 16.212048  27.274006  15.312894  13.145929  32.91761   27.346655
 27.274006  27.386913  31.239584  19.770964  30.975758  11.970923
 25.847372  34.124245  41.898613  29.95422   30.371826  22.32788
 20.62676   16.566513  22.169018  24.988337  25.204771  25.043308
 13.057874  20.860973  26.222473  12.515566  26.512796  20.626759
 21.543299  20.626776  26.222473  26.222467  20.426718  19.236576
 21.90514   17.47577   16.422035  19.427345  29.780392  18.550714
 15.8408575 17.295967  29.035025  17.209896   8.241949  27.291145
 19.893744  12.399775  19.016157  15.785375  17.443855  16.706568
 24.515507  14.368276  14.5184    15.977191  20.317339  35.065323
 27.91372   16.299332  23.253052  20.758448  17.8744    27.913727
 28.175032  17.205877  12.288967  20.508703  20.851969  15.040696
 15.259268  25.454473  19.220798  27.146612  15.962423  15.109266
 17.644825  16.994345  17.451183  14.3696165 16.760656  19.089954
 22.696444  14.518404  15.268893  11.348094  15.887668  19.08994
 12.432914  11.626969  15.947266  24.581053  24.999744  22.214579
 23.202284  17.453619  16.994352  20.535364  26.279749  24.091978
 11.668147  13.958186  21.472595  16.913826  21.976618  20.812689
 22.214579  17.956556  17.45118   23.90079   21.984058  16.310793
 29.004923  10.906996  17.05683   22.214579  18.077442  14.63833
 21.438469  16.253305  17.874397  29.949238  23.900793  13.455922
 21.43847   24.999744  17.366528  14.791689  17.692144  15.779716
 11.494523  15.906371  17.164581  20.758764  24.329767  27.88334
 15.267916  13.103414  15.756068  16.830294  17.216072  17.216078
 19.697105  15.687666  21.046417  15.481015  14.156115  17.293009
 21.151834  17.004206  19.714067  20.57305   15.7678175 15.471455
 26.05591   22.97484   11.668152  23.62219   10.2527275 21.281384
 14.777651  25.345436  20.114798  21.438469  14.593603  16.647121
 17.467709  14.518402  24.06917   17.698267  22.434998  16.563774
 16.750957  17.293009  26.05591   15.133535  17.293013  21.296576
 15.894168  17.451178  17.098997  22.974834  14.566361  21.151836
 23.346231  26.05591   21.438465  16.2206    13.797158  23.850027
 16.545336  26.44172   15.767711  15.286008  15.549917  17.451181
 17.451181  23.62219   16.148441  23.346233  21.438467  27.010206
 14.4104595 15.589834  22.833504  16.310795  22.799082  15.729721
 16.118341  16.656069  22.833504  19.87161   24.32977   24.338787
 17.098995  16.192139  16.994352  17.70574   20.57305   20.914534
 23.361788  17.216078  15.195532  14.167576  25.54666   20.57305
 16.545336  19.551191  16.617311  14.382003  16.617306  17.216078
 15.388254  14.612915  15.421217  20.291313  17.041721  17.216082
 20.792156  17.937525  19.697105  16.337322  14.746287  21.4998
 16.401247  28.502642  18.946753  26.470669  14.3129    13.211763
 15.687664  11.272236  18.946362  24.444054  22.84321   22.799078
 11.264679  23.119646  15.647243  17.215918  23.62219   22.33554
 15.139895  22.238829  16.489983  16.489983  22.238829  22.238829
 22.238827  16.952517  21.534294  22.238827  22.238829  15.000215
 22.238832  24.260942  11.740866  15.840679  18.592363  13.88594
 25.067013  23.62219   16.159887  19.063564  16.891361  16.489983
 19.08221   15.015764  22.328352  16.95251   16.45171   16.45171
 17.187233  22.788265  22.238829  17.041714  22.23883   16.952513
 18.830393  23.361786  22.328352  22.328352  22.23883   22.804792
 22.328352  16.159891  15.492167  16.617313  16.489985  25.652964
 17.240767  16.081377  22.238832  15.77641   11.210172  15.692391
 22.040478  20.57305   20.197     22.23883   23.119646  23.119642
 16.750956  19.653997  19.393303  15.593222  16.489975  18.599539
 21.75881   13.748925  16.712124  15.910488  15.52764   15.657258
 15.332224  14.065857  15.940622  16.698526  22.464664  21.69634
 16.477274  22.238829  16.489988  11.903683  19.862226  17.405056
 13.193927  16.641909  20.962868  12.311006  17.347479  22.238827
 19.290585  16.641914  16.135454  16.135454  16.794683  16.794687
 16.794683  20.84889   21.488016  20.69932   21.059305  17.73303
 16.794687  21.488014  15.978211  16.135445  16.147404  20.928799
 16.135456  10.776611  16.79469   16.135448  21.488016  16.794683
 16.794685  21.151356  21.949347  16.794683  22.464653  20.361948
 19.542458  21.059305  15.793497  21.050756  14.219772  22.660975
 20.369133  17.673868  13.529127  23.938456  16.06757   20.1892
 16.794685  16.466003  16.794685  16.79469   21.059301  15.871238
 16.088793  19.308952  20.336391  20.169823  24.209927  24.209927
 24.209927  11.419515  17.179329  23.330019  23.330017  20.328625
 15.705602  20.987093  20.328623  20.79469   20.987093  22.435781
 20.375074  19.74155   25.021656  15.7935    16.199905  20.375072
 21.05076   15.2392235 19.741552  20.375074  21.723415  15.793498
 13.613859  24.186098  21.723415  16.199903  15.181567  13.887282
 15.314978  15.793124  16.199905  16.199903  20.336391  20.328623
 24.249397  13.582882  21.702345  20.328623  14.249179  21.020367
 20.987093  12.6219845 23.225302  17.29904   15.793501  20.336395
 15.146878  21.702345  15.7335005 19.74155   15.733499  22.492374
 20.79469   20.328623  20.328625  20.361948  20.328623  20.045616
 21.020367  23.225302  20.14992   16.094072  25.160519  20.987093
 23.225294  19.501024  19.501024  20.987093  15.523372  20.987093
 20.14992   20.79469   20.987097  15.468355  20.79469   20.169825
 20.149921  23.330017  21.020367  20.987093  22.353497  12.148666
 20.79469   15.705601  20.987093  20.79469   20.79469   20.328625
 15.733497  16.470098  19.18878   15.14688   20.79469   16.470097
 20.79469   16.470097  19.314604  20.79469   19.50103   19.501024
 19.50103   20.136183  15.7666    20.136183  20.136187  20.136189
 20.136189  20.13618   20.13618   20.136187  20.13618   19.484795
 22.566444  20.13618   20.136187  20.13618   20.13618   20.136189
 20.13618   20.136187  20.136189  20.136189  20.136187  20.136183
 20.136183  20.136189  20.13618   20.987093  19.963541  20.79469
 21.140045  16.096546  33.43211   33.43211   15.793626  21.140045
 20.79469   20.14992   20.14992   20.79469   20.149921  20.79469
 20.79469   20.13618   20.169825  20.79469   19.50103   20.79469
 20.79469   20.14992   20.79469   20.149921  20.79469   20.79469
 20.149921  20.14992   20.79469   20.149921  20.79469   20.79469
 20.79469   15.571862  16.560757  16.560757  20.136183  18.649115
 19.44457   20.79469   20.149921  20.13618   20.13618   20.14992
 15.271313  20.79469   20.79469   20.79469   20.3354    15.066472
 16.560759  20.79469   20.136187  20.149923  20.149921  11.431798
 20.136183  20.149921  20.79469   20.136189  20.136183  20.13618
 20.79469   20.79469   17.730644  16.560762 ]
2025-06-02 15:43:13,848 - DEBUG - Edge reconstruction errors: [  4.494918   4.426411  43.24531  ...  12.345311  12.345303 534.24567 ]
2025-06-02 15:43:13,850 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154313_update_20.json
2025-06-02 15:43:13,850 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:13,853 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154313_update_20.pth and as latest_checkpoint.pth
2025-06-02 15:43:13,853 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.0043
2025-06-02 15:43:13,853 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:43:13,853 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.5226, MLP Score: 0.0066
2025-06-02 15:43:13,853 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.6967, MLP Score: 0.0054
2025-06-02 15:43:13,853 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.3116, MLP Score: 0.0041
2025-06-02 15:43:13,853 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.4388, MLP Score: 0.0058
2025-06-02 15:43:13,854 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.3483, MLP Score: 0.0040
2025-06-02 15:43:13,854 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:13,854 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2452, MLP Score: 0.0000
2025-06-02 15:43:13,854 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9476, MLP Score: 0.0000
2025-06-02 15:43:13,854 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0460, MLP Score: 0.0000
2025-06-02 15:43:13,854 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7479, MLP Score: 0.0000
2025-06-02 15:43:13,854 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2457, MLP Score: 0.0000
2025-06-02 15:43:13,854 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-02 15:43:13,854 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:43:13,854 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:43:13,854 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:43:13,878 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:43:13,898 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:43:13,898 - INFO - Processing node updates/additions.
2025-06-02 15:43:13,904 - INFO - Processing edge updates/additions.
2025-06-02 15:43:13,916 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:13,917 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:13,918 - DEBUG - Updated graph - Nodes: 653, Edges: 1355
2025-06-02 15:43:13,918 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:13,920 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:13,929 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-02 15:43:13,935 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:13,941 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-02 15:43:13,947 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-02 15:43:13,949 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:13,957 - DEBUG - Initial edge attributes tensor shape: torch.Size([1355, 10])
2025-06-02 15:43:13,963 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:13,968 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1355, 10])
2025-06-02 15:43:13,969 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:13,969 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:13,971 - INFO - Updated main graph to 653 nodes and 1355 edges.
2025-06-02 15:43:13,971 - INFO - Performing online update...
2025-06-02 15:43:13,971 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:13,972 - DEBUG - Updated RunningStats: new_mean=0.9401717470158093, new_var=11400000000160.668, new_n=1170
2025-06-02 15:43:13,972 - DEBUG - Updated RunningStats: new_mean=0.935138272560361, new_var=11700000000019.045, new_n=1200
2025-06-02 15:43:13,973 - DEBUG - Updated RunningStats: new_mean=41.59544081049852, new_var=3800000193812.523, new_n=390
2025-06-02 15:43:13,973 - DEBUG - Updated RunningStats: new_mean=41.82345538560301, new_var=3900000225254.5874, new_n=400
2025-06-02 15:43:13,974 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:13,974 - DEBUG - Online update step: 1/25
2025-06-02 15:43:13,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,974 - DEBUG - Online update step: 2/25
2025-06-02 15:43:13,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,974 - DEBUG - Online update step: 3/25
2025-06-02 15:43:13,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,974 - DEBUG - Online update step: 4/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 5/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 6/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 7/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 8/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 9/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,975 - DEBUG - Online update step: 10/25
2025-06-02 15:43:13,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 11/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 12/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 13/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 14/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 15/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 16/25
2025-06-02 15:43:13,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,976 - DEBUG - Online update step: 17/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 18/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 19/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 20/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 21/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 22/25
2025-06-02 15:43:13,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,977 - DEBUG - Online update step: 23/25
2025-06-02 15:43:13,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,978 - DEBUG - Online update step: 24/25
2025-06-02 15:43:13,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,978 - DEBUG - Online update step: 25/25
2025-06-02 15:43:13,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:13,978 - WARNING - No successful steps during online update.
2025-06-02 15:43:13,979 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], current edge mean: [-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:43:13,980 - DEBUG - Node drift difference: 0.0281, Edge drift difference: 0.0043
2025-06-02 15:43:13,981 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], edge=[-4.9267306e-09  4.6377417e+02  0.0000000e+00  0.0000000e+00
  3.5190935e-09  1.0557281e-09 -1.4076373e-09  2.8152747e-09
  0.0000000e+00 -5.8065042e-09]
2025-06-02 15:43:13,982 - DEBUG - Updated reference std: node=[0.         0.         1.0007665  1.0007666  0.         0.
 0.         1.0007665  1.0007665  1.0007665  1.0007665  1.0007666
 1.0142448  0.28991058 0.3638549  0.56661487 1.0007665  3.0958197
 2.9316137  1.5298709  0.3638549  0.         1.0007666  1.0007666
 0.         0.         0.         0.         1.0007666  1.0007665 ], edge=[  1.0003692 500.15765     0.          0.          1.0003692   1.0003692
   1.0003692   1.0003692   1.0003692   1.0003692]
2025-06-02 15:43:13,982 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:13,983 - INFO - Running anomaly detection...
2025-06-02 15:43:13,983 - INFO - Starting anomaly detection.
2025-06-02 15:43:13,996 - DEBUG - Node reconstruction errors: [21.187866  11.876922  19.22687   33.55077   15.763591  16.725729
 17.671358  27.801022  27.801022  30.716936  27.801025  19.949785
 23.599998  11.92228   28.599453  28.543629  19.435873  28.543621
 28.43976   27.306246  22.757206  28.59945   19.305267  13.040383
 27.659655  31.34185   27.659655  16.079306  26.825802  27.659649
 14.822413  29.73339   15.024143  32.485508  31.37852   21.240185
 16.24785   27.306246  15.38996   13.188688  32.9778    27.396097
 27.306246  27.508806  31.289824  19.857111  31.09745   12.012241
 25.891687  34.265373  42.092777  29.992453  30.414337  22.484001
 20.708591  16.649721  21.351467  25.044476  25.313908  25.16146
 13.104328  20.959038  26.275396  11.761152  26.569681  20.70859
 21.62152   20.708597  26.275393  26.275393  20.51255   19.282255
 21.999537  17.525522  16.467691  19.474161  25.915422  18.603498
 15.891076  17.346964  29.122154  17.264486   8.301434  27.408442
 19.994318  12.458692  19.067406  15.835691  17.494665  16.75857
 24.597607  14.444009  14.604654  16.02795   20.404413  35.282345
 28.009806  15.963749  23.342953  20.851213  17.92845   28.009806
 28.284449  17.777927  12.348447  20.606144  20.953032  15.089656
 15.338971  24.900333  18.782295  27.250202  16.03412   15.179126
 17.701506  17.052174  17.5067    14.445257  16.813444  19.19207
 22.792318  14.604655  15.349851  11.401777  15.940852  19.192043
 12.499575  11.6817045 15.999288  24.69626   25.11295   22.311003
 23.27945   17.531069  17.052176  20.629175  26.402771  24.169575
 11.723833  14.03535   21.570312  16.968378  22.072086  20.904167
 20.30747   18.013048  17.506697  23.990515  22.080976  16.36257
 29.098272  10.966117  17.100103  22.311003  18.126383  13.913266
 21.536585  16.306402  17.928446  30.049126  23.990509  13.524494
 21.536585  25.112951  17.421392  14.8684    17.742289  15.834023
 11.548452  15.958379  17.216658  20.855907  24.41028   28.089762
 15.314878  13.143439  15.80733   16.887747  17.271318  17.271322
 19.795223  15.757184  21.13174   15.560979  14.231015  17.349398
 21.258427  17.058277  19.80584   20.671478  15.822474  15.531694
 26.16319   23.068403  11.723841  23.742096  10.130739  21.383728
 14.856692  25.459215  20.206934  21.536581  14.67158   16.700993
 17.524529  14.604653  24.177893  17.785666  22.530481  16.609278
 16.806997  17.349403  26.16319   15.181818  17.349401  21.395876
 15.945292  17.506697  17.152763  23.068403  14.63667   21.258427
 23.429598  26.16319   21.536585  16.27692   13.86847   23.933353
 16.59811   26.53182   15.84054   15.346686  15.789607  17.506695
 17.5067    23.742096  16.20293   23.4296    21.536585  27.112007
 14.488124  15.644039  22.927116  16.362566  22.889791  15.789606
 16.171568  16.715652  22.927114  19.972494  24.410282  24.419397
 17.152765  16.246197  17.05217   17.76715   20.671478  21.01934
 23.44356   17.271322  15.247903  14.248204  25.639612  20.671478
 16.59811   19.646727  16.671797  14.533729  16.671799  17.271322
 15.470214  14.690213  15.483123  19.522     17.091621  17.271318
 20.891846  17.996172  19.79522   16.393162  14.808352  21.593159
 15.434305  28.61379   19.050608  26.571402  14.3890705 13.283651
 15.757186  11.345943  19.050196  24.55847   22.940908  22.889788
 11.325304  23.20578   15.709625  17.271154  23.742102  22.415945
 15.198233  22.325449  16.539051  16.539051  22.32545   22.325449
 22.325449  17.001537  21.618834  22.325449  22.325449  15.05785
 22.325449  24.368155  11.356846  15.89799   18.66452   13.967865
 25.176022  23.7421    16.216206  19.159342  16.942167  16.539051
 19.188349  15.096494  22.418377  17.00154   16.496607  16.496607
 17.248169  22.909386  22.325447  17.091623  22.325449  17.00154
 18.934874  23.44356   22.418377  22.418379  22.325449  22.885305
 22.418379  16.216208  15.11566   16.6718    16.539051  25.759724
 17.291494  16.134958  22.325449  15.82752   14.133394  15.743173
 22.125666  20.671478  20.296492  22.325449  23.20578   23.205776
 16.806995  19.757652  19.500772  15.2650585 16.53904   18.194035
 21.846706  13.705796  16.76722   15.97485   15.057719  15.719723
 15.200799  14.1400795 15.998468  16.74936   22.552849  21.794168
 16.52971   22.325449  16.539047  11.955667  19.962729  17.473682
 13.26891   16.695656  21.0568    12.3684435 17.40554   22.32545
 19.358732  16.69566   16.197044  16.197044  16.844479  16.84448
 16.844479  21.004723  21.570704  20.853823  21.15724   17.803785
 16.84448   21.570704  16.03641   16.197037  16.209047  21.018139
 16.197044  10.836731  16.844479  16.197044  21.570704  16.844479
 16.844479  21.234135  22.033146  16.84448   22.552906  20.46804
 19.639692  21.157244  15.85761   21.142864  14.294162  22.759047
 20.464502  17.744823  13.598186  24.030344  16.12634   20.28421
 16.844477  16.535913  16.84448   16.84448   21.15724   15.932297
 16.16968   19.40401   20.432823  20.26607   24.327854  24.327856
 24.327854  11.475727  17.251833  23.449156  23.449154  20.418911
 15.77573   21.082222  19.768932  20.888355  21.08222   22.552279
 20.46762   19.841736  25.124853  15.857606  16.26483   20.46762
 21.142864  15.326593  19.841732  20.467625  21.805424  15.857608
 13.678697  24.29318   21.805424  16.26483   15.242023  13.745809
 15.389119  15.857229  16.26483   16.264828  20.432823  20.418911
 24.3636    13.647537  21.787157  20.418911  14.325307  21.11276
 21.082222  12.694822  23.320097  13.735945  15.857607  20.432823
 15.207738  20.468035  15.796931  19.841738  15.7969265 22.642153
 20.88836   20.41891   20.418911  20.46804   20.418911  20.140158
 21.112757  23.320097  20.244606  14.166473  19.768934  21.082222
 23.320099  19.603037  19.603035  21.082222  15.57819   21.082222
 20.244608  15.578189  21.082222  15.519964  15.578191  20.26607
 20.244606  23.449154  21.112757  15.796929  22.468239  12.207455
 15.578191  15.77573   21.08222   20.88836   20.888357  20.41891
 15.79693   16.536022  14.995478  15.389123  20.888355  16.536026
 20.88836   16.536022  19.41317   15.57819   19.603033  19.603033
 19.603037  20.240284  15.830867  20.240286  20.240276  20.240284
 20.240286  20.240286  20.240284  20.240284  20.240286  19.585388
 22.670607  20.240286  20.240284  20.240284  20.240276  20.240284
 20.240284  20.240284  20.240284  20.240286  20.240286  20.240284
 20.240284  15.543271  20.240282  21.082222  20.056616  20.888355
 21.257458  16.168253  33.60775   33.60775   15.864432  21.257458
 20.888355  20.244606  20.244606  20.888363  20.244606  20.88836
 19.403769  20.240286  20.26607   20.888363  19.603035  20.888355
 20.888355  20.244606  20.88836   20.244604  20.888363  20.888363
 20.244606  20.244608  20.888355  20.244606  20.88836   20.888355
 20.888357  15.206497  16.62831   16.62831   20.240284  18.754374
 19.538158  20.888363  20.244606  20.240286  20.240284  20.244608
 15.345626  20.88836   20.88836   20.888355  20.437971  15.134813
 16.628307  20.888357  15.543271  20.244608  20.244606  11.49555
 20.240284  20.244606  15.578192  20.240286  20.240286  20.240284
 20.88836   20.88836   17.844904  16.628305  20.240286  15.134815
 23.58365   15.839487  15.839487  19.503012  20.43797   20.240284
 20.240276  15.839487  15.134815  16.00652   20.43797  ]
2025-06-02 15:43:13,997 - DEBUG - Edge reconstruction errors: [  4.475626    4.4121428  43.245102  ...  12.345097   12.345086
 534.2456   ]
2025-06-02 15:43:14,000 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154313_update_21.json
2025-06-02 15:43:14,001 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:14,007 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154314_update_21.pth and as latest_checkpoint.pth
2025-06-02 15:43:14,008 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.0044
2025-06-02 15:43:14,008 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 15:43:14,008 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.5508, MLP Score: 0.0066
2025-06-02 15:43:14,008 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.7169, MLP Score: 0.0055
2025-06-02 15:43:14,009 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.3419, MLP Score: 0.0041
2025-06-02 15:43:14,009 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.4855, MLP Score: 0.0058
2025-06-02 15:43:14,009 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.3785, MLP Score: 0.0041
2025-06-02 15:43:14,009 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:14,009 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2450, MLP Score: 0.0000
2025-06-02 15:43:14,010 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9474, MLP Score: 0.0000
2025-06-02 15:43:14,010 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0457, MLP Score: 0.0000
2025-06-02 15:43:14,010 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7479, MLP Score: 0.0000
2025-06-02 15:43:14,011 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2455, MLP Score: 0.0000
2025-06-02 15:43:14,025 - DEBUG - Embedding standard deviations before t-SNE: [1.3989184  0.02385233 0.8824374  1.550771   0.03406976 0.67365026
 0.9232864  0.5128517  0.7102256  2.6081157  1.9829897  1.9832878
 1.2282785  0.737782   1.2274455  1.2044525  0.1383925  0.79226273
 0.         1.2932101  0.26387358 1.6664941  0.         0.26965982
 0.5550839  0.8342666  0.00315873 1.4540406  2.0876615  0.
 1.2804252  1.1955417 ]
2025-06-02 15:43:14,705 - INFO - Embeddings visualization saved to vis/embeddings_21_updates_20250602_154314.png
2025-06-02 15:43:14,705 - INFO - Performing visualization of node and edge features.
2025-06-02 15:43:14,706 - INFO - Starting visualization of node features.
2025-06-02 15:43:14,706 - INFO - Graph has 653 nodes and 30 features.
2025-06-02 15:43:14,707 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:43:14,707 - INFO - Calculating feature statistics:
2025-06-02 15:43:14,707 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,707 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,707 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5793545), 'max': np.float32(1.4206686)}
2025-06-02 15:43:14,707 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.3954121), 'max': np.float32(2.629857)}
2025-06-02 15:43:14,707 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,707 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,707 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,707 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4277511), 'max': np.float32(2.337808)}
2025-06-02 15:43:14,707 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(4.6734424e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1985687), 'max': np.float32(0.8343284)}
2025-06-02 15:43:14,707 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-8.865789), 'max': np.float32(0.11624347)}
2025-06-02 15:43:14,708 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-3.7988932), 'max': np.float32(0.8994265)}
2025-06-02 15:43:14,708 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(-2.3367212e-08), 'std': np.float32(1.0), 'min': np.float32(-0.88663286), 'max': np.float32(3.8624964)}
2025-06-02 15:43:14,708 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.361409), 'std': np.float32(1.0134679), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:43:14,708 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.957121), 'std': np.float32(0.28968853), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:43:14,708 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:14,708 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.376723), 'std': np.float32(0.5661809), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:43:14,708 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.11624347), 'max': np.float32(8.865789)}
2025-06-02 15:43:14,708 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.474732), 'std': np.float32(3.0934484), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:43:14,708 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6738133), 'std': np.float32(2.9293683), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:14,708 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5895867), 'std': np.float32(1.528699), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:14,708 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:14,708 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:43:14,708 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1343134), 'max': np.float32(14.483462)}
2025-06-02 15:43:14,709 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.841803e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14801767), 'max': np.float32(6.75595)}
2025-06-02 15:43:14,709 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,709 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,709 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,709 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:14,709 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0165796), 'max': np.float32(8.674318)}
2025-06-02 15:43:14,709 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.8418028e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1326946), 'max': np.float32(4.414677)}
2025-06-02 15:43:14,721 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c189eca10>
2025-06-02 15:43:14,848 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:43:14,898 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:43:14,924 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:16,211 - INFO - Node feature visualization saved to vis/node_features_20250602_154315.png
2025-06-02 15:43:16,211 - INFO - Finished visualization of node features.
2025-06-02 15:43:16,211 - INFO - Performing additional feature analysis:
2025-06-02 15:43:16,211 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:16,212 - INFO - Starting visualization of edge features.
2025-06-02 15:43:16,212 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:43:16,212 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:16,212 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:16,212 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:16,212 - INFO - - count: {'name': 'count', 'unique': 24, 'mean': np.float32(-4.2229122e-09), 'std': np.float32(1.0), 'min': np.float32(-0.047597624), 'max': np.float32(27.940474)}
2025-06-02 15:43:16,212 - INFO - - dst_port: {'name': 'dst_port', 'unique': 15, 'mean': np.float32(463.77417), 'std': np.float32(499.97305), 'min': np.float32(3.0), 'max': np.float32(8688.0)}
2025-06-02 15:43:16,213 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:16,213 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:16,213 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 904, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.07276706), 'max': np.float32(27.607315)}
2025-06-02 15:43:16,213 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 960, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.06579117), 'max': np.float32(27.892584)}
2025-06-02 15:43:16,213 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 316, 'mean': np.float32(1.4076373e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.056002725), 'max': np.float32(27.88871)}
2025-06-02 15:43:16,213 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 937, 'mean': np.float32(2.1114561e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12164314), 'max': np.float32(19.201406)}
2025-06-02 15:43:16,213 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 955, 'mean': np.float32(2.8152747e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11973842), 'max': np.float32(18.085634)}
2025-06-02 15:43:16,213 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 353, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06595535), 'max': np.float32(27.347694)}
2025-06-02 15:43:16,224 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c0982dc40>
2025-06-02 15:43:16,303 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:16,313 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c0938e180>
2025-06-02 15:43:16,390 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:16,534 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:16,668 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:16,689 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:16,697 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:17,918 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154316.png
2025-06-02 15:43:17,918 - INFO - Finished visualization of edge features.
2025-06-02 15:43:17,918 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:17,918 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:17,918 - INFO - - Highest correlation (1.00) between features: 'total_orig_bytes' and 'total_orig_ip_bytes'.
2025-06-02 15:43:17,919 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:17,919 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:43:17,919 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:18,209 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154317_summary.png
2025-06-02 15:43:18,463 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154317_pca_3d.png
2025-06-02 15:43:18,671 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154317_pca_variance.png
2025-06-02 15:43:18,671 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:18,671 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-02 15:43:18,671 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:43:18,671 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:43:18,672 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:43:18,689 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:43:18,705 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:43:18,705 - INFO - Processing node updates/additions.
2025-06-02 15:43:18,709 - INFO - Processing edge updates/additions.
2025-06-02 15:43:18,716 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:18,717 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:18,717 - DEBUG - Updated graph - Nodes: 693, Edges: 1448
2025-06-02 15:43:18,717 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:18,718 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:18,725 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-02 15:43:18,726 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:18,726 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-02 15:43:18,727 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-02 15:43:18,728 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:18,731 - DEBUG - Initial edge attributes tensor shape: torch.Size([1448, 10])
2025-06-02 15:43:18,732 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:18,732 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1448, 10])
2025-06-02 15:43:18,732 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:18,732 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:18,732 - INFO - Updated main graph to 693 nodes and 1448 edges.
2025-06-02 15:43:18,733 - INFO - Performing online update...
2025-06-02 15:43:18,733 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:18,733 - DEBUG - Updated RunningStats: new_mean=0.940599945244928, new_var=12000000000161.371, new_n=1230
2025-06-02 15:43:18,733 - DEBUG - Updated RunningStats: new_mean=0.9357146834184095, new_var=12300000000018.945, new_n=1260
2025-06-02 15:43:18,733 - DEBUG - Updated RunningStats: new_mean=41.93008753559372, new_var=4000000192247.603, new_n=410
2025-06-02 15:43:18,734 - DEBUG - Updated RunningStats: new_mean=42.1009306896671, new_var=4100000210703.012, new_n=420
2025-06-02 15:43:18,734 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:18,734 - DEBUG - Online update step: 1/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 2/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 3/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 4/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 5/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 6/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 7/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 8/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 9/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 10/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 11/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 12/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 13/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 14/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 15/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 16/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 17/25
2025-06-02 15:43:18,734 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,734 - DEBUG - Online update step: 18/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 19/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 20/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 21/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 22/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 23/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 24/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - DEBUG - Online update step: 25/25
2025-06-02 15:43:18,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:18,735 - WARNING - No successful steps during online update.
2025-06-02 15:43:18,735 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], current edge mean: [-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:43:18,735 - DEBUG - Node drift difference: 0.0304, Edge drift difference: 0.0036
2025-06-02 15:43:18,736 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], edge=[-1.3172298e-09  4.6195374e+02  0.0000000e+00  0.0000000e+00
 -1.3172298e-09  4.9396114e-09 -1.3172298e-09  2.6344595e-09
 -3.9516892e-09  9.8792230e-10]
2025-06-02 15:43:18,736 - DEBUG - Updated reference std: node=[0.         0.         1.0007223  1.0007223  0.         0.
 0.         1.0007223  1.0007223  1.0007224  1.0007223  1.0007223
 0.98739225 0.28158483 0.36058903 0.565704   1.0007224  3.083906
 2.926053   1.4880826  0.36058903 0.         1.0007223  1.0007223
 0.         0.         0.         0.         1.0007223  1.0007223 ], edge=[  1.0003455 484.05258     0.          0.          1.0003455   1.0003455
   1.0003455   1.0003455   1.0003455   1.0003455]
2025-06-02 15:43:18,736 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:18,737 - INFO - Running anomaly detection...
2025-06-02 15:43:18,737 - INFO - Starting anomaly detection.
2025-06-02 15:43:18,742 - DEBUG - Node reconstruction errors: [21.025755  12.104531  19.778015  33.528465  15.889166  16.83484
 18.214409  27.778511  27.778511  30.71884   27.778515  19.987232
 24.597721  11.9792185 28.608574  28.493395  19.552359  28.49339
 28.54378   27.313902  22.94149   28.608574  19.53372   13.151636
 27.70645   31.375858  27.706442  16.241823  26.849466  27.70645
 15.180823  29.77081   14.927108  32.504475  31.424261  20.983301
 16.373837  27.313902  15.5371    13.304472  33.06147   27.455145
 27.313902  27.826351  31.329863  20.086168  31.425554  11.638791
 25.953808  34.703323  42.671818  30.060787  30.488106  22.82768
 20.905907  14.721106  21.964048  25.148384  25.520819  25.411446
 13.202826  20.698256  26.38656   11.889852  26.66645   20.905897
 21.823782  20.905905  26.38656   26.38656   20.723778  19.361626
 22.25645   17.64124   16.612823  19.546778  26.260166  18.710024
 16.045097  17.467741  29.290123  17.393965   8.087715  27.701561
 20.262201  12.582953  19.19326   15.985942  17.607246  16.917864
 24.773752  14.613035  14.771642  16.174961  20.641485  35.86762
 28.209444  16.12029   23.543636  21.087301  18.05376   28.209442
 28.558636  17.94123   10.76274   20.843407  20.675182  15.2048435
 15.485491  25.302433  19.0152    27.490175  14.830853  15.319129
 17.837461  17.19918   17.638746  14.622033  16.943783  19.461376
 23.032682  12.649191  14.727627  11.534487  16.09165   19.461344
 12.642205  11.836491  16.030546  19.36064   25.40362   22.544674
 23.434074  17.712856  17.19918   20.87498   26.737955  24.336601
 11.881594  14.144138  21.829906  17.133581  22.319178  21.162441
 20.57701   18.144468  17.638744  24.174685  22.309322  16.500357
 29.28261   10.762739  17.23896   22.54467   18.224148  14.079422
 21.788158  15.680359  18.05376   30.265348  24.174685  13.728023
 21.788153  25.40362   17.551643  15.045322  17.896828  15.975081
 11.691188  16.101921  17.336699  18.91687   24.58457   28.669394
 15.45704   13.208933  15.973247  17.034674  17.40748   17.40748
 20.034185  15.867612  21.306402  15.715948  14.408997  17.488794
 21.524305  17.18475   20.061527  20.935051  15.966054  15.691247
 22.725224  23.278284  11.881601  24.059404  10.198804  21.037489
 15.029131  25.73419   20.437431  21.788158  14.817317  16.833048
 17.666567  14.77164   24.45889   17.985445  22.767673  16.757793
 16.949438  17.4888    26.416069  15.317561  17.488794  21.661741
 15.65199   17.638746  17.290606  23.278284  14.776267  21.524305
 23.637737  26.416069  21.788157  16.421417  14.045054  24.110966
 16.729319  26.727468  13.224315  15.514013  15.3211    17.638744
 17.638742  24.059404  15.324917  23.637737  21.788153  23.67106
 14.658462  15.803327  23.138437  16.500359  23.099825  15.943717
 16.321997  16.879524  23.138437  20.224985  24.58457   24.593908
 17.290606  15.216475  17.199184  17.899239  20.935053  21.283834
 20.347477  17.407478  15.412799  14.373474  25.84535   19.321775
 15.3198805 19.907696  16.825943  14.877795  16.825937  15.697822
 15.653423  14.863341  15.646953  19.76069   17.249506  17.407478
 21.113522  18.126928  20.034187  16.540552  14.690525  21.79936
 15.584883  28.860573  15.683013  26.81272   14.509376  13.486742
 15.867616  11.030536  18.762829  24.857092  23.19027   23.099821
 11.461274  23.404041  15.449398  17.407305  24.059399  22.585966
 15.347443  22.53778   16.69737   16.69737   22.53778   22.537785
 22.537785  17.155895  21.839626  22.537785  22.537785  14.901232
 22.537785  20.197876  11.49046   16.054726  18.840494  14.137868
 25.455536  23.370884  16.381807  19.412016  17.0705    16.69737
 19.477854  15.260716  22.642696  17.155903  16.644316  16.644316
 17.422255  23.248455  22.537783  17.249504  22.537783  17.155905
 18.641577  23.643728  22.642693  22.642696  22.537785  23.064264
 22.642696  15.251928  15.277209  16.825937  16.697369  26.027872
 17.420963  16.27258   22.537783  15.978841  14.21473   15.903441
 22.328888  20.935053  20.567423  22.53778   23.404041  23.404036
 16.949442  20.039785  19.78168   15.432588  16.697361  18.761097
 22.078571  13.880133  16.908642  16.124968  15.213752  15.876113
 14.901137  14.314483  16.16433   16.920218  22.766884  22.019642
 16.67098   22.537785  16.697369  12.083452  20.242178  17.621592
 13.47746   16.831753  21.278452  10.642426  17.545162  22.537785
 19.513672  16.831755  16.337168  15.584772  16.995573  16.995577
 16.995577  21.356604  21.789055  21.20944   19.514566  17.964252
 16.995573  21.789057  16.194214  16.337156  16.370861  21.234434
 16.337168  10.987705  16.995573  16.337168  21.789057  16.995577
 16.995573  20.22784   22.235075  16.995575  22.76687   20.737623
 19.894289  21.377256  16.014277  21.383211  14.459689  22.983624
 20.713564  17.890993  13.752468  24.262388  16.27827   20.49915
 15.819109  16.701687  16.995577  16.995577  21.377256  16.076496
 16.36752   19.631626  20.686436  20.518627  24.613026  24.61303
 24.613035  11.609417  17.417906  23.768093  23.768099  20.669363
 15.92366   21.31719   20.042385  21.119574  21.317192  22.854239
 20.728216  20.121466  25.39153   16.014278  16.418386  20.728216
 21.383213  15.494071  20.121466  20.728212  22.01842   16.014277
 13.844011  24.585815  22.018421  16.418385  15.395541  13.861453
 15.559818  16.0139    16.418385  16.418386  20.686436  20.669363
 24.661818  13.204614  22.004206  20.669363  14.488555  21.341105
 21.31719   12.896885  23.564135  13.850726  15.552212  20.686436
 15.3427515 20.737629  15.942348  20.121468  15.942344  22.971285
 21.119577  20.669363  20.669361  20.737629  20.669363  20.356348
 21.3411    23.564135  20.491781  14.273187  20.042385  21.31719
 23.564129  19.877962  19.877964  21.317186  15.736523  21.31719
 20.491781  15.736527  25.23833   15.143306  15.736525  20.518627
 20.491785  23.768099  21.341105  15.942346  22.785038  12.329115
 15.73653   15.923659  21.31719   21.119574  21.119577  20.669363
 15.942347  15.864535  15.144745  15.559827  21.119577  16.703682
 21.11958   16.70368   19.098364  15.7365265 19.877966  19.877962
 19.877962  20.484322  15.926282  20.484312  20.484322  20.484322
 20.484316  20.484322  20.484316  20.484316  15.706644  19.858004
 22.927263  20.484314  20.484316  20.484316  20.484312  20.484316
 20.484322  20.484312  20.484316  20.484316  15.340707  20.484316
 20.484316  15.706645  20.484314  21.31719   20.219715  21.119577
 21.461966  16.34553   33.931736  33.931736  16.018085  21.461966
 21.119576  20.491781  20.491785  21.119577  20.491789  21.119574
 18.51729   20.484316  20.518627  21.119577  19.877962  21.119576
 21.119577  20.491789  21.119577  20.491785  21.119577  21.119577
 15.736526  20.491785  21.119577  20.491785  21.119577  21.11958
 21.11958   15.372803  16.78795   16.78795   20.484316  19.025097
 19.694723  21.119576  20.491785  14.901654  20.484314  20.491785
 15.51177   19.90468   21.119577  21.119576  15.910005  15.307098
 16.78795   21.119577  15.706646  20.491785  20.491789  11.620716
 20.484314  20.491781  15.736525  20.484316  20.484314  15.706647
 21.119577  21.119577  18.131844  16.78795   20.484316  15.307098
 23.885565  16.029232  16.029234  19.66643   20.677431  20.484314
 20.484316  16.029238  15.307097  16.180006  20.677427  20.090065
 19.89837   19.898367  19.898365  19.898367  19.898367  19.898369
 19.898367  19.898367  19.89837   20.484316  20.484312  20.484316
 16.029232  14.90186   16.029238  20.217499  16.029234  20.484316
 20.484316  20.484312  20.484316  20.484312  16.029234  20.70378
 19.88451   19.88451   19.898367  20.70378   16.180006  19.640848
 20.484314  20.484322  19.898369  20.090065  19.884508  19.884508
 20.090063  20.115562  19.898365 ]
2025-06-02 15:43:18,742 - DEBUG - Edge reconstruction errors: [  4.497515    4.4176035  43.24523   ...  12.345222   12.345211
 534.2458   ]
2025-06-02 15:43:18,743 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154318_update_22.json
2025-06-02 15:43:18,744 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:18,747 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154318_update_22.pth and as latest_checkpoint.pth
2025-06-02 15:43:18,747 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.0044
2025-06-02 15:43:18,747 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 15:43:18,747 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.5285, MLP Score: 0.0065
2025-06-02 15:43:18,747 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.7188, MLP Score: 0.0053
2025-06-02 15:43:18,747 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.3759, MLP Score: 0.0040
2025-06-02 15:43:18,747 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.5045, MLP Score: 0.0057
2025-06-02 15:43:18,747 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.4243, MLP Score: 0.0040
2025-06-02 15:43:18,747 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:18,747 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2452, MLP Score: 0.0000
2025-06-02 15:43:18,747 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9476, MLP Score: 0.0000
2025-06-02 15:43:18,748 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0458, MLP Score: 0.0000
2025-06-02 15:43:18,748 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7480, MLP Score: 0.0000
2025-06-02 15:43:18,748 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2457, MLP Score: 0.0000
2025-06-02 15:43:18,748 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-02 15:43:18,748 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:43:18,748 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:43:18,748 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:43:18,766 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:43:18,786 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:43:18,786 - INFO - Processing node updates/additions.
2025-06-02 15:43:18,791 - INFO - Processing edge updates/additions.
2025-06-02 15:43:18,799 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:18,800 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:18,801 - DEBUG - Updated graph - Nodes: 700, Edges: 1476
2025-06-02 15:43:18,801 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:18,802 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:19,048 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-02 15:43:19,050 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:19,050 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-02 15:43:19,051 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-02 15:43:19,052 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:19,055 - DEBUG - Initial edge attributes tensor shape: torch.Size([1476, 10])
2025-06-02 15:43:19,055 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:19,056 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1476, 10])
2025-06-02 15:43:19,056 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:19,056 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:19,056 - INFO - Updated main graph to 700 nodes and 1476 edges.
2025-06-02 15:43:19,056 - INFO - Performing online update...
2025-06-02 15:43:19,056 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:19,057 - DEBUG - Updated RunningStats: new_mean=0.9408962908400099, new_var=12600000000160.984, new_n=1290
2025-06-02 15:43:19,057 - DEBUG - Updated RunningStats: new_mean=0.9362716635058301, new_var=12900000000019.05, new_n=1320
2025-06-02 15:43:19,057 - DEBUG - Updated RunningStats: new_mean=42.19462086323534, new_var=4200000191673.1953, new_n=430
2025-06-02 15:43:19,057 - DEBUG - Updated RunningStats: new_mean=42.34154735289656, new_var=4300000206746.0786, new_n=440
2025-06-02 15:43:19,057 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:19,057 - DEBUG - Online update step: 1/25
2025-06-02 15:43:19,057 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,057 - DEBUG - Online update step: 2/25
2025-06-02 15:43:19,057 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 3/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 4/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 5/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 6/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 7/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 8/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 9/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 10/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 11/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 12/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 13/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 14/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 15/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 16/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 17/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 18/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 19/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 20/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 21/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 22/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,058 - DEBUG - Online update step: 23/25
2025-06-02 15:43:19,058 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,059 - DEBUG - Online update step: 24/25
2025-06-02 15:43:19,059 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,059 - DEBUG - Online update step: 25/25
2025-06-02 15:43:19,059 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,059 - WARNING - No successful steps during online update.
2025-06-02 15:43:19,059 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], current edge mean: [-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:43:19,059 - DEBUG - Node drift difference: 0.0145, Edge drift difference: 0.0014
2025-06-02 15:43:19,060 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], edge=[-3.8767247e-09  4.6129608e+02  0.0000000e+00  0.0000000e+00
 -4.5228457e-09 -1.9383624e-09  6.4612082e-10  2.5844833e-09
 -2.5844833e-09 -2.2614228e-09]
2025-06-02 15:43:19,060 - DEBUG - Updated reference std: node=[0.         0.         1.000715   1.000715   0.         0.
 0.         1.0007151  1.000715   1.000715   1.000715   1.0007151
 0.9945478  0.2802002  0.36725795 0.5633757  1.000715   3.0975275
 2.9325864  1.5110466  0.36725795 0.         1.000715   1.000715
 0.         0.         0.         0.         1.000715   1.000715  ], edge=[  1.0003389 479.5915      0.          0.          1.0003389   1.0003389
   1.0003389   1.0003389   1.0003389   1.0003389]
2025-06-02 15:43:19,060 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:19,060 - INFO - Running anomaly detection...
2025-06-02 15:43:19,060 - INFO - Starting anomaly detection.
2025-06-02 15:43:19,066 - DEBUG - Node reconstruction errors: [21.152147  12.196021  19.916914  33.479023  15.355859  16.88381
 18.33187   27.7297    27.729698  30.674313  27.729698  20.000765
 24.760778  11.8702    28.582727  28.41728   19.623547  28.417286
 28.526157  27.27354   23.01348   28.582727  19.160234  13.214588
 27.698065  31.35098   27.698065  16.306704  26.819632  27.69807
 15.28613   29.747902  14.991791  32.4854    31.398954  21.101929
 16.419563  27.27354   15.619081  13.35835   33.06622   27.446484
 27.273542  27.966516  31.310497  20.202105  31.544302  11.695257
 25.940302  31.560314  38.140934  30.061258  30.487022  22.956608
 20.984838  14.805927  22.114946  25.158882  25.572176  25.463335
 13.252836  20.82383   26.396454  11.964909  26.679817  20.984838
 21.9049    20.984846  26.396454  26.396454  18.529472  19.387493
 22.358564  17.688015  16.671618  19.568796  26.410921  18.76282
 16.106998  17.51575   29.338015  17.445715   8.1507015 27.82736
 20.379047  12.652637  17.216757  16.047846  17.657637  16.355526
 24.836285  14.6920595 14.874297  16.238401  20.74433   35.98013
 28.282204  16.18759   23.628017  21.192442  18.106005  28.282202
 28.669308  18.00965   10.840077  20.95407   20.808596  15.241218
 15.567056  25.454075  19.121761  27.580128  14.922168  15.391166
 17.896925  17.26612   17.698277  14.707988  17.002562  19.585331
 23.129078  12.7563715 14.8181305 11.611818  16.16249   19.5853
 12.724014  11.909331  16.096241  19.486061  25.51261   22.64356
 23.49507   17.794523  17.266125  20.980408  26.88433   24.396656
 11.958409  14.230292  21.940182  17.204319  22.43178   21.277126
 20.69698   18.205254  17.698277  24.237568  22.411364  16.566305
 29.349138  10.8400755 17.282782  22.643562  18.260017  14.150698
 21.900106  15.744708  18.106005  30.339273  24.237568  13.817859
 21.900106  25.512613  17.610638  15.131412  17.942394  16.04626
 11.757522  15.511746  17.386719  19.04819   24.6469    28.838604
 15.520208  13.256749  16.039896  15.97021   17.469591  17.469585
 20.155876  15.933494  21.40088   15.788177  13.834717  17.551575
 21.653585  17.245962  20.175188  21.056982  16.029802  15.760319
 22.881805  23.364113  11.958418  24.191767   7.9067707 21.168402
 15.116846  25.853361  20.551775  21.900108  14.903088  16.891808
 17.728851  14.874298  24.566233  18.07758   22.868889  16.805485
 17.018156  17.551575  26.51039   15.132345  15.537181  21.791584
 15.722507  17.698278  17.35267   23.36411   14.849669  21.653582
 23.717283  26.51039   21.900106  16.488277  14.132824  24.170813
 16.789833  26.794548  13.337644  15.591248  15.391213  17.698277
 17.69828   24.191765  15.40203   23.717283  21.900106  23.820557
 14.73712   15.245206  23.22439   16.56631   23.186256  16.0163
 16.387524  16.958683  23.22439   20.342718  24.646898  24.656332
 17.352669  15.284932  16.174324  17.966766  21.056982  21.402863
 20.48361   17.469587  15.482808  14.46184   25.931185  19.446964
 15.39296   20.021019  16.883049  15.012986  16.883045  15.767554
 15.745777  14.950563  15.722459  19.375772  17.30285   17.469593
 21.225689  18.187656  20.155876  16.612751  14.750096  21.896711
 15.666903  28.953321  15.749618  26.902855  14.596799  13.576715
 15.93349   11.115555  18.900074  24.996023  23.291687  23.186256
 11.546533  23.485462  15.051617  17.46941   24.191767  22.66438
 15.427021  22.63466   16.756401  16.756403  22.63466   22.634655
 22.634655  17.208014  21.944088  22.63466   22.63466   14.976014
 22.63466   20.319853  10.726654  16.122997  18.922834  14.248393
 25.564888  23.520527  16.44076   19.525919  17.12807   16.7564
 19.610884  15.349697  22.740976  17.208012  16.69363   16.693626
 17.489508  23.399477  22.63466   17.302845  22.63466   17.20801
 18.779675  23.72204   22.740984  22.740978  22.634657  23.14403
 22.740978  15.32754   15.35565   16.883049  16.756401  26.134912
 17.46927   16.339792  22.63466   15.746472  14.290567  15.972974
 22.424246  21.056978  20.702818  22.63466   23.485466  23.485462
 17.01816   20.174543  19.90399   15.150751  16.756384  18.939932
 22.18321   13.949432  16.977797  16.201574  15.290538  15.956758
 14.975893  13.977674  16.232656  16.98221   22.863874  22.124765
 16.72608   22.634657  16.756397  12.146397  20.363712  17.698893
 13.576293  16.899788  21.378084  10.723175  17.605757  22.63466
 19.59189   15.79315   16.408978  15.674152  17.059744  17.059744
 17.059744  21.493107  21.89325   21.343191  19.652348  18.039307
 17.059744  21.89325   16.259012  16.408974  16.443752  18.957195
 16.408978  11.064009  17.059744  16.408976  21.893248  17.059744
 17.059744  19.791931  22.329014  17.059744  22.86386   20.874168
 20.007349  21.492855  16.101131  19.679186  14.5468855 21.277168
 20.834415  17.1896    13.823581  24.378603  16.351017  18.778036
 15.895612  16.781525  17.059744  17.059744  19.652342  16.161585
 15.48088   19.757053  20.819248  20.640404  24.757658  24.757679
 24.757679  11.68746   17.507505  23.910757  23.910755  20.788342
 16.004734  21.436941  20.174412  21.230747  21.43694   22.99217
 20.844643  20.245317  25.511513  16.101133  16.496058  20.844645
 21.49303   15.604823  20.245314  20.844645  22.121838  16.101131
 12.542562  22.671642  22.121838  16.49606   15.478978  13.762284
 15.655699  16.100761  16.49606   16.49606   20.819252  20.788342
 24.802303  13.274008  22.109798  20.788338  14.579153  21.464815
 21.436937  12.99872   23.687006  13.933364  15.6363    20.819252
 15.425624  20.874168  16.028513  20.245317  16.028511  23.11207
 21.23075   20.788338  20.788338  20.874168  20.788338  20.47056
 21.464808  13.325788  20.624138  14.348914  20.17441   21.436947
 23.687006  20.019138  20.019135  21.436941  15.812385  21.436941
 20.624138  15.812388  25.423256  15.21938   15.812382  20.640406
 20.624142  23.910757  21.464815  16.028511  22.932133  12.417265
 15.8123865 16.004736  21.43694   21.23075   21.230747  20.788334
 16.028507  15.947024  15.217802  15.655706  21.23075   16.79019
 21.23075   16.790192  19.234884  15.81238   20.019135  20.019136
 20.019136  20.614504  15.99834   20.614504  20.614504  20.614504
 20.614502  20.614504  20.614504  20.614504  15.783173  19.997076
 23.073795  20.614504  20.614504  20.614504  20.614504  20.614502
 20.614506  20.614506  20.614502  20.614504  15.419704  20.614504
 20.614502  15.783174  20.614502  21.436941  20.341127  21.23075
 21.59762   16.442192  34.129322  34.129322  16.115498  21.59762
 21.230745  20.624125  20.624138  21.23075   20.624142  21.230747
 18.656801  20.614506  20.640404  21.23075   20.019136  21.23075
 21.230747  20.624138  21.23075   20.624136  21.23075   21.23075
 15.812384  20.624142  21.230747  20.624138  21.23075   21.230745
 21.23075   15.458799  15.662313  16.87642   20.614504  19.154459
 19.814404  21.23075   20.624138  14.996081  20.614504  20.624136
 15.607998  20.04984   21.23075   21.230747  15.996488  15.397487
 16.87642   21.23075   15.783172  20.624136  20.624138  11.71144
 20.614506  20.624132  15.812383  20.614506  20.614504  15.783172
 21.23075   21.23075   18.284315  16.876421  15.41971   15.397488
 24.05013   16.112648  16.112644  19.791155  20.81076   20.614504
 19.390202  16.11265   15.397488  16.273922  20.81076   20.236437
 20.043072  20.043074  20.043072  20.043074  20.043072  20.043072
 15.408032  20.043072  20.043072  20.614504  20.614504  20.614504
 16.11265   14.996557  16.112648  20.337904  16.112648  15.4197035
 15.4197035 20.614504  15.41971   20.614504  16.112648  20.84096
 20.031088  20.031092  20.043072  20.840963  16.273926  19.784264
 20.614504  20.614504  20.043072  20.236437  20.031092  20.031092
 20.236437  20.266836  20.043072  15.83901   23.342247  19.471006
 19.568121  20.236437  19.568121  20.266834 ]
2025-06-02 15:43:19,066 - DEBUG - Edge reconstruction errors: [  4.4897323   4.429468   43.244125  ...  12.344129   12.344112
 534.2446   ]
2025-06-02 15:43:19,068 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154319_update_23.json
2025-06-02 15:43:19,068 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:19,071 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154319_update_23.pth and as latest_checkpoint.pth
2025-06-02 15:43:19,071 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.0045
2025-06-02 15:43:19,071 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:43:19,071 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.4790, MLP Score: 0.0064
2025-06-02 15:43:19,071 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.6743, MLP Score: 0.0053
2025-06-02 15:43:19,071 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.3510, MLP Score: 0.0041
2025-06-02 15:43:19,071 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.4854, MLP Score: 0.0057
2025-06-02 15:43:19,071 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.3990, MLP Score: 0.0040
2025-06-02 15:43:19,071 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:19,071 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2440, MLP Score: 0.0000
2025-06-02 15:43:19,071 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9466, MLP Score: 0.0000
2025-06-02 15:43:19,071 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0448, MLP Score: 0.0000
2025-06-02 15:43:19,071 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7469, MLP Score: 0.0000
2025-06-02 15:43:19,071 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2446, MLP Score: 0.0000
2025-06-02 15:43:19,072 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-02 15:43:19,072 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:43:19,072 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:43:19,072 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:43:19,091 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:43:19,109 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:43:19,109 - INFO - Processing node updates/additions.
2025-06-02 15:43:19,113 - INFO - Processing edge updates/additions.
2025-06-02 15:43:19,122 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:19,123 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:19,123 - DEBUG - Updated graph - Nodes: 715, Edges: 1521
2025-06-02 15:43:19,123 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:19,124 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:19,131 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-02 15:43:19,132 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:19,132 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-02 15:43:19,133 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-02 15:43:19,134 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:19,137 - DEBUG - Initial edge attributes tensor shape: torch.Size([1521, 10])
2025-06-02 15:43:19,138 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:19,138 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1521, 10])
2025-06-02 15:43:19,138 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:19,138 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:19,139 - INFO - Updated main graph to 715 nodes and 1521 edges.
2025-06-02 15:43:19,139 - INFO - Performing online update...
2025-06-02 15:43:19,139 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:19,139 - DEBUG - Updated RunningStats: new_mean=0.9411957479889629, new_var=13200000000160.975, new_n=1350
2025-06-02 15:43:19,139 - DEBUG - Updated RunningStats: new_mean=0.9367650206579131, new_var=13500000000019.027, new_n=1380
2025-06-02 15:43:19,140 - DEBUG - Updated RunningStats: new_mean=42.42399321903783, new_var=4400000191002.168, new_n=450
2025-06-02 15:43:19,140 - DEBUG - Updated RunningStats: new_mean=42.54423701092599, new_var=4500000200612.566, new_n=460
2025-06-02 15:43:19,140 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:19,140 - DEBUG - Online update step: 1/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 2/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 3/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 4/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 5/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 6/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 7/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 8/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 9/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 10/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 11/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 12/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 13/25
2025-06-02 15:43:19,140 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,140 - DEBUG - Online update step: 14/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 15/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 16/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 17/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 18/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 19/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 20/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 21/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 22/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 23/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 24/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - DEBUG - Online update step: 25/25
2025-06-02 15:43:19,141 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,141 - WARNING - No successful steps during online update.
2025-06-02 15:43:19,141 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], current edge mean: [ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:43:19,142 - DEBUG - Node drift difference: 0.0255, Edge drift difference: 0.0016
2025-06-02 15:43:19,142 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], edge=[ 8.7780672e-09  4.6051611e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.2540097e-09  2.5080193e-09  1.2540097e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:43:19,143 - DEBUG - Updated reference std: node=[0.         0.         1.0007     1.0007     0.         0.
 0.         1.0007     1.0007     1.0007001  1.0007     1.0007
 1.017057   0.27730066 0.3667061  0.56330985 1.0007001  3.0911584
 2.9346402  1.4961902  0.3667061  0.         1.0007001  1.0007
 0.         0.         0.         0.         1.0007     1.0007    ], edge=[  1.0003289 472.54977     0.          0.          1.0003289   1.0003289
   1.0003289   1.0003289   1.0003289   1.0003289]
2025-06-02 15:43:19,143 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:19,143 - INFO - Running anomaly detection...
2025-06-02 15:43:19,143 - INFO - Starting anomaly detection.
2025-06-02 15:43:19,150 - DEBUG - Node reconstruction errors: [20.942463  12.266666  20.071724  33.347897  15.451422  16.984198
 18.484941  27.608759  27.60876   30.574972  27.608765  19.9717
 25.099556  11.741243  28.477571  28.253727  19.691723  28.253721
 28.440704  27.17371   23.12205   28.477575  19.35096   13.312272
 27.642141  31.297934  27.642143  16.404606  26.74512   27.642141
 15.461239  22.55426   15.10578   32.403957  31.344099  21.33485
 16.067991  27.173708  15.688906  13.448527  33.042603  27.400515
 27.173714  28.208706  31.23936   20.3994    31.766212  11.788049
 25.89512   31.961882  38.618774  30.046444  30.471373  23.138332
 21.116383  14.656658  22.45418   25.165083  25.613766  25.512875
 13.31364   21.064882  26.406897  12.08627   26.683018  21.116383
 22.039408  21.116385  26.406897  26.406895  18.741856  19.406618
 22.541784  17.763264  16.184849  19.58404   26.685984  18.829195
 16.229698  17.591278  29.394842  17.534735   8.061018  28.02815
 20.595392  12.751375  17.353424  16.166862  17.73169   16.480541
 24.927908  14.800481  15.008197  16.350895  20.91355   36.218925
 28.38574   15.062476  23.759808  21.368765  18.188107  28.385738
 28.856756  18.135931  10.97061   21.137053  20.555279  15.297362
 15.674729  25.767918  19.309448  27.728874  14.575379  15.474835
 17.987339  16.307945  17.793749  14.824816  17.094744  19.802649
 23.297232  12.946721  14.945607  11.739804  16.289856  19.80263
 12.844161  12.037558  16.223824  19.693169  25.709589  22.81056
 23.574467  15.229453  17.378633  21.166317  27.144611  24.484941
 12.085178  14.264831  19.90927   17.33779   22.624111  21.494219
 20.399658  18.286348  17.79375   24.33335   22.570751  16.67567
 29.443247  10.796708  17.372875  22.81056   15.575194  14.250202
 22.08777   15.86376   18.188103  30.449076  20.399654  11.3780575
 22.087772  25.709572  17.706478  15.248287  18.043013  16.169077
 10.934214  15.643388  17.461758  19.283697  24.73828   29.179941
 15.358907  13.105587  16.170158  16.12257   17.57116   17.571157
 20.357735  16.002508  21.522503  15.875593  13.95143   17.653217
 21.862663  17.340027  20.382256  21.269766  16.135563  15.884167
 23.175922  23.498121  12.08519   24.439636   7.9549356 21.400652
 15.226131  19.851948  20.735252  22.08777   14.995245  16.98918
 17.825216  15.008194  24.751884  16.867455  23.03484   16.912792
 17.13217   17.653217  26.668348  15.23759   15.68176   22.016277
 15.857105  17.793755  17.454298  23.498117  14.932233  21.862663
 23.84832   26.668348  22.087772  16.601004  14.2613    24.265036
 16.890923  13.145499  13.526884  15.723846  15.108551  17.79375
 17.793753  24.43964   15.53709   23.84832   22.08777   24.110624
 13.904223  15.371026  23.360159  16.675669  23.323536  15.529555
 16.5085    17.093395  23.360159  20.531816  24.73828   24.746016
 17.454298  15.411575  16.307943  18.060293  21.269766  21.606571
 20.729828  17.57116   15.632194  14.552482  26.0719    19.667576
 15.530955  20.21321   16.995024  15.211718  16.995024  15.788808
 15.87208   15.066491  15.8532    19.586584  17.419346  17.571161
 21.394386  18.278902  20.357737  15.019849  14.845387  22.031736
 15.808812  29.106878  15.889934  27.049011  14.446482  13.737764
 16.00251   11.1238    19.141144  25.236425  23.46536   23.323536
 10.885729  20.491764  15.182149  17.570976  24.43964   22.78042
 15.568055  22.792833  16.884953  16.884953  22.79283   22.792833
 22.792833  17.32827   22.124079  22.792833  22.79283   15.105875
 22.792833  20.552301  10.860991  16.245693  16.265041  14.40208
 25.761074  23.79758   16.567825  18.257318  17.226412  16.88495
 19.832407  15.457061  22.901684  17.328274  16.804472  16.804476
 17.603422  23.678183  22.792833  17.419342  22.792833  17.328272
 18.51179   23.850004  22.901684  22.90169   22.792833  23.261251
 22.901684  15.482314  15.491574  16.995028  16.88495   26.315153
 17.558044  16.452738  22.792833  15.876038  14.389039  16.111845
 22.571167  21.269766  20.935722  22.792833  23.613188  27.116114
 17.132172  20.40393   20.13098   15.29362   16.884941  19.291393
 22.366201  13.574918  17.095554  16.334175  15.1057005 15.365693
 15.10575   14.084422  16.36401   17.117798  23.022175  22.28841
 16.825298  22.792833  16.884953  10.84128   20.59018   15.354594
 10.841282  17.013897  21.544107  10.865699  17.711512  22.79283
 19.711645  15.930145  16.532309  15.821624  17.183603  17.183603
 17.183603  21.695133  22.069221  21.54602   19.905596  18.16356
 17.183603  22.069223  16.389357  16.532299  16.575228  19.19596
 16.53231   11.192486  17.183603  16.53231   22.069221  17.183601
 17.183603  20.029453  22.477926  17.183603  23.022099  21.107155
 19.108347  21.673367  16.244463  19.933405  13.731347  19.10831
 19.9056    17.346245  13.94433   24.571325  16.47585   19.031149
 15.883763  16.919697  17.183603  17.183603  19.905598  16.293926
 15.633552  19.95145   21.049738  20.85033   23.079191  19.95093
 19.950928  11.058902  17.282633  24.163107  24.163113  19.842985
 16.13383   21.634228  20.404505  21.426031  21.634228  18.430273
 19.933407  20.47593   23.161804  16.244465  16.621058  21.058292
 19.409813  15.76042   20.47593   21.058292  22.30354   16.244463
 12.32083   22.969706  22.30354   16.621058  15.621509  13.8249445
 15.214962  16.244076  15.888289  16.62106   21.049738  21.000675
 25.040997  13.381306  20.011333  21.000675  14.028118  21.655857
 21.634228  13.173377  23.90291   13.9783325 15.373789  21.049738
 15.563931  21.107155  15.810182  20.47593   16.170265  23.307854
 21.426031  21.000675  21.000675  21.107155  19.312658  20.652922
 21.655855  13.497163  20.851305  14.12032   20.404507  21.634228
 13.062107  20.252594  20.252592  21.634222  15.809652  21.634228
 20.851307  15.9623575 25.73482   15.004794  15.9623575 20.85033
 20.851307  24.163105  21.655859  16.170263  23.199673  12.548322
 15.9623575 16.13383   21.634222  21.426031  21.426033  21.000675
 16.170265  16.085224  15.36374   15.7938385 21.426031  16.932976
 21.426031  16.932976  19.450705  15.962359  20.252594  20.252592
 20.252594  20.837002  16.032293  20.837002  20.837002  20.837004
 20.837002  20.837002  20.837002  20.837002  15.932702  20.233582
 23.318064  20.837002  20.837006  20.837002  20.837006  20.837006
 20.837002  20.837004  20.837002  20.837006  15.574578  20.837006
 20.837002  15.932702  20.837002  21.634228  20.491875  21.426031
 21.784737  15.47244   34.397472  34.397472  16.248972  21.784737
 21.426031  20.851305  20.851307  21.426031  20.851307  21.426031
 18.909235  20.837002  20.85033   21.426033  20.252592  21.426031
 21.426031  20.851307  21.426031  20.851307  21.426027  21.426027
 15.96236   20.851307  21.426033  20.851307  21.426031  21.426031
 21.426031  15.601829  15.810182  15.810184  20.837002  19.384418
 19.960358  21.426031  20.851307  15.164084  20.837004  20.851305
 15.75607   20.2937    21.426031  21.426031  16.136086  15.55456
 17.01434   21.426031  15.932703  20.851307  20.851301  11.855444
 20.837006  20.851307  15.9623575 20.837002  20.837004  15.9327
 21.426031  21.426031  18.549366  17.01434   15.409354  15.554561
 24.323742  16.27859   16.278591  19.953426  21.03438   20.837002
 19.642393  15.533876  15.554562  16.43671   21.03438   20.483883
 20.28983   20.28983   20.289833  20.289833  20.28983   15.241973
 15.747764  20.28983   20.289833  20.837006  20.837004  20.837006
 16.278593  15.164974  16.278593  20.534796  16.278593  15.574576
 15.574579  20.837006  15.574576  20.837006  16.278591  21.063948
 20.269033  20.269033  20.289833  21.063948  16.436712  20.020369
 20.837002  20.837002  20.289833  20.483883  20.269037  20.269035
 20.483883  20.516335  15.241974  15.861739  19.954597  19.692514
 19.820013  20.483887  19.820013  20.516335  19.964138  19.964136
 15.531423  19.77526   15.874465  20.483887  20.483887  20.483887
 19.9359    20.483883  20.483887  19.964136  20.483887  20.483883
 20.48388  ]
2025-06-02 15:43:19,151 - DEBUG - Edge reconstruction errors: [  4.5095773   4.443139   43.243073  ...  12.343078   12.343061
 534.2436   ]
2025-06-02 15:43:19,153 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154319_update_24.json
2025-06-02 15:43:19,153 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:19,156 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154319_update_24.pth and as latest_checkpoint.pth
2025-06-02 15:43:19,157 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.0045
2025-06-02 15:43:19,157 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:43:19,157 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.3479, MLP Score: 0.0063
2025-06-02 15:43:19,157 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.5750, MLP Score: 0.0052
2025-06-02 15:43:19,157 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.2979, MLP Score: 0.0040
2025-06-02 15:43:19,157 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.4040, MLP Score: 0.0056
2025-06-02 15:43:19,157 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.3441, MLP Score: 0.0039
2025-06-02 15:43:19,157 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:19,157 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2430, MLP Score: 0.0000
2025-06-02 15:43:19,157 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9481, MLP Score: 0.0000
2025-06-02 15:43:19,157 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0468, MLP Score: 0.0000
2025-06-02 15:43:19,157 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7458, MLP Score: 0.0000
2025-06-02 15:43:19,157 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2436, MLP Score: 0.0000
2025-06-02 15:43:19,157 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-02 15:43:19,157 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:43:19,157 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:43:19,157 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:43:19,179 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:43:19,196 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:43:19,196 - INFO - Processing node updates/additions.
2025-06-02 15:43:19,200 - INFO - Processing edge updates/additions.
2025-06-02 15:43:19,208 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:19,209 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:19,210 - DEBUG - Updated graph - Nodes: 723, Edges: 1547
2025-06-02 15:43:19,210 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:19,210 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:19,217 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-02 15:43:19,218 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:19,218 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-02 15:43:19,219 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-02 15:43:19,220 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:19,223 - DEBUG - Initial edge attributes tensor shape: torch.Size([1547, 10])
2025-06-02 15:43:19,224 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:19,226 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1547, 10])
2025-06-02 15:43:19,226 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:19,226 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:19,226 - INFO - Updated main graph to 723 nodes and 1547 edges.
2025-06-02 15:43:19,226 - INFO - Performing online update...
2025-06-02 15:43:19,227 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:19,227 - DEBUG - Updated RunningStats: new_mean=0.9414760517616573, new_var=13800000000160.807, new_n=1410
2025-06-02 15:43:19,227 - DEBUG - Updated RunningStats: new_mean=0.9372416511682102, new_var=14100000000019.094, new_n=1440
2025-06-02 15:43:19,227 - DEBUG - Updated RunningStats: new_mean=42.61773635225704, new_var=4600000190546.081, new_n=470
2025-06-02 15:43:19,227 - DEBUG - Updated RunningStats: new_mean=42.72083880305888, new_var=4700000197267.158, new_n=480
2025-06-02 15:43:19,227 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:19,227 - DEBUG - Online update step: 1/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 2/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 3/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 4/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 5/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 6/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 7/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 8/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 9/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 10/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 11/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 12/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 13/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 14/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 15/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 16/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 17/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 18/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 19/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,228 - DEBUG - Online update step: 20/25
2025-06-02 15:43:19,228 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - DEBUG - Online update step: 21/25
2025-06-02 15:43:19,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - DEBUG - Online update step: 22/25
2025-06-02 15:43:19,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - DEBUG - Online update step: 23/25
2025-06-02 15:43:19,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - DEBUG - Online update step: 24/25
2025-06-02 15:43:19,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - DEBUG - Online update step: 25/25
2025-06-02 15:43:19,229 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,229 - WARNING - No successful steps during online update.
2025-06-02 15:43:19,229 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], current edge mean: [-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:43:19,229 - DEBUG - Node drift difference: 0.0184, Edge drift difference: 0.0011
2025-06-02 15:43:19,230 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], edge=[-8.6305372e-09  4.5998706e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4658677e-09 -2.4658677e-09 -1.5411673e-09
 -4.3152686e-09  2.4658677e-09]
2025-06-02 15:43:19,230 - DEBUG - Updated reference std: node=[0.         0.         1.0006922  1.0006922  0.         0.
 0.         1.0006924  1.0006922  1.0006924  1.0006922  1.0006922
 1.0100604  0.27579054 0.37301496 0.5619617  1.0006924  3.101849
 2.9398093  1.5029361  0.37301496 0.         1.0006922  1.0006924
 0.         0.         0.         0.         1.0006922  1.0006924 ], edge=[  1.0003234 468.66428     0.          0.          1.0003234   1.0003233
   1.0003234   1.0003234   1.0003234   1.0003234]
2025-06-02 15:43:19,230 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:19,230 - INFO - Running anomaly detection...
2025-06-02 15:43:19,231 - INFO - Starting anomaly detection.
2025-06-02 15:43:19,236 - DEBUG - Node reconstruction errors: [20.980213  12.093685  20.204649  33.328564  15.486485  17.011932
 18.601301  27.583735  27.58373   30.55315   27.583733  19.98287
 25.282084  11.772103  28.466703  28.223122  19.733753  28.223118
 28.454556  27.162767  23.16915   28.466703  18.9993    13.347373
 27.646635  31.29002   27.646633  16.44274   26.73632   27.646635
 15.549024  22.645203  15.144703  32.404022  31.335331  21.413109
 16.091084  27.162767  15.741257  13.477649  33.05752   27.405313
 27.162767  28.293161  31.2389    20.47401   31.842455  11.821298
 25.898691  32.08582   38.79718   30.055172  30.478945  23.23916
 21.173096  14.7051    21.80559   25.184834  25.665476  25.56863
 13.344967  21.148167  26.425127  11.535872  26.702806  21.1731
 22.097878  21.173096  26.425127  26.425127  18.826765  19.430897
 22.6115    17.799341  16.224636  19.603954  26.787535  18.868988
 16.272821  17.62926   29.440163  17.56918    8.1006365 28.116241
 20.68159   12.796342  17.404482  16.209843  17.772795  16.525412
 24.977024  14.854257  15.074617  16.3964    20.987604  36.340286
 28.446833  15.109146  23.820477  21.440958  18.223186  28.446836
 28.938847  18.179037  11.023757  21.215555  20.644457  10.63913
 15.7294655 24.706648  18.515087  27.796919  14.627307  15.523666
 18.028633  16.359348  17.835754  14.885668  17.141636  19.886116
 23.366282  13.020959  15.009473  11.793489  16.342064  19.88607
 12.897054  12.086667  16.268524  19.778475  25.789309  22.88326
 23.623837  15.287862  17.42381   21.24058   27.239841  24.53297
 12.134477  14.3259115 20.004126  17.385662  22.702517  21.578459
 20.485693  18.331163  17.835754  24.386383  22.644466  16.723606
 29.496931  10.843717  17.408123  22.88326   15.619036  14.297292
 22.167107  15.910518  18.223188  30.511919  20.485693  11.428265
 22.167105  25.789309  17.747799  15.313625  18.07623   16.218811
 10.980554  15.688293  17.50073   19.37093   24.788774  29.326574
 15.401394  13.135483  16.216293  16.173067  17.615051  17.615055
 20.443546  16.050266  21.591434  15.928742  14.012522  15.7015505
 21.942387  17.384195  20.463118  21.355852  16.182034  15.93297
 23.28339   23.56358   12.13448   24.533148   7.9896626 21.488943
 15.28821   19.936558  20.815918  22.167105  15.051714  17.03414
 17.870924  15.074612  24.830017  16.930021  23.105608  16.94839
 17.179464  17.697615  26.740232  15.275824  15.741566  22.098925
 15.906725  17.835752  17.498724  23.56358   14.983472  21.942385
 23.909037  26.740229  22.167107  16.649822  14.327443  24.315847
 16.936169  13.220309  13.6035    15.772762  15.159395  17.835754
 17.835754  24.533148  15.589548  23.909037  22.167107  24.215887
 13.953564  15.419313  23.426916  16.723612  23.390871  15.589506
 16.553837  17.148378  23.426916  20.610466  24.788774  24.796413
 17.498726  15.454306  16.359352  18.109533  21.355852  21.684061
 20.820597  17.615055  15.684373  14.605036  26.137384  19.753412
 15.584804  20.290918  17.039845  15.316272  17.039843  15.8352995
 15.939642  15.131121  15.90097   19.218378  17.457634  17.615053
 21.472515  18.328997  20.44355   15.070543  14.88375   22.099209
 15.869625  29.179419  15.935422  27.12015   14.501351  13.796833
 16.050266  11.179976  19.23031   25.3337    23.541662  23.390873
 10.942247  20.58214   15.2320385 17.614868  24.533155  18.722254
 15.6256695 22.862394  16.926764  16.926771  22.862398  22.862398
 22.862398  17.36614   22.199245  22.862398  22.862398  15.159374
 22.862398  20.640585  10.626737  16.288044  16.319136  14.469691
 25.842506  23.900232  16.61341   18.344719  17.274279  16.92677
 19.913815  15.519535  22.97224   17.366138  16.842106  16.842108
 17.651602  23.782331  22.862398  17.457632  22.862398  17.366142
 18.608767  23.910492  22.972239  22.972246  22.862398  23.321115
 22.972246  15.234694  15.544947  17.039848  16.92677   26.395252
 17.597292  16.501291  22.862398  15.923047  14.443524  16.15888
 22.639034  21.355848  21.023836  22.862398  23.674479  27.23595
 17.179462  20.493002  20.219078  15.347347  16.92676   18.551697
 22.442427  13.620365  17.145374  16.386288  15.1592045 15.420984
 15.159253  14.149307  16.413305  15.650812  23.090708  22.364275
 15.045195  22.862398  16.926767  10.893779  20.67529   15.408924
 10.893781  17.061905  21.61443   10.922082  17.755098  22.862398
 19.766294  15.982447  16.580797  15.880499  17.2321    17.232098
 17.2321    21.805391  22.14102   21.654453  19.999449  18.216467
 17.2321    22.141024  16.434565  16.58079   16.63363   19.288538
 16.5808    11.2436    17.232103  16.5808    22.141022  17.2321
 17.232103  20.12039   22.546717  17.2321    23.09087   21.19727
 19.200628  21.753761  16.303537  20.027687  13.795545  19.20058
 19.99945   17.414488  13.995847  24.649464  16.533932  19.12876
 15.944279  16.975267  17.2321    17.2321    19.99945   16.355364
 15.704836  20.034533  21.138948  20.933521  23.199045  20.0471
 20.0471    11.10816   17.350704  24.256428  24.256428  19.937567
 16.191044  21.713297  20.48991   21.503275  21.7133    18.529268
 20.027687  20.562687  23.26944   16.303535  16.671705  21.140978
 19.511168  15.830451  20.56269   21.140972  22.377497  16.30354
 12.393719  23.0788    22.377497  16.671707  15.681859  13.883362
 15.269664  16.303164  15.948979  16.671705  21.138948  21.08189
 25.134726  13.433567  20.106817  21.081888  14.096129  21.731932
 21.713297  13.239678  23.982565  14.037978  15.429151  21.138947
 15.622936  21.19727   15.869887  20.562687  16.229012  23.414856
 21.503275  21.081888  21.081888  21.197271  19.410666  20.731833
 21.731932  13.567614  20.938324  14.171692  20.489912  21.7133
 13.140429  20.341576  20.341578  21.713295  15.869504  21.713297
 20.938324  16.014517  25.855806  15.053738  16.014517  20.933521
 20.938324  24.25643   21.731936  16.22901   23.300047  12.601207
 16.01452   16.191044  21.7133    21.503275  21.503275  21.08189
 16.22901   16.140932  15.419155  15.849572  21.503275  16.986578
 21.503275  16.98658   19.05048   16.014517  20.341576  20.341578
 20.341576  20.920689  16.08749   20.920689  20.920689  20.920689
 20.920689  20.920689  20.920687  20.920689  15.982591  20.320196
 23.410534  20.92069   20.920689  20.92069   20.920689  20.920689
 20.92069   20.920689  20.920689  20.920687  15.627031  20.92069
 20.920689  15.982591  20.920687  21.7133    20.553596  21.503275
 21.85321   15.536789  34.494553  34.494553  16.309391  21.85321
 21.503275  20.93833   20.938322  21.503275  20.93832   21.503275
 19.00596   20.920687  20.933521  21.503275  20.341572  21.503275
 21.503275  20.93832   21.503275  20.938324  21.503275  21.503275
 16.014517  20.938322  21.503275  20.938322  21.503275  21.503275
 21.503275  15.657167  15.869887  15.869888  20.920687  19.472664
 20.02246   21.503275  20.938322  15.227435  20.920689  20.938322
 15.828778  20.38346   21.503275  21.503275  15.386904  15.621885
 17.076138  21.503275  15.982591  20.938324  20.938324  11.908075
 20.920689  20.938324  16.014517  20.920689  20.920687  15.982594
 21.503275  21.503275  18.659105  17.076138  15.468729  15.621885
 24.42641   16.333447  16.333447  20.017122  21.12027   20.920687
 19.738575  15.596181  15.621885  15.402673  21.120272  20.578505
 20.381994  20.38199   20.381996  20.381992  20.381994  15.292005
 15.803558  20.381994  20.381994  20.92069   20.920689  20.920689
 16.333447  15.233029  16.333448  20.609825  16.33345   15.627029
 15.627032  20.920687  15.627028  20.920689  16.333454  21.149122
 20.356312  20.356312  20.38199   21.149122  14.857192  20.109169
 20.92069   20.920689  20.381994  20.57851   20.356312  20.356304
 20.578512  20.612806  15.291999  15.909966  20.051004  13.333679
 15.531323  20.578503  19.912256  20.612806  20.056335  20.056337
 15.575451  19.865856  15.932448  20.57851   20.57851   20.57851
 20.031963  20.57851   20.57851   20.056335  20.57851   20.578505
 20.57851   15.728136  20.09173   14.854924  14.854925  15.728141
 19.3447    20.056335  15.728139 ]
2025-06-02 15:43:19,237 - DEBUG - Edge reconstruction errors: [  4.488077    4.4252505  43.243496  ...  12.3435     12.343481
 534.2442   ]
2025-06-02 15:43:19,238 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154319_update_25.json
2025-06-02 15:43:19,238 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:19,241 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154319_update_25.pth and as latest_checkpoint.pth
2025-06-02 15:43:19,241 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.0046
2025-06-02 15:43:19,241 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:43:19,241 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.3286, MLP Score: 0.0063
2025-06-02 15:43:19,241 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.5532, MLP Score: 0.0052
2025-06-02 15:43:19,241 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.2900, MLP Score: 0.0040
2025-06-02 15:43:19,241 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.4040, MLP Score: 0.0056
2025-06-02 15:43:19,242 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.3353, MLP Score: 0.0039
2025-06-02 15:43:19,242 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:43:19,242 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2434, MLP Score: 0.0000
2025-06-02 15:43:19,242 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9484, MLP Score: 0.0000
2025-06-02 15:43:19,242 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0472, MLP Score: 0.0000
2025-06-02 15:43:19,242 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7462, MLP Score: 0.0000
2025-06-02 15:43:19,242 - WARNING -   Source: 192.168.27.12, Target: 224.0.0.251, Recon Error: 534.2442, MLP Score: 0.0000
2025-06-02 15:43:19,242 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-02 15:43:19,242 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:43:19,242 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:43:19,242 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:43:19,261 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:43:19,281 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:43:19,281 - INFO - Processing node updates/additions.
2025-06-02 15:43:19,287 - INFO - Processing edge updates/additions.
2025-06-02 15:43:19,298 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:19,300 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:19,301 - DEBUG - Updated graph - Nodes: 730, Edges: 1559
2025-06-02 15:43:19,301 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:19,302 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:19,312 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-02 15:43:19,314 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:19,315 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-02 15:43:19,317 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-02 15:43:19,319 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:19,324 - DEBUG - Initial edge attributes tensor shape: torch.Size([1559, 10])
2025-06-02 15:43:19,326 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:19,326 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1559, 10])
2025-06-02 15:43:19,326 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:19,327 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:19,328 - INFO - Updated main graph to 730 nodes and 1559 edges.
2025-06-02 15:43:19,328 - INFO - Performing online update...
2025-06-02 15:43:19,328 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:19,329 - DEBUG - Updated RunningStats: new_mean=0.9417411459336562, new_var=14400000000160.809, new_n=1470
2025-06-02 15:43:19,329 - DEBUG - Updated RunningStats: new_mean=0.9376691856178527, new_var=14700000000019.037, new_n=1500
2025-06-02 15:43:19,329 - DEBUG - Updated RunningStats: new_mean=42.79806008047822, new_var=4800000194781.938, new_n=490
2025-06-02 15:43:19,329 - DEBUG - Updated RunningStats: new_mean=42.98318271685465, new_var=4900000237473.236, new_n=500
2025-06-02 15:43:19,329 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:19,329 - DEBUG - Online update step: 1/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 2/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 3/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 4/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 5/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 6/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 7/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 8/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 9/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 10/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 11/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 12/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 13/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 14/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 15/25
2025-06-02 15:43:19,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,330 - DEBUG - Online update step: 16/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 17/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 18/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 19/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 20/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 21/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 22/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 23/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 24/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - DEBUG - Online update step: 25/25
2025-06-02 15:43:19,331 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:19,331 - WARNING - No successful steps during online update.
2025-06-02 15:43:19,332 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], current edge mean: [ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:43:19,332 - DEBUG - Node drift difference: 0.0086, Edge drift difference: 0.0108
2025-06-02 15:43:19,333 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], edge=[ 1.2234437e-09  4.6504681e+02  0.0000000e+00  0.0000000e+00
  3.6703309e-09 -4.8937747e-09  1.2234437e-09 -4.8937747e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:43:19,334 - DEBUG - Updated reference std: node=[0.         0.         1.0006856  1.0006857  0.         0.
 0.         1.0006856  1.0006857  1.0006857  1.0006856  1.0006856
 1.0018492  0.28392488 0.37280026 0.56569636 1.0006857  3.0937886
 2.9347494  1.5104574  0.37280026 0.         1.0006857  1.0006857
 0.         0.         0.         0.         1.0006856  1.0006856 ], edge=[  1.0003209 513.5397      0.          0.          1.0003209   1.0003209
   1.0003208   1.0003208   1.0003209   1.0003209]
2025-06-02 15:43:19,334 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:19,334 - INFO - Running anomaly detection...
2025-06-02 15:43:19,334 - INFO - Starting anomaly detection.
2025-06-02 15:43:19,384 - DEBUG - Node reconstruction errors: [20.712294  11.956531  20.016136  33.187668  15.471088  16.998615
 18.398762  27.45233   27.45233   30.433346  27.452335  19.898123
 25.023338  11.571376  28.327736  28.050434  19.7009    28.050432
 28.120062  27.027874  23.150343  28.327736  19.038116  13.352963
 27.534794  31.200035  27.534792  16.441736  26.636082  27.534794
 15.3117285 18.21708   15.165377  32.28939   31.245611  21.466948
 16.084127  27.027876  15.635599  13.474784  32.970284  27.299213
 27.027876  28.319206  31.125086  20.52606   31.839397  11.830417
 25.798239  32.244064  38.99067   29.99241   30.426401  23.055962
 21.177586  14.711532  21.859571  25.109829  25.448103  19.971525
 13.325897  21.208809  26.348053  11.567765  26.631123  21.177584
 22.103329  21.177591  26.348051  26.34805   18.88947   19.36745
 22.640978  17.763842  16.244722  19.54793   26.846039  18.841475
 16.274672  17.596647  29.374388  17.540962   8.029123  28.139223
 20.729897  11.116357  17.424654  16.206148  17.739643  16.52651
 24.941456  14.848916  15.095907  16.388891  21.01477   36.39689
 28.408577  15.116684  23.808111  21.469114  18.205967  28.40858
 28.944536  18.179287  11.061835  21.249569  20.292852  10.675108
 15.735139  24.845116  18.579472  27.777355  14.629037  15.511629
 18.012354  16.380829  17.82433   14.898069  17.130806  19.945715
 23.375221  13.076947  15.037985  11.819331  16.353456  19.945692
 12.914968  12.111243  16.271708  19.832521  25.801615  22.90247
 23.599403  15.316881  17.420496  21.272596  27.280539  24.505503
 12.158232  14.197659  20.087206  17.396837  22.728167  21.631268
 20.560766  18.294538  17.82433   24.363148  22.65301   16.72407
 29.459291  10.872903  17.393332  22.902468  13.898779  14.294119
 22.206907  15.915195  18.205967  30.472267  20.560766  11.466348
 22.206907  25.80161   17.73989   15.317965  18.066536  16.223932
 11.014724  15.705534  17.469234  19.441475  24.756878  29.450329
 15.407917  13.088726  16.231234  16.200459  17.609438  17.609436
 20.487558  16.04646   21.59385   15.935162  14.038879  15.718824
 21.986717  17.358908  20.512188  21.415314  16.1659    15.934505
 23.365732  23.561829  12.158238  24.589575   7.9436812 21.548273
 15.292163  19.995552  20.85248   22.206907  15.036604  17.01726
 17.84971   10.892074  24.83241   16.10262   23.114677  16.950418
 17.183563  17.68645   26.738506  15.279895  15.174885  22.14522
 15.924255  17.82433   17.485487  23.561829  14.963012  21.98672
 23.902327  26.738512  22.20691   16.645725  14.351802  24.294529
 16.918344  13.279777  13.659382  15.784506  15.172837  17.824333
 17.82433   24.589575  15.598263  23.90233   22.206903  24.299232
 13.964152  15.430173  23.428415  16.724073  23.390764  15.620837
 16.54629   17.16343   23.428415  20.64983   24.756878  24.76707
 17.48549   15.468238  16.380825  18.088856  21.415314  21.726435
 20.896091  17.609434  15.71393   14.613464  26.127068  19.81416
 15.593406  20.33393   17.039398  15.147744  17.0394    15.844709
 15.963213  15.1516485 15.9069395 19.289213  17.46195   17.609438
 21.494764  18.312634  20.487556  15.088665  14.884678  22.099928
 15.893645  29.168997  15.9607725 27.108187  14.37561   13.837828
 16.04646   11.070314  19.30289   25.38383   23.560709  23.390764
 10.983023  20.65409   15.24345   17.609257  24.589575  18.804863
 15.644345  22.874804  16.94099   16.940987  22.874804  22.8748
 22.874805  17.373056  22.231445  22.874805  22.874804  15.173061
 22.8748    20.707712  10.670467  16.28655   16.345844  14.495625
 25.862509  23.969488  16.63159   18.40734   17.26828   16.94098
 19.973701  15.530625  22.984385  17.373058  16.850447  16.850447
 17.650585  23.852892  22.874805  17.461943  22.8748    17.373058
 18.691061  23.907898  22.984385  22.984383  22.874804  23.31616
 22.984385  15.279189  15.562766  17.039396  16.940989  26.404694
 17.58657   16.498377  22.874804  15.929654  14.443677  16.175009
 22.653164  21.415316  21.086063  22.874804  23.666594  27.315561
 17.183565  20.55288   20.27539   15.371143  16.940977  18.700237
 22.473454  13.642758  17.151522  16.403511  15.172889  15.445416
 15.172938  14.177817  16.429636  15.675419  23.10635   22.374182
 15.07904   22.8748    16.940989  10.935435  20.742643  15.439709
 10.935437  15.867039  21.630396  10.962511  17.752516  22.874804
 19.771053  16.008009  16.59231   15.908465  17.24939   17.24939
 17.24939   21.641167  22.170881  21.506174  20.079828  18.22763
 17.24939   22.170881  16.443216  16.592302  16.650957  19.360334
 16.59231   11.273648  17.24939   16.592308  22.170881  17.24939
 17.24939   20.196342  22.564138  17.24939   23.106333  21.260284
 19.273129  21.790224  16.325659  20.107813  13.60151   19.273096
 20.079828  17.440386  14.019515  24.682539  16.551298  19.20334
 15.992207  16.99249   17.24939   17.24939   20.079826  16.377039
 13.601519  20.078278  21.202026  20.98357   23.300293  20.133747
 20.133747  11.147108  17.381287  24.311646  22.485601  20.017927
 16.211447  21.759188  20.556667  21.54907   21.759188  18.61648
 20.107811  20.629734  23.363472  16.32566   16.688032  21.193125
 19.600485  15.854703  19.600487  21.193125  22.412748  16.325659
 12.457263  23.16154   22.41275   16.688032  15.7059965 13.535649
 15.301715  16.325275  15.980665  16.688032  21.202026  21.134348
 25.181232  13.465179  20.191034  21.13435   14.136313  21.77886
 21.759186  13.287752  24.02412   13.925938  15.450826  21.202028
 15.648913  21.260284  15.900192  20.629732  16.253187  23.3104
 21.54907   21.134348  17.91082   21.260283  19.500734  20.77118
 21.77886   13.610303  21.004742  14.055302  20.556667  21.759188
 13.1918955 20.404348  20.404352  21.759188  15.916336  21.759188
 21.004742  16.04941   25.936466  15.067946  16.049408  20.98357
 21.00474   24.311646  21.77886   16.25319   23.370373  12.6233015
 16.049412  16.211447  21.759188  21.54907   21.54907   21.134348
 16.253185  16.160517  15.45546   15.867319  21.54907   17.010063
 21.54907   17.010063  18.679111  16.049414  20.404352  20.40435
 20.40435   20.981432  15.975525  20.981432  20.981432  20.981432
 20.981432  20.981432  20.981432  20.981432  16.018068  20.38393
 23.466448  20.981432  20.981432  20.981432  20.981432  20.981432
 20.981432  20.981432  20.981432  20.981432  15.664573  20.981432
 20.981432  16.01807   20.981432  21.759188  20.629679  21.54907
 21.929466  15.572618  34.54185   34.54185   16.3242    21.929466
 21.54907   21.004742  21.004742  21.54907   21.004742  21.54907
 18.0944    20.981432  20.983568  21.54907   20.40435   21.54907
 21.54907   21.004742  21.54907   21.00474   21.54907   21.54907
 16.049412  21.004742  21.54907   21.00474   21.54907   21.54907
 21.549072  15.695343  15.900191  15.900199  20.981432  19.528055
 20.097046  21.54907   21.00474   15.273784  20.981432  21.004742
 15.860424  20.460804  21.549072  21.54907   15.411429  15.660395
 17.098267  21.54907   16.018068  21.004742  21.00474   11.943076
 20.981432  21.004742  16.04941   20.981432  20.981432  16.018068
 21.54907   21.54907   18.722284  17.098265  15.5177    15.660395
 24.492876  16.372795  16.372793  20.099827  21.18223   20.981432
 19.812954  15.649856  15.660395  15.43361   21.182232  20.645597
 20.454828  20.45483   20.454826  20.45483   20.45483   15.331565
 15.843265  20.45483   20.45483   20.981432  20.981432  20.981432
 16.372793  15.279304  16.372791  20.66483   16.372793  15.020894
 15.664572  20.981432  15.664576  20.981432  16.372795  21.211613
 20.432589  20.432592  20.45483   21.211613  14.903865  20.178844
 20.981432  20.981432  20.45483   20.645597  20.432589  20.432589
 20.645597  20.685793  15.331564  15.7955265 20.13624   13.384762
 15.568373  20.645597  19.980446  20.68579   20.134008  20.134008
 15.633852  19.945807  15.984847  20.645597  20.645597  20.645597
 20.114607  20.645597  20.645596  20.134005  20.645597  20.645596
 20.645597  15.773792  20.172216  14.901002  14.562923  15.773793
 19.429945  20.134005  14.562924  19.595358  19.687561  19.723513
 19.687538  17.95169   17.95169   20.134007 ]
2025-06-02 15:43:19,384 - DEBUG - Edge reconstruction errors: [  4.511196   4.444804  43.2447   ...  12.344709  12.344691 534.24536 ]
2025-06-02 15:43:19,386 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154319_update_26.json
2025-06-02 15:43:19,386 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:19,390 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154319_update_26.pth and as latest_checkpoint.pth
2025-06-02 15:43:19,390 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.0046
2025-06-02 15:43:19,390 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:43:19,390 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.1877, MLP Score: 0.0062
2025-06-02 15:43:19,390 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.4333, MLP Score: 0.0052
2025-06-02 15:43:19,390 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.2000, MLP Score: 0.0040
2025-06-02 15:43:19,391 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.2894, MLP Score: 0.0055
2025-06-02 15:43:19,391 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.2456, MLP Score: 0.0039
2025-06-02 15:43:19,391 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:19,391 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2447, MLP Score: 0.0000
2025-06-02 15:43:19,391 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9493, MLP Score: 0.0000
2025-06-02 15:43:19,391 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0482, MLP Score: 0.0000
2025-06-02 15:43:19,391 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7473, MLP Score: 0.0000
2025-06-02 15:43:19,391 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7456, MLP Score: 0.0000
2025-06-02 15:43:19,396 - DEBUG - Embedding standard deviations before t-SNE: [1.4000084e+00 2.5639934e-02 8.7419075e-01 1.5598103e+00 3.8598418e-02
 6.6023767e-01 9.5344317e-01 5.0274682e-01 7.1409374e-01 2.6346123e+00
 1.9947385e+00 1.9774758e+00 1.2428086e+00 7.0981151e-01 1.2293448e+00
 1.1755431e+00 1.2840249e-01 7.8006256e-01 0.0000000e+00 1.3049649e+00
 2.6723993e-01 1.6768742e+00 0.0000000e+00 2.4167663e-01 5.4201925e-01
 8.6202824e-01 1.8359881e-03 1.4644622e+00 2.0862803e+00 0.0000000e+00
 1.2858816e+00 1.2153982e+00]
2025-06-02 15:43:20,067 - INFO - Embeddings visualization saved to vis/embeddings_26_updates_20250602_154319.png
2025-06-02 15:43:20,067 - INFO - Performing visualization of node and edge features.
2025-06-02 15:43:20,068 - INFO - Starting visualization of node features.
2025-06-02 15:43:20,069 - INFO - Graph has 730 nodes and 30 features.
2025-06-02 15:43:20,069 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:43:20,069 - INFO - Calculating feature statistics:
2025-06-02 15:43:20,069 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,069 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,069 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5024931), 'max': np.float32(2.2060432)}
2025-06-02 15:43:20,069 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(-4.1804903e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.137797), 'max': np.float32(2.5623133)}
2025-06-02 15:43:20,069 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,069 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,069 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,069 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-5.225613e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.43019173), 'max': np.float32(2.3245447)}
2025-06-02 15:43:20,070 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.7030515e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1705256), 'max': np.float32(0.8543171)}
2025-06-02 15:43:20,070 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-9.39341), 'max': np.float32(0.10967602)}
2025-06-02 15:43:20,070 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(2.0902451e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.5601614), 'max': np.float32(1.563953)}
2025-06-02 15:43:20,070 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5274093), 'max': np.float32(3.6428556)}
2025-06-02 15:43:20,070 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.30137), 'std': np.float32(1.0011629), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:43:20,070 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.958904), 'std': np.float32(0.28373036), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:43:20,070 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:20,070 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3876715), 'std': np.float32(0.56530875), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:43:20,070 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10967602), 'max': np.float32(9.39341)}
2025-06-02 15:43:20,070 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.5342467), 'std': np.float32(3.091669), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:43:20,070 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.656164), 'std': np.float32(2.9327388), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:20,070 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6), 'std': np.float32(1.5094225), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:20,071 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:20,071 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:43:20,071 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.838419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13171281), 'max': np.float32(15.049921)}
2025-06-02 15:43:20,071 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.874087e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14484136), 'max': np.float32(6.904105)}
2025-06-02 15:43:20,071 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,071 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,071 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,071 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:20,071 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(3.6579287e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.0050753), 'max': np.float32(8.777658)}
2025-06-02 15:43:20,071 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(5.225613e-09), 'std': np.float32(1.0), 'min': np.float32(-1.108116), 'max': np.float32(4.419843)}
2025-06-02 15:43:20,083 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09c02a50>
2025-06-02 15:43:20,218 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:43:20,270 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:43:20,301 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:21,655 - INFO - Node feature visualization saved to vis/node_features_20250602_154320.png
2025-06-02 15:43:21,655 - INFO - Finished visualization of node features.
2025-06-02 15:43:21,655 - INFO - Performing additional feature analysis:
2025-06-02 15:43:21,655 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:21,656 - INFO - Starting visualization of edge features.
2025-06-02 15:43:21,657 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:43:21,657 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:21,657 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:21,657 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:21,657 - INFO - - count: {'name': 'count', 'unique': 25, 'mean': np.float32(2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.045147676), 'max': np.float32(30.35215)}
2025-06-02 15:43:21,657 - INFO - - dst_port: {'name': 'dst_port', 'unique': 16, 'mean': np.float32(465.0468), 'std': np.float32(513.37494), 'min': np.float32(3.0), 'max': np.float32(8898.0)}
2025-06-02 15:43:21,657 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:21,657 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:21,657 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1049, 'mean': np.float32(2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0737332), 'max': np.float32(29.76732)}
2025-06-02 15:43:21,657 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1107, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06559564), 'max': np.float32(30.237577)}
2025-06-02 15:43:21,657 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 347, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.053769764), 'max': np.float32(30.348267)}
2025-06-02 15:43:21,657 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1081, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.12731944), 'max': np.float32(19.250559)}
2025-06-02 15:43:21,657 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1095, 'mean': np.float32(1.2234437e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.124131665), 'max': np.float32(20.257381)}
2025-06-02 15:43:21,657 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 404, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.06376676), 'max': np.float32(29.849796)}
2025-06-02 15:43:21,668 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18909f40>
2025-06-02 15:43:21,748 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:21,758 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08cf0d10>
2025-06-02 15:43:21,837 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:21,982 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:22,117 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:22,135 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:22,141 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:23,389 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154322.png
2025-06-02 15:43:23,389 - INFO - Finished visualization of edge features.
2025-06-02 15:43:23,389 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:23,389 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:23,389 - INFO - - Highest correlation (1.00) between features: 'count' and 'total_orig_pkts'.
2025-06-02 15:43:23,391 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:23,391 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:43:23,391 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:23,718 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154323_summary.png
2025-06-02 15:43:23,973 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154323_pca_3d.png
2025-06-02 15:43:24,155 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154323_pca_variance.png
2025-06-02 15:43:24,155 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:24,156 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-02 15:43:24,156 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:43:24,156 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:43:24,156 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:43:24,171 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:43:24,405 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:43:24,406 - INFO - Processing node updates/additions.
2025-06-02 15:43:24,409 - INFO - Processing edge updates/additions.
2025-06-02 15:43:24,417 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:24,417 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:24,418 - DEBUG - Updated graph - Nodes: 736, Edges: 1571
2025-06-02 15:43:24,418 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:24,418 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:24,424 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-02 15:43:24,426 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:24,426 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-02 15:43:24,427 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-02 15:43:24,428 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:24,430 - DEBUG - Initial edge attributes tensor shape: torch.Size([1571, 10])
2025-06-02 15:43:24,431 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:24,431 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1571, 10])
2025-06-02 15:43:24,432 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:24,432 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:24,432 - INFO - Updated main graph to 736 nodes and 1571 edges.
2025-06-02 15:43:24,432 - INFO - Performing online update...
2025-06-02 15:43:24,432 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:24,433 - DEBUG - Updated RunningStats: new_mean=0.9419710684142605, new_var=15000000000160.754, new_n=1530
2025-06-02 15:43:24,433 - DEBUG - Updated RunningStats: new_mean=0.9380401861293707, new_var=15300000000019.012, new_n=1560
2025-06-02 15:43:24,433 - DEBUG - Updated RunningStats: new_mean=43.05190152233215, new_var=5000000194621.167, new_n=510
2025-06-02 15:43:24,433 - DEBUG - Updated RunningStats: new_mean=43.221247961653724, new_var=5100000235586.076, new_n=520
2025-06-02 15:43:24,433 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:24,433 - DEBUG - Online update step: 1/25
2025-06-02 15:43:24,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,433 - DEBUG - Online update step: 2/25
2025-06-02 15:43:24,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,433 - DEBUG - Online update step: 3/25
2025-06-02 15:43:24,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,433 - DEBUG - Online update step: 4/25
2025-06-02 15:43:24,433 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 5/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 6/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 7/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 8/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 9/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 10/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 11/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 12/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 13/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 14/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 15/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 16/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 17/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 18/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 19/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 20/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 21/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 22/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 23/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 24/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - DEBUG - Online update step: 25/25
2025-06-02 15:43:24,434 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,434 - WARNING - No successful steps during online update.
2025-06-02 15:43:24,435 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], current edge mean: [-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:43:24,435 - DEBUG - Node drift difference: 0.0102, Edge drift difference: 0.0003
2025-06-02 15:43:24,436 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], edge=[-6.6775412e-09  4.6487842e+02  0.0000000e+00  0.0000000e+00
 -3.0352461e-09  1.2140984e-09 -2.4281968e-09 -3.0352461e-09
  2.4281968e-09  4.8563935e-09]
2025-06-02 15:43:24,436 - DEBUG - Updated reference std: node=[0.         0.         1.0006801  1.0006801  0.         0.
 0.         1.00068    1.00068    1.0006801  1.00068    1.0006801
 0.9868769  0.2827878  0.37280363 0.5652814  1.0006801  3.0891504
 2.9303455  1.5187457  0.37280363 0.         1.0006801  1.0006801
 0.         0.         0.         0.         1.0006801  1.0006801 ], edge=[  1.0003184 511.57693     0.          0.          1.0003184   1.0003184
   1.0003184   1.0003184   1.0003184   1.0003184]
2025-06-02 15:43:24,436 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:24,436 - INFO - Running anomaly detection...
2025-06-02 15:43:24,436 - INFO - Starting anomaly detection.
2025-06-02 15:43:24,442 - DEBUG - Node reconstruction errors: [20.69751   11.795511  20.117493  33.086872  15.507099  17.025866
 18.489264  27.353947  27.353947  30.348034  27.353947  19.851452
 25.145718  11.60122   28.23214   27.924967  19.71307   27.924961
 28.032995  26.936466  23.163788  28.232124  19.106873  13.377414
 27.466795  31.135782  27.466797  16.46847   26.569313  27.466795
 15.369363  18.253803  15.206818  32.219044  31.18163   21.547884
 16.108734  26.936466  15.668112  13.495675  32.925377  27.236458
 26.93647   28.387602  31.052113  20.60041   31.889997  11.867275
 25.733864  32.380207  39.15867   29.96066   30.389591  23.11681
 21.215187  14.764453  21.663034  25.068521  25.435856  20.092339
 13.344824  21.294027  26.307228  11.619615  26.592222  21.215199
 22.1421    21.215193  26.30723   26.307228  18.976427  19.353533
 22.69501   17.779896  16.288307  19.531286  26.942049  18.858284
 16.31386   17.615126  29.362885  17.560143   8.059938  23.381382
 20.807888  11.167234  17.479473  16.245241  17.758492  16.084095
 24.945961  14.897449  15.148036  16.425346  21.075447  36.42457
 28.422426  15.167126  23.834438  21.52848   18.219126  28.422422
 28.998846  18.220068  11.120236  21.311699  20.390827  10.490215
 15.769416  24.961786  18.660913  27.807875  14.682427  15.550825
 18.039034  16.436127  17.850996  14.955834  17.164541  20.02906
 23.418377  13.153857  15.102526  11.872067  16.400173  20.02903
 12.957412  12.153638  16.314854  19.922365  25.84987   22.950207
 23.609356  15.376704  17.455494  21.333818  27.362886  24.511189
 12.201102  14.24882   20.183893  17.443987  22.78914   21.707035
 20.652658  18.312506  17.850996  24.371399  22.70087   16.765036
 29.468252  10.923116  17.403124  22.950207  13.947007  14.339575
 22.27026   15.96498   18.219118  30.486914  20.652658  11.520803
 22.27026   25.849867  17.765434  15.374049  18.07575   16.27145
 11.06713   15.757136  17.489489  19.53347   24.764608  29.545143
 14.993465  13.115149  16.273268  16.252495  17.637238  17.63724
 20.564249  16.070547  21.643969  15.974343  14.106248  15.06259
 22.060472  17.385443  20.584131  21.49593   14.788512  15.979425
 23.476023  23.591105  12.201108  24.672468   7.9752126 21.633562
 15.346287  20.085827  20.926676  22.27026   15.0855055 17.049158
 17.875654  10.949208  24.88224   16.154028  23.158632  16.97114
 17.220987  17.71491   26.769896  15.321141  15.246359  22.214954
 15.976449  17.850994  17.514837  23.591108  15.005137  22.060469
 23.930735  26.769894  22.27026   16.687382  14.4198265 24.303192
 16.950533  13.364011  13.741537  15.836239  15.228912  17.850994
 17.851     24.672472  15.6493025 23.930735  22.270252  24.408144
 14.014856  15.47925   23.459238  16.765036  23.422367  15.68666
 16.588398  17.214079  23.45924   20.723028  24.764608  24.774633
 17.514841  15.515345  16.436129  18.122744  21.495934  21.795855
 20.989866  17.637234  15.765799  14.648075  26.15579   19.899225
 15.641203  20.407583  17.068316  15.185364  17.068317  15.893709
 16.026676  15.211725  15.950607  19.385468  17.48443   17.637238
 21.55743   18.350706  20.564245  15.145368  14.52161   22.147858
 15.955067  29.204958  15.406248  27.143755  14.426157  13.890758
 16.070553  11.1218605 19.3982    25.466852  23.611916  23.422365
 11.044536  20.747135  15.297271  17.63706   24.672482  18.89758
 15.703561  22.921192  16.972555  16.972557  22.921198  22.921192
 22.921198  17.394348  22.292236  22.921192  22.921192  13.370839
 22.921198  20.798475  10.481419  16.320211  16.405983  14.558953
 25.915045  24.06436   16.665407  18.504185  17.301365  16.972557
 20.053293  15.58338   23.030336  17.394348  16.874153  16.874155
 17.671833  23.95297   22.921192  17.484434  22.921192  17.39435
 18.358154  23.936583  23.030338  23.030338  22.921194  23.34495
 23.030338  15.3394375 15.616395  17.068321  16.972559  26.45843
 17.605051  16.53912   22.921198  15.979451  14.497732  16.220984
 22.699108  21.49593   21.17158   22.921192  23.694761  27.444757
 17.220984  20.641644  20.354109  15.427707  16.972544  18.834904
 22.5357    13.694055  17.191992  16.456156  15.230674  15.50347
 15.230723  13.763423  16.465666  15.733072  23.15254   22.422585
 15.1411295 22.921192  16.972559  10.995391  20.82716   15.500294
 10.995394  15.933989  21.677114  11.025099  17.78086   22.921192
 19.813477  16.066069  16.638596  15.969718  17.285461  17.28546
 17.28546   21.72424   22.229664  21.587475  20.177206  18.274519
 17.28546   22.229664  16.484009  16.638584  16.690323  19.458225
 16.63859   11.319266  17.285461  16.638596  22.229662  17.28546
 17.285461  20.29207   22.610546  17.285461  23.152485  21.348925
 19.371714  21.854404  16.379213  20.20699   13.6719475 19.37168
 20.177206  17.506182  14.061198  24.743425  16.597914  19.304993
 16.055773  17.043678  17.28546   17.285461  20.177206  16.43712
 13.671938  20.161432  21.28976   21.05815   18.04058   20.241823
 20.24182   11.201     14.763586  19.123283  22.605835  20.11829
 16.265724  21.833038  20.642513  21.621067  21.833036  18.724691
 20.206987  20.716417  23.48307   16.379217  16.735     21.267895
 19.709011  15.917894  19.709017  21.267895  22.472988  16.379217
 12.540342  23.276236  22.472988  16.735003  15.768065  13.588526
 15.359229  16.378853  16.045046  16.735     21.28976   21.207333
 25.267395  13.525163  20.296228  22.070335  14.209909  21.851694
 21.833038  13.355173  24.094769  13.984404  15.512574  21.28976
 15.710332  21.348925  15.964709  20.716413  16.311846  23.388124
 21.621067  21.207333  18.040575  21.348925  19.610838  20.843927
 21.851694  13.685984  21.086872  14.106147  20.642513  21.833042
 12.8901    20.493074  20.49307   19.7713    15.979424  21.833042
 21.08688   16.101439  26.052591  15.121408  16.101439  21.058153
 21.086872  24.395243  21.851694  16.311846  23.468145  12.671012
 16.101439  16.265728  21.833038  21.621067  21.621067  21.207333
 16.311846  16.216946  15.511633  15.925262  21.621069  17.059221
 21.621069  17.059221  18.784184  16.101437  20.49307   20.49307
 20.493074  21.061226  16.028364  21.061228  21.061226  21.061226
 21.061226  21.061226  21.061224  21.061226  16.067604  20.469603
 23.547651  21.061224  21.061226  21.061228  21.061226  21.061226
 21.061226  21.061226  21.061228  21.061224  15.72095   21.061228
 21.061228  16.067602  21.061226  21.833036  20.615545  21.621067
 21.93613   15.643835  34.578304  34.578304  16.378733  21.93613
 21.621067  21.086876  21.086872  21.621067  21.086878  21.621067
 18.208351  21.061226  21.05815   21.621067  20.49307   21.621063
 21.621063  21.086872  21.621067  21.086872  21.621067  21.621067
 16.101439  21.086872  21.621067  21.086872  21.621067  21.621067
 21.621067  15.751526  15.964708  15.964709  21.061226  19.611063
 20.08127   21.621063  21.086878  15.339903  21.061226  21.086872
 15.935145  20.555395  21.621067  21.621067  15.466193  15.715127
 17.150654  21.621067  16.067602  21.086872  21.086876  11.995511
 21.061226  21.086872  16.101437  21.061226  21.061226  16.067602
 21.621067  21.621063  18.817022  17.150654  15.584524  15.715125
 22.82842   16.4277    16.4277    20.096716  21.268347  21.061224
 19.916317  15.721527  15.715123  15.50004   21.268345  20.735806
 20.543314  20.543312  20.543312  20.543314  20.54331   15.389495
 15.904269  20.543314  20.543314  21.061226  21.061226  21.06123
 16.4277    15.352054  16.4277    20.742443  16.427698  15.083392
 15.720954  21.061228  15.720948  21.061228  16.427698  21.298084
 20.528238  20.528246  20.543312  21.298082  14.989026  20.272554
 21.061226  21.061226  20.543312  20.735807  20.528238  20.52824
 20.735807  20.778833  15.389496  15.844213  20.242924  13.207736
 15.628749  20.73581   20.07925   20.77883   20.238352  20.238352
 15.687424  20.046967  16.046564  20.73581   20.73581   20.735806
 20.2204    20.73581   20.735807  20.238352  20.73581   20.73581
 20.735811  15.835725  20.279938  14.982716  14.648316  15.835725
 19.538393  20.238352  14.648315  19.68591   19.793882  19.832806
 19.793894  18.074259  18.074257  20.23835   10.492206  17.8844
 19.793894  19.605888  21.96713   21.981062 ]
2025-06-02 15:43:24,442 - DEBUG - Edge reconstruction errors: [  4.502932    4.4354815  43.244915  ...  12.344922   12.344904
 534.2455   ]
2025-06-02 15:43:24,443 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154324_update_27.json
2025-06-02 15:43:24,444 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:24,446 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154324_update_27.pth and as latest_checkpoint.pth
2025-06-02 15:43:24,447 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.0045
2025-06-02 15:43:24,447 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 15:43:24,447 - WARNING -   Node ID: 3.131.239.162, Recon Error: 33.0869, MLP Score: 0.0061
2025-06-02 15:43:24,447 - WARNING -   Node ID: 20.24.249.45, Recon Error: 30.3480, MLP Score: 0.0051
2025-06-02 15:43:24,447 - WARNING -   Node ID: 103.102.166.224, Recon Error: 31.1358, MLP Score: 0.0039
2025-06-02 15:43:24,447 - WARNING -   Node ID: 142.250.198.196, Recon Error: 32.2190, MLP Score: 0.0055
2025-06-02 15:43:24,447 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.1816, MLP Score: 0.0039
2025-06-02 15:43:24,447 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:24,447 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2449, MLP Score: 0.0000
2025-06-02 15:43:24,447 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9493, MLP Score: 0.0000
2025-06-02 15:43:24,447 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0483, MLP Score: 0.0000
2025-06-02 15:43:24,447 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7474, MLP Score: 0.0000
2025-06-02 15:43:24,447 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7457, MLP Score: 0.0000
2025-06-02 15:43:24,447 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-02 15:43:24,447 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:43:24,447 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:43:24,447 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:43:24,467 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:43:24,485 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:43:24,485 - INFO - Processing node updates/additions.
2025-06-02 15:43:24,489 - INFO - Processing edge updates/additions.
2025-06-02 15:43:24,498 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:24,498 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:24,499 - DEBUG - Updated graph - Nodes: 762, Edges: 1619
2025-06-02 15:43:24,499 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:24,500 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:24,507 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-02 15:43:24,508 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:24,508 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-02 15:43:24,509 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-02 15:43:24,510 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:24,513 - DEBUG - Initial edge attributes tensor shape: torch.Size([1619, 10])
2025-06-02 15:43:24,514 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:24,514 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1619, 10])
2025-06-02 15:43:24,514 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:24,514 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:24,515 - INFO - Updated main graph to 762 nodes and 1619 edges.
2025-06-02 15:43:24,515 - INFO - Performing online update...
2025-06-02 15:43:24,515 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:24,516 - DEBUG - Updated RunningStats: new_mean=0.9421525034829301, new_var=15600000000160.803, new_n=1590
2025-06-02 15:43:24,516 - DEBUG - Updated RunningStats: new_mean=0.9383199389642939, new_var=15900000000018.898, new_n=1620
2025-06-02 15:43:24,516 - DEBUG - Updated RunningStats: new_mean=43.281234894827485, new_var=5200000193870.212, new_n=530
2025-06-02 15:43:24,516 - DEBUG - Updated RunningStats: new_mean=43.426096402709874, new_var=5300000228543.337, new_n=540
2025-06-02 15:43:24,516 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:24,516 - DEBUG - Online update step: 1/25
2025-06-02 15:43:24,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,516 - DEBUG - Online update step: 2/25
2025-06-02 15:43:24,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,516 - DEBUG - Online update step: 3/25
2025-06-02 15:43:24,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,516 - DEBUG - Online update step: 4/25
2025-06-02 15:43:24,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,516 - DEBUG - Online update step: 5/25
2025-06-02 15:43:24,516 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 6/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 7/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 8/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 9/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 10/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 11/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 12/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 13/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 14/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 15/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 16/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 17/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 18/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 19/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 20/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 21/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 22/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 23/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 24/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - DEBUG - Online update step: 25/25
2025-06-02 15:43:24,517 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,517 - WARNING - No successful steps during online update.
2025-06-02 15:43:24,518 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], current edge mean: [ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:43:24,518 - DEBUG - Node drift difference: 0.0179, Edge drift difference: 0.0017
2025-06-02 15:43:24,519 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], edge=[ 3.5343088e-09  4.6400555e+02  0.0000000e+00  0.0000000e+00
 -1.7671544e-09  5.8905147e-09 -3.5343088e-09  0.0000000e+00
 -2.3562059e-09 -2.3562059e-09]
2025-06-02 15:43:24,519 - DEBUG - Updated reference std: node=[0.         0.         1.0006568  1.0006568  0.         0.
 0.         1.0006568  1.0006567  1.0006567  1.0006568  1.0006568
 0.97361827 0.27801365 0.36245453 0.5658664  1.0006567  3.0614383
 2.9225075  1.5215856  0.36245453 0.         1.0006568  1.0006568
 0.         0.         0.         0.         1.0006568  1.0006568 ], edge=[  1.000309  504.0354      0.          0.          1.0003089   1.000309
   1.000309    1.000309    1.000309    1.000309 ]
2025-06-02 15:43:24,519 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:24,519 - INFO - Running anomaly detection...
2025-06-02 15:43:24,519 - INFO - Starting anomaly detection.
2025-06-02 15:43:24,525 - DEBUG - Node reconstruction errors: [20.622074  11.753204  20.407837  32.783596  15.590264  17.104456
 19.489653  27.067446  27.067446  30.093288  27.067446  19.684168
 25.651463  11.527366  27.940454  27.55422   19.703552  27.554218
 27.797895  26.659746  23.188753  27.94046   18.946583  13.423747
 27.254675  30.982029  27.254675  16.523237  26.372545  27.254675
 15.584356  18.35278   15.324067  31.988045  31.010859  21.800251
 16.25143   26.659746  15.755607  12.200682  32.780193  27.044922
 26.659746  28.578356  11.955265  20.839197  32.054516  11.95605
 25.55186   32.819683  39.731213  29.858809  30.30645   23.311663
 21.356565  14.908535  22.144962  24.947962  25.363543  20.466393
 13.41946   21.55308   26.192505  11.7556095 26.477283  21.35656
 22.282768  21.356564  26.192505  26.192509  19.257267  19.37321
 22.878004  17.840326  16.41282   19.53776   27.23939   18.92143
 16.485487  17.683695  29.321749  17.676208   8.1085005 23.741003
 21.029833  11.319244  17.699976  16.43441   17.862238  16.290436
 24.958242  15.037518  15.284206  16.606627  21.273968  36.59788
 28.429823  15.377424  23.914455  21.697933  18.305418  28.429823
 29.156563  18.413567  10.521814  21.498354  11.309416  10.642176
 15.8496895 25.347424  18.929312  27.895132  14.818929  15.643066
 18.100887  16.599033  17.926947  15.107017  17.241734  20.298021
 23.551928  13.388196  15.290159  12.031133  16.600231  20.297977
 13.095119  12.296807  14.910636  20.181454  26.022156  23.090582
 23.624632  15.53263   17.555782  21.5114    27.614513  24.530828
 11.156282  14.321875  20.489458  17.586723  22.971016  21.934574
 20.927862  18.353352  17.926949  24.395567  22.841795  16.865816
 29.516438  11.059967  17.45065   23.090582  14.110372  14.46311
 22.474636  16.158335  18.305422  30.526102  20.927862  11.6866455
 22.474632  26.022156  17.889772  15.501573  18.125805  16.451859
 10.997976  15.912216  17.5606    19.84093   24.787445  29.899427
 15.221177  13.211258  16.402382  16.422064  17.766514  17.766518
 20.791113  16.132715  21.7517    16.078337  14.28629   14.876755
 22.280077  17.511532  20.807577  21.740778  14.797792  16.18491
 23.843039  23.702118  11.156287  24.954676   8.090035  21.893694
 15.4806385 20.350733  21.134352  22.474636  15.21396   17.156868
 18.009052  11.142561  25.0454    16.178755  23.294416  17.05181
 17.377201  17.800943  26.878828  15.50453   15.450999  22.423418
 16.137377  17.926952  17.65546   23.702112  15.107402  22.280083
 24.016788  26.878828  22.474632  15.054576  14.59106   24.362776
 17.06187   13.608893  13.978964  16.068907  15.160931  17.92695
 17.92695   24.954676  15.872632  24.01679   22.474632  24.738615
 14.168925  15.629779  23.55393   16.865814  23.534159  15.4273615
 16.768385  17.35423   23.55393   18.797817  24.787445  24.790586
 17.65545   15.725282  16.599037  18.200645  21.740778  22.01356
 21.272926  17.766514  15.929715  14.734164  26.22497   20.172525
 15.068882  20.64158   17.158104  15.482253  17.1581    16.088423
 16.19381   15.385469  16.103151  19.662382  17.576244  17.766516
 21.73612   18.485071  20.791117  15.136013  14.683198  22.27574
 16.108377  29.316439  15.603103  27.248688  14.517646  14.111277
 16.132717  11.187732  18.460358  25.7032    23.765032  23.534157
  7.658786  21.0348    15.530123  17.766392  24.954678  18.773693
 15.925838  23.057844  17.092001  17.092     23.057844  23.057844
 23.057844  17.487068  22.474592  23.057844  23.057844  13.368272
 23.057844  21.076138  10.662732  16.510765  16.59529   14.715811
 26.091198  24.390772  16.782604  18.807375  17.441496  17.092003
 10.351841  15.723035  23.168226  17.48707   16.961075  16.96107
 17.754883  24.27691   23.057844  17.576252  23.057844  17.48707
 18.71271   24.019005  23.168226  23.168226  23.057844  23.400536
 23.168226  15.531103  15.845033  15.068292  17.092003  26.617332
 17.662245  16.68259   23.057844  16.192768  14.632638  16.410048
 22.790583  21.740778  21.42287   23.057844  23.776392  27.806545
 17.377192  20.91032   20.59203   15.597439  17.091991  19.302244
 22.71991   13.50785   17.310871  16.615776  15.40634   15.680417
 15.406386  13.9401655 16.578758  15.96385   23.28933   22.57346
 15.386733  23.057844  17.092     11.181118  21.091797  15.687542
 10.922143  14.95875   21.824215  11.204387  17.871614  23.057844
 19.947176  16.277622  16.818712  16.181099  17.40677   17.40677
 17.40677   21.917513  22.405024  21.85363   20.487274  18.412462
 17.40677   22.40503   16.665092  16.818708  16.80756   19.771776
 16.818708  11.456531  17.40677   16.818712  22.40503   17.406769
 17.40677   20.564812  22.715132  17.406769  23.28925   21.608225
 19.684454  19.140749  16.537416  20.500319  13.881147  19.684443
 20.487274  17.742939  14.245527  24.89098   16.733158  19.591614
 16.26338   17.185497  17.406769  17.40677   20.487274  16.59426
 13.881155  20.391478  21.54228   21.286407  18.437996  20.569897
 20.111134  11.367208  14.97248   19.49828   23.002417  20.418184
 14.777444  22.04525   20.907396  21.830378  22.045248  19.05878
 20.500322  20.985422  23.849016  16.537418  16.87455   21.500416
 20.044094  16.07718   20.044092  21.500414  22.64407   16.53742
 12.793466  23.642355  22.64407   16.874554  15.93452   13.613748
 15.545849  16.537077  15.393549  16.874557  21.542276  21.435268
 25.517155  13.6999855 20.613768  19.49828   13.677431  22.78655
 22.04525   12.111498  24.302988  14.09248   15.699994  21.542274
 14.721543  21.608229  16.153677  20.985426  16.48431   23.630247
 21.830381  21.435268  18.437996  21.608227  18.438002  21.059475
 22.056463  13.887686  21.323143  14.209782  20.907396  22.045248
 13.130451  20.760216  20.760216  20.111134  16.188143  20.11114
 21.323143  16.275751  26.39486   15.283024  16.275751  21.286407
 21.323143  24.666979  22.056467  16.48431   23.78123   12.7902155
 16.275755  16.471554  19.69756   21.830376  21.830376  21.435268
 16.48431   16.423376  15.68273   16.078224  21.830376  17.24002
 21.830378  17.24002   18.702784  16.275753  19.32326   20.760218
 18.879381  21.294975  16.124907  21.294981  21.294977  21.294975
 21.294977  21.294975  21.294975  21.294981  16.236113  18.828337
 23.791624  21.294981  21.294977  21.294975  21.294981  21.294975
 21.294981  21.294977  21.294975  21.294975  15.905564  21.294975
 21.294975  16.236116  21.294975  13.13045   20.846378  21.830381
 22.198082  15.514957  34.938107  34.938107  16.524126  22.198082
 21.830376  21.323143  21.323143  21.830378  21.323143  23.052795
 18.550463  21.294977  21.286407  21.830376  20.760218  21.830378
 21.830378  19.910877  21.830378  21.323143  21.830378  21.830378
 16.275753  21.323153  21.830378  21.323143  21.830376  21.830381
 21.830378  15.922612  16.153675  16.153677  21.294975  19.862642
 20.307232  21.830378  21.323149  15.512081  21.294981  21.323143
 16.129818  20.837643  21.830378  21.830378  15.177409  15.877808
 17.292086  21.830381  16.236122  19.91087   21.323143  12.138025
 21.294977  21.323143  16.275751  21.294975  21.294975  16.236116
 19.91087   21.830378  19.093384  17.292082  15.806132  15.877807
 23.22729   16.602674  16.602674  20.348627  21.50401   21.294981
 20.225714  15.945568  15.877809  15.737246  21.504011  21.007267
 20.81      20.810001  20.810003  20.810001  20.810003  15.581036
 16.105003  20.810003  20.810001  21.294975  19.44077   21.294975
 16.602678  15.546972  16.602678  20.963612  16.602674  14.434908
 15.905562  21.294977  15.905563  21.294977  16.602674  21.521624
 20.81103   20.81103   20.810001  21.521624  15.308613  20.511007
 21.294975  21.294981  20.81      21.007261  20.81103   19.885134
 21.007267  21.021187  15.581038  13.415442  19.63412   13.1264515
 15.912767  21.007267  20.359056  21.021181  20.544437  20.544436
 15.901859  20.34904   16.241777  21.007265  21.007265  21.007267
 20.524105  21.007267  21.007265  20.544434  21.007261  21.007265
 21.007265  15.354371  20.560682  15.262989  14.930983  16.093983
 19.871552  20.544436  14.930984  19.89366   20.104712  20.120636
 20.104729  18.433933  18.43393   20.544434  10.585545  18.251743
 20.104729  19.914358  22.345165  13.077839  19.734074  19.734074
 19.734074  19.5297    19.717121  13.281817  20.803202  18.251743
 22.663189  19.657795  18.784533  19.914358  19.390669  22.154463
 20.104729  22.154472  20.104729  18.251743  19.914358  15.857738
 19.657795  19.320353  19.734074  19.529697  20.104723  19.233103 ]
2025-06-02 15:43:24,525 - DEBUG - Edge reconstruction errors: [  4.5339985   4.456039   43.247692  ...  12.347711   12.347692
 534.24817  ]
2025-06-02 15:43:24,527 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154324_update_28.json
2025-06-02 15:43:24,527 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:24,530 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154324_update_28.pth and as latest_checkpoint.pth
2025-06-02 15:43:24,530 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.0044
2025-06-02 15:43:24,530 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:43:24,530 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.7836, MLP Score: 0.0058
2025-06-02 15:43:24,530 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.9820, MLP Score: 0.0038
2025-06-02 15:43:24,530 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.9880, MLP Score: 0.0053
2025-06-02 15:43:24,530 - WARNING -   Node ID: 151.101.0.223, Recon Error: 31.0109, MLP Score: 0.0038
2025-06-02 15:43:24,530 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.7802, MLP Score: 0.0051
2025-06-02 15:43:24,530 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:24,530 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2476, MLP Score: 0.0000
2025-06-02 15:43:24,530 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9515, MLP Score: 0.0000
2025-06-02 15:43:24,530 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0506, MLP Score: 0.0000
2025-06-02 15:43:24,530 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7497, MLP Score: 0.0000
2025-06-02 15:43:24,531 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7484, MLP Score: 0.0000
2025-06-02 15:43:24,531 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-02 15:43:24,531 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:43:24,531 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:43:24,531 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:43:24,550 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:43:24,569 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:43:24,569 - INFO - Processing node updates/additions.
2025-06-02 15:43:24,573 - INFO - Processing edge updates/additions.
2025-06-02 15:43:24,582 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:24,582 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:24,583 - DEBUG - Updated graph - Nodes: 768, Edges: 1644
2025-06-02 15:43:24,583 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:24,584 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:24,590 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-02 15:43:24,592 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:24,592 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-02 15:43:24,593 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-02 15:43:24,594 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:24,597 - DEBUG - Initial edge attributes tensor shape: torch.Size([1644, 10])
2025-06-02 15:43:24,598 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:24,598 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1644, 10])
2025-06-02 15:43:24,598 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:24,598 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:24,599 - INFO - Updated main graph to 768 nodes and 1644 edges.
2025-06-02 15:43:24,599 - INFO - Performing online update...
2025-06-02 15:43:24,599 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:24,599 - DEBUG - Updated RunningStats: new_mean=0.9422744119933412, new_var=16200000000160.84, new_n=1650
2025-06-02 15:43:24,599 - DEBUG - Updated RunningStats: new_mean=0.9385665205305781, new_var=16500000000018.895, new_n=1680
2025-06-02 15:43:24,600 - DEBUG - Updated RunningStats: new_mean=43.47959669847244, new_var=5400000193589.352, new_n=550
2025-06-02 15:43:24,600 - DEBUG - Updated RunningStats: new_mean=43.608880197122424, new_var=5500000224989.786, new_n=560
2025-06-02 15:43:24,600 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:24,600 - DEBUG - Online update step: 1/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 2/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 3/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 4/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 5/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 6/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 7/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 8/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 9/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 10/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 11/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 12/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 13/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 14/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 15/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,600 - DEBUG - Online update step: 16/25
2025-06-02 15:43:24,600 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 17/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 18/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 19/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 20/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 21/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 22/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 23/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 24/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - DEBUG - Online update step: 25/25
2025-06-02 15:43:24,601 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,601 - WARNING - No successful steps during online update.
2025-06-02 15:43:24,601 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], current edge mean: [-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:43:24,601 - DEBUG - Node drift difference: 0.0144, Edge drift difference: 0.0006
2025-06-02 15:43:24,602 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], edge=[-1.7402816e-09  4.6368613e+02  0.0000000e+00  0.0000000e+00
 -3.4805632e-09 -2.9004694e-09 -5.8009386e-10 -4.3507038e-09
 -3.1905163e-09  3.7706100e-09]
2025-06-02 15:43:24,602 - DEBUG - Updated reference std: node=[0.         0.         1.0006517  1.0006517  0.         0.
 0.         1.0006517  1.0006517  1.0006516  1.0006517  1.0006516
 0.96356016 0.27694583 0.362543   0.56546044 1.0006516  3.062159
 2.921897   1.5160462  0.362543   0.         1.0006517  1.0006517
 0.         0.         0.         0.         1.0006517  1.0006516 ], edge=[  1.0003042 500.1926      0.          0.          1.0003042   1.0003042
   1.0003042   1.0003042   1.0003043   1.0003043]
2025-06-02 15:43:24,603 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:24,603 - INFO - Running anomaly detection...
2025-06-02 15:43:24,603 - INFO - Starting anomaly detection.
2025-06-02 15:43:24,609 - DEBUG - Node reconstruction errors: [20.749836  11.753729  20.486528  32.649414  15.641256  17.135931
 19.558748  26.949636  26.949636  29.983429  26.949636  19.617373
 25.750177  11.563654  27.811024  27.392052  19.71263   27.39206
 27.685253  26.533998  23.198202  27.811018  19.041332  13.449906
 27.161781  30.908934  27.161781  16.55371   26.26523   27.161781
 15.643488  16.626745  15.381058  31.885334  30.941477  21.90248
 16.288918  26.533998  15.809375  12.252539  32.71158   26.955458
 26.533998  28.651684  12.002999  11.195128  32.106968  12.004588
 25.461733  32.970253  39.918564  29.809706  30.242237  23.37866
 21.391733  14.986385  22.293217  24.883331  25.331146  20.614376
 13.439046  21.658098  26.13066   11.378467  26.415459  21.391733
 22.319572  21.39173   26.130665  26.13066   18.216915  19.351427
 22.935452  17.848606  16.466402  19.512949  27.351862  18.93739
 16.527412  17.693823  29.290197  17.696993   8.157423  23.895266
 18.04803   10.772323  17.765882  16.47894   17.87803   16.357615
 24.950315  15.097608  15.3396435 16.642878  21.337507  36.58693
 28.429016  15.439286  23.9312    21.76224   18.320171  28.429016
 29.208073  18.467344  10.597448  21.56358   11.380037  10.708402
 15.883196  25.481344  19.034184  27.919516  14.886672  15.690241
 18.126915  16.664452  17.952702  15.175763  17.27169   20.390532
 23.593842  13.478232  15.368311  12.094067  16.65104   20.390495
 13.140253  12.341958  14.973455  20.290932  26.068678  23.136003
 23.62257   15.607088  17.593842  21.57862   27.7047    24.524813
 11.230626  14.385614  20.605078  17.640312  23.034481  22.01853
 21.03521   18.370562  17.952698  24.38951   22.889488  16.908434
 29.513887  11.122583  17.454956  23.136005  14.1786585 14.523991
 22.541294  16.217543  18.320164  30.525702  21.035208  11.754943
 22.541294  26.068678  17.91735   15.560977  18.127111  16.504625
 11.069299  15.980183  17.572481  19.948696  24.783098  29.980062
 15.092045  13.245342  16.446712  16.483685  17.796488  17.796488
 20.87546   16.153545  21.803286  16.11906   14.36842   14.951097
 22.363314  17.54267   20.889416  21.828287  14.863043  16.233023
 22.520702  23.722971  11.23063   25.046082   8.133638  20.262665
 15.539831  20.459534  21.220833  22.541302  15.273984  17.187456
 18.040436  11.216939  25.095278  16.244328  23.336493  17.069483
 17.419767  17.829802  26.90368   15.564199  15.29072   22.503748
 15.511973  17.952696  17.683542  23.722971  15.1576805 22.363312
 24.03889   26.903673  22.541294  15.136306  14.669867  24.356739
 17.094648  13.716159  11.2281685 16.125065  15.027692  17.9527
 17.952696  25.046076  15.929882  24.03889   22.541302  23.439274
 14.239989  15.689662  23.577066  15.449062  23.557962  15.497039
 16.815561  17.40927   23.577065  18.927446  24.783098  24.786194
 17.68354   15.783706  16.66445   18.232784  21.828287  22.095419
 20.120361  17.79649   15.983119  14.768638  26.246359  20.26705
 15.142306  20.723318  17.182884  15.5383215 17.182882  16.150312
 16.2649    15.454227  16.149523  19.781012  17.59661   17.79649
 21.806639  18.517908  20.875456  15.210275  14.746426  22.324821
 16.17045   29.344893  15.000202  27.276398  14.586104  14.172685
 16.153547  11.259759  18.592113  25.797543  23.81491   23.557966
  9.503332  21.147066  15.600167  17.796392  25.046082  18.895264
 15.997835  23.104176  17.125051  17.125055  23.104174  23.104174
 23.104174  17.505802  22.541744  23.104176  23.104174  13.4322815
 23.104174  21.179304  10.520333  16.546795  16.06515   14.786158
 26.14205   24.501461  16.818407  18.927498  17.476738  17.125063
 10.428882  15.775507  23.21323   17.5058    16.980871  16.980871
 17.776083  24.387127  23.104176  17.596605  23.104174  17.505798
 18.850914  24.041237  23.21323   23.21323   23.104174  23.42196
 23.21323   15.1124935 15.904974  15.045205  17.125051  26.668709
 17.671345  16.726671  23.104174  16.256609  14.698391  16.463707
 22.836775  21.828287  21.517595  23.104176  23.797384  27.941376
 17.419765  21.014307  20.676977  15.6666765 17.12505   19.446217
 22.788252  13.575278  17.354736  16.678892  15.477139  15.750498
 15.477179  14.016568  16.613655  15.533251  23.334812  22.622974
 15.460202  23.104174  17.125053  11.258551  21.190948  15.766383
 11.002415  15.054121  21.870842  11.283075  17.900219  23.104174
 19.99509   16.348274  16.873653  16.252926  17.447924  17.447924
 17.447924  22.006807  22.47047   21.940556  20.600103  18.466072
 17.447926  22.470467  16.7128    16.873646  16.849648  19.887325
 16.873653  11.506791  17.447926  16.873652  22.470467  17.447926
 17.447924  20.67522   22.761284  17.447924  23.334814  21.706501
 19.801308  19.297064  16.600842  20.61214   13.976467  19.801296
 19.297056  17.823671  14.288081  24.95676   16.781292  19.704565
 16.32946   17.243921  17.447926  17.447924  20.600103  16.661303
 13.9764595 20.489782  19.844954  21.371178  18.597752  20.70454
 20.250982  10.393859  14.810157  19.641071  23.154455  20.532299
 14.880268  22.127995  21.007269  21.911747  22.127993  19.191868
 20.612133  21.085323  23.997541  16.600842  16.929317  21.58371
 20.173206  16.145025  20.173206  21.583715  22.708963  16.600842
 12.896146  23.77652   22.708963  16.929316  16.00456   13.672724
 15.624101  16.60058   15.488905  16.929316  21.638807  21.518188
 25.612753  13.777964  20.745293  19.641071  13.768441  19.8575
 22.127993  12.224943  24.38501   14.1631565 15.774707  21.638805
 14.810439  21.706505  16.230871  21.085323  16.552822  23.723185
 21.911745  21.518188  18.59775   21.706505  18.597752  21.1426
 22.13705   13.9855585 21.419268  14.280628  21.00727   22.127995
 13.241634  20.862206  20.862206  20.250982  16.259825  20.25098
 21.419268  16.33713   26.530867  15.3520155 16.337126  21.371178
 21.419268  24.7608    22.137049  16.552824  23.896458  12.846728
 16.337128  16.532764  19.844952  21.911745  21.911745  21.518185
 16.552822  16.488396  15.743155  16.145123  21.911745  17.299791
 21.911747  17.299791  18.84106   16.337128  19.467623  20.86221
 19.038588  21.3906    16.19335   21.3906    21.3906    21.390598
 21.3906    21.390602  21.3906    21.3906    16.293837  18.989353
 23.889639  21.390602  21.3906    21.390602  21.390598  21.3906
 21.3906    21.3906    21.390602  21.3906    15.974927  21.390602
 21.390602  16.293835  21.390602  13.241633  20.87165   21.911747
 22.2464    15.615261  35.037243  35.037243  16.589575  22.2464
 21.911745  21.419268  21.419268  21.911745  21.419268  23.213875
 18.69382   21.3906    21.371178  21.911745  20.86221   21.911747
 21.911745  20.046711  21.911749  21.419268  21.911749  21.911745
 16.337128  21.419268  21.911747  21.419268  21.911745  21.911745
 21.911747  15.989442  16.230867  16.230871  21.390602  19.960226
 20.328646  21.911745  21.419268  15.579633  21.390602  21.419268
 16.20268   20.953178  21.911747  21.911745  15.253912  15.941129
 15.376203  21.911747  16.293837  20.046715  21.419268  12.201491
 21.3906    21.419268  16.337126  21.3906    21.390602  16.293835
 20.046715  21.911747  19.195381  17.35442   15.889311  15.941127
 23.39901   16.666735  16.666735  20.389187  21.601877  21.390602
 20.343626  16.0318    15.941127  15.822242  21.601875  21.123526
 20.922468  20.922468  20.922468  20.922468  20.922468  15.655074
 16.175568  20.922466  20.922466  21.3906    19.593937  21.3906
 16.666735  15.61832   16.666735  21.05801   16.666735  14.647564
 15.974934  21.3906    15.974938  21.390602  16.666737  21.619226
 20.92678   20.92678   20.922468  21.619226  15.402215  20.614502
 21.390602  21.3906    20.922468  21.12353   20.926785  20.025806
 21.123526  19.787382  15.655072  13.476857  19.787382  13.008457
 15.243227  21.123526  20.472609  21.13744   20.677626  20.677624
 15.983265  20.477924  16.314354  21.12353   21.123526  21.123526
 20.647701  21.12353   21.123526  20.67763   21.123526  21.123526
 21.123526  15.263399  20.696455  15.36595   14.67973   16.187613
 20.006462  19.775795  15.04071   20.008066  20.24486   20.263842
 20.24485   18.574879  18.574879  20.67763   12.827761  14.543588
 20.24485   20.0503    22.502848  13.153195  19.883137  19.883137
 19.883135  19.671904  19.862219  13.382889  20.957281  18.408321
 22.82629   19.80714   18.946129  20.050297  19.532927  15.331022
 20.24485   22.32304   20.24485   18.408323  20.050297  15.946379
 19.80714   19.461308  19.883135  19.671904  20.24485   19.37596
 18.12771   19.671904  19.671904  19.671902  18.937727  18.93773  ]
2025-06-02 15:43:24,609 - DEBUG - Edge reconstruction errors: [  4.524741    4.4529552  43.248055  ...  12.348068   12.348049
 534.2486   ]
2025-06-02 15:43:24,615 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154324_update_29.json
2025-06-02 15:43:24,615 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:24,618 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154324_update_29.pth and as latest_checkpoint.pth
2025-06-02 15:43:24,618 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.0044
2025-06-02 15:43:24,618 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:43:24,618 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.6494, MLP Score: 0.0057
2025-06-02 15:43:24,618 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.9089, MLP Score: 0.0038
2025-06-02 15:43:24,618 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.8853, MLP Score: 0.0052
2025-06-02 15:43:24,619 - WARNING -   Node ID: 151.101.0.223, Recon Error: 30.9415, MLP Score: 0.0037
2025-06-02 15:43:24,619 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.7116, MLP Score: 0.0051
2025-06-02 15:43:24,619 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:24,619 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2480, MLP Score: 0.0000
2025-06-02 15:43:24,619 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9515, MLP Score: 0.0000
2025-06-02 15:43:24,619 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0507, MLP Score: 0.0000
2025-06-02 15:43:24,619 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7500, MLP Score: 0.0000
2025-06-02 15:43:24,619 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7487, MLP Score: 0.0000
2025-06-02 15:43:24,619 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-02 15:43:24,619 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:43:24,619 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:43:24,619 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:43:24,642 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:43:24,665 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:43:24,665 - INFO - Processing node updates/additions.
2025-06-02 15:43:24,672 - INFO - Processing edge updates/additions.
2025-06-02 15:43:24,686 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:24,688 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:24,688 - DEBUG - Updated graph - Nodes: 780, Edges: 1667
2025-06-02 15:43:24,689 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:24,690 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:24,702 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-02 15:43:24,704 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:24,704 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-02 15:43:24,706 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-02 15:43:24,708 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:24,717 - DEBUG - Initial edge attributes tensor shape: torch.Size([1667, 10])
2025-06-02 15:43:24,726 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:24,731 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1667, 10])
2025-06-02 15:43:24,731 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:24,732 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:24,733 - INFO - Updated main graph to 780 nodes and 1667 edges.
2025-06-02 15:43:24,733 - INFO - Performing online update...
2025-06-02 15:43:24,733 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:24,734 - DEBUG - Updated RunningStats: new_mean=0.9423680974794084, new_var=16800000000160.652, new_n=1710
2025-06-02 15:43:24,734 - DEBUG - Updated RunningStats: new_mean=0.9389637560575538, new_var=17100000000018.463, new_n=1740
2025-06-02 15:43:24,734 - DEBUG - Updated RunningStats: new_mean=43.65564973143083, new_var=5600000192791.492, new_n=570
2025-06-02 15:43:24,735 - DEBUG - Updated RunningStats: new_mean=43.77193341232553, new_var=5700000222060.272, new_n=580
2025-06-02 15:43:24,735 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:24,735 - DEBUG - Online update step: 1/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 2/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 3/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 4/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 5/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 6/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 7/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 8/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 9/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 10/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,735 - DEBUG - Online update step: 11/25
2025-06-02 15:43:24,735 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 12/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 13/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 14/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 15/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 16/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 17/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 18/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 19/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 20/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 21/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 22/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 23/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 24/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - DEBUG - Online update step: 25/25
2025-06-02 15:43:24,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,736 - WARNING - No successful steps during online update.
2025-06-02 15:43:24,737 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], current edge mean: [-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:43:24,737 - DEBUG - Node drift difference: 8974.5518, Edge drift difference: 0.0019
2025-06-02 15:43:24,738 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:43:24,738 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], edge=[-4.5767212e-09  4.6274744e+02  0.0000000e+00  0.0000000e+00
 -2.0023156e-09  0.0000000e+00  3.7185861e-09  0.0000000e+00
  0.0000000e+00  6.4360144e-09]
2025-06-02 15:43:24,739 - DEBUG - Updated reference std: node=[0.         0.         1.0006417  1.0006417  0.         0.
 0.         1.0006417  1.0006416  1.0006417  1.0006416  1.0006417
 1.0045444  0.29221377 0.36398143 0.5649002  1.0006417  3.058592
 2.92255    1.5183852  0.36398143 0.2506402  1.0006417  1.0006417
 0.         0.         0.         0.         1.0006417  1.0006417 ], edge=[  1.0003  496.99893   0.        0.        1.0003    1.0003    1.0003
   1.0003    1.0003    1.0003 ]
2025-06-02 15:43:24,739 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:24,739 - INFO - Running anomaly detection...
2025-06-02 15:43:24,739 - INFO - Starting anomaly detection.
2025-06-02 15:43:24,747 - DEBUG - Node reconstruction errors: [20.626804  11.414624  20.1941    32.462925  15.663081  17.104187
 19.303556  26.80175   26.80175   29.822601  26.801752  19.51695
 25.230465  11.461907  27.63009   27.176167  19.6959    27.17617
 27.153637  26.36127   23.185448  27.63009   19.12085   13.463161
 27.01755   30.802574  27.01755   16.577013  26.09914   27.017553
 15.23059   16.64516   14.823464  31.735285  30.832468  21.9774
 16.286766  26.361275  15.702478  12.291868  32.593227  26.815952
 26.361275  28.665606  11.936692  11.24517   32.06886   12.038098
 25.33595   33.179604  40.200954  29.686764  30.113562  23.083174
 21.413212  15.066847  22.37875   24.785322  24.972128  20.41147
 13.436132  21.744213  26.024334  11.447281  26.307402  21.413218
 22.338701  21.413216  26.024336  26.024336  18.357677  19.264254
 22.989021  17.80032   16.49312   19.423393  25.098263  18.90891
 16.535294  17.650736  29.20053   17.66696    8.105885  24.038136
 18.181446  10.833922  17.805412  16.483374  17.837961  16.390108
 24.904629  15.142162  15.398307  16.632755  21.39761   36.653942
 28.381933  15.458888  23.919432  21.825867  18.289354  28.381933
 29.217073  18.487097  10.683     21.626324  11.266821  10.7787485
 15.923243  25.672697  19.150965  27.895357  14.938562  15.717668
 18.107893  16.70255   17.941408  15.239538  17.265804  20.49347
 23.60691   13.563279  15.456919  12.147516  16.671633  20.493437
 13.179301  12.382333  14.9988365 20.406609  26.07284   23.173555
 23.607958  15.700258  17.594748  21.64513   27.758972  24.494898
 11.312433  14.280994  20.74168   17.65396   23.075357  22.108112
 21.160864  18.33867   17.941408  24.369215  22.91854   16.9183
 29.472464  10.521368  17.433455  23.173563  14.266466  14.567217
 22.607178  16.226357  18.289349  30.471415  21.160864  11.824506
 22.607176  26.072836  17.905048  15.6136055 18.096888  16.515402
 11.1410675 16.029436  17.540615  20.075472  24.744835  30.142984
 15.127757  13.184509  16.461845  16.519022  17.787836  17.787838
 20.96637   16.177145  21.847466  16.17546   13.727555  14.808231
 22.43897   17.526667  20.979378  21.928076  14.730648  16.238008
 22.684368  23.732143  11.312437  25.12343    8.088183  20.406416
 15.588147  20.57245   21.307497  22.607178  15.321952  17.169355
 18.02369   11.298523  25.103777  16.348213  23.349907  17.06377
 17.427893  17.829329  26.895205  15.573511  15.366916  22.576807
 15.555285  17.941408  17.68479   23.732143  15.183419  22.43897
 24.036457  26.895205  22.607176  15.187975  14.75096   24.336218
 17.09021   13.829603  11.305159  16.14351   15.064397  17.941408
 17.941412  25.123436  15.94675   24.036459  22.607176  23.599703
 14.289308  15.715026  23.590246  15.52084   23.569714  15.335637
 16.816265  15.817201  23.590246  19.078373  24.744833  24.75123
 17.684792  15.811566  16.702553  18.218481  21.928076  22.170008
 20.275661  17.787836  16.021801  14.809301  26.229795  20.37281
 15.1862955 20.80853   17.166649  15.216538  17.166647  16.17572
 16.360395  15.536776  16.157915  19.911892  17.586706  17.787838
 21.863552  18.503502  20.966368  15.259452  14.635533  22.355272
 16.210646  29.333506  15.033504  27.266378  14.50139   14.241799
 16.177145  11.189954  18.743784  25.872675  23.8578    23.569714
  9.440357  21.259148  15.635609  17.787785  25.123436  19.075113
 16.046148  23.135862  17.129461  17.129461  23.135862  23.135862
 23.135862  17.497187  22.60362   23.135862  23.135862  13.372267
 23.135862  21.300062  10.608426  16.552204  16.136375  14.860228
 26.167988  24.60137   16.82916   19.060347  17.476297  17.12946
 10.288197  15.8466215 23.24117   17.497187  16.980434  16.980436
 17.775974  24.489994  23.135862  17.58671   23.135862  17.497183
 19.002172  24.041735  23.241169  23.241169  23.135862  23.429535
 23.24117   15.183746  15.936458  15.090058  17.129463  26.68775
 17.648838  16.738234  23.135862  16.276936  14.745996  16.486284
 22.870909  21.92808   21.6088    23.135862  23.798126  28.06577
 17.427893  21.114521  20.749514  15.710526  17.129461  19.680214
 22.847746  13.649001  17.373165  16.723225  15.512183  15.7936945
 15.512205  14.10607   16.627998  15.5832815 23.368544  22.652857
 15.513297  23.135862  17.12946   11.334213  21.306566  15.8268795
 11.085791  15.136718  21.917645  11.362335  17.90432   23.135862
 20.024218  16.394035  16.898485  16.29639   17.471819  17.471819
 17.471819  21.7448    22.531239  21.688925  20.730095  18.490396
 17.471819  22.531242  16.72925   16.898481  16.866783  20.010267
 16.898483  11.5625725 17.471819  16.898485  22.531239  17.471819
 17.471819  20.797598  22.798206  17.471819  23.368597  19.702375
 19.925495  19.472704  16.645168  20.735876  13.894126  18.342396
 19.4727    17.87798   14.339252  25.008162  16.805687  19.82584
 16.386045  17.272215  17.471819  17.471815  20.730097  16.703602
 14.10455   20.583843  20.009441  21.452105  18.756304  20.8466
 20.404257  10.46667   14.883782  19.795769  23.298563  20.654585
 14.957991  22.210644  21.113674  21.990871  22.21064   19.323751
 20.735878  21.192457  24.150585  16.64517   16.960976  21.678785
 20.312277  16.213213  20.312277  21.678782  22.769197  15.573889
 13.010149  23.895678  22.769196  16.960978  15.139364  13.597929
 15.684861  16.645027  15.573886  16.960978  21.737309  21.608007
 25.690363  13.878339  20.883291  19.795767  13.90598   20.020433
 22.210642  10.779656  24.451418  13.597928  15.815766  21.737309
 14.883942  21.801085  16.289831  21.192457  16.59541   20.933071
 21.99087   21.608007  18.756304  21.80108   18.756304  21.226965
 22.21929   14.077683  21.523357  14.199886  21.113674  22.21064
 13.353429  20.962822  20.962822  20.404259  16.322557  20.404259
 21.523369  16.384457  26.65567   15.391804  16.384453  21.452105
 21.523363  24.843166  22.219294  16.595411  24.005327  12.892992
 16.384459  16.576874  20.009443  21.990871  21.990871  21.608
 16.59541   16.530323  15.789849  16.191029  21.990871  17.34674
 21.990871  17.34674   18.65868   16.384459  19.621613  25.707394
 19.21577   21.4931    16.107536  21.493101  21.493105  21.4931
 21.493101  21.493101  21.493101  21.493101  16.33927   19.163725
 23.980864  21.4931    21.493101  21.493101  21.4931    21.493101
 21.493101  21.493101  21.493105  21.493101  16.031237  21.493101
 21.493103  13.368357  21.493101  11.233124  20.962599  21.990871
 22.324827  15.707504  35.053455  35.053455  16.628225  22.324827
 21.990871  21.523369  21.523363  21.990871  21.523363  23.366108
 18.08912   21.493103  21.45211   21.990871  20.962822  21.990871
 21.990871  20.197233  21.990875  21.52336   21.990875  21.990875
 16.384462  21.523357  21.990871  21.523363  21.990875  21.990871
 21.99087   16.050426  16.289833  16.289831  21.493101  20.054401
 20.413074  21.990871  21.523369  14.804426  21.493101  21.523363
 16.259491  21.08148   21.990871  21.99087   15.295713  16.000832
 15.46385   21.990871  16.339268  20.197235  21.523369  12.261315
 21.493101  21.523363  16.384459  21.4931    21.493101  16.339268
 20.197235  21.990871  19.287237  17.400623  15.960052  16.000828
 23.582144  16.72299   16.722988  20.492786  19.5741    21.493101
 20.464071  16.110725  16.000832  15.887356  21.705046  21.2464
 21.039104  21.039104  21.039104  21.039104  21.039104  15.715
 16.23113   21.039104  21.039103  21.493101  19.765532  21.493101
 16.722988  15.689048  16.722988  21.164726  16.722988  14.723622
 16.03123   21.493101  16.03123   21.493101  16.722986  21.723421
 21.055126  21.055126  21.039104  21.723425  15.471238  20.730171
 21.4931    21.493101  21.039104  21.2464    21.055126  20.184713
 21.2464    19.951317  15.715003  13.400738  19.951317  13.109496
 15.322846  21.2464    20.588823  21.265045  20.804937  20.804935
 16.062077  20.609522  16.378872  21.2464    21.2464    21.246395
 20.784655  21.2464    21.246405  20.804937  21.246397  21.246395
 21.2464    15.328339  20.831936  14.780884  14.780884  16.28197
 20.138235  19.939112  14.505678  19.780155  20.388052  20.412975
 19.960075  18.72578   18.725788  20.804935  12.929339  14.623004
 20.388117  20.18918   22.649866  13.279613  20.037376  20.03738
 20.037376  19.816792  19.599955  13.462666  21.128412  18.563026
 22.99941   19.549397  19.115335  20.189186  19.681204  15.394352
 19.960075  22.503088  20.388117  14.623029  20.189186  15.735108
 19.960075  19.603434  20.03738   19.816795  19.960075  19.532413
 18.302105  19.816792  19.816792  19.816793  18.687181  19.103857
  9.896012  20.03738   14.8798895 19.816795  15.797846  18.659668
 20.895634  18.659668  19.816795  19.483389  18.659668  20.013437 ]
2025-06-02 15:43:24,748 - DEBUG - Edge reconstruction errors: [  4.545241    4.4582562  43.250786  ...  12.350805   12.350786
 534.25134  ]
2025-06-02 15:43:24,751 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154324_update_30.json
2025-06-02 15:43:24,751 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:24,759 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154324_update_30.pth and as latest_checkpoint.pth
2025-06-02 15:43:24,759 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.0043
2025-06-02 15:43:24,760 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 15:43:24,760 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.4629, MLP Score: 0.0056
2025-06-02 15:43:24,760 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.8026, MLP Score: 0.0037
2025-06-02 15:43:24,760 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.7353, MLP Score: 0.0051
2025-06-02 15:43:24,760 - WARNING -   Node ID: 151.101.0.223, Recon Error: 30.8325, MLP Score: 0.0037
2025-06-02 15:43:24,761 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.5932, MLP Score: 0.0050
2025-06-02 15:43:24,761 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:24,761 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2507, MLP Score: 0.0000
2025-06-02 15:43:24,761 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9538, MLP Score: 0.0000
2025-06-02 15:43:24,762 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0529, MLP Score: 0.0000
2025-06-02 15:43:24,762 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7526, MLP Score: 0.0000
2025-06-02 15:43:24,762 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7513, MLP Score: 0.0000
2025-06-02 15:43:24,762 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-02 15:43:24,762 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:43:24,762 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:43:24,763 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:43:24,789 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:43:24,812 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:43:24,812 - INFO - Processing node updates/additions.
2025-06-02 15:43:24,817 - INFO - Processing edge updates/additions.
2025-06-02 15:43:24,830 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:24,831 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:24,832 - DEBUG - Updated graph - Nodes: 799, Edges: 1718
2025-06-02 15:43:24,832 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:24,834 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:24,846 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-02 15:43:24,848 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:24,849 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-02 15:43:24,853 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-02 15:43:24,856 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:24,862 - DEBUG - Initial edge attributes tensor shape: torch.Size([1718, 10])
2025-06-02 15:43:24,867 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:24,873 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1718, 10])
2025-06-02 15:43:24,873 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:24,874 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:24,875 - INFO - Updated main graph to 799 nodes and 1718 edges.
2025-06-02 15:43:24,875 - INFO - Performing online update...
2025-06-02 15:43:24,876 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:24,876 - DEBUG - Updated RunningStats: new_mean=0.942642110264984, new_var=17400000000160.617, new_n=1770
2025-06-02 15:43:24,877 - DEBUG - Updated RunningStats: new_mean=0.9393541601867237, new_var=17700000000018.457, new_n=1800
2025-06-02 15:43:24,877 - DEBUG - Updated RunningStats: new_mean=43.81154408349425, new_var=5800000191396.974, new_n=590
2025-06-02 15:43:24,877 - DEBUG - Updated RunningStats: new_mean=43.90972650801738, new_var=5900000215767.278, new_n=600
2025-06-02 15:43:24,877 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:24,877 - DEBUG - Online update step: 1/25
2025-06-02 15:43:24,877 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,877 - DEBUG - Online update step: 2/25
2025-06-02 15:43:24,877 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,877 - DEBUG - Online update step: 3/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 4/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 5/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 6/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 7/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 8/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 9/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 10/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 11/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 12/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 13/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 14/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 15/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 16/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 17/25
2025-06-02 15:43:24,878 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,878 - DEBUG - Online update step: 18/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 19/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 20/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 21/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 22/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 23/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 24/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - DEBUG - Online update step: 25/25
2025-06-02 15:43:24,879 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:24,879 - WARNING - No successful steps during online update.
2025-06-02 15:43:24,880 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], current edge mean: [-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:43:24,880 - DEBUG - Node drift difference: 0.0216, Edge drift difference: 0.0033
2025-06-02 15:43:24,881 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], edge=[-8.8817167e-09  4.6108963e+02  0.0000000e+00  0.0000000e+00
 -3.0530900e-09 -2.2204292e-09  2.2204292e-09  5.5510729e-10
 -3.8857508e-09  1.1102146e-09]
2025-06-02 15:43:24,882 - DEBUG - Updated reference std: node=[0.         0.         1.0006263  1.0006263  0.         0.
 0.         1.0006263  1.0006263  1.0006263  1.0006263  1.0006263
 1.0016909  0.28879055 0.37459666 0.5672931  1.0006264  3.0588543
 2.925534   1.5144387  0.37459666 0.2476422  1.0006263  1.0006263
 0.         0.         0.         0.         1.0006263  1.0006263 ], edge=[  1.0002911 490.02286     0.          0.          1.0002911   1.0002911
   1.0002912   1.0002911   1.0002911   1.0002911]
2025-06-02 15:43:24,882 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:24,882 - INFO - Running anomaly detection...
2025-06-02 15:43:24,882 - INFO - Starting anomaly detection.
2025-06-02 15:43:24,951 - DEBUG - Node reconstruction errors: [20.547464  12.557691  19.812761  32.151833  15.58106   17.135122
 19.059649  26.530699  26.530693  29.532276  26.530699  19.341433
 24.928867  11.392196  27.363321  26.862972  19.59989   26.86297
 26.949743  26.10734   23.097769  27.363321  19.170656  13.464091
 26.79344   30.552181  26.793436  14.751429  25.844484  26.793436
 15.367672  16.688175  14.620794  31.472218  30.587227  19.10724
 16.32232   26.107344  15.648436  12.339105  32.36865   26.605925
 26.107344  28.65325   11.959093  11.289438  32.026833  11.3184185
 25.131258  31.298944  39.76592   29.449947  29.860619  23.133322
 21.372644  15.029814  21.400879  24.63486   24.901907  20.58758
 13.442154  21.82829   25.866194  11.526287  26.151968  21.372643
 22.298786  21.372646  25.866194  25.866194  18.44471   19.228815
 22.985443  17.815636  15.617048  19.373621  25.252874  18.917034
 16.602924  17.675377  29.073656  17.700487   8.128825  24.117664
 15.216041  10.916608  17.887781  15.100206  17.845768  16.497168
 24.836365  15.098328  15.413529  16.688757  21.391455  35.87315
 28.30002   15.559028  23.897387  21.834532  18.310696  28.30002
 29.205242  18.551037  10.787484  21.646276  11.363507  10.865331
 15.911463  25.688715  19.223978  27.847704  14.937933  15.674361
 18.145845  16.807528  17.987608  15.226236  17.305763  20.534948
 23.610432  13.652441  15.439832  12.22536   16.730755  20.534916
 13.222465  12.437099  14.937066  20.472065  26.051609  23.16969
 23.532831  15.693439  17.656776  21.666172  27.80378   24.43722
 11.41252   14.304678  20.856516  17.745827  23.107204  22.160023
 21.257244  18.363111  17.98761   24.290686  22.918104  16.976366
 29.395256  10.43564   17.435986  23.169687  14.265791  14.559647
 22.628168  16.316526  18.310703  30.388205  21.257244  11.912572
 22.628162  26.05161   17.94164   15.577988  18.114092  16.591866
 11.238549  16.120464  17.563776  20.136105  24.68499   29.652138
 15.230887  13.145934  16.528263  16.611364  17.831959  17.831964
 21.014868  16.153355  21.81809   16.117989  13.663372  14.927711
 22.495283  17.560059  21.034065  21.98005   14.837252  16.31297
 22.83109   23.689732  11.412524  25.153069   8.092683  20.54235
 15.558933  20.645592  21.333195  22.628166  15.2796545 15.0876255
 18.043121  11.397214  25.078356  16.330973  23.359343  17.09269
 17.491203  17.86838   26.83619   15.660801  15.498478  22.628304
 15.667311  17.987612  17.71841   23.689732  15.157435  22.495283
 24.015324  26.83619   22.628166  15.318955  14.754369  24.254347
 17.12675   13.940878  11.41063   16.2278    15.170648  17.987614
 17.98761   25.153074  16.035357  24.015324  22.628168  23.748373
 14.303861  15.801135  23.559977  15.640837  23.535364  15.459784
 16.894308  15.951058  23.559977  19.180098  24.68499   24.688349
 17.718407  15.910453  15.673029  18.25704   21.980053  22.23039
 20.416851  17.831963  16.101053  14.805569  26.183083  20.417377
 14.908087  20.829134  17.200432  15.36828   17.200434  16.269857
 16.334476  15.519849  16.224483  23.49845   17.632896  17.831963
 21.878271  18.560509  21.014868  15.375508  14.643504  22.344717
 16.29713   29.280989  14.970803  27.223017  14.541047  14.289075
 16.153358  11.247835  18.865353  25.9246    23.85877   23.535364
  9.484942  21.363747  15.729343  17.831905  25.153074  10.425425
 16.12752   23.152203  17.198107  14.969204  23.1522    23.1522
 23.152203  17.544128  22.644384  23.152205  23.1522    13.391933
 23.152203  21.37781   10.514012  16.607838  16.257046  14.909082
 26.142742  24.655315  16.874285  19.124657  17.510588  17.198109
 10.401007  15.806563  23.254326  17.544128  17.007156  17.00715
 17.799109  24.547636  23.152203  17.632896  23.152205  17.544128
 19.126888  24.01883   23.254326  23.254328  23.152203  23.394281
 23.254326  15.09518   16.016508  15.207724  17.198109  26.675852
 17.66867   16.796545  23.1522    16.38001   14.752758  15.508224
 22.874071  21.98005   21.692476  23.1522    23.779842  23.94036
 17.491205  21.201258  20.819181  15.806614  17.198103  19.211538
 22.883642  13.463252  17.435263  16.816664  15.616282  15.896865
 14.898342  14.127738  16.681166  15.508244  23.37911   22.66669
 15.623973  23.1522    17.198109  11.4367695 21.395111  15.935868
 11.197584  15.269543  21.918474  11.45801   17.94569   23.152205
 20.093449  16.504702  16.983253  16.413206  17.529577  17.529575
 17.529577  21.866547  22.57112   21.80992   20.83681   18.58134
 17.529573  22.571127  16.807482  16.983244  14.96921   20.089312
 16.983252  11.61641   17.529577  16.983252  22.571127  17.529577
 17.529577  20.891012  22.8026    17.529577  23.37913   19.864569
 20.006435  19.654482  16.739927  20.85257   13.934867  18.471731
 19.654478  17.992258  14.377366  12.837982  16.869844  19.923168
 16.47854   17.352795  17.529577  17.529577  20.83681   16.78684
 14.145061  20.645012  20.160307  21.507149  17.321032  20.966866
 20.54695   13.424086  15.025928  19.956326  23.430359  20.770197
 14.801057  22.268347  21.202837  22.051392  22.268347  19.453579
 20.85257   21.282228  24.280949  16.739927  17.03874   21.740938
 20.448587  16.250116  20.448586  21.740942  22.804918  15.722797
 13.133404  23.994183  22.804922  17.03874   15.284583  13.622989
 15.797077  16.739788  15.722795  17.038736  21.818615  21.664347
 25.741758  13.912377  21.00971   19.956322  13.944257  20.169807
 22.268347  10.896615  24.493048  13.622984  15.928269  21.818607
 15.026108  21.881046  16.40666   21.282228  16.688871  21.13283
 22.05139   21.664347  18.928328  21.881046  18.928328  21.263075
 22.276812  14.17085   21.60397   14.247727  21.202833  22.26835
 13.470446  21.045855  21.045849  20.546946  16.425365  20.546944
 21.60397   16.471045  26.767065  15.490123  16.471045  21.507149
 21.60397   24.891853  22.276808  16.688871  24.076197  12.941786
 16.471045  16.655504  20.160307  22.051394  22.051392  21.664347
 16.688871  16.623259  15.876504  16.287601  22.051392  17.40897
 22.051392  17.408972  18.78602   16.471043  19.773954  25.793585
 10.362881  21.576313  16.136538  21.576315  21.576313  21.576315
 21.576313  21.576313  21.576315  21.576313  16.427181  19.32589
 24.03784   21.576313  21.576313  21.576313  21.576315  21.576315
 21.576315  21.576315  21.576315  21.576315  16.132635  21.576315
 21.576313  13.427339  21.576313  11.340205  21.002605  22.051392
 22.377935  15.856799  35.153088  35.153088  16.71419   22.377935
 22.051392  21.603975  21.60397   22.051392  21.603975  23.521051
 18.239275  21.576315  21.507149  22.051392  21.04585   22.051392
 22.051392  20.338348  22.051394  21.60397   22.051392  22.051392
 16.471043  21.603971  22.051392  21.603971  22.051392  22.051392
 22.051392  16.149452  16.406664  16.406666  21.576315  20.1366
 20.446589  22.051394  21.60397   14.952872  21.576313  21.60397
 16.349157  21.182484  22.051394  22.051392  15.421541  16.089968
 15.607648  22.051392  16.427181  20.338348  21.60397   12.318048
 21.576315  21.60397   16.471043  21.576315  21.576315  16.427185
 20.338348  22.05139   19.382168  17.462744  14.7112875 16.089968
 23.738636  16.818111  16.818113  20.551119  19.750103  21.576313
 20.56698   15.453753  16.089968  16.008963  21.788263  21.342773
 21.134296  21.134296  21.134296  21.134296  21.134296  15.824727
 15.10997   21.134296  21.134296  21.576313  19.924065  21.576313
 16.818111  15.792098  16.818111  21.234837  16.818113  14.869097
 16.132639  18.758156  16.132643  21.576313  16.818111  21.804356
 21.155876  21.155878  21.134296  21.804358  15.582383  20.814295
 21.576313  21.576313  21.134296  21.34278   21.155876  20.32548
 21.34278   20.113611  15.824729  13.422848  20.113611  13.166385
 15.45908   21.342777  19.048925  21.357452  20.916204  20.916203
 16.173914  20.718697  16.480106  21.342773  21.34278   21.342773
 20.904451  21.342777  21.34278   20.916203  21.342777  21.34278
 21.34278   15.437481  20.929482  14.939787  14.598707  16.39503
 19.029371  20.093876  14.671699  19.929008  20.513859  20.532682
 20.099552  18.855175  18.855175  20.916203  12.974213  14.762165
 20.51392   20.316732  22.768436  13.311966  20.156485  20.156487
 20.156483  19.943874  19.742878  13.530431  21.30664   18.743702
 23.167818  19.71041   19.275303  20.31673   19.838705  15.498523
 20.099552  22.680225  20.51392   14.762193  20.316736  15.846234
 20.099552  19.716162  20.156483  19.943878  20.099552  19.6818
 18.45951   19.943874  19.943878  19.94388   18.875467  15.137744
  9.977692  20.156485  15.006044  19.943874  15.8953285 18.8643
 21.014194  18.864302  19.943874  19.612675  18.8643    20.1377
 19.612679  18.8643    35.430542  22.497072  15.444163  18.8643
 15.444163  18.059196  22.107473  14.578043  19.612679  19.801697
 19.801697  14.578043  17.7428    19.612679  18.8643    22.107473
 18.864307 ]
2025-06-02 15:43:24,952 - DEBUG - Edge reconstruction errors: [  4.5495453   4.463644   43.25058   ...  12.350588  534.2511
  12.350681 ]
2025-06-02 15:43:24,954 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154324_update_31.json
2025-06-02 15:43:24,955 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:24,959 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154324_update_31.pth and as latest_checkpoint.pth
2025-06-02 15:43:24,959 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.0044
2025-06-02 15:43:24,959 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:43:24,959 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.1518, MLP Score: 0.0054
2025-06-02 15:43:24,959 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.5522, MLP Score: 0.0037
2025-06-02 15:43:24,959 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.4722, MLP Score: 0.0050
2025-06-02 15:43:24,959 - WARNING -   Node ID: 151.101.0.223, Recon Error: 30.5872, MLP Score: 0.0037
2025-06-02 15:43:24,959 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.3686, MLP Score: 0.0049
2025-06-02 15:43:24,959 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:24,960 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2505, MLP Score: 0.0000
2025-06-02 15:43:24,960 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9537, MLP Score: 0.0000
2025-06-02 15:43:24,960 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0527, MLP Score: 0.0000
2025-06-02 15:43:24,960 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7523, MLP Score: 0.0000
2025-06-02 15:43:24,960 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7513, MLP Score: 0.0000
2025-06-02 15:43:24,971 - DEBUG - Embedding standard deviations before t-SNE: [1.4169335  0.02720604 0.8554223  1.5308626  0.0349848  0.6563896
 0.9812794  0.5155942  0.715591   2.6554196  2.0043213  2.0114696
 1.2682675  0.70074487 1.2387478  1.1584518  0.14869833 0.7873489
 0.         1.3176419  0.30050623 1.6562054  0.         0.27774447
 0.58213055 0.89233303 0.02653903 1.4569743  2.0240037  0.
 1.2986088  1.2190267 ]
2025-06-02 15:43:26,458 - INFO - Embeddings visualization saved to vis/embeddings_31_updates_20250602_154324.png
2025-06-02 15:43:26,459 - INFO - Performing visualization of node and edge features.
2025-06-02 15:43:26,460 - INFO - Starting visualization of node features.
2025-06-02 15:43:26,460 - INFO - Graph has 799 nodes and 30 features.
2025-06-02 15:43:26,460 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:43:26,460 - INFO - Calculating feature statistics:
2025-06-02 15:43:26,460 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,460 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,460 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-2.2631247), 'max': np.float32(2.2575989)}
2025-06-02 15:43:26,461 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.1910229), 'max': np.float32(2.3384998)}
2025-06-02 15:43:26,461 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,461 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,461 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,461 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4509027), 'max': np.float32(2.2177732)}
2025-06-02 15:43:26,461 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1530161), 'max': np.float32(0.86729056)}
2025-06-02 15:43:26,461 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(2.8646037e-08), 'std': np.float32(1.0), 'min': np.float32(-9.285732), 'max': np.float32(0.11055708)}
2025-06-02 15:43:26,461 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0355306), 'max': np.float32(1.4744775)}
2025-06-02 15:43:26,461 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4472969), 'max': np.float32(3.1356149)}
2025-06-02 15:43:26,461 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2966208), 'std': np.float32(1.0010638), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:43:26,461 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9574468), 'std': np.float32(0.28860977), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:43:26,461 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:26,461 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.394243), 'std': np.float32(0.566938), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:43:26,462 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11055708), 'max': np.float32(9.285733)}
2025-06-02 15:43:26,462 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.436796), 'std': np.float32(3.0569396), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:43:26,462 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7058825), 'std': np.float32(2.923703), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:26,462 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5969963), 'std': np.float32(1.5134907), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:26,462 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:43:26,462 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.991239), 'std': np.float32(0.24748717), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:43:26,462 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.3871698e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13463752), 'max': np.float32(15.2332735)}
2025-06-02 15:43:26,462 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-4.7743396e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14744195), 'max': np.float32(6.78233)}
2025-06-02 15:43:26,462 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,462 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,462 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,462 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:26,462 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.98786825), 'max': np.float32(8.7366495)}
2025-06-02 15:43:26,462 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.7292073e-08), 'std': np.float32(1.0), 'min': np.float32(-1.096277), 'max': np.float32(4.459275)}
2025-06-02 15:43:26,475 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c098a3560>
2025-06-02 15:43:26,688 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:43:26,783 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:43:26,819 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:43:28,298 - INFO - Node feature visualization saved to vis/node_features_20250602_154326.png
2025-06-02 15:43:28,298 - INFO - Finished visualization of node features.
2025-06-02 15:43:28,298 - INFO - Performing additional feature analysis:
2025-06-02 15:43:28,298 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:43:28,300 - INFO - Starting visualization of edge features.
2025-06-02 15:43:28,301 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:43:28,301 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:28,301 - INFO - Calculating edge feature statistics:
2025-06-02 15:43:28,302 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:43:28,302 - INFO - - count: {'name': 'count', 'unique': 28, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.04193423), 'max': np.float32(32.319332)}
2025-06-02 15:43:28,302 - INFO - - dst_port: {'name': 'dst_port', 'unique': 17, 'mean': np.float32(461.08963), 'std': np.float32(489.88022), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:43:28,302 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:28,302 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:43:28,302 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1147, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.07043896), 'max': np.float32(30.815102)}
2025-06-02 15:43:28,302 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1215, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06402924), 'max': np.float32(31.744682)}
2025-06-02 15:43:28,302 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 393, 'mean': np.float32(2.2204292e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052897945), 'max': np.float32(32.174114)}
2025-06-02 15:43:28,302 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1192, 'mean': np.float32(1.1102146e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0993745), 'max': np.float32(26.157906)}
2025-06-02 15:43:28,302 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1209, 'mean': np.float32(-4.9959654e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09994788), 'max': np.float32(25.52512)}
2025-06-02 15:43:28,302 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 446, 'mean': np.float32(-1.1102146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.065954395), 'max': np.float32(31.160322)}
2025-06-02 15:43:28,325 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08eead20>
2025-06-02 15:43:28,450 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:43:28,462 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08e906b0>
2025-06-02 15:43:28,542 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:43:28,670 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:43:28,798 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:43:28,815 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:43:28,824 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:43:30,413 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154328.png
2025-06-02 15:43:30,413 - INFO - Finished visualization of edge features.
2025-06-02 15:43:30,413 - INFO - Performing additional edge feature analysis:
2025-06-02 15:43:30,413 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:43:30,413 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:43:30,415 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:43:30,415 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:43:30,415 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:43:30,691 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154330_summary.png
2025-06-02 15:43:30,923 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154330_pca_3d.png
2025-06-02 15:43:31,107 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154330_pca_variance.png
2025-06-02 15:43:31,108 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:43:31,108 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-02 15:43:31,108 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:43:31,108 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:43:31,108 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:43:31,473 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:43:31,492 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:43:31,492 - INFO - Processing node updates/additions.
2025-06-02 15:43:31,498 - INFO - Processing edge updates/additions.
2025-06-02 15:43:31,509 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:31,509 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:31,510 - DEBUG - Updated graph - Nodes: 805, Edges: 1734
2025-06-02 15:43:31,510 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:31,511 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:31,519 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-02 15:43:31,521 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:31,521 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-02 15:43:31,523 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-02 15:43:31,524 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:31,528 - DEBUG - Initial edge attributes tensor shape: torch.Size([1734, 10])
2025-06-02 15:43:31,529 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:31,529 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1734, 10])
2025-06-02 15:43:31,529 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:31,529 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:31,530 - INFO - Updated main graph to 805 nodes and 1734 edges.
2025-06-02 15:43:31,530 - INFO - Performing online update...
2025-06-02 15:43:31,530 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:31,531 - DEBUG - Updated RunningStats: new_mean=0.9429041022205888, new_var=18000000000160.73, new_n=1830
2025-06-02 15:43:31,531 - DEBUG - Updated RunningStats: new_mean=0.9397072950483281, new_var=18300000000018.41, new_n=1860
2025-06-02 15:43:31,531 - DEBUG - Updated RunningStats: new_mean=43.94550595787562, new_var=6000000191251.641, new_n=610
2025-06-02 15:43:31,531 - DEBUG - Updated RunningStats: new_mean=44.0347084341112, new_var=6100000213737.563, new_n=620
2025-06-02 15:43:31,531 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:31,531 - DEBUG - Online update step: 1/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,531 - DEBUG - Online update step: 2/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,531 - DEBUG - Online update step: 3/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,531 - DEBUG - Online update step: 4/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,531 - DEBUG - Online update step: 5/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,531 - DEBUG - Online update step: 6/25
2025-06-02 15:43:31,531 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 7/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 8/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 9/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 10/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 11/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 12/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 13/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 14/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 15/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 16/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 17/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 18/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 19/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 20/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 21/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 22/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 23/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 24/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,532 - DEBUG - Online update step: 25/25
2025-06-02 15:43:31,532 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:43:31,533 - WARNING - No successful steps during online update.
2025-06-02 15:43:31,533 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], current edge mean: [ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:43:31,533 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0003
2025-06-02 15:43:31,534 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], edge=[ 3.2999112e-09  4.6092273e+02  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.1999407e-09  4.3998813e-09 -2.7499258e-09
 -1.2374667e-09  0.0000000e+00]
2025-06-02 15:43:31,534 - DEBUG - Updated reference std: node=[0.         0.         1.0006217  1.0006217  0.         0.
 0.         1.0006217  1.0006218  1.0006217  1.0006217  1.0006217
 1.0000262  0.28773427 0.3710666  0.5675718  1.0006218  3.0480378
 2.9194205  1.52196    0.3710666  0.24671759 1.0006217  1.0006217
 0.         0.         0.         0.         1.0006217  1.0006217 ], edge=[  1.0002885 487.75858     0.          0.          1.0002885   1.0002885
   1.0002885   1.0002885   1.0002885   1.0002885]
2025-06-02 15:43:31,534 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:43:31,534 - INFO - Running anomaly detection...
2025-06-02 15:43:31,534 - INFO - Starting anomaly detection.
2025-06-02 15:43:31,541 - DEBUG - Node reconstruction errors: [20.264109  12.686196  19.88062   32.001232  15.593642  17.155708
 19.162828  26.403593  26.403597  29.421257  26.403597  19.245117
 25.07725   11.297018  27.221502  26.692009  19.561975  26.692009
 26.806683  25.96799   23.073439  27.221502  19.254004  13.467435
 26.678698  30.451475  26.6787    14.656691  25.711555  26.678694
 15.399671  16.735094  14.666909  31.341145  30.493061  19.219185
 16.362377  25.96799   15.670623  12.378511  32.2766    26.495996
 25.96799   28.700684  11.986882  10.90665   32.063828  11.352435
 25.02784   31.498085  39.939827  29.33962   29.752485  23.142475
 21.37807   15.063695  21.548756  24.553984  24.829113  20.68477
 13.439211  21.910511  25.787384  11.576523  26.064985  21.378065
 22.303503  21.378061  25.787386  25.787384  18.54386   19.177479
 23.009449  17.798695  15.520499  19.323368  25.399797  18.8974
 16.635387  17.661325  29.008183  17.707468   7.833438  24.227299
 15.2772    10.9632    17.931398  15.153123  17.833323  16.55649
 24.800348  15.120569  15.428639  16.711369  21.418518  29.786823
 28.264318  15.610171  23.889303  21.860666  18.297924  28.26431
 29.221369  18.597378  10.846725  21.674774  11.252673  10.542495
 15.909417  24.290005  18.382051  27.834188  14.099562  15.674686
 18.145136  16.854057  17.99304   15.242967  17.308372  20.59587
 23.623863  13.706569  15.461496  12.2586975 16.763073  20.595837
 13.236683  12.460588  14.990614  20.538073  26.076603  23.18092
 23.495012  15.727151  17.673883  21.695793  27.864637  24.406704
 11.473918  14.28461   20.948742  17.78488   23.141256  22.212067
 21.339617  15.792896  17.993042  24.25622   22.92768   16.991274
 29.363535  10.488921  17.440641  23.180922  13.8143425 14.5833435
 22.659063  16.357311  18.297922  30.354942  21.339619  11.960855
 22.659063  26.076603  17.947195  15.581346  18.11921   16.616648
 11.294147  16.167265  17.551886  20.213776  24.65231   29.72714
 15.289099  12.922426  16.565605  16.668882  17.839422  17.839418
 21.062725  16.138638  21.815063  16.113155  13.714084  14.99035
 22.546167  17.571482  21.087177  22.030518  14.748369  16.346912
 22.97312   23.679518  11.473922  25.2196     8.099009  20.6552
 15.563569  20.712759  21.372866  22.65906   15.291867  14.996845
 15.7932625 10.869951  25.0959    16.098288  23.37457   17.11017
 17.50941   17.876299  26.834225  15.704212  15.570796  22.6786
 15.732937  17.99304   17.727697  23.679525  15.164321  22.546165
 24.006971  26.83424   22.65906   15.389395  14.783484  24.220194
 17.128487  14.010944  11.468268  16.272451  15.229116  17.99304
 17.99304   25.2196    16.078608  24.006971  22.659061  23.879112
 14.339329  15.851995  23.551105  15.7047825 23.526276  15.520388
 16.926922  16.025547  23.5511    19.287714  24.65231   24.654594
 17.727697  15.962556  15.737206  18.257     22.030516  22.282759
 20.532427  17.839415  16.151136  14.801287  26.176846  20.476624
 14.974672  20.876585  17.220495  15.442506  17.220499  16.321873
 16.352667  15.534594  16.260155  23.634493  17.653479  17.839417
 21.89893   18.560446  21.062727  14.877104  14.688444  22.346857
 16.337477  29.278605  15.030452  27.2177    14.538767  14.329371
 16.138645  11.2326975 18.980907  25.979586  23.872993  23.526276
  9.472807  21.448845  15.7836    17.839365  25.2196    10.480072
 16.165897  23.164656  17.23211   15.0572815 23.16466   23.164656
 23.164656  17.565828  22.67643   23.16466   23.16466   13.437792
 23.16466   21.448093  10.581687  16.637047  16.332447  14.94043
 26.167439  24.739017  16.907396  19.209883  17.51154   17.232107
 10.465927  15.812498  23.265299  17.56583   17.027086  17.027082
 17.821388  24.632524  23.164656  17.653475  23.164656  17.56583
 19.237001  24.01034   23.265299  23.265299  23.16466   23.38138
 23.2653    15.177362  16.061863  15.275176  17.232111  26.6934
 17.670532  16.80896   23.164656  16.427443  14.770954  15.58444
 22.881098  22.030518  21.757074  23.164656  23.768925  24.071465
 17.50941   21.26753   20.877478  15.860976  17.232111  19.359083
 22.916044  13.513629  17.45732   16.860928  15.670225  15.954379
 14.972626  14.177504  16.713047  15.58446   23.393375  22.679436
 15.6913    23.16466   17.232111  11.497519  21.465923  15.987776
 11.258836  14.926005  21.935762  11.508635  17.959604  23.164656
 20.118496  16.552135  17.01407   16.461279  17.560108  17.560106
 17.560102  21.907034  22.603163  21.8515    20.925444  18.611446
 17.560106  22.603168  16.84638   17.01407   15.057278  20.166782
 17.01407   11.648677  17.560108  17.014072  22.603167  17.560108
 17.560106  20.967802  22.811096  17.560108  23.393377  19.991789
 20.08318   19.780779  16.783567  20.940422  13.992306  18.598082
 19.780775  18.042236  14.403835  12.929028  16.89552   20.00166
 16.546135  17.384993  17.560108  17.560108  20.92544   16.818169
 14.196981  20.697475  20.279726  21.558445  17.136559  21.064548
 20.660498  13.47691   14.709439  20.073187  23.55239   20.857496
 14.882659  22.313969  21.274984  22.099108  22.313972  19.550627
 20.940424  21.353518  24.391417  15.373119  17.0718    21.798101
 20.547438  16.278906  20.547443  21.798103  22.838865  15.797029
 13.213232  24.098452  22.838865  17.071798  15.359434  13.640897
 15.849615  16.783436  15.373117  17.071798  21.88203   21.7208
 25.796612  13.953843  21.111338  20.073193  13.6529665 20.289501
 22.313972  10.967181  24.544685  13.640899  15.987245  21.88203
 15.103837  21.94703   16.45837   21.353518  16.73191   21.254007
 22.099108  21.720802  19.05189   21.947031  19.051891  21.303297
 22.325415  14.226277  21.666693  14.251434  18.975664  22.313969
 13.546941  21.114695  21.114693  20.660498  16.495525  20.660498
 21.666693  16.52581   26.863918  15.5411825 16.525808  21.558445
 21.666689  24.960148  22.325415  16.731909  24.159208  12.9645195
 16.525812  16.686642  20.279726  22.099112  22.09911   21.7208
 16.73191   16.663303  15.93012   16.324966  22.099112  17.438375
 22.099112  17.438375  18.595758  16.52581   19.886738  25.908712
 10.430169  21.641047  16.136753  21.641047  21.641047  21.641047
 21.641047  21.641047  21.641047  21.641047  16.483568  19.450468
 24.1033    21.641047  21.641047  21.641047  21.641047  21.641047
 21.641047  21.641047  21.641047  21.641047  16.197544  21.641047
 21.641047  13.488648  21.641047  11.410305  21.070248  22.099112
 22.454897  15.939325  35.241985  35.241985  16.743925  22.454897
 22.099112  21.666693  21.666693  22.099108  21.666693  23.648487
 18.36891   21.641047  21.558445  22.099108  21.114693  22.099112
 22.099112  20.449333  22.099112  21.666693  22.099108  22.099108
 16.525808  21.666689  22.099108  21.666695  22.099112  22.099112
 22.099112  16.201473  16.458372  16.458372  21.641047  20.201838
 20.51113   22.099112  21.666695  15.035592  21.641047  21.666693
 14.626334  21.25987   22.099112  22.099108  15.489574  16.139622
 15.681883  22.099112  16.48357   20.449327  21.666693  12.359147
 21.641047  21.666693  16.525812  21.641047  21.641047  16.483564
 20.449333  22.09911   19.457119  17.49295   14.578625  16.13962
 23.86315   16.872839  16.872835  20.632114  19.878252  21.641047
 20.650295  15.54739   16.13962   16.067682  21.85128   21.416355
 21.209696  21.209696  21.209696  21.209696  21.209696  15.896269
 15.192216  21.20969   21.209696  21.641047  20.045902  21.641047
 16.872839  15.851148  16.872837  21.293016  16.872835  14.937808
 16.197544  18.865608  16.197542  21.641047  16.872837  21.86576
 21.232683  21.232687  21.209696  21.86576   15.644058  20.883455
 21.641047  21.641047  21.209696  19.845865  21.232683  20.43485
 21.416355  20.234898  15.896267  13.29038   20.2349    13.220872
 15.530918  21.416355  19.192427  21.433313  21.00754   21.007538
 16.248878  20.810423  16.5444    21.416355  21.416355  21.416355
 20.998316  21.416355  21.416355  21.00754   21.416355  21.416355
 21.416355  15.507151  21.019918  15.026032  14.681808  16.46692
 19.173708  20.21395   14.765613  20.005806  20.621883  20.637775
 20.217272  18.968555  18.96855   21.007538  13.024659  14.841686
 20.62188   20.425018  22.877237  12.776349  20.268333  20.268333
 20.268333  20.05846   19.867228  13.605991  21.441444  18.867344
 23.304804  19.841755  19.39728   20.425018  19.956852  15.562723
 20.217272  22.817606  20.62188   14.841719  20.425018  15.563549
 20.217274  19.825493  20.268333  20.058462  20.217268  19.799322
 18.583439  20.058462  20.05846   20.05846   19.01665   15.2066965
 10.015769  20.268328  15.083178  20.058458  15.965406  19.003271
 21.090914  19.003267  20.058462  19.73373   19.003271  20.252401
 19.73373   19.003271  35.66657   22.628025  15.531741  19.003271
 15.531744  18.202473  22.254969  14.665426  19.73373   19.922285
 19.922285  14.665425  17.874935  19.73373   19.003267  22.254969
 19.003271  19.625652  19.625652  19.625652  19.922289  19.625647
 19.625645 ]
2025-06-02 15:43:31,541 - DEBUG - Edge reconstruction errors: [  4.5823483   4.4757714  43.250816  ...  12.35083   534.25134
  12.350924 ]
2025-06-02 15:43:31,543 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154331_update_32.json
2025-06-02 15:43:31,543 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:31,546 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154331_update_32.pth and as latest_checkpoint.pth
2025-06-02 15:43:31,546 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.0044
2025-06-02 15:43:31,546 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 15:43:31,546 - WARNING -   Node ID: 3.131.239.162, Recon Error: 32.0012, MLP Score: 0.0053
2025-06-02 15:43:31,547 - WARNING -   Node ID: 103.102.166.224, Recon Error: 30.4515, MLP Score: 0.0036
2025-06-02 15:43:31,547 - WARNING -   Node ID: 142.250.198.196, Recon Error: 31.3411, MLP Score: 0.0049
2025-06-02 15:43:31,547 - WARNING -   Node ID: 151.101.0.223, Recon Error: 30.4931, MLP Score: 0.0036
2025-06-02 15:43:31,547 - WARNING -   Node ID: 13.107.5.93, Recon Error: 32.2766, MLP Score: 0.0048
2025-06-02 15:43:31,547 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:31,547 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 534.2509, MLP Score: 0.0000
2025-06-02 15:43:31,547 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 807.9537, MLP Score: 0.0000
2025-06-02 15:43:31,547 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.0548, MLP Score: 0.0000
2025-06-02 15:43:31,547 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 867.7526, MLP Score: 0.0000
2025-06-02 15:43:31,547 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 888.7513, MLP Score: 0.0000
2025-06-02 15:43:31,547 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-02 15:43:31,547 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:43:31,547 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:43:31,547 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:43:31,573 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:43:31,592 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:43:31,592 - INFO - Processing node updates/additions.
2025-06-02 15:43:31,597 - INFO - Processing edge updates/additions.
2025-06-02 15:43:31,606 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:31,607 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:31,608 - DEBUG - Updated graph - Nodes: 818, Edges: 1761
2025-06-02 15:43:31,608 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:31,609 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:31,617 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-02 15:43:31,619 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:31,619 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-02 15:43:31,624 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-02 15:43:31,625 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:31,631 - DEBUG - Initial edge attributes tensor shape: torch.Size([1761, 10])
2025-06-02 15:43:31,634 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:31,634 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1761, 10])
2025-06-02 15:43:31,634 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:31,635 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:31,636 - INFO - Updated main graph to 818 nodes and 1761 edges.
2025-06-02 15:43:31,636 - INFO - Performing online update...
2025-06-02 15:43:31,636 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:31,637 - DEBUG - Updated RunningStats: new_mean=0.9431474725346277, new_var=18600000000160.938, new_n=1890
2025-06-02 15:43:31,637 - DEBUG - Updated RunningStats: new_mean=0.9400313981362496, new_var=18900000000018.375, new_n=1920
2025-06-02 15:43:31,638 - DEBUG - Updated RunningStats: new_mean=44.066580447277005, new_var=6200000190832.944, new_n=630
2025-06-02 15:43:31,638 - DEBUG - Updated RunningStats: new_mean=44.1453949573977, new_var=6300000210496.594, new_n=640
2025-06-02 15:43:31,639 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:31,639 - DEBUG - Online update step: 1/25
2025-06-02 15:43:31,645 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:31,822 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:31,827 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:31,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:31,975 - DEBUG - Step 1: Loss=28.6188
2025-06-02 15:43:31,975 - DEBUG - Online update step: 2/25
2025-06-02 15:43:31,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:32,089 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:32,096 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:32,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:32,250 - DEBUG - Step 2: Loss=25.7317
2025-06-02 15:43:32,250 - DEBUG - Online update step: 3/25
2025-06-02 15:43:32,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:32,364 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:32,368 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:32,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:32,511 - DEBUG - Step 3: Loss=23.3767
2025-06-02 15:43:32,512 - DEBUG - Online update step: 4/25
2025-06-02 15:43:32,524 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:32,633 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:32,639 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:32,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:32,797 - DEBUG - Step 4: Loss=21.4513
2025-06-02 15:43:32,797 - DEBUG - Online update step: 5/25
2025-06-02 15:43:32,802 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:32,914 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:32,917 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:32,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:33,047 - DEBUG - Step 5: Loss=19.8483
2025-06-02 15:43:33,047 - DEBUG - Online update step: 6/25
2025-06-02 15:43:33,053 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:33,116 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:33,122 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:33,123 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:33,288 - DEBUG - Step 6: Loss=18.5038
2025-06-02 15:43:33,288 - DEBUG - Online update step: 7/25
2025-06-02 15:43:33,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:33,400 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:33,406 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:33,408 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:33,573 - DEBUG - Step 7: Loss=17.3657
2025-06-02 15:43:33,574 - DEBUG - Online update step: 8/25
2025-06-02 15:43:33,589 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:33,690 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:33,696 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:33,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:33,864 - DEBUG - Step 8: Loss=16.3832
2025-06-02 15:43:33,864 - DEBUG - Online update step: 9/25
2025-06-02 15:43:33,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:33,971 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:33,975 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:33,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:34,128 - DEBUG - Step 9: Loss=15.5094
2025-06-02 15:43:34,128 - DEBUG - Online update step: 10/25
2025-06-02 15:43:34,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:34,217 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:34,237 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:34,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:34,384 - DEBUG - Step 10: Loss=14.6974
2025-06-02 15:43:34,384 - DEBUG - Online update step: 11/25
2025-06-02 15:43:34,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:34,496 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:34,499 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:34,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:34,635 - DEBUG - Step 11: Loss=13.9004
2025-06-02 15:43:34,636 - DEBUG - Online update step: 12/25
2025-06-02 15:43:34,642 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:34,712 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:34,724 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:34,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:34,932 - DEBUG - Step 12: Loss=13.1461
2025-06-02 15:43:34,933 - DEBUG - Online update step: 13/25
2025-06-02 15:43:34,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:35,039 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:35,043 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:35,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:35,220 - DEBUG - Step 13: Loss=12.4404
2025-06-02 15:43:35,220 - DEBUG - Online update step: 14/25
2025-06-02 15:43:35,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:35,291 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:35,295 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:35,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:35,401 - DEBUG - Step 14: Loss=11.7660
2025-06-02 15:43:35,402 - DEBUG - Online update step: 15/25
2025-06-02 15:43:35,412 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:35,548 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:35,553 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:35,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:35,683 - DEBUG - Step 15: Loss=11.1444
2025-06-02 15:43:35,683 - DEBUG - Online update step: 16/25
2025-06-02 15:43:35,686 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:35,766 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:35,819 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:35,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:35,964 - DEBUG - Step 16: Loss=10.5600
2025-06-02 15:43:35,965 - DEBUG - Online update step: 17/25
2025-06-02 15:43:35,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:36,080 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:36,084 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:36,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:36,238 - DEBUG - Step 17: Loss=9.9487
2025-06-02 15:43:36,239 - DEBUG - Online update step: 18/25
2025-06-02 15:43:36,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:36,311 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:36,315 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:36,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:36,448 - DEBUG - Step 18: Loss=9.3895
2025-06-02 15:43:36,449 - DEBUG - Online update step: 19/25
2025-06-02 15:43:36,452 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:36,562 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:36,566 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:36,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:36,758 - DEBUG - Step 19: Loss=8.8680
2025-06-02 15:43:36,758 - DEBUG - Online update step: 20/25
2025-06-02 15:43:36,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:36,849 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:36,863 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:36,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:37,100 - DEBUG - Step 20: Loss=8.3603
2025-06-02 15:43:37,100 - DEBUG - Online update step: 21/25
2025-06-02 15:43:37,109 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:37,218 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:37,223 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:37,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:37,431 - DEBUG - Step 21: Loss=7.8656
2025-06-02 15:43:37,432 - DEBUG - Online update step: 22/25
2025-06-02 15:43:37,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:37,544 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:37,549 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:37,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:37,757 - DEBUG - Step 22: Loss=7.3864
2025-06-02 15:43:37,758 - DEBUG - Online update step: 23/25
2025-06-02 15:43:37,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:37,869 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:37,875 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:37,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:38,119 - DEBUG - Step 23: Loss=6.9223
2025-06-02 15:43:38,120 - DEBUG - Online update step: 24/25
2025-06-02 15:43:38,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:38,229 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:38,234 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:38,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:38,531 - DEBUG - Step 24: Loss=6.4725
2025-06-02 15:43:38,532 - DEBUG - Online update step: 25/25
2025-06-02 15:43:38,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:38,631 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:38,637 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:38,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:38,844 - DEBUG - Step 25: Loss=6.0364
2025-06-02 15:43:38,845 - INFO - Online update finished. Average loss: 13.8277, Learning rate: 0.001000
2025-06-02 15:43:38,846 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], current edge mean: [-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:43:38,846 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0010
2025-06-02 15:43:38,847 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], edge=[-2.1662108e-09  4.6042645e+02  0.0000000e+00  0.0000000e+00
  1.6246581e-09 -5.4155269e-10 -2.7077636e-09  4.7385862e-10
  3.2493161e-09 -1.0831054e-09]
2025-06-02 15:43:38,847 - DEBUG - Updated reference std: node=[0.         0.         1.0006118  1.0006118  0.         0.
 0.         1.0006119  1.0006119  1.0006118  1.0006118  1.0006118
 1.0033096  0.28548482 0.36737394 0.5672308  1.0006118  3.0404615
 2.9175723  1.5106635  0.36737394 0.24474926 1.0006118  1.0006118
 0.         0.         0.         0.         1.0006118  1.0006118 ], edge=[  1.000284  484.1051      0.          0.          1.0002841   1.0002841
   1.0002841   1.0002841   1.0002841   1.0002841]
2025-06-02 15:43:38,848 - INFO - Online update complete. Loss: 13.8277
2025-06-02 15:43:38,848 - INFO - Running anomaly detection...
2025-06-02 15:43:38,848 - INFO - Starting anomaly detection.
2025-06-02 15:43:38,877 - DEBUG - Node reconstruction errors: [ 1.7619011   7.2384534  15.095218    1.5742443   2.4962122   2.2548
 14.583035    1.6723183   1.6723183   1.546674    1.6723179   1.8492584
 19.54134     2.843672    1.6483631   2.1224473   1.9506592   2.1224473
  5.048922    1.9580318   1.0088555   1.6483631   0.9280499   1.9828626
  1.5570545   1.396714    1.5570545   2.8022459   1.4782244   1.5570544
  5.5048985   2.2318025   2.6625469   1.4045777   1.3872398   1.042584
  2.2537475   1.9580318   2.528713    2.3994875   1.2617255   1.4946383
  1.9580323   1.1361878   2.2989786   2.0284207   1.5850514   2.0660002
  1.3071063   2.3446507   8.753827    1.1491005   1.2333034   4.502192
  0.86333776  2.0803537  10.497281    1.6935165   4.732762    4.579271
  1.392453    1.1743934   1.3619536   2.5098555   1.3375127   0.86333764
  0.83111495  0.86333853  1.3619535   1.3619535   0.8098501   1.9661354
  0.7991864   2.2572246   2.319594    2.0100265   1.2771114   1.892231
  1.9819399   2.0746055   1.0482409   1.8011061   3.9193633   4.3628798
  2.159404    2.3347485   1.8835182   2.1432316   2.0926936   1.7660294
  1.1508416   2.4354188   1.7075602   1.9780375   0.69780254  7.631951
  0.9768736   1.9774076   1.1089927   0.78336495  1.816755    0.97687364
  0.91480434  1.8335024   2.450194    0.7538307   2.3750257   1.789651
  1.6850654   1.7061121   1.4506003   0.95129085  2.327506    2.1307619
  1.8117962   1.7548665   1.7749896   2.3189805   2.1545317   0.64584905
  1.0310909   1.9228883   2.0103066   1.9332496   1.9575706   0.6458458
  1.8077762   1.358262    2.1300948   1.0480144   0.6753973   0.769173
  3.5200403   2.2132974   1.74955     0.7530678   0.92350835  1.1568971
  1.9137627   2.8549063   0.67842996  1.8120826   1.006939    0.90095305
  0.6628571   1.9961318   1.77499     0.9129931   0.72842366  1.9673226
  1.4878728   2.6575077   2.1334105   0.769173    2.656104    2.3896904
  0.71887845  1.7780697   1.8167553   0.9868879   0.6628569   1.4412156
  0.71887845  0.6753973   1.7779076   2.347078    1.883624    1.9501165
  1.5898527   1.9578918   2.038308    0.6466213   1.1200602   8.549786
  2.0234373   5.1878953   1.9565505   1.7616004   1.7525977   1.7525982
  0.7011407   1.7095444   1.1932169   2.1022737   2.5567143   2.0464926
  0.9664236   1.7542442   0.7019123   0.6586755   2.149284    2.1036055
  0.80714     0.8420939   1.9137574   0.6541213   3.5410457   1.2655714
  2.3388422   1.0123173   1.0403645   0.71887845  2.088692    2.1875017
  1.9725537   1.892569    0.7404112   3.2060118   1.0743965   2.0831997
  1.7246628   1.7510221   0.7656196   2.0149496   2.035448    1.0013717
  1.9396034   1.7749892   1.808429    0.8420939   2.2295291   0.9664236
  1.0465772   0.7656196   0.71887845  2.133261    2.3297591   0.92251796
  1.9704701   1.9353544   2.1207068   1.9311291   2.1834612   1.7749898
  1.7749895   0.6541213   1.9202014   1.0465772   0.71887845  1.0269815
  2.3624165   2.0062993   0.81854856  2.1817932   0.82609     2.0606897
  1.7020091   1.9054466   0.81854856  0.7387883   1.1200602   1.1272696
  1.808428    1.9514146   1.8916408   1.7885433   0.6586755   1.0134718
  1.0690792   1.7525985   1.9895815   2.0294504   1.2483938   0.6293279
  2.1750135   0.64784044  2.086338    5.3385878   2.0863378   1.7594204
  2.1031585   2.0235069   2.0148027   1.1808631   1.8261383   1.752598
  1.0041989   1.9797789   0.7011407   2.1124878   2.7971544   1.0349804
  1.9183809   0.953377    2.1373742   0.94494605  2.8614721   1.5453187
  1.7095445   2.666473    0.730884    0.8530214   0.735309    0.82609
  3.297671    1.0167954   1.9628026   1.7525916   0.6541213   2.6117663
  1.8991357   1.0307145   1.7917123   2.1346908   1.0307145   1.0307145
  1.0307145   1.8311086   1.0051864   1.0307145   1.0307145   2.6800494
  1.0307145   0.6270534   2.0263555   1.9622648   1.7624198   1.7884804
  0.70970714  0.65070957  2.0472503   0.65240055  1.9836944   1.7917125
  1.6813773   2.0544238   1.046726    1.8311081   2.073052    2.073053
  2.0943248   0.6467863   1.0307145   1.826139    1.0307145   1.8311083
  0.6735001   1.0527803   1.046726    1.046726    1.0307145   1.2147584
  1.046726    2.1445882   2.17219     2.0861347   1.7917118   0.91597307
  2.1031723   1.9388268   1.0307145   1.6963334   2.0956595   1.9141917
  1.1749948   0.65867573  0.97806233  1.0307145   1.0842707   4.360074
  1.724663    0.61437386  1.001902    2.0082653   1.791714    7.930359
  0.9647693   2.6668653   1.7096074   1.6917527   1.9994079   1.9694546
  2.1294222   2.0820699   1.9924719   1.9142483   0.9931162   0.70279795
  1.9802328   1.0307145   1.7917126   1.553226    0.628772    1.9113221
  1.6306058   2.114328    0.78732026  2.2230399   1.8191447   1.0307145
  1.7672088   1.6974056   1.688146    1.6841298   1.7915859   1.7915859
  1.7915858   4.6535215   0.99049526  4.6240277   0.6248052   1.6831546
  1.7915858   0.9904951   1.7164468   1.6881452   2.1936564   0.627742
  1.6881465   1.9367145   1.7915859   1.688146    0.99049526  1.7915858
  1.7915859   1.1041845   1.1668521   1.7915859   0.99311614  1.0852672
  0.6362056   0.7083681   1.6808281   0.62774533  2.1230323   0.7795894
  0.8430115   1.6869327   1.592622    2.3305702   2.0187798   0.68185306
  1.7867038   1.6936921   1.7915859   1.7915858   0.6248052   1.911007
  2.0744772   0.9670981   1.1557617   0.64748734  1.330543    0.9389791
  0.9701925   2.2745576   3.0734916   0.6876973   0.7325601   0.6444029
  2.2198725   0.9381636   0.6485458   0.96275383  0.9381635   0.7224728
  0.6277453   0.6316248   0.8613842   1.8995987   1.6887915   0.6524709
  0.6414804   1.9206352   0.6414804   0.6524707   0.9643133   1.7808912
  1.8298562   0.67895263  0.9643133   1.688792    1.9964674   2.7315207
  1.9168514   1.6807655   1.899598    1.6887915   0.9235962   0.66967064
  0.83181494  2.4977667   0.94351566  0.6876973   2.3017318   1.0153644
  0.9381635   1.7642817   1.209833    2.7414486   1.7845663   0.9235962
  2.0088189   0.92715037  1.6924134   0.6316248   1.6871979   4.900154
  0.96275383  0.66967046  1.1073238   0.9271507   1.1073238   0.95137894
  0.9396469   1.9986306   0.9549934   3.0751274   0.87185967  0.9381636
  2.1650996   0.6337381   0.6337378   0.9701925   1.8042461   1.1557617
  0.9549934   1.7856597   0.8726275   2.046269    1.78566     0.64748734
  0.9549934   0.6899589   0.9396469   1.6871978   0.66496855  1.947146
  1.7856592   1.9093198   1.1557617   0.96275383  0.96275383  0.66967064
  1.6871978   1.6859537   2.0377321   1.9101506   0.96275383  1.705158
  0.96275383  1.7051586   1.275093    1.7856593   0.6970647   5.3710184
  1.9790459   0.96340066  3.299571    0.96340066  0.96340066  0.96340066
  0.9634004   0.96340066  0.96340066  0.96340066  1.8250226   0.77761847
  1.2478045   0.96340066  0.96340066  0.96340066  0.96340066  0.96340066
  0.96340066  0.96340066  0.96340066  0.9634004   1.8178099   0.96340066
  0.96340066  2.2527232   0.96340066  2.203342    1.0628333   0.96275383
  1.2429107   1.7872386   2.3590481   2.3590481   1.9171509   1.2429107
  0.96275383  0.95499325  0.9549934   0.96275383  0.95499295  0.95479274
  0.815968    0.963401    0.64748734  0.96275383  0.6337381   0.96275383
  0.96275383  1.0273526   0.96275383  0.9549934   0.96275383  0.96275383
  1.7856599   0.9549934   0.96275383  0.95499307  0.96275383  0.96275383
  0.96275383  2.003599    1.6924133   1.6924126   0.96340066  0.6903459
  1.2239552   0.96275383  0.95499325  2.1420095   0.96340066  0.95499307
  2.1540236   0.9635054   0.96275383  0.96275383  1.8016821   2.0377202
  1.7783309   0.96275383  1.8250233   1.0273526   0.9549934   2.0465844
  0.96340066  0.95499295  1.7856593   0.96340066  0.96340066  1.8250229
  1.0273522   0.96275383  1.0971557   1.7084496   2.2476618   2.0377202
  0.918112    1.8012565   1.8012565   1.0560248   1.0866717   0.96340066
  0.66548735  1.9181554   2.0377202   1.7208269   0.93304473  0.9568358
  0.9935699   0.9935699   0.9935699   0.9935699   0.9935699   1.8735957
  2.0337102   0.9935699   0.9935699   0.9634004   1.0865513   0.96340066
  1.8012562   2.0356295   1.8012562   1.1204941   1.8012562   2.144591
  1.8178113   1.1793544   1.8178109   0.96340066  1.8012562   0.9338779
  0.9713751   0.9713751   0.9935699   0.9338779   1.935973    1.1546538
  0.9634004   0.96340066  0.9935699   1.112417    0.9713751   1.0334222
  0.9568358   1.0497903   1.8735967   2.9602287   1.0497897   2.634429
  1.8170594   0.956836    0.8579107   0.9570914   1.0093565   1.0093567
  1.9005706   1.0518409   1.837883    0.9568358   0.9568358   0.9568358
  0.9740345   0.9568359   0.9568358   1.0093565   0.956836    0.9568359
  0.9568358   1.860819    1.0090706   2.082479    2.2591734   1.7877747
  0.9240731   1.0894027   2.1294172   5.004064    1.0896611   1.0890496
  1.1374128   0.9522869   0.9522869   1.0093567   2.806946    2.3610427
  1.0896634   1.1458308   1.513497    2.9393551   1.2114617   1.2114615
  1.2114617   1.2759238   1.2720209   2.5712743   1.2544348   1.3360425
  1.0920638   1.2844403   0.9350026   1.1458308   1.0743424   2.0324535
  1.1374124   0.99559647  1.0896634   2.3610504   1.1458308   2.032453
  1.2844403   1.4461963   1.2114615   1.275923    1.1374128   0.88219965
  1.1009027   1.275923    1.275923    1.275923    1.0939541   2.1628582
  6.6909666   1.2114617   2.2214916   1.2759236   1.9677948   1.1860142
  5.4244456   1.1860142   1.2759236   1.4235324   1.1860142   1.2079129
  1.4235324   1.1860142   9.44289     1.3634105   2.2570603   1.1860142
  2.2069123   1.2786231   1.5856154   2.5008724   2.2940383   1.3481534
  1.3481529   2.5008724   1.6973811   1.4235328   1.1860142   1.5856214
  1.1860142   1.5087949   1.5087949   1.5087949   1.3481529   1.5087949
  1.5087949   1.5087949   1.5087949   1.6056906   1.5087949   1.5087949
  1.5910516   1.457029    2.4838233   2.4838233   1.5087949   1.3461235
  1.6056912   1.5087951 ]
2025-06-02 15:43:38,878 - DEBUG - Edge reconstruction errors: [  5.2570453   5.2579856  44.25256   ...  13.352533  535.2529
  13.352534 ]
2025-06-02 15:43:38,880 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154338_update_33.json
2025-06-02 15:43:38,881 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:38,892 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154338_update_33.pth and as latest_checkpoint.pth
2025-06-02 15:43:38,892 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.4602
2025-06-02 15:43:38,892 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-02 15:43:38,892 - WARNING -   Node ID: 192.168.239.101, Recon Error: 7.2385, MLP Score: 0.7267
2025-06-02 15:43:38,892 - WARNING -   Node ID: 192.168.27.13, Recon Error: 15.0952, MLP Score: 0.6378
2025-06-02 15:43:38,893 - WARNING -   Node ID: 192.168.27.12, Recon Error: 14.5830, MLP Score: 0.7169
2025-06-02 15:43:38,893 - WARNING -   Node ID: 192.168.27.10, Recon Error: 19.5413, MLP Score: 0.7347
2025-06-02 15:43:38,893 - WARNING -   Node ID: 43.132.85.151, Recon Error: 5.0489, MLP Score: 0.5682
2025-06-02 15:43:38,893 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:43:38,893 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2526, MLP Score: 0.0000
2025-06-02 15:43:38,893 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9551, MLP Score: 0.0000
2025-06-02 15:43:38,893 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0562, MLP Score: 0.0000
2025-06-02 15:43:38,893 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7540, MLP Score: 0.0000
2025-06-02 15:43:38,893 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7531, MLP Score: 0.0000
2025-06-02 15:43:38,893 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-02 15:43:38,893 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:43:38,893 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:43:38,893 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 15:43:38,921 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:43:38,950 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 15:43:38,950 - INFO - Processing node updates/additions.
2025-06-02 15:43:38,957 - INFO - Processing edge updates/additions.
2025-06-02 15:43:38,972 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:38,973 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:38,974 - DEBUG - Updated graph - Nodes: 836, Edges: 1786
2025-06-02 15:43:38,974 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:38,976 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:38,993 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-02 15:43:38,995 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:38,996 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-02 15:43:38,998 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-02 15:43:39,000 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:39,005 - DEBUG - Initial edge attributes tensor shape: torch.Size([1786, 10])
2025-06-02 15:43:39,006 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:39,007 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1786, 10])
2025-06-02 15:43:39,007 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:39,007 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:39,008 - INFO - Updated main graph to 836 nodes and 1786 edges.
2025-06-02 15:43:39,008 - INFO - Performing online update...
2025-06-02 15:43:39,009 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:39,009 - DEBUG - Updated RunningStats: new_mean=0.9433641257131974, new_var=19200000000161.137, new_n=1950
2025-06-02 15:43:39,009 - DEBUG - Updated RunningStats: new_mean=0.940316357224152, new_var=19500000000018.273, new_n=1980
2025-06-02 15:43:39,010 - DEBUG - Updated RunningStats: new_mean=44.1754632219865, new_var=6400000191305.117, new_n=650
2025-06-02 15:43:39,010 - DEBUG - Updated RunningStats: new_mean=44.24691834900959, new_var=6500000208562.447, new_n=660
2025-06-02 15:43:39,010 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:39,010 - DEBUG - Online update step: 1/25
2025-06-02 15:43:39,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:39,155 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:43:39,172 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:43:39,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:39,312 - DEBUG - Step 1: Loss=5.6119
2025-06-02 15:43:39,312 - DEBUG - Online update step: 2/25
2025-06-02 15:43:39,315 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:39,398 - DEBUG - Node anomaly scores shape: torch.Size([15057, 1])
2025-06-02 15:43:39,405 - DEBUG - Edge anomaly scores shape: torch.Size([30865, 1])
2025-06-02 15:43:39,406 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:39,639 - DEBUG - Step 2: Loss=5.2070
2025-06-02 15:43:39,640 - DEBUG - Online update step: 3/25
2025-06-02 15:43:39,643 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:39,724 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:43:39,729 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:43:39,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:39,938 - DEBUG - Step 3: Loss=4.8203
2025-06-02 15:43:39,938 - DEBUG - Online update step: 4/25
2025-06-02 15:43:39,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:40,039 - DEBUG - Node anomaly scores shape: torch.Size([14780, 1])
2025-06-02 15:43:40,046 - DEBUG - Edge anomaly scores shape: torch.Size([30341, 1])
2025-06-02 15:43:40,047 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:40,300 - DEBUG - Step 4: Loss=4.4346
2025-06-02 15:43:40,300 - DEBUG - Online update step: 5/25
2025-06-02 15:43:40,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:40,403 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:43:40,410 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:43:40,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:40,663 - DEBUG - Step 5: Loss=4.0597
2025-06-02 15:43:40,664 - DEBUG - Online update step: 6/25
2025-06-02 15:43:40,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:40,752 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 15:43:40,759 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 15:43:40,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:40,954 - DEBUG - Step 6: Loss=3.6851
2025-06-02 15:43:40,955 - DEBUG - Online update step: 7/25
2025-06-02 15:43:40,963 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:41,062 - DEBUG - Node anomaly scores shape: torch.Size([14328, 1])
2025-06-02 15:43:41,069 - DEBUG - Edge anomaly scores shape: torch.Size([29237, 1])
2025-06-02 15:43:41,070 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:41,301 - DEBUG - Step 7: Loss=3.3073
2025-06-02 15:43:41,301 - DEBUG - Online update step: 8/25
2025-06-02 15:43:41,309 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:41,463 - DEBUG - Node anomaly scores shape: torch.Size([14493, 1])
2025-06-02 15:43:41,469 - DEBUG - Edge anomaly scores shape: torch.Size([29643, 1])
2025-06-02 15:43:41,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:41,711 - DEBUG - Step 8: Loss=2.9129
2025-06-02 15:43:41,712 - DEBUG - Online update step: 9/25
2025-06-02 15:43:41,715 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:41,832 - DEBUG - Node anomaly scores shape: torch.Size([15057, 1])
2025-06-02 15:43:41,836 - DEBUG - Edge anomaly scores shape: torch.Size([30865, 1])
2025-06-02 15:43:41,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:41,996 - DEBUG - Step 9: Loss=2.5249
2025-06-02 15:43:41,996 - DEBUG - Online update step: 10/25
2025-06-02 15:43:41,999 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:42,089 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:43:42,092 - DEBUG - Edge anomaly scores shape: torch.Size([30972, 1])
2025-06-02 15:43:42,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:42,237 - DEBUG - Step 10: Loss=2.2171
2025-06-02 15:43:42,237 - DEBUG - Online update step: 11/25
2025-06-02 15:43:42,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:42,338 - DEBUG - Node anomaly scores shape: torch.Size([14378, 1])
2025-06-02 15:43:42,342 - DEBUG - Edge anomaly scores shape: torch.Size([29354, 1])
2025-06-02 15:43:42,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:42,527 - DEBUG - Step 11: Loss=2.2795
2025-06-02 15:43:42,528 - DEBUG - Online update step: 12/25
2025-06-02 15:43:42,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:42,598 - DEBUG - Node anomaly scores shape: torch.Size([15084, 1])
2025-06-02 15:43:42,601 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 15:43:42,602 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:42,757 - DEBUG - Step 12: Loss=2.4384
2025-06-02 15:43:42,757 - DEBUG - Online update step: 13/25
2025-06-02 15:43:42,760 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:42,862 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 15:43:42,867 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 15:43:42,868 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:43,022 - DEBUG - Step 13: Loss=2.5484
2025-06-02 15:43:43,023 - DEBUG - Online update step: 14/25
2025-06-02 15:43:43,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:43,117 - DEBUG - Node anomaly scores shape: torch.Size([15092, 1])
2025-06-02 15:43:43,120 - DEBUG - Edge anomaly scores shape: torch.Size([30927, 1])
2025-06-02 15:43:43,122 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:43,341 - DEBUG - Step 14: Loss=2.6067
2025-06-02 15:43:43,342 - DEBUG - Online update step: 15/25
2025-06-02 15:43:43,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:43,444 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 15:43:43,447 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 15:43:43,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:43,741 - DEBUG - Step 15: Loss=2.6116
2025-06-02 15:43:43,742 - DEBUG - Online update step: 16/25
2025-06-02 15:43:43,749 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:43,877 - DEBUG - Node anomaly scores shape: torch.Size([14707, 1])
2025-06-02 15:43:43,892 - DEBUG - Edge anomaly scores shape: torch.Size([30079, 1])
2025-06-02 15:43:43,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:44,151 - DEBUG - Step 16: Loss=2.5857
2025-06-02 15:43:44,152 - DEBUG - Online update step: 17/25
2025-06-02 15:43:44,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:44,226 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:44,230 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:44,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:44,353 - DEBUG - Step 17: Loss=2.5079
2025-06-02 15:43:44,353 - DEBUG - Online update step: 18/25
2025-06-02 15:43:44,366 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:44,464 - DEBUG - Node anomaly scores shape: torch.Size([15017, 1])
2025-06-02 15:43:44,471 - DEBUG - Edge anomaly scores shape: torch.Size([30812, 1])
2025-06-02 15:43:44,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:44,651 - DEBUG - Step 18: Loss=2.4364
2025-06-02 15:43:44,652 - DEBUG - Online update step: 19/25
2025-06-02 15:43:44,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:44,740 - DEBUG - Node anomaly scores shape: torch.Size([15127, 1])
2025-06-02 15:43:44,746 - DEBUG - Edge anomaly scores shape: torch.Size([30972, 1])
2025-06-02 15:43:44,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:44,875 - DEBUG - Step 19: Loss=2.3344
2025-06-02 15:43:44,876 - DEBUG - Online update step: 20/25
2025-06-02 15:43:44,879 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:44,984 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:43:44,991 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:43:44,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:45,146 - DEBUG - Step 20: Loss=2.2149
2025-06-02 15:43:45,146 - DEBUG - Online update step: 21/25
2025-06-02 15:43:45,149 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:45,221 - DEBUG - Node anomaly scores shape: torch.Size([14754, 1])
2025-06-02 15:43:45,226 - DEBUG - Edge anomaly scores shape: torch.Size([30245, 1])
2025-06-02 15:43:45,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:45,404 - DEBUG - Step 21: Loss=2.1061
2025-06-02 15:43:45,404 - DEBUG - Online update step: 22/25
2025-06-02 15:43:45,407 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:45,476 - DEBUG - Node anomaly scores shape: torch.Size([14384, 1])
2025-06-02 15:43:45,489 - DEBUG - Edge anomaly scores shape: torch.Size([29379, 1])
2025-06-02 15:43:45,490 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:45,668 - DEBUG - Step 22: Loss=1.9874
2025-06-02 15:43:45,668 - DEBUG - Online update step: 23/25
2025-06-02 15:43:45,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:45,764 - DEBUG - Node anomaly scores shape: torch.Size([14384, 1])
2025-06-02 15:43:45,767 - DEBUG - Edge anomaly scores shape: torch.Size([29379, 1])
2025-06-02 15:43:45,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:46,080 - DEBUG - Step 23: Loss=1.8960
2025-06-02 15:43:46,081 - DEBUG - Online update step: 24/25
2025-06-02 15:43:46,085 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:46,823 - DEBUG - Node anomaly scores shape: torch.Size([14416, 1])
2025-06-02 15:43:46,840 - DEBUG - Edge anomaly scores shape: torch.Size([29439, 1])
2025-06-02 15:43:46,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:47,931 - DEBUG - Step 24: Loss=1.8774
2025-06-02 15:43:47,932 - DEBUG - Online update step: 25/25
2025-06-02 15:43:47,936 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:48,089 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 15:43:48,103 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 15:43:48,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:48,585 - DEBUG - Step 25: Loss=1.9188
2025-06-02 15:43:48,585 - INFO - Online update finished. Average loss: 2.9252, Learning rate: 0.001000
2025-06-02 15:43:48,586 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], current edge mean: [ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:43:48,586 - DEBUG - Node drift difference: 0.0111, Edge drift difference: 0.0012
2025-06-02 15:43:48,587 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], edge=[ 1.0679444e-09  4.6099832e+02  0.0000000e+00  0.0000000e+00
  2.6698610e-09  3.2038332e-09  2.1358888e-09 -2.1358888e-09
  8.5435552e-09  8.0095823e-09]
2025-06-02 15:43:48,588 - DEBUG - Updated reference std: node=[0.         0.         1.0005987  1.0005985  0.         0.
 0.         1.0005987  1.0005987  1.0005987  1.0005987  1.0005987
 0.99652076 0.2824555  0.36981332 0.5666934  1.0005987  3.0259826
 2.9103527  1.4954265  0.36981332 0.24210006 1.0005987  1.0005987
 0.         0.         0.         0.         1.0005987  1.0005987 ], edge=[  1.0002801 481.91306     0.          0.          1.00028     1.0002801
   1.0002801   1.00028     1.0002801   1.00028  ]
2025-06-02 15:43:48,588 - INFO - Online update complete. Loss: 2.9252
2025-06-02 15:43:48,588 - INFO - Running anomaly detection...
2025-06-02 15:43:48,588 - INFO - Starting anomaly detection.
2025-06-02 15:43:48,597 - DEBUG - Node reconstruction errors: [ 1.0948159   4.6368794  11.07286     0.9549753   1.8713821   1.5932368
 10.591405    1.3025359   1.302536    1.2698482   1.302536    1.0612843
 14.77851     1.6307698   0.90725034  1.0823648   1.0663124   1.0823648
  4.0601      0.95552754  0.7867501   0.90725034  0.68597066  0.9143916
  0.8389275   1.1261243   0.8389267   2.0371363   1.1467673   0.8389275
  3.6661909   1.4992397   1.8747395   0.8356111   1.1235069   0.71763617
  1.4376377   0.95552754  2.1002276   1.2546103   0.7605225   0.7840022
  0.95552754  0.66894025  1.1157292   0.7181174   0.8462626   0.74972004
  1.0091159   1.6330736   4.902311    0.9258205   0.9934069   3.4639769
  0.7023466   1.5027375   7.7981577   0.75158024  3.7791126   3.3491724
  0.974015    0.5193018   0.6769746   1.1137612   0.69469684  0.70234644
  0.6405171   0.70234764  0.6769746   0.67697406  0.58133066  1.6522092
  0.61237335  1.3336982   1.2918421   1.7180992   0.7180204   1.5460757
  1.3291068   1.5223424   0.5638422   1.3658218   2.0829837   2.1904137
  1.2062579   1.039641    1.3322042   1.1983329   1.5209846   1.2250949
  0.5495194   1.7736284   0.7835899   1.3122139   0.5061719   4.5103106
  0.50398743  1.214721    0.45828056  0.6407246   1.4557989   0.50398743
  0.49574533  1.4104899   1.126249    0.62444156  1.115129    0.61536324
  0.78292936  1.1483686   0.87636936  0.48526338  1.6781584   1.5390023
  1.4312837   1.2123438   1.3755504   1.6933997   1.2153927   0.4511051
  0.4391317   0.82694733  1.4631407   0.8484231   1.2387803   0.4511039
  0.85084575  0.6099203   1.1405814   0.41961336  0.54724884  0.5894984
  1.6716712   2.0137036   1.3280152   0.6148103   0.4714987   0.49935028
  0.67142576  2.393384    0.4843798   1.2504177   0.41575766  0.585863
  0.585863    1.2577989   1.375551    0.585863    0.52857625  1.2318054
  1.379792    1.255955    1.3425292   0.58949864  1.7921468   1.6915905
  0.5509947   1.1007785   1.4557989   0.55901366  0.48428905  0.6714207
  0.5509947   0.54724884  1.4006149   1.7183926   1.3840994   1.2962468
  0.5832536   1.2665855   1.4695195   0.43951413  0.51888686  5.0224605
  1.232671    3.8521843   1.2179372   1.067672    1.3545126   1.3545119
  0.576239    0.8620809   0.4886236   1.5324367   1.7406764   1.144867
  0.37642708  1.2874552   0.5662814   0.5031874   1.1331818   1.1644304
  0.52753824  0.6475813   0.67142767  0.5180752   1.9840481   0.6134271
  1.7216053   0.4180893   0.4101943   0.5509947   1.4829279   1.1680028
  1.1859466   0.6793253   0.6168119   2.3248208   0.4286217   1.287269
  1.3051798   1.3291882   0.6389776   1.1409795   1.1267003   0.41212043
  1.1643393   1.3755499   1.4147657   0.6475813   1.5084926   0.37642708
  0.45148095  0.63897705  0.5509947   1.1464283   1.6585209   0.71187484
  1.3586667   0.80459976  0.92188627  1.183027    1.2039865   1.3755505
  1.3755506   0.5180752   1.1891905   0.45148087  0.550995    0.53285635
  1.6765332   1.1232852   0.6312755   1.2491823   0.63910276  1.2491816
  1.1792301   1.1446699   0.6312755   0.49244756  0.51888686  0.52878785
  1.4147655   1.1661261   1.1418465   1.3500203   0.5031874   0.37385225
  0.4685292   1.3545115   1.130796    1.0564996   0.51484066  0.5014951
  1.1286584   0.4609378   1.1931051   3.6331146   1.1931044   1.0941722
  1.550206    1.4644681   1.1420413   0.6109638   1.2885308   1.3545111
  0.4084786   1.5338614   0.576239    1.1872193   2.1501482   0.43571445
  1.191531    0.48896804  1.0744612   0.42641583  2.596112    0.612249
  0.8620805   0.96245366  0.4438907   0.38902992  0.5115067   0.6391025
  1.5915935   0.3850769   1.1002821   1.3544986   0.5180752   1.1831828
  1.1807883   0.3934121   1.2106167   1.0388304   0.3934121   0.3934117
  0.3934117   1.2525972   0.37035322  0.3934121   0.3934121   1.8346343
  0.39341173  0.47303113  0.67014825  1.197724    1.2093585   0.8220047
  0.5913954   0.49902427  1.1428753   0.42244098  1.3592095   1.2106189
  0.5825037   1.4932603   0.405222    1.2525972   1.2414175   1.241417
  1.2885798   0.49552405  0.3934117   1.2885303   0.3934117   1.2525971
  0.53684425  0.46188247  0.40522173  0.40522173  0.3934121   0.49441877
  0.405222    1.0798709   1.1021794   1.0464959   1.2106178   0.40078294
  1.2774632   1.3007244   0.3934121   1.1126671   1.46115     1.0603154
  0.46441954  0.5031874   0.35559624  0.3934121   0.4367959   2.3524063
  1.3051807   0.41899708  0.68668073  1.0216658   1.2106166   4.5094604
  0.37633404  1.824588    1.2435658   1.1641135   1.0549114   1.032869
  1.0262839   1.4397926   1.1652385   1.0602994   0.40301025  0.5130514
  1.0183672   0.3934121   1.2106174   0.598182    0.46789294  1.1334077
  0.6036864   1.1491818   0.6458969   1.0690616   1.2367625   0.3934121
  1.5623137   1.1541207   1.1947173   1.1285001   1.1567029   1.156702
  1.156702    3.5577579   0.36770672  3.5407724   0.46034175  1.3320508
  1.156702    0.36770687  1.1384434   1.194717    1.0733374   0.4495176
  1.1947162   0.66205317  1.1567029   1.1947162   0.36770687  1.156702
  1.1567029   0.41584846  0.46395537  1.1567029   0.40301073  0.4627544
  0.45583057  0.46908486  1.1373154   0.45348537  1.4643009   0.47766626
  0.524438    1.2930907   0.72842866  0.9957697   1.0955749   0.53223175
  1.0375404   1.1263806   1.1567029   1.1567029   0.46034124  1.1620668
  1.4453335   0.37801826  0.5682738   0.46169907  0.7340922   0.36293718
  0.38397038  1.5642835   1.9778253   0.45865598  0.500215    0.46482036
  1.0133814   0.3614814   0.4835584   0.36010858  0.36148137  0.5257231
  0.4534853   0.4699888   0.39221355  1.1241561   1.1731186   0.49692342
  0.4472831   0.9098179   0.4472831   0.49692342  0.3855031   1.1241568
  0.707222    0.48824754  0.3855033   1.1731187   1.0583831   2.1254625
  1.1062609   1.1372677   1.1241571   1.1731179   0.3521396   0.51281226
  0.3706062   1.8556925   0.51635844  0.45865598  1.5360233   0.42353752
  0.36148137  0.6469136   0.52467865  2.130418    1.0161914   0.3521396
  1.0852934   0.34819493  1.0892886   0.4699888   1.1173612   3.5041819
  0.36010858  0.51281226  0.73973006  0.34819508  0.73973006  0.38362464
  0.3740618   0.89370316  0.3536586   2.7205632   0.52354854  0.3614814
  0.9342343   0.4364691   0.43646917  0.38397068  1.0157593   0.50700146
  0.35365838  1.1069039   0.46329308  1.0267391   1.1069058   0.46169934
  0.35365838  0.5435367   0.37406176  1.1173614   0.47773704  0.9309597
  1.1069047   1.168182    0.50700146  0.36010858  0.36010858  0.51281226
  1.1173606   1.1390934   1.0499078   1.0900052   0.36010858  1.1712366
  0.3601083   1.1712366   0.5769611   1.106905    0.42262948  2.9088404
  0.69647795  0.369849    2.922143    0.369849    0.36984894  0.369849
  0.36984894  0.369849    0.369849    0.3698489   1.0986291   0.4550358
  0.5608088   0.36984894  0.36984894  0.369849    0.369849    0.369849
  0.369849    0.36984894  0.369849    0.369849    1.0815865   0.369849
  0.369849    1.5835443   0.369849    0.96508664  0.6404932   0.36010858
  0.70539075  1.1377457   1.828621    1.828621    1.1437172   0.70539075
  0.36010858  0.35365838  0.35365838  0.3601083   0.35365838  0.42637584
  0.4631046   0.36984894  0.46169907  0.3601083   0.4364691   0.36010858
  0.36010858  0.39354745  0.3601083   0.35365838  0.36010858  0.36010858
  1.1069052   0.35365838  0.36010858  0.3536591   0.36010858  0.36010858
  0.36010858  1.0012165   1.0892893   1.0892893   0.369849    0.49462226
  0.69451696  0.36010858  0.3536591   0.95136625  0.369849    0.523373
  1.1196022   0.3576272   0.3601083   0.36010858  1.0364169   0.9877422
  1.0731415   0.3601083   1.0986292   0.3935477   0.3536586   0.9484341
  0.369849    0.49172014  1.1069058   0.369849    0.369849    1.0986294
  0.3935477   0.36010858  0.706924    1.1426958   1.0090054   0.98774296
  0.57553595  1.0562134   1.0562134   0.6348678   0.46043175  0.369849
  0.44203004  1.0750939   0.9877422   1.0838767   0.50919145  0.39091498
  0.39591     0.39590937  0.39591     0.39590937  0.39591     1.074212
  1.0892856   0.39591     0.39591     0.36984894  0.43371642  0.369849
  1.0562134   0.96892715  1.0562134   0.44476053  1.0562134   0.9658336
  1.0815858   0.48463914  1.0815862   0.36984894  1.0562134   0.38039356
  0.3712004   0.37120005  0.39591     0.38039356  1.0610766   0.47753757
  0.369849    0.369849    0.39591     0.47707137  0.3712004   0.40289357
  0.39091447  0.45166308  1.0742111   2.2671819   0.45166308  1.7976284
  1.0959249   0.39091447  0.5406572   0.40413985  0.43082696  0.5494701
  1.0327667   0.43914998  1.0345278   0.39091447  0.39091498  0.39091447
  0.3970136   0.39091498  0.39091447  0.43082696  0.39091498  0.39091498
  0.39091447  1.1151712   0.4446283   1.062593    1.0007576   1.1113114
  0.5697139   0.47053054  1.0743614   3.7227128   0.4885202   0.50270027
  0.5114304   0.605369    0.605369    0.43082696  1.9038831   1.251333
  0.48851997  0.49995956  0.7713699   1.9655513   0.57782495  0.57782495
  0.5778247   0.5780845   0.5940751   1.2675363   0.8371124   0.87780553
  0.5680111   0.5864887   0.5596939   0.49995956  0.6404907   1.1616473
  0.5114304   0.6656726   0.48851997  1.2513443   0.4999593   1.1616474
  0.5864887   0.6954834   0.5778247   0.5780845   0.5114304   0.5485522
  0.6719917   0.5780845   0.5780845   0.5780845   0.63501054  1.1803788
  5.003598    0.57782495  1.1081994   0.5780845   1.1389408   0.69896924
  3.972279    0.69896924  0.5780845   0.6733248   0.72677684  0.5632785
  0.6733248   0.69896924  5.199333    0.73315245  1.2035115   0.69896924
  1.1672041   0.75706184  0.82608163  1.080835    1.2557696   0.6548681
  0.6548681   1.080835    0.95485914  0.6733239   0.69896924  0.82608163
  0.69896924  0.7578465   0.7578463   0.75784653  0.6917603   1.3379617
  0.75784653  0.7578463   0.75784653  0.9505101   0.75784653  0.7578465
  0.77924675  0.93446505  1.2293743   1.2293742   0.75784653  0.8328167
  0.9505101   0.7578465   0.87640536  0.8328168   0.75784653  0.7578465
  1.2596513   0.8328168   0.7578465   0.8328167   0.86132485  1.3204029
  1.0577444   0.7578465   1.4187404   0.8328168   0.8328167   0.93446517
  0.90078413  0.83281666]
2025-06-02 15:43:48,597 - DEBUG - Edge reconstruction errors: [  5.2581015   5.2581396  44.253212  ...  13.353189  535.2537
  13.353189 ]
2025-06-02 15:43:48,599 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154348_update_34.json
2025-06-02 15:43:48,599 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:48,607 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154348_update_34.pth and as latest_checkpoint.pth
2025-06-02 15:43:48,608 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.4012
2025-06-02 15:43:48,608 - WARNING - Detected 22 anomalous nodes (reconstruction-based):
2025-06-02 15:43:48,608 - WARNING -   Node ID: 192.168.239.101, Recon Error: 4.6369, MLP Score: 0.5313
2025-06-02 15:43:48,608 - WARNING -   Node ID: 192.168.27.13, Recon Error: 11.0729, MLP Score: 0.4619
2025-06-02 15:43:48,608 - WARNING -   Node ID: 192.168.27.12, Recon Error: 10.5914, MLP Score: 0.4854
2025-06-02 15:43:48,608 - WARNING -   Node ID: 192.168.27.10, Recon Error: 14.7785, MLP Score: 0.4849
2025-06-02 15:43:48,608 - WARNING -   Node ID: 43.132.85.151, Recon Error: 4.0601, MLP Score: 0.4771
2025-06-02 15:43:48,608 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:43:48,608 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2532, MLP Score: 0.0000
2025-06-02 15:43:48,608 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9556, MLP Score: 0.0000
2025-06-02 15:43:48,608 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0565, MLP Score: 0.0000
2025-06-02 15:43:48,608 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7545, MLP Score: 0.0000
2025-06-02 15:43:48,608 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7537, MLP Score: 0.0000
2025-06-02 15:43:48,609 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-02 15:43:48,609 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:43:48,609 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:43:48,609 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 15:43:48,633 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:43:48,655 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 15:43:48,655 - INFO - Processing node updates/additions.
2025-06-02 15:43:48,660 - INFO - Processing edge updates/additions.
2025-06-02 15:43:48,670 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:48,671 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:48,672 - DEBUG - Updated graph - Nodes: 845, Edges: 1818
2025-06-02 15:43:48,672 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:48,673 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:48,681 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-02 15:43:48,686 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:48,692 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-02 15:43:48,693 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-02 15:43:48,695 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:48,699 - DEBUG - Initial edge attributes tensor shape: torch.Size([1818, 10])
2025-06-02 15:43:48,700 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:48,700 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1818, 10])
2025-06-02 15:43:48,700 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:48,701 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:48,701 - INFO - Updated main graph to 845 nodes and 1818 edges.
2025-06-02 15:43:48,701 - INFO - Performing online update...
2025-06-02 15:43:48,701 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:48,702 - DEBUG - Updated RunningStats: new_mean=0.9435463496370878, new_var=19800000000161.184, new_n=2010
2025-06-02 15:43:48,702 - DEBUG - Updated RunningStats: new_mean=0.9405838327777333, new_var=20100000000018.215, new_n=2040
2025-06-02 15:43:48,702 - DEBUG - Updated RunningStats: new_mean=44.27410093866763, new_var=6600000191037.39, new_n=670
2025-06-02 15:43:48,702 - DEBUG - Updated RunningStats: new_mean=44.33574414481712, new_var=6700000204846.448, new_n=680
2025-06-02 15:43:48,703 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:48,703 - DEBUG - Online update step: 1/25
2025-06-02 15:43:48,705 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:48,771 - DEBUG - Node anomaly scores shape: torch.Size([15154, 1])
2025-06-02 15:43:48,775 - DEBUG - Edge anomaly scores shape: torch.Size([31037, 1])
2025-06-02 15:43:48,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:48,950 - DEBUG - Step 1: Loss=1.9704
2025-06-02 15:43:48,951 - DEBUG - Online update step: 2/25
2025-06-02 15:43:48,959 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:49,046 - DEBUG - Node anomaly scores shape: torch.Size([14608, 1])
2025-06-02 15:43:49,054 - DEBUG - Edge anomaly scores shape: torch.Size([29912, 1])
2025-06-02 15:43:49,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:49,225 - DEBUG - Step 2: Loss=1.9715
2025-06-02 15:43:49,226 - DEBUG - Online update step: 3/25
2025-06-02 15:43:49,233 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:49,311 - DEBUG - Node anomaly scores shape: torch.Size([15902, 1])
2025-06-02 15:43:49,315 - DEBUG - Edge anomaly scores shape: torch.Size([32695, 1])
2025-06-02 15:43:49,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:49,472 - DEBUG - Step 3: Loss=1.9242
2025-06-02 15:43:49,473 - DEBUG - Online update step: 4/25
2025-06-02 15:43:49,479 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:49,583 - DEBUG - Node anomaly scores shape: torch.Size([15162, 1])
2025-06-02 15:43:49,589 - DEBUG - Edge anomaly scores shape: torch.Size([31154, 1])
2025-06-02 15:43:49,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:49,768 - DEBUG - Step 4: Loss=1.8456
2025-06-02 15:43:49,768 - DEBUG - Online update step: 5/25
2025-06-02 15:43:49,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:49,838 - DEBUG - Node anomaly scores shape: torch.Size([15166, 1])
2025-06-02 15:43:49,847 - DEBUG - Edge anomaly scores shape: torch.Size([31112, 1])
2025-06-02 15:43:49,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:50,055 - DEBUG - Step 5: Loss=1.7570
2025-06-02 15:43:50,055 - DEBUG - Online update step: 6/25
2025-06-02 15:43:50,064 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:50,147 - DEBUG - Node anomaly scores shape: torch.Size([14919, 1])
2025-06-02 15:43:50,159 - DEBUG - Edge anomaly scores shape: torch.Size([30628, 1])
2025-06-02 15:43:50,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:50,361 - DEBUG - Step 6: Loss=1.6898
2025-06-02 15:43:50,362 - DEBUG - Online update step: 7/25
2025-06-02 15:43:50,365 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:50,450 - DEBUG - Node anomaly scores shape: torch.Size([15106, 1])
2025-06-02 15:43:50,456 - DEBUG - Edge anomaly scores shape: torch.Size([30964, 1])
2025-06-02 15:43:50,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:50,645 - DEBUG - Step 7: Loss=1.6785
2025-06-02 15:43:50,645 - DEBUG - Online update step: 8/25
2025-06-02 15:43:50,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:50,733 - DEBUG - Node anomaly scores shape: torch.Size([15199, 1])
2025-06-02 15:43:50,739 - DEBUG - Edge anomaly scores shape: torch.Size([31189, 1])
2025-06-02 15:43:50,740 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:50,952 - DEBUG - Step 8: Loss=1.6872
2025-06-02 15:43:50,953 - DEBUG - Online update step: 9/25
2025-06-02 15:43:50,972 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:51,254 - DEBUG - Node anomaly scores shape: torch.Size([14458, 1])
2025-06-02 15:43:51,259 - DEBUG - Edge anomaly scores shape: torch.Size([29534, 1])
2025-06-02 15:43:51,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:51,418 - DEBUG - Step 9: Loss=1.6911
2025-06-02 15:43:51,419 - DEBUG - Online update step: 10/25
2025-06-02 15:43:51,424 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:51,546 - DEBUG - Node anomaly scores shape: torch.Size([15139, 1])
2025-06-02 15:43:51,552 - DEBUG - Edge anomaly scores shape: torch.Size([31083, 1])
2025-06-02 15:43:51,556 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:51,716 - DEBUG - Step 10: Loss=1.6827
2025-06-02 15:43:51,716 - DEBUG - Online update step: 11/25
2025-06-02 15:43:51,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:51,814 - DEBUG - Node anomaly scores shape: torch.Size([15191, 1])
2025-06-02 15:43:51,821 - DEBUG - Edge anomaly scores shape: torch.Size([31127, 1])
2025-06-02 15:43:51,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:52,078 - DEBUG - Step 11: Loss=1.6643
2025-06-02 15:43:52,079 - DEBUG - Online update step: 12/25
2025-06-02 15:43:52,084 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:52,207 - DEBUG - Node anomaly scores shape: torch.Size([14708, 1])
2025-06-02 15:43:52,219 - DEBUG - Edge anomaly scores shape: torch.Size([30127, 1])
2025-06-02 15:43:52,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:52,546 - DEBUG - Step 12: Loss=1.6379
2025-06-02 15:43:52,546 - DEBUG - Online update step: 13/25
2025-06-02 15:43:52,550 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:52,625 - DEBUG - Node anomaly scores shape: torch.Size([15637, 1])
2025-06-02 15:43:52,629 - DEBUG - Edge anomaly scores shape: torch.Size([32242, 1])
2025-06-02 15:43:52,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:52,751 - DEBUG - Step 13: Loss=1.5901
2025-06-02 15:43:52,751 - DEBUG - Online update step: 14/25
2025-06-02 15:43:52,758 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:52,858 - DEBUG - Node anomaly scores shape: torch.Size([15122, 1])
2025-06-02 15:43:52,863 - DEBUG - Edge anomaly scores shape: torch.Size([31016, 1])
2025-06-02 15:43:52,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:53,049 - DEBUG - Step 14: Loss=1.5571
2025-06-02 15:43:53,050 - DEBUG - Online update step: 15/25
2025-06-02 15:43:53,053 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:53,369 - DEBUG - Node anomaly scores shape: torch.Size([15629, 1])
2025-06-02 15:43:53,372 - DEBUG - Edge anomaly scores shape: torch.Size([32227, 1])
2025-06-02 15:43:53,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:53,502 - DEBUG - Step 15: Loss=1.5357
2025-06-02 15:43:53,502 - DEBUG - Online update step: 16/25
2025-06-02 15:43:53,505 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:53,636 - DEBUG - Node anomaly scores shape: torch.Size([15259, 1])
2025-06-02 15:43:53,656 - DEBUG - Edge anomaly scores shape: torch.Size([31295, 1])
2025-06-02 15:43:53,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:53,995 - DEBUG - Step 16: Loss=1.5499
2025-06-02 15:43:53,995 - DEBUG - Online update step: 17/25
2025-06-02 15:43:54,003 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:54,105 - DEBUG - Node anomaly scores shape: torch.Size([14845, 1])
2025-06-02 15:43:54,112 - DEBUG - Edge anomaly scores shape: torch.Size([30492, 1])
2025-06-02 15:43:54,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:54,460 - DEBUG - Step 17: Loss=1.5475
2025-06-02 15:43:54,461 - DEBUG - Online update step: 18/25
2025-06-02 15:43:54,468 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:54,542 - DEBUG - Node anomaly scores shape: torch.Size([14533, 1])
2025-06-02 15:43:54,548 - DEBUG - Edge anomaly scores shape: torch.Size([29755, 1])
2025-06-02 15:43:54,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:54,920 - DEBUG - Step 18: Loss=1.5411
2025-06-02 15:43:54,920 - DEBUG - Online update step: 19/25
2025-06-02 15:43:54,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:55,006 - DEBUG - Node anomaly scores shape: torch.Size([14849, 1])
2025-06-02 15:43:55,010 - DEBUG - Edge anomaly scores shape: torch.Size([30436, 1])
2025-06-02 15:43:55,011 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:55,196 - DEBUG - Step 19: Loss=1.5035
2025-06-02 15:43:55,197 - DEBUG - Online update step: 20/25
2025-06-02 15:43:55,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:55,632 - DEBUG - Node anomaly scores shape: torch.Size([15272, 1])
2025-06-02 15:43:55,637 - DEBUG - Edge anomaly scores shape: torch.Size([31480, 1])
2025-06-02 15:43:55,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:55,804 - DEBUG - Step 20: Loss=1.4628
2025-06-02 15:43:55,804 - DEBUG - Online update step: 21/25
2025-06-02 15:43:55,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:55,914 - DEBUG - Node anomaly scores shape: torch.Size([14571, 1])
2025-06-02 15:43:55,919 - DEBUG - Edge anomaly scores shape: torch.Size([29849, 1])
2025-06-02 15:43:55,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:56,068 - DEBUG - Step 21: Loss=1.4610
2025-06-02 15:43:56,068 - DEBUG - Online update step: 22/25
2025-06-02 15:43:56,071 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:56,182 - DEBUG - Node anomaly scores shape: torch.Size([14819, 1])
2025-06-02 15:43:56,190 - DEBUG - Edge anomaly scores shape: torch.Size([30396, 1])
2025-06-02 15:43:56,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:56,341 - DEBUG - Step 22: Loss=1.4495
2025-06-02 15:43:56,341 - DEBUG - Online update step: 23/25
2025-06-02 15:43:56,347 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:56,442 - DEBUG - Node anomaly scores shape: torch.Size([15470, 1])
2025-06-02 15:43:56,449 - DEBUG - Edge anomaly scores shape: torch.Size([31877, 1])
2025-06-02 15:43:56,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:56,621 - DEBUG - Step 23: Loss=1.4346
2025-06-02 15:43:56,622 - DEBUG - Online update step: 24/25
2025-06-02 15:43:56,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:56,766 - DEBUG - Node anomaly scores shape: torch.Size([15202, 1])
2025-06-02 15:43:56,778 - DEBUG - Edge anomaly scores shape: torch.Size([31207, 1])
2025-06-02 15:43:56,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:56,897 - DEBUG - Step 24: Loss=1.4181
2025-06-02 15:43:56,898 - DEBUG - Online update step: 25/25
2025-06-02 15:43:56,906 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:56,990 - DEBUG - Node anomaly scores shape: torch.Size([14393, 1])
2025-06-02 15:43:56,997 - DEBUG - Edge anomaly scores shape: torch.Size([29411, 1])
2025-06-02 15:43:56,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:57,159 - DEBUG - Step 25: Loss=1.3960
2025-06-02 15:43:57,159 - INFO - Online update finished. Average loss: 1.6259, Learning rate: 0.001000
2025-06-02 15:43:57,160 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], current edge mean: [ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:43:57,160 - DEBUG - Node drift difference: 0.0106, Edge drift difference: 0.0007
2025-06-02 15:43:57,161 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], edge=[ 4.1965866e-09  4.6068152e+02  0.0000000e+00  0.0000000e+00
 -3.1474401e-09  1.0491467e-09 -4.1965866e-09  3.1474401e-09
  3.1474401e-09  2.0982933e-09]
2025-06-02 15:43:57,162 - DEBUG - Updated reference std: node=[0.         0.         1.0005922  1.0005922  0.         0.
 0.         1.0005922  1.0005922  1.0005922  1.0005922  1.0005922
 0.9916503  0.28097653 0.3715423  0.5695371  1.0005922  3.015083
 2.9019485  1.5126619  0.3715423  0.24080732 1.0005922  1.0005922
 0.         0.         0.         0.         1.0005922  1.0005922 ], edge=[  1.0002751 477.65646     0.          0.          1.0002751   1.0002751
   1.0002751   1.0002751   1.0002751   1.0002751]
2025-06-02 15:43:57,166 - INFO - Online update complete. Loss: 1.6259
2025-06-02 15:43:57,167 - INFO - Running anomaly detection...
2025-06-02 15:43:57,167 - INFO - Starting anomaly detection.
2025-06-02 15:43:57,188 - DEBUG - Node reconstruction errors: [ 0.8144184   4.406562    9.811355    0.5752392   1.6210655   0.90554976
  9.395692    0.8490793   0.849079    0.8490229   0.849079    0.87354815
 13.382252    1.5326538   0.539376    0.6990534   0.91319275  0.6990534
  3.3549354   0.5935167   0.4928171   0.539376    0.47823966  0.7968048
  0.48491487  0.72577393  0.48491487  1.9992822   0.7322927   0.48491457
  3.3087602   0.8274432   1.93871     0.47439364  0.73577446  0.5156224
  0.72374576  0.5935167   2.0448308   1.1540315   0.40719137  0.43479124
  0.5935167   0.38564274  1.0186704   0.689927    0.5524778   0.66335386
  0.62530303  1.2555584   3.678599    0.57762265  0.62504923  2.8993962
  0.38896397  1.3670616   6.6007643   0.42087322  3.1307962   2.8078372
  0.72728133  0.24342327  0.34445974  0.99393845  0.3642211   0.3889635
  0.3357322   0.3889637   0.34445974  0.34445974  0.34682417  0.9106313
  0.3211431   0.7602813   0.7568278   0.9613825   0.4520129   0.82551175
  0.66454816  0.78829724  0.23317055  0.72813666  2.214894    2.0366924
  0.675814    0.9013447   0.6643852   0.6562948   0.7840808   0.5600653
  0.24391323  1.526603    0.6727108   0.6708766   0.25495598  3.9134605
  0.17770371  0.6691798   0.17794155  0.34386212  0.75275654  0.17770375
  0.21634969  0.6351472   1.0043161   0.32262713  0.9808935   0.5302771
  0.6774426   0.9237245   0.6349095   0.18067901  1.6720406   1.4321278
  0.7353424   0.5797485   0.69169533  1.435527    0.66176283  0.2327494
  0.16092236  0.7135236   1.2886012   0.7205241   0.64026314  0.23275207
  0.72892624  0.47625405  0.61657923  0.1467604   0.2969087   0.2987977
  2.2038655   1.8909055   0.6527426   0.32269898  0.21611696  0.20706502
  0.8641464   2.0669916   0.39062148  0.61839014  0.14515951  0.39062136
  0.34461075  0.6748175   0.6916956   0.56467146  0.26854506  0.6292836
  1.0625969   1.1822382   0.67824465  0.298798    1.7104563   1.5289787
  0.26880062  0.5671448   0.7527561   0.24989487  0.39062148  0.5858959
  0.26880062  0.2969087   0.70568883  1.463415    0.7261175   0.61874443
  0.62791246  0.6690477   0.7445662   0.23400511  0.21779148  4.11989
  0.66176194  4.189365    0.5952799   0.53633785  0.6725832   0.67258316
  0.29024255  0.7366263   0.17525639  1.3222301   1.6362634   0.56408155
  0.11325994  0.6574779   0.2901607   0.23439386  0.60187614  0.59018016
  0.28411418  0.3354507   0.8641468   0.2582033   2.069391    0.3689723
  1.4476631   0.13285828  0.13764797  0.26880062  1.3311632   0.6831458
  0.63863385  0.57546085  0.3655396   2.092685    0.1574226   0.6406825
  0.6313945   0.658107    0.3448738   0.5938928   0.5121842   0.13845403
  0.6523981   0.69169515  0.6320714   0.3354507   1.4211471   0.11325994
  0.16684823  0.3448738   0.26880056  0.5667078   1.4466686   0.3809801
  0.6583192   0.70514303  0.7935615   0.56484425  0.6917211   0.69169533
  0.6916955   0.35542917  0.5688489   0.16684833  0.26880062  0.24282704
  1.4869646   0.5746154   0.32463488  0.6431557   0.3260049   0.6431553
  0.57842356  0.55517393  0.32463488  0.2643498   0.21779148  0.2199964
  0.63207126  0.56592816  0.61517805  0.6983027   0.23439386  0.1151526
  0.18067667  0.67258286  0.53525734  0.9213701   0.20083284  0.34330702
  0.6091163   0.22664255  0.5755197   3.2476587   0.5755198   0.5434522
  1.3822793   1.2874515   0.5723047   0.36082608  0.6525406   0.67258334
  0.12357187  0.8242623   0.29024246  0.589364    2.0481577   0.1459608
  0.54676545  0.20813122  0.55792934  0.13661553  2.3152995   0.4835611
  0.7366263   0.96844995  0.2668248   0.11040328  0.25989717  0.32600516
  1.5001061   0.12457145  0.531527    0.67258316  0.25820276  1.0446217
  0.52473545  0.12617652  0.5925846   0.5226613   0.12617652  0.12617652
  0.12617643  0.6226564   0.10944688  0.12617652  0.12617652  1.7946365
  0.12617652  0.2150099   0.6752408   0.5651008   0.5041454   0.71056384
  0.3093603   0.2459753   0.5429347   0.23697957  0.63525325  0.5925847
  0.63405985  1.3011166   0.13671404  0.70319664  0.60065854  0.60065925
  0.52360165  0.24185967  0.12617652  0.65254104  0.12617652  0.62265575
  0.37722185  0.16953756  0.13671404  0.13671389  0.12617652  0.20249015
  0.13671404  0.56027764  0.6217631   0.5289371   0.5925846   0.12223013
  0.60618114  0.6155314   0.12617652  0.5318969   1.4062604   0.54596835
  0.1771775   0.23439386  0.09909503  0.12617652  0.15920582  2.1757948
  0.6313948   0.20323303  0.3744838   0.48814598  0.5925848   4.0007434
  0.11065208  1.7534528   0.5910391   0.53165746  0.5069457   0.4759181
  0.51493573  1.3605095   0.6335744   0.5460094   0.13055515  0.2503434
  0.46488303  0.12617652  0.59258455  0.5044012   0.21679185  0.49929613
  0.5158577   0.53187287  0.4077919   0.94357425  0.61265916  0.12617643
  0.93236566  0.58925956  0.55085427  1.4932586   0.55263156  0.55263156
  0.5526318   2.9669392   0.1064221   2.9582083   0.21115868  0.7120958
  0.5526318   0.1064221   0.5317369   0.5508548   0.5609865   0.20552029
  0.5508545   0.5962391   0.55263174  0.5508543   0.1064221   0.5526318
  0.55263156  0.13718577  0.17206138  0.55263156  0.13055454  0.27613556
  0.20985672  0.23582868  0.5114551   0.2128184   1.3546282   0.26198438
  0.29426023  0.6746568   0.58431965  0.8638764   0.47047433  0.26965088
  0.49647433  0.52371156  0.55263156  0.5526318   0.21115868  0.48295593
  1.3273778   0.10659818  0.26475385  0.22348417  0.51136893  0.09668779
  0.1131697   1.8205887   1.794577    0.23161818  0.26357928  0.22432216
  0.5000251   0.09877934  0.23329471  0.09966166  0.09877935  0.28133267
  0.21281831  0.22026671  0.12441555  0.58401674  0.5378052   0.23607625
  0.21383552  0.8157513   0.21383552  0.23607625  0.11160279  0.54579896
  0.6366451   0.24720006  0.11160283  0.53780556  0.4492406   1.9514443
  0.52602535  0.5114528   0.54579955  0.53780544  0.08951707  0.25062424
  0.10477693  1.6645777   0.22315232  0.23161818  1.4552895   0.13934566
  0.09877935  0.5665558   0.21089758  1.9549072   0.48730066  0.08951707
  0.4686387   0.08641113  0.48060125  0.2202668   0.49958798  3.0076106
  0.09966148  0.25062424  0.40452486  0.08641135  0.40452486  0.1013184
  0.10320093  0.78308976  0.09386873  2.4105086   0.30520836  0.09877931
  0.81970257  0.2131295   0.2131295   0.1131697   0.47672746  0.21388151
  0.09386873  0.51652575  0.20635542  0.47455528  0.51652604  0.22348417
  0.09386857  0.28332213  0.10320093  0.49958807  0.26053113  0.80112004
  0.51652586  0.4790282   0.21388151  0.09966166  0.09966166  0.25062424
  0.49958828  0.51192397  0.46391016  0.445035    0.09966148  0.5289369
  0.09966166  0.5289373   0.27216274  0.51652604  0.23307656  2.6887252
  0.6300157   0.10579451  2.6081593   0.10579422  0.10579422  0.10579421
  0.10579421  0.10579421  0.10579422  0.10579421  0.50896394  0.26995486
  0.2415475   0.10579421  0.10579421  0.10579422  0.10579421  0.10579421
  0.10579421  0.10579421  0.10579422  0.10579421  0.50202423  0.10579421
  0.10579447  1.6074859   0.10579421  0.8480738   0.24219231  0.09966166
  0.29473552  0.5498264   1.3593974   1.3593974   0.46459147  0.29473552
  0.09966166  0.09386873  0.09386857  0.09966148  0.09386857  0.16038445
  0.2847056   0.10579421  0.22348417  0.09966166  0.2131295   0.09966171
  0.09966169  0.28409907  0.09966148  0.09386873  0.09966166  0.09966166
  0.5165261   0.09386873  0.09966166  0.09386873  0.09966166  0.09966166
  0.09966166  0.41155878  0.5498263   0.4806018   0.10579421  0.27092496
  0.2956767   0.09966166  0.09386873  0.43004504  0.10579422  0.23281053
  0.51003337  0.09613173  0.09966166  0.09966166  0.47142527  0.39904964
  0.48582187  0.09966166  0.50896275  0.12558767  0.09386858  0.8127044
  0.10579421  0.3749491   0.66402876  0.10579421  0.10579451  0.5089629
  0.12558767  0.09966148  0.41777074  0.5125552   0.49434897  0.39904964
  0.263089    0.47869813  0.47869813  0.23982379  0.17433085  0.10579422
  0.22814056  0.52941096  0.39904964  0.4791817   0.2143831   0.11949528
  0.12572867  0.12572865  0.12572901  0.12572901  0.12572901  0.5059225
  0.5564537   0.12572901  0.12572865  0.10579421  0.15701072  0.10579421
  0.47869813  0.39105284  0.57099164  0.16059996  0.4786982   0.44311583
  0.5020241   0.1950969   0.5020234   0.10579422  0.47869813  0.10740213
  0.10615369  0.10615365  0.12572867  0.10740215  0.42340997  0.18573046
  0.10579447  0.10579451  0.12572865  0.18668637  0.10615369  0.13177313
  0.11949531  0.16065915  0.5059231   2.0932777   0.16065915  1.7068933
  0.4904802   0.11949528  0.30724388  0.1251611   0.15096901  0.24482086
  0.46779892  0.16025567  0.4647468   0.11949531  0.11949528  0.11949531
  0.12381005  0.11949531  0.11949531  0.15096901  0.11949531  0.11949531
  0.11949531  0.5026175   0.15691824  0.43144453  0.45421612  0.46612823
  0.3422136   0.18129589  0.4464386   3.1595113   0.19679727  0.20258945
  0.31745592  0.40860334  0.40860334  0.15096901  1.7308496   0.49323893
  0.19679718  0.2087659   0.41914523  1.8577638   0.2625409   0.2625409
  0.26254055  0.27168483  0.2811827   1.1352667   0.5597796   0.5217001
  0.26331005  0.27480793  0.36333296  0.2087659   0.41056198  0.5590855
  0.21442246  0.41330186  0.19679709  0.49323884  0.2087659   0.55908567
  0.27480772  0.35860384  0.2625409   0.27168483  0.21442246  0.34482485
  0.47758     0.27168483  0.2716849   0.27168483  0.4374892   0.61159116
  4.875849    0.2625409   0.44881108  0.27168483  0.50212234  0.49360067
  3.3901317   0.49360123  0.27168483  0.3492569   0.52616733  0.2567295
  0.34925687  0.49360123  3.744106    0.4018468   0.6634442   0.49360123
  0.57710296  0.5598103   0.47704247  0.48893353  0.67569906  0.3313864
  0.3313864   0.48893356  0.68554074  0.34925687  0.49360123  0.47704262
  0.49360123  0.419645    0.419645    0.419645    0.36293375  0.6568352
  0.419645    0.419645    0.45699272  0.60002863  0.419645    0.419645
  0.4400611   0.65011257  0.59881395  0.55503786  0.419645    0.69747484
  0.60002863  0.419645    0.5193872   0.57881325  0.4196453   0.4196453
  1.1473485   0.57881325  0.419645    0.57881325  0.6100425   0.6315337
  0.7712527   0.419645    1.0582492   0.6100425   0.6100425   0.65011257
  0.5425693   0.6100425   0.5193872   0.5193872   0.5193872   0.7597441
  0.678332    0.7597443   0.9702494   0.5193873   0.67833173]
2025-06-02 15:43:57,188 - DEBUG - Edge reconstruction errors: [  5.262876    5.2628164  44.25845   ...  13.358429  535.2589
  13.358429 ]
2025-06-02 15:43:57,191 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154357_update_35.json
2025-06-02 15:43:57,191 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:43:57,201 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154357_update_35.pth and as latest_checkpoint.pth
2025-06-02 15:43:57,201 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.5197
2025-06-02 15:43:57,201 - WARNING - Detected 22 anomalous nodes (reconstruction-based):
2025-06-02 15:43:57,202 - WARNING -   Node ID: 192.168.239.101, Recon Error: 4.4066, MLP Score: 0.5745
2025-06-02 15:43:57,202 - WARNING -   Node ID: 192.168.27.13, Recon Error: 9.8114, MLP Score: 0.5335
2025-06-02 15:43:57,202 - WARNING -   Node ID: 192.168.27.12, Recon Error: 9.3957, MLP Score: 0.5489
2025-06-02 15:43:57,202 - WARNING -   Node ID: 192.168.27.10, Recon Error: 13.3823, MLP Score: 0.5450
2025-06-02 15:43:57,202 - WARNING -   Node ID: 43.132.85.151, Recon Error: 3.3549, MLP Score: 0.4717
2025-06-02 15:43:57,202 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:43:57,202 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.0000
2025-06-02 15:43:57,202 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0000
2025-06-02 15:43:57,202 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.0000
2025-06-02 15:43:57,202 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7595, MLP Score: 0.0000
2025-06-02 15:43:57,202 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.0000
2025-06-02 15:43:57,202 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-02 15:43:57,202 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:43:57,203 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:43:57,203 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 15:43:57,231 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:43:57,262 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 15:43:57,262 - INFO - Processing node updates/additions.
2025-06-02 15:43:57,270 - INFO - Processing edge updates/additions.
2025-06-02 15:43:57,286 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:43:57,287 - INFO - Finished updating NetworkX graph.
2025-06-02 15:43:57,288 - DEBUG - Updated graph - Nodes: 866, Edges: 1848
2025-06-02 15:43:57,288 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:43:57,290 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:43:57,302 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-02 15:43:57,307 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:43:57,308 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-02 15:43:57,310 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-02 15:43:57,312 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:43:57,318 - DEBUG - Initial edge attributes tensor shape: torch.Size([1848, 10])
2025-06-02 15:43:57,320 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:43:57,320 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1848, 10])
2025-06-02 15:43:57,321 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:43:57,321 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:43:57,322 - INFO - Updated main graph to 866 nodes and 1848 edges.
2025-06-02 15:43:57,322 - INFO - Performing online update...
2025-06-02 15:43:57,322 - INFO - Starting online update for 25 steps.
2025-06-02 15:43:57,323 - DEBUG - Updated RunningStats: new_mean=0.9437220506251973, new_var=20400000000161.473, new_n=2070
2025-06-02 15:43:57,323 - DEBUG - Updated RunningStats: new_mean=0.940823358502129, new_var=20700000000018.105, new_n=2100
2025-06-02 15:43:57,324 - DEBUG - Updated RunningStats: new_mean=44.35958148517441, new_var=6800000190305.406, new_n=690
2025-06-02 15:43:57,324 - DEBUG - Updated RunningStats: new_mean=44.41303840466879, new_var=6900000201696.47, new_n=700
2025-06-02 15:43:57,324 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:43:57,324 - DEBUG - Online update step: 1/25
2025-06-02 15:43:57,327 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:57,402 - DEBUG - Node anomaly scores shape: torch.Size([15976, 1])
2025-06-02 15:43:57,409 - DEBUG - Edge anomaly scores shape: torch.Size([32886, 1])
2025-06-02 15:43:57,410 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:57,610 - DEBUG - Step 1: Loss=1.3782
2025-06-02 15:43:57,611 - DEBUG - Online update step: 2/25
2025-06-02 15:43:57,619 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:57,720 - DEBUG - Node anomaly scores shape: torch.Size([15507, 1])
2025-06-02 15:43:57,726 - DEBUG - Edge anomaly scores shape: torch.Size([31895, 1])
2025-06-02 15:43:57,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:57,891 - DEBUG - Step 2: Loss=1.3668
2025-06-02 15:43:57,892 - DEBUG - Online update step: 3/25
2025-06-02 15:43:57,895 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:57,996 - DEBUG - Node anomaly scores shape: torch.Size([15846, 1])
2025-06-02 15:43:58,008 - DEBUG - Edge anomaly scores shape: torch.Size([32672, 1])
2025-06-02 15:43:58,010 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:58,206 - DEBUG - Step 3: Loss=1.3439
2025-06-02 15:43:58,206 - DEBUG - Online update step: 4/25
2025-06-02 15:43:58,210 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:58,359 - DEBUG - Node anomaly scores shape: torch.Size([15901, 1])
2025-06-02 15:43:58,371 - DEBUG - Edge anomaly scores shape: torch.Size([32694, 1])
2025-06-02 15:43:58,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:58,684 - DEBUG - Step 4: Loss=1.3354
2025-06-02 15:43:58,684 - DEBUG - Online update step: 5/25
2025-06-02 15:43:58,694 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:58,847 - DEBUG - Node anomaly scores shape: torch.Size([15336, 1])
2025-06-02 15:43:58,852 - DEBUG - Edge anomaly scores shape: torch.Size([31542, 1])
2025-06-02 15:43:58,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:59,112 - DEBUG - Step 5: Loss=1.3288
2025-06-02 15:43:59,112 - DEBUG - Online update step: 6/25
2025-06-02 15:43:59,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:59,194 - DEBUG - Node anomaly scores shape: torch.Size([15251, 1])
2025-06-02 15:43:59,199 - DEBUG - Edge anomaly scores shape: torch.Size([31441, 1])
2025-06-02 15:43:59,200 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:59,400 - DEBUG - Step 6: Loss=1.3167
2025-06-02 15:43:59,400 - DEBUG - Online update step: 7/25
2025-06-02 15:43:59,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:59,488 - DEBUG - Node anomaly scores shape: torch.Size([15652, 1])
2025-06-02 15:43:59,493 - DEBUG - Edge anomaly scores shape: torch.Size([32249, 1])
2025-06-02 15:43:59,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:59,685 - DEBUG - Step 7: Loss=1.2945
2025-06-02 15:43:59,686 - DEBUG - Online update step: 8/25
2025-06-02 15:43:59,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:43:59,775 - DEBUG - Node anomaly scores shape: torch.Size([15396, 1])
2025-06-02 15:43:59,780 - DEBUG - Edge anomaly scores shape: torch.Size([31671, 1])
2025-06-02 15:43:59,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:43:59,935 - DEBUG - Step 8: Loss=1.2848
2025-06-02 15:43:59,936 - DEBUG - Online update step: 9/25
2025-06-02 15:43:59,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:00,033 - DEBUG - Node anomaly scores shape: torch.Size([15357, 1])
2025-06-02 15:44:00,037 - DEBUG - Edge anomaly scores shape: torch.Size([31535, 1])
2025-06-02 15:44:00,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:00,196 - DEBUG - Step 9: Loss=1.2907
2025-06-02 15:44:00,196 - DEBUG - Online update step: 10/25
2025-06-02 15:44:00,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:00,284 - DEBUG - Node anomaly scores shape: torch.Size([15616, 1])
2025-06-02 15:44:00,289 - DEBUG - Edge anomaly scores shape: torch.Size([32175, 1])
2025-06-02 15:44:00,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:00,506 - DEBUG - Step 10: Loss=1.2692
2025-06-02 15:44:00,507 - DEBUG - Online update step: 11/25
2025-06-02 15:44:00,510 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:00,622 - DEBUG - Node anomaly scores shape: torch.Size([15242, 1])
2025-06-02 15:44:00,625 - DEBUG - Edge anomaly scores shape: torch.Size([31231, 1])
2025-06-02 15:44:00,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:00,790 - DEBUG - Step 11: Loss=1.2595
2025-06-02 15:44:00,791 - DEBUG - Online update step: 12/25
2025-06-02 15:44:00,796 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:00,890 - DEBUG - Node anomaly scores shape: torch.Size([15909, 1])
2025-06-02 15:44:00,893 - DEBUG - Edge anomaly scores shape: torch.Size([32709, 1])
2025-06-02 15:44:00,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:01,055 - DEBUG - Step 12: Loss=1.2488
2025-06-02 15:44:01,056 - DEBUG - Online update step: 13/25
2025-06-02 15:44:01,064 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:01,161 - DEBUG - Node anomaly scores shape: torch.Size([15183, 1])
2025-06-02 15:44:01,165 - DEBUG - Edge anomaly scores shape: torch.Size([31139, 1])
2025-06-02 15:44:01,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:01,341 - DEBUG - Step 13: Loss=1.2418
2025-06-02 15:44:01,342 - DEBUG - Online update step: 14/25
2025-06-02 15:44:01,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:01,436 - DEBUG - Node anomaly scores shape: torch.Size([15520, 1])
2025-06-02 15:44:01,461 - DEBUG - Edge anomaly scores shape: torch.Size([32011, 1])
2025-06-02 15:44:01,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:01,729 - DEBUG - Step 14: Loss=1.2187
2025-06-02 15:44:01,729 - DEBUG - Online update step: 15/25
2025-06-02 15:44:01,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:02,284 - DEBUG - Node anomaly scores shape: torch.Size([15367, 1])
2025-06-02 15:44:02,357 - DEBUG - Edge anomaly scores shape: torch.Size([31678, 1])
2025-06-02 15:44:02,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:02,613 - DEBUG - Step 15: Loss=1.2073
2025-06-02 15:44:02,614 - DEBUG - Online update step: 16/25
2025-06-02 15:44:02,626 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:02,712 - DEBUG - Node anomaly scores shape: torch.Size([16709, 1])
2025-06-02 15:44:02,718 - DEBUG - Edge anomaly scores shape: torch.Size([34462, 1])
2025-06-02 15:44:02,720 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:02,925 - DEBUG - Step 16: Loss=1.2048
2025-06-02 15:44:02,926 - DEBUG - Online update step: 17/25
2025-06-02 15:44:02,931 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:03,018 - DEBUG - Node anomaly scores shape: torch.Size([15192, 1])
2025-06-02 15:44:03,023 - DEBUG - Edge anomaly scores shape: torch.Size([31282, 1])
2025-06-02 15:44:03,025 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:03,194 - DEBUG - Step 17: Loss=1.1881
2025-06-02 15:44:03,194 - DEBUG - Online update step: 18/25
2025-06-02 15:44:03,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:03,289 - DEBUG - Node anomaly scores shape: torch.Size([15695, 1])
2025-06-02 15:44:03,292 - DEBUG - Edge anomaly scores shape: torch.Size([32340, 1])
2025-06-02 15:44:03,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:03,470 - DEBUG - Step 18: Loss=1.1790
2025-06-02 15:44:03,471 - DEBUG - Online update step: 19/25
2025-06-02 15:44:03,477 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:03,574 - DEBUG - Node anomaly scores shape: torch.Size([15400, 1])
2025-06-02 15:44:03,581 - DEBUG - Edge anomaly scores shape: torch.Size([31570, 1])
2025-06-02 15:44:03,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:03,760 - DEBUG - Step 19: Loss=1.1767
2025-06-02 15:44:03,760 - DEBUG - Online update step: 20/25
2025-06-02 15:44:03,763 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:03,843 - DEBUG - Node anomaly scores shape: torch.Size([14909, 1])
2025-06-02 15:44:03,847 - DEBUG - Edge anomaly scores shape: torch.Size([30554, 1])
2025-06-02 15:44:03,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:04,018 - DEBUG - Step 20: Loss=1.1610
2025-06-02 15:44:04,019 - DEBUG - Online update step: 21/25
2025-06-02 15:44:04,027 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:04,118 - DEBUG - Node anomaly scores shape: torch.Size([15433, 1])
2025-06-02 15:44:04,123 - DEBUG - Edge anomaly scores shape: torch.Size([31728, 1])
2025-06-02 15:44:04,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:04,307 - DEBUG - Step 21: Loss=1.1489
2025-06-02 15:44:04,307 - DEBUG - Online update step: 22/25
2025-06-02 15:44:04,316 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:04,426 - DEBUG - Node anomaly scores shape: torch.Size([16625, 1])
2025-06-02 15:44:04,433 - DEBUG - Edge anomaly scores shape: torch.Size([34341, 1])
2025-06-02 15:44:04,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:04,601 - DEBUG - Step 22: Loss=1.1351
2025-06-02 15:44:04,602 - DEBUG - Online update step: 23/25
2025-06-02 15:44:04,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:04,679 - DEBUG - Node anomaly scores shape: torch.Size([15694, 1])
2025-06-02 15:44:04,685 - DEBUG - Edge anomaly scores shape: torch.Size([32454, 1])
2025-06-02 15:44:04,686 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:04,834 - DEBUG - Step 23: Loss=1.1250
2025-06-02 15:44:04,835 - DEBUG - Online update step: 24/25
2025-06-02 15:44:04,839 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:04,922 - DEBUG - Node anomaly scores shape: torch.Size([14536, 1])
2025-06-02 15:44:04,928 - DEBUG - Edge anomaly scores shape: torch.Size([29692, 1])
2025-06-02 15:44:04,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:05,078 - DEBUG - Step 24: Loss=1.1247
2025-06-02 15:44:05,078 - DEBUG - Online update step: 25/25
2025-06-02 15:44:05,087 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:05,179 - DEBUG - Node anomaly scores shape: torch.Size([15442, 1])
2025-06-02 15:44:05,184 - DEBUG - Edge anomaly scores shape: torch.Size([31771, 1])
2025-06-02 15:44:05,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:05,361 - DEBUG - Step 25: Loss=1.1056
2025-06-02 15:44:05,362 - INFO - Online update finished. Average loss: 1.2374, Learning rate: 0.001000
2025-06-02 15:44:05,362 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], current edge mean: [-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:44:05,363 - DEBUG - Node drift difference: 0.0150, Edge drift difference: 0.0018
2025-06-02 15:44:05,364 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], edge=[-2.0642301e-09  4.5980521e+02  0.0000000e+00  0.0000000e+00
 -1.0321151e-09  0.0000000e+00  3.0963452e-09 -6.1926904e-09
  4.1284602e-09 -2.0642301e-09]
2025-06-02 15:44:05,364 - DEBUG - Updated reference std: node=[0.         0.         1.0005779  1.0005779  0.         0.
 0.         1.0005778  1.0005778  1.0005779  1.0005779  1.0005779
 0.99914396 0.28549412 0.3677101  0.5709333  1.0005779  2.9968822
 2.89626    1.4954702  0.3677101  0.23786968 1.0005778  1.0005778
 0.         0.         0.         0.         1.0005778  1.0005778 ], edge=[  1.0002707 474.01376     0.          0.          1.0002707   1.0002707
   1.0002707   1.0002707   1.0002707   1.0002707]
2025-06-02 15:44:05,365 - INFO - Online update complete. Loss: 1.2374
2025-06-02 15:44:05,365 - INFO - Running anomaly detection...
2025-06-02 15:44:05,365 - INFO - Starting anomaly detection.
2025-06-02 15:44:05,374 - DEBUG - Node reconstruction errors: [ 0.68767005  3.3076446   8.462089    0.48575637  1.2745585   0.51448524
  8.053336    0.6889843   0.68898404  0.7195358   0.6889843   0.73665947
 12.169575    1.0649992   0.46074328  0.56063265  0.767296    0.56058997
  2.8249009   0.46875528  0.41833565  0.46074328  0.3964216   0.67681867
  0.41391864  0.5879081   0.4139185   1.5420222   0.5978061   0.4139185
  2.8758774   0.4783688   1.5025436   0.40361747  0.59497386  0.43513307
  0.41549316  0.46875528  1.4478371   1.0622071   0.36712113  0.37110755
  0.46875528  0.32987818  0.6285541   0.6239      0.4009411   0.5512525
  0.518339    1.063328    2.772489    0.50887424  0.514605    2.4355822
  0.33800697  1.0841038   4.7700725   0.31753448  2.6454208   2.3736398
  0.6723229   0.418495    0.2913271   0.81196314  0.3050916   0.33800694
  0.28905737  0.3380073   0.2913271   0.418495    0.29992884  0.50822467
  0.26994473  0.4410475   0.4082258   0.545413    0.3816211   0.43547133
  0.32899907  0.42512724  0.19833308  0.37042367  1.7483853   1.8682058
  0.3163174   1.0411141   0.30021474  0.30718434  0.43385366  0.26537007
  0.20617348  1.3244994   0.5946544   0.3319483   0.22061294  3.3003013
  0.1467255   0.3199653   0.13887252  0.29818404  0.37638175  0.14672555
  0.17755188  0.3644807   0.87193304  0.280656    0.88072693  0.4798442
  0.6031725   0.7541773   0.5157527   0.14952888  1.2955669   1.1255642
  0.3605141   0.24008441  0.32734284  1.1606585   0.3214873   0.19894807
  0.12863201  0.592156    1.0373112   0.6164129   0.32870105  0.19894938
  0.6507296   0.43782872  0.2717587   0.09808335  0.28897348  0.24476798
  1.5835956   1.5980159   0.29511204  0.27972224  0.1930819   0.16451153
  0.814556    1.5468398   0.3229616   0.269536    0.11180675  0.3229616
  0.28525564  0.31779277  0.32734305  0.50401425  0.23912825  0.31259978
  0.90558255  1.0456568   0.33138865  0.24476798  1.3334967   1.2053295
  0.22257644  0.24103029  0.37638175  0.2093002   0.3229616   0.5311554
  0.2225767   0.28897348  0.33661684  1.3879844   0.34545523  0.29302892
  0.56286234  0.3430096   0.3905067   0.19817081  0.18130708  3.2942073
  0.32148692  4.282205    0.27672234  0.2401969   0.31145895  0.31145886
  0.25347006  0.6538765   0.10356272  1.0788181   1.2755073   0.2475598
  0.07776438  0.31193802  0.25254586  0.19337387  0.2645916   0.2672945
  0.26337343  0.27287042  0.81455666  0.24086986  1.6903611   0.24730206
  1.1727717   0.2872847   0.10151056  0.22257644  1.2574902   0.32062346
  0.35790196  0.52275825  0.36304247  1.7551014   0.11984833  0.29941458
  0.27769276  0.30185017  0.30478498  0.25531864  0.23543255  0.09726641
  0.29970992  0.32734296  0.31594494  0.2728705   1.1196841   0.07776438
  0.13359006  0.30478498  0.2225767   0.26343933  1.1692411   0.30790013
  0.32341108  0.60932785  0.6796743   0.26485708  0.32881334  0.32734284
  0.327343    0.29192442  0.25343445  0.13359006  0.22257644  0.18451472
  1.180286    0.24271612  0.26149648  0.34300956  0.26267043  0.33930334
  0.2506909   0.25420505  0.2614963   0.2213333   0.18130706  0.17883328
  0.31594503  0.24769467  0.261593    0.35763296  0.19337389  0.07506904
  0.10746244  0.31145912  0.21382584  0.8153673   0.09446444  0.27776194
  0.33152372  0.19527434  0.2776731   2.8518016   0.27767313  0.21380812
  1.1440758   1.0416408   0.24386287  0.2980096   0.28722543  0.31145892
  0.08982694  0.47366518  0.25347006  0.27216402  1.7665621   0.11113728
  0.24244653  0.19078027  0.24503255  0.11792655  1.8690575   0.4431718
  0.6538765   0.78566796  0.35770398  0.08067992  0.22882882  0.26267043
  1.2751634   0.07700165  0.21492577  0.31145877  0.24086991  0.89116067
  0.22262697  0.08397947  0.24157985  0.22889331  0.0839796   0.08397947
  0.08397947  0.26820654  0.06760983  0.0839796   0.0839796   1.4536865
  0.0839796   0.17545554  0.58270997  0.2520767   0.22729005  0.62453955
  0.27588     0.23255704  0.2504268   0.19681515  0.31686786  0.24157982
  0.5693168   1.0569332   0.09719857  0.31323832  0.27140766  0.27140775
  0.25976855  0.22766475  0.0839796   0.28722525  0.0839796   0.2682065
  0.348586    0.1305111   0.09719857  0.09719857  0.0839796   0.13113147
  0.09719864  0.25672254  0.27588814  0.2274661   0.2415797   0.10362684
  0.30732095  0.29039833  0.08397947  0.21362476  1.1025231   0.24288501
  0.1067816   0.19337387  0.05308084  0.0839796   0.11810105  1.9260452
  0.2776925   0.17993592  0.3564926   0.19909789  0.24157986  3.4381874
  0.0750307   1.3677247   0.24932232  0.2029873   0.1935638   0.1964964
  0.21605088  1.0751535   0.2946256   0.24291846  0.09520411  0.22197871
  0.1885051   0.0839796   0.24157962  0.47104818  0.17675442  0.2082666
  0.48110738  0.24527784  0.34879348  0.8291416   0.28529865  0.0839796
  0.5676109   0.2956477   0.21728297  1.1852696   0.239569    0.23956887
  0.23956887  2.495429    0.06027076  2.4901705   0.16947918  0.37029722
  0.23956887  0.06027076  0.20916623  0.21728283  0.2583606   0.17336068
  0.21728279  0.54283696  0.23956886  0.21728273  0.06027076  0.23956886
  0.239569    0.05700292  0.09972973  0.23956886  0.09520383  0.1592122
  0.17414328  0.1898418   0.18916212  0.17078018  1.0824991   0.21357031
  0.23729481  0.340706    0.5290673   0.720657    0.20474656  0.2333433
  0.20119505  0.22563007  0.239569    0.23956887  0.16947916  0.21389061
  1.0644674   0.04988438  0.14446798  0.19209869  0.45972046  0.03580895
  0.04371274  1.4812684   1.4562595   0.18330453  0.24079204  0.17679758
  0.20462745  0.05010457  0.18378004  0.04656051  0.05010457  0.24037103
  0.17078003  0.1765863   0.08477448  0.25296536  0.20908807  0.18882991
  0.17175221  0.71649253  0.17175221  0.18882991  0.06730461  0.21988621
  0.57906073  0.23088299  0.06730472  0.20908816  0.18645069  1.417836
  0.26735222  0.18916184  0.2198863   0.20908806  0.03891397  0.19726302
  0.06983223  1.3994619   0.12208614  0.18330455  1.1546663   0.05735709
  0.05010457  0.5251146   0.09198232  1.4115767   0.17278354  0.03891397
  0.18809481  0.04272198  0.16830847  0.1765863   0.18172051  2.4748328
  0.04656038  0.19726302  0.36791557  0.04272198  0.36791557  0.06011937
  0.05146427  0.6794924   0.0385848   1.9129285   0.24413446  0.05010457
  0.6953216   0.18268129  0.18268129  0.04371266  0.1882157   0.10835698
  0.0385848   0.1861367   0.1679137   0.17132036  0.18613638  0.19209881
  0.0385848   0.25575024  0.05146427  0.18172023  0.24340247  0.7120449
  0.18613628  0.20489582  0.10835698  0.04656051  0.04656051  0.1972629
  0.18172058  0.18940458  0.16461986  0.1865815   0.04656038  0.21877773
  0.04656051  0.21877773  0.13952567  0.18613657  0.19562674  2.4864614
  0.55603296  0.04260329  1.9326923   0.04260329  0.04260341  0.0426034
  0.0426034   0.0426034   0.0426034   0.0426034   0.18316773  0.22150064
  0.11314484  0.0426034   0.0426034   0.0426034   0.0426034   0.0426034
  0.0426034   0.0426034   0.0426034   0.04260329  0.17615677  0.0426034
  0.0426034   1.2401314   0.0426034   0.7153122   0.145074    0.04656051
  0.13845868  0.24736373  1.1402454   1.1402454   0.20212878  0.13845868
  0.04656051  0.0385848   0.0385848   0.04656051  0.0385848   0.11143216
  0.2302222   0.0426034   0.19209869  0.04656051  0.1826814   0.04656051
  0.04656051  0.15094289  0.04656051  0.0385848   0.04656051  0.04656051
  0.18613671  0.0385848   0.04656051  0.0385848   0.04656051  0.04656051
  0.04656046  0.15872559  0.27129036  0.16830842  0.04260329  0.245677
  0.1651795   0.04656051  0.0385848   0.162065    0.04260329  0.11506812
  0.22157815  0.03683649  0.04656051  0.04656051  0.16439946  0.15148516
  0.16976257  0.04656051  0.18316777  0.05190544  0.0385848   0.6827196
  0.0426034   0.2998873   0.28750107  0.04260329  0.04260329  0.1831679
  0.05190543  0.04656038  0.40757513  0.20867889  0.20982762  0.15148535
  0.13471311  0.18546139  0.18546133  0.13483344  0.07524703  0.04260329
  0.19138628  0.22610773  0.15148534  0.16663228  0.10210656  0.04606034
  0.04815995  0.04815995  0.04815995  0.04815995  0.04815995  0.1785934
  0.24571241  0.04815996  0.04815996  0.04260329  0.06623241  0.0426034
  0.18546139  0.14453225  0.25004998  0.07007033  0.18546137  0.16367434
  0.17615679  0.08572852  0.17615673  0.0426034   0.18546133  0.04546808
  0.03893561  0.03893561  0.04815996  0.04546808  0.16145746  0.08060326
  0.15481256  0.0426034   0.04815995  0.07935703  0.03893561  0.05073833
  0.04606035  0.06226991  0.17859344  1.5338339   0.06226988  1.372593
  0.17691526  0.04606033  0.23949744  0.04950354  0.06007155  0.11515484
  0.18047947  0.06437838  0.17676029  0.04606035  0.04606035  0.04606035
  0.04441694  0.04606035  0.04606036  0.06007157  0.04606035  0.04606036
  0.04606033  0.18864998  0.06371547  0.25193164  0.17983182  0.17579731
  0.26486054  0.0737792   0.18187763  2.6317627   0.08488841  0.08863009
  0.1631049   0.34501785  0.34501785  0.06007157  1.4123871   0.25907618
  0.08488899  0.09120014  0.2431527   1.502809    0.12514517  0.12514517
  0.12514514  0.13006051  0.1360144   0.96244335  0.48875585  0.46063942
  0.1622376   0.1328846   0.28877506  0.09120014  0.31752744  0.24067946
  0.09395096  0.34658557  0.08488896  0.25907657  0.09120014  0.24067944
  0.1328846   1.2864071   0.12514514  0.13006051  0.093951    0.27537563
  0.39611265  0.13006051  0.13006051  0.13006051  0.3441606   0.26372194
  4.3255157   0.12514517  0.20273498  0.13006051  0.20809667  0.3864463
  2.7978919   0.3864463   0.13006051  0.18104777  0.47989905  0.12121094
  0.6720095   0.38644633  2.8319006   0.25871262  0.33660683  0.3864463
  0.26927     0.45808586  0.29420504  0.23297293  0.31692526  0.16949436
  0.16949436  0.23297304  0.67200965  0.18104777  0.3864463   0.29420492
  0.3864463   0.23016657  0.23016657  0.23016657  0.1903188   0.35830197
  0.23016654  0.23016657  0.25689587  0.44122943  0.23016635  0.23016635
  0.24420474  0.5320593   0.31505683  0.29132465  0.23016635  0.35514048
  0.44122943  0.23016654  0.30302125  0.4465235   0.29091513  0.25689587
  1.0805745   0.4465235   0.23016654  0.4465235   0.47252527  0.3550219
  0.65496963  0.23016654  0.7358812   0.47252527  0.47252527  0.5320595
  0.31945994  0.47252548  0.30302125  0.38510504  0.3349082   0.6149522
  0.5258378   0.6149525   0.8508342   0.30302098  0.5258378   0.40409505
  0.40409526  3.0289357   0.40409523  0.5559438   0.31945994  0.6499721
  0.5732561   0.3349082   0.5732564   1.2710892   0.30302098  1.1796606
  0.40409505  0.47277936  0.38510504  0.40409526  0.43170363  0.33490863
  0.47277933  0.33490857]
2025-06-02 15:44:05,375 - DEBUG - Edge reconstruction errors: [  5.2639685   5.263185   44.259083  ...  13.359064  535.25946
  13.359064 ]
2025-06-02 15:44:05,377 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154405_update_36.json
2025-06-02 15:44:05,377 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:44:05,386 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154405_update_36.pth and as latest_checkpoint.pth
2025-06-02 15:44:05,386 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.5406
2025-06-02 15:44:05,386 - WARNING - Detected 24 anomalous nodes (reconstruction-based):
2025-06-02 15:44:05,386 - WARNING -   Node ID: 192.168.239.101, Recon Error: 3.3076, MLP Score: 0.5588
2025-06-02 15:44:05,386 - WARNING -   Node ID: 192.168.27.13, Recon Error: 8.4621, MLP Score: 0.5098
2025-06-02 15:44:05,387 - WARNING -   Node ID: 192.168.27.12, Recon Error: 8.0533, MLP Score: 0.5252
2025-06-02 15:44:05,387 - WARNING -   Node ID: 192.168.27.10, Recon Error: 12.1696, MLP Score: 0.5288
2025-06-02 15:44:05,387 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.8249, MLP Score: 0.4993
2025-06-02 15:44:05,387 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:44:05,387 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2591, MLP Score: 0.0000
2025-06-02 15:44:05,387 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9608, MLP Score: 0.0000
2025-06-02 15:44:05,387 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0615, MLP Score: 0.0000
2025-06-02 15:44:05,387 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7601, MLP Score: 0.0000
2025-06-02 15:44:05,387 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.0000
2025-06-02 15:44:05,393 - DEBUG - Embedding standard deviations before t-SNE: [1.0840716  0.         0.46454963 0.7757814  1.3702029  0.
 0.742907   0.64237845 1.786336   0.9186726  0.63766855 0.06938354
 1.5066582  0.30794516 0.81883323 1.2043397  0.         0.4308279
 0.         0.05823632 2.6876988  0.6867753  0.         1.0172418
 0.5750065  0.44826737 0.         0.7162955  1.7708484  0.
 1.2331116  0.2759165 ]
2025-06-02 15:44:06,324 - INFO - Embeddings visualization saved to vis/embeddings_36_updates_20250602_154405.png
2025-06-02 15:44:06,324 - INFO - Performing visualization of node and edge features.
2025-06-02 15:44:06,326 - INFO - Starting visualization of node features.
2025-06-02 15:44:06,326 - INFO - Graph has 866 nodes and 30 features.
2025-06-02 15:44:06,326 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:44:06,326 - INFO - Calculating feature statistics:
2025-06-02 15:44:06,326 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,326 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,326 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(-3.5239697e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0430336), 'max': np.float32(2.4478908)}
2025-06-02 15:44:06,326 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(-7.0479395e-08), 'std': np.float32(1.0), 'min': np.float32(-2.36622), 'max': np.float32(2.1294224)}
2025-06-02 15:44:06,326 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,327 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,327 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,327 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45955282), 'max': np.float32(2.1760283)}
2025-06-02 15:44:06,327 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1335609), 'max': np.float32(0.88217574)}
2025-06-02 15:44:06,327 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-9.6710415), 'max': np.float32(0.106151916)}
2025-06-02 15:44:06,327 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6916394), 'max': np.float32(1.5956728)}
2025-06-02 15:44:06,327 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5623697), 'max': np.float32(2.8000467)}
2025-06-02 15:44:06,327 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.3048499), 'std': np.float32(0.9985669), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:44:06,327 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9584296), 'std': np.float32(0.28532922), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:44:06,327 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:44:06,327 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.400693), 'std': np.float32(0.57060355), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:44:06,327 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.106151916), 'max': np.float32(9.6710415)}
2025-06-02 15:44:06,327 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3418014), 'std': np.float32(2.995151), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:44:06,328 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8198614), 'std': np.float32(2.8945873), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:44:06,328 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6073904), 'std': np.float32(1.4946064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:44:06,328 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:44:06,328 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9919167), 'std': np.float32(0.23773229), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:44:06,328 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.982233e-08), 'std': np.float32(1.0), 'min': np.float32(-0.133326), 'max': np.float32(15.61126)}
2025-06-02 15:44:06,328 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.4227292e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.14569288), 'max': np.float32(6.8637533)}
2025-06-02 15:44:06,328 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,328 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,328 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,328 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:06,328 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.809924e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.9807018), 'max': np.float32(8.856608)}
2025-06-02 15:44:06,328 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.6429774e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0817144), 'max': np.float32(4.494266)}
2025-06-02 15:44:06,341 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18a6fe30>
2025-06-02 15:44:06,477 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:44:06,529 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:44:06,558 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:44:07,979 - INFO - Node feature visualization saved to vis/node_features_20250602_154406.png
2025-06-02 15:44:07,980 - INFO - Finished visualization of node features.
2025-06-02 15:44:07,980 - INFO - Performing additional feature analysis:
2025-06-02 15:44:07,980 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:44:07,981 - INFO - Starting visualization of edge features.
2025-06-02 15:44:07,981 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:44:07,981 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:44:07,981 - INFO - Calculating edge feature statistics:
2025-06-02 15:44:07,982 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:44:07,982 - INFO - - count: {'name': 'count', 'unique': 32, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.036982697), 'max': np.float32(35.559486)}
2025-06-02 15:44:07,982 - INFO - - dst_port: {'name': 'dst_port', 'unique': 18, 'mean': np.float32(459.8052), 'std': np.float32(473.8855), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:44:07,982 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:07,982 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:44:07,982 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1235, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05767335), 'max': np.float32(34.11734)}
2025-06-02 15:44:07,982 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1316, 'mean': np.float32(2.0642301e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05346426), 'max': np.float32(34.90347)}
2025-06-02 15:44:07,982 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 421, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.045245994), 'max': np.float32(35.391674)}
2025-06-02 15:44:07,982 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1284, 'mean': np.float32(-4.1284602e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08053714), 'max': np.float32(28.465456)}
2025-06-02 15:44:07,982 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1305, 'mean': np.float32(3.0963452e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081029944), 'max': np.float32(27.663826)}
2025-06-02 15:44:07,982 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 468, 'mean': np.float32(1.0321151e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05446046), 'max': np.float32(34.686768)}
2025-06-02 15:44:07,993 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c1b12a870>
2025-06-02 15:44:08,083 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:44:08,093 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08b24410>
2025-06-02 15:44:08,178 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:44:08,339 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:44:08,503 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:44:08,521 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:44:08,527 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:44:09,908 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154408.png
2025-06-02 15:44:09,909 - INFO - Finished visualization of edge features.
2025-06-02 15:44:09,909 - INFO - Performing additional edge feature analysis:
2025-06-02 15:44:09,909 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:44:09,909 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:44:09,910 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:44:09,911 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 15:44:09,911 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:44:10,433 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154409_summary.png
2025-06-02 15:44:10,721 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154409_pca_3d.png
2025-06-02 15:44:10,898 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154409_pca_variance.png
2025-06-02 15:44:10,898 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:44:10,898 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-02 15:44:10,898 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:44:10,898 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:44:10,898 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 15:44:10,914 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:44:10,932 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 15:44:10,932 - INFO - Processing node updates/additions.
2025-06-02 15:44:10,938 - INFO - Processing edge updates/additions.
2025-06-02 15:44:10,950 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:44:10,951 - INFO - Finished updating NetworkX graph.
2025-06-02 15:44:10,952 - DEBUG - Updated graph - Nodes: 894, Edges: 1887
2025-06-02 15:44:10,952 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:44:10,954 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:44:10,964 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-02 15:44:10,965 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:44:10,966 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-02 15:44:10,968 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-02 15:44:10,969 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:44:10,975 - DEBUG - Initial edge attributes tensor shape: torch.Size([1887, 10])
2025-06-02 15:44:10,977 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:44:10,978 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1887, 10])
2025-06-02 15:44:10,978 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:44:10,978 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:44:10,980 - INFO - Updated main graph to 894 nodes and 1887 edges.
2025-06-02 15:44:10,980 - INFO - Performing online update...
2025-06-02 15:44:10,980 - INFO - Starting online update for 25 steps.
2025-06-02 15:44:10,981 - DEBUG - Updated RunningStats: new_mean=0.9438908178123014, new_var=21000000000162.062, new_n=2130
2025-06-02 15:44:10,981 - DEBUG - Updated RunningStats: new_mean=0.9410268868966298, new_var=21300000000017.93, new_n=2160
2025-06-02 15:44:10,981 - DEBUG - Updated RunningStats: new_mean=44.43380237466284, new_var=7000000189529.252, new_n=710
2025-06-02 15:44:10,981 - DEBUG - Updated RunningStats: new_mean=44.47826031662791, new_var=7100000197702.887, new_n=720
2025-06-02 15:44:10,981 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:44:10,981 - DEBUG - Online update step: 1/25
2025-06-02 15:44:10,984 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:11,085 - DEBUG - Node anomaly scores shape: torch.Size([15691, 1])
2025-06-02 15:44:11,090 - DEBUG - Edge anomaly scores shape: torch.Size([32280, 1])
2025-06-02 15:44:11,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:11,301 - DEBUG - Step 1: Loss=1.0989
2025-06-02 15:44:11,301 - DEBUG - Online update step: 2/25
2025-06-02 15:44:11,304 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:11,376 - DEBUG - Node anomaly scores shape: torch.Size([15430, 1])
2025-06-02 15:44:11,380 - DEBUG - Edge anomaly scores shape: torch.Size([31642, 1])
2025-06-02 15:44:11,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:11,509 - DEBUG - Step 2: Loss=1.0965
2025-06-02 15:44:11,509 - DEBUG - Online update step: 3/25
2025-06-02 15:44:11,512 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:11,680 - DEBUG - Node anomaly scores shape: torch.Size([15718, 1])
2025-06-02 15:44:11,684 - DEBUG - Edge anomaly scores shape: torch.Size([32397, 1])
2025-06-02 15:44:11,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:11,896 - DEBUG - Step 3: Loss=1.0838
2025-06-02 15:44:11,896 - DEBUG - Online update step: 4/25
2025-06-02 15:44:11,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:11,983 - DEBUG - Node anomaly scores shape: torch.Size([16505, 1])
2025-06-02 15:44:11,988 - DEBUG - Edge anomaly scores shape: torch.Size([34306, 1])
2025-06-02 15:44:11,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:12,180 - DEBUG - Step 4: Loss=1.0718
2025-06-02 15:44:12,180 - DEBUG - Online update step: 5/25
2025-06-02 15:44:12,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:12,272 - DEBUG - Node anomaly scores shape: torch.Size([16421, 1])
2025-06-02 15:44:12,279 - DEBUG - Edge anomaly scores shape: torch.Size([33874, 1])
2025-06-02 15:44:12,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:12,566 - DEBUG - Step 5: Loss=1.0684
2025-06-02 15:44:12,567 - DEBUG - Online update step: 6/25
2025-06-02 15:44:12,570 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:12,721 - DEBUG - Node anomaly scores shape: torch.Size([15237, 1])
2025-06-02 15:44:12,725 - DEBUG - Edge anomaly scores shape: torch.Size([31303, 1])
2025-06-02 15:44:12,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:13,259 - DEBUG - Step 6: Loss=1.0640
2025-06-02 15:44:13,259 - DEBUG - Online update step: 7/25
2025-06-02 15:44:13,262 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:13,799 - DEBUG - Node anomaly scores shape: torch.Size([15843, 1])
2025-06-02 15:44:13,803 - DEBUG - Edge anomaly scores shape: torch.Size([32645, 1])
2025-06-02 15:44:13,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:13,948 - DEBUG - Step 7: Loss=1.0572
2025-06-02 15:44:13,949 - DEBUG - Online update step: 8/25
2025-06-02 15:44:13,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:14,094 - DEBUG - Node anomaly scores shape: torch.Size([15677, 1])
2025-06-02 15:44:14,103 - DEBUG - Edge anomaly scores shape: torch.Size([32222, 1])
2025-06-02 15:44:14,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:14,276 - DEBUG - Step 8: Loss=1.0515
2025-06-02 15:44:14,276 - DEBUG - Online update step: 9/25
2025-06-02 15:44:14,280 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:14,364 - DEBUG - Node anomaly scores shape: torch.Size([16258, 1])
2025-06-02 15:44:14,373 - DEBUG - Edge anomaly scores shape: torch.Size([33514, 1])
2025-06-02 15:44:14,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:14,578 - DEBUG - Step 9: Loss=1.0434
2025-06-02 15:44:14,578 - DEBUG - Online update step: 10/25
2025-06-02 15:44:14,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:14,672 - DEBUG - Node anomaly scores shape: torch.Size([16336, 1])
2025-06-02 15:44:14,677 - DEBUG - Edge anomaly scores shape: torch.Size([33806, 1])
2025-06-02 15:44:14,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:14,868 - DEBUG - Step 10: Loss=1.0354
2025-06-02 15:44:14,868 - DEBUG - Online update step: 11/25
2025-06-02 15:44:14,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:14,976 - DEBUG - Node anomaly scores shape: torch.Size([15098, 1])
2025-06-02 15:44:14,982 - DEBUG - Edge anomaly scores shape: torch.Size([31003, 1])
2025-06-02 15:44:14,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:15,171 - DEBUG - Step 11: Loss=1.0345
2025-06-02 15:44:15,171 - DEBUG - Online update step: 12/25
2025-06-02 15:44:15,174 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:15,258 - DEBUG - Node anomaly scores shape: torch.Size([16172, 1])
2025-06-02 15:44:15,261 - DEBUG - Edge anomaly scores shape: torch.Size([33273, 1])
2025-06-02 15:44:15,262 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:15,424 - DEBUG - Step 12: Loss=1.0270
2025-06-02 15:44:15,424 - DEBUG - Online update step: 13/25
2025-06-02 15:44:15,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:15,534 - DEBUG - Node anomaly scores shape: torch.Size([16000, 1])
2025-06-02 15:44:15,538 - DEBUG - Edge anomaly scores shape: torch.Size([33029, 1])
2025-06-02 15:44:15,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:15,763 - DEBUG - Step 13: Loss=1.0179
2025-06-02 15:44:15,764 - DEBUG - Online update step: 14/25
2025-06-02 15:44:15,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:15,895 - DEBUG - Node anomaly scores shape: torch.Size([16042, 1])
2025-06-02 15:44:15,899 - DEBUG - Edge anomaly scores shape: torch.Size([33147, 1])
2025-06-02 15:44:15,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:16,133 - DEBUG - Step 14: Loss=1.0123
2025-06-02 15:44:16,133 - DEBUG - Online update step: 15/25
2025-06-02 15:44:16,137 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:17,111 - DEBUG - Node anomaly scores shape: torch.Size([16520, 1])
2025-06-02 15:44:17,202 - DEBUG - Edge anomaly scores shape: torch.Size([34178, 1])
2025-06-02 15:44:17,265 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:18,871 - DEBUG - Step 15: Loss=1.0054
2025-06-02 15:44:18,872 - DEBUG - Online update step: 16/25
2025-06-02 15:44:18,875 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:19,954 - DEBUG - Node anomaly scores shape: torch.Size([15050, 1])
2025-06-02 15:44:20,031 - DEBUG - Edge anomaly scores shape: torch.Size([30897, 1])
2025-06-02 15:44:20,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:21,739 - DEBUG - Step 16: Loss=1.0042
2025-06-02 15:44:21,740 - DEBUG - Online update step: 17/25
2025-06-02 15:44:21,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:22,898 - DEBUG - Node anomaly scores shape: torch.Size([15807, 1])
2025-06-02 15:44:23,006 - DEBUG - Edge anomaly scores shape: torch.Size([32572, 1])
2025-06-02 15:44:23,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:24,644 - DEBUG - Step 17: Loss=0.9973
2025-06-02 15:44:24,645 - DEBUG - Online update step: 18/25
2025-06-02 15:44:24,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:25,867 - DEBUG - Node anomaly scores shape: torch.Size([16260, 1])
2025-06-02 15:44:25,992 - DEBUG - Edge anomaly scores shape: torch.Size([33485, 1])
2025-06-02 15:44:26,057 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:28,313 - DEBUG - Step 18: Loss=0.9916
2025-06-02 15:44:28,314 - DEBUG - Online update step: 19/25
2025-06-02 15:44:28,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:29,184 - DEBUG - Node anomaly scores shape: torch.Size([16226, 1])
2025-06-02 15:44:29,265 - DEBUG - Edge anomaly scores shape: torch.Size([33381, 1])
2025-06-02 15:44:29,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:29,641 - DEBUG - Step 19: Loss=0.9880
2025-06-02 15:44:29,641 - DEBUG - Online update step: 20/25
2025-06-02 15:44:29,644 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:30,106 - DEBUG - Node anomaly scores shape: torch.Size([14591, 1])
2025-06-02 15:44:30,110 - DEBUG - Edge anomaly scores shape: torch.Size([29830, 1])
2025-06-02 15:44:30,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:30,404 - DEBUG - Step 20: Loss=0.9855
2025-06-02 15:44:30,405 - DEBUG - Online update step: 21/25
2025-06-02 15:44:30,407 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:31,281 - DEBUG - Node anomaly scores shape: torch.Size([15844, 1])
2025-06-02 15:44:31,367 - DEBUG - Edge anomaly scores shape: torch.Size([32678, 1])
2025-06-02 15:44:31,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:32,658 - DEBUG - Step 21: Loss=0.9772
2025-06-02 15:44:32,659 - DEBUG - Online update step: 22/25
2025-06-02 15:44:32,662 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:32,934 - DEBUG - Node anomaly scores shape: torch.Size([15925, 1])
2025-06-02 15:44:32,944 - DEBUG - Edge anomaly scores shape: torch.Size([32845, 1])
2025-06-02 15:44:32,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:33,257 - DEBUG - Step 22: Loss=0.9711
2025-06-02 15:44:33,258 - DEBUG - Online update step: 23/25
2025-06-02 15:44:33,261 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:33,762 - DEBUG - Node anomaly scores shape: torch.Size([15708, 1])
2025-06-02 15:44:33,766 - DEBUG - Edge anomaly scores shape: torch.Size([32334, 1])
2025-06-02 15:44:33,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:34,031 - DEBUG - Step 23: Loss=0.9663
2025-06-02 15:44:34,031 - DEBUG - Online update step: 24/25
2025-06-02 15:44:34,038 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:34,178 - DEBUG - Node anomaly scores shape: torch.Size([16075, 1])
2025-06-02 15:44:34,182 - DEBUG - Edge anomaly scores shape: torch.Size([33126, 1])
2025-06-02 15:44:34,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:34,357 - DEBUG - Step 24: Loss=0.9601
2025-06-02 15:44:34,358 - DEBUG - Online update step: 25/25
2025-06-02 15:44:34,363 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:34,439 - DEBUG - Node anomaly scores shape: torch.Size([15175, 1])
2025-06-02 15:44:34,443 - DEBUG - Edge anomaly scores shape: torch.Size([31145, 1])
2025-06-02 15:44:34,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:34,604 - DEBUG - Step 25: Loss=0.9579
2025-06-02 15:44:34,604 - INFO - Online update finished. Average loss: 1.0227, Learning rate: 0.001000
2025-06-02 15:44:34,605 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], current edge mean: [-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:44:34,605 - DEBUG - Node drift difference: 0.0192, Edge drift difference: 0.0020
2025-06-02 15:44:34,606 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], edge=[-2.0215671e-09  4.5887280e+02  0.0000000e+00  0.0000000e+00
  2.0215671e-09  5.0539177e-09  0.0000000e+00 -3.5377425e-09
  3.5377425e-09  3.0323508e-09]
2025-06-02 15:44:34,607 - DEBUG - Updated reference std: node=[0.         0.         1.0005598  1.0005598  0.         0.
 0.         1.0005598  1.0005598  1.0005598  1.0005598  1.0005598
 0.97541434 0.28107604 0.36824727 0.5703764  1.0005598  2.9711607
 2.8818514  1.4734278  0.36824727 0.23411502 1.0005598  1.0005598
 0.         0.         0.         0.         1.0005598  1.0005597 ], edge=[  1.0002651 469.3459      0.          0.          1.0002651   1.0002651
   1.0002651   1.000265    1.0002651   1.0002651]
2025-06-02 15:44:34,607 - INFO - Online update complete. Loss: 1.0227
2025-06-02 15:44:34,607 - INFO - Running anomaly detection...
2025-06-02 15:44:34,608 - INFO - Starting anomaly detection.
2025-06-02 15:44:34,619 - DEBUG - Node reconstruction errors: [ 0.7137931   2.6303747   7.104915    0.40898943  0.9603935   0.30491155
  6.53982     0.52290124  0.52290124  0.5506487   0.5229014   0.5941715
 10.618512    0.9738378   0.38461646  0.46084592  0.6179864   0.46084592
  2.6101682   0.3888667   0.3248736   0.38461646  0.4780616   0.5676117
  0.347413    0.44411686  0.34741274  1.177424    0.45459136  0.347413
  2.659837    0.42711896  1.1085464   0.3472915   0.44583973  0.36045036
  0.31305414  0.3888665   0.9846767   0.9604667   0.32899377  0.31454098
  0.3888665   0.31853226  0.62952256  0.4962432   0.3747093   0.51354295
  0.3962732   1.0180137   2.0908244   0.3745375   0.3922545   2.2811368
  0.27129936  0.8344326   3.4913409   0.26659942  2.4377005   2.1979358
  0.6087319   0.36865026  0.2521351   0.76214004  0.26327354  0.27129906
  0.21771893  0.27129924  0.2521351   0.36865026  0.24834742  0.31145135
  0.20199902  0.28408587  0.2522717   0.33303508  0.37123123  0.26751807
  0.18800452  0.25538874  0.1931254   0.21278402  1.584436    1.6053903
  0.16946211  0.8622159   0.14945492  0.16809972  0.28527826  0.23172808
  0.18018208  1.0267223   0.5156469   0.19736384  0.29366297  2.6077812
  0.15516481  0.18489501  0.12905745  0.23655024  0.21096465  0.15516481
  0.20543751  0.31519654  0.7490533   0.22596614  0.7386312   0.39615554
  0.51940304  0.7659923   0.51484793  0.15897965  1.089723    0.8591255
  0.19263966  0.1007369   0.17258522  0.89133793  0.1876435   0.1473291
  0.11873858  0.49289587  0.81065655  0.537217    0.22873154  0.14732938
  0.5799946   0.36959457  0.21150854  0.09681238  0.23518012  0.18037696
  1.0781718   1.279394    0.14602076  0.22314341  0.20512149  0.15018588
  0.6973121   1.0684227   0.25234458  0.13487734  0.10675466  0.25234458
  0.22162144  0.16245045  0.17258525  0.40801015  0.3124146   0.17776927
  0.8392933   0.86420405  0.19889437  0.18037707  0.99733245  0.90026855
  0.16673979  0.11218417  0.21096478  0.22665653  0.25234458  0.43570918
  0.16673979  0.23518012  0.17800178  1.062253    0.18743722  0.16194801
  0.4591249   0.23260148  0.2372612   0.14687732  0.15901312  2.5912704
  0.18764308  4.538359    0.15258744  0.13382562  0.16369225  0.1636922
  0.2070002   0.5724038   0.19629866  0.8526691   0.94835764  0.13401629
  0.07694279  0.17478547  0.20376475  0.14513193  0.14364706  0.14856109
  0.23077148  0.20080562  0.6973114   0.20984541  1.5528867   0.22046813
  0.9027489   0.2799822   0.09828139  0.16673979  1.026136    0.18243939
  0.21749741  0.42863947  0.3068098   1.3849181   0.11359877  0.17060441
  0.13604745  0.15759465  0.2569682   0.1343517   0.13447355  0.09904427
  0.16898613  0.17258501  0.22406028  0.20080562  0.8551423   0.07694279
  0.11855387  0.25696805  0.16673979  0.15642765  0.8986737   0.22506586
  0.19308962  0.5193345   0.585097    0.1648039   0.18685944  0.17258498
  0.17258507  0.22709437  0.14182284  0.11855387  0.16673979  0.19281773
  0.89319265  0.12396013  0.19264795  0.23531698  0.1944347   0.23531744
  0.12510248  0.1307548   0.19264795  0.16673723  0.1590131   0.15929571
  0.22406045  0.12949176  0.11828534  0.21941513  0.14513181  0.07467046
  0.1047002   0.16369228  0.10740127  0.706259    0.07679302  0.20959902
  0.19527483  0.2748222   0.18666321  2.5988948   0.18666317  0.09060492
  0.91061157  0.8180383   0.13357058  0.4123287   0.14635447  0.16369237
  0.09720198  0.31065947  0.2070002   0.15241273  1.3645653   0.11437048
  0.13231175  0.1968531   0.14358374  0.12137011  1.3600963   0.36031628
  0.5724038   0.8076984   0.27334884  0.10377467  0.16553068  0.1944347
  1.2619109   0.07539527  0.10964563  0.16369154  0.2098453   0.75914156
  0.12160171  0.07975676  0.11462436  0.13653651  0.07975676  0.07975677
  0.07975677  0.13801607  0.20303956  0.07975677  0.07975677  1.0814514
  0.07975676  0.12977852  0.5169893   0.1487782   0.21228568  0.54432636
  0.23724337  0.20336671  0.16294171  0.14491245  0.20377636  0.11462415
  0.47411984  0.8321553   0.23599467  0.19753763  0.15954472  0.15954475
  0.27785045  0.1983353   0.07975676  0.14635445  0.07975676  0.13801609
  0.26206136  0.11931201  0.09387925  0.0938793   0.07975677  0.11318258
  0.09387925  0.15192632  0.15572143  0.1313775   0.11462419  0.11030675
  0.20684789  0.16727014  0.07975676  0.09296174  0.83546525  0.13210702
  0.09327222  0.1451318   0.05302611  0.07975677  0.11104234  1.6932622
  0.13604732  0.12948065  0.28447503  0.12122025  0.11462394  2.685124
  0.07034007  1.0403022   0.12071379  0.08264396  0.0988793   0.11979569
  0.12596318  0.8224698   0.17390336  0.1321313   0.08596619  0.16077018
  0.11114004  0.07975677  0.11462434  0.39981505  0.12882848  0.11276975
  0.4064602   0.14360805  0.2841338   0.73393095  0.17582573  0.07975676
  0.37455755  0.18367478  0.09918704  0.911135    0.14392176  0.14392185
  0.14392199  2.2714086   0.05551815  2.2743874   0.12299947  0.21115163
  0.14392191  0.05551805  0.09687152  0.09918698  0.1573133   0.12444006
  0.09918725  0.4573213   0.14392205  0.09918725  0.05551815  0.14392193
  0.14392209  0.03915541  0.08403027  0.143922    0.08596385  0.12692815
  0.12364972  0.13856296  0.07675357  0.12218477  0.83579427  0.15404873
  0.1760493   0.14142141  0.44312078  0.60616094  0.14086379  0.18871103
  0.11095872  0.1296388   0.14392217  0.14392185  0.12299947  0.13620952
  0.82382     0.04196594  0.10626882  0.1378083   0.36619008  0.02930903
  0.03507911  1.1029178   1.1362875   0.1287398   0.20246278  0.12460294
  0.12494065  0.04204185  0.13033003  0.03834585  0.04204185  0.19025303
  0.12218475  0.23967722  0.09820256  0.1223416   0.09359892  0.13666059
  0.12261616  0.6237792   0.12261607  0.13666059  0.0621133   0.09812549
  0.48372325  0.1968268   0.06211333  0.09359865  0.10669955  0.927241
  0.17078976  0.0767526   0.09812565  0.09359886  0.03273939  0.1415894
  0.08591238  1.1147919   0.09915981  0.1287398   0.8849153   0.0446199
  0.04204185  0.44425184  0.05977697  0.9287964   0.06869666  0.03273939
  0.10458621  0.04065053  0.06435695  0.12686162  0.07604547  2.2136648
  0.03834585  0.14158937  0.2949088   0.04065053  0.2949088   0.063724
  0.0440345   0.58976215  0.03065641  1.4023565   0.17583008  0.04204185
  0.5950168   0.12979287  0.12979287  0.0350792   0.10693865  0.08033095
  0.03065644  0.07835533  0.18453231  0.09368619  0.07835535  0.1378083
  0.03065644  0.21640077  0.0440345   0.07604549  0.20461819  0.63845825
  0.07835522  0.13390064  0.08033095  0.03834585  0.03834583  0.14158937
  0.07604523  0.08063804  0.09421853  0.12225016  0.03834585  0.12209279
  0.03834585  0.12209292  0.1335842   0.07835522  0.13846502  1.9660794
  0.46895084  0.02800482  1.377178    0.02800482  0.02800482  0.02800482
  0.02800482  0.02800482  0.02800482  0.02800482  0.08198896  0.15582834
  0.07088946  0.02800482  0.02800482  0.02800482  0.02800482  0.02800482
  0.02800482  0.02800482  0.02800482  0.02800482  0.07430162  0.02800482
  0.02800482  1.0558642   0.02800482  0.62805766  0.11183698  0.03834583
  0.08197698  0.12886038  1.0690691   1.0690691   0.1332596   0.08197698
  0.03834585  0.03065644  0.03065644  0.03834583  0.03065643  0.10557941
  0.1636519   0.02800482  0.1378083   0.03834585  0.12979287  0.03834585
  0.03834585  0.1081146   0.03834585  0.03065644  0.03834585  0.03834585
  0.07835509  0.03065642  0.03834585  0.03065644  0.03834583  0.03834583
  0.03834585  0.10853292  0.17100878  0.06435699  0.02800482  0.194474
  0.11436003  0.03834585  0.03065644  0.11006691  0.02800482  0.08158055
  0.13310169  0.0279866   0.03834583  0.03834583  0.06884743  0.11110321
  0.0644436   0.03834585  0.08198906  0.03767737  0.03065642  0.5999637
  0.02800482  0.21719483  0.19857655  0.02800482  0.02800482  0.08198895
  0.03767737  0.03834585  0.34390467  0.11524925  0.14241628  0.11110323
  0.09138333  0.10901211  0.10901219  0.09364336  0.04785171  0.02800482
  0.1343557   0.12549594  0.11110323  0.0648663   0.06673442  0.11180685
  0.02444685  0.02444685  0.02444685  0.02444685  0.02444685  0.08020134
  0.147508    0.02444685  0.02444685  0.02800482  0.03999682  0.02800482
  0.10901219  0.10311437  0.14066236  0.03939272  0.10901213  0.10413389
  0.07430179  0.05187041  0.07430163  0.02800482  0.10901214  0.03280832
  0.02334302  0.02334302  0.02444676  0.03280832  0.10164768  0.03802587
  0.10449743  0.02800482  0.02444685  0.0416934   0.02334302  0.02927947
  0.02447857  0.0314351   0.08020114  1.0139803   0.03143496  1.041677
  0.07574704  0.02447857  0.16570431  0.02788305  0.02567654  0.057153
  0.11065793  0.02776369  0.10570092  0.02447857  0.02447857  0.02447857
  0.02133172  0.02447857  0.02447857  0.02567654  0.02447857  0.02447857
  0.02447857  0.08699994  0.02910186  0.16261418  0.12712012  0.09524814
  0.18014507  0.03115656  0.12096305  2.332816    0.03460127  0.03798437
  0.08092748  0.26113406  0.26113406  0.02567654  1.0767514   0.23802583
  0.03458349  0.03784051  0.15116815  1.1420367   0.05470179  0.05470179
  0.05470179  0.05592298  0.05754973  0.801286    0.39716876  0.36610827
  0.13082588  0.06071434  0.19824241  0.03784039  0.21563815  0.12839897
  0.03824443  0.27278426  0.03458339  0.23802191  0.03784039  0.12839885
  0.06071434  1.0845481   0.05470179  0.0559229   0.03824443  0.18974404
  0.29663405  0.0559229   0.05592298  0.0559229   0.23637697  0.15861243
  3.9318848   0.05470179  0.14863062  0.05592298  0.1199384   0.26571003
  2.429452    0.26570988  0.05592298  0.08237467  0.33346224  0.05113833
  0.52994996  0.26571     2.2108252   0.1844726   0.27427912  0.26570988
  0.1826238   0.3401362   0.18969235  0.20187727  0.20522562  0.07509773
  0.07509763  0.20187734  0.52994955  0.08237467  0.26571003  0.1896923
  0.26570988  0.10794924  0.10794924  0.10794915  0.0857636   0.29431316
  0.10794924  0.10794924  0.14545655  0.3487731   0.10794924  0.10794924
  0.11725311  0.40056577  0.29039517  0.29210028  0.10794924  0.2244781
  0.3487729   0.10794924  0.15046515  0.30022448  0.14545655  0.1234128
  0.8973839   0.30022448  0.10794924  0.30022448  0.3185201   0.27755785
  0.5126549   0.10794915  0.49145353  0.31852007  0.31852007  0.40056577
  0.16122524  0.31852007  0.15046515  0.2633497   0.17090136  0.45105585
  0.35647765  0.45105585  0.6879904   0.15046504  0.35647765  0.21451789
  0.21451789  2.6415243   0.21451788  0.37271795  0.16122524  0.47763678
  0.39904478  0.17090121  0.3990447   1.0444343   0.15046504  0.9608687
  0.21451789  0.3209321   0.2633497   0.21451788  0.34212014  0.17090121
  0.3209321   0.17090136  0.21451789  0.21451789  0.21451788  0.21451789
  0.21451788  0.20306765  0.4391627   0.20306747  0.43916273  0.20306765
  0.30307287  0.30307287  0.30307284  0.21451789  0.21451788  0.21451788
  0.21451788  2.3689241   0.4391627   0.20306747  0.21451788  0.21451788
  0.21451788  0.27210477  0.21451789  0.21451789  0.21451788  0.4391626 ]
2025-06-02 15:44:34,620 - DEBUG - Edge reconstruction errors: [  5.26371    5.262931  44.25883  ... 535.2592    13.358812   2.159841]
2025-06-02 15:44:34,622 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154434_update_37.json
2025-06-02 15:44:34,622 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:44:34,634 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154434_update_37.pth and as latest_checkpoint.pth
2025-06-02 15:44:34,634 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.5402
2025-06-02 15:44:34,634 - WARNING - Detected 25 anomalous nodes (reconstruction-based):
2025-06-02 15:44:34,634 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.6304, MLP Score: 0.5327
2025-06-02 15:44:34,634 - WARNING -   Node ID: 192.168.27.13, Recon Error: 7.1049, MLP Score: 0.5138
2025-06-02 15:44:34,634 - WARNING -   Node ID: 192.168.27.12, Recon Error: 6.5398, MLP Score: 0.5339
2025-06-02 15:44:34,634 - WARNING -   Node ID: 192.168.27.10, Recon Error: 10.6185, MLP Score: 0.5354
2025-06-02 15:44:34,635 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.6102, MLP Score: 0.5037
2025-06-02 15:44:34,635 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:44:34,635 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2588, MLP Score: 0.0000
2025-06-02 15:44:34,635 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9605, MLP Score: 0.0000
2025-06-02 15:44:34,635 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.0000
2025-06-02 15:44:34,635 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0000
2025-06-02 15:44:34,635 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7591, MLP Score: 0.0000
2025-06-02 15:44:34,635 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-02 15:44:34,635 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:44:34,635 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:44:34,635 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 15:44:34,663 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:44:34,688 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 15:44:34,688 - INFO - Processing node updates/additions.
2025-06-02 15:44:34,694 - INFO - Processing edge updates/additions.
2025-06-02 15:44:34,705 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:44:34,706 - INFO - Finished updating NetworkX graph.
2025-06-02 15:44:34,707 - DEBUG - Updated graph - Nodes: 901, Edges: 1907
2025-06-02 15:44:34,707 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:44:34,708 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:44:34,716 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-02 15:44:34,718 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:44:34,718 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-02 15:44:34,719 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-02 15:44:34,720 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:44:34,725 - DEBUG - Initial edge attributes tensor shape: torch.Size([1907, 10])
2025-06-02 15:44:34,726 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:44:34,726 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1907, 10])
2025-06-02 15:44:34,726 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:44:34,726 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:44:34,727 - INFO - Updated main graph to 901 nodes and 1907 edges.
2025-06-02 15:44:34,727 - INFO - Performing online update...
2025-06-02 15:44:34,727 - INFO - Starting online update for 25 steps.
2025-06-02 15:44:34,728 - DEBUG - Updated RunningStats: new_mean=0.944007361581552, new_var=21600000000162.066, new_n=2190
2025-06-02 15:44:34,728 - DEBUG - Updated RunningStats: new_mean=0.9412247215304804, new_var=21900000000017.934, new_n=2220
2025-06-02 15:44:34,728 - DEBUG - Updated RunningStats: new_mean=44.49685123472331, new_var=7200000189097.694, new_n=730
2025-06-02 15:44:34,728 - DEBUG - Updated RunningStats: new_mean=44.53611131325915, new_var=7300000195727.552, new_n=740
2025-06-02 15:44:34,728 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:44:34,728 - DEBUG - Online update step: 1/25
2025-06-02 15:44:34,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:34,799 - DEBUG - Node anomaly scores shape: torch.Size([17172, 1])
2025-06-02 15:44:34,803 - DEBUG - Edge anomaly scores shape: torch.Size([35644, 1])
2025-06-02 15:44:34,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:34,982 - DEBUG - Step 1: Loss=0.9476
2025-06-02 15:44:34,983 - DEBUG - Online update step: 2/25
2025-06-02 15:44:34,986 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:35,069 - DEBUG - Node anomaly scores shape: torch.Size([15966, 1])
2025-06-02 15:44:35,073 - DEBUG - Edge anomaly scores shape: torch.Size([32907, 1])
2025-06-02 15:44:35,075 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:35,237 - DEBUG - Step 2: Loss=0.9448
2025-06-02 15:44:35,238 - DEBUG - Online update step: 3/25
2025-06-02 15:44:35,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:35,335 - DEBUG - Node anomaly scores shape: torch.Size([15222, 1])
2025-06-02 15:44:35,339 - DEBUG - Edge anomaly scores shape: torch.Size([31229, 1])
2025-06-02 15:44:35,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:35,510 - DEBUG - Step 3: Loss=0.9440
2025-06-02 15:44:35,510 - DEBUG - Online update step: 4/25
2025-06-02 15:44:35,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:35,611 - DEBUG - Node anomaly scores shape: torch.Size([16085, 1])
2025-06-02 15:44:35,615 - DEBUG - Edge anomaly scores shape: torch.Size([33181, 1])
2025-06-02 15:44:35,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:35,787 - DEBUG - Step 4: Loss=0.9389
2025-06-02 15:44:35,787 - DEBUG - Online update step: 5/25
2025-06-02 15:44:35,794 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:35,881 - DEBUG - Node anomaly scores shape: torch.Size([16280, 1])
2025-06-02 15:44:35,886 - DEBUG - Edge anomaly scores shape: torch.Size([33641, 1])
2025-06-02 15:44:35,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:36,092 - DEBUG - Step 5: Loss=0.9379
2025-06-02 15:44:36,092 - DEBUG - Online update step: 6/25
2025-06-02 15:44:36,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:36,168 - DEBUG - Node anomaly scores shape: torch.Size([16515, 1])
2025-06-02 15:44:36,173 - DEBUG - Edge anomaly scores shape: torch.Size([34091, 1])
2025-06-02 15:44:36,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:36,315 - DEBUG - Step 6: Loss=0.9299
2025-06-02 15:44:36,315 - DEBUG - Online update step: 7/25
2025-06-02 15:44:36,323 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:36,463 - DEBUG - Node anomaly scores shape: torch.Size([15756, 1])
2025-06-02 15:44:36,466 - DEBUG - Edge anomaly scores shape: torch.Size([32478, 1])
2025-06-02 15:44:36,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:36,669 - DEBUG - Step 7: Loss=0.9238
2025-06-02 15:44:36,670 - DEBUG - Online update step: 8/25
2025-06-02 15:44:36,677 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:36,791 - DEBUG - Node anomaly scores shape: torch.Size([16521, 1])
2025-06-02 15:44:36,794 - DEBUG - Edge anomaly scores shape: torch.Size([34088, 1])
2025-06-02 15:44:36,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:36,961 - DEBUG - Step 8: Loss=0.9208
2025-06-02 15:44:36,962 - DEBUG - Online update step: 9/25
2025-06-02 15:44:36,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:37,051 - DEBUG - Node anomaly scores shape: torch.Size([15091, 1])
2025-06-02 15:44:37,056 - DEBUG - Edge anomaly scores shape: torch.Size([30927, 1])
2025-06-02 15:44:37,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:37,222 - DEBUG - Step 9: Loss=0.9214
2025-06-02 15:44:37,222 - DEBUG - Online update step: 10/25
2025-06-02 15:44:37,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:37,319 - DEBUG - Node anomaly scores shape: torch.Size([15979, 1])
2025-06-02 15:44:37,323 - DEBUG - Edge anomaly scores shape: torch.Size([32988, 1])
2025-06-02 15:44:37,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:37,502 - DEBUG - Step 10: Loss=0.9145
2025-06-02 15:44:37,503 - DEBUG - Online update step: 11/25
2025-06-02 15:44:37,509 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:37,708 - DEBUG - Node anomaly scores shape: torch.Size([16652, 1])
2025-06-02 15:44:37,744 - DEBUG - Edge anomaly scores shape: torch.Size([34291, 1])
2025-06-02 15:44:37,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:38,176 - DEBUG - Step 11: Loss=0.9148
2025-06-02 15:44:38,177 - DEBUG - Online update step: 12/25
2025-06-02 15:44:38,181 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:38,345 - DEBUG - Node anomaly scores shape: torch.Size([15517, 1])
2025-06-02 15:44:38,350 - DEBUG - Edge anomaly scores shape: torch.Size([31863, 1])
2025-06-02 15:44:38,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:38,721 - DEBUG - Step 12: Loss=0.9088
2025-06-02 15:44:38,721 - DEBUG - Online update step: 13/25
2025-06-02 15:44:38,727 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:39,888 - DEBUG - Node anomaly scores shape: torch.Size([16009, 1])
2025-06-02 15:44:39,966 - DEBUG - Edge anomaly scores shape: torch.Size([33154, 1])
2025-06-02 15:44:40,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:40,324 - DEBUG - Step 13: Loss=0.9001
2025-06-02 15:44:40,325 - DEBUG - Online update step: 14/25
2025-06-02 15:44:40,330 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:40,396 - DEBUG - Node anomaly scores shape: torch.Size([16524, 1])
2025-06-02 15:44:40,400 - DEBUG - Edge anomaly scores shape: torch.Size([34195, 1])
2025-06-02 15:44:40,401 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:40,540 - DEBUG - Step 14: Loss=0.8969
2025-06-02 15:44:40,541 - DEBUG - Online update step: 15/25
2025-06-02 15:44:40,546 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:40,718 - DEBUG - Node anomaly scores shape: torch.Size([16275, 1])
2025-06-02 15:44:40,722 - DEBUG - Edge anomaly scores shape: torch.Size([33625, 1])
2025-06-02 15:44:40,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:40,936 - DEBUG - Step 15: Loss=0.8960
2025-06-02 15:44:40,937 - DEBUG - Online update step: 16/25
2025-06-02 15:44:40,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:41,017 - DEBUG - Node anomaly scores shape: torch.Size([16116, 1])
2025-06-02 15:44:41,021 - DEBUG - Edge anomaly scores shape: torch.Size([33120, 1])
2025-06-02 15:44:41,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:41,159 - DEBUG - Step 16: Loss=0.8985
2025-06-02 15:44:41,160 - DEBUG - Online update step: 17/25
2025-06-02 15:44:41,165 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:41,267 - DEBUG - Node anomaly scores shape: torch.Size([16771, 1])
2025-06-02 15:44:41,272 - DEBUG - Edge anomaly scores shape: torch.Size([34649, 1])
2025-06-02 15:44:41,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:41,464 - DEBUG - Step 17: Loss=0.8935
2025-06-02 15:44:41,464 - DEBUG - Online update step: 18/25
2025-06-02 15:44:41,471 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:41,573 - DEBUG - Node anomaly scores shape: torch.Size([16234, 1])
2025-06-02 15:44:41,578 - DEBUG - Edge anomaly scores shape: torch.Size([33462, 1])
2025-06-02 15:44:41,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:41,849 - DEBUG - Step 18: Loss=0.8837
2025-06-02 15:44:41,850 - DEBUG - Online update step: 19/25
2025-06-02 15:44:41,853 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:41,928 - DEBUG - Node anomaly scores shape: torch.Size([16371, 1])
2025-06-02 15:44:41,932 - DEBUG - Edge anomaly scores shape: torch.Size([33742, 1])
2025-06-02 15:44:41,933 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:42,079 - DEBUG - Step 19: Loss=0.8781
2025-06-02 15:44:42,079 - DEBUG - Online update step: 20/25
2025-06-02 15:44:42,083 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:42,174 - DEBUG - Node anomaly scores shape: torch.Size([16489, 1])
2025-06-02 15:44:42,178 - DEBUG - Edge anomaly scores shape: torch.Size([34002, 1])
2025-06-02 15:44:42,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:42,366 - DEBUG - Step 20: Loss=0.8814
2025-06-02 15:44:42,367 - DEBUG - Online update step: 21/25
2025-06-02 15:44:42,370 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:42,454 - DEBUG - Node anomaly scores shape: torch.Size([16832, 1])
2025-06-02 15:44:42,460 - DEBUG - Edge anomaly scores shape: torch.Size([34722, 1])
2025-06-02 15:44:42,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:42,647 - DEBUG - Step 21: Loss=0.8828
2025-06-02 15:44:42,647 - DEBUG - Online update step: 22/25
2025-06-02 15:44:42,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:42,719 - DEBUG - Node anomaly scores shape: torch.Size([15187, 1])
2025-06-02 15:44:42,727 - DEBUG - Edge anomaly scores shape: torch.Size([31195, 1])
2025-06-02 15:44:42,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:42,854 - DEBUG - Step 22: Loss=0.8763
2025-06-02 15:44:42,854 - DEBUG - Online update step: 23/25
2025-06-02 15:44:42,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:42,951 - DEBUG - Node anomaly scores shape: torch.Size([14761, 1])
2025-06-02 15:44:42,957 - DEBUG - Edge anomaly scores shape: torch.Size([30223, 1])
2025-06-02 15:44:42,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:43,117 - DEBUG - Step 23: Loss=0.8694
2025-06-02 15:44:43,118 - DEBUG - Online update step: 24/25
2025-06-02 15:44:43,122 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:43,202 - DEBUG - Node anomaly scores shape: torch.Size([16350, 1])
2025-06-02 15:44:43,207 - DEBUG - Edge anomaly scores shape: torch.Size([33667, 1])
2025-06-02 15:44:43,208 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:43,367 - DEBUG - Step 24: Loss=0.8637
2025-06-02 15:44:43,367 - DEBUG - Online update step: 25/25
2025-06-02 15:44:43,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:43,473 - DEBUG - Node anomaly scores shape: torch.Size([15392, 1])
2025-06-02 15:44:43,477 - DEBUG - Edge anomaly scores shape: torch.Size([31712, 1])
2025-06-02 15:44:43,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:43,593 - DEBUG - Step 25: Loss=0.8677
2025-06-02 15:44:43,593 - INFO - Online update finished. Average loss: 0.9054, Learning rate: 0.001000
2025-06-02 15:44:43,594 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], current edge mean: [-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:44:43,594 - DEBUG - Node drift difference: 0.0041, Edge drift difference: 0.0011
2025-06-02 15:44:43,595 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], edge=[-1.0001828e-09  4.5835397e+02  0.0000000e+00  0.0000000e+00
 -1.0001828e-09  1.0001828e-09 -9.0016457e-09 -2.2504114e-09
 -1.5002742e-09  1.0001828e-09]
2025-06-02 15:44:43,596 - DEBUG - Updated reference std: node=[0.         0.         1.0005554  1.0005554  0.         0.
 0.         1.0005554  1.0005554  1.0005554  1.0005554  1.0005554
 0.9781268  0.28000316 0.37004966 0.57211477 1.0005554  2.9718418
 2.880792   1.4799136  0.37004966 0.23320381 1.0005554  1.0005554
 0.         0.         0.         0.         1.0005554  1.0005554 ], edge=[  1.0002623 467.01913     0.          0.          1.0002623   1.0002624
   1.0002623   1.0002623   1.0002623   1.0002623]
2025-06-02 15:44:43,596 - INFO - Online update complete. Loss: 0.9054
2025-06-02 15:44:43,596 - INFO - Running anomaly detection...
2025-06-02 15:44:43,596 - INFO - Starting anomaly detection.
2025-06-02 15:44:43,605 - DEBUG - Node reconstruction errors: [0.6568124  2.3217895  5.466336   0.30900913 0.73824805 0.22863096
 4.872157   0.40702775 0.40702775 0.42180893 0.40702775 0.47108775
 8.691846   1.0300571  0.30242088 0.37195405 0.47882888 0.37195414
 2.3628125  0.31691507 0.26316437 0.3024209  0.4102618  0.48362547
 0.27536818 0.32281497 0.27536812 0.88797444 0.36117676 0.27536812
 2.3770306  0.41074854 0.83568746 0.26596013 0.43103012 0.30823332
 0.28711697 0.31691477 0.77662057 0.87059283 0.27006343 0.25053555
 0.31691477 0.2834066  0.7000505  0.4117187  0.3406498  1.3392756
 0.32100073 1.0396674  1.7528832  0.2847327  0.29069182 2.105297
 0.21938196 0.6376095  2.6264539  0.22375509 2.2492402  2.05648
 0.5772336  0.31218463 0.20481828 0.6127577  0.28688717 0.21938205
 0.16160454 0.21938223 0.20481828 0.31218463 0.2095727  0.23876284
 0.14776179 0.25629103 0.21514511 0.25320444 0.31875655 0.20789899
 0.1389822  0.18874422 0.1572241  0.168936   1.5692883  1.3730539
 0.14389619 0.68126285 0.12811676 0.15014242 0.21618721 0.25216296
 0.15259819 0.7722628  0.41152516 0.15400282 0.23101321 2.139259
 0.12908809 0.16589221 0.1121214  0.19273154 0.16186126 0.12908809
 0.17898521 0.31191674 0.6122801  0.18524417 0.5946596  0.32634813
 0.4127733  0.6816399  0.4650597  0.13403155 0.8303764  0.66344965
 0.14606695 0.07951002 0.13274927 0.68643516 0.16868512 0.11284209
 0.1052851  0.38494903 0.6332577  0.45642966 0.20428237 0.11284211
 0.49994504 0.32976043 0.18891199 0.09059974 0.18694521 0.13228337
 0.8214108  1.0157261  0.11211551 0.18238154 0.18369608 0.12879604
 0.6130793  0.81788003 0.20245624 0.11704511 0.09602995 0.20245656
 0.17721863 0.1974747  0.13274902 0.34500605 0.24871519 0.15662333
 0.7960483  0.69605863 0.15281977 0.13228339 0.75257003 0.67786163
 0.12167284 0.09785727 0.16186151 0.19360478 0.20245656 0.35285914
 0.1216728  0.18694517 0.13627842 0.81363434 0.14879261 0.12058917
 0.42826515 0.23814414 0.1780244  0.11307205 0.13667482 2.1407897
 0.22074    5.2102504  0.11374983 0.11844867 0.12724504 0.12724496
 0.17034404 0.4686161  0.15679713 0.6754686  0.7049814  0.11946482
 0.07164481 0.1399432  0.16757463 0.10606731 0.12793426 0.13266751
 0.20230961 0.1489127  0.61307883 0.16927508 1.5705376  0.19046183
 0.7006973  0.23022771 0.09290291 0.12167284 0.7705668  0.18803234
 0.19475514 0.3496513  0.26258412 1.1092483  0.09957798 0.13008904
 0.10559335 0.12357493 0.19594379 0.11450179 0.12145641 0.09039943
 0.2047945  0.13274929 0.22180024 0.14891258 0.6557997  0.0716448
 0.10575978 0.19594377 0.12167284 0.14137766 0.6808347  0.16868943
 0.14670604 0.4005952  0.4843977  0.1462162  0.22307174 0.13274916
 0.13274932 0.17948881 0.11520199 0.10575978 0.1216728  0.16644645
 0.6717623  0.09942424 0.14360942 0.21016654 0.14527717 0.23740552
 0.10351415 0.11553551 0.14360942 0.12838407 0.13667482 0.13830045
 0.2218002  0.10162813 0.10278281 0.1785972  0.10606731 0.06763954
 0.09413548 0.12724468 0.08695409 0.5739189  0.06751309 0.15822974
 0.17241573 0.21153551 0.15246038 2.3282597  0.15246032 0.07628144
 0.73010135 0.6424832  0.10598432 0.35911196 0.11874746 0.12724473
 0.09379206 0.262942   0.17034407 0.13574415 1.1037632  0.10822125
 0.10345516 0.17611915 0.13074152 0.10774397 1.0592102  0.30355516
 0.46861643 0.90023124 0.20861155 0.09259483 0.12235424 0.14527717
 1.3148688  0.06761154 0.08958114 0.12724504 0.16927512 0.6252121
 0.09779592 0.07313892 0.09546538 0.12173324 0.07313892 0.07313892
 0.07313892 0.11466603 0.19170846 0.07313892 0.07313892 0.86097836
 0.07313892 0.09561487 0.4233218  0.1180096  0.35165423 0.43897465
 0.1854485  0.16824359 0.13335527 0.10937046 0.15839794 0.09546532
 0.41236123 0.65632606 0.19072227 0.1704554  0.12557344 0.12557344
 0.2918808  0.16612741 0.07313892 0.11874754 0.07313892 0.11466594
 0.1973344  0.1072313  0.08402533 0.08402533 0.07313892 0.1043198
 0.08402538 0.13358644 0.13529596 0.20478593 0.09546507 0.09936862
 0.16874719 0.12668064 0.07313892 0.0795844  0.6356653  0.1151379
 0.08859486 0.10606731 0.0489432  0.07313892 0.09844593 1.447404
 0.17905241 0.09620548 0.24773148 0.11296741 0.09546525 2.1591263
 0.06657463 0.77843505 0.09668862 0.06719241 0.08273317 0.11033528
 0.1135064  0.62780094 0.14956601 0.1151543  0.07983368 0.12227624
 0.10136922 0.07313892 0.09546528 0.33680397 0.09540032 0.09285884
 0.4484352  0.13040115 0.23240687 0.61569923 0.14630939 0.07313892
 0.3313894  0.16246143 0.07947521 0.7085764  0.12374161 0.12374177
 0.1237417  2.1297302  0.05291665 2.131292   0.09096251 0.18269993
 0.12374178 0.05291667 0.07968766 0.07947508 0.21875864 0.09185863
 0.07947508 0.3728705  0.12374172 0.07947525 0.05291667 0.12374178
 0.12374167 0.04283007 0.08175663 0.12374171 0.07983245 0.10191062
 0.19833377 0.10235593 0.06392752 0.09076329 0.6519947  0.10933868
 0.13142742 0.11884663 0.379845   0.47406548 0.12524897 0.15650177
 0.09678224 0.11569285 0.12374173 0.12374177 0.09096253 0.11779536
 0.64359856 0.04249338 0.08175065 0.10489596 0.28978267 0.02869471
 0.12907651 0.84324116 0.9770168  0.09358141 0.17564362 0.09270637
 0.1139077  0.0430647  0.09807161 0.03756069 0.04306471 0.15570521
 0.09076312 0.1804808  0.08513106 0.10537679 0.07678568 0.10251517
 0.09105547 0.50146276 0.09105547 0.10251512 0.06019615 0.085008
 0.38789293 0.17124824 0.06019615 0.0767858  0.09863172 0.6709704
 0.14757404 0.06392813 0.08500808 0.07678596 0.03432096 0.10769785
 0.07785433 0.87414443 0.08177359 0.09358124 0.68751943 0.03809739
 0.0430647  0.36241814 0.05412855 0.6718468  0.05980118 0.03432096
 0.09190929 0.04106443 0.05508678 0.09454976 0.06397353 2.0573494
 0.03756069 0.10769785 0.25208434 0.04106443 0.36337325 0.06469958
 0.04413338 0.47413382 0.0296979  1.0979053  0.12756209 0.0430647
 0.47189718 0.09738459 0.09738459 0.03177604 0.09496436 0.06355379
 0.0296979  0.07017455 0.15981226 0.08251695 0.07017466 0.10489605
 0.0296979  0.271573   0.04413338 0.06397341 0.17815694 0.5580109
 0.07017454 0.1202573  0.06355379 0.03756069 0.03756069 0.10769785
 0.06397338 0.06609282 0.08742192 0.11358759 0.03756069 0.10924913
 0.03756069 0.10924913 0.11846881 0.07017455 0.09994432 1.722818
 0.4508877  0.02706363 1.1177026  0.02706363 0.02706357 0.02706363
 0.02706363 0.02706363 0.02706363 0.02706363 0.07514253 0.1107112
 0.06090175 0.02706363 0.02706363 0.02706363 0.02706357 0.02706357
 0.02706357 0.02706363 0.02706363 0.02706363 0.06773538 0.02706363
 0.02706363 0.8221511  0.02706363 0.59610206 0.11396717 0.03756069
 0.06963418 0.10717298 0.96411234 0.96411234 0.11969729 0.06963418
 0.03756069 0.0296979  0.0296979  0.03756069 0.02969794 0.08954478
 0.11398955 0.02706363 0.10489596 0.03756069 0.09738459 0.03756069
 0.03756069 0.07600032 0.03756069 0.02969794 0.03756069 0.03756069
 0.07017484 0.02969794 0.03756069 0.0296979  0.03756069 0.03756069
 0.03756069 0.1025325  0.14778227 0.05508677 0.02706363 0.16179031
 0.11229401 0.03756069 0.0296979  0.10153381 0.02706357 0.05892305
 0.1139789  0.02586864 0.03756069 0.03756069 0.05695416 0.10869328
 0.05596337 0.03756069 0.0751427  0.02998876 0.0296979  0.5189933
 0.02706363 0.15484661 0.16900249 0.02706357 0.02706363 0.07514261
 0.02998869 0.03756069 0.3135196  0.10392162 0.12445697 0.10869325
 0.06509943 0.09871758 0.09871759 0.09487399 0.03739051 0.02706363
 0.09985643 0.10786969 0.10869333 0.05400933 0.04948251 0.07171097
 0.02147103 0.02147103 0.02147103 0.02147103 0.02147103 0.07228182
 0.11977462 0.02147103 0.02147103 0.02706363 0.02779791 0.02706363
 0.09871766 0.10170185 0.11287329 0.04367153 0.09871759 0.09940612
 0.06773532 0.0362217  0.06773537 0.02706363 0.09871759 0.03289721
 0.02127752 0.02127752 0.02147103 0.03289721 0.09726138 0.04038466
 0.07055327 0.02706363 0.02147103 0.0287999  0.02127752 0.02165937
 0.02563554 0.02339972 0.07228184 0.7309208  0.02339972 0.7929783
 0.06187018 0.02563551 0.11654314 0.0264794  0.02303187 0.03392248
 0.0998937  0.0205545  0.09654641 0.02563551 0.02563551 0.02563551
 0.02099899 0.09507611 0.02563551 0.02303187 0.02563551 0.02563551
 0.02563551 0.07020166 0.02466187 0.1379563  0.11800685 0.08561043
 0.12612906 0.02011802 0.10931231 2.1650848  0.02387238 0.02562312
 0.04466205 0.20623246 0.20623277 0.02303175 0.9198269  0.23796085
 0.02385534 0.02423394 0.69656765 0.8879322  0.03229987 0.03229987
 0.03229987 0.0318989  0.0322868  0.65739137 0.38865358 0.30758235
 0.10095266 0.03356371 0.14249296 0.02423394 0.14977975 0.10189312
 0.02286085 0.22649659 0.02385534 0.23796059 0.02423394 0.10189303
 0.03356371 0.8890467  0.03229987 0.03189899 0.02286085 0.13903861
 0.23112541 0.03189899 0.03189899 0.0318989  0.16897002 0.12726144
 3.6322975  0.03229987 0.13871518 0.0318989  0.10150143 0.19178887
 2.2314136  0.19178887 0.0318989  0.04629372 0.23473586 0.030631
 0.4440129  0.19178873 1.9094977  0.1398616  0.23216489 0.19178873
 0.15002012 0.2618402  0.13921294 0.18131018 0.16148691 0.04373389
 0.04373389 0.18131015 0.41790912 0.04629372 0.19178873 0.13921288
 0.19178887 0.08217826 0.06342749 0.06342749 0.04795575 0.25019684
 0.06342749 0.06342749 0.08217826 0.28911638 0.06342749 0.06342749
 0.06780522 0.31764615 0.2507973  0.24798428 0.06342749 0.17444636
 0.28911665 0.06342749 0.09022067 0.21203443 0.08217826 0.07046129
 0.7429436  0.21203443 0.06342749 0.21203443 0.23705901 0.2806551
 0.4173618  0.06342749 0.42078388 0.22221804 0.22221804 0.31764615
 0.09659681 0.22221804 0.09022082 0.20455816 0.10035115 0.3413195
 0.2503125  0.3413195  0.579346   0.09022082 0.25031254 0.13245702
 0.13245699 2.4107256  0.13245702 0.28122908 0.09659681 0.3590438
 0.2847428  0.10035115 0.2847429  0.8538631  0.24945097 0.78993213
 0.13245699 0.24526477 0.20455816 0.13245699 0.2932627  0.26901627
 0.2452647  0.10035115 0.13245699 0.6056797  0.13245699 0.13245699
 0.13245699 0.12444058 0.3160695  0.12444058 0.3160693  0.12444058
 0.2354115  0.23541151 0.2354115  0.13245699 0.13245702 0.13245702
 0.13245702 2.0159585  0.3160695  0.12444058 0.13245702 0.13245702
 0.13245699 0.18281804 0.13245702 0.13245699 0.13245702 0.3160695
 0.16713455 1.9865527  0.1477591  0.13245702 0.13245702 0.1796386
 0.13245702]
2025-06-02 15:44:43,606 - DEBUG - Edge reconstruction errors: [ 5.2638984  5.262724  44.258614  ... 13.358597   2.1596293 13.358597 ]
2025-06-02 15:44:43,608 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154443_update_38.json
2025-06-02 15:44:43,608 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:44:43,617 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154443_update_38.pth and as latest_checkpoint.pth
2025-06-02 15:44:43,617 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.5501
2025-06-02 15:44:43,617 - WARNING - Detected 27 anomalous nodes (reconstruction-based):
2025-06-02 15:44:43,617 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.3218, MLP Score: 0.5765
2025-06-02 15:44:43,617 - WARNING -   Node ID: 192.168.27.13, Recon Error: 5.4663, MLP Score: 0.4965
2025-06-02 15:44:43,617 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.8722, MLP Score: 0.5056
2025-06-02 15:44:43,618 - WARNING -   Node ID: 192.168.27.10, Recon Error: 8.6918, MLP Score: 0.5029
2025-06-02 15:44:43,618 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.3628, MLP Score: 0.4946
2025-06-02 15:44:43,618 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:44:43,618 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2585, MLP Score: 0.0000
2025-06-02 15:44:43,618 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0000
2025-06-02 15:44:43,618 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0610, MLP Score: 0.0000
2025-06-02 15:44:43,618 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.0000
2025-06-02 15:44:43,618 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.0000
2025-06-02 15:44:43,618 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-02 15:44:43,618 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:44:43,618 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:44:43,618 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 15:44:43,648 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:44:43,679 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 15:44:43,679 - INFO - Processing node updates/additions.
2025-06-02 15:44:43,686 - INFO - Processing edge updates/additions.
2025-06-02 15:44:43,700 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:44:43,701 - INFO - Finished updating NetworkX graph.
2025-06-02 15:44:43,702 - DEBUG - Updated graph - Nodes: 914, Edges: 1945
2025-06-02 15:44:43,702 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:44:43,703 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:44:43,715 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-02 15:44:43,721 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:44:43,721 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-02 15:44:43,723 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-02 15:44:43,724 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:44:43,728 - DEBUG - Initial edge attributes tensor shape: torch.Size([1945, 10])
2025-06-02 15:44:43,733 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:44:43,734 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1945, 10])
2025-06-02 15:44:43,734 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:44:43,735 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:44:43,736 - INFO - Updated main graph to 914 nodes and 1945 edges.
2025-06-02 15:44:43,736 - INFO - Performing online update...
2025-06-02 15:44:43,736 - INFO - Starting online update for 25 steps.
2025-06-02 15:44:43,737 - DEBUG - Updated RunningStats: new_mean=0.9441289852880805, new_var=22200000000161.926, new_n=2250
2025-06-02 15:44:43,737 - DEBUG - Updated RunningStats: new_mean=0.9414485711235131, new_var=22500000000018.0, new_n=2280
2025-06-02 15:44:43,737 - DEBUG - Updated RunningStats: new_mean=44.553035143202116, new_var=7400000188848.005, new_n=750
2025-06-02 15:44:43,737 - DEBUG - Updated RunningStats: new_mean=44.58449360350399, new_var=7500000191874.098, new_n=760
2025-06-02 15:44:43,737 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:44:43,738 - DEBUG - Online update step: 1/25
2025-06-02 15:44:43,740 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:43,955 - DEBUG - Node anomaly scores shape: torch.Size([17500, 1])
2025-06-02 15:44:43,959 - DEBUG - Edge anomaly scores shape: torch.Size([36319, 1])
2025-06-02 15:44:43,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:44,112 - DEBUG - Step 1: Loss=0.8651
2025-06-02 15:44:44,112 - DEBUG - Online update step: 2/25
2025-06-02 15:44:44,115 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:44,193 - DEBUG - Node anomaly scores shape: torch.Size([16205, 1])
2025-06-02 15:44:44,207 - DEBUG - Edge anomaly scores shape: torch.Size([33369, 1])
2025-06-02 15:44:44,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:44,367 - DEBUG - Step 2: Loss=0.8591
2025-06-02 15:44:44,367 - DEBUG - Online update step: 3/25
2025-06-02 15:44:44,370 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:44,470 - DEBUG - Node anomaly scores shape: torch.Size([15636, 1])
2025-06-02 15:44:44,474 - DEBUG - Edge anomaly scores shape: torch.Size([32180, 1])
2025-06-02 15:44:44,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:44,604 - DEBUG - Step 3: Loss=0.8512
2025-06-02 15:44:44,604 - DEBUG - Online update step: 4/25
2025-06-02 15:44:44,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:44,671 - DEBUG - Node anomaly scores shape: torch.Size([15075, 1])
2025-06-02 15:44:44,676 - DEBUG - Edge anomaly scores shape: torch.Size([30881, 1])
2025-06-02 15:44:44,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:44,834 - DEBUG - Step 4: Loss=0.8508
2025-06-02 15:44:44,835 - DEBUG - Online update step: 5/25
2025-06-02 15:44:44,838 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:44,951 - DEBUG - Node anomaly scores shape: torch.Size([17098, 1])
2025-06-02 15:44:44,956 - DEBUG - Edge anomaly scores shape: torch.Size([35427, 1])
2025-06-02 15:44:44,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:45,140 - DEBUG - Step 5: Loss=0.8510
2025-06-02 15:44:45,141 - DEBUG - Online update step: 6/25
2025-06-02 15:44:45,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:45,227 - DEBUG - Node anomaly scores shape: torch.Size([16099, 1])
2025-06-02 15:44:45,231 - DEBUG - Edge anomaly scores shape: torch.Size([33203, 1])
2025-06-02 15:44:45,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:45,391 - DEBUG - Step 6: Loss=0.8543
2025-06-02 15:44:45,392 - DEBUG - Online update step: 7/25
2025-06-02 15:44:45,395 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:45,525 - DEBUG - Node anomaly scores shape: torch.Size([17468, 1])
2025-06-02 15:44:45,530 - DEBUG - Edge anomaly scores shape: torch.Size([36106, 1])
2025-06-02 15:44:45,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:45,699 - DEBUG - Step 7: Loss=0.8379
2025-06-02 15:44:45,700 - DEBUG - Online update step: 8/25
2025-06-02 15:44:45,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:45,790 - DEBUG - Node anomaly scores shape: torch.Size([15868, 1])
2025-06-02 15:44:45,794 - DEBUG - Edge anomaly scores shape: torch.Size([32567, 1])
2025-06-02 15:44:45,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:45,959 - DEBUG - Step 8: Loss=0.8573
2025-06-02 15:44:45,959 - DEBUG - Online update step: 9/25
2025-06-02 15:44:45,962 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:46,075 - DEBUG - Node anomaly scores shape: torch.Size([16168, 1])
2025-06-02 15:44:46,079 - DEBUG - Edge anomaly scores shape: torch.Size([33485, 1])
2025-06-02 15:44:46,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:46,205 - DEBUG - Step 9: Loss=0.8344
2025-06-02 15:44:46,206 - DEBUG - Online update step: 10/25
2025-06-02 15:44:46,209 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:46,269 - DEBUG - Node anomaly scores shape: torch.Size([15454, 1])
2025-06-02 15:44:46,273 - DEBUG - Edge anomaly scores shape: torch.Size([31821, 1])
2025-06-02 15:44:46,274 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:46,455 - DEBUG - Step 10: Loss=0.8344
2025-06-02 15:44:46,456 - DEBUG - Online update step: 11/25
2025-06-02 15:44:46,459 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:46,532 - DEBUG - Node anomaly scores shape: torch.Size([15966, 1])
2025-06-02 15:44:46,536 - DEBUG - Edge anomaly scores shape: torch.Size([32845, 1])
2025-06-02 15:44:46,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:46,661 - DEBUG - Step 11: Loss=0.8468
2025-06-02 15:44:46,661 - DEBUG - Online update step: 12/25
2025-06-02 15:44:46,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:46,805 - DEBUG - Node anomaly scores shape: torch.Size([16279, 1])
2025-06-02 15:44:46,815 - DEBUG - Edge anomaly scores shape: torch.Size([33497, 1])
2025-06-02 15:44:46,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:47,007 - DEBUG - Step 12: Loss=0.8258
2025-06-02 15:44:47,008 - DEBUG - Online update step: 13/25
2025-06-02 15:44:47,011 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:47,087 - DEBUG - Node anomaly scores shape: torch.Size([15953, 1])
2025-06-02 15:44:47,092 - DEBUG - Edge anomaly scores shape: torch.Size([32743, 1])
2025-06-02 15:44:47,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:47,251 - DEBUG - Step 13: Loss=0.8240
2025-06-02 15:44:47,251 - DEBUG - Online update step: 14/25
2025-06-02 15:44:47,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:47,345 - DEBUG - Node anomaly scores shape: torch.Size([15712, 1])
2025-06-02 15:44:47,348 - DEBUG - Edge anomaly scores shape: torch.Size([32392, 1])
2025-06-02 15:44:47,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:47,521 - DEBUG - Step 14: Loss=0.8353
2025-06-02 15:44:47,522 - DEBUG - Online update step: 15/25
2025-06-02 15:44:47,525 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:47,602 - DEBUG - Node anomaly scores shape: torch.Size([15787, 1])
2025-06-02 15:44:47,606 - DEBUG - Edge anomaly scores shape: torch.Size([32562, 1])
2025-06-02 15:44:47,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:47,750 - DEBUG - Step 15: Loss=0.8215
2025-06-02 15:44:47,750 - DEBUG - Online update step: 16/25
2025-06-02 15:44:47,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:47,837 - DEBUG - Node anomaly scores shape: torch.Size([15772, 1])
2025-06-02 15:44:47,840 - DEBUG - Edge anomaly scores shape: torch.Size([32505, 1])
2025-06-02 15:44:47,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:48,039 - DEBUG - Step 16: Loss=0.8143
2025-06-02 15:44:48,039 - DEBUG - Online update step: 17/25
2025-06-02 15:44:48,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:48,166 - DEBUG - Node anomaly scores shape: torch.Size([16670, 1])
2025-06-02 15:44:48,172 - DEBUG - Edge anomaly scores shape: torch.Size([34482, 1])
2025-06-02 15:44:48,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:48,432 - DEBUG - Step 17: Loss=0.8117
2025-06-02 15:44:48,433 - DEBUG - Online update step: 18/25
2025-06-02 15:44:48,436 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:48,551 - DEBUG - Node anomaly scores shape: torch.Size([16790, 1])
2025-06-02 15:44:48,557 - DEBUG - Edge anomaly scores shape: torch.Size([34731, 1])
2025-06-02 15:44:48,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:48,807 - DEBUG - Step 18: Loss=0.8143
2025-06-02 15:44:48,808 - DEBUG - Online update step: 19/25
2025-06-02 15:44:48,811 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:48,909 - DEBUG - Node anomaly scores shape: torch.Size([16511, 1])
2025-06-02 15:44:48,914 - DEBUG - Edge anomaly scores shape: torch.Size([34094, 1])
2025-06-02 15:44:48,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:49,153 - DEBUG - Step 19: Loss=0.8193
2025-06-02 15:44:49,154 - DEBUG - Online update step: 20/25
2025-06-02 15:44:49,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:49,262 - DEBUG - Node anomaly scores shape: torch.Size([16185, 1])
2025-06-02 15:44:49,267 - DEBUG - Edge anomaly scores shape: torch.Size([33430, 1])
2025-06-02 15:44:49,268 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:49,485 - DEBUG - Step 20: Loss=0.8064
2025-06-02 15:44:49,486 - DEBUG - Online update step: 21/25
2025-06-02 15:44:49,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:49,721 - DEBUG - Node anomaly scores shape: torch.Size([16619, 1])
2025-06-02 15:44:49,794 - DEBUG - Edge anomaly scores shape: torch.Size([34411, 1])
2025-06-02 15:44:49,844 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:50,283 - DEBUG - Step 21: Loss=0.8013
2025-06-02 15:44:50,283 - DEBUG - Online update step: 22/25
2025-06-02 15:44:50,286 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:50,396 - DEBUG - Node anomaly scores shape: torch.Size([17022, 1])
2025-06-02 15:44:50,400 - DEBUG - Edge anomaly scores shape: torch.Size([35357, 1])
2025-06-02 15:44:50,401 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:50,650 - DEBUG - Step 22: Loss=0.8021
2025-06-02 15:44:50,651 - DEBUG - Online update step: 23/25
2025-06-02 15:44:50,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:50,773 - DEBUG - Node anomaly scores shape: torch.Size([15085, 1])
2025-06-02 15:44:50,777 - DEBUG - Edge anomaly scores shape: torch.Size([30910, 1])
2025-06-02 15:44:50,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:50,969 - DEBUG - Step 23: Loss=0.8108
2025-06-02 15:44:50,969 - DEBUG - Online update step: 24/25
2025-06-02 15:44:50,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:51,076 - DEBUG - Node anomaly scores shape: torch.Size([16880, 1])
2025-06-02 15:44:51,080 - DEBUG - Edge anomaly scores shape: torch.Size([34846, 1])
2025-06-02 15:44:51,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:51,270 - DEBUG - Step 24: Loss=0.7979
2025-06-02 15:44:51,270 - DEBUG - Online update step: 25/25
2025-06-02 15:44:51,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:51,459 - DEBUG - Node anomaly scores shape: torch.Size([15939, 1])
2025-06-02 15:44:51,472 - DEBUG - Edge anomaly scores shape: torch.Size([32874, 1])
2025-06-02 15:44:51,473 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:51,749 - DEBUG - Step 25: Loss=0.7940
2025-06-02 15:44:51,749 - INFO - Online update finished. Average loss: 0.8288, Learning rate: 0.001000
2025-06-02 15:44:51,752 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], current edge mean: [-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:44:51,752 - DEBUG - Node drift difference: 0.0147, Edge drift difference: 0.0006
2025-06-02 15:44:51,755 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], edge=[-3.9225680e-09  4.5805399e+02  0.0000000e+00  0.0000000e+00
 -5.8838516e-09 -3.9225680e-09 -9.8064201e-10  9.8064201e-10
  2.9419258e-09  4.9032098e-09]
2025-06-02 15:44:51,756 - DEBUG - Updated reference std: node=[0.         0.         1.0005475  1.0005475  0.         0.
 0.         1.0005475  1.0005475  1.0005475  1.0005475  1.0005475
 1.0195211  0.27804288 0.37305197 0.5736149  1.0005475  2.9805017
 2.883391   1.4932402  0.37305197 0.23153941 1.0005475  1.0005474
 0.         0.         0.         0.         1.0005475  1.0005475 ], edge=[  1.0002571 462.43698     0.          0.          1.0002571   1.0002571
   1.0002571   1.0002571   1.0002571   1.0002573]
2025-06-02 15:44:51,757 - INFO - Online update complete. Loss: 0.8288
2025-06-02 15:44:51,757 - INFO - Running anomaly detection...
2025-06-02 15:44:51,758 - INFO - Starting anomaly detection.
2025-06-02 15:44:51,782 - DEBUG - Node reconstruction errors: [0.60974056 2.0429168  4.432613   0.18467972 0.5845965  0.17487143
 3.7996738  0.30023798 0.30023798 0.31781253 0.30023798 0.3638015
 7.2784524  1.0441897  0.19763413 0.2561532  0.37267452 0.25615317
 2.105832   0.22380015 0.199384   0.197634   0.3510491  0.40483722
 0.18409093 0.22342017 0.18409093 0.7329405  0.27085307 0.18409093
 2.113696   0.37061685 0.71363235 0.16721956 0.38201097 0.26213023
 0.23655635 0.22380015 0.65677387 0.7676379  0.18985511 0.17106672
 0.22380015 0.24241178 0.7893323  0.352232   0.30505335 1.0975506
 0.244914   0.94325364 1.5714538  0.21607806 0.20761484 1.9197881
 0.17868182 0.51839    2.1809907  0.17569515 2.042816   1.8983994
 0.56779844 0.2664446  0.14742383 0.5016811  0.22766657 0.17868172
 0.12032819 0.1786821  0.14742404 0.2664446  0.18220368 0.17486617
 0.11042393 0.25282502 0.26832393 0.18147247 0.27578416 0.14852615
 0.11361882 0.1447738  0.11696341 0.12886266 1.5744694  1.2215289
 0.13352188 0.5325501  0.11426605 0.1382294  0.15540293 0.24611695
 0.11720844 0.6381075  0.31965646 0.1282644  0.18060602 1.8842107
 0.09868123 0.15320611 0.0873679  0.2978926  0.12218655 0.09868145
 0.14942731 0.28986993 0.57527626 0.16420156 0.48398077 0.28068936
 0.32174852 0.62811196 0.43334997 0.10385306 0.65209824 0.5429061
 0.10984372 0.06975482 0.1030343  0.56191564 0.20071703 0.09290551
 0.08580204 0.29058868 0.5161883  0.38046008 0.18048531 0.09290542
 0.41860643 0.3108615  0.2005601  0.08567227 0.16367404 0.10303532
 0.7017371  0.83975995 0.08879944 0.16042472 0.15974689 0.09775333
 0.5600612  0.67803395 0.16000922 0.10242946 0.08054184 0.16000935
 0.14029004 0.16847019 0.10303426 0.34592602 0.22326152 0.2126531
 0.76468414 0.5358073  0.12726073 0.10303532 0.67311406 0.5483957
 0.09680118 0.08559108 0.12218639 0.15562953 0.16000922 0.29093373
 0.09680118 0.16367404 0.10385167 0.63737607 0.10977221 0.10312147
 0.34550136 0.21265286 0.1431013  0.09186588 0.10553849 1.8968228
 0.20071653 5.700801   0.0999157  0.09933607 0.10025927 0.10025959
 0.155446   0.3742691  0.13070652 0.5590597  0.5594176  0.11236678
 0.06307352 0.11200371 0.15228812 0.08583605 0.12138217 0.12400376
 0.27442226 0.11622322 0.56006116 0.15010312 1.603685   0.21404825
 0.576013   0.20007274 0.08502872 0.09680118 0.6114555  0.17522521
 0.20119552 0.29107875 0.24039689 0.9284569  0.08012319 0.11081704
 0.08486573 0.09951292 0.16955623 0.10443453 0.10378578 0.07833309
 0.18320602 0.10303421 0.19772659 0.11622322 0.5442266  0.06307352
 0.08439012 0.16955622 0.09680118 0.19052295 0.55494934 0.13098761
 0.12570693 0.2973714  0.47518322 0.11840525 0.1994706  0.10303438
 0.1030343  0.13889632 0.10418949 0.08439012 0.09680118 0.26450342
 0.5424734  0.09284533 0.11539454 0.18239807 0.11770196 0.20717452
 0.08697916 0.10134513 0.11539454 0.10181243 0.10553844 0.10678513
 0.19772667 0.09281618 0.09136242 0.13356635 0.08583602 0.05849898
 0.17846851 0.10025941 0.08442434 0.46168977 0.0530953  0.12126443
 0.1578931  0.1614792  0.1277553  2.094851   0.12775524 0.06656022
 0.59777486 0.52620226 0.09917889 0.30164853 0.09114861 0.2648988
 0.08521203 0.24373966 0.15544619 0.12554567 0.8814437  0.09535681
 0.09706764 0.14763302 0.12325668 0.08515359 0.8715184  0.278385
 0.37426898 0.9244535  0.15916423 0.07683317 0.09513006 0.11770184
 1.3399236  0.06083817 0.08650205 0.10025919 0.15010312 0.49000183
 0.09384039 0.05960921 0.0769923  0.11193798 0.05960921 0.05960921
 0.05960911 0.09181719 0.15408228 0.05960911 0.05960911 0.6768823
 0.05960921 0.07704861 0.36575967 0.10903115 0.3247618  0.3406367
 0.16693333 0.14823648 0.11411989 0.08725522 0.19459683 0.07699251
 0.33408976 0.5401503  0.15865244 0.1382591  0.11177739 0.11177739
 0.2785528  0.14706351 0.05960921 0.09114838 0.05960921 0.0918173
 0.14664845 0.08546876 0.06796019 0.06796019 0.05960921 0.08588052
 0.06796019 0.20504709 0.12459718 0.18320139 0.07699232 0.08030435
 0.1380334  0.11076743 0.05960921 0.07100867 0.5223831  0.10542223
 0.07485452 0.08583602 0.04423144 0.05960921 0.07714098 1.2264808
 0.15087052 0.07930374 0.2270897  0.10286222 0.07699261 1.9200085
 0.05745773 0.61860746 0.08256704 0.06183888 0.08466803 0.098368
 0.10778267 0.50641173 0.1851969  0.10543279 0.06634965 0.10314591
 0.6474399  0.05960921 0.07699243 0.3032246  0.07653365 0.09274475
 0.35183257 0.11546243 0.19114402 0.50539845 0.11724535 0.05960911
 0.32139602 0.16857156 0.07078122 0.5629102  0.10375681 0.10375682
 0.10375688 1.9726177  0.04508575 1.974654   0.07187734 0.17494942
 0.10375689 0.04508571 0.06984337 0.07078125 0.19016148 0.07377359
 0.07078116 0.31025776 0.1037571  0.07078122 0.04508575 0.1037571
 0.10375679 0.04064506 0.07048995 0.10375686 0.06634894 0.08514404
 0.14156818 0.07670329 0.06080483 0.07160164 0.5236931  0.1415687
 0.0966517  0.09802552 0.35000354 0.34056303 0.11559869 0.14124905
 0.08591051 0.0972326  0.10375688 0.10375682 0.07187732 0.10451861
 0.5188552  0.04263445 0.06659819 0.08805624 0.24387553 0.02813503
 0.1016399  0.6944282  0.8031343  0.07043321 0.15202762 0.07306392
 0.11104393 0.03953413 0.07895894 0.03350289 0.03953413 0.13696717
 0.07160176 0.13116032 0.07169394 0.08917458 0.07022379 0.08355749
 0.07026403 0.38825148 0.07026403 0.08355749 0.05224937 0.07456663
 0.31490615 0.14930324 0.05224937 0.07022361 0.08942608 0.5525866
 0.1339389  0.06080334 0.07456683 0.07022361 0.03278911 0.08800953
 0.0639829  0.7090792  0.07015611 0.07043321 0.5470449  0.03492551
 0.03953413 0.3084633  0.04387865 0.5532555  0.05526014 0.03278911
 0.09347418 0.03890944 0.12101451 0.07600223 0.06207243 1.8970462
 0.03350287 0.08800953 0.22735034 0.03890947 0.30015248 0.06226162
 0.04026664 0.36421093 0.02756365 0.93851    0.0907629  0.03953413
 0.42356062 0.07987186 0.07987186 0.03023398 0.08634632 0.05340245
 0.02756358 0.06120799 0.13651961 0.08751164 0.06120812 0.08805624
 0.02756358 0.22208913 0.04026664 0.06207232 0.16263682 0.46941626
 0.06120803 0.10879716 0.05340245 0.03350287 0.03350289 0.08800953
 0.06207211 0.06223118 0.09442122 0.10411108 0.03350289 0.09244976
 0.03350289 0.09244976 0.09126343 0.06120794 0.075365   1.4837892
 0.35955587 0.02484396 1.0301276  0.02484396 0.02484398 0.02484398
 0.02484396 0.02484396 0.02484396 0.02484396 0.06668475 0.08025523
 0.04820619 0.02484396 0.02484396 0.02484396 0.02484396 0.02484396
 0.02484396 0.02484396 0.02484396 0.02484396 0.05960779 0.02484396
 0.02484396 0.6472723  0.02484396 0.45390418 0.12063354 0.03350287
 0.06601988 0.09373856 0.8708392  0.8708392  0.11046167 0.06601988
 0.03350289 0.02756358 0.02756358 0.03350289 0.02756358 0.07444704
 0.08018653 0.02484396 0.08805624 0.03350287 0.07987186 0.03350287
 0.03350289 0.09535869 0.03350287 0.02756365 0.03350287 0.03350289
 0.06120791 0.02756365 0.03350289 0.02756358 0.03350287 0.03350287
 0.03350287 0.10255565 0.15021792 0.05503461 0.02484396 0.14699966
 0.11201603 0.03350287 0.02756365 0.09878578 0.02484396 0.05104888
 0.14925765 0.02457522 0.03350289 0.03350287 0.0519545  0.11090054
 0.05258177 0.03350287 0.06668461 0.02739802 0.02756358 0.43174312
 0.02484396 0.10828581 0.14825691 0.02484396 0.02484396 0.06668466
 0.02739808 0.03350289 0.30202758 0.08959042 0.11398363 0.11090047
 0.0510617  0.09028497 0.09028482 0.10242858 0.03126539 0.02484396
 0.0790206  0.0900123  0.11090054 0.05197819 0.04002444 0.05102946
 0.01913559 0.01913554 0.01913559 0.01913554 0.01913559 0.06187711
 0.09489023 0.01913554 0.01913559 0.02484396 0.02301177 0.02484396
 0.09028482 0.10426249 0.12220045 0.04171239 0.09028491 0.0991011
 0.05960779 0.03230266 0.05960776 0.02484396 0.09028482 0.0311185
 0.01997191 0.01997192 0.01913554 0.0311185  0.09102256 0.03781218
 0.05216781 0.02484396 0.01913559 0.02306388 0.01997191 0.01906334
 0.02397762 0.0659007  0.06187709 0.5886801  0.01911921 0.63703877
 0.05376866 0.02397772 0.08094103 0.02473562 0.02034118 0.02181045
 0.08948027 0.05953037 0.0896806  0.02397772 0.02397772 0.02397772
 0.01939201 0.0661888  0.02397772 0.02034108 0.02397762 0.02397762
 0.02397762 0.0585031  0.02114666 0.11740009 0.11025931 0.07759164
 0.0867448  0.0544997  0.09769741 2.0135887  0.0188356  0.02038955
 0.02465971 0.16990396 0.16990396 0.02034118 0.73668694 0.22558138
 0.0188207  0.01627939 0.49679404 0.7170817  0.02056763 0.02056763
 0.02056763 0.01861581 0.01717456 0.50007963 0.3169266  0.27448988
 0.07306229 0.01830224 0.10002173 0.01627937 0.10030058 0.07587007
 0.01529581 0.18978125 0.0188207  0.22558145 0.01627937 0.07587013
 0.01830224 0.69707566 0.02056763 0.01861581 0.01529581 0.10050214
 0.18381312 0.01861581 0.01861581 0.01861581 0.11556021 2.788832
 3.3993912  0.02056763 0.12085822 0.01861581 0.08140179 0.1316506
 2.0517519  0.13165054 0.01861581 0.02404785 0.15435788 0.01883459
 0.3524538  0.13165054 1.6677842  0.09650954 0.18685423 0.1316506
 0.1120694  0.20330502 0.09090949 0.15793076 0.11045706 0.02359449
 0.02359449 0.15793072 0.3377628  0.02404785 0.1316506  0.0909095
 0.1316506  0.04092092 0.03341501 0.03341496 0.02381741 0.22499304
 0.03341501 0.03341501 0.04092092 0.21313277 0.03341501 0.03341501
 0.03478823 0.2418886  0.22177243 0.1962279  0.03341501 0.11827338
 0.21313277 0.03341501 0.04837991 0.14358015 0.04092092 0.03549485
 0.57785887 0.16658314 0.03341501 0.16658314 0.15526256 0.2214285
 0.3370088  0.03341501 0.36812928 0.1475652  0.16658309 0.2418886
 0.05121421 0.1475652  0.04837996 0.13644125 0.05251019 0.2545694
 0.16745427 0.2545694  0.48584744 0.06093046 0.16745427 0.07354627
 0.07354639 2.23286    0.07354639 0.19830416 0.05121428 0.26423943
 0.18827367 0.06093046 0.18827367 0.66341466 0.16344084 0.636213
 0.07354639 0.16688177 0.28525126 0.07354639 0.2305246  0.17924027
 0.16688177 0.06093046 0.07354639 0.49631113 0.07354639 0.07354639
 0.07354639 0.06941224 0.21544532 0.06941224 0.21041933 0.06941224
 0.15873995 0.15873994 0.15874007 0.07354627 0.07354639 0.07354639
 0.07354639 1.807753   0.21041925 0.06941224 0.07354639 0.07354627
 0.07354639 0.11546138 0.07354627 0.07354627 0.08183967 0.21041925
 0.09741136 1.7409306  0.08183967 0.07354639 0.07354639 0.11387861
 0.2154455  0.22758913 0.22758913 0.10218658 0.30444935 0.33425748
 0.33425748 0.30444935 0.22758913 0.09741136 0.22758913 0.20519042
 0.22821942 0.22758922]
2025-06-02 15:44:51,783 - DEBUG - Edge reconstruction errors: [ 5.2639675  5.2628508 44.2589    ... 13.358881   2.1598773 13.358881 ]
2025-06-02 15:44:51,789 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154451_update_39.json
2025-06-02 15:44:51,790 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:44:51,811 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154451_update_39.pth and as latest_checkpoint.pth
2025-06-02 15:44:51,811 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.5616
2025-06-02 15:44:51,811 - WARNING - Detected 29 anomalous nodes (reconstruction-based):
2025-06-02 15:44:51,811 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.0429, MLP Score: 0.5563
2025-06-02 15:44:51,811 - WARNING -   Node ID: 192.168.27.13, Recon Error: 4.4326, MLP Score: 0.4950
2025-06-02 15:44:51,811 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.7997, MLP Score: 0.5044
2025-06-02 15:44:51,811 - WARNING -   Node ID: 192.168.27.10, Recon Error: 7.2785, MLP Score: 0.5022
2025-06-02 15:44:51,811 - WARNING -   Node ID: 43.132.85.151, Recon Error: 2.1058, MLP Score: 0.4900
2025-06-02 15:44:51,811 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:44:51,812 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.0000
2025-06-02 15:44:51,812 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9606, MLP Score: 0.0000
2025-06-02 15:44:51,812 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.0000
2025-06-02 15:44:51,812 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0000
2025-06-02 15:44:51,812 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.0000
2025-06-02 15:44:51,812 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-02 15:44:51,812 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:44:51,812 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:44:51,812 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 15:44:51,841 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:44:51,870 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 15:44:51,870 - INFO - Processing node updates/additions.
2025-06-02 15:44:51,876 - INFO - Processing edge updates/additions.
2025-06-02 15:44:51,889 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:44:51,890 - INFO - Finished updating NetworkX graph.
2025-06-02 15:44:51,890 - DEBUG - Updated graph - Nodes: 918, Edges: 1958
2025-06-02 15:44:51,890 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:44:51,892 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:44:51,901 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-02 15:44:51,903 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:44:51,903 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-02 15:44:51,905 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-02 15:44:51,907 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:44:51,914 - DEBUG - Initial edge attributes tensor shape: torch.Size([1958, 10])
2025-06-02 15:44:51,916 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:44:51,917 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1958, 10])
2025-06-02 15:44:51,917 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:44:51,918 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:44:51,919 - INFO - Updated main graph to 918 nodes and 1958 edges.
2025-06-02 15:44:51,919 - INFO - Performing online update...
2025-06-02 15:44:51,919 - INFO - Starting online update for 25 steps.
2025-06-02 15:44:51,920 - DEBUG - Updated RunningStats: new_mean=0.9442654921479535, new_var=22800000000161.9, new_n=2310
2025-06-02 15:44:51,920 - DEBUG - Updated RunningStats: new_mean=0.9416475316370125, new_var=23100000000017.992, new_n=2340
2025-06-02 15:44:51,921 - DEBUG - Updated RunningStats: new_mean=44.60021971324374, new_var=7600000188764.186, new_n=770
2025-06-02 15:44:51,921 - DEBUG - Updated RunningStats: new_mean=44.628296260798756, new_var=7700000190590.046, new_n=780
2025-06-02 15:44:51,921 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:44:51,921 - DEBUG - Online update step: 1/25
2025-06-02 15:44:51,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:52,084 - DEBUG - Node anomaly scores shape: torch.Size([17004, 1])
2025-06-02 15:44:52,091 - DEBUG - Edge anomaly scores shape: torch.Size([35204, 1])
2025-06-02 15:44:52,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:52,270 - DEBUG - Step 1: Loss=0.7943
2025-06-02 15:44:52,271 - DEBUG - Online update step: 2/25
2025-06-02 15:44:52,290 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:52,455 - DEBUG - Node anomaly scores shape: torch.Size([17813, 1])
2025-06-02 15:44:52,461 - DEBUG - Edge anomaly scores shape: torch.Size([36875, 1])
2025-06-02 15:44:52,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:52,726 - DEBUG - Step 2: Loss=0.7980
2025-06-02 15:44:52,727 - DEBUG - Online update step: 3/25
2025-06-02 15:44:52,734 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:52,823 - DEBUG - Node anomaly scores shape: torch.Size([15825, 1])
2025-06-02 15:44:52,826 - DEBUG - Edge anomaly scores shape: torch.Size([32686, 1])
2025-06-02 15:44:52,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:52,987 - DEBUG - Step 3: Loss=0.7910
2025-06-02 15:44:52,988 - DEBUG - Online update step: 4/25
2025-06-02 15:44:52,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:53,098 - DEBUG - Node anomaly scores shape: torch.Size([17033, 1])
2025-06-02 15:44:53,101 - DEBUG - Edge anomaly scores shape: torch.Size([35332, 1])
2025-06-02 15:44:53,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:53,264 - DEBUG - Step 4: Loss=0.7850
2025-06-02 15:44:53,264 - DEBUG - Online update step: 5/25
2025-06-02 15:44:53,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:53,350 - DEBUG - Node anomaly scores shape: torch.Size([16003, 1])
2025-06-02 15:44:53,354 - DEBUG - Edge anomaly scores shape: torch.Size([33051, 1])
2025-06-02 15:44:53,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:53,564 - DEBUG - Step 5: Loss=0.7874
2025-06-02 15:44:53,565 - DEBUG - Online update step: 6/25
2025-06-02 15:44:53,568 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:53,673 - DEBUG - Node anomaly scores shape: torch.Size([17319, 1])
2025-06-02 15:44:53,678 - DEBUG - Edge anomaly scores shape: torch.Size([35901, 1])
2025-06-02 15:44:53,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:53,870 - DEBUG - Step 6: Loss=0.7875
2025-06-02 15:44:53,871 - DEBUG - Online update step: 7/25
2025-06-02 15:44:53,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:53,976 - DEBUG - Node anomaly scores shape: torch.Size([17624, 1])
2025-06-02 15:44:53,980 - DEBUG - Edge anomaly scores shape: torch.Size([36605, 1])
2025-06-02 15:44:53,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:54,252 - DEBUG - Step 7: Loss=0.7809
2025-06-02 15:44:54,252 - DEBUG - Online update step: 8/25
2025-06-02 15:44:54,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:54,396 - DEBUG - Node anomaly scores shape: torch.Size([16808, 1])
2025-06-02 15:44:54,401 - DEBUG - Edge anomaly scores shape: torch.Size([34781, 1])
2025-06-02 15:44:54,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:54,628 - DEBUG - Step 8: Loss=0.7771
2025-06-02 15:44:54,629 - DEBUG - Online update step: 9/25
2025-06-02 15:44:54,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:54,730 - DEBUG - Node anomaly scores shape: torch.Size([15573, 1])
2025-06-02 15:44:54,734 - DEBUG - Edge anomaly scores shape: torch.Size([32137, 1])
2025-06-02 15:44:54,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:54,915 - DEBUG - Step 9: Loss=0.7803
2025-06-02 15:44:54,916 - DEBUG - Online update step: 10/25
2025-06-02 15:44:54,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:55,010 - DEBUG - Node anomaly scores shape: torch.Size([17170, 1])
2025-06-02 15:44:55,014 - DEBUG - Edge anomaly scores shape: torch.Size([35667, 1])
2025-06-02 15:44:55,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:55,222 - DEBUG - Step 10: Loss=0.7779
2025-06-02 15:44:55,223 - DEBUG - Online update step: 11/25
2025-06-02 15:44:55,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:55,309 - DEBUG - Node anomaly scores shape: torch.Size([17899, 1])
2025-06-02 15:44:55,314 - DEBUG - Edge anomaly scores shape: torch.Size([37122, 1])
2025-06-02 15:44:55,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:55,513 - DEBUG - Step 11: Loss=0.7729
2025-06-02 15:44:55,513 - DEBUG - Online update step: 12/25
2025-06-02 15:44:55,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:55,637 - DEBUG - Node anomaly scores shape: torch.Size([16765, 1])
2025-06-02 15:44:55,645 - DEBUG - Edge anomaly scores shape: torch.Size([34736, 1])
2025-06-02 15:44:55,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:55,857 - DEBUG - Step 12: Loss=0.7693
2025-06-02 15:44:55,858 - DEBUG - Online update step: 13/25
2025-06-02 15:44:55,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:56,155 - DEBUG - Node anomaly scores shape: torch.Size([16305, 1])
2025-06-02 15:44:56,160 - DEBUG - Edge anomaly scores shape: torch.Size([33598, 1])
2025-06-02 15:44:56,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:56,315 - DEBUG - Step 13: Loss=0.7709
2025-06-02 15:44:56,316 - DEBUG - Online update step: 14/25
2025-06-02 15:44:56,321 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:56,411 - DEBUG - Node anomaly scores shape: torch.Size([15739, 1])
2025-06-02 15:44:56,424 - DEBUG - Edge anomaly scores shape: torch.Size([32476, 1])
2025-06-02 15:44:56,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:56,569 - DEBUG - Step 14: Loss=0.7700
2025-06-02 15:44:56,569 - DEBUG - Online update step: 15/25
2025-06-02 15:44:56,575 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:56,679 - DEBUG - Node anomaly scores shape: torch.Size([17019, 1])
2025-06-02 15:44:56,684 - DEBUG - Edge anomaly scores shape: torch.Size([35429, 1])
2025-06-02 15:44:56,686 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:56,840 - DEBUG - Step 15: Loss=0.7659
2025-06-02 15:44:56,840 - DEBUG - Online update step: 16/25
2025-06-02 15:44:56,846 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:56,961 - DEBUG - Node anomaly scores shape: torch.Size([16706, 1])
2025-06-02 15:44:56,965 - DEBUG - Edge anomaly scores shape: torch.Size([34466, 1])
2025-06-02 15:44:56,967 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:57,138 - DEBUG - Step 16: Loss=0.7626
2025-06-02 15:44:57,138 - DEBUG - Online update step: 17/25
2025-06-02 15:44:57,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:57,257 - DEBUG - Node anomaly scores shape: torch.Size([16028, 1])
2025-06-02 15:44:57,261 - DEBUG - Edge anomaly scores shape: torch.Size([32981, 1])
2025-06-02 15:44:57,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:57,436 - DEBUG - Step 17: Loss=0.7624
2025-06-02 15:44:57,436 - DEBUG - Online update step: 18/25
2025-06-02 15:44:57,442 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:57,553 - DEBUG - Node anomaly scores shape: torch.Size([16059, 1])
2025-06-02 15:44:57,558 - DEBUG - Edge anomaly scores shape: torch.Size([33093, 1])
2025-06-02 15:44:57,559 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:57,725 - DEBUG - Step 18: Loss=0.7592
2025-06-02 15:44:57,726 - DEBUG - Online update step: 19/25
2025-06-02 15:44:57,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:57,847 - DEBUG - Node anomaly scores shape: torch.Size([16105, 1])
2025-06-02 15:44:57,851 - DEBUG - Edge anomaly scores shape: torch.Size([33232, 1])
2025-06-02 15:44:57,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:58,088 - DEBUG - Step 19: Loss=0.7571
2025-06-02 15:44:58,088 - DEBUG - Online update step: 20/25
2025-06-02 15:44:58,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:58,195 - DEBUG - Node anomaly scores shape: torch.Size([15787, 1])
2025-06-02 15:44:58,203 - DEBUG - Edge anomaly scores shape: torch.Size([32378, 1])
2025-06-02 15:44:58,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:58,386 - DEBUG - Step 20: Loss=0.7549
2025-06-02 15:44:58,386 - DEBUG - Online update step: 21/25
2025-06-02 15:44:58,389 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:58,528 - DEBUG - Node anomaly scores shape: torch.Size([17719, 1])
2025-06-02 15:44:58,536 - DEBUG - Edge anomaly scores shape: torch.Size([36899, 1])
2025-06-02 15:44:58,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:58,767 - DEBUG - Step 21: Loss=0.7518
2025-06-02 15:44:58,768 - DEBUG - Online update step: 22/25
2025-06-02 15:44:58,771 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:58,844 - DEBUG - Node anomaly scores shape: torch.Size([16134, 1])
2025-06-02 15:44:58,847 - DEBUG - Edge anomaly scores shape: torch.Size([33275, 1])
2025-06-02 15:44:58,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:58,976 - DEBUG - Step 22: Loss=0.7501
2025-06-02 15:44:58,976 - DEBUG - Online update step: 23/25
2025-06-02 15:44:58,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:59,101 - DEBUG - Node anomaly scores shape: torch.Size([17281, 1])
2025-06-02 15:44:59,105 - DEBUG - Edge anomaly scores shape: torch.Size([35982, 1])
2025-06-02 15:44:59,106 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:59,293 - DEBUG - Step 23: Loss=0.7471
2025-06-02 15:44:59,293 - DEBUG - Online update step: 24/25
2025-06-02 15:44:59,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:59,391 - DEBUG - Node anomaly scores shape: torch.Size([16317, 1])
2025-06-02 15:44:59,396 - DEBUG - Edge anomaly scores shape: torch.Size([33657, 1])
2025-06-02 15:44:59,397 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:59,566 - DEBUG - Step 24: Loss=0.7465
2025-06-02 15:44:59,566 - DEBUG - Online update step: 25/25
2025-06-02 15:44:59,570 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:44:59,657 - DEBUG - Node anomaly scores shape: torch.Size([17505, 1])
2025-06-02 15:44:59,662 - DEBUG - Edge anomaly scores shape: torch.Size([36243, 1])
2025-06-02 15:44:59,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:44:59,852 - DEBUG - Step 25: Loss=0.7441
2025-06-02 15:44:59,852 - INFO - Online update finished. Average loss: 0.7698, Learning rate: 0.001000
2025-06-02 15:44:59,853 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], current edge mean: [-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:44:59,853 - DEBUG - Node drift difference: 0.0134, Edge drift difference: 0.0002
2025-06-02 15:44:59,854 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], edge=[-9.7413111e-10  4.5795404e+02  0.0000000e+00  0.0000000e+00
 -2.4353277e-09  6.3318519e-09 -4.8706555e-10  9.7413111e-10
  2.9223932e-09  9.7413111e-10]
2025-06-02 15:44:59,855 - DEBUG - Updated reference std: node=[0.         0.         1.0005451  1.0005451  0.         0.
 0.         1.0005451  1.0005451  1.0005451  1.0005451  1.0005451
 1.0198451  0.27744794 0.36818114 0.57352495 1.000545   2.9750328
 2.8805428  1.5016054  0.36818114 0.23103443 1.0005451  1.0005451
 0.         0.         0.         0.         1.0005451  1.000545  ], edge=[  1.0002555 460.90012     0.          0.          1.0002555   1.0002555
   1.0002555   1.0002555   1.0002555   1.0002555]
2025-06-02 15:44:59,855 - INFO - Online update complete. Loss: 0.7698
2025-06-02 15:44:59,855 - INFO - Running anomaly detection...
2025-06-02 15:44:59,855 - INFO - Starting anomaly detection.
2025-06-02 15:44:59,868 - DEBUG - Node reconstruction errors: [0.5656775  1.7372645  3.7798424  0.07919104 0.49853864 0.13736396
 3.1122167  0.17120007 0.17120007 0.21887141 0.17120007 0.30346105
 6.278723   1.053974   0.09008398 0.16460685 0.32033727 0.16460703
 1.7810842  0.145894   0.12618473 0.09008398 0.28452265 0.3449455
 0.08449272 0.14685415 0.08449272 0.6202387  0.16083956 0.08449272
 1.8471186  0.3393613  0.5977749  0.0737507  0.3239705  0.20530795
 0.20094746 0.14589399 0.5697306  0.68150556 0.12620895 0.07760439
 0.145894   0.18646501 0.8043216  0.30128258 0.27129096 1.2288705
 0.15194845 0.77123713 1.4043022  0.15619412 0.1411972  1.6730952
 0.11257612 0.43636864 1.9100999  0.11988907 1.7757779  1.684426
 0.530865   0.25011763 0.06643047 0.3999454  0.21280296 0.11257585
 0.06871722 0.11257625 0.06643047 0.25011763 0.13808341 0.12802921
 0.0624382  0.22031108 0.24333917 0.13032743 0.40186054 0.10847104
 0.09232793 0.11454372 0.05840821 0.10184431 1.5125206  1.1297313
 0.12141082 0.40117532 0.106943   0.12064978 0.11598442 0.23660879
 0.05625521 0.51770914 0.2657887  0.1042506  0.14243302 1.6611979
 0.05454902 0.13634317 0.04523724 0.24559827 0.09315739 0.05454902
 0.11787734 0.27003887 0.44673187 0.11023893 0.40054676 0.24806914
 0.2701114  0.5988665  0.43640807 0.05902881 0.5298387  0.4643219
 0.08461396 0.06579385 0.08050486 0.5008809  0.17790991 0.06085968
 0.04891242 0.228973   0.4426251  0.3208414  0.15761961 0.06085912
 0.35791174 0.2916088  0.17721775 0.07418837 0.1336171  0.06261092
 0.5810391  0.7932729  0.07210505 0.10722428 0.13629514 0.04857258
 0.5238724  0.5574493  0.12560794 0.09352171 0.05031448 0.12560801
 0.16806298 0.17982541 0.0805047  0.30776057 0.1790517  0.19506206
 0.8116771  0.45433336 0.10325713 0.06261092 0.53942007 0.48048952
 0.05788928 0.0804894  0.09315761 0.1134421  0.12560794 0.31008703
 0.05788928 0.13361709 0.08092178 0.5192831  0.07822037 0.08768053
 0.30315876 0.19506194 0.1168548  0.06202535 0.05302064 1.5873063
 0.17791    6.0854897  0.08505694 0.09058901 0.07970393 0.07970373
 0.1098176  0.3164186  0.12210096 0.49295095 0.45509493 0.099399
 0.04550606 0.09136309 0.10683554 0.0549492  0.10781381 0.11021768
 0.23348051 0.071335   0.5238721  0.11755601 1.5602763  0.20292658
 0.5182397  0.1924228  0.06322609 0.05788928 0.55514336 0.15498596
 0.1798839  0.2588927  0.19769517 0.79555774 0.0443609  0.09218809
 0.06937768 0.07921079 0.13124874 0.08881329 0.0919291  0.05371065
 0.16043346 0.08050472 0.17091957 0.071335   0.4701317  0.04550608
 0.04720202 0.13124874 0.05788928 0.16682696 0.49123004 0.08179963
 0.10728569 0.23424967 0.36431986 0.09621087 0.1776235  0.08050469
 0.08050478 0.10699037 0.08837318 0.04720202 0.05788928 0.24436934
 0.46953732 0.08049223 0.07598912 0.16168533 0.07729628 0.18337329
 0.0762322  0.10221554 0.07598912 0.07518908 0.05302064 0.05391948
 0.17091975 0.08084714 0.09039605 0.1028939  0.0549492  0.04014739
 0.1668778  0.07970353 0.07732552 0.38781384 0.03940078 0.14188285
 0.13917889 0.12433818 0.10876612 1.8319058  0.10876596 0.0621687
 0.52147216 0.45681265 0.08654564 0.27930337 0.06732656 0.25350526
 0.06356828 0.23188747 0.1098176  0.11452413 0.68980175 0.06632318
 0.08667584 0.1192105  0.1082931  0.05534934 0.7043247  0.256555
 0.3164186  0.87099326 0.12260607 0.06056641 0.07729907 0.07729628
 1.295613   0.05059908 0.07683576 0.07970358 0.11755601 0.38912144
 0.08474219 0.03615347 0.059491   0.10414086 0.03615347 0.03615347
 0.03615347 0.06968182 0.14107881 0.03615356 0.03615347 0.5605597
 0.03615347 0.05295867 0.2969468  0.09674783 0.3058468  0.27737466
 0.13190895 0.11790023 0.18077412 0.06455452 0.17052491 0.05949093
 0.27347323 0.4730207  0.14985761 0.12249058 0.09560471 0.09560466
 0.25155136 0.11959594 0.03615356 0.06732661 0.03615356 0.06968198
 0.1096044  0.04802592 0.0388871  0.03888706 0.03615347 0.05634015
 0.03888706 0.18274672 0.11062577 0.16042955 0.0594909  0.05520784
 0.1153651  0.09584861 0.03615347 0.06799068 0.44401154 0.10485779
 0.05101451 0.0549491  0.03548753 0.03615347 0.04176957 1.0578119
 0.14263852 0.05820733 0.22870117 0.09240814 0.05949098 1.6724781
 0.03995911 0.5127748  0.06944756 0.05731366 0.077046   0.08767893
 0.15308073 0.41952226 0.16322151 0.10486874 0.04252855 0.07723437
 0.5138572  0.03615347 0.05949081 0.2796777  0.05242193 0.08564935
 0.2869024  0.10144862 0.15619071 0.42412442 0.09395614 0.03615356
 0.31364435 0.14525582 0.06263258 0.44825113 0.08784653 0.08784658
 0.08784657 1.7526824  0.03156576 1.755398   0.05211203 0.17156525
 0.08784661 0.0315657  0.06131951 0.06263264 0.16755459 0.05238095
 0.06263269 0.26072374 0.0878466  0.06263267 0.03156576 0.08784661
 0.0878466  0.04136689 0.05164045 0.08784657 0.04251978 0.08227465
 0.10371692 0.05597819 0.05661579 0.05163604 0.42700848 0.10371742
 0.07122723 0.09187474 0.3224274  0.2413312  0.10636338 0.11278532
 0.08077479 0.08537284 0.08784661 0.08784658 0.05211204 0.09526406
 0.4283954  0.10194907 0.06324629 0.0717765  0.21769449 0.03306071
 0.09096839 0.54767823 0.66197854 0.05176485 0.12890758 0.05507581
 0.09876686 0.03606561 0.06046927 0.0279923  0.03606561 0.11322457
 0.05163604 0.09806625 0.07291413 0.11130746 0.06272624 0.06124485
 0.05064907 0.31400105 0.05064915 0.06124485 0.03963849 0.07453961
 0.26942807 0.12498061 0.03963849 0.06272624 0.08119171 0.46090046
 0.11417553 0.05661508 0.0745393  0.06272623 0.03398032 0.06835302
 0.05626037 0.62450546 0.07020564 0.05176485 0.4369158  0.03805285
 0.03606561 0.27651533 0.04275586 0.46110687 0.05281119 0.03398031
 0.08807852 0.03654785 0.1084284  0.05520751 0.0582407  1.6731664
 0.02799236 0.06835302 0.221044   0.03654791 0.25811633 0.05721978
 0.03690328 0.282626   0.02606177 0.78262204 0.06597783 0.03606561
 0.2835258  0.0642111  0.0642111  0.03474139 0.12975688 0.05291491
 0.02606177 0.05118988 0.13320571 0.08401176 0.05118984 0.0717765
 0.02606177 0.1842495  0.03690328 0.05824089 0.14203998 0.40198967
 0.05118977 0.10129032 0.05291497 0.0279923  0.02799236 0.06835302
 0.05824075 0.05787275 0.08888526 0.09618317 0.0279923  0.08336549
 0.0279923  0.08336546 0.09995213 0.05118978 0.05624926 1.2862668
 0.29511544 0.02541763 0.9597553  0.02541774 0.02541775 0.02541766
 0.02541774 0.02541763 0.02541763 0.02541763 0.05602909 0.05815618
 0.04515694 0.02541763 0.02541763 0.02541763 0.02541763 0.02541763
 0.02541763 0.02541763 0.02541763 0.02541763 0.0504893  0.02541763
 0.02541763 0.5062094  0.02541763 0.33669075 0.11942126 0.0279923
 0.06037089 0.0910453  0.795248   0.795248   0.10348954 0.06037089
 0.0279923  0.02606177 0.02606177 0.02799236 0.02606177 0.07339166
 0.05615765 0.02541763 0.0717765  0.0279923  0.06421108 0.0279923
 0.0279923  0.0855385  0.0279923  0.02606177 0.0279923  0.02799236
 0.05118974 0.02606177 0.02799236 0.02606177 0.02799236 0.0279923
 0.0279923  0.09864108 0.12632938 0.05322635 0.02541763 0.12219027
 0.11297924 0.0279923  0.02606177 0.09328005 0.02541763 0.05226422
 0.12139221 0.02646803 0.0279923  0.0279923  0.05104116 0.10699788
 0.05321439 0.0279923  0.0560292  0.03065482 0.02606177 0.3681256
 0.02541763 0.10094539 0.1285668  0.02541763 0.02541763 0.05602905
 0.03065482 0.02799236 0.303417   0.08116959 0.10181039 0.10699787
 0.04625319 0.08344039 0.08344037 0.11171591 0.03233342 0.02541763
 0.06400455 0.08416365 0.10699793 0.05058404 0.03877329 0.04379495
 0.019925   0.019925   0.019925   0.019925   0.01992507 0.05176437
 0.08510722 0.019925   0.019925   0.02541763 0.02430994 0.02541763
 0.08344037 0.10068833 0.11299792 0.04179598 0.08344011 0.0923459
 0.05048934 0.03441311 0.0504894  0.02541763 0.08344037 0.03331843
 0.02239049 0.02239049 0.019925   0.03331843 0.08637427 0.05848005
 0.04609698 0.02541763 0.019925   0.05448681 0.02239049 0.02142455
 0.02577996 0.05364779 0.0517644  0.47495404 0.02047518 0.50732774
 0.04945247 0.02577996 0.05708032 0.02635291 0.02074456 0.02006888
 0.08505009 0.04150269 0.0838941  0.02577996 0.02577996 0.02577996
 0.02177277 0.0544867  0.02577996 0.02074456 0.02577996 0.02577996
 0.02577996 0.05218993 0.02135343 0.09633236 0.09806398 0.07662854
 0.06040597 0.04029305 0.08752844 1.783858   0.01771466 0.01838681
 0.01714963 0.14492325 0.14492325 0.02074456 0.5851777  0.20728897
 0.0177076  0.01306605 0.3378442  0.5723867  0.01740907 0.01740907
 0.01740907 0.01263407 0.01266049 0.36898014 0.2631782  0.25972015
 0.06090566 0.01448797 0.07067765 0.01306605 0.06522782 0.06097021
 0.01472015 0.15873426 0.0177076  0.20728843 0.01306605 0.06096996
 0.01448797 0.53364825 0.01740907 0.01263411 0.01472015 0.07546595
 0.15244874 0.01263411 0.01263411 0.01263411 0.3825362  2.5232437
 3.0769808  0.01740907 0.10955466 0.01263411 0.07509547 0.0864137
 1.815581   0.0864137  0.01263411 0.01375641 0.09058201 0.01664577
 0.28091007 0.0864137  1.3659301  0.07475358 0.14339481 0.0864137
 0.09328479 0.16132408 0.06478985 0.13707943 0.07678816 0.0148755
 0.0148755  0.6347252  0.2735122  0.01375642 0.0864137  0.06478991
 0.0864137  0.0175236  0.01719633 0.01719633 0.01230802 0.15838434
 0.02855169 0.01719633 0.01752367 0.17255361 0.01719633 0.01719633
 0.0167635  0.18820494 0.1586629  0.14415292 0.01719633 0.08294891
 0.17255372 0.01719633 0.02384848 0.09849086 0.0216346  0.0216346
 0.44056633 0.09849092 0.01719633 0.09849086 0.09435297 0.15998745
 0.27686483 0.01719633 0.32691413 0.09308    0.09849092 0.18820494
 0.02420036 0.09308    0.02384841 0.09482227 0.02408972 0.18889573
 0.10777545 0.18889573 0.41768876 0.02705342 0.10777545 0.03647335
 0.03647335 1.9986892  0.03647335 0.13673657 0.02420036 0.19168146
 0.11390121 0.0270534  0.11390121 0.5100221  0.10454394 0.47645026
 0.03647335 0.11260065 0.20601238 0.03647335 0.16298124 0.11321913
 0.12754805 0.02705342 0.03647335 0.4163419  0.03647335 0.03647323
 0.03647335 0.03499395 0.1365562  0.03499402 0.13019006 0.03499395
 0.12592392 0.10955351 0.1259239  0.03647323 0.03647335 0.03647323
 0.03647323 1.54561    0.13019015 0.03499402 0.03647335 0.03647335
 0.03647335 0.07438572 0.03647335 0.03647323 0.03955691 0.13019003
 0.05136853 1.4262086  0.03955691 0.03647323 0.03647335 0.07272217
 0.13840172 0.15140414 0.15140419 0.05401438 0.22593008 0.24002239
 0.14789674 0.2210085  0.15140419 0.05136857 0.15140414 0.14451988
 0.14789675 0.15140419 0.07778623 0.05136853 0.16858076 0.05401429]
2025-06-02 15:44:59,869 - DEBUG - Edge reconstruction errors: [ 5.264627   5.262809  44.25904   ... 13.359026   2.1599774 13.359026 ]
2025-06-02 15:44:59,871 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154459_update_40.json
2025-06-02 15:44:59,871 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:44:59,880 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154459_update_40.pth and as latest_checkpoint.pth
2025-06-02 15:44:59,880 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.5747
2025-06-02 15:44:59,880 - WARNING - Detected 29 anomalous nodes (reconstruction-based):
2025-06-02 15:44:59,880 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.7373, MLP Score: 0.5854
2025-06-02 15:44:59,880 - WARNING -   Node ID: 192.168.27.13, Recon Error: 3.7798, MLP Score: 0.4937
2025-06-02 15:44:59,881 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.1122, MLP Score: 0.5042
2025-06-02 15:44:59,881 - WARNING -   Node ID: 192.168.27.10, Recon Error: 6.2787, MLP Score: 0.5007
2025-06-02 15:44:59,881 - WARNING -   Node ID: 43.132.85.151, Recon Error: 1.7811, MLP Score: 0.4805
2025-06-02 15:44:59,881 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:44:59,881 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2590, MLP Score: 0.0211
2025-06-02 15:44:59,881 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9618, MLP Score: 0.0006
2025-06-02 15:44:59,881 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0613, MLP Score: 0.0006
2025-06-02 15:44:59,881 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7599, MLP Score: 0.0005
2025-06-02 15:44:59,881 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7594, MLP Score: 0.0003
2025-06-02 15:44:59,881 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-02 15:44:59,881 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:44:59,881 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:44:59,881 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 15:44:59,911 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:44:59,936 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 15:44:59,936 - INFO - Processing node updates/additions.
2025-06-02 15:44:59,942 - INFO - Processing edge updates/additions.
2025-06-02 15:44:59,953 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:44:59,953 - INFO - Finished updating NetworkX graph.
2025-06-02 15:44:59,954 - DEBUG - Updated graph - Nodes: 922, Edges: 1981
2025-06-02 15:44:59,954 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:44:59,955 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:44:59,964 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-02 15:44:59,965 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:44:59,965 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-02 15:44:59,966 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-02 15:44:59,967 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:44:59,972 - DEBUG - Initial edge attributes tensor shape: torch.Size([1981, 10])
2025-06-02 15:44:59,973 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:44:59,973 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([1981, 10])
2025-06-02 15:44:59,973 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:44:59,974 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:44:59,974 - INFO - Updated main graph to 922 nodes and 1981 edges.
2025-06-02 15:44:59,974 - INFO - Performing online update...
2025-06-02 15:44:59,974 - INFO - Starting online update for 25 steps.
2025-06-02 15:44:59,975 - DEBUG - Updated RunningStats: new_mean=0.9443832966486937, new_var=23400000000161.7, new_n=2370
2025-06-02 15:44:59,975 - DEBUG - Updated RunningStats: new_mean=0.9418362403986674, new_var=23700000000018.027, new_n=2400
2025-06-02 15:44:59,975 - DEBUG - Updated RunningStats: new_mean=44.64285001193961, new_var=7800000188619.679, new_n=790
2025-06-02 15:44:59,975 - DEBUG - Updated RunningStats: new_mean=44.66633927059707, new_var=7900000188362.781, new_n=800
2025-06-02 15:44:59,976 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:44:59,976 - DEBUG - Online update step: 1/25
2025-06-02 15:44:59,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:00,220 - DEBUG - Node anomaly scores shape: torch.Size([17779, 1])
2025-06-02 15:45:00,291 - DEBUG - Edge anomaly scores shape: torch.Size([36797, 1])
2025-06-02 15:45:00,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:00,600 - DEBUG - Step 1: Loss=0.7413
2025-06-02 15:45:00,601 - DEBUG - Online update step: 2/25
2025-06-02 15:45:00,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:00,680 - DEBUG - Node anomaly scores shape: torch.Size([16146, 1])
2025-06-02 15:45:00,683 - DEBUG - Edge anomaly scores shape: torch.Size([33303, 1])
2025-06-02 15:45:00,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:00,829 - DEBUG - Step 2: Loss=0.7408
2025-06-02 15:45:00,829 - DEBUG - Online update step: 3/25
2025-06-02 15:45:00,832 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:00,944 - DEBUG - Node anomaly scores shape: torch.Size([17430, 1])
2025-06-02 15:45:00,948 - DEBUG - Edge anomaly scores shape: torch.Size([36104, 1])
2025-06-02 15:45:00,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:01,155 - DEBUG - Step 3: Loss=0.7391
2025-06-02 15:45:01,155 - DEBUG - Online update step: 4/25
2025-06-02 15:45:01,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:01,247 - DEBUG - Node anomaly scores shape: torch.Size([16377, 1])
2025-06-02 15:45:01,251 - DEBUG - Edge anomaly scores shape: torch.Size([33888, 1])
2025-06-02 15:45:01,252 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:01,422 - DEBUG - Step 4: Loss=0.7376
2025-06-02 15:45:01,422 - DEBUG - Online update step: 5/25
2025-06-02 15:45:01,425 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:01,514 - DEBUG - Node anomaly scores shape: torch.Size([16642, 1])
2025-06-02 15:45:01,518 - DEBUG - Edge anomaly scores shape: torch.Size([34449, 1])
2025-06-02 15:45:01,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:01,713 - DEBUG - Step 5: Loss=0.7366
2025-06-02 15:45:01,713 - DEBUG - Online update step: 6/25
2025-06-02 15:45:01,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:01,813 - DEBUG - Node anomaly scores shape: torch.Size([17795, 1])
2025-06-02 15:45:01,816 - DEBUG - Edge anomaly scores shape: torch.Size([36898, 1])
2025-06-02 15:45:01,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:02,007 - DEBUG - Step 6: Loss=0.7330
2025-06-02 15:45:02,008 - DEBUG - Online update step: 7/25
2025-06-02 15:45:02,011 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:02,108 - DEBUG - Node anomaly scores shape: torch.Size([17795, 1])
2025-06-02 15:45:02,113 - DEBUG - Edge anomaly scores shape: torch.Size([36906, 1])
2025-06-02 15:45:02,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:02,306 - DEBUG - Step 7: Loss=0.7342
2025-06-02 15:45:02,306 - DEBUG - Online update step: 8/25
2025-06-02 15:45:02,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:02,436 - DEBUG - Node anomaly scores shape: torch.Size([16685, 1])
2025-06-02 15:45:02,452 - DEBUG - Edge anomaly scores shape: torch.Size([34478, 1])
2025-06-02 15:45:02,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:02,699 - DEBUG - Step 8: Loss=0.7329
2025-06-02 15:45:02,699 - DEBUG - Online update step: 9/25
2025-06-02 15:45:02,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:02,783 - DEBUG - Node anomaly scores shape: torch.Size([16202, 1])
2025-06-02 15:45:02,787 - DEBUG - Edge anomaly scores shape: torch.Size([33477, 1])
2025-06-02 15:45:02,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:02,992 - DEBUG - Step 9: Loss=0.7323
2025-06-02 15:45:02,993 - DEBUG - Online update step: 10/25
2025-06-02 15:45:02,999 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:03,097 - DEBUG - Node anomaly scores shape: torch.Size([17206, 1])
2025-06-02 15:45:03,102 - DEBUG - Edge anomaly scores shape: torch.Size([35626, 1])
2025-06-02 15:45:03,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:03,305 - DEBUG - Step 10: Loss=0.7274
2025-06-02 15:45:03,305 - DEBUG - Online update step: 11/25
2025-06-02 15:45:03,311 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:03,424 - DEBUG - Node anomaly scores shape: torch.Size([18644, 1])
2025-06-02 15:45:03,433 - DEBUG - Edge anomaly scores shape: torch.Size([38666, 1])
2025-06-02 15:45:03,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:03,634 - DEBUG - Step 11: Loss=0.7252
2025-06-02 15:45:03,634 - DEBUG - Online update step: 12/25
2025-06-02 15:45:03,637 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:03,755 - DEBUG - Node anomaly scores shape: torch.Size([17961, 1])
2025-06-02 15:45:03,759 - DEBUG - Edge anomaly scores shape: torch.Size([37445, 1])
2025-06-02 15:45:03,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:03,915 - DEBUG - Step 12: Loss=0.7285
2025-06-02 15:45:03,915 - DEBUG - Online update step: 13/25
2025-06-02 15:45:03,919 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:04,026 - DEBUG - Node anomaly scores shape: torch.Size([18203, 1])
2025-06-02 15:45:04,031 - DEBUG - Edge anomaly scores shape: torch.Size([37754, 1])
2025-06-02 15:45:04,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:04,394 - DEBUG - Step 13: Loss=0.7314
2025-06-02 15:45:04,394 - DEBUG - Online update step: 14/25
2025-06-02 15:45:04,397 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:04,480 - DEBUG - Node anomaly scores shape: torch.Size([17208, 1])
2025-06-02 15:45:04,486 - DEBUG - Edge anomaly scores shape: torch.Size([35773, 1])
2025-06-02 15:45:04,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:04,637 - DEBUG - Step 14: Loss=0.7213
2025-06-02 15:45:04,637 - DEBUG - Online update step: 15/25
2025-06-02 15:45:04,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:04,744 - DEBUG - Node anomaly scores shape: torch.Size([17253, 1])
2025-06-02 15:45:04,749 - DEBUG - Edge anomaly scores shape: torch.Size([35686, 1])
2025-06-02 15:45:04,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:04,922 - DEBUG - Step 15: Loss=0.7185
2025-06-02 15:45:04,922 - DEBUG - Online update step: 16/25
2025-06-02 15:45:04,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:05,029 - DEBUG - Node anomaly scores shape: torch.Size([16368, 1])
2025-06-02 15:45:05,033 - DEBUG - Edge anomaly scores shape: torch.Size([33666, 1])
2025-06-02 15:45:05,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:05,212 - DEBUG - Step 16: Loss=0.7238
2025-06-02 15:45:05,213 - DEBUG - Online update step: 17/25
2025-06-02 15:45:05,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:05,304 - DEBUG - Node anomaly scores shape: torch.Size([16907, 1])
2025-06-02 15:45:05,308 - DEBUG - Edge anomaly scores shape: torch.Size([34963, 1])
2025-06-02 15:45:05,309 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:05,476 - DEBUG - Step 17: Loss=0.7311
2025-06-02 15:45:05,477 - DEBUG - Online update step: 18/25
2025-06-02 15:45:05,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:05,579 - DEBUG - Node anomaly scores shape: torch.Size([18036, 1])
2025-06-02 15:45:05,583 - DEBUG - Edge anomaly scores shape: torch.Size([37534, 1])
2025-06-02 15:45:05,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:05,801 - DEBUG - Step 18: Loss=0.7156
2025-06-02 15:45:05,801 - DEBUG - Online update step: 19/25
2025-06-02 15:45:05,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:05,893 - DEBUG - Node anomaly scores shape: torch.Size([16711, 1])
2025-06-02 15:45:05,899 - DEBUG - Edge anomaly scores shape: torch.Size([34687, 1])
2025-06-02 15:45:05,900 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:06,053 - DEBUG - Step 19: Loss=0.7164
2025-06-02 15:45:06,053 - DEBUG - Online update step: 20/25
2025-06-02 15:45:06,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:06,154 - DEBUG - Node anomaly scores shape: torch.Size([16843, 1])
2025-06-02 15:45:06,158 - DEBUG - Edge anomaly scores shape: torch.Size([34902, 1])
2025-06-02 15:45:06,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:06,335 - DEBUG - Step 20: Loss=0.7287
2025-06-02 15:45:06,335 - DEBUG - Online update step: 21/25
2025-06-02 15:45:06,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:06,432 - DEBUG - Node anomaly scores shape: torch.Size([15620, 1])
2025-06-02 15:45:06,435 - DEBUG - Edge anomaly scores shape: torch.Size([32136, 1])
2025-06-02 15:45:06,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:06,584 - DEBUG - Step 21: Loss=0.7143
2025-06-02 15:45:06,584 - DEBUG - Online update step: 22/25
2025-06-02 15:45:06,587 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:06,676 - DEBUG - Node anomaly scores shape: torch.Size([16738, 1])
2025-06-02 15:45:06,680 - DEBUG - Edge anomaly scores shape: torch.Size([34613, 1])
2025-06-02 15:45:06,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:06,866 - DEBUG - Step 22: Loss=0.7106
2025-06-02 15:45:06,866 - DEBUG - Online update step: 23/25
2025-06-02 15:45:06,870 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:06,964 - DEBUG - Node anomaly scores shape: torch.Size([16820, 1])
2025-06-02 15:45:06,968 - DEBUG - Edge anomaly scores shape: torch.Size([34834, 1])
2025-06-02 15:45:06,969 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:07,133 - DEBUG - Step 23: Loss=0.7200
2025-06-02 15:45:07,133 - DEBUG - Online update step: 24/25
2025-06-02 15:45:07,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:07,223 - DEBUG - Node anomaly scores shape: torch.Size([15537, 1])
2025-06-02 15:45:07,226 - DEBUG - Edge anomaly scores shape: torch.Size([31794, 1])
2025-06-02 15:45:07,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:07,374 - DEBUG - Step 24: Loss=0.7257
2025-06-02 15:45:07,374 - DEBUG - Online update step: 25/25
2025-06-02 15:45:07,379 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:07,469 - DEBUG - Node anomaly scores shape: torch.Size([15871, 1])
2025-06-02 15:45:07,474 - DEBUG - Edge anomaly scores shape: torch.Size([32564, 1])
2025-06-02 15:45:07,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:07,628 - DEBUG - Step 25: Loss=0.7101
2025-06-02 15:45:07,629 - INFO - Online update finished. Average loss: 0.7271, Learning rate: 0.001000
2025-06-02 15:45:07,630 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], current edge mean: [ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:45:07,630 - DEBUG - Node drift difference: 0.0042, Edge drift difference: 0.0004
2025-06-02 15:45:07,631 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], edge=[ 0.0000000e+00  4.5778043e+02  0.0000000e+00  0.0000000e+00
 -3.3698739e-09 -9.6282116e-10 -2.8884632e-09 -2.6477580e-09
 -3.3698739e-09 -2.8884632e-09]
2025-06-02 15:45:07,631 - DEBUG - Updated reference std: node=[0.         0.         1.0005428  1.0005428  0.         0.
 0.         1.0005426  1.0005426  1.0005428  1.0005428  1.0005428
 1.0201662  0.2768568  0.3696031  0.5732584  1.0005428  2.978598
 2.8835957  1.5098369  0.3696031  0.23053272 1.0005428  1.0005428
 0.         0.         0.         0.         1.0005428  1.0005428 ], edge=[  1.0002525 458.21814     0.          0.          1.0002525   1.0002525
   1.0002525   1.0002525   1.0002525   1.0002525]
2025-06-02 15:45:07,632 - INFO - Online update complete. Loss: 0.7271
2025-06-02 15:45:07,632 - INFO - Running anomaly detection...
2025-06-02 15:45:07,632 - INFO - Starting anomaly detection.
2025-06-02 15:45:07,646 - DEBUG - Node reconstruction errors: [0.5237931  1.4488943  3.2886815  0.05207684 0.39268348 0.11895671
 2.5868764  0.09142467 0.09142467 0.16266075 0.09142467 0.21703675
 5.459982   0.9457137  0.04698293 0.11931124 0.23306842 0.11931118
 1.5103747  0.11007788 0.08320175 0.04698293 0.25202748 0.2812807
 0.04670754 0.10424636 0.04670754 0.50398827 0.09008668 0.04670754
 1.5289569  0.30513716 0.48004064 0.05081497 0.2896952  0.17641695
 0.17378058 0.11007795 0.5297106  0.61477244 0.11122008 0.04139529
 0.11007795 0.17976497 0.7158912  0.23496823 0.2523487  1.0352733
 0.08930317 0.6998818  1.2028244  0.11413608 0.10346161 1.4306499
 0.07766334 0.35545886 1.679524   0.09808397 1.5167984  1.4310218
 0.44731    0.21804151 0.03609603 0.31698164 0.20200768 0.07766328
 0.03878121 0.07766353 0.03609603 0.21804151 0.11577989 0.10741803
 0.03719834 0.20702328 0.2380157  0.11054768 0.3590905  0.09221029
 0.07780138 0.09846061 0.04507649 0.08905432 1.3535155  0.89912075
 0.10336501 0.2707288  0.10477689 0.18631479 0.09342486 0.23514287
 0.03052474 0.4204902  0.20225446 0.16414472 0.11817425 1.4805968
 0.04250237 0.11026812 0.02608179 0.23364592 0.07796415 0.04250237
 0.10893301 0.26594394 0.3325217  0.08078226 0.3042596  0.19654535
 0.20616575 0.60736525 0.41137668 0.04872017 0.44209686 0.46120098
 0.07246511 0.06293928 0.06846613 0.40250817 0.14406048 0.0404622
 0.02841065 0.16143808 0.36471492 0.2672135  0.12749584 0.04046138
 0.30489507 0.24091281 0.14517424 0.05598159 0.11019819 0.03709463
 0.49327087 0.6393998  0.06305273 0.07786158 0.12820676 0.02700622
 0.43023708 0.46098372 0.15903777 0.09121504 0.03088663 0.10288545
 0.15903766 0.1693431  0.06846608 0.26573297 0.1471948  0.16374965
 0.74619484 0.33998537 0.08967219 0.03709467 0.40924633 0.38081944
 0.03515424 0.08074544 0.07796408 0.1030494  0.15903777 0.2295714
 0.03515424 0.11019819 0.06928153 0.39852607 0.06803816 0.07598405
 0.22459513 0.16374975 0.10137691 0.0430395  0.02803845 1.2883203
 0.14406052 6.364349   0.07334454 0.08793168 0.06852048 0.06852058
 0.08397087 0.24846992 0.11119711 0.41248256 0.36275005 0.07883968
 0.02719831 0.08034033 0.0808901  0.03565583 0.41552132 0.14554258
 0.19726866 0.04210262 0.43023694 0.09965714 1.4168084  0.17829004
 0.41986427 0.17720835 0.04311754 0.03515424 0.41980505 0.16608232
 0.14660196 0.19889107 0.17002058 0.6135473  0.02705375 0.08069281
 0.06116363 0.06792199 0.10847329 0.07522427 0.07328928 0.03447407
 0.12941901 0.06846611 0.15540957 0.04210262 0.38942006 0.02719826
 0.02536981 0.10847329 0.03515424 0.13606134 0.39315006 0.04838219
 0.09415696 0.21622807 0.27493867 0.07654358 0.16725977 0.0684659
 0.06846596 0.08572126 0.07401793 0.02536981 0.03515429 0.21606039
 0.37077782 0.06895338 0.04794765 0.13228916 0.04909164 0.1501285
 0.07033825 0.10154425 0.04794765 0.05876481 0.02803845 0.02818767
 0.1554096  0.06858907 0.16891143 0.08768298 0.03565583 0.02579264
 0.14774494 0.06852033 0.06824511 0.29770893 0.03594517 0.11717586
 0.11282728 0.1012551  0.09495292 1.5309672  0.09495314 0.06102606
 0.4421482  0.3800052  0.0758629  0.25479135 0.05783371 0.2424361
 0.03947091 0.2214392  0.08397083 0.09198367 0.5359665  0.04027812
 0.0761611  0.11004225 0.1589145  0.04702787 0.60421073 0.1828632
 0.24846992 0.741458   0.10087696 0.0498869  0.05877087 0.04909166
 1.1421987  0.03650688 0.06541335 0.06852026 0.09965714 0.30166307
 0.07392783 0.02021793 0.05107162 0.08851228 0.02021793 0.02021793
 0.02021793 0.05894007 0.12551872 0.02021793 0.02021793 0.41528606
 0.02021793 0.03646898 0.21406423 0.08533334 0.31051528 0.21598366
 0.11140786 0.1005762  0.14903127 0.04916765 0.14018787 0.05107158
 0.20719892 0.3948104  0.13081495 0.11213265 0.08474494 0.0847449
 0.22476564 0.10246081 0.02021793 0.05783384 0.02021793 0.05893997
 0.08703367 0.02554722 0.02232635 0.02232635 0.02021793 0.04055052
 0.02232635 0.17348394 0.08864591 0.12941502 0.05107158 0.04816834
 0.10014539 0.08406068 0.02021793 0.06581456 0.3623606  0.10784769
 0.03688295 0.03565583 0.02221039 0.02021793 0.02333479 0.826367
 0.13323167 0.04042879 0.21569706 0.07896797 0.05107163 1.4501591
 0.02158683 0.40757504 0.06158759 0.05370764 0.06660478 0.07348792
 0.12413941 0.41095665 0.13410304 0.10786233 0.02312369 0.05250228
 0.40522847 0.02021793 0.05107153 0.21888205 0.03595576 0.07472292
 0.20949046 0.07989275 0.12773198 0.348104   0.08163751 0.02021793
 0.314187   0.11331801 0.05760527 0.3914876  0.07785913 0.07785914
 0.07785919 1.506406   0.01756956 1.5083022  0.03775287 0.16438922
 0.07785919 0.01756956 0.05682598 0.05760527 0.13818884 0.03769886
 0.05760523 0.2021427  0.07785916 0.05760534 0.01756956 0.07785919
 0.07785916 0.02935719 0.03794223 0.07785919 0.02311813 0.07080626
 0.0804901  0.04178194 0.05343557 0.03716393 0.34986    0.09465946
 0.05394553 0.08733223 0.24327393 0.16305621 0.09486192 0.09159891
 0.0774157  0.07794654 0.07785919 0.07785933 0.03775284 0.08305302
 0.3519986  0.09578429 0.05444359 0.05469837 0.19246869 0.01876411
 0.08160347 0.40493065 0.5070105  0.03846495 0.11154211 0.04137452
 0.08135287 0.01897798 0.04580661 0.09748705 0.01897798 0.09276421
 0.0371639  0.07445429 0.05786277 0.10218024 0.05784274 0.04409285
 0.03681228 0.23773885 0.03681234 0.04409285 0.02137416 0.07264573
 0.20663592 0.10794459 0.02137415 0.05784264 0.06495359 0.41972274
 0.09018573 0.05343483 0.07264576 0.05784275 0.01708945 0.0521578
 0.04517682 0.5114367  0.05797448 0.03846495 0.35333824 0.02749251
 0.01897798 0.22179085 0.03834093 0.41806704 0.05298237 0.0170894
 0.07453599 0.01928858 0.12070772 0.03965478 0.05523185 1.4424678
 0.0153676  0.05215781 0.20950809 0.01928858 0.22095674 0.03567755
 0.01967143 0.21472257 0.01389571 0.6874999  0.04854418 0.01897798
 0.16996771 0.04870801 0.04870801 0.02233798 0.10964731 0.04393165
 0.01389571 0.04550086 0.11542761 0.07502339 0.04550062 0.05469832
 0.01389571 0.1554389  0.01967145 0.05523171 0.1238097  0.34107527
 0.04550078 0.08921075 0.04393165 0.1205805  0.01536755 0.05215781
 0.05523175 0.05466003 0.07982428 0.08206838 0.0153676  0.07728173
 0.0153676  0.07728174 0.0944567  0.04550087 0.04157334 0.97074234
 0.21575959 0.01361215 0.91801983 0.01361215 0.01361215 0.01361215
 0.01361215 0.01361215 0.01361215 0.01361215 0.04986511 0.04309843
 0.04030158 0.01361215 0.01361215 0.01361215 0.01361215 0.01361215
 0.01361215 0.01361215 0.01361215 0.01361215 0.0453291  0.01361215
 0.01361215 0.3971093  0.01361215 0.24456199 0.09199716 0.0153676
 0.0544674  0.08824695 0.6978233  0.6978233  0.0914897  0.0544674
 0.0153676  0.01389571 0.01389571 0.0153676  0.01389571 0.06203095
 0.04204792 0.01361215 0.05469832 0.0153676  0.04870801 0.0153676
 0.0153676  0.08302739 0.0153676  0.01389571 0.0153676  0.0153676
 0.04550077 0.01389571 0.0153676  0.01389571 0.01536755 0.0153676
 0.0153676  0.08789802 0.11023549 0.05137575 0.01361215 0.1004721
 0.09752695 0.0153676  0.01389571 0.0810372  0.01361215 0.04931004
 0.08946462 0.01424119 0.0153676  0.0153676  0.05245594 0.09657692
 0.05251833 0.01536755 0.04986509 0.02034855 0.01389571 0.30760974
 0.01361215 0.07577372 0.10368737 0.01361215 0.01361215 0.04986512
 0.02034855 0.0153676  0.29031822 0.07470708 0.08424279 0.09657692
 0.04028481 0.0767766  0.07677663 0.08916024 0.02553169 0.01361215
 0.05036728 0.08118108 0.0965769  0.049401   0.03242491 0.03806866
 0.01221336 0.01221336 0.01221336 0.01221336 0.01221334 0.04665119
 0.08226147 0.01221336 0.01221334 0.01361215 0.01789252 0.01361215
 0.07677663 0.08989263 0.10745751 0.03199274 0.07677663 0.11617637
 0.04532889 0.03291349 0.04532911 0.01361215 0.07677663 0.01814346
 0.01195677 0.01195677 0.01221336 0.01814343 0.07449854 0.04449772
 0.03977981 0.01361215 0.01221336 0.04610996 0.01195677 0.01410706
 0.0159623  0.04481238 0.0466512  0.41452134 0.01549934 0.38694146
 0.04780722 0.0159623  0.04353772 0.01692774 0.01494674 0.01683962
 0.08105831 0.03227161 0.07819846 0.0159623  0.0159623  0.01596235
 0.01387052 0.04610996 0.0159623  0.01494674 0.0159623  0.0159623
 0.0159623  0.05004824 0.01602212 0.07438175 0.08428219 0.07679663
 0.04712857 0.03243182 0.07304128 1.5344249  0.01433304 0.01554527
 0.01388098 0.12577337 0.12577337 0.01494674 0.43914613 0.18819539
 0.01431921 0.01048014 0.2080453  0.45806116 0.01548723 0.01548723
 0.01548723 0.01020542 0.01154959 0.26513767 0.22803548 0.25413257
 0.05308319 0.01253434 0.05822819 0.0104802  0.0505929  0.05361611
 0.01192122 0.13945685 0.01431921 0.18819518 0.0104802  0.05361608
 0.01253434 0.3852293  0.01548723 0.01020542 0.01192122 0.06423831
 0.13265097 0.01020542 0.01020542 0.01020542 0.29364777 2.1656866
 2.7442935  0.01548723 0.09948524 0.01020542 0.07505904 0.07251709
 1.5893574  0.07251709 0.01020542 0.0101019  0.06312739 0.01410918
 0.23448414 0.07251709 1.0627908  0.06168684 0.11134124 0.07251709
 0.08803978 0.14032672 0.04839223 0.11998066 0.06276089 0.01344508
 0.01344508 0.48252618 0.5288798  0.4016238  0.07251702 0.04839225
 0.07251709 0.0063897  0.01231696 0.01231696 0.00958521 0.13313338
 0.00944105 0.01231696 0.0063897  0.14517954 0.01231696 0.01231696
 0.01024409 0.15874748 0.12812798 0.11403797 0.01231696 0.06991741
 0.14517951 0.01231696 0.01261378 0.0659788  0.0067962  0.00679616
 0.3520745  0.0659788  0.01231696 0.0659788  0.06769136 0.12840955
 0.24352677 0.01231696 0.3110743  0.06637167 0.06637161 0.15874748
 0.01209415 0.0716276  0.01261373 0.06739622 0.00968805 0.15835567
 0.08360618 0.15835567 0.34690768 0.00900811 0.08360637 0.0171971
 0.0171971  1.7629107  0.01719721 0.09780399 0.01209416 0.15675081
 0.08054025 0.00900816 0.08054025 0.38225156 0.13497595 0.3502852
 0.0171971  0.07663591 0.15949093 0.01719721 0.13443844 0.09490449
 0.08167449 0.00900811 0.0171971  0.36057672 0.0171971  0.0171971
 0.0171971  0.01687074 0.10040858 0.01687074 0.09269319 0.01687074
 0.09624429 0.09488367 0.13942663 0.01719721 0.01719721 0.0171971
 0.0171971  1.2718911  0.09269319 0.01687074 0.01719721 0.0171971
 0.0171971  0.04321565 0.01719721 0.01719721 0.0161833  0.09269319
 0.02500733 1.1119804  0.01618336 0.01719721 0.0171971  0.04300842
 0.11456687 0.12202348 0.1220235  0.02634882 0.17704207 0.1864828
 0.09854853 0.43115327 0.12202352 0.02533781 0.12202355 0.09351909
 0.09854853 0.12202352 0.04062945 0.02500742 0.11704322 0.02687752
 0.03852833 0.04062943 0.20465621 0.04017346]
2025-06-02 15:45:07,647 - DEBUG - Edge reconstruction errors: [ 5.2649045  5.262681  44.258915  ... 13.358897   2.1598501 13.358897 ]
2025-06-02 15:45:07,649 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154507_update_41.json
2025-06-02 15:45:07,649 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:45:07,658 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154507_update_41.pth and as latest_checkpoint.pth
2025-06-02 15:45:07,658 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.5853
2025-06-02 15:45:07,658 - WARNING - Detected 27 anomalous nodes (reconstruction-based):
2025-06-02 15:45:07,658 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4489, MLP Score: 0.5674
2025-06-02 15:45:07,658 - WARNING -   Node ID: 192.168.27.13, Recon Error: 3.2887, MLP Score: 0.4983
2025-06-02 15:45:07,658 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.5869, MLP Score: 0.4967
2025-06-02 15:45:07,659 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.4600, MLP Score: 0.4925
2025-06-02 15:45:07,659 - WARNING -   Node ID: 43.132.85.151, Recon Error: 1.5104, MLP Score: 0.4858
2025-06-02 15:45:07,659 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:45:07,659 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2589, MLP Score: 0.0333
2025-06-02 15:45:07,659 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9615, MLP Score: 0.0017
2025-06-02 15:45:07,659 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0612, MLP Score: 0.0017
2025-06-02 15:45:07,659 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7598, MLP Score: 0.0031
2025-06-02 15:45:07,659 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7592, MLP Score: 0.0028
2025-06-02 15:45:07,668 - DEBUG - Embedding standard deviations before t-SNE: [1.2115904e+00 0.0000000e+00 9.8574275e-01 1.0227984e+00 1.9458585e+00
 0.0000000e+00 7.4732137e-01 7.4823171e-01 2.0683212e+00 1.0824841e+00
 7.1709603e-01 2.6625732e-03 1.5300374e+00 4.3384743e-01 1.0566087e+00
 1.1809038e+00 0.0000000e+00 4.5628938e-01 0.0000000e+00 8.4286228e-02
 3.1579835e+00 5.9330308e-01 0.0000000e+00 1.1103537e+00 6.9472784e-01
 7.3447537e-01 0.0000000e+00 6.7776072e-01 1.9980100e+00 0.0000000e+00
 1.1905305e+00 4.7555760e-01]
2025-06-02 15:45:08,988 - INFO - Embeddings visualization saved to vis/embeddings_41_updates_20250602_154507.png
2025-06-02 15:45:08,988 - INFO - Performing visualization of node and edge features.
2025-06-02 15:45:08,990 - INFO - Starting visualization of node features.
2025-06-02 15:45:08,990 - INFO - Graph has 922 nodes and 30 features.
2025-06-02 15:45:08,990 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:45:08,990 - INFO - Calculating feature statistics:
2025-06-02 15:45:08,990 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,990 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,990 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(3.3099326e-08), 'std': np.float32(1.0), 'min': np.float32(-1.9147569), 'max': np.float32(2.4391384)}
2025-06-02 15:45:08,990 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.352639), 'max': np.float32(2.006021)}
2025-06-02 15:45:08,990 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,990 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,991 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,991 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.46169025), 'max': np.float32(2.165954)}
2025-06-02 15:45:08,991 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(6.619865e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1199458), 'max': np.float32(0.8929003)}
2025-06-02 15:45:08,991 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-9.039497), 'max': np.float32(0.11300867)}
2025-06-02 15:45:08,991 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.4760993), 'max': np.float32(1.4725882)}
2025-06-02 15:45:08,991 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4442264), 'max': np.float32(2.5885324)}
2025-06-02 15:45:08,991 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.308026), 'std': np.float32(1.0196128), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:45:08,991 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9609544), 'std': np.float32(0.27670658), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:45:08,991 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:45:08,991 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4078093), 'std': np.float32(0.5729474), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:45:08,991 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11300867), 'max': np.float32(9.039497)}
2025-06-02 15:45:08,991 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3156183), 'std': np.float32(2.9769824), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:45:08,991 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8611712), 'std': np.float32(2.8820314), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:45:08,992 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5986986), 'std': np.float32(1.5090178), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:45:08,992 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:45:08,992 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992408), 'std': np.float32(0.23040767), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:45:08,992 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-4.1374157e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.12914392), 'max': np.float32(16.107769)}
2025-06-02 15:45:08,992 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-6.2061236e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14110813), 'max': np.float32(7.086764)}
2025-06-02 15:45:08,992 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,992 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,992 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,992 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:08,992 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.2748315e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.974236), 'max': np.float32(8.896596)}
2025-06-02 15:45:08,992 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0681784), 'max': np.float32(4.4855456)}
2025-06-02 15:45:09,004 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09965f10>
2025-06-02 15:45:09,136 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:45:09,185 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:45:09,215 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:45:10,575 - INFO - Node feature visualization saved to vis/node_features_20250602_154509.png
2025-06-02 15:45:10,575 - INFO - Finished visualization of node features.
2025-06-02 15:45:10,575 - INFO - Performing additional feature analysis:
2025-06-02 15:45:10,575 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:45:10,577 - INFO - Starting visualization of edge features.
2025-06-02 15:45:10,577 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:45:10,577 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:45:10,577 - INFO - Calculating edge feature statistics:
2025-06-02 15:45:10,578 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:45:10,578 - INFO - - count: {'name': 'count', 'unique': 34, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-0.03646034), 'max': np.float32(34.218254)}
2025-06-02 15:45:10,578 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(457.78043), 'std': np.float32(458.10248), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:45:10,578 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:10,578 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:45:10,578 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1323, 'mean': np.float32(-1.9256423e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.058690593), 'max': np.float32(31.43086)}
2025-06-02 15:45:10,578 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1409, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05430731), 'max': np.float32(33.032013)}
2025-06-02 15:45:10,578 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 468, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.044447273), 'max': np.float32(34.08441)}
2025-06-02 15:45:10,578 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1380, 'mean': np.float32(-1.4442316e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0819718), 'max': np.float32(28.840654)}
2025-06-02 15:45:10,578 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1404, 'mean': np.float32(-2.8884632e-09), 'std': np.float32(1.0), 'min': np.float32(-0.082216784), 'max': np.float32(27.85083)}
2025-06-02 15:45:10,578 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 509, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052967753), 'max': np.float32(33.503876)}
2025-06-02 15:45:10,592 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18a43170>
2025-06-02 15:45:10,692 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:45:10,703 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08ca8d70>
2025-06-02 15:45:10,798 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:45:11,245 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:45:11,387 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:45:11,569 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:45:11,574 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:45:12,911 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154511.png
2025-06-02 15:45:12,911 - INFO - Finished visualization of edge features.
2025-06-02 15:45:12,911 - INFO - Performing additional edge feature analysis:
2025-06-02 15:45:12,911 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:45:12,911 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:45:12,913 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:45:12,913 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 15:45:12,913 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:45:13,219 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154512_summary.png
2025-06-02 15:45:13,494 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154512_pca_3d.png
2025-06-02 15:45:13,660 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154512_pca_variance.png
2025-06-02 15:45:13,660 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:45:13,660 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-02 15:45:13,660 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:45:13,660 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:45:13,660 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 15:45:13,677 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:45:13,695 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 15:45:13,695 - INFO - Processing node updates/additions.
2025-06-02 15:45:13,700 - INFO - Processing edge updates/additions.
2025-06-02 15:45:13,711 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:45:13,712 - INFO - Finished updating NetworkX graph.
2025-06-02 15:45:13,713 - DEBUG - Updated graph - Nodes: 934, Edges: 2007
2025-06-02 15:45:13,713 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:45:13,714 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:45:13,725 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-02 15:45:13,733 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:45:13,738 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-02 15:45:13,740 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-02 15:45:13,743 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:45:13,753 - DEBUG - Initial edge attributes tensor shape: torch.Size([2007, 10])
2025-06-02 15:45:13,758 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:45:13,764 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2007, 10])
2025-06-02 15:45:13,764 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:45:13,765 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:45:13,766 - INFO - Updated main graph to 934 nodes and 2007 edges.
2025-06-02 15:45:13,767 - INFO - Performing online update...
2025-06-02 15:45:13,767 - INFO - Starting online update for 25 steps.
2025-06-02 15:45:13,768 - DEBUG - Updated RunningStats: new_mean=0.9445000116300595, new_var=24000000000161.836, new_n=2430
2025-06-02 15:45:13,768 - DEBUG - Updated RunningStats: new_mean=0.942001057574944, new_var=24300000000017.97, new_n=2460
2025-06-02 15:45:13,768 - DEBUG - Updated RunningStats: new_mean=44.679570484884216, new_var=8000000188288.719, new_n=810
2025-06-02 15:45:13,769 - DEBUG - Updated RunningStats: new_mean=44.698534313194855, new_var=8100000185992.935, new_n=820
2025-06-02 15:45:13,769 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:45:13,769 - DEBUG - Online update step: 1/25
2025-06-02 15:45:13,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:13,918 - DEBUG - Node anomaly scores shape: torch.Size([18071, 1])
2025-06-02 15:45:13,928 - DEBUG - Edge anomaly scores shape: torch.Size([37693, 1])
2025-06-02 15:45:13,933 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:14,344 - DEBUG - Step 1: Loss=0.7346
2025-06-02 15:45:14,345 - DEBUG - Online update step: 2/25
2025-06-02 15:45:14,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:14,451 - DEBUG - Node anomaly scores shape: torch.Size([17318, 1])
2025-06-02 15:45:14,465 - DEBUG - Edge anomaly scores shape: torch.Size([35946, 1])
2025-06-02 15:45:14,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:14,804 - DEBUG - Step 2: Loss=0.7127
2025-06-02 15:45:14,805 - DEBUG - Online update step: 3/25
2025-06-02 15:45:14,809 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:14,982 - DEBUG - Node anomaly scores shape: torch.Size([17777, 1])
2025-06-02 15:45:14,991 - DEBUG - Edge anomaly scores shape: torch.Size([36901, 1])
2025-06-02 15:45:14,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:16,123 - DEBUG - Step 3: Loss=0.7535
2025-06-02 15:45:16,123 - DEBUG - Online update step: 4/25
2025-06-02 15:45:16,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:16,326 - DEBUG - Node anomaly scores shape: torch.Size([17049, 1])
2025-06-02 15:45:16,350 - DEBUG - Edge anomaly scores shape: torch.Size([35274, 1])
2025-06-02 15:45:16,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:16,671 - DEBUG - Step 4: Loss=0.7580
2025-06-02 15:45:16,672 - DEBUG - Online update step: 5/25
2025-06-02 15:45:16,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:17,097 - DEBUG - Node anomaly scores shape: torch.Size([17138, 1])
2025-06-02 15:45:17,103 - DEBUG - Edge anomaly scores shape: torch.Size([35400, 1])
2025-06-02 15:45:17,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:17,251 - DEBUG - Step 5: Loss=0.7068
2025-06-02 15:45:17,252 - DEBUG - Online update step: 6/25
2025-06-02 15:45:17,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:17,324 - DEBUG - Node anomaly scores shape: torch.Size([14784, 1])
2025-06-02 15:45:17,327 - DEBUG - Edge anomaly scores shape: torch.Size([30205, 1])
2025-06-02 15:45:17,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:17,482 - DEBUG - Step 6: Loss=0.7769
2025-06-02 15:45:17,483 - DEBUG - Online update step: 7/25
2025-06-02 15:45:17,486 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:17,607 - DEBUG - Node anomaly scores shape: torch.Size([16909, 1])
2025-06-02 15:45:17,611 - DEBUG - Edge anomaly scores shape: torch.Size([34942, 1])
2025-06-02 15:45:17,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:17,767 - DEBUG - Step 7: Loss=0.7991
2025-06-02 15:45:17,767 - DEBUG - Online update step: 8/25
2025-06-02 15:45:17,770 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:17,880 - DEBUG - Node anomaly scores shape: torch.Size([17489, 1])
2025-06-02 15:45:17,884 - DEBUG - Edge anomaly scores shape: torch.Size([36379, 1])
2025-06-02 15:45:17,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:18,053 - DEBUG - Step 8: Loss=0.7601
2025-06-02 15:45:18,054 - DEBUG - Online update step: 9/25
2025-06-02 15:45:18,057 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:18,160 - DEBUG - Node anomaly scores shape: torch.Size([16164, 1])
2025-06-02 15:45:18,165 - DEBUG - Edge anomaly scores shape: torch.Size([33293, 1])
2025-06-02 15:45:18,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:18,317 - DEBUG - Step 9: Loss=0.7145
2025-06-02 15:45:18,317 - DEBUG - Online update step: 10/25
2025-06-02 15:45:18,320 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:18,458 - DEBUG - Node anomaly scores shape: torch.Size([18563, 1])
2025-06-02 15:45:18,464 - DEBUG - Edge anomaly scores shape: torch.Size([38682, 1])
2025-06-02 15:45:18,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:18,657 - DEBUG - Step 10: Loss=0.7371
2025-06-02 15:45:18,657 - DEBUG - Online update step: 11/25
2025-06-02 15:45:18,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:18,783 - DEBUG - Node anomaly scores shape: torch.Size([19180, 1])
2025-06-02 15:45:18,789 - DEBUG - Edge anomaly scores shape: torch.Size([39948, 1])
2025-06-02 15:45:18,790 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:18,976 - DEBUG - Step 11: Loss=0.7029
2025-06-02 15:45:18,976 - DEBUG - Online update step: 12/25
2025-06-02 15:45:18,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:19,109 - DEBUG - Node anomaly scores shape: torch.Size([17307, 1])
2025-06-02 15:45:19,114 - DEBUG - Edge anomaly scores shape: torch.Size([35875, 1])
2025-06-02 15:45:19,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:19,282 - DEBUG - Step 12: Loss=0.7559
2025-06-02 15:45:19,282 - DEBUG - Online update step: 13/25
2025-06-02 15:45:19,285 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:19,411 - DEBUG - Node anomaly scores shape: torch.Size([16359, 1])
2025-06-02 15:45:19,415 - DEBUG - Edge anomaly scores shape: torch.Size([33795, 1])
2025-06-02 15:45:19,417 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:19,571 - DEBUG - Step 13: Loss=0.7729
2025-06-02 15:45:19,571 - DEBUG - Online update step: 14/25
2025-06-02 15:45:19,574 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:19,705 - DEBUG - Node anomaly scores shape: torch.Size([18279, 1])
2025-06-02 15:45:19,710 - DEBUG - Edge anomaly scores shape: torch.Size([38122, 1])
2025-06-02 15:45:19,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:19,885 - DEBUG - Step 14: Loss=0.7297
2025-06-02 15:45:19,885 - DEBUG - Online update step: 15/25
2025-06-02 15:45:19,888 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:19,989 - DEBUG - Node anomaly scores shape: torch.Size([16600, 1])
2025-06-02 15:45:19,994 - DEBUG - Edge anomaly scores shape: torch.Size([34300, 1])
2025-06-02 15:45:19,995 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:20,179 - DEBUG - Step 15: Loss=0.7341
2025-06-02 15:45:20,179 - DEBUG - Online update step: 16/25
2025-06-02 15:45:20,182 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:20,271 - DEBUG - Node anomaly scores shape: torch.Size([16052, 1])
2025-06-02 15:45:20,277 - DEBUG - Edge anomaly scores shape: torch.Size([32942, 1])
2025-06-02 15:45:20,278 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:20,430 - DEBUG - Step 16: Loss=0.7616
2025-06-02 15:45:20,430 - DEBUG - Online update step: 17/25
2025-06-02 15:45:20,434 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:20,545 - DEBUG - Node anomaly scores shape: torch.Size([17216, 1])
2025-06-02 15:45:20,550 - DEBUG - Edge anomaly scores shape: torch.Size([35566, 1])
2025-06-02 15:45:20,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:20,740 - DEBUG - Step 17: Loss=0.7280
2025-06-02 15:45:20,740 - DEBUG - Online update step: 18/25
2025-06-02 15:45:20,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:20,867 - DEBUG - Node anomaly scores shape: torch.Size([17111, 1])
2025-06-02 15:45:20,872 - DEBUG - Edge anomaly scores shape: torch.Size([35490, 1])
2025-06-02 15:45:20,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:21,033 - DEBUG - Step 18: Loss=0.7208
2025-06-02 15:45:21,033 - DEBUG - Online update step: 19/25
2025-06-02 15:45:21,036 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:21,170 - DEBUG - Node anomaly scores shape: torch.Size([17754, 1])
2025-06-02 15:45:21,175 - DEBUG - Edge anomaly scores shape: torch.Size([36786, 1])
2025-06-02 15:45:21,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:21,332 - DEBUG - Step 19: Loss=0.7393
2025-06-02 15:45:21,333 - DEBUG - Online update step: 20/25
2025-06-02 15:45:21,336 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:21,454 - DEBUG - Node anomaly scores shape: torch.Size([17671, 1])
2025-06-02 15:45:21,459 - DEBUG - Edge anomaly scores shape: torch.Size([36903, 1])
2025-06-02 15:45:21,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:21,620 - DEBUG - Step 20: Loss=0.7009
2025-06-02 15:45:21,621 - DEBUG - Online update step: 21/25
2025-06-02 15:45:21,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:21,726 - DEBUG - Node anomaly scores shape: torch.Size([17541, 1])
2025-06-02 15:45:21,731 - DEBUG - Edge anomaly scores shape: torch.Size([36461, 1])
2025-06-02 15:45:21,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:22,131 - DEBUG - Step 21: Loss=0.7455
2025-06-02 15:45:22,132 - DEBUG - Online update step: 22/25
2025-06-02 15:45:22,135 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:22,228 - DEBUG - Node anomaly scores shape: torch.Size([15630, 1])
2025-06-02 15:45:22,232 - DEBUG - Edge anomaly scores shape: torch.Size([32122, 1])
2025-06-02 15:45:22,233 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:22,412 - DEBUG - Step 22: Loss=0.7672
2025-06-02 15:45:22,412 - DEBUG - Online update step: 23/25
2025-06-02 15:45:22,415 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:22,508 - DEBUG - Node anomaly scores shape: torch.Size([17479, 1])
2025-06-02 15:45:22,512 - DEBUG - Edge anomaly scores shape: torch.Size([36256, 1])
2025-06-02 15:45:22,513 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:22,739 - DEBUG - Step 23: Loss=0.7308
2025-06-02 15:45:22,739 - DEBUG - Online update step: 24/25
2025-06-02 15:45:22,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:22,917 - DEBUG - Node anomaly scores shape: torch.Size([18285, 1])
2025-06-02 15:45:22,923 - DEBUG - Edge anomaly scores shape: torch.Size([37989, 1])
2025-06-02 15:45:22,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:23,428 - DEBUG - Step 24: Loss=0.7097
2025-06-02 15:45:23,428 - DEBUG - Online update step: 25/25
2025-06-02 15:45:23,431 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:23,603 - DEBUG - Node anomaly scores shape: torch.Size([17099, 1])
2025-06-02 15:45:23,629 - DEBUG - Edge anomaly scores shape: torch.Size([35658, 1])
2025-06-02 15:45:23,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:24,284 - DEBUG - Step 25: Loss=0.7313
2025-06-02 15:45:24,284 - INFO - Online update finished. Average loss: 0.7394, Learning rate: 0.001000
2025-06-02 15:45:24,287 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], current edge mean: [ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:45:24,288 - DEBUG - Node drift difference: 0.0108, Edge drift difference: 0.0009
2025-06-02 15:45:24,292 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], edge=[ 3.8013925e-09  4.5738068e+02  0.0000000e+00  0.0000000e+00
 -2.3758702e-09  1.9006963e-09 -9.5034813e-10  1.9006963e-09
  1.9006963e-09  2.8510443e-09]
2025-06-02 15:45:24,294 - DEBUG - Updated reference std: node=[0.         0.         1.0005357  1.0005357  0.         0.
 0.         1.0005357  1.0005357  1.0005358  1.0005357  1.0005357
 1.0156461  0.27510577 0.3654804  0.5750021  1.0005357  2.9664128
 2.87709    1.51188    0.3654804  0.229047   1.0005357  1.0005357
 0.         0.         0.         0.         1.0005357  1.0005357 ], edge=[  1.0002493 455.3443      0.          0.          1.0002491   1.0002493
   1.0002493   1.0002493   1.0002493   1.0002493]
2025-06-02 15:45:24,307 - INFO - Online update complete. Loss: 0.7394
2025-06-02 15:45:24,307 - INFO - Running anomaly detection...
2025-06-02 15:45:24,307 - INFO - Starting anomaly detection.
2025-06-02 15:45:24,319 - DEBUG - Node reconstruction errors: [4.97636467e-01 1.10546339e+00 3.02571225e+00 4.33242396e-02
 2.99318939e-01 1.01361752e-01 2.30282545e+00 5.90183884e-02
 5.90183958e-02 1.34093285e-01 5.90183958e-02 1.23048477e-01
 4.98643494e+00 8.18460405e-01 3.21799256e-02 1.00769617e-01
 2.73839086e-01 1.00769773e-01 1.21486139e+00 9.83229727e-02
 6.52074143e-02 3.21799256e-02 2.98005104e-01 2.14767262e-01
 3.33961919e-02 8.23900625e-02 3.33961919e-02 4.07762110e-01
 5.99479340e-02 3.33961919e-02 1.30915391e+00 2.72910595e-01
 3.64389867e-01 4.30606939e-02 2.65502244e-01 1.54336601e-01
 1.48650602e-01 9.83229727e-02 4.58262593e-01 5.49381614e-01
 9.86264572e-02 2.91730873e-02 9.83229727e-02 1.72740757e-01
 6.27180338e-01 1.56400248e-01 2.08321080e-01 8.18484902e-01
 6.14451244e-02 6.66916132e-01 9.70349252e-01 9.08160433e-02
 8.34006518e-02 1.17038238e+00 6.14032410e-02 2.78080404e-01
 1.47915065e+00 9.41712186e-02 1.23492610e+00 1.17934775e+00
 3.79461765e-01 1.89756975e-01 2.62577292e-02 2.28444979e-01
 2.05698311e-01 6.14031479e-02 2.51695048e-02 6.14036396e-02
 2.62578093e-02 2.62345761e-01 9.82332230e-02 8.42712298e-02
 2.50475518e-02 1.60458937e-01 1.98820680e-01 8.63968655e-02
 3.24873477e-01 7.45000541e-02 7.16511905e-02 9.49058831e-02
 3.96255292e-02 7.20517635e-02 1.15284014e+00 6.26884460e-01
 8.80632401e-02 1.43656522e-01 9.40873474e-02 1.48354039e-01
 8.17923248e-02 2.32194483e-01 2.17902139e-02 3.04224491e-01
 1.13720939e-01 1.28475085e-01 9.72404256e-02 1.21939778e+00
 3.76613997e-02 8.64730552e-02 2.01778617e-02 2.00138599e-01
 6.26319274e-02 3.76615189e-02 1.02249973e-01 2.63425767e-01
 2.26185456e-01 6.61100969e-02 2.31887624e-01 1.23723477e-01
 1.19910046e-01 5.64129293e-01 3.67868245e-01 4.46236059e-02
 3.15453976e-01 3.49870503e-01 5.80482446e-02 5.41978739e-02
 5.48676625e-02 3.23274165e-01 1.12471774e-01 2.82685440e-02
 2.09750533e-02 8.00520629e-02 2.92146355e-01 1.97559774e-01
 9.68182757e-02 2.82677114e-02 2.31041938e-01 1.75115973e-01
 1.15429446e-01 4.51745875e-02 9.22056213e-02 2.53106263e-02
 3.88146728e-01 4.83931243e-01 5.08562922e-02 6.27888963e-02
 1.19473808e-01 2.04566326e-02 3.34999651e-01 3.52270275e-01
 1.30081266e-01 8.22463706e-02 2.39533354e-02 8.27739090e-02
 1.30081266e-01 1.50317356e-01 5.48677109e-02 2.40703523e-01
 1.21780671e-01 1.34497613e-01 6.79165840e-01 2.24048689e-01
 8.70620459e-02 2.53106263e-02 2.85632342e-01 2.95099735e-01
 2.45032646e-02 7.23319873e-02 6.26317710e-02 9.55224559e-02
 1.30081400e-01 1.42386377e-01 2.45032646e-02 9.22056213e-02
 5.57440929e-02 2.75892526e-01 5.65536357e-02 7.35272542e-02
 1.37255892e-01 1.34497434e-01 9.92363468e-02 3.11511718e-02
 1.97753292e-02 1.00842595e+00 1.12471499e-01 6.76421833e+00
 7.06691295e-02 7.92311057e-02 5.53762801e-02 5.53764589e-02
 6.95029423e-02 1.54811338e-01 9.22778472e-02 3.41523796e-01
 2.71304756e-01 6.37064949e-02 2.13369038e-02 6.63794726e-02
 6.60293773e-02 2.57344227e-02 2.89308101e-01 1.13181800e-01
 1.68033570e-01 2.92993151e-02 3.34999651e-01 8.51951614e-02
 1.24236906e+00 1.50359586e-01 3.43188494e-01 1.48191452e-01
 3.32877859e-02 2.45034117e-02 2.94813484e-01 1.31413952e-01
 1.15734056e-01 1.22315004e-01 1.49081290e-01 4.44993466e-01
 2.15233397e-02 7.96004161e-02 4.99321409e-02 1.52254090e-01
 9.11028087e-02 6.73468634e-02 5.87185062e-02 2.71541048e-02
 1.03465527e-01 5.48677035e-02 1.43947586e-01 2.92993318e-02
 3.20463538e-01 2.13369485e-02 1.81325153e-02 9.11028087e-02
 2.45032646e-02 1.04527086e-01 3.12261552e-01 3.39550190e-02
 9.33161899e-02 1.14065766e-01 1.94213778e-01 6.42571077e-02
 1.33996725e-01 5.48676737e-02 5.48676476e-02 6.77012652e-02
 6.89759925e-02 1.81325153e-02 2.45034117e-02 1.87064961e-01
 2.85872996e-01 1.53790653e-01 3.44056599e-02 1.03400975e-01
 3.58037837e-02 1.17437847e-01 6.01996295e-02 9.28632990e-02
 3.44056152e-02 4.52411361e-02 1.97753292e-02 1.97960939e-02
 1.43947601e-01 6.30860403e-02 1.35592550e-01 7.15232044e-02
 2.57344227e-02 2.10375059e-02 1.22568160e-01 5.53764105e-02
 6.82882294e-02 1.83097288e-01 2.70980559e-02 9.74342972e-02
 8.97284597e-02 1.31007850e-01 8.90026465e-02 1.33312070e+00
 8.90025795e-02 5.38180023e-02 3.71637464e-01 3.07711750e-01
 7.36364573e-02 2.33234584e-01 4.83546108e-02 2.22728968e-01
 2.88912915e-02 2.12073103e-01 6.95029423e-02 7.47075155e-02
 3.77832919e-01 2.92392541e-02 7.46411830e-02 9.96270180e-02
 1.24587692e-01 4.16240878e-02 4.74456251e-01 1.05477408e-01
 1.54811338e-01 6.26615345e-01 1.30172223e-01 4.57139201e-02
 4.98744063e-02 3.58037837e-02 9.83885884e-01 3.07560936e-02
 6.11081868e-02 5.53763770e-02 8.51951614e-02 2.10262597e-01
 7.27684721e-02 1.41574383e-01 4.27696928e-02 7.53365979e-02
 1.56178987e-02 1.56178521e-02 1.56178521e-02 4.86024618e-02
 1.06073134e-01 1.41574383e-01 1.56178521e-02 2.86053717e-01
 1.56178987e-02 2.70442981e-02 1.21375702e-01 8.46455395e-02
 2.96113700e-01 1.20105140e-01 9.44190845e-02 8.63022655e-02
 1.23951808e-01 3.81659940e-02 1.10664748e-01 4.27695960e-02
 1.27053440e-01 3.23280841e-01 4.11473542e-01 9.80931818e-02
 8.45280513e-02 8.45279619e-02 2.19182536e-01 8.77209529e-02
 1.56178521e-02 4.83544730e-02 1.56178521e-02 4.86024544e-02
 7.01299682e-02 1.81653276e-02 1.68188944e-01 1.73484217e-02
 1.41574383e-01 3.87438759e-02 1.73484217e-02 1.41506895e-01
 7.21080825e-02 1.03458419e-01 4.27697860e-02 4.33640629e-02
 9.48558226e-02 8.32370892e-02 1.56178521e-02 5.77633344e-02
 2.90536672e-01 1.02002017e-01 3.55410725e-02 2.57344227e-02
 1.41574383e-01 1.56178521e-02 1.78169012e-02 5.56505263e-01
 1.17250614e-01 2.98847631e-02 2.19822600e-01 6.96572140e-02
 4.27698307e-02 1.20692372e+00 1.62257329e-02 2.88867086e-01
 5.12216277e-02 4.58153933e-02 6.38905764e-02 6.42623380e-02
 9.71787795e-02 2.80980408e-01 1.06104769e-01 1.02008775e-01
 1.68896895e-02 3.89794558e-02 2.85330743e-01 1.56178521e-02
 4.27698530e-02 1.30744979e-01 2.62703262e-02 7.29887560e-02
 1.24821663e-01 6.20642193e-02 1.07868604e-01 2.54866570e-01
 6.79514483e-02 1.56178521e-02 3.04703176e-01 8.75407830e-02
 4.90684584e-02 2.87446707e-01 6.66585043e-02 6.66585118e-02
 6.66586533e-02 1.25411451e+00 1.37772597e-02 1.25511098e+00
 2.86574326e-02 1.59802631e-01 6.66585267e-02 1.37772942e-02
 4.85588126e-02 4.90683988e-02 1.12822480e-01 2.75689568e-02
 4.90684435e-02 1.24142535e-01 6.66586682e-02 4.90682274e-02
 1.37772597e-02 6.66585118e-02 6.66586682e-02 2.81876810e-02
 3.66416946e-02 6.66585937e-02 1.68810282e-02 5.70933819e-02
 6.40911683e-02 3.11761424e-02 4.61223982e-02 2.78134886e-02
 2.69020289e-01 7.53125921e-02 4.10274714e-02 7.83519819e-02
 1.57887906e-01 7.12866932e-02 9.19359848e-02 7.71178231e-02
 6.96478710e-02 6.90596923e-02 2.95352787e-01 6.66585118e-02
 2.86574326e-02 8.04586038e-02 2.73141891e-01 8.16439167e-02
 4.30666246e-02 4.27353568e-02 1.84128240e-01 1.38717238e-02
 6.48293346e-02 2.76019424e-01 3.71059537e-01 2.89652385e-02
 9.65456590e-02 3.19429003e-02 6.85377121e-02 1.47124231e-02
 3.57737169e-02 9.53571498e-02 1.47124231e-02 7.76265711e-02
 2.78134886e-02 5.77526428e-02 5.25210239e-02 1.01190560e-01
 4.95347567e-02 3.35861668e-02 2.72988752e-02 1.24619268e-01
 2.72987895e-02 3.35862413e-02 1.60081033e-02 6.56888783e-02
 1.30054042e-01 9.30790752e-02 1.60081033e-02 4.95348684e-02
 5.46103008e-02 3.59049261e-01 7.17313960e-02 4.61214520e-02
 6.56891018e-02 4.95348834e-02 1.29072024e-02 4.11672555e-02
 4.21488024e-02 4.03721809e-01 4.65079211e-02 2.89652105e-02
 2.70226926e-01 2.02856362e-02 1.47124231e-02 1.46857515e-01
 3.47519666e-02 3.55912000e-01 4.78793792e-02 1.29072024e-02
 6.93928972e-02 1.46304555e-02 9.67043415e-02 2.99180038e-02
 4.83496189e-02 1.24763179e+00 1.22578600e-02 4.11672555e-02
 2.12998763e-01 1.46305161e-02 2.03972980e-01 2.64071729e-02
 1.50491381e-02 1.16934434e-01 1.09751355e-02 5.96237004e-01
 3.67802382e-02 1.47124231e-02 6.97825253e-02 3.77747342e-02
 3.77747342e-02 1.66361369e-02 9.40218121e-02 3.42174396e-02
 1.09751355e-02 3.79073694e-02 1.05469972e-01 7.41957873e-02
 3.79073620e-02 4.27353568e-02 1.09751560e-02 1.34637818e-01
 1.50491381e-02 4.83497046e-02 1.05417632e-01 2.63050944e-01
 1.17362753e-01 8.64163563e-02 3.42174396e-02 9.41781849e-02
 1.22578600e-02 4.11672555e-02 4.83496673e-02 4.74915691e-02
 8.07333365e-02 7.72517547e-02 1.22578600e-02 6.94418773e-02
 1.22578600e-02 9.48296264e-02 9.42396596e-02 3.79073732e-02
 3.21394652e-02 6.58878922e-01 1.23873100e-01 1.10291298e-02
 8.38305116e-01 1.10291298e-02 1.10291624e-02 1.10291624e-02
 1.10291298e-02 1.10291624e-02 1.10291298e-02 1.10291624e-02
 4.12611887e-02 3.35533954e-02 3.82129960e-02 1.10291298e-02
 1.10291624e-02 1.10291298e-02 1.10291298e-02 1.10291298e-02
 1.10291624e-02 1.10291624e-02 1.10291624e-02 1.10291624e-02
 3.75411138e-02 1.10291298e-02 1.10291298e-02 2.95582414e-01
 1.10291624e-02 1.65342897e-01 7.64431432e-02 1.22578600e-02
 4.70240377e-02 8.28904808e-02 5.87901413e-01 5.87901413e-01
 8.92658904e-02 4.70240377e-02 1.22578600e-02 1.09751560e-02
 1.09751560e-02 1.22578600e-02 1.09751560e-02 5.67741171e-02
 3.21268775e-02 1.10291624e-02 4.27353568e-02 1.22578600e-02
 3.77747342e-02 1.22578600e-02 1.22578600e-02 6.85967207e-02
 1.22578600e-02 1.09751355e-02 1.22578600e-02 1.22578600e-02
 3.79073992e-02 1.09751355e-02 1.22578600e-02 1.09751560e-02
 1.22578600e-02 1.22578600e-02 1.22578600e-02 8.49383697e-02
 8.48015323e-02 4.52427082e-02 1.10291624e-02 8.38023052e-02
 8.77228603e-02 1.22578600e-02 1.09751560e-02 7.44220242e-02
 1.10291624e-02 3.93514149e-02 7.09509775e-02 1.12255085e-02
 1.22578600e-02 1.22578600e-02 5.04354425e-02 9.38061848e-02
 4.71735634e-02 1.22578600e-02 4.12612222e-02 1.62461177e-02
 1.09751560e-02 2.24322692e-01 1.10291624e-02 5.96598797e-02
 8.60736445e-02 1.10291298e-02 1.10291298e-02 4.12611850e-02
 1.62461177e-02 1.22578600e-02 2.92551190e-01 6.69106469e-02
 7.40787014e-02 9.38061848e-02 3.01950406e-02 6.77659512e-02
 6.77659512e-02 7.48850480e-02 1.86560079e-02 1.10291624e-02
 3.98895517e-02 7.60748237e-02 9.38061550e-02 4.38776575e-02
 2.42785420e-02 2.84730084e-02 1.00239189e-02 1.00239040e-02
 1.00239040e-02 1.00239394e-02 1.00239040e-02 3.85747664e-02
 7.80700371e-02 1.00239189e-02 1.00239189e-02 1.10291624e-02
 1.39050893e-02 1.10291298e-02 6.77659512e-02 8.65537673e-02
 1.01941995e-01 3.15762497e-02 6.77659512e-02 9.38490704e-02
 3.75412367e-02 2.55210213e-02 3.75411436e-02 1.10291624e-02
 6.77659512e-02 1.39221819e-02 9.46697686e-03 9.46697686e-03
 1.00239189e-02 1.39221819e-02 6.89725727e-02 3.62583362e-02
 3.17622460e-02 1.10291624e-02 1.00239189e-02 3.65167037e-02
 9.46697686e-03 1.08836694e-02 1.24205146e-02 3.52526270e-02
 3.85746621e-02 3.47462982e-01 1.03075700e-02 2.92915344e-01
 4.37956564e-02 1.24204811e-02 3.40228453e-02 1.30430320e-02
 1.16859255e-02 1.11546256e-02 7.30700418e-02 2.62196083e-02
 6.98731095e-02 1.24205146e-02 1.24205248e-02 1.24205146e-02
 1.01741794e-02 3.65167037e-02 1.24205146e-02 1.16859255e-02
 1.24205146e-02 1.24205146e-02 1.24205146e-02 4.56520915e-02
 1.24212382e-02 6.38494864e-02 7.80358613e-02 7.23670796e-02
 3.77928540e-02 2.59269886e-02 7.78681412e-02 1.30589294e+00
 1.12434272e-02 1.20937033e-02 9.70603991e-03 1.07312366e-01
 1.07312433e-01 1.16859255e-02 3.19115072e-01 1.82398796e-01
 1.12313312e-02 8.74250289e-03 9.08584297e-02 3.26114833e-01
 1.21386936e-02 1.21386936e-02 1.21386936e-02 8.59122071e-03
 8.17158166e-03 1.58871993e-01 2.03121260e-01 2.56967694e-01
 4.80558164e-02 7.87422340e-03 4.80149016e-02 8.74248985e-03
 4.12855074e-02 4.69673648e-02 8.54675751e-03 1.25488102e-01
 1.12313312e-02 1.82398409e-01 8.74248985e-03 4.69673239e-02
 7.87422340e-03 2.59854198e-01 1.21386936e-02 8.59122071e-03
 8.54675751e-03 5.36851622e-02 1.13441430e-01 8.59122071e-03
 8.59122071e-03 8.59122071e-03 1.98855162e-01 1.80167329e+00
 2.48732162e+00 1.21386936e-02 1.86729118e-01 8.59122071e-03
 7.43181780e-02 5.50795086e-02 1.38217592e+00 6.13641217e-02
 8.59122071e-03 8.73854291e-03 5.03480434e-02 1.11189643e-02
 6.49003446e-01 6.13641217e-02 7.88736165e-01 5.70270307e-02
 1.04878031e-01 6.13641217e-02 8.23245421e-02 1.20268784e-01
 4.54817638e-02 1.12742357e-01 5.16704060e-02 1.13689434e-02
 1.13689564e-02 3.61816317e-01 4.32979167e-01 3.07772070e-01
 6.13639355e-02 4.54817601e-02 6.13639355e-02 6.18489599e-03
 1.19083589e-02 1.19084576e-02 8.18750262e-03 1.15997076e-01
 5.31963399e-03 1.19084259e-02 6.18487503e-03 1.31282598e-01
 1.19084259e-02 1.19084259e-02 9.16728843e-03 1.44676790e-01
 1.13100395e-01 9.96521786e-02 1.19084259e-02 5.89465536e-02
 1.31282598e-01 1.19084259e-02 1.22292573e-02 5.34618124e-02
 5.13117528e-03 5.13114873e-03 2.58230060e-01 5.34618124e-02
 1.19084576e-02 5.34618124e-02 5.68129942e-02 1.12856299e-01
 2.18703359e-01 1.19084576e-02 3.01994711e-01 5.20989560e-02
 5.20989560e-02 1.44676790e-01 9.67038516e-03 6.19489290e-02
 1.22292573e-02 5.97758070e-02 8.15563928e-03 1.35805413e-01
 7.40715936e-02 1.35805443e-01 3.19379538e-01 5.01487404e-03
 7.40715936e-02 1.06622465e-02 1.06622325e-02 1.52743530e+00
 1.06622120e-02 8.21484476e-02 9.67038516e-03 1.32583797e-01
 6.63883835e-02 5.01491921e-03 6.63883165e-02 2.89164364e-01
 1.12105414e-01 2.02057824e-01 1.06622120e-02 5.88083118e-02
 1.43015906e-01 1.06622120e-02 1.16246477e-01 8.21140260e-02
 5.88083118e-02 5.01491921e-03 1.06622325e-02 3.41111600e-01
 1.06622325e-02 1.06622120e-02 1.06622325e-02 1.20614795e-02
 7.78606161e-02 1.20614795e-02 6.97353706e-02 1.20615084e-02
 7.46235922e-02 8.54800865e-02 1.25775442e-01 1.06622120e-02
 1.06622120e-02 6.58681802e-03 1.06622465e-02 1.00934625e+00
 7.77592212e-02 1.20614795e-02 1.06622120e-02 1.06622465e-02
 1.06622120e-02 2.85473987e-02 1.06622465e-02 1.06622120e-02
 7.35509163e-03 7.77592808e-02 1.07121700e-02 8.16059113e-01
 7.35513540e-03 1.06622120e-02 1.06622325e-02 2.88512204e-02
 9.89149585e-02 1.02754094e-01 1.02754161e-01 1.37587916e-02
 1.49792671e-01 1.68719769e-01 7.99968168e-02 4.00649160e-01
 1.02754161e-01 1.39547298e-02 1.02754161e-01 6.61323741e-02
 7.99968168e-02 1.02754161e-01 2.02795379e-02 1.07122026e-02
 9.59063768e-02 1.09527903e-02 1.94955859e-02 1.90479718e-02
 1.78856373e-01 2.12818142e-02 3.10195219e-02 3.10195219e-02
 2.12818142e-02 3.10195219e-02 3.10195219e-02 3.10195219e-02
 3.10195219e-02 1.18981078e-01 3.10195219e-02 3.10194772e-02
 3.10195219e-02 3.10195219e-02]
2025-06-02 15:45:24,320 - DEBUG - Edge reconstruction errors: [ 5.2649856  5.262358  44.258606  ... 13.358591   2.1595414 13.358591 ]
2025-06-02 15:45:24,323 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154524_update_42.json
2025-06-02 15:45:24,324 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:45:24,338 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154524_update_42.pth and as latest_checkpoint.pth
2025-06-02 15:45:24,338 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.5977
2025-06-02 15:45:24,338 - WARNING - Detected 24 anomalous nodes (reconstruction-based):
2025-06-02 15:45:24,339 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.1055, MLP Score: 0.5431
2025-06-02 15:45:24,339 - WARNING -   Node ID: 192.168.27.13, Recon Error: 3.0257, MLP Score: 0.4971
2025-06-02 15:45:24,340 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.3028, MLP Score: 0.4963
2025-06-02 15:45:24,340 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.9864, MLP Score: 0.4938
2025-06-02 15:45:24,340 - WARNING -   Node ID: 43.132.85.151, Recon Error: 1.2149, MLP Score: 0.4871
2025-06-02 15:45:24,340 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:45:24,341 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2586, MLP Score: 0.2114
2025-06-02 15:45:24,341 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9613, MLP Score: 0.0325
2025-06-02 15:45:24,341 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0609, MLP Score: 0.0325
2025-06-02 15:45:24,341 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7596, MLP Score: 0.0302
2025-06-02 15:45:24,341 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7589, MLP Score: 0.0191
2025-06-02 15:45:24,341 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-02 15:45:24,341 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:45:24,341 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:45:24,341 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 15:45:24,372 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:45:24,404 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 15:45:24,404 - INFO - Processing node updates/additions.
2025-06-02 15:45:24,411 - INFO - Processing edge updates/additions.
2025-06-02 15:45:24,427 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:45:24,428 - INFO - Finished updating NetworkX graph.
2025-06-02 15:45:24,429 - DEBUG - Updated graph - Nodes: 944, Edges: 2034
2025-06-02 15:45:24,429 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:45:24,430 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:45:24,444 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-02 15:45:24,446 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:45:24,446 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-02 15:45:24,448 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-02 15:45:24,449 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:45:24,455 - DEBUG - Initial edge attributes tensor shape: torch.Size([2034, 10])
2025-06-02 15:45:24,456 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:45:24,456 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2034, 10])
2025-06-02 15:45:24,457 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:45:24,457 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:45:24,458 - INFO - Updated main graph to 944 nodes and 2034 edges.
2025-06-02 15:45:24,458 - INFO - Performing online update...
2025-06-02 15:45:24,458 - INFO - Starting online update for 25 steps.
2025-06-02 15:45:24,459 - DEBUG - Updated RunningStats: new_mean=0.9445968346702539, new_var=24600000000161.99, new_n=2490
2025-06-02 15:45:24,459 - DEBUG - Updated RunningStats: new_mean=0.9421383733471721, new_var=24900000000017.93, new_n=2520
2025-06-02 15:45:24,459 - DEBUG - Updated RunningStats: new_mean=44.71039878558435, new_var=8200000187836.212, new_n=830
2025-06-02 15:45:24,460 - DEBUG - Updated RunningStats: new_mean=44.72511970001074, new_var=8300000183638.025, new_n=840
2025-06-02 15:45:24,460 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:45:24,460 - DEBUG - Online update step: 1/25
2025-06-02 15:45:24,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:24,631 - DEBUG - Node anomaly scores shape: torch.Size([16878, 1])
2025-06-02 15:45:24,643 - DEBUG - Edge anomaly scores shape: torch.Size([34904, 1])
2025-06-02 15:45:24,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:24,929 - DEBUG - Step 1: Loss=0.6962
2025-06-02 15:45:24,929 - DEBUG - Online update step: 2/25
2025-06-02 15:45:24,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:25,031 - DEBUG - Node anomaly scores shape: torch.Size([16824, 1])
2025-06-02 15:45:25,035 - DEBUG - Edge anomaly scores shape: torch.Size([34971, 1])
2025-06-02 15:45:25,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:25,236 - DEBUG - Step 2: Loss=0.7362
2025-06-02 15:45:25,237 - DEBUG - Online update step: 3/25
2025-06-02 15:45:25,240 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:25,342 - DEBUG - Node anomaly scores shape: torch.Size([16601, 1])
2025-06-02 15:45:25,349 - DEBUG - Edge anomaly scores shape: torch.Size([34364, 1])
2025-06-02 15:45:25,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:25,590 - DEBUG - Step 3: Loss=0.7539
2025-06-02 15:45:25,590 - DEBUG - Online update step: 4/25
2025-06-02 15:45:25,597 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:25,706 - DEBUG - Node anomaly scores shape: torch.Size([17551, 1])
2025-06-02 15:45:25,713 - DEBUG - Edge anomaly scores shape: torch.Size([36446, 1])
2025-06-02 15:45:25,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:25,913 - DEBUG - Step 4: Loss=0.7176
2025-06-02 15:45:25,913 - DEBUG - Online update step: 5/25
2025-06-02 15:45:25,916 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:26,014 - DEBUG - Node anomaly scores shape: torch.Size([16959, 1])
2025-06-02 15:45:26,018 - DEBUG - Edge anomaly scores shape: torch.Size([35202, 1])
2025-06-02 15:45:26,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:26,201 - DEBUG - Step 5: Loss=0.7132
2025-06-02 15:45:26,202 - DEBUG - Online update step: 6/25
2025-06-02 15:45:26,205 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:26,332 - DEBUG - Node anomaly scores shape: torch.Size([19617, 1])
2025-06-02 15:45:26,340 - DEBUG - Edge anomaly scores shape: torch.Size([40853, 1])
2025-06-02 15:45:26,341 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:26,617 - DEBUG - Step 6: Loss=0.7344
2025-06-02 15:45:26,618 - DEBUG - Online update step: 7/25
2025-06-02 15:45:26,621 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:26,759 - DEBUG - Node anomaly scores shape: torch.Size([17846, 1])
2025-06-02 15:45:26,765 - DEBUG - Edge anomaly scores shape: torch.Size([37021, 1])
2025-06-02 15:45:26,768 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:27,047 - DEBUG - Step 7: Loss=0.7016
2025-06-02 15:45:27,047 - DEBUG - Online update step: 8/25
2025-06-02 15:45:27,050 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:27,161 - DEBUG - Node anomaly scores shape: torch.Size([18207, 1])
2025-06-02 15:45:27,165 - DEBUG - Edge anomaly scores shape: torch.Size([37924, 1])
2025-06-02 15:45:27,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:27,403 - DEBUG - Step 8: Loss=0.7221
2025-06-02 15:45:27,403 - DEBUG - Online update step: 9/25
2025-06-02 15:45:27,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:27,494 - DEBUG - Node anomaly scores shape: torch.Size([16721, 1])
2025-06-02 15:45:27,498 - DEBUG - Edge anomaly scores shape: torch.Size([34591, 1])
2025-06-02 15:45:27,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:27,688 - DEBUG - Step 9: Loss=0.7427
2025-06-02 15:45:27,688 - DEBUG - Online update step: 10/25
2025-06-02 15:45:27,692 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:27,805 - DEBUG - Node anomaly scores shape: torch.Size([16981, 1])
2025-06-02 15:45:27,809 - DEBUG - Edge anomaly scores shape: torch.Size([35237, 1])
2025-06-02 15:45:27,810 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:27,998 - DEBUG - Step 10: Loss=0.7088
2025-06-02 15:45:27,999 - DEBUG - Online update step: 11/25
2025-06-02 15:45:28,002 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:28,082 - DEBUG - Node anomaly scores shape: torch.Size([17172, 1])
2025-06-02 15:45:28,086 - DEBUG - Edge anomaly scores shape: torch.Size([35608, 1])
2025-06-02 15:45:28,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:28,256 - DEBUG - Step 11: Loss=0.7126
2025-06-02 15:45:28,256 - DEBUG - Online update step: 12/25
2025-06-02 15:45:28,261 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:28,502 - DEBUG - Node anomaly scores shape: torch.Size([16966, 1])
2025-06-02 15:45:28,531 - DEBUG - Edge anomaly scores shape: torch.Size([35181, 1])
2025-06-02 15:45:28,550 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:28,821 - DEBUG - Step 12: Loss=0.7331
2025-06-02 15:45:28,822 - DEBUG - Online update step: 13/25
2025-06-02 15:45:28,825 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:28,925 - DEBUG - Node anomaly scores shape: torch.Size([18545, 1])
2025-06-02 15:45:28,931 - DEBUG - Edge anomaly scores shape: torch.Size([38640, 1])
2025-06-02 15:45:28,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:29,134 - DEBUG - Step 13: Loss=0.6992
2025-06-02 15:45:29,134 - DEBUG - Online update step: 14/25
2025-06-02 15:45:29,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:29,257 - DEBUG - Node anomaly scores shape: torch.Size([18205, 1])
2025-06-02 15:45:29,262 - DEBUG - Edge anomaly scores shape: torch.Size([38025, 1])
2025-06-02 15:45:29,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:29,502 - DEBUG - Step 14: Loss=0.7146
2025-06-02 15:45:29,503 - DEBUG - Online update step: 15/25
2025-06-02 15:45:29,508 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:29,602 - DEBUG - Node anomaly scores shape: torch.Size([19041, 1])
2025-06-02 15:45:29,606 - DEBUG - Edge anomaly scores shape: torch.Size([39791, 1])
2025-06-02 15:45:29,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:30,093 - DEBUG - Step 15: Loss=0.7356
2025-06-02 15:45:30,093 - DEBUG - Online update step: 16/25
2025-06-02 15:45:30,097 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:30,630 - DEBUG - Node anomaly scores shape: torch.Size([16758, 1])
2025-06-02 15:45:30,641 - DEBUG - Edge anomaly scores shape: torch.Size([34707, 1])
2025-06-02 15:45:30,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:31,485 - DEBUG - Step 16: Loss=0.7036
2025-06-02 15:45:31,485 - DEBUG - Online update step: 17/25
2025-06-02 15:45:31,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:31,610 - DEBUG - Node anomaly scores shape: torch.Size([17438, 1])
2025-06-02 15:45:31,614 - DEBUG - Edge anomaly scores shape: torch.Size([36323, 1])
2025-06-02 15:45:31,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:32,057 - DEBUG - Step 17: Loss=0.7082
2025-06-02 15:45:32,057 - DEBUG - Online update step: 18/25
2025-06-02 15:45:32,063 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:32,170 - DEBUG - Node anomaly scores shape: torch.Size([17270, 1])
2025-06-02 15:45:32,174 - DEBUG - Edge anomaly scores shape: torch.Size([35680, 1])
2025-06-02 15:45:32,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:32,362 - DEBUG - Step 18: Loss=0.7276
2025-06-02 15:45:32,362 - DEBUG - Online update step: 19/25
2025-06-02 15:45:32,368 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:32,463 - DEBUG - Node anomaly scores shape: torch.Size([18177, 1])
2025-06-02 15:45:32,468 - DEBUG - Edge anomaly scores shape: torch.Size([37892, 1])
2025-06-02 15:45:32,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:32,672 - DEBUG - Step 19: Loss=0.6939
2025-06-02 15:45:32,672 - DEBUG - Online update step: 20/25
2025-06-02 15:45:32,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:32,781 - DEBUG - Node anomaly scores shape: torch.Size([18706, 1])
2025-06-02 15:45:32,787 - DEBUG - Edge anomaly scores shape: torch.Size([39094, 1])
2025-06-02 15:45:32,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:33,132 - DEBUG - Step 20: Loss=0.7126
2025-06-02 15:45:33,133 - DEBUG - Online update step: 21/25
2025-06-02 15:45:33,139 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:33,261 - DEBUG - Node anomaly scores shape: torch.Size([18060, 1])
2025-06-02 15:45:33,266 - DEBUG - Edge anomaly scores shape: torch.Size([37529, 1])
2025-06-02 15:45:33,267 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:33,711 - DEBUG - Step 21: Loss=0.7340
2025-06-02 15:45:33,712 - DEBUG - Online update step: 22/25
2025-06-02 15:45:33,720 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:33,979 - DEBUG - Node anomaly scores shape: torch.Size([18647, 1])
2025-06-02 15:45:33,994 - DEBUG - Edge anomaly scores shape: torch.Size([38856, 1])
2025-06-02 15:45:33,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:34,384 - DEBUG - Step 22: Loss=0.7007
2025-06-02 15:45:34,385 - DEBUG - Online update step: 23/25
2025-06-02 15:45:34,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:34,482 - DEBUG - Node anomaly scores shape: torch.Size([18515, 1])
2025-06-02 15:45:34,486 - DEBUG - Edge anomaly scores shape: torch.Size([38576, 1])
2025-06-02 15:45:34,488 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:34,692 - DEBUG - Step 23: Loss=0.7000
2025-06-02 15:45:34,693 - DEBUG - Online update step: 24/25
2025-06-02 15:45:34,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:34,789 - DEBUG - Node anomaly scores shape: torch.Size([16330, 1])
2025-06-02 15:45:34,794 - DEBUG - Edge anomaly scores shape: torch.Size([33541, 1])
2025-06-02 15:45:34,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:34,991 - DEBUG - Step 24: Loss=0.7205
2025-06-02 15:45:34,992 - DEBUG - Online update step: 25/25
2025-06-02 15:45:34,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:35,092 - DEBUG - Node anomaly scores shape: torch.Size([17535, 1])
2025-06-02 15:45:35,096 - DEBUG - Edge anomaly scores shape: torch.Size([36390, 1])
2025-06-02 15:45:35,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:35,303 - DEBUG - Step 25: Loss=0.6864
2025-06-02 15:45:35,304 - INFO - Online update finished. Average loss: 0.7164, Learning rate: 0.001000
2025-06-02 15:45:35,306 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], current edge mean: [-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:45:35,306 - DEBUG - Node drift difference: 0.0128, Edge drift difference: 0.0012
2025-06-02 15:45:35,308 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], edge=[-3.7509316e-09  4.5683286e+02  0.0000000e+00  0.0000000e+00
  1.8754658e-09 -9.3773289e-10 -4.6886641e-09 -4.6886641e-09
  0.0000000e+00  2.8131986e-09]
2025-06-02 15:45:35,309 - DEBUG - Updated reference std: node=[0.         0.         1.0005301  1.0005301  0.         0.
 0.         1.0005301  1.0005301  1.0005301  1.0005301  1.0005301
 1.0107334  0.27367172 0.36063462 0.5744843  1.0005301  2.9573143
 2.8775678  1.49335    0.36063462 0.22783059 1.0005301  1.0005301
 0.         0.         0.         0.         1.00053    1.00053   ], edge=[  1.0002459 452.46783     0.          0.          1.0002459   1.0002459
   1.0002459   1.0002459   1.0002459   1.0002459]
2025-06-02 15:45:35,316 - INFO - Online update complete. Loss: 0.7164
2025-06-02 15:45:35,316 - INFO - Running anomaly detection...
2025-06-02 15:45:35,317 - INFO - Starting anomaly detection.
2025-06-02 15:45:35,334 - DEBUG - Node reconstruction errors: [4.43453938e-01 1.00085855e+00 2.81252313e+00 3.33110318e-02
 2.26066932e-01 8.67719799e-02 2.06097722e+00 4.59890217e-02
 4.59888205e-02 1.20696239e-01 4.59890217e-02 6.89034015e-02
 4.55591726e+00 7.37473190e-01 2.37099007e-02 8.95565301e-02
 2.05127165e-01 8.95565972e-02 9.78897214e-01 8.67127553e-02
 5.54974414e-02 2.37099007e-02 2.74030596e-01 1.78112477e-01
 2.52805073e-02 6.58061355e-02 2.52805911e-02 3.28889370e-01
 4.67101932e-02 2.52805911e-02 1.04704499e+00 2.51354754e-01
 2.72351623e-01 3.34575921e-02 2.43416950e-01 1.39675781e-01
 1.31385356e-01 8.67127553e-02 3.98954570e-01 4.94558811e-01
 8.60650241e-02 2.10241247e-02 8.67127553e-02 1.57445818e-01
 5.24348021e-01 1.32776305e-01 1.84269235e-01 6.89562559e-01
 4.83636037e-02 6.93062127e-01 9.03049648e-01 7.65323788e-02
 6.72790855e-02 9.41993356e-01 5.28865829e-02 2.26999521e-01
 1.26181281e+00 8.19651410e-02 9.96487796e-01 9.46546793e-01
 3.44574779e-01 1.67162523e-01 1.87853146e-02 1.89860538e-01
 2.10308895e-01 5.28864339e-02 1.89761575e-02 5.28869554e-02
 1.87853537e-02 2.31209695e-01 8.78976062e-02 6.27109483e-02
 1.65083427e-02 1.51396438e-01 1.67749271e-01 6.33156523e-02
 2.97574043e-01 2.14120001e-01 6.51306510e-02 8.81553367e-02
 3.14442255e-02 6.06622063e-02 9.96028900e-01 4.89860803e-01
 7.31994286e-02 8.98085013e-02 8.03681239e-02 1.23059757e-01
 7.38557950e-02 2.29678378e-01 1.79941542e-02 2.25718245e-01
 7.14820698e-02 1.01376899e-01 8.52732882e-02 8.89922023e-01
 3.03172469e-02 6.87442645e-02 1.50140245e-02 1.76675364e-01
 4.66956384e-02 3.03171892e-02 8.90947059e-02 3.42026383e-01
 1.90138042e-01 5.34547977e-02 1.85186148e-01 9.95595381e-02
 7.51847252e-02 5.17001271e-01 3.46170425e-01 3.67022231e-02
 2.12661549e-01 2.85258204e-01 4.29400019e-02 4.22842391e-02
 4.13237028e-02 2.61884242e-01 8.78744572e-02 2.23469734e-02
 1.77117027e-02 4.73569259e-02 2.39943817e-01 1.62373140e-01
 7.40490034e-02 2.23460495e-02 1.88417867e-01 1.46056399e-01
 9.44445506e-02 4.12948504e-02 8.01525936e-02 1.54334819e-02
 7.33327627e-01 4.00279790e-01 3.86092104e-02 5.02226427e-02
 1.08148031e-01 1.49898343e-02 2.89988518e-01 2.89116174e-01
 1.08832531e-01 7.06033036e-02 2.01581791e-02 6.71308711e-02
 1.08832337e-01 1.34036481e-01 4.13236991e-02 2.27395386e-01
 1.03959724e-01 1.06402166e-01 6.45081162e-01 1.85124338e-01
 8.48308727e-02 1.54334782e-02 1.89636543e-01 2.34496623e-01
 1.52179282e-02 6.54355511e-02 4.66957465e-02 8.27146471e-02
 1.08832337e-01 1.08215846e-01 1.52179757e-02 8.01526606e-02
 4.16941978e-02 1.85136870e-01 3.91819254e-02 6.71057999e-02
 1.08016774e-01 1.06402166e-01 9.34948102e-02 2.51914822e-02
 1.70269404e-02 7.41998017e-01 8.78748521e-02 7.25078821e+00
 6.53106198e-02 7.70690590e-02 4.20650169e-02 4.20652479e-02
 5.65823726e-02 1.08414657e-01 8.18810835e-02 2.93384731e-01
 2.15913698e-01 5.11562154e-02 1.77366138e-02 5.53414263e-02
 5.31720519e-02 1.65198799e-02 1.96524009e-01 8.80270004e-02
 1.46623179e-01 1.87392514e-02 2.89988577e-01 7.12585822e-02
 1.08694291e+00 1.28357545e-01 2.83489764e-01 1.27677083e-01
 3.03064957e-02 1.52179757e-02 1.98779374e-01 1.09555639e-01
 9.03921500e-02 9.58110839e-02 1.36760011e-01 3.42428297e-01
 1.64065547e-02 7.65029117e-02 3.81275006e-02 1.32919118e-01
 7.55853131e-02 6.25000820e-02 4.60128002e-02 2.28126030e-02
 8.21374804e-02 4.13237214e-02 1.25103191e-01 1.87392309e-02
 2.72390902e-01 1.77366138e-02 1.58720613e-02 7.55851567e-02
 1.52179757e-02 8.32466632e-02 2.49440730e-01 2.25793216e-02
 8.84198844e-02 7.04388618e-02 1.52502671e-01 5.73924221e-02
 1.09425217e-01 4.13236953e-02 4.13237251e-02 5.36826178e-02
 6.34795800e-02 1.58720277e-02 1.52179282e-02 1.68831021e-01
 2.24604443e-01 1.26249388e-01 2.34215576e-02 7.99942166e-02
 2.47353259e-02 9.15301666e-02 5.16837500e-02 8.67125690e-02
 2.34215558e-02 3.70434113e-02 1.70269404e-02 1.70688648e-02
 1.25103191e-01 5.58817200e-02 1.09048516e-01 6.30615652e-02
 1.65198799e-02 1.66926645e-02 1.04178362e-01 4.20654267e-02
 6.25100434e-02 1.26575276e-01 2.06877552e-02 8.78299102e-02
 7.18865916e-02 1.14189498e-01 8.32715482e-02 1.08966553e+00
 8.32715482e-02 4.61492501e-02 3.25149894e-01 2.57976085e-01
 6.99854046e-02 2.20239565e-01 3.30598094e-02 2.03784451e-01
 2.52299998e-02 2.02930450e-01 5.65823726e-02 5.85224219e-02
 2.93700993e-01 2.55935173e-02 6.73647150e-02 8.94395635e-02
 1.02425478e-01 3.53389829e-02 4.12616402e-01 7.34957680e-02
 1.08414724e-01 5.46449900e-01 1.16176359e-01 3.84529196e-02
 4.06684726e-02 2.47353259e-02 8.40582311e-01 2.55022999e-02
 5.54367900e-02 4.20650244e-02 7.12585300e-02 7.00921416e-01
 6.63590357e-02 1.21266373e-01 2.91278679e-02 6.26875684e-02
 1.24896569e-02 1.24896681e-02 1.24896681e-02 3.40979807e-02
 9.03336480e-02 1.21266373e-01 1.24896569e-02 1.94878787e-01
 1.24896569e-02 1.80093925e-02 1.02228388e-01 8.05989578e-02
 2.86274910e-01 7.86400512e-02 7.85529315e-02 7.23941773e-02
 9.89118069e-02 3.37534472e-02 8.82861167e-02 2.91278176e-02
 1.00803800e-01 2.74436921e-01 3.72026950e-01 8.17975998e-02
 8.13363269e-02 8.13363865e-02 2.20718130e-01 7.33989179e-02
 1.24896569e-02 3.30597311e-02 1.24896681e-02 3.40980701e-02
 5.91758229e-02 1.63126532e-02 1.44744128e-01 1.32283783e-02
 1.21266238e-01 3.53923477e-02 1.32283783e-02 1.15136415e-01
 5.77739254e-02 8.21286216e-02 2.91276705e-02 3.71255539e-02
 8.99020657e-02 7.78799504e-02 1.24896569e-02 4.98550087e-02
 2.13283479e-01 1.00684062e-01 3.25885564e-02 1.65198594e-02
 1.21266238e-01 1.24896681e-02 1.35481404e-02 4.07468885e-01
 1.01851247e-01 1.93591695e-02 2.25029275e-01 6.34271204e-02
 2.91277003e-02 9.24038827e-01 1.37750003e-02 2.15603068e-01
 3.92789319e-02 3.53400670e-02 5.91539852e-02 5.76729141e-02
 7.77126327e-02 1.90320432e-01 8.24299678e-02 1.00688301e-01
 1.47701818e-02 2.62228604e-02 2.10958958e-01 1.24896569e-02
 2.91278102e-02 9.76479352e-02 1.71705838e-02 6.52495548e-02
 9.31986496e-02 4.77403402e-02 9.14930999e-02 2.01055914e-01
 5.94546907e-02 1.24896569e-02 2.79766202e-01 6.70004338e-02
 3.80403884e-02 2.33002931e-01 5.95770217e-02 5.95768839e-02
 5.95769100e-02 1.02290785e+00 1.14407474e-02 1.02385283e+00
 1.97211578e-02 1.46607891e-01 1.11697540e-01 1.14408080e-02
 3.89624089e-02 3.80404070e-02 9.17378888e-02 2.04411838e-02
 3.80404629e-02 9.86841470e-02 5.95768839e-02 3.80404554e-02
 1.14407474e-02 5.95770292e-02 5.95768765e-02 2.75515094e-02
 3.46618183e-02 5.95770366e-02 1.47616267e-02 4.77975942e-02
 5.18555529e-02 2.14975160e-02 3.56395096e-02 1.88534427e-02
 2.20170721e-01 6.17932305e-02 2.96905842e-02 6.75405785e-02
 1.23942025e-01 3.44813094e-02 8.65719169e-02 6.34444654e-02
 6.54844716e-02 6.38127401e-02 2.55152255e-01 5.95768690e-02
 1.97211578e-02 7.30356798e-02 2.25928947e-01 6.98828325e-02
 3.56435217e-02 3.07974461e-02 1.83532730e-01 1.11341039e-02
 5.42177483e-02 1.93694249e-01 2.74422824e-01 1.96076389e-02
 8.01864937e-02 2.24399082e-02 6.01292513e-02 1.26924133e-02
 2.58956756e-02 8.09766203e-02 1.26924133e-02 6.32631108e-02
 1.88534427e-02 4.39009927e-02 4.43537682e-02 7.80180693e-02
 3.81892659e-02 2.38462724e-02 1.83459744e-02 7.67464563e-02
 1.83459111e-02 2.38462724e-02 1.43156946e-02 5.44554964e-02
 1.01580881e-01 7.73884952e-02 1.43156946e-02 3.81893255e-02
 4.44077849e-02 3.36506337e-01 5.80628254e-02 3.56377624e-02
 5.44554479e-02 3.81891876e-02 1.08176796e-02 3.07211000e-02
 3.45946439e-02 3.39249164e-01 3.87372784e-02 1.96076389e-02
 2.17171475e-01 1.65296588e-02 1.26924133e-02 1.17985956e-01
 2.46011075e-02 3.31812024e-01 4.16697264e-02 1.08176796e-02
 5.93294241e-02 1.20696258e-02 7.33227581e-02 2.06694324e-02
 3.80009823e-02 1.04534483e+00 1.03071919e-02 3.07211000e-02
 2.14098319e-01 1.20696826e-02 1.96641952e-01 2.35876013e-02
 1.33920172e-02 7.65227154e-02 9.00172070e-03 5.47737300e-01
 2.57714428e-02 1.26924133e-02 3.10323313e-02 2.66041830e-02
 2.66041830e-02 1.33337937e-02 7.86836073e-02 2.81145703e-02
 9.00172070e-03 2.66605206e-02 9.26270708e-02 6.99890777e-02
 9.81462821e-02 3.07975076e-02 9.00172070e-03 1.22674003e-01
 1.33920172e-02 3.80009003e-02 9.13195387e-02 2.15516880e-01
 9.81462002e-02 7.95422047e-02 2.81145629e-02 8.53012726e-02
 1.03071919e-02 3.07211000e-02 3.80009972e-02 3.76408361e-02
 7.44587556e-02 7.04731867e-02 1.03071919e-02 6.41198009e-02
 1.03071919e-02 9.18634236e-02 8.01044032e-02 2.66604256e-02
 2.20464505e-02 5.27800679e-01 1.03986196e-01 9.44997557e-03
 8.01561654e-01 9.44997557e-03 9.44993086e-03 9.44997557e-03
 9.44997557e-03 9.44997557e-03 9.44997557e-03 9.44997557e-03
 3.00369374e-02 2.35160682e-02 2.69961003e-02 9.44997557e-03
 9.44997557e-03 9.44997557e-03 9.44997557e-03 9.44997557e-03
 9.44997557e-03 9.44997557e-03 9.44993086e-03 9.44997557e-03
 2.67649777e-02 9.44993086e-03 9.44997557e-03 2.37819582e-01
 9.44997557e-03 1.22482859e-01 7.26238564e-02 1.03071919e-02
 4.97299805e-02 7.99994245e-02 5.20289302e-01 5.20289302e-01
 8.17346722e-02 4.97299805e-02 1.03071919e-02 9.00172070e-03
 9.00172070e-03 1.03071919e-02 9.00172070e-03 4.93443608e-02
 2.38486137e-02 9.44997557e-03 3.07974461e-02 1.03071919e-02
 2.66041830e-02 1.03071919e-02 1.03071919e-02 5.88814206e-02
 1.03071891e-02 9.00172070e-03 1.03071919e-02 1.03071919e-02
 2.66605895e-02 9.00175143e-03 1.03071919e-02 9.00172070e-03
 1.03071919e-02 1.03071919e-02 1.03071919e-02 7.86541775e-02
 6.48159012e-02 3.56647559e-02 9.44997557e-03 6.77631050e-02
 8.83331746e-02 1.03071891e-02 9.00172070e-03 6.58116117e-02
 9.44997557e-03 3.41013707e-02 5.47073931e-02 9.05494764e-03
 1.03071919e-02 1.03071919e-02 4.64222990e-02 8.73331055e-02
 3.82663608e-02 1.03071919e-02 3.00370380e-02 1.31445033e-02
 9.00172070e-03 1.89305693e-01 9.44997557e-03 4.83227335e-02
 7.10137710e-02 9.44997557e-03 9.44997557e-03 3.00368927e-02
 1.31445033e-02 1.03071919e-02 2.95109600e-01 1.26202613e-01
 6.35845363e-02 8.73329788e-02 2.47658622e-02 6.17898554e-02
 6.17898554e-02 7.05711916e-02 1.47767821e-02 9.44997557e-03
 2.90322918e-02 7.08904564e-02 8.73331055e-02 3.53691205e-02
 1.94814634e-02 2.29666270e-02 8.75180773e-03 8.75179097e-03
 8.75180773e-03 8.75179097e-03 8.75180773e-03 2.79595200e-02
 7.61473477e-02 8.75179097e-03 8.75180773e-03 9.44997557e-03
 1.11079775e-02 9.44997557e-03 6.17900379e-02 7.96979368e-02
 1.01897463e-01 3.23367529e-02 8.64477232e-02 7.92651400e-02
 2.67650615e-02 2.24722847e-02 2.67650653e-02 9.44997557e-03
 6.17900379e-02 1.24377953e-02 7.87770282e-03 7.87770282e-03
 8.75179097e-03 1.24377953e-02 6.24416508e-02 3.26793715e-02
 2.62576528e-02 9.44993086e-03 8.75179097e-03 2.97817420e-02
 7.87770282e-03 8.67718458e-03 1.07687674e-02 2.89368052e-02
 2.79594567e-02 3.22443962e-01 8.26532673e-03 2.34492645e-01
 3.60384509e-02 1.07687674e-02 2.40822267e-02 1.17137553e-02
 1.01874433e-02 8.37683678e-03 6.68335855e-02 2.13527493e-02
 6.38438612e-02 1.07687674e-02 1.07687730e-02 1.07687674e-02
 8.48241802e-03 2.97817420e-02 1.07687674e-02 1.01874433e-02
 1.07687674e-02 1.07687730e-02 1.07687674e-02 3.82047147e-02
 1.12304008e-02 5.27281053e-02 7.22160339e-02 6.83593303e-02
 2.69734673e-02 3.49813215e-02 5.81895523e-02 1.07810867e+00
 9.86412819e-03 1.09907947e-02 7.19470670e-03 8.83727521e-02
 8.83728638e-02 1.01874433e-02 2.45385885e-01 1.68416992e-01
 9.85302497e-03 7.91943911e-03 4.31512259e-02 2.47384608e-01
 1.10745095e-02 1.10745095e-02 1.10745095e-02 7.91312009e-03
 6.88828388e-03 1.12920441e-01 1.76097482e-01 2.53875345e-01
 4.17701565e-02 5.84586104e-03 3.61284427e-02 7.91943911e-03
 2.99442299e-02 3.75073701e-02 7.15641258e-03 1.06908306e-01
 9.85302497e-03 1.68416947e-01 7.91943911e-03 3.75074074e-02
 5.84589178e-03 1.71262041e-01 1.10745095e-02 7.91312009e-03
 7.15641258e-03 4.12722379e-02 9.35958549e-02 7.91312009e-03
 7.91312009e-03 7.91312009e-03 1.59896284e-01 1.59760416e+00
 2.24817562e+00 1.10745095e-02 1.66933775e-01 7.91312009e-03
 7.30796829e-02 4.07697037e-02 1.17101216e+00 4.80074286e-02
 7.91312009e-03 8.19405541e-03 3.75310704e-02 9.80741251e-03
 5.51296830e-01 4.80074286e-02 5.68176866e-01 5.15225977e-02
 9.05716792e-02 4.80073802e-02 7.79634267e-02 9.95361954e-02
 3.72355580e-02 1.03955001e-01 3.91362272e-02 1.01338075e-02
 1.01337675e-02 2.97417074e-01 3.76571149e-01 2.40879014e-01
 4.80073765e-02 3.72356400e-02 4.80073765e-02 5.09845512e-03
 1.07530691e-02 1.07530691e-02 6.95774937e-03 1.03944011e-01
 4.62133344e-03 1.07530691e-02 5.09842765e-03 1.17279053e-01
 1.07530691e-02 1.07530691e-02 8.71199369e-03 1.24473356e-01
 1.01691008e-01 8.31967220e-02 1.07530691e-02 4.56197038e-02
 1.17278986e-01 1.07530691e-02 1.14496825e-02 4.06281799e-02
 4.21893829e-03 4.21894155e-03 1.99179649e-01 4.06281799e-02
 1.07530691e-02 4.06281799e-02 3.85510139e-02 9.50089172e-02
 1.91484958e-01 1.07530691e-02 2.98334271e-01 3.88450399e-02
 3.88450250e-02 1.24473356e-01 9.42477863e-03 4.87255603e-02
 1.14496825e-02 5.44772819e-02 7.68644130e-03 1.13470823e-01
 5.98123893e-02 1.13470823e-01 3.05350631e-01 5.21400245e-03
 5.98123893e-02 1.03500430e-02 1.03500430e-02 1.28875566e+00
 1.03501361e-02 9.72807109e-02 9.42480378e-03 1.10742539e-01
 5.21076359e-02 5.21399500e-03 5.21076359e-02 2.13161156e-01
 8.95076245e-02 1.40852615e-01 1.03500430e-02 5.11311851e-02
 1.22130923e-01 1.03501361e-02 9.72650498e-02 6.38873428e-02
 5.11312746e-02 5.21399500e-03 1.03500430e-02 3.12425792e-01
 1.03500430e-02 1.03500430e-02 1.03501361e-02 1.21961543e-02
 5.95321581e-02 1.21961543e-02 5.30325100e-02 1.21960957e-02
 5.37321083e-02 7.77843520e-02 1.12587854e-01 1.03500430e-02
 1.03500430e-02 3.22946114e-03 1.03501361e-02 7.69653261e-01
 5.30325435e-02 1.21961543e-02 3.22944392e-03 1.03501361e-02
 1.03501361e-02 2.72400584e-02 3.22946114e-03 1.03500430e-02
 6.74201548e-03 6.25190288e-02 8.07533413e-03 5.87953687e-01
 6.74208859e-03 1.03501361e-02 1.03501361e-02 2.44639032e-02
 8.99772123e-02 8.90727863e-02 8.90729427e-02 1.15647512e-02
 1.23842582e-01 1.48164839e-01 6.42809942e-02 3.75366390e-01
 8.90727863e-02 1.27361100e-02 8.90729427e-02 5.58618158e-02
 6.42809942e-02 8.90728012e-02 1.44154234e-02 8.07530247e-03
 7.88162574e-02 5.77727240e-03 1.44084254e-02 1.15528768e-02
 1.58001140e-01 1.62608847e-02 2.04463080e-02 2.04463080e-02
 7.55699500e-02 2.04463080e-02 2.04463080e-02 2.04463080e-02
 2.04463080e-02 9.87528339e-02 2.04463080e-02 2.04463080e-02
 2.04463080e-02 2.04463080e-02 2.04463080e-02 2.04463080e-02
 2.04463080e-02 2.04463080e-02 2.04463080e-02 8.39713290e-02
 2.04463080e-02 2.04463080e-02 2.04463080e-02 2.04463080e-02]
2025-06-02 15:45:35,334 - DEBUG - Edge reconstruction errors: [ 5.2648196  5.262198  44.258453  ... 13.358432   2.1593845 13.358432 ]
2025-06-02 15:45:35,338 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154535_update_43.json
2025-06-02 15:45:35,338 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:45:35,356 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154535_update_43.pth and as latest_checkpoint.pth
2025-06-02 15:45:35,356 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.6150
2025-06-02 15:45:35,356 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-02 15:45:35,356 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.8125, MLP Score: 0.4986
2025-06-02 15:45:35,356 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.0610, MLP Score: 0.4981
2025-06-02 15:45:35,357 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.5559, MLP Score: 0.4957
2025-06-02 15:45:35,357 - WARNING -   Node ID: 199.232.214.172, Recon Error: 1.0470, MLP Score: 0.4514
2025-06-02 15:45:35,357 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.2618, MLP Score: 0.4983
2025-06-02 15:45:35,357 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:45:35,357 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2584, MLP Score: 0.9649
2025-06-02 15:45:35,357 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9611, MLP Score: 0.9240
2025-06-02 15:45:35,358 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0607, MLP Score: 0.9240
2025-06-02 15:45:35,358 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7593, MLP Score: 0.8288
2025-06-02 15:45:35,358 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7588, MLP Score: 0.7711
2025-06-02 15:45:35,358 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-02 15:45:35,358 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:45:35,358 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:45:35,359 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 15:45:35,382 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:45:35,406 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 15:45:35,406 - INFO - Processing node updates/additions.
2025-06-02 15:45:35,411 - INFO - Processing edge updates/additions.
2025-06-02 15:45:35,423 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:45:35,423 - INFO - Finished updating NetworkX graph.
2025-06-02 15:45:35,424 - DEBUG - Updated graph - Nodes: 957, Edges: 2059
2025-06-02 15:45:35,424 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:45:35,425 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:45:35,433 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-02 15:45:35,435 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:45:35,435 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-02 15:45:35,436 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-02 15:45:35,437 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:45:35,442 - DEBUG - Initial edge attributes tensor shape: torch.Size([2059, 10])
2025-06-02 15:45:35,443 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:45:35,443 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2059, 10])
2025-06-02 15:45:35,443 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:45:35,444 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:45:35,444 - INFO - Updated main graph to 957 nodes and 2059 edges.
2025-06-02 15:45:35,444 - INFO - Performing online update...
2025-06-02 15:45:35,445 - INFO - Starting online update for 25 steps.
2025-06-02 15:45:35,445 - DEBUG - Updated RunningStats: new_mean=0.944677028690125, new_var=25200000000162.082, new_n=2550
2025-06-02 15:45:35,445 - DEBUG - Updated RunningStats: new_mean=0.9422583820159048, new_var=25500000000017.926, new_n=2580
2025-06-02 15:45:35,445 - DEBUG - Updated RunningStats: new_mean=44.73619462878942, new_var=8400000187697.295, new_n=850
2025-06-02 15:45:35,445 - DEBUG - Updated RunningStats: new_mean=44.74707082630964, new_var=8500000181399.229, new_n=860
2025-06-02 15:45:35,446 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:45:35,446 - DEBUG - Online update step: 1/25
2025-06-02 15:45:35,448 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:35,561 - DEBUG - Node anomaly scores shape: torch.Size([18129, 1])
2025-06-02 15:45:35,594 - DEBUG - Edge anomaly scores shape: torch.Size([37529, 1])
2025-06-02 15:45:35,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:35,843 - DEBUG - Step 1: Loss=0.7114
2025-06-02 15:45:35,843 - DEBUG - Online update step: 2/25
2025-06-02 15:45:35,854 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:35,973 - DEBUG - Node anomaly scores shape: torch.Size([18724, 1])
2025-06-02 15:45:35,983 - DEBUG - Edge anomaly scores shape: torch.Size([38867, 1])
2025-06-02 15:45:35,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:36,256 - DEBUG - Step 2: Loss=0.7299
2025-06-02 15:45:36,257 - DEBUG - Online update step: 3/25
2025-06-02 15:45:36,262 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:36,859 - DEBUG - Node anomaly scores shape: torch.Size([18059, 1])
2025-06-02 15:45:36,867 - DEBUG - Edge anomaly scores shape: torch.Size([37549, 1])
2025-06-02 15:45:36,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:37,389 - DEBUG - Step 3: Loss=0.6981
2025-06-02 15:45:37,390 - DEBUG - Online update step: 4/25
2025-06-02 15:45:37,407 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:37,526 - DEBUG - Node anomaly scores shape: torch.Size([17996, 1])
2025-06-02 15:45:37,535 - DEBUG - Edge anomaly scores shape: torch.Size([37486, 1])
2025-06-02 15:45:37,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:37,762 - DEBUG - Step 4: Loss=0.6975
2025-06-02 15:45:37,763 - DEBUG - Online update step: 5/25
2025-06-02 15:45:37,769 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:37,884 - DEBUG - Node anomaly scores shape: torch.Size([19716, 1])
2025-06-02 15:45:37,890 - DEBUG - Edge anomaly scores shape: torch.Size([41393, 1])
2025-06-02 15:45:37,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:38,130 - DEBUG - Step 5: Loss=0.7158
2025-06-02 15:45:38,131 - DEBUG - Online update step: 6/25
2025-06-02 15:45:38,137 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:38,243 - DEBUG - Node anomaly scores shape: torch.Size([19878, 1])
2025-06-02 15:45:38,249 - DEBUG - Edge anomaly scores shape: torch.Size([41534, 1])
2025-06-02 15:45:38,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:38,505 - DEBUG - Step 6: Loss=0.6831
2025-06-02 15:45:38,506 - DEBUG - Online update step: 7/25
2025-06-02 15:45:38,512 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:38,606 - DEBUG - Node anomaly scores shape: torch.Size([17966, 1])
2025-06-02 15:45:38,612 - DEBUG - Edge anomaly scores shape: torch.Size([37468, 1])
2025-06-02 15:45:38,614 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:38,808 - DEBUG - Step 7: Loss=0.7060
2025-06-02 15:45:38,809 - DEBUG - Online update step: 8/25
2025-06-02 15:45:38,815 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:38,926 - DEBUG - Node anomaly scores shape: torch.Size([17396, 1])
2025-06-02 15:45:38,936 - DEBUG - Edge anomaly scores shape: torch.Size([36039, 1])
2025-06-02 15:45:38,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:39,145 - DEBUG - Step 8: Loss=0.7260
2025-06-02 15:45:39,145 - DEBUG - Online update step: 9/25
2025-06-02 15:45:39,151 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:39,256 - DEBUG - Node anomaly scores shape: torch.Size([18869, 1])
2025-06-02 15:45:39,262 - DEBUG - Edge anomaly scores shape: torch.Size([39262, 1])
2025-06-02 15:45:39,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:39,524 - DEBUG - Step 9: Loss=0.6941
2025-06-02 15:45:39,525 - DEBUG - Online update step: 10/25
2025-06-02 15:45:39,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:39,707 - DEBUG - Node anomaly scores shape: torch.Size([19341, 1])
2025-06-02 15:45:39,714 - DEBUG - Edge anomaly scores shape: torch.Size([40406, 1])
2025-06-02 15:45:39,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:40,103 - DEBUG - Step 10: Loss=0.6930
2025-06-02 15:45:40,103 - DEBUG - Online update step: 11/25
2025-06-02 15:45:40,106 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:40,265 - DEBUG - Node anomaly scores shape: torch.Size([18177, 1])
2025-06-02 15:45:40,274 - DEBUG - Edge anomaly scores shape: torch.Size([37940, 1])
2025-06-02 15:45:40,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:40,523 - DEBUG - Step 11: Loss=0.7115
2025-06-02 15:45:40,523 - DEBUG - Online update step: 12/25
2025-06-02 15:45:40,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:40,624 - DEBUG - Node anomaly scores shape: torch.Size([17449, 1])
2025-06-02 15:45:40,640 - DEBUG - Edge anomaly scores shape: torch.Size([36256, 1])
2025-06-02 15:45:40,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:40,864 - DEBUG - Step 12: Loss=0.6795
2025-06-02 15:45:40,864 - DEBUG - Online update step: 13/25
2025-06-02 15:45:40,867 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:40,963 - DEBUG - Node anomaly scores shape: torch.Size([18563, 1])
2025-06-02 15:45:40,967 - DEBUG - Edge anomaly scores shape: torch.Size([38817, 1])
2025-06-02 15:45:40,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:41,188 - DEBUG - Step 13: Loss=0.7041
2025-06-02 15:45:41,189 - DEBUG - Online update step: 14/25
2025-06-02 15:45:41,195 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:41,310 - DEBUG - Node anomaly scores shape: torch.Size([20350, 1])
2025-06-02 15:45:41,316 - DEBUG - Edge anomaly scores shape: torch.Size([42627, 1])
2025-06-02 15:45:41,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:41,528 - DEBUG - Step 14: Loss=0.7227
2025-06-02 15:45:41,528 - DEBUG - Online update step: 15/25
2025-06-02 15:45:41,534 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:41,641 - DEBUG - Node anomaly scores shape: torch.Size([18089, 1])
2025-06-02 15:45:41,647 - DEBUG - Edge anomaly scores shape: torch.Size([37774, 1])
2025-06-02 15:45:41,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:41,851 - DEBUG - Step 15: Loss=0.6919
2025-06-02 15:45:41,851 - DEBUG - Online update step: 16/25
2025-06-02 15:45:41,854 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:41,960 - DEBUG - Node anomaly scores shape: torch.Size([18021, 1])
2025-06-02 15:45:41,964 - DEBUG - Edge anomaly scores shape: torch.Size([37515, 1])
2025-06-02 15:45:41,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:42,155 - DEBUG - Step 16: Loss=0.6892
2025-06-02 15:45:42,156 - DEBUG - Online update step: 17/25
2025-06-02 15:45:42,159 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:42,260 - DEBUG - Node anomaly scores shape: torch.Size([18092, 1])
2025-06-02 15:45:42,264 - DEBUG - Edge anomaly scores shape: torch.Size([37547, 1])
2025-06-02 15:45:42,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:42,471 - DEBUG - Step 17: Loss=0.7081
2025-06-02 15:45:42,472 - DEBUG - Online update step: 18/25
2025-06-02 15:45:42,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:42,578 - DEBUG - Node anomaly scores shape: torch.Size([18228, 1])
2025-06-02 15:45:42,582 - DEBUG - Edge anomaly scores shape: torch.Size([37706, 1])
2025-06-02 15:45:42,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:42,767 - DEBUG - Step 18: Loss=0.6764
2025-06-02 15:45:42,767 - DEBUG - Online update step: 19/25
2025-06-02 15:45:42,776 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:42,876 - DEBUG - Node anomaly scores shape: torch.Size([17257, 1])
2025-06-02 15:45:42,880 - DEBUG - Edge anomaly scores shape: torch.Size([35786, 1])
2025-06-02 15:45:42,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:43,050 - DEBUG - Step 19: Loss=0.7009
2025-06-02 15:45:43,050 - DEBUG - Online update step: 20/25
2025-06-02 15:45:43,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:43,159 - DEBUG - Node anomaly scores shape: torch.Size([17812, 1])
2025-06-02 15:45:43,164 - DEBUG - Edge anomaly scores shape: torch.Size([36930, 1])
2025-06-02 15:45:43,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:43,373 - DEBUG - Step 20: Loss=0.7190
2025-06-02 15:45:43,374 - DEBUG - Online update step: 21/25
2025-06-02 15:45:43,377 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:43,522 - DEBUG - Node anomaly scores shape: torch.Size([16229, 1])
2025-06-02 15:45:43,530 - DEBUG - Edge anomaly scores shape: torch.Size([33439, 1])
2025-06-02 15:45:43,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:43,752 - DEBUG - Step 21: Loss=0.6886
2025-06-02 15:45:43,752 - DEBUG - Online update step: 22/25
2025-06-02 15:45:43,758 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:43,852 - DEBUG - Node anomaly scores shape: torch.Size([17246, 1])
2025-06-02 15:45:43,857 - DEBUG - Edge anomaly scores shape: torch.Size([36000, 1])
2025-06-02 15:45:43,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:44,048 - DEBUG - Step 22: Loss=0.6871
2025-06-02 15:45:44,049 - DEBUG - Online update step: 23/25
2025-06-02 15:45:44,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:44,170 - DEBUG - Node anomaly scores shape: torch.Size([18593, 1])
2025-06-02 15:45:44,176 - DEBUG - Edge anomaly scores shape: torch.Size([38636, 1])
2025-06-02 15:45:44,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:44,398 - DEBUG - Step 23: Loss=0.7059
2025-06-02 15:45:44,398 - DEBUG - Online update step: 24/25
2025-06-02 15:45:44,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:44,494 - DEBUG - Node anomaly scores shape: torch.Size([17846, 1])
2025-06-02 15:45:44,499 - DEBUG - Edge anomaly scores shape: torch.Size([37019, 1])
2025-06-02 15:45:44,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:44,776 - DEBUG - Step 24: Loss=0.6742
2025-06-02 15:45:44,777 - DEBUG - Online update step: 25/25
2025-06-02 15:45:44,780 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:44,868 - DEBUG - Node anomaly scores shape: torch.Size([17915, 1])
2025-06-02 15:45:44,883 - DEBUG - Edge anomaly scores shape: torch.Size([37455, 1])
2025-06-02 15:45:44,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:45,355 - DEBUG - Step 25: Loss=0.6964
2025-06-02 15:45:45,356 - INFO - Online update finished. Average loss: 0.7004, Learning rate: 0.001000
2025-06-02 15:45:45,358 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], current edge mean: [-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:45:45,358 - DEBUG - Node drift difference: 0.0061, Edge drift difference: 0.0004
2025-06-02 15:45:45,360 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], edge=[-2.7790412e-09  4.5666489e+02  0.0000000e+00  0.0000000e+00
 -4.6317354e-09  0.0000000e+00  9.2634705e-10 -4.6317353e-10
 -6.6002230e-09  9.2634705e-10]
2025-06-02 15:45:45,361 - DEBUG - Updated reference std: node=[0.         0.         1.0005229  1.0005229  0.         0.
 0.         1.0005229  1.0005229  1.0005229  1.0005229  1.0005229
 0.97763693 0.27184048 0.36169627 0.5735438  1.0005229  2.9591587
 2.8782218  1.4838562  0.36169627 0.22627786 1.0005229  1.0005229
 0.         0.         0.         0.         1.0005229  1.0005229 ], edge=[  1.000243  449.71378     0.          0.          1.0002428   1.000243
   1.000243    1.000243    1.000243    1.000243 ]
2025-06-02 15:45:45,362 - INFO - Online update complete. Loss: 0.7004
2025-06-02 15:45:45,362 - INFO - Running anomaly detection...
2025-06-02 15:45:45,362 - INFO - Starting anomaly detection.
2025-06-02 15:45:45,386 - DEBUG - Node reconstruction errors: [4.22339886e-01 9.29658592e-01 2.65451026e+00 2.81963311e-02
 1.68593377e-01 7.16903284e-02 1.88038468e+00 3.60121727e-02
 3.60121727e-02 1.04078956e-01 3.60121727e-02 5.68846017e-02
 4.21226692e+00 7.22704530e-01 1.81488898e-02 7.90880620e-02
 1.76213890e-01 7.90880620e-02 7.81048596e-01 7.65647516e-02
 4.69139852e-02 1.81488898e-02 2.64254898e-01 1.60461962e-01
 1.96621194e-02 5.30188456e-02 1.96621194e-02 2.72728056e-01
 3.69518995e-02 1.96621194e-02 8.36801529e-01 3.02380949e-01
 2.49716029e-01 2.87652221e-02 2.07822114e-01 2.57535845e-01
 1.15560152e-01 7.65644684e-02 3.50356013e-01 4.51710343e-01
 7.89901391e-02 1.58612989e-02 7.65644684e-02 1.41311228e-01
 4.76931423e-01 1.18552670e-01 1.67412221e-01 5.81155062e-01
 3.81849669e-02 6.51815116e-01 6.63679302e-01 6.35593906e-02
 5.41847013e-02 7.49700904e-01 4.34284844e-02 1.89566657e-01
 1.13283157e+00 7.26374388e-02 7.94713318e-01 7.53269613e-01
 3.26630473e-01 2.24509031e-01 1.38925426e-02 1.88400283e-01
 1.88388571e-01 4.34283465e-02 1.37531906e-02 4.34287004e-02
 1.38925752e-02 2.03734457e-01 7.57990330e-02 5.11155799e-02
 1.19761145e-02 1.11574680e-01 1.29658684e-01 5.16226627e-02
 2.66082138e-01 1.94657192e-01 5.80891781e-02 7.99730122e-02
 2.77783312e-02 5.08907884e-02 9.08956945e-01 7.84040615e-02
 5.88522404e-02 7.67437890e-02 7.22825080e-02 9.66412351e-02
 6.21210970e-02 2.20922187e-01 1.42641244e-02 1.74264476e-01
 6.23171963e-02 9.05074775e-02 7.15689138e-02 6.41651869e-01
 2.64757406e-02 5.23441397e-02 1.10669732e-02 1.57783419e-01
 3.72126289e-02 2.64757406e-02 7.93198198e-02 3.30349267e-01
 1.64494410e-01 4.35368866e-02 1.69473901e-01 8.50980729e-02
 6.50183484e-02 4.82603997e-01 3.23978394e-01 3.25537771e-02
 1.43537626e-01 2.42118135e-01 3.38232368e-02 3.38643789e-02
 3.24224643e-02 2.14085266e-01 6.57928661e-02 1.71239059e-02
 1.43869631e-02 4.30560820e-02 2.06013337e-01 1.47765413e-01
 4.98233512e-02 1.71233378e-02 1.68741614e-01 1.35481998e-01
 7.36708194e-02 3.74635831e-02 6.67587370e-02 9.81544144e-03
 6.88840747e-01 3.45068157e-01 3.00166812e-02 4.05087806e-02
 9.77802500e-02 1.08079752e-02 2.90205896e-01 2.73712486e-01
 9.37317386e-02 6.36864677e-02 1.65830739e-02 5.67305312e-02
 9.37317833e-02 1.37338400e-01 3.24223489e-02 2.22477436e-01
 8.93912315e-02 8.17639679e-02 6.08289838e-01 1.61767334e-01
 7.98731744e-02 9.81544144e-03 1.26614258e-01 1.89387143e-01
 9.96166561e-03 5.78981414e-02 3.72126587e-02 7.37908706e-02
 9.37317833e-02 9.23811123e-02 9.96162463e-03 6.67587370e-02
 3.30367759e-02 1.27528518e-01 3.07105854e-02 6.05018921e-02
 9.38296840e-02 8.17635283e-02 8.56174603e-02 1.97235476e-02
 1.33073227e-02 5.47284245e-01 6.57931641e-02 7.67816067e+00
 5.95630296e-02 7.02150986e-02 3.31096277e-02 3.31094712e-02
 4.58855294e-02 9.64640081e-02 7.30324313e-02 2.58478254e-01
 1.77640721e-01 4.04466577e-02 1.47375297e-02 4.60565314e-02
 4.26692963e-02 1.08240647e-02 1.42958909e-01 7.76713192e-02
 1.23539336e-01 1.25607215e-02 2.90205926e-01 5.74615076e-02
 9.97366846e-01 1.14396885e-01 1.46968424e-01 1.13650821e-01
 2.74900235e-02 9.96166561e-03 1.32947400e-01 8.65451545e-02
 6.75731078e-02 8.53622779e-02 1.18195154e-01 2.72100329e-01
 1.25635630e-02 7.12434426e-02 2.99268160e-02 1.18370436e-01
 6.19726442e-02 5.60291596e-02 3.19843143e-02 1.92663465e-02
 6.33314848e-02 3.24224047e-02 1.11581221e-01 1.25607215e-02
 2.39331439e-01 1.47375297e-02 1.28029007e-02 6.19726442e-02
 9.96166561e-03 6.01475388e-02 2.02204958e-01 1.57283060e-02
 8.15344974e-02 5.59896901e-02 1.31823510e-01 4.77810316e-02
 8.55824649e-02 3.24225277e-02 3.24225277e-02 4.43080142e-02
 5.75594194e-02 1.28029007e-02 9.96166561e-03 1.51299611e-01
 1.80629984e-01 9.97245014e-02 1.60565879e-02 5.51878028e-02
 1.73393581e-02 6.39942586e-02 4.39511612e-02 7.84008428e-02
 1.60565879e-02 2.95902807e-02 1.33073227e-02 1.36331758e-02
 1.11581296e-01 4.85637672e-02 8.46721828e-02 5.52525073e-02
 1.08240843e-02 1.32110249e-02 9.30500031e-02 3.31095569e-02
 5.65848984e-02 1.12252481e-01 2.13170685e-02 7.42095187e-02
 5.57103902e-02 9.67551395e-02 7.34121948e-02 8.83788705e-01
 7.34121352e-02 3.91555205e-02 2.92426080e-01 2.25273356e-01
 6.50696456e-02 1.98505491e-01 2.49923710e-02 1.85314924e-01
 2.28214897e-02 1.88317910e-01 4.58855294e-02 4.47242148e-02
 2.31703550e-01 2.30256114e-02 6.07678480e-02 8.18975717e-02
 7.60060698e-02 3.26092765e-02 3.61559808e-01 6.68402240e-02
 9.64640155e-02 5.00655830e-01 9.91104618e-02 3.40000577e-02
 3.81774120e-02 1.73393581e-02 7.99988449e-01 2.14778539e-02
 4.91908789e-02 3.31091844e-02 5.74615076e-02 6.55355513e-01
 6.02951646e-02 1.08021326e-01 2.12912317e-02 4.82982360e-02
 8.82114936e-03 8.82114936e-03 8.82114936e-03 2.54251957e-02
 8.04075673e-02 1.08021379e-01 8.82118568e-03 1.30918160e-01
 8.82114936e-03 1.18789105e-02 9.14996639e-02 7.58383721e-02
 2.79417992e-01 6.89714924e-02 6.51489198e-02 5.83831258e-02
 7.79939815e-02 2.73342840e-02 6.41823784e-02 2.12910939e-02
 8.51039067e-02 2.40708277e-01 3.30301225e-01 7.11356476e-02
 7.61071518e-02 7.61072487e-02 2.17602551e-01 5.95565401e-02
 8.82118568e-03 2.49925498e-02 8.82114936e-03 2.54251398e-02
 4.82689627e-02 1.30762151e-02 1.29106447e-01 9.63608734e-03
 1.08021379e-01 2.95137726e-02 9.63605288e-03 1.18300192e-01
 4.53224033e-02 6.33225217e-02 2.12912243e-02 3.41505334e-02
 8.08923319e-02 7.18809664e-02 8.82118568e-03 4.24172804e-02
 1.44788519e-01 9.35914665e-02 2.72985566e-02 1.08240843e-02
 1.23328775e-01 8.82114936e-03 9.68000293e-03 3.41560870e-01
 9.08139274e-02 1.29419165e-02 2.28911564e-01 5.36598191e-02
 2.12911256e-02 7.20327914e-01 1.14664501e-02 1.66557714e-01
 3.05605754e-02 2.76365876e-02 5.36501035e-02 4.77515124e-02
 5.66114411e-02 1.28425404e-01 6.30641580e-02 9.35959443e-02
 1.24188988e-02 1.81512125e-02 1.61800787e-01 8.82114936e-03
 2.12913863e-02 8.32253993e-02 1.10757248e-02 5.83600961e-02
 7.98952878e-02 3.25812250e-02 7.93660954e-02 1.76974863e-01
 5.12962490e-02 8.82118568e-03 2.58049577e-01 4.98771742e-02
 2.94896476e-02 1.93963155e-01 5.12477160e-02 5.12477010e-02
 5.12475707e-02 8.21377456e-01 8.23277328e-03 8.22442889e-01
 1.30897174e-02 1.31467849e-01 9.84749720e-02 8.23277328e-03
 3.08030974e-02 2.94895731e-02 6.96274117e-02 1.44756772e-02
 2.94896197e-02 8.35957974e-02 5.12477085e-02 2.94895116e-02
 8.23281799e-03 5.12477010e-02 5.12477085e-02 2.28912663e-02
 2.89082136e-02 5.12477085e-02 1.24064954e-02 4.23936620e-02
 4.10349742e-02 1.50863258e-02 2.76379846e-02 1.22659737e-02
 1.90645784e-01 4.99307849e-02 2.24791728e-02 6.19230680e-02
 1.13627277e-01 2.74503566e-02 7.79552832e-02 5.11453226e-02
 5.84117621e-02 5.61863817e-02 2.19742090e-01 5.12477010e-02
 1.30897174e-02 6.44922629e-02 1.96893021e-01 6.30394220e-02
 3.16168293e-02 2.16551814e-02 1.85609296e-01 1.02963708e-02
 4.84150760e-02 1.36498511e-01 2.04462439e-01 1.32016065e-02
 6.63547888e-02 1.52678574e-02 4.80521359e-02 1.17486678e-02
 1.80333015e-02 7.17887580e-02 1.17486678e-02 5.09160981e-02
 1.22659737e-02 3.56162079e-02 3.99211384e-02 5.86826727e-02
 2.95647178e-02 1.61409713e-02 1.20095331e-02 6.54990152e-02
 1.20095331e-02 1.61409713e-02 1.23650897e-02 4.58314829e-02
 9.04569626e-02 6.36309907e-02 1.23650627e-02 2.95648146e-02
 3.27513143e-02 3.11048001e-01 4.24524806e-02 2.76362412e-02
 4.58314419e-02 2.95647047e-02 1.01139396e-02 2.20780801e-02
 3.08194961e-02 2.89780170e-01 3.43617983e-02 1.32016065e-02
 1.84739679e-01 1.48911141e-02 1.17486678e-02 1.06488183e-01
 2.39789300e-02 3.05935860e-01 3.53771187e-02 1.01139396e-02
 5.09782173e-02 1.06491810e-02 5.57702072e-02 1.36260800e-02
 2.94031277e-02 8.66009414e-01 7.89669249e-03 2.20780801e-02
 2.14929268e-01 1.06491810e-02 1.95091680e-01 2.13549938e-02
 1.22273797e-02 6.64764568e-02 6.93852501e-03 5.00713766e-01
 1.90746896e-02 1.17486678e-02 2.05901656e-02 1.82026997e-02
 1.82026997e-02 1.21368887e-02 7.11269379e-02 2.49660537e-02
 6.93852501e-03 1.87734086e-02 8.32674578e-02 6.47338107e-02
 8.63371417e-02 2.16551814e-02 6.93852501e-03 1.03544347e-01
 1.22273779e-02 2.94029228e-02 7.56677613e-02 1.90959990e-01
 8.63371044e-02 7.04139397e-02 2.49660537e-02 6.28650859e-02
 7.89669249e-03 2.20781248e-02 2.94028800e-02 2.91427709e-02
 6.93846121e-02 6.12869337e-02 7.89669249e-03 5.65541759e-02
 7.89667387e-03 8.28116089e-02 8.23223293e-02 1.87734365e-02
 1.50740361e-02 4.53901350e-01 9.39563364e-02 7.78274098e-03
 7.59180188e-01 7.78271863e-03 7.78271863e-03 7.78271863e-03
 7.78271863e-03 7.78271863e-03 7.78270559e-03 7.78271863e-03
 2.14850549e-02 1.59734730e-02 2.59221997e-02 7.78270559e-03
 7.78271863e-03 7.78271863e-03 7.78271863e-03 7.78271863e-03
 7.78271863e-03 7.78274098e-03 7.78271863e-03 7.78271863e-03
 1.89130101e-02 7.78271863e-03 7.78271863e-03 1.98189571e-01
 7.78271863e-03 1.04502268e-01 7.28869960e-02 7.89669249e-03
 5.68872429e-02 7.66348690e-02 4.73284811e-01 4.73284811e-01
 7.29419664e-02 5.68872429e-02 7.89669249e-03 6.93852501e-03
 6.93852501e-03 7.89667387e-03 6.93852501e-03 4.52931747e-02
 1.70999877e-02 7.78270559e-03 2.16551814e-02 7.89667387e-03
 1.82026997e-02 7.89669249e-03 7.89669249e-03 5.30940779e-02
 7.89667387e-03 6.93852501e-03 7.89669249e-03 7.89669249e-03
 1.87734421e-02 6.93852501e-03 7.89669249e-03 6.93852501e-03
 7.89667387e-03 7.89667387e-03 7.89667387e-03 6.96270838e-02
 4.49198373e-02 2.77090147e-02 7.78271863e-03 5.33524491e-02
 8.81252810e-02 7.89669249e-03 6.93852501e-03 5.45808002e-02
 7.78271863e-03 3.10219172e-02 4.22886461e-02 7.16281729e-03
 7.89667387e-03 7.89669249e-03 4.13248762e-02 7.79244900e-02
 3.12343333e-02 7.89667387e-03 2.14850064e-02 1.10420166e-02
 6.93852501e-03 1.71610281e-01 7.78271863e-03 3.83627489e-02
 5.45492619e-02 7.78271863e-03 7.78271863e-03 2.14850307e-02
 1.10420166e-02 7.89667387e-03 2.94316560e-01 7.27610588e-02
 5.10164835e-02 7.79244900e-02 2.20763162e-02 5.34528606e-02
 5.34527339e-02 7.13119656e-02 1.33284312e-02 7.78271863e-03
 2.00916529e-02 6.37268871e-02 7.79244974e-02 2.79743746e-02
 1.74050033e-02 2.06326358e-02 7.73401465e-03 7.73401465e-03
 7.73401046e-03 7.73401465e-03 7.73401465e-03 1.98719371e-02
 7.14268535e-02 7.73401465e-03 7.73401465e-03 7.78274098e-03
 9.52506997e-03 7.78271863e-03 5.34528457e-02 7.76905790e-02
 9.98210609e-02 2.72100046e-02 7.57289976e-02 6.13728277e-02
 1.89130791e-02 2.02952363e-02 1.89130139e-02 7.78274098e-03
 5.34528457e-02 1.19704995e-02 6.49619382e-03 6.49618311e-03
 7.73401465e-03 1.19705368e-02 5.28136678e-02 3.06540634e-02
 2.29039192e-02 7.78274098e-03 7.73401465e-03 2.67671868e-02
 6.49619382e-03 7.36201555e-03 1.01735704e-02 2.59860847e-02
 1.98717657e-02 2.94791669e-01 7.78047927e-03 1.92383125e-01
 2.92828921e-02 1.01735704e-02 1.68131553e-02 1.11842491e-02
 9.52551886e-03 7.70875998e-03 5.74931763e-02 1.87801141e-02
 5.51625378e-02 1.01736002e-02 1.01735704e-02 1.01736002e-02
 8.06125812e-03 2.67671868e-02 1.01736002e-02 9.52551886e-03
 1.01736002e-02 1.01736002e-02 1.01735704e-02 3.06835100e-02
 1.06018288e-02 4.37721349e-02 6.21266849e-02 6.09025545e-02
 6.72285035e-02 3.14775594e-02 4.61359657e-02 8.72482061e-01
 9.09700152e-03 1.02234334e-02 6.60812948e-03 7.13869259e-02
 7.13870004e-02 9.52551886e-03 1.90617517e-01 1.59958452e-01
 9.08441283e-03 7.11108232e-03 2.96136234e-02 1.89598575e-01
 1.00661991e-02 1.00661991e-02 1.00661991e-02 6.97877491e-03
 6.26412174e-03 9.64717641e-02 1.51321575e-01 2.48567134e-01
 3.78216915e-02 5.42619964e-03 2.68494170e-02 7.11108232e-03
 2.15315092e-02 3.24557759e-02 6.63909363e-03 8.98551270e-02
 9.08441283e-03 1.59958601e-01 7.11108232e-03 3.24558541e-02
 5.42618567e-03 1.39273241e-01 1.00661991e-02 6.97876420e-03
 6.63909363e-03 3.14292684e-02 7.57367611e-02 6.97876420e-03
 6.97876420e-03 6.97876420e-03 1.38698444e-01 1.41798723e+00
 2.04220557e+00 1.00661991e-02 1.50636092e-01 6.97876420e-03
 6.49022162e-02 3.02726589e-02 9.67472315e-01 3.65423299e-02
 6.97876420e-03 7.09103839e-03 2.72381343e-02 8.84708110e-03
 5.23262918e-01 3.65423299e-02 3.78573090e-01 4.75428104e-02
 7.28195831e-02 3.65423299e-02 6.89206570e-02 8.07574615e-02
 3.39671187e-02 9.07498524e-02 3.09941843e-02 8.87046847e-03
 8.87046847e-03 2.45361969e-01 3.63633901e-01 2.06698462e-01
 3.65423299e-02 3.39671336e-02 3.65423299e-02 4.46446659e-03
 9.20397695e-03 9.20397695e-03 6.13117544e-03 8.69992301e-02
 4.24900046e-03 9.20397695e-03 4.46442002e-03 1.07990786e-01
 9.20399930e-03 9.20397695e-03 7.41475308e-03 1.04961380e-01
 8.51755962e-02 7.11334720e-02 9.20397695e-03 3.75757143e-02
 1.07990690e-01 9.20397695e-03 9.69116203e-03 2.99044922e-02
 3.80015653e-03 3.80015653e-03 1.61750481e-01 2.99044922e-02
 9.20397695e-03 2.99045257e-02 2.81234346e-02 8.19938257e-02
 1.63605005e-01 9.20397695e-03 2.80038178e-01 2.83560194e-02
 2.83560194e-02 1.04961403e-01 7.94394501e-03 3.69559452e-02
 9.69116203e-03 4.95229848e-02 6.49910374e-03 9.23200473e-02
 4.62406464e-02 9.23200473e-02 2.94283241e-01 4.42222646e-03
 4.62406464e-02 8.66735168e-03 8.66738148e-03 1.05371439e+00
 8.66735168e-03 6.70380220e-02 7.94394501e-03 9.00767967e-02
 3.93521376e-02 4.42222646e-03 3.93521786e-02 1.75062656e-01
 7.28505105e-02 1.16090640e-01 8.66735168e-03 4.64421101e-02
 1.02625974e-01 8.66735168e-03 7.88641050e-02 5.38424738e-02
 4.64421101e-02 4.42222646e-03 8.66735168e-03 2.97037274e-01
 8.66735168e-03 8.66735168e-03 8.66735168e-03 1.01612108e-02
 4.58589420e-02 1.01612108e-02 3.91023569e-02 1.01612108e-02
 4.21353355e-02 7.04151914e-02 9.45631191e-02 8.66738148e-03
 8.66738148e-03 2.79675890e-03 8.66735168e-03 6.18352592e-01
 3.91023569e-02 1.01612108e-02 2.79673445e-03 8.66735168e-03
 8.66738148e-03 2.31743101e-02 2.79675890e-03 8.66738148e-03
 5.52838808e-03 4.80719246e-02 7.14799156e-03 3.83112580e-01
 5.52838808e-03 8.66738148e-03 8.66735168e-03 2.20061950e-02
 8.08524713e-02 7.72057697e-02 7.72059709e-02 9.62688308e-03
 9.93010178e-02 1.24685340e-01 4.95363958e-02 3.54333907e-01
 7.72059709e-02 1.08247567e-02 7.72059709e-02 5.02282158e-02
 4.95363958e-02 7.72057697e-02 1.08818971e-02 7.14799156e-03
 6.15554675e-02 3.13808094e-03 1.17259305e-02 7.13162730e-03
 1.33021921e-01 1.34752989e-02 1.28657622e-02 1.28657622e-02
 5.78120425e-02 7.96915144e-02 1.28657622e-02 1.28658051e-02
 7.66228288e-02 8.40596482e-02 1.28657622e-02 1.28658051e-02
 1.28658051e-02 1.28657622e-02 1.28657622e-02 1.28657622e-02
 1.28657622e-02 1.28657622e-02 1.04414523e-02 6.49881214e-02
 1.28657622e-02 1.28657622e-02 1.28657622e-02 1.28657622e-02
 3.44504684e-01 1.39487758e-01 1.48697486e-02 6.49880171e-02
 1.28323101e-02 1.83907151e-02 1.83907151e-02 1.28657622e-02
 1.83907151e-02 1.83906239e-02 1.51959389e-01 1.01337306e-01
 1.01337306e-01]
2025-06-02 15:45:45,387 - DEBUG - Edge reconstruction errors: [ 5.2641516  5.2615395 44.25781   ... 13.357794   2.1587405 13.357794 ]
2025-06-02 15:45:45,390 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154545_update_44.json
2025-06-02 15:45:45,391 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:45:45,409 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154545_update_44.pth and as latest_checkpoint.pth
2025-06-02 15:45:45,410 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.6239
2025-06-02 15:45:45,410 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:45:45,410 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.6545, MLP Score: 0.5022
2025-06-02 15:45:45,410 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.8804, MLP Score: 0.5021
2025-06-02 15:45:45,410 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.2123, MLP Score: 0.5000
2025-06-02 15:45:45,411 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.1328, MLP Score: 0.5057
2025-06-02 15:45:45,411 - WARNING -   Node ID: 183.81.34.26, Recon Error: 7.6782, MLP Score: 0.5022
2025-06-02 15:45:45,411 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:45:45,411 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.9898
2025-06-02 15:45:45,411 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9604, MLP Score: 0.9895
2025-06-02 15:45:45,412 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0601, MLP Score: 0.9895
2025-06-02 15:45:45,412 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7588, MLP Score: 0.9689
2025-06-02 15:45:45,412 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7580, MLP Score: 0.9575
2025-06-02 15:45:45,412 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-02 15:45:45,412 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:45:45,412 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:45:45,412 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 15:45:45,436 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:45:45,458 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 15:45:45,458 - INFO - Processing node updates/additions.
2025-06-02 15:45:45,464 - INFO - Processing edge updates/additions.
2025-06-02 15:45:45,479 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:45:45,481 - INFO - Finished updating NetworkX graph.
2025-06-02 15:45:45,482 - DEBUG - Updated graph - Nodes: 962, Edges: 2098
2025-06-02 15:45:45,482 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:45:45,484 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:45:45,501 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-02 15:45:45,503 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:45:45,503 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-02 15:45:45,506 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-02 15:45:45,508 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:45:45,515 - DEBUG - Initial edge attributes tensor shape: torch.Size([2098, 10])
2025-06-02 15:45:45,518 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:45:45,524 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2098, 10])
2025-06-02 15:45:45,524 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:45:45,525 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:45:45,526 - INFO - Updated main graph to 962 nodes and 2098 edges.
2025-06-02 15:45:45,527 - INFO - Performing online update...
2025-06-02 15:45:45,527 - INFO - Starting online update for 25 steps.
2025-06-02 15:45:45,528 - DEBUG - Updated RunningStats: new_mean=0.9447302528549198, new_var=25800000000161.633, new_n=2610
2025-06-02 15:45:45,528 - DEBUG - Updated RunningStats: new_mean=0.9423829119140225, new_var=26100000000018.145, new_n=2640
2025-06-02 15:45:45,528 - DEBUG - Updated RunningStats: new_mean=44.757305784704556, new_var=8600000187458.265, new_n=870
2025-06-02 15:45:45,529 - DEBUG - Updated RunningStats: new_mean=44.76303132361939, new_var=8700000178091.943, new_n=880
2025-06-02 15:45:45,529 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:45:45,529 - DEBUG - Online update step: 1/25
2025-06-02 15:45:45,532 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:45,952 - DEBUG - Node anomaly scores shape: torch.Size([18774, 1])
2025-06-02 15:45:46,013 - DEBUG - Edge anomaly scores shape: torch.Size([39184, 1])
2025-06-02 15:45:46,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:46,296 - DEBUG - Step 1: Loss=0.7153
2025-06-02 15:45:46,296 - DEBUG - Online update step: 2/25
2025-06-02 15:45:46,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:46,626 - DEBUG - Node anomaly scores shape: torch.Size([19077, 1])
2025-06-02 15:45:46,633 - DEBUG - Edge anomaly scores shape: torch.Size([39861, 1])
2025-06-02 15:45:46,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:46,833 - DEBUG - Step 2: Loss=0.6840
2025-06-02 15:45:46,834 - DEBUG - Online update step: 3/25
2025-06-02 15:45:46,837 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:46,959 - DEBUG - Node anomaly scores shape: torch.Size([17488, 1])
2025-06-02 15:45:46,964 - DEBUG - Edge anomaly scores shape: torch.Size([36295, 1])
2025-06-02 15:45:46,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:47,178 - DEBUG - Step 3: Loss=0.6849
2025-06-02 15:45:47,178 - DEBUG - Online update step: 4/25
2025-06-02 15:45:47,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:47,288 - DEBUG - Node anomaly scores shape: torch.Size([19591, 1])
2025-06-02 15:45:47,294 - DEBUG - Edge anomaly scores shape: torch.Size([40887, 1])
2025-06-02 15:45:47,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:47,517 - DEBUG - Step 4: Loss=0.7027
2025-06-02 15:45:47,518 - DEBUG - Online update step: 5/25
2025-06-02 15:45:47,524 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:47,633 - DEBUG - Node anomaly scores shape: torch.Size([18699, 1])
2025-06-02 15:45:47,638 - DEBUG - Edge anomaly scores shape: torch.Size([39126, 1])
2025-06-02 15:45:47,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:47,869 - DEBUG - Step 5: Loss=0.6716
2025-06-02 15:45:47,870 - DEBUG - Online update step: 6/25
2025-06-02 15:45:47,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:47,985 - DEBUG - Node anomaly scores shape: torch.Size([18560, 1])
2025-06-02 15:45:47,990 - DEBUG - Edge anomaly scores shape: torch.Size([38651, 1])
2025-06-02 15:45:47,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:48,204 - DEBUG - Step 6: Loss=0.6923
2025-06-02 15:45:48,205 - DEBUG - Online update step: 7/25
2025-06-02 15:45:48,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:48,319 - DEBUG - Node anomaly scores shape: torch.Size([18671, 1])
2025-06-02 15:45:48,324 - DEBUG - Edge anomaly scores shape: torch.Size([38943, 1])
2025-06-02 15:45:48,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:48,573 - DEBUG - Step 7: Loss=0.7109
2025-06-02 15:45:48,573 - DEBUG - Online update step: 8/25
2025-06-02 15:45:48,579 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:48,685 - DEBUG - Node anomaly scores shape: torch.Size([19620, 1])
2025-06-02 15:45:48,690 - DEBUG - Edge anomaly scores shape: torch.Size([40983, 1])
2025-06-02 15:45:48,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:48,942 - DEBUG - Step 8: Loss=0.6800
2025-06-02 15:45:48,943 - DEBUG - Online update step: 9/25
2025-06-02 15:45:48,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:49,035 - DEBUG - Node anomaly scores shape: torch.Size([19657, 1])
2025-06-02 15:45:49,039 - DEBUG - Edge anomaly scores shape: torch.Size([41149, 1])
2025-06-02 15:45:49,041 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:49,224 - DEBUG - Step 9: Loss=0.6830
2025-06-02 15:45:49,225 - DEBUG - Online update step: 10/25
2025-06-02 15:45:49,231 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:49,327 - DEBUG - Node anomaly scores shape: torch.Size([18474, 1])
2025-06-02 15:45:49,332 - DEBUG - Edge anomaly scores shape: torch.Size([38384, 1])
2025-06-02 15:45:49,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:49,517 - DEBUG - Step 10: Loss=0.7015
2025-06-02 15:45:49,518 - DEBUG - Online update step: 11/25
2025-06-02 15:45:49,527 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:49,646 - DEBUG - Node anomaly scores shape: torch.Size([18716, 1])
2025-06-02 15:45:49,650 - DEBUG - Edge anomaly scores shape: torch.Size([39244, 1])
2025-06-02 15:45:49,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:49,883 - DEBUG - Step 11: Loss=0.6705
2025-06-02 15:45:49,883 - DEBUG - Online update step: 12/25
2025-06-02 15:45:49,888 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:49,976 - DEBUG - Node anomaly scores shape: torch.Size([17710, 1])
2025-06-02 15:45:49,980 - DEBUG - Edge anomaly scores shape: torch.Size([36857, 1])
2025-06-02 15:45:49,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:50,216 - DEBUG - Step 12: Loss=0.6889
2025-06-02 15:45:50,217 - DEBUG - Online update step: 13/25
2025-06-02 15:45:50,223 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:50,311 - DEBUG - Node anomaly scores shape: torch.Size([17891, 1])
2025-06-02 15:45:50,315 - DEBUG - Edge anomaly scores shape: torch.Size([37259, 1])
2025-06-02 15:45:50,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:50,516 - DEBUG - Step 13: Loss=0.7077
2025-06-02 15:45:50,516 - DEBUG - Online update step: 14/25
2025-06-02 15:45:50,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:50,611 - DEBUG - Node anomaly scores shape: torch.Size([17055, 1])
2025-06-02 15:45:50,616 - DEBUG - Edge anomaly scores shape: torch.Size([35477, 1])
2025-06-02 15:45:50,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:50,813 - DEBUG - Step 14: Loss=0.6775
2025-06-02 15:45:50,813 - DEBUG - Online update step: 15/25
2025-06-02 15:45:50,819 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:50,941 - DEBUG - Node anomaly scores shape: torch.Size([18032, 1])
2025-06-02 15:45:50,945 - DEBUG - Edge anomaly scores shape: torch.Size([37532, 1])
2025-06-02 15:45:50,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:51,174 - DEBUG - Step 15: Loss=0.6799
2025-06-02 15:45:51,175 - DEBUG - Online update step: 16/25
2025-06-02 15:45:51,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:51,263 - DEBUG - Node anomaly scores shape: torch.Size([18381, 1])
2025-06-02 15:45:51,267 - DEBUG - Edge anomaly scores shape: torch.Size([38157, 1])
2025-06-02 15:45:51,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:51,453 - DEBUG - Step 16: Loss=0.6984
2025-06-02 15:45:51,453 - DEBUG - Online update step: 17/25
2025-06-02 15:45:51,460 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:51,564 - DEBUG - Node anomaly scores shape: torch.Size([18182, 1])
2025-06-02 15:45:51,568 - DEBUG - Edge anomaly scores shape: torch.Size([37707, 1])
2025-06-02 15:45:51,570 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:51,752 - DEBUG - Step 17: Loss=0.6676
2025-06-02 15:45:51,753 - DEBUG - Online update step: 18/25
2025-06-02 15:45:51,756 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:51,844 - DEBUG - Node anomaly scores shape: torch.Size([17462, 1])
2025-06-02 15:45:51,848 - DEBUG - Edge anomaly scores shape: torch.Size([36392, 1])
2025-06-02 15:45:51,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:52,042 - DEBUG - Step 18: Loss=0.6868
2025-06-02 15:45:52,042 - DEBUG - Online update step: 19/25
2025-06-02 15:45:52,046 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:52,126 - DEBUG - Node anomaly scores shape: torch.Size([16885, 1])
2025-06-02 15:45:52,131 - DEBUG - Edge anomaly scores shape: torch.Size([35000, 1])
2025-06-02 15:45:52,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:52,292 - DEBUG - Step 19: Loss=0.7056
2025-06-02 15:45:52,292 - DEBUG - Online update step: 20/25
2025-06-02 15:45:52,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:52,398 - DEBUG - Node anomaly scores shape: torch.Size([18120, 1])
2025-06-02 15:45:52,402 - DEBUG - Edge anomaly scores shape: torch.Size([37625, 1])
2025-06-02 15:45:52,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:52,579 - DEBUG - Step 20: Loss=0.6752
2025-06-02 15:45:52,579 - DEBUG - Online update step: 21/25
2025-06-02 15:45:52,583 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:52,678 - DEBUG - Node anomaly scores shape: torch.Size([19711, 1])
2025-06-02 15:45:52,683 - DEBUG - Edge anomaly scores shape: torch.Size([41239, 1])
2025-06-02 15:45:52,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:52,886 - DEBUG - Step 21: Loss=0.6779
2025-06-02 15:45:52,886 - DEBUG - Online update step: 22/25
2025-06-02 15:45:52,889 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:52,992 - DEBUG - Node anomaly scores shape: torch.Size([18087, 1])
2025-06-02 15:45:52,995 - DEBUG - Edge anomaly scores shape: torch.Size([37449, 1])
2025-06-02 15:45:52,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:53,159 - DEBUG - Step 22: Loss=0.6960
2025-06-02 15:45:53,160 - DEBUG - Online update step: 23/25
2025-06-02 15:45:53,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:53,246 - DEBUG - Node anomaly scores shape: torch.Size([16171, 1])
2025-06-02 15:45:53,250 - DEBUG - Edge anomaly scores shape: torch.Size([33466, 1])
2025-06-02 15:45:53,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:53,483 - DEBUG - Step 23: Loss=0.6665
2025-06-02 15:45:53,483 - DEBUG - Online update step: 24/25
2025-06-02 15:45:53,487 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:53,759 - DEBUG - Node anomaly scores shape: torch.Size([17803, 1])
2025-06-02 15:45:53,765 - DEBUG - Edge anomaly scores shape: torch.Size([37049, 1])
2025-06-02 15:45:53,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:53,943 - DEBUG - Step 24: Loss=0.6840
2025-06-02 15:45:53,943 - DEBUG - Online update step: 25/25
2025-06-02 15:45:53,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:54,088 - DEBUG - Node anomaly scores shape: torch.Size([18759, 1])
2025-06-02 15:45:54,095 - DEBUG - Edge anomaly scores shape: torch.Size([39161, 1])
2025-06-02 15:45:54,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:54,317 - DEBUG - Step 25: Loss=0.7008
2025-06-02 15:45:54,318 - INFO - Online update finished. Average loss: 0.6884, Learning rate: 0.001000
2025-06-02 15:45:54,320 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], current edge mean: [-3.6365084e-09  4.5637512e+02  0.0000000e+00  0.0000000e+00
  9.0912711e-10  2.7273812e-09  0.0000000e+00  9.0912711e-10
 -3.6365084e-09 -9.0912711e-10]
2025-06-02 15:45:54,320 - DEBUG - Node drift difference: 0.0202, Edge drift difference: 0.0006
2025-06-02 15:45:54,323 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], edge=[-3.6365084e-09  4.5637512e+02  0.0000000e+00  0.0000000e+00
  9.0912711e-10  2.7273812e-09  0.0000000e+00  9.0912711e-10
 -3.6365084e-09 -9.0912711e-10]
2025-06-02 15:45:54,324 - DEBUG - Updated reference std: node=[0.         0.         1.0005201  1.0005201  0.         0.
 0.         1.0005201  1.0005201  1.0005202  1.0005201  1.0005201
 0.96617806 0.27114588 0.36217502 0.5716872  1.0005202  2.9931998
 2.895206   1.4912298  0.36217502 0.22568905 1.0005201  1.0005201
 0.         0.         0.         0.         1.0005202  1.0005201 ], edge=[  1.0002384 445.60986     0.          0.          1.0002384   1.0002384
   1.0002384   1.0002384   1.0002384   1.0002383]
2025-06-02 15:45:54,324 - INFO - Online update complete. Loss: 0.6884
2025-06-02 15:45:54,324 - INFO - Running anomaly detection...
2025-06-02 15:45:54,325 - INFO - Starting anomaly detection.
2025-06-02 15:45:54,354 - DEBUG - Node reconstruction errors: [3.81311566e-01 8.55199456e-01 2.49800324e+00 2.38832738e-02
 1.33266553e-01 5.61021380e-02 1.71293306e+00 2.89241914e-02
 2.89241914e-02 8.75456482e-02 2.89241914e-02 5.78473471e-02
 3.89100575e+00 7.10138202e-01 1.54376049e-02 7.35084116e-02
 1.57600239e-01 7.35083371e-02 5.92204094e-01 7.11804330e-02
 3.96846086e-02 1.54376049e-02 2.32996270e-01 1.45853266e-01
 1.67500321e-02 4.15151119e-02 1.67500321e-02 2.25924715e-01
 2.94574741e-02 1.67501140e-02 6.62611544e-01 2.77259558e-01
 2.03546897e-01 2.48737317e-02 1.78484008e-01 2.28294209e-01
 1.03542246e-01 7.11804330e-02 3.12919974e-01 4.12980258e-01
 6.96752593e-02 1.35345915e-02 7.11804330e-02 1.24843106e-01
 4.24915135e-01 1.03253856e-01 1.50833204e-01 5.12362421e-01
 3.02332677e-02 6.03039801e-01 4.78656977e-01 5.06309159e-02
 4.24699523e-02 5.71912348e-01 3.48057933e-02 1.62799969e-01
 1.05808783e+00 6.74443096e-02 6.07735395e-01 5.80457807e-01
 3.07161927e-01 1.99210718e-01 1.19079910e-02 1.64055616e-01
 1.65795043e-01 3.48056480e-02 9.59631242e-03 3.48060653e-02
 1.19079910e-02 1.80258125e-01 1.66102678e-01 4.31250855e-02
 9.78434552e-03 7.89867416e-02 9.73365754e-02 4.36684527e-02
 2.37842843e-01 2.00707838e-01 4.84102853e-02 6.93746433e-02
 2.36980617e-02 4.12428156e-02 8.31179857e-01 2.85685241e-01
 4.55315299e-02 7.06709474e-02 6.64526299e-02 7.35005364e-02
 4.87512611e-02 2.13329300e-01 1.25755621e-02 1.55120641e-01
 6.09703995e-02 6.78462163e-02 5.91368899e-02 4.86240804e-01
 2.27057543e-02 3.89430448e-02 9.48780123e-03 1.39419302e-01
 2.97356620e-02 2.27057338e-02 6.92863688e-02 3.77946168e-01
 1.45121604e-01 3.55601534e-02 1.48302794e-01 7.37394169e-02
 6.30469769e-02 4.94515449e-01 3.56914073e-01 2.80014928e-02
 1.00016683e-01 2.04802319e-01 2.69081332e-02 1.37686223e-01
 2.54191551e-02 1.80631489e-01 4.84922417e-02 1.21301971e-02
 1.27052972e-02 4.21304703e-02 1.80461407e-01 1.35349303e-01
 3.14735174e-02 1.21294828e-02 1.56085253e-01 1.26504272e-01
 5.53056747e-02 3.26243564e-02 5.29439300e-02 7.22057978e-03
 6.53079391e-01 3.08450699e-01 2.31676176e-02 3.25478651e-02
 8.69420692e-02 9.28214192e-03 3.04145962e-01 2.31318891e-01
 8.10796693e-02 5.86915612e-02 1.46129280e-02 4.82529290e-02
 1.07959837e-01 1.20781869e-01 2.54190955e-02 2.45501101e-01
 7.58549497e-02 6.28445074e-02 6.36548877e-01 1.42513439e-01
 7.13917762e-02 7.22057978e-03 8.69445950e-02 1.58807307e-01
 7.44955754e-03 4.92555536e-02 2.97356006e-02 6.42705038e-02
 8.10795203e-02 9.59603339e-02 7.44955754e-03 5.29439300e-02
 2.56529246e-02 9.06486586e-02 2.43107211e-02 5.03581427e-02
 8.14235881e-02 6.28446043e-02 7.50188828e-02 1.44239934e-02
 1.16766077e-02 6.92804694e-01 4.84926850e-02 8.04703140e+00
 5.14916144e-02 6.15064576e-02 2.55975705e-02 2.55975928e-02
 3.71501669e-02 9.37484726e-02 6.43077418e-02 2.30012938e-01
 1.51642844e-01 3.13325785e-02 1.29375244e-02 3.69285010e-02
 3.40001844e-02 7.90737756e-03 9.90681425e-02 5.76890856e-02
 1.04429819e-01 1.00379307e-02 3.04145873e-01 4.61747460e-02
 9.17055309e-01 1.02734201e-01 1.01051882e-01 1.45134777e-01
 2.36854553e-02 7.44955754e-03 9.10618380e-02 6.57496378e-02
 8.18918794e-02 7.66885802e-02 9.93326008e-02 2.31083810e-01
 1.07621951e-02 6.27922341e-02 2.27848049e-02 1.04247704e-01
 5.00408523e-02 4.76685874e-02 2.04748828e-02 1.72993727e-02
 7.77824298e-02 2.54190918e-02 1.01119027e-01 1.00379577e-02
 2.13177070e-01 1.29374908e-02 1.11820614e-02 5.00408523e-02
 7.44955335e-03 7.45682642e-02 1.69157550e-01 1.28592523e-02
 7.14131445e-02 4.98314910e-02 1.16760142e-01 3.83974910e-02
 6.44649640e-02 2.54191235e-02 2.54190881e-02 3.69806848e-02
 5.05718775e-02 1.11820614e-02 7.44955754e-03 1.35448664e-01
 1.49700299e-01 7.64347389e-02 1.25214504e-02 3.63629460e-02
 1.40215773e-02 4.30352539e-02 3.54706421e-02 7.00488761e-02
 1.25214504e-02 2.30099205e-02 1.16766356e-02 1.22156795e-02
 1.01119019e-01 4.02340181e-02 6.37329966e-02 4.76363152e-02
 7.90737756e-03 1.13456007e-02 8.37678462e-02 2.55975835e-02
 4.81023267e-02 1.09951735e-01 2.22463645e-02 6.19285107e-02
 4.17745039e-02 8.12377110e-02 6.08151518e-02 7.10237503e-01
 6.08151034e-02 3.18751745e-02 2.65260309e-01 1.99116617e-01
 5.75202070e-02 1.77423656e-01 1.88320354e-02 1.69484228e-01
 1.99661031e-02 1.65507823e-01 3.71501669e-02 3.38525064e-02
 2.09594727e-01 2.01451741e-02 5.35894409e-02 7.31154308e-02
 5.34294806e-02 2.88965981e-02 3.19787413e-01 6.24306239e-02
 9.37484875e-02 4.47580367e-01 8.48314539e-02 2.96563469e-02
 3.90992947e-02 1.40215950e-02 6.94870949e-01 1.86643396e-02
 4.16598432e-02 2.55973060e-02 4.61747795e-02 6.00037873e-01
 5.25872372e-02 9.58912596e-02 1.51791321e-02 3.47837359e-02
 7.54335104e-03 7.54339388e-03 7.54339388e-03 1.87094491e-02
 7.15872720e-02 9.58912596e-02 7.54339388e-03 9.04147699e-02
 7.54339388e-03 7.46993050e-02 7.93505982e-02 6.76756203e-02
 2.73846179e-01 6.70610443e-02 5.29401377e-02 4.69314493e-02
 6.07266836e-02 2.10791528e-02 4.39261757e-02 1.51789980e-02
 7.22729638e-02 2.13421732e-01 2.95450896e-01 6.10834435e-02
 6.78716600e-02 6.78716451e-02 2.23882169e-01 4.80873175e-02
 7.54335104e-03 1.88322663e-02 7.54335104e-03 1.87095311e-02
 8.80223066e-02 1.16842845e-02 1.14369556e-01 8.23215861e-03
 9.58912596e-02 2.67333295e-02 8.23220797e-03 8.81482437e-02
 3.41636986e-02 4.72963266e-02 1.51791433e-02 3.02529037e-02
 6.92391545e-02 6.20366186e-02 7.54339388e-03 3.45906802e-02
 1.00812554e-01 1.16904087e-01 2.47645900e-02 7.90745858e-03
 1.09536119e-01 7.54339388e-03 8.32371134e-03 3.08800638e-01
 8.01260620e-02 9.01772548e-03 2.41645277e-01 4.32649367e-02
 1.51791181e-02 5.67372620e-01 9.81278066e-03 1.36280015e-01
 2.31156703e-02 2.03946307e-02 4.66669947e-02 3.74885462e-02
 3.87886353e-02 1.03378549e-01 4.71291952e-02 8.40280503e-02
 1.05852187e-02 1.35301240e-02 1.32014364e-01 7.54339388e-03
 1.51790762e-02 7.20736906e-02 7.63682229e-03 5.12886122e-02
 6.97993785e-02 2.03760732e-02 6.79671094e-02 1.62805215e-01
 4.43096086e-02 7.54339388e-03 2.34644756e-01 5.94893284e-02
 2.24185288e-02 1.67093307e-01 4.37367409e-02 4.37368266e-02
 4.37367819e-02 6.37689948e-01 6.93293987e-03 6.38445497e-01
 9.31199174e-03 1.17241159e-01 1.41326725e-01 6.93293987e-03
 2.33738385e-02 2.24186443e-02 4.99262027e-02 9.88245383e-03
 2.24186573e-02 7.13307336e-02 4.37367521e-02 2.24186424e-02
 6.93293987e-03 4.37367558e-02 4.37368266e-02 2.02562734e-02
 2.60793306e-02 4.37367819e-02 1.05729271e-02 3.79184037e-02
 3.23872082e-02 1.07852975e-02 2.04492398e-02 8.37043766e-03
 1.68763071e-01 5.96594587e-02 1.71933286e-02 5.49742952e-02
 1.05954289e-01 2.71556396e-02 6.74304664e-02 4.09422517e-02
 5.04974909e-02 4.83440869e-02 1.37153059e-01 4.37367558e-02
 9.31199174e-03 5.57919368e-02 1.74876928e-01 5.65661117e-02
 2.80967038e-02 1.62587389e-02 1.94095716e-01 8.75015464e-03
 4.31497060e-02 1.10552229e-01 1.57617003e-01 8.77893344e-03
 5.38093969e-02 1.08085815e-02 3.71851921e-02 9.78400744e-03
 1.33532109e-02 6.39120489e-02 9.78400744e-03 3.99318002e-02
 8.37043766e-03 2.89515015e-02 3.50800380e-02 5.13180085e-02
 2.21773125e-02 1.20059662e-02 8.06367770e-03 6.41247854e-02
 8.06369446e-03 1.20059662e-02 1.08276000e-02 3.76230367e-02
 8.19782019e-02 5.15693538e-02 1.08276000e-02 2.21772958e-02
 2.29383595e-02 2.81323314e-01 2.89131906e-02 2.04475392e-02
 3.76230031e-02 2.21773200e-02 8.45504925e-03 1.69490017e-02
 2.67043412e-02 2.54735738e-01 3.06643192e-02 8.77893344e-03
 1.61415815e-01 1.32141868e-02 9.78400744e-03 9.79228169e-02
 2.36968752e-02 2.76700288e-01 2.76358891e-02 8.45504925e-03
 4.34769951e-02 9.11328476e-03 5.33936471e-02 9.71228722e-03
 2.20389888e-02 7.03601658e-01 6.53718319e-03 1.69490017e-02
 2.24089652e-01 9.11328476e-03 2.00544119e-01 1.88787207e-02
 1.06422408e-02 6.37368262e-02 5.68243256e-03 4.54157770e-01
 1.37799243e-02 9.78400744e-03 1.76523868e-02 1.32196080e-02
 1.32196080e-02 1.05106551e-02 6.20961040e-02 2.21400745e-02
 5.68246376e-03 1.26668112e-02 7.34546185e-02 5.82294241e-02
 8.77762139e-02 1.62587389e-02 5.68246376e-03 8.55017081e-02
 1.06422408e-02 2.20389366e-02 6.10586964e-02 1.75976500e-01
 8.77761394e-02 6.11347742e-02 2.21400745e-02 4.86808047e-02
 6.53719204e-03 1.69490147e-02 2.20388956e-02 2.19464656e-02
 6.21467568e-02 5.25131300e-02 6.53719204e-03 4.93664593e-02
 6.53718319e-03 7.26696029e-02 7.41400868e-02 1.26666753e-02
 1.04667246e-02 4.02203143e-01 8.31610039e-02 6.32681139e-03
 7.11527646e-01 6.32681139e-03 6.32681139e-03 6.32681139e-03
 6.32681139e-03 6.32681139e-03 6.32681139e-03 6.32683747e-03
 1.47137288e-02 1.09711019e-02 2.52862051e-02 6.32681139e-03
 6.32681139e-03 6.32681139e-03 6.32681139e-03 6.32681139e-03
 6.32681139e-03 6.32681139e-03 6.32681139e-03 6.32681139e-03
 1.26807028e-02 6.32681139e-03 6.32681139e-03 1.71589345e-01
 6.32681139e-03 9.19053406e-02 7.03352392e-02 6.53719204e-03
 5.86790293e-02 6.94222152e-02 4.23194766e-01 4.23194766e-01
 6.41884506e-02 5.86788543e-02 6.53719204e-03 5.68246376e-03
 5.68243256e-03 7.72757903e-02 5.68246376e-03 4.06571291e-02
 1.16103776e-02 6.32681139e-03 1.62587296e-02 6.53719204e-03
 1.32195801e-02 6.53719204e-03 6.53718319e-03 4.76170443e-02
 6.53719204e-03 5.68246376e-03 6.53719204e-03 6.53719204e-03
 1.26666846e-02 5.68243256e-03 6.53719204e-03 5.68243256e-03
 6.53719204e-03 6.53719204e-03 6.53719204e-03 5.94573617e-02
 2.86623240e-02 2.05725357e-02 6.32681139e-03 4.13517803e-02
 8.67899507e-02 6.53718319e-03 5.68246376e-03 4.35313694e-02
 6.32681139e-03 2.78224219e-02 3.14410888e-02 5.88684855e-03
 6.53719204e-03 6.53719204e-03 3.45197581e-02 6.74962327e-02
 2.37520933e-02 6.53718319e-03 1.47137307e-02 9.33388527e-03
 5.68246376e-03 1.59518287e-01 6.32681139e-03 2.95768026e-02
 3.96741889e-02 6.32681139e-03 6.32681139e-03 1.47138098e-02
 9.33388527e-03 6.53718319e-03 3.02082419e-01 5.12685254e-02
 3.88881527e-02 6.74961358e-02 1.96627062e-02 4.50053215e-02
 4.50052284e-02 6.93239048e-02 1.17388340e-02 6.32681139e-03
 1.46723296e-02 5.54274321e-02 6.74962699e-02 2.11342834e-02
 1.53664686e-02 1.81450360e-02 6.23447401e-03 6.23447401e-03
 6.23447401e-03 6.23447401e-03 6.23447401e-03 1.33857774e-02
 6.29766509e-02 6.23447401e-03 6.23447401e-03 6.32681139e-03
 7.92211108e-03 6.32683747e-03 4.50051799e-02 5.82812279e-02
 9.35216099e-02 2.39670575e-02 1.17696285e-01 5.98682389e-02
 1.26804495e-02 1.83036719e-02 1.26805324e-02 6.32681139e-03
 4.50051799e-02 1.03724180e-02 5.19979699e-03 5.19979978e-03
 6.23447401e-03 1.03724180e-02 4.40015532e-02 2.69634090e-02
 1.99724641e-02 6.32681139e-03 6.23447401e-03 2.35910639e-02
 5.19979419e-03 5.99766662e-03 9.17712972e-03 2.30586845e-02
 1.33858211e-02 2.67761767e-01 7.18501816e-03 1.61764175e-01
 2.27660052e-02 9.17712972e-03 1.17936609e-02 1.02300756e-02
 9.10852756e-03 7.07282778e-03 4.84967083e-02 1.60995964e-02
 4.64192815e-02 9.17712972e-03 9.17712972e-03 9.17712972e-03
 7.35405507e-03 2.35910639e-02 9.17712972e-03 9.10852756e-03
 9.17712972e-03 9.17712972e-03 9.17712972e-03 2.39374079e-02
 1.02401022e-02 3.75863202e-02 5.26814312e-02 5.34683466e-02
 5.58477193e-02 2.76201144e-02 3.09445802e-02 6.88778698e-01
 9.21230856e-03 1.04038222e-02 6.24835398e-03 5.65522835e-02
 5.65523058e-02 9.10852756e-03 1.53506264e-01 1.54958978e-01
 9.19599924e-03 6.37896499e-03 2.78620794e-02 1.50297433e-01
 1.07096983e-02 1.07096983e-02 1.07096983e-02 6.68421201e-03
 6.91190967e-03 9.17272046e-02 1.27960667e-01 2.52387822e-01
 3.34522016e-02 5.42064710e-03 1.99251156e-02 6.37896499e-03
 1.62874050e-02 2.59881336e-02 6.87532406e-03 7.43360817e-02
 9.19599924e-03 1.54959649e-01 6.37896499e-03 2.59881262e-02
 5.42058563e-03 1.23136282e-01 1.07096983e-02 6.68417988e-03
 6.87532406e-03 2.39412468e-02 6.04874268e-02 6.68417988e-03
 6.68421201e-03 6.68417988e-03 1.22306891e-01 1.28659904e+00
 1.88054717e+00 1.07096983e-02 1.36414751e-01 6.68417988e-03
 5.61071858e-02 2.16862988e-02 7.87248552e-01 2.90207081e-02
 6.68417988e-03 7.15205120e-03 1.97473653e-02 9.43277590e-03
 5.07576942e-01 2.90207528e-02 2.01780722e-01 4.37075682e-02
 5.61870113e-02 2.90207583e-02 5.80619387e-02 6.52381852e-02
 3.18124369e-02 7.79766366e-02 2.23406013e-02 9.74409375e-03
 9.74403508e-03 2.09034577e-01 3.61943394e-01 1.82374269e-01
 2.90207528e-02 3.18124108e-02 2.90207528e-02 4.73074801e-03
 9.85524151e-03 9.85524151e-03 6.96763489e-03 7.08013251e-02
 3.96001339e-03 9.85524151e-03 4.73074801e-03 9.88313407e-02
 9.85524151e-03 9.85524151e-03 7.83405267e-03 2.09255312e-02
 6.97435811e-02 6.15716539e-02 9.85524151e-03 3.06680966e-02
 9.88313407e-02 9.85524151e-03 1.00650527e-02 2.09255312e-02
 3.80773540e-03 3.80773540e-03 1.40346318e-01 2.26099007e-02
 9.85524151e-03 2.26099566e-02 2.02985294e-02 7.18868077e-02
 1.38051137e-01 9.85524151e-03 2.66339093e-01 2.08791271e-02
 2.08791271e-02 8.78013223e-02 8.74224398e-03 2.99632084e-02
 1.00650527e-02 4.42498289e-02 6.71022618e-03 7.66214877e-02
 3.80355790e-02 7.66215548e-02 2.91532516e-01 4.53900360e-03
 3.80355306e-02 9.38638393e-03 9.38634947e-03 8.50052536e-01
 9.38638393e-03 5.81035465e-02 8.74224398e-03 7.46222585e-02
 3.14073525e-02 4.53900360e-03 3.14073525e-02 1.56866387e-01
 5.98860197e-02 1.52429730e-01 9.38638393e-03 4.23667394e-02
 2.29723398e-02 9.38638393e-03 6.44588321e-02 4.67993096e-02
 4.23667394e-02 4.53900360e-03 9.38638393e-03 2.90295959e-01
 9.38638393e-03 9.38634947e-03 9.38634947e-03 1.03039760e-02
 3.50305177e-02 1.03039760e-02 2.99907681e-02 1.03039760e-02
 3.28414217e-02 6.37120306e-02 7.88937286e-02 9.38638393e-03
 9.38634947e-03 2.71771941e-03 9.38638393e-03 5.17574310e-01
 2.99907681e-02 1.03039760e-02 2.71771941e-03 9.38638393e-03
 9.38638393e-03 2.13315897e-02 2.71771941e-03 9.38638393e-03
 6.01910846e-03 3.94209139e-02 7.11096404e-03 2.09418342e-01
 6.01913640e-03 9.38638393e-03 9.38638393e-03 2.13713851e-02
 7.23705590e-02 6.80117384e-02 6.80117384e-02 1.02160973e-02
 8.19915310e-02 9.48147848e-02 3.94392945e-02 3.38056654e-01
 6.80117384e-02 1.07921613e-02 6.80117384e-02 4.57268246e-02
 3.94392945e-02 6.80117384e-02 1.12916213e-02 7.11096404e-03
 5.01221083e-02 3.10374773e-03 1.15232170e-02 7.54416920e-03
 1.12150155e-01 1.36649963e-02 1.26267532e-02 1.26267020e-02
 4.40628342e-02 6.22642450e-02 1.26267532e-02 1.26267532e-02
 6.03417233e-02 7.18459934e-02 1.26267020e-02 1.26267532e-02
 1.26267020e-02 1.26267020e-02 6.22641891e-02 6.22640811e-02
 6.22642003e-02 6.22642599e-02 6.22641817e-02 5.27287573e-02
 6.22642189e-02 6.22642450e-02 1.26267020e-02 1.26267532e-02
 3.20369095e-01 1.18001603e-01 1.49682350e-02 6.22642525e-02
 1.23945484e-02 1.52995717e-02 5.84275834e-02 1.26267532e-02
 1.52995717e-02 1.52995717e-02 1.29452780e-01 8.51700753e-02
 8.51700753e-02 1.75729599e-02 8.51698890e-02 8.51700753e-02
 1.48953879e-02 8.51700529e-02]
2025-06-02 15:45:54,355 - DEBUG - Edge reconstruction errors: [ 5.264825  5.262099 44.25805  ... 13.35803   2.158983 13.35803 ]
2025-06-02 15:45:54,359 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154554_update_45.json
2025-06-02 15:45:54,360 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:45:54,381 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154554_update_45.pth and as latest_checkpoint.pth
2025-06-02 15:45:54,382 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.6266
2025-06-02 15:45:54,382 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:45:54,382 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.4980, MLP Score: 0.5031
2025-06-02 15:45:54,382 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.7129, MLP Score: 0.5033
2025-06-02 15:45:54,382 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.8910, MLP Score: 0.5014
2025-06-02 15:45:54,382 - WARNING -   Node ID: 192.168.209.130, Recon Error: 1.0581, MLP Score: 0.5055
2025-06-02 15:45:54,382 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.0470, MLP Score: 0.5031
2025-06-02 15:45:54,382 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:45:54,383 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2581, MLP Score: 0.8933
2025-06-02 15:45:54,383 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9607, MLP Score: 0.7992
2025-06-02 15:45:54,383 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0602, MLP Score: 0.7991
2025-06-02 15:45:54,383 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7590, MLP Score: 0.5589
2025-06-02 15:45:54,383 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7583, MLP Score: 0.4579
2025-06-02 15:45:54,383 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-02 15:45:54,383 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 15:45:54,383 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:45:54,383 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 15:45:54,411 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:45:54,437 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 15:45:54,437 - INFO - Processing node updates/additions.
2025-06-02 15:45:54,445 - INFO - Processing edge updates/additions.
2025-06-02 15:45:54,458 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:45:54,459 - INFO - Finished updating NetworkX graph.
2025-06-02 15:45:54,460 - DEBUG - Updated graph - Nodes: 985, Edges: 2150
2025-06-02 15:45:54,460 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:45:54,461 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:45:54,471 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-02 15:45:54,473 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:45:54,473 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-02 15:45:54,475 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-02 15:45:54,477 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:45:54,482 - DEBUG - Initial edge attributes tensor shape: torch.Size([2150, 10])
2025-06-02 15:45:54,484 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:45:54,484 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2150, 10])
2025-06-02 15:45:54,484 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:45:54,485 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:45:54,486 - INFO - Updated main graph to 985 nodes and 2150 edges.
2025-06-02 15:45:54,486 - INFO - Performing online update...
2025-06-02 15:45:54,486 - INFO - Starting online update for 25 steps.
2025-06-02 15:45:54,486 - DEBUG - Updated RunningStats: new_mean=0.9448048532339003, new_var=26400000000161.727, new_n=2670
2025-06-02 15:45:54,486 - DEBUG - Updated RunningStats: new_mean=0.9425044059362168, new_var=26700000000018.18, new_n=2700
2025-06-02 15:45:54,487 - DEBUG - Updated RunningStats: new_mean=44.772114071386206, new_var=8800000186914.152, new_n=890
2025-06-02 15:45:54,487 - DEBUG - Updated RunningStats: new_mean=44.77169187834093, new_var=8900000173894.514, new_n=900
2025-06-02 15:45:54,487 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:45:54,487 - DEBUG - Online update step: 1/25
2025-06-02 15:45:54,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:54,650 - DEBUG - Node anomaly scores shape: torch.Size([18742, 1])
2025-06-02 15:45:54,656 - DEBUG - Edge anomaly scores shape: torch.Size([39001, 1])
2025-06-02 15:45:54,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:54,825 - DEBUG - Step 1: Loss=0.6722
2025-06-02 15:45:54,825 - DEBUG - Online update step: 2/25
2025-06-02 15:45:54,828 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:55,005 - DEBUG - Node anomaly scores shape: torch.Size([19552, 1])
2025-06-02 15:45:55,011 - DEBUG - Edge anomaly scores shape: torch.Size([40854, 1])
2025-06-02 15:45:55,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:55,235 - DEBUG - Step 2: Loss=0.6766
2025-06-02 15:45:55,235 - DEBUG - Online update step: 3/25
2025-06-02 15:45:55,239 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:55,356 - DEBUG - Node anomaly scores shape: torch.Size([20557, 1])
2025-06-02 15:45:55,362 - DEBUG - Edge anomaly scores shape: torch.Size([43186, 1])
2025-06-02 15:45:55,363 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:55,584 - DEBUG - Step 3: Loss=0.6940
2025-06-02 15:45:55,585 - DEBUG - Online update step: 4/25
2025-06-02 15:45:55,590 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:55,715 - DEBUG - Node anomaly scores shape: torch.Size([17389, 1])
2025-06-02 15:45:55,719 - DEBUG - Edge anomaly scores shape: torch.Size([36088, 1])
2025-06-02 15:45:55,720 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:55,890 - DEBUG - Step 4: Loss=0.6645
2025-06-02 15:45:55,891 - DEBUG - Online update step: 5/25
2025-06-02 15:45:55,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:56,010 - DEBUG - Node anomaly scores shape: torch.Size([20234, 1])
2025-06-02 15:45:56,015 - DEBUG - Edge anomaly scores shape: torch.Size([42622, 1])
2025-06-02 15:45:56,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:56,230 - DEBUG - Step 5: Loss=0.6786
2025-06-02 15:45:56,230 - DEBUG - Online update step: 6/25
2025-06-02 15:45:56,237 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:56,340 - DEBUG - Node anomaly scores shape: torch.Size([18384, 1])
2025-06-02 15:45:56,345 - DEBUG - Edge anomaly scores shape: torch.Size([38372, 1])
2025-06-02 15:45:56,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:56,541 - DEBUG - Step 6: Loss=0.6986
2025-06-02 15:45:56,541 - DEBUG - Online update step: 7/25
2025-06-02 15:45:56,547 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:56,687 - DEBUG - Node anomaly scores shape: torch.Size([19459, 1])
2025-06-02 15:45:56,694 - DEBUG - Edge anomaly scores shape: torch.Size([40826, 1])
2025-06-02 15:45:56,696 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:57,005 - DEBUG - Step 7: Loss=0.6677
2025-06-02 15:45:57,005 - DEBUG - Online update step: 8/25
2025-06-02 15:45:57,012 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:57,187 - DEBUG - Node anomaly scores shape: torch.Size([18846, 1])
2025-06-02 15:45:57,192 - DEBUG - Edge anomaly scores shape: torch.Size([39226, 1])
2025-06-02 15:45:57,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:57,450 - DEBUG - Step 8: Loss=0.6753
2025-06-02 15:45:57,450 - DEBUG - Online update step: 9/25
2025-06-02 15:45:57,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:57,544 - DEBUG - Node anomaly scores shape: torch.Size([17818, 1])
2025-06-02 15:45:57,550 - DEBUG - Edge anomaly scores shape: torch.Size([37092, 1])
2025-06-02 15:45:57,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:57,766 - DEBUG - Step 9: Loss=0.6928
2025-06-02 15:45:57,767 - DEBUG - Online update step: 10/25
2025-06-02 15:45:57,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:57,893 - DEBUG - Node anomaly scores shape: torch.Size([20374, 1])
2025-06-02 15:45:57,901 - DEBUG - Edge anomaly scores shape: torch.Size([42737, 1])
2025-06-02 15:45:57,903 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:58,296 - DEBUG - Step 10: Loss=0.6619
2025-06-02 15:45:58,297 - DEBUG - Online update step: 11/25
2025-06-02 15:45:58,305 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:58,486 - DEBUG - Node anomaly scores shape: torch.Size([19462, 1])
2025-06-02 15:45:58,491 - DEBUG - Edge anomaly scores shape: torch.Size([40710, 1])
2025-06-02 15:45:58,492 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:58,723 - DEBUG - Step 11: Loss=0.6770
2025-06-02 15:45:58,724 - DEBUG - Online update step: 12/25
2025-06-02 15:45:58,727 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:58,823 - DEBUG - Node anomaly scores shape: torch.Size([18061, 1])
2025-06-02 15:45:58,826 - DEBUG - Edge anomaly scores shape: torch.Size([37628, 1])
2025-06-02 15:45:58,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:59,014 - DEBUG - Step 12: Loss=0.6958
2025-06-02 15:45:59,014 - DEBUG - Online update step: 13/25
2025-06-02 15:45:59,017 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:59,128 - DEBUG - Node anomaly scores shape: torch.Size([18104, 1])
2025-06-02 15:45:59,134 - DEBUG - Edge anomaly scores shape: torch.Size([37568, 1])
2025-06-02 15:45:59,135 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:59,333 - DEBUG - Step 13: Loss=0.6668
2025-06-02 15:45:59,333 - DEBUG - Online update step: 14/25
2025-06-02 15:45:59,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:59,500 - DEBUG - Node anomaly scores shape: torch.Size([18700, 1])
2025-06-02 15:45:59,507 - DEBUG - Edge anomaly scores shape: torch.Size([39110, 1])
2025-06-02 15:45:59,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:45:59,785 - DEBUG - Step 14: Loss=0.6726
2025-06-02 15:45:59,785 - DEBUG - Online update step: 15/25
2025-06-02 15:45:59,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:45:59,884 - DEBUG - Node anomaly scores shape: torch.Size([19873, 1])
2025-06-02 15:45:59,889 - DEBUG - Edge anomaly scores shape: torch.Size([41755, 1])
2025-06-02 15:45:59,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:00,088 - DEBUG - Step 15: Loss=0.6892
2025-06-02 15:46:00,089 - DEBUG - Online update step: 16/25
2025-06-02 15:46:00,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:00,213 - DEBUG - Node anomaly scores shape: torch.Size([18544, 1])
2025-06-02 15:46:00,217 - DEBUG - Edge anomaly scores shape: torch.Size([38833, 1])
2025-06-02 15:46:00,219 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:00,408 - DEBUG - Step 16: Loss=0.6600
2025-06-02 15:46:00,408 - DEBUG - Online update step: 17/25
2025-06-02 15:46:00,415 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:00,511 - DEBUG - Node anomaly scores shape: torch.Size([17875, 1])
2025-06-02 15:46:00,516 - DEBUG - Edge anomaly scores shape: torch.Size([37305, 1])
2025-06-02 15:46:00,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:00,741 - DEBUG - Step 17: Loss=0.6756
2025-06-02 15:46:00,742 - DEBUG - Online update step: 18/25
2025-06-02 15:46:00,748 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:00,866 - DEBUG - Node anomaly scores shape: torch.Size([18996, 1])
2025-06-02 15:46:00,872 - DEBUG - Edge anomaly scores shape: torch.Size([39596, 1])
2025-06-02 15:46:00,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:01,102 - DEBUG - Step 18: Loss=0.6934
2025-06-02 15:46:01,102 - DEBUG - Online update step: 19/25
2025-06-02 15:46:01,106 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:01,198 - DEBUG - Node anomaly scores shape: torch.Size([19427, 1])
2025-06-02 15:46:01,202 - DEBUG - Edge anomaly scores shape: torch.Size([40751, 1])
2025-06-02 15:46:01,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:01,526 - DEBUG - Step 19: Loss=0.6637
2025-06-02 15:46:01,527 - DEBUG - Online update step: 20/25
2025-06-02 15:46:01,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:01,632 - DEBUG - Node anomaly scores shape: torch.Size([18724, 1])
2025-06-02 15:46:01,636 - DEBUG - Edge anomaly scores shape: torch.Size([38950, 1])
2025-06-02 15:46:01,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:01,848 - DEBUG - Step 20: Loss=0.6704
2025-06-02 15:46:01,849 - DEBUG - Online update step: 21/25
2025-06-02 15:46:01,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:01,947 - DEBUG - Node anomaly scores shape: torch.Size([18301, 1])
2025-06-02 15:46:01,951 - DEBUG - Edge anomaly scores shape: torch.Size([38174, 1])
2025-06-02 15:46:01,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:02,153 - DEBUG - Step 21: Loss=0.6873
2025-06-02 15:46:02,153 - DEBUG - Online update step: 22/25
2025-06-02 15:46:02,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:02,238 - DEBUG - Node anomaly scores shape: torch.Size([17943, 1])
2025-06-02 15:46:02,242 - DEBUG - Edge anomaly scores shape: torch.Size([37489, 1])
2025-06-02 15:46:02,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:02,538 - DEBUG - Step 22: Loss=0.6579
2025-06-02 15:46:02,538 - DEBUG - Online update step: 23/25
2025-06-02 15:46:02,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:02,707 - DEBUG - Node anomaly scores shape: torch.Size([19065, 1])
2025-06-02 15:46:02,712 - DEBUG - Edge anomaly scores shape: torch.Size([39869, 1])
2025-06-02 15:46:02,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:02,940 - DEBUG - Step 23: Loss=0.6726
2025-06-02 15:46:02,940 - DEBUG - Online update step: 24/25
2025-06-02 15:46:02,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:03,035 - DEBUG - Node anomaly scores shape: torch.Size([17085, 1])
2025-06-02 15:46:03,041 - DEBUG - Edge anomaly scores shape: torch.Size([35475, 1])
2025-06-02 15:46:03,043 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:03,253 - DEBUG - Step 24: Loss=0.6910
2025-06-02 15:46:03,253 - DEBUG - Online update step: 25/25
2025-06-02 15:46:03,259 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:03,376 - DEBUG - Node anomaly scores shape: torch.Size([18970, 1])
2025-06-02 15:46:03,382 - DEBUG - Edge anomaly scores shape: torch.Size([39592, 1])
2025-06-02 15:46:03,384 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:03,624 - DEBUG - Step 25: Loss=0.6616
2025-06-02 15:46:03,624 - INFO - Online update finished. Average loss: 0.6767, Learning rate: 0.001000
2025-06-02 15:46:03,626 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], current edge mean: [ 3.1049860e-09  4.5571396e+02  0.0000000e+00  0.0000000e+00
  3.5485557e-09  5.7664029e-09 -3.9921249e-09  3.5485557e-09
 -1.7742778e-09 -1.7742778e-09]
2025-06-02 15:46:03,627 - DEBUG - Node drift difference: 0.0114, Edge drift difference: 0.0015
2025-06-02 15:46:03,629 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], edge=[ 3.1049860e-09  4.5571396e+02  0.0000000e+00  0.0000000e+00
  3.5485557e-09  5.7664029e-09 -3.9921249e-09  3.5485557e-09
 -1.7742778e-09 -1.7742778e-09]
2025-06-02 15:46:03,630 - DEBUG - Updated reference std: node=[0.         0.         1.000508   1.000508   0.         0.
 0.         1.0005081  1.0005081  1.0005081  1.000508   1.000508
 0.9526825  0.2752198  0.36361656 0.57165736 1.000508   3.002603
 2.8995261  1.4748815  0.36361656 0.22303854 1.000508   1.0005081
 0.         0.         0.         0.         1.000508   1.000508  ], edge=[  1.0002327 440.33954     0.          0.          1.0002327   1.0002327
   1.0002326   1.0002326   1.0002326   1.0002326]
2025-06-02 15:46:03,630 - INFO - Online update complete. Loss: 0.6767
2025-06-02 15:46:03,631 - INFO - Running anomaly detection...
2025-06-02 15:46:03,631 - INFO - Starting anomaly detection.
2025-06-02 15:46:03,660 - DEBUG - Node reconstruction errors: [3.48839194e-01 7.95364022e-01 2.36051083e+00 2.25901697e-02
 1.11403815e-01 4.25576568e-02 1.61207426e+00 2.14321520e-02
 2.14321520e-02 7.57304206e-02 2.14320831e-02 5.89206852e-02
 4.12820101e+00 7.02723324e-01 1.28801903e-02 6.06082417e-02
 1.37360170e-01 6.06083386e-02 4.29874837e-01 5.87994345e-02
 3.16955782e-02 1.28801903e-02 1.94250107e-01 1.25693858e-01
 1.42570157e-02 3.59069593e-02 1.42570930e-02 1.98960170e-01
 2.16671620e-02 1.42570930e-02 5.24704933e-01 2.65483886e-01
 1.66683137e-01 2.34560780e-02 1.53635725e-01 1.92182675e-01
 9.06868130e-02 5.87992817e-02 2.73951232e-01 3.69028002e-01
 6.61895424e-02 1.15779201e-02 5.87992817e-02 1.15043588e-01
 3.98916274e-01 8.24940577e-02 1.38750106e-01 4.04995650e-01
 2.20146533e-02 5.40981591e-01 3.43402416e-01 4.45330627e-02
 3.67074423e-02 4.17432457e-01 2.76314802e-02 1.38263255e-01
 9.48429823e-01 5.56526519e-02 4.44131792e-01 4.27316725e-01
 2.84750432e-01 1.72116891e-01 1.03504006e-02 1.33987695e-01
 1.30577624e-01 2.76315324e-02 8.50726292e-03 2.76317727e-02
 1.03504006e-02 1.56167269e-01 1.38441816e-01 3.91098149e-02
 9.71852709e-03 4.99148220e-02 1.08647868e-01 3.87008190e-02
 2.13444769e-01 1.64341748e-01 8.84151831e-02 6.19870164e-02
 2.23137848e-02 3.59948315e-02 7.99909711e-01 2.39913076e-01
 3.73820029e-02 1.04935661e-01 6.44860640e-02 5.20441495e-02
 3.81039158e-02 1.99457332e-01 1.19388020e-02 1.31211981e-01
 5.91391586e-02 4.96206358e-02 1.04299501e-01 3.81206870e-01
 2.14076117e-02 2.98023541e-02 8.65111966e-03 1.16952784e-01
 2.69047655e-02 2.14075241e-02 6.30619749e-02 3.57076913e-01
 1.24513455e-01 2.88279485e-02 1.33348539e-01 6.07848056e-02
 6.05167598e-02 4.50858533e-01 3.13743860e-01 2.63728108e-02
 7.15057701e-02 1.67296514e-01 2.47512497e-02 1.17073275e-01
 2.31815688e-02 1.62249297e-01 3.63875702e-02 9.08137579e-03
 1.22595429e-02 3.74123082e-02 1.58116832e-01 1.15993522e-01
 1.78917665e-02 9.08103399e-03 1.43375233e-01 1.18028797e-01
 3.98091339e-02 2.88444683e-02 4.58877794e-02 7.27313431e-03
 6.19625509e-01 2.73478776e-01 2.10446324e-02 2.58699581e-02
 8.12752992e-02 8.18265881e-03 3.16491693e-01 1.81320027e-01
 6.78709745e-02 5.74768372e-02 1.40397642e-02 4.02506106e-02
 9.02774036e-02 1.02419950e-01 2.31815800e-02 2.48924285e-01
 6.40168041e-02 4.99764122e-02 5.63376963e-01 1.18684046e-01
 6.91556409e-02 7.27313431e-03 6.42914027e-02 1.39193252e-01
 7.66728027e-03 4.00503464e-02 2.69048102e-02 5.84260710e-02
 6.78709745e-02 7.77978599e-02 7.66728027e-03 4.58877794e-02
 2.30546352e-02 7.07947537e-02 2.11651716e-02 4.44913022e-02
 6.71638474e-02 4.99769300e-02 6.73980862e-02 1.09519446e-02
 1.10295061e-02 5.54023921e-01 3.63877639e-02 8.31061459e+00
 4.53296117e-02 4.84083444e-02 2.29064394e-02 2.29064804e-02
 2.97779851e-02 8.90332609e-02 5.55131175e-02 2.02143416e-01
 1.34349674e-01 2.65182499e-02 1.26476139e-02 3.19877490e-02
 2.67353170e-02 7.40933642e-02 8.76919404e-02 6.37504235e-02
 8.82078856e-02 1.00810798e-02 3.16492021e-01 3.95689681e-02
 8.57423782e-01 9.00846198e-02 6.98629469e-02 1.26203641e-01
 2.11102962e-02 7.66728027e-03 6.46221116e-02 4.67827991e-02
 6.03888370e-02 6.79335669e-02 8.44959766e-02 2.08158553e-01
 9.98493843e-03 6.11275211e-02 2.01965086e-02 8.76364708e-02
 4.24062945e-02 4.09764871e-02 1.22422250e-02 1.65955015e-02
 5.56448922e-02 2.31815577e-02 9.38750952e-02 8.80267844e-02
 1.87418163e-01 1.26476139e-02 1.06020402e-02 4.24063280e-02
 7.66728027e-03 4.60411794e-02 1.50532722e-01 1.27276890e-02
 6.87974766e-02 4.18310091e-02 1.02337047e-01 3.03172078e-02
 4.62817214e-02 2.31815912e-02 2.31815968e-02 3.06046400e-02
 4.63435054e-02 1.06020402e-02 7.66728027e-03 1.20226465e-01
 1.31541014e-01 5.44224344e-02 1.17305173e-02 2.28935946e-02
 1.33978324e-02 2.79913954e-02 3.10598370e-02 6.09520264e-02
 1.17305173e-02 1.86182018e-02 1.10295061e-02 1.16019798e-02
 9.38751400e-02 3.41361500e-02 4.70000729e-02 4.08925824e-02
 7.79889757e-03 1.06515763e-02 7.39282444e-02 2.29064990e-02
 4.65930626e-02 1.06206849e-01 2.09957883e-02 4.98415902e-02
 6.74244314e-02 8.93881619e-02 4.88038734e-02 5.69186807e-01
 4.88037728e-02 2.43627708e-02 2.40835860e-01 1.74669087e-01
 5.14826216e-02 1.60104841e-01 1.61419492e-02 1.49395376e-01
 1.88320111e-02 1.41768396e-01 2.97779851e-02 2.78150328e-02
 1.81701973e-01 1.88776460e-02 4.79930639e-02 6.81976601e-02
 3.16404253e-02 2.75496561e-02 2.96416342e-01 5.91129698e-02
 8.90332609e-02 4.04791743e-01 9.18205306e-02 2.77994610e-02
 4.52229269e-02 1.33978324e-02 6.74513698e-01 1.73348971e-02
 3.72026451e-02 2.29065176e-02 3.95690352e-02 5.63155234e-01
 4.64817435e-02 8.48784149e-02 1.26516540e-02 2.30384339e-02
 6.54287310e-03 6.54287310e-03 6.54287310e-03 1.57709587e-02
 6.37454540e-02 8.48784968e-02 6.54287310e-03 6.48440644e-02
 6.54287310e-03 6.16146736e-02 6.36281595e-02 5.98681942e-02
 2.63102680e-01 6.44595101e-02 4.44871336e-02 4.02134471e-02
 5.20497710e-02 1.69307198e-02 2.58277170e-02 1.26516009e-02
 5.79896942e-02 1.87318504e-01 2.54148453e-01 5.26422746e-02
 6.54325187e-02 6.54325113e-02 2.21373737e-01 4.08172347e-02
 6.54287310e-03 1.61419492e-02 6.54287310e-03 1.57708619e-02
 7.03372806e-02 1.11852875e-02 1.00542799e-01 7.52452528e-03
 8.48784149e-02 2.42904015e-02 7.52452528e-03 6.14566207e-02
 2.62490455e-02 3.47273387e-02 1.26516167e-02 2.89522242e-02
 6.04062341e-02 5.53190783e-02 6.54287310e-03 3.06486916e-02
 7.13243186e-02 9.50138867e-02 2.25635450e-02 7.79889757e-03
 9.67207924e-02 6.54287729e-03 7.30101159e-03 2.87624806e-01
 6.89908341e-02 7.53368391e-03 2.60175973e-01 3.12833153e-02
 1.26516409e-02 4.58646834e-01 9.59636550e-03 1.24423623e-01
 2.06782874e-02 1.81545075e-02 4.19703908e-02 2.69227736e-02
 2.11861394e-02 7.36140311e-02 3.53082344e-02 6.67219833e-02
 1.00275073e-02 1.09096719e-02 1.12602986e-01 6.54287310e-03
 1.26516270e-02 6.04517236e-02 7.04629626e-03 4.64933403e-02
 6.02512211e-02 1.08854929e-02 5.55111915e-02 1.50651917e-01
 3.57780792e-02 6.54287310e-03 2.02364296e-01 4.39572260e-02
 1.93411540e-02 1.41854674e-01 3.45844552e-02 3.45844701e-02
 3.45844142e-02 4.72023368e-01 5.91939455e-03 5.34676433e-01
 6.01955280e-02 1.07029788e-01 1.22512713e-01 5.91936987e-03
 1.79774649e-02 1.93412099e-02 3.35232839e-02 8.09906982e-03
 1.93413012e-02 5.87308742e-02 3.45844142e-02 1.93411540e-02
 5.91939455e-03 3.45843919e-02 3.45843919e-02 1.88429914e-02
 2.38550138e-02 3.45844142e-02 1.09319329e-01 3.51779424e-02
 2.54182909e-02 9.37870517e-03 1.78404450e-02 7.33354129e-03
 1.47993252e-01 4.77729104e-02 1.43211754e-02 4.83622067e-02
 9.77164134e-02 2.69829072e-02 5.79517148e-02 3.22685614e-02
 3.87067907e-02 4.05585989e-02 1.15109116e-01 3.45843919e-02
 8.36893078e-03 4.80146334e-02 1.53345197e-01 5.11928797e-02
 2.66575497e-02 1.23700285e-02 2.08258286e-01 9.02516674e-03
 3.99372391e-02 8.13544542e-02 1.28562406e-01 7.23658269e-03
 4.47015166e-02 9.03926231e-03 2.38655284e-02 9.20082163e-03
 1.12626357e-02 5.77103943e-02 9.20082163e-03 3.07093319e-02
 7.33354129e-03 2.38766633e-02 3.25338505e-02 3.84496041e-02
 1.93711035e-02 1.04946010e-02 7.01801293e-03 6.17444329e-02
 7.01801293e-03 1.04946513e-02 1.03038568e-02 3.30876186e-02
 7.42317960e-02 4.33284119e-02 1.03038568e-02 1.93711407e-02
 1.50005482e-02 2.59693474e-01 3.97873633e-02 1.78391971e-02
 3.30876373e-02 1.93711035e-02 8.33859853e-03 1.43772820e-02
 2.45390832e-02 2.28187531e-01 2.87811942e-02 7.23662786e-03
 1.39678568e-01 1.33190108e-02 9.20082163e-03 9.00523886e-02
 2.11623628e-02 2.54953176e-01 2.07167864e-02 8.33856221e-03
 3.93071510e-02 9.18193813e-03 4.26830798e-02 8.50236695e-03
 1.87638737e-02 5.48278570e-01 5.42795472e-03 1.43772522e-02
 2.41355926e-01 9.18196421e-03 2.13746682e-01 1.78715419e-02
 1.00215310e-02 6.00626841e-02 5.01542399e-03 4.26792890e-01
 1.13331405e-02 9.20082163e-03 1.63630564e-02 1.00158723e-02
 1.00159002e-02 1.07513638e-02 7.12415427e-02 2.13417523e-02
 5.01542399e-03 9.61371139e-03 6.60038143e-02 5.26864789e-02
 7.63252974e-02 1.23700639e-02 5.01542399e-03 7.20611066e-02
 1.00215310e-02 1.87638197e-02 5.05654849e-02 1.60389096e-01
 7.63253942e-02 5.18660434e-02 2.13417057e-02 2.85036806e-02
 5.42795472e-03 1.43772522e-02 1.87638197e-02 1.86912548e-02
 5.90612963e-02 4.27322574e-02 5.42795472e-03 4.24495190e-02
 5.42795472e-03 6.44008815e-02 7.66154602e-02 9.61368904e-03
 8.17095675e-03 3.67507368e-01 6.92942962e-02 5.05389273e-03
 6.80626631e-01 5.05386433e-03 5.05389273e-03 5.05389273e-03
 5.05389273e-03 5.05389273e-03 5.05389273e-03 5.05389273e-03
 1.07646668e-02 8.26959126e-03 2.22277530e-02 5.05386433e-03
 5.05389273e-03 5.05389273e-03 5.05389273e-03 5.05386433e-03
 5.05389273e-03 5.05389273e-03 5.05389273e-03 5.05389273e-03
 9.13666654e-03 5.05386433e-03 5.05389273e-03 1.48728788e-01
 5.05386433e-03 8.11010525e-02 6.97463900e-02 5.42795472e-03
 6.05265386e-02 6.01000227e-02 3.78768951e-01 3.78768951e-01
 5.54383025e-02 6.05265386e-02 5.42795472e-03 5.01542399e-03
 5.01542399e-03 6.93875626e-02 5.01542399e-03 3.83074731e-02
 4.00993004e-02 5.05389273e-03 1.23700285e-02 5.42793376e-03
 1.00158863e-02 5.42793376e-03 5.42795472e-03 4.32822369e-02
 5.42795472e-03 5.01538254e-03 5.42795472e-03 5.42795472e-03
 8.82182941e-02 5.01542399e-03 5.42795472e-03 5.01542399e-03
 5.42795472e-03 5.42795472e-03 5.42795472e-03 5.02467640e-02
 1.64407156e-02 1.75675768e-02 5.05389273e-03 2.91626807e-02
 8.78129229e-02 5.42795472e-03 5.01542399e-03 3.06991804e-02
 5.05389273e-03 2.58643292e-02 2.44863573e-02 5.48434164e-03
 5.42795472e-03 5.42795472e-03 3.03206760e-02 5.67807928e-02
 2.04964988e-02 5.42795472e-03 1.07648373e-02 9.05345939e-03
 5.01538254e-03 1.39977530e-01 5.05389273e-03 2.29056086e-02
 2.53831781e-02 5.05389273e-03 5.05389273e-03 1.07647339e-02
 9.05339699e-03 5.42795472e-03 3.10688138e-01 3.01055890e-02
 2.56715212e-02 5.67807928e-02 1.91999897e-02 3.48294526e-02
 3.48295122e-02 6.92019165e-02 1.19871544e-02 5.05389273e-03
 1.08277258e-02 4.58674580e-02 5.67807928e-02 1.77303571e-02
 1.53324166e-02 1.79567300e-02 4.78271255e-03 4.78271255e-03
 4.78271255e-03 4.78271255e-03 4.78271255e-03 9.30578355e-03
 4.92775179e-02 4.78271255e-03 4.78271255e-03 5.05389273e-03
 7.81225087e-03 5.05389273e-03 3.48295122e-02 4.31831516e-02
 8.03873986e-02 2.17752531e-02 1.02308862e-01 3.75834256e-02
 9.13662836e-03 1.73387043e-02 9.13664419e-03 5.05386433e-03
 3.48294526e-02 9.70314257e-03 4.44178889e-03 4.44178795e-03
 4.78271255e-03 9.70314257e-03 3.40787359e-02 2.42211055e-02
 1.91450715e-02 5.05386433e-03 4.78271255e-03 2.28923429e-02
 4.44184290e-03 5.48526496e-02 8.38585198e-03 2.23372299e-02
 9.30576492e-03 2.44430438e-01 7.57873338e-03 1.40817150e-01
 1.90848988e-02 8.38587806e-03 8.95739626e-03 9.37313680e-03
 8.10282212e-03 7.58690713e-03 3.69103998e-02 1.58760138e-02
 3.55888084e-02 8.38587806e-03 8.38587806e-03 8.38587806e-03
 7.10130157e-03 2.28923429e-02 8.38587806e-03 8.10282212e-03
 8.38587806e-03 8.38587806e-03 8.38587806e-03 1.99378431e-02
 9.14892182e-03 3.34047638e-02 3.82234529e-02 4.48281579e-02
 4.73859496e-02 2.67974604e-02 1.72132049e-02 5.15331328e-01
 7.92988855e-03 9.03298240e-03 6.78971922e-03 6.96932822e-02
 4.01745178e-02 8.10282212e-03 1.24331065e-01 1.47791594e-01
 7.93026946e-03 4.46043815e-03 2.55743079e-02 1.18950717e-01
 9.01870523e-03 9.01870523e-03 9.01871268e-03 4.46919026e-03
 6.08042954e-03 8.36042389e-02 1.20436400e-01 2.63197362e-01
 2.93226950e-02 5.78142377e-03 1.39374416e-02 4.46043815e-03
 1.15060210e-02 2.15132516e-02 6.28083339e-03 5.95760494e-02
 7.93026946e-03 1.47792682e-01 4.46043815e-03 2.15132441e-02
 5.78136183e-03 1.09191172e-01 9.01870523e-03 4.46919026e-03
 6.28086831e-03 1.69998929e-02 4.28208001e-02 4.46919026e-03
 4.46919026e-03 4.46921820e-03 1.04071870e-01 1.18135405e+00
 1.73246920e+00 9.01870523e-03 1.21362820e-01 4.46919026e-03
 4.61796634e-02 1.39978407e-02 6.11131787e-01 2.01602019e-02
 4.46919026e-03 4.61399881e-03 1.25308698e-02 7.85321929e-03
 4.68829662e-01 2.01602019e-02 1.29250273e-01 3.78996953e-02
 3.45284231e-02 2.01602019e-02 4.34385985e-02 4.57312353e-02
 2.44637411e-02 4.15265597e-02 1.49816154e-02 7.80023448e-03
 7.80026102e-03 1.75825596e-01 3.16635281e-01 1.56916365e-01
 2.01602019e-02 2.44637392e-02 2.01602019e-02 4.75323619e-03
 7.94826914e-03 7.94827659e-03 5.94503758e-03 4.74122427e-02
 5.02529135e-03 7.94826914e-03 4.75329719e-03 8.71881992e-02
 7.94827659e-03 7.94826914e-03 4.88307094e-03 1.52597260e-02
 4.82670106e-02 5.14531247e-02 7.94826914e-03 2.57864408e-02
 8.71881992e-02 7.94826914e-03 8.23408645e-03 1.39271831e-02
 4.45654476e-03 4.45655314e-03 1.10067107e-01 1.58735532e-02
 7.94827659e-03 1.58735532e-02 1.35468831e-02 5.98555207e-02
 1.11430436e-01 7.94827659e-03 2.45851532e-01 1.41111743e-02
 1.41111044e-02 6.54476956e-02 5.27633727e-03 2.19065491e-02
 8.23406223e-03 3.70624289e-02 6.00671768e-03 5.32242171e-02
 2.83092912e-02 5.32242171e-02 2.95972168e-01 4.64927452e-03
 2.83093099e-02 5.80282230e-03 5.80282230e-03 6.43176913e-01
 5.80279063e-03 4.68694679e-02 5.27631352e-03 5.18724248e-02
 2.05418356e-02 4.64929920e-03 2.05418356e-02 1.38535395e-01
 4.77185324e-02 1.24219656e-01 5.80282230e-03 1.17290877e-02
 1.78685226e-02 5.80282230e-03 4.70769852e-02 4.59114648e-02
 3.78585011e-02 4.64927452e-03 5.80282230e-03 2.84121513e-01
 4.18094080e-03 1.88849606e-02 5.80279063e-03 8.61337408e-03
 2.41983570e-02 8.61337408e-03 1.88849606e-02 8.61344300e-03
 2.74768155e-02 5.51435389e-02 5.82775660e-02 5.80279063e-03
 4.18093149e-03 4.18093149e-03 5.80279063e-03 4.58892882e-01
 1.88849606e-02 8.61337408e-03 4.18094080e-03 5.80282230e-03
 4.18092636e-03 1.22534912e-02 4.18092636e-03 5.80279063e-03
 3.69949546e-03 1.88849159e-02 6.39226753e-03 1.34166494e-01
 3.69949546e-03 4.18094080e-03 5.80279063e-03 1.51206870e-02
 5.86242788e-02 5.51825427e-02 5.51825427e-02 6.50848961e-03
 6.13846183e-02 7.35550821e-02 2.88125649e-02 3.15032303e-01
 5.51825427e-02 9.06407926e-03 5.51825501e-02 1.08008953e-02
 2.88125649e-02 5.51825427e-02 7.38398684e-03 6.39229035e-03
 3.72601636e-02 2.26242584e-03 9.68539622e-03 4.84047504e-03
 8.70902911e-02 1.14905825e-02 8.42336193e-03 8.42336193e-03
 3.34547795e-02 4.23568897e-02 8.42336193e-03 8.42336193e-03
 4.10654806e-02 5.83353750e-02 8.42336193e-03 8.42336193e-03
 8.42336193e-03 8.42336193e-03 4.23569269e-02 4.23569866e-02
 4.23569120e-02 4.23570424e-02 4.54059355e-02 3.62224504e-02
 4.23569903e-02 4.23570462e-02 4.23569866e-02 8.42336193e-03
 2.87397116e-01 4.23570238e-02 1.24587007e-02 4.23569269e-02
 1.04305511e-02 9.62261017e-03 1.00230344e-01 8.42336193e-03
 9.76410881e-02 9.62261017e-03 1.00701161e-01 6.47476465e-02
 6.47478029e-02 1.35929780e-02 6.47476465e-02 6.47478029e-02
 1.11415209e-02 4.94254678e-02 7.10090175e-02 1.11775370e-02
 1.11775370e-02 1.11775370e-02 1.11775370e-02 1.11774933e-02
 1.11775370e-02 7.56054044e-01 7.10090175e-02 1.35929780e-02
 9.14791077e-02 1.11774933e-02 1.10038660e-01 1.11775370e-02
 7.10090175e-02 1.56817529e-02 1.06558323e-01 8.86913911e-02
 7.10090175e-02 7.10090175e-02 4.57773618e-02 1.11774933e-02
 7.10090920e-02]
2025-06-02 15:46:03,661 - DEBUG - Edge reconstruction errors: [ 5.264422   5.2617254 44.25771   ... 13.357691   2.158636  13.357691 ]
2025-06-02 15:46:03,664 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154603_update_46.json
2025-06-02 15:46:03,665 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:46:03,684 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154603_update_46.pth and as latest_checkpoint.pth
2025-06-02 15:46:03,684 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.6268
2025-06-02 15:46:03,684 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:46:03,684 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.3605, MLP Score: 0.4973
2025-06-02 15:46:03,684 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.6121, MLP Score: 0.4972
2025-06-02 15:46:03,685 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.1282, MLP Score: 0.4962
2025-06-02 15:46:03,685 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.9484, MLP Score: 0.5026
2025-06-02 15:46:03,685 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.3106, MLP Score: 0.4973
2025-06-02 15:46:03,685 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:46:03,685 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2577, MLP Score: 0.0335
2025-06-02 15:46:03,685 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0024
2025-06-02 15:46:03,686 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0024
2025-06-02 15:46:03,686 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7585, MLP Score: 0.0007
2025-06-02 15:46:03,686 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7581, MLP Score: 0.0004
2025-06-02 15:46:03,692 - DEBUG - Embedding standard deviations before t-SNE: [1.2527807  0.         1.2053525  1.1338408  2.010468   0.
 0.78052896 0.77324426 2.2444968  1.1623257  0.7513793  0.
 1.5315144  0.5802545  1.1075621  1.1549898  0.         0.47542185
 0.         0.08780191 3.2753406  0.6265157  0.         1.1434258
 1.0356692  0.8684242  0.         0.76527876 2.1082861  0.
 1.1883913  0.5003252 ]
2025-06-02 15:46:04,564 - INFO - Embeddings visualization saved to vis/embeddings_46_updates_20250602_154603.png
2025-06-02 15:46:04,565 - INFO - Performing visualization of node and edge features.
2025-06-02 15:46:04,568 - INFO - Starting visualization of node features.
2025-06-02 15:46:04,568 - INFO - Graph has 985 nodes and 30 features.
2025-06-02 15:46:04,568 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:46:04,568 - INFO - Calculating feature statistics:
2025-06-02 15:46:04,568 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,569 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,569 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(3.0982314e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7551239), 'max': np.float32(2.4481673)}
2025-06-02 15:46:04,569 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3552341), 'max': np.float32(1.85407)}
2025-06-02 15:46:04,569 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,569 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,569 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,569 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45509103), 'max': np.float32(2.1973627)}
2025-06-02 15:46:04,570 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.1244411), 'max': np.float32(0.8893307)}
2025-06-02 15:46:04,570 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.349739), 'max': np.float32(0.10923729)}
2025-06-02 15:46:04,570 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3229966), 'max': np.float32(1.4913315)}
2025-06-02 15:46:04,570 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4571143), 'max': np.float32(2.4393346)}
2025-06-02 15:46:04,570 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2720811), 'std': np.float32(0.95219874), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:46:04,570 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9614213), 'std': np.float32(0.27508003), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:46:04,570 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:46:04,571 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.406091), 'std': np.float32(0.57136714), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:46:04,571 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10923729), 'max': np.float32(9.349739)}
2025-06-02 15:46:04,571 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.394924), 'std': np.float32(3.0010784), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:46:04,571 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8081217), 'std': np.float32(2.8980536), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:46:04,571 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.618274), 'std': np.float32(1.4741325), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:46:04,571 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:46:04,572 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992893), 'std': np.float32(0.22292528), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:46:04,572 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(3.872789e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12862214), 'max': np.float32(16.396528)}
2025-06-02 15:46:04,572 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-2.9045918e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14024527), 'max': np.float32(7.1303654)}
2025-06-02 15:46:04,572 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,572 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,572 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,573 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:04,573 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(7.745578e-09), 'std': np.float32(1.0), 'min': np.float32(-0.9681856), 'max': np.float32(10.4042845)}
2025-06-02 15:46:04,573 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0705417), 'max': np.float32(4.459967)}
2025-06-02 15:46:04,597 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c098de510>
2025-06-02 15:46:04,833 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:46:04,936 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:46:04,983 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:46:06,414 - INFO - Node feature visualization saved to vis/node_features_20250602_154605.png
2025-06-02 15:46:06,415 - INFO - Finished visualization of node features.
2025-06-02 15:46:06,415 - INFO - Performing additional feature analysis:
2025-06-02 15:46:06,415 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:46:06,416 - INFO - Starting visualization of edge features.
2025-06-02 15:46:06,417 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 15:46:06,417 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:46:06,417 - INFO - Calculating edge feature statistics:
2025-06-02 15:46:06,417 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:46:06,417 - INFO - - count: {'name': 'count', 'unique': 38, 'mean': np.float32(3.5485557e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.035350062), 'max': np.float32(35.62755)}
2025-06-02 15:46:06,417 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(455.71396), 'std': np.float32(440.23712), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:46:06,417 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:06,417 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:46:06,417 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1444, 'mean': np.float32(-8.871389e-10), 'std': np.float32(1.0), 'min': np.float32(-0.05988589), 'max': np.float32(29.227173)}
2025-06-02 15:46:06,417 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1519, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.056591857), 'max': np.float32(32.76064)}
2025-06-02 15:46:06,417 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 500, 'mean': np.float32(-3.5485557e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0443943), 'max': np.float32(35.470356)}
2025-06-02 15:46:06,417 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1493, 'mean': np.float32(2.6614166e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08654886), 'max': np.float32(29.027)}
2025-06-02 15:46:06,418 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1521, 'mean': np.float32(2.6614166e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.086640574), 'max': np.float32(28.039663)}
2025-06-02 15:46:06,418 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 547, 'mean': np.float32(-1.7742778e-09), 'std': np.float32(1.0), 'min': np.float32(-0.053714637), 'max': np.float32(34.84866)}
2025-06-02 15:46:06,430 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c08c7dbb0>
2025-06-02 15:46:06,527 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:46:06,538 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09eeaf90>
2025-06-02 15:46:06,623 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:46:06,797 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:46:07,073 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:46:07,085 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:46:07,089 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:46:08,332 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154607.png
2025-06-02 15:46:08,332 - INFO - Finished visualization of edge features.
2025-06-02 15:46:08,332 - INFO - Performing additional edge feature analysis:
2025-06-02 15:46:08,332 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:46:08,332 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:46:08,334 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:46:08,334 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 15:46:08,334 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:46:08,623 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154608_summary.png
2025-06-02 15:46:09,049 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154608_pca_3d.png
2025-06-02 15:46:09,334 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154608_pca_variance.png
2025-06-02 15:46:09,334 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:46:09,335 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-02 15:46:09,335 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 15:46:09,335 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:46:09,335 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 15:46:09,359 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:46:09,384 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 15:46:09,384 - INFO - Processing node updates/additions.
2025-06-02 15:46:09,390 - INFO - Processing edge updates/additions.
2025-06-02 15:46:09,404 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:46:09,405 - INFO - Finished updating NetworkX graph.
2025-06-02 15:46:09,405 - DEBUG - Updated graph - Nodes: 994, Edges: 2170
2025-06-02 15:46:09,405 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:46:09,407 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:46:09,417 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-02 15:46:09,419 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:46:09,419 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-02 15:46:09,421 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-02 15:46:09,422 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:46:09,428 - DEBUG - Initial edge attributes tensor shape: torch.Size([2170, 10])
2025-06-02 15:46:09,429 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:46:09,429 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2170, 10])
2025-06-02 15:46:09,429 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:46:09,430 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:46:09,431 - INFO - Updated main graph to 994 nodes and 2170 edges.
2025-06-02 15:46:09,431 - INFO - Performing online update...
2025-06-02 15:46:09,431 - INFO - Starting online update for 25 steps.
2025-06-02 15:46:09,431 - DEBUG - Updated RunningStats: new_mean=0.944865281087555, new_var=27000000000161.66, new_n=2730
2025-06-02 15:46:09,432 - DEBUG - Updated RunningStats: new_mean=0.9426092598686419, new_var=27300000000018.19, new_n=2760
2025-06-02 15:46:09,432 - DEBUG - Updated RunningStats: new_mean=44.78016724714231, new_var=9000000186680.312, new_n=910
2025-06-02 15:46:09,432 - DEBUG - Updated RunningStats: new_mean=44.7775372179632, new_var=9100000172348.469, new_n=920
2025-06-02 15:46:09,432 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:46:09,432 - DEBUG - Online update step: 1/25
2025-06-02 15:46:09,434 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:09,525 - DEBUG - Node anomaly scores shape: torch.Size([19090, 1])
2025-06-02 15:46:09,532 - DEBUG - Edge anomaly scores shape: torch.Size([40020, 1])
2025-06-02 15:46:09,533 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:09,752 - DEBUG - Step 1: Loss=0.6692
2025-06-02 15:46:09,752 - DEBUG - Online update step: 2/25
2025-06-02 15:46:09,758 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:09,852 - DEBUG - Node anomaly scores shape: torch.Size([18053, 1])
2025-06-02 15:46:09,857 - DEBUG - Edge anomaly scores shape: torch.Size([37755, 1])
2025-06-02 15:46:09,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:10,040 - DEBUG - Step 2: Loss=0.6867
2025-06-02 15:46:10,040 - DEBUG - Online update step: 3/25
2025-06-02 15:46:10,044 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:10,142 - DEBUG - Node anomaly scores shape: torch.Size([18227, 1])
2025-06-02 15:46:10,146 - DEBUG - Edge anomaly scores shape: torch.Size([38045, 1])
2025-06-02 15:46:10,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:10,332 - DEBUG - Step 3: Loss=0.6578
2025-06-02 15:46:10,332 - DEBUG - Online update step: 4/25
2025-06-02 15:46:10,336 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:10,448 - DEBUG - Node anomaly scores shape: torch.Size([19297, 1])
2025-06-02 15:46:10,452 - DEBUG - Edge anomaly scores shape: torch.Size([40625, 1])
2025-06-02 15:46:10,453 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:10,706 - DEBUG - Step 4: Loss=0.6692
2025-06-02 15:46:10,706 - DEBUG - Online update step: 5/25
2025-06-02 15:46:10,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:11,014 - DEBUG - Node anomaly scores shape: torch.Size([17731, 1])
2025-06-02 15:46:11,026 - DEBUG - Edge anomaly scores shape: torch.Size([36876, 1])
2025-06-02 15:46:11,028 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:11,377 - DEBUG - Step 5: Loss=0.6878
2025-06-02 15:46:11,377 - DEBUG - Online update step: 6/25
2025-06-02 15:46:11,386 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:11,727 - DEBUG - Node anomaly scores shape: torch.Size([19530, 1])
2025-06-02 15:46:11,742 - DEBUG - Edge anomaly scores shape: torch.Size([40893, 1])
2025-06-02 15:46:11,744 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:12,428 - DEBUG - Step 6: Loss=0.6577
2025-06-02 15:46:12,428 - DEBUG - Online update step: 7/25
2025-06-02 15:46:12,437 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:13,218 - DEBUG - Node anomaly scores shape: torch.Size([17429, 1])
2025-06-02 15:46:13,238 - DEBUG - Edge anomaly scores shape: torch.Size([36176, 1])
2025-06-02 15:46:13,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:13,527 - DEBUG - Step 7: Loss=0.6686
2025-06-02 15:46:13,528 - DEBUG - Online update step: 8/25
2025-06-02 15:46:13,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:13,631 - DEBUG - Node anomaly scores shape: torch.Size([18189, 1])
2025-06-02 15:46:13,635 - DEBUG - Edge anomaly scores shape: torch.Size([37962, 1])
2025-06-02 15:46:13,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:13,828 - DEBUG - Step 8: Loss=0.6855
2025-06-02 15:46:13,828 - DEBUG - Online update step: 9/25
2025-06-02 15:46:13,834 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:13,939 - DEBUG - Node anomaly scores shape: torch.Size([18798, 1])
2025-06-02 15:46:13,944 - DEBUG - Edge anomaly scores shape: torch.Size([39433, 1])
2025-06-02 15:46:13,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:14,147 - DEBUG - Step 9: Loss=0.6562
2025-06-02 15:46:14,147 - DEBUG - Online update step: 10/25
2025-06-02 15:46:14,153 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:14,276 - DEBUG - Node anomaly scores shape: torch.Size([20259, 1])
2025-06-02 15:46:14,281 - DEBUG - Edge anomaly scores shape: torch.Size([42785, 1])
2025-06-02 15:46:14,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:14,507 - DEBUG - Step 10: Loss=0.6650
2025-06-02 15:46:14,507 - DEBUG - Online update step: 11/25
2025-06-02 15:46:14,513 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:14,608 - DEBUG - Node anomaly scores shape: torch.Size([18732, 1])
2025-06-02 15:46:14,613 - DEBUG - Edge anomaly scores shape: torch.Size([39330, 1])
2025-06-02 15:46:14,614 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:14,803 - DEBUG - Step 11: Loss=0.6831
2025-06-02 15:46:14,803 - DEBUG - Online update step: 12/25
2025-06-02 15:46:14,809 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:14,906 - DEBUG - Node anomaly scores shape: torch.Size([18239, 1])
2025-06-02 15:46:14,910 - DEBUG - Edge anomaly scores shape: torch.Size([37975, 1])
2025-06-02 15:46:14,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:15,151 - DEBUG - Step 12: Loss=0.6558
2025-06-02 15:46:15,151 - DEBUG - Online update step: 13/25
2025-06-02 15:46:15,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:15,271 - DEBUG - Node anomaly scores shape: torch.Size([18838, 1])
2025-06-02 15:46:15,278 - DEBUG - Edge anomaly scores shape: torch.Size([39606, 1])
2025-06-02 15:46:15,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:15,529 - DEBUG - Step 13: Loss=0.6679
2025-06-02 15:46:15,529 - DEBUG - Online update step: 14/25
2025-06-02 15:46:15,536 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:15,638 - DEBUG - Node anomaly scores shape: torch.Size([18991, 1])
2025-06-02 15:46:15,643 - DEBUG - Edge anomaly scores shape: torch.Size([39965, 1])
2025-06-02 15:46:15,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:15,866 - DEBUG - Step 14: Loss=0.6840
2025-06-02 15:46:15,866 - DEBUG - Online update step: 15/25
2025-06-02 15:46:15,869 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:15,964 - DEBUG - Node anomaly scores shape: torch.Size([17742, 1])
2025-06-02 15:46:15,970 - DEBUG - Edge anomaly scores shape: torch.Size([36983, 1])
2025-06-02 15:46:15,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:16,169 - DEBUG - Step 15: Loss=0.6563
2025-06-02 15:46:16,169 - DEBUG - Online update step: 16/25
2025-06-02 15:46:16,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:16,275 - DEBUG - Node anomaly scores shape: torch.Size([17775, 1])
2025-06-02 15:46:16,279 - DEBUG - Edge anomaly scores shape: torch.Size([37164, 1])
2025-06-02 15:46:16,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:16,488 - DEBUG - Step 16: Loss=0.6640
2025-06-02 15:46:16,488 - DEBUG - Online update step: 17/25
2025-06-02 15:46:16,494 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:16,801 - DEBUG - Node anomaly scores shape: torch.Size([17935, 1])
2025-06-02 15:46:16,805 - DEBUG - Edge anomaly scores shape: torch.Size([37420, 1])
2025-06-02 15:46:16,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:16,979 - DEBUG - Step 17: Loss=0.6812
2025-06-02 15:46:16,979 - DEBUG - Online update step: 18/25
2025-06-02 15:46:16,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:17,113 - DEBUG - Node anomaly scores shape: torch.Size([20353, 1])
2025-06-02 15:46:17,118 - DEBUG - Edge anomaly scores shape: torch.Size([42688, 1])
2025-06-02 15:46:17,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:17,423 - DEBUG - Step 18: Loss=0.6528
2025-06-02 15:46:17,423 - DEBUG - Online update step: 19/25
2025-06-02 15:46:17,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:17,555 - DEBUG - Node anomaly scores shape: torch.Size([18566, 1])
2025-06-02 15:46:17,560 - DEBUG - Edge anomaly scores shape: torch.Size([38792, 1])
2025-06-02 15:46:17,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:17,788 - DEBUG - Step 19: Loss=0.6658
2025-06-02 15:46:17,789 - DEBUG - Online update step: 20/25
2025-06-02 15:46:17,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:17,890 - DEBUG - Node anomaly scores shape: torch.Size([19314, 1])
2025-06-02 15:46:17,895 - DEBUG - Edge anomaly scores shape: torch.Size([40568, 1])
2025-06-02 15:46:17,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:18,135 - DEBUG - Step 20: Loss=0.6835
2025-06-02 15:46:18,135 - DEBUG - Online update step: 21/25
2025-06-02 15:46:18,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:18,245 - DEBUG - Node anomaly scores shape: torch.Size([21356, 1])
2025-06-02 15:46:18,255 - DEBUG - Edge anomaly scores shape: torch.Size([45014, 1])
2025-06-02 15:46:18,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:18,477 - DEBUG - Step 21: Loss=0.6527
2025-06-02 15:46:18,478 - DEBUG - Online update step: 22/25
2025-06-02 15:46:18,485 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:18,598 - DEBUG - Node anomaly scores shape: torch.Size([19194, 1])
2025-06-02 15:46:18,603 - DEBUG - Edge anomaly scores shape: torch.Size([40101, 1])
2025-06-02 15:46:18,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:18,843 - DEBUG - Step 22: Loss=0.6635
2025-06-02 15:46:18,844 - DEBUG - Online update step: 23/25
2025-06-02 15:46:18,850 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:18,955 - DEBUG - Node anomaly scores shape: torch.Size([19479, 1])
2025-06-02 15:46:18,959 - DEBUG - Edge anomaly scores shape: torch.Size([40945, 1])
2025-06-02 15:46:18,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:19,171 - DEBUG - Step 23: Loss=0.6811
2025-06-02 15:46:19,172 - DEBUG - Online update step: 24/25
2025-06-02 15:46:19,177 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:19,266 - DEBUG - Node anomaly scores shape: torch.Size([18088, 1])
2025-06-02 15:46:19,271 - DEBUG - Edge anomaly scores shape: torch.Size([37754, 1])
2025-06-02 15:46:19,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:19,474 - DEBUG - Step 24: Loss=0.6543
2025-06-02 15:46:19,474 - DEBUG - Online update step: 25/25
2025-06-02 15:46:19,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:19,921 - DEBUG - Node anomaly scores shape: torch.Size([19169, 1])
2025-06-02 15:46:19,931 - DEBUG - Edge anomaly scores shape: torch.Size([40208, 1])
2025-06-02 15:46:19,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:20,089 - DEBUG - Step 25: Loss=0.6622
2025-06-02 15:46:20,089 - INFO - Online update finished. Average loss: 0.6685, Learning rate: 0.001000
2025-06-02 15:46:20,090 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], current edge mean: [ 4.3948126e-10  4.5542950e+02  0.0000000e+00  0.0000000e+00
  4.7244235e-09 -2.1974063e-09 -4.3948125e-09  1.7579250e-09
 -2.1974063e-09  0.0000000e+00]
2025-06-02 15:46:20,091 - DEBUG - Node drift difference: 0.0170, Edge drift difference: 0.0006
2025-06-02 15:46:20,092 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], edge=[ 4.3948126e-10  4.5542950e+02  0.0000000e+00  0.0000000e+00
  4.7244235e-09 -2.1974063e-09 -4.3948125e-09  1.7579250e-09
 -2.1974063e-09  0.0000000e+00]
2025-06-02 15:46:20,092 - DEBUG - Updated reference std: node=[0.         0.         1.0005034  1.0005034  0.         0.
 0.         1.0005034  1.0005034  1.0005034  1.0005034  1.0005034
 0.9407508  0.27399415 0.3602073  0.5745763  1.0005034  3.003227
 2.8989465  1.479363   0.3602073  0.22202651 1.0005034  1.0005034
 0.         0.         0.         0.         1.0005034  1.0005034 ], edge=[  1.0002304 438.38043     0.          0.          1.0002304   1.0002306
   1.0002306   1.0002306   1.0002304   1.0002306]
2025-06-02 15:46:20,092 - INFO - Online update complete. Loss: 0.6685
2025-06-02 15:46:20,092 - INFO - Running anomaly detection...
2025-06-02 15:46:20,093 - INFO - Starting anomaly detection.
2025-06-02 15:46:20,108 - DEBUG - Node reconstruction errors: [3.12528312e-01 8.58444989e-01 2.19889283e+00 2.10780632e-02
 9.45723951e-02 3.22081484e-02 1.47344506e+00 1.88101027e-02
 1.88101027e-02 6.76833093e-02 1.88101027e-02 5.19852526e-02
 3.86487174e+00 6.92389131e-01 1.08011011e-02 5.32259680e-02
 1.23614363e-01 5.32259382e-02 3.28200459e-01 5.18069826e-02
 2.87344977e-02 1.08011011e-02 1.71177521e-01 1.08974963e-01
 1.20853046e-02 3.16799134e-02 1.20853689e-02 1.76290929e-01
 1.89564992e-02 1.20853689e-02 4.42238063e-01 2.44007036e-01
 1.57766715e-01 2.15402730e-02 1.34949967e-01 1.68845341e-01
 8.92899334e-02 5.18069826e-02 2.54330963e-01 3.31808478e-01
 6.05670474e-02 9.63470712e-03 5.18069826e-02 1.05671726e-01
 3.70729417e-01 6.93397373e-02 1.29218206e-01 3.68631691e-01
 1.91891156e-02 4.96097744e-01 2.88472086e-01 3.79287079e-02
 3.22564617e-02 3.23897868e-01 2.44036485e-02 1.18697859e-01
 8.39085639e-01 4.92808856e-02 3.44175935e-01 3.35870892e-01
 2.67667085e-01 1.51389182e-01 8.54810141e-03 1.12742424e-01
 1.07908852e-01 2.44035516e-02 7.70242186e-03 2.44038105e-02
 8.54810141e-03 1.37211934e-01 1.34680420e-01 3.13741229e-02
 9.40865558e-03 4.27362807e-02 9.24328491e-02 3.06321606e-02
 1.93353236e-01 1.44003808e-01 7.54121840e-02 5.12587316e-02
 2.02819575e-02 3.13522592e-02 7.25077569e-01 2.02386320e-01
 3.19547988e-02 9.84010622e-02 5.83481081e-02 4.36221734e-02
 3.05638108e-02 1.78438172e-01 1.04915025e-02 1.20063059e-01
 5.43780103e-02 6.04065843e-02 8.78155753e-02 3.06265265e-01
 1.97215565e-02 2.54374798e-02 7.21421745e-03 1.40452683e-01
 2.29128767e-02 1.97215565e-02 5.69133535e-02 2.97619820e-01
 1.06656276e-01 2.51704715e-02 1.13079950e-01 9.00316760e-02
 5.50933629e-02 3.93884808e-01 2.77062684e-01 2.41662599e-02
 5.68422154e-02 1.41006187e-01 2.15071552e-02 1.00469097e-01
 2.00471748e-02 1.46868154e-01 3.10062990e-02 7.88179971e-03
 1.05282040e-02 3.34875733e-02 1.40729979e-01 9.74428281e-02
 1.52786737e-02 7.88121205e-03 1.28885597e-01 1.08633563e-01
 3.27474661e-02 2.52197199e-02 3.91869880e-02 6.93185627e-03
 5.89371622e-01 2.49080479e-01 1.79179404e-02 2.22993232e-02
 7.40601122e-02 6.76522730e-03 3.09583157e-01 1.55265063e-01
 5.76851405e-02 5.25474586e-02 1.21157812e-02 3.45752612e-02
 7.68819079e-02 8.57738554e-02 2.00472008e-02 2.56043762e-01
 5.49714305e-02 4.17402722e-02 5.08370101e-01 1.01633094e-01
 6.15249351e-02 6.93185022e-03 5.20038195e-02 1.25545561e-01
 7.52564985e-03 3.31542268e-02 2.29128338e-02 5.25250211e-02
 5.76851405e-02 3.09583813e-01 7.52569316e-03 3.91869433e-02
 2.00266354e-02 5.70928194e-02 2.04664432e-02 3.62933949e-02
 5.55659868e-02 4.17406298e-02 5.64600378e-02 9.25729237e-03
 9.55532771e-03 4.35886770e-01 3.10065988e-02 8.57621670e+00
 3.70133929e-02 4.19889241e-02 1.99839789e-02 1.99839976e-02
 2.58618072e-02 8.21726322e-02 4.85803708e-02 1.82174236e-01
 1.26014054e-01 2.34742258e-02 1.08929619e-01 2.75984276e-02
 2.29342654e-02 6.25676066e-02 7.03250468e-02 5.34206368e-02
 7.22762197e-02 9.79393069e-03 3.09583277e-01 3.38520631e-02
 7.84487367e-01 1.25760168e-01 5.46044596e-02 1.10545911e-01
 1.81010924e-02 7.52569316e-03 5.21844849e-02 3.85505781e-02
 5.13432696e-02 5.93396984e-02 7.51977265e-02 1.92989320e-01
 8.42698384e-03 5.42318746e-02 1.73279569e-02 7.31114075e-02
 3.66786607e-02 3.80299687e-02 9.62655433e-03 1.45579455e-02
 4.63131219e-02 2.00471543e-02 8.63600895e-02 8.55442584e-02
 1.66536719e-01 1.09440582e-02 9.07100178e-03 3.66786607e-02
 7.52564985e-03 3.79226580e-02 1.35737419e-01 1.22245634e-02
 5.80515936e-02 3.59591395e-02 1.02585465e-01 2.52110865e-02
 3.85923348e-02 2.00471207e-02 2.00471524e-02 7.22762197e-02
 3.95310409e-02 9.07100178e-03 7.52569316e-03 2.07385316e-01
 1.18073009e-01 4.54898104e-02 1.09162647e-02 1.92118324e-02
 1.27621805e-02 2.38481667e-02 2.59400886e-02 5.43453358e-02
 1.09162647e-02 1.54748131e-02 1.26836896e-01 1.03095714e-02
 8.63599554e-02 2.71629263e-02 3.96751277e-02 3.59470434e-02
 7.56852981e-03 9.08141024e-03 1.07245371e-01 1.99840069e-02
 4.10878025e-02 9.88612473e-02 2.07434427e-02 4.26224321e-02
 5.60706444e-02 7.46814907e-02 4.04967405e-02 4.75997597e-01
 4.04967330e-02 1.96001902e-02 2.19880119e-01 1.56710699e-01
 4.40098830e-02 1.45361632e-01 1.54470485e-02 1.34479001e-01
 1.65341776e-02 1.22284435e-01 2.58618072e-02 5.50488681e-02
 1.73215926e-01 1.63832176e-02 3.91672701e-02 6.17181696e-02
 2.55000573e-02 2.50441618e-02 2.87098378e-01 5.54075055e-02
 8.21726695e-02 3.62935275e-01 7.81415701e-02 2.55197864e-02
 4.72435318e-02 1.27622522e-02 6.53250694e-01 1.49738556e-02
 3.06756515e-02 1.99839938e-02 3.38520631e-02 5.09710729e-01
 3.84948328e-02 7.40346387e-02 1.16110761e-02 1.86642222e-02
 5.45750698e-03 5.45750698e-03 5.45750698e-03 1.48349050e-02
 5.54430410e-02 7.40346387e-02 5.45750698e-03 5.28771095e-02
 5.45750698e-03 5.16998507e-02 5.41354567e-02 5.07853366e-02
 2.40936443e-01 5.98663017e-02 3.81582119e-02 3.43821906e-02
 4.58194651e-02 1.57505590e-02 2.07904559e-02 1.16110705e-02
 4.78654318e-02 1.68574139e-01 2.29518384e-01 4.31786589e-02
 5.81961013e-02 5.81961237e-02 2.24962100e-01 3.47770602e-02
 5.45750698e-03 1.54470764e-02 5.45750698e-03 1.48348948e-02
 6.10109419e-02 9.90094524e-03 8.78808647e-02 6.28197286e-03
 7.40346387e-02 2.25209817e-02 6.28194259e-03 5.18912077e-02
 2.19228193e-02 2.86591686e-02 1.16110770e-02 2.63915174e-02
 4.87042181e-02 4.62074541e-02 5.45750698e-03 2.49225739e-02
 5.77462725e-02 7.71718770e-02 2.09530015e-02 7.56852981e-03
 8.44633281e-02 5.45750698e-03 6.05845964e-03 2.55866438e-01
 5.71972989e-02 7.00859027e-03 2.72640228e-01 2.55876388e-02
 1.16110612e-02 3.63679320e-01 9.34035257e-02 1.13794334e-01
 1.72600485e-02 1.46164214e-02 3.70086357e-02 2.13631373e-02
 1.66373476e-02 5.93831055e-02 2.93947626e-02 5.65595254e-02
 8.67888331e-03 1.00262910e-02 1.03462920e-01 5.45750698e-03
 1.16110919e-02 5.06748296e-02 6.53616758e-03 3.78744975e-02
 5.16962036e-02 9.40058194e-03 4.80473377e-02 1.36553228e-01
 3.11100166e-02 5.45750698e-03 1.72711268e-01 3.72900441e-02
 1.60231162e-02 1.22765265e-01 2.98074652e-02 2.98074204e-02
 2.98074204e-02 3.69991034e-01 4.97164112e-03 4.30205852e-01
 4.98735197e-02 8.85206908e-02 1.08103350e-01 4.97167464e-03
 1.47254532e-02 1.60230882e-02 2.73907166e-02 7.05147302e-03
 1.60231125e-02 4.93948981e-02 2.98074652e-02 1.60230957e-02
 4.97167464e-03 2.98074204e-02 2.98074204e-02 1.73434578e-02
 2.22662687e-02 2.98074652e-02 9.59739760e-02 3.06301229e-02
 2.04977561e-02 8.23060609e-03 1.42734386e-02 6.72597159e-03
 1.32531717e-01 4.65682074e-02 1.22297900e-02 3.83134484e-02
 9.10520554e-02 2.42765527e-02 4.69733104e-02 2.78308783e-02
 3.31338011e-02 3.53396423e-02 1.07953459e-01 2.98074204e-02
 7.97439925e-03 3.87398079e-02 1.37700185e-01 4.50783558e-02
 6.61572590e-02 1.11218551e-02 2.07754925e-01 7.94239994e-03
 4.19299416e-02 6.72694221e-02 1.11599453e-01 6.40699454e-03
 3.75393853e-02 8.22250545e-03 1.94122568e-02 8.14900082e-03
 1.02705173e-02 5.01147918e-02 8.14900082e-03 2.61423197e-02
 6.72597159e-03 1.99999511e-02 2.93086488e-02 3.86004560e-02
 1.58507060e-02 9.62325092e-03 6.34846790e-03 5.79543598e-02
 6.34846790e-03 9.62325092e-03 9.34919529e-03 2.66384780e-02
 6.68204650e-02 3.65422554e-02 9.34919529e-03 1.58507451e-02
 1.18783992e-02 2.40920588e-01 3.15301940e-02 1.42723024e-02
 2.66384911e-02 1.58506911e-02 7.44766230e-03 1.30736260e-02
 2.19533630e-02 2.13373423e-01 2.50978842e-02 6.40699454e-03
 1.23047262e-01 1.18263923e-02 8.14900082e-03 8.24875757e-02
 2.02412810e-02 2.35829413e-01 1.52096273e-02 7.44766230e-03
 3.21016833e-02 8.03101808e-03 1.62726566e-01 7.80405570e-03
 1.48735652e-02 4.51501667e-01 4.59796796e-03 1.30736260e-02
 2.52889603e-01 8.03101808e-03 2.22042173e-01 1.61188431e-02
 9.18119587e-03 5.59482388e-02 4.24023857e-03 4.18221772e-01
 9.45075881e-03 8.14900082e-03 1.44356033e-02 9.02380701e-03
 9.02380701e-03 9.42738634e-03 5.71586303e-02 1.85972583e-02
 4.24030004e-03 7.85685703e-03 5.88036366e-02 4.75134179e-02
 6.27800971e-02 1.11218551e-02 4.24030004e-03 6.13007210e-02
 9.18121077e-03 1.48735689e-02 4.24448140e-02 1.46037742e-01
 6.27800673e-02 4.34266292e-02 1.85972583e-02 2.26018988e-02
 4.59800754e-03 1.30736260e-02 1.48735708e-02 1.49963200e-02
 5.22352643e-02 3.59704159e-02 4.59796796e-03 3.73028405e-02
 4.59796796e-03 5.33624031e-02 6.67559355e-02 7.85687193e-03
 7.04546785e-03 3.23348880e-01 6.07091263e-02 4.35111998e-03
 6.54891610e-01 4.35111998e-03 4.35111998e-03 4.35111998e-03
 4.35111998e-03 4.35111998e-03 4.35111998e-03 4.35111998e-03
 8.83417763e-03 6.83731819e-03 2.12039351e-02 4.35111998e-03
 4.35111998e-03 4.35111998e-03 4.35111998e-03 4.35111998e-03
 4.35111998e-03 4.35111998e-03 4.35111998e-03 4.35111998e-03
 6.84663374e-03 4.35115583e-03 4.35111998e-03 1.29564673e-01
 4.35111998e-03 6.80473745e-02 6.67646453e-02 4.59796796e-03
 6.00006022e-02 5.32445088e-02 3.33084762e-01 3.33084762e-01
 4.55026887e-02 6.00006022e-02 4.59796796e-03 4.24023857e-03
 4.24023857e-03 6.09945990e-02 4.24030004e-03 3.45997475e-02
 3.20120901e-02 4.35111998e-03 1.11218551e-02 4.59800754e-03
 9.02380701e-03 4.59796796e-03 4.59800754e-03 3.81377526e-02
 4.59796796e-03 4.24023857e-03 4.59800754e-03 4.59796796e-03
 7.33036101e-02 4.24030004e-03 4.59796796e-03 4.24023857e-03
 4.59796796e-03 4.59800754e-03 4.59796796e-03 4.08788547e-02
 1.21628083e-02 1.35880066e-02 4.35111998e-03 2.47739144e-02
 8.44021738e-02 4.59796796e-03 4.24023857e-03 2.49432046e-02
 4.35115583e-03 2.28570625e-02 2.01189555e-02 4.62873373e-03
 4.59800754e-03 4.59796796e-03 2.28368714e-02 4.67164330e-02
 1.57290567e-02 4.59796796e-03 8.83413386e-03 7.72295985e-03
 4.24023857e-03 1.26770943e-01 4.35111998e-03 1.83528122e-02
 4.09827977e-02 4.35111998e-03 4.35115583e-03 8.83415993e-03
 7.72295985e-03 4.59796796e-03 3.20098847e-01 2.33188458e-02
 2.03619320e-02 4.67164330e-02 1.69193149e-02 2.95271296e-02
 2.95271296e-02 6.64744079e-02 1.04807857e-02 4.35111998e-03
 9.65749938e-03 3.94787230e-02 4.67164330e-02 1.33730955e-02
 1.33683300e-02 1.56308953e-02 4.19467501e-03 4.19467501e-03
 4.19467501e-03 4.19467501e-03 4.19467501e-03 6.38460182e-03
 4.08655070e-02 4.19467501e-03 4.19466151e-03 4.35111998e-03
 6.66134898e-03 4.35111998e-03 2.95271296e-02 3.42390426e-02
 6.75536767e-02 2.03366522e-02 8.97288322e-02 3.02355103e-02
 6.84656482e-03 1.55835720e-02 6.84656901e-03 4.35115583e-03
 2.95271296e-02 9.04489961e-03 3.77838616e-03 3.77838616e-03
 4.19467501e-03 9.04489961e-03 2.92187855e-02 2.11652555e-02
 1.65517125e-02 4.35111998e-03 4.19466151e-03 1.99017003e-02
 3.77842574e-03 4.75840196e-02 7.63408840e-03 4.31555770e-02
 6.38461020e-03 2.26345807e-01 6.97909016e-03 1.30525380e-01
 1.37299504e-02 7.63408840e-03 7.68753700e-03 8.82381387e-03
 7.44868722e-03 6.72693970e-03 3.06660291e-02 1.36681711e-02
 2.98692379e-02 7.63412006e-03 7.63408840e-03 7.63412006e-03
 6.43325131e-03 1.99017227e-02 7.63412006e-03 7.44868722e-03
 7.63412006e-03 7.63412006e-03 7.63408840e-03 1.42016765e-02
 8.69273115e-03 2.67969426e-02 3.29278298e-02 3.91066223e-02
 3.66156213e-02 3.49693969e-02 2.75486149e-02 4.08309489e-01
 7.35777197e-03 8.65402818e-03 6.05085772e-03 2.07690001e-01
 3.35256606e-02 7.44868722e-03 1.09729648e-01 1.38034061e-01
 7.35783856e-03 4.04014206e-03 2.40116883e-02 1.04374141e-01
 8.70636199e-03 8.70636199e-03 8.70636199e-03 4.11753124e-03
 5.72203426e-03 7.88618624e-02 1.03552274e-01 2.72896558e-01
 2.57710405e-02 5.23583777e-03 1.15484986e-02 4.04014206e-03
 9.51475184e-03 1.51764434e-02 5.84172597e-03 5.00695631e-02
 7.35783856e-03 1.38036668e-01 4.04014206e-03 1.51764955e-02
 2.70552859e-02 9.69123021e-02 8.70636199e-03 4.11751261e-03
 5.84172597e-03 1.43919047e-02 3.56677845e-02 4.11753124e-03
 4.11751261e-03 4.11753124e-03 9.07954052e-02 8.73148918e-01
 1.63317144e+00 8.70636199e-03 1.02351710e-01 4.11751261e-03
 3.93988863e-02 9.58432071e-03 5.01560926e-01 1.68800689e-02
 4.11751261e-03 4.29738872e-03 9.72380582e-03 7.30220694e-03
 4.50771660e-01 1.68801229e-02 1.07330427e-01 3.35584171e-02
 2.78142057e-02 1.68801229e-02 3.55101041e-02 3.79554890e-02
 2.14647520e-02 3.26556377e-02 9.25318431e-03 7.31638353e-03
 7.31638353e-03 1.32611066e-01 3.19270641e-01 1.39251143e-01
 1.68800969e-02 2.14647651e-02 1.68800969e-02 4.44069924e-03
 7.48018501e-03 7.48018501e-03 5.57952235e-03 3.96507271e-02
 4.48745629e-03 7.48019107e-03 4.44069924e-03 7.70594105e-02
 7.48018501e-03 7.48018501e-03 4.58712969e-03 9.93412547e-03
 4.09384556e-02 4.36812751e-02 7.48018501e-03 1.88546665e-02
 7.70594105e-02 7.48018501e-03 7.76632829e-03 9.25275311e-03
 4.07369016e-03 4.07369994e-03 9.35255960e-02 1.21716298e-02
 7.48018501e-03 1.21716298e-02 9.42116883e-03 5.11311889e-02
 9.48476791e-02 7.48018501e-03 2.33479828e-01 1.04311397e-02
 1.04311397e-02 5.25303707e-02 1.26416562e-02 1.77432634e-02
 7.76633061e-03 3.23254988e-02 5.68031380e-03 4.32979427e-02
 2.33152490e-02 4.32979427e-02 3.03382039e-01 4.36268747e-03
 2.33152490e-02 5.51122660e-03 5.51119773e-03 5.16048253e-01
 5.51119773e-03 4.34638970e-02 4.98585310e-03 4.18666527e-02
 1.65749155e-02 4.36268747e-03 1.65748615e-02 1.27230898e-01
 3.92469577e-02 1.06269918e-01 5.51119773e-03 1.10050747e-02
 1.29973488e-02 5.51119773e-03 3.76602896e-02 3.85352001e-02
 3.37493531e-02 4.36268747e-03 5.51122660e-03 2.86122322e-01
 3.55099514e-03 1.28221940e-02 5.51119773e-03 8.13765172e-03
 1.65796541e-02 8.13765358e-03 1.28221847e-02 8.13765172e-03
 2.06090640e-02 4.75397483e-02 5.13959751e-02 5.51122660e-03
 4.76561636e-02 1.28221847e-02 5.51122660e-03 4.18284476e-01
 1.28221847e-02 8.13765172e-03 1.28221847e-02 3.55099514e-03
 3.55099514e-03 1.33760907e-02 3.55099514e-03 5.51122660e-03
 3.55662266e-03 1.28221940e-02 1.45826433e-02 1.12308972e-01
 3.55662266e-03 3.55099514e-03 5.51122660e-03 1.39257312e-02
 4.71519753e-02 4.49330956e-02 4.49330099e-02 6.16619829e-03
 4.96147312e-02 5.97973578e-02 2.30478682e-02 2.93154150e-01
 4.49330099e-02 8.50556139e-03 4.49330099e-02 1.03415409e-02
 2.30478682e-02 4.49330099e-02 7.00878259e-03 3.70348105e-03
 3.06458678e-02 2.13101250e-03 9.07057058e-03 4.65557212e-03
 6.42182156e-02 1.09838843e-02 8.00202601e-03 8.00203159e-03
 2.42827069e-02 3.03436946e-02 8.00202601e-03 8.00202601e-03
 3.00258063e-02 5.07189371e-02 8.00203159e-03 8.00202601e-03
 8.00203159e-03 8.00202601e-03 3.03436704e-02 3.03437356e-02
 3.03437635e-02 3.03436816e-02 3.24198268e-02 2.85684634e-02
 3.03436536e-02 3.03437784e-02 3.24198343e-02 8.00202601e-03
 2.67785907e-01 3.24198082e-02 1.18860099e-02 3.03436797e-02
 9.67432372e-03 3.75234224e-02 8.11518356e-02 8.00202601e-03
 7.83781037e-02 3.75231281e-02 1.06322154e-01 5.30466698e-02
 5.30466288e-02 1.27949174e-02 5.30466288e-02 5.30466288e-02
 1.03741670e-02 3.63698713e-02 5.73890619e-02 1.04125272e-02
 1.04125272e-02 1.04125272e-02 3.55523415e-02 7.10718483e-02
 1.04125272e-02 6.16107941e-01 5.73889799e-02 1.27948038e-02
 7.34281316e-02 1.04125272e-02 9.82480869e-02 1.04125272e-02
 5.73889799e-02 1.43749677e-02 3.55523415e-02 7.10718483e-02
 5.73889799e-02 5.73889799e-02 3.55523415e-02 1.04125272e-02
 5.73889799e-02 5.73889799e-02 1.04125272e-02 1.43749677e-02
 1.31577626e-01 1.04125272e-02 3.77086326e-02 1.14003429e-02
 1.43749677e-02 1.14004044e-02]
2025-06-02 15:46:20,108 - DEBUG - Edge reconstruction errors: [ 5.2639923  5.261504  44.257763  ... 13.357752   2.1586323 13.357752 ]
2025-06-02 15:46:20,111 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154620_update_47.json
2025-06-02 15:46:20,111 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:46:20,119 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154620_update_47.pth and as latest_checkpoint.pth
2025-06-02 15:46:20,120 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.6282
2025-06-02 15:46:20,120 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:46:20,120 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.1989, MLP Score: 0.5011
2025-06-02 15:46:20,120 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.4734, MLP Score: 0.5017
2025-06-02 15:46:20,120 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.8649, MLP Score: 0.5011
2025-06-02 15:46:20,120 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.5762, MLP Score: 0.5011
2025-06-02 15:46:20,120 - WARNING -   Node ID: 142.250.76.14, Recon Error: 1.6332, MLP Score: 0.4391
2025-06-02 15:46:20,120 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:46:20,120 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.0107
2025-06-02 15:46:20,120 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0005
2025-06-02 15:46:20,120 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0599, MLP Score: 0.0005
2025-06-02 15:46:20,120 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0001
2025-06-02 15:46:20,121 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7580, MLP Score: 0.0001
2025-06-02 15:46:20,121 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-02 15:46:20,121 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 15:46:20,121 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:46:20,121 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 15:46:20,155 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:46:20,185 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 15:46:20,186 - INFO - Processing node updates/additions.
2025-06-02 15:46:20,195 - INFO - Processing edge updates/additions.
2025-06-02 15:46:20,212 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:46:20,214 - INFO - Finished updating NetworkX graph.
2025-06-02 15:46:20,215 - DEBUG - Updated graph - Nodes: 996, Edges: 2181
2025-06-02 15:46:20,215 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:46:20,218 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:46:20,232 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-02 15:46:20,238 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:46:20,244 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-02 15:46:20,248 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-02 15:46:20,251 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:46:20,261 - DEBUG - Initial edge attributes tensor shape: torch.Size([2181, 10])
2025-06-02 15:46:20,264 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:46:20,265 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2181, 10])
2025-06-02 15:46:20,265 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:46:20,266 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:46:20,268 - INFO - Updated main graph to 996 nodes and 2181 edges.
2025-06-02 15:46:20,268 - INFO - Performing online update...
2025-06-02 15:46:20,268 - INFO - Starting online update for 25 steps.
2025-06-02 15:46:20,269 - DEBUG - Updated RunningStats: new_mean=0.9449173580080591, new_var=27600000000161.516, new_n=2790
2025-06-02 15:46:20,269 - DEBUG - Updated RunningStats: new_mean=0.9427162085269993, new_var=27900000000018.227, new_n=2820
2025-06-02 15:46:20,270 - DEBUG - Updated RunningStats: new_mean=44.785700033647366, new_var=9200000186628.725, new_n=930
2025-06-02 15:46:20,270 - DEBUG - Updated RunningStats: new_mean=44.781889960195755, new_var=9300000171478.684, new_n=940
2025-06-02 15:46:20,271 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:46:20,271 - DEBUG - Online update step: 1/25
2025-06-02 15:46:20,276 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:20,405 - DEBUG - Node anomaly scores shape: torch.Size([18799, 1])
2025-06-02 15:46:20,428 - DEBUG - Edge anomaly scores shape: torch.Size([39443, 1])
2025-06-02 15:46:20,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:20,715 - DEBUG - Step 1: Loss=0.6792
2025-06-02 15:46:20,715 - DEBUG - Online update step: 2/25
2025-06-02 15:46:20,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:20,819 - DEBUG - Node anomaly scores shape: torch.Size([18087, 1])
2025-06-02 15:46:20,826 - DEBUG - Edge anomaly scores shape: torch.Size([37731, 1])
2025-06-02 15:46:20,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:21,024 - DEBUG - Step 2: Loss=0.6510
2025-06-02 15:46:21,025 - DEBUG - Online update step: 3/25
2025-06-02 15:46:21,031 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:21,266 - DEBUG - Node anomaly scores shape: torch.Size([18180, 1])
2025-06-02 15:46:21,271 - DEBUG - Edge anomaly scores shape: torch.Size([37841, 1])
2025-06-02 15:46:21,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:21,463 - DEBUG - Step 3: Loss=0.6620
2025-06-02 15:46:21,463 - DEBUG - Online update step: 4/25
2025-06-02 15:46:21,468 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:21,608 - DEBUG - Node anomaly scores shape: torch.Size([21418, 1])
2025-06-02 15:46:21,616 - DEBUG - Edge anomaly scores shape: torch.Size([45211, 1])
2025-06-02 15:46:21,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:21,851 - DEBUG - Step 4: Loss=0.6783
2025-06-02 15:46:21,851 - DEBUG - Online update step: 5/25
2025-06-02 15:46:21,857 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:21,961 - DEBUG - Node anomaly scores shape: torch.Size([19819, 1])
2025-06-02 15:46:21,966 - DEBUG - Edge anomaly scores shape: torch.Size([41678, 1])
2025-06-02 15:46:21,967 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:22,197 - DEBUG - Step 5: Loss=0.6508
2025-06-02 15:46:22,197 - DEBUG - Online update step: 6/25
2025-06-02 15:46:22,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:22,296 - DEBUG - Node anomaly scores shape: torch.Size([18441, 1])
2025-06-02 15:46:22,300 - DEBUG - Edge anomaly scores shape: torch.Size([38700, 1])
2025-06-02 15:46:22,302 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:22,502 - DEBUG - Step 6: Loss=0.6623
2025-06-02 15:46:22,502 - DEBUG - Online update step: 7/25
2025-06-02 15:46:22,507 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:22,597 - DEBUG - Node anomaly scores shape: torch.Size([18654, 1])
2025-06-02 15:46:22,601 - DEBUG - Edge anomaly scores shape: torch.Size([38838, 1])
2025-06-02 15:46:22,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:22,800 - DEBUG - Step 7: Loss=0.6790
2025-06-02 15:46:22,800 - DEBUG - Online update step: 8/25
2025-06-02 15:46:22,806 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:22,909 - DEBUG - Node anomaly scores shape: torch.Size([19764, 1])
2025-06-02 15:46:22,913 - DEBUG - Edge anomaly scores shape: torch.Size([41500, 1])
2025-06-02 15:46:22,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:23,135 - DEBUG - Step 8: Loss=0.6496
2025-06-02 15:46:23,136 - DEBUG - Online update step: 9/25
2025-06-02 15:46:23,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:23,236 - DEBUG - Node anomaly scores shape: torch.Size([16922, 1])
2025-06-02 15:46:23,240 - DEBUG - Edge anomaly scores shape: torch.Size([35120, 1])
2025-06-02 15:46:23,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:23,417 - DEBUG - Step 9: Loss=0.6615
2025-06-02 15:46:23,418 - DEBUG - Online update step: 10/25
2025-06-02 15:46:23,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:23,535 - DEBUG - Node anomaly scores shape: torch.Size([19194, 1])
2025-06-02 15:46:23,540 - DEBUG - Edge anomaly scores shape: torch.Size([40162, 1])
2025-06-02 15:46:23,541 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:23,719 - DEBUG - Step 10: Loss=0.6775
2025-06-02 15:46:23,719 - DEBUG - Online update step: 11/25
2025-06-02 15:46:23,722 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:23,834 - DEBUG - Node anomaly scores shape: torch.Size([19866, 1])
2025-06-02 15:46:23,840 - DEBUG - Edge anomaly scores shape: torch.Size([41748, 1])
2025-06-02 15:46:23,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:24,052 - DEBUG - Step 11: Loss=0.6497
2025-06-02 15:46:24,053 - DEBUG - Online update step: 12/25
2025-06-02 15:46:24,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:24,163 - DEBUG - Node anomaly scores shape: torch.Size([19112, 1])
2025-06-02 15:46:24,168 - DEBUG - Edge anomaly scores shape: torch.Size([39870, 1])
2025-06-02 15:46:24,169 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:24,368 - DEBUG - Step 12: Loss=0.6605
2025-06-02 15:46:24,368 - DEBUG - Online update step: 13/25
2025-06-02 15:46:24,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:24,469 - DEBUG - Node anomaly scores shape: torch.Size([20726, 1])
2025-06-02 15:46:24,474 - DEBUG - Edge anomaly scores shape: torch.Size([43747, 1])
2025-06-02 15:46:24,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:24,694 - DEBUG - Step 13: Loss=0.6762
2025-06-02 15:46:24,694 - DEBUG - Online update step: 14/25
2025-06-02 15:46:24,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:24,798 - DEBUG - Node anomaly scores shape: torch.Size([19547, 1])
2025-06-02 15:46:24,803 - DEBUG - Edge anomaly scores shape: torch.Size([40938, 1])
2025-06-02 15:46:24,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:25,014 - DEBUG - Step 14: Loss=0.6483
2025-06-02 15:46:25,014 - DEBUG - Online update step: 15/25
2025-06-02 15:46:25,018 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:25,121 - DEBUG - Node anomaly scores shape: torch.Size([18721, 1])
2025-06-02 15:46:25,126 - DEBUG - Edge anomaly scores shape: torch.Size([39118, 1])
2025-06-02 15:46:25,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:25,318 - DEBUG - Step 15: Loss=0.6580
2025-06-02 15:46:25,319 - DEBUG - Online update step: 16/25
2025-06-02 15:46:25,322 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:25,413 - DEBUG - Node anomaly scores shape: torch.Size([17449, 1])
2025-06-02 15:46:25,417 - DEBUG - Edge anomaly scores shape: torch.Size([36307, 1])
2025-06-02 15:46:25,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:25,593 - DEBUG - Step 16: Loss=0.6768
2025-06-02 15:46:25,593 - DEBUG - Online update step: 17/25
2025-06-02 15:46:25,597 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:25,690 - DEBUG - Node anomaly scores shape: torch.Size([18095, 1])
2025-06-02 15:46:25,694 - DEBUG - Edge anomaly scores shape: torch.Size([37723, 1])
2025-06-02 15:46:25,695 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:25,852 - DEBUG - Step 17: Loss=0.6493
2025-06-02 15:46:25,853 - DEBUG - Online update step: 18/25
2025-06-02 15:46:25,857 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:25,982 - DEBUG - Node anomaly scores shape: torch.Size([21328, 1])
2025-06-02 15:46:25,989 - DEBUG - Edge anomaly scores shape: torch.Size([45040, 1])
2025-06-02 15:46:25,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:26,204 - DEBUG - Step 18: Loss=0.6576
2025-06-02 15:46:26,205 - DEBUG - Online update step: 19/25
2025-06-02 15:46:26,208 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:26,300 - DEBUG - Node anomaly scores shape: torch.Size([17901, 1])
2025-06-02 15:46:26,304 - DEBUG - Edge anomaly scores shape: torch.Size([37382, 1])
2025-06-02 15:46:26,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:26,506 - DEBUG - Step 19: Loss=0.6748
2025-06-02 15:46:26,507 - DEBUG - Online update step: 20/25
2025-06-02 15:46:26,510 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:26,665 - DEBUG - Node anomaly scores shape: torch.Size([19917, 1])
2025-06-02 15:46:26,671 - DEBUG - Edge anomaly scores shape: torch.Size([41729, 1])
2025-06-02 15:46:26,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:26,857 - DEBUG - Step 20: Loss=0.6457
2025-06-02 15:46:26,857 - DEBUG - Online update step: 21/25
2025-06-02 15:46:26,860 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:26,966 - DEBUG - Node anomaly scores shape: torch.Size([20871, 1])
2025-06-02 15:46:26,971 - DEBUG - Edge anomaly scores shape: torch.Size([43837, 1])
2025-06-02 15:46:26,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:27,186 - DEBUG - Step 21: Loss=0.6584
2025-06-02 15:46:27,186 - DEBUG - Online update step: 22/25
2025-06-02 15:46:27,189 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:27,621 - DEBUG - Node anomaly scores shape: torch.Size([22164, 1])
2025-06-02 15:46:27,626 - DEBUG - Edge anomaly scores shape: torch.Size([46946, 1])
2025-06-02 15:46:27,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:27,801 - DEBUG - Step 22: Loss=0.6751
2025-06-02 15:46:27,801 - DEBUG - Online update step: 23/25
2025-06-02 15:46:27,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:28,163 - DEBUG - Node anomaly scores shape: torch.Size([19146, 1])
2025-06-02 15:46:28,167 - DEBUG - Edge anomaly scores shape: torch.Size([39952, 1])
2025-06-02 15:46:28,169 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:28,315 - DEBUG - Step 23: Loss=0.6482
2025-06-02 15:46:28,315 - DEBUG - Online update step: 24/25
2025-06-02 15:46:28,318 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:28,646 - DEBUG - Node anomaly scores shape: torch.Size([18198, 1])
2025-06-02 15:46:28,650 - DEBUG - Edge anomaly scores shape: torch.Size([37760, 1])
2025-06-02 15:46:28,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:28,972 - DEBUG - Step 24: Loss=0.6566
2025-06-02 15:46:28,972 - DEBUG - Online update step: 25/25
2025-06-02 15:46:28,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:29,077 - DEBUG - Node anomaly scores shape: torch.Size([20429, 1])
2025-06-02 15:46:29,082 - DEBUG - Edge anomaly scores shape: torch.Size([42922, 1])
2025-06-02 15:46:29,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:29,292 - DEBUG - Step 25: Loss=0.6724
2025-06-02 15:46:29,293 - INFO - Online update finished. Average loss: 0.6624, Learning rate: 0.001000
2025-06-02 15:46:29,294 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], current edge mean: [-8.7452939e-10  4.5536679e+02  0.0000000e+00  0.0000000e+00
  6.5589706e-10 -4.3726470e-10 -2.6235882e-09  1.6397427e-09
 -3.0608529e-09 -8.7452939e-10]
2025-06-02 15:46:29,294 - DEBUG - Node drift difference: 0.0104, Edge drift difference: 0.0001
2025-06-02 15:46:29,295 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], edge=[-8.7452939e-10  4.5536679e+02  0.0000000e+00  0.0000000e+00
  6.5589706e-10 -4.3726470e-10 -2.6235882e-09  1.6397427e-09
 -3.0608529e-09 -8.7452939e-10]
2025-06-02 15:46:29,295 - DEBUG - Updated reference std: node=[0.         0.         1.0005023  1.0005023  0.         0.
 0.         1.0005023  1.0005023  1.0005023  1.0005023  1.0005023
 0.9383103  0.273724   0.3638916  0.5740894  1.0005023  3.008886
 2.9010541  1.4886004  0.3638916  0.22180349 1.0005023  1.0005023
 0.         0.         0.         0.         1.0005023  1.0005023 ], edge=[  1.0002294 437.27393     0.          0.          1.0002294   1.0002294
   1.0002294   1.0002294   1.0002294   1.0002294]
2025-06-02 15:46:29,296 - INFO - Online update complete. Loss: 0.6624
2025-06-02 15:46:29,296 - INFO - Running anomaly detection...
2025-06-02 15:46:29,296 - INFO - Starting anomaly detection.
2025-06-02 15:46:29,314 - DEBUG - Node reconstruction errors: [2.86426395e-01 8.07713211e-01 2.04215002e+00 1.97217893e-02
 7.13063926e-02 2.54826639e-02 1.33082640e+00 1.71608124e-02
 1.71608124e-02 6.23600744e-02 1.71608124e-02 4.48628254e-02
 3.61253738e+00 6.78815484e-01 8.64157174e-03 4.65913899e-02
 1.14899553e-01 4.65913899e-02 2.55548358e-01 4.54992987e-02
 2.68830881e-02 8.64149909e-03 1.59710839e-01 9.18456689e-02
 9.82830394e-03 2.79469527e-02 9.82830394e-03 1.60525754e-01
 1.72614232e-02 9.82830394e-03 3.81618053e-01 2.31754288e-01
 1.44311368e-01 1.96950436e-02 1.24022946e-01 1.56708196e-01
 9.07017365e-02 4.54992987e-02 2.38232031e-01 2.96903461e-01
 5.48639260e-02 7.60918530e-03 4.54992987e-02 9.89210829e-02
 3.57501119e-01 5.94080202e-02 1.22450963e-01 3.44264895e-01
 1.74005385e-02 4.69853818e-01 2.50527948e-01 3.22199315e-02
 2.83847768e-02 2.56433427e-01 2.37429421e-02 1.68224052e-01
 7.61095345e-01 4.34663370e-02 2.71928430e-01 2.73152471e-01
 2.53935844e-01 1.37394682e-01 6.66738534e-03 9.43712294e-02
 1.60507515e-01 2.37428080e-02 6.96912222e-03 2.37431116e-02
 6.66730898e-03 1.24353871e-01 1.25855014e-01 2.43334342e-02
 8.28396901e-03 4.28816788e-02 8.61715376e-02 2.33051274e-02
 1.81710660e-01 1.30211383e-01 6.76660016e-02 4.15905565e-02
 1.84431039e-02 2.66998950e-02 6.51217997e-01 1.75036401e-01
 2.60525458e-02 9.52326953e-02 4.77041863e-02 3.93190458e-02
 2.65343115e-02 1.69377267e-01 8.81927554e-03 9.26547050e-02
 4.77194823e-02 5.44669218e-02 7.84171522e-02 3.11947167e-01
 1.83300171e-02 2.30636857e-02 5.58037031e-03 1.30900562e-01
 1.69096980e-02 1.83300171e-02 5.18655106e-02 2.77324140e-01
 8.85240957e-02 2.40413379e-02 9.45524201e-02 8.01867247e-02
 4.80265953e-02 3.63076866e-01 2.60769993e-01 2.24960390e-02
 4.58790623e-02 1.24438792e-01 1.58726983e-02 8.66310745e-02
 1.53088570e-02 1.27207279e-01 2.82200612e-02 6.96729170e-03
 8.90872814e-03 2.87117157e-02 1.27541274e-01 8.12069625e-02
 1.70225706e-02 6.96674827e-03 1.12239867e-01 9.71386656e-02
 2.90204752e-02 2.23307889e-02 3.33652832e-02 5.94452908e-03
 5.62042236e-01 2.35653386e-01 1.36732133e-02 2.13061571e-02
 6.80313781e-02 5.17228572e-03 3.10661584e-01 1.36879489e-01
 5.12025692e-02 4.44707163e-02 1.03946608e-02 3.08340788e-02
 6.85799420e-02 7.25468323e-02 1.53088775e-02 2.50869125e-01
 4.84266467e-02 3.66071016e-02 4.80344355e-01 8.43120888e-02
 5.10898829e-02 5.94450720e-03 4.21020724e-02 1.10675335e-01
 6.63955975e-03 2.66233124e-02 1.69096943e-02 4.71922234e-02
 5.12025692e-02 3.10662717e-01 6.63955975e-03 3.33652832e-02
 1.41702592e-02 4.61859033e-02 1.54020600e-02 2.88465563e-02
 4.63179126e-02 3.66075411e-02 4.64411005e-02 8.12373776e-03
 7.99183454e-03 3.61290514e-01 2.82204766e-02 8.77924633e+00
 2.95490734e-02 3.78163606e-02 1.46439625e-02 1.46440016e-02
 2.44551338e-02 7.40469322e-02 4.37366292e-02 1.66830763e-01
 1.03607625e-01 2.07813904e-02 9.88595039e-02 2.36606579e-02
 2.16601621e-02 5.52525520e-02 5.88445514e-02 4.76988666e-02
 6.39692321e-02 8.79447069e-03 3.10661763e-01 2.95523442e-02
 7.06288934e-01 1.14194602e-01 4.52473983e-02 1.00506932e-01
 1.59305297e-02 6.63955975e-03 4.38508317e-02 3.43534499e-02
 4.67233509e-02 4.97754849e-02 6.90555349e-02 1.79142937e-01
 6.68829260e-03 4.45294790e-02 1.27432737e-02 6.15206361e-02
 3.19658257e-02 3.13903093e-02 9.84037947e-03 1.28268702e-02
 4.09677215e-02 1.53089147e-02 8.33486542e-02 7.60410503e-02
 1.50473684e-01 9.34861507e-03 7.55715789e-03 3.19658257e-02
 6.63955975e-03 3.60788219e-02 1.19904995e-01 1.10881012e-02
 5.15198335e-02 3.07767428e-02 8.50996450e-02 2.30311193e-02
 3.42053995e-02 1.53088402e-02 1.53088290e-02 6.39691204e-02
 3.32305916e-02 7.55715789e-03 6.63955975e-03 1.95197299e-01
 1.03726633e-01 4.05346565e-02 9.64831468e-03 2.08804831e-02
 1.15871923e-02 2.56486945e-02 2.16209255e-02 4.87351008e-02
 9.64830909e-03 1.35866916e-02 1.15757994e-01 8.98966193e-03
 8.33487436e-02 2.09899545e-02 3.52549814e-02 3.17143276e-02
 6.67420309e-03 7.32071185e-03 9.71287861e-02 1.46439970e-02
 3.31883579e-02 8.90867040e-02 2.02104058e-02 3.92011739e-02
 4.93359603e-02 6.64593279e-02 3.35433073e-02 4.02272195e-01
 3.35434340e-02 1.53053412e-02 2.04156637e-01 1.42927364e-01
 3.61381695e-02 1.36736393e-01 1.23373596e-02 1.23125702e-01
 1.47498846e-02 1.07576378e-01 2.44551338e-02 4.91567850e-02
 1.59311935e-01 1.46976989e-02 3.14729996e-02 5.54627590e-02
 2.46929545e-02 2.25713681e-02 2.82523960e-01 5.14259450e-02
 7.40469322e-02 3.26893896e-01 7.08529651e-02 2.42053568e-02
 4.52728197e-02 1.15871923e-02 6.19097352e-01 1.26692019e-02
 2.42597628e-02 1.46440538e-02 2.95523442e-02 4.64124084e-01
 3.12156938e-02 6.66563809e-02 9.31034144e-03 1.65435132e-02
 4.07893397e-03 4.07891860e-03 4.07891860e-03 1.23523716e-02
 4.95463535e-02 6.66563809e-02 4.07891860e-03 4.43844087e-02
 4.07891860e-03 4.53818031e-02 4.45758663e-02 4.19627354e-02
 2.29525402e-01 5.34780994e-02 3.31900083e-02 3.01083066e-02
 3.94465663e-02 1.50624057e-02 2.03316156e-02 9.31034610e-03
 4.07180563e-02 1.54061958e-01 2.15152979e-01 3.58576216e-02
 4.84927557e-02 4.84927967e-02 2.22651109e-01 3.02776694e-02
 4.07891860e-03 1.23373233e-02 4.07891860e-03 1.23523679e-02
 5.09486124e-02 8.61637387e-03 7.92893395e-02 4.78198146e-03
 6.66562393e-02 2.05246992e-02 4.78198146e-03 4.95727286e-02
 1.90386754e-02 2.50160359e-02 9.31032095e-03 2.39903554e-02
 3.97258960e-02 3.76714617e-02 4.07893397e-03 2.00878549e-02
 4.83190902e-02 6.30758703e-02 1.91312693e-02 6.67422730e-03
 7.62520730e-02 4.07891860e-03 4.57640737e-03 2.19447345e-01
 4.70709130e-02 5.36789047e-03 2.72548199e-01 2.16064341e-02
 9.31033120e-03 2.96483994e-01 8.47231150e-02 1.07076816e-01
 1.36384880e-02 1.07131507e-02 3.01472247e-02 1.80574432e-02
 1.63085926e-02 5.00220284e-02 2.56501045e-02 5.04951365e-02
 7.18619721e-03 8.11215211e-03 1.06165692e-01 4.07891860e-03
 9.31033306e-03 4.23989631e-02 5.60347829e-03 3.06424070e-02
 4.34888341e-02 1.06753195e-02 4.54688258e-02 1.18915960e-01
 2.78175548e-02 4.07891860e-03 1.45698771e-01 3.36834043e-02
 1.26103805e-02 1.09894283e-01 2.73593552e-02 2.73593552e-02
 2.73593552e-02 2.96227753e-01 3.68807348e-03 3.58960718e-01
 4.36388738e-02 7.41572678e-02 9.81099755e-02 3.68807348e-03
 1.22791734e-02 1.26104662e-02 2.59232875e-02 6.33401517e-03
 1.26103368e-02 4.19482961e-02 2.73593552e-02 1.26103796e-02
 3.68807348e-03 2.73593422e-02 2.73593552e-02 1.56007707e-02
 2.03767586e-02 2.73593552e-02 8.76814052e-02 2.72246413e-02
 1.77034494e-02 7.07857125e-03 1.06036989e-02 5.78317931e-03
 1.20501645e-01 4.06816341e-02 1.04981931e-02 3.05127874e-02
 8.50421265e-02 2.05045212e-02 3.85672674e-02 2.60359850e-02
 2.96378173e-02 3.15099470e-02 1.00771174e-01 2.73593552e-02
 7.04949116e-03 3.26757357e-02 1.25986502e-01 4.12333421e-02
 5.99676631e-02 9.09684319e-03 2.06599578e-01 6.73062308e-03
 3.66390981e-02 5.72164468e-02 9.63595584e-02 5.45713492e-03
 3.18125635e-02 7.15019833e-03 1.78566538e-02 6.76597422e-03
 9.05293319e-03 4.48568091e-02 6.76597422e-03 2.42848024e-02
 5.78317931e-03 1.72686949e-02 2.74136048e-02 3.48271616e-02
 1.23005155e-02 8.44262633e-03 5.42413257e-03 5.23192249e-02
 5.42413257e-03 8.44255649e-03 8.12289957e-03 2.03965101e-02
 5.82881570e-02 3.11254486e-02 8.12289957e-03 1.23005202e-02
 1.10499104e-02 2.25183904e-01 2.90561747e-02 1.06025366e-02
 2.03964803e-02 1.23005379e-02 6.17099414e-03 1.16298972e-02
 2.00310070e-02 1.99475899e-01 2.22996399e-02 5.45713492e-03
 1.10876217e-01 1.03960950e-02 6.76597422e-03 7.31458962e-02
 1.96446646e-02 2.19731852e-01 1.16328066e-02 6.17099414e-03
 2.57248990e-02 6.74220640e-03 1.51041418e-01 6.78351009e-03
 1.13072870e-02 3.79976302e-01 3.39992484e-03 1.16298785e-02
 2.53397822e-01 6.74220640e-03 2.21498206e-01 1.47167984e-02
 8.00929684e-03 4.99041602e-02 3.07334936e-03 4.17236775e-01
 8.18216987e-03 6.76597422e-03 1.20167686e-02 7.09106354e-03
 7.09106354e-03 8.09712801e-03 4.69435863e-02 1.65102649e-02
 3.07334936e-03 6.07692497e-03 5.31980991e-02 3.98036726e-02
 5.33143096e-02 9.09684412e-03 3.07334936e-03 5.47203906e-02
 8.00929684e-03 1.13073085e-02 3.53822075e-02 1.29670411e-01
 5.33142239e-02 3.70903686e-02 1.65103376e-02 2.19163001e-02
 3.39992484e-03 1.16298972e-02 1.13072693e-02 1.15623707e-02
 4.33426239e-02 3.11442427e-02 3.39992484e-03 3.31992172e-02
 3.39989667e-03 4.37988900e-02 6.07431605e-02 6.07695337e-03
 5.03535289e-03 2.76597083e-01 5.10009564e-02 3.24459327e-03
 6.50971115e-01 3.24459327e-03 3.24456301e-03 3.24459327e-03
 3.24459327e-03 3.24456301e-03 3.24459327e-03 3.24459327e-03
 7.18014874e-03 4.80686454e-03 2.04642396e-02 3.24459327e-03
 3.24456301e-03 3.24459327e-03 3.24459327e-03 3.24459327e-03
 3.24459327e-03 3.24459327e-03 3.24459327e-03 3.24459327e-03
 5.26212202e-03 3.24459327e-03 3.24456301e-03 1.14768624e-01
 3.24459327e-03 5.58170192e-02 6.69227168e-02 3.39992484e-03
 5.98928295e-02 4.76469807e-02 2.89412409e-01 2.89412409e-01
 3.83821689e-02 5.98928295e-02 3.39992484e-03 3.07334936e-03
 3.07334936e-03 5.58322258e-02 3.07334936e-03 3.17671970e-02
 2.77531818e-02 3.24459327e-03 9.09684412e-03 3.39989667e-03
 7.09106354e-03 3.39992484e-03 3.39992484e-03 3.48500386e-02
 3.39992484e-03 3.07334936e-03 3.39992484e-03 3.39992484e-03
 6.33640513e-02 3.07334936e-03 3.39992484e-03 3.07334936e-03
 3.39992484e-03 3.39989667e-03 3.39992484e-03 3.31129171e-02
 1.29369330e-02 9.85253416e-03 3.24459327e-03 2.24879701e-02
 8.28083232e-02 3.39992484e-03 3.07334936e-03 2.05115844e-02
 3.24456301e-03 2.06445828e-02 1.69044733e-02 3.43836006e-03
 3.39989667e-03 3.39992484e-03 1.82397645e-02 3.82826887e-02
 1.11408206e-02 3.39992484e-03 7.18015339e-03 6.24745665e-03
 3.07334936e-03 1.11060135e-01 3.24456301e-03 1.58461705e-02
 3.70905139e-02 3.24459327e-03 3.24459327e-03 7.18011474e-03
 6.24745665e-03 3.39992484e-03 3.20367336e-01 2.17828713e-02
 1.69621464e-02 3.82826887e-02 1.50403613e-02 2.67906412e-02
 2.67905928e-02 6.65826872e-02 9.10494290e-03 3.24459327e-03
 7.43821543e-03 3.56062911e-02 3.82826887e-02 9.64729208e-03
 1.17555121e-02 1.38716120e-02 3.19737988e-03 3.19737988e-03
 3.19737988e-03 3.19737988e-03 3.19737988e-03 4.93256142e-03
 3.64274867e-02 3.19737988e-03 3.19737988e-03 3.24459327e-03
 5.35975350e-03 3.24459327e-03 2.67905928e-02 3.07821538e-02
 6.04980551e-02 1.83160659e-02 8.09849277e-02 2.78977584e-02
 5.26213460e-03 1.42899845e-02 5.26214112e-03 3.24459327e-03
 2.67906412e-02 7.97182508e-03 2.73044035e-03 2.73045991e-03
 3.19737988e-03 7.97182508e-03 2.58214436e-02 1.87223814e-02
 1.43912965e-02 3.24459327e-03 3.19737988e-03 1.77051257e-02
 2.73044035e-03 4.26822975e-02 6.51979214e-03 3.89742032e-02
 4.93257307e-03 2.09571391e-01 6.11683913e-03 1.15406007e-01
 9.55544878e-03 6.51979214e-03 6.60553016e-03 7.86452368e-03
 6.45388849e-03 5.81988879e-03 2.75031216e-02 1.19195003e-02
 2.69435644e-02 6.51979772e-03 6.51979772e-03 6.51979772e-03
 5.41444076e-03 1.77051257e-02 6.51979772e-03 6.45388849e-03
 6.51979772e-03 6.51979772e-03 6.51979214e-03 9.99136269e-03
 7.83517398e-03 2.22470500e-02 2.86839977e-02 3.44884470e-02
 2.96382345e-02 3.16027850e-02 2.25212071e-02 3.30411732e-01
 6.46952819e-03 7.88628403e-03 5.27334306e-03 1.93193525e-01
 2.95926239e-02 6.45388849e-03 9.88046080e-02 1.28916830e-01
 6.47015031e-03 3.23528470e-03 2.07151975e-02 9.34964493e-02
 8.03204533e-03 8.03204533e-03 8.03204533e-03 3.39222909e-03
 5.03110653e-03 7.22913742e-02 9.30880681e-02 2.74063766e-01
 2.32163686e-02 4.50875843e-03 9.05495416e-03 3.23526724e-03
 7.81307183e-03 1.05813285e-02 5.09443693e-03 4.21609916e-02
 6.47015031e-03 1.28919229e-01 3.23526724e-03 1.05814254e-02
 2.44115032e-02 8.19056556e-02 8.03204533e-03 3.39222909e-03
 5.09443693e-03 1.17001412e-02 3.13104540e-02 3.39222909e-03
 3.39222909e-03 3.39222909e-03 7.91265666e-02 7.80742049e-01
 1.54255700e+00 8.03204533e-03 8.91739652e-02 3.39219742e-03
 3.44434902e-02 6.59386162e-03 4.18374598e-01 1.38411280e-02
 3.39222909e-03 3.65196378e-03 7.14778760e-03 6.47190306e-03
 4.40211564e-01 1.38411075e-02 9.50682908e-02 2.97099669e-02
 2.39318050e-02 1.38411280e-02 3.14218439e-02 3.31542045e-02
 1.89137198e-02 2.57503204e-02 7.54327327e-03 6.56128163e-03
 6.56127045e-03 1.19477481e-01 3.17311108e-01 1.19455196e-01
 1.38411280e-02 1.89137105e-02 1.38411280e-02 3.97357671e-03
 6.78065699e-03 6.78065699e-03 4.95996280e-03 3.48434485e-02
 4.02947236e-03 6.78065699e-03 3.97357671e-03 6.73735142e-02
 6.78065699e-03 6.78065699e-03 4.01370274e-03 7.58347893e-03
 3.58827785e-02 3.69677432e-02 6.78065699e-03 1.43778063e-02
 6.73735142e-02 6.78065699e-03 7.10385852e-03 7.17628887e-03
 3.64552205e-03 3.64552205e-03 8.08525160e-02 1.02858860e-02
 6.78065699e-03 1.02858860e-02 7.48553220e-03 4.39718142e-02
 8.23321566e-02 6.78065699e-03 2.20559657e-01 8.54240917e-03
 8.54248088e-03 4.37870510e-02 1.15479566e-02 1.55046787e-02
 7.10385852e-03 2.86741871e-02 5.18061640e-03 3.74156199e-02
 2.05671862e-02 3.74156199e-02 3.05959374e-01 3.98333604e-03
 2.05671862e-02 5.04788430e-03 5.04788430e-03 4.22718048e-01
 5.04788430e-03 3.93657275e-02 4.46986081e-03 3.60167474e-02
 1.33610787e-02 3.98333604e-03 1.33610787e-02 1.13864653e-01
 3.24194916e-02 9.25147459e-02 5.04788430e-03 1.03031211e-02
 9.99963563e-03 5.04788430e-03 3.28445584e-02 3.32277454e-02
 2.99765225e-02 3.98331927e-03 5.04788430e-03 2.83483595e-01
 3.24587012e-03 8.79136194e-03 5.04788430e-03 7.52898306e-03
 1.37998527e-02 7.52898306e-03 8.79137404e-03 7.52898306e-03
 1.72330141e-02 4.25445959e-02 4.67225052e-02 5.04788430e-03
 4.06194329e-02 8.79137404e-03 5.04788430e-03 4.06837463e-01
 8.79137404e-03 7.52898306e-03 8.79137404e-03 3.24587012e-03
 3.24587012e-03 1.25653530e-02 3.24587012e-03 5.04788430e-03
 3.25085549e-03 8.79137404e-03 1.18244532e-02 1.03667408e-01
 3.25085549e-03 3.24587012e-03 5.04788430e-03 1.28166527e-02
 5.27725779e-02 3.99855375e-02 3.99855375e-02 5.71211381e-03
 4.31320444e-02 4.96919565e-02 2.00312026e-02 2.80942053e-01
 3.99855375e-02 7.93736894e-03 3.99855375e-02 9.82671417e-03
 2.00312044e-02 3.99855226e-02 6.52824109e-03 3.62397847e-03
 2.73966268e-02 2.02277745e-03 8.45260266e-03 4.39500529e-03
 5.40889949e-02 1.04329530e-02 7.46960612e-03 7.46960612e-03
 2.09137499e-02 2.55853347e-02 7.46960612e-03 7.46960612e-03
 2.60197446e-02 4.68232892e-02 7.46960612e-03 7.46960612e-03
 7.46960612e-03 7.46960612e-03 2.55853590e-02 2.55854316e-02
 2.55853720e-02 2.55854074e-02 2.69821007e-02 2.35213339e-02
 2.55854372e-02 2.55853832e-02 2.69820932e-02 7.46960612e-03
 2.53877103e-01 2.69821957e-02 1.11985235e-02 2.55854633e-02
 8.98013823e-03 3.16614769e-02 6.84956461e-02 7.46960612e-03
 6.72000647e-02 3.16612273e-02 9.57454145e-02 4.72658910e-02
 4.72658910e-02 1.20496601e-02 4.72658910e-02 4.72658910e-02
 9.66897979e-03 5.21023721e-02 5.12453988e-02 9.74082481e-03
 9.74082481e-03 3.92797999e-02 2.87682675e-02 5.96912242e-02
 9.74078383e-03 5.15786707e-01 5.12453988e-02 1.20495511e-02
 6.30312115e-02 9.74082481e-03 8.33456367e-02 9.74078383e-03
 5.12454174e-02 1.34422043e-02 2.87682675e-02 5.96913733e-02
 5.12453988e-02 5.12454174e-02 2.87682675e-02 9.74078383e-03
 5.12453988e-02 5.12453988e-02 9.74082481e-03 1.34422043e-02
 5.94955496e-02 9.74082481e-03 3.15849371e-02 1.05746044e-02
 1.34422043e-02 1.05746044e-02 5.59425317e-02 5.59425317e-02]
2025-06-02 15:46:29,314 - DEBUG - Edge reconstruction errors: [ 5.263985   5.2614965 44.25776   ... 13.35774    2.158624  13.35774  ]
2025-06-02 15:46:29,316 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154629_update_48.json
2025-06-02 15:46:29,316 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:46:29,325 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154629_update_48.pth and as latest_checkpoint.pth
2025-06-02 15:46:29,325 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.6323
2025-06-02 15:46:29,325 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:46:29,325 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.0422, MLP Score: 0.5027
2025-06-02 15:46:29,325 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.3308, MLP Score: 0.5040
2025-06-02 15:46:29,325 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.6125, MLP Score: 0.5023
2025-06-02 15:46:29,326 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.7792, MLP Score: 0.5027
2025-06-02 15:46:29,326 - WARNING -   Node ID: 142.250.76.14, Recon Error: 1.5426, MLP Score: 0.4425
2025-06-02 15:46:29,326 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:46:29,326 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2578, MLP Score: 0.1060
2025-06-02 15:46:29,326 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0142
2025-06-02 15:46:29,326 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0599, MLP Score: 0.0142
2025-06-02 15:46:29,326 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0033
2025-06-02 15:46:29,326 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7581, MLP Score: 0.0019
2025-06-02 15:46:29,326 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-02 15:46:29,326 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 15:46:29,326 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:46:29,326 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 15:46:29,356 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:46:29,382 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 15:46:29,382 - INFO - Processing node updates/additions.
2025-06-02 15:46:29,388 - INFO - Processing edge updates/additions.
2025-06-02 15:46:29,399 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:46:29,400 - INFO - Finished updating NetworkX graph.
2025-06-02 15:46:29,401 - DEBUG - Updated graph - Nodes: 1002, Edges: 2201
2025-06-02 15:46:29,401 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:46:29,402 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:46:29,411 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-02 15:46:29,412 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:46:29,412 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-02 15:46:29,415 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-02 15:46:29,417 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:46:29,421 - DEBUG - Initial edge attributes tensor shape: torch.Size([2201, 10])
2025-06-02 15:46:29,422 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:46:29,422 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2201, 10])
2025-06-02 15:46:29,423 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:46:29,423 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:46:29,424 - INFO - Updated main graph to 1002 nodes and 2201 edges.
2025-06-02 15:46:29,424 - INFO - Performing online update...
2025-06-02 15:46:29,424 - INFO - Starting online update for 25 steps.
2025-06-02 15:46:29,424 - DEBUG - Updated RunningStats: new_mean=0.94498078497351, new_var=28200000000161.395, new_n=2850
2025-06-02 15:46:29,425 - DEBUG - Updated RunningStats: new_mean=0.9428342472347508, new_var=28500000000018.305, new_n=2880
2025-06-02 15:46:29,425 - DEBUG - Updated RunningStats: new_mean=44.78971682909302, new_var=9400000186536.402, new_n=950
2025-06-02 15:46:29,425 - DEBUG - Updated RunningStats: new_mean=44.78387076441833, new_var=9500000169920.123, new_n=960
2025-06-02 15:46:29,425 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:46:29,425 - DEBUG - Online update step: 1/25
2025-06-02 15:46:29,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:29,560 - DEBUG - Node anomaly scores shape: torch.Size([20256, 1])
2025-06-02 15:46:29,575 - DEBUG - Edge anomaly scores shape: torch.Size([42729, 1])
2025-06-02 15:46:29,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:29,829 - DEBUG - Step 1: Loss=0.6445
2025-06-02 15:46:29,829 - DEBUG - Online update step: 2/25
2025-06-02 15:46:29,836 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:29,936 - DEBUG - Node anomaly scores shape: torch.Size([18737, 1])
2025-06-02 15:46:29,940 - DEBUG - Edge anomaly scores shape: torch.Size([39351, 1])
2025-06-02 15:46:29,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:30,193 - DEBUG - Step 2: Loss=0.6565
2025-06-02 15:46:30,194 - DEBUG - Online update step: 3/25
2025-06-02 15:46:30,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:30,310 - DEBUG - Node anomaly scores shape: torch.Size([19684, 1])
2025-06-02 15:46:30,315 - DEBUG - Edge anomaly scores shape: torch.Size([41374, 1])
2025-06-02 15:46:30,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:30,533 - DEBUG - Step 3: Loss=0.6733
2025-06-02 15:46:30,534 - DEBUG - Online update step: 4/25
2025-06-02 15:46:30,540 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:30,646 - DEBUG - Node anomaly scores shape: torch.Size([19775, 1])
2025-06-02 15:46:30,652 - DEBUG - Edge anomaly scores shape: torch.Size([41489, 1])
2025-06-02 15:46:30,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:30,897 - DEBUG - Step 4: Loss=0.6458
2025-06-02 15:46:30,898 - DEBUG - Online update step: 5/25
2025-06-02 15:46:30,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:31,041 - DEBUG - Node anomaly scores shape: torch.Size([20647, 1])
2025-06-02 15:46:31,051 - DEBUG - Edge anomaly scores shape: torch.Size([43581, 1])
2025-06-02 15:46:31,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:31,420 - DEBUG - Step 5: Loss=0.6551
2025-06-02 15:46:31,421 - DEBUG - Online update step: 6/25
2025-06-02 15:46:31,425 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:31,826 - DEBUG - Node anomaly scores shape: torch.Size([20003, 1])
2025-06-02 15:46:31,830 - DEBUG - Edge anomaly scores shape: torch.Size([41957, 1])
2025-06-02 15:46:31,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:32,384 - DEBUG - Step 6: Loss=0.6719
2025-06-02 15:46:32,384 - DEBUG - Online update step: 7/25
2025-06-02 15:46:32,388 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:32,471 - DEBUG - Node anomaly scores shape: torch.Size([17748, 1])
2025-06-02 15:46:32,475 - DEBUG - Edge anomaly scores shape: torch.Size([36819, 1])
2025-06-02 15:46:32,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:32,696 - DEBUG - Step 7: Loss=0.6448
2025-06-02 15:46:32,696 - DEBUG - Online update step: 8/25
2025-06-02 15:46:32,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:32,844 - DEBUG - Node anomaly scores shape: torch.Size([18925, 1])
2025-06-02 15:46:32,849 - DEBUG - Edge anomaly scores shape: torch.Size([39814, 1])
2025-06-02 15:46:32,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:33,216 - DEBUG - Step 8: Loss=0.6549
2025-06-02 15:46:33,216 - DEBUG - Online update step: 9/25
2025-06-02 15:46:33,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:33,460 - DEBUG - Node anomaly scores shape: torch.Size([20321, 1])
2025-06-02 15:46:33,473 - DEBUG - Edge anomaly scores shape: torch.Size([42734, 1])
2025-06-02 15:46:33,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:33,716 - DEBUG - Step 9: Loss=0.6714
2025-06-02 15:46:33,716 - DEBUG - Online update step: 10/25
2025-06-02 15:46:33,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:33,833 - DEBUG - Node anomaly scores shape: torch.Size([20656, 1])
2025-06-02 15:46:33,838 - DEBUG - Edge anomaly scores shape: torch.Size([43536, 1])
2025-06-02 15:46:33,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:34,058 - DEBUG - Step 10: Loss=0.6377
2025-06-02 15:46:34,059 - DEBUG - Online update step: 11/25
2025-06-02 15:46:34,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:34,157 - DEBUG - Node anomaly scores shape: torch.Size([19170, 1])
2025-06-02 15:46:34,162 - DEBUG - Edge anomaly scores shape: torch.Size([40378, 1])
2025-06-02 15:46:34,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:34,368 - DEBUG - Step 11: Loss=0.6541
2025-06-02 15:46:34,368 - DEBUG - Online update step: 12/25
2025-06-02 15:46:34,372 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:34,470 - DEBUG - Node anomaly scores shape: torch.Size([19509, 1])
2025-06-02 15:46:34,475 - DEBUG - Edge anomaly scores shape: torch.Size([40708, 1])
2025-06-02 15:46:34,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:34,694 - DEBUG - Step 12: Loss=0.7316
2025-06-02 15:46:34,694 - DEBUG - Online update step: 13/25
2025-06-02 15:46:34,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:34,800 - DEBUG - Node anomaly scores shape: torch.Size([19815, 1])
2025-06-02 15:46:34,805 - DEBUG - Edge anomaly scores shape: torch.Size([41737, 1])
2025-06-02 15:46:34,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:35,035 - DEBUG - Step 13: Loss=0.6373
2025-06-02 15:46:35,035 - DEBUG - Online update step: 14/25
2025-06-02 15:46:35,038 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:35,121 - DEBUG - Node anomaly scores shape: torch.Size([18482, 1])
2025-06-02 15:46:35,124 - DEBUG - Edge anomaly scores shape: torch.Size([38714, 1])
2025-06-02 15:46:35,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:35,304 - DEBUG - Step 14: Loss=0.6649
2025-06-02 15:46:35,304 - DEBUG - Online update step: 15/25
2025-06-02 15:46:35,307 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:35,412 - DEBUG - Node anomaly scores shape: torch.Size([19002, 1])
2025-06-02 15:46:35,418 - DEBUG - Edge anomaly scores shape: torch.Size([39636, 1])
2025-06-02 15:46:35,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:35,635 - DEBUG - Step 15: Loss=0.6824
2025-06-02 15:46:35,635 - DEBUG - Online update step: 16/25
2025-06-02 15:46:35,638 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:35,731 - DEBUG - Node anomaly scores shape: torch.Size([17631, 1])
2025-06-02 15:46:35,736 - DEBUG - Edge anomaly scores shape: torch.Size([36794, 1])
2025-06-02 15:46:35,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:35,908 - DEBUG - Step 16: Loss=0.6550
2025-06-02 15:46:35,908 - DEBUG - Online update step: 17/25
2025-06-02 15:46:35,911 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:36,003 - DEBUG - Node anomaly scores shape: torch.Size([17330, 1])
2025-06-02 15:46:36,007 - DEBUG - Edge anomaly scores shape: torch.Size([36099, 1])
2025-06-02 15:46:36,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:36,207 - DEBUG - Step 17: Loss=0.6552
2025-06-02 15:46:36,208 - DEBUG - Online update step: 18/25
2025-06-02 15:46:36,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:36,312 - DEBUG - Node anomaly scores shape: torch.Size([20092, 1])
2025-06-02 15:46:36,318 - DEBUG - Edge anomaly scores shape: torch.Size([42107, 1])
2025-06-02 15:46:36,320 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:36,624 - DEBUG - Step 18: Loss=0.6710
2025-06-02 15:46:36,624 - DEBUG - Online update step: 19/25
2025-06-02 15:46:36,627 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:36,775 - DEBUG - Node anomaly scores shape: torch.Size([18013, 1])
2025-06-02 15:46:36,779 - DEBUG - Edge anomaly scores shape: torch.Size([37515, 1])
2025-06-02 15:46:36,780 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:36,954 - DEBUG - Step 19: Loss=0.6446
2025-06-02 15:46:36,954 - DEBUG - Online update step: 20/25
2025-06-02 15:46:36,957 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:37,064 - DEBUG - Node anomaly scores shape: torch.Size([19872, 1])
2025-06-02 15:46:37,073 - DEBUG - Edge anomaly scores shape: torch.Size([41741, 1])
2025-06-02 15:46:37,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:37,265 - DEBUG - Step 20: Loss=0.6672
2025-06-02 15:46:37,266 - DEBUG - Online update step: 21/25
2025-06-02 15:46:37,269 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:37,375 - DEBUG - Node anomaly scores shape: torch.Size([19251, 1])
2025-06-02 15:46:37,380 - DEBUG - Edge anomaly scores shape: torch.Size([40348, 1])
2025-06-02 15:46:37,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:37,581 - DEBUG - Step 21: Loss=0.6874
2025-06-02 15:46:37,581 - DEBUG - Online update step: 22/25
2025-06-02 15:46:37,584 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:37,693 - DEBUG - Node anomaly scores shape: torch.Size([19750, 1])
2025-06-02 15:46:37,699 - DEBUG - Edge anomaly scores shape: torch.Size([41645, 1])
2025-06-02 15:46:37,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:38,040 - DEBUG - Step 22: Loss=0.6607
2025-06-02 15:46:38,041 - DEBUG - Online update step: 23/25
2025-06-02 15:46:38,045 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:38,400 - DEBUG - Node anomaly scores shape: torch.Size([18622, 1])
2025-06-02 15:46:38,404 - DEBUG - Edge anomaly scores shape: torch.Size([39143, 1])
2025-06-02 15:46:38,405 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:38,557 - DEBUG - Step 23: Loss=0.6585
2025-06-02 15:46:38,557 - DEBUG - Online update step: 24/25
2025-06-02 15:46:38,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:38,698 - DEBUG - Node anomaly scores shape: torch.Size([19998, 1])
2025-06-02 15:46:38,704 - DEBUG - Edge anomaly scores shape: torch.Size([42105, 1])
2025-06-02 15:46:38,705 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:38,878 - DEBUG - Step 24: Loss=0.6731
2025-06-02 15:46:38,878 - DEBUG - Online update step: 25/25
2025-06-02 15:46:38,882 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:39,020 - DEBUG - Node anomaly scores shape: torch.Size([18059, 1])
2025-06-02 15:46:39,024 - DEBUG - Edge anomaly scores shape: torch.Size([37803, 1])
2025-06-02 15:46:39,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:39,269 - DEBUG - Step 25: Loss=0.6476
2025-06-02 15:46:39,270 - INFO - Online update finished. Average loss: 0.6619, Learning rate: 0.001000
2025-06-02 15:46:39,270 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], current edge mean: [-8.6658275e-10  4.5525443e+02  0.0000000e+00  0.0000000e+00
  1.5165198e-09 -3.0330396e-09  6.4993708e-09 -4.4412367e-09
  2.8163940e-09  3.0330396e-09]
2025-06-02 15:46:39,271 - DEBUG - Node drift difference: 0.0196, Edge drift difference: 0.0003
2025-06-02 15:46:39,272 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], edge=[-8.6658275e-10  4.5525443e+02  0.0000000e+00  0.0000000e+00
  1.5165198e-09 -3.0330396e-09  6.4993708e-09 -4.4412367e-09
  2.8163940e-09  3.0330396e-09]
2025-06-02 15:46:39,272 - DEBUG - Updated reference std: node=[0.         0.         1.0004994  1.0004994  0.         0.
 0.         1.0004994  1.0004994  1.0004994  1.0004994  1.0004994
 0.93571764 0.27291828 0.3706852  0.573176   1.0004994  3.0238457
 2.9087992  1.4844369  0.3706852  0.2211384  1.0004994  1.0004994
 0.         0.         0.         0.         1.0004994  1.0004994 ], edge=[  1.0002272 435.28336     0.          0.          1.0002272   1.0002272
   1.0002272   1.0002272   1.0002272   1.0002272]
2025-06-02 15:46:39,273 - INFO - Online update complete. Loss: 0.6619
2025-06-02 15:46:39,273 - INFO - Running anomaly detection...
2025-06-02 15:46:39,273 - INFO - Starting anomaly detection.
2025-06-02 15:46:39,316 - DEBUG - Node reconstruction errors: [0.29960635 1.4437667  2.040324   ... 0.0659211  0.06270098 0.06164145]
2025-06-02 15:46:39,317 - DEBUG - Edge reconstruction errors: [ 5.264103   5.2616024 44.257847  ... 13.357831   2.1587172 13.357831 ]
2025-06-02 15:46:39,331 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154639_update_49.json
2025-06-02 15:46:39,332 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:46:39,357 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154639_update_49.pth and as latest_checkpoint.pth
2025-06-02 15:46:39,358 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.6754
2025-06-02 15:46:39,358 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:46:39,358 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4438, MLP Score: 0.5802
2025-06-02 15:46:39,358 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.0403, MLP Score: 0.4971
2025-06-02 15:46:39,358 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.4320, MLP Score: 0.5046
2025-06-02 15:46:39,358 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.6316, MLP Score: 0.5003
2025-06-02 15:46:39,358 - WARNING -   Node ID: 142.250.71.227, Recon Error: 8.1656, MLP Score: 0.4982
2025-06-02 15:46:39,358 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:46:39,358 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.9681
2025-06-02 15:46:39,359 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9518
2025-06-02 15:46:39,359 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9518
2025-06-02 15:46:39,359 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.8435
2025-06-02 15:46:39,359 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.7877
2025-06-02 15:46:39,359 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-02 15:46:39,359 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 15:46:39,359 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:46:39,359 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 15:46:39,393 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:46:39,427 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 15:46:39,427 - INFO - Processing node updates/additions.
2025-06-02 15:46:39,436 - INFO - Processing edge updates/additions.
2025-06-02 15:46:39,453 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:46:39,455 - INFO - Finished updating NetworkX graph.
2025-06-02 15:46:39,456 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:46:39,456 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:46:39,458 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:46:39,470 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:46:39,475 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:46:39,475 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:46:39,477 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:46:39,479 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:46:39,491 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:46:39,500 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:46:39,505 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:46:39,505 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:46:39,506 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:46:39,508 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:46:39,508 - INFO - Performing online update...
2025-06-02 15:46:39,508 - INFO - Starting online update for 25 steps.
2025-06-02 15:46:39,509 - DEBUG - Updated RunningStats: new_mean=0.9450520328433731, new_var=28800000000161.414, new_n=2910
2025-06-02 15:46:39,509 - DEBUG - Updated RunningStats: new_mean=0.942950469417523, new_var=29100000000018.3, new_n=2940
2025-06-02 15:46:39,510 - DEBUG - Updated RunningStats: new_mean=44.79151010792172, new_var=9600000186531.814, new_n=970
2025-06-02 15:46:39,510 - DEBUG - Updated RunningStats: new_mean=44.785664218748245, new_var=9700000169842.979, new_n=980
2025-06-02 15:46:39,510 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:46:39,510 - DEBUG - Online update step: 1/25
2025-06-02 15:46:39,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:39,697 - DEBUG - Node anomaly scores shape: torch.Size([22087, 1])
2025-06-02 15:46:39,713 - DEBUG - Edge anomaly scores shape: torch.Size([46838, 1])
2025-06-02 15:46:39,716 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:40,027 - DEBUG - Step 1: Loss=0.6730
2025-06-02 15:46:40,027 - DEBUG - Online update step: 2/25
2025-06-02 15:46:40,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:40,141 - DEBUG - Node anomaly scores shape: torch.Size([19696, 1])
2025-06-02 15:46:40,148 - DEBUG - Edge anomaly scores shape: torch.Size([41361, 1])
2025-06-02 15:46:40,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:40,377 - DEBUG - Step 2: Loss=0.6880
2025-06-02 15:46:40,378 - DEBUG - Online update step: 3/25
2025-06-02 15:46:40,384 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:40,478 - DEBUG - Node anomaly scores shape: torch.Size([19201, 1])
2025-06-02 15:46:40,482 - DEBUG - Edge anomaly scores shape: torch.Size([40202, 1])
2025-06-02 15:46:40,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:40,706 - DEBUG - Step 3: Loss=0.6599
2025-06-02 15:46:40,706 - DEBUG - Online update step: 4/25
2025-06-02 15:46:40,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:40,823 - DEBUG - Node anomaly scores shape: torch.Size([21038, 1])
2025-06-02 15:46:40,827 - DEBUG - Edge anomaly scores shape: torch.Size([44454, 1])
2025-06-02 15:46:40,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:41,055 - DEBUG - Step 4: Loss=0.6578
2025-06-02 15:46:41,056 - DEBUG - Online update step: 5/25
2025-06-02 15:46:41,059 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:41,149 - DEBUG - Node anomaly scores shape: torch.Size([18169, 1])
2025-06-02 15:46:41,153 - DEBUG - Edge anomaly scores shape: torch.Size([37907, 1])
2025-06-02 15:46:41,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:41,350 - DEBUG - Step 5: Loss=0.6786
2025-06-02 15:46:41,350 - DEBUG - Online update step: 6/25
2025-06-02 15:46:41,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:41,438 - DEBUG - Node anomaly scores shape: torch.Size([18439, 1])
2025-06-02 15:46:41,442 - DEBUG - Edge anomaly scores shape: torch.Size([38420, 1])
2025-06-02 15:46:41,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:41,636 - DEBUG - Step 6: Loss=0.6507
2025-06-02 15:46:41,636 - DEBUG - Online update step: 7/25
2025-06-02 15:46:41,640 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:41,750 - DEBUG - Node anomaly scores shape: torch.Size([19375, 1])
2025-06-02 15:46:41,755 - DEBUG - Edge anomaly scores shape: torch.Size([40573, 1])
2025-06-02 15:46:41,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:41,974 - DEBUG - Step 7: Loss=0.6633
2025-06-02 15:46:41,974 - DEBUG - Online update step: 8/25
2025-06-02 15:46:41,977 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:42,073 - DEBUG - Node anomaly scores shape: torch.Size([19718, 1])
2025-06-02 15:46:42,079 - DEBUG - Edge anomaly scores shape: torch.Size([41460, 1])
2025-06-02 15:46:42,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:42,290 - DEBUG - Step 8: Loss=0.6785
2025-06-02 15:46:42,290 - DEBUG - Online update step: 9/25
2025-06-02 15:46:42,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:42,395 - DEBUG - Node anomaly scores shape: torch.Size([19606, 1])
2025-06-02 15:46:42,399 - DEBUG - Edge anomaly scores shape: torch.Size([41370, 1])
2025-06-02 15:46:42,400 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:42,596 - DEBUG - Step 9: Loss=0.6502
2025-06-02 15:46:42,596 - DEBUG - Online update step: 10/25
2025-06-02 15:46:42,600 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:42,695 - DEBUG - Node anomaly scores shape: torch.Size([18096, 1])
2025-06-02 15:46:42,699 - DEBUG - Edge anomaly scores shape: torch.Size([37793, 1])
2025-06-02 15:46:42,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:42,911 - DEBUG - Step 10: Loss=0.6615
2025-06-02 15:46:42,911 - DEBUG - Online update step: 11/25
2025-06-02 15:46:42,918 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:43,038 - DEBUG - Node anomaly scores shape: torch.Size([20973, 1])
2025-06-02 15:46:43,043 - DEBUG - Edge anomaly scores shape: torch.Size([44186, 1])
2025-06-02 15:46:43,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:43,318 - DEBUG - Step 11: Loss=0.6768
2025-06-02 15:46:43,319 - DEBUG - Online update step: 12/25
2025-06-02 15:46:43,324 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:43,432 - DEBUG - Node anomaly scores shape: torch.Size([20745, 1])
2025-06-02 15:46:43,438 - DEBUG - Edge anomaly scores shape: torch.Size([43632, 1])
2025-06-02 15:46:43,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:43,683 - DEBUG - Step 12: Loss=0.6495
2025-06-02 15:46:43,683 - DEBUG - Online update step: 13/25
2025-06-02 15:46:43,689 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:43,784 - DEBUG - Node anomaly scores shape: torch.Size([20073, 1])
2025-06-02 15:46:43,789 - DEBUG - Edge anomaly scores shape: torch.Size([42319, 1])
2025-06-02 15:46:43,790 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:44,012 - DEBUG - Step 13: Loss=0.6589
2025-06-02 15:46:44,012 - DEBUG - Online update step: 14/25
2025-06-02 15:46:44,018 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:44,116 - DEBUG - Node anomaly scores shape: torch.Size([18557, 1])
2025-06-02 15:46:44,123 - DEBUG - Edge anomaly scores shape: torch.Size([38726, 1])
2025-06-02 15:46:44,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:44,334 - DEBUG - Step 14: Loss=0.6770
2025-06-02 15:46:44,335 - DEBUG - Online update step: 15/25
2025-06-02 15:46:44,341 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:44,443 - DEBUG - Node anomaly scores shape: torch.Size([19065, 1])
2025-06-02 15:46:44,447 - DEBUG - Edge anomaly scores shape: torch.Size([39926, 1])
2025-06-02 15:46:44,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:44,707 - DEBUG - Step 15: Loss=0.6480
2025-06-02 15:46:44,708 - DEBUG - Online update step: 16/25
2025-06-02 15:46:44,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:44,813 - DEBUG - Node anomaly scores shape: torch.Size([20239, 1])
2025-06-02 15:46:44,819 - DEBUG - Edge anomaly scores shape: torch.Size([42573, 1])
2025-06-02 15:46:44,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:45,049 - DEBUG - Step 16: Loss=0.6577
2025-06-02 15:46:45,050 - DEBUG - Online update step: 17/25
2025-06-02 15:46:45,053 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:45,169 - DEBUG - Node anomaly scores shape: torch.Size([21546, 1])
2025-06-02 15:46:45,173 - DEBUG - Edge anomaly scores shape: torch.Size([45512, 1])
2025-06-02 15:46:45,175 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:45,496 - DEBUG - Step 17: Loss=0.6740
2025-06-02 15:46:45,496 - DEBUG - Online update step: 18/25
2025-06-02 15:46:45,504 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:45,628 - DEBUG - Node anomaly scores shape: torch.Size([20694, 1])
2025-06-02 15:46:45,632 - DEBUG - Edge anomaly scores shape: torch.Size([43699, 1])
2025-06-02 15:46:45,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:45,904 - DEBUG - Step 18: Loss=0.6464
2025-06-02 15:46:45,904 - DEBUG - Online update step: 19/25
2025-06-02 15:46:45,907 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:46,011 - DEBUG - Node anomaly scores shape: torch.Size([20354, 1])
2025-06-02 15:46:46,015 - DEBUG - Edge anomaly scores shape: torch.Size([42940, 1])
2025-06-02 15:46:46,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:46,235 - DEBUG - Step 19: Loss=0.6511
2025-06-02 15:46:46,235 - DEBUG - Online update step: 20/25
2025-06-02 15:46:46,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:46,421 - DEBUG - Node anomaly scores shape: torch.Size([21090, 1])
2025-06-02 15:46:46,430 - DEBUG - Edge anomaly scores shape: torch.Size([44610, 1])
2025-06-02 15:46:46,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:46,658 - DEBUG - Step 20: Loss=0.6643
2025-06-02 15:46:46,659 - DEBUG - Online update step: 21/25
2025-06-02 15:46:46,662 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:46,776 - DEBUG - Node anomaly scores shape: torch.Size([21624, 1])
2025-06-02 15:46:46,782 - DEBUG - Edge anomaly scores shape: torch.Size([45891, 1])
2025-06-02 15:46:46,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:47,017 - DEBUG - Step 21: Loss=0.6358
2025-06-02 15:46:47,017 - DEBUG - Online update step: 22/25
2025-06-02 15:46:47,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:47,140 - DEBUG - Node anomaly scores shape: torch.Size([18259, 1])
2025-06-02 15:46:47,143 - DEBUG - Edge anomaly scores shape: torch.Size([38090, 1])
2025-06-02 15:46:47,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:47,413 - DEBUG - Step 22: Loss=0.6550
2025-06-02 15:46:47,413 - DEBUG - Online update step: 23/25
2025-06-02 15:46:47,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:47,525 - DEBUG - Node anomaly scores shape: torch.Size([18972, 1])
2025-06-02 15:46:47,531 - DEBUG - Edge anomaly scores shape: torch.Size([39674, 1])
2025-06-02 15:46:47,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:47,748 - DEBUG - Step 23: Loss=0.6707
2025-06-02 15:46:47,749 - DEBUG - Online update step: 24/25
2025-06-02 15:46:47,752 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:47,854 - DEBUG - Node anomaly scores shape: torch.Size([20201, 1])
2025-06-02 15:46:47,859 - DEBUG - Edge anomaly scores shape: torch.Size([42393, 1])
2025-06-02 15:46:47,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:48,109 - DEBUG - Step 24: Loss=0.6451
2025-06-02 15:46:48,109 - DEBUG - Online update step: 25/25
2025-06-02 15:46:48,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:48,295 - DEBUG - Node anomaly scores shape: torch.Size([18840, 1])
2025-06-02 15:46:48,302 - DEBUG - Edge anomaly scores shape: torch.Size([39374, 1])
2025-06-02 15:46:48,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:48,557 - DEBUG - Step 25: Loss=0.6455
2025-06-02 15:46:48,557 - INFO - Online update finished. Average loss: 0.6607, Learning rate: 0.001000
2025-06-02 15:46:48,558 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:46:48,558 - DEBUG - Node drift difference: 0.0040, Edge drift difference: 0.0000
2025-06-02 15:46:48,559 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:46:48,560 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:46:48,560 - INFO - Online update complete. Loss: 0.6607
2025-06-02 15:46:48,560 - INFO - Running anomaly detection...
2025-06-02 15:46:48,560 - INFO - Starting anomaly detection.
2025-06-02 15:46:48,569 - DEBUG - Node reconstruction errors: [0.22740793 1.3898572  2.2669182  ... 0.04767042 0.0490148  0.10681765]
2025-06-02 15:46:48,570 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:46:48,575 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154648_update_50.json
2025-06-02 15:46:48,575 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:46:48,598 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154648_update_50.pth and as latest_checkpoint.pth
2025-06-02 15:46:48,598 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.6783
2025-06-02 15:46:48,598 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:46:48,599 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3899, MLP Score: 0.5448
2025-06-02 15:46:48,599 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.2669, MLP Score: 0.4997
2025-06-02 15:46:48,599 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.5511, MLP Score: 0.5023
2025-06-02 15:46:48,599 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.8083, MLP Score: 0.5018
2025-06-02 15:46:48,599 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.2061, MLP Score: 0.4997
2025-06-02 15:46:48,599 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:46:48,599 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.9905
2025-06-02 15:46:48,599 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9921
2025-06-02 15:46:48,599 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9921
2025-06-02 15:46:48,599 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.9754
2025-06-02 15:46:48,599 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.9658
2025-06-02 15:46:48,600 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-02 15:46:48,600 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 15:46:48,600 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:46:48,600 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 15:46:48,628 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:46:48,652 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 15:46:48,653 - INFO - Processing node updates/additions.
2025-06-02 15:46:48,658 - INFO - Processing edge updates/additions.
2025-06-02 15:46:48,670 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:46:48,671 - INFO - Finished updating NetworkX graph.
2025-06-02 15:46:48,671 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:46:48,671 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:46:48,672 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:46:48,681 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:46:48,683 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:46:48,683 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:46:48,685 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:46:48,686 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:46:48,693 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:46:48,695 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:46:48,695 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:46:48,696 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:46:48,696 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:46:48,698 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:46:48,698 - INFO - Performing online update...
2025-06-02 15:46:48,698 - INFO - Starting online update for 25 steps.
2025-06-02 15:46:48,699 - DEBUG - Updated RunningStats: new_mean=0.9451222773150341, new_var=29400000000161.41, new_n=2970
2025-06-02 15:46:48,699 - DEBUG - Updated RunningStats: new_mean=0.9430620427129843, new_var=29700000000018.305, new_n=3000
2025-06-02 15:46:48,699 - DEBUG - Updated RunningStats: new_mean=44.79313111637954, new_var=9800000186531.791, new_n=990
2025-06-02 15:46:48,700 - DEBUG - Updated RunningStats: new_mean=44.78738593490496, new_var=9900000169842.998, new_n=1000
2025-06-02 15:46:48,700 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:46:48,700 - DEBUG - Online update step: 1/25
2025-06-02 15:46:48,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:48,853 - DEBUG - Node anomaly scores shape: torch.Size([18211, 1])
2025-06-02 15:46:48,891 - DEBUG - Edge anomaly scores shape: torch.Size([38287, 1])
2025-06-02 15:46:48,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:49,089 - DEBUG - Step 1: Loss=0.6625
2025-06-02 15:46:49,089 - DEBUG - Online update step: 2/25
2025-06-02 15:46:49,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:49,239 - DEBUG - Node anomaly scores shape: torch.Size([20655, 1])
2025-06-02 15:46:49,244 - DEBUG - Edge anomaly scores shape: torch.Size([43594, 1])
2025-06-02 15:46:49,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:49,545 - DEBUG - Step 2: Loss=0.6333
2025-06-02 15:46:49,545 - DEBUG - Online update step: 3/25
2025-06-02 15:46:49,548 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:49,662 - DEBUG - Node anomaly scores shape: torch.Size([21019, 1])
2025-06-02 15:46:49,668 - DEBUG - Edge anomaly scores shape: torch.Size([44360, 1])
2025-06-02 15:46:49,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:49,904 - DEBUG - Step 3: Loss=0.6542
2025-06-02 15:46:49,904 - DEBUG - Online update step: 4/25
2025-06-02 15:46:49,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:50,017 - DEBUG - Node anomaly scores shape: torch.Size([18108, 1])
2025-06-02 15:46:50,022 - DEBUG - Edge anomaly scores shape: torch.Size([37840, 1])
2025-06-02 15:46:50,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:50,247 - DEBUG - Step 4: Loss=0.6722
2025-06-02 15:46:50,248 - DEBUG - Online update step: 5/25
2025-06-02 15:46:50,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:50,497 - DEBUG - Node anomaly scores shape: torch.Size([21291, 1])
2025-06-02 15:46:50,504 - DEBUG - Edge anomaly scores shape: torch.Size([45009, 1])
2025-06-02 15:46:50,505 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:50,701 - DEBUG - Step 5: Loss=0.6445
2025-06-02 15:46:50,702 - DEBUG - Online update step: 6/25
2025-06-02 15:46:50,705 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:50,897 - DEBUG - Node anomaly scores shape: torch.Size([19125, 1])
2025-06-02 15:46:50,902 - DEBUG - Edge anomaly scores shape: torch.Size([40163, 1])
2025-06-02 15:46:50,903 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:51,116 - DEBUG - Step 6: Loss=0.6423
2025-06-02 15:46:51,116 - DEBUG - Online update step: 7/25
2025-06-02 15:46:51,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:51,372 - DEBUG - Node anomaly scores shape: torch.Size([20487, 1])
2025-06-02 15:46:51,377 - DEBUG - Edge anomaly scores shape: torch.Size([43294, 1])
2025-06-02 15:46:51,379 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:51,927 - DEBUG - Step 7: Loss=0.6578
2025-06-02 15:46:51,927 - DEBUG - Online update step: 8/25
2025-06-02 15:46:51,934 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:52,118 - DEBUG - Node anomaly scores shape: torch.Size([20851, 1])
2025-06-02 15:46:52,124 - DEBUG - Edge anomaly scores shape: torch.Size([44139, 1])
2025-06-02 15:46:52,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:53,216 - DEBUG - Step 8: Loss=0.6297
2025-06-02 15:46:53,217 - DEBUG - Online update step: 9/25
2025-06-02 15:46:53,220 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:53,359 - DEBUG - Node anomaly scores shape: torch.Size([20160, 1])
2025-06-02 15:46:53,372 - DEBUG - Edge anomaly scores shape: torch.Size([42523, 1])
2025-06-02 15:46:53,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:53,789 - DEBUG - Step 9: Loss=0.6534
2025-06-02 15:46:53,789 - DEBUG - Online update step: 10/25
2025-06-02 15:46:53,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:53,977 - DEBUG - Node anomaly scores shape: torch.Size([20145, 1])
2025-06-02 15:46:53,982 - DEBUG - Edge anomaly scores shape: torch.Size([42346, 1])
2025-06-02 15:46:53,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:54,257 - DEBUG - Step 10: Loss=0.6696
2025-06-02 15:46:54,258 - DEBUG - Online update step: 11/25
2025-06-02 15:46:54,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:54,398 - DEBUG - Node anomaly scores shape: torch.Size([21885, 1])
2025-06-02 15:46:54,417 - DEBUG - Edge anomaly scores shape: torch.Size([46424, 1])
2025-06-02 15:46:54,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:54,717 - DEBUG - Step 11: Loss=0.6410
2025-06-02 15:46:54,717 - DEBUG - Online update step: 12/25
2025-06-02 15:46:54,723 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:54,840 - DEBUG - Node anomaly scores shape: torch.Size([19855, 1])
2025-06-02 15:46:54,854 - DEBUG - Edge anomaly scores shape: torch.Size([41833, 1])
2025-06-02 15:46:54,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:55,193 - DEBUG - Step 12: Loss=0.6427
2025-06-02 15:46:55,193 - DEBUG - Online update step: 13/25
2025-06-02 15:46:55,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:55,501 - DEBUG - Node anomaly scores shape: torch.Size([20555, 1])
2025-06-02 15:46:55,506 - DEBUG - Edge anomaly scores shape: torch.Size([43450, 1])
2025-06-02 15:46:55,508 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:55,701 - DEBUG - Step 13: Loss=0.6594
2025-06-02 15:46:55,701 - DEBUG - Online update step: 14/25
2025-06-02 15:46:55,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:55,833 - DEBUG - Node anomaly scores shape: torch.Size([18072, 1])
2025-06-02 15:46:55,843 - DEBUG - Edge anomaly scores shape: torch.Size([37831, 1])
2025-06-02 15:46:55,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:56,026 - DEBUG - Step 14: Loss=0.6355
2025-06-02 15:46:56,027 - DEBUG - Online update step: 15/25
2025-06-02 15:46:56,030 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:56,153 - DEBUG - Node anomaly scores shape: torch.Size([19368, 1])
2025-06-02 15:46:56,157 - DEBUG - Edge anomaly scores shape: torch.Size([40693, 1])
2025-06-02 15:46:56,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:56,358 - DEBUG - Step 15: Loss=0.6507
2025-06-02 15:46:56,358 - DEBUG - Online update step: 16/25
2025-06-02 15:46:56,361 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:56,493 - DEBUG - Node anomaly scores shape: torch.Size([20873, 1])
2025-06-02 15:46:56,502 - DEBUG - Edge anomaly scores shape: torch.Size([44076, 1])
2025-06-02 15:46:56,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:56,728 - DEBUG - Step 16: Loss=0.6655
2025-06-02 15:46:56,728 - DEBUG - Online update step: 17/25
2025-06-02 15:46:56,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:56,888 - DEBUG - Node anomaly scores shape: torch.Size([19634, 1])
2025-06-02 15:46:56,893 - DEBUG - Edge anomaly scores shape: torch.Size([41375, 1])
2025-06-02 15:46:56,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:57,116 - DEBUG - Step 17: Loss=0.6392
2025-06-02 15:46:57,116 - DEBUG - Online update step: 18/25
2025-06-02 15:46:57,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:57,238 - DEBUG - Node anomaly scores shape: torch.Size([19511, 1])
2025-06-02 15:46:57,245 - DEBUG - Edge anomaly scores shape: torch.Size([40974, 1])
2025-06-02 15:46:57,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:57,453 - DEBUG - Step 18: Loss=0.6434
2025-06-02 15:46:57,453 - DEBUG - Online update step: 19/25
2025-06-02 15:46:57,456 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:57,554 - DEBUG - Node anomaly scores shape: torch.Size([18789, 1])
2025-06-02 15:46:57,559 - DEBUG - Edge anomaly scores shape: torch.Size([39502, 1])
2025-06-02 15:46:57,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:57,757 - DEBUG - Step 19: Loss=0.6613
2025-06-02 15:46:57,757 - DEBUG - Online update step: 20/25
2025-06-02 15:46:57,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:57,879 - DEBUG - Node anomaly scores shape: torch.Size([21013, 1])
2025-06-02 15:46:57,884 - DEBUG - Edge anomaly scores shape: torch.Size([44592, 1])
2025-06-02 15:46:57,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:58,100 - DEBUG - Step 20: Loss=0.6335
2025-06-02 15:46:58,100 - DEBUG - Online update step: 21/25
2025-06-02 15:46:58,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:58,217 - DEBUG - Node anomaly scores shape: torch.Size([20653, 1])
2025-06-02 15:46:58,222 - DEBUG - Edge anomaly scores shape: torch.Size([43584, 1])
2025-06-02 15:46:58,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:58,466 - DEBUG - Step 21: Loss=0.6467
2025-06-02 15:46:58,466 - DEBUG - Online update step: 22/25
2025-06-02 15:46:58,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:58,585 - DEBUG - Node anomaly scores shape: torch.Size([19506, 1])
2025-06-02 15:46:58,590 - DEBUG - Edge anomaly scores shape: torch.Size([40913, 1])
2025-06-02 15:46:58,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:58,868 - DEBUG - Step 22: Loss=0.6622
2025-06-02 15:46:58,868 - DEBUG - Online update step: 23/25
2025-06-02 15:46:58,872 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:59,089 - DEBUG - Node anomaly scores shape: torch.Size([18142, 1])
2025-06-02 15:46:59,125 - DEBUG - Edge anomaly scores shape: torch.Size([38012, 1])
2025-06-02 15:46:59,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:46:59,386 - DEBUG - Step 23: Loss=0.6358
2025-06-02 15:46:59,386 - DEBUG - Online update step: 24/25
2025-06-02 15:46:59,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:46:59,887 - DEBUG - Node anomaly scores shape: torch.Size([19955, 1])
2025-06-02 15:46:59,952 - DEBUG - Edge anomaly scores shape: torch.Size([42107, 1])
2025-06-02 15:46:59,961 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:01,909 - DEBUG - Step 24: Loss=0.6434
2025-06-02 15:47:01,911 - DEBUG - Online update step: 25/25
2025-06-02 15:47:01,991 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:03,648 - DEBUG - Node anomaly scores shape: torch.Size([19240, 1])
2025-06-02 15:47:03,731 - DEBUG - Edge anomaly scores shape: torch.Size([40398, 1])
2025-06-02 15:47:03,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:04,207 - DEBUG - Step 25: Loss=0.6615
2025-06-02 15:47:04,207 - INFO - Online update finished. Average loss: 0.6496, Learning rate: 0.001000
2025-06-02 15:47:04,209 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:47:04,209 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:47:04,211 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:47:04,211 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:47:04,212 - INFO - Online update complete. Loss: 0.6496
2025-06-02 15:47:04,212 - INFO - Running anomaly detection...
2025-06-02 15:47:04,212 - INFO - Starting anomaly detection.
2025-06-02 15:47:04,222 - DEBUG - Node reconstruction errors: [0.21015857 1.4053982  1.9611405  ... 0.03781322 0.0398391  0.08748116]
2025-06-02 15:47:04,223 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:47:04,226 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154704_update_51.json
2025-06-02 15:47:04,227 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:47:04,236 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154704_update_51.pth and as latest_checkpoint.pth
2025-06-02 15:47:04,236 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.6829
2025-06-02 15:47:04,236 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:47:04,236 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4054, MLP Score: 0.5286
2025-06-02 15:47:04,236 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.9611, MLP Score: 0.5027
2025-06-02 15:47:04,236 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.2930, MLP Score: 0.5057
2025-06-02 15:47:04,236 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.3224, MLP Score: 0.5052
2025-06-02 15:47:04,236 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.6901, MLP Score: 0.5027
2025-06-02 15:47:04,236 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:47:04,236 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.9496
2025-06-02 15:47:04,236 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9194
2025-06-02 15:47:04,237 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9193
2025-06-02 15:47:04,237 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.7486
2025-06-02 15:47:04,237 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.6645
2025-06-02 15:47:04,242 - DEBUG - Embedding standard deviations before t-SNE: [1.2090486  0.         1.2815603  1.1864303  2.105014   0.
 0.76504517 0.80910826 2.211433   1.1942705  0.7301291  0.
 1.597278   0.6695912  1.1307898  1.174365   0.         0.49444193
 0.         0.05323308 3.1600862  0.69193625 0.         1.2240978
 1.0453384  0.9282063  0.         0.84671044 2.1192558  0.
 1.2244632  0.519867  ]
2025-06-02 15:47:05,234 - INFO - Embeddings visualization saved to vis/embeddings_51_updates_20250602_154704.png
2025-06-02 15:47:05,234 - INFO - Performing visualization of node and edge features.
2025-06-02 15:47:05,236 - INFO - Starting visualization of node features.
2025-06-02 15:47:05,236 - INFO - Graph has 1003 nodes and 30 features.
2025-06-02 15:47:05,236 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:47:05,236 - INFO - Calculating feature statistics:
2025-06-02 15:47:05,236 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,236 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,236 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7199986), 'max': np.float32(2.4740193)}
2025-06-02 15:47:05,236 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(-6.08526e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3749828), 'max': np.float32(1.8203772)}
2025-06-02 15:47:05,236 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,237 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,237 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,237 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45654544), 'max': np.float32(2.1903625)}
2025-06-02 15:47:05,237 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1496779), 'max': np.float32(0.86980885)}
2025-06-02 15:47:05,237 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-9.436405), 'max': np.float32(0.108228795)}
2025-06-02 15:47:05,237 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683976), 'max': np.float32(1.4923526)}
2025-06-02 15:47:05,237 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4565239), 'max': np.float32(2.385281)}
2025-06-02 15:47:05,237 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2671983), 'std': np.float32(0.94219303), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:47:05,237 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9621136), 'std': np.float32(0.27264866), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:47:05,237 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:47:05,237 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3928213), 'std': np.float32(0.5729255), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:47:05,238 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108228795), 'max': np.float32(9.436405)}
2025-06-02 15:47:05,238 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.435693), 'std': np.float32(3.0227787), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:47:05,238 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.775673), 'std': np.float32(2.906747), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:47:05,238 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6131606), 'std': np.float32(1.4830064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:47:05,238 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:47:05,238 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993021), 'std': np.float32(0.22091796), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:47:05,238 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.1409862e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.12744388), 'max': np.float32(16.54554)}
2025-06-02 15:47:05,238 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.13895662), 'max': np.float32(7.1964903)}
2025-06-02 15:47:05,238 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,238 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,238 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,238 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:05,238 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.9900672), 'max': np.float32(10.424156)}
2025-06-02 15:47:05,239 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0934536), 'max': np.float32(4.4456067)}
2025-06-02 15:47:05,251 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18932de0>
2025-06-02 15:47:05,392 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:47:05,446 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:47:05,477 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:47:06,846 - INFO - Node feature visualization saved to vis/node_features_20250602_154705.png
2025-06-02 15:47:06,846 - INFO - Finished visualization of node features.
2025-06-02 15:47:06,846 - INFO - Performing additional feature analysis:
2025-06-02 15:47:06,846 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:47:06,848 - INFO - Starting visualization of edge features.
2025-06-02 15:47:06,848 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 15:47:06,848 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:47:06,848 - INFO - Calculating edge feature statistics:
2025-06-02 15:47:06,848 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:47:06,848 - INFO - - count: {'name': 'count', 'unique': 39, 'mean': np.float32(3.464757e-09), 'std': np.float32(1.0), 'min': np.float32(-0.03478463), 'max': np.float32(33.15622)}
2025-06-02 15:47:06,848 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(455.24887), 'std': np.float32(435.08572), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:47:06,848 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:06,848 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:47:06,848 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1480, 'mean': np.float32(4.330946e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059619874), 'max': np.float32(27.69297)}
2025-06-02 15:47:06,849 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1552, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05574151), 'max': np.float32(30.763014)}
2025-06-02 15:47:06,849 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 513, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.043342285), 'max': np.float32(33.037327)}
2025-06-02 15:47:06,849 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1525, 'mean': np.float32(-5.197135e-09), 'std': np.float32(1.0), 'min': np.float32(-0.088083506), 'max': np.float32(28.738836)}
2025-06-02 15:47:06,849 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1555, 'mean': np.float32(-8.6618923e-10), 'std': np.float32(0.99999994), 'min': np.float32(-0.08783306), 'max': np.float32(27.616936)}
2025-06-02 15:47:06,849 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 567, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052230973), 'max': np.float32(32.468086)}
2025-06-02 15:47:06,860 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c099c6930>
2025-06-02 15:47:07,205 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:47:07,218 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c1865b2f0>
2025-06-02 15:47:07,316 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:47:07,476 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:47:07,617 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:47:07,633 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:47:07,639 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:47:08,965 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154707.png
2025-06-02 15:47:08,965 - INFO - Finished visualization of edge features.
2025-06-02 15:47:08,965 - INFO - Performing additional edge feature analysis:
2025-06-02 15:47:08,965 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:47:08,965 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 15:47:08,967 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:47:08,967 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 15:47:08,967 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:47:09,302 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154708_summary.png
2025-06-02 15:47:09,587 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154708_pca_3d.png
2025-06-02 15:47:09,772 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154708_pca_variance.png
2025-06-02 15:47:09,772 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:47:09,773 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-02 15:47:09,773 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 15:47:09,773 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:47:09,773 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 15:47:09,793 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:47:09,816 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 15:47:09,817 - INFO - Processing node updates/additions.
2025-06-02 15:47:09,824 - INFO - Processing edge updates/additions.
2025-06-02 15:47:09,839 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:47:09,841 - INFO - Finished updating NetworkX graph.
2025-06-02 15:47:09,842 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:47:09,842 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:47:09,844 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:47:09,858 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:47:09,860 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:47:09,860 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:47:09,863 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:47:09,865 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:47:09,875 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:47:09,878 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:47:09,884 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:47:09,884 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:47:09,885 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:47:09,887 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:47:09,887 - INFO - Performing online update...
2025-06-02 15:47:09,887 - INFO - Starting online update for 25 steps.
2025-06-02 15:47:09,889 - DEBUG - Updated RunningStats: new_mean=0.9451897398274213, new_var=30000000000161.41, new_n=3030
2025-06-02 15:47:09,889 - DEBUG - Updated RunningStats: new_mean=0.9431692405850942, new_var=30300000000018.305, new_n=3060
2025-06-02 15:47:09,890 - DEBUG - Updated RunningStats: new_mean=44.794687926482595, new_var=10000000186531.766, new_n=1010
2025-06-02 15:47:09,890 - DEBUG - Updated RunningStats: new_mean=44.78904013278102, new_var=10100000169843.016, new_n=1020
2025-06-02 15:47:09,890 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:47:09,890 - DEBUG - Online update step: 1/25
2025-06-02 15:47:09,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:10,028 - DEBUG - Node anomaly scores shape: torch.Size([19032, 1])
2025-06-02 15:47:10,040 - DEBUG - Edge anomaly scores shape: torch.Size([40063, 1])
2025-06-02 15:47:10,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:10,369 - DEBUG - Step 1: Loss=0.6348
2025-06-02 15:47:10,369 - DEBUG - Online update step: 2/25
2025-06-02 15:47:10,373 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:10,516 - DEBUG - Node anomaly scores shape: torch.Size([19982, 1])
2025-06-02 15:47:10,532 - DEBUG - Edge anomaly scores shape: torch.Size([42039, 1])
2025-06-02 15:47:10,533 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:10,838 - DEBUG - Step 2: Loss=0.6443
2025-06-02 15:47:10,838 - DEBUG - Online update step: 3/25
2025-06-02 15:47:10,841 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:10,949 - DEBUG - Node anomaly scores shape: torch.Size([18374, 1])
2025-06-02 15:47:10,955 - DEBUG - Edge anomaly scores shape: torch.Size([38336, 1])
2025-06-02 15:47:10,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:11,180 - DEBUG - Step 3: Loss=0.6619
2025-06-02 15:47:11,180 - DEBUG - Online update step: 4/25
2025-06-02 15:47:11,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:11,343 - DEBUG - Node anomaly scores shape: torch.Size([20860, 1])
2025-06-02 15:47:11,351 - DEBUG - Edge anomaly scores shape: torch.Size([44207, 1])
2025-06-02 15:47:11,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:11,660 - DEBUG - Step 4: Loss=0.6363
2025-06-02 15:47:11,661 - DEBUG - Online update step: 5/25
2025-06-02 15:47:11,669 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:11,784 - DEBUG - Node anomaly scores shape: torch.Size([18726, 1])
2025-06-02 15:47:11,789 - DEBUG - Edge anomaly scores shape: torch.Size([39268, 1])
2025-06-02 15:47:11,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:12,004 - DEBUG - Step 5: Loss=0.6433
2025-06-02 15:47:12,004 - DEBUG - Online update step: 6/25
2025-06-02 15:47:12,011 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:12,106 - DEBUG - Node anomaly scores shape: torch.Size([18518, 1])
2025-06-02 15:47:12,111 - DEBUG - Edge anomaly scores shape: torch.Size([38868, 1])
2025-06-02 15:47:12,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:12,340 - DEBUG - Step 6: Loss=0.6633
2025-06-02 15:47:12,340 - DEBUG - Online update step: 7/25
2025-06-02 15:47:12,347 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:12,467 - DEBUG - Node anomaly scores shape: torch.Size([21466, 1])
2025-06-02 15:47:12,473 - DEBUG - Edge anomaly scores shape: torch.Size([45103, 1])
2025-06-02 15:47:12,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:12,761 - DEBUG - Step 7: Loss=0.6363
2025-06-02 15:47:12,761 - DEBUG - Online update step: 8/25
2025-06-02 15:47:12,769 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:12,880 - DEBUG - Node anomaly scores shape: torch.Size([18977, 1])
2025-06-02 15:47:12,885 - DEBUG - Edge anomaly scores shape: torch.Size([39931, 1])
2025-06-02 15:47:12,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:13,102 - DEBUG - Step 8: Loss=0.6433
2025-06-02 15:47:13,103 - DEBUG - Online update step: 9/25
2025-06-02 15:47:13,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:13,213 - DEBUG - Node anomaly scores shape: torch.Size([20902, 1])
2025-06-02 15:47:13,219 - DEBUG - Edge anomaly scores shape: torch.Size([44045, 1])
2025-06-02 15:47:13,221 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:13,492 - DEBUG - Step 9: Loss=0.6651
2025-06-02 15:47:13,493 - DEBUG - Online update step: 10/25
2025-06-02 15:47:13,501 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:13,602 - DEBUG - Node anomaly scores shape: torch.Size([19578, 1])
2025-06-02 15:47:13,609 - DEBUG - Edge anomaly scores shape: torch.Size([41271, 1])
2025-06-02 15:47:13,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:13,884 - DEBUG - Step 10: Loss=0.6395
2025-06-02 15:47:13,884 - DEBUG - Online update step: 11/25
2025-06-02 15:47:13,891 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:14,005 - DEBUG - Node anomaly scores shape: torch.Size([21462, 1])
2025-06-02 15:47:14,011 - DEBUG - Edge anomaly scores shape: torch.Size([45325, 1])
2025-06-02 15:47:14,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:14,279 - DEBUG - Step 11: Loss=0.6406
2025-06-02 15:47:14,279 - DEBUG - Online update step: 12/25
2025-06-02 15:47:14,286 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:14,437 - DEBUG - Node anomaly scores shape: torch.Size([19194, 1])
2025-06-02 15:47:14,447 - DEBUG - Edge anomaly scores shape: torch.Size([40385, 1])
2025-06-02 15:47:14,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:14,860 - DEBUG - Step 12: Loss=0.6641
2025-06-02 15:47:14,860 - DEBUG - Online update step: 13/25
2025-06-02 15:47:14,864 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:15,062 - DEBUG - Node anomaly scores shape: torch.Size([17441, 1])
2025-06-02 15:47:15,074 - DEBUG - Edge anomaly scores shape: torch.Size([36584, 1])
2025-06-02 15:47:15,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:15,426 - DEBUG - Step 13: Loss=0.6416
2025-06-02 15:47:15,427 - DEBUG - Online update step: 14/25
2025-06-02 15:47:15,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:15,620 - DEBUG - Node anomaly scores shape: torch.Size([19772, 1])
2025-06-02 15:47:15,627 - DEBUG - Edge anomaly scores shape: torch.Size([41409, 1])
2025-06-02 15:47:15,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:15,983 - DEBUG - Step 14: Loss=0.6549
2025-06-02 15:47:15,983 - DEBUG - Online update step: 15/25
2025-06-02 15:47:15,987 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:16,103 - DEBUG - Node anomaly scores shape: torch.Size([18606, 1])
2025-06-02 15:47:16,108 - DEBUG - Edge anomaly scores shape: torch.Size([38985, 1])
2025-06-02 15:47:16,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:16,373 - DEBUG - Step 15: Loss=0.6610
2025-06-02 15:47:16,373 - DEBUG - Online update step: 16/25
2025-06-02 15:47:16,377 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:16,610 - DEBUG - Node anomaly scores shape: torch.Size([21534, 1])
2025-06-02 15:47:16,648 - DEBUG - Edge anomaly scores shape: torch.Size([45329, 1])
2025-06-02 15:47:16,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:17,051 - DEBUG - Step 16: Loss=0.6424
2025-06-02 15:47:17,051 - DEBUG - Online update step: 17/25
2025-06-02 15:47:17,055 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:17,187 - DEBUG - Node anomaly scores shape: torch.Size([20170, 1])
2025-06-02 15:47:17,192 - DEBUG - Edge anomaly scores shape: torch.Size([42343, 1])
2025-06-02 15:47:17,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:17,391 - DEBUG - Step 17: Loss=0.6560
2025-06-02 15:47:17,391 - DEBUG - Online update step: 18/25
2025-06-02 15:47:17,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:17,571 - DEBUG - Node anomaly scores shape: torch.Size([20430, 1])
2025-06-02 15:47:17,580 - DEBUG - Edge anomaly scores shape: torch.Size([42892, 1])
2025-06-02 15:47:17,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:18,257 - DEBUG - Step 18: Loss=0.6662
2025-06-02 15:47:18,257 - DEBUG - Online update step: 19/25
2025-06-02 15:47:18,282 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:19,596 - DEBUG - Node anomaly scores shape: torch.Size([19706, 1])
2025-06-02 15:47:19,627 - DEBUG - Edge anomaly scores shape: torch.Size([41553, 1])
2025-06-02 15:47:19,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:20,052 - DEBUG - Step 19: Loss=0.6344
2025-06-02 15:47:20,053 - DEBUG - Online update step: 20/25
2025-06-02 15:47:20,065 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:20,738 - DEBUG - Node anomaly scores shape: torch.Size([21611, 1])
2025-06-02 15:47:20,764 - DEBUG - Edge anomaly scores shape: torch.Size([45690, 1])
2025-06-02 15:47:20,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:22,388 - DEBUG - Step 20: Loss=0.6521
2025-06-02 15:47:22,388 - DEBUG - Online update step: 21/25
2025-06-02 15:47:22,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:23,720 - DEBUG - Node anomaly scores shape: torch.Size([20568, 1])
2025-06-02 15:47:23,792 - DEBUG - Edge anomaly scores shape: torch.Size([43463, 1])
2025-06-02 15:47:23,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:25,344 - DEBUG - Step 21: Loss=0.6634
2025-06-02 15:47:25,345 - DEBUG - Online update step: 22/25
2025-06-02 15:47:25,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:25,561 - DEBUG - Node anomaly scores shape: torch.Size([19469, 1])
2025-06-02 15:47:25,566 - DEBUG - Edge anomaly scores shape: torch.Size([40837, 1])
2025-06-02 15:47:25,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:25,783 - DEBUG - Step 22: Loss=0.6340
2025-06-02 15:47:25,783 - DEBUG - Online update step: 23/25
2025-06-02 15:47:25,793 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:25,902 - DEBUG - Node anomaly scores shape: torch.Size([19433, 1])
2025-06-02 15:47:25,908 - DEBUG - Edge anomaly scores shape: torch.Size([40871, 1])
2025-06-02 15:47:25,910 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:26,132 - DEBUG - Step 23: Loss=0.6525
2025-06-02 15:47:26,133 - DEBUG - Online update step: 24/25
2025-06-02 15:47:26,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:26,237 - DEBUG - Node anomaly scores shape: torch.Size([20511, 1])
2025-06-02 15:47:26,242 - DEBUG - Edge anomaly scores shape: torch.Size([43089, 1])
2025-06-02 15:47:26,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:26,473 - DEBUG - Step 24: Loss=0.6627
2025-06-02 15:47:26,473 - DEBUG - Online update step: 25/25
2025-06-02 15:47:26,478 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:26,581 - DEBUG - Node anomaly scores shape: torch.Size([20580, 1])
2025-06-02 15:47:26,587 - DEBUG - Edge anomaly scores shape: torch.Size([43307, 1])
2025-06-02 15:47:26,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:26,795 - DEBUG - Step 25: Loss=0.6396
2025-06-02 15:47:26,796 - INFO - Online update finished. Average loss: 0.6493, Learning rate: 0.001000
2025-06-02 15:47:26,797 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:47:26,798 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:47:26,799 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-1.7323785e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -2.1654731e-10 -6.9295139e-09 -2.5985676e-09
 -2.3820204e-09  3.4647569e-09]
2025-06-02 15:47:26,800 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:47:26,808 - INFO - Online update complete. Loss: 0.6493
2025-06-02 15:47:26,809 - INFO - Running anomaly detection...
2025-06-02 15:47:26,809 - INFO - Starting anomaly detection.
2025-06-02 15:47:26,818 - DEBUG - Node reconstruction errors: [0.1941698  1.4937916  1.8758863  ... 0.03403344 0.03422283 0.07075484]
2025-06-02 15:47:26,819 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:47:26,822 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154726_update_52.json
2025-06-02 15:47:26,822 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:47:26,841 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154726_update_52.pth and as latest_checkpoint.pth
2025-06-02 15:47:26,842 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.6985
2025-06-02 15:47:26,842 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:47:26,842 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4938, MLP Score: 0.5090
2025-06-02 15:47:26,842 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.8759, MLP Score: 0.4730
2025-06-02 15:47:26,843 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.2070, MLP Score: 0.4739
2025-06-02 15:47:26,843 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.1648, MLP Score: 0.4720
2025-06-02 15:47:26,843 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.7729, MLP Score: 0.4730
2025-06-02 15:47:26,843 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:47:26,844 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.0931
2025-06-02 15:47:26,844 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0106
2025-06-02 15:47:26,844 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0106
2025-06-02 15:47:26,844 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0020
2025-06-02 15:47:26,845 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0011
2025-06-02 15:47:26,845 - INFO - 
--- Processing file: nw_graph_encoded_1748870685.dot (Timestamp: 2025-06-02 15:24:45) ---
2025-06-02 15:47:26,845 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-02 15:47:26,845 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 15:47:26,845 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-02 15:47:26,877 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 15:47:26,904 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 15:47:26,905 - INFO - Processing node updates/additions.
2025-06-02 15:47:26,912 - INFO - Processing edge updates/additions.
2025-06-02 15:47:26,927 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:47:26,928 - INFO - Finished updating NetworkX graph.
2025-06-02 15:47:26,929 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:47:26,929 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:47:26,931 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:47:26,942 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:47:26,944 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:47:26,944 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:47:26,948 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:47:26,950 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:47:26,955 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:47:26,956 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:47:26,957 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:47:26,957 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:47:26,957 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:47:26,958 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:47:26,958 - INFO - Performing online update...
2025-06-02 15:47:26,958 - INFO - Starting online update for 25 steps.
2025-06-02 15:47:26,959 - DEBUG - Updated RunningStats: new_mean=0.9452545824321069, new_var=30600000000161.41, new_n=3090
2025-06-02 15:47:26,959 - DEBUG - Updated RunningStats: new_mean=0.9432723154578565, new_var=30900000000018.305, new_n=3120
2025-06-02 15:47:26,959 - DEBUG - Updated RunningStats: new_mean=44.79618427793919, new_var=10200000186531.742, new_n=1030
2025-06-02 15:47:26,959 - DEBUG - Updated RunningStats: new_mean=44.79063070766018, new_var=10300000169843.035, new_n=1040
2025-06-02 15:47:26,959 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:47:26,959 - DEBUG - Online update step: 1/25
2025-06-02 15:47:26,961 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:27,088 - DEBUG - Node anomaly scores shape: torch.Size([18354, 1])
2025-06-02 15:47:27,096 - DEBUG - Edge anomaly scores shape: torch.Size([38349, 1])
2025-06-02 15:47:27,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:27,278 - DEBUG - Step 1: Loss=0.6538
2025-06-02 15:47:27,278 - DEBUG - Online update step: 2/25
2025-06-02 15:47:27,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:27,383 - DEBUG - Node anomaly scores shape: torch.Size([20363, 1])
2025-06-02 15:47:27,388 - DEBUG - Edge anomaly scores shape: torch.Size([42930, 1])
2025-06-02 15:47:27,390 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:27,579 - DEBUG - Step 2: Loss=0.6639
2025-06-02 15:47:27,579 - DEBUG - Online update step: 3/25
2025-06-02 15:47:27,582 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:27,709 - DEBUG - Node anomaly scores shape: torch.Size([23486, 1])
2025-06-02 15:47:27,714 - DEBUG - Edge anomaly scores shape: torch.Size([49719, 1])
2025-06-02 15:47:27,715 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:27,931 - DEBUG - Step 3: Loss=0.6285
2025-06-02 15:47:27,931 - DEBUG - Online update step: 4/25
2025-06-02 15:47:27,934 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:28,082 - DEBUG - Node anomaly scores shape: torch.Size([18824, 1])
2025-06-02 15:47:28,091 - DEBUG - Edge anomaly scores shape: torch.Size([39523, 1])
2025-06-02 15:47:28,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:28,489 - DEBUG - Step 4: Loss=0.6507
2025-06-02 15:47:28,491 - DEBUG - Online update step: 5/25
2025-06-02 15:47:28,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:28,846 - DEBUG - Node anomaly scores shape: torch.Size([20480, 1])
2025-06-02 15:47:28,855 - DEBUG - Edge anomaly scores shape: torch.Size([43118, 1])
2025-06-02 15:47:28,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:29,180 - DEBUG - Step 5: Loss=0.6628
2025-06-02 15:47:29,180 - DEBUG - Online update step: 6/25
2025-06-02 15:47:29,191 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:29,318 - DEBUG - Node anomaly scores shape: torch.Size([21433, 1])
2025-06-02 15:47:29,326 - DEBUG - Edge anomaly scores shape: torch.Size([45562, 1])
2025-06-02 15:47:29,328 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:29,594 - DEBUG - Step 6: Loss=0.6323
2025-06-02 15:47:29,595 - DEBUG - Online update step: 7/25
2025-06-02 15:47:29,599 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:29,729 - DEBUG - Node anomaly scores shape: torch.Size([20484, 1])
2025-06-02 15:47:29,737 - DEBUG - Edge anomaly scores shape: torch.Size([43125, 1])
2025-06-02 15:47:29,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:29,986 - DEBUG - Step 7: Loss=0.6472
2025-06-02 15:47:29,986 - DEBUG - Online update step: 8/25
2025-06-02 15:47:29,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:30,097 - DEBUG - Node anomaly scores shape: torch.Size([20115, 1])
2025-06-02 15:47:30,104 - DEBUG - Edge anomaly scores shape: torch.Size([42290, 1])
2025-06-02 15:47:30,106 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:30,324 - DEBUG - Step 8: Loss=0.6586
2025-06-02 15:47:30,324 - DEBUG - Online update step: 9/25
2025-06-02 15:47:30,328 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:30,434 - DEBUG - Node anomaly scores shape: torch.Size([21878, 1])
2025-06-02 15:47:30,440 - DEBUG - Edge anomaly scores shape: torch.Size([46365, 1])
2025-06-02 15:47:30,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:30,669 - DEBUG - Step 9: Loss=0.6329
2025-06-02 15:47:30,669 - DEBUG - Online update step: 10/25
2025-06-02 15:47:30,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:30,798 - DEBUG - Node anomaly scores shape: torch.Size([21216, 1])
2025-06-02 15:47:30,804 - DEBUG - Edge anomaly scores shape: torch.Size([44986, 1])
2025-06-02 15:47:30,806 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:31,130 - DEBUG - Step 10: Loss=0.6508
2025-06-02 15:47:31,131 - DEBUG - Online update step: 11/25
2025-06-02 15:47:31,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:31,313 - DEBUG - Node anomaly scores shape: torch.Size([18022, 1])
2025-06-02 15:47:31,320 - DEBUG - Edge anomaly scores shape: torch.Size([37845, 1])
2025-06-02 15:47:31,322 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:31,791 - DEBUG - Step 11: Loss=0.6648
2025-06-02 15:47:31,791 - DEBUG - Online update step: 12/25
2025-06-02 15:47:31,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:32,010 - DEBUG - Node anomaly scores shape: torch.Size([20097, 1])
2025-06-02 15:47:32,041 - DEBUG - Edge anomaly scores shape: torch.Size([42477, 1])
2025-06-02 15:47:32,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:32,564 - DEBUG - Step 12: Loss=0.6325
2025-06-02 15:47:32,564 - DEBUG - Online update step: 13/25
2025-06-02 15:47:32,569 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:33,010 - DEBUG - Node anomaly scores shape: torch.Size([21476, 1])
2025-06-02 15:47:33,019 - DEBUG - Edge anomaly scores shape: torch.Size([45463, 1])
2025-06-02 15:47:33,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:34,652 - DEBUG - Step 13: Loss=0.6465
2025-06-02 15:47:34,654 - DEBUG - Online update step: 14/25
2025-06-02 15:47:34,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:36,292 - DEBUG - Node anomaly scores shape: torch.Size([20685, 1])
2025-06-02 15:47:36,411 - DEBUG - Edge anomaly scores shape: torch.Size([43654, 1])
2025-06-02 15:47:36,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:38,841 - DEBUG - Step 14: Loss=0.6591
2025-06-02 15:47:38,841 - DEBUG - Online update step: 15/25
2025-06-02 15:47:38,845 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:39,114 - DEBUG - Node anomaly scores shape: torch.Size([19382, 1])
2025-06-02 15:47:39,125 - DEBUG - Edge anomaly scores shape: torch.Size([40706, 1])
2025-06-02 15:47:39,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:39,512 - DEBUG - Step 15: Loss=0.6298
2025-06-02 15:47:39,512 - DEBUG - Online update step: 16/25
2025-06-02 15:47:39,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:39,712 - DEBUG - Node anomaly scores shape: torch.Size([18955, 1])
2025-06-02 15:47:39,726 - DEBUG - Edge anomaly scores shape: torch.Size([39886, 1])
2025-06-02 15:47:39,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:40,298 - DEBUG - Step 16: Loss=0.6482
2025-06-02 15:47:40,299 - DEBUG - Online update step: 17/25
2025-06-02 15:47:40,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:40,520 - DEBUG - Node anomaly scores shape: torch.Size([20404, 1])
2025-06-02 15:47:40,543 - DEBUG - Edge anomaly scores shape: torch.Size([42942, 1])
2025-06-02 15:47:40,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:41,013 - DEBUG - Step 17: Loss=0.6583
2025-06-02 15:47:41,014 - DEBUG - Online update step: 18/25
2025-06-02 15:47:41,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:41,386 - DEBUG - Node anomaly scores shape: torch.Size([20986, 1])
2025-06-02 15:47:41,399 - DEBUG - Edge anomaly scores shape: torch.Size([44540, 1])
2025-06-02 15:47:41,410 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:41,920 - DEBUG - Step 18: Loss=0.6326
2025-06-02 15:47:41,920 - DEBUG - Online update step: 19/25
2025-06-02 15:47:41,924 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:42,132 - DEBUG - Node anomaly scores shape: torch.Size([22875, 1])
2025-06-02 15:47:42,152 - DEBUG - Edge anomaly scores shape: torch.Size([48546, 1])
2025-06-02 15:47:42,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:42,640 - DEBUG - Step 19: Loss=0.6465
2025-06-02 15:47:42,640 - DEBUG - Online update step: 20/25
2025-06-02 15:47:42,646 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:42,837 - DEBUG - Node anomaly scores shape: torch.Size([20898, 1])
2025-06-02 15:47:42,864 - DEBUG - Edge anomaly scores shape: torch.Size([44315, 1])
2025-06-02 15:47:42,867 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:43,259 - DEBUG - Step 20: Loss=0.6593
2025-06-02 15:47:43,260 - DEBUG - Online update step: 21/25
2025-06-02 15:47:43,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:43,525 - DEBUG - Node anomaly scores shape: torch.Size([20872, 1])
2025-06-02 15:47:43,537 - DEBUG - Edge anomaly scores shape: torch.Size([44234, 1])
2025-06-02 15:47:43,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:43,965 - DEBUG - Step 21: Loss=0.6292
2025-06-02 15:47:43,966 - DEBUG - Online update step: 22/25
2025-06-02 15:47:43,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:44,161 - DEBUG - Node anomaly scores shape: torch.Size([20383, 1])
2025-06-02 15:47:44,176 - DEBUG - Edge anomaly scores shape: torch.Size([43121, 1])
2025-06-02 15:47:44,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:44,592 - DEBUG - Step 22: Loss=0.6463
2025-06-02 15:47:44,593 - DEBUG - Online update step: 23/25
2025-06-02 15:47:44,596 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:44,788 - DEBUG - Node anomaly scores shape: torch.Size([20597, 1])
2025-06-02 15:47:44,799 - DEBUG - Edge anomaly scores shape: torch.Size([43501, 1])
2025-06-02 15:47:44,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:45,232 - DEBUG - Step 23: Loss=0.6601
2025-06-02 15:47:45,232 - DEBUG - Online update step: 24/25
2025-06-02 15:47:45,236 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:45,516 - DEBUG - Node anomaly scores shape: torch.Size([22661, 1])
2025-06-02 15:47:45,530 - DEBUG - Edge anomaly scores shape: torch.Size([48238, 1])
2025-06-02 15:47:45,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:45,963 - DEBUG - Step 24: Loss=0.6306
2025-06-02 15:47:45,963 - DEBUG - Online update step: 25/25
2025-06-02 15:47:45,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:46,178 - DEBUG - Node anomaly scores shape: torch.Size([21379, 1])
2025-06-02 15:47:46,198 - DEBUG - Edge anomaly scores shape: torch.Size([45248, 1])
2025-06-02 15:47:46,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:46,634 - DEBUG - Step 25: Loss=0.6435
2025-06-02 15:47:46,635 - INFO - Online update finished. Average loss: 0.6468, Learning rate: 0.001000
2025-06-02 15:47:46,636 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:47:46,636 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:47:46,637 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:47:46,638 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:47:46,638 - INFO - Online update complete. Loss: 0.6468
2025-06-02 15:47:46,638 - INFO - Running anomaly detection...
2025-06-02 15:47:46,638 - INFO - Starting anomaly detection.
2025-06-02 15:47:46,654 - DEBUG - Node reconstruction errors: [0.17869721 1.4726177  1.7813585  ... 0.03074321 0.03113969 0.06612358]
2025-06-02 15:47:46,654 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:47:46,656 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154746_update_53.json
2025-06-02 15:47:46,657 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:47:46,667 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154746_update_53.pth and as latest_checkpoint.pth
2025-06-02 15:47:46,667 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870685.dot): 0.7050
2025-06-02 15:47:46,667 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:47:46,667 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4726, MLP Score: 0.5318
2025-06-02 15:47:46,667 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7814, MLP Score: 0.4960
2025-06-02 15:47:46,667 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.1075, MLP Score: 0.4915
2025-06-02 15:47:46,667 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.9562, MLP Score: 0.4904
2025-06-02 15:47:46,667 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.9203, MLP Score: 0.4960
2025-06-02 15:47:46,667 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:47:46,668 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.0253
2025-06-02 15:47:46,668 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0017
2025-06-02 15:47:46,668 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0017
2025-06-02 15:47:46,668 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0003
2025-06-02 15:47:46,668 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0002
2025-06-02 15:47:46,668 - INFO - 
--- Processing file: nw_graph_encoded_1748870715.dot (Timestamp: 2025-06-02 15:25:15) ---
2025-06-02 15:47:46,668 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-02 15:47:46,668 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 15:47:46,668 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-02 15:47:46,701 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 15:47:46,737 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 15:47:46,737 - INFO - Processing node updates/additions.
2025-06-02 15:47:46,745 - INFO - Processing edge updates/additions.
2025-06-02 15:47:46,764 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:47:46,766 - INFO - Finished updating NetworkX graph.
2025-06-02 15:47:46,767 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:47:46,767 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:47:46,769 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:47:46,782 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:47:46,784 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:47:46,784 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:47:46,787 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:47:46,790 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:47:46,799 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:47:46,802 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:47:46,803 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:47:46,803 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:47:46,804 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:47:46,805 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:47:46,806 - INFO - Performing online update...
2025-06-02 15:47:46,806 - INFO - Starting online update for 25 steps.
2025-06-02 15:47:46,807 - DEBUG - Updated RunningStats: new_mean=0.9453169548423284, new_var=31200000000161.41, new_n=3150
2025-06-02 15:47:46,807 - DEBUG - Updated RunningStats: new_mean=0.9433715007127786, new_var=31500000000018.31, new_n=3180
2025-06-02 15:47:46,808 - DEBUG - Updated RunningStats: new_mean=44.797623625530775, new_var=10400000186531.72, new_n=1050
2025-06-02 15:47:46,808 - DEBUG - Updated RunningStats: new_mean=44.79216126084578, new_var=10500000169843.05, new_n=1060
2025-06-02 15:47:46,809 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:47:46,809 - DEBUG - Online update step: 1/25
2025-06-02 15:47:46,815 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:47,086 - DEBUG - Node anomaly scores shape: torch.Size([20094, 1])
2025-06-02 15:47:47,102 - DEBUG - Edge anomaly scores shape: torch.Size([42481, 1])
2025-06-02 15:47:47,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:47,564 - DEBUG - Step 1: Loss=0.6553
2025-06-02 15:47:47,564 - DEBUG - Online update step: 2/25
2025-06-02 15:47:47,567 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:47,871 - DEBUG - Node anomaly scores shape: torch.Size([24058, 1])
2025-06-02 15:47:47,886 - DEBUG - Edge anomaly scores shape: torch.Size([51503, 1])
2025-06-02 15:47:47,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:48,335 - DEBUG - Step 2: Loss=0.6283
2025-06-02 15:47:48,336 - DEBUG - Online update step: 3/25
2025-06-02 15:47:48,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:48,648 - DEBUG - Node anomaly scores shape: torch.Size([24408, 1])
2025-06-02 15:47:48,661 - DEBUG - Edge anomaly scores shape: torch.Size([51998, 1])
2025-06-02 15:47:48,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:49,150 - DEBUG - Step 3: Loss=0.6465
2025-06-02 15:47:49,151 - DEBUG - Online update step: 4/25
2025-06-02 15:47:49,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:49,427 - DEBUG - Node anomaly scores shape: torch.Size([24215, 1])
2025-06-02 15:47:49,436 - DEBUG - Edge anomaly scores shape: torch.Size([51587, 1])
2025-06-02 15:47:49,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:49,789 - DEBUG - Step 4: Loss=0.6576
2025-06-02 15:47:49,789 - DEBUG - Online update step: 5/25
2025-06-02 15:47:49,793 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:49,962 - DEBUG - Node anomaly scores shape: torch.Size([21146, 1])
2025-06-02 15:47:49,972 - DEBUG - Edge anomaly scores shape: torch.Size([44893, 1])
2025-06-02 15:47:49,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:50,365 - DEBUG - Step 5: Loss=0.6312
2025-06-02 15:47:50,365 - DEBUG - Online update step: 6/25
2025-06-02 15:47:50,369 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:50,515 - DEBUG - Node anomaly scores shape: torch.Size([18997, 1])
2025-06-02 15:47:50,521 - DEBUG - Edge anomaly scores shape: torch.Size([40039, 1])
2025-06-02 15:47:50,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:50,816 - DEBUG - Step 6: Loss=0.6447
2025-06-02 15:47:50,817 - DEBUG - Online update step: 7/25
2025-06-02 15:47:50,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:50,972 - DEBUG - Node anomaly scores shape: torch.Size([20884, 1])
2025-06-02 15:47:50,981 - DEBUG - Edge anomaly scores shape: torch.Size([44215, 1])
2025-06-02 15:47:50,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:51,313 - DEBUG - Step 7: Loss=0.6562
2025-06-02 15:47:51,313 - DEBUG - Online update step: 8/25
2025-06-02 15:47:51,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:51,429 - DEBUG - Node anomaly scores shape: torch.Size([18155, 1])
2025-06-02 15:47:51,435 - DEBUG - Edge anomaly scores shape: torch.Size([37957, 1])
2025-06-02 15:47:51,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:51,731 - DEBUG - Step 8: Loss=0.6280
2025-06-02 15:47:51,732 - DEBUG - Online update step: 9/25
2025-06-02 15:47:51,742 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:51,910 - DEBUG - Node anomaly scores shape: torch.Size([19866, 1])
2025-06-02 15:47:51,917 - DEBUG - Edge anomaly scores shape: torch.Size([42030, 1])
2025-06-02 15:47:51,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:52,208 - DEBUG - Step 9: Loss=0.6445
2025-06-02 15:47:52,208 - DEBUG - Online update step: 10/25
2025-06-02 15:47:52,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:52,325 - DEBUG - Node anomaly scores shape: torch.Size([19692, 1])
2025-06-02 15:47:52,331 - DEBUG - Edge anomaly scores shape: torch.Size([41502, 1])
2025-06-02 15:47:52,333 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:52,543 - DEBUG - Step 10: Loss=0.6562
2025-06-02 15:47:52,543 - DEBUG - Online update step: 11/25
2025-06-02 15:47:52,547 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:52,650 - DEBUG - Node anomaly scores shape: torch.Size([18931, 1])
2025-06-02 15:47:52,656 - DEBUG - Edge anomaly scores shape: torch.Size([39882, 1])
2025-06-02 15:47:52,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:52,899 - DEBUG - Step 11: Loss=0.6291
2025-06-02 15:47:52,899 - DEBUG - Online update step: 12/25
2025-06-02 15:47:52,903 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:53,105 - DEBUG - Node anomaly scores shape: torch.Size([22741, 1])
2025-06-02 15:47:53,149 - DEBUG - Edge anomaly scores shape: torch.Size([48212, 1])
2025-06-02 15:47:53,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:53,557 - DEBUG - Step 12: Loss=0.6444
2025-06-02 15:47:53,557 - DEBUG - Online update step: 13/25
2025-06-02 15:47:53,561 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:53,685 - DEBUG - Node anomaly scores shape: torch.Size([19971, 1])
2025-06-02 15:47:53,692 - DEBUG - Edge anomaly scores shape: torch.Size([42224, 1])
2025-06-02 15:47:53,693 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:53,954 - DEBUG - Step 13: Loss=0.6566
2025-06-02 15:47:53,954 - DEBUG - Online update step: 14/25
2025-06-02 15:47:53,957 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:54,061 - DEBUG - Node anomaly scores shape: torch.Size([20072, 1])
2025-06-02 15:47:54,067 - DEBUG - Edge anomaly scores shape: torch.Size([42264, 1])
2025-06-02 15:47:54,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:54,285 - DEBUG - Step 14: Loss=0.6284
2025-06-02 15:47:54,285 - DEBUG - Online update step: 15/25
2025-06-02 15:47:54,289 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:54,401 - DEBUG - Node anomaly scores shape: torch.Size([20564, 1])
2025-06-02 15:47:54,407 - DEBUG - Edge anomaly scores shape: torch.Size([43299, 1])
2025-06-02 15:47:54,408 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:54,651 - DEBUG - Step 15: Loss=0.6427
2025-06-02 15:47:54,651 - DEBUG - Online update step: 16/25
2025-06-02 15:47:54,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:54,757 - DEBUG - Node anomaly scores shape: torch.Size([19143, 1])
2025-06-02 15:47:54,764 - DEBUG - Edge anomaly scores shape: torch.Size([40125, 1])
2025-06-02 15:47:54,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:54,974 - DEBUG - Step 16: Loss=0.6551
2025-06-02 15:47:54,975 - DEBUG - Online update step: 17/25
2025-06-02 15:47:54,981 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:55,082 - DEBUG - Node anomaly scores shape: torch.Size([19429, 1])
2025-06-02 15:47:55,087 - DEBUG - Edge anomaly scores shape: torch.Size([40877, 1])
2025-06-02 15:47:55,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:55,291 - DEBUG - Step 17: Loss=0.6267
2025-06-02 15:47:55,292 - DEBUG - Online update step: 18/25
2025-06-02 15:47:55,299 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:55,408 - DEBUG - Node anomaly scores shape: torch.Size([19505, 1])
2025-06-02 15:47:55,413 - DEBUG - Edge anomaly scores shape: torch.Size([41162, 1])
2025-06-02 15:47:55,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:55,766 - DEBUG - Step 18: Loss=0.6446
2025-06-02 15:47:55,766 - DEBUG - Online update step: 19/25
2025-06-02 15:47:55,769 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:55,882 - DEBUG - Node anomaly scores shape: torch.Size([19430, 1])
2025-06-02 15:47:55,886 - DEBUG - Edge anomaly scores shape: torch.Size([40990, 1])
2025-06-02 15:47:55,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:56,108 - DEBUG - Step 19: Loss=0.6566
2025-06-02 15:47:56,109 - DEBUG - Online update step: 20/25
2025-06-02 15:47:56,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:56,212 - DEBUG - Node anomaly scores shape: torch.Size([18914, 1])
2025-06-02 15:47:56,220 - DEBUG - Edge anomaly scores shape: torch.Size([39738, 1])
2025-06-02 15:47:56,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:56,446 - DEBUG - Step 20: Loss=0.6300
2025-06-02 15:47:56,446 - DEBUG - Online update step: 21/25
2025-06-02 15:47:56,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:56,568 - DEBUG - Node anomaly scores shape: torch.Size([21361, 1])
2025-06-02 15:47:56,573 - DEBUG - Edge anomaly scores shape: torch.Size([45050, 1])
2025-06-02 15:47:56,574 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:56,787 - DEBUG - Step 21: Loss=0.6396
2025-06-02 15:47:56,788 - DEBUG - Online update step: 22/25
2025-06-02 15:47:56,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:56,897 - DEBUG - Node anomaly scores shape: torch.Size([21106, 1])
2025-06-02 15:47:56,902 - DEBUG - Edge anomaly scores shape: torch.Size([44434, 1])
2025-06-02 15:47:56,903 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:57,129 - DEBUG - Step 22: Loss=0.6516
2025-06-02 15:47:57,129 - DEBUG - Online update step: 23/25
2025-06-02 15:47:57,132 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:57,261 - DEBUG - Node anomaly scores shape: torch.Size([20931, 1])
2025-06-02 15:47:57,270 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-02 15:47:57,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:57,581 - DEBUG - Step 23: Loss=0.6253
2025-06-02 15:47:57,581 - DEBUG - Online update step: 24/25
2025-06-02 15:47:57,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:57,702 - DEBUG - Node anomaly scores shape: torch.Size([20019, 1])
2025-06-02 15:47:57,708 - DEBUG - Edge anomaly scores shape: torch.Size([42206, 1])
2025-06-02 15:47:57,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:58,016 - DEBUG - Step 24: Loss=0.6444
2025-06-02 15:47:58,017 - DEBUG - Online update step: 25/25
2025-06-02 15:47:58,021 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:58,160 - DEBUG - Node anomaly scores shape: torch.Size([20547, 1])
2025-06-02 15:47:58,167 - DEBUG - Edge anomaly scores shape: torch.Size([43252, 1])
2025-06-02 15:47:58,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:58,560 - DEBUG - Step 25: Loss=0.6571
2025-06-02 15:47:58,561 - INFO - Online update finished. Average loss: 0.6432, Learning rate: 0.001000
2025-06-02 15:47:58,563 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:47:58,564 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:47:58,567 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:47:58,568 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:47:58,581 - INFO - Online update complete. Loss: 0.6432
2025-06-02 15:47:58,582 - INFO - Running anomaly detection...
2025-06-02 15:47:58,582 - INFO - Starting anomaly detection.
2025-06-02 15:47:58,591 - DEBUG - Node reconstruction errors: [0.16841194 1.4734663  1.7241497  ... 0.02925229 0.02885872 0.06827952]
2025-06-02 15:47:58,592 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:47:58,596 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154758_update_54.json
2025-06-02 15:47:58,596 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:47:58,618 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154758_update_54.pth and as latest_checkpoint.pth
2025-06-02 15:47:58,618 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870715.dot): 0.7024
2025-06-02 15:47:58,618 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:47:58,618 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4735, MLP Score: 0.5516
2025-06-02 15:47:58,619 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7241, MLP Score: 0.5055
2025-06-02 15:47:58,619 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.0445, MLP Score: 0.4985
2025-06-02 15:47:58,619 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.7828, MLP Score: 0.4953
2025-06-02 15:47:58,619 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.0005, MLP Score: 0.5055
2025-06-02 15:47:58,619 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:47:58,619 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.1670
2025-06-02 15:47:58,620 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.0270
2025-06-02 15:47:58,620 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.0269
2025-06-02 15:47:58,620 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.0058
2025-06-02 15:47:58,620 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.0033
2025-06-02 15:47:58,620 - INFO - 
--- Processing file: nw_graph_encoded_1748870745.dot (Timestamp: 2025-06-02 15:25:45) ---
2025-06-02 15:47:58,620 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-02 15:47:58,620 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 15:47:58,620 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-02 15:47:58,650 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 15:47:58,676 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 15:47:58,677 - INFO - Processing node updates/additions.
2025-06-02 15:47:58,685 - INFO - Processing edge updates/additions.
2025-06-02 15:47:58,699 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:47:58,700 - INFO - Finished updating NetworkX graph.
2025-06-02 15:47:58,701 - DEBUG - Updated graph - Nodes: 1003, Edges: 2202
2025-06-02 15:47:58,701 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:47:58,702 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:47:58,712 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 15:47:58,714 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:47:58,714 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 15:47:58,717 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 15:47:58,720 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:47:58,728 - DEBUG - Initial edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 15:47:58,730 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:47:58,730 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2202, 10])
2025-06-02 15:47:58,730 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:47:58,730 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:47:58,731 - INFO - Updated main graph to 1003 nodes and 2202 edges.
2025-06-02 15:47:58,731 - INFO - Performing online update...
2025-06-02 15:47:58,732 - INFO - Starting online update for 25 steps.
2025-06-02 15:47:58,732 - DEBUG - Updated RunningStats: new_mean=0.945376995573663, new_var=31800000000161.406, new_n=3210
2025-06-02 15:47:58,732 - DEBUG - Updated RunningStats: new_mean=0.9434670124397407, new_var=32100000000018.31, new_n=3240
2025-06-02 15:47:58,733 - DEBUG - Updated RunningStats: new_mean=44.799009165735754, new_var=10600000186531.7, new_n=1070
2025-06-02 15:47:58,733 - DEBUG - Updated RunningStats: new_mean=44.79363512687637, new_var=10700000169843.068, new_n=1080
2025-06-02 15:47:58,733 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:47:58,733 - DEBUG - Online update step: 1/25
2025-06-02 15:47:58,736 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:58,903 - DEBUG - Node anomaly scores shape: torch.Size([20291, 1])
2025-06-02 15:47:58,910 - DEBUG - Edge anomaly scores shape: torch.Size([42990, 1])
2025-06-02 15:47:58,911 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:59,132 - DEBUG - Step 1: Loss=0.6289
2025-06-02 15:47:59,133 - DEBUG - Online update step: 2/25
2025-06-02 15:47:59,137 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:59,291 - DEBUG - Node anomaly scores shape: torch.Size([21084, 1])
2025-06-02 15:47:59,301 - DEBUG - Edge anomaly scores shape: torch.Size([44638, 1])
2025-06-02 15:47:59,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:47:59,599 - DEBUG - Step 2: Loss=0.6393
2025-06-02 15:47:59,599 - DEBUG - Online update step: 3/25
2025-06-02 15:47:59,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:47:59,749 - DEBUG - Node anomaly scores shape: torch.Size([23159, 1])
2025-06-02 15:47:59,756 - DEBUG - Edge anomaly scores shape: torch.Size([49353, 1])
2025-06-02 15:47:59,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:00,130 - DEBUG - Step 3: Loss=0.6500
2025-06-02 15:48:00,131 - DEBUG - Online update step: 4/25
2025-06-02 15:48:00,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:00,353 - DEBUG - Node anomaly scores shape: torch.Size([21639, 1])
2025-06-02 15:48:00,372 - DEBUG - Edge anomaly scores shape: torch.Size([45867, 1])
2025-06-02 15:48:00,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:00,686 - DEBUG - Step 4: Loss=0.6247
2025-06-02 15:48:00,686 - DEBUG - Online update step: 5/25
2025-06-02 15:48:00,690 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:00,829 - DEBUG - Node anomaly scores shape: torch.Size([21043, 1])
2025-06-02 15:48:00,836 - DEBUG - Edge anomaly scores shape: torch.Size([44603, 1])
2025-06-02 15:48:00,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:01,187 - DEBUG - Step 5: Loss=0.6447
2025-06-02 15:48:01,187 - DEBUG - Online update step: 6/25
2025-06-02 15:48:01,191 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:01,343 - DEBUG - Node anomaly scores shape: torch.Size([20497, 1])
2025-06-02 15:48:01,350 - DEBUG - Edge anomaly scores shape: torch.Size([43371, 1])
2025-06-02 15:48:01,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:01,630 - DEBUG - Step 6: Loss=0.6559
2025-06-02 15:48:01,630 - DEBUG - Online update step: 7/25
2025-06-02 15:48:01,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:01,770 - DEBUG - Node anomaly scores shape: torch.Size([21099, 1])
2025-06-02 15:48:01,777 - DEBUG - Edge anomaly scores shape: torch.Size([44795, 1])
2025-06-02 15:48:01,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:02,217 - DEBUG - Step 7: Loss=0.6289
2025-06-02 15:48:02,217 - DEBUG - Online update step: 8/25
2025-06-02 15:48:02,221 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:02,392 - DEBUG - Node anomaly scores shape: torch.Size([22051, 1])
2025-06-02 15:48:02,409 - DEBUG - Edge anomaly scores shape: torch.Size([47001, 1])
2025-06-02 15:48:02,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:02,748 - DEBUG - Step 8: Loss=0.6373
2025-06-02 15:48:02,748 - DEBUG - Online update step: 9/25
2025-06-02 15:48:02,751 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:02,858 - DEBUG - Node anomaly scores shape: torch.Size([18288, 1])
2025-06-02 15:48:02,863 - DEBUG - Edge anomaly scores shape: torch.Size([38230, 1])
2025-06-02 15:48:02,866 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:03,087 - DEBUG - Step 9: Loss=0.6519
2025-06-02 15:48:03,088 - DEBUG - Online update step: 10/25
2025-06-02 15:48:03,091 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:03,219 - DEBUG - Node anomaly scores shape: torch.Size([19659, 1])
2025-06-02 15:48:03,224 - DEBUG - Edge anomaly scores shape: torch.Size([41356, 1])
2025-06-02 15:48:03,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:03,547 - DEBUG - Step 10: Loss=0.6242
2025-06-02 15:48:03,547 - DEBUG - Online update step: 11/25
2025-06-02 15:48:03,551 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:03,690 - DEBUG - Node anomaly scores shape: torch.Size([23668, 1])
2025-06-02 15:48:03,696 - DEBUG - Edge anomaly scores shape: torch.Size([50427, 1])
2025-06-02 15:48:03,698 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:04,078 - DEBUG - Step 11: Loss=0.6439
2025-06-02 15:48:04,078 - DEBUG - Online update step: 12/25
2025-06-02 15:48:04,082 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:04,246 - DEBUG - Node anomaly scores shape: torch.Size([21768, 1])
2025-06-02 15:48:04,257 - DEBUG - Edge anomaly scores shape: torch.Size([46104, 1])
2025-06-02 15:48:04,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:04,756 - DEBUG - Step 12: Loss=0.6566
2025-06-02 15:48:04,757 - DEBUG - Online update step: 13/25
2025-06-02 15:48:04,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:04,950 - DEBUG - Node anomaly scores shape: torch.Size([19502, 1])
2025-06-02 15:48:04,958 - DEBUG - Edge anomaly scores shape: torch.Size([41160, 1])
2025-06-02 15:48:04,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:05,268 - DEBUG - Step 13: Loss=0.6283
2025-06-02 15:48:05,268 - DEBUG - Online update step: 14/25
2025-06-02 15:48:05,273 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:05,423 - DEBUG - Node anomaly scores shape: torch.Size([22467, 1])
2025-06-02 15:48:05,429 - DEBUG - Edge anomaly scores shape: torch.Size([47830, 1])
2025-06-02 15:48:05,431 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:05,731 - DEBUG - Step 14: Loss=0.6364
2025-06-02 15:48:05,732 - DEBUG - Online update step: 15/25
2025-06-02 15:48:05,736 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:05,905 - DEBUG - Node anomaly scores shape: torch.Size([19658, 1])
2025-06-02 15:48:05,913 - DEBUG - Edge anomaly scores shape: torch.Size([41292, 1])
2025-06-02 15:48:05,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:06,200 - DEBUG - Step 15: Loss=0.6505
2025-06-02 15:48:06,201 - DEBUG - Online update step: 16/25
2025-06-02 15:48:06,205 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:06,351 - DEBUG - Node anomaly scores shape: torch.Size([20961, 1])
2025-06-02 15:48:06,359 - DEBUG - Edge anomaly scores shape: torch.Size([44261, 1])
2025-06-02 15:48:06,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:06,650 - DEBUG - Step 16: Loss=0.6225
2025-06-02 15:48:06,650 - DEBUG - Online update step: 17/25
2025-06-02 15:48:06,653 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:06,776 - DEBUG - Node anomaly scores shape: torch.Size([18349, 1])
2025-06-02 15:48:06,782 - DEBUG - Edge anomaly scores shape: torch.Size([38458, 1])
2025-06-02 15:48:06,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:07,126 - DEBUG - Step 17: Loss=0.6428
2025-06-02 15:48:07,127 - DEBUG - Online update step: 18/25
2025-06-02 15:48:07,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:07,313 - DEBUG - Node anomaly scores shape: torch.Size([19096, 1])
2025-06-02 15:48:07,328 - DEBUG - Edge anomaly scores shape: torch.Size([40437, 1])
2025-06-02 15:48:07,333 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:07,720 - DEBUG - Step 18: Loss=0.6551
2025-06-02 15:48:07,721 - DEBUG - Online update step: 19/25
2025-06-02 15:48:07,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:07,884 - DEBUG - Node anomaly scores shape: torch.Size([21959, 1])
2025-06-02 15:48:07,890 - DEBUG - Edge anomaly scores shape: torch.Size([46582, 1])
2025-06-02 15:48:07,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:08,217 - DEBUG - Step 19: Loss=0.6272
2025-06-02 15:48:08,218 - DEBUG - Online update step: 20/25
2025-06-02 15:48:08,223 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:08,405 - DEBUG - Node anomaly scores shape: torch.Size([20591, 1])
2025-06-02 15:48:08,416 - DEBUG - Edge anomaly scores shape: torch.Size([43422, 1])
2025-06-02 15:48:08,417 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:08,773 - DEBUG - Step 20: Loss=0.6366
2025-06-02 15:48:08,774 - DEBUG - Online update step: 21/25
2025-06-02 15:48:08,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:08,922 - DEBUG - Node anomaly scores shape: torch.Size([21802, 1])
2025-06-02 15:48:08,931 - DEBUG - Edge anomaly scores shape: torch.Size([46313, 1])
2025-06-02 15:48:08,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:09,314 - DEBUG - Step 21: Loss=0.6479
2025-06-02 15:48:09,314 - DEBUG - Online update step: 22/25
2025-06-02 15:48:09,319 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:09,497 - DEBUG - Node anomaly scores shape: torch.Size([20739, 1])
2025-06-02 15:48:09,505 - DEBUG - Edge anomaly scores shape: torch.Size([44101, 1])
2025-06-02 15:48:09,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:09,858 - DEBUG - Step 22: Loss=0.6216
2025-06-02 15:48:09,858 - DEBUG - Online update step: 23/25
2025-06-02 15:48:09,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:09,980 - DEBUG - Node anomaly scores shape: torch.Size([17649, 1])
2025-06-02 15:48:09,984 - DEBUG - Edge anomaly scores shape: torch.Size([36885, 1])
2025-06-02 15:48:09,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:10,212 - DEBUG - Step 23: Loss=0.6413
2025-06-02 15:48:10,212 - DEBUG - Online update step: 24/25
2025-06-02 15:48:10,218 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:10,519 - DEBUG - Node anomaly scores shape: torch.Size([22412, 1])
2025-06-02 15:48:10,530 - DEBUG - Edge anomaly scores shape: torch.Size([47616, 1])
2025-06-02 15:48:10,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:10,896 - DEBUG - Step 24: Loss=0.6532
2025-06-02 15:48:10,896 - DEBUG - Online update step: 25/25
2025-06-02 15:48:10,900 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:11,041 - DEBUG - Node anomaly scores shape: torch.Size([19821, 1])
2025-06-02 15:48:11,050 - DEBUG - Edge anomaly scores shape: torch.Size([41845, 1])
2025-06-02 15:48:11,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:11,389 - DEBUG - Step 25: Loss=0.6269
2025-06-02 15:48:11,389 - INFO - Online update finished. Average loss: 0.6391, Learning rate: 0.001000
2025-06-02 15:48:11,390 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:48:11,390 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:48:11,392 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[-3.8978514e-09  4.5524887e+02  0.0000000e+00  0.0000000e+00
  3.2482095e-09 -1.7323785e-09 -6.4964190e-09 -2.5985676e-09
  1.7323785e-09  8.6618923e-10]
2025-06-02 15:48:11,392 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[  1.0002271 435.18454     0.          0.          1.0002272   1.0002272
   1.0002271   1.0002271   1.0002271   1.0002271]
2025-06-02 15:48:11,392 - INFO - Online update complete. Loss: 0.6391
2025-06-02 15:48:11,393 - INFO - Running anomaly detection...
2025-06-02 15:48:11,393 - INFO - Starting anomaly detection.
2025-06-02 15:48:11,410 - DEBUG - Node reconstruction errors: [0.15408562 1.4320912  1.7425517  ... 0.02863939 0.02659144 0.06682684]
2025-06-02 15:48:11,410 - DEBUG - Edge reconstruction errors: [ 5.264114  5.261613 44.257854 ... 13.357839  2.158727 13.357839]
2025-06-02 15:48:11,414 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154811_update_55.json
2025-06-02 15:48:11,414 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:48:11,424 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154811_update_55.pth and as latest_checkpoint.pth
2025-06-02 15:48:11,424 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870745.dot): 0.7057
2025-06-02 15:48:11,424 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:48:11,424 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4321, MLP Score: 0.5620
2025-06-02 15:48:11,424 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7426, MLP Score: 0.5103
2025-06-02 15:48:11,425 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.0140, MLP Score: 0.5042
2025-06-02 15:48:11,425 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.6724, MLP Score: 0.4991
2025-06-02 15:48:11,425 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.9365, MLP Score: 0.5103
2025-06-02 15:48:11,425 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:48:11,425 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2579, MLP Score: 0.9656
2025-06-02 15:48:11,425 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9603, MLP Score: 0.9507
2025-06-02 15:48:11,425 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0600, MLP Score: 0.9506
2025-06-02 15:48:11,425 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7587, MLP Score: 0.8338
2025-06-02 15:48:11,425 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7582, MLP Score: 0.7710
2025-06-02 15:48:11,425 - INFO - 
--- Processing file: nw_graph_encoded_1748870775.dot (Timestamp: 2025-06-02 15:26:15) ---
2025-06-02 15:48:11,425 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-02 15:48:11,425 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 15:48:11,426 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-02 15:48:11,457 - INFO - Parsed 1005 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 15:48:11,492 - INFO - Parsed 2207 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 15:48:11,492 - INFO - Processing node updates/additions.
2025-06-02 15:48:11,502 - INFO - Processing edge updates/additions.
2025-06-02 15:48:11,521 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:48:11,523 - INFO - Finished updating NetworkX graph.
2025-06-02 15:48:11,525 - DEBUG - Updated graph - Nodes: 1005, Edges: 2207
2025-06-02 15:48:11,525 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:48:11,527 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:48:11,546 - DEBUG - Initial node features tensor shape: torch.Size([1005, 30])
2025-06-02 15:48:11,551 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:48:11,552 - DEBUG - Node features tensor shape after scaling: torch.Size([1005, 30])
2025-06-02 15:48:11,566 - DEBUG - Edge index tensor shape: torch.Size([2, 2207])
2025-06-02 15:48:11,572 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:48:11,584 - DEBUG - Initial edge attributes tensor shape: torch.Size([2207, 10])
2025-06-02 15:48:11,588 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:48:11,589 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2207, 10])
2025-06-02 15:48:11,589 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:48:11,590 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:48:11,593 - INFO - Updated main graph to 1005 nodes and 2207 edges.
2025-06-02 15:48:11,593 - INFO - Performing online update...
2025-06-02 15:48:11,594 - INFO - Starting online update for 25 steps.
2025-06-02 15:48:11,595 - DEBUG - Updated RunningStats: new_mean=0.9454343832184556, new_var=32400000000161.445, new_n=3270
2025-06-02 15:48:11,595 - DEBUG - Updated RunningStats: new_mean=0.9435575135547243, new_var=32700000000018.293, new_n=3300
2025-06-02 15:48:11,596 - DEBUG - Updated RunningStats: new_mean=44.800318382458215, new_var=10800000186508.883, new_n=1090
2025-06-02 15:48:11,597 - DEBUG - Updated RunningStats: new_mean=44.79458190043875, new_var=10900000169458.346, new_n=1100
2025-06-02 15:48:11,597 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:48:11,597 - DEBUG - Online update step: 1/25
2025-06-02 15:48:11,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:11,926 - DEBUG - Node anomaly scores shape: torch.Size([20081, 1])
2025-06-02 15:48:11,939 - DEBUG - Edge anomaly scores shape: torch.Size([42296, 1])
2025-06-02 15:48:11,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:12,335 - DEBUG - Step 1: Loss=0.6354
2025-06-02 15:48:12,336 - DEBUG - Online update step: 2/25
2025-06-02 15:48:12,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:12,522 - DEBUG - Node anomaly scores shape: torch.Size([21935, 1])
2025-06-02 15:48:12,529 - DEBUG - Edge anomaly scores shape: torch.Size([46646, 1])
2025-06-02 15:48:12,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:12,844 - DEBUG - Step 2: Loss=0.6458
2025-06-02 15:48:12,844 - DEBUG - Online update step: 3/25
2025-06-02 15:48:12,847 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:12,950 - DEBUG - Node anomaly scores shape: torch.Size([18559, 1])
2025-06-02 15:48:12,955 - DEBUG - Edge anomaly scores shape: torch.Size([39049, 1])
2025-06-02 15:48:12,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:13,194 - DEBUG - Step 3: Loss=0.6224
2025-06-02 15:48:13,194 - DEBUG - Online update step: 4/25
2025-06-02 15:48:13,198 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:13,317 - DEBUG - Node anomaly scores shape: torch.Size([19225, 1])
2025-06-02 15:48:13,322 - DEBUG - Edge anomaly scores shape: torch.Size([40382, 1])
2025-06-02 15:48:13,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:13,584 - DEBUG - Step 4: Loss=0.6406
2025-06-02 15:48:13,584 - DEBUG - Online update step: 5/25
2025-06-02 15:48:13,588 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:13,778 - DEBUG - Node anomaly scores shape: torch.Size([22464, 1])
2025-06-02 15:48:13,787 - DEBUG - Edge anomaly scores shape: torch.Size([47643, 1])
2025-06-02 15:48:13,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:14,258 - DEBUG - Step 5: Loss=0.6522
2025-06-02 15:48:14,258 - DEBUG - Online update step: 6/25
2025-06-02 15:48:14,262 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:14,514 - DEBUG - Node anomaly scores shape: torch.Size([19769, 1])
2025-06-02 15:48:14,549 - DEBUG - Edge anomaly scores shape: torch.Size([41511, 1])
2025-06-02 15:48:14,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:14,889 - DEBUG - Step 6: Loss=0.6250
2025-06-02 15:48:14,890 - DEBUG - Online update step: 7/25
2025-06-02 15:48:14,893 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:15,076 - DEBUG - Node anomaly scores shape: torch.Size([21568, 1])
2025-06-02 15:48:15,086 - DEBUG - Edge anomaly scores shape: torch.Size([45556, 1])
2025-06-02 15:48:15,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:15,359 - DEBUG - Step 7: Loss=0.6361
2025-06-02 15:48:15,360 - DEBUG - Online update step: 8/25
2025-06-02 15:48:15,363 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:15,703 - DEBUG - Node anomaly scores shape: torch.Size([22369, 1])
2025-06-02 15:48:15,724 - DEBUG - Edge anomaly scores shape: torch.Size([47615, 1])
2025-06-02 15:48:15,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:16,207 - DEBUG - Step 8: Loss=0.6482
2025-06-02 15:48:16,208 - DEBUG - Online update step: 9/25
2025-06-02 15:48:16,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:16,320 - DEBUG - Node anomaly scores shape: torch.Size([20932, 1])
2025-06-02 15:48:16,328 - DEBUG - Edge anomaly scores shape: torch.Size([44351, 1])
2025-06-02 15:48:16,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:16,818 - DEBUG - Step 9: Loss=0.6226
2025-06-02 15:48:16,818 - DEBUG - Online update step: 10/25
2025-06-02 15:48:16,828 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:17,124 - DEBUG - Node anomaly scores shape: torch.Size([21766, 1])
2025-06-02 15:48:17,136 - DEBUG - Edge anomaly scores shape: torch.Size([46007, 1])
2025-06-02 15:48:17,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:17,546 - DEBUG - Step 10: Loss=0.6368
2025-06-02 15:48:17,546 - DEBUG - Online update step: 11/25
2025-06-02 15:48:17,550 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:17,662 - DEBUG - Node anomaly scores shape: torch.Size([20243, 1])
2025-06-02 15:48:17,669 - DEBUG - Edge anomaly scores shape: torch.Size([42757, 1])
2025-06-02 15:48:17,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:17,926 - DEBUG - Step 11: Loss=0.6490
2025-06-02 15:48:17,927 - DEBUG - Online update step: 12/25
2025-06-02 15:48:17,930 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:18,083 - DEBUG - Node anomaly scores shape: torch.Size([19571, 1])
2025-06-02 15:48:18,114 - DEBUG - Edge anomaly scores shape: torch.Size([41120, 1])
2025-06-02 15:48:18,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:18,414 - DEBUG - Step 12: Loss=0.6219
2025-06-02 15:48:18,414 - DEBUG - Online update step: 13/25
2025-06-02 15:48:18,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:18,548 - DEBUG - Node anomaly scores shape: torch.Size([21034, 1])
2025-06-02 15:48:18,556 - DEBUG - Edge anomaly scores shape: torch.Size([44632, 1])
2025-06-02 15:48:18,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:18,837 - DEBUG - Step 13: Loss=0.6360
2025-06-02 15:48:18,837 - DEBUG - Online update step: 14/25
2025-06-02 15:48:18,841 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:18,988 - DEBUG - Node anomaly scores shape: torch.Size([22353, 1])
2025-06-02 15:48:18,995 - DEBUG - Edge anomaly scores shape: torch.Size([47322, 1])
2025-06-02 15:48:18,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:19,270 - DEBUG - Step 14: Loss=0.6477
2025-06-02 15:48:19,270 - DEBUG - Online update step: 15/25
2025-06-02 15:48:19,274 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:19,388 - DEBUG - Node anomaly scores shape: torch.Size([21642, 1])
2025-06-02 15:48:19,393 - DEBUG - Edge anomaly scores shape: torch.Size([45794, 1])
2025-06-02 15:48:19,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:19,821 - DEBUG - Step 15: Loss=0.6216
2025-06-02 15:48:19,821 - DEBUG - Online update step: 16/25
2025-06-02 15:48:19,827 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:19,948 - DEBUG - Node anomaly scores shape: torch.Size([21417, 1])
2025-06-02 15:48:19,955 - DEBUG - Edge anomaly scores shape: torch.Size([45318, 1])
2025-06-02 15:48:19,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:20,209 - DEBUG - Step 16: Loss=0.6369
2025-06-02 15:48:20,209 - DEBUG - Online update step: 17/25
2025-06-02 15:48:20,213 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:20,354 - DEBUG - Node anomaly scores shape: torch.Size([24251, 1])
2025-06-02 15:48:20,361 - DEBUG - Edge anomaly scores shape: torch.Size([51787, 1])
2025-06-02 15:48:20,362 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:20,873 - DEBUG - Step 17: Loss=0.6487
2025-06-02 15:48:20,873 - DEBUG - Online update step: 18/25
2025-06-02 15:48:20,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:21,011 - DEBUG - Node anomaly scores shape: torch.Size([20442, 1])
2025-06-02 15:48:21,019 - DEBUG - Edge anomaly scores shape: torch.Size([43310, 1])
2025-06-02 15:48:21,020 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:21,273 - DEBUG - Step 18: Loss=0.6229
2025-06-02 15:48:21,273 - DEBUG - Online update step: 19/25
2025-06-02 15:48:21,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:21,425 - DEBUG - Node anomaly scores shape: torch.Size([19437, 1])
2025-06-02 15:48:21,433 - DEBUG - Edge anomaly scores shape: torch.Size([40709, 1])
2025-06-02 15:48:21,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:21,663 - DEBUG - Step 19: Loss=0.6364
2025-06-02 15:48:21,663 - DEBUG - Online update step: 20/25
2025-06-02 15:48:21,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:21,813 - DEBUG - Node anomaly scores shape: torch.Size([21383, 1])
2025-06-02 15:48:21,823 - DEBUG - Edge anomaly scores shape: torch.Size([45186, 1])
2025-06-02 15:48:21,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:22,063 - DEBUG - Step 20: Loss=0.6470
2025-06-02 15:48:22,063 - DEBUG - Online update step: 21/25
2025-06-02 15:48:22,066 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:22,185 - DEBUG - Node anomaly scores shape: torch.Size([21006, 1])
2025-06-02 15:48:22,196 - DEBUG - Edge anomaly scores shape: torch.Size([44337, 1])
2025-06-02 15:48:22,197 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:22,403 - DEBUG - Step 21: Loss=0.6206
2025-06-02 15:48:22,403 - DEBUG - Online update step: 22/25
2025-06-02 15:48:22,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:22,525 - DEBUG - Node anomaly scores shape: torch.Size([21244, 1])
2025-06-02 15:48:22,533 - DEBUG - Edge anomaly scores shape: torch.Size([45069, 1])
2025-06-02 15:48:22,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:22,787 - DEBUG - Step 22: Loss=0.6358
2025-06-02 15:48:22,788 - DEBUG - Online update step: 23/25
2025-06-02 15:48:22,792 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:23,010 - DEBUG - Node anomaly scores shape: torch.Size([19770, 1])
2025-06-02 15:48:23,017 - DEBUG - Edge anomaly scores shape: torch.Size([41673, 1])
2025-06-02 15:48:23,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:23,247 - DEBUG - Step 23: Loss=0.6491
2025-06-02 15:48:23,247 - DEBUG - Online update step: 24/25
2025-06-02 15:48:23,250 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:23,387 - DEBUG - Node anomaly scores shape: torch.Size([22764, 1])
2025-06-02 15:48:23,396 - DEBUG - Edge anomaly scores shape: torch.Size([48367, 1])
2025-06-02 15:48:23,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:23,708 - DEBUG - Step 24: Loss=0.6225
2025-06-02 15:48:23,708 - DEBUG - Online update step: 25/25
2025-06-02 15:48:23,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:23,839 - DEBUG - Node anomaly scores shape: torch.Size([20858, 1])
2025-06-02 15:48:23,844 - DEBUG - Edge anomaly scores shape: torch.Size([44057, 1])
2025-06-02 15:48:23,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:24,087 - DEBUG - Step 25: Loss=0.6333
2025-06-02 15:48:24,087 - INFO - Online update finished. Average loss: 0.6358, Learning rate: 0.001000
2025-06-02 15:48:24,088 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8266896e-08
 -8.5403666e-09  4.1397058e-08 -9.0148315e-09 -3.7957189e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  2.1350917e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-08  2.1469534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.0257037e-08 -1.9927523e-08], current edge mean: [-1.7284537e-09  4.5522110e+02  0.0000000e+00  0.0000000e+00
  3.4569074e-09 -8.6422686e-10  8.6422686e-10  9.7225517e-10
 -5.8335310e-09  2.5926805e-09]
2025-06-02 15:48:24,089 - DEBUG - Node drift difference: 0.0048, Edge drift difference: 0.0001
2025-06-02 15:48:24,090 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8266896e-08
 -8.5403666e-09  4.1397058e-08 -9.0148315e-09 -3.7957189e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  2.1350917e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-08  2.1469534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.0257037e-08 -1.9927523e-08], edge=[-1.7284537e-09  4.5522110e+02  0.0000000e+00  0.0000000e+00
  3.4569074e-09 -8.6422686e-10  8.6422686e-10  9.7225517e-10
 -5.8335310e-09  2.5926805e-09]
2025-06-02 15:48:24,090 - DEBUG - Updated reference std: node=[0.         0.         1.0004979  1.0004979  0.         0.
 0.         1.0004978  1.0004979  1.0004978  1.0004978  1.0004978
 0.94502825 0.2725181  0.37022114 0.5732797  1.0004979  3.021951
 2.9069915  1.4823681  0.37022114 0.2208081  1.0004979  1.0004979
 0.         0.         0.         0.         1.0004979  1.0004978 ], edge=[  1.0002267 434.69147     0.          0.          1.0002266   1.0002266
   1.0002265   1.0002266   1.0002266   1.0002266]
2025-06-02 15:48:24,091 - INFO - Online update complete. Loss: 0.6358
2025-06-02 15:48:24,091 - INFO - Running anomaly detection...
2025-06-02 15:48:24,091 - INFO - Starting anomaly detection.
2025-06-02 15:48:24,103 - DEBUG - Node reconstruction errors: [0.14012034 1.4422172  1.7950523  ... 0.05481466 0.02005596 0.01901219]
2025-06-02 15:48:24,104 - DEBUG - Edge reconstruction errors: [ 5.2639437  5.26144   44.257683  ... 13.357663   2.1585512 13.357663 ]
2025-06-02 15:48:24,106 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154824_update_56.json
2025-06-02 15:48:24,106 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:48:24,115 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154824_update_56.pth and as latest_checkpoint.pth
2025-06-02 15:48:24,115 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870775.dot): 0.7202
2025-06-02 15:48:24,115 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:48:24,115 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4422, MLP Score: 0.5432
2025-06-02 15:48:24,115 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7951, MLP Score: 0.4965
2025-06-02 15:48:24,115 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.9916, MLP Score: 0.4979
2025-06-02 15:48:24,115 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.6073, MLP Score: 0.4945
2025-06-02 15:48:24,116 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.8337, MLP Score: 0.4965
2025-06-02 15:48:24,116 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:48:24,116 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2577, MLP Score: 0.9896
2025-06-02 15:48:24,116 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9601, MLP Score: 0.9904
2025-06-02 15:48:24,116 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0598, MLP Score: 0.9904
2025-06-02 15:48:24,116 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7607, MLP Score: 0.9753
2025-06-02 15:48:24,116 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7586, MLP Score: 0.9597
2025-06-02 15:48:24,122 - DEBUG - Embedding standard deviations before t-SNE: [1.1969085  0.07500557 1.2890997  1.128554   2.0874503  0.
 0.7756714  0.8291331  2.213225   1.2360623  0.7560554  0.
 1.6251906  0.68900514 1.1075712  1.1948032  0.         0.5139302
 0.         0.06288639 3.1770282  0.70133483 0.         1.2172501
 1.0325698  0.9452021  0.         0.8855973  2.0846932  0.
 1.2044559  0.42580357]
2025-06-02 15:48:25,034 - INFO - Embeddings visualization saved to vis/embeddings_56_updates_20250602_154824.png
2025-06-02 15:48:25,034 - INFO - Performing visualization of node and edge features.
2025-06-02 15:48:25,035 - INFO - Starting visualization of node features.
2025-06-02 15:48:25,036 - INFO - Graph has 1005 nodes and 30 features.
2025-06-02 15:48:25,036 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:48:25,036 - INFO - Calculating feature statistics:
2025-06-02 15:48:25,036 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,036 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,036 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7107942), 'max': np.float32(3.1591537)}
2025-06-02 15:48:25,036 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(-3.036575e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9619691), 'max': np.float32(1.8120885)}
2025-06-02 15:48:25,036 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,037 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,037 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,037 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-7.591438e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45599636), 'max': np.float32(2.1929998)}
2025-06-02 15:48:25,037 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1470258), 'max': np.float32(0.87182)}
2025-06-02 15:48:25,037 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.7957186e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.445913), 'max': np.float32(0.10811979)}
2025-06-02 15:48:25,037 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 28, 'mean': np.float32(1.5182875e-08), 'std': np.float32(1.0), 'min': np.float32(-2.225497), 'max': np.float32(2.067204)}
2025-06-02 15:48:25,037 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 28, 'mean': np.float32(-3.036575e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.9784383), 'max': np.float32(2.3454158)}
2025-06-02 15:48:25,037 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2626865), 'std': np.float32(0.94455796), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:48:25,037 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.962189), 'std': np.float32(0.27238247), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:48:25,037 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14925373), 'std': np.float32(0.3700369), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:48:25,037 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3940296), 'std': np.float32(0.57299435), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:48:25,038 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.795719e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108119786), 'max': np.float32(9.445913)}
2025-06-02 15:48:25,038 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.4328358), 'std': np.float32(3.0204473), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:48:25,038 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7800994), 'std': np.float32(2.905545), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:48:25,038 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.61393), 'std': np.float32(1.4816304), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:48:25,038 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14925373), 'std': np.float32(0.3700369), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:48:25,038 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993035), 'std': np.float32(0.22069824), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:48:25,038 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.591438e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.12731494), 'max': np.float32(16.562014)}
2025-06-02 15:48:25,038 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.6570032e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.13881561), 'max': np.float32(7.2038)}
2025-06-02 15:48:25,038 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,038 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,038 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,038 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:25,039 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(4.5548624e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9881183), 'max': np.float32(10.426352)}
2025-06-02 15:48:25,039 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-4.5548624e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0910678), 'max': np.float32(4.446928)}
2025-06-02 15:48:25,054 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c09caa7e0>
2025-06-02 15:48:25,202 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:48:25,255 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:48:25,473 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:48:26,970 - INFO - Node feature visualization saved to vis/node_features_20250602_154825.png
2025-06-02 15:48:26,970 - INFO - Finished visualization of node features.
2025-06-02 15:48:26,970 - INFO - Performing additional feature analysis:
2025-06-02 15:48:26,970 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:48:26,972 - INFO - Starting visualization of edge features.
2025-06-02 15:48:26,972 - INFO - Graph has 2207 edges and 10 edge features.
2025-06-02 15:48:26,972 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:48:26,972 - INFO - Calculating edge feature statistics:
2025-06-02 15:48:26,973 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:48:26,973 - INFO - - count: {'name': 'count', 'unique': 39, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.034745842), 'max': np.float32(33.19388)}
2025-06-02 15:48:26,973 - INFO - - dst_port: {'name': 'dst_port', 'unique': 19, 'mean': np.float32(455.2211), 'std': np.float32(434.593), 'min': np.float32(0.0), 'max': np.float32(8898.0)}
2025-06-02 15:48:26,973 - INFO - - protocol: {'name': 'protocol', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:26,973 - INFO - - service: {'name': 'service', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:48:26,973 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1487, 'mean': np.float32(3.4569074e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059603624), 'max': np.float32(27.724396)}
2025-06-02 15:48:26,973 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1553, 'mean': np.float32(-1.7284537e-09), 'std': np.float32(1.0), 'min': np.float32(-0.055753566), 'max': np.float32(30.797874)}
2025-06-02 15:48:26,973 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 512, 'mean': np.float32(3.4569074e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.043381877), 'max': np.float32(33.074604)}
2025-06-02 15:48:26,973 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1531, 'mean': np.float32(-3.4569074e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0889072), 'max': np.float32(28.729872)}
2025-06-02 15:48:26,973 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1561, 'mean': np.float32(-8.6422686e-10), 'std': np.float32(1.0), 'min': np.float32(-0.08862654), 'max': np.float32(27.611528)}
2025-06-02 15:48:26,973 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 568, 'mean': np.float32(-2.5926805e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052383553), 'max': np.float32(32.50327)}
2025-06-02 15:48:26,989 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c093615e0>
2025-06-02 15:48:27,095 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:48:27,108 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x766c18f5e330>
2025-06-02 15:48:27,208 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:48:27,374 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:48:27,514 - DEBUG - Plotted boxplots of the first 8 non-constant edge features.
2025-06-02 15:48:27,530 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:48:27,536 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:48:29,004 - INFO - Edge feature visualization saved to vis/edge_features_20250602_154827.png
2025-06-02 15:48:29,004 - INFO - Finished visualization of edge features.
2025-06-02 15:48:29,005 - INFO - Performing additional edge feature analysis:
2025-06-02 15:48:29,005 - INFO - - 2 out of 10 edge features are constant.
2025-06-02 15:48:29,005 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:48:29,007 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:48:29,007 - INFO - Graph has 2207 edges and 10 edge features.
2025-06-02 15:48:29,007 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:48:29,307 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_154829_summary.png
2025-06-02 15:48:29,583 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_154829_pca_3d.png
2025-06-02 15:48:29,765 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_154829_pca_variance.png
2025-06-02 15:48:29,766 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:48:29,766 - INFO - 
--- Processing file: nw_graph_encoded_1748870805.dot (Timestamp: 2025-06-02 15:26:45) ---
2025-06-02 15:48:29,766 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-02 15:48:29,766 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 15:48:29,766 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-02 15:48:29,787 - INFO - Parsed 1009 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 15:48:29,809 - INFO - Parsed 2219 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 15:48:29,809 - INFO - Processing node updates/additions.
2025-06-02 15:48:29,815 - INFO - Processing edge updates/additions.
2025-06-02 15:48:29,828 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:48:29,829 - INFO - Finished updating NetworkX graph.
2025-06-02 15:48:29,829 - DEBUG - Updated graph - Nodes: 1009, Edges: 2219
2025-06-02 15:48:29,829 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:48:29,831 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:48:29,841 - DEBUG - Initial node features tensor shape: torch.Size([1009, 30])
2025-06-02 15:48:29,843 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:48:29,843 - DEBUG - Node features tensor shape after scaling: torch.Size([1009, 30])
2025-06-02 15:48:29,845 - DEBUG - Edge index tensor shape: torch.Size([2, 2219])
2025-06-02 15:48:29,847 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:48:29,853 - DEBUG - Initial edge attributes tensor shape: torch.Size([2219, 10])
2025-06-02 15:48:29,854 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:48:29,854 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2219, 10])
2025-06-02 15:48:29,854 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:48:29,855 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:48:29,856 - INFO - Updated main graph to 1009 nodes and 2219 edges.
2025-06-02 15:48:29,856 - INFO - Performing online update...
2025-06-02 15:48:29,856 - INFO - Starting online update for 25 steps.
2025-06-02 15:48:29,856 - DEBUG - Updated RunningStats: new_mean=0.945477921874116, new_var=33000000000161.348, new_n=3330
2025-06-02 15:48:29,857 - DEBUG - Updated RunningStats: new_mean=0.9436303340368478, new_var=33300000000018.31, new_n=3360
2025-06-02 15:48:29,857 - DEBUG - Updated RunningStats: new_mean=44.80092929283682, new_var=11000000186320.396, new_n=1110
2025-06-02 15:48:29,857 - DEBUG - Updated RunningStats: new_mean=44.794304531322105, new_var=11100000168599.082, new_n=1120
2025-06-02 15:48:29,857 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:48:29,857 - DEBUG - Online update step: 1/25
2025-06-02 15:48:29,860 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:29,989 - DEBUG - Node anomaly scores shape: torch.Size([21156, 1])
2025-06-02 15:48:30,001 - DEBUG - Edge anomaly scores shape: torch.Size([44697, 1])
2025-06-02 15:48:30,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:30,235 - DEBUG - Step 1: Loss=0.6468
2025-06-02 15:48:30,235 - DEBUG - Online update step: 2/25
2025-06-02 15:48:30,243 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:30,543 - DEBUG - Node anomaly scores shape: torch.Size([22273, 1])
2025-06-02 15:48:30,574 - DEBUG - Edge anomaly scores shape: torch.Size([47459, 1])
2025-06-02 15:48:30,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:30,902 - DEBUG - Step 2: Loss=0.6187
2025-06-02 15:48:30,902 - DEBUG - Online update step: 3/25
2025-06-02 15:48:30,909 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:31,043 - DEBUG - Node anomaly scores shape: torch.Size([21453, 1])
2025-06-02 15:48:31,049 - DEBUG - Edge anomaly scores shape: torch.Size([45504, 1])
2025-06-02 15:48:31,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:31,317 - DEBUG - Step 3: Loss=0.6355
2025-06-02 15:48:31,317 - DEBUG - Online update step: 4/25
2025-06-02 15:48:31,321 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:31,470 - DEBUG - Node anomaly scores shape: torch.Size([21603, 1])
2025-06-02 15:48:31,477 - DEBUG - Edge anomaly scores shape: torch.Size([45752, 1])
2025-06-02 15:48:31,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:31,725 - DEBUG - Step 4: Loss=0.6472
2025-06-02 15:48:31,725 - DEBUG - Online update step: 5/25
2025-06-02 15:48:31,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:31,856 - DEBUG - Node anomaly scores shape: torch.Size([19956, 1])
2025-06-02 15:48:31,861 - DEBUG - Edge anomaly scores shape: torch.Size([42073, 1])
2025-06-02 15:48:31,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:32,112 - DEBUG - Step 5: Loss=0.6214
2025-06-02 15:48:32,112 - DEBUG - Online update step: 6/25
2025-06-02 15:48:32,116 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:32,236 - DEBUG - Node anomaly scores shape: torch.Size([21629, 1])
2025-06-02 15:48:32,242 - DEBUG - Edge anomaly scores shape: torch.Size([46146, 1])
2025-06-02 15:48:32,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:32,499 - DEBUG - Step 6: Loss=0.6328
2025-06-02 15:48:32,500 - DEBUG - Online update step: 7/25
2025-06-02 15:48:32,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:32,617 - DEBUG - Node anomaly scores shape: torch.Size([20841, 1])
2025-06-02 15:48:32,624 - DEBUG - Edge anomaly scores shape: torch.Size([44029, 1])
2025-06-02 15:48:32,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:32,868 - DEBUG - Step 7: Loss=0.6458
2025-06-02 15:48:32,869 - DEBUG - Online update step: 8/25
2025-06-02 15:48:32,872 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:32,977 - DEBUG - Node anomaly scores shape: torch.Size([18534, 1])
2025-06-02 15:48:32,982 - DEBUG - Edge anomaly scores shape: torch.Size([38845, 1])
2025-06-02 15:48:32,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:33,162 - DEBUG - Step 8: Loss=0.6205
2025-06-02 15:48:33,162 - DEBUG - Online update step: 9/25
2025-06-02 15:48:33,165 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:33,292 - DEBUG - Node anomaly scores shape: torch.Size([21408, 1])
2025-06-02 15:48:33,300 - DEBUG - Edge anomaly scores shape: torch.Size([45332, 1])
2025-06-02 15:48:33,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:33,718 - DEBUG - Step 9: Loss=0.6373
2025-06-02 15:48:33,718 - DEBUG - Online update step: 10/25
2025-06-02 15:48:33,722 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:33,854 - DEBUG - Node anomaly scores shape: torch.Size([23081, 1])
2025-06-02 15:48:33,862 - DEBUG - Edge anomaly scores shape: torch.Size([49084, 1])
2025-06-02 15:48:33,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:34,156 - DEBUG - Step 10: Loss=0.6493
2025-06-02 15:48:34,156 - DEBUG - Online update step: 11/25
2025-06-02 15:48:34,159 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:34,282 - DEBUG - Node anomaly scores shape: torch.Size([23349, 1])
2025-06-02 15:48:34,288 - DEBUG - Edge anomaly scores shape: torch.Size([49807, 1])
2025-06-02 15:48:34,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:34,533 - DEBUG - Step 11: Loss=0.6232
2025-06-02 15:48:34,534 - DEBUG - Online update step: 12/25
2025-06-02 15:48:34,538 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:34,634 - DEBUG - Node anomaly scores shape: torch.Size([18774, 1])
2025-06-02 15:48:34,638 - DEBUG - Edge anomaly scores shape: torch.Size([39252, 1])
2025-06-02 15:48:34,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:34,820 - DEBUG - Step 12: Loss=0.6325
2025-06-02 15:48:34,821 - DEBUG - Online update step: 13/25
2025-06-02 15:48:34,826 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:34,944 - DEBUG - Node anomaly scores shape: torch.Size([21768, 1])
2025-06-02 15:48:34,950 - DEBUG - Edge anomaly scores shape: torch.Size([46206, 1])
2025-06-02 15:48:34,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:35,164 - DEBUG - Step 13: Loss=0.6442
2025-06-02 15:48:35,164 - DEBUG - Online update step: 14/25
2025-06-02 15:48:35,167 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:35,267 - DEBUG - Node anomaly scores shape: torch.Size([18759, 1])
2025-06-02 15:48:35,272 - DEBUG - Edge anomaly scores shape: torch.Size([39560, 1])
2025-06-02 15:48:35,274 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:35,468 - DEBUG - Step 14: Loss=0.6195
2025-06-02 15:48:35,469 - DEBUG - Online update step: 15/25
2025-06-02 15:48:35,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:35,582 - DEBUG - Node anomaly scores shape: torch.Size([20834, 1])
2025-06-02 15:48:35,588 - DEBUG - Edge anomaly scores shape: torch.Size([43981, 1])
2025-06-02 15:48:35,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:35,793 - DEBUG - Step 15: Loss=0.6351
2025-06-02 15:48:35,793 - DEBUG - Online update step: 16/25
2025-06-02 15:48:35,796 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:35,900 - DEBUG - Node anomaly scores shape: torch.Size([21227, 1])
2025-06-02 15:48:35,906 - DEBUG - Edge anomaly scores shape: torch.Size([44963, 1])
2025-06-02 15:48:35,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:36,106 - DEBUG - Step 16: Loss=0.6473
2025-06-02 15:48:36,106 - DEBUG - Online update step: 17/25
2025-06-02 15:48:36,109 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:36,208 - DEBUG - Node anomaly scores shape: torch.Size([20597, 1])
2025-06-02 15:48:36,213 - DEBUG - Edge anomaly scores shape: torch.Size([43472, 1])
2025-06-02 15:48:36,214 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:36,407 - DEBUG - Step 17: Loss=0.6214
2025-06-02 15:48:36,407 - DEBUG - Online update step: 18/25
2025-06-02 15:48:36,411 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:36,532 - DEBUG - Node anomaly scores shape: torch.Size([22562, 1])
2025-06-02 15:48:36,538 - DEBUG - Edge anomaly scores shape: torch.Size([48142, 1])
2025-06-02 15:48:36,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:36,783 - DEBUG - Step 18: Loss=0.6309
2025-06-02 15:48:36,784 - DEBUG - Online update step: 19/25
2025-06-02 15:48:36,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:36,897 - DEBUG - Node anomaly scores shape: torch.Size([21852, 1])
2025-06-02 15:48:36,903 - DEBUG - Edge anomaly scores shape: torch.Size([46411, 1])
2025-06-02 15:48:36,904 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:37,125 - DEBUG - Step 19: Loss=0.6445
2025-06-02 15:48:37,126 - DEBUG - Online update step: 20/25
2025-06-02 15:48:37,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:37,235 - DEBUG - Node anomaly scores shape: torch.Size([21634, 1])
2025-06-02 15:48:37,242 - DEBUG - Edge anomaly scores shape: torch.Size([45758, 1])
2025-06-02 15:48:37,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:37,478 - DEBUG - Step 20: Loss=0.6197
2025-06-02 15:48:37,479 - DEBUG - Online update step: 21/25
2025-06-02 15:48:37,482 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:37,596 - DEBUG - Node anomaly scores shape: torch.Size([21414, 1])
2025-06-02 15:48:37,602 - DEBUG - Edge anomaly scores shape: torch.Size([45159, 1])
2025-06-02 15:48:37,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:37,790 - DEBUG - Step 21: Loss=0.6327
2025-06-02 15:48:37,790 - DEBUG - Online update step: 22/25
2025-06-02 15:48:37,793 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:37,904 - DEBUG - Node anomaly scores shape: torch.Size([22701, 1])
2025-06-02 15:48:37,909 - DEBUG - Edge anomaly scores shape: torch.Size([48413, 1])
2025-06-02 15:48:37,910 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:38,127 - DEBUG - Step 22: Loss=0.6448
2025-06-02 15:48:38,127 - DEBUG - Online update step: 23/25
2025-06-02 15:48:38,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:38,240 - DEBUG - Node anomaly scores shape: torch.Size([21051, 1])
2025-06-02 15:48:38,245 - DEBUG - Edge anomaly scores shape: torch.Size([44436, 1])
2025-06-02 15:48:38,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:38,454 - DEBUG - Step 23: Loss=0.6191
2025-06-02 15:48:38,454 - DEBUG - Online update step: 24/25
2025-06-02 15:48:38,457 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:38,587 - DEBUG - Node anomaly scores shape: torch.Size([21683, 1])
2025-06-02 15:48:38,594 - DEBUG - Edge anomaly scores shape: torch.Size([46158, 1])
2025-06-02 15:48:38,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:38,799 - DEBUG - Step 24: Loss=0.6327
2025-06-02 15:48:38,799 - DEBUG - Online update step: 25/25
2025-06-02 15:48:38,802 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:38,923 - DEBUG - Node anomaly scores shape: torch.Size([21240, 1])
2025-06-02 15:48:38,929 - DEBUG - Edge anomaly scores shape: torch.Size([44951, 1])
2025-06-02 15:48:38,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:39,164 - DEBUG - Step 25: Loss=0.6441
2025-06-02 15:48:39,165 - INFO - Online update finished. Average loss: 0.6339, Learning rate: 0.001000
2025-06-02 15:48:39,166 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  8.97909391e-09 -1.91396481e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.28445822e-08
  6.14359053e-09 -1.03968461e-08  1.08694298e-08 -1.74856041e-08
  2.25173450e+00  2.96233892e+00  1.44697726e-01  4.39643192e+00
  1.41775169e-08  3.42319131e+00  5.76412296e+00  7.62140751e+00
  1.44697726e-01  7.99306250e+00  5.67100678e-09 -1.13420136e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.03968461e-08  2.93002014e-08], current edge mean: [-6.0168728e-09  4.5499142e+02  0.0000000e+00  0.0000000e+00
  1.3967740e-09  1.7191065e-09  2.1488831e-09  1.0744415e-09
  5.3722076e-09  0.0000000e+00]
2025-06-02 15:48:39,167 - DEBUG - Node drift difference: 0.0123, Edge drift difference: 0.0005
2025-06-02 15:48:39,169 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  8.97909391e-09 -1.91396481e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.28445822e-08
  6.14359053e-09 -1.03968461e-08  1.08694298e-08 -1.74856041e-08
  2.25173450e+00  2.96233892e+00  1.44697726e-01  4.39643192e+00
  1.41775169e-08  3.42319131e+00  5.76412296e+00  7.62140751e+00
  1.44697726e-01  7.99306250e+00  5.67100678e-09 -1.13420136e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.03968461e-08  2.93002014e-08], edge=[-6.0168728e-09  4.5499142e+02  0.0000000e+00  0.0000000e+00
  1.3967740e-09  1.7191065e-09  2.1488831e-09  1.0744415e-09
  5.3722076e-09  0.0000000e+00]
2025-06-02 15:48:39,170 - DEBUG - Updated reference std: node=[0.         0.         1.0004959  1.0004959  0.         0.
 0.         1.0004959  1.0004959  1.0004959  1.0004959  1.0004959
 0.95122075 0.27198726 0.3657919  0.57340807 1.0004959  3.0204818
 2.9123883  1.4690516  0.3657919  0.22037    1.0004959  1.0004959
 0.         0.         0.         0.         1.0004959  1.0004959 ], edge=[  1.0002253 433.58798     0.          0.          1.0002254   1.0002254
   1.0002254   1.0002254   1.0002254   1.0002254]
2025-06-02 15:48:39,170 - INFO - Online update complete. Loss: 0.6339
2025-06-02 15:48:39,170 - INFO - Running anomaly detection...
2025-06-02 15:48:39,171 - INFO - Starting anomaly detection.
2025-06-02 15:48:39,179 - DEBUG - Node reconstruction errors: [0.12545256 1.4142162  1.7577137  ... 0.01423232 0.01423232 0.01423232]
2025-06-02 15:48:39,179 - DEBUG - Edge reconstruction errors: [ 5.2638426  5.2613387 44.257576  ... 13.357559   2.158449  13.357559 ]
2025-06-02 15:48:39,183 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154839_update_57.json
2025-06-02 15:48:39,183 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:48:39,203 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154839_update_57.pth and as latest_checkpoint.pth
2025-06-02 15:48:39,203 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870805.dot): 0.7264
2025-06-02 15:48:39,203 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:48:39,203 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4142, MLP Score: 0.5427
2025-06-02 15:48:39,204 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7577, MLP Score: 0.4876
2025-06-02 15:48:39,204 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.9453, MLP Score: 0.4848
2025-06-02 15:48:39,204 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.4980, MLP Score: 0.4812
2025-06-02 15:48:39,204 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.8709, MLP Score: 0.4876
2025-06-02 15:48:39,204 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:48:39,205 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2576, MLP Score: 0.9420
2025-06-02 15:48:39,205 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9601, MLP Score: 0.9115
2025-06-02 15:48:39,205 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0597, MLP Score: 0.9114
2025-06-02 15:48:39,205 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7623, MLP Score: 0.7868
2025-06-02 15:48:39,205 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7586, MLP Score: 0.6802
2025-06-02 15:48:39,205 - INFO - 
--- Processing file: nw_graph_encoded_1748870835.dot (Timestamp: 2025-06-02 15:27:15) ---
2025-06-02 15:48:39,205 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-02 15:48:39,205 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 15:48:39,205 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-02 15:48:39,233 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 15:48:39,258 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 15:48:39,258 - INFO - Processing node updates/additions.
2025-06-02 15:48:39,265 - INFO - Processing edge updates/additions.
2025-06-02 15:48:39,278 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:48:39,279 - INFO - Finished updating NetworkX graph.
2025-06-02 15:48:39,280 - DEBUG - Updated graph - Nodes: 1010, Edges: 2220
2025-06-02 15:48:39,280 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:48:39,281 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:48:39,293 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 15:48:39,295 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:48:39,295 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 15:48:39,297 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 15:48:39,298 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:48:39,303 - DEBUG - Initial edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 15:48:39,304 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:48:39,304 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2220, 10])
2025-06-02 15:48:39,304 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:48:39,305 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:48:39,306 - INFO - Updated main graph to 1010 nodes and 2220 edges.
2025-06-02 15:48:39,306 - INFO - Performing online update...
2025-06-02 15:48:39,306 - INFO - Starting online update for 25 steps.
2025-06-02 15:48:39,306 - DEBUG - Updated RunningStats: new_mean=0.9455161954885306, new_var=33600000000161.367, new_n=3390
2025-06-02 15:48:39,306 - DEBUG - Updated RunningStats: new_mean=0.9436999204951688, new_var=33900000000018.3, new_n=3420
2025-06-02 15:48:39,307 - DEBUG - Updated RunningStats: new_mean=44.800537254891786, new_var=11200000186315.969, new_n=1130
2025-06-02 15:48:39,307 - DEBUG - Updated RunningStats: new_mean=44.7939464922926, new_var=11300000168523.15, new_n=1140
2025-06-02 15:48:39,307 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:48:39,307 - DEBUG - Online update step: 1/25
2025-06-02 15:48:39,309 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:39,421 - DEBUG - Node anomaly scores shape: torch.Size([22504, 1])
2025-06-02 15:48:39,428 - DEBUG - Edge anomaly scores shape: torch.Size([47946, 1])
2025-06-02 15:48:39,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:39,646 - DEBUG - Step 1: Loss=0.6191
2025-06-02 15:48:39,646 - DEBUG - Online update step: 2/25
2025-06-02 15:48:39,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:39,763 - DEBUG - Node anomaly scores shape: torch.Size([21539, 1])
2025-06-02 15:48:39,768 - DEBUG - Edge anomaly scores shape: torch.Size([45714, 1])
2025-06-02 15:48:39,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:40,010 - DEBUG - Step 2: Loss=0.6323
2025-06-02 15:48:40,010 - DEBUG - Online update step: 3/25
2025-06-02 15:48:40,014 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:40,173 - DEBUG - Node anomaly scores shape: torch.Size([22032, 1])
2025-06-02 15:48:40,179 - DEBUG - Edge anomaly scores shape: torch.Size([46766, 1])
2025-06-02 15:48:40,180 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:40,517 - DEBUG - Step 3: Loss=0.6442
2025-06-02 15:48:40,517 - DEBUG - Online update step: 4/25
2025-06-02 15:48:40,521 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:40,751 - DEBUG - Node anomaly scores shape: torch.Size([22101, 1])
2025-06-02 15:48:40,780 - DEBUG - Edge anomaly scores shape: torch.Size([47009, 1])
2025-06-02 15:48:40,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:41,150 - DEBUG - Step 4: Loss=0.6198
2025-06-02 15:48:41,151 - DEBUG - Online update step: 5/25
2025-06-02 15:48:41,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:41,301 - DEBUG - Node anomaly scores shape: torch.Size([21003, 1])
2025-06-02 15:48:41,316 - DEBUG - Edge anomaly scores shape: torch.Size([44474, 1])
2025-06-02 15:48:41,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:41,688 - DEBUG - Step 5: Loss=0.6327
2025-06-02 15:48:41,689 - DEBUG - Online update step: 6/25
2025-06-02 15:48:41,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:41,814 - DEBUG - Node anomaly scores shape: torch.Size([19386, 1])
2025-06-02 15:48:41,819 - DEBUG - Edge anomaly scores shape: torch.Size([40823, 1])
2025-06-02 15:48:41,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:42,005 - DEBUG - Step 6: Loss=0.6461
2025-06-02 15:48:42,005 - DEBUG - Online update step: 7/25
2025-06-02 15:48:42,009 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:42,103 - DEBUG - Node anomaly scores shape: torch.Size([20312, 1])
2025-06-02 15:48:42,109 - DEBUG - Edge anomaly scores shape: torch.Size([43004, 1])
2025-06-02 15:48:42,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:42,313 - DEBUG - Step 7: Loss=0.6186
2025-06-02 15:48:42,313 - DEBUG - Online update step: 8/25
2025-06-02 15:48:42,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:42,430 - DEBUG - Node anomaly scores shape: torch.Size([22173, 1])
2025-06-02 15:48:42,436 - DEBUG - Edge anomaly scores shape: torch.Size([47141, 1])
2025-06-02 15:48:42,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:42,657 - DEBUG - Step 8: Loss=0.6323
2025-06-02 15:48:42,657 - DEBUG - Online update step: 9/25
2025-06-02 15:48:42,661 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:42,766 - DEBUG - Node anomaly scores shape: torch.Size([21383, 1])
2025-06-02 15:48:42,771 - DEBUG - Edge anomaly scores shape: torch.Size([45449, 1])
2025-06-02 15:48:42,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:42,946 - DEBUG - Step 9: Loss=0.6445
2025-06-02 15:48:42,946 - DEBUG - Online update step: 10/25
2025-06-02 15:48:42,950 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:43,145 - DEBUG - Node anomaly scores shape: torch.Size([23851, 1])
2025-06-02 15:48:43,160 - DEBUG - Edge anomaly scores shape: torch.Size([50915, 1])
2025-06-02 15:48:43,162 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:43,398 - DEBUG - Step 10: Loss=0.6187
2025-06-02 15:48:43,398 - DEBUG - Online update step: 11/25
2025-06-02 15:48:43,401 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:43,544 - DEBUG - Node anomaly scores shape: torch.Size([20640, 1])
2025-06-02 15:48:43,553 - DEBUG - Edge anomaly scores shape: torch.Size([43671, 1])
2025-06-02 15:48:43,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:43,993 - DEBUG - Step 11: Loss=0.6316
2025-06-02 15:48:43,993 - DEBUG - Online update step: 12/25
2025-06-02 15:48:43,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:44,137 - DEBUG - Node anomaly scores shape: torch.Size([21772, 1])
2025-06-02 15:48:44,143 - DEBUG - Edge anomaly scores shape: torch.Size([46622, 1])
2025-06-02 15:48:44,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:44,350 - DEBUG - Step 12: Loss=0.6432
2025-06-02 15:48:44,351 - DEBUG - Online update step: 13/25
2025-06-02 15:48:44,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:44,455 - DEBUG - Node anomaly scores shape: torch.Size([21939, 1])
2025-06-02 15:48:44,460 - DEBUG - Edge anomaly scores shape: torch.Size([46907, 1])
2025-06-02 15:48:44,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:44,661 - DEBUG - Step 13: Loss=0.6169
2025-06-02 15:48:44,661 - DEBUG - Online update step: 14/25
2025-06-02 15:48:44,665 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:44,755 - DEBUG - Node anomaly scores shape: torch.Size([18989, 1])
2025-06-02 15:48:44,759 - DEBUG - Edge anomaly scores shape: torch.Size([39839, 1])
2025-06-02 15:48:44,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:44,940 - DEBUG - Step 14: Loss=0.6311
2025-06-02 15:48:44,941 - DEBUG - Online update step: 15/25
2025-06-02 15:48:44,944 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:45,047 - DEBUG - Node anomaly scores shape: torch.Size([19690, 1])
2025-06-02 15:48:45,052 - DEBUG - Edge anomaly scores shape: torch.Size([41518, 1])
2025-06-02 15:48:45,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:45,220 - DEBUG - Step 15: Loss=0.6440
2025-06-02 15:48:45,221 - DEBUG - Online update step: 16/25
2025-06-02 15:48:45,224 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:45,334 - DEBUG - Node anomaly scores shape: torch.Size([22928, 1])
2025-06-02 15:48:45,339 - DEBUG - Edge anomaly scores shape: torch.Size([48790, 1])
2025-06-02 15:48:45,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:45,668 - DEBUG - Step 16: Loss=0.6169
2025-06-02 15:48:45,669 - DEBUG - Online update step: 17/25
2025-06-02 15:48:45,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:45,845 - DEBUG - Node anomaly scores shape: torch.Size([23269, 1])
2025-06-02 15:48:45,947 - DEBUG - Edge anomaly scores shape: torch.Size([49620, 1])
2025-06-02 15:48:45,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:46,357 - DEBUG - Step 17: Loss=0.6309
2025-06-02 15:48:46,357 - DEBUG - Online update step: 18/25
2025-06-02 15:48:46,360 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:46,473 - DEBUG - Node anomaly scores shape: torch.Size([21903, 1])
2025-06-02 15:48:46,480 - DEBUG - Edge anomaly scores shape: torch.Size([46429, 1])
2025-06-02 15:48:46,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:46,732 - DEBUG - Step 18: Loss=0.6436
2025-06-02 15:48:46,732 - DEBUG - Online update step: 19/25
2025-06-02 15:48:46,735 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:46,821 - DEBUG - Node anomaly scores shape: torch.Size([18060, 1])
2025-06-02 15:48:46,826 - DEBUG - Edge anomaly scores shape: torch.Size([38026, 1])
2025-06-02 15:48:46,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:46,992 - DEBUG - Step 19: Loss=0.6192
2025-06-02 15:48:46,992 - DEBUG - Online update step: 20/25
2025-06-02 15:48:46,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:47,126 - DEBUG - Node anomaly scores shape: torch.Size([23405, 1])
2025-06-02 15:48:47,132 - DEBUG - Edge anomaly scores shape: torch.Size([49882, 1])
2025-06-02 15:48:47,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:47,353 - DEBUG - Step 20: Loss=0.6298
2025-06-02 15:48:47,353 - DEBUG - Online update step: 21/25
2025-06-02 15:48:47,356 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:47,493 - DEBUG - Node anomaly scores shape: torch.Size([22983, 1])
2025-06-02 15:48:47,501 - DEBUG - Edge anomaly scores shape: torch.Size([49179, 1])
2025-06-02 15:48:47,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:47,740 - DEBUG - Step 21: Loss=0.6418
2025-06-02 15:48:47,740 - DEBUG - Online update step: 22/25
2025-06-02 15:48:47,744 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:47,842 - DEBUG - Node anomaly scores shape: torch.Size([19861, 1])
2025-06-02 15:48:47,847 - DEBUG - Edge anomaly scores shape: torch.Size([41873, 1])
2025-06-02 15:48:47,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:48,059 - DEBUG - Step 22: Loss=0.6170
2025-06-02 15:48:48,059 - DEBUG - Online update step: 23/25
2025-06-02 15:48:48,065 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:48,185 - DEBUG - Node anomaly scores shape: torch.Size([22772, 1])
2025-06-02 15:48:48,194 - DEBUG - Edge anomaly scores shape: torch.Size([48632, 1])
2025-06-02 15:48:48,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:48,426 - DEBUG - Step 23: Loss=0.6298
2025-06-02 15:48:48,427 - DEBUG - Online update step: 24/25
2025-06-02 15:48:48,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:48,538 - DEBUG - Node anomaly scores shape: torch.Size([22253, 1])
2025-06-02 15:48:48,544 - DEBUG - Edge anomaly scores shape: torch.Size([47197, 1])
2025-06-02 15:48:48,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:48,738 - DEBUG - Step 24: Loss=0.6426
2025-06-02 15:48:48,738 - DEBUG - Online update step: 25/25
2025-06-02 15:48:48,742 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:48,850 - DEBUG - Node anomaly scores shape: torch.Size([23549, 1])
2025-06-02 15:48:48,856 - DEBUG - Edge anomaly scores shape: torch.Size([50454, 1])
2025-06-02 15:48:48,857 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:49,070 - DEBUG - Step 25: Loss=0.6158
2025-06-02 15:48:49,071 - INFO - Online update finished. Average loss: 0.6305, Learning rate: 0.001000
2025-06-02 15:48:49,072 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:48:49,072 - DEBUG - Node drift difference: 0.0013, Edge drift difference: 0.0000
2025-06-02 15:48:49,073 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:48:49,074 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[  1.0002253 433.49033     0.          0.          1.0002253   1.0002253
   1.0002253   1.0002253   1.0002253   1.0002254]
2025-06-02 15:48:49,074 - INFO - Online update complete. Loss: 0.6305
2025-06-02 15:48:49,074 - INFO - Running anomaly detection...
2025-06-02 15:48:49,074 - INFO - Starting anomaly detection.
2025-06-02 15:48:49,079 - DEBUG - Node reconstruction errors: [0.11686821 1.405369   1.7086638  ... 0.0120379  0.0120379  0.0120379 ]
2025-06-02 15:48:49,080 - DEBUG - Edge reconstruction errors: [ 5.2638526  5.2613487 44.257584  ... 13.357569   2.1584582 13.357569 ]
2025-06-02 15:48:49,082 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154849_update_58.json
2025-06-02 15:48:49,082 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:48:49,091 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154849_update_58.pth and as latest_checkpoint.pth
2025-06-02 15:48:49,091 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870835.dot): 0.7281
2025-06-02 15:48:49,091 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:48:49,091 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4054, MLP Score: 0.5357
2025-06-02 15:48:49,091 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.7087, MLP Score: 0.4885
2025-06-02 15:48:49,091 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.8955, MLP Score: 0.4843
2025-06-02 15:48:49,091 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.3729, MLP Score: 0.4811
2025-06-02 15:48:49,091 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.9354, MLP Score: 0.4885
2025-06-02 15:48:49,091 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:48:49,091 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2576, MLP Score: 0.0955
2025-06-02 15:48:49,092 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9601, MLP Score: 0.0111
2025-06-02 15:48:49,092 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0598, MLP Score: 0.0111
2025-06-02 15:48:49,092 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7623, MLP Score: 0.0029
2025-06-02 15:48:49,092 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7586, MLP Score: 0.0015
2025-06-02 15:48:49,092 - INFO - 
--- Processing file: nw_graph_encoded_1748870865.dot (Timestamp: 2025-06-02 15:27:45) ---
2025-06-02 15:48:49,092 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-02 15:48:49,092 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 15:48:49,092 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-02 15:48:49,123 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 15:48:49,150 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 15:48:49,150 - INFO - Processing node updates/additions.
2025-06-02 15:48:49,156 - INFO - Processing edge updates/additions.
2025-06-02 15:48:49,169 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:48:49,170 - INFO - Finished updating NetworkX graph.
2025-06-02 15:48:49,170 - DEBUG - Updated graph - Nodes: 1010, Edges: 2220
2025-06-02 15:48:49,170 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:48:49,172 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:48:49,181 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 15:48:49,182 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:48:49,182 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 15:48:49,184 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 15:48:49,186 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:48:49,190 - DEBUG - Initial edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 15:48:49,192 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:48:49,192 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2220, 10])
2025-06-02 15:48:49,192 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:48:49,192 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:48:49,193 - INFO - Updated main graph to 1010 nodes and 2220 edges.
2025-06-02 15:48:49,193 - INFO - Performing online update...
2025-06-02 15:48:49,193 - INFO - Starting online update for 25 steps.
2025-06-02 15:48:49,194 - DEBUG - Updated RunningStats: new_mean=0.9455523792567501, new_var=34200000000161.367, new_n=3450
2025-06-02 15:48:49,194 - DEBUG - Updated RunningStats: new_mean=0.9437671074204443, new_var=34500000000018.305, new_n=3480
2025-06-02 15:48:49,194 - DEBUG - Updated RunningStats: new_mean=44.800073934052634, new_var=11400000186315.975, new_n=1150
2025-06-02 15:48:49,194 - DEBUG - Updated RunningStats: new_mean=44.793600799436526, new_var=11500000168523.145, new_n=1160
2025-06-02 15:48:49,194 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:48:49,194 - DEBUG - Online update step: 1/25
2025-06-02 15:48:49,197 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:49,306 - DEBUG - Node anomaly scores shape: torch.Size([22723, 1])
2025-06-02 15:48:49,313 - DEBUG - Edge anomaly scores shape: torch.Size([48372, 1])
2025-06-02 15:48:49,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:49,545 - DEBUG - Step 1: Loss=0.6307
2025-06-02 15:48:49,546 - DEBUG - Online update step: 2/25
2025-06-02 15:48:49,551 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:49,676 - DEBUG - Node anomaly scores shape: torch.Size([22582, 1])
2025-06-02 15:48:49,682 - DEBUG - Edge anomaly scores shape: torch.Size([48021, 1])
2025-06-02 15:48:49,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:49,928 - DEBUG - Step 2: Loss=0.6431
2025-06-02 15:48:49,928 - DEBUG - Online update step: 3/25
2025-06-02 15:48:49,934 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:50,072 - DEBUG - Node anomaly scores shape: torch.Size([22774, 1])
2025-06-02 15:48:50,078 - DEBUG - Edge anomaly scores shape: torch.Size([48447, 1])
2025-06-02 15:48:50,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:50,352 - DEBUG - Step 3: Loss=0.6175
2025-06-02 15:48:50,353 - DEBUG - Online update step: 4/25
2025-06-02 15:48:50,358 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:50,471 - DEBUG - Node anomaly scores shape: torch.Size([22446, 1])
2025-06-02 15:48:50,477 - DEBUG - Edge anomaly scores shape: torch.Size([47650, 1])
2025-06-02 15:48:50,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:50,793 - DEBUG - Step 4: Loss=0.6301
2025-06-02 15:48:50,793 - DEBUG - Online update step: 5/25
2025-06-02 15:48:50,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:50,936 - DEBUG - Node anomaly scores shape: torch.Size([23560, 1])
2025-06-02 15:48:50,942 - DEBUG - Edge anomaly scores shape: torch.Size([50323, 1])
2025-06-02 15:48:50,945 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:51,420 - DEBUG - Step 5: Loss=0.6421
2025-06-02 15:48:51,420 - DEBUG - Online update step: 6/25
2025-06-02 15:48:51,424 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:51,641 - DEBUG - Node anomaly scores shape: torch.Size([23288, 1])
2025-06-02 15:48:51,647 - DEBUG - Edge anomaly scores shape: torch.Size([49367, 1])
2025-06-02 15:48:51,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:52,003 - DEBUG - Step 6: Loss=0.6160
2025-06-02 15:48:52,003 - DEBUG - Online update step: 7/25
2025-06-02 15:48:52,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:52,133 - DEBUG - Node anomaly scores shape: torch.Size([21767, 1])
2025-06-02 15:48:52,139 - DEBUG - Edge anomaly scores shape: torch.Size([46089, 1])
2025-06-02 15:48:52,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:52,348 - DEBUG - Step 7: Loss=0.6292
2025-06-02 15:48:52,349 - DEBUG - Online update step: 8/25
2025-06-02 15:48:52,352 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:52,445 - DEBUG - Node anomaly scores shape: torch.Size([20743, 1])
2025-06-02 15:48:52,451 - DEBUG - Edge anomaly scores shape: torch.Size([44006, 1])
2025-06-02 15:48:52,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:52,627 - DEBUG - Step 8: Loss=0.6422
2025-06-02 15:48:52,627 - DEBUG - Online update step: 9/25
2025-06-02 15:48:52,631 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:52,731 - DEBUG - Node anomaly scores shape: torch.Size([22146, 1])
2025-06-02 15:48:52,736 - DEBUG - Edge anomaly scores shape: torch.Size([47246, 1])
2025-06-02 15:48:52,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:52,927 - DEBUG - Step 9: Loss=0.6173
2025-06-02 15:48:52,927 - DEBUG - Online update step: 10/25
2025-06-02 15:48:52,931 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:53,033 - DEBUG - Node anomaly scores shape: torch.Size([22399, 1])
2025-06-02 15:48:53,038 - DEBUG - Edge anomaly scores shape: torch.Size([47796, 1])
2025-06-02 15:48:53,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:53,239 - DEBUG - Step 10: Loss=0.6284
2025-06-02 15:48:53,239 - DEBUG - Online update step: 11/25
2025-06-02 15:48:53,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:53,357 - DEBUG - Node anomaly scores shape: torch.Size([22969, 1])
2025-06-02 15:48:53,363 - DEBUG - Edge anomaly scores shape: torch.Size([48970, 1])
2025-06-02 15:48:53,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:53,588 - DEBUG - Step 11: Loss=0.6406
2025-06-02 15:48:53,589 - DEBUG - Online update step: 12/25
2025-06-02 15:48:53,592 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:53,722 - DEBUG - Node anomaly scores shape: torch.Size([22046, 1])
2025-06-02 15:48:53,732 - DEBUG - Edge anomaly scores shape: torch.Size([46862, 1])
2025-06-02 15:48:53,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:53,948 - DEBUG - Step 12: Loss=0.6158
2025-06-02 15:48:53,949 - DEBUG - Online update step: 13/25
2025-06-02 15:48:53,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:54,055 - DEBUG - Node anomaly scores shape: torch.Size([22264, 1])
2025-06-02 15:48:54,060 - DEBUG - Edge anomaly scores shape: torch.Size([47347, 1])
2025-06-02 15:48:54,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:54,270 - DEBUG - Step 13: Loss=0.6296
2025-06-02 15:48:54,270 - DEBUG - Online update step: 14/25
2025-06-02 15:48:54,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:54,400 - DEBUG - Node anomaly scores shape: torch.Size([23838, 1])
2025-06-02 15:48:54,406 - DEBUG - Edge anomaly scores shape: torch.Size([51119, 1])
2025-06-02 15:48:54,408 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:54,639 - DEBUG - Step 14: Loss=0.6413
2025-06-02 15:48:54,639 - DEBUG - Online update step: 15/25
2025-06-02 15:48:54,642 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:54,745 - DEBUG - Node anomaly scores shape: torch.Size([22518, 1])
2025-06-02 15:48:54,751 - DEBUG - Edge anomaly scores shape: torch.Size([48111, 1])
2025-06-02 15:48:54,752 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:54,957 - DEBUG - Step 15: Loss=0.6158
2025-06-02 15:48:54,957 - DEBUG - Online update step: 16/25
2025-06-02 15:48:54,961 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:55,061 - DEBUG - Node anomaly scores shape: torch.Size([20329, 1])
2025-06-02 15:48:55,066 - DEBUG - Edge anomaly scores shape: torch.Size([43058, 1])
2025-06-02 15:48:55,067 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:55,242 - DEBUG - Step 16: Loss=0.6308
2025-06-02 15:48:55,243 - DEBUG - Online update step: 17/25
2025-06-02 15:48:55,246 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:55,339 - DEBUG - Node anomaly scores shape: torch.Size([20005, 1])
2025-06-02 15:48:55,344 - DEBUG - Edge anomaly scores shape: torch.Size([42356, 1])
2025-06-02 15:48:55,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:55,538 - DEBUG - Step 17: Loss=0.6434
2025-06-02 15:48:55,539 - DEBUG - Online update step: 18/25
2025-06-02 15:48:55,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:55,645 - DEBUG - Node anomaly scores shape: torch.Size([22342, 1])
2025-06-02 15:48:55,651 - DEBUG - Edge anomaly scores shape: torch.Size([47730, 1])
2025-06-02 15:48:55,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:55,862 - DEBUG - Step 18: Loss=0.6151
2025-06-02 15:48:55,862 - DEBUG - Online update step: 19/25
2025-06-02 15:48:55,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:55,972 - DEBUG - Node anomaly scores shape: torch.Size([21259, 1])
2025-06-02 15:48:55,978 - DEBUG - Edge anomaly scores shape: torch.Size([45209, 1])
2025-06-02 15:48:55,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:56,166 - DEBUG - Step 19: Loss=0.6282
2025-06-02 15:48:56,167 - DEBUG - Online update step: 20/25
2025-06-02 15:48:56,170 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:56,275 - DEBUG - Node anomaly scores shape: torch.Size([22215, 1])
2025-06-02 15:48:56,281 - DEBUG - Edge anomaly scores shape: torch.Size([47280, 1])
2025-06-02 15:48:56,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:56,500 - DEBUG - Step 20: Loss=0.6408
2025-06-02 15:48:56,500 - DEBUG - Online update step: 21/25
2025-06-02 15:48:56,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:56,599 - DEBUG - Node anomaly scores shape: torch.Size([20706, 1])
2025-06-02 15:48:56,604 - DEBUG - Edge anomaly scores shape: torch.Size([43889, 1])
2025-06-02 15:48:56,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:56,786 - DEBUG - Step 21: Loss=0.6148
2025-06-02 15:48:56,787 - DEBUG - Online update step: 22/25
2025-06-02 15:48:56,790 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:56,897 - DEBUG - Node anomaly scores shape: torch.Size([22671, 1])
2025-06-02 15:48:56,904 - DEBUG - Edge anomaly scores shape: torch.Size([48224, 1])
2025-06-02 15:48:56,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:57,115 - DEBUG - Step 22: Loss=0.6296
2025-06-02 15:48:57,115 - DEBUG - Online update step: 23/25
2025-06-02 15:48:57,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:57,222 - DEBUG - Node anomaly scores shape: torch.Size([22430, 1])
2025-06-02 15:48:57,228 - DEBUG - Edge anomaly scores shape: torch.Size([47871, 1])
2025-06-02 15:48:57,229 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:57,412 - DEBUG - Step 23: Loss=0.6420
2025-06-02 15:48:57,412 - DEBUG - Online update step: 24/25
2025-06-02 15:48:57,415 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:57,512 - DEBUG - Node anomaly scores shape: torch.Size([21327, 1])
2025-06-02 15:48:57,520 - DEBUG - Edge anomaly scores shape: torch.Size([44979, 1])
2025-06-02 15:48:57,521 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:57,704 - DEBUG - Step 24: Loss=0.6169
2025-06-02 15:48:57,704 - DEBUG - Online update step: 25/25
2025-06-02 15:48:57,707 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:57,812 - DEBUG - Node anomaly scores shape: torch.Size([21330, 1])
2025-06-02 15:48:57,817 - DEBUG - Edge anomaly scores shape: torch.Size([45357, 1])
2025-06-02 15:48:57,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:58,013 - DEBUG - Step 25: Loss=0.6271
2025-06-02 15:48:58,014 - INFO - Online update finished. Average loss: 0.6291, Learning rate: 0.001000
2025-06-02 15:48:58,014 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:48:58,015 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:48:58,016 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:48:58,016 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[  1.0002253 433.49033     0.          0.          1.0002253   1.0002253
   1.0002253   1.0002253   1.0002253   1.0002254]
2025-06-02 15:48:58,023 - INFO - Online update complete. Loss: 0.6291
2025-06-02 15:48:58,023 - INFO - Running anomaly detection...
2025-06-02 15:48:58,024 - INFO - Starting anomaly detection.
2025-06-02 15:48:58,029 - DEBUG - Node reconstruction errors: [0.10540546 1.33657    1.6781764  ... 0.01234076 0.01234076 0.0123408 ]
2025-06-02 15:48:58,029 - DEBUG - Edge reconstruction errors: [ 5.2638526  5.2613487 44.257584  ... 13.357569   2.1584582 13.357569 ]
2025-06-02 15:48:58,031 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154858_update_59.json
2025-06-02 15:48:58,031 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:48:58,040 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154858_update_59.pth and as latest_checkpoint.pth
2025-06-02 15:48:58,040 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870865.dot): 0.7282
2025-06-02 15:48:58,040 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:48:58,040 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3366, MLP Score: 0.5403
2025-06-02 15:48:58,040 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6782, MLP Score: 0.4920
2025-06-02 15:48:58,040 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.8565, MLP Score: 0.4875
2025-06-02 15:48:58,040 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.2380, MLP Score: 0.4848
2025-06-02 15:48:58,040 - WARNING -   Node ID: 183.81.34.26, Recon Error: 8.9827, MLP Score: 0.4920
2025-06-02 15:48:58,040 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:48:58,041 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2576, MLP Score: 0.0346
2025-06-02 15:48:58,041 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9601, MLP Score: 0.0026
2025-06-02 15:48:58,041 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0598, MLP Score: 0.0026
2025-06-02 15:48:58,041 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7623, MLP Score: 0.0006
2025-06-02 15:48:58,041 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7586, MLP Score: 0.0003
2025-06-02 15:48:58,041 - INFO - 
--- Processing file: nw_graph_encoded_1748870895.dot (Timestamp: 2025-06-02 15:28:15) ---
2025-06-02 15:48:58,041 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-02 15:48:58,041 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 15:48:58,041 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-02 15:48:58,071 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 15:48:58,097 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 15:48:58,097 - INFO - Processing node updates/additions.
2025-06-02 15:48:58,103 - INFO - Processing edge updates/additions.
2025-06-02 15:48:58,116 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:48:58,117 - INFO - Finished updating NetworkX graph.
2025-06-02 15:48:58,118 - DEBUG - Updated graph - Nodes: 1010, Edges: 2220
2025-06-02 15:48:58,118 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:48:58,119 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:48:58,128 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 15:48:58,130 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:48:58,130 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 15:48:58,133 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 15:48:58,135 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:48:58,143 - DEBUG - Initial edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 15:48:58,145 - INFO - Numerical Edge Attributes (edge_attr) after initial standard scaling.
2025-06-02 15:48:58,145 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([2220, 10])
2025-06-02 15:48:58,145 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:48:58,146 - DEBUG - Type of pytorch_data (update): <class 'torch_geometric.data.data.Data'>
2025-06-02 15:48:58,147 - INFO - Updated main graph to 1010 nodes and 2220 edges.
2025-06-02 15:48:58,147 - INFO - Performing online update...
2025-06-02 15:48:58,148 - INFO - Starting online update for 25 steps.
2025-06-02 15:48:58,148 - DEBUG - Updated RunningStats: new_mean=0.9455873259730645, new_var=34800000000161.363, new_n=3510
2025-06-02 15:48:58,148 - DEBUG - Updated RunningStats: new_mean=0.9438320168228291, new_var=35100000000018.305, new_n=3540
2025-06-02 15:48:58,149 - DEBUG - Updated RunningStats: new_mean=44.79962645324216, new_var=11600000186315.98, new_n=1170
2025-06-02 15:48:58,149 - DEBUG - Updated RunningStats: new_mean=44.793266824982354, new_var=11700000168523.139, new_n=1180
2025-06-02 15:48:58,149 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:48:58,150 - DEBUG - Online update step: 1/25
2025-06-02 15:48:58,153 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:58,258 - DEBUG - Node anomaly scores shape: torch.Size([22743, 1])
2025-06-02 15:48:58,265 - DEBUG - Edge anomaly scores shape: torch.Size([48562, 1])
2025-06-02 15:48:58,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:58,484 - DEBUG - Step 1: Loss=0.6396
2025-06-02 15:48:58,484 - DEBUG - Online update step: 2/25
2025-06-02 15:48:58,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:58,608 - DEBUG - Node anomaly scores shape: torch.Size([21945, 1])
2025-06-02 15:48:58,613 - DEBUG - Edge anomaly scores shape: torch.Size([46828, 1])
2025-06-02 15:48:58,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:58,838 - DEBUG - Step 2: Loss=0.6134
2025-06-02 15:48:58,838 - DEBUG - Online update step: 3/25
2025-06-02 15:48:58,843 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:58,946 - DEBUG - Node anomaly scores shape: torch.Size([20091, 1])
2025-06-02 15:48:58,951 - DEBUG - Edge anomaly scores shape: torch.Size([42383, 1])
2025-06-02 15:48:58,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:59,229 - DEBUG - Step 3: Loss=0.6304
2025-06-02 15:48:59,230 - DEBUG - Online update step: 4/25
2025-06-02 15:48:59,233 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:59,364 - DEBUG - Node anomaly scores shape: torch.Size([23430, 1])
2025-06-02 15:48:59,372 - DEBUG - Edge anomaly scores shape: torch.Size([49963, 1])
2025-06-02 15:48:59,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:48:59,662 - DEBUG - Step 4: Loss=0.6425
2025-06-02 15:48:59,662 - DEBUG - Online update step: 5/25
2025-06-02 15:48:59,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:48:59,799 - DEBUG - Node anomaly scores shape: torch.Size([21882, 1])
2025-06-02 15:48:59,805 - DEBUG - Edge anomaly scores shape: torch.Size([46488, 1])
2025-06-02 15:48:59,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:00,271 - DEBUG - Step 5: Loss=0.6164
2025-06-02 15:49:00,272 - DEBUG - Online update step: 6/25
2025-06-02 15:49:00,279 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:00,470 - DEBUG - Node anomaly scores shape: torch.Size([22178, 1])
2025-06-02 15:49:00,480 - DEBUG - Edge anomaly scores shape: torch.Size([47086, 1])
2025-06-02 15:49:00,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:00,733 - DEBUG - Step 6: Loss=0.6261
2025-06-02 15:49:00,733 - DEBUG - Online update step: 7/25
2025-06-02 15:49:00,736 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:00,839 - DEBUG - Node anomaly scores shape: torch.Size([20714, 1])
2025-06-02 15:49:00,846 - DEBUG - Edge anomaly scores shape: torch.Size([44005, 1])
2025-06-02 15:49:00,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:01,220 - DEBUG - Step 7: Loss=0.6385
2025-06-02 15:49:01,221 - DEBUG - Online update step: 8/25
2025-06-02 15:49:01,229 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:01,520 - DEBUG - Node anomaly scores shape: torch.Size([22912, 1])
2025-06-02 15:49:01,526 - DEBUG - Edge anomaly scores shape: torch.Size([48698, 1])
2025-06-02 15:49:01,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:01,754 - DEBUG - Step 8: Loss=0.6127
2025-06-02 15:49:01,756 - DEBUG - Online update step: 9/25
2025-06-02 15:49:01,767 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:01,903 - DEBUG - Node anomaly scores shape: torch.Size([23872, 1])
2025-06-02 15:49:01,910 - DEBUG - Edge anomaly scores shape: torch.Size([50880, 1])
2025-06-02 15:49:01,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:02,154 - DEBUG - Step 9: Loss=0.6287
2025-06-02 15:49:02,154 - DEBUG - Online update step: 10/25
2025-06-02 15:49:02,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:02,267 - DEBUG - Node anomaly scores shape: torch.Size([21705, 1])
2025-06-02 15:49:02,272 - DEBUG - Edge anomaly scores shape: torch.Size([45935, 1])
2025-06-02 15:49:02,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:02,490 - DEBUG - Step 10: Loss=0.6426
2025-06-02 15:49:02,491 - DEBUG - Online update step: 11/25
2025-06-02 15:49:02,494 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:02,605 - DEBUG - Node anomaly scores shape: torch.Size([20787, 1])
2025-06-02 15:49:02,610 - DEBUG - Edge anomaly scores shape: torch.Size([44124, 1])
2025-06-02 15:49:02,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:02,792 - DEBUG - Step 11: Loss=0.6171
2025-06-02 15:49:02,793 - DEBUG - Online update step: 12/25
2025-06-02 15:49:02,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:02,916 - DEBUG - Node anomaly scores shape: torch.Size([24117, 1])
2025-06-02 15:49:02,931 - DEBUG - Edge anomaly scores shape: torch.Size([51312, 1])
2025-06-02 15:49:02,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:03,176 - DEBUG - Step 12: Loss=0.6242
2025-06-02 15:49:03,176 - DEBUG - Online update step: 13/25
2025-06-02 15:49:03,179 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:03,418 - DEBUG - Node anomaly scores shape: torch.Size([24593, 1])
2025-06-02 15:49:03,457 - DEBUG - Edge anomaly scores shape: torch.Size([52463, 1])
2025-06-02 15:49:03,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:03,851 - DEBUG - Step 13: Loss=0.6358
2025-06-02 15:49:03,852 - DEBUG - Online update step: 14/25
2025-06-02 15:49:03,854 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:03,952 - DEBUG - Node anomaly scores shape: torch.Size([18948, 1])
2025-06-02 15:49:03,957 - DEBUG - Edge anomaly scores shape: torch.Size([39815, 1])
2025-06-02 15:49:03,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:04,127 - DEBUG - Step 14: Loss=0.6122
2025-06-02 15:49:04,127 - DEBUG - Online update step: 15/25
2025-06-02 15:49:04,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:04,254 - DEBUG - Node anomaly scores shape: torch.Size([23116, 1])
2025-06-02 15:49:04,260 - DEBUG - Edge anomaly scores shape: torch.Size([49405, 1])
2025-06-02 15:49:04,262 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:04,529 - DEBUG - Step 15: Loss=0.6302
2025-06-02 15:49:04,530 - DEBUG - Online update step: 16/25
2025-06-02 15:49:04,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:04,721 - DEBUG - Node anomaly scores shape: torch.Size([20872, 1])
2025-06-02 15:49:04,727 - DEBUG - Edge anomaly scores shape: torch.Size([44323, 1])
2025-06-02 15:49:04,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:04,964 - DEBUG - Step 16: Loss=0.6430
2025-06-02 15:49:04,964 - DEBUG - Online update step: 17/25
2025-06-02 15:49:04,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:05,079 - DEBUG - Node anomaly scores shape: torch.Size([21514, 1])
2025-06-02 15:49:05,085 - DEBUG - Edge anomaly scores shape: torch.Size([45718, 1])
2025-06-02 15:49:05,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:05,282 - DEBUG - Step 17: Loss=0.6170
2025-06-02 15:49:05,283 - DEBUG - Online update step: 18/25
2025-06-02 15:49:05,286 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:05,388 - DEBUG - Node anomaly scores shape: torch.Size([20285, 1])
2025-06-02 15:49:05,393 - DEBUG - Edge anomaly scores shape: torch.Size([42909, 1])
2025-06-02 15:49:05,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:05,569 - DEBUG - Step 18: Loss=0.6249
2025-06-02 15:49:05,570 - DEBUG - Online update step: 19/25
2025-06-02 15:49:05,573 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:05,685 - DEBUG - Node anomaly scores shape: torch.Size([22893, 1])
2025-06-02 15:49:05,691 - DEBUG - Edge anomaly scores shape: torch.Size([48657, 1])
2025-06-02 15:49:05,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:05,979 - DEBUG - Step 19: Loss=0.6365
2025-06-02 15:49:05,980 - DEBUG - Online update step: 20/25
2025-06-02 15:49:05,986 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:06,118 - DEBUG - Node anomaly scores shape: torch.Size([23605, 1])
2025-06-02 15:49:06,124 - DEBUG - Edge anomaly scores shape: torch.Size([50241, 1])
2025-06-02 15:49:06,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:06,374 - DEBUG - Step 20: Loss=0.6111
2025-06-02 15:49:06,374 - DEBUG - Online update step: 21/25
2025-06-02 15:49:06,377 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:06,503 - DEBUG - Node anomaly scores shape: torch.Size([23387, 1])
2025-06-02 15:49:06,508 - DEBUG - Edge anomaly scores shape: torch.Size([49958, 1])
2025-06-02 15:49:06,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:06,703 - DEBUG - Step 21: Loss=0.6291
2025-06-02 15:49:06,703 - DEBUG - Online update step: 22/25
2025-06-02 15:49:06,707 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:06,826 - DEBUG - Node anomaly scores shape: torch.Size([24285, 1])
2025-06-02 15:49:06,832 - DEBUG - Edge anomaly scores shape: torch.Size([51637, 1])
2025-06-02 15:49:06,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:07,054 - DEBUG - Step 22: Loss=0.6412
2025-06-02 15:49:07,054 - DEBUG - Online update step: 23/25
2025-06-02 15:49:07,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:07,172 - DEBUG - Node anomaly scores shape: torch.Size([23564, 1])
2025-06-02 15:49:07,178 - DEBUG - Edge anomaly scores shape: torch.Size([50478, 1])
2025-06-02 15:49:07,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:07,387 - DEBUG - Step 23: Loss=0.6139
2025-06-02 15:49:07,387 - DEBUG - Online update step: 24/25
2025-06-02 15:49:07,390 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:07,492 - DEBUG - Node anomaly scores shape: torch.Size([20857, 1])
2025-06-02 15:49:07,497 - DEBUG - Edge anomaly scores shape: torch.Size([44250, 1])
2025-06-02 15:49:07,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:07,682 - DEBUG - Step 24: Loss=0.6251
2025-06-02 15:49:07,682 - DEBUG - Online update step: 25/25
2025-06-02 15:49:07,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:49:07,791 - DEBUG - Node anomaly scores shape: torch.Size([21247, 1])
2025-06-02 15:49:07,796 - DEBUG - Edge anomaly scores shape: torch.Size([45073, 1])
2025-06-02 15:49:07,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:49:07,990 - DEBUG - Step 25: Loss=0.6383
2025-06-02 15:49:07,990 - INFO - Online update finished. Average loss: 0.6276, Learning rate: 0.001000
2025-06-02 15:49:07,991 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:49:07,991 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 15:49:07,993 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[-4.2958304e-10  4.5498602e+02  0.0000000e+00  0.0000000e+00
 -2.2553108e-09 -4.2958304e-10  0.0000000e+00 -8.5916607e-10
 -1.7183321e-09  3.4366643e-09]
2025-06-02 15:49:07,993 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[  1.0002253 433.49033     0.          0.          1.0002253   1.0002253
   1.0002253   1.0002253   1.0002253   1.0002254]
2025-06-02 15:49:07,993 - INFO - Online update complete. Loss: 0.6276
2025-06-02 15:49:07,993 - INFO - Running anomaly detection...
2025-06-02 15:49:07,994 - INFO - Starting anomaly detection.
2025-06-02 15:49:07,998 - DEBUG - Node reconstruction errors: [0.0961227 1.264584  1.623293  ... 0.0146025 0.0146025 0.0146025]
2025-06-02 15:49:07,999 - DEBUG - Edge reconstruction errors: [ 5.2638526  5.2613487 44.257584  ... 13.357569   2.1584582 13.357569 ]
2025-06-02 15:49:08,000 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_154908_update_60.json
2025-06-02 15:49:08,001 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:49:08,009 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_154908_update_60.pth and as latest_checkpoint.pth
2025-06-02 15:49:08,009 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870895.dot): 0.7249
2025-06-02 15:49:08,009 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:49:08,010 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.2646, MLP Score: 0.5525
2025-06-02 15:49:08,010 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.6233, MLP Score: 0.5034
2025-06-02 15:49:08,010 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.7981, MLP Score: 0.5018
2025-06-02 15:49:08,010 - WARNING -   Node ID: 192.168.27.10, Recon Error: 2.0784, MLP Score: 0.5005
2025-06-02 15:49:08,010 - WARNING -   Node ID: 183.81.34.26, Recon Error: 9.0700, MLP Score: 0.5034
2025-06-02 15:49:08,010 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:49:08,010 - WARNING -   Source: 192.168.27.13, Target: 224.0.0.251, Recon Error: 535.2576, MLP Score: 0.1887
2025-06-02 15:49:08,010 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 808.9601, MLP Score: 0.0303
2025-06-02 15:49:08,010 - WARNING -   Source: 192.168.27.13, Target: 183.81.34.26, Recon Error: 809.0598, MLP Score: 0.0303
2025-06-02 15:49:08,010 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.97, Recon Error: 868.7623, MLP Score: 0.0088
2025-06-02 15:49:08,010 - WARNING -   Source: 192.168.27.13, Target: 210.245.26.100, Recon Error: 889.7586, MLP Score: 0.0044
2025-06-02 15:49:08,010 - INFO - Finished processing all files in the directory.
