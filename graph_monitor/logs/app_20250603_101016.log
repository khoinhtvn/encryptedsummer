2025-06-03 10:10:16,368 - INFO - Application logging to file: logs/app_20250603_101016.log
2025-06-03 10:10:16,368 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 10:10:16,369 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-03 10:10:16,369 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-03 10:10:16,369 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 10:10:16,369 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 10:10:16,371 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-03 10:10:16,372 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-03 10:10:16,372 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:16,373 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:16,373 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-03 10:10:16,374 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:16,374 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-03 10:10:16,375 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-03 10:10:16,375 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:16,375 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-03 10:10:16,376 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:16,376 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 10:10:16,376 - DEBUG - Shape of encoded categorical edge features: torch.Size([133, 3])
2025-06-03 10:10:16,376 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:16,377 - DEBUG - Shape of scaled numerical edge features: torch.Size([133, 7])
2025-06-03 10:10:16,377 - DEBUG - Final edge attributes tensor shape: torch.Size([133, 10])
2025-06-03 10:10:16,377 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:16,377 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 10:10:16,377 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4
2025-06-03 10:10:16,418 - DEBUG - Encoder GATConv layers initialized with output dimension: 64
2025-06-03 10:10:16,418 - DEBUG - Decoder MLP layers initialized.
2025-06-03 10:10:16,419 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 10:10:16,419 - INFO - Optimizer and scheduler initialized.
2025-06-03 10:10:16,419 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-03 10:10:16,419 - INFO - RunningStats initialized.
2025-06-03 10:10:16,419 - INFO - RunningStats initialized.
2025-06-03 10:10:16,419 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 10:10:16,420 - INFO - Using device: cpu
2025-06-03 10:10:16,420 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-03 10:10:16,420 - INFO - Performing initial training for 100 epochs...
2025-06-03 10:10:16,691 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:16,713 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:16,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:16,801 - INFO - Epoch 1/100, Loss: 6.6935
2025-06-03 10:10:16,804 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:16,804 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:16,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:16,933 - INFO - Epoch 2/100, Loss: 6.2328
2025-06-03 10:10:16,947 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:16,947 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:16,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,006 - INFO - Epoch 3/100, Loss: 5.7611
2025-06-03 10:10:17,009 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,009 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,009 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,013 - INFO - Epoch 4/100, Loss: 5.1483
2025-06-03 10:10:17,016 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,016 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,020 - INFO - Epoch 5/100, Loss: 4.3564
2025-06-03 10:10:17,023 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,023 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,028 - INFO - Epoch 6/100, Loss: 3.6419
2025-06-03 10:10:17,030 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,031 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,031 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,034 - INFO - Epoch 7/100, Loss: 2.8308
2025-06-03 10:10:17,037 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,037 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,041 - INFO - Epoch 8/100, Loss: 2.2131
2025-06-03 10:10:17,045 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,045 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,049 - INFO - Epoch 9/100, Loss: 1.9232
2025-06-03 10:10:17,052 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,052 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,052 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,110 - INFO - Epoch 10/100, Loss: 2.1370
2025-06-03 10:10:17,114 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,114 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,157 - INFO - Epoch 11/100, Loss: 2.1715
2025-06-03 10:10:17,164 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,168 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,233 - INFO - Epoch 12/100, Loss: 1.9175
2025-06-03 10:10:17,252 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,252 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,280 - INFO - Epoch 13/100, Loss: 1.6455
2025-06-03 10:10:17,284 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,285 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,285 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,294 - INFO - Epoch 14/100, Loss: 1.5318
2025-06-03 10:10:17,299 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,299 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,309 - INFO - Epoch 15/100, Loss: 1.4240
2025-06-03 10:10:17,315 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,315 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,324 - INFO - Epoch 16/100, Loss: 1.4711
2025-06-03 10:10:17,330 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,331 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,419 - INFO - Epoch 17/100, Loss: 1.5570
2025-06-03 10:10:17,434 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,435 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,473 - INFO - Epoch 18/100, Loss: 1.5933
2025-06-03 10:10:17,483 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,483 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,484 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,494 - INFO - Epoch 19/100, Loss: 1.6061
2025-06-03 10:10:17,499 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,500 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,500 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,510 - INFO - Epoch 20/100, Loss: 1.6337
2025-06-03 10:10:17,516 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,516 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,516 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,525 - INFO - Epoch 21/100, Loss: 1.5471
2025-06-03 10:10:17,532 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,532 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,541 - INFO - Epoch 22/100, Loss: 1.4649
2025-06-03 10:10:17,548 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,548 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,560 - INFO - Epoch 23/100, Loss: 1.4386
2025-06-03 10:10:17,566 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,566 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,578 - INFO - Epoch 24/100, Loss: 1.4323
2025-06-03 10:10:17,584 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,585 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,593 - INFO - Epoch 25/100, Loss: 1.4349
2025-06-03 10:10:17,598 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,598 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,599 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,606 - INFO - Epoch 26/100, Loss: 1.4075
2025-06-03 10:10:17,611 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,611 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,619 - INFO - Epoch 27/100, Loss: 1.3924
2025-06-03 10:10:17,627 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,627 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,627 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,727 - INFO - Epoch 28/100, Loss: 1.3366
2025-06-03 10:10:17,737 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,737 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,742 - INFO - Epoch 29/100, Loss: 1.3289
2025-06-03 10:10:17,745 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,745 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,751 - INFO - Epoch 30/100, Loss: 1.3290
2025-06-03 10:10:17,754 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,754 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,790 - INFO - Epoch 31/100, Loss: 1.3118
2025-06-03 10:10:17,793 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,793 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,794 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,798 - INFO - Epoch 32/100, Loss: 1.3037
2025-06-03 10:10:17,801 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,801 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,805 - INFO - Epoch 33/100, Loss: 1.2978
2025-06-03 10:10:17,808 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,808 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,812 - INFO - Epoch 34/100, Loss: 1.3022
2025-06-03 10:10:17,815 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,815 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,819 - INFO - Epoch 35/100, Loss: 1.2889
2025-06-03 10:10:17,822 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,822 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,826 - INFO - Epoch 36/100, Loss: 1.2758
2025-06-03 10:10:17,830 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,830 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,847 - INFO - Epoch 37/100, Loss: 1.2563
2025-06-03 10:10:17,871 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,872 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,964 - INFO - Epoch 38/100, Loss: 1.2493
2025-06-03 10:10:17,968 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,968 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:17,972 - INFO - Epoch 39/100, Loss: 1.2524
2025-06-03 10:10:17,975 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:17,977 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:17,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,138 - INFO - Epoch 40/100, Loss: 1.2435
2025-06-03 10:10:18,142 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,142 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,181 - INFO - Epoch 41/100, Loss: 1.2235
2025-06-03 10:10:18,184 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,185 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,188 - INFO - Epoch 42/100, Loss: 1.1933
2025-06-03 10:10:18,191 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,191 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,195 - INFO - Epoch 43/100, Loss: 1.1866
2025-06-03 10:10:18,198 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,198 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,202 - INFO - Epoch 44/100, Loss: 1.1772
2025-06-03 10:10:18,204 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,205 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,208 - INFO - Epoch 45/100, Loss: 1.1683
2025-06-03 10:10:18,211 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,211 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,215 - INFO - Epoch 46/100, Loss: 1.1532
2025-06-03 10:10:18,217 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,218 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,218 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,221 - INFO - Epoch 47/100, Loss: 1.1329
2025-06-03 10:10:18,224 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,224 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,228 - INFO - Epoch 48/100, Loss: 1.1292
2025-06-03 10:10:18,230 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,231 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,234 - INFO - Epoch 49/100, Loss: 1.1201
2025-06-03 10:10:18,237 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,237 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,241 - INFO - Epoch 50/100, Loss: 1.1116
2025-06-03 10:10:18,243 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,244 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,247 - INFO - Epoch 51/100, Loss: 1.0981
2025-06-03 10:10:18,250 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,250 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,250 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,254 - INFO - Epoch 52/100, Loss: 1.0750
2025-06-03 10:10:18,256 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,257 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,257 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,260 - INFO - Epoch 53/100, Loss: 1.0656
2025-06-03 10:10:18,263 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,263 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,267 - INFO - Epoch 54/100, Loss: 1.0447
2025-06-03 10:10:18,269 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,270 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,270 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,273 - INFO - Epoch 55/100, Loss: 1.0412
2025-06-03 10:10:18,276 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,276 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,303 - INFO - Epoch 56/100, Loss: 1.0261
2025-06-03 10:10:18,306 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,306 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,311 - INFO - Epoch 57/100, Loss: 1.0092
2025-06-03 10:10:18,315 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,315 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,335 - INFO - Epoch 58/100, Loss: 1.0023
2025-06-03 10:10:18,338 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,339 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,339 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,528 - INFO - Epoch 59/100, Loss: 0.9812
2025-06-03 10:10:18,531 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,531 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,568 - INFO - Epoch 60/100, Loss: 0.9703
2025-06-03 10:10:18,571 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,571 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,607 - INFO - Epoch 61/100, Loss: 0.9663
2025-06-03 10:10:18,610 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,610 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,614 - INFO - Epoch 62/100, Loss: 0.9443
2025-06-03 10:10:18,617 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,617 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,621 - INFO - Epoch 63/100, Loss: 0.9376
2025-06-03 10:10:18,624 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,624 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,628 - INFO - Epoch 64/100, Loss: 0.9339
2025-06-03 10:10:18,631 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,631 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,636 - INFO - Epoch 65/100, Loss: 0.9120
2025-06-03 10:10:18,639 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,639 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,644 - INFO - Epoch 66/100, Loss: 0.9120
2025-06-03 10:10:18,647 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,647 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,647 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,651 - INFO - Epoch 67/100, Loss: 0.9033
2025-06-03 10:10:18,654 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,654 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,655 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,659 - INFO - Epoch 68/100, Loss: 0.8915
2025-06-03 10:10:18,662 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,662 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,697 - INFO - Epoch 69/100, Loss: 0.8829
2025-06-03 10:10:18,700 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,700 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,704 - INFO - Epoch 70/100, Loss: 0.8749
2025-06-03 10:10:18,707 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,707 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,753 - INFO - Epoch 71/100, Loss: 0.8577
2025-06-03 10:10:18,762 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,767 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,848 - INFO - Epoch 72/100, Loss: 0.8487
2025-06-03 10:10:18,852 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,852 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,891 - INFO - Epoch 73/100, Loss: 0.8383
2025-06-03 10:10:18,894 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,894 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:18,962 - INFO - Epoch 74/100, Loss: 0.8330
2025-06-03 10:10:18,976 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:18,976 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:18,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,029 - INFO - Epoch 75/100, Loss: 0.8237
2025-06-03 10:10:19,059 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,059 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,095 - INFO - Epoch 76/100, Loss: 0.8132
2025-06-03 10:10:19,098 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,098 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,102 - INFO - Epoch 77/100, Loss: 0.8095
2025-06-03 10:10:19,105 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,105 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,111 - INFO - Epoch 78/100, Loss: 0.8047
2025-06-03 10:10:19,114 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,114 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,119 - INFO - Epoch 79/100, Loss: 0.7945
2025-06-03 10:10:19,121 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,122 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,122 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,129 - INFO - Epoch 80/100, Loss: 0.7788
2025-06-03 10:10:19,135 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,135 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,143 - INFO - Epoch 81/100, Loss: 0.7746
2025-06-03 10:10:19,149 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,149 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,154 - INFO - Epoch 82/100, Loss: 0.7733
2025-06-03 10:10:19,158 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,158 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,165 - INFO - Epoch 83/100, Loss: 0.7645
2025-06-03 10:10:19,187 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,189 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,286 - INFO - Epoch 84/100, Loss: 0.7657
2025-06-03 10:10:19,294 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,295 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,305 - INFO - Epoch 85/100, Loss: 0.7596
2025-06-03 10:10:19,314 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,314 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,351 - INFO - Epoch 86/100, Loss: 0.7597
2025-06-03 10:10:19,356 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,356 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,374 - INFO - Epoch 87/100, Loss: 0.7361
2025-06-03 10:10:19,386 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,386 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,388 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,439 - INFO - Epoch 88/100, Loss: 0.7463
2025-06-03 10:10:19,447 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,448 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,493 - INFO - Epoch 89/100, Loss: 0.7351
2025-06-03 10:10:19,498 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,499 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,543 - INFO - Epoch 90/100, Loss: 0.7352
2025-06-03 10:10:19,548 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,549 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,554 - INFO - Epoch 91/100, Loss: 0.7315
2025-06-03 10:10:19,557 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,557 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,631 - INFO - Epoch 92/100, Loss: 0.7245
2025-06-03 10:10:19,637 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,637 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,722 - INFO - Epoch 93/100, Loss: 0.7249
2025-06-03 10:10:19,729 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,729 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,737 - INFO - Epoch 94/100, Loss: 0.7168
2025-06-03 10:10:19,743 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,743 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,743 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,751 - INFO - Epoch 95/100, Loss: 0.7192
2025-06-03 10:10:19,756 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,756 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,766 - INFO - Epoch 96/100, Loss: 0.7176
2025-06-03 10:10:19,771 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,772 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,781 - INFO - Epoch 97/100, Loss: 0.7078
2025-06-03 10:10:19,786 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,786 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,793 - INFO - Epoch 98/100, Loss: 0.7075
2025-06-03 10:10:19,796 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,796 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,800 - INFO - Epoch 99/100, Loss: 0.7073
2025-06-03 10:10:19,803 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:10:19,803 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:10:19,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:19,807 - INFO - Epoch 100/100, Loss: 0.7062
2025-06-03 10:10:19,807 - INFO - Initial training complete.
2025-06-03 10:10:19,809 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 1
2025-06-03 10:10:19,809 - INFO - Starting or resuming online updates from step: 1
2025-06-03 10:10:19,810 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-03 10:10:19,810 - INFO - Running anomaly detection...
2025-06-03 10:10:19,810 - INFO - Starting anomaly detection.
2025-06-03 10:10:19,812 - DEBUG - Node reconstruction errors: [0.03404479 0.03404553 0.03404503 0.06208611 0.03404466 0.11855412
 0.13837208 0.05843227 0.11568459 0.08904502 0.08066493 0.06849675
 0.03872817 0.03742502 0.05021109 0.58776087 0.05761825 0.06218003
 0.07866467 0.08587404 0.06218002 0.07619309 0.06735708 0.03326037
 1.6648129  0.11454178 0.04670434 0.03404576 0.06218    0.09459831
 0.05068043 0.11442785 0.54007393 0.3279977  0.81540674 0.8281486
 0.9668526  0.06695171 0.51048666 0.13929622 0.07484166 0.65865105
 0.4489408  0.03745241 0.04916955 0.08586502 1.3352401  0.02251875
 0.0438407  0.05593073 0.73513776 0.06758455 0.0442195  0.06695191
 0.1146001  0.07921457 0.07390215 0.04448897 0.5246079  0.339807
 0.3755985  0.07386325 0.5770403  0.07716264 0.34876645 0.08843359
 0.31262296 0.06735725 0.05512166 0.08446126 0.28677318 0.2591768
 0.04241579 0.03405141 1.697246   0.4152216  0.0559307  0.08611046
 0.7146273  0.04422162 0.05029355 0.07256566 0.06388511 0.03745323
 0.09569588 0.08468075 0.07604373 0.05888829 0.27602556]
2025-06-03 10:10:19,812 - DEBUG - Edge reconstruction errors: [0.14676861 0.75940675 0.7622051  0.69112545 0.8911256  0.76933104
 5.8784637  0.5549895  1.0696032  1.1696049  0.8690497  0.8784514
 0.9835229  0.795019   0.7697213  0.85288906 0.75726813 0.25291514
 0.9935105  0.7627584  0.6712144  0.87121534 0.7620826  0.75780416
 0.83224607 0.7574857  0.7639613  0.79200757 0.79133403 0.7737084
 0.81319124 0.7703607  0.66452545 0.86452556 0.66774076 0.86774117
 0.67598933 0.8759897  0.6754776  0.87547773 0.6685304  0.86853063
 0.66141534 0.8614154  0.7265468  0.92654705 0.5894753  0.9528025
 0.6828808  0.85635006 0.75767106 0.8535374  1.2346927  1.6315997
 0.25472912 0.65161026 0.2516244  0.87628126 0.9544495  0.5544442
 0.86006284 0.8554956  0.86051214 0.25186718 0.29857406 1.1632468
 0.80607384 0.7760601  0.78456455 0.7695624  0.7636772  2.777041
 0.8721277  0.8420002  0.3710787  0.9805539  1.1805552  0.25472414
 0.8373712  0.7644172  0.786664   1.12105    3.272433   0.76681435
 0.7654915  0.47978473 0.25329188 0.76030743 2.6329575  0.15138286
 0.85945326 0.25131267 0.25160977 0.25162426 0.2517853  0.7772978
 0.8485562  0.7643552  0.7719825  0.79551977 0.83372957 0.25210288
 0.7660427  0.85383767 0.25164557 0.78860986 0.77821434 0.2792829
 0.76518077 1.0112351  0.77672243 0.66805303 0.86805326 0.7598285
 0.7581531  0.85598856 0.8196846  0.55497885 1.5965812  0.7594809
 0.7796262  0.76035416 0.8530607  0.25149697 0.78523296 0.7620718
 0.8347462  0.25290936 0.7627461  0.9164636  0.6549927  0.79086965
 0.7606171 ]
2025-06-03 10:10:19,813 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101019_update_1.json
2025-06-03 10:10:19,813 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:19,817 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101019_update_1.pth and as latest_checkpoint.pth
2025-06-03 10:10:19,817 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.3573
2025-06-03 10:10:19,817 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-03 10:10:19,817 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.6648, MLP Score: 0.4694
2025-06-03 10:10:19,817 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.3352, MLP Score: 0.5092
2025-06-03 10:10:19,817 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6972, MLP Score: 0.4901
2025-06-03 10:10:19,817 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 10:10:19,818 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.8785, MLP Score: 0.5025
2025-06-03 10:10:19,818 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.7770, MLP Score: 0.5131
2025-06-03 10:10:19,818 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.2724, MLP Score: 0.5144
2025-06-03 10:10:19,818 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.6330, MLP Score: 0.4955
2025-06-03 10:10:19,818 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:19,818 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:19,818 - INFO - Starting visualization of node features.
2025-06-03 10:10:19,818 - INFO - Graph has 89 nodes and 30 features.
2025-06-03 10:10:19,818 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:19,818 - INFO - Calculating feature statistics:
2025-06-03 10:10:19,818 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,818 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,818 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(-1.6240591e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3339475), 'max': np.float32(1.5135604)}
2025-06-03 10:10:19,818 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(-1.3645446e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.5060302), 'max': np.float32(1.3409579)}
2025-06-03 10:10:19,818 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,819 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,819 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,819 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.8417165e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18677184), 'max': np.float32(5.354126)}
2025-06-03 10:10:19,819 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-1.6073162e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9242114), 'max': np.float32(1.0820036)}
2025-06-03 10:10:19,819 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(2.3105171e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.0625086), 'max': np.float32(0.25681368)}
2025-06-03 10:10:19,819 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(3.4825185e-08), 'std': np.float32(1.0), 'min': np.float32(-1.727558), 'max': np.float32(1.0981954)}
2025-06-03 10:10:19,819 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(3.6499472e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0945183), 'max': np.float32(1.7363071)}
2025-06-03 10:10:19,819 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.7977529), 'std': np.float32(1.4929029), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-03 10:10:19,819 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.8202248), 'std': np.float32(0.57204145), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:19,819 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.21348314), 'std': np.float32(0.4613588), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:19,819 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4044943), 'std': np.float32(0.73007774), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:19,819 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-2.3105171e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.25681368), 'max': np.float32(4.0625086)}
2025-06-03 10:10:19,819 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(1.9662921), 'std': np.float32(2.215621), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:19,819 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.741573), 'std': np.float32(2.4288902), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:19,819 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5617976), 'std': np.float32(1.6349763), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:19,820 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.21348314), 'std': np.float32(0.4613588), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:19,820 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:10:19,820 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(1.1720014e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29483095), 'max': np.float32(4.47607)}
2025-06-03 10:10:19,820 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-7.0320088e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3142697), 'max': np.float32(3.1819806)}
2025-06-03 10:10:19,820 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,820 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,820 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,820 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:19,820 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 4, 'mean': np.float32(2.611889e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.734376), 'max': np.float32(4.6010904)}
2025-06-03 10:10:19,820 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.745832e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.8399851), 'max': np.float32(4.143926)}
2025-06-03 10:10:19,822 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-03 10:10:19,838 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c8585610>
2025-06-03 10:10:19,990 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:20,043 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:20,070 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:21,305 - INFO - Node feature visualization saved to vis/node_features_20250603_101020.png
2025-06-03 10:10:21,305 - INFO - Finished visualization of node features.
2025-06-03 10:10:21,305 - INFO - Performing additional feature analysis:
2025-06-03 10:10:21,305 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:21,305 - INFO - Starting visualization of edge features.
2025-06-03 10:10:21,305 - INFO - Graph has 133 edges and 10 edge features.
2025-06-03 10:10:21,305 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:21,305 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:21,306 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:21,306 - INFO - - count: {'name': 'count', 'unique': 8, 'mean': np.float32(3.5639098), 'std': np.float32(1.4160911), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:10:21,306 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.2255639), 'std': np.float32(0.43557137), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:21,306 - INFO - - protocol: {'name': 'protocol', 'unique': 6, 'mean': np.float32(3.4586465), 'std': np.float32(1.9792581), 'min': np.float32(0.0), 'max': np.float32(5.0)}
2025-06-03 10:10:21,306 - INFO - - service: {'name': 'service', 'unique': 13, 'mean': np.float32(-1.43409675e-08), 'std': np.float32(1.0), 'min': np.float32(-0.13801745), 'max': np.float32(10.9908285)}
2025-06-03 10:10:21,306 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 100, 'mean': np.float32(5.3778626e-09), 'std': np.float32(1.0), 'min': np.float32(-0.23179126), 'max': np.float32(9.476409)}
2025-06-03 10:10:21,306 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 112, 'mean': np.float32(3.5852419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.25956312), 'max': np.float32(7.983913)}
2025-06-03 10:10:21,306 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 60, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.20947704), 'max': np.float32(10.808742)}
2025-06-03 10:10:21,306 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 97, 'mean': np.float32(3.5852419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2045888), 'max': np.float32(8.801429)}
2025-06-03 10:10:21,306 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 109, 'mean': np.float32(3.5852419e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.21361978), 'max': np.float32(8.714024)}
2025-06-03 10:10:21,306 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 66, 'mean': np.float32(8.963104e-09), 'std': np.float32(1.0), 'min': np.float32(-0.23307015), 'max': np.float32(10.26763)}
2025-06-03 10:10:21,317 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c30b2c60>
2025-06-03 10:10:21,382 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:21,392 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c2e37ad0>
2025-06-03 10:10:21,456 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:21,686 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:21,762 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:21,775 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:21,781 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:22,939 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101021.png
2025-06-03 10:10:22,939 - INFO - Finished visualization of edge features.
2025-06-03 10:10:22,939 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:22,939 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:10:22,939 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:22,939 - INFO - Graph has 133 edges and 10 edge features.
2025-06-03 10:10:22,939 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:23,227 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101022_summary.png
2025-06-03 10:10:23,408 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101022_pca_3d.png
2025-06-03 10:10:23,569 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101022_pca_variance.png
2025-06-03 10:10:23,569 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:23,569 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-03 10:10:23,569 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:10:23,569 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:10:23,572 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:10:23,573 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:10:23,573 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:10:23,573 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:10:23,576 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:10:23,577 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:10:23,577 - INFO - Processing node updates/additions.
2025-06-03 10:10:23,578 - INFO - Processing edge updates/additions.
2025-06-03 10:10:23,579 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:23,579 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:23,579 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:23,579 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:23,580 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-03 10:10:23,581 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:23,581 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-03 10:10:23,581 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-03 10:10:23,581 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:23,582 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 9
2025-06-03 10:10:23,582 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:23,582 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 10:10:23,583 - DEBUG - Shape of encoded categorical edge features: torch.Size([186, 3])
2025-06-03 10:10:23,583 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:23,583 - DEBUG - Shape of scaled numerical edge features: torch.Size([186, 7])
2025-06-03 10:10:23,583 - DEBUG - Final edge attributes tensor shape: torch.Size([186, 10])
2025-06-03 10:10:23,583 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:23,583 - INFO - Performing online update...
2025-06-03 10:10:23,584 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:23,584 - DEBUG - Initialized RunningStats with first batch: mean=1.1612403095384594, var=5.557419953322139, n=30
2025-06-03 10:10:23,584 - DEBUG - Updated RunningStats: new_mean=0.9430679843137739, new_var=182.6281684762696, new_n=60
2025-06-03 10:10:23,584 - DEBUG - Initialized RunningStats with first batch: mean=0.8263440838424108, var=1.939334304066308, n=10
2025-06-03 10:10:23,584 - DEBUG - Updated RunningStats: new_mean=0.9649381230755518, new_var=21.338851078526258, new_n=20
2025-06-03 10:10:23,584 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:23,584 - DEBUG - Online update step: 1/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 2/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 3/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 4/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 5/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 6/50
2025-06-03 10:10:23,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,584 - DEBUG - Online update step: 7/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 8/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 9/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 10/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 11/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 12/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 13/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 14/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 15/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 16/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 17/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 18/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 19/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 20/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 21/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 22/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 23/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 24/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 25/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 26/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 27/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 28/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 29/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 30/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 31/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 32/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,585 - DEBUG - Online update step: 33/50
2025-06-03 10:10:23,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 34/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 35/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 36/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 37/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 38/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 39/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 40/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 41/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 42/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 43/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 44/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 45/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 46/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 47/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 48/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 49/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - DEBUG - Online update step: 50/50
2025-06-03 10:10:23,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,586 - WARNING - No successful steps during online update.
2025-06-03 10:10:23,586 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.5446181e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.6205152e-08
  4.8053359e-08  1.1089236e-08 -2.5874884e-08  3.6964121e-09
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -9.2410302e-09  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00  7.3928241e-09  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0660534e-08 -5.1749769e-08], current edge mean: [ 3.5591397e+00  1.2365592e+00  3.4677420e+00  7.6909217e-09
  0.0000000e+00 -8.9727425e-09 -5.1272813e-09  7.6909217e-09
 -2.5636406e-09 -7.6909217e-09]
2025-06-03 10:10:23,587 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.5446181e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.6205152e-08
  4.8053359e-08  1.1089236e-08 -2.5874884e-08  3.6964121e-09
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -9.2410302e-09  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00  7.3928241e-09  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0660534e-08 -5.1749769e-08], edge=[ 3.5591397e+00  1.2365592e+00  3.4677420e+00  7.6909217e-09
  0.0000000e+00 -8.9727425e-09 -5.1272813e-09  7.6909217e-09
 -2.5636406e-09 -7.6909217e-09]
2025-06-03 10:10:23,587 - DEBUG - Updated reference std: node=[0.         0.         1.0038986  1.0038986  0.         0.
 0.         1.0038986  1.0038987  1.0038986  1.0038986  1.0038986
 1.4040276  0.484248   0.43981254 0.7156203  1.0038986  2.3433478
 2.4947863  1.3784312  0.43981254 0.         1.0038986  1.0038986
 0.         0.         0.         0.         1.0038986  1.0038986 ], edge=[1.5558946 0.4386182 2.0219157 1.002699  1.002699  1.002699  1.002699
 1.002699  1.002699  1.002699 ]
2025-06-03 10:10:23,587 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:23,587 - INFO - Running anomaly detection...
2025-06-03 10:10:23,587 - INFO - Starting anomaly detection.
2025-06-03 10:10:23,590 - DEBUG - Node reconstruction errors: [0.06518659 0.06518812 0.06518682 0.05242331 0.06518626 0.07836358
 0.10113667 0.86010563 0.08706965 0.07263648 0.10427501 0.06079141
 0.12742724 0.04863239 0.08082204 0.5585234  0.07413072 0.06730986
 0.08473197 0.09806912 0.06730964 0.08947334 0.08598864 0.0435258
 1.546578   0.14672753 0.05690951 0.06518839 0.0802945  0.11787022
 0.05406905 0.14668182 0.5469758  0.4435436  0.7837611  0.8581599
 1.1919391  0.08863818 0.5535764  0.16114013 0.0945768  0.5870255
 0.38695616 0.0486634  0.05550075 0.09805988 1.4637184  0.03131372
 0.12743203 0.06833735 0.7351362  0.0848321  0.06441338 0.0886379
 0.14678094 0.06854293 0.0933292  0.05759976 0.54754335 0.4364664
 1.2502655  0.08533609 0.56336915 0.08165172 0.45645422 0.10654435
 0.44779122 0.08598815 0.06763663 0.10580118 0.317329   0.2562722
 0.06016807 0.06519902 1.7291224  0.451086   0.06833733 0.07065337
 0.6639602  0.06442168 0.0446784  0.06933942 0.06373047 0.04866448
 0.08935077 0.10596704 0.05383903 0.06132048 0.31213894 0.0701581
 0.03930724 0.14220731 0.14220731 0.05806679 0.05803596 1.3162934
 0.08891162 0.058038   0.05396236 0.10701931 0.05804163 0.08890422
 0.04601683 0.06553485 0.10600934 0.09361599 0.0532531  0.733138
 0.08706965 0.8553964  0.2757353  0.05250873 0.5965748  0.08706965
 0.03930753 0.0460667  0.04601776 0.0452627  0.08081125 0.05803249
 0.07184543 0.14220993 0.14220731 0.14220993 0.0448879  0.05803238
 0.9381378  0.6543601  0.05804836]
2025-06-03 10:10:23,591 - DEBUG - Edge reconstruction errors: [0.14777493 0.75714356 0.7595898  1.313383   1.513383   0.7655743
 4.7589383  0.55318546 1.1204292  1.2204303  0.86178607 0.9666646
 0.8952166  0.78434306 0.7658728  0.9521555  0.75520146 0.25205985
 0.9092409  0.75901836 0.66521716 0.86521775 0.7584184  0.7556577
 0.81694275 0.7554074  0.76001555 0.6704412  0.87044126 0.7796777
 0.7782101  0.6696347  0.86963475 0.7537076  0.7955184  0.6638249
 0.863825   0.76385224 0.66041154 0.86041147 0.66292065 0.8629207
 0.6689333  0.8689333  0.66841877 0.86841875 0.6635323  0.8635325
 0.6579778  0.85797787 0.7053178  0.9053179  0.93555164 1.1355518
 0.8865083  1.0865084  0.7564413  0.7649385  0.75923645 0.25137153
 0.9787988  0.25174376 0.25137153 0.25174376 0.6599106  0.8599108
 0.75875676 0.2520612  0.7601377  0.25137153 0.25168723 0.7584495
 0.800146   0.78401303 0.80000216 0.83314776 0.75945216 0.77459806
 0.5739868  1.0520588  0.6705996  0.8544509  0.7554154  0.9526572
 1.0806506  1.3493237  0.25297385 0.7514298  0.25144315 0.9656273
 1.0528947  0.55289024 0.8565518  0.9537414  0.8184498  0.25153068
 0.28467792 1.0443234  0.7873722  0.768251   0.7770491  0.76331824
 0.75954163 2.0918012  0.83090204 0.8115818  0.36425453 0.87324744
 1.0732483  0.25297087 0.8080284  0.76037306 0.77478915 1.123771
 2.9616494  0.761585   0.7609917  0.41330558 0.25227517 0.7576149
 2.444747   0.15132797 0.9570887  0.25128537 0.25142944 0.25144306
 0.25150484 0.7701659  0.8179055  0.7613094  0.76576644 0.7805023
 0.8057099  0.2516759  0.7627758  0.9527953  0.25146326 0.77623045
 0.7684563  0.2691771  0.7607085  0.93297863 0.76914454 0.6937714
 0.8937716  0.7567295  0.7558047  0.7515547  0.7713573  0.9540014
 0.7933786  0.55317897 7.1795664  0.7571975  0.77196    0.7579378
 0.9522382  0.25137076 0.7734555  0.7584111  0.8943344  0.2520569
 0.7590102  1.7467351  0.7551679  0.8126206  0.28562677 1.8739837
 0.25137076 0.86868095 1.0896802  0.25136793 0.78398865 0.25137076
 0.75841886 0.88016456 0.75898314 0.75531447 0.8154497  0.75928307
 0.7586672  1.8540319  0.7582516  0.76672834 0.71175385 0.7515966 ]
2025-06-03 10:10:23,592 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101023_update_2.json
2025-06-03 10:10:23,592 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:23,596 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101023_update_2.pth and as latest_checkpoint.pth
2025-06-03 10:10:23,596 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.3528
2025-06-03 10:10:23,596 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-03 10:10:23,596 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.5466, MLP Score: 0.4696
2025-06-03 10:10:23,596 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.1919, MLP Score: 0.4944
2025-06-03 10:10:23,596 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.4637, MLP Score: 0.5032
2025-06-03 10:10:23,596 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.2503, MLP Score: 0.4997
2025-06-03 10:10:23,596 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.7291, MLP Score: 0.4914
2025-06-03 10:10:23,596 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-03 10:10:23,596 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7589, MLP Score: 0.5098
2025-06-03 10:10:23,596 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.9616, MLP Score: 0.5081
2025-06-03 10:10:23,596 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.1796, MLP Score: 0.5015
2025-06-03 10:10:23,596 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-03 10:10:23,596 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-03 10:10:23,596 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-03 10:10:23,632 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-03 10:10:23,635 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-03 10:10:23,635 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-03 10:10:23,635 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-03 10:10:23,638 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-03 10:10:23,640 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-03 10:10:23,640 - INFO - Processing node updates/additions.
2025-06-03 10:10:23,640 - INFO - Processing edge updates/additions.
2025-06-03 10:10:23,641 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:23,642 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:23,642 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:23,642 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:23,643 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-03 10:10:23,644 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:23,644 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-03 10:10:23,645 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-03 10:10:23,645 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:23,645 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-03 10:10:23,646 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:23,646 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:23,646 - DEBUG - Shape of encoded categorical edge features: torch.Size([256, 3])
2025-06-03 10:10:23,647 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:23,647 - DEBUG - Shape of scaled numerical edge features: torch.Size([256, 7])
2025-06-03 10:10:23,647 - DEBUG - Final edge attributes tensor shape: torch.Size([256, 10])
2025-06-03 10:10:23,647 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:23,647 - INFO - Performing online update...
2025-06-03 10:10:23,648 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:23,648 - DEBUG - Updated RunningStats: new_mean=1.0160315109660785, new_var=11126.014154089224, new_n=90
2025-06-03 10:10:23,648 - DEBUG - Updated RunningStats: new_mean=0.9395570039776882, new_var=1001355.9038360852, new_n=120
2025-06-03 10:10:23,648 - DEBUG - Updated RunningStats: new_mean=0.9790993741826958, new_var=457.1937918583572, new_n=30
2025-06-03 10:10:23,648 - DEBUG - Updated RunningStats: new_mean=1.0186407299098927, new_var=13718.319611007648, new_n=40
2025-06-03 10:10:23,648 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:23,648 - DEBUG - Online update step: 1/50
2025-06-03 10:10:23,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,648 - DEBUG - Online update step: 2/50
2025-06-03 10:10:23,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,648 - DEBUG - Online update step: 3/50
2025-06-03 10:10:23,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,648 - DEBUG - Online update step: 4/50
2025-06-03 10:10:23,648 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,648 - DEBUG - Online update step: 5/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 6/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 7/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 8/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 9/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 10/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 11/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 12/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 13/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 14/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 15/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 16/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 17/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 18/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 19/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 20/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 21/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 22/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 23/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 24/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 25/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 26/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 27/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,649 - DEBUG - Online update step: 28/50
2025-06-03 10:10:23,649 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 29/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 30/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 31/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 32/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 33/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 34/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 35/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 36/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 37/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 38/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 39/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 40/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 41/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 42/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 43/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 44/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 45/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 46/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 47/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 48/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 49/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - DEBUG - Online update step: 50/50
2025-06-03 10:10:23,650 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,650 - WARNING - No successful steps during online update.
2025-06-03 10:10:23,651 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7144916e-08  2.6939952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.1185911e-08
  5.3879905e-09  2.4245956e-08 -2.6939952e-08  2.4245956e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
 -2.4245956e-08  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -1.8857966e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.2327943e-08  1.6163971e-08], current edge mean: [ 4.4804688e+00  1.2421875e+00  4.3515625e+00  0.0000000e+00
  1.1175871e-08  7.4505806e-09  1.8626451e-09 -1.0244548e-08
  5.5879354e-09 -1.8626451e-09]
2025-06-03 10:10:23,651 - DEBUG - Node drift difference: 0.0695, Edge drift difference: 0.5922
2025-06-03 10:10:23,651 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:23,651 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7144916e-08  2.6939952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.1185911e-08
  5.3879905e-09  2.4245956e-08 -2.6939952e-08  2.4245956e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
 -2.4245956e-08  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -1.8857966e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.2327943e-08  1.6163971e-08], edge=[ 4.4804688e+00  1.2421875e+00  4.3515625e+00  0.0000000e+00
  1.1175871e-08  7.4505806e-09  1.8626451e-09 -1.0244548e-08
  5.5879354e-09 -1.8626451e-09]
2025-06-03 10:10:23,651 - DEBUG - Updated reference std: node=[0.         0.         1.002837   1.0028368  0.         0.
 0.         1.002837   1.002837   1.0028368  1.002837   1.0028368
 1.3349775  0.4166538  0.41433606 0.65556365 1.0028368  2.234172
 2.4678338  1.3320888  0.41433606 0.         1.0028368  1.002837
 0.         0.         0.         0.         1.002837   1.002837  ], edge=[1.5439984 0.4382871 2.3766506 1.0019588 1.0019588 1.0019588 1.0019588
 1.0019588 1.0019588 1.0019588]
2025-06-03 10:10:23,651 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:23,651 - INFO - Running anomaly detection...
2025-06-03 10:10:23,652 - INFO - Starting anomaly detection.
2025-06-03 10:10:23,656 - DEBUG - Node reconstruction errors: [0.15829283 0.15830718 0.15829174 0.07388314 0.15277378 0.09569515
 0.09348885 0.7375616  0.09391309 0.10463271 0.20529298 0.08231213
 0.23081906 0.08683024 0.17084153 0.6160844  0.09345052 0.10545739
 0.09252372 0.12215388 0.10545697 0.12004025 0.13103427 0.0798554
 1.4905317  0.21695487 0.08062122 0.15830645 0.10551032 0.16604689
 0.07593158 0.21693796 0.616489   0.59296423 0.8248982  0.92257404
 1.9278563  0.14272326 0.6254152  0.36287796 0.16034728 0.5062807
 0.46535847 0.08677731 0.07457659 0.12214483 1.6960503  0.06343117
 0.23082443 0.10815895 0.8088738  0.13026954 0.10966916 0.142723
 0.21700417 0.08889029 0.15871933 0.2550588  0.59735316 0.62436384
 1.3760191  0.12123848 0.5537948  0.10812418 0.616032   0.13138123
 0.6762637  0.13103363 0.10773966 0.1509214  0.3860749  0.26178008
 0.91078377 0.1584048  1.8437793  0.4952288  0.10815885 0.10734149
 0.6889486  0.10967842 0.14628746 0.07340205 0.07716747 0.08677828
 0.11013753 0.15101136 0.09491054 0.0900962  0.35273698 0.07272518
 0.08360216 0.15157151 0.15157151 0.06875977 0.07271997 1.5248458
 0.1068314  0.07269905 0.07761865 0.11295103 0.07272296 0.10682822
 0.07223977 0.15902242 0.11817084 0.11918821 0.08361102 0.7273303
 0.09391309 1.0470284  0.3235409  0.07397249 0.63247114 0.09391309
 0.07223359 0.07224984 0.07224017 1.0027238  0.06698525 0.07266183
 0.08715226 0.15157463 0.15157151 0.15157463 0.12037413 0.07266124
 0.8609728  0.6020076  0.0727696  0.10682956 0.11753824 0.06698524
 0.11815085 0.753766   0.06698573 0.11479916 0.14398639 0.07761371
 0.06699533 0.06699435 0.06710486 0.08688217 0.07224008 0.06700157
 0.17203084 0.06727268 0.06699821 0.06706908 0.0715322  0.06705549
 0.6903899  0.8821669  0.47899383 0.06698501 0.48746237 0.78102976
 0.07268929 0.06698523 0.08651229 0.13325399 0.06748509 0.7537823
 0.07266153 0.11753204 0.12043864 0.83949107 0.1165212  0.10684002
 0.753687   0.0671573  0.07283134 0.07266025 0.07224006 1.4406596
 0.0726608  0.06694695 0.06705301]
2025-06-03 10:10:23,657 - DEBUG - Edge reconstruction errors: [0.03390744 0.97005594 0.9722066  1.4061373  1.6061376  0.9773541
 5.4774604  0.7667006  1.3103052  1.4103059  1.0723698  1.0754619
 1.0637959  0.9921262  0.97762007 1.0660975  0.9683923  0.3660002
 1.076192   0.9710157  0.8754435  1.0754439  0.97048014 0.9687896
 1.02068    0.96857995 0.97187144 0.879248   1.079248   0.9863791
 0.98468316 0.87858176 1.0785818  1.3220537  0.99908155 0.8745854
 1.0745854  0.974727   0.87198544 1.0719855  0.87400496 1.074005
 0.8783294  1.0783294  0.87797034 1.0779704  0.8743616  1.0743616
 0.8698032  1.0698032  0.90535045 1.1053505  1.1030889  1.3030889
 1.281909   1.4819093  0.365594   0.9694865  0.9767473  0.9711361
 0.36559597 1.146988   0.36624917 0.36559597 0.36624917 0.87183726
 1.0718373  0.97082263 0.36600068 0.9850131  0.36559597 0.36578435
 0.9705201  0.99964714 0.98872805 1.1248963  1.0224514  1.0012786
 0.99833614 0.9892269  0.9842149  1.0650332  0.3655956  1.0453498
 0.9710153  0.8704281  1.0704281  0.882657   1.082657   0.97059846
 0.36560318 0.9703191  0.97056794 0.9846795  0.7803895  1.2660204
 0.8783392  1.0677143  0.96844465 1.0664858  1.1805736  1.2666491
 0.36654463 0.8656321  0.36564416 1.074693   1.266521   0.7665187
 1.0690728  1.0671781  1.0112534  0.3656863  0.38961363 1.179409
 0.991202   0.97758853 0.9864365  0.97367525 0.9712946  1.8316844
 1.0190468  1.0074508  0.47452348 1.0177981  1.2177986  0.3665427
 1.0045315  0.9722293  0.9821064  1.1739044  2.7888737  0.9725865
 0.9724953  0.48137316 0.36614498 0.9703656  2.3534327  0.26557013
 1.0699642  0.87826586 1.0782661  0.36555    0.3656317  0.3656441
 0.36567727 1.0011882  1.0135683  0.9736256  0.9761204  0.98558056
 1.001405   0.3657772  0.9749251  1.0665349  0.36566246 0.98222804
 0.9773464  0.37704867 0.98611844 1.1025249  0.9791316  0.9467086
 1.1467087  0.97537535 0.9685673  0.86571014 0.9798172  1.0471003
 1.2471002  0.88667804 1.0866781  0.9709039  0.9855308  0.9702955
 0.9801615  0.9705251  1.0673382  0.99419236 0.76669824 8.259636
 0.97009426 0.9816379  0.9707367  1.0661454  0.36559564 0.9807819
 0.9704755  1.0833523  0.36599863 0.97101086 0.8720672  1.0720675
 5.8572745  0.86784196 1.0145614  0.38572764 1.8680376  0.36559564
 1.0844518  1.2231938  0.36559433 0.98941094 0.36559564 0.9705155
 1.2157084  0.99814963 0.96852577 1.0183316  0.97120655 0.97071916
 1.9106725  0.9703965  0.87466586 0.97116864 1.7081729  0.9707024
 0.9712331  0.8655063  1.0701716  0.8666251  1.0402887  0.366
 1.0131507  1.5716156  0.97137696 0.36715868 1.0735056  1.0580834
 1.074498   1.1977748  0.9867769  0.36560312 1.003474   1.3692364
 0.9704601  0.9927849  0.97092235 0.97010577 1.1222498  0.9815133
 0.9828972  0.98183686 0.9713986  0.36559507 1.0384918  0.866568
 1.0563474  0.36600035 0.97046417 0.9704344  0.9704848  0.8701609
 1.070161   0.8034728  0.8657352  0.865515  ]
2025-06-03 10:10:23,657 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101023_update_3.json
2025-06-03 10:10:23,657 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:23,661 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101023_update_3.pth and as latest_checkpoint.pth
2025-06-03 10:10:23,661 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.3467
2025-06-03 10:10:23,661 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-03 10:10:23,661 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.4905, MLP Score: 0.4688
2025-06-03 10:10:23,661 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.9279, MLP Score: 0.4944
2025-06-03 10:10:23,661 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.6961, MLP Score: 0.4975
2025-06-03 10:10:23,661 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.3760, MLP Score: 0.4951
2025-06-03 10:10:23,661 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.8438, MLP Score: 0.4893
2025-06-03 10:10:23,661 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 10:10:23,662 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.4775, MLP Score: 0.5185
2025-06-03 10:10:23,662 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.7889, MLP Score: 0.5043
2025-06-03 10:10:23,662 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.2596, MLP Score: 0.5076
2025-06-03 10:10:23,662 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.8573, MLP Score: 0.5087
2025-06-03 10:10:23,662 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-03 10:10:23,662 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-03 10:10:23,662 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-03 10:10:23,667 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-03 10:10:23,671 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-03 10:10:23,671 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-03 10:10:23,671 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-03 10:10:23,676 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-03 10:10:23,680 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-03 10:10:23,680 - INFO - Processing node updates/additions.
2025-06-03 10:10:23,681 - INFO - Processing edge updates/additions.
2025-06-03 10:10:23,682 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:23,683 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:23,683 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:23,683 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:23,685 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-03 10:10:23,686 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:23,686 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-03 10:10:23,686 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-03 10:10:23,686 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:23,687 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-03 10:10:23,688 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:23,688 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:23,688 - DEBUG - Shape of encoded categorical edge features: torch.Size([395, 3])
2025-06-03 10:10:23,689 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:23,689 - DEBUG - Shape of scaled numerical edge features: torch.Size([395, 7])
2025-06-03 10:10:23,689 - DEBUG - Final edge attributes tensor shape: torch.Size([395, 10])
2025-06-03 10:10:23,689 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:23,689 - INFO - Performing online update...
2025-06-03 10:10:23,689 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:23,690 - DEBUG - Updated RunningStats: new_mean=0.9846403939920004, new_var=120162874.25142235, new_n=150
2025-06-03 10:10:23,690 - DEBUG - Updated RunningStats: new_mean=0.9412491066089386, new_var=18024431153.841064, new_n=180
2025-06-03 10:10:23,690 - DEBUG - Updated RunningStats: new_mean=1.0197733453349695, new_var=548763.8267379416, new_n=50
2025-06-03 10:10:23,690 - DEBUG - Updated RunningStats: new_mean=1.033234646704166, new_var=27438193.109454684, new_n=60
2025-06-03 10:10:23,690 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:23,690 - DEBUG - Online update step: 1/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 2/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 3/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 4/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 5/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 6/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 7/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 8/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 9/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 10/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 11/50
2025-06-03 10:10:23,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,690 - DEBUG - Online update step: 12/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 13/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 14/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 15/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 16/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 17/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 18/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 19/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 20/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 21/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 22/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 23/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 24/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 25/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 26/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 27/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 28/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 29/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 30/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 31/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 32/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 33/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 34/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 35/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 36/50
2025-06-03 10:10:23,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,691 - DEBUG - Online update step: 37/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 38/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 39/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 40/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 41/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 42/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 43/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 44/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 45/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 46/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 47/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 48/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 49/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - DEBUG - Online update step: 50/50
2025-06-03 10:10:23,692 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,692 - WARNING - No successful steps during online update.
2025-06-03 10:10:23,692 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7252903e-08 -3.7252903e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8626451e-08
  2.0489097e-08  1.4901161e-08 -4.8428774e-08 -3.1664968e-08
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -1.4901161e-08  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  1.8626451e-08 -3.3527613e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8626451e-08  2.0489097e-08], current edge mean: [ 4.3518987e+00  1.3265823e+00  4.5645571e+00  9.6574615e-09
 -4.8287307e-09 -4.8287307e-09  4.8287307e-09 -7.2430959e-09
  1.2071827e-08  2.4143654e-09]
2025-06-03 10:10:23,692 - DEBUG - Node drift difference: 0.2039, Edge drift difference: 0.1926
2025-06-03 10:10:23,693 - WARNING - Feature drift detected (2 consecutive)
2025-06-03 10:10:23,693 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7252903e-08 -3.7252903e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8626451e-08
  2.0489097e-08  1.4901161e-08 -4.8428774e-08 -3.1664968e-08
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -1.4901161e-08  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  1.8626451e-08 -3.3527613e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8626451e-08  2.0489097e-08], edge=[ 4.3518987e+00  1.3265823e+00  4.5645571e+00  9.6574615e-09
 -4.8287307e-09 -4.8287307e-09  4.8287307e-09 -7.2430959e-09
  1.2071827e-08  2.4143654e-09]
2025-06-03 10:10:23,693 - DEBUG - Updated reference std: node=[0.         0.         1.0019588  1.0019588  0.         0.
 0.         1.0019588  1.0019588  1.0019588  1.0019588  1.0019588
 1.209687   0.36907077 0.41064274 0.6137592  1.0019588  2.614132
 2.6151161  1.4622234  0.41064274 0.         1.0019588  1.0019588
 0.         0.         0.         0.         1.0019588  1.0019588 ], edge=[1.3215185  0.47493222 2.200083   1.0012683  1.0012683  1.0012683
 1.0012683  1.0012681  1.0012683  1.0012683 ]
2025-06-03 10:10:23,693 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:23,693 - INFO - Running anomaly detection...
2025-06-03 10:10:23,693 - INFO - Starting anomaly detection.
2025-06-03 10:10:23,697 - DEBUG - Node reconstruction errors: [0.2868358  0.286847   0.5427071  0.12090148 0.24095906 0.14022192
 0.20241372 0.70203936 0.87205213 0.15657613 0.33522794 0.10910266
 0.37164563 0.24857768 0.28951016 0.82276255 0.16409151 0.21426275
 0.1111423  0.3011009  0.16766217 0.31404248 0.2996794  1.2069408
 1.7029325  0.45924103 0.13417387 0.28684625 0.1579256  0.37411055
 0.10889234 0.45927703 0.86008435 0.9087036  1.0324254  1.0046363
 2.18541    0.32525674 0.745409   0.40959036 0.37803122 0.5919529
 0.6359908  0.24852501 0.23634791 0.30109164 3.3190045  0.21680921
 0.37165457 0.28947136 1.0595394  0.3020629  0.28059152 0.3252559
 0.45922464 0.24097371 0.3799465  0.36981276 0.74692684 0.78191894
 1.5944133  0.3063403  0.67958057 0.25239712 0.7600044  0.23129708
 1.0319602  0.29967853 0.28988168 0.3696873  0.5898764  0.40842485
 1.1912065  0.2869229  1.9876869  0.6889114  0.28947136 0.19204825
 0.7449102  0.28060138 0.26791966 0.1934715  0.13221803 0.24852623
 0.24718831 0.36951417 0.16736898 1.1732911  0.4424133  0.23520346
 0.13449189 1.0446779  0.17399934 0.2334133  0.09787126 2.0571299
 0.145765   0.09785256 0.22294751 0.15009409 0.23517925 0.14576322
 0.1230946  0.28728285 0.15407261 0.15725975 0.16318665 0.7549995
 0.12370649 1.2065631  0.47137383 0.12095806 0.94773716 0.97503847
 0.23712368 0.23090632 0.25763476 1.5190533  0.5223558  0.09782089
 0.12508544 0.17400089 1.0593646  0.17400089 0.20957491 0.09781992
 0.890964   0.63474655 0.23521465 0.1457642  0.22273378 0.09054743
 0.15405537 0.7620322  0.09053566 0.15156452 0.2689237  0.22289711
 0.0906229  0.09054636 0.09068667 0.12493335 0.12309515 0.09055328
 0.17687629 0.09088705 0.09055167 0.09064276 0.19706617 0.09062613
 0.82562155 0.95431334 0.56357753 0.09054771 0.4772393  1.0522472
 0.09784327 0.23073404 0.13844056 0.1654521  0.09120961 0.7620611
 0.0978203  0.22266848 0.20961322 0.8740764  0.33951187 0.1457697
 0.6163531  0.09074978 0.09792498 0.09781976 0.12309517 1.9350711
 0.0978199  0.09259109 0.09062009 0.1643074  0.14539796 0.11102331
 0.17174695 0.21499851 0.15526672 0.6929132  0.21499869 0.16447689
 0.12728408 0.16298729 0.12728553 0.11098989 0.14539286 0.16431364
 0.16300103 0.10277484 0.12309656 0.16297756 0.13680239 0.12309475
 0.9103207  0.14576435 0.2229031  0.09783936 0.96863914 0.14577983
 0.20196372 0.17399934 0.29174742 0.89096934 0.22289364 0.22289385
 0.16505498 0.10229725 0.11098985 0.20196387 0.1643191  0.13843475
 0.1643063  0.20196338 0.11125822 0.09782042 0.21499869 0.12728237
 0.12728573 0.11098969 0.09782004 0.48053715 0.16441663 0.09782015
 0.1109909  0.1512347  0.17400019 0.14539787 0.12493982 0.20200652
 0.20196387 0.16297744 0.4654239  0.127283   0.0978199  0.16655411
 0.21499869 0.2228951  0.10227893 0.09054767 0.11101243 0.09053728
 0.11173902 0.16432415 0.10227918 0.09519941 0.12309991 0.13843663
 0.1110246  0.09782053 0.2019816  0.20198813]
2025-06-03 10:10:23,699 - DEBUG - Edge reconstruction errors: [0.01705515 1.0180172  1.018539   1.0743102  1.2743102  1.0198485
 8.095375   0.8170656  1.3362083  1.4362086  1.1195403  1.1273636
 1.0692132  1.024417   1.0199015  1.116779   1.0175586  0.4167536
 1.0727221  1.0236274  0.9205543  1.1205544  1.018594   1.0212812
 1.0314264  1.0176009  1.0189351  0.9220166  1.1220165  1.0242255
 1.0240462  0.92177725 1.1217772  2.5978715  1.0279853  0.9201014
 1.1201015  1.0198007  0.91917163 1.1191717  0.91978353 1.1197835
 1.0188394  0.9215354  1.1215354  0.9213477  1.1213477  0.92003155
 1.1200315  0.918739   1.118739   0.93142194 1.1314219  0.98179805
 1.1817981  1.1263571  1.3263572  0.41655666 1.0229466  1.0178566
 1.0197177  1.018781   0.4165567  0.92976946 1.1297697  1.1309603
 0.9538383  1.1538383  0.4168777  0.41655704 0.9276372  1.1276373
 0.4168777  0.91896486 1.1189648  1.0186538  0.4167539  1.0239961
 0.41655794 0.4166466  1.018595   1.0304596  0.919117   1.119117
 1.0256946  1.0808955  1.0400492  0.9220665  1.1220666  1.0305449
 0.92456096 1.124561   1.0298041  1.0251805  1.0237622  1.0442717
 0.41655704 1.0491337  1.0187185  0.9186202  1.1186203  0.92328763
 1.1232877  1.0186164  0.41655824 1.0185332  1.0185952  1.0238111
 0.41908452 1.0228543  0.41655794 1.0352764  0.41655657 1.0267925
 1.0186162  1.0227785  1.0186645  1.0291991  1.0187254  0.41655758
 1.0235877  1.117515   1.0185921  1.0185932  1.0186796  1.020743
 1.0186173  0.41675425 1.0293379  1.0374221  1.0185314  1.0185004
 1.0196099  1.018578   1.0646948  0.41655794 1.0273283  1.0189474
 0.41655794 0.92358094 1.123581   0.41655794 1.1583624  1.121305
 1.0375315  0.41655794 1.0223407  1.0187354  1.0244511  1.0242009
 1.0252159  1.0262078  1.0185652  1.0186092  1.018633   0.41655764
 1.0597506  1.0187545  0.8230575  1.3189677  0.92210805 1.1174214
 1.0176768  1.116912   1.4183838  1.0094341  1.0282183  0.41701022
 0.9211395  1.1211395  0.9165737  0.4165765  1.1207142  1.316984
 0.8169834  1.1179954  1.1172117  1.035014   0.41660327 0.42599493
 1.0980506  1.0264039  1.0213549  1.0226723  1.0201337  1.0189058
 1.4475104  1.0405575  1.0338575  0.52025384 1.041433   1.2414329
 0.41701013 1.0330434  1.0189722  1.0231332  1.0024906  1.556558
 1.0195751  1.0192425  0.46323487 0.41680917 1.018136   1.440652
 0.3167265  1.1180185  0.9218095  1.1218095  0.41653207 0.41657367
 0.4165765  0.41659355 1.0290027  1.0349119  1.0189397  1.0205057
 1.0250797  1.0334975  0.4166431  0.9198074  1.1198075  1.0192454
 5.8519654  0.41658065 1.0242105  1.0213882  0.42217574 1.0245876
 1.063191   1.0210545  0.9515032  1.1515033  1.0209501  1.0179133
 0.91662043 1.0221802  1.021395   1.2213951  0.9239883  1.1239884
 1.0185829  1.0243896  1.0183951  1.0220925  1.0183786  1.0183669
 1.0183688  1.0218415  1.0189799  1.0184686  1.117284   1.0281141
 0.8170644  7.890387   1.0180333  1.021688   1.0181937  1.1168027
 0.41655725 1.0229396  1.0185916  1.0706047  0.41675267 1.0187148
 0.9190911  1.1190914  5.1776977  0.9176317  1.0312793  0.42629775
 1.3748682  0.41655776 1.0817107  1.1043464  0.41655576 1.0254103
 0.94644517 1.1464454  0.41655648 0.9394831  1.1394833  1.0185361
 0.92129284 1.1212928  1.1268381  1.0298399  1.0175738  1.0315406
 1.0391903  1.2391903  1.018784   0.91851115 1.1185113  1.0186396
 0.91862434 1.1186243  1.2579477  1.0185328  0.9209126  1.0189174
 1.3184737  1.0186266  0.9201213  1.1201214  1.0187362  0.9165162
 1.118469   0.9170494  1.0364757  0.41675353 1.0295523  1.6189321
 1.0188183  0.4173068  1.0612252  1.0550841  1.061706   1.1109937
 1.0251032  0.4165582  1.0289344  1.168081   1.0185742  1.0260907
 1.0187114  1.0184842  1.079875   1.0230575  1.0537895  1.0232078
 1.0188073  0.41655743 1.047699   0.917021   1.0527261  0.41675356
 1.0291524  1.0233413  1.0232546  0.918374   1.118374   1.0192744
 1.0234762  1.0244477  0.41675404 0.9181728  1.1181728  0.9180121
 1.1180121  1.030247   0.93109    1.13109    0.9181584  1.1181583
 1.0201606  0.9181558  1.1181558  0.91838354 1.1183838  0.92623466
 1.1262347  1.0185348  0.9240304  1.1240305  1.0190737  0.92333466
 1.1233346  0.9189492  1.1189492  0.9228072  1.1228074  0.92082286
 1.1208229  0.9206814  1.1206814  1.0184757  1.0190079  1.0187466
 1.0238179  0.96452975 1.1645298  1.018538   1.0185869  0.92199063
 1.1219907  0.91914284 1.1191429  0.9483353  1.1483353  1.0186222
 1.0190747  0.8392525  0.8165183  0.9166329  0.9165205 ]
2025-06-03 10:10:23,700 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101023_update_4.json
2025-06-03 10:10:23,700 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:23,704 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101023_update_4.pth and as latest_checkpoint.pth
2025-06-03 10:10:23,704 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.3345
2025-06-03 10:10:23,704 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-03 10:10:23,704 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.7029, MLP Score: 0.4698
2025-06-03 10:10:23,704 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.1854, MLP Score: 0.4924
2025-06-03 10:10:23,704 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.3190, MLP Score: 0.4915
2025-06-03 10:10:23,704 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.5944, MLP Score: 0.4865
2025-06-03 10:10:23,704 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.9877, MLP Score: 0.4833
2025-06-03 10:10:23,704 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 10:10:23,704 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 8.0954, MLP Score: 0.4985
2025-06-03 10:10:23,704 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8520, MLP Score: 0.5185
2025-06-03 10:10:23,704 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.8904, MLP Score: 0.4956
2025-06-03 10:10:23,704 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.1777, MLP Score: 0.5043
2025-06-03 10:10:23,704 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-03 10:10:23,704 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-03 10:10:23,704 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-03 10:10:23,711 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-03 10:10:23,716 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-03 10:10:23,716 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-03 10:10:23,716 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-03 10:10:23,722 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-03 10:10:23,727 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-03 10:10:23,727 - INFO - Processing node updates/additions.
2025-06-03 10:10:23,728 - INFO - Processing edge updates/additions.
2025-06-03 10:10:23,730 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:23,730 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:23,730 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:23,730 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:23,733 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-03 10:10:23,734 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:23,734 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-03 10:10:23,734 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-03 10:10:23,735 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:23,736 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-03 10:10:23,736 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:23,737 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:23,737 - DEBUG - Shape of encoded categorical edge features: torch.Size([503, 3])
2025-06-03 10:10:23,738 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:23,738 - DEBUG - Shape of scaled numerical edge features: torch.Size([503, 7])
2025-06-03 10:10:23,738 - DEBUG - Final edge attributes tensor shape: torch.Size([503, 10])
2025-06-03 10:10:23,738 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:23,739 - INFO - Performing online update...
2025-06-03 10:10:23,739 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:23,739 - DEBUG - Updated RunningStats: new_mean=0.9732452654032483, new_var=1800000000164.506, new_n=210
2025-06-03 10:10:23,739 - DEBUG - Updated RunningStats: new_mean=0.9430407916794223, new_var=2100000000017.1758, new_n=240
2025-06-03 10:10:23,740 - DEBUG - Updated RunningStats: new_mean=1.0333718175874917, new_var=1646291618.0819848, new_n=70
2025-06-03 10:10:23,740 - DEBUG - Updated RunningStats: new_mean=1.0404419648933831, new_var=115240413267.28825, new_n=80
2025-06-03 10:10:23,740 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:23,740 - DEBUG - Online update step: 1/50
2025-06-03 10:10:23,740 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,740 - DEBUG - Online update step: 2/50
2025-06-03 10:10:23,740 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,740 - DEBUG - Online update step: 3/50
2025-06-03 10:10:23,740 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,740 - DEBUG - Online update step: 4/50
2025-06-03 10:10:23,740 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,740 - DEBUG - Online update step: 5/50
2025-06-03 10:10:23,740 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,740 - DEBUG - Online update step: 6/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 7/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 8/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 9/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 10/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 11/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 12/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 13/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 14/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 15/50
2025-06-03 10:10:23,741 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,741 - DEBUG - Online update step: 16/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 17/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 18/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 19/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 20/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 21/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 22/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 23/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 24/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 25/50
2025-06-03 10:10:23,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,742 - DEBUG - Online update step: 26/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 27/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 28/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 29/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 30/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 31/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 32/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 33/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 34/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 35/50
2025-06-03 10:10:23,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,743 - DEBUG - Online update step: 36/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 37/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 38/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 39/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 40/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 41/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 42/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 43/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 44/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 45/50
2025-06-03 10:10:23,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,744 - DEBUG - Online update step: 46/50
2025-06-03 10:10:23,745 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,745 - DEBUG - Online update step: 47/50
2025-06-03 10:10:23,745 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,745 - DEBUG - Online update step: 48/50
2025-06-03 10:10:23,745 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,745 - DEBUG - Online update step: 49/50
2025-06-03 10:10:23,745 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,745 - DEBUG - Online update step: 50/50
2025-06-03 10:10:23,745 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,745 - WARNING - No successful steps during online update.
2025-06-03 10:10:23,746 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1789146e-08  1.9073486e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.0199686e-08
  2.5828680e-08  1.5894572e-09  4.4504802e-08  9.5367430e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  1.5894572e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -6.3578289e-09 -6.3578289e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.9472864e-09 -3.3378601e-08], current edge mean: [ 4.3359842e+00  1.3638171e+00  4.6421471e+00  2.4647646e-08
  7.5838908e-09  0.0000000e+00 -7.5838908e-09  5.2139253e-09
  5.2139253e-09  3.7919454e-09]
2025-06-03 10:10:23,746 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0784
2025-06-03 10:10:23,747 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1789146e-08  1.9073486e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.0199686e-08
  2.5828680e-08  1.5894572e-09  4.4504802e-08  9.5367430e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  1.5894572e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -6.3578289e-09 -6.3578289e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.9472864e-09 -3.3378601e-08], edge=[ 4.3359842e+00  1.3638171e+00  4.6421471e+00  2.4647646e-08
  7.5838908e-09  0.0000000e+00 -7.5838908e-09  5.2139253e-09
  5.2139253e-09  3.7919454e-09]
2025-06-03 10:10:23,747 - DEBUG - Updated reference std: node=[0.         0.         1.0016708  1.0016708  0.         0.
 0.         1.0016708  1.0016708  1.0016708  1.0016708  1.0016708
 1.1858089  0.34174448 0.39080855 0.5999907  1.0016708  2.8067029
 2.7072284  1.5051417  0.39080855 0.         1.0016708  1.0016708
 0.         0.         0.         0.         1.0016708  1.0016708 ], edge=[1.2860101 0.4856947 2.1206565 1.0009955 1.0009955 1.0009955 1.0009955
 1.0009955 1.0009955 1.0009955]
2025-06-03 10:10:23,747 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:23,747 - INFO - Running anomaly detection...
2025-06-03 10:10:23,747 - INFO - Starting anomaly detection.
2025-06-03 10:10:23,754 - DEBUG - Node reconstruction errors: [0.27913195 0.33148804 0.43749416 0.17491989 0.30429903 0.18970898
 0.3016409  0.5168496  0.91213423 0.20195243 0.445002   0.13518909
 0.3918549  0.35056934 0.32728922 0.9324532  0.21738538 0.24189086
 0.17493966 0.41402656 0.24190034 0.42243928 0.40520903 1.382912
 1.6460755  0.6002672  0.18856803 0.33160818 0.24618244 0.50233835
 0.14434817 0.60028213 1.0014106  1.1210606  1.1609043  1.0703094
 2.2065842  0.44660345 0.9080724  0.8148438  0.52228075 0.5762926
 1.319997   0.35050812 0.33694336 0.5332221  4.3032184  0.32062897
 0.48700982 0.40419817 1.2018536  0.4055096  0.3873053  0.44660288
 0.6002635  0.33007368 0.5260538  0.44123107 0.88243216 0.9238844
 2.2065842  0.43203527 0.77143055 0.3461564  0.9238846  0.31866047
 1.3215656  0.40520817 0.40504465 0.4907278  0.68061894 0.51761067
 1.3611283  0.28439882 2.1780217  0.74083173 0.40419787 0.38561794
 0.7530607  0.38731843 0.34620747 0.28244478 0.18856524 0.35050926
 0.3352071  0.49032402 0.23313816 1.2985803  0.4604438  0.30030054
 0.18648797 1.4142683  0.19572765 0.4287972  0.12854694 2.3697975
 0.17643301 0.30026764 0.313856   0.19075075 0.30027243 0.17643155
 0.17745116 0.39671248 0.20114571 0.19512391 0.21004693 0.8240438
 0.17072016 1.2956065  0.5775179  0.17499219 1.0155985  1.0485048
 0.3200766  0.30088666 0.3471047  1.3614553  0.42178974 0.12847301
 0.17662662 0.19572888 1.0840515  0.19572888 0.29310328 0.12847164
 0.9350243  0.667755   0.30031404 0.18985376 0.28691846 0.12850307
 0.20111214 1.2888824  0.30024734 0.19461098 0.35071716 0.3138518
 0.12870565 0.30025113 0.12887958 0.17643218 0.17745131 0.12852153
 0.20912436 0.12944733 0.3002638  0.1287592  0.27695924 0.12871525
 0.910788   1.0198067  0.58112264 0.12850396 0.39311022 1.3682231
 0.1285061  0.24842301 0.3002624  0.21724866 0.13036637 0.82718456
 0.12847212 0.28691247 0.29314643 1.0923563  0.49654344 0.4218661
 0.6714243  0.12906049 0.42194512 0.12847109 0.17745131 2.2290506
 0.30024973 0.1340239  0.30033392 0.23766515 0.17790446 0.1322246
 0.20069192 0.9972714  0.18464065 0.7350695  0.23199603 0.23814742
 0.17789812 0.17355734 0.17789812 0.13217984 0.1778988  0.29753986
 0.17358875 0.12315296 0.17745204 0.17354617 0.17070214 0.1774513
 0.94188064 0.17643239 0.31385237 0.1284998  1.0298265  0.16240351
 0.25646657 0.19572765 0.3610183  1.0959506  0.31385145 0.50642395
 0.18984853 0.13222119 0.17355339 0.2930957  0.23769586 0.17745139
 0.23766308 0.2930948  0.13253553 0.12312142 0.23199603 0.17789759
 0.17789817 0.17355333 0.12847166 0.36447042 0.23797812 0.12847163
 0.13228224 0.19572845 0.9418804  0.17790432 0.3002518  0.29324034
 0.2930966  0.17354608 0.3644367  0.17789772 0.12847143 0.18989179
 0.23199603 0.31385142 0.13221627 0.12850419 0.13225895 0.3002345
 0.13321623 0.2377107  0.13221724 0.12748213 0.1774533  0.17745352
 0.13222629 0.1284724  0.29315785 0.29318002 0.13218024 0.31753844
 0.17790489 0.13222165 0.43438143 0.23248832 0.23248832 0.13218077
 0.13219711 0.13221806 0.43282256 0.23248832 0.432946   0.17357565
 0.23199603 0.23199603 0.36456522 0.37510926 0.43284214 0.17355691
 0.17789894 0.17356764 0.20081396 0.13221592 0.36439884 0.17789894
 0.18984841 0.37510794 0.13219856 0.32527047 0.23786226 0.893002
 0.997271   0.18467961 0.17354648 0.18985404 0.25571993 0.13221906
 0.18462406 0.3175326  0.13222435 0.17791906 0.17354608 0.22591019]
2025-06-03 10:10:23,757 - DEBUG - Edge reconstruction errors: [0.02127244 1.0222923  1.02749    1.0859467  1.2859468  0.42079517
 1.0242679  9.038679   0.82128966 1.3400197  1.4400198  1.123715
 1.1356381  1.087934   1.0289952  1.0243281  1.1210122  1.0268642
 0.4209848  1.1201086  1.0278081  0.9247626  1.1247627  1.0401586
 1.0255684  1.036596   1.0254083  1.0285083  0.9262247  1.1262246
 1.0285063  1.0282552  0.9259812  1.1259812  6.3553877  1.0324284
 0.9243279  1.1243279  1.0240713  0.92338693 1.123387   1.0231539
 0.9240229  1.124023   1.0278612  0.9257633  1.1257633  1.0232537
 0.9255815  1.1255815  1.0695714  0.93042076 1.1304208  0.9228959
 1.1228958  1.0234536  0.93572253 1.1357225  1.0240799  0.9898892
 1.1898892  1.1369705  1.3369708  0.4207955  1.0270239  1.0221235
 1.0241214  1.0230037  0.42079544 0.9339875  1.1339877  1.1406455
 0.96048504 1.160485   0.42110327 0.42079577 0.9316984  1.1316985
 0.42110327 0.9232032  1.1232032  1.0228782  0.4209849  1.0282315
 0.42079642 0.4208821  1.0270476  1.0345651  0.92336106 1.1233611
 1.0298882  0.92495894 1.124959   1.0846193  1.0440264  0.92622155
 1.1262215  1.0347314  0.9287089  1.128709   1.0339328  1.0294806
 0.9244495  1.1244495  1.0279876  1.050058   0.9356032  1.1356032
 0.42079544 1.0530584  0.95872396 1.1587241  1.0229441  0.9228292
 1.1228292  0.9275017  1.1275016  1.0270725  0.92319953 1.1231996
 0.42079726 1.0227469  1.0270369  1.0461828  0.92277294 1.1227729
 0.4232262  1.027018   0.9262625  1.1262625  0.42079642 1.0991403
 0.4207955  1.0311463  1.0228261  1.0269278  1.0228804  1.0636855
 1.0229481  0.42079616 1.0278032  1.121729   1.0228028  1.022804
 1.0378149  1.0250497  1.0228273  0.4209849  1.0238203  1.0426689
 1.052838   1.0227438  1.022714   1.0238118  1.0227891  1.0685601
 0.42079642 1.032165   1.0231489  0.42079642 0.9277115  1.1277114
 0.42079642 1.1690165  1.1253995  1.0415053  0.42079616 1.0232948
 1.0326484  1.0229532  1.0286597  1.0283996  1.0295048  1.0305146
 1.0273467  1.0274502  1.0228475  0.42079622 1.0643328  1.0356063
 1.0315305  1.0228435  0.42079616 1.0232269  1.027653   0.4216221
 1.022963   1.0253085  1.0473031  1.0283118  1.023476   1.0273558
 1.0346721  1.0377613  1.0229648  1.0305403  0.42079642 0.42079642
 1.051431   1.0275228  0.92079645 1.0289807  1.0275983  1.0251255
 1.022941   1.0228888  0.92079645 0.92079645 0.9208825  1.0280628
 1.0229563  1.0288925  0.923534   1.123534   1.0229205  0.82715863
 1.3231537  0.92623925 1.121652   1.0219111  1.1211491  1.4225879
 1.0632169  1.0529841  0.42123273 0.9326682  1.1326683  0.9208118
 0.4208148  1.1248409  1.3212105  0.82121015 1.1222159  1.1214426
 1.0390722  0.4208395  0.43020412 1.1023904  1.0306264  1.025564
 1.0271894  1.0243013  1.0231197  1.4374523  1.0442772  1.0379032
 0.5244498  1.0435517  1.2435517  0.42123267 1.0370444  1.0300316
 1.0273306  1.0115199  1.5936412  1.0237637  1.0234748  0.46716818
 0.42104    1.0224104  1.4701596  0.32095772 1.1222883  0.9376537
 1.1376538  1.0671046  0.42077184 0.4208117  0.4208148  0.42083082
 1.033417   1.0391492  1.0232817  1.0247573  1.0291884  1.0372679
 0.42087892 0.924019   1.124019   1.0236158  6.2064376  0.42081937
 1.0282638  1.0255722  0.42623305 1.028798   1.068255   1.0253912
 0.9551741  1.1551741  1.0250896  1.1158397  0.9208561  1.026392
 1.0317894  1.2317894  1.1841377  0.9283212  1.1283212  1.03401
 1.0228226  1.0285995  1.0226289  1.0263397  1.0226281  1.0225991
 0.9672721  1.1672722  1.0226014  1.0260535  1.0231817  1.0227063
 1.0243635  1.0245756  1.0219222  0.9243889  1.1243889  0.9306167
 1.1306167  0.923137   1.123137   0.9775497  1.1775496  1.0227065
 1.0242245  1.0241146  1.0281508  1.1215137  1.0396904  0.82128966
 7.7292185  1.0223083  1.0260754  1.0224816  1.1210353  0.42079616
 1.0270913  1.0228055  1.0773846  0.42098445 1.0229411  0.9233221
 1.1233221  5.3046274  0.9218314  1.036112   0.43016532 1.3771734
 0.42079642 1.0854313  1.110196   0.42079547 1.0296868  0.9520887
 1.1520889  0.4207958  0.9452404  1.1452404  1.0227591  0.9255383
 1.1255383  1.1336367  1.0339528  1.0218269  1.036558   1.0494878
 1.2494879  1.0230106  0.9227564  1.1227564  1.02286    0.9228376
 1.1228377  1.280183   1.0227509  0.9249915  1.0231218  1.3199922
 1.0228481  0.9308825  1.1308825  1.0229716  0.9207561  1.1286715
 0.92127043 1.0420095  0.9776632  1.1776632  0.4209845  1.0345687
 0.92265105 1.1226512  1.6231595  1.02305    0.42151812 1.0649512
 1.0588461  1.065414   1.1144125  1.0292737  0.92463183 1.1246319
 0.42079726 1.0334882  0.9224146  1.1224147  1.1727182  1.0227898
 1.0304579  1.0229326  1.0226932  1.0835916  1.0272338  0.92347676
 1.1234767  1.0575095  1.0273803  1.0230418  0.9250392  1.1250392
 0.4207957  1.051446   0.9245814  1.1245815  0.921243   1.0567405
 0.9224849  1.1224848  0.42098492 1.0332311  1.0274898  1.0274061
 0.92260253 1.1226026  1.0234818  0.9223524  1.1223524  1.027651
 1.0286661  0.9226262  1.1226262  0.42098516 0.92241025 1.1224103
 0.9222559  1.1222559  1.0436673  0.9353514  1.1353513  0.92240214
 1.1224022  1.0243659  0.9223997  1.1223997  0.92263526 1.1226352
 0.9305744  1.1305743  1.0227456  0.92829967 1.1282997  1.0233083
 0.92760855 1.1276085  0.92320067 1.1232007  0.92693394 1.126934
 0.9252455  1.1252456  0.92484283 1.1248428  1.0226927  1.0232134
 1.0229567  1.027994   0.97172904 1.1717291  1.0273782  1.0274277
 0.92613924 1.1261393  0.92335767 1.1233577  0.95457125 1.1545712
 1.0228493  1.0233078  1.1238676  1.1293583  0.9377905  1.1377906
 0.942713   1.1427131  1.022864   0.9219221  1.1219221  0.93646735
 1.1364673  0.84281975 0.8207583  0.9208681  0.9207601 ]
2025-06-03 10:10:23,758 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101023_update_5.json
2025-06-03 10:10:23,758 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:23,765 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101023_update_5.pth and as latest_checkpoint.pth
2025-06-03 10:10:23,765 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.3255
2025-06-03 10:10:23,765 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-03 10:10:23,765 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.6461, MLP Score: 0.4688
2025-06-03 10:10:23,765 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.2066, MLP Score: 0.4885
2025-06-03 10:10:23,765 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.3032, MLP Score: 0.4935
2025-06-03 10:10:23,765 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.2066, MLP Score: 0.4885
2025-06-03 10:10:23,765 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.1780, MLP Score: 0.4792
2025-06-03 10:10:23,765 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 10:10:23,766 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 9.0387, MLP Score: 0.4921
2025-06-03 10:10:23,766 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.3554, MLP Score: 0.5064
2025-06-03 10:10:23,766 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 6.2064, MLP Score: 0.5174
2025-06-03 10:10:23,766 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.7292, MLP Score: 0.5003
2025-06-03 10:10:23,766 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.3046, MLP Score: 0.5025
2025-06-03 10:10:23,766 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-03 10:10:23,766 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-03 10:10:23,766 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-03 10:10:23,777 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-03 10:10:23,782 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-03 10:10:23,782 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-03 10:10:23,782 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-03 10:10:23,789 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-03 10:10:23,797 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-03 10:10:23,797 - INFO - Processing node updates/additions.
2025-06-03 10:10:23,798 - INFO - Processing edge updates/additions.
2025-06-03 10:10:23,801 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:23,802 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:23,802 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:23,802 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:23,805 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-03 10:10:23,806 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:23,806 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-03 10:10:23,807 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-03 10:10:23,807 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:23,809 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 12
2025-06-03 10:10:23,809 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:23,809 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:23,810 - DEBUG - Shape of encoded categorical edge features: torch.Size([657, 3])
2025-06-03 10:10:23,810 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:23,810 - DEBUG - Shape of scaled numerical edge features: torch.Size([657, 7])
2025-06-03 10:10:23,810 - DEBUG - Final edge attributes tensor shape: torch.Size([657, 10])
2025-06-03 10:10:23,811 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:23,811 - INFO - Performing online update...
2025-06-03 10:10:23,811 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:23,812 - DEBUG - Updated RunningStats: new_mean=0.9676958419202868, new_var=2400000000163.3765, new_n=270
2025-06-03 10:10:23,812 - DEBUG - Updated RunningStats: new_mean=0.9444401802209211, new_var=2700000000018.078, new_n=300
2025-06-03 10:10:23,812 - DEBUG - Updated RunningStats: new_mean=1.0515749972685386, new_var=800000000039.366, new_n=90
2025-06-03 10:10:23,812 - DEBUG - Updated RunningStats: new_mean=1.0539865843913743, new_var=900000000001.273, new_n=100
2025-06-03 10:10:23,812 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:23,812 - DEBUG - Online update step: 1/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 2/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 3/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 4/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 5/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 6/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 7/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 8/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 9/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 10/50
2025-06-03 10:10:23,812 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,812 - DEBUG - Online update step: 11/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 12/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 13/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 14/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 15/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 16/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 17/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 18/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 19/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 20/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 21/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 22/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 23/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 24/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 25/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 26/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 27/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 28/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 29/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 30/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 31/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 32/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 33/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 34/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 35/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,813 - DEBUG - Online update step: 36/50
2025-06-03 10:10:23,813 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 37/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 38/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 39/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 40/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 41/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 42/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 43/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 44/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 45/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 46/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 47/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 48/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 49/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - DEBUG - Online update step: 50/50
2025-06-03 10:10:23,814 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:23,814 - WARNING - No successful steps during online update.
2025-06-03 10:10:23,815 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.3451008e-08  2.6056675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.3451008e-08
 -4.1039264e-08 -5.2113349e-09  1.8239673e-08 -4.4296350e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  5.2113349e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00 -2.0845340e-08 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.2570846e-08  2.6056675e-08], current edge mean: [ 5.2602739e+00  1.3805175e+00  4.7656012e+00  1.4515591e-09
  0.0000000e+00  2.9031182e-09 -1.4515591e-09 -6.5320158e-09
 -5.0804569e-09 -2.9031182e-09]
2025-06-03 10:10:23,815 - DEBUG - Node drift difference: 0.0954, Edge drift difference: 0.7187
2025-06-03 10:10:23,815 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:23,816 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.3451008e-08  2.6056675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.3451008e-08
 -4.1039264e-08 -5.2113349e-09  1.8239673e-08 -4.4296350e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  5.2113349e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00 -2.0845340e-08 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.2570846e-08  2.6056675e-08], edge=[ 5.2602739e+00  1.3805175e+00  4.7656012e+00  1.4515591e-09
  0.0000000e+00  2.9031182e-09 -1.4515591e-09 -6.5320158e-09
 -5.0804569e-09 -2.9031182e-09]
2025-06-03 10:10:23,816 - DEBUG - Updated reference std: node=[0.         0.         1.0013689  1.0013689  0.         0.
 0.         1.0013689  1.001369   1.0013689  1.001369   1.0013689
 1.1053125  0.31016898 0.38222542 0.589653   1.0013689  2.9452322
 2.8023348  1.5205975  0.38222542 0.         1.001369   1.001369
 0.         0.         0.         0.         1.0013689  1.0013689 ], edge=[1.2472489  0.49827543 2.0060513  1.0007619  1.0007619  1.0007619
 1.0007619  1.0007619  1.0007619  1.0007619 ]
2025-06-03 10:10:23,816 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:23,816 - INFO - Running anomaly detection...
2025-06-03 10:10:23,816 - INFO - Starting anomaly detection.
2025-06-03 10:10:23,850 - DEBUG - Node reconstruction errors: [0.38117716 0.391097   0.45175523 0.22332032 0.40213028 0.24040675
 0.3426013  0.44297302 0.8587791  0.27426517 0.5963938  0.1829427
 0.4999182  0.44263932 0.42602804 1.0373976  0.28466353 0.2821159
 0.21095991 0.5410109  0.28212738 0.5569052  0.51201403 1.5496447
 1.7301046  0.78131    0.27954635 0.45188    0.288446   0.6532919
 0.21483041 0.78132784 1.1617019  1.2312254  1.2789595  1.1646934
 2.4015396  0.5774585  1.0601686  0.83615243 0.6776602  0.6087335
 1.6055278  0.44256705 0.433925   0.70730084 4.923833   0.4211421
 0.64385384 0.53637326 1.3613969  0.51235425 0.48859498 0.57745785
 0.7813062  0.41127923 0.6829205  0.6878789  0.98393816 1.1566073
 2.4015396  1.4733752  1.3482928  0.41228393 1.1566077  0.42284822
 1.6773921  0.5120126  0.5376475  0.6428889  0.76320684 0.60236007
 1.5516714  0.39115435 2.4685779  0.86384696 0.5363733  0.42125034
 0.8576926  0.5049222  0.3922744  0.3781733  0.27954376 0.4425691
 0.52101237 0.58112794 0.31025514 1.4495158  0.7068989  0.44143298
 0.23487346 1.4031188  0.22876762 0.43244284 0.2752357  2.5755544
 0.21930043 0.40249184 0.37607607 0.25127    0.40249664 0.21929917
 0.2940355  0.54908967 1.0794715  0.26022813 0.2827664  0.89194375
 0.21192406 1.0411866  0.6753388  0.23764987 1.1151586  1.1239666
 0.4500475  0.40298483 0.4732294  1.3377973  0.43128905 0.18778427
 0.24589542 0.22876889 1.1410007  0.97435445 0.3620465  0.18778287
 0.9803511  0.73151845 0.4025355  0.22012943 0.36278376 0.18782526
 0.24301927 1.367949   0.40247324 0.25959122 0.43923303 0.3848526
 0.18809655 0.4024777  0.188324   0.49115217 0.2301887  0.18784621
 0.24403144 0.40288517 0.40248874 0.18816687 0.34334722 0.4314127
 1.0137861  1.0794997  0.62521476 0.18782637 0.42757532 1.3509223
 0.18782799 0.34792948 0.4024873  0.25594947 0.19025391 0.87894565
 0.18778346 0.3628243  0.41688374 1.1504004  0.62999725 0.4313971
 0.73541987 0.40271404 0.4314173  0.16932258 0.23018882 1.7442223
 0.40249732 0.19556744 0.40255338 0.33447143 0.3545142  0.35450828
 0.255932   1.0281415  0.23923467 1.1265062  0.2576293  0.3348745
 0.22147931 0.36073157 0.22147961 0.18135282 0.17284207 0.35387352
 0.20721136 0.1694639  0.23018932 0.20717175 0.21686703 0.23018858
 1.3215525  0.21930018 0.3848533  0.18782099 1.1254764  0.4315862
 0.3536139  0.22876762 0.44657668 1.145322   0.394522   0.601411
 0.45161614 0.35450333 0.20717862 0.40247428 0.33450237 0.23018861
 0.33446783 0.41683617 0.40706977 0.16942208 1.1691192  0.22147886
 0.22147976 0.20717819 0.18778299 0.36529827 0.3347302  0.18778321
 0.40736932 0.22876833 0.97435504 0.35454816 0.40247753 0.41697317
 0.41683802 0.20717174 0.36525735 0.22147886 0.1877828  0.22016421
 1.3984468  0.593613   0.18139844 0.37159786 0.18145268 0.40246215
 0.35484084 0.33451363 0.18139938 0.1825317  0.23019065 0.23019075
 0.4070119  0.431295   0.41689345 0.41691273 0.18135339 0.37782234
 0.2214861  0.1814049  0.5853227  0.25810957 0.25810957 0.18135364
 0.1813716  0.27524063 0.5847896  0.25810957 0.5848496  0.2071983
 0.25762922 0.25762922 0.4819475  0.43089947 0.58476907 0.20718136
 0.22148027 0.20719177 0.2560754  0.1813975  0.36522445 0.22148006
 0.22453551 0.41582277 0.18137357 0.3708553  1.2289485  0.93171847
 1.028141   0.22333704 0.27526677 0.22454067 0.3069908  0.18140198
 0.22327028 0.37781566 0.18140809 0.22151743 0.20717183 0.25982365
 0.23238434 0.38651276 0.38649452 0.38649464 0.38649943 0.3864961
 0.38649604 0.38649464 0.3864964  0.38652566 0.38649696 0.38649857
 0.38649952 0.23237845 0.45583495 0.29478198 0.39971793 0.2969623
 0.23237967 0.21335357 0.37787393 0.3778138  0.36550108 0.38649467
 0.22147942 0.79510516 0.3796284  0.38649553 0.630697   0.5848714
 0.5781015  0.2323785  0.38669235 0.5847884  0.38650095 0.3864971
 0.18851379 0.22147998 0.37960565 0.37961376 0.4434869  0.22323653
 0.37960657 0.5847874  0.38649854 0.58484304 0.3865003  0.38224745
 0.5535866  0.22455838 0.38660863 0.17275126 0.25763002 0.2986118
 0.23036727 0.20717803 0.3865067  0.3864946  0.37781382 0.3778163
 0.33452508 0.38650414 0.37960526 0.3864946  0.38649446 1.2245088 ]
2025-06-03 10:10:23,852 - DEBUG - Edge reconstruction errors: [ 0.02643006  1.1272296   1.1316661   1.2937455   1.4937457   0.5259709
  1.128715   10.781014    0.8264333   1.4437234   1.5437236   1.2286692
  1.2396408   1.2182825   1.1326089   1.1287547   1.2261711   1.1312019
  0.52615106  1.211083    1.1322939   1.0295523   1.2295525   1.1417838
  1.1301011   1.1382594   1.13001     1.1328235   1.0411656   1.2411656
  1.1327305   1.1326392   1.0306393   1.2306393   7.6144824   1.1359046
  1.029132    1.229132    1.128807    1.0283157   1.2283157   1.128129
  1.0351856   1.2351856   1.1325196   1.0382562   1.2382561   1.128205
  1.0379688   1.2379688   1.1700578   1.0345788   1.2345787   1.0279924
  1.2279924   1.128343    1.0503278   1.2503277   1.1288269   1.0801256
  1.2801257   1.205986    1.4059861   0.5259711   1.1317965   1.1270958
  1.1286136   1.1279579   0.5259711   1.0377266   1.2377268   1.2221338
  1.0903119   1.2903119   0.5262649   0.5259713   1.0359886   1.2359886
  0.5262647   1.127867    1.0362741   1.236274    1.1278445   0.5261511
  1.1325691   0.5259717   0.5260524   1.131656    1.1384268   1.0282402
  1.2282403   1.1341149   1.0297008   1.2297008   1.183518    1.1470578
  1.0309478   1.2309479   1.1384251   1.0331703   1.2331704   1.1378242
  1.1335574   1.0292536   1.2292538   1.1323725   1.1490549   1.0379618
  1.2379619   0.5259711   1.1551608   1.056248    1.2562481   1.1279004
  1.0278331   1.227833    1.0319735   1.2319736   1.1386195   1.0281171
  1.2281172   0.4259715   1.1314795   1.1316303   1.1484962   1.0337459
  1.2337459   0.5282822   1.1316272   1.0311203   1.2311205   0.5259717
  1.1886445   1.0445988   1.2445989   0.5259712   1.1349348   1.1278244
  1.1315738   1.127862    1.1625797   1.1279093   1.0288178   1.2288177
  0.52597106  1.1322279   1.0996467   1.2996467   1.2268386   1.1278021
  1.1278032   1.1414279   1.129615    1.1278254   0.5261511   1.1287594
  1.1458457   1.1551248   1.1277477   1.127719    1.1413065   1.1277897
  1.1690167   1.0299737   1.2299738   0.52597123  1.0298065   1.2298065
  1.1349436   1.0346929   1.234693    1.1281241   0.5259717   1.0323153
  1.2323152   0.5259711   1.035634    1.2356341   1.2455088   1.0292083
  1.2292085   1.23029     1.1448244   0.52597153  1.128252    1.1369085
  1.1279231   1.1329983   1.0290915   1.2290915   1.1327844   1.0281901
  1.2281902   1.1335975   1.0288049   1.2288051   1.1344577   1.0289508
  1.2289509   1.1319358   1.1320344   1.1278355   1.0367725   1.2367724
  0.5259711   1.1639369   1.0285348   1.2285349   1.1392951   1.0278167
  1.2278167   1.1430643   1.1278188   1.039517    1.2395171   0.52597153
  1.1281877   1.132228    0.52675706  1.1279202   1.1297953   1.1685394
  1.1327761   1.1284273   1.1318854   1.1384903   1.1409985   1.1278987
  1.1344762   0.5259717   0.5259717   1.150252    1.131981    1.0259719
  1.1332663   1.1382432   1.1296216   1.1278982   1.1278422   1.0259719
  1.0259719   1.0260526   1.1325552   1.1279076   1.1334034   1.0284085
  1.2284085   1.1278777   1.1322004   1.2264655   0.5259716   1.1522639
  2.003718    1.1322529   1.1282581   1.1332915   1.0478674   1.2478675
  1.0331212   1.2331214   0.5261513   1.131536    1.1489283   1.1699915
  1.1287905   0.52623105  1.1316735   1.127779    1.1351956   1.1316205
  1.029924    1.2299241   1.127901    0.83184576  1.4281509   0.93098414
  1.2267461   1.1269692   1.226289    1.5276216   1.4126799   1.2131943
  0.526384    1.0368154   1.2368155   1.1274029   1.0259857   0.5259878
  1.2297482   1.4263582   0.82635796  1.2272594   1.2265579   1.1424494
  0.5260132   1.1281561   0.5343837   1.1982448   1.134702    1.1302583
  1.1311247   1.129214    1.1280777   1.5231221   1.1477797   1.1414992
  0.6292894   1.1389354   1.3389355   0.526384    1.1408211   1.3040469
  1.13184     1.0975357   1.5844452   1.1286978   1.1404035   0.567757
  0.5261991   1.130174    1.4890054   0.32612798  1.2272362   1.0414073
  1.2414074   1.3082466   0.5259474   0.52598554  0.5259878   0.5260032
  1.1476126   1.1456718   1.1531807   1.1279838   1.129462    1.1336565
  1.1591872   0.5260493   1.0366741   1.2366742   1.1305988   1.1282272
  5.0874963   0.5259911   1.1435834   1.1302997   0.5311359   1.1331182
  1.1664641   1.1298572   1.116607    1.316607    1.1299604   1.1990191
  1.0260302   1.1360977   1.1130179   1.313018    1.2504922   1.032469
  1.2324691   1.1367337   1.1277671   1.1489927   1.3344332   1.1541278
  1.1776937   1.136781    1.0686382   1.2686383   1.1373124   1.1509233
  1.1281555   1.1323514   1.0314891   1.2314892   1.1292216   1.1433455
  1.1310309   1.0290856   1.2290857   1.1284798   1.0342405   1.2342405
  1.1369421   1.0280654   1.2280655   1.1347128   1.0705477   1.2705476
  1.1815087   1.1290991   1.1290214   1.1326323   1.0441701   1.2441701
  1.1317661   1.0307667   1.2307668   1.1472149   1.0290167   1.2290167
  1.1326885   1.0295398   1.2295398   1.1313579   1.0309336   1.2309337
  1.1316861   1.1479377   1.0325307   1.2325307   1.1386169   1.1277614
  1.1786089   1.1275545   1.1298287   1.1323559   1.133445    1.13179
  1.1325006   1.1390215   1.132031    1.0279665   1.2279665   0.52800244
  1.1309333   1.1345097   1.130019    1.1310422   1.1276104   1.3362584
  1.1370218   1.1299103   1.131517    1.1501685   1.1413529   1.1276482
  1.12828     1.1278062   1.1304681   1.2232852   1.127631    1.1286908
  1.1293976   1.1285934   1.1281013   1.1273237   6.024065    1.1289382
  1.1371405   1.1282814   1.1305366   1.1276519   1.1278465   1.1275785
  1.1279655   1.1397622   1.2266253   1.1430148   0.8264333   7.3193803
  1.1272441   1.1303746   1.1273743   1.2261933   0.5259715   1.1281675
  1.1378793   1.1277995   1.1714448   0.5261508   1.1323103   1.0282278
  1.228228    5.07997     1.0269513   1.1384443   0.5348797   1.4457111
  0.5259717   1.184247    1.2329873   0.5259711   1.1337854   1.0511318
  1.251132    0.5259713   1.044839    1.2448391   1.1277384   1.030169
  1.230169    1.2492324   1.1378714   1.1268562   1.138508    1.1289265
  1.3289267   1.1279571   1.0276986   1.2276987   1.1278354   1.0278295
  1.2278296   1.8263838   1.132331    1.0299472   1.2269073   1.1280969
  1.3962958   1.127823    1.034581    1.234581    1.127907    1.0259339
  1.2393286   1.0264202   1.1423823   1.069541    1.2695409   0.5261509
  1.1367433   1.0275626   1.2275628   1.7280875   1.1279837   0.5266555
  1.1660725   1.1605929   1.0289503   1.2289504   1.166512    1.2105547
  1.0295827   1.2295829   1.1336135   1.029418    1.229418    0.4259715
  1.13664     1.0274589   1.227459    1.2599226   1.0314256   1.2314258
  1.1277825   1.134299    1.1278983   1.1277095   1.0314173   1.2314173
  1.1826077   1.1317945   1.0283839   1.228384    1.1594859   1.1319327
  1.1279709   1.0297725   1.2297727   0.5259713   1.1540586   1.029556
  1.2295561   1.0263938   1.1582549   1.0274582   1.2274582   0.5261512
  1.1372935   1.1320716   1.1319929   1.0275928   1.2275928   1.1284096
  1.027345    1.2273451   1.1321687   1.0277404   1.2277404   1.1329851
  1.0275453   1.2275455   0.5261513   1.0274065   1.2274066   1.0272592
  1.2272594   1.1468345   1.0388075   1.2388076   1.0273877   1.2273879
  1.1291963   1.0273856   1.2273856   1.0275807   1.2275808   1.0344622
  1.2344624   1.1277521   1.0325729   1.232573    1.1282054   1.0319511
  1.2319512   1.0280821   1.2280823   1.031635    1.2316352   1.0295775
  1.2295775   1.0297055   1.2297055   1.1276938   1.1281768   1.1279393
  1.1324663   1.0274731   1.2274733   1.0656558   1.265656    1.1319653
  1.1320134   1.0308828   1.2308829   1.028288    1.228288    1.0522279
  1.252228    1.1278136   1.1282079   1.2288452   1.2338703   1.0396754
  1.2396754   1.0597186   1.2597187   0.32731044  1.1278383   1.0270013
  1.2270013   1.0383371   1.2383372   1.1280428   1.0277063   1.2277063
  1.0321062   1.2321062   1.23032     0.9466183   0.925936    1.0260416
  1.0259374   0.02592839  0.02592878]
2025-06-03 10:10:23,853 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101023_update_6.json
2025-06-03 10:10:23,853 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:23,858 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101023_update_6.pth and as latest_checkpoint.pth
2025-06-03 10:10:23,858 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.3249
2025-06-03 10:10:23,858 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-03 10:10:23,858 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.7301, MLP Score: 0.4712
2025-06-03 10:10:23,858 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.4015, MLP Score: 0.4850
2025-06-03 10:10:23,858 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.9238, MLP Score: 0.4866
2025-06-03 10:10:23,858 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.4015, MLP Score: 0.4850
2025-06-03 10:10:23,858 - WARNING -   Node ID: 43.132.85.151, Recon Error: 1.6774, MLP Score: 0.4841
2025-06-03 10:10:23,858 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 10:10:23,858 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 10.7810, MLP Score: 0.4841
2025-06-03 10:10:23,858 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 7.6145, MLP Score: 0.4999
2025-06-03 10:10:23,858 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.0875, MLP Score: 0.5244
2025-06-03 10:10:23,858 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 6.0241, MLP Score: 0.5250
2025-06-03 10:10:23,858 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.3194, MLP Score: 0.4996
2025-06-03 10:10:23,858 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:23,858 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:23,859 - INFO - Starting visualization of node features.
2025-06-03 10:10:23,859 - INFO - Graph has 366 nodes and 30 features.
2025-06-03 10:10:23,859 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:23,859 - INFO - Calculating feature statistics:
2025-06-03 10:10:23,859 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,859 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,859 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(-4.169068e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5098004), 'max': np.float32(1.2227579)}
2025-06-03 10:10:23,860 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(4.169068e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2045138), 'max': np.float32(2.5324697)}
2025-06-03 10:10:23,860 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,860 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,860 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,860 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(5.211335e-09), 'std': np.float32(1.0), 'min': np.float32(-0.34037283), 'max': np.float32(2.937955)}
2025-06-03 10:10:23,860 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.9507683e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1667435), 'max': np.float32(0.8570864)}
2025-06-03 10:10:23,860 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(1.042267e-08), 'std': np.float32(0.9999999), 'min': np.float32(-6.655533), 'max': np.float32(0.15411638)}
2025-06-03 10:10:23,860 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(-2.084534e-08), 'std': np.float32(1.0), 'min': np.float32(-3.477314), 'max': np.float32(0.8536967)}
2025-06-03 10:10:23,860 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.8442478), 'max': np.float32(3.5091558)}
2025-06-03 10:10:23,860 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 6, 'mean': np.float32(2.5655737), 'std': np.float32(1.1038015), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:23,860 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9508197), 'std': np.float32(0.30974498), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:23,860 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14480874), 'std': np.float32(0.38170287), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:23,860 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.387978), 'std': np.float32(0.5888469), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:23,860 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-1.042267e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.15411638), 'max': np.float32(6.655533)}
2025-06-03 10:10:23,860 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.0710382), 'std': np.float32(2.9412057), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:23,861 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.0846996), 'std': np.float32(2.7985039), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:23,861 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5983605), 'std': np.float32(1.5185188), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:23,861 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14480874), 'std': np.float32(0.38170287), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:23,861 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:10:23,861 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.084534e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14313397), 'max': np.float32(11.946181)}
2025-06-03 10:10:23,861 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-0.15877683), 'max': np.float32(6.298148)}
2025-06-03 10:10:23,861 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,861 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,861 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,861 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:23,861 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-0.96676147), 'max': np.float32(8.344678)}
2025-06-03 10:10:23,861 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0877768), 'max': np.float32(4.3412185)}
2025-06-03 10:10:23,875 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c2ec0c50>
2025-06-03 10:10:24,011 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:24,070 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:24,100 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:25,321 - INFO - Node feature visualization saved to vis/node_features_20250603_101024.png
2025-06-03 10:10:25,321 - INFO - Finished visualization of node features.
2025-06-03 10:10:25,321 - INFO - Performing additional feature analysis:
2025-06-03 10:10:25,321 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:25,322 - INFO - Starting visualization of edge features.
2025-06-03 10:10:25,322 - INFO - Graph has 657 edges and 10 edge features.
2025-06-03 10:10:25,322 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:25,322 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:25,322 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:25,322 - INFO - - count: {'name': 'count', 'unique': 12, 'mean': np.float32(5.260274), 'std': np.float32(1.2462993), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:25,322 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.3805175), 'std': np.float32(0.49789605), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:25,322 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.765601), 'std': np.float32(2.004524), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-03 10:10:25,322 - INFO - - service: {'name': 'service', 'unique': 18, 'mean': np.float32(-1.4515591e-09), 'std': np.float32(1.0), 'min': np.float32(-0.07790402), 'max': np.float32(17.56882)}
2025-06-03 10:10:25,322 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 441, 'mean': np.float32(7.2577953e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12065887), 'max': np.float32(17.925482)}
2025-06-03 10:10:25,322 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 478, 'mean': np.float32(2.9031182e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11201595), 'max': np.float32(17.534716)}
2025-06-03 10:10:25,322 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 170, 'mean': np.float32(1.4515591e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09598722), 'max': np.float32(17.402863)}
2025-06-03 10:10:25,323 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 447, 'mean': np.float32(-5.8062364e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11106191), 'max': np.float32(19.272167)}
2025-06-03 10:10:25,323 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 467, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.113993295), 'max': np.float32(18.993053)}
2025-06-03 10:10:25,323 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 182, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.10933003), 'max': np.float32(17.167276)}
2025-06-03 10:10:25,333 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c306f830>
2025-06-03 10:10:25,406 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:25,534 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c16f8f50>
2025-06-03 10:10:25,619 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:25,716 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:25,810 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:25,825 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:25,831 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:27,053 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101025.png
2025-06-03 10:10:27,053 - INFO - Finished visualization of edge features.
2025-06-03 10:10:27,054 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:27,054 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-03 10:10:27,054 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:27,054 - INFO - Graph has 657 edges and 10 edge features.
2025-06-03 10:10:27,054 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:27,380 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101027_summary.png
2025-06-03 10:10:27,583 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101027_pca_3d.png
2025-06-03 10:10:27,743 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101027_pca_variance.png
2025-06-03 10:10:27,743 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:27,744 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-03 10:10:27,744 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-03 10:10:27,744 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-03 10:10:27,816 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-03 10:10:27,823 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-03 10:10:27,823 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-03 10:10:27,824 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-03 10:10:27,830 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-03 10:10:27,837 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-03 10:10:27,837 - INFO - Processing node updates/additions.
2025-06-03 10:10:27,839 - INFO - Processing edge updates/additions.
2025-06-03 10:10:27,842 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:27,843 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:27,843 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:27,843 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:27,846 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-03 10:10:27,848 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:27,848 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-03 10:10:27,849 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-03 10:10:27,849 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:27,851 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 13
2025-06-03 10:10:27,852 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:27,852 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:27,853 - DEBUG - Shape of encoded categorical edge features: torch.Size([753, 3])
2025-06-03 10:10:27,854 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:27,854 - DEBUG - Shape of scaled numerical edge features: torch.Size([753, 7])
2025-06-03 10:10:27,854 - DEBUG - Final edge attributes tensor shape: torch.Size([753, 10])
2025-06-03 10:10:27,854 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:27,855 - INFO - Performing online update...
2025-06-03 10:10:27,855 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:27,855 - DEBUG - Updated RunningStats: new_mean=0.9640086983986977, new_var=3000000000161.261, new_n=330
2025-06-03 10:10:27,855 - DEBUG - Updated RunningStats: new_mean=0.9453092965718037, new_var=3300000000018.869, new_n=360
2025-06-03 10:10:27,855 - DEBUG - Updated RunningStats: new_mean=1.062576239182118, new_var=1000000000039.7682, new_n=110
2025-06-03 10:10:27,856 - DEBUG - Updated RunningStats: new_mean=1.0629562765036356, new_var=1100000000001.1294, new_n=120
2025-06-03 10:10:27,856 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:27,856 - DEBUG - Online update step: 1/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 2/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 3/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 4/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 5/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 6/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 7/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 8/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 9/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 10/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 11/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 12/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 13/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 14/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 15/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 16/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 17/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 18/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 19/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 20/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 21/50
2025-06-03 10:10:27,856 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,856 - DEBUG - Online update step: 22/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 23/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 24/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 25/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 26/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 27/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 28/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 29/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 30/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 31/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 32/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 33/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 34/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 35/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 36/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 37/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 38/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 39/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 40/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 41/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 42/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 43/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 44/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 45/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 46/50
2025-06-03 10:10:27,857 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,857 - DEBUG - Online update step: 47/50
2025-06-03 10:10:27,858 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,858 - DEBUG - Online update step: 48/50
2025-06-03 10:10:27,858 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,858 - DEBUG - Online update step: 49/50
2025-06-03 10:10:27,858 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,858 - DEBUG - Online update step: 50/50
2025-06-03 10:10:27,858 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,858 - WARNING - No successful steps during online update.
2025-06-03 10:10:27,858 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.1895584e-08  1.0339582e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.9194112e-08
 -3.2843374e-08  1.2164214e-08  3.6492640e-08 -1.2164214e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  8.5149496e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00  7.2985280e-09 -1.0643687e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0947792e-08  0.0000000e+00], current edge mean: [ 5.2563081e+00  1.4037185e+00  4.8247013e+00  5.0659992e-09
  0.0000000e+00 -2.5329996e-09  0.0000000e+00  3.1662495e-09
 -4.4327493e-09  1.0131998e-08]
2025-06-03 10:10:27,858 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0466
2025-06-03 10:10:27,859 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.1895584e-08  1.0339582e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.9194112e-08
 -3.2843374e-08  1.2164214e-08  3.6492640e-08 -1.2164214e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  8.5149496e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00  7.2985280e-09 -1.0643687e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0947792e-08  0.0000000e+00], edge=[ 5.2563081e+00  1.4037185e+00  4.8247013e+00  5.0659992e-09
  0.0000000e+00 -2.5329996e-09  0.0000000e+00  3.1662495e-09
 -4.4327493e-09  1.0131998e-08]
2025-06-03 10:10:27,859 - DEBUG - Updated reference std: node=[0.         0.         1.0012779  1.0012779  0.         0.
 0.         1.001278   1.0012779  1.0012779  1.0012779  1.0012779
 1.0559748  0.29992953 0.37355423 0.58165294 1.0012779  3.045268
 2.8914173  1.55179    0.37355423 0.         1.0012779  1.0012779
 0.         0.         0.         0.         1.0012779  1.0012779 ], edge=[1.2309898  0.50168544 1.9340388  1.0006647  1.0006647  1.0006646
 1.0006647  1.0006647  1.0006647  1.0006647 ]
2025-06-03 10:10:27,859 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:27,859 - INFO - Running anomaly detection...
2025-06-03 10:10:27,859 - INFO - Starting anomaly detection.
2025-06-03 10:10:27,877 - DEBUG - Node reconstruction errors: [0.44577762 0.43425187 0.4581622  0.2596884  0.4817424  1.1134472
 0.37470266 0.38411605 0.90818536 0.31119496 0.6789008  0.21155183
 0.50883424 0.5081183  0.48728758 1.1316394  0.3304709  0.3536233
 0.26979905 0.60748893 0.30790398 0.6273838  0.58473426 1.6488332
 1.7945064  0.8644616  0.32104728 0.43286487 0.31614888 0.72576386
 0.2500378  0.8644769  1.2284838  1.3621275  1.3646438  1.1997311
 2.5544326  0.65684295 1.1804099  0.8562201  0.7605883  0.6462676
 1.8936626  0.5080563  0.44923598 0.696051   5.2530384  0.48589596
 0.7319143  0.6080545  1.4657408  0.5850474  0.5573302  0.6568423
 0.864458   0.46693882 0.7632292  0.711878   0.9760283  1.2675933
 2.5544326  1.5233465  1.3909509  0.4657715  1.2675935  0.48169985
 1.8383964  0.5847329  0.6093224  0.7176869  0.8288861  0.65760225
 1.6337616  0.39731964 2.4815826  0.89725214 0.60805446 0.8559664
 0.9010839  0.5396702  0.43723658 0.43265676 0.3210444  0.5080577
 0.5520149  0.6260204  0.3606797  1.5320232  0.7295964  0.5756045
 0.27311173 1.3856472  0.25606748 0.43766534 0.3100191  2.7596695
 0.25294772 0.46626514 0.42741165 0.28536716 0.46626922 0.25294647
 0.315011   0.6309067  1.1337752  0.29569495 0.3103458  0.9344961
 1.0119866  1.0891628  0.747181   0.26443046 1.1572982  1.2124726
 0.46829617 0.46676978 0.5459818  1.3346423  0.43523198 0.21901895
 0.27430147 0.25606906 1.1724358  1.0163187  0.36608282 0.21901768
 1.0270512  0.7777306  0.4663042  0.24940516 0.391149   0.2190628
 0.2756714  1.4113277  0.4662483  0.29502374 0.47489214 0.44119072
 0.19688554 0.46625212 0.21960348 0.5409924  0.26907915 0.19658136
 0.1965106  0.46662557 0.4241899  0.21943071 0.38389388 0.43534172
 1.0913546  1.1339515  0.6551027  0.21906403 0.4410712  1.3034791
 0.21906717 0.38550833 0.46626082 0.2871293  0.22171597 0.914032
 0.2190184  0.39118707 0.42415828 1.1832538  0.71800804 0.40085295
 0.7819048  0.4664666  0.4353613  0.19629122 0.26907924 1.8758968
 0.40078843 0.22883266 0.40083116 0.39523295 0.40629777 0.4062924
 0.28700104 1.0719618  0.26811895 1.1702696  1.2068032  0.40649167
 0.25729915 0.41401282 0.25729907 0.20944862 0.39712903 0.35381794
 0.22511902 0.19644047 0.27150908 0.22508296 0.25197628 0.2690792
 1.2847816  0.2529472  0.44119105 0.21905808 1.191106   0.40128854
 0.41812643 0.25606748 0.48027828 1.1744205  0.44037578 0.61806315
 0.49430093 0.40628812 0.22508918 0.40577754 0.406294   0.26907924
 0.3952309  0.4888401  0.45691064 0.1963964  1.2206999  0.25457874
 0.25729927 0.22508886 0.21901752 0.366067   0.40640837 0.21901745
 0.39571765 0.2560684  1.0163189  0.40633163 0.4662523  0.42420292
 0.488841   0.22508281 0.36603573 0.25729877 0.2190171  0.24943693
 1.3176132  0.61779237 0.20949516 0.42414907 0.2095494  0.4662383
 0.4066256  0.39527386 0.2094962  0.2044864  0.26908112 0.2690813
 0.4568548  0.43523636 0.48889488 0.48891503 0.20944947 0.43028313
 0.25730494 0.40629545 0.62152696 0.28200296 0.28200296 0.20944987
 0.39568096 0.31184533 0.53833103 0.28200296 0.5385687  0.4064075
 1.1995567  1.206791   0.48223022 0.46846807 0.66108817 0.40630493
 0.25729942 0.48052946 0.28714654 0.4063017  0.3308242  0.2655855
 0.3957883  0.45897707 0.20947167 0.41655332 1.2800714  0.9584083
 1.0719613  0.9005973  0.31178397 0.2553     0.34376138 0.20949827
 0.25483525 0.43027762 0.40629426 0.4086732  0.22508292 0.28919467
 0.21112986 0.43477818 0.43472004 0.43471977 0.43473938 0.43472144
 0.43472168 0.43471992 0.4347296  0.43474752 0.43472257 0.6795241
 0.43472493 0.2464149  1.2525796  0.3324393  0.44690913 0.31741711
 0.2464164  0.22649054 0.43032983 0.43027624 0.31937414 0.43471974
 0.25729913 0.8390005  0.42679876 0.6795523  0.6204286  0.6205181
 0.6025636  0.24641491 0.43488935 0.66110605 0.43472585 0.6795105
 0.21103565 0.25729945 0.42677918 0.42678723 0.49840853 0.254802
 0.42677987 0.6204092  0.43472397 0.6611623  0.43472475 0.42244104
 0.58045095 0.2553162  0.4349319  0.1940505  0.2814775  0.3464339
 0.26355466 0.22508885 0.43474805 0.43471992 0.4302761  0.43027797
 0.3952869  0.43472818 0.42677897 0.4347202  0.43472    1.3533896
 0.25935334 0.34653953 0.2109959  0.25935838 0.40968686 0.21117224
 0.21098949 0.21113962 0.40955743 0.43471983 0.2602859  0.41491228
 0.3374037  0.4347214  0.40309492 0.2109908  0.21099286 0.2695197
 0.21099009 0.34670216 0.29168794 1.2489535  0.59658414 0.43475455
 0.31034413 0.34642926]
2025-06-03 10:10:27,880 - DEBUG - Edge reconstruction errors: [ 0.02639873  1.1271579   1.1310663   1.5427341   1.7427342   0.5260349
  1.128616   10.104327    0.8264122   1.4406633   1.5406635   1.2282574
  1.2373191   1.2036525   1.1321499   1.1286596   1.2262001   1.1306045
  0.5261795   1.2007519   1.1313548   1.0290469   1.2290468   1.1404973
  1.1296307   1.137753    1.1295165   1.1318719   1.0387193   1.2387195
  1.1318585   1.1316859   1.0299692   1.2299693   6.592184    1.134783
  1.0287126   1.2287127   1.1285028   1.0280029   1.228003    1.1278285
  1.0337981   1.2337983   1.1314198   1.036564    1.2365642   1.127902
  1.1017864   1.3017865   1.1630512   1.0333301   1.23333     1.027647
  1.2276471   1.1280483   1.0468737   1.2468737   1.1285121   1.0773396
  1.2773397   1.7837164   1.9837165   0.5260353   1.1307895   1.1270324
  1.1285087   1.1277097   0.5260353   1.0360267   1.2360266   1.2153023
  1.0872422   1.2872423   0.52626985  0.5260355   1.0343349   1.2343348
  0.5262697   1.1276325   1.0347465   1.2347467   1.1276146   0.5261796
  1.1316612   0.52603585  0.5261013   1.1307845   1.1364863   1.0279763
  1.2279762   1.1329255   1.029191    1.2291911   1.174455    1.1436788
  1.0301648   1.2301648   1.1365916   1.032049    1.232049    1.1360015
  1.1325899   1.0288068   1.2288067   1.1314794   1.1477802   1.0370834
  1.2370834   0.5260353   1.1505234   1.0714628   1.2714627   1.127664
  1.0275826   1.2275827   1.0311183   1.2311184   1.1278993   1.1365837
  1.0369992   1.2369993   0.4260363   1.1306262   1.1307746   1.1452441
  1.0416939   1.2416941   0.5278892   1.130762    1.0302149   1.230215
  0.52603585  1.1843693   1.0895523   1.2895525   0.5260353   1.1338367
  1.1488076   1.3488076   1.1275785   1.1306974   1.1276182   1.1582881
  1.1276678   1.0284216   1.2284217   0.5260353   1.1313422   1.0953729
  1.2953728   1.2267461   1.1275609   1.1275618   1.1389616   1.1292361
  1.1275793   0.52617955  1.1283385   1.1426493   1.1503798   1.1275159
  1.1274931   1.1388669   1.0301224   1.2301224   1.1275504   1.1622679
  1.0294302   1.2294303   0.5260354   1.029319    1.2293191   1.1344838
  1.0334573   1.2334573   1.1278248   0.5260355   1.0372806   1.2372806
  1.0312986   1.2312987   0.5260353   1.0339768   1.233977    1.2365344
  1.0288692   1.2288692   1.2295473   1.1417708   0.52603567  1.1279349
  1.1350615   1.1276728   1.131992    1.028653    1.2286532   1.1317977
  1.0279315   1.2279314   1.1326108   1.0283984   1.2283984   1.1333693
  1.0285478   1.2285478   1.1310132   1.1310922   1.1275938   1.035222
  1.2352221   0.52603537  1.1588858   1.0282209   1.228221    1.1372654
  1.0275685   1.2275685   1.1505519   1.127589    1.0381436   1.2381436
  0.52603567  1.127883    1.1312472   0.52666557  1.1276786   1.1294252
  1.1631845   1.4550072   1.6550074   1.1317408   1.0282371   1.228237
  1.1280738   1.1310117   1.0297681   1.229768    1.136563    1.1388676
  1.0275409   1.2275409   1.1276765   1.1333892   1.0292664   1.2292664
  0.5260355   1.0434821   1.243482    0.5260355   1.0277315   1.2277316
  1.1488149   1.039267    1.239267    1.1311308   1.0260359   1.1322328
  1.0296909   1.2296908   1.1363773   1.1292851   1.0275383   1.2275383
  1.1276617   1.127621    1.0260359   1.0260359   1.0261014   1.1315525
  1.0285248   1.2285248   1.1317201   1.1321962   1.0281091   1.2281091
  1.1276461   1.1311163   1.030096    1.2300961   1.2264434   0.5260357
  1.1498439   1.9871746   1.1313847   1.1279539   1.1323789   1.0623205
  1.2623206   1.0324258   1.2324258   0.52617973  1.1306897   1.1468613
  1.1632627   1.1286712   0.526243    1.1371696   1.1275437   1.1341518
  1.1307588   1.0292785   1.2292786   1.1276639   1.048568    1.248568
  1.027895    1.227895    1.0290301   1.22903     1.0303665   1.2303666
  1.0373609   1.2373608   1.0278193   1.2278193   0.83088034  1.4278312
  0.93017966  1.2266854   1.1268806   1.2263036   1.5273997   1.3340045
  1.2229487   0.5263686   1.0427282   1.2427282   1.1272485   1.0260476
  0.5260497   1.2291192   1.4263518   0.8263516   1.2271131   1.2265263
  1.1398879   0.5260686   1.127894    0.5331652   1.1877738   1.1334742
  1.1296511   1.1308017   1.1287067   1.1278      1.4452431   1.1439416
  1.1390293   0.6288108   1.1477661   1.347766    0.52636856  1.1383914
  1.5945609   1.1309887   1.0934529   1.5753934   1.1282943   1.1381919
  0.5612245   0.52622133  1.1297454   1.4839102   0.3261587   1.2271563
  1.0388607   1.2388607   1.500744    0.526017    0.52604747  0.5260497
  0.5260621   1.2686136   1.1430701   1.1492614   1.1278899   1.1290299
  1.1324198   1.1529962   0.5260988   1.0349739   1.2349739   1.1299573
  1.128135    4.984424    0.5260531   1.1404212   1.1296613   0.53019756
  1.1392732   1.1617172   1.1294856   1.1013895   1.3013895   1.1293087
  1.1963964   1.0260817   1.1345979   1.1084597   1.3084596   1.2468153
  1.0317047   1.2317046   1.1359006   1.1275686   1.1660626   1.3263413
  1.1511707   1.1751957   1.1354101   1.0614108   1.2614108   1.1359516
  1.1464474   1.1278502   1.1314294   1.0386426   1.2386426   1.1287472
  1.1503547   1.1302507   1.0287449   1.228745    1.128151    1.0546303
  1.2546303   1.1357248   1.0312111   1.2312112   1.1331141   1.109474
  1.3094739   1.1784642   1.1286418   1.1285614   1.1316192   1.054741
  1.254741    1.1309274   1.0366609   1.236661    1.1442325   1.0286115
  1.2286116   1.131755    1.0354596   1.2354596   1.1305405   1.0370252
  1.2370253   1.1309321   1.1440071   1.0314673   1.2314674   1.1380898
  1.1275641   1.176831    1.1273662   1.1294031   1.1313739   1.1323535
  1.0285976   1.2285976   1.1309055   1.1316142   1.1380265   1.1311204
  1.0276856   1.2276857   0.5276955   1.1284456   1.1305121   1.1340415
  1.1294124   1.028516    1.228516    1.1303211   1.1274297   1.2941424
  1.1476624   1.1292709   1.1308959   1.1485909   1.1392238   1.1274636
  1.1324588   1.1276143   1.1301043   1.324982    1.1274463   1.1283084
  1.1291035   1.1282288   1.0278075   1.2278075   1.1279068   1.1271253
  5.919369    1.1285923   1.1353502   1.1279882   1.1383832   1.1274668
  1.1276598   1.127405    1.1277117   1.0320432   1.2320431   1.1683247
  1.1280489   1.2603408   1.1274762   1.1512793   1.1275007   1.1276932
  1.0284531   1.228453    1.2265803   1.1473811   0.8264122  10.393106
  1.1271702   1.1299907   1.127298    1.2262177   0.52603567  1.1278591
  1.1359472   1.1360556   1.1681992   0.5261793   1.1313678   1.0279492
  1.2279491   7.1354628   1.0268252   1.2309072   1.1374673   0.5331815
  1.3961704   0.52603567  1.1280389   1.175068    1.2206738   0.5260353
  1.139882    1.0493572   1.2493571   0.52603537  1.0441458   1.244146
  1.1313703   1.1310356   1.0296223   1.2296225   1.2349925   1.1360213
  1.1268111   1.1377628   1.1218841   1.321884    1.127714    1.0275171
  1.2275171   1.1276017   1.0275875   1.2275875   1.8104247   1.1313628
  1.0292351   1.2322459   1.1278039   1.3530813   1.1316162   1.0336213
  1.2336212   1.1276823   1.0260049   1.2598373   1.0263973   1.1417534
  1.0681251   1.2681253   0.5261794   1.1362566   1.0274321   1.2274321
  1.7278264   1.1277424   0.5265863   1.159573    1.1549436   1.0284631
  1.228463    1.1599258   1.1970875   1.0290945   1.2290945   1.1324664
  1.0338323   1.2338325   0.4260363   1.1355574   1.0272679   1.2272679
  1.2408586   1.030558    1.230558    1.1347233   1.14074     1.1276566
  1.1274787   1.0303755   1.2303755   1.1736739   1.1309222   1.0280697
  1.2280697   1.1654993   1.1310338   1.1277359   1.0292518   1.2292517
  0.5260355   1.1493499   1.0289323   1.2289323   1.0263765   1.1640862
  1.0273118   1.2273118   0.5261796   1.1354839   1.1311224   1.1310585
  1.027405    1.2274052   1.1278447   1.1280755   1.0272129   1.2272128
  1.1312383   1.0275556   1.2275558   1.131994    1.0274138   1.2274139
  0.52617973  1.0272576   1.2272575   1.0271392   1.2271392   1.1434184
  1.0370373   1.2370374   1.127878    1.0272499   1.22725     1.1287445
  1.027248    1.2272481   1.0274241   1.2274241   1.0334097   1.2334096
  1.1275177   1.0317061   1.2317061   1.1318189   1.031182    1.2311821
  1.0278524   1.2278525   1.0307112   1.2307112   0.5260353   1.0293559
  1.2293559   1.0291177   1.2291176   1.1278644   1.1305803   1.1278728
  1.1276774   1.1314969   1.027337    1.227337    1.0638235   1.2638234
  1.1320517   1.1310375   1.1310748   1.030103    1.2301029   1.1281638
  1.02798     1.2279799   1.0510848   1.2510847   1.1278665   1.127592
  1.127937    1.2283775   1.2325504   1.1274571   1.0387083   1.2387083
  1.0570495   1.2570497   0.32710177  1.1569973   1.026831    1.2268312
  1.0268923   1.2268924   1.0376835   1.2376835   1.1277624   1.0275234
  1.2275236   1.0309246   1.2309247   1.2295711   1.8335692   1.2285172
  1.0261011   1.1280351   1.1276056   1.1358112   1.1281054   1.1386395
  1.2143818   1.1405284   1.1277916   1.1373574   1.1341203   1.1332564
  1.1279972   1.1317115   1.1276219   1.1276631   1.1280059   1.127597
  1.1805695   1.1274776   1.128434    0.94492954  0.92600673  1.0260907
  1.0260078   0.02600045  0.02600081]
2025-06-03 10:10:27,881 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101027_update_7.json
2025-06-03 10:10:27,882 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:27,886 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101027_update_7.pth and as latest_checkpoint.pth
2025-06-03 10:10:27,886 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.3231
2025-06-03 10:10:27,886 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-03 10:10:27,886 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.7945, MLP Score: 0.4715
2025-06-03 10:10:27,886 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.5544, MLP Score: 0.4822
2025-06-03 10:10:27,886 - WARNING -   Node ID: 142.250.196.228, Recon Error: 1.8937, MLP Score: 0.4785
2025-06-03 10:10:27,886 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.2530, MLP Score: 0.4840
2025-06-03 10:10:27,886 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.5544, MLP Score: 0.4822
2025-06-03 10:10:27,886 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 10:10:27,886 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 10.1043, MLP Score: 0.4862
2025-06-03 10:10:27,886 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.5922, MLP Score: 0.5030
2025-06-03 10:10:27,886 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.9844, MLP Score: 0.5214
2025-06-03 10:10:27,886 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 5.9194, MLP Score: 0.5225
2025-06-03 10:10:27,886 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.3931, MLP Score: 0.4803
2025-06-03 10:10:27,886 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-03 10:10:27,886 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-03 10:10:27,886 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-03 10:10:27,898 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-03 10:10:27,906 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-03 10:10:27,906 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-03 10:10:27,906 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-03 10:10:27,913 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-03 10:10:27,921 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-03 10:10:27,921 - INFO - Processing node updates/additions.
2025-06-03 10:10:27,922 - INFO - Processing edge updates/additions.
2025-06-03 10:10:27,926 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:27,926 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:27,927 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:27,927 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:27,930 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-03 10:10:27,931 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:27,932 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-03 10:10:27,932 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-03 10:10:27,933 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:27,934 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 13
2025-06-03 10:10:27,935 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:27,935 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:27,936 - DEBUG - Shape of encoded categorical edge features: torch.Size([833, 3])
2025-06-03 10:10:27,937 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:27,937 - DEBUG - Shape of scaled numerical edge features: torch.Size([833, 7])
2025-06-03 10:10:27,937 - DEBUG - Final edge attributes tensor shape: torch.Size([833, 10])
2025-06-03 10:10:27,937 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:27,938 - INFO - Performing online update...
2025-06-03 10:10:27,938 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:27,938 - DEBUG - Updated RunningStats: new_mean=0.9617187102114145, new_var=3600000000160.446, new_n=390
2025-06-03 10:10:27,938 - DEBUG - Updated RunningStats: new_mean=0.9460127830021069, new_var=3900000000019.2983, new_n=420
2025-06-03 10:10:27,938 - DEBUG - Updated RunningStats: new_mean=1.0699613011853957, new_var=1200000000040.0815, new_n=130
2025-06-03 10:10:27,938 - DEBUG - Updated RunningStats: new_mean=1.0693656478659157, new_var=1300000000001.0361, new_n=140
2025-06-03 10:10:27,938 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:27,938 - DEBUG - Online update step: 1/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 2/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 3/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 4/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 5/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 6/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 7/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 8/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 9/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 10/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 11/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 12/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 13/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 14/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 15/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 16/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 17/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 18/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 19/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 20/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 21/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 22/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 23/50
2025-06-03 10:10:27,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,939 - DEBUG - Online update step: 24/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 25/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 26/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 27/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 28/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 29/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 30/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 31/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 32/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 33/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 34/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 35/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 36/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 37/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 38/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 39/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 40/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 41/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 42/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 43/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 44/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 45/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 46/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 47/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 48/50
2025-06-03 10:10:27,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,940 - DEBUG - Online update step: 49/50
2025-06-03 10:10:27,941 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,941 - DEBUG - Online update step: 50/50
2025-06-03 10:10:27,941 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:27,941 - WARNING - No successful steps during online update.
2025-06-03 10:10:27,941 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -6.94202100e-08  5.91778822e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.86932300e-08
  1.76395609e-08 -1.13803615e-08  1.36564342e-08  0.00000000e+00
  2.45823383e+00  2.94272065e+00  1.40811458e-01  4.34367561e+00
  1.13803615e-08  3.47971368e+00  5.64677811e+00  7.60620546e+00
  1.40811458e-01  8.00000000e+00 -5.12116261e-09  2.04846504e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -2.04846504e-08 -2.38987603e-08], current edge mean: [ 5.2617044e+00  1.4177670e+00  4.8607445e+00  1.1448671e-08
 -4.5794684e-09  5.7243355e-10 -5.7243357e-09  3.4346013e-09
 -5.7243355e-10  0.0000000e+00]
2025-06-03 10:10:27,941 - DEBUG - Node drift difference: 0.0666, Edge drift difference: 0.0280
2025-06-03 10:10:27,942 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -6.94202100e-08  5.91778822e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.86932300e-08
  1.76395609e-08 -1.13803615e-08  1.36564342e-08  0.00000000e+00
  2.45823383e+00  2.94272065e+00  1.40811458e-01  4.34367561e+00
  1.13803615e-08  3.47971368e+00  5.64677811e+00  7.60620546e+00
  1.40811458e-01  8.00000000e+00 -5.12116261e-09  2.04846504e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -2.04846504e-08 -2.38987603e-08], edge=[ 5.2617044e+00  1.4177670e+00  4.8607445e+00  1.1448671e-08
 -4.5794684e-09  5.7243355e-10 -5.7243357e-09  3.4346013e-09
 -5.7243355e-10  0.0000000e+00]
2025-06-03 10:10:27,942 - DEBUG - Updated reference std: node=[0.        0.        1.0011954 1.0011954 0.        0.        0.
 1.0011954 1.0011954 1.0011954 1.0011954 1.0011954 1.0142751 0.3339817
 0.3747156 0.5714724 1.0011954 3.1244435 2.942724  1.5043986 0.3747156
 0.        1.0011954 1.0011955 0.        0.        0.        0.
 1.0011954 1.0011955], edge=[1.2291279 0.5031357 1.8797524 1.0006008 1.0006008 1.0006008 1.0006007
 1.0006008 1.0006008 1.0006008]
2025-06-03 10:10:27,942 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:27,942 - INFO - Running anomaly detection...
2025-06-03 10:10:27,942 - INFO - Starting anomaly detection.
2025-06-03 10:10:27,948 - DEBUG - Node reconstruction errors: [0.47455695 0.44285116 0.47944197 0.26856813 0.49076283 1.1141379
 0.36416468 0.37713224 0.93098795 0.2986543  0.71821684 0.21776555
 0.5286     0.51903856 0.51547146 1.1199099  0.34452784 0.33611193
 0.25386387 0.61171496 0.33611828 0.6305962  0.59543246 1.3437063
 1.7410005  0.86541635 0.32888606 0.4426751  0.33611724 0.72688514
 0.25788164 0.8654297  1.2072698  1.5063083  1.3773513  1.1834605
 2.5006022  0.669522   1.153617   0.85942537 0.7683901  0.6292187
 1.7779052  0.5189829  0.4168043  0.6603011  5.138899   0.4964232
 0.7697252  0.6187737  2.4274492  0.59571475 0.56896335 0.6695216
 0.8654128  0.46926892 0.7690142  0.6730556  0.99127614 1.1058167
 2.5006022  1.5036795  1.2984778  0.47580805 1.1058172  0.49271837
 1.6602633  0.59543157 0.61881256 0.7211325  0.8224181  0.8927517
 1.5933493  0.41889822 2.3562407  0.9542742  0.6187737  0.8500556
 0.8974383  0.5229834  0.4385342  0.4381804  0.32888415 0.518984
 0.53070134 0.6038882  0.37450707 1.5906287  0.74090284 0.56410277
 0.28196403 1.3462332  1.0545863  0.45855132 0.31371    2.964765
 0.2596294  0.4946438  0.43181425 0.2882501  0.49464753 0.25962844
 0.307201   0.67134583 1.1347085  0.2999763  0.34978545 0.93707776
 0.9996033  1.1419431  0.7618533  0.2625477  1.1508713  1.1998628
 0.4842964  0.49497122 0.44031352 1.318075   0.4108064  0.20887995
 0.2710424  1.0545858  1.1380869  1.0545874  0.38878396 0.24803433
 0.9249332  0.75143737 0.49467516 0.25149253 0.37703687 0.19226287
 0.27824688 1.4215782  0.4946303  0.29942325 0.4648184  0.45046848
 0.19269551 0.49463394 0.22446655 0.5685545  0.2801353  0.19229095
 0.19224194 0.4949195  0.44034183 0.22432774 0.37521973 0.4566738
 1.1334655  1.1348236  0.67124814 0.19226474 0.4718594  1.2888206
 0.208935   0.42971835 0.49464038 0.2919456  0.22623059 0.91369593
 0.20890765 0.37706718 0.44031817 1.1808052  0.7412927  0.41099218
 0.7837113  0.4948023  0.4566702  0.19784498 0.28013524 2.0222461
 0.41087234 0.23342295 0.41090414 0.39403906 0.42268318 0.4226786
 0.2890909  1.0707582  0.26403373 1.1693661  1.196628   0.42281613
 0.25668606 0.42597947 0.25668636 0.21276754 0.3862048  0.35603476
 0.22140822 0.19796655 0.27071226 0.22137746 0.25883538 0.3006115
 1.276815   0.25962916 0.4504692  0.22401927 1.1972218  0.41118094
 0.39045748 0.25602946 0.46512014 1.1724651  0.43768603 0.62287843
 0.5121825  0.42267498 0.2213829  0.41434336 0.42268085 0.28013518
 0.4226697  0.44030932 0.47283423 0.1979302  1.215735   0.2721793
 0.2655148  0.2213828  0.22398558 0.3123686  0.42275503 0.2239858
 0.4044785  0.2560302  1.0142833  0.42270857 0.4946335  0.44034737
 0.44031614 0.22137734 0.404453   0.26551464 0.22398546 0.25151998
 1.3095807  0.622645   0.21280527 0.44031096 0.21285136 0.49462312
 0.4229258  0.42381042 0.21280639 0.19940689 0.28013647 0.28013664
 0.47278517 0.45659116 0.3848877  0.38489473 0.2127679  0.43642572
 0.2655199  0.42268124 0.6232527  1.3016104  0.27776304 0.21276824
 0.40444893 0.30448315 0.54349995 0.27776304 0.54368955 0.42275944
 1.1897914  1.1966206  0.46144766 0.46145108 0.6707625  0.4226885
 0.2655154  0.49121016 0.2892092  0.42268655 0.33839777 0.26692444
 0.404517   0.45892006 0.21278337 0.4181166  1.2873254  0.9491405
 1.0707576  0.90209955 0.30444765 0.25924322 0.3393013  0.21280845
 0.2566201  0.43642092 0.4226807  0.4243817  0.22137764 0.28760064
 0.39081115 0.43623936 0.6442363  0.4361901  0.43620735 0.43619055
 0.43619123 0.68572444 0.4362209  0.43621266 0.43619168 0.68571657
 0.43619347 0.24117593 1.2413845  0.45725748 0.4589621  0.30855733
 0.23877147 0.21773745 0.6020181  0.4364198  0.33042082 0.64423734
 0.26551488 0.8375624  0.42672035 0.68574136 0.6225052  0.6225822
 0.5976042  0.23877096 0.4363455  0.67077994 0.43619484 0.6857044
 0.21026036 0.2655153  0.42670232 0.42670825 0.49369785 0.2565919
 0.42670295 0.6224903  0.6442436  0.5436122  0.64425826 0.4175096
 0.5976335  0.48911047 0.43636525 0.42268524 0.27724823 0.3625341
 0.26409003 0.22138289 0.43621513 0.43619004 0.43642    0.43642148
 0.4238163  0.4361969  0.426702   0.43619    0.43619046 1.4992355
 0.26286986 0.36259776 0.2102284  0.26313573 0.40137133 0.21036102
 0.21022347 0.21032555 0.54546624 0.43619004 0.2639777  0.40625274
 0.4672305  0.4361906  0.3987339  0.2102241  0.2102258  0.26905128
 0.2102237  0.3627448  0.28922036 1.2414441  0.6063897  0.43622014
 0.3011742  0.36252728 0.27588055 0.22208956 0.5922075  0.591384
 0.5904902  1.3349881  0.4512118  1.3349884  0.22204718 0.26766315
 0.591568   0.4511739  0.27588075 0.2235079  0.5264629  0.2192222
 0.26763394 0.26313338 0.5910192  0.22209011 0.45119044 0.59163135
 0.59113467 0.290141   0.26780874 0.5904264  0.26313257]
2025-06-03 10:10:27,950 - DEBUG - Edge reconstruction errors: [ 0.03093334  1.1314584   1.1345226   1.6278071   1.8278074   0.53059596
  1.1324066  11.49481     0.83092993  1.4433589   1.543359    1.2325366
  1.2436966   1.2091624   1.1350411   1.1324296   1.2307401   1.1342269
  0.5307276   1.1895089   1.1350949   1.0331475   1.2331475   1.1412406
  1.1334692   1.138621    1.133424    1.1354344   1.0414673   1.2414675
  1.1353351   1.1353195   1.0339162   1.2339162   6.117089    1.1374595
  1.0328379   1.2328379   1.1325694   1.0322685   1.2322686   1.1321431
  1.0371511   1.2371513   1.1353207   1.0392433   1.2392434   1.1321919
  1.0890621   1.2890623   1.1620033   1.0366982   1.2366984   1.0320828
  1.2320827   1.1322746   1.0477573   1.2477573   1.1325893   1.0661428
  1.2661428   1.5786546   1.7786549   0.53059626  1.1398698   1.1313701
  1.1323458   1.1355617   0.53059626  1.0389131   1.2389133   1.1368793
  1.1946409   1.0726973   1.2726974   0.53081113  1.1333215   0.5307273
  1.0377958   1.2377957   1.1352341   0.53081113  1.1425614   1.0379105
  1.2379105   1.1350895   0.5307276   1.147647    0.5305967   1.13271
  0.5306552   1.1392407   1.1394737   1.0321957   1.2321956   1.1363703
  1.0332425   1.2332424   1.1715425   1.1456524   1.0341704   1.2341704
  1.1456126   1.0357448   1.2357447   1.1454476   1.1359047   1.0329287
  1.2329288   1.140336    1.1458092   1.0386297   1.2386298   0.53059626
  1.1600047   1.0633755   1.2633755   1.1383796   1.0319325   1.2319325
  1.0348532   1.2348533   1.1321893   1.1396445   1.0398687   1.2398689
  0.43059644  1.1345388   1.1346347   1.1464891   1.0551568   1.255157
  0.5322822   1.1346375   1.0343441   1.2343441   0.53059685  1.1722625
  1.0749294   1.2749294   0.53059626  1.1368382   1.1156505   1.3156506
  1.1319233   1.1346098   1.1319457   1.1558858   1.1319749   1.0326282
  1.2326283   0.5305963   1.1350257   1.0792009   1.2792008   1.2312222
  1.1319071   1.1319079   1.1416336   1.133118    1.1319242   0.5307277
  1.1326029   1.1447933   1.1514367   1.131868    1.131847    1.141544
  1.0395283   1.2395284   1.1318984   1.161217    1.0334316   1.2334318
  0.53059644  1.0332975   1.2332977   1.1365108   1.0367615   1.2367615
  1.134871    0.5305965   1.0387458   1.2387458   1.0351526   1.2351525
  1.1321865   0.5305963   1.0375757   1.2375759   1.2104664   1.0328434
  1.2328434   1.2337258   1.1440768   0.5305967   1.1322291   1.1384705
  1.1319879   1.135573    1.0328223   1.2328223   1.135428    1.0321615
  1.2321615   1.1359394   1.0326256   1.2326256   1.1365324   1.0327157
  1.2327158   1.1348616   1.1349334   1.1319282   1.0382363   1.2382362
  0.5305964   1.1571357   1.0324066   1.2324066   1.140065    1.0319208
  1.231921    1.1504574   1.1319118   1.039869    1.2398689   0.5305967
  1.1321822   1.135075    0.5311697   1.1319814   1.1332271   1.160191
  1.3300835   1.5300835   1.1354479   1.0324214   1.2324213   1.132358
  1.1348045   1.0338422   1.2338421   1.1395062   1.1411885   1.031895
  1.2318951   1.1319562   1.136544    1.0332296   1.2332295   0.5305965
  1.0426296   1.2426296   0.5305965   1.0321335   1.2321335   1.1466448
  1.0405113   1.2405112   1.1348524   1.0305969   1.1357559   1.0336385
  1.2336384   1.1393185   1.1331005   1.0318995   1.2318995   1.1319649
  1.131922    1.0305969   1.0305967   1.2309517   1.0306555   1.1352928
  1.032702    1.232702    1.1353929   1.1359322   1.0936805   1.2936805
  1.1319497   1.1351129   1.034284    1.2342842   1.2309518   0.53059673
  1.1484203   1.984242    1.1350328   1.132226    1.1357085   1.0331384
  1.2331383   1.058941    1.2589412   1.0354912   1.2354913   0.53072786
  1.1345707   1.1461428   1.0433514   1.2433513   1.1618162   1.132464
  0.5307863   1.1402378   1.0369091   1.2369092   1.1346359   1.1369743
  1.032034    1.232034    1.1346318   1.0334551   1.2334552   1.1319671
  1.0492727   1.2492726   1.0321947   1.2321947   1.0330228   1.2330228
  1.034248    1.234248    1.0386658   1.2386658   1.0320991   1.2320993
  1.230818    1.1319188   1.2427163   1.1358287   1.131936    1.23074
  1.135465    1.1349459   1.1349245   1.1353818   0.8348221   1.4321647
  0.93419856  1.2311479   1.13277     1.2308213   1.531782    1.2992857
  1.1932677   0.5308965   1.0449606   1.2449605   1.1316111   1.0306066
  0.53060806  1.2333294   1.4308757   0.83087546  1.2315143   1.2310143
  1.1423036   0.5306275   1.132141    0.536559    1.1815634   1.1367573
  1.1336428   1.1340388   1.1329346   1.1320997   1.421264    1.1463519
  1.1416831   0.63296616  1.1636225   1.3636225   0.5308964   1.1412361
  1.5968437   1.1347634   1.0777535   4.8906946   1.1325555   1.1408589
  0.5603349   0.5307613   1.133494    1.3986669   0.33071172  1.2314667
  1.0416735   1.2416736   1.4829164   0.53067213  0.5306067   0.53060806
  0.5306195   1.31924     1.1443753   1.1497837   1.1319444   1.1330509
  1.1361086   1.1547613   0.53065294  1.047354    1.247354    1.1338753
  1.1320965   7.054521    0.5306101   1.1433601   1.133683    0.5343688
  1.141728    1.1585543   1.1332656   1.1876993   1.3876994   1.1334778
  1.1779273   1.0306401   1.1377804   1.0877535   1.2877535   1.2108395
  1.0351145   1.2351145   1.1378295   1.1318629   1.1649921   1.2659184
  1.1498797   1.1644517   1.1381413   1.0612499   1.2612498   1.1384709
  1.1486646   1.1321628   1.1351231   1.041692    1.2416921   1.1329223
  1.1512187   1.1342188   1.0327674   1.2327673   1.1323786   1.0531981
  1.2531981   1.1381624   1.0349845   1.2349845   1.1369643   1.0885041
  1.288504    1.1671365   1.1328359   1.1327883   1.1353467   1.0556909
  1.2556908   1.1347113   1.0399417   1.2399417   1.1455429   1.0327582
  1.2327583   1.1353406   1.0387155   1.2387154   1.1344433   1.0399342
  1.2399342   1.1346166   1.1464967   1.0451068   1.2451068   1.1388556
  1.1318586   1.1646531   1.058838    1.2588379   1.131724    1.1332781
  1.1351577   1.1358992   1.0327476   1.2327477   1.13475     1.1351979
  1.139354    1.1349149   1.0320324   1.2320324   0.532065    1.1326262
  1.1339694   1.1362422   1.1334922   1.0326855   1.2326856   1.1341953
  1.0344145   1.2344145   1.1317552   1.0334208   1.2334207   1.2849758
  1.1494048   1.1334422   1.1344407   1.1466668   1.1414118   1.131781
  1.033741    1.233741    1.149254    1.1318841   1.1336474   1.033349
  1.2333491   1.2634672   1.1317701   1.0342739   1.2342738   1.1325395
  1.1329379   1.1324685   1.0320795   1.2320794   1.1320714   1.1315842
  4.2648506   1.1326767   1.1385868   1.1322354   1.1417758   1.1317837
  1.1319069   1.1317313   1.0336665   1.2336665   1.1320167   1.0359335
  1.2359335   1.1621864   1.1323267   1.4013218   1.1317978   1.1528809
  1.1318136   1.1319997   1.0326742   1.2326742   1.0355474   1.2355473
  1.0368884   1.2368884   1.0347933   1.2347933   1.1360915   1.0920353
  1.2920353   1.0372856   1.2372856   1.1732886   1.065521    1.2655209
  1.1538638   1.0400583   1.2400582   1.0947827   1.2947828   1.0706193
  1.2706194   1.0829985   1.2829984   1.1232871   1.3232871   1.231063
  1.1486542   0.83092993  9.451585    1.1314689   1.133598    1.1315517
  1.2307564   0.5305966   1.132171    1.1391237   1.1382734   1.160913
  0.53072745  1.1351068   1.0321946   1.2321947   6.4555445   1.031309
  1.2348762   1.1389791   0.5370939   1.3575389   0.5305967   1.1322817
  1.1720601   1.2043386   0.5305963   1.1419231   1.0473794   1.2473794
  0.5305964   1.042857    1.2428572   1.134518    1.1348406   1.0335556
  1.2335558   1.2369589   1.1390773   1.1331965   1.1389017   1.0990607
  1.2990606   1.1357294   1.031811    1.231811    1.1349403   1.0319252
  1.2319252   1.5793179   1.1351326   1.0334898   1.2405527   1.1321193
  1.3231374   1.1470835   1.0365456   1.2365458   1.1319643   1.0305693
  1.2596936   1.0309228   1.1412753   1.0587704   1.2587706   0.5307275
  1.1376559   1.0316992   1.2316992   1.7320966   1.1320211   0.5310945
  1.1592355   1.1553456   1.0327584   1.2327585   1.1595553   1.1908518
  1.033157    1.2331569   1.1360332   1.037052    1.2370521   0.43059644
  1.1379023   1.0316658   1.2316657   1.2247875   1.0345145   1.2345145
  1.1380397   1.1423855   1.1319678   1.1318437   1.0346024   1.2346025
  1.1708986   1.1347467   1.0323123   1.2323123   1.1777772   1.1348473
  1.1320103   1.0332937   1.2332938   0.5305965   1.1507472   1.0332124
  1.2332124   1.0309036   1.1626891   1.0316416   1.2316418   0.53072774
  1.1386925   1.1398182   1.1396754   1.0317476   1.2317477   1.132158
  1.1323376   1.0315635   1.2315634   1.1350121   1.0318391   1.2318391
  1.1355563   1.0316892   1.2316892   0.53072786  1.0316106   1.2316105
  1.1369197   1.0315031   1.2315031   1.1348009   1.1455281   1.03962
  1.23962     1.1321715   1.0315931   1.2315933   1.1324798   1.1328926
  1.0315915   1.2315916   1.0317237   1.2317239   1.0365198   1.2365199
  1.1325508   1.1447002   1.0352343   1.2352345   1.1323707   1.1406168
  1.0347927   1.2347927   1.032078    1.2320781   1.132783    1.034676
  1.234676    0.53059626  1.1322274   1.0330139   1.2330141   1.1321889
  1.0332854   1.2332854   1.1321576   1.1445647   1.1358156   1.1353661
  1.1352192   1.0316461   1.2316462   1.0565437   1.2565438   1.1357205
  1.1348829   1.1349185   1.0341269   1.2341268   1.1323726   1.0322477
  1.2322478   1.1321913   1.0477393   1.2477392   1.1321552   1.1319039
  1.1321775   1.2326759   1.2362752   1.1345987   1.0397534   1.2397535
  1.053246    1.2532462   0.33158144  1.1519477   1.0312806   1.2312807
  1.031335    1.2313352   1.0387486   1.2387487   1.1320785   1.0318167
  1.2318169   1.035109    1.2351091   1.2337477   1.8370911   1.2327652
  1.0306553   1.1323687   1.1319268   1.1390675   1.1323552   1.1397849
  1.1899091   1.1421349   1.1320653   1.1405197   1.1371237   1.135945
  1.1322643   1.1353728   1.131941    1.1319677   1.1322962   1.1318592
  1.1766285   1.1347891   1.1325424   1.1326756   1.1321478   1.1508989
  1.1332934   1.1326796   1.2312757   1.1545212   1.2307395   0.9474317
  0.930571    1.0306485   1.0305719   0.03056529  0.03056562]
2025-06-03 10:10:27,951 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101027_update_8.json
2025-06-03 10:10:27,951 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:27,955 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101027_update_8.pth and as latest_checkpoint.pth
2025-06-03 10:10:27,955 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.3266
2025-06-03 10:10:27,955 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-03 10:10:27,955 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.7410, MLP Score: 0.4715
2025-06-03 10:10:27,955 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.5006, MLP Score: 0.4834
2025-06-03 10:10:27,955 - WARNING -   Node ID: 142.250.196.228, Recon Error: 1.7779, MLP Score: 0.4772
2025-06-03 10:10:27,955 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.1389, MLP Score: 0.4861
2025-06-03 10:10:27,955 - WARNING -   Node ID: 199.232.214.172, Recon Error: 2.4274, MLP Score: 0.4878
2025-06-03 10:10:27,955 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 10:10:27,955 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 11.4948, MLP Score: 0.4763
2025-06-03 10:10:27,956 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.1171, MLP Score: 0.5006
2025-06-03 10:10:27,956 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.8907, MLP Score: 0.5313
2025-06-03 10:10:27,956 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 7.0545, MLP Score: 0.5365
2025-06-03 10:10:27,956 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 4.2649, MLP Score: 0.5166
2025-06-03 10:10:27,956 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-03 10:10:27,956 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-03 10:10:27,956 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-03 10:10:27,968 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-03 10:10:27,976 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-03 10:10:27,976 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-03 10:10:27,976 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-03 10:10:27,983 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-03 10:10:27,992 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-03 10:10:27,992 - INFO - Processing node updates/additions.
2025-06-03 10:10:27,993 - INFO - Processing edge updates/additions.
2025-06-03 10:10:27,997 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:27,998 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:27,998 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:27,998 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:28,001 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-03 10:10:28,002 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:28,003 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-03 10:10:28,004 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-03 10:10:28,004 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:28,006 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 14
2025-06-03 10:10:28,006 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:28,007 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:28,008 - DEBUG - Shape of encoded categorical edge features: torch.Size([919, 3])
2025-06-03 10:10:28,008 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:28,008 - DEBUG - Shape of scaled numerical edge features: torch.Size([919, 7])
2025-06-03 10:10:28,008 - DEBUG - Final edge attributes tensor shape: torch.Size([919, 10])
2025-06-03 10:10:28,008 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:28,009 - INFO - Performing online update...
2025-06-03 10:10:28,009 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:28,009 - DEBUG - Updated RunningStats: new_mean=0.9601105382169378, new_var=4200000000159.0537, new_n=450
2025-06-03 10:10:28,010 - DEBUG - Updated RunningStats: new_mean=0.9467992910610908, new_var=4500000000019.754, new_n=480
2025-06-03 10:10:28,010 - DEBUG - Updated RunningStats: new_mean=1.081578414433561, new_var=1400000000049.083, new_n=150
2025-06-03 10:10:28,010 - DEBUG - Updated RunningStats: new_mean=1.0801891576436928, new_var=1500000000001.0137, new_n=160
2025-06-03 10:10:28,010 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:28,010 - DEBUG - Online update step: 1/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 2/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 3/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 4/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 5/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 6/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 7/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 8/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 9/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 10/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 11/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 12/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 13/50
2025-06-03 10:10:28,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,010 - DEBUG - Online update step: 14/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 15/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 16/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 17/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 18/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 19/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 20/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 21/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 22/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 23/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 24/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 25/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 26/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 27/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 28/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 29/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 30/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 31/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 32/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 33/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 34/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 35/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 36/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 37/50
2025-06-03 10:10:28,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,011 - DEBUG - Online update step: 38/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 39/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 40/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 41/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 42/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 43/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 44/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 45/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 46/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 47/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 48/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 49/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - DEBUG - Online update step: 50/50
2025-06-03 10:10:28,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,012 - WARNING - No successful steps during online update.
2025-06-03 10:10:28,012 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.1275197e-08 -4.5619956e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -8.1464204e-09  2.1723789e-09 -1.5206652e-08 -3.8016630e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -1.9551409e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.9551409e-08 -3.4214967e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.6033260e-09 -1.9008315e-08], current edge mean: [ 6.2328620e+00  1.4417845e+00  4.8509250e+00  4.1509218e-09
 -5.7075176e-09  4.6697872e-09 -3.1131915e-09 -2.0754609e-09
  5.1886526e-09 -4.7995035e-09]
2025-06-03 10:10:28,012 - DEBUG - Node drift difference: 0.0619, Edge drift difference: 0.7901
2025-06-03 10:10:28,013 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:28,013 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.1275197e-08 -4.5619956e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -8.1464204e-09  2.1723789e-09 -1.5206652e-08 -3.8016630e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -1.9551409e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.9551409e-08 -3.4214967e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.6033260e-09 -1.9008315e-08], edge=[ 6.2328620e+00  1.4417845e+00  4.8509250e+00  4.1509218e-09
 -5.7075176e-09  4.6697872e-09 -3.1131915e-09 -2.0754609e-09
  5.1886526e-09 -4.7995035e-09]
2025-06-03 10:10:28,013 - DEBUG - Updated reference std: node=[0.         0.         1.0011408  1.0011408  0.         0.
 0.         1.0011408  1.001141   1.001141   1.0011408  1.001141
 1.003074   0.3264865  0.39457318 0.56690574 1.001141   3.2002099
 2.9714756  1.5429286  0.39457318 0.         1.001141   1.0011408
 0.         0.         0.         0.         1.001141   1.001141  ], edge=[1.2118548 0.5077134 1.870123  1.0005445 1.0005445 1.0005445 1.0005445
 1.0005445 1.0005445 1.0005445]
2025-06-03 10:10:28,013 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:28,013 - INFO - Running anomaly detection...
2025-06-03 10:10:28,013 - INFO - Starting anomaly detection.
2025-06-03 10:10:28,023 - DEBUG - Node reconstruction errors: [0.5309018  0.47515336 0.51859814 0.2933617  0.5399186  1.1501521
 0.40471584 0.40543276 0.95274186 0.31522468 0.7822022  0.23963664
 0.5681209  0.5784231  0.56919914 1.1989135  0.37478074 0.3481824
 0.26365715 0.6676629  0.34818885 0.6918737  0.6535338  1.4159224
 1.8049177  0.91772145 0.3524428  0.47423756 0.34818828 0.7798055
 0.28152132 0.91773033 1.2505938  1.6141641  1.4392403  1.2068994
 2.6346571  0.72905254 1.1710107  0.87510854 0.82104325 0.6894019
 2.0342143  0.5783817  0.4729592  0.6909158  5.3097215  0.5490568
 0.833894   0.6744692  2.511233   0.65374875 0.6286127  0.72905225
 0.9177194  0.52579147 0.822621   0.68917775 0.98398155 1.1781377
 2.6346571  1.5379626  1.3191149  0.5279497  1.178138   0.5202746
 1.7630994  0.65353316 0.6749415  0.779497   1.1546109  0.8905296
 1.6804864  0.46068966 2.4146996  0.9492477  0.6744688  1.0035459
 0.9368208  0.5564144  0.48566058 0.49204484 0.35244066 0.5783831
 0.55978566 0.6449872  0.40344518 1.7231638  0.62897354 0.6208387
 0.30855358 1.3922246  1.0636089  0.43072975 0.34358943 3.1134553
 0.2830571  0.55197835 0.4861714  0.31493226 0.5519818  0.28305644
 0.31808478 0.7374473  1.1690896  0.32905367 0.3563283  0.970133
 1.0157982  1.0991683  0.742051   0.27883226 1.1924694  1.3458507
 0.53340685 0.55226254 0.4909895  1.3315647  0.44385463 0.21846962
 0.2893394  1.0636083  1.1716286  1.0636084  0.42907664 0.24777608
 0.94872016 0.77116996 0.5520055  0.31155267 0.41480127 0.21025153
 0.30260548 1.3969694  0.46112683 0.30249462 0.5040061  0.5095551
 0.21070051 1.2838573  0.21903394 0.54244804 0.31159896 0.21028289
 0.21023072 0.5522213  0.49101457 0.24996406 0.42544067 0.42157924
 1.188131   1.1692048  0.7446536  0.21025367 0.5171587  1.3028562
 0.21852678 0.46876395 0.55197555 0.31337303 0.25197268 0.94116807
 0.21850063 0.4148255  0.49099317 1.2818604  0.83513707 0.42167556
 0.82058436 0.42178947 0.49674442 0.21851227 0.3085001  2.1345105
 0.4215578  0.22761184 0.42158207 0.43422115 0.47262013 0.4726167
 0.31668177 1.0978323  0.283487   1.2105905  1.2197268  0.47274825
 0.2779772  0.47663745 0.277977   0.23769623 0.49662584 0.38478312
 0.23532633 0.2206654  0.2890393  0.23529904 0.2854416  0.31160802
 1.2964517  0.31154826 0.50955576 0.24963881 1.2485174  0.44420877
 0.44020525 1.0636089  0.50681055 1.1826935  0.4847897  0.6893775
 0.5566763  0.47261342 0.23530361 0.44730672 0.4726181  0.3085002
 0.472608   0.49098536 0.51946443 0.2206272  1.3266276  0.28641078
 0.29171118 0.2353035  0.24960393 0.33282986 0.47268963 0.24960391
 0.43665448 0.27500674 1.038635   0.4726442  0.42148682 0.49101964
 0.4909918  0.23529886 0.43663162 0.29171064 0.24960336 0.27097806
 1.3177897  0.50976294 0.23773547 0.4214873  0.23778288 0.40235192
 0.43763912 0.48028958 0.23773646 0.21805438 0.30850124 0.30850142
 0.51941985 0.4966699  0.46114823 0.43520322 0.23769659 0.49207315
 0.29171553 0.47261825 0.6901048  1.3245443  0.293697   0.23769715
 0.43662745 0.34592512 0.6104196  0.29369727 0.61062473 0.4726933
 1.2079984  1.2197193  0.49379814 0.5044755  0.75998956 0.47262523
 0.29793388 0.5192462  0.31680146 0.4726232  0.4142119  0.2891676
 0.3331929  0.5072595  0.23771352 0.4679977  1.3550543  0.9691446
 1.0978317  0.93618757 0.3366812  0.28083172 0.3883096  0.23773894
 0.28077894 0.49206963 0.4726182  0.47423953 0.23529893 0.3094291
 0.43167084 0.48855993 0.7239118  0.723914   0.48853642 0.48852417
 0.48852426 0.7724625  0.4885458  0.48854107 0.4885245  0.7724555
 0.4885262  0.24724816 1.283421   0.4923543  0.50566185 0.32116166
 0.2508075  0.22738792 0.5733138  0.49206856 0.36278865 0.72391236
 0.28640243 1.181003   0.47622827 0.7724778  0.68938917 0.6894592
 0.6348373  0.25080675 0.48863834 0.76000315 0.48852682 0.7724453
 0.21373172 0.29171127 0.47621545 0.4762197  0.5532845  0.280748
 0.47621566 0.57272774 0.7239188  0.6105404  0.72393155 0.4622373
 0.671691   0.5261541  0.4886561  0.43426237 0.29321578 0.4119302
 0.2837211  0.23530349 0.4885415  0.48852295 0.49206832 0.49207002
 0.4802948  0.48852816 0.47621515 0.7263723  0.7244871  2.1284804
 0.27997133 0.41198695 0.43157908 0.3656678  0.41531155 0.431631
 0.3365862  1.2120847  0.59364015 0.646166   0.28695908 0.46189982
 0.52033055 0.488524   0.7239024  0.23222859 0.21369512 0.50580776
 0.23222773 0.43168247 0.3132493  1.2760975  0.69565487 0.48854542
 0.63042057 0.4315879  0.29331595 0.23739348 0.67066765 0.66984403
 0.66894263 1.3794951  0.49821922 1.3794951  0.23735124 0.27387086
 0.67003095 0.49816594 0.293316   0.23886633 0.58179414 0.24188836
 0.2738442  0.28617507 0.6694797  0.23739362 0.49817878 0.6700899
 0.6695898  0.30743772 0.28879413 0.668882   0.28617388 0.29331237
 0.29331207 0.23753105 0.29332072 0.23744546 1.091903   0.28943887
 0.23735006 0.3046307  1.0821875  0.35835806 0.62041306 0.32188606
 0.6719848  0.3833067  0.66880786 0.6698967  0.2373525  0.38148823
 0.3583582 ]
2025-06-03 10:10:28,026 - DEBUG - Edge reconstruction errors: [ 0.03154059  1.2320682   1.2350571   1.7231524   1.9231526   0.631223
  1.2330358  11.891657    0.9315409   1.5433936   1.6433938   1.3330733
  1.3437222   1.3066399   1.2356352   1.2330606   1.3313607   1.2347547
  0.6313475   1.2886181   1.2355399   1.1336703   1.3336705   1.241758
  1.2340142   1.2393045   1.2339604   1.2358855   1.1416252   1.3416252
  1.2358081   1.2357666   1.1344104   1.3344104   7.7973375   1.2379172
  1.1333789   1.3333789   1.2331396   1.1328263   1.3328264   1.2327017
  1.1375152   1.3375151   1.2357222   1.1395724   1.3395724   1.2327511
  1.1884546   1.3884547   1.261339    1.1370919   1.3370918   1.1326246
  1.3326247   1.2328389   1.147783    1.347783    1.2331563   1.1669166
  1.3669165   1.6758504   1.8758503   0.6312234   1.2400423   1.23198
  1.2329712   1.2359911   0.6312233   1.1392304   1.3392304   1.237506
  1.2949901   1.1735741   1.3735741   0.63142616  1.2338939   0.63134724
  1.1380948   1.338095    1.2356803   0.63142616  1.242835    1.1382521
  1.3382522   1.2355319   0.6313475   1.2476611   0.63122374  1.2332708
  0.6312793   1.2394949   1.2397337   1.1327665   1.3327665   1.2367747
  1.133767    1.333767    1.2705135   1.2456429   1.1346363   1.3346363
  1.2619423   1.1361508   1.3361509   1.2454641   1.2363644   1.1334636
  1.3334635   1.2405959   1.2464627   1.1391965   1.3391964   0.6312234
  1.2594118   1.163816    1.3638161   1.2388954   1.1324999   1.3325
  1.1353165   1.3353164   1.2327486   1.2466514   1.1401203   1.3401202
  0.43122366  1.2394068   1.23961     1.2554004   1.154694    1.354694
  0.63281673  1.2478758   1.134776    1.3347762   0.63122374  1.232948
  1.2727531   1.1756594   1.3756593   0.6312234   1.2372848   1.2166314
  1.4166316   1.2324923   1.2350603   1.2355928   1.2558914   1.2325466
  1.1331706   1.3331707   0.63122344  1.2354854   1.1798896   1.3798895
  1.331819    1.2324771   1.2324778   1.241793    1.2336808   1.232493
  0.63134754  1.2331371   1.2448164   1.2511697   1.2324398   1.23242
  1.241709    1.1396983   1.3396982   1.2324687   1.2606094   1.1339512
  1.3339512   0.6312235   1.1338307   1.3338307   1.2371471   1.1371615
  1.3371615   1.2353002   0.63122356  1.1393181   1.3393183   1.1355739
  1.3355739   1.232746    0.6312234   1.137867    1.3378671   1.3106065
  1.1334097   1.3334097   1.3341943   1.2441237   0.63122374  1.2327849
  1.2387303   1.2325572   1.2360109   1.1333568   1.3333567   1.2358681
  1.132733    1.3327329   1.2363944   1.1331642   1.3331642   1.2369734
  1.1332581   1.333258    1.2353048   1.2353729   1.2324985   1.1385801
  1.33858     0.6312235   1.2569402   1.1329681   1.3329681   1.2403147
  1.1324887   1.3324888   1.2504575   1.2324854   1.1403164   1.3403164
  0.63122374  1.2327406   1.2355067   0.6317653   1.2325534   1.2337958
  1.2599889   1.4313906   1.6313908   1.2358735   1.132982    1.3329821
  1.2329061   1.2352612   1.1343198   1.3343198   1.2397715   1.2414396
  1.1324643   1.3324643   1.2325342   1.2369854   1.1337702   1.3337702
  0.63122356  1.1433203   1.3433204   0.63122356  1.1326774   1.3326775
  1.2472726   1.1409948   1.3409948   1.235318    1.1312239   1.2361908
  1.1341523   1.3341523   1.2395976   1.2336757   1.1324674   1.3324673
  1.2325381   1.2324985   1.1312239   1.1312238   1.3315624   1.1312795
  1.2357236   1.1332437   1.3332436   1.2462223   1.2363183   1.1943398
  1.3943398   1.2325238   1.235513    1.1347106   1.3347106   1.3315625
  0.63122344  1.2487931   1.35776     1.5577601   2.0989814   1.2354981
  1.2327857   1.2451887   1.1336855   1.3336855   1.1588943   1.3588943
  1.1360233   1.3360232   0.63134766  1.2350292   1.2465584   1.1439039
  1.3439038   1.3250625   1.2330886   0.63140273  1.2404294   1.1428263
  1.3428262   1.2350868   1.2374417   1.1325997   1.3325998   1.2390233
  1.133943    1.333943    1.23254     1.1492206   1.3492205   1.232708
  1.1327518   1.3327519   1.1335729   1.333573    1.2330843   1.1347296
  1.3347296   1.1392714   1.3392713   1.1419362   1.3419363   1.3314345
  1.2324885   1.344329    1.2362434   1.2325075   1.3313607   1.2358902
  1.2354074   1.2353868   1.235824    0.43137532  1.2351733   0.6313476
  1.2351077   1.2326133   1.2324574   0.63134766  0.63122374  1.2358123
  1.2350912   0.63134766  1.2352504   1.1314665   1.2444718   1.2327178
  0.9388863   1.5327189   1.0381002   1.3317523   1.2333118   1.33144
  1.632355    1.3944606   1.325706    0.6315077   1.144956    1.344956
  1.2321994   1.1312335   0.6312347   1.3338207   1.5314893   0.93148905
  1.3321031   1.331624    1.2424606   0.6312526   1.2327111   0.6369582
  1.2803787   1.2371618   1.2341487   1.2346456   1.2334511   1.2326639
  1.5059301   1.2462176   1.241842    0.73349285  1.2891147   1.4891148
  0.6315077   1.2413945   1.6915295   1.2352262   1.1784656   5.0496683
  1.2330935   1.2410747   0.6597618   0.63138014  1.2340525   1.5026004
  0.43133184  1.3320742   1.1863694   1.3863693   1.5752084   0.6312953
  0.6312333   0.6312347   0.63124543  1.4200294   1.2445716   1.2497267
  1.2325615   1.2335944   1.2364899   1.2541344   0.63127726  1.1589392
  1.3589393   1.2343773   1.2327186   7.2496552   0.63123685  1.2433498
  1.2341812   0.63479227  1.2493916   1.2584996   1.233835    1.2814125
  1.4814125   1.2339654   1.2790992   1.1312644   1.2381284   1.1886046
  1.3886045   1.3126456   1.1356146   1.3356147   1.2383884   1.2324448
  1.2641174   1.3679577   1.2501252   1.2652693   1.2385405   1.1604867
  1.3604867   1.2388828   1.2483974   1.2327201   1.2355741   1.141782
  1.341782    1.2334486   1.2510002   1.2346878   1.1333308   1.3333309
  1.2329351   1.1532296   1.3532296   1.2386105   1.1354315   1.3354315
  1.2372564   1.1893464   1.3893464   1.2678612   1.2333652   1.2333155
  1.2357761   1.1551359   1.3551359   1.2351763   1.1401174   1.3401175
  1.2456547   1.133301    1.3333011   1.2357944   1.154415    1.354415
  1.2349074   1.1401743   1.3401743   1.2351054   1.2463386   1.1450415
  1.3450415   1.2395397   1.2324407   1.2657009   1.1943398   1.3943398
  1.2323049   1.2338302   1.2355907   1.2363198   1.1332908   1.3332908
  1.2352021   1.2356622   1.2399063   1.2353636   1.132593    1.3325931
  0.63261986  1.2375282   1.2345436   1.2368681   1.2339942   1.1332299
  1.3332298   1.2346821   1.1348673   1.3348672   1.2323395   1.1339277
  1.3339278   1.3768814   1.2491659   1.233932    1.234966    1.2472512
  1.2416698   1.2323648   1.134228    1.3342279   1.2489951   1.2324686
  1.1971024   1.3971025   1.2342299   1.1338578   1.3338578   1.3658679
  1.2323536   1.1347609   1.3347609   1.2330838   1.2335216   1.2330165
  1.1326497   1.3326496   1.2326604   1.142451    1.3424511   1.232158
  4.42447     1.2332361   1.2388679   1.2327988   1.2418015   1.2323674
  1.1343718   1.3343718   1.2324936   1.39815     1.59815     1.2323172
  1.1341531   1.3341532   1.2325858   1.1362925   1.3362925   1.2623794
  1.2328781   1.4874909   1.2323797   1.1407148   1.3407147   1.2524172
  1.232396    1.1354266   1.3354267   1.2325697   1.1331041   1.333104
  1.1332104   1.3332105   1.1359599   1.3359599   1.1372546   1.3372546
  1.1353031   1.3353031   1.2364738   1.1936778   1.3936778   1.1378114
  1.3378114   1.2991469   1.1666303   1.3666303   1.2534301   1.1405187
  1.3405187   1.1962625   1.3962624   1.1716037   1.3716037   1.1843694
  1.3843695   1.2253199   1.4253199   1.1392438   1.3392439   1.1868677
  1.3868678   1.2937291   1.493729    1.1344334   1.3344333   1.1363387
  1.3363388   1.1382701   1.3382701   1.3316703   1.2485529   0.9315409
  9.792663    1.2320783   1.234173    1.232163    1.331376    0.6312237
  1.232728    1.2393765   1.238751    1.2748805   0.63134736  1.2355511
  1.1327611   1.3327613   6.769899    1.1318984   1.3352983   1.2395266
  0.63736475  1.4492851   0.63122374  1.2328424   1.2710102   1.3032528
  0.63122344  1.2421697   1.1479216   1.3479216   0.6312235   1.1436057
  1.3436058   1.2351058   1.2352929   1.1340778   1.3340778   1.3349228
  1.2393541   1.2337403   1.2395186   1.199463    1.3994629   1.2361481
  1.1323967   1.3323967   1.2353854   1.1324955   1.3324955   1.6880717
  1.2355701   1.1339622   1.3407236   1.2326794   1.4158679   1.2470226
  1.1427854   1.3427855   1.2325411   1.1311977   1.3590412   1.1315327
  1.2419984   1.1890688   1.3890688   0.6313472   1.2383176   1.1341488
  1.3341489   1.8362192   1.2325944   0.6316949   1.258648    1.2549102
  1.1385311   1.3385311   1.2589507   1.3047551   1.1450927   1.3450927
  1.2364407   1.1374457   1.3374456   0.43122366  1.2383848   1.1351397
  1.3351399   1.3221924   1.1349642   1.3349642   1.2383462   1.2426664
  1.2360674   1.2354417   1.1349992   1.3349992   1.2816728   1.2394862
  1.1423306   1.3423308   0.4312024   1.2763516   1.2401997   1.235709
  1.1338161   1.3338162   0.6312235   1.2606744   1.1336999   1.3337
  1.1315144   1.2620355   1.1350359   1.3350359   0.6313476   1.2389709
  1.2400279   1.2398926   1.1323297   1.3323296   1.2327158   1.2328911
  1.1351497   1.3351496   1.2354575   1.1350852   1.3350852   1.2359989
  1.134578    1.3345779   0.63134766  1.1322004   1.3322003   1.2374113
  1.1320988   1.3320987   1.2352579   1.2455046   1.1399393   1.3399394
  1.2327315   1.132186    1.332186    1.2330253   1.2334259   1.1321846
  1.3321846   1.1323148   1.3323148   1.1369704   1.3369704   1.2331142
  1.2447066   1.1357057   1.3357056   1.2404858   1.2407905   1.1352814
  1.3352815   1.1326563   1.3326564   1.2333122   1.1351124   1.3351125
  0.6312234   1.2327874   1.1336222   1.3336222   1.2327482   1.133787
  1.3337871   1.2327188   1.2445815   1.2362131   1.2357713   1.2356584
  1.132241    1.332241    1.157336    1.357336    1.2361332   1.2353252
  1.2353585   1.1345928   1.3345927   1.2329327   1.1328065   1.3328066
  1.2327505   1.1484895   1.3484895   1.2327172   1.23248     1.232746
  1.3331993   1.336639    1.2350087   1.1602862   1.3602862   1.2327737
  1.1784027   1.3784027   0.43215173  1.235768    1.2526877   1.1957437
  1.3957436   1.1319293   1.3319294   1.139389    1.3393891   1.236034
  1.1324022   1.3324022   1.1354768   1.3354769   1.3342152   1.9374309
  1.3332907   1.1312793   1.2363671   1.2324996   1.1360927   1.3360927
  1.2393106   1.1319287   1.3319287   1.2329094   1.1318774   1.3318775
  1.2605523   1.1323278   1.3323277   0.63122344  1.2912483   1.2424405
  1.1357961   1.3357961   1.2364764   1.240675    1.1341488   1.3341488
  1.2375495   1.1328068   1.3328068   1.2365091   1.134229    1.334229
  1.2328222   1.1322261   1.332226    1.2358114   1.2325131   1.2325402
  1.2328477   1.2324468   1.2754109   1.1318774   1.3318775   1.2352406
  1.2331074   1.1321509   1.3321508   1.2332561   1.2327057   1.2504077
  1.2338107   1.2332205   1.3318714   1.2546626   1.3313601   1.1343787
  1.3343786   1.2333186   1.2727757   1.4727757   1.2342877   1.2335012
  1.238847    1.1347485   1.3347485   1.2422421   1.232993    1.2328224
  1.0490053   1.0311993   1.1312723   1.1312003   0.03119391  0.0311939
  1.1314797 ]
2025-06-03 10:10:28,030 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101028_update_9.json
2025-06-03 10:10:28,030 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:28,034 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101028_update_9.pth and as latest_checkpoint.pth
2025-06-03 10:10:28,034 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.3249
2025-06-03 10:10:28,034 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-03 10:10:28,034 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.8049, MLP Score: 0.4715
2025-06-03 10:10:28,034 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.6347, MLP Score: 0.4816
2025-06-03 10:10:28,034 - WARNING -   Node ID: 142.250.196.228, Recon Error: 2.0342, MLP Score: 0.4801
2025-06-03 10:10:28,034 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.3097, MLP Score: 0.4881
2025-06-03 10:10:28,034 - WARNING -   Node ID: 199.232.214.172, Recon Error: 2.5112, MLP Score: 0.4871
2025-06-03 10:10:28,034 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 10:10:28,034 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 11.8917, MLP Score: 0.4756
2025-06-03 10:10:28,034 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 7.7973, MLP Score: 0.4993
2025-06-03 10:10:28,034 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 5.0497, MLP Score: 0.5309
2025-06-03 10:10:28,034 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 7.2497, MLP Score: 0.5312
2025-06-03 10:10:28,034 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 4.4245, MLP Score: 0.5153
2025-06-03 10:10:28,034 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-03 10:10:28,034 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-03 10:10:28,034 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-03 10:10:28,046 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-03 10:10:28,057 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-03 10:10:28,057 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-03 10:10:28,057 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-03 10:10:28,066 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-03 10:10:28,076 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-03 10:10:28,076 - INFO - Processing node updates/additions.
2025-06-03 10:10:28,078 - INFO - Processing edge updates/additions.
2025-06-03 10:10:28,083 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:28,084 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:28,084 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:28,085 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:28,089 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-03 10:10:28,092 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:28,092 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-03 10:10:28,093 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-03 10:10:28,093 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:28,096 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:28,096 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:28,097 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:28,098 - DEBUG - Shape of encoded categorical edge features: torch.Size([1044, 3])
2025-06-03 10:10:28,098 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:28,098 - DEBUG - Shape of scaled numerical edge features: torch.Size([1044, 7])
2025-06-03 10:10:28,099 - DEBUG - Final edge attributes tensor shape: torch.Size([1044, 10])
2025-06-03 10:10:28,099 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:28,100 - INFO - Performing online update...
2025-06-03 10:10:28,100 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:28,100 - DEBUG - Updated RunningStats: new_mean=0.9588923302759377, new_var=4800000000159.365, new_n=510
2025-06-03 10:10:28,100 - DEBUG - Updated RunningStats: new_mean=0.9466423468842772, new_var=5100000000019.355, new_n=540
2025-06-03 10:10:28,101 - DEBUG - Updated RunningStats: new_mean=1.0900653428295601, new_var=1600000000048.9282, new_n=170
2025-06-03 10:10:28,101 - DEBUG - Updated RunningStats: new_mean=1.0884048613674604, new_var=1700000000001.0906, new_n=180
2025-06-03 10:10:28,101 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:28,101 - DEBUG - Online update step: 1/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 2/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 3/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 4/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 5/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 6/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 7/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 8/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 9/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 10/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 11/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 12/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 13/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 14/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 15/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 16/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 17/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 18/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,101 - DEBUG - Online update step: 19/50
2025-06-03 10:10:28,101 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 20/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 21/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 22/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 23/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 24/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 25/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 26/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 27/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 28/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 29/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 30/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 31/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 32/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 33/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 34/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 35/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 36/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 37/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 38/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 39/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 40/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 41/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 42/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,102 - DEBUG - Online update step: 43/50
2025-06-03 10:10:28,102 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 44/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 45/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 46/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 47/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 48/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 49/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - DEBUG - Online update step: 50/50
2025-06-03 10:10:28,103 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,103 - WARNING - No successful steps during online update.
2025-06-03 10:10:28,103 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.9192095e-08  2.0529193e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.1524959e-08  7.4651609e-09 -2.7994354e-08 -1.7729757e-08
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -7.4651609e-09  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -2.2395483e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  5.5988707e-09 -3.0793789e-08], current edge mean: [ 6.2222223e+00  1.4061303e+00  4.8524904e+00  0.0000000e+00
 -9.1348112e-10 -2.7404434e-09 -4.5674056e-10 -5.9376273e-09
  2.2837028e-09 -1.3702217e-09]
2025-06-03 10:10:28,104 - DEBUG - Node drift difference: 0.0883, Edge drift difference: 0.0702
2025-06-03 10:10:28,104 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.9192095e-08  2.0529193e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.1524959e-08  7.4651609e-09 -2.7994354e-08 -1.7729757e-08
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -7.4651609e-09  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -2.2395483e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  5.5988707e-09 -3.0793789e-08], edge=[ 6.2222223e+00  1.4061303e+00  4.8524904e+00  0.0000000e+00
 -9.1348112e-10 -2.7404434e-09 -4.5674056e-10 -5.9376273e-09
  2.2837028e-09 -1.3702217e-09]
2025-06-03 10:10:28,104 - DEBUG - Updated reference std: node=[0.         0.         1.0009799  1.0009799  0.         0.
 0.         1.0009799  1.0009799  1.0009799  1.0009799  1.0009799
 0.99121654 0.31522512 0.3527915  0.5612344  1.0009799  3.1126812
 2.953794   1.5002859  0.3527915  0.         1.0009799  1.0009799
 0.         0.         0.         0.         1.0009799  1.0009799 ], edge=[1.183315  0.5010064 1.9140905 1.0004793 1.0004793 1.0004792 1.0004792
 1.0004792 1.0004792 1.0004792]
2025-06-03 10:10:28,105 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:28,105 - INFO - Running anomaly detection...
2025-06-03 10:10:28,105 - INFO - Starting anomaly detection.
2025-06-03 10:10:28,186 - DEBUG - Node reconstruction errors: [0.6806478  0.5748053  0.65834713 0.395383   0.68580216 2.0511084
 0.48969117 0.5195391  1.0405142  0.40776634 0.95460624 0.3489598
 0.710511   0.70375633 0.7060457  1.3148773  0.4652188  0.43248183
 0.33902195 0.80699986 0.43248835 0.8530577  0.7929119  1.5724245
 2.0077465  1.0782028  0.44547695 0.5975181  0.43249124 0.9223573
 0.3697975  1.078255   1.403309   1.9746892  1.576958   1.5214634
 2.913923   0.87557495 1.4445214  0.95124424 0.96339935 0.84972596
 2.1139302  0.7037375  0.5421221  0.7909851  5.741059   0.66953206
 1.0041094  0.8248165  2.8087769  0.79301095 0.76718724 0.87557477
 1.0781541  0.6602706  0.97509634 0.73453087 1.1404344  1.3551432
 4.0895915  1.6185302  1.4572111  0.6356876  1.3995844  0.61322147
 1.9953228  0.7929117  0.8255628  0.9462308  1.2701435  0.90420055
 1.8821634  0.6029998  2.56999    1.0938715  0.8248164  0.99343264
 1.071128   0.6271159  0.57613975 0.6171138  0.47082558 0.7037377
 0.62747276 0.7632046  0.5171416  1.9223148  0.44017813 0.76082367
 0.42242336 1.5660045  1.1074127  0.5454119  0.4377255  3.5729814
 0.34983265 0.69573444 0.5982008  0.42684427 0.69573593 0.34983185
 0.40874836 0.91399276 1.2833369  0.37675425 0.48875144 1.1015372
 1.107659   0.90437627 0.87069386 0.3733095  1.369882   1.5373762
 0.7043341  0.6204365  0.6658861  1.4570117  0.59986365 0.28497455
 0.3936222  1.1074156  1.301833   1.1074115  0.56437945 0.28802603
 1.0243115  0.85621184 0.69574666 0.35915422 0.497295   0.3109463
 0.4027311  1.554425   0.62006515 0.40277734 0.5827742  0.628064
 0.88712823 1.4511439  0.31251281 0.6893673  0.4079131  0.32860658
 0.31092802 0.735124   0.6659069  0.36103344 0.53803897 0.5637041
 1.336532   1.2922399  0.9184329  0.31094763 0.6646568  1.4412934
 0.28500926 0.59976906 0.69573385 0.41260865 0.36306688 1.02124
 0.28500265 0.49730763 0.6231739  1.446967   1.0184073  0.5275332
 0.8826479  0.56386906 0.6309299  0.28499806 0.42381904 2.500379
 0.52741057 0.35296017 0.56370986 0.59574443 0.6000041  0.60000193
 0.376671   1.149576   0.36661398 1.3406817  1.3019202  0.64684486
 0.38703844 0.6170387  0.40805557 0.286252   0.6320471  0.5175152
 0.28924024 0.3007706  1.0669273  0.3112981  1.3500286  0.4400376
 1.4091266  0.35915217 0.58070594 0.2852063  1.4082234  0.5663545
 0.58444583 1.1074127  0.5993502  1.2590706  0.58839726 0.8473006
 0.54713035 0.64670473 0.2892289  0.5838941  0.6467081  0.40333095
 0.6467007  0.665883   0.6410769  0.30074736 1.5150299  0.38703987
 0.40295812 0.28922892 0.28497007 0.4372786  1.3570219  0.33255196
 0.55548376 0.36948308 1.1014581  0.5335322  0.56363684 0.66591185
 0.6658898  0.30537638 0.46376556 0.40295798 0.28506663 0.33349028
 1.4646398  0.6802169  0.34709418 0.5636374  0.3178058  0.62008196
 0.5578082  0.5290809  0.34709504 0.30550057 0.42381957 0.388344
 0.6410491  0.52743834 0.62008595 0.60500973 0.31775612 0.6020545
 0.3653489  0.6000028  0.8444776  1.3784729  0.3467658  0.31775644
 0.55547196 0.44861582 0.7660225  0.3467658  0.76614267 0.6000479
 1.2874285  1.3093097  0.68676156 0.58495194 0.9267832  0.60000634
 0.381314   0.6246899  0.40558752 0.6000045  0.5216216  0.3795681
 0.4743206  0.59187716 0.3177689  0.55875665 1.5117307  1.0371763
 1.1495757  1.0518385  0.43159026 0.34378263 0.49412158 0.31778088
 1.3098663  0.60205257 0.6000023  0.6009842  0.28922635 0.3766575
 0.43612823 0.5871028  0.8680769  0.868079   0.58709055 0.58708465
 0.58708537 0.92976075 0.57327974 0.5870931  0.5870852  0.79212296
 0.5870859  0.29055488 1.3932033  0.60779154 0.6850105  1.1970547
 0.2978343  0.28205928 0.71238524 0.41691616 0.48132902 0.8680776
 0.39512673 1.3023416  0.5794998  0.9297657  0.84402645 0.8440562
 0.7753972  0.29783377 0.5871357  0.9267892  0.58708584 0.9297529
 0.28116408 0.36534673 0.57949334 0.5794961  0.6562747  0.3541989
 0.57949436 0.71206653 0.8680824  0.76608825 0.8680872  0.547313
 0.8361855  0.5110219  0.58715284 0.5471356  0.34628764 0.50659764
 0.3507999  0.2892289  0.5870932  0.58708453 0.60205203 0.6020527
 0.5471222  0.58708733 0.5794936  0.8695328  0.86847216 3.0880902
 0.38208765 1.3656306  0.5907363  0.5222207  0.556869   0.590787
 0.4772379  1.3869517  0.75415355 0.7910089  0.39349118 0.57201004
 0.6593278  0.58708465 0.86807275 0.9725191  0.3112874  0.64443296
 1.0949589  0.5400126  0.42587224 1.3841907  0.85176575 0.5870947
 0.79166466 0.5399665  0.5110757  0.51107925 0.80340874 0.80287117
 0.80227256 1.4859601  0.58592683 1.530112   0.30163246 0.6610368
 0.80300206 0.5859035  0.5532175  0.5115051  0.71190447 0.33129537
 0.51107234 1.0384399  0.802637   0.5110727  0.5859093  0.8030244
 0.802693   0.39472595 0.35408983 0.8022416  0.392618   0.39371035
 0.30943647 0.30194193 0.39371496 0.33315557 1.1474081  0.35161284
 0.30163136 0.35349977 1.1213093  0.3952404  0.73685163 0.39384034
 0.80429584 0.53196996 0.80219895 0.80290806 0.3016331  0.52995604
 0.3952404  0.4076646  0.4076687  0.5687656  0.4192794  0.4192812
 0.4192811  1.1005641  0.38297692 0.3829089  0.3829106  0.34286055
 0.45023048 0.4076647  0.34285784 0.5969026  0.40766487 0.46724093
 0.3147503  0.33310413 0.39619336 0.3331178  0.3330719  0.31475338
 0.33306834 0.5639898  0.31520557 0.31480524 0.35126653 0.35570037
 1.1719747  0.3556975  0.35126677 0.33412457 0.31501454 1.1719626
 0.38291067 0.33421746 0.33306685 0.33307236 0.40766576 0.34296563
 0.39619333 1.2245562  0.39371008 0.34323013 1.1527648  0.36186495
 0.40766457 1.1719779  0.47950134 0.3556973  0.3331157  0.40766424
 0.3437864  0.39371115 0.34286103 0.31485987 0.34328678 1.9727066
 0.59690297 0.34285817 0.34295565 0.39104205 0.34296033 0.38479957
 0.36186486 0.47950134 0.59690434 0.52895623 0.45265576 0.40766472
 0.47950125]
2025-06-03 10:10:28,186 - DEBUG - Edge reconstruction errors: [0.04239587 1.2427573  1.2444787  ... 0.0422416  0.04224121 1.1425318 ]
2025-06-03 10:10:28,187 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101028_update_10.json
2025-06-03 10:10:28,188 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:28,192 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101028_update_10.pth and as latest_checkpoint.pth
2025-06-03 10:10:28,192 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.3251
2025-06-03 10:10:28,192 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-03 10:10:28,192 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.0511, MLP Score: 0.5006
2025-06-03 10:10:28,192 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.0077, MLP Score: 0.4728
2025-06-03 10:10:28,192 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.9139, MLP Score: 0.4767
2025-06-03 10:10:28,192 - WARNING -   Node ID: 142.250.196.228, Recon Error: 2.1139, MLP Score: 0.4799
2025-06-03 10:10:28,192 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.7411, MLP Score: 0.4830
2025-06-03 10:10:28,192 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:28,192 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.4105, MLP Score: 0.4951
2025-06-03 10:10:28,192 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.3257, MLP Score: 0.5076
2025-06-03 10:10:28,192 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0478, MLP Score: 0.5081
2025-06-03 10:10:28,192 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.6546, MLP Score: 0.5179
2025-06-03 10:10:28,192 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.5986, MLP Score: 0.5018
2025-06-03 10:10:28,192 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-03 10:10:28,192 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-03 10:10:28,192 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-03 10:10:28,209 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-03 10:10:28,220 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-03 10:10:28,220 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-03 10:10:28,220 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-03 10:10:28,231 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-03 10:10:28,242 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-03 10:10:28,242 - INFO - Processing node updates/additions.
2025-06-03 10:10:28,244 - INFO - Processing edge updates/additions.
2025-06-03 10:10:28,250 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:28,251 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:28,251 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:28,252 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:28,257 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-03 10:10:28,258 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:28,259 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-03 10:10:28,260 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-03 10:10:28,260 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:28,263 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:28,264 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:28,264 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:28,265 - DEBUG - Shape of encoded categorical edge features: torch.Size([1118, 3])
2025-06-03 10:10:28,266 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:28,266 - DEBUG - Shape of scaled numerical edge features: torch.Size([1118, 7])
2025-06-03 10:10:28,266 - DEBUG - Final edge attributes tensor shape: torch.Size([1118, 10])
2025-06-03 10:10:28,266 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:28,268 - INFO - Performing online update...
2025-06-03 10:10:28,268 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:28,269 - DEBUG - Updated RunningStats: new_mean=0.9575009343992924, new_var=5400000000160.021, new_n=570
2025-06-03 10:10:28,269 - DEBUG - Updated RunningStats: new_mean=0.9464960917405976, new_var=5700000000019.1045, new_n=600
2025-06-03 10:10:28,269 - DEBUG - Updated RunningStats: new_mean=1.09693340685633, new_var=1800000000049.0686, new_n=190
2025-06-03 10:10:28,269 - DEBUG - Updated RunningStats: new_mean=1.0947313098145903, new_var=1900000000001.0383, new_n=200
2025-06-03 10:10:28,270 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:28,270 - DEBUG - Online update step: 1/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 2/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 3/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 4/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 5/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 6/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 7/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 8/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 9/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 10/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 11/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 12/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 13/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 14/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 15/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 16/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 17/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 18/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 19/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 20/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 21/50
2025-06-03 10:10:28,270 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,270 - DEBUG - Online update step: 22/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 23/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 24/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 25/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 26/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 27/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 28/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 29/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 30/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 31/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 32/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 33/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 34/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 35/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 36/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 37/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 38/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 39/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 40/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 41/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 42/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 43/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 44/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 45/50
2025-06-03 10:10:28,271 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,271 - DEBUG - Online update step: 46/50
2025-06-03 10:10:28,272 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,272 - DEBUG - Online update step: 47/50
2025-06-03 10:10:28,272 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,272 - DEBUG - Online update step: 48/50
2025-06-03 10:10:28,272 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,272 - DEBUG - Online update step: 49/50
2025-06-03 10:10:28,272 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,272 - DEBUG - Online update step: 50/50
2025-06-03 10:10:28,272 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:28,272 - WARNING - No successful steps during online update.
2025-06-03 10:10:28,272 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.7434632e-09 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7895410e-08
  2.3536751e-08  3.8356188e-08 -1.7870496e-08  3.0510605e-09
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -3.8356188e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.3947705e-08  2.1575357e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.0049825e-08  7.1481985e-08], current edge mean: [ 6.2075133e+00  1.4025044e+00  4.8944545e+00  1.7060363e-09
  2.9855636e-09 -2.1325455e-09  4.2650908e-10  0.0000000e+00
  8.5301816e-10 -2.9855636e-09]
2025-06-03 10:10:28,273 - DEBUG - Node drift difference: 0.0277, Edge drift difference: 0.0219
2025-06-03 10:10:28,273 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.7434632e-09 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7895410e-08
  2.3536751e-08  3.8356188e-08 -1.7870496e-08  3.0510605e-09
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -3.8356188e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.3947705e-08  2.1575357e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.0049825e-08  7.1481985e-08], edge=[ 6.2075133e+00  1.4025044e+00  4.8944545e+00  1.7060363e-09
  2.9855636e-09 -2.1325455e-09  4.2650908e-10  0.0000000e+00
  8.5301816e-10 -2.9855636e-09]
2025-06-03 10:10:28,274 - DEBUG - Updated reference std: node=[0.         0.         1.0009154  1.0009153  0.         0.
 0.         1.0009153  1.0009153  1.0009153  1.0009153  1.0009153
 1.0682304  0.30491748 0.34246618 0.56139016 1.0009153  3.063846
 2.9354372  1.4923851  0.34246618 0.         1.0009153  1.0009153
 0.         0.         0.         0.         1.0009153  1.0009153 ], edge=[1.1447818  0.49966237 1.8813379  1.0004475  1.0004475  1.0004475
 1.0004475  1.0004475  1.0004475  1.0004475 ]
2025-06-03 10:10:28,274 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:28,274 - INFO - Running anomaly detection...
2025-06-03 10:10:28,274 - INFO - Starting anomaly detection.
2025-06-03 10:10:28,289 - DEBUG - Node reconstruction errors: [0.76675886 0.62151146 0.7336497  0.43215242 0.76494616 2.1841726
 2.866226   0.5407999  1.081929   0.45177823 1.0482157  0.37921253
 0.78555316 0.7537052  0.7860958  1.3736056  0.5132316  0.4771506
 0.3771015  0.86726415 0.47715724 0.9295202  0.8533893  1.6661681
 2.188324   1.1591169  0.49758372 0.62100035 0.4771592  0.98587316
 0.41973263 1.1591605  1.4589176  2.1587615  1.6446176  1.4449313
 3.1390696  0.9391435  1.601021   0.99903613 1.0330385  0.8671199
 2.263092   0.7536865  0.6204714  0.9294468  6.2131643  0.720426
 1.098059   0.89462316 2.9942946  0.8534885  0.82714516 0.9391433
 1.1590637  0.7217082  1.047982   0.9021744  1.1912605  1.4789444
 4.327302   1.6558505  1.3341374  0.6746548  1.521433   0.6615614
 2.1343231  0.85338885 0.8953669  1.0272076  1.3382417  0.8909794
 2.0090163  0.6779864  2.657182   1.1041914  0.8946232  1.0550634
 1.1551464  0.6415036  0.6050991  0.67000574 0.52175003 0.7536867
 0.6437915  0.82111627 0.56187075 2.0832913  0.45247984 0.85407776
 0.46566316 1.6808777  1.1333029  0.6005125  0.48080787 3.8025339
 0.38552758 0.7216302  0.63974166 0.4643971  0.7761143  0.3855268
 0.434021   0.82307065 1.3363925  0.41835207 0.50851125 1.1609734
 1.1399642  0.92759293 0.9285849  0.40332282 1.4470454  1.6423904
 0.77560043 0.68437684 0.7368296  1.4674256  0.65946406 0.3226867
 0.42821482 1.1333051  1.3805956  1.1645371  0.6374696  0.31237218
 1.0674016  0.90156156 0.7761232  0.41861394 0.52533346 0.35261664
 0.444174   1.6242772  0.6840467  0.44396013 0.6656946  0.67405874
 0.9289618  1.5114024  0.34938163 0.7406548  0.43679965 0.36070716
 0.35260022 0.812573   0.7368465  0.40665233 0.58712363 0.6161688
 1.3976871  1.3273017  1.0022606  0.3526184  0.74380964 1.519416
 0.32271948 0.6427525  0.77611214 0.44469407 0.4086548  1.0504233
 0.32271582 0.52534604 0.69803613 1.5075849  1.1115962  0.5632505
 0.92523366 0.6163071  0.70258576 0.33487853 0.466597   2.6841877
 0.57187766 0.38783613 0.61617595 0.6591238  0.67377955 0.6737777
 0.41492277 1.1851758  0.40453577 1.4193327  1.4642838  0.7173696
 0.4331248  0.690574   0.44161636 0.32047775 0.69393426 0.56355125
 0.32360622 0.34617975 0.9288413  0.33482555 1.37719    0.46298754
 1.477164   0.38258082 0.6095627  0.3229151  1.4921333  0.62929547
 0.6618519  1.1333032  0.6333079  1.3066518  0.62492245 0.9218767
 0.61318654 0.7172459  0.3235971  0.6547535  0.7172481  0.4275304
 0.7172429  0.73682725 0.71669006 0.34615776 1.6249758  0.43312684
 0.4420905  0.32359704 0.32268283 0.49327102 1.4253632  0.37921703
 0.6176952  0.40133065 1.1427281  0.6090971  0.598241   0.736851
 0.7368334  0.32817072 0.5198752  0.44209012 0.32278088 0.36609784
 1.5367103  0.7797037  0.39277035 0.6161145  0.36503288 0.68406063
 0.60901314 0.5930307  0.39277083 0.35715878 0.4665974  0.43130085
 0.7166669  0.5829802  0.6840634  0.67711735 0.3162062  0.62175834
 0.40553814 0.6737785  0.8300382  1.413103   0.37648907 0.31617478
 0.61768514 0.4734888  0.8383286  0.37648907 0.83843    0.67381835
 1.3151268  1.3532957  0.742129   0.6217717  1.0032883  0.6737821
 0.41524556 0.6790416  0.41500747 0.5792687  0.6108578  0.41811955
 0.5278123  0.61807233 0.36500156 0.58868504 1.5660325  1.0339357
 1.1851755  1.0755264  0.53622633 0.3913598  0.5402409  0.3650112
 1.3514163  0.6435919  0.5400526  0.6746393  0.32796735 0.4162182
 0.49097702 0.62444264 0.9325298  0.9325315  0.6244313  0.62442577
 0.6244256  1.0024264  0.60622543 0.6244336  0.62442595 0.7578229
 0.6244268  0.31727406 1.4317925  0.66445297 0.73682785 1.2192999
 0.32818118 0.32825387 0.7770182  0.45779127 0.54346675 0.9325306
 0.4382232  1.3766067  0.61696947 1.0024314  0.9110985  0.91112316
 0.8542776  0.3281807  0.6244741  1.0032943  0.62442684 1.002421
 0.3125571  0.40553632 0.6169628  0.6169657  0.6992573  0.39549443
 0.6169635  0.776734   0.65549254 0.83838314 0.9325378  0.57287997
 0.9143693  0.56496245 0.62449324 0.5911507  1.1083506  0.5629665
 0.38865557 0.31620774 0.607598   0.6244253  0.64359134 0.64359224
 0.61317915 0.62442756 0.61696297 0.9337583  0.9328731  3.2289116
 0.41417536 1.3868077  0.65234715 0.6131828  0.68365777 0.65239006
 0.5288814  1.4164563  0.80884135 0.8585223  0.429085   0.62137866
 0.7276295  0.6244257  0.9325265  1.0169071  0.3523096  0.6861098
 1.1201686  0.6033894  0.47384307 1.4303234  0.9249485  0.624435
 0.8402382  0.60335046 0.5655955  0.5655982  0.86355114 0.86308384
 0.8625575  1.5755407  0.6181728  1.6186547  0.34365943 0.70959085
 0.86319935 0.61815035 0.6757024  0.5659651  0.7692228  0.3769726
 0.5655924  1.0799137  0.8628794  0.56559265 0.61815625 0.86321545
 0.8629252  0.4266637  0.39187524 0.8625327  0.4282102  0.42518553
 0.34757367 0.34393376 0.42518964 0.37420338 1.3878039  0.38025868
 0.32137567 0.6418833  1.1492136  0.4183644  0.7905986  0.43949094
 0.8643313  0.54664516 0.8624963  0.86311555 0.3436611  0.5888862
 1.414613   0.43319124 0.43319437 0.609267   0.44064024 0.44064206
 0.44064173 1.1346155  0.4035837  0.40352613 0.40352577 0.37564358
 0.48643902 0.43319157 0.37564155 0.62313586 0.4331916  0.48937854
 0.35105523 0.37415695 0.4222393  0.37417057 0.37412873 0.351057
 0.37412506 1.1608793  0.3514676  0.3511035  0.38414916 0.38224676
 1.1996127  0.38224414 0.38414916 0.37513277 0.35132045 1.199599
 0.40352574 0.37522995 0.37412363 0.37412873 0.43319264 0.37583306
 0.4229122  1.2514886  0.4251853  0.37597194 1.1826159  0.3895674
 0.43319163 1.1996168  0.49612656 0.38224363 0.37416765 0.43319097
 0.37654266 0.42518568 0.3756443  0.3511543  0.376162   2.0616493
 0.6231363  0.3756781  0.37572828 0.41770083 0.3757325  0.41508755
 0.38956735 0.49612656 0.6231474  0.55399406 0.47156528 0.4331916
 0.49612662 0.6231364  0.6075058  0.43319967 0.6231365  0.4331927
 0.623136   0.623136   0.43319118 0.6074045  0.623142   0.59331673
 0.62313634 0.40352517 0.38956937 0.43319404 0.60740954 1.258432
 0.62314105 0.48644656 0.4331916  0.6231365  0.6231373  0.37564236
 0.37630758 0.507314   0.7749987  0.3756472  0.6231391  0.50734407
 0.6231397  0.5073275  0.4332732  0.62314355 0.6075335  0.60776633
 0.62313735]
2025-06-03 10:10:28,289 - DEBUG - Edge reconstruction errors: [0.04501607 1.2453485  1.2488447  ... 0.04489108 0.04489071 1.1452726 ]
2025-06-03 10:10:28,291 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101028_update_11.json
2025-06-03 10:10:28,291 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:28,296 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101028_update_11.pth and as latest_checkpoint.pth
2025-06-03 10:10:28,296 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.3235
2025-06-03 10:10:28,296 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-03 10:10:28,296 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.1842, MLP Score: 0.5024
2025-06-03 10:10:28,296 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.8662, MLP Score: 0.4859
2025-06-03 10:10:28,296 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.1883, MLP Score: 0.4750
2025-06-03 10:10:28,296 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.1588, MLP Score: 0.4998
2025-06-03 10:10:28,296 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.1391, MLP Score: 0.4742
2025-06-03 10:10:28,296 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:28,297 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.7154, MLP Score: 0.4971
2025-06-03 10:10:28,297 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.7835, MLP Score: 0.5094
2025-06-03 10:10:28,297 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.8733, MLP Score: 0.5049
2025-06-03 10:10:28,297 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.3761, MLP Score: 0.5173
2025-06-03 10:10:28,297 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.4536, MLP Score: 0.5005
2025-06-03 10:10:28,297 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:28,297 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:28,297 - INFO - Starting visualization of node features.
2025-06-03 10:10:28,297 - INFO - Graph has 547 nodes and 30 features.
2025-06-03 10:10:28,298 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:28,298 - INFO - Calculating feature statistics:
2025-06-03 10:10:28,298 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,298 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,298 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5481575), 'max': np.float32(1.3595055)}
2025-06-03 10:10:28,298 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.3379294), 'max': np.float32(2.591279)}
2025-06-03 10:10:28,298 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,298 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,298 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,298 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.0460779e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.41691694), 'max': np.float32(2.398559)}
2025-06-03 10:10:28,298 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(2.9638873e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3276393), 'max': np.float32(0.7532166)}
2025-06-03 10:10:28,298 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(2.789541e-08), 'std': np.float32(0.9999999), 'min': np.float32(-8.166651), 'max': np.float32(0.12557776)}
2025-06-03 10:10:28,299 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-3.7928014), 'max': np.float32(0.7891658)}
2025-06-03 10:10:28,299 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-0.77910113), 'max': np.float32(3.8437746)}
2025-06-03 10:10:28,299 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.4442413), 'std': np.float32(1.0672535), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:28,299 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.952468), 'std': np.float32(0.30463862), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:28,299 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.12065814), 'std': np.float32(0.34215298), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:28,299 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3254113), 'std': np.float32(0.5608768), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:28,299 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-2.789541e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12557776), 'max': np.float32(8.166651)}
2025-06-03 10:10:28,299 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3436928), 'std': np.float32(3.0610442), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:28,299 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6709323), 'std': np.float32(2.9327526), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:28,299 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6106033), 'std': np.float32(1.4910204), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:28,299 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.12065814), 'std': np.float32(0.34215298), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:28,299 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:10:28,299 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.14127478), 'max': np.float32(13.495896)}
2025-06-03 10:10:28,299 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-0.15602747), 'max': np.float32(6.409128)}
2025-06-03 10:10:28,299 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,299 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,300 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,300 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:28,300 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0949515), 'max': np.float32(8.565346)}
2025-06-03 10:10:28,300 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(4.881697e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.2455094), 'max': np.float32(4.400571)}
2025-06-03 10:10:28,318 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c377f260>
2025-06-03 10:10:28,458 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:28,517 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:28,547 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:29,764 - INFO - Node feature visualization saved to vis/node_features_20250603_101028.png
2025-06-03 10:10:29,764 - INFO - Finished visualization of node features.
2025-06-03 10:10:29,764 - INFO - Performing additional feature analysis:
2025-06-03 10:10:29,764 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:29,765 - INFO - Starting visualization of edge features.
2025-06-03 10:10:29,765 - INFO - Graph has 1118 edges and 10 edge features.
2025-06-03 10:10:29,765 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:29,765 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:29,766 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:29,766 - INFO - - count: {'name': 'count', 'unique': 15, 'mean': np.float32(6.2075133), 'std': np.float32(1.1442697), 'min': np.float32(0.0), 'max': np.float32(14.0)}
2025-06-03 10:10:29,766 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4025044), 'std': np.float32(0.49943885), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:29,766 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.8944545), 'std': np.float32(1.8804963), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-03 10:10:29,766 - INFO - - service: {'name': 'service', 'unique': 22, 'mean': np.float32(5.118109e-09), 'std': np.float32(1.0), 'min': np.float32(-0.051895097), 'max': np.float32(26.151205)}
2025-06-03 10:10:29,766 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 744, 'mean': np.float32(3.4120726e-09), 'std': np.float32(1.0), 'min': np.float32(-0.071058035), 'max': np.float32(25.977112)}
2025-06-03 10:10:29,766 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 796, 'mean': np.float32(6.8241452e-09), 'std': np.float32(1.0), 'min': np.float32(-0.066338696), 'max': np.float32(26.158375)}
2025-06-03 10:10:29,766 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 269, 'mean': np.float32(-3.4120726e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.059648167), 'max': np.float32(26.113943)}
2025-06-03 10:10:29,766 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 771, 'mean': np.float32(-1.7060363e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11723028), 'max': np.float32(17.794384)}
2025-06-03 10:10:29,766 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 793, 'mean': np.float32(-1.7060363e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11607735), 'max': np.float32(16.786764)}
2025-06-03 10:10:29,766 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 290, 'mean': np.float32(-8.5301816e-10), 'std': np.float32(1.0), 'min': np.float32(-0.06889698), 'max': np.float32(25.622356)}
2025-06-03 10:10:29,776 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c31e9220>
2025-06-03 10:10:29,995 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:30,007 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c34f8c50>
2025-06-03 10:10:30,102 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:30,242 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:30,339 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:30,354 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:30,360 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:31,591 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101030.png
2025-06-03 10:10:31,591 - INFO - Finished visualization of edge features.
2025-06-03 10:10:31,591 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:31,591 - INFO - - Highest correlation (1.00) between features: 'total_orig_bytes' and 'total_orig_ip_bytes'.
2025-06-03 10:10:31,592 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:31,592 - INFO - Graph has 1118 edges and 10 edge features.
2025-06-03 10:10:31,592 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:31,874 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101031_summary.png
2025-06-03 10:10:32,098 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101031_pca_3d.png
2025-06-03 10:10:32,260 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101031_pca_variance.png
2025-06-03 10:10:32,260 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:32,260 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-03 10:10:32,260 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-03 10:10:32,260 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-03 10:10:32,275 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-03 10:10:32,286 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-03 10:10:32,287 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-03 10:10:32,287 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-03 10:10:32,297 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-03 10:10:32,310 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-03 10:10:32,310 - INFO - Processing node updates/additions.
2025-06-03 10:10:32,313 - INFO - Processing edge updates/additions.
2025-06-03 10:10:32,319 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:32,320 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:32,320 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:32,321 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:32,327 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-03 10:10:32,330 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:32,331 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-03 10:10:32,332 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-03 10:10:32,333 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:32,337 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:32,339 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:32,340 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:32,341 - DEBUG - Shape of encoded categorical edge features: torch.Size([1300, 3])
2025-06-03 10:10:32,341 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:32,341 - DEBUG - Shape of scaled numerical edge features: torch.Size([1300, 7])
2025-06-03 10:10:32,342 - DEBUG - Final edge attributes tensor shape: torch.Size([1300, 10])
2025-06-03 10:10:32,342 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:32,344 - INFO - Performing online update...
2025-06-03 10:10:32,344 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:32,345 - DEBUG - Updated RunningStats: new_mean=0.9565190948573316, new_var=6000000000161.073, new_n=630
2025-06-03 10:10:32,345 - DEBUG - Updated RunningStats: new_mean=0.9465014085989958, new_var=6300000000018.955, new_n=660
2025-06-03 10:10:32,345 - DEBUG - Updated RunningStats: new_mean=1.1023045446854804, new_var=2000000000049.2114, new_n=210
2025-06-03 10:10:32,345 - DEBUG - Updated RunningStats: new_mean=1.0995411624241123, new_var=2100000000000.9634, new_n=220
2025-06-03 10:10:32,345 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:32,345 - DEBUG - Online update step: 1/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 2/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 3/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 4/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 5/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 6/50
2025-06-03 10:10:32,345 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,345 - DEBUG - Online update step: 7/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 8/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 9/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 10/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 11/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 12/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 13/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 14/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 15/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 16/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 17/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 18/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 19/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 20/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 21/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 22/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 23/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 24/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 25/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 26/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 27/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 28/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 29/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 30/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 31/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 32/50
2025-06-03 10:10:32,346 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,346 - DEBUG - Online update step: 33/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 34/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 35/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 36/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 37/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 38/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 39/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 40/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 41/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 42/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 43/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 44/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 45/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 46/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 47/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 48/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 49/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - DEBUG - Online update step: 50/50
2025-06-03 10:10:32,347 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,347 - WARNING - No successful steps during online update.
2025-06-03 10:10:32,348 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.4901161e-08  3.2782555e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1175871e-08
  3.8743018e-08  1.1920929e-08  2.9802323e-09  1.1920929e-08
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -1.1920929e-08  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  4.4703484e-08  5.5879354e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.3644179e-08  2.9802322e-08], current edge mean: [ 6.1853848e+00  1.4076923e+00  4.9446154e+00  0.0000000e+00
 -7.3359563e-10  0.0000000e+00  0.0000000e+00  1.4671913e-09
 -7.3359563e-09  0.0000000e+00]
2025-06-03 10:10:32,348 - DEBUG - Node drift difference: 0.1134, Edge drift difference: 0.0267
2025-06-03 10:10:32,349 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.4901161e-08  3.2782555e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1175871e-08
  3.8743018e-08  1.1920929e-08  2.9802323e-09  1.1920929e-08
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -1.1920929e-08  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  4.4703484e-08  5.5879354e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.3644179e-08  2.9802322e-08], edge=[ 6.1853848e+00  1.4076923e+00  4.9446154e+00  0.0000000e+00
 -7.3359563e-10  0.0000000e+00  0.0000000e+00  1.4671913e-09
 -7.3359563e-09  0.0000000e+00]
2025-06-03 10:10:32,349 - DEBUG - Updated reference std: node=[0.         0.         1.0007821  1.0007823  0.         0.
 0.         1.0007821  1.0007821  1.0007821  1.0007821  1.0007821
 1.0366606  0.29277956 0.3543513  0.5707029  1.0007821  3.053545
 2.915992   1.4961315  0.3543513  0.         1.0007821  1.0007821
 0.         0.         0.         0.         1.0007821  1.0007821 ], edge=[1.0811287  0.50090224 1.8303767  1.0003848  1.0003848  1.0003848
 1.0003848  1.0003848  1.0003848  1.0003848 ]
2025-06-03 10:10:32,349 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:32,349 - INFO - Running anomaly detection...
2025-06-03 10:10:32,349 - INFO - Starting anomaly detection.
2025-06-03 10:10:32,433 - DEBUG - Node reconstruction errors: [0.9459902  0.7391128  0.8908152  0.50538385 0.94058776 2.7064133
 2.9367447  0.60466236 1.1824765  0.5727939  1.2352908  0.4754699
 0.94440824 0.9060317  0.9580223  1.5373577  0.61649096 0.59760016
 0.4873996  1.0462594  0.5976077  1.137669   1.010753   1.8764632
 2.6408117  1.3664854  0.614889   0.7381447  0.5976106  1.1637965
 0.535876   1.3665372  1.6177413  2.5779967  1.8062192  1.5956818
 3.546627   1.0980239  1.950067   1.1066772  1.203159   1.0355518
 2.4522147  0.9060137  0.7837919  1.122857   6.916159   0.8648064
 1.2868333  1.0700706  3.3056495  1.010851   0.9852726  1.0980238
 1.3664211  0.89599544 1.2197788  0.9434723  1.4325662  1.6859517
 4.74542    1.7766937  1.5488707  0.79822266 1.728615   0.7475535
 2.3935964  1.0107524  1.0709453  1.238371   1.5040189  0.94324887
 2.3721497  0.83371663 2.056421   1.222198   1.0700705  1.1888733
 1.4187077  0.9197238  0.7061288  0.8395594  0.64183885 0.90601385
 0.9077352  1.0019281  0.6506564  2.5107498  0.4716684  1.044194
 0.5614722  2.0060444  1.2042367  0.73492163 0.61574256 4.2805142
 0.45837915 0.8896112  0.77673125 0.5681838  0.9564372  0.4583786
 0.49869725 0.9696916  1.4543229  0.52438366 0.6082514  1.311555
 1.2193437  0.9497653  1.0497935  0.47623932 1.6632378  1.9786929
 0.946591   0.83328384 0.8980127  1.6552831  0.7983769  0.6331304
 0.5139919  1.2042408  1.612425   1.2537477  0.62548447 0.63319266
 1.1695687  1.0296127  0.86771977 0.4687539  0.6574324  0.46001142
 0.54341036 1.8466638  0.8329427  0.55376035 0.74891573 0.8148152
 1.0533901  1.6758627  0.4519109  0.8683213  0.5132282  0.45578167
 0.45998943 0.987518   0.89803046 0.52196276 0.75025207 0.74178475
 1.5044764  1.4319974  1.215628   0.46001416 0.9019609  1.7679291
 0.4219887  0.78548586 0.9564342  0.51715034 0.52444434 1.1486931
 0.42198497 0.6582641  0.86530584 1.6720777  1.3534764  0.6751267
 1.0507518  0.7072469  0.8574565  0.42810592 0.5646363  3.0967703
 0.6963127  0.4869709  0.84623224 0.8045647  0.8311193  0.8311175
 0.5180333  1.272812   0.49557906 1.6304896  1.6276754  0.8717382
 0.50231946 0.85089034 0.54763925 0.4177036  0.8518221  0.6745661
 0.40691632 0.45766193 1.0532609  0.41343984 1.4016407  0.5290116
 1.6810063  0.4422719  0.7183556  0.4222364  1.810952   0.77205503
 0.8343764  1.204238   0.7771484  1.4419419  0.7580828  1.1243693
 0.76127297 0.8716074  0.40672693 0.884846   0.8716093  0.49680206
 0.87957406 0.8980101  0.8952351  0.45763338 1.9908137  0.50232154
 0.534818   0.4067269  0.42194235 0.61988014 1.6365211  0.49835145
 0.75149083 0.47444215 1.2369157  0.6065716  0.6976386  0.8980371
 0.89801663 0.40501252 0.6498247  0.53481793 0.42206702 0.43890342
 1.7589397  0.9389831  0.5047827  0.7417275  0.47344425 0.6246145
 0.7463083  0.68942326 0.5047829  0.45373204 0.56463706 0.52987754
 0.89520705 0.71207136 0.8329608  0.8451216  0.41260377 0.74774855
 0.49756572 0.83111805 0.97530466 1.5006019  0.4517586  0.4125657
 0.7514802  0.6066317  1.035764   3.283891   1.0358638  0.8311595
 1.4847192  1.5478904  0.8956232  0.76866245 1.2254506  0.8311227
 0.49994707 0.79511887 0.5181326  0.71392655 2.772669   0.5108122
 0.6508463  0.72348    0.61000997 0.70315564 2.2002     1.129669
 1.2728124  1.1648316  0.61164504 0.44560403 0.69622666 0.4734165
 1.4369258  0.78167266 0.6483187  0.83201313 0.40475938 0.5068961
 0.618478   0.7614315  1.1318092  1.1318105  0.7604038  0.76013005
 0.7601489  1.2121171  0.73967105 0.7608221  0.76016086 0.88579714
 0.7602161  0.40303478 1.5721619  0.8050299  0.87088215 1.2688965
 0.41627705 0.4051157  0.9623385  0.58751994 0.6793078  1.1318101
 0.55611414 1.5803198  0.75348246 1.21212    1.1076925  1.1077179
 1.0580571  0.4205721  0.7642707  1.2254567  0.76022357 1.2121109
 0.6034576  0.497564   0.7531523  0.7533872  0.8549109  0.49091557
 0.7531662  0.9620629  0.8088486  1.0358164  1.1318183  0.68363994
 1.1193446  0.68731016 0.7668636  0.7235289  1.2614781  0.79650325
 0.48003787 0.41260523 0.7503174  0.7601023  0.78167194 0.7816727
 0.7612658  0.71222913 0.8406001  0.8544174  1.1321483  3.6439493
 0.49202964 1.7237183  0.79264045 0.7158139  0.8182232  0.68132794
 0.71145266 1.5519383  0.97128135 1.0640067  0.5137598  0.7874758
 0.89634717 0.76013    1.131806   1.1395373  0.43655545 0.7882757
 1.2074134  0.74538934 0.59183747 1.5309886  1.1374604  0.76075405
 0.95542103 0.74535114 0.6926895  0.6926916  1.0529188  1.0524747
 1.0519753  1.7059197  0.7512546  1.7582135  0.44790182 0.8211481
 1.0525839  0.7494278  0.82739264 0.6930317  0.9432475  0.48923314
 0.69268674 1.2012621  1.052281   0.6926867  0.749971   1.0525995
 1.0523243  0.5029476  0.47870865 1.051951   0.5128847  0.4898207
 0.44748196 0.4482245  0.71079946 0.47991678 1.5516546  0.4682264
 0.4193389  0.755206   1.2382133  0.47749263 0.9541572  0.55027026
 1.0536555  0.67211026 1.0519153  1.052506   0.44790286 0.5984103
 1.529833   0.6916666  0.4915628  0.7618632  0.4970932  0.4970951
 0.49709478 1.2217308  0.8061772  0.47609568 0.47609523 0.47240466
 0.57740337 0.4982795  0.47240195 0.749482   0.4982794  0.5700473
 0.44957224 0.43730804 0.48473772 0.71064544 0.743792   0.44957468
 0.47982323 1.4556305  0.43791157 0.44963104 0.46007144 0.7106422
 1.285772   0.46446568 0.46007282 0.7443679  0.66739386 1.5717814
 0.5977361  0.7143303  0.7438129  0.74379194 0.49155113 0.4726424
 0.48039848 1.7232472  0.5007681  0.4728154  1.6071086  0.4584774
 0.4982795  1.250322   0.5442185  0.7920819  0.7106431  0.49154902
 0.68762344 0.5007689  0.72274303 0.43869978 0.72269577 2.2506194
 0.7495005  0.47244745 0.47250998 0.48983666 0.47251594 0.48977295
 0.45847562 0.5442185  0.74498695 0.8401085  0.53662914 0.49827912
 0.5442192  0.73497784 0.73479396 0.49828818 1.0551798  0.49828047
 0.77087754 0.74951303 0.4982792  0.8842667  0.7499052  0.76051396
 0.7435978  0.47609442 0.45856416 0.49828193 0.7214684  1.3309438
 0.7499532  0.57741064 0.4982794  0.7495097  0.74955887 0.47240326
 0.72283536 0.62557656 0.8991315  0.6866309  0.7496427  0.62560517
 0.7497797  0.6255894  0.6968883  0.7501529  0.73571885 0.73624146
 0.7379406  0.76012474 2.091969   0.7600502  0.7603311  0.76012146
 0.7600142  0.7600865  0.7601498  0.760102   0.7600137  0.76655567
 0.58106357 0.7603422  0.75999194 0.76008594 0.7600285  0.76012576
 0.7599886  0.7601829  0.7601096  0.7599842  0.76005864 0.7617057
 0.7599809  0.76003784 0.7601393  0.49827927 0.3852452  0.74950427
 0.38248014 0.6385773  0.92390215 0.92390215 0.6216097  0.38248014
 0.7495924  0.74349564 0.7438152  0.7495219  0.7455658  0.74954796
 0.7505496  0.7599698  0.7598259  0.749513   0.7353695  0.7495049
 0.749679   0.7491672  0.7495379  0.7434923  0.74950665 0.7495917
 0.743535   0.74357814 0.7496115  0.7463365  0.74961865 0.74950045
 0.74952465 0.9222476  0.6783851  0.6783904  0.759985   0.86274815
 0.4409683  0.7496545  0.74499047 0.7599937  0.7614721  0.74348587
 0.62345964 0.7512894  0.74949896 0.74950224 0.50618374 0.9233968
 0.67838836 0.7499375  0.7600204  0.74677616 0.7437772  1.666018
 0.7599911  0.7483929  0.7506146  0.7600802  0.76224256 0.7599846
 0.7495191  0.7495483  1.0028785  0.6783952 ]
2025-06-03 10:10:32,433 - DEBUG - Edge reconstruction errors: [0.04539973 1.245754   1.2494761  ... 0.04526683 0.04526655 1.1456724 ]
2025-06-03 10:10:32,435 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101032_update_12.json
2025-06-03 10:10:32,435 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:32,442 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101032_update_12.pth and as latest_checkpoint.pth
2025-06-03 10:10:32,442 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.3245
2025-06-03 10:10:32,442 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 10:10:32,442 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.7064, MLP Score: 0.5060
2025-06-03 10:10:32,443 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.9367, MLP Score: 0.4905
2025-06-03 10:10:32,443 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.6408, MLP Score: 0.4800
2025-06-03 10:10:32,443 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.5780, MLP Score: 0.4992
2025-06-03 10:10:32,443 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.5466, MLP Score: 0.4696
2025-06-03 10:10:32,443 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:32,443 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.1259, MLP Score: 0.4919
2025-06-03 10:10:32,443 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.0563, MLP Score: 0.5053
2025-06-03 10:10:32,443 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0404, MLP Score: 0.5022
2025-06-03 10:10:32,443 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.6424, MLP Score: 0.5155
2025-06-03 10:10:32,444 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.5998, MLP Score: 0.4984
2025-06-03 10:10:32,444 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-03 10:10:32,444 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-03 10:10:32,444 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-03 10:10:32,459 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-03 10:10:32,472 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-03 10:10:32,472 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-03 10:10:32,472 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-03 10:10:32,484 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-03 10:10:32,496 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-03 10:10:32,496 - INFO - Processing node updates/additions.
2025-06-03 10:10:32,499 - INFO - Processing edge updates/additions.
2025-06-03 10:10:32,505 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:32,505 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:32,505 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:32,506 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:32,511 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-03 10:10:32,513 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:32,513 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-03 10:10:32,514 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-03 10:10:32,514 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:32,517 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:32,517 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:32,518 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:32,519 - DEBUG - Shape of encoded categorical edge features: torch.Size([1355, 3])
2025-06-03 10:10:32,520 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:32,520 - DEBUG - Shape of scaled numerical edge features: torch.Size([1355, 7])
2025-06-03 10:10:32,520 - DEBUG - Final edge attributes tensor shape: torch.Size([1355, 10])
2025-06-03 10:10:32,520 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:32,521 - INFO - Performing online update...
2025-06-03 10:10:32,521 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:32,522 - DEBUG - Updated RunningStats: new_mean=0.9556565620993513, new_var=6600000000160.491, new_n=690
2025-06-03 10:10:32,522 - DEBUG - Updated RunningStats: new_mean=0.9466222373784565, new_var=6900000000019.211, new_n=720
2025-06-03 10:10:32,522 - DEBUG - Updated RunningStats: new_mean=1.1062545169688205, new_var=2200000000049.1313, new_n=230
2025-06-03 10:10:32,522 - DEBUG - Updated RunningStats: new_mean=1.1034876450640858, new_var=2300000000000.9478, new_n=240
2025-06-03 10:10:32,522 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:32,522 - DEBUG - Online update step: 1/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 2/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 3/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 4/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 5/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 6/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 7/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,522 - DEBUG - Online update step: 8/50
2025-06-03 10:10:32,522 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 9/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 10/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 11/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 12/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 13/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 14/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 15/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 16/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 17/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 18/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 19/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 20/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 21/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 22/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 23/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 24/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 25/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 26/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 27/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 28/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 29/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 30/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 31/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,523 - DEBUG - Online update step: 32/50
2025-06-03 10:10:32,523 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 33/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 34/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 35/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 36/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 37/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 38/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 39/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 40/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 41/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 42/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 43/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 44/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 45/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 46/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 47/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 48/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 49/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - DEBUG - Online update step: 50/50
2025-06-03 10:10:32,524 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,524 - WARNING - No successful steps during online update.
2025-06-03 10:10:32,525 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.6511267e-08 -7.8134114e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.2413831e-08
  4.6916981e-08  5.8418030e-09 -6.9371411e-09 -8.3975920e-09
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  3.0669465e-08  2.1906761e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6288113e-08 -3.8336832e-08], current edge mean: [ 6.1793356e+00  1.4169742e+00  4.9431734e+00 -4.2229122e-09
 -1.4076373e-09 -1.4076373e-09  1.4076373e-09 -4.9267306e-09
  5.2786402e-09 -1.4780192e-08]
2025-06-03 10:10:32,525 - DEBUG - Node drift difference: 0.0281, Edge drift difference: 0.0185
2025-06-03 10:10:32,525 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.6511267e-08 -7.8134114e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.2413831e-08
  4.6916981e-08  5.8418030e-09 -6.9371411e-09 -8.3975920e-09
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  3.0669465e-08  2.1906761e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6288113e-08 -3.8336832e-08], edge=[ 6.1793356e+00  1.4169742e+00  4.9431734e+00 -4.2229122e-09
 -1.4076373e-09 -1.4076373e-09  1.4076373e-09 -4.9267306e-09
  5.2786402e-09 -1.4780192e-08]
2025-06-03 10:10:32,526 - DEBUG - Updated reference std: node=[0.         0.         1.0007665  1.0007666  0.         0.
 0.         1.0007665  1.0007665  1.0007665  1.0007665  1.0007666
 1.0142448  0.28991058 0.3638549  0.56661487 1.0007665  3.0958197
 2.9316137  1.5298709  0.3638549  0.         1.0007666  1.0007666
 0.         0.         0.         0.         1.0007666  1.0007665 ], edge=[1.0690424  0.50653744 1.8203317  1.0003692  1.0003692  1.0003692
 1.0003692  1.0003692  1.0003692  1.0003692 ]
2025-06-03 10:10:32,526 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:32,526 - INFO - Running anomaly detection...
2025-06-03 10:10:32,526 - INFO - Starting anomaly detection.
2025-06-03 10:10:32,547 - DEBUG - Node reconstruction errors: [0.9778677  0.7627838  0.9205674  0.52229875 0.97260284 2.7693458
 2.9464107  0.6168508  1.2069741  0.59223515 1.267583   0.49084404
 0.97420764 0.9356995  0.98879325 1.6057912  0.6373344  0.6168554
 0.50463384 1.0721523  0.61686313 1.1695377  1.0408162  1.9283994
 2.6795866  1.3959725  0.6297147  0.7611984  0.61686605 1.1885465
 0.5512501  1.3960266  1.6525623  2.6485868  1.8404392  1.6172222
 3.6370342  1.1275542  1.8276839  1.1221712  1.2324318  1.0698354
 2.4764197  0.9356801  0.80092716 1.0842677  7.077589   0.89125323
 1.3191602  1.1003487  3.3759675  1.0409129  1.0155681  1.1275543
 1.3959054  0.9268309  1.2495414  0.9569813  1.4490381  1.7318833
 4.8535094  1.8054726  1.5766463  0.82418084 1.7750952  0.7652979
 2.4480355  1.0408156  1.1012527  1.2695487  1.5394938  0.9564545
 2.4920878  0.862704   2.1051178  1.23716    1.1003484  1.2081826
 1.455202   0.998027   0.8540685  0.8645255  0.65692097 0.935681
 0.9305233  1.032327   0.66938084 2.5399387  0.48624575 1.0762793
 0.5814305  2.0611098  1.2240529  0.7610109  0.63819873 4.361661
 0.474362   0.89522755 0.80531794 0.5859641  0.988848   0.47436172
 0.5138126  0.7956036  1.4822278  0.541544   0.6220247  1.3337075
 1.2404581  0.9765303  1.0880624  0.4928621  1.6952016  2.020396
 0.9781424  0.8632269  0.92927283 1.6842848  0.82607716 0.65347844
 0.533008   1.224056   1.6450807  1.277756   0.6488435  0.65363884
 1.19418    1.0503863  0.89746475 0.48171014 0.67932564 0.47670045
 0.56284106 1.8791537  0.8628826  0.57102704 0.76846814 0.84313107
 1.0738926  1.703072   0.46777254 0.8984803  0.5311529  0.471058
 0.4852659  1.0203611  0.9292925  0.5401371  0.77916896 0.767739
 1.535088   1.4545611  1.2565562  0.4767026  0.9312261  1.9867706
 0.43752682 0.8117845  0.9888459  0.53345734 0.542701   1.164676
 0.43752262 0.6802098  0.89666235 1.6992433  1.3983442  0.69884104
 1.0712264  0.730645   0.88692564 0.4424787  0.5849014  3.169491
 0.71677554 0.50313425 0.87559503 0.8331844  0.8620087  0.8620066
 0.5348104  1.2944041  0.51527363 1.6613902  1.6542412  0.9012932
 0.51927495 0.88217604 0.5649521  0.43363062 0.88286453 0.69725055
 0.41961604 0.47599828 1.0737612  0.42465076 1.4332217  0.5454337
 1.7120013  0.45674497 0.74276483 0.43778402 1.8439449  0.8000678
 0.86546004 1.224053   0.8023886  1.4616201  0.786867   1.163894
 0.789641   0.90115994 0.41931805 0.91132754 0.9011619  0.51318127
 0.9096357  0.9292709  0.9261059  0.47596842 2.0316675  0.5192773
 0.55456007 0.4193167  0.43747845 0.6459688  1.6601161  0.51693976
 0.77874786 0.4887626  1.259232   0.62630236 0.64438367 0.929299
 0.9292775  0.41586998 0.67620933 0.55456    0.43760812 0.45526955
 1.790824   0.97061926 0.5215752  0.7676806  0.49022177 0.64443326
 0.77195656 0.7160038  0.52157605 0.4691736  0.5849013  0.54932517
 0.926081   0.7381668  0.86290103 0.876364   0.42836952 0.7747586
 0.51698935 0.86200744 1.0072953  1.5231706  0.46666825 0.42833123
 0.77873766 0.62971526 1.0747566  3.334916   1.0748565  0.8620497
 1.5100192  1.5771906  0.9261342  0.7390149  1.2682761  0.86201155
 0.5190971  0.8190785  0.5349122  0.73977846 2.8060186  0.53100693
 0.6926887  0.7466404  0.6313303  0.72782433 2.2558806  1.1453462
 1.2944038  1.1866753  0.63311726 0.45926    0.7215922  0.49019286
 1.4614085  0.8102171  0.6708002  0.8629107  0.41560662 0.52594274
 0.6382683  0.7906171  1.1718632  1.1718643  0.78954583 0.7892624
 0.789283   1.254107   0.7679599  0.78998333 0.78929514 0.91437113
 0.78935224 0.41550824 1.6028438  0.8337363  0.89375687 1.2848947
 0.42954102 0.41597468 1.0001007  0.60954833 0.7065309  1.1718639
 0.5721495  1.6106731  0.7826143  1.2541112  1.1464183  1.1464427
 1.0939486  0.43107024 0.79353774 1.2682809  0.7893595  1.2541019
 0.6287749  0.51698756 0.7822729  0.7825183  0.8871844  0.5105999
 0.7822878  0.999824   0.79845107 1.0748103  1.1718718  0.7077386
 1.1586972  0.71292835 0.7962858  0.7485074  1.6922075  0.8247464
 0.49970564 0.42837134 0.7767388  0.78923565 0.81021553 0.8102173
 0.7896338  0.7376162  0.8648164  0.85509115 1.1721922  3.6744733
 0.5104659  1.9189852  0.8204042  0.73920804 0.9145887  0.70356715
 0.8199997  1.5774496  1.0055593  1.1055623  0.53288    0.8158502
 0.9300039  0.7892622  1.1718608  1.1606424  0.45124254 0.8103839
 1.222071   0.77325404 0.6113646  1.5567994  1.1792971  0.7899075
 0.9795306  0.77321625 0.71812123 0.71812284 1.0915794  1.0911347
 1.0906307  1.7433094  0.7795134  1.7962415  0.46493623 0.844177
 1.0912435  0.77762884 0.8581118  0.71846217 0.9804337  0.50689995
 0.7181186  1.2225149  1.0909389  0.718119   0.77818966 1.0912598
 1.0909816  0.5204312  0.4977576  1.0906078  0.5320179  0.5061995
 0.46410653 0.4652669  0.73381037 0.497398   1.5780913  0.48141137
 0.4355727  0.77776974 1.2528808  0.49066052 0.9888293  0.56882435
 1.09232    0.6977407  1.0905709  1.091165   0.46493763 0.6203875
 1.5480942  0.7156212  0.50752103 0.78904873 0.5116619  0.5116636
 0.5116636  1.2386712  0.8264453  0.4875064  0.4875063  0.4888268
 0.5985214  0.5156691  0.46613666 0.7767932  0.5156692  0.5830074
 0.4660501  0.45229727 0.50013673 0.7336558  0.7693667  0.46605313
 0.49730116 1.4702096  0.45450765 0.46611086 0.4784001  0.7336525
 1.3002851  0.4768776  0.4784016  0.7699439  0.6868994  1.6185406
 0.6164868  0.73734415 0.7693875  0.76936656 0.5075095  0.4890702
 0.49493518 1.749294   0.5190013  0.4892472  1.6331388  0.47580025
 0.5156692  1.2625438  0.5562946  1.6752548  0.7336535  0.5075072
 0.70649165 0.5062923  0.74506074 0.45372602 0.74501306 2.2962444
 0.77681285 0.48887014 0.48893505 0.506225   0.48894125 0.50810164
 0.47579798 0.5562946  0.7711736  2.0680702  0.46619436 0.51566917
 0.55629474 0.7606091  0.76042193 0.51567817 1.0882764  0.51567066
 0.8101583  1.0882384  0.51566905 0.91198945 1.0882661  0.7876987
 0.76974094 0.4875055  0.47589022 0.74492913 0.7428322  1.3519356
 1.0883735  0.598529   0.5156693  0.7768225  0.7768723  0.48882493
 0.74515367 0.64993966 1.0223458  0.6159123  0.7769591  0.6499685
 0.7771024  0.64995205 0.71897423 1.088314   0.7613628  0.7618954
 0.77092665 0.786726   2.0994542  0.7866493  0.78694075 0.78672343
 0.7866127  0.7866873  0.78675294 0.786703   0.786612   0.7910341
 0.5919024  0.7869502  0.78658885 0.7866856  0.7866271  0.7867283
 0.78658587 0.78678787 0.78671163 0.7865799  0.7866579  0.78837043
 0.7865765  1.1179919  0.786743   0.5156695  0.38651797 0.776816
 0.38155597 0.66059846 0.91527873 0.91527873 0.6426273  0.38155597
 0.7769085  0.76963615 0.7708672  0.7768351  0.77178246 0.77686125
 0.716577   0.7865649  0.787001   0.7768255  0.7610019  0.776818
 0.77700025 0.7755312  0.77685165 0.7696324  0.7768185  0.7769075
 0.7696765  0.7697203  0.77692854 0.77259445 0.7769359  0.7768127
 0.77683806 0.9150578  0.70306534 0.7030717  0.78658175 0.89039135
 0.44252908 0.7769729  0.77118164 0.78659034 0.78811705 0.7696274
 0.64052135 0.7786543  0.77681065 0.77681404 0.52192736 0.9504159
 0.7030683  0.777265   1.1179937  0.77302456 0.7699284  1.696893
 0.7865881  0.7747328  1.0883067  0.78668    0.7902429  0.78658116
 0.77683246 0.77686095 1.0277278  0.7030764  0.78659856 0.95034117
 0.48320997 1.0182194  1.0181941  0.3777995  0.52192503 0.78658766
 0.7926903  1.0182495  0.9504564  0.6245605  0.52203786]
2025-06-03 10:10:32,547 - DEBUG - Edge reconstruction errors: [0.04518931 1.2455461  1.2492838  ... 0.04505649 0.04505622 1.1456342 ]
2025-06-03 10:10:32,553 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101032_update_13.json
2025-06-03 10:10:32,554 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:32,558 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101032_update_13.pth and as latest_checkpoint.pth
2025-06-03 10:10:32,558 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.3240
2025-06-03 10:10:32,558 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 10:10:32,558 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.7693, MLP Score: 0.5058
2025-06-03 10:10:32,558 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.9464, MLP Score: 0.4911
2025-06-03 10:10:32,558 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.6796, MLP Score: 0.4799
2025-06-03 10:10:32,558 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.6486, MLP Score: 0.4991
2025-06-03 10:10:32,558 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.6370, MLP Score: 0.4688
2025-06-03 10:10:32,558 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:32,558 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.3898, MLP Score: 0.4910
2025-06-03 10:10:32,558 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.0598, MLP Score: 0.5052
2025-06-03 10:10:32,558 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0653, MLP Score: 0.5021
2025-06-03 10:10:32,558 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.6823, MLP Score: 0.5151
2025-06-03 10:10:32,558 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.6220, MLP Score: 0.4986
2025-06-03 10:10:32,558 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-03 10:10:32,559 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-03 10:10:32,559 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-03 10:10:32,579 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-03 10:10:32,593 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-03 10:10:32,593 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-03 10:10:32,593 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-03 10:10:32,606 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-03 10:10:32,621 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-03 10:10:32,621 - INFO - Processing node updates/additions.
2025-06-03 10:10:32,624 - INFO - Processing edge updates/additions.
2025-06-03 10:10:32,631 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:32,632 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:32,632 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:32,633 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:32,639 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-03 10:10:32,644 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:32,651 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-03 10:10:32,654 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-03 10:10:32,655 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:32,657 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:32,658 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:32,659 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:32,660 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 3])
2025-06-03 10:10:32,660 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:32,661 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 7])
2025-06-03 10:10:32,661 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 10])
2025-06-03 10:10:32,661 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:32,662 - INFO - Performing online update...
2025-06-03 10:10:32,663 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:32,663 - DEBUG - Updated RunningStats: new_mean=0.9551200219251195, new_var=7200000000161.204, new_n=750
2025-06-03 10:10:32,663 - DEBUG - Updated RunningStats: new_mean=0.946669980640736, new_var=7500000000019.105, new_n=780
2025-06-03 10:10:32,664 - DEBUG - Updated RunningStats: new_mean=1.109632669437506, new_var=2400000000049.339, new_n=250
2025-06-03 10:10:32,664 - DEBUG - Updated RunningStats: new_mean=1.1067313299620174, new_var=2500000000000.9023, new_n=260
2025-06-03 10:10:32,664 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:32,664 - DEBUG - Online update step: 1/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 2/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 3/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 4/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 5/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 6/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 7/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 8/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 9/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 10/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 11/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 12/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 13/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 14/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 15/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 16/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 17/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 18/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 19/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 20/50
2025-06-03 10:10:32,664 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,664 - DEBUG - Online update step: 21/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 22/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 23/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 24/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 25/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 26/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 27/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 28/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 29/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 30/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 31/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 32/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 33/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 34/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 35/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 36/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 37/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 38/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 39/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 40/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 41/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 42/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 43/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 44/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 45/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 46/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 47/50
2025-06-03 10:10:32,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,665 - DEBUG - Online update step: 48/50
2025-06-03 10:10:32,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,666 - DEBUG - Online update step: 49/50
2025-06-03 10:10:32,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,666 - DEBUG - Online update step: 50/50
2025-06-03 10:10:32,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,666 - WARNING - No successful steps during online update.
2025-06-03 10:10:32,666 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.5114799e-08  7.2248056e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.5390174e-08
 -5.5046137e-09  1.6513841e-08  1.3761534e-08 -3.3027682e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -1.6513841e-08  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.8188258e-08  6.1926904e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8211145e-08  1.2385381e-08], current edge mean: [ 6.1754146e+00  1.4191989e+00  4.9765191e+00  2.6344595e-09
 -2.6344595e-09  0.0000000e+00  1.3172298e-09  1.3172298e-09
 -1.3172298e-09  1.9758446e-09]
2025-06-03 10:10:32,666 - DEBUG - Node drift difference: 0.0304, Edge drift difference: 0.0183
2025-06-03 10:10:32,667 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.5114799e-08  7.2248056e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.5390174e-08
 -5.5046137e-09  1.6513841e-08  1.3761534e-08 -3.3027682e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -1.6513841e-08  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.8188258e-08  6.1926904e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8211145e-08  1.2385381e-08], edge=[ 6.1754146e+00  1.4191989e+00  4.9765191e+00  2.6344595e-09
 -2.6344595e-09  0.0000000e+00  1.3172298e-09  1.3172298e-09
 -1.3172298e-09  1.9758446e-09]
2025-06-03 10:10:32,667 - DEBUG - Updated reference std: node=[0.         0.         1.0007223  1.0007223  0.         0.
 0.         1.0007223  1.0007223  1.0007224  1.0007223  1.0007223
 0.98739225 0.28158483 0.36058903 0.565704   1.0007224  3.083906
 2.926053   1.4880826  0.36058903 0.         1.0007223  1.0007223
 0.         0.         0.         0.         1.0007223  1.0007223 ], edge=[1.0506998 0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455]
2025-06-03 10:10:32,667 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:32,667 - INFO - Running anomaly detection...
2025-06-03 10:10:32,667 - INFO - Starting anomaly detection.
2025-06-03 10:10:32,675 - DEBUG - Node reconstruction errors: [1.078822   0.84521544 1.0181252  0.5728247  1.0749128  2.940386
 2.9975176  0.6711099  1.2840365  0.66793996 1.3693756  0.55338234
 1.0698956  1.0267115  1.0862098  1.6967404  0.7025139  0.6920836
 0.5743092  1.1673189  0.69209105 1.2827643  1.129935   2.0790024
 2.8273795  1.500565   0.69258606 0.84316194 0.6920946  1.2780775
 0.6159781  1.5006225  1.7540071  2.857163   1.9349636  2.3588126
 3.83386    1.2143738  1.9979423  1.1772828  1.3202695  1.1769425
 2.591453   1.0266931  0.8654235  1.156711   7.4482927  0.9730548
 1.4211905  1.1952434  3.584231   1.1300267  1.1057981  1.214373
 1.5004928  1.0279405  1.3385383  0.9930541  1.5621097  1.8701415
 5.0721297  1.885605   1.7047386  0.90344006 1.9153622  0.8155094
 2.6044335  1.1299349  1.1962352  1.3798956  1.6436422  0.9988083
 2.7628906  0.9569983  2.2188144  1.3418295  1.1952436  1.2764581
 1.6443102  1.1149518  0.9005309  0.9571006  0.72219086 1.0266929
 1.0440751  1.1373408  0.726931   2.7828174  0.50271416 1.1881309
 0.64249575 2.3495972  1.282713   0.85156995 0.72429067 4.5891256
 0.5212206  0.99012583 0.8949759  0.6566136  1.093019   0.52122
 0.56154543 0.8671273  1.5389435  0.6113867  0.7058102  1.4248631
 1.3021579  0.98992574 1.1641852  0.5412351  1.9412249  2.2490702
 1.0803083  0.9614672  1.0324563  1.832728   0.92091006 0.72522014
 0.5926705  1.4356352  1.7708615  1.3466431  0.7289941  0.7254003
 1.2673784  1.1362171  1.1150452  0.8398588  0.76493603 0.5444135
 0.62933123 2.033747   0.9611076  0.6386081  0.82618713 0.92652285
 1.1585116  1.827052   0.53034264 0.99393284 0.5870388  0.53046983
 0.5408376  1.1262499  1.0324762  0.6148201  0.8803011  0.8570071
 1.608039   1.5394726  1.384041   0.5444164  1.0258701  2.2241552
 0.4993788  1.1017808  1.0930165  0.5802201  0.61765534 1.234866
 0.49937436 0.7659072  0.9986184  1.8227832  1.5356517  0.78181833
 1.1565679  0.8139295  0.983981   0.7457963  0.6477057  3.3832636
 0.79073966 0.56520844 0.97646904 0.9267151  0.96295536 0.9629526
 0.598723   1.3589687  0.5803814  1.8085785  1.7828717  1.0007261
 0.5725196  0.9843373  0.6329377  0.4961208  0.98786193 0.7797824
 0.5190787  0.5482995  1.1583747  0.47557366 1.4992981  0.61848754
 1.8677003  0.5015792  0.818515   0.49967518 2.075706   0.89423394
 0.9654494  1.2827137  0.89597017 1.5503784  0.8753256  1.2887512
 0.8857535  1.0005854  0.47456703 1.0003781  1.0005876  0.5647767
 1.108572   1.0324537  1.0322126  0.5482671  2.2839165  0.5725219
 0.6177468  0.4745652  0.49932274 0.7334692  1.765163   0.59112734
 0.87179947 0.53571355 1.3483351  0.696526   0.9474248  1.0324826
 1.032461   0.4654857  0.7573096  0.61774665 0.49947307 0.6022718
 1.9644445  1.077768   0.58835053 0.8569431  0.5589651  0.71583295
 0.8614807  0.80635285 0.5883514  0.5275917  0.6477068  0.6109125
 1.032187   0.8913595  0.9611273  0.97731644 0.49025443 0.8575602
 0.58349794 0.9629529  1.1114706  1.5912608  0.5178537  0.70856553
 0.8587795  0.7106785  1.1972808  3.5106292  1.1973844  0.9294139
 1.6264825  1.7160724  1.030513   0.81257373 1.4014202  0.96295685
 0.5804187  0.8990902  0.59883595 0.8282022  3.299767   0.59560275
 0.76431113 0.8155477  1.1171376  0.8030047  2.4756532  1.2131096
 1.3589689  1.2654942  0.72417843 0.50167906 0.81163174 0.55893224
 1.5341631  0.90206367 0.8605478  0.9638767  0.46518132 0.59186107
 0.70968515 0.88159496 1.3004662  1.300467   0.8804017  0.8800888
 0.88011056 1.3852513  0.8569287  0.8808908  0.88012385 1.001358
 0.880188   0.4807905  1.6919129  0.9333548  0.98275554 1.3305899
 0.48280767 0.48683107 1.1181628  0.68908095 0.7981439  1.3004669
 0.6354744  1.7540184  0.87289864 1.3852537  1.2703217  1.2703487
 1.215511   0.47978818 0.8848306  1.4014251  0.88019544 1.3852445
 0.71361995 0.57949907 0.8725185  0.87279403 0.98520046 0.57747823
 0.8725341  1.016729   0.8877782  1.1973367  1.3004742  0.78132427
 1.2819318  0.80196416 0.8878969  0.8316664  2.0629985  0.9165178
 0.5642849  0.49025583 0.8572792  0.8800557  0.90202695 0.9021011
 0.8857464  0.82749456 0.95094085 0.9522413  1.3007976  3.8827205
 0.5696654  2.06965    0.91221344 0.8185304  1.0119333  0.78229916
 1.0015     1.6815922  1.1190224  1.232306   0.5947244  0.91009116
 1.0393062  0.88008857 1.3004631  1.2451642  0.51108235 0.88592887
 1.2879783  0.8642319  0.68541527 1.5632838  1.309033   0.8808048
 1.0576948  0.86419475 0.8012539  0.7346135  1.213792   1.2133527
 1.2128576  1.8555915  0.8682759  1.9091798  0.48136985 0.9201024
 1.2134603  0.86619014 0.955363   0.80163556 1.0965518  0.5753816
 0.80125076 1.3093282  1.2131608  0.8012505  0.8668115  1.213477
 1.2132034  0.57416177 0.56140614 1.212833   0.59390706 0.5573597
 0.5300534  0.5322631  0.8124425  0.5657032  1.6880085  0.53964347
 0.50025856 0.8533558  1.3191861  0.536504   1.1021684  0.63992405
 1.1843317  0.780816   1.2127982  1.2133839  0.5319019  0.6966904
 1.6270087  0.79269224 0.55976707 0.88419324 0.5572121  0.55721337
 0.55721307 1.3096354  0.89514655 0.5403603  0.54035985 0.55376846
 0.6720324  0.5716231  0.52793777 0.86162126 0.57162297 0.6405585
 0.5319258  0.51329446 0.5487682  0.81228703 0.8540298  0.53192914
 0.5655951  1.5079724  0.51969326 0.53199273 0.5398519  0.81228423
 1.3665508  0.53227144 0.5398534  0.8546423  0.75763035 1.7193806
 0.68423206 0.81597686 0.8540517  0.854029   0.5597552  0.5540456
 0.5405314  1.9045066  0.57802844 0.55425483 1.7369055  0.5336081
 0.5716232  1.320001   0.5968803  1.7762349  0.95625967 0.5597538
 0.7754664  0.5574506  0.8211706  0.5148634  0.8211234  2.4315772
 0.86164343 0.5538157  0.55388635 0.55738455 0.553893   0.56734747
 0.5336057  0.5968802  0.8522066  2.2129724  0.5280003  0.57162327
 0.59688014 0.8517526  0.85155356 0.57163113 1.1934153  0.5716241
 0.8948209  1.1933783  0.61590457 1.0516093  1.1934059  0.88276774
 0.8506254  0.5403592  0.5337013  0.8210394  0.82312113 1.4168533
 1.1935128  0.6720406  0.5716231  0.86165327 0.86171037 0.5537669
 0.8212624  0.76320475 1.1184026  0.6836368  0.86180645 0.7294785
 0.8619693  0.7294638  0.79959804 1.1934549  0.8525479  0.85311335
 0.86261946 0.8673862  2.1389902  0.8673016  0.86762524 0.8673837
 0.8672613  0.8673439  0.8674147  0.8673607  1.2189851  0.88047403
 0.62851924 0.86763316 0.8672349  0.8673409  0.8672756  0.8673888
 0.8672329  0.86745554 0.8673702  0.8672259  1.1820965  0.86920154
 0.8672214  1.2189848  0.86740565 0.57162344 0.42599195 0.8616467
 0.40819094 0.73504245 0.91292363 0.91292363 0.7159366  0.40819094
 0.8617488  0.8505099  0.8518696  0.8616678  0.85288215 0.86169714
 0.7993599  0.9010337  0.882029   0.8616568  0.85216624 0.86164755
 0.8618524  0.8570227  0.8616866  0.85050696 0.86164886 0.86174864
 1.193411   0.85060334 0.8617719  0.85378265 0.86178154 0.86164284
 0.8616706  1.0089501  0.7832377  0.7832441  0.8672277  0.98721284
 0.48867825 0.8618234  0.85221505 1.021478   0.86891913 0.8505003
 0.7040884  0.85722756 0.86164075 0.8616441  0.8451363  1.0397571
 0.7832418  0.8621502  1.2189859  0.85425025 0.8508336  1.7864155
 0.8672345  0.8561434  1.1934471  0.867335   0.8712555  1.2189865
 0.8616642  0.8616974  1.1221373  0.7832491  0.86724573 1.039679
 0.5251774  1.118232   1.1182067  0.41445735 0.57373196 0.86723477
 0.8739445  1.1182629  1.0398     0.6957297  0.57384425 0.5836349
 0.8782736  0.87826836 0.8784683  0.87841076 0.878275   0.87829155
 0.8784418  0.8782621  0.88283443 0.8674257  0.8676261  0.8673428
 1.1182047  1.0119488  1.118403   0.5996291  1.1181985  0.86858207
 0.86721855 0.8672303  0.8672677  0.86727875 1.1181961  0.5364724
 0.8611559  0.8612768  0.87828076 0.53642195 0.6959839  0.62277627
 0.86760575 0.8672586  0.8784227  0.5836351  0.8609296  0.88331926
 0.58363444 0.5475713  0.8782786 ]
2025-06-03 10:10:32,676 - DEBUG - Edge reconstruction errors: [0.04531737 1.2456827  1.2495058  ... 0.04518167 0.04518143 1.1457715 ]
2025-06-03 10:10:32,677 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101032_update_14.json
2025-06-03 10:10:32,677 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:32,681 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101032_update_14.pth and as latest_checkpoint.pth
2025-06-03 10:10:32,682 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.3256
2025-06-03 10:10:32,682 - WARNING - Detected 18 anomalous nodes (reconstruction-based):
2025-06-03 10:10:32,682 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.9404, MLP Score: 0.5067
2025-06-03 10:10:32,682 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.9975, MLP Score: 0.4932
2025-06-03 10:10:32,682 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.8274, MLP Score: 0.4813
2025-06-03 10:10:32,682 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8572, MLP Score: 0.4987
2025-06-03 10:10:32,682 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.8339, MLP Score: 0.4666
2025-06-03 10:10:32,682 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:32,682 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.5589, MLP Score: 0.4885
2025-06-03 10:10:32,682 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.2275, MLP Score: 0.5026
2025-06-03 10:10:32,682 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1310, MLP Score: 0.5000
2025-06-03 10:10:32,682 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.7871, MLP Score: 0.5137
2025-06-03 10:10:32,682 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.6796, MLP Score: 0.4975
2025-06-03 10:10:32,682 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-03 10:10:32,682 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-03 10:10:32,682 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-03 10:10:32,699 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-03 10:10:32,713 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-03 10:10:32,713 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-03 10:10:32,713 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-03 10:10:32,726 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-03 10:10:32,740 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-03 10:10:32,740 - INFO - Processing node updates/additions.
2025-06-03 10:10:32,744 - INFO - Processing edge updates/additions.
2025-06-03 10:10:32,751 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:32,752 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:32,752 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:32,753 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:32,760 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-03 10:10:32,761 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:32,761 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-03 10:10:32,762 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-03 10:10:32,763 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:32,766 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:32,767 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:32,768 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:32,769 - DEBUG - Shape of encoded categorical edge features: torch.Size([1476, 3])
2025-06-03 10:10:32,770 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:32,770 - DEBUG - Shape of scaled numerical edge features: torch.Size([1476, 7])
2025-06-03 10:10:32,770 - DEBUG - Final edge attributes tensor shape: torch.Size([1476, 10])
2025-06-03 10:10:32,770 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:32,772 - INFO - Performing online update...
2025-06-03 10:10:32,773 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:32,773 - DEBUG - Updated RunningStats: new_mean=0.9545164184769304, new_var=7800000000160.826, new_n=810
2025-06-03 10:10:32,773 - DEBUG - Updated RunningStats: new_mean=0.9467627138219007, new_var=8100000000019.2, new_n=840
2025-06-03 10:10:32,774 - DEBUG - Updated RunningStats: new_mean=1.1122960337697287, new_var=2600000000049.2944, new_n=270
2025-06-03 10:10:32,774 - DEBUG - Updated RunningStats: new_mean=1.1094697617876677, new_var=2700000000000.903, new_n=280
2025-06-03 10:10:32,774 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:32,774 - DEBUG - Online update step: 1/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 2/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 3/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 4/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 5/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 6/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 7/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 8/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 9/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 10/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 11/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 12/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 13/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 14/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 15/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,774 - DEBUG - Online update step: 16/50
2025-06-03 10:10:32,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 17/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 18/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 19/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 20/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 21/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 22/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 23/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 24/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 25/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 26/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 27/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 28/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 29/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 30/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 31/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 32/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 33/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 34/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 35/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 36/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 37/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 38/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 39/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 40/50
2025-06-03 10:10:32,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,775 - DEBUG - Online update step: 41/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 42/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 43/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 44/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 45/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 46/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 47/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 48/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 49/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - DEBUG - Online update step: 50/50
2025-06-03 10:10:32,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,776 - WARNING - No successful steps during online update.
2025-06-03 10:10:32,776 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.4495675e-09  2.9972622e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.0095280e-08
  5.1770890e-08 -3.2697404e-08  8.1743510e-09 -2.8610229e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  3.2697404e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -9.5367430e-09  4.0190560e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3623919e-09 -2.1798270e-08], current edge mean: [ 6.1714091e+00  1.4214092e+00  4.9769650e+00 -5.1689666e-09
  0.0000000e+00  1.2922416e-09  2.5844833e-09  1.2922416e-09
 -9.6918118e-10 -1.2922416e-09]
2025-06-03 10:10:32,777 - DEBUG - Node drift difference: 0.0145, Edge drift difference: 0.0044
2025-06-03 10:10:32,777 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.4495675e-09  2.9972622e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.0095280e-08
  5.1770890e-08 -3.2697404e-08  8.1743510e-09 -2.8610229e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  3.2697404e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -9.5367430e-09  4.0190560e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3623919e-09 -2.1798270e-08], edge=[ 6.1714091e+00  1.4214092e+00  4.9769650e+00 -5.1689666e-09
  0.0000000e+00  1.2922416e-09  2.5844833e-09  1.2922416e-09
 -9.6918118e-10 -1.2922416e-09]
2025-06-03 10:10:32,778 - DEBUG - Updated reference std: node=[0.         0.         1.000715   1.000715   0.         0.
 0.         1.0007151  1.000715   1.000715   1.000715   1.0007151
 0.9945478  0.2802002  0.36725795 0.5633757  1.000715   3.0975275
 2.9325864  1.5110466  0.36725795 0.         1.000715   1.000715
 0.         0.         0.         0.         1.000715   1.000715  ], edge=[1.041392  0.507492  1.7803478 1.0003389 1.0003389 1.0003389 1.0003389
 1.0003389 1.0003389 1.0003389]
2025-06-03 10:10:32,778 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:32,778 - INFO - Running anomaly detection...
2025-06-03 10:10:32,778 - INFO - Starting anomaly detection.
2025-06-03 10:10:32,812 - DEBUG - Node reconstruction errors: [1.0978284  0.85986954 1.0361301  0.5806142  1.0947553  2.958206
 2.997517   0.67503315 1.2971215  0.7189808  1.3836063  0.5599029
 1.0871274  1.0396014  0.85386884 1.710755   0.7106691  0.7011326
 0.58264565 1.1728933  0.7011411  1.2939372  1.1408665  2.1067882
 2.8474329  1.5039076  0.69287056 0.8577268  0.7011445  1.2792522
 0.6190482  1.5039637  1.7716647  2.7519917  1.9493984  2.3852327
 3.8922615  1.2220553  2.0387025  1.1831205  1.3251995  1.199088
 2.6421988  1.0395838  0.8691457  1.2087741  7.5481215  0.9801403
 1.4351733  1.2042097  3.6230905  1.1409576  1.1168162  1.2220552
 1.5038357  1.0417742  1.343528   0.9932547  1.6265396  1.8914951
 5.140997   1.9002217  1.7120498  0.9134319  1.9366897  0.81486106
 2.6194332  1.1408659  1.2052002  1.3879247  1.6629598  1.000069
 2.774717   0.97471064 2.2419658  1.3374443  1.2042098  1.2847863
 1.662326   1.116163   0.9025994  0.96487457 0.72214437 1.0395834
 1.0481349  1.1522352  0.7298115  2.7966034  0.5531709  1.1771368
 0.6521215  2.3848064  1.293562   0.86903864 0.7371806  4.6323276
 0.5294061  1.0084543  0.9111389  0.6645754  1.1123828  0.5294055
 0.56842166 0.8780868  1.5457561  0.6207081  0.70463    1.434574
 1.3134362  0.994346   1.1776317  0.54874957 1.9522156  2.2678518
 1.0995933  0.98085266 1.052305   1.8490921  0.93851167 0.7337129
 0.6023457  1.4379851  1.7835644  1.3568397  0.7452377  0.7338962
 1.2818515  1.1486344  1.13479    0.84534824 0.77711    0.5536636
 0.6382557  2.050685   0.98049265 0.64766705 0.8334171  0.94248873
 1.1701748  1.8419325  0.53797406 1.0113482  0.59543645 0.53624797
 0.5457136  1.1455233  1.0523255  0.6234312  0.89671445 0.87367743
 1.624926   1.5462242  1.4087173  0.55366546 1.0420471  2.248841
 0.5078816  1.1159874  1.1123805  0.5875879  0.6262823  1.2425975
 0.50787807 0.77808976 1.0186838  1.8375747  1.5623558  0.79755706
 1.1683462  0.79884315 1.0020463  0.75145406 0.6574982  3.4293857
 0.8012288  0.5714137  0.9956867  1.01977    0.983434   0.9834324
 0.60625166 1.3713368  0.59079766 1.8265847  1.7634156  1.0206231
 0.58019555 1.0048478  0.64115757 0.50332093 1.0089623  0.79521203
 0.51696813 0.55774903 1.1700375  0.4781498  2.8584316  0.6223593
 1.8854848  0.507777   0.82971776 0.5081815  2.0869725  0.9125796
 0.9853836  1.2935623  0.90923107 1.5611379  0.8912337  1.3139476
 0.9058949  1.0204837  0.48072577 1.0163741  0.6886493  0.57144207
 1.125826   1.0523024  1.0526314  0.5577172  2.3009577  0.58019716
 0.6282358  0.48072383 0.50782573 0.75190806 1.7773128  0.6000846
 0.8903065  0.54245114 1.348058   0.70920205 0.95847046 1.0523313
 1.0523096  0.46790805 0.7702455  0.6282358  0.50797856 0.59946287
 1.9830463  1.06753    0.59764236 0.87361366 0.56863517 0.7278557
 0.87903565 0.8252109  0.59764296 0.53349644 0.6574986  0.62094104
 1.052605   0.9019864  0.8803161  0.9972389  0.49740955 0.87150973
 0.585972   0.98343277 1.1319371  1.6048752  0.52480555 0.7194755
 0.8751374  0.721905   1.2223775  3.5397873  1.22248    0.94474804
 1.6416898  1.732799   1.0507394  0.84508044 1.4288803  0.9834373
 0.590416   0.915641   0.60636395 0.8470899  3.320853   0.6066004
 0.7764242  0.82793635 1.135044   0.81671226 2.493691   1.221308
 1.3713367  1.2722659  0.7315329  0.5068278  0.8269249  0.5686022
 1.5475434  0.9189106  0.9359084  0.9842734  0.4676005  0.60211504
 0.72297555 0.8985171  1.3278278  1.3278298  0.89730746 0.8969927
 0.8970153  1.4124808  0.87334955 0.8978049  0.8970283  1.0153453
 0.8970934  0.4880102  1.5654655  0.9540468  0.99841595 1.3386314
 0.48871073 0.4877307  1.1433318  0.69953    0.81680715 1.327828
 0.6423174  1.7712616  0.8894641  1.4124845  1.2956555  1.2956812
 1.2389717  0.4820607  0.9017599  1.4288849  0.89710045 1.4124755
 0.7244902  0.5900504  0.8890812  0.88936037 1.0034525  0.58816206
 0.88909835 1.0320892  0.90604687 1.2224333  1.3278354  0.79446465
 1.306393   0.81952864 0.90491766 0.83142066 2.09629    0.9363883
 0.57481873 0.49741107 0.870117   0.89695966 0.9188725  0.91894805
 0.905889   0.84159684 0.96418506 0.9464838  1.3281506  3.9285624
 0.57958573 2.0926657  0.93144923 0.83387184 1.0308893  0.79684186
 1.0155604  1.7048692  1.1419748  1.2606442  0.6054217  0.92559415
 1.0624111  0.89699227 1.3278254  1.2583659  0.5184775  0.9007491
 1.2960371  0.8838709  0.6951865  1.5692668  1.3365964  0.8977135
 1.0732522  0.7605347  0.81886655 0.7467796  1.241797   1.2413651
 1.2408757  1.875531   0.88504463 1.9295112  0.486979   0.9356816
 1.241471   0.8829454  0.9757212  0.81924975 1.1219727  0.5205194
 0.81886417 1.3219353  1.2411755  0.8188638  0.8835726  1.2414869
 1.2412163  0.5951585  0.5719975  1.2408521  0.6046099  0.5646911
 0.54022354 0.54276556 0.8280218  0.5271088  1.7043468  0.5403936
 0.5102822  0.8083413  1.3277316  0.5429455  1.127654   0.6018152
 1.2070117  0.7989446  1.2408175  1.2413944  0.48610586 0.71260464
 1.6229347  0.8054324  0.5679844  0.90170383 0.5647572  0.56475925
 0.5647587  1.321137   0.90902483 0.5464713  0.5464705  0.56465465
 0.6881449  0.58161443 0.53685313 0.8779347  0.58161414 0.64730096
 0.54228234 0.52170855 0.5571546  0.827867   0.8711472  0.5422859
 0.5760415  1.5140651  0.52784234 0.5423492  0.550669   0.8278648
 1.3202542  0.52996814 0.5506704  0.87175906 0.77028275 1.7876856
 0.69731826 0.83150315 0.87116843 0.87114644 0.567973   0.5649199
 0.5473305  1.9165508  0.5884268  0.56511253 1.7527213  0.54387116
 0.58161396 1.3262131  0.6022781  1.79289    0.9714366  0.56797147
 0.7880758  0.5647816  0.8365291  0.52327526 0.8364817  2.4550421
 0.87795705 0.5647022  0.56477195 0.56471485 0.564779   0.5773393
 0.5438685  1.47055    0.8664902  2.2373679  0.5369167  0.5816142
 0.60227895 0.8674638  0.8672655  0.5816232  1.216186   0.58161545
 0.9098294  1.2161492  0.61794037 1.0707029  1.2161752  0.9003071
 0.8648954  0.5464704  0.54396635 0.83639926 0.8340856  1.4297999
 1.2162817  0.6881522  0.58161426 0.8779673  0.87802327 0.56465274
 0.8366192  0.77923787 1.1386952  0.69671804 0.87812144 0.74777424
 0.87828714 0.74775827 0.804736   1.2162238  0.86825097 0.8688153
 0.87822306 0.8831192  2.1437979  0.88303536 0.88336277 0.8831164
 0.8829941  0.8830788  0.88315004 0.8830948  1.2414894  0.89686984
 0.63294226 0.88336986 0.8829679  0.8830764  0.8830103  0.88312364
 0.8829647  0.8831913  0.8831061  0.88295734 1.2017798  0.8849641
 0.8829536  1.2414894  0.88314116 0.58161443 0.4375822  0.8779615
 0.41194293 0.751057   0.90600556 0.90600556 0.7317191  0.41194293
 0.8780636  0.86477935 0.8661546  0.87798154 0.86718243 0.8780113
 0.8117165  0.9173024  0.89957416 0.87797064 0.8678688  0.8779625
 0.87816995 0.87139285 0.8780005  0.8647758  0.8779634  0.87806314
 1.2161796  0.86487377 0.8780868  0.8681076  0.8780963  0.87795675
 0.8779846  1.0288243  0.80742115 0.80107194 0.8829593  1.0036348
 0.49988505 0.87814033 0.8665015  1.0373412  0.88466704 0.8647695
 0.716642   0.8697625  0.87795436 0.8779589  0.8601821  1.0593088
 0.8010703  0.8784678  1.2414894  0.86855644 0.86510676 1.8040687
 0.8829669  0.8705054  1.2162168  0.88306886 0.8870185  1.2414895
 0.87797874 0.8780111  1.1382041  0.80107677 1.2017624  1.059232
 0.5322292  1.1405084  1.1404845  0.42524236 0.582677   0.88296705
 0.8783542  1.1405392  1.0593494  0.711911   0.5827887  0.5916587
 0.89336914 0.89336425 0.89356595 0.8935077  0.89337045 0.89338595
 1.2370776  0.8933581  0.89796865 0.8831613  0.8833601  0.8830774
 1.1404824  1.0281502  1.1406758  0.60770667 1.1404767  1.201899
 1.201769   0.8829629  1.2017672  0.8830121  1.1404738  0.54582936
 0.8754038  0.87552416 0.89337605 0.5457777  0.71216315 0.62834173
 0.8833411  0.8829916  0.8935183  0.5916591  0.87517244 0.89795893
 0.59165937 0.55609214 0.8933745  2.223572   0.5514978  0.6468929
 0.5400452  0.5916668  0.5400449  0.5560783 ]
2025-06-03 10:10:32,812 - DEBUG - Edge reconstruction errors: [0.04428512 1.2445781  1.2483834  ... 0.04407867 0.04407845 1.1446629 ]
2025-06-03 10:10:32,820 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101032_update_15.json
2025-06-03 10:10:32,820 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:32,824 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101032_update_15.pth and as latest_checkpoint.pth
2025-06-03 10:10:32,824 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.3249
2025-06-03 10:10:32,824 - WARNING - Detected 18 anomalous nodes (reconstruction-based):
2025-06-03 10:10:32,825 - WARNING -   Node ID: 142.250.71.227, Recon Error: 2.9582, MLP Score: 0.5065
2025-06-03 10:10:32,825 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.9975, MLP Score: 0.4937
2025-06-03 10:10:32,825 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.8474, MLP Score: 0.4810
2025-06-03 10:10:32,825 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.7520, MLP Score: 0.4902
2025-06-03 10:10:32,825 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.8923, MLP Score: 0.4662
2025-06-03 10:10:32,825 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:32,825 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.6909, MLP Score: 0.4858
2025-06-03 10:10:32,825 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.4757, MLP Score: 0.5026
2025-06-03 10:10:32,825 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1298, MLP Score: 0.5000
2025-06-03 10:10:32,825 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.7858, MLP Score: 0.5135
2025-06-03 10:10:32,825 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.6789, MLP Score: 0.4977
2025-06-03 10:10:32,825 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-03 10:10:32,825 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-03 10:10:32,825 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-03 10:10:32,842 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-03 10:10:32,856 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-03 10:10:32,856 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-03 10:10:32,857 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-03 10:10:32,870 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-03 10:10:32,886 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-03 10:10:32,886 - INFO - Processing node updates/additions.
2025-06-03 10:10:32,889 - INFO - Processing edge updates/additions.
2025-06-03 10:10:32,896 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:32,897 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:32,897 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:32,898 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:32,905 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-03 10:10:32,906 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:32,906 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-03 10:10:32,907 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-03 10:10:32,908 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:32,910 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:32,911 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:32,912 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:32,913 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 3])
2025-06-03 10:10:32,914 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:32,914 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 7])
2025-06-03 10:10:32,914 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 10])
2025-06-03 10:10:32,914 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:32,915 - INFO - Performing online update...
2025-06-03 10:10:32,916 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:32,916 - DEBUG - Updated RunningStats: new_mean=0.9540417742100178, new_var=8400000000160.826, new_n=870
2025-06-03 10:10:32,916 - DEBUG - Updated RunningStats: new_mean=0.946819791428373, new_var=8700000000019.17, new_n=900
2025-06-03 10:10:32,916 - DEBUG - Updated RunningStats: new_mean=1.114588818701254, new_var=2800000000049.342, new_n=290
2025-06-03 10:10:32,916 - DEBUG - Updated RunningStats: new_mean=1.11180815977561, new_var=2900000000000.8916, new_n=300
2025-06-03 10:10:32,916 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:32,917 - DEBUG - Online update step: 1/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 2/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 3/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 4/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 5/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 6/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 7/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 8/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 9/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 10/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 11/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 12/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 13/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 14/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 15/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 16/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 17/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 18/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 19/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 20/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 21/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 22/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,917 - DEBUG - Online update step: 23/50
2025-06-03 10:10:32,917 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 24/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 25/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 26/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 27/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 28/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 29/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 30/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 31/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 32/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 33/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 34/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 35/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 36/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 37/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 38/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 39/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 40/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 41/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 42/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 43/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 44/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 45/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 46/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 47/50
2025-06-03 10:10:32,918 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,918 - DEBUG - Online update step: 48/50
2025-06-03 10:10:32,919 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,919 - DEBUG - Online update step: 49/50
2025-06-03 10:10:32,919 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,919 - DEBUG - Online update step: 50/50
2025-06-03 10:10:32,919 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:32,919 - WARNING - No successful steps during online update.
2025-06-03 10:10:32,919 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.0014307e-09 -9.3700166e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.4171734e-09
 -2.1674417e-08  0.0000000e+00 -4.1348116e-08 -2.6676206e-09
  2.3160839e+00  2.9608393e+00  1.3986014e-01  4.3930068e+00
  0.0000000e+00  3.5202796e+00  5.6573424e+00  7.6083918e+00
  1.3986014e-01  8.0000000e+00 -1.8673344e-08  1.1670839e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.4679065e-08 -1.8006439e-08], current edge mean: [ 6.1696253e+00  1.4234056e+00  4.9861932e+00  1.0659082e-08
  3.7620289e-09 -1.2540097e-09  0.0000000e+00 -3.7620289e-09
  0.0000000e+00  3.7620289e-09]
2025-06-03 10:10:32,919 - DEBUG - Node drift difference: 0.0255, Edge drift difference: 0.0052
2025-06-03 10:10:32,920 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.0014307e-09 -9.3700166e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.4171734e-09
 -2.1674417e-08  0.0000000e+00 -4.1348116e-08 -2.6676206e-09
  2.3160839e+00  2.9608393e+00  1.3986014e-01  4.3930068e+00
  0.0000000e+00  3.5202796e+00  5.6573424e+00  7.6083918e+00
  1.3986014e-01  8.0000000e+00 -1.8673344e-08  1.1670839e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.4679065e-08 -1.8006439e-08], edge=[ 6.1696253e+00  1.4234056e+00  4.9861932e+00  1.0659082e-08
  3.7620289e-09 -1.2540097e-09  0.0000000e+00 -3.7620289e-09
  0.0000000e+00  3.7620289e-09]
2025-06-03 10:10:32,920 - DEBUG - Updated reference std: node=[0.         0.         1.0007     1.0007     0.         0.
 0.         1.0007     1.0007     1.0007001  1.0007     1.0007
 1.017057   0.27730066 0.3667061  0.56330985 1.0007001  3.0911584
 2.9346402  1.4961902  0.3667061  0.         1.0007001  1.0007
 0.         0.         0.         0.         1.0007     1.0007    ], edge=[1.0337199 0.5073971 1.7682712 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289]
2025-06-03 10:10:32,920 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:32,920 - INFO - Running anomaly detection...
2025-06-03 10:10:32,920 - INFO - Starting anomaly detection.
2025-06-03 10:10:32,929 - DEBUG - Node reconstruction errors: [1.1510658  0.90306747 1.0865433  0.6033336  1.1497926  3.0154235
 3.013906   0.69412917 1.3348752  0.732708   1.4308511  0.5878276
 1.1356905  1.0764396  0.88586164 1.7457359  0.7385191  0.73604035
 0.6151813  1.2534031  0.73604923 1.3366103  1.173764   2.1672723
 2.9094167  1.5336688  0.71449196 0.9001049  0.736052   1.3045752
 0.644954   1.5337279  1.8146214  2.8184645  1.9866265  2.4842868
 3.93597    1.2501351  2.1279128  1.2078048  1.3485695  1.2056563
 2.6712968  1.0764211  0.8902296  1.221432   7.64263    1.007707
 1.4821762  1.235972   3.712075   1.1738552  1.1502045  1.2501353
 1.5335957  1.0821935  1.3672975  0.99667907 1.7368543  1.9457728
 5.181665   1.934274   1.7520393  0.94332504 1.9912908  0.8261499
 2.663821   1.1737638  1.2369906  1.4254271  1.7108339  1.0086745
 2.8220875  1.023141   2.2890627  1.3967364  1.2359719  1.3682622
 1.7630099  1.1206604  0.91132724 1.000357   0.74500304 1.0764211
 1.0586338  1.1963526  0.74894357 2.8424025  0.53147745 1.212231
 0.68019414 2.5433092  1.3221177  0.9176463  0.7769105  4.722448
 0.5518463  0.9440979  0.94854796 0.6961741  1.1675303  0.55184567
 0.58920884 0.9134397  1.5693915  0.65504736 0.7523816  1.4786547
 1.3438461  0.9976318  1.2087733  0.5695583  2.3581166  2.3814352
 1.1545238  0.91728127 1.1085073  1.9253801  0.988769   0.7631549
 0.6304313  1.4492906  1.8596007  1.3857142  0.7893738  0.7633456
 1.31962    1.1956165  1.1833981  0.86212265 0.8141878  0.5873657
 0.66819453 2.4221258  1.034218   0.6814598  0.852923   0.9799824
 1.2153704  1.9042898  0.60658354 1.0601151  0.62020713 0.5615008
 0.58129984 1.2014264  1.1085278  0.65874076 0.9429032  0.92153996
 1.6584947  1.7697037  1.4703969  0.5873677  0.9622117  2.3494928
 0.5396669  1.1549877  1.1675278  0.6087113  0.5912125  1.1898276
 0.5396637  0.81520665 1.0745807  1.8995596  1.6298041  0.84164745
 1.1994634  0.82709754 1.0525395  0.77420527 0.68612283 3.5252163
 0.8278348  0.6160645  1.0467229  1.0650213  1.0393517  1.0393496
 0.6357588  1.4046612  0.6217286  1.9064585  1.8178786  1.0766702
 0.6036298  1.0608546  0.67058223 0.5312478  1.0631453  0.8400029
 0.52710146 0.5932102  1.2152312  0.49691904 3.01533    0.63729954
 1.9676179  0.6721766  0.85926944 0.53998005 2.2006295  0.962858
 1.0401213  1.3221182  0.94880974 2.0639567  0.9287445  1.3758196
 0.9607906  1.0765254  0.5081256  1.0474263  0.71663165 0.59222394
 1.1730978  1.108505   1.1097684  0.59317654 2.4235442  0.60363185
 0.6593581  0.5081236  0.5396087  0.8000571  1.825298   0.6355793
 0.9408997  1.4164975  1.35494    0.7448569  1.1104785  1.1085339
 1.1085116  0.48630193 0.80664927 0.6593582  0.5397673  0.6003842
 1.9908475  1.1042925  0.6321735  0.92147475 0.6039893  0.7604195
 0.9295747  0.87655157 0.6321741  0.5591897  0.68612355 0.6497104
 1.109742   0.93573743 0.9169029  1.0520726  0.5251263  0.90473515
 0.598712   1.0393498  1.1809207  1.6403375  0.54672664 0.7512575
 0.9166405  0.75642055 1.2830988  3.6254773  1.2832036  1.1162082
 1.7035004  1.8059763  1.1044254  0.8668716  1.496919   1.0393538
 0.61935747 0.96024287 0.63587505 0.7734741  3.3819718  0.6378825
 0.8139687  0.8565578  1.1848894  0.8509963  2.5171196  1.2568399
 1.4046612  1.2934096  0.76053905 0.5237134  0.8702789  0.6039553
 1.5734478  0.927328   0.97138107 1.0402044  0.48598212 0.63360596
 0.76048166 0.9389538  1.3940023  1.3940041  0.9376935  0.93736637
 0.93738943 1.4802417  0.9122222  0.9382122  0.93740237 1.0544393
 0.93747133 0.5163732  1.6120425  1.0073913  0.8712438  1.3606191
 0.5144261  0.50253284 1.2029779  0.7471876  0.86648816 1.394003
 0.66952425 1.8476199  0.928661   1.4802451  1.357918   1.3579462
 1.2975062  0.5012742  0.94233376 1.4969246  0.93747807 1.4802352
 0.7645941  0.6211206  0.9282617  0.92855287 1.0474921  0.62017363
 0.9282792  1.0723326  0.94972825 1.2831548  1.3940107  0.8288324
 1.3663777  0.8673421  0.94560826 0.868744   2.215478   0.9887489
 0.60556275 0.52512765 0.9016641  0.9373318  0.95944583 3.2517698
 0.96078354 0.88310206 0.99908394 0.9822062  1.3943301  4.0233164
 0.6088037  2.1720326  0.98337173 0.87901247 1.0547652  0.9347957
 1.0546663  1.7622484  1.2001208  1.3278968  0.63643914 0.97110313
 1.1193153  0.9373662  1.3940002  1.2113584  0.5478898  0.7847943
 1.2113713  0.93735415 0.7297273  1.5925115  1.4038408  0.9381166
 1.1162103  0.79829687 0.86708033 0.78519714 1.3077847  1.307351
 1.3068612  1.9228075  0.9253634  1.9769248  0.51247007 0.97886777
 1.3074592  0.9231765  1.0283607  0.86745685 1.1810242  0.5444346
 0.8670766  1.3695139  1.3071605  0.8670774  0.9238304  1.307475
 1.307204   0.6120927  0.6031896  1.3068364  0.6356516  0.58788913
 0.54314196 0.57801247 0.87272006 0.5532151  1.6705892  0.5431487
 0.52170384 0.84212613 1.3646157  0.5643949  1.1871922  0.6285504
 1.1465003  0.84738976 1.306802   1.307381   0.51157933 0.7554057
 1.6544629  0.8393489  0.5932815  0.9492342  0.5992997  0.5961446
 0.5961418  1.2942255  0.9181015  0.57398134 0.5739804  0.55219674
 0.73035073 0.6105724  0.56930363 0.9167015  0.61057204 0.66330934
 0.5425922  0.55278003 0.6060693  0.87257373 0.91937125 0.5776856
 0.54472816 1.5314339  0.5591556  0.5777503  0.58164436 0.87257046
 1.3473     0.54625154 0.5816456  0.9199922  0.8079641  1.7584714
 0.7974913  0.87611926 0.8411224  0.9193705  0.5932713  0.6006286
 0.5684499  1.962684   0.604934   0.6008264  1.7300217  0.57321465
 0.6105718  1.35594    0.6216948  1.849142   1.1080905  0.59326947
 0.8256169  0.587978   0.8460966  0.5543921  0.8803051  2.5065782
 0.9167238  0.60040504 0.60047626 0.5879137  0.5463297  0.6063146
 0.5732126  1.4837264  0.90129626 2.1444132  0.56936723 0.61057246
 1.503252   0.9116226  0.9114217  0.61058116 1.1430657  0.6105735
 0.94644815 1.2714252  0.629987   1.0618222  1.2714505  0.94780135
 0.89963174 0.57398015 0.5733136  0.8802233  0.8680213  1.4644828
 1.2715548  0.7303591  0.6105716  0.9167356  0.9167945  0.6003538
 0.8804403  0.8239906  1.1878444  0.73428637 0.91689426 0.7959375
 0.9170637  0.7959213  0.83418435 1.2714969  0.91242546 0.91299856
 0.9225706  0.9192583  2.1663938  0.9191689  0.9195117  0.91925496
 0.9191272  0.9192146  0.91929    0.9192316  1.2964325  0.9421097
 0.649645   0.9195188  0.91909945 0.91921216 0.9191444  0.91926205
 0.91909736 0.9193324  0.9192433  0.9190893  1.2521323  0.92117935
 0.9190849  1.2964319  0.91927946 0.61057216 0.4616505  0.91672903
 0.42209873 0.82798636 0.8995183  0.8995183  0.77382857 0.42209873
 0.9168346  0.8995103  0.90094537 0.9167503  0.90201706 0.9167806
 0.85023665 0.95483506 0.947053   0.9167391  0.9120359  0.91672987
 0.91694313 0.90640795 0.91676927 0.89950615 0.9167316  0.916834
 1.2714541  0.89960784 0.91685855 0.90297985 0.91686726 0.916724
 0.9167534  1.0765313  0.84586376 0.8458658  0.91909117 1.0495218
 0.52569836 0.9169119  0.9013084  1.0778438  0.9208713  0.89949936
 0.75227714 0.9006997  0.9167222  0.9167271  0.9037966  1.1056644
 0.84864557 0.91724944 1.2964331  0.90345407 0.8998518  1.8416939
 0.919099   0.9054828  1.2714907  0.9192046  0.9233248  1.2964337
 0.9167464  0.91678035 1.1801705  0.8486528  1.1300827  1.1055863
 0.55310833 1.194844   1.1948178  0.44872007 0.6098182  0.9190992
 0.9200345  1.1214     1.1057067  0.75620574 0.60992694 0.61589795
 0.9277605  0.92775613 0.9279664  0.9279054  0.92776215 1.253649
 1.1900765  0.9277496  0.9325441  0.9193007  0.91950816 0.91921306
 1.1948159  1.0685661  1.1950219  0.6334115  1.1948091  1.2522563
 1.2521199  0.9190945  1.2521186  0.9191458  1.1948054  0.5731059
 0.9072754  0.9074015  0.9277681  0.5730516  0.75645757 0.6504991
 0.9194886  0.91912353 0.9279175  0.6158987  0.9070332  0.9307882
 0.61589843 0.5806598  1.2536489  2.2334769  0.57467294 0.66542804
 0.56832325 0.6159063  0.5683232  0.580644   0.6298155  0.6298153
 1.1896807  0.94503695 1.1801354  0.6158979  0.6158993  0.6158974
 0.6080994  0.6158978  0.61589783 0.62981504 0.6158979  0.6158978
 0.61590195]
2025-06-03 10:10:32,930 - DEBUG - Edge reconstruction errors: [0.04323361 1.2435267  1.2473396  ... 0.04302654 0.04302633 1.1436125 ]
2025-06-03 10:10:32,931 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101032_update_16.json
2025-06-03 10:10:32,931 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:32,935 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101032_update_16.pth and as latest_checkpoint.pth
2025-06-03 10:10:32,935 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.3267
2025-06-03 10:10:32,935 - WARNING - Detected 19 anomalous nodes (reconstruction-based):
2025-06-03 10:10:32,935 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0154, MLP Score: 0.5073
2025-06-03 10:10:32,935 - WARNING -   Node ID: 23.33.92.48, Recon Error: 3.0139, MLP Score: 0.4949
2025-06-03 10:10:32,935 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.9094, MLP Score: 0.4819
2025-06-03 10:10:32,935 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8185, MLP Score: 0.4916
2025-06-03 10:10:32,935 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.9360, MLP Score: 0.4653
2025-06-03 10:10:32,935 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:32,935 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.7067, MLP Score: 0.4842
2025-06-03 10:10:32,935 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.8635, MLP Score: 0.5006
2025-06-03 10:10:32,936 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1320, MLP Score: 0.4981
2025-06-03 10:10:32,936 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.7900, MLP Score: 0.5123
2025-06-03 10:10:32,936 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.6806, MLP Score: 0.4966
2025-06-03 10:10:32,936 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:32,936 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:32,936 - INFO - Starting visualization of node features.
2025-06-03 10:10:32,936 - INFO - Graph has 715 nodes and 30 features.
2025-06-03 10:10:32,936 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:32,936 - INFO - Calculating feature statistics:
2025-06-03 10:10:32,937 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,937 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,937 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5437796), 'max': np.float32(1.9436969)}
2025-06-03 10:10:32,937 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-1.89119), 'max': np.float32(2.6003509)}
2025-06-03 10:10:32,937 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,937 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,937 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,937 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.42181066), 'max': np.float32(2.370732)}
2025-06-03 10:10:32,937 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1660773), 'max': np.float32(0.85757613)}
2025-06-03 10:10:32,937 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-2.1340965e-08), 'std': np.float32(1.0), 'min': np.float32(-9.290467), 'max': np.float32(0.11090706)}
2025-06-03 10:10:32,937 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(-2.1340965e-08), 'std': np.float32(1.0), 'min': np.float32(-3.639823), 'max': np.float32(1.3070177)}
2025-06-03 10:10:32,937 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-2.1340965e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2804745), 'max': np.float32(3.7169163)}
2025-06-03 10:10:32,937 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.316084), 'std': np.float32(1.0163454), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:32,937 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9608393), 'std': np.float32(0.27710664), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:32,938 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.13986014), 'std': np.float32(0.36644956), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:32,938 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.393007), 'std': np.float32(0.56291574), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:32,938 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(2.1340965e-08), 'std': np.float32(1.0), 'min': np.float32(-0.110907055), 'max': np.float32(9.290467)}
2025-06-03 10:10:32,938 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.5202796), 'std': np.float32(3.0889957), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:32,938 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6573424), 'std': np.float32(2.9325874), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:32,938 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.608392), 'std': np.float32(1.4951435), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:32,938 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.13986014), 'std': np.float32(0.36644956), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:32,938 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:10:32,938 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(2.6676206e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1282577), 'max': np.float32(15.1557865)}
2025-06-03 10:10:32,938 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.335241e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.14132045), 'max': np.float32(7.0761166)}
2025-06-03 10:10:32,938 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,938 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,938 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,938 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:32,938 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(2.1340965e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0001479), 'max': np.float32(8.773507)}
2025-06-03 10:10:32,939 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-2.6676204e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1050692), 'max': np.float32(4.4331865)}
2025-06-03 10:10:32,952 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c15a6510>
2025-06-03 10:10:33,094 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:33,148 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:33,179 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:34,448 - INFO - Node feature visualization saved to vis/node_features_20250603_101033.png
2025-06-03 10:10:34,448 - INFO - Finished visualization of node features.
2025-06-03 10:10:34,448 - INFO - Performing additional feature analysis:
2025-06-03 10:10:34,449 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:34,449 - INFO - Starting visualization of edge features.
2025-06-03 10:10:34,450 - INFO - Graph has 1521 edges and 10 edge features.
2025-06-03 10:10:34,450 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:34,450 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:34,450 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:34,450 - INFO - - count: {'name': 'count', 'unique': 15, 'mean': np.float32(6.1696253), 'std': np.float32(1.03338), 'min': np.float32(0.0), 'max': np.float32(14.0)}
2025-06-03 10:10:34,450 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4234056), 'std': np.float32(0.5072303), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:34,450 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.986193), 'std': np.float32(1.7676897), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-03 10:10:34,450 - INFO - - service: {'name': 'service', 'unique': 26, 'mean': np.float32(1.0032077e-08), 'std': np.float32(1.0), 'min': np.float32(-0.046280693), 'max': np.float32(28.645458)}
2025-06-03 10:10:34,450 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1024, 'mean': np.float32(-1.2540097e-09), 'std': np.float32(1.0), 'min': np.float32(-0.075644925), 'max': np.float32(28.088793)}
2025-06-03 10:10:34,450 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1082, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.067453384), 'max': np.float32(28.545845)}
2025-06-03 10:10:34,450 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 339, 'mean': np.float32(-3.762029e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05568627), 'max': np.float32(28.61098)}
2025-06-03 10:10:34,450 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1057, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.13027921), 'max': np.float32(19.717041)}
2025-06-03 10:10:34,450 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1072, 'mean': np.float32(-1.2540097e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12774907), 'max': np.float32(18.552853)}
2025-06-03 10:10:34,450 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 398, 'mean': np.float32(6.2700484e-10), 'std': np.float32(1.0), 'min': np.float32(-0.06670332), 'max': np.float32(28.010948)}
2025-06-03 10:10:34,462 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c267f7d0>
2025-06-03 10:10:34,686 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:34,700 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c2707c80>
2025-06-03 10:10:34,789 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:34,912 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:35,018 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:35,032 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:35,038 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:36,298 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101035.png
2025-06-03 10:10:36,298 - INFO - Finished visualization of edge features.
2025-06-03 10:10:36,298 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:36,299 - INFO - - Highest correlation (1.00) between features: 'service' and 'total_orig_pkts'.
2025-06-03 10:10:36,299 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:36,300 - INFO - Graph has 1521 edges and 10 edge features.
2025-06-03 10:10:36,300 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:36,580 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101036_summary.png
2025-06-03 10:10:36,829 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101036_pca_3d.png
2025-06-03 10:10:36,988 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101036_pca_variance.png
2025-06-03 10:10:36,988 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:36,988 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-03 10:10:36,988 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-03 10:10:36,988 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-03 10:10:37,005 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-03 10:10:37,019 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-03 10:10:37,019 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-03 10:10:37,019 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-03 10:10:37,032 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-03 10:10:37,047 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-03 10:10:37,047 - INFO - Processing node updates/additions.
2025-06-03 10:10:37,050 - INFO - Processing edge updates/additions.
2025-06-03 10:10:37,058 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:37,059 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:37,059 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:37,059 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:37,065 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-03 10:10:37,070 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:37,076 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-03 10:10:37,078 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-03 10:10:37,079 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:37,082 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-03 10:10:37,082 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:37,083 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:37,084 - DEBUG - Shape of encoded categorical edge features: torch.Size([1547, 3])
2025-06-03 10:10:37,085 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:37,085 - DEBUG - Shape of scaled numerical edge features: torch.Size([1547, 7])
2025-06-03 10:10:37,085 - DEBUG - Final edge attributes tensor shape: torch.Size([1547, 10])
2025-06-03 10:10:37,085 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:37,088 - INFO - Performing online update...
2025-06-03 10:10:37,088 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:37,089 - DEBUG - Updated RunningStats: new_mean=0.9536379750086101, new_var=9000000000160.664, new_n=930
2025-06-03 10:10:37,089 - DEBUG - Updated RunningStats: new_mean=0.9469063140169723, new_var=9300000000019.229, new_n=960
2025-06-03 10:10:37,089 - DEBUG - Updated RunningStats: new_mean=1.1165422497477628, new_var=3000000000049.3447, new_n=310
2025-06-03 10:10:37,089 - DEBUG - Updated RunningStats: new_mean=1.1138546008830312, new_var=3100000000000.887, new_n=320
2025-06-03 10:10:37,089 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:37,089 - DEBUG - Online update step: 1/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 2/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 3/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 4/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 5/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 6/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 7/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 8/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 9/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 10/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 11/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 12/50
2025-06-03 10:10:37,089 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,089 - DEBUG - Online update step: 13/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 14/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 15/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 16/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 17/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 18/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 19/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 20/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 21/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 22/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 23/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 24/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 25/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 26/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 27/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 28/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 29/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 30/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 31/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 32/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 33/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 34/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 35/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 36/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 37/50
2025-06-03 10:10:37,090 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,090 - DEBUG - Online update step: 38/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 39/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 40/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 41/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 42/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 43/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 44/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 45/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 46/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 47/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 48/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 49/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - DEBUG - Online update step: 50/50
2025-06-03 10:10:37,091 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,091 - WARNING - No successful steps during online update.
2025-06-03 10:10:37,092 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.8359610e-08  4.2209653e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.2036346e-08
  1.7477435e-08 -1.1871465e-08 -1.4509568e-08  2.3742929e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  1.1871465e-08  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  5.6059695e-09 -3.7592972e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.9357324e-09 -7.9967508e-09], current edge mean: [ 6.1700063e+00  1.4292178e+00  4.9864254e+00 -1.2329339e-09
  2.4658677e-09  1.2329339e-09 -2.4658677e-09 -2.4658677e-09
  0.0000000e+00  1.2329339e-09]
2025-06-03 10:10:37,092 - DEBUG - Node drift difference: 0.0184, Edge drift difference: 0.0115
2025-06-03 10:10:37,093 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.8359610e-08  4.2209653e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.2036346e-08
  1.7477435e-08 -1.1871465e-08 -1.4509568e-08  2.3742929e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  1.1871465e-08  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  5.6059695e-09 -3.7592972e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.9357324e-09 -7.9967508e-09], edge=[ 6.1700063e+00  1.4292178e+00  4.9864254e+00 -1.2329339e-09
  2.4658677e-09  1.2329339e-09 -2.4658677e-09 -2.4658677e-09
  0.0000000e+00  1.2329339e-09]
2025-06-03 10:10:37,093 - DEBUG - Updated reference std: node=[0.         0.         1.0006922  1.0006922  0.         0.
 0.         1.0006924  1.0006922  1.0006924  1.0006922  1.0006922
 1.0100604  0.27579054 0.37301496 0.5619617  1.0006924  3.101849
 2.9398093  1.5029361  0.37301496 0.         1.0006922  1.0006924
 0.         0.         0.         0.         1.0006922  1.0006924 ], edge=[1.0325518  0.50802064 1.7625387  1.0003234  1.0003234  1.0003233
 1.0003234  1.0003234  1.0003234  1.0003234 ]
2025-06-03 10:10:37,093 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:37,093 - INFO - Running anomaly detection...
2025-06-03 10:10:37,093 - INFO - Starting anomaly detection.
2025-06-03 10:10:37,105 - DEBUG - Node reconstruction errors: [1.1705711  0.9172827  1.102905   0.61233175 1.1692601  3.0372348
 3.021399   0.6971655  1.3501365  0.7397393  1.4482632  0.5979032
 1.150924   1.0925516  0.8990081  1.81404    0.74926656 0.7480867
 0.62640446 1.2547648  0.7480948  1.3541913  1.1882194  2.1982431
 2.9319696  1.5468417  0.7215061  0.9140333  0.74809825 1.3151015
 0.65326035 1.5469     1.8350588  2.8586342  2.0032747  2.5276554
 3.9912827  1.2633903  2.040375   1.2135372  1.3608365  1.2217119
 2.6781404  1.0925335  0.8999063  1.2776077  7.740435   1.0201333
 1.499102   1.2507896  3.7553282  1.1883069  1.1652232  1.2633904
 1.5467681  1.0996666  1.3797897  1.0017419  1.7338115  1.9712862
 5.245519   1.9496629  1.7681907  0.9568302  2.016557   0.8312201
 2.689475   1.1882194  1.2518126  1.4413762  1.7316291  1.0149748
 2.842845   1.0390816  2.3384652  1.394688   1.25079    1.3701872
 1.7944044  1.1281188  0.9192273  1.0141935  0.75177944 1.0925342
 1.0682398  1.2140292  0.7562676  2.8611486  0.53308433 1.2309426
 0.6908971  2.5989187  1.3348916  0.9332873  0.792657   4.772903
 0.5607706  0.95281726 0.9656829  0.7072917  1.1876179  0.5607701
 0.59749097 0.92880917 1.5819049  0.66725004 0.7547554  1.3493227
 1.356718   1.0444323  1.2464259  0.5781611  2.3998113  2.4187047
 1.1740483  0.93247914 1.128612   1.9476697  1.0044405  0.77677804
 0.64127886 1.4582274  1.8867539  1.4004201  0.8047169  0.7769697
 1.3358296  1.2123094  1.2051898  0.8730776  0.8292577  0.5986738
 0.6788219  2.442495   1.0538343  0.6931805  0.8638536  0.99686074
 1.2310627  1.9212943  0.61181104 1.0802752  0.63032305 0.57067573
 0.5884841  1.2212964  1.1286327  0.66999716 0.96160436 0.93661964
 1.6737982  1.7863184  1.49399    0.59867746 0.9774193  2.381892
 0.55093026 1.1747777  1.1876149  0.6168436  0.5984863  1.2016782
 0.55092704 0.8302926  1.0950099  1.9163698  1.65705    0.856051
 1.2088982  0.83710253 1.0687566  0.7852263  0.69685376 3.5756292
 0.8383158  0.62403494 1.0646846  1.0859314  1.0597148  1.0597136
 0.64656615 1.4179558  0.63340825 1.9335588  1.8352923  0.8711344
 0.6134789  1.0812144  0.68106663 0.5412411  1.0820534  0.8547704
 0.5315703  0.60519356 1.2309228  0.503403   3.0411737  0.6449818
 1.9924355  0.67899215 0.87341464 0.5512422  2.2383661  0.9791356
 1.0604179  1.3348923  0.9650737  2.0921597  0.94547176 1.3995569
 0.98094267 1.0964745  0.5169633  1.0616766  0.7267483  0.6016464
 1.1948284  1.1286093  1.1306875  0.6051596  2.4672573  0.6134815
 0.67052186 0.5169617  0.5508731  0.81608105 1.8379483  0.6473696
 0.9570868  1.4198253  1.3618667  0.75807726 1.1226935  1.1286392
 1.1286167  0.49262145 0.8190638  0.6705216  0.5510315  0.603855
 2.0183234  1.1203918  0.64308053 0.93655497 0.6155353  0.7670835
 0.94887215 0.8963575  0.6430813  0.56885725 0.696854   0.6607653
 1.1306612  0.9496059  0.932102   1.0721202  0.53502613 0.9209795
 0.60628736 1.0597137  1.2012131  1.6548419  0.55471706 0.7646347
 0.931966   0.770431   1.3065622  3.6605303  1.3066641  1.1373937
 1.7246058  1.8308452  1.1240315  0.90476364 1.5247706  1.059717
 0.6308174  0.9741535  0.64668316 0.7808189  3.407676   0.6496545
 0.8260968  0.8690427  1.2073802  0.8649881  2.53385    1.2686676
 1.4179559  1.304507   0.77316666 0.5314129  0.8875168  0.6155008
 1.5858023  0.941083   0.9864096  1.0605751  0.4922986  0.71243554
 0.77229077 0.95634276 1.4211522  1.4211537  0.9550657  0.9547366
 0.9547607  1.5078853  0.9294595  0.95559525 0.95477325 1.0707556
 0.95484376 0.52679    1.6208832  1.0255659  0.88274246 1.3708333
 0.5220249  0.50753194 1.2263261  0.75708413 0.8827242  1.421153
 0.6790887  1.8736656  0.94609505 1.50789    1.3815665  1.3815925
 1.3203647  0.5079106  0.9597113  1.5247761  0.954851   1.5078795
 0.77626854 0.6324568  0.9456949  0.9459909  1.0664071  0.6319396
 0.94571286 1.0871887  0.96781284 1.3066175  1.4211603  0.8436763
 1.3893648  0.88267314 0.9631062  0.8849431  2.2518601  1.0100118
 0.61737454 0.53502804 0.91739357 0.9547024  0.9769899  3.2490158
 0.98093575 0.9007919  1.0105367  0.9983627  1.4214787  4.010428
 0.6196751  2.1961327  1.0017115  0.8959767  1.071087   0.9505926
 1.0709836  1.7840463  1.2212682  1.0525944  0.6474388  0.98897463
 0.9112293  0.9547367  1.4211504  1.221043   0.5584665  0.7940784
 1.2210544  0.95763206 0.74054086 1.604699   1.431582   0.9554907
 1.131374   0.8140312  0.88475966 0.8004848  1.3349862  1.3345561
 1.3340687  1.9440761  0.9423603  1.9979042  0.5216587  0.99417317
 1.3346616  0.9401686  1.0489376  0.88513356 1.2037123  0.5535275
 0.88475776 1.3846679  1.3343672  0.88475746 0.9408249  1.3346771
 1.3344091  0.62014294 0.61461633 1.3340448  0.6466467  0.59727055
 0.55260587 0.5891198  0.8892452  0.56238693 1.686729   0.55261356
 0.5309572  0.85558194 1.374934   0.5716287  1.2090967  0.63850594
 1.1705388  0.86516815 1.3340118  1.3345866  0.52076155 0.7682628
 1.6655546  0.8536108  0.6026028  0.966915   0.6043579  0.6032859
 0.60328376 1.3033869  0.9305607  0.5811047  0.58110344 0.5612937
 0.74259263 0.6205631  0.5794058  0.933133   0.6205624  0.6723849
 0.55167353 0.5632979  0.6104785  0.88909966 0.9366933  0.5888123
 0.5525437  1.5381796  0.5695716  0.5888784  0.59279466 0.8890971
 1.3531097  0.5517021  0.59279597 0.93730503 0.8187116  1.7757838
 0.8062607  0.8925812  0.8559435  0.93669283 0.60259163 0.6113355
 0.57650054 1.9746683  0.6117774  0.6115321  1.7468437  0.5836153
 0.620563   1.3645908  0.62780225 1.8683106  1.1274489  0.6025898
 0.83587915 0.5973591  0.8601248  0.56491    0.89584    2.5316274
 0.9331556  0.6111107  0.61118156 0.5972942  0.5545496  0.617268
 0.58361155 1.4899815  0.91695964 2.1658783  0.57947004 0.6205629
 1.5067861  0.92875034 0.9285482  0.62057143 1.1649759  0.62056446
 0.96284556 1.2944313  0.63550097 1.076342   1.2944579  0.96550727
 0.91529065 0.5811032  0.58371544 0.8957581  0.8815641  1.4749949
 1.294561   0.7426001  0.62056273 0.93316746 0.93322414 0.6110597
 0.89597434 0.84004325 1.205589   0.7450593  0.9333254  0.81309676
 0.93349963 0.8130823  0.8489622  1.2945048  0.92955244 0.9301296
 0.9396975  0.9348498  2.171201   0.934762   0.9351101  0.934847
 0.9347196  0.93480855 0.9348823  0.9348248  1.3182666  0.9587276
 0.65470886 0.93511254 0.9346913  0.9348037  0.93473595 0.9348568
 0.93468857 0.93492764 0.93483675 0.9346804  1.2726364  0.9368
 0.93467724 1.3182659  0.9348743  0.6205627  0.45211324 0.93316066
 0.41644904 0.8400286  0.88747066 0.88747066 0.7856887  0.41644904
 0.93326795 0.9151698  0.9166134  0.9331825  0.91769993 0.9332136
 0.86517197 0.9709626  0.9647583  0.93317133 0.9291566  0.9331626
 0.9333784  0.92215663 0.9332025  0.9151659  0.9331639  0.93326694
 1.2944629  0.9152672  0.9332903  0.91869265 0.93329966 0.9331559
 0.9331847  1.0946507  0.8598966  0.8598986  0.9346829  1.0674407
 0.5148686  0.9333471  0.9169768  1.0932201  0.93647295 0.91515857
 0.7618123  0.91560733 0.9331535  0.93315774 0.826828   1.1225791
 0.865336   0.9336835  1.3182671  0.9191305  0.9155137  1.8586972
 0.9346905  0.92122865 1.294499   0.9347973  0.9389269  1.3182684
 0.9331779  0.9332124  1.1922175  0.86534333 1.1494982  1.122501
 0.560364   1.2170578  1.2170321  0.4420388  0.6191199  0.9346907
 0.9358283  1.1402268  1.1226226  0.78837913 0.61922926 0.6241958
 0.9428748  0.94286984 0.9430809  0.9430204  0.94287676 1.2709653
 1.2095793  0.942864   0.94773066 0.9348958  0.93510085 0.9348052
 1.2170302  1.0836214  1.2172269  0.6419871  1.2170231  1.272758
 1.2726243  0.9346861  1.2726227  0.93473697 1.2170202  0.5827828
 0.9222768  0.92240316 0.9428831  0.5827285  0.6653331  0.65793645
 0.93508154 0.9347158  0.9430312  0.62419564 0.9220313  0.94615686
 0.6241957  0.58962    1.2709649  2.2329047  0.58276653 1.9095055
 0.7267486  0.6242028  0.5763091  0.5896052  0.6362465  0.63624644
 1.2053554  0.9574381  1.1996008  0.6241954  0.6241972  0.6241957
 0.6156294  0.62419546 0.62419575 0.63624614 0.62419564 0.62419564
 0.6241995  0.7543369  0.6025279  0.7310868  0.73106426 0.7541699
 0.6316967  0.6362461  0.7541784 ]
2025-06-03 10:10:37,105 - DEBUG - Edge reconstruction errors: [0.04365334 1.2439462  1.247729   ... 0.0434491  0.04344888 1.1442151 ]
2025-06-03 10:10:37,108 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101037_update_17.json
2025-06-03 10:10:37,108 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:37,113 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101037_update_17.pth and as latest_checkpoint.pth
2025-06-03 10:10:37,113 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.3262
2025-06-03 10:10:37,113 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-03 10:10:37,113 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0372, MLP Score: 0.5073
2025-06-03 10:10:37,113 - WARNING -   Node ID: 23.33.92.48, Recon Error: 3.0214, MLP Score: 0.4953
2025-06-03 10:10:37,113 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.9320, MLP Score: 0.4817
2025-06-03 10:10:37,113 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8586, MLP Score: 0.4918
2025-06-03 10:10:37,113 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.9913, MLP Score: 0.4647
2025-06-03 10:10:37,113 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:37,114 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.6312, MLP Score: 0.4844
2025-06-03 10:10:37,114 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.8618, MLP Score: 0.5004
2025-06-03 10:10:37,114 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1288, MLP Score: 0.4979
2025-06-03 10:10:37,114 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.7848, MLP Score: 0.5122
2025-06-03 10:10:37,114 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.6786, MLP Score: 0.4966
2025-06-03 10:10:37,114 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-03 10:10:37,114 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-03 10:10:37,114 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-03 10:10:37,133 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-03 10:10:37,146 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-03 10:10:37,147 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-03 10:10:37,147 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-03 10:10:37,160 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-03 10:10:37,174 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-03 10:10:37,174 - INFO - Processing node updates/additions.
2025-06-03 10:10:37,177 - INFO - Processing edge updates/additions.
2025-06-03 10:10:37,185 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:37,185 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:37,186 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:37,186 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:37,193 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-03 10:10:37,195 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:37,196 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-03 10:10:37,197 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-03 10:10:37,198 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:37,203 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-03 10:10:37,204 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:37,205 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:37,206 - DEBUG - Shape of encoded categorical edge features: torch.Size([1559, 3])
2025-06-03 10:10:37,207 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:37,207 - DEBUG - Shape of scaled numerical edge features: torch.Size([1559, 7])
2025-06-03 10:10:37,207 - DEBUG - Final edge attributes tensor shape: torch.Size([1559, 10])
2025-06-03 10:10:37,207 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:37,209 - INFO - Performing online update...
2025-06-03 10:10:37,209 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:37,210 - DEBUG - Updated RunningStats: new_mean=0.9532945133823586, new_var=9600000000160.674, new_n=990
2025-06-03 10:10:37,210 - DEBUG - Updated RunningStats: new_mean=0.9469665315223916, new_var=9900000000019.166, new_n=1020
2025-06-03 10:10:37,210 - DEBUG - Updated RunningStats: new_mean=1.1182455413346668, new_var=3200000000049.3867, new_n=330
2025-06-03 10:10:37,210 - DEBUG - Updated RunningStats: new_mean=1.1157610677696062, new_var=3300000000000.894, new_n=340
2025-06-03 10:10:37,210 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:37,210 - DEBUG - Online update step: 1/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 2/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 3/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 4/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 5/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 6/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 7/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 8/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 9/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 10/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 11/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 12/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 13/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 14/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,210 - DEBUG - Online update step: 15/50
2025-06-03 10:10:37,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 16/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 17/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 18/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 19/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 20/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 21/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 22/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 23/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 24/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 25/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 26/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 27/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 28/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 29/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 30/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 31/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 32/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 33/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 34/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 35/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 36/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 37/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 38/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 39/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 40/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,211 - DEBUG - Online update step: 41/50
2025-06-03 10:10:37,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 42/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 43/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 44/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 45/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 46/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 47/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 48/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 49/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - DEBUG - Online update step: 50/50
2025-06-03 10:10:37,212 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,212 - WARNING - No successful steps during online update.
2025-06-03 10:10:37,212 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.4417707e-08 -4.0498499e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8990119e-09
 -5.4868934e-08 -9.1448218e-09 -1.5676838e-08  1.0451226e-08
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  9.1448218e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  3.2660079e-09  2.3515257e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683717e-08  3.5926087e-09], current edge mean: [ 6.1776781e+00  1.4271970e+00  4.9826813e+00 -3.6703309e-09
  0.0000000e+00  0.0000000e+00 -1.2234437e-09 -1.2234437e-09
  6.1172184e-10  1.2234437e-09]
2025-06-03 10:10:37,213 - DEBUG - Node drift difference: 0.0086, Edge drift difference: 0.0074
2025-06-03 10:10:37,213 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.4417707e-08 -4.0498499e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8990119e-09
 -5.4868934e-08 -9.1448218e-09 -1.5676838e-08  1.0451226e-08
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  9.1448218e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  3.2660079e-09  2.3515257e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683717e-08  3.5926087e-09], edge=[ 6.1776781e+00  1.4271970e+00  4.9826813e+00 -3.6703309e-09
  0.0000000e+00  0.0000000e+00 -1.2234437e-09 -1.2234437e-09
  6.1172184e-10  1.2234437e-09]
2025-06-03 10:10:37,213 - DEBUG - Updated reference std: node=[0.         0.         1.0006856  1.0006857  0.         0.
 0.         1.0006856  1.0006857  1.0006857  1.0006856  1.0006856
 1.0018492  0.28392488 0.37280026 0.56569636 1.0006857  3.0937886
 2.9347494  1.5104574  0.37280026 0.         1.0006857  1.0006857
 0.         0.         0.         0.         1.0006856  1.0006856 ], edge=[1.0597621 0.5076354 1.7680905 1.0003209 1.0003209 1.0003209 1.0003209
 1.0003209 1.0003209 1.0003209]
2025-06-03 10:10:37,213 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:37,214 - INFO - Running anomaly detection...
2025-06-03 10:10:37,214 - INFO - Starting anomaly detection.
2025-06-03 10:10:37,221 - DEBUG - Node reconstruction errors: [1.1718878  0.9204699  1.1048124  0.61201555 1.1725298  3.031579
 3.0126846  0.6940888  1.4279989  0.73317695 1.4446183  0.5956447
 1.1521237  1.0818759  0.8982746  1.7935958  0.7465883  0.7471327
 0.6255673  1.7782575  0.74714106 1.3373373  1.1739916  2.1253366
 2.9111164  1.5215276  0.71480316 0.9172173  0.74714375 1.2944798
 0.6490387  1.5215797  1.8212196  2.8919873  1.9893442  2.524684
 3.9100063  1.2460417  2.0628166  1.2071961  1.335594   1.2094605
 2.6601233  1.0818607  0.88624406 1.2516571  7.5666213  1.005138
 1.4950565  1.2308562  3.6683023  1.1740725  1.1516688  1.246041
 1.5214525  1.0858558  1.3543676  0.9854854  1.825401   1.8994248
 5.1561413  1.9395392  1.7517823  0.94549805 1.9855751  0.8185749
 2.590435   1.173992   1.2318014  1.4207084  1.7220594  1.0026671
 2.815821   1.040301   2.311865   1.4369648  1.2308563  1.3434297
 1.8028308  1.1059679  0.9063245  1.002263   0.7466692  1.0818609
 1.0485849  1.2008699  0.7501927  2.8361382  0.5250009  1.2182305
 0.69168127 2.6022372  1.333816   0.9377653  0.7864652  4.8086867
 0.5601495  0.94305825 0.9551662  0.7065243  1.1898341  0.56014884
 0.5977034  0.9268377  1.5791931  0.66685677 0.7926901  1.346461
 1.3585782  1.0403857  1.2340318  0.5783529  2.387775   2.409743
 1.1785054  0.9343275  1.1338446  1.9475874  1.0094554  0.7684461
 0.6425617  1.4494091  1.8858122  1.3950416  0.80851674 0.76862246
 1.3365328  1.216132   1.1994948  0.8604055  0.8191842  0.59903485
 0.6777752  2.4360554  1.0595819  0.6932602  0.85485584 0.9868166
 1.2354908  1.9243248  0.6049834  1.0793353  0.630883   0.56956935
 0.58415246 1.2249178  1.1338646  0.66936946 0.9521397  0.94193393
 1.672205   1.778467   1.4858727  0.5990375  2.1272135  2.3660867
 0.5507078  1.1660913  1.189832   0.616985   0.59395653 1.2019036
 0.5507055  0.8201902  1.0990086  1.9192088  1.6486657  0.8596802
 1.2059382  0.8380994  1.0707109  0.77490467 0.6973528  3.6177604
 0.8372272  0.6200297  1.0642765  1.0794669  1.063819   1.0638176
 0.6455902  1.4164346  0.6325632  1.9366058  1.8343575  0.868907
 0.6138369  1.0856228  0.6804371  0.54007274 1.0810343  0.8588325
 0.5255975  0.604761   1.235359   0.50026006 3.0376494  0.6424137
 1.9943362  0.6731126  0.8643257  0.5510066  2.2407928  0.98261654
 1.0640122  1.2051097  0.9540561  2.200733   0.9351034  1.3933271
 0.98587406 1.1017209  0.5157971  1.0527741  0.7410936  0.5989786
 1.1884272  1.1338421  1.1343564  0.60473055 2.459675   0.61383915
 0.67174053 0.51579535 0.5506527  0.8198068  1.8378476  0.6459816
 0.96073663 1.4083487  1.3540627  0.7585233  1.1105144  1.1338698
 1.133848   0.4898318  0.82084584 0.6717399  0.55080605 0.5967172
 2.0188992  1.1126071  0.64271206 0.9418727  0.61469346 0.7629629
 0.95341223 0.9020598  0.6427129  0.567934   0.69735324 0.66035265
 1.1343333  0.9451307  0.93396086 1.0765305  0.5341228  0.90976924
 0.6011542  1.0638182  1.1945584  1.6536695  0.5523364  0.7571203
 0.9298136  0.7637919  1.2998154  3.5805397  1.2999139  1.1306995
 1.7255982  1.8318217  1.1207721  0.89045036 1.518398   1.0638213
 0.6309248  0.97726554 0.64569926 0.7773724  3.3891802  0.6498991
 0.829672   0.8621143  1.2011324  0.85787547 2.5266845  1.2695138
 1.4164339  1.3011897  0.76362693 0.530081   0.8786148  0.61466193
 1.582651   0.9270898  0.98007685 1.0646479  0.48952332 0.70289993
 0.77455056 0.9457246  1.4155082  1.4155096  0.9445015  0.9441995
 0.9442226  1.5013337  0.91910183 0.9450186  0.94423413 1.0635159
 0.9443025  0.52623487 1.6092366  1.0245521  0.8792403  1.367897
 0.5203005  0.5030712  1.2206677  0.7464857  0.8857686  1.415508
 0.67694265 1.8761507  0.9357272  1.5013362  1.3753306  1.3753548
 1.3120017  0.5048799  0.9487806  1.5184034  0.94430846 1.501328
 0.76508415 0.6328184  0.9353579  0.93564296 1.0549775  0.6304772
 0.9353742  1.0735595  0.9612127  1.2998675  1.4155157  0.8373495
 1.3807986  0.8869325  0.95223564 0.8856857  2.2384326  1.0087094
 0.61576474 0.53412265 0.90561324 0.9441682  0.96596915 3.2242823
 0.9858668  0.89172566 0.99953645 0.9892607  1.4158263  4.0512505
 0.6213098  2.1841824  1.0070803  0.90062493 1.0638179  0.94344467
 1.0637201  1.7857949  1.2173373  1.0417706  0.64893055 0.9786818
 0.89911133 0.9441997  1.4155056  1.2186344  0.55871713 0.7957181
 1.2186465  0.7294436  0.7398848  1.601538   1.4249036  0.94489795
 1.1357478  0.81644225 0.88858396 0.8027832  1.3291599  1.3287315
 1.3282485  1.8753555  0.93195796 1.9299467  0.5195636  0.99822044
 1.3288388  0.92993605 1.0478623  0.8889424  1.1978838  0.5509104
 0.888581   1.3884284  1.3285449  0.8885807  0.93054736 1.3288528
 1.3285849  0.6159171  0.61324054 1.3282257  0.6481599  0.5976677
 0.55085576 0.5885201  0.89435285 0.5605376  1.679045   0.5508614
 0.5284947  0.8580046  1.3739501  0.5686032  1.2022629  0.63628715
 1.1624608  0.8703302  1.3281915  1.3287625  0.5187174  0.77232784
 1.6790421  0.84542847 0.60320765 0.95724297 0.6003123  0.60114497
 0.6011429  1.3013959  0.9320386  0.58109224 0.56576055 0.5599521
 0.7446588  0.62175906 0.57912844 0.92248154 0.62175965 0.6696786
 0.5501516  0.56367385 0.6054129  0.89420676 0.9416967  0.5895711
 0.54940826 1.5352479  0.5583774  0.5896321  0.59220695 0.8942042
 1.3485558  0.54987675 0.59220773 0.94228244 0.8215493  1.749991
 0.80695426 0.8976494  0.8593861  0.9416964  0.603197   0.61161965
 0.57626474 1.9738425  0.6085123  0.6118038  1.7467384  0.58256376
 0.6217595  1.3638898  0.6260222  1.8702735  1.118282   0.6031958
 0.83823985 0.5977466  0.8626311  0.56518465 0.8997631  2.450723
 0.9225041  0.61140805 0.7004767  0.5976879  0.55203706 0.61738837
 0.5825614  1.4833983  0.90570194 2.1683831  0.5791881  0.6217595
 1.4961908  0.91906494 0.91886574 0.62176687 1.1564416  0.6217598
 0.9504537  1.2870325  0.6326     1.0691667  1.2870559  0.9559515
 0.9041809  0.5810909  0.58265793 0.8996875  0.869729   1.4716948
 1.2871573  0.74466604 0.62175953 0.92251426 0.922567   0.6113608
 0.8998958  0.84294605 1.1969489  0.7473206  0.9226603  0.8167463
 0.92283094 0.8167323  0.8530425  1.2871022  0.9198326  0.9204025
 0.9296728  0.92325836 2.1623344  0.92317975 0.9235117  0.9232557
 0.9231388  0.92322344 0.92329127 0.9232361  1.3094038  0.94842464
 0.65149295 0.9235008  0.9231125  0.92321724 0.9231559  0.92326987
 0.9231103  0.9233378  0.9232521  0.92310256 1.2627233  0.9251105
 0.92309916 1.3094037  0.9232876  0.6217593  0.44804117 0.9225082
 0.4073265  0.84021693 0.8730203  0.8730203  0.78858167 0.4073265
 0.9226072  0.90407026 0.90540284 0.92253023 0.90642893 0.92255944
 0.84479076 0.95832473 0.9552276  0.9225187  0.9194332  0.92250973
 0.92271775 0.9107152  0.92254776 0.90406746 0.92251104 0.9226078
 1.2870598  0.90415937 0.9226304  0.9074225  0.92263794 0.9225039
 0.922532   1.0866878  0.8624103  0.86241156 0.923104   1.0569412
 0.509402   0.9226876  0.90573317 1.0825269  0.92475915 0.9040616
 0.7628306  0.90276134 0.9225014  0.9225053  0.8251438  1.1134156
 0.8695252  0.9229969  1.3094046  0.9077289  0.90439355 1.8438706
 0.92311215 0.909852   1.2870961  0.9232102  0.9270133  1.3094052
 0.92252463 0.9225566  1.1801498  0.8695327  1.1384978  1.1133434
 0.5588428  1.20898    1.2089552  0.4369634  0.61980313 0.9231116
 0.9245168  1.1292536  1.1134608  0.78771555 0.619901   0.6238184
 0.92990756 0.9299026  0.9301014  0.93004453 0.9299082  1.2583224
 1.1983215  0.92989737 0.9345891  0.923308   0.92348635 0.9232179
 1.2089524  1.0727057  1.2091424  0.6392821  1.2089471  1.1288713
 1.2627116  0.92310745 1.2627113  0.92315567 1.2089448  0.5811655
 0.9099185  0.910036   0.9299141  0.5811142  0.6607797  0.65443254
 0.9234728  0.9231335  0.9300552  0.6238186  0.9096832  0.93308204
 0.6238186  0.5866703  1.2583207  2.2184691  0.5790344  1.9004512
 0.7237269  0.62382543 0.5734011  0.5866584  0.6337632  0.63376313
 1.1906602  0.94184405 1.1890695  0.623818   0.6238202  0.6238182
 0.6141816  0.6238178  0.6238182  0.63376236 0.62381816 0.623818
 0.6238215  0.7499021  0.5970697  0.72308695 0.7133798  0.74974126
 0.6272394  0.6337625  0.7133401  2.2783868  0.67347693 0.6318742
 0.6577922  1.1338017  1.1327052  0.63376236]
2025-06-03 10:10:37,221 - DEBUG - Edge reconstruction errors: [0.04484818 1.2451323  1.2487136  ... 0.04465925 0.04465904 1.1453676 ]
2025-06-03 10:10:37,222 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101037_update_18.json
2025-06-03 10:10:37,223 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:37,227 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101037_update_18.pth and as latest_checkpoint.pth
2025-06-03 10:10:37,227 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.3282
2025-06-03 10:10:37,227 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-03 10:10:37,227 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0316, MLP Score: 0.5080
2025-06-03 10:10:37,227 - WARNING -   Node ID: 23.33.92.48, Recon Error: 3.0127, MLP Score: 0.4954
2025-06-03 10:10:37,227 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.9111, MLP Score: 0.4825
2025-06-03 10:10:37,227 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8920, MLP Score: 0.4922
2025-06-03 10:10:37,227 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.9100, MLP Score: 0.4649
2025-06-03 10:10:37,227 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:37,227 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.1984, MLP Score: 0.4854
2025-06-03 10:10:37,227 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 5.0517, MLP Score: 0.4995
2025-06-03 10:10:37,227 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0339, MLP Score: 0.4950
2025-06-03 10:10:37,227 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.6330, MLP Score: 0.5099
2025-06-03 10:10:37,227 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.5975, MLP Score: 0.4944
2025-06-03 10:10:37,227 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-03 10:10:37,227 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-03 10:10:37,227 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-03 10:10:37,244 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-03 10:10:37,258 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-03 10:10:37,258 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-03 10:10:37,259 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-03 10:10:37,273 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-03 10:10:37,288 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-03 10:10:37,288 - INFO - Processing node updates/additions.
2025-06-03 10:10:37,292 - INFO - Processing edge updates/additions.
2025-06-03 10:10:37,301 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:37,302 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:37,302 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:37,303 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:37,310 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-03 10:10:37,318 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:37,324 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-03 10:10:37,325 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-03 10:10:37,327 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:37,330 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-03 10:10:37,331 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:37,332 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:37,333 - DEBUG - Shape of encoded categorical edge features: torch.Size([1571, 3])
2025-06-03 10:10:37,334 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:37,334 - DEBUG - Shape of scaled numerical edge features: torch.Size([1571, 7])
2025-06-03 10:10:37,334 - DEBUG - Final edge attributes tensor shape: torch.Size([1571, 10])
2025-06-03 10:10:37,334 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:37,337 - INFO - Performing online update...
2025-06-03 10:10:37,337 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:37,338 - DEBUG - Updated RunningStats: new_mean=0.9529693508585702, new_var=10200000000160.625, new_n=1050
2025-06-03 10:10:37,338 - DEBUG - Updated RunningStats: new_mean=0.9469859019347208, new_var=10500000000019.137, new_n=1080
2025-06-03 10:10:37,338 - DEBUG - Updated RunningStats: new_mean=1.11980106781928, new_var=3400000000049.2695, new_n=350
2025-06-03 10:10:37,338 - DEBUG - Updated RunningStats: new_mean=1.1174459146364113, new_var=3500000000000.9194, new_n=360
2025-06-03 10:10:37,338 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:37,338 - DEBUG - Online update step: 1/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 2/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 3/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 4/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 5/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 6/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 7/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 8/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 9/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 10/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,338 - DEBUG - Online update step: 11/50
2025-06-03 10:10:37,338 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 12/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 13/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 14/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 15/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 16/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 17/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 18/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 19/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 20/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 21/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 22/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 23/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 24/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 25/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 26/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 27/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 28/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 29/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 30/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 31/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 32/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 33/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 34/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 35/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 36/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,339 - DEBUG - Online update step: 37/50
2025-06-03 10:10:37,339 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 38/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 39/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 40/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 41/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 42/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 43/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 44/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 45/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 46/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 47/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 48/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 49/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - DEBUG - Online update step: 50/50
2025-06-03 10:10:37,340 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,340 - WARNING - No successful steps during online update.
2025-06-03 10:10:37,341 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.7576843e-08 -4.7942866e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  3.6605027e-08  3.8872594e-09  1.6844790e-08 -1.2957532e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
 -3.8872594e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  4.0816225e-08 -1.2957531e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6886879e-08 -4.9562559e-08], current edge mean: [ 6.1763210e+00  1.4252069e+00  4.9700828e+00 -1.2140984e-09
  0.0000000e+00  4.2493444e-09  3.0352459e-10  1.5176230e-10
  1.5176230e-09  9.1057384e-10]
2025-06-03 10:10:37,341 - DEBUG - Node drift difference: 0.0102, Edge drift difference: 0.0071
2025-06-03 10:10:37,341 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.7576843e-08 -4.7942866e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  3.6605027e-08  3.8872594e-09  1.6844790e-08 -1.2957532e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
 -3.8872594e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  4.0816225e-08 -1.2957531e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6886879e-08 -4.9562559e-08], edge=[ 6.1763210e+00  1.4252069e+00  4.9700828e+00 -1.2140984e-09
  0.0000000e+00  4.2493444e-09  3.0352459e-10  1.5176230e-10
  1.5176230e-09  9.1057384e-10]
2025-06-03 10:10:37,342 - DEBUG - Updated reference std: node=[0.         0.         1.0006801  1.0006801  0.         0.
 0.         1.00068    1.00068    1.0006801  1.00068    1.0006801
 0.9868769  0.2827878  0.37280363 0.5652814  1.0006801  3.0891504
 2.9303455  1.5187457  0.37280363 0.         1.0006801  1.0006801
 0.         0.         0.         0.         1.0006801  1.0006801 ], edge=[1.0558177 0.507248  1.784861  1.0003184 1.0003184 1.0003184 1.0003184
 1.0003184 1.0003184 1.0003184]
2025-06-03 10:10:37,342 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:37,342 - INFO - Running anomaly detection...
2025-06-03 10:10:37,342 - INFO - Starting anomaly detection.
2025-06-03 10:10:37,364 - DEBUG - Node reconstruction errors: [1.181421   0.9285374  1.1107184  0.61524564 1.1839709  3.0466726
 2.8719435  0.69280493 1.4275283  0.736365   1.4476869  0.60220325
 1.1574016  1.0872879  0.9077708  1.8004682  0.7489036  0.75471604
 0.6327168  1.783732   0.75472397 1.3425758  1.1761322  2.1445525
 2.9250743  1.5190768  0.71230614 0.9258301  0.7547273  1.2906452
 0.64925295 1.5191253  1.8338271  2.9248617  1.9931374  2.5566468
 3.9524434  1.2446399  2.056807   1.2078762  1.3315846  1.2191868
 2.6618226  1.0872725  0.89155346 1.2488334  7.6394134  1.0050014
 1.497876   1.2314308  3.6963603  1.1762078  1.1545798  1.2446392
 1.5190048  1.0931202  1.3503426  0.9861136  1.7932813  1.9098411
 5.2037244  1.9474202  1.7622477  0.94900215 1.9841045  0.8109773
 2.5906823  1.1761315  1.2323309  1.4224358  1.7348012  1.0054808
 2.8300624  1.0464416  2.3292265  1.4243057  1.2314304  1.3406726
 1.825135   1.1067142  0.90928364 1.0055829  0.74386466 1.087273
 1.0515106  1.2114027  0.7469175  2.847491   0.5199315  1.2502933
 0.69645566 2.6515658  1.3419452  0.94677407 0.79724526 4.839002
 0.56413114 0.9474313  0.96504    0.71376055 1.1998843  0.5641309
 0.60230887 0.93933886 1.5866338  0.6751214  0.78686327 1.3712506
 1.3662432  1.0386599  1.2399837  0.5829407  2.4247842  2.442021
 1.1895599  0.94550425 1.1454409  1.9645504  1.0167968  0.777541
 0.64864504 1.4539999  1.909755   1.4046918  0.81830984 0.77771217
 1.3470914  1.2288551  1.2159022  0.86574465 0.8291005  0.60616
 0.682942   2.453122   1.0724242  0.7010096  0.86096674 0.9948092
 1.2471234  1.934875   0.6069361  1.0941682  0.6367232  0.57563144
 0.5879165  1.2343979  1.1454601  0.6746183  0.9641168  0.9501863
 1.6772263  1.7889823  1.4969335  0.6061623  2.1406696  2.395233
 0.5584433  1.1813635  1.1998819  0.62050647 0.5974915  1.2107072
 0.5584429  0.83008504 1.1111509  1.9296519  1.6634152  0.86867523
 1.212536   0.8435987  1.0767434  0.7819255  0.70173144 3.656384
 0.8608488  0.6242629  1.0757531  1.0955073  1.076203   1.0762019
 0.6529034  1.4233611  0.6393685  1.9573778  1.8454074  0.75118166
 0.6195957  1.0979103  0.68723613 0.5468738  0.9948798  0.86804557
 0.52691615 0.6117764  1.2469984  0.50420773 3.056642   0.64608175
 2.0126076  0.67547554 0.8729279  0.55873567 2.276756   0.99061126
 1.0761901  1.2090157  0.96461743 2.2284577  0.9453742  1.406432
 0.9995182  1.1134316  0.52085686 1.0606273  0.74063873 0.6044498
 1.2048982  1.1454391  1.1473405  0.61174715 2.501985   0.61959666
 0.6770863  0.52085567 0.558389   0.8293945  1.8456138  0.65178
 0.968656   1.407302   1.357201   0.7673277  1.1175145  1.145465
 1.1454462  0.49393755 0.82887495 0.67708623 0.5585409  0.5963244
 2.0451255  1.1222283  0.6486162  0.95012814 0.62118226 0.765715
 0.96759266 0.9164027  0.6486166  0.5750227  0.701732   0.66520244
 1.1473174  0.9535694  0.9451525  1.0883297  0.5410111  0.91995144
 0.604528   1.0762022  1.208384   1.6624159  0.5566619  0.766346
 0.94009703 0.77441573 1.3130081  3.616832   1.3131032  1.1469089
 1.7431598  1.8526618  1.1336367  0.89490515 1.5355842  1.0762056
 0.63778985 0.9836818  0.65300715 0.7811217  3.4622858  0.6565694
 0.83715016 0.8688255  1.1317958  0.86555094 2.5395453  1.2782298
 1.4233613  1.3076831  0.7716029  0.5344433  0.88966864 0.6211529
 1.5901914  0.93451273 0.9904006  1.0770053  0.4936348  0.703205
 0.7825574  0.95600504 1.4338394  1.433841   0.9548072  0.95451874
 0.95454156 1.5182976  0.9298392  0.9553207  0.954552   2.067876
 0.9546204  0.53375834 1.6187909  1.0353525  0.88859594 1.3743895
 0.52483886 0.50587046 1.2353444  0.7525662  0.8938048  1.4338403
 0.68277985 1.897438   0.9462538  1.5183002  1.3883598  1.3883816
 1.3257526  0.50916207 0.95887524 1.5355879  0.95462483 1.5182921
 0.78430206 0.63830286 0.9459019  0.9461826  1.0650544  0.63643897
 0.94591975 1.0831422  0.9743213  1.313059   1.4338462  0.84616315
 1.3915944  0.89595276 0.9624104  0.89837813 2.2725973  1.0249307
 0.62246615 0.54101014 0.9152018  0.95448893 0.9754256  3.215962
 0.99951226 0.9040964  1.0042154  1.0004675  1.434148   4.0907993
 0.6276436  2.2055535  1.018986   0.9128964  1.0749305  0.9541625
 1.0748316  1.8089585  1.2301148  1.0573918  0.6547669  0.9896534
 0.90710825 0.95451814 1.4338378  1.2256933  0.5661693  0.8009973
 1.2257047  0.7403782  0.74605376 1.6089675  1.4420565  0.95518726
 1.1452452  0.82869506 0.90150845 0.81494033 1.3473431  1.346902
 1.3464037  1.8878791  0.94232094 1.9419383  0.5260991  1.0088016
 1.3470114  0.9403943  1.0633073  0.90185285 1.2119223  0.5569092
 0.9015056  1.399342   1.3467094  0.90150505 0.9409813  1.3470268
 1.3467507  0.62005407 0.6198053  1.3463796  0.6539917  0.60324085
 0.5573236  0.595019   0.9062502  0.566631   1.6897758  0.5573299
 0.534866   0.86817986 1.3806139  0.57257944 1.2154453  0.64328057
 1.180929   0.88299656 1.3463453  1.3469354  0.5252725  0.779821
 1.6897738  0.8545466  0.608869   0.9688943  0.69546956 0.60482115
 0.6048194  1.3088008  0.7957161  0.5583541  0.56782883 0.5663988
 0.7517615  0.62761533 0.5864197  0.9328182  0.6276153  0.67572176
 0.55644596 0.5712429  0.60590416 0.90610534 0.9539139  0.59709865
 0.5546038  1.5383681  0.563108   0.5971581  0.59888846 0.90610325
 1.35239    0.5532764  0.5988897  0.9544817  0.8277056  1.7588707
 0.81149095 0.9095329  0.87066156 0.9539137  0.60885924 0.61868477
 0.58074015 1.982254   0.61132973 0.5802609  1.7598749  0.5889397
 0.6276149  1.3702494  0.6289504  1.8858935  1.1332133  0.60885745
 0.84350616 0.60332024 0.8733195  0.5726895  0.91112685 2.4655259
 0.93284035 0.6184807  0.69647497 0.60326254 0.5576767  0.62419796
 0.5889371  1.4860532  0.91573846 2.186553   0.5864778  0.627615
 1.5221531  0.9312223  0.9310256  0.61746186 1.1740857  0.6276163
 0.9599669  1.3039799  0.6346887  1.0787343  1.304004   0.9676909
 0.91428757 0.58561814 0.589031   0.9110542  0.8787318  1.477268
 1.3041031  0.75176734 0.62761503 0.93285096 0.9328991  0.6184357
 0.91125524 0.85540366 1.2075734  0.75394595 0.93298763 0.82927114
 0.9331582  0.829259   0.8539816  1.3040482  0.93196356 0.9325264
 0.9415445  0.93305975 2.1647887  0.9329868  0.9333135  0.93305784
 0.9329474  0.93302983 0.93309325 0.93303984 1.3251364  0.960057
 0.65346915 0.93329316 0.9329212  0.9330215  0.93296415 0.9330759
 0.93292046 0.9331429  0.9330593  0.93291223 1.2779814  0.9348802
 0.9329081  1.3251373  0.93309385 0.62761503 0.45001248 0.93284404
 0.40775636 0.849264   0.86968046 0.86968046 0.79515326 0.40775636
 0.93293875 0.9141836  0.91546667 0.9328648  0.9164696  0.932894
 0.8511473  0.96762824 0.96698666 0.93285316 0.931562   0.93284565
 0.9330492  0.9206618  0.932882   0.91418207 0.9328467  0.93293834
 1.3040078  0.9142676  0.93296087 0.91745985 0.9329666  0.93283904
 0.93286663 1.0993336  0.8731082  0.8731097  0.9329128  1.0695561
 0.5101797  0.93301964 0.91577834 1.092435   0.9345042  0.9141759
 0.7684378  0.9115246  0.9328372  0.93284184 0.83480203 1.1244181
 0.881387   0.93331265 1.3251368  0.9176756  0.91449606 1.8543351
 0.93292147 0.91983527 1.3040447  0.9330146  0.93662983 1.3251383
 0.9328592  0.9328902  1.185241   0.88139427 1.1534553  1.1243513
 0.5714683  1.2253864  1.2253629  0.4394267  0.625207   0.9329213
 0.935446   1.1439656  1.1244628  0.79767543 0.6253035  0.628617
 0.9390158  0.9390105  0.9392036  0.939148   0.9390169  1.271427
 1.2133679  0.9390043  0.94361806 0.93311334 0.9332771  0.93302184
 1.2253611  1.0823047  1.2255337  0.6442417  1.2253555  1.1391636
 1.2779706  0.9329164  1.2779691  0.93296266 1.2253535  0.58714294
 0.91915613 0.9192684  0.93902284 0.5870933  0.6642102  0.65864766
 0.93326783 0.932942   0.9391568  0.62861705 0.9189244  0.9420143
 0.62861735 0.5916871  1.2714258  2.2167046  0.58378714 1.8856112
 0.7328815  0.6286237  0.57981956 0.59167653 0.63751197 0.6375123
 1.2022588  0.9498078  1.2037581  0.6286167  0.62861806 0.628617
 0.61825365 0.6286169  0.6286169  0.6375121  0.6286167  0.6286169
 0.62862    0.757297   0.6010691  0.72251385 0.71037114 0.7571442
 0.63170123 0.6375115  0.7103316  2.278498   0.6736727  0.63250625
 0.65842736 1.1414338  1.1403888  0.63751185 1.5816988  0.8188101
 0.6584274  0.9788263  0.7711168  0.749882  ]
2025-06-03 10:10:37,364 - DEBUG - Edge reconstruction errors: [0.04505205 1.2453291  1.2487581  ... 0.04487405 0.04487384 1.1455402 ]
2025-06-03 10:10:37,365 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101037_update_19.json
2025-06-03 10:10:37,365 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:37,369 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101037_update_19.pth and as latest_checkpoint.pth
2025-06-03 10:10:37,369 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.3278
2025-06-03 10:10:37,370 - WARNING - Detected 19 anomalous nodes (reconstruction-based):
2025-06-03 10:10:37,370 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0467, MLP Score: 0.5080
2025-06-03 10:10:37,370 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.8719, MLP Score: 0.4898
2025-06-03 10:10:37,370 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.9251, MLP Score: 0.4823
2025-06-03 10:10:37,370 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.9249, MLP Score: 0.4925
2025-06-03 10:10:37,370 - WARNING -   Node ID: 192.168.27.12, Recon Error: 3.9524, MLP Score: 0.4644
2025-06-03 10:10:37,370 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:37,370 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.8816, MLP Score: 0.4864
2025-06-03 10:10:37,370 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 5.0980, MLP Score: 0.4999
2025-06-03 10:10:37,370 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9581, MLP Score: 0.4940
2025-06-03 10:10:37,370 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.5123, MLP Score: 0.5097
2025-06-03 10:10:37,370 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.5326, MLP Score: 0.4937
2025-06-03 10:10:37,370 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-03 10:10:37,370 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-03 10:10:37,370 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-03 10:10:37,387 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-03 10:10:37,401 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-03 10:10:37,401 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-03 10:10:37,401 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-03 10:10:37,415 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-03 10:10:37,430 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-03 10:10:37,431 - INFO - Processing node updates/additions.
2025-06-03 10:10:37,433 - INFO - Processing edge updates/additions.
2025-06-03 10:10:37,441 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:37,442 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:37,442 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:37,442 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:37,449 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-03 10:10:37,452 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:37,452 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-03 10:10:37,453 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-03 10:10:37,454 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:37,457 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-03 10:10:37,457 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:37,458 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:37,459 - DEBUG - Shape of encoded categorical edge features: torch.Size([1619, 3])
2025-06-03 10:10:37,460 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:37,460 - DEBUG - Shape of scaled numerical edge features: torch.Size([1619, 7])
2025-06-03 10:10:37,460 - DEBUG - Final edge attributes tensor shape: torch.Size([1619, 10])
2025-06-03 10:10:37,460 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:37,463 - INFO - Performing online update...
2025-06-03 10:10:37,463 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:37,463 - DEBUG - Updated RunningStats: new_mean=0.9526347426151807, new_var=10800000000160.68, new_n=1110
2025-06-03 10:10:37,463 - DEBUG - Updated RunningStats: new_mean=0.9469126183220594, new_var=11100000000019.018, new_n=1140
2025-06-03 10:10:37,464 - DEBUG - Updated RunningStats: new_mean=1.1212179303684808, new_var=3600000000049.285, new_n=370
2025-06-03 10:10:37,464 - DEBUG - Updated RunningStats: new_mean=1.118923725002696, new_var=3700000000000.925, new_n=380
2025-06-03 10:10:37,464 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:37,464 - DEBUG - Online update step: 1/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 2/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 3/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 4/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 5/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 6/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 7/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 8/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 9/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 10/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 11/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 12/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 13/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 14/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 15/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 16/50
2025-06-03 10:10:37,464 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,464 - DEBUG - Online update step: 17/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 18/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 19/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 20/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 21/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 22/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 23/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 24/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 25/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 26/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 27/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 28/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 29/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 30/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 31/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 32/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 33/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 34/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 35/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 36/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 37/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 38/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 39/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 40/50
2025-06-03 10:10:37,465 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,465 - DEBUG - Online update step: 41/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 42/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 43/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 44/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 45/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 46/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 47/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 48/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 49/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - DEBUG - Online update step: 50/50
2025-06-03 10:10:37,466 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,466 - WARNING - No successful steps during online update.
2025-06-03 10:10:37,466 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -6.25770546e-09 -6.38285940e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.89542159e-08
 -1.12638698e-08 -1.37669520e-08 -3.75462328e-09 -1.00123287e-08
  2.29790020e+00  2.96062994e+00  1.40419945e-01  4.39238834e+00
  1.37669520e-08  3.44750667e+00  5.70734930e+00  7.59317589e+00
  1.40419945e-01  8.00000000e+00 -1.84602307e-08  7.50924656e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  1.30629605e-08  3.87977757e-08], current edge mean: [ 6.1741815e+00  1.4200124e+00  4.9759111e+00  4.1233603e-09
  5.8905147e-10  2.3562059e-09  3.5343088e-09  1.1781029e-09
  0.0000000e+00 -1.1781029e-09]
2025-06-03 10:10:37,467 - DEBUG - Node drift difference: 0.0179, Edge drift difference: 0.0102
2025-06-03 10:10:37,467 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -6.25770546e-09 -6.38285940e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.89542159e-08
 -1.12638698e-08 -1.37669520e-08 -3.75462328e-09 -1.00123287e-08
  2.29790020e+00  2.96062994e+00  1.40419945e-01  4.39238834e+00
  1.37669520e-08  3.44750667e+00  5.70734930e+00  7.59317589e+00
  1.40419945e-01  8.00000000e+00 -1.84602307e-08  7.50924656e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  1.30629605e-08  3.87977757e-08], edge=[ 6.1741815e+00  1.4200124e+00  4.9759111e+00  4.1233603e-09
  5.8905147e-10  2.3562059e-09  3.5343088e-09  1.1781029e-09
  0.0000000e+00 -1.1781029e-09]
2025-06-03 10:10:37,468 - DEBUG - Updated reference std: node=[0.         0.         1.0006568  1.0006568  0.         0.
 0.         1.0006568  1.0006567  1.0006567  1.0006568  1.0006568
 0.97361827 0.27801365 0.36245453 0.5658664  1.0006567  3.0614383
 2.9225075  1.5215856  0.36245453 0.         1.0006568  1.0006568
 0.         0.         0.         0.         1.0006568  1.0006568 ], edge=[1.0473584 0.5060766 1.7847834 1.000309  1.000309  1.000309  1.000309
 1.000309  1.000309  1.000309 ]
2025-06-03 10:10:37,468 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:37,468 - INFO - Running anomaly detection...
2025-06-03 10:10:37,468 - INFO - Starting anomaly detection.
2025-06-03 10:10:37,502 - DEBUG - Node reconstruction errors: [1.2377871  0.98606396 1.1612995  0.6408165  1.249487   3.1290474
 2.867606   0.7202582  1.4471929  0.7721334  1.4916098  0.6445989
 1.2041744  1.1290206  0.96630454 1.844937   0.7820323  0.8027308
 0.6783246  1.8173478  0.80273926 1.3908937  1.2088354  2.2367811
 3.007605   1.5460324  0.7360788  0.9862917  0.8027382  1.309394
 0.6814244  1.5460703  1.8970121  3.0474534  2.0293622  2.608047
 4.585151   1.2681214  2.1749537  1.2329973  1.3521267  1.2772111
 2.6762667  1.12901    0.9475677  1.3032552  7.825242   1.7846643
 1.5375453  1.2648159  3.8289797  1.2088966  1.1900469  1.2681214
 1.545966   1.1440486  1.3708078  0.99961096 1.9136219  1.993107
 5.289767   1.9889551  1.8265407  0.98241335 2.0084102  0.8150695
 2.6379468  1.2088352  1.2655865  1.4607948  1.7963537  1.0264249
 2.9012904  1.0949018  2.4449646  1.4546494  1.2648157  1.3619622
 1.779668   1.126976   0.9316863  1.0417228  0.75935894 1.1290096
 1.0794412  1.2680353  0.7590093  2.9236314  0.5034845  1.3089427
 0.7286055  2.6047342  1.3816463  1.0097656  0.87558395 4.9610257
 0.60492134 1.0028265  1.0183412  0.7564531  1.2643244  0.6049207
 0.6266587  0.99142265 1.6751201  0.7271208  1.4631326  1.406993
 1.4069141  1.0354476  1.2942446  0.6097774  2.5814044  2.6200814
 1.2491035  1.000664   1.2071913  1.9962432  1.0714653  0.84949136
 0.68382895 1.4964147  1.9356021  1.4636352  0.87913287 0.8496389
 1.3951733  1.2895832  1.1550319  0.919057   0.88203675 0.64745533
 0.71945536 2.5270908  1.1366999  0.74500656 0.89474136 1.0456543
 1.2623212  2.0224473  0.6291713  1.1639525  0.67043465 0.6135525
 0.6160227  1.2908936  1.2072071  0.7126897  1.025052   1.0063925
 1.7247808  1.8453288  1.5667027  0.6474579  2.2340486  2.4294336
 0.6074203  1.2584316  1.2643225  0.64437085 0.62474215 1.2615697
 0.60742223 0.8829447  1.1816294  2.0166163  1.7395531  0.9317313
 1.2664666  0.8898603  1.130352   0.8493347  0.73279774 3.7987697
 0.88955516 0.6530435  1.1426575  1.1678003  1.1493039  1.1493031
 0.7050045  1.4595627  0.68495953 2.0067186  1.8933578  0.8723084
 0.6530975  1.1695019  0.7264206  0.59657264 1.0633557  0.93278664
 0.5535669  0.6582948  1.2621806  0.5401825  3.1235871  0.67244107
 2.0434136  0.70373744 0.9204557  0.60776305 2.3054435  1.0503982
 1.1430253  1.2435932  1.0214156  2.1940527  0.9992373  1.4810166
 1.0755038  1.1760291  0.5641271  1.1274525  0.76743287 0.64279634
 1.2798812  1.2071892  1.2171723  0.65826195 2.5802567  0.6530984
 0.71128345 0.56412715 0.6073606  0.7969195  1.9176266  0.694927
 1.0308441  1.4192013  1.3842294  0.8257469  1.1717337  1.2072135
 1.2071955  0.5285098  0.8905872  0.711283   0.60753924 0.6228154
 2.071356   1.1826003  0.6870107  1.0063435  0.66817707 0.8784828
 1.0428329  0.98273355 0.68701094 0.68403107 0.7327984  0.7085001
 1.2171491  1.0320402  1.0003331  1.149146   0.58932394 0.9735377
 0.6342811  1.1493037  1.282743   1.6997962  0.585222   0.8384842
 0.97517574 0.8523658  1.3858525  3.7163026  1.3859372  1.2453486
 1.8071978  1.9081886  1.2171487  0.93001664 1.6190841  1.149307
 0.68255955 1.0442375  0.7051268  0.8307244  3.5295508  0.7016479
 0.8905572  0.904682   1.2112728  0.90689725 2.6125448  1.3374125
 1.4595627  1.3461086  0.87674904 0.5752677  0.9453992  0.668144
 2.9595883  0.9797997  1.07654    1.1503074  0.5281779  0.7601974
 0.84801114 1.011102   1.5186474  1.5186485  1.0100048  1.0097591
 1.0097787  1.600327   0.9857193  1.0104924  1.0097861  2.1443646
 1.0098509  0.58398837 1.6790403  1.1250297  0.935848   1.411438
 0.5648767  0.5372341  1.3122457  0.8073891  0.9524982  1.5186477
 1.3747733  1.9509099  1.0018376  1.6003286  1.4633712  1.4633907
 1.3962109  0.5432564  1.0134752  1.6190894  1.0098536  1.600322
 0.8434161  0.6854989  1.0015334  1.0017933  1.1170014  0.6788274
 1.0015494  1.142481   1.066589   1.1813712  1.5186523  0.89018714
 1.4593139  0.9617069  1.0169783  0.9650296  2.36883    1.127633
 0.6689584  0.5893195  0.96682966 1.0097309  1.0273502  3.2007356
 1.0754969  0.95995945 1.0542867  1.0640942  1.5189139  4.235311
 0.6635973  2.29172    1.0828805  0.9720299  1.1399568  1.0167112
 1.1398612  1.8836131  1.3030485  1.1507741  0.68984836 1.0466607
 0.9862023  1.0097585  1.5186455  1.2689991  0.60596645 0.84639436
 1.2660583  0.72482896 0.78586    1.6501185  1.5236835  1.0103391
 1.1924899  0.90357375 0.9800424  0.8913755  1.4298859  1.4294999
 1.4290645  1.9734031  0.997191   2.0066996  0.5746778  1.0605379
 1.4295965  0.9955413  1.1668639  0.9804164  1.2875506  0.6038683
 0.9800404  1.4583691  1.429332   0.98004025 0.99605364 1.4296087
 1.4293679  0.64985913 0.6636613  1.4290453  0.68910617 0.6364535
 0.60539544 0.58167285 0.96397537 0.60399896 1.754925   0.605413
 0.5853376  0.94608784 1.4351071  0.607061   1.2884908  0.6937014
 1.2617075  0.944826   1.4290138  1.4295276  0.5737057  0.8315798
 1.7549212  0.90390074 0.6418778  1.0267644  0.71668065 0.6311861
 0.63783836 1.3507062  0.82438457 0.5888223  0.5887564  0.6047269
 0.72290814 0.66123784 0.62674004 0.9866125  0.6612381  0.7123276
 0.59469    0.61283964 0.6206829  0.96384937 1.0136924  0.6374933
 0.58803344 1.5574162  0.5953104  0.6375464  0.6451226  0.96384645
 1.3817388  0.5780182  0.6451226  1.0141882  0.8758182  1.8162402
 0.853886   0.96688473 0.88670576 1.013692   0.64187074 0.6582194
 0.6079958  2.0510795  0.636551   0.59052914 1.7792712  0.6281332
 0.66123784 1.3940648  0.6496631  1.9623622  1.2040291  0.6418694
 0.82529414 0.63651884 0.92643076 0.61409694 0.96646446 2.5396326
 0.98663384 0.6580398  0.71755916 0.6364707  0.7168616  0.6690285
 0.6327649  1.5033776  0.96870905 2.3045142  0.62679017 0.6612376
 1.5263973  0.9902426  0.9900654  0.63784796 1.2534927  0.6378365
 1.0099946  1.3793831  0.65330064 1.1423367  1.3794055  1.0257875
 0.9674691  0.61364406 0.6327667  0.96639836 0.9263999  1.5095285
 1.3794945  0.8144948  0.6533639  0.9866411  0.986682   0.6580008
 0.9665834  0.9311782  1.27297    0.80127746 0.98675853 0.9047123
 0.98692185 0.90469944 0.8993881  1.3794439  0.9418316  0.9913992
 0.9542923  0.9843852  2.1842704  0.9843265  0.9846277  0.9843852
 0.98429173 0.9843666  0.9844197  0.9843724  1.3953278  0.9460228
 0.67073005 0.98458964 0.9842686  0.98435587 0.98430634 0.9844097
 0.9842656  0.9844709  0.98439306 0.98425937 1.3473576  0.9860475
 0.98425573 1.3953274  0.98442584 1.5264024  0.4752053  0.9866365
 0.41939238 0.79555047 0.858113   0.858113   0.84303    0.41939238
 0.98671913 0.96738213 0.96850365 0.9866553  0.9694108  0.8934925
 0.90704954 1.0163997  1.025161   0.986645   0.9905088  0.9866375
 0.9868263  0.96907085 0.9866698  0.9673813  0.9866384  0.98671836
 1.3794065  0.9674523  0.986739   0.97036785 0.9867436  0.98663175
 0.9866559  1.1690654  0.9262518  0.9262529  0.9842607  1.1304804
 0.5368961  0.98679906 0.96876556 1.1521392  0.98564684 0.9673749
 0.81118786 0.96101683 0.9866289  0.9866339  0.8713205  1.1869093
 0.93783087 0.9870446  1.3953279  0.96620667 0.96765894 1.9085437
 0.9842674  0.9724985  1.3794414  0.98434895 0.98744494 1.3953288
 0.96272445 0.9866749  1.2341241  0.93783724 1.219837   1.1868559
 0.6043061  1.2972317  1.2972125  0.46402267 0.6566534  0.9842672
 0.99030983 1.2094206  1.1869493  0.86802447 0.6567339  0.65773606
 0.98845536 0.9884523  0.98861974 0.9885717  0.9884566  1.3332222
 1.2786316  0.98844856 0.99263346 0.9844448  0.9718432  0.98435515
 1.2972105  1.139831   1.2973468  0.6756133  1.2972063  1.0738869
 1.3473474  0.9842623  1.3473467  0.9843028  1.2972043  0.6273921
 0.9686543  0.96874875 0.98846346 0.627392   0.71904975 0.6867091
 0.98456925 0.98428446 0.98857975 0.6577362  0.9684457  0.988356
 0.65773636 0.62778586 1.3332208  1.8850772  0.6228715  1.9430937
 0.8006024  0.65774095 0.62784475 0.6277857  0.66322297 0.6632229
 1.2575387  0.99580765 1.268163   0.65773636 0.6577371  0.65773606
 0.6447355  0.65773636 0.6577362  0.6632229  0.65773624 0.6577361
 0.6577385  0.78341585 0.63515604 0.76721156 0.74738663 0.8208658
 0.65962213 0.66322243 0.7473406  2.3223832  0.68943375 0.6554176
 0.6740154  1.1852708  1.1844146  0.66322273 1.5663574  0.83131665
 0.67401475 1.010605   0.7673127  2.0448208  0.6751716  0.6751672
 0.67516255 1.0413804  0.69766784 1.843059   0.79515666 0.8291578
 0.6957093  0.67122203 1.0218757  1.0101755  0.67738014 0.675644
 0.6740188  0.67562956 0.67401487 0.8291517  1.0101768  0.8683493
 0.6712229  0.73648953 0.67516434 1.0414635  0.6740207  1.0393833 ]
2025-06-03 10:10:37,503 - DEBUG - Edge reconstruction errors: [0.04781113 1.2480595  1.2510234  ... 0.04766276 0.04766258 1.1482158 ]
2025-06-03 10:10:37,505 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101037_update_20.json
2025-06-03 10:10:37,506 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:37,511 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101037_update_20.pth and as latest_checkpoint.pth
2025-06-03 10:10:37,511 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.3283
2025-06-03 10:10:37,511 - WARNING - Detected 19 anomalous nodes (reconstruction-based):
2025-06-03 10:10:37,511 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1290, MLP Score: 0.5092
2025-06-03 10:10:37,511 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.8676, MLP Score: 0.4918
2025-06-03 10:10:37,511 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0076, MLP Score: 0.4829
2025-06-03 10:10:37,511 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 3.0475, MLP Score: 0.4935
2025-06-03 10:10:37,512 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.5852, MLP Score: 0.4676
2025-06-03 10:10:37,512 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 10:10:37,512 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.9867, MLP Score: 0.4908
2025-06-03 10:10:37,512 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.7568, MLP Score: 0.5032
2025-06-03 10:10:37,512 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.6787, MLP Score: 0.4887
2025-06-03 10:10:37,512 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.0654, MLP Score: 0.5078
2025-06-03 10:10:37,512 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.2908, MLP Score: 0.4900
2025-06-03 10:10:37,512 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-03 10:10:37,512 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-03 10:10:37,512 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-03 10:10:37,531 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-03 10:10:37,549 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-03 10:10:37,549 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-03 10:10:37,549 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-03 10:10:37,564 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-03 10:10:37,580 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-03 10:10:37,581 - INFO - Processing node updates/additions.
2025-06-03 10:10:37,584 - INFO - Processing edge updates/additions.
2025-06-03 10:10:37,592 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:37,593 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:37,593 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:37,593 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:37,602 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-03 10:10:37,607 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:37,610 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-03 10:10:37,611 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-03 10:10:37,612 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:37,615 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-03 10:10:37,616 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:37,616 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:37,617 - DEBUG - Shape of encoded categorical edge features: torch.Size([1644, 3])
2025-06-03 10:10:37,618 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:37,618 - DEBUG - Shape of scaled numerical edge features: torch.Size([1644, 7])
2025-06-03 10:10:37,618 - DEBUG - Final edge attributes tensor shape: torch.Size([1644, 10])
2025-06-03 10:10:37,618 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:37,620 - INFO - Performing online update...
2025-06-03 10:10:37,620 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:37,620 - DEBUG - Updated RunningStats: new_mean=0.9522691141930327, new_var=11400000000160.723, new_n=1170
2025-06-03 10:10:37,620 - DEBUG - Updated RunningStats: new_mean=0.9468281985901721, new_var=11700000000019.01, new_n=1200
2025-06-03 10:10:37,621 - DEBUG - Updated RunningStats: new_mean=1.1224718158450406, new_var=3800000000049.291, new_n=390
2025-06-03 10:10:37,621 - DEBUG - Updated RunningStats: new_mean=1.120228385516158, new_var=3900000000000.9214, new_n=400
2025-06-03 10:10:37,621 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:37,621 - DEBUG - Online update step: 1/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 2/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 3/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 4/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 5/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 6/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 7/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 8/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 9/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 10/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 11/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 12/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 13/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 14/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 15/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 16/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,621 - DEBUG - Online update step: 17/50
2025-06-03 10:10:37,621 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 18/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 19/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 20/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 21/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 22/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 23/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 24/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 25/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 26/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 27/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 28/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 29/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 30/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 31/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 32/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 33/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 34/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 35/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 36/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 37/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 38/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 39/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 40/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 41/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 42/50
2025-06-03 10:10:37,622 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,622 - DEBUG - Online update step: 43/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 44/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 45/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 46/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 47/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 48/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 49/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - DEBUG - Online update step: 50/50
2025-06-03 10:10:37,623 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:37,623 - WARNING - No successful steps during online update.
2025-06-03 10:10:37,623 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.29067298e-08
  2.66979132e-08 -3.72529030e-09  1.11758709e-08 -1.24176340e-08
  2.28385425e+00  2.96093750e+00  1.40625000e-01  4.39322901e+00
  3.72529030e-09  3.44921875e+00  5.70963526e+00  7.59635401e+00
  1.40625000e-01  8.00000000e+00 -1.14863115e-08 -2.98023224e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -7.45058060e-09  5.58793545e-09], current edge mean: [ 6.1715326e+00  1.4209245e+00  4.9805355e+00  1.7402816e-09
 -1.3052112e-09  3.1905163e-09  0.0000000e+00 -3.7706100e-09
 -2.3203754e-09 -1.4502347e-09]
2025-06-03 10:10:37,623 - DEBUG - Node drift difference: 0.0144, Edge drift difference: 0.0026
2025-06-03 10:10:37,624 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.29067298e-08
  2.66979132e-08 -3.72529030e-09  1.11758709e-08 -1.24176340e-08
  2.28385425e+00  2.96093750e+00  1.40625000e-01  4.39322901e+00
  3.72529030e-09  3.44921875e+00  5.70963526e+00  7.59635401e+00
  1.40625000e-01  8.00000000e+00 -1.14863115e-08 -2.98023224e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -7.45058060e-09  5.58793545e-09], edge=[ 6.1715326e+00  1.4209245e+00  4.9805355e+00  1.7402816e-09
 -1.3052112e-09  3.1905163e-09  0.0000000e+00 -3.7706100e-09
 -2.3203754e-09 -1.4502347e-09]
2025-06-03 10:10:37,624 - DEBUG - Updated reference std: node=[0.         0.         1.0006517  1.0006517  0.         0.
 0.         1.0006517  1.0006517  1.0006516  1.0006517  1.0006516
 0.96356016 0.27694583 0.362543   0.56546044 1.0006516  3.062159
 2.921897   1.5160462  0.362543   0.         1.0006517  1.0006517
 0.         0.         0.         0.         1.0006517  1.0006516 ], edge=[1.0395782  0.50603193 1.779606   1.0003043  1.0003043  1.0003042
 1.0003042  1.0003042  1.0003042  1.0003043 ]
2025-06-03 10:10:37,624 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:37,624 - INFO - Running anomaly detection...
2025-06-03 10:10:37,624 - INFO - Starting anomaly detection.
2025-06-03 10:10:37,636 - DEBUG - Node reconstruction errors: [1.242887   0.9933964  1.164565   0.6411894  1.2572142  3.1424484
 2.8582673  1.0491223  1.4911329  0.8424056  1.4877484  0.6488931
 1.2068528  1.129993   0.975887   1.9022504  0.78011864 0.8078234
 0.68310946 1.5490816  0.80783147 1.391143   1.206468   2.2541747
 3.021065   1.537136   0.72883034 0.9946833  0.80783117 1.2994472
 0.67699736 1.5371761  1.9074129  3.0785475  2.0277498  2.6177251
 4.6252627  1.261047   2.209165   1.2341554  1.3433225  1.2886797
 2.6775384  1.1299812  1.7745957  1.2919495  7.889929   1.7823656
 1.5330637  1.2612787  3.8559806  1.2065295  1.1878814  1.2610471
 1.5370823  1.1480883  1.3616623  0.99872774 1.8912702  1.9990747
 5.3278427  1.993753   1.8350147  0.98199874 2.0054457  0.8026735
 2.6304626  1.2064674  1.2619994  1.4564548  1.797875   1.0276808
 2.9132485  1.0984124  2.4366012  1.4349378  1.2612795  1.3601025
 1.7899442  1.1271487  0.93229175 1.0397834  0.7515994  1.1299814
 1.0812944  1.2759544  0.75151384 2.937      0.49839535 1.3163015
 0.73033303 2.6322088  1.3881067  1.0176562  0.8841063  4.982423
 0.6065636  1.0100604  1.02689    0.76202786 1.2697119  0.606564
 0.62868387 1.0022163  1.6720241  0.7334358  1.457084   1.4094963
 1.4115157  1.0342319  1.2987331  0.6121575  2.6085215  2.649445
 1.256586   1.0110549  1.2152002  2.0112855  1.0772427  0.8570755
 0.68745035 1.4993289  1.9525105  1.4712685  0.8887643  0.8572165
 1.4030843  1.2995515  1.153275   0.92316735 0.89063287 0.652533
 0.72237915 2.5405     1.1469233  0.75086987 0.8981705  1.0528852
 1.2651527  2.033776   0.62961376 1.177709   0.6741892  0.6188821
 0.61856663 1.2957336  1.2152151  0.7148793  1.0344589  1.0140523
 1.7261225  1.8539393  1.5747327  0.652535   2.2556787  2.4547782
 0.61339647 1.2703516  1.2697092  0.64547414 0.62642807 1.2692628
 0.61339384 0.8914122  1.190107   2.0279286  1.7494129  0.9408779
 1.2691771  0.89727247 1.1339343  0.85601586 0.73408246 3.8325522
 0.90630835 0.65549123 1.1538466  1.1838807  1.1582078  1.1582068
 0.7115667  1.4639493  0.68968636 2.0205905  1.904712   0.86916536
 0.65695167 1.17813    0.73229957 0.60108906 1.0626817  0.9420722
 0.6327749  0.66263974 1.2650187  0.5417602  3.1404052  0.7647324
 2.0579972  0.70427626 0.9277748  0.613702   2.3307104  1.0568146
 1.1516541  1.2466432  1.0307345  2.212236   1.008459   1.4921964
 1.08655    1.1843704  0.5663316  1.1369071  0.78030473 0.64624953
 1.2564065  1.2151982  1.2256118  0.66260886 2.6136165  0.6569541
 0.7137903  0.56633174 0.6133407  0.7936817  1.9281156  0.69755554
 1.0373394  1.4169266  1.4264998  0.8360882  1.1896263  1.2152201
 1.2152041  0.5315883  0.90001136 0.7137902  0.6134959  0.7301134
 2.0875313  1.1939253  0.690414   0.8194286  0.6720058  0.87960166
 1.0550544  0.9955638  0.69041467 0.6785747  0.73408276 0.71027213
 1.225589   1.0420473  1.0107667  1.157497   0.5947434  0.9830939
 0.7031593  1.1582069  1.297413   1.7059902  0.5885252  0.8467978
 0.979496   0.86118406 1.3973237  3.7484255  1.3973979  1.2598568
 1.8207108  1.9244308  1.2300582  0.9336024  1.6328208  1.1582106
 0.6871614  1.0498291  0.7116831  0.8333559  3.548513   0.70577824
 0.8993776  0.9091311  1.0661395  0.9121123  2.6252263  1.3438202
 1.4639494  1.3509371  0.87647176 0.57798845 0.95410067 0.67197484
 1.4582313  0.9867345  1.0875684  1.1590917  0.53129447 0.7554994
 0.8573588  1.0203197  1.5346024  1.5346032  1.0193592  1.0191138
 1.0191314  1.6137937  0.99571675 1.0197579  1.0191414  2.1544042
 1.0191941  0.58953595 1.6866442  1.1352297  1.1356679  1.4168266
 0.56703657 0.5391055  1.3260043  0.8121357  0.95933604 1.5346029
 1.3786267  1.9663978  1.0110358  1.6137965  1.4746729  1.4746912
 1.4076973  0.5455894  1.02283    1.6328245  1.0191998  1.6137893
 0.84813887 0.68824977 1.0107285  1.0109572  1.119196   0.682676
 1.0107435  1.1537322  1.0808634  1.0900704  1.5346078  0.89605504
 1.4675183  0.97024995 1.0254291  0.97601664 2.3980052  1.1427376
 0.6722093  0.59474343 0.9759236  1.0190879  1.0355338  3.1890497
 1.0865443  0.9695768  1.060973   1.0776579  1.5348327  4.2739716
 0.6678369  2.312221   1.0932769  0.98394185 1.1517545  1.0296122
 1.1516724  1.9017996  1.3153896  1.1204536  0.6932777  1.055538
 0.99658525 1.0191138  1.5346007  1.2752693  0.6118543  0.8537321
 1.2705216  0.7239195  0.79066956 1.6563846  1.53743    1.0196767
 1.1995388  0.9155373  0.9916819  0.9033344  1.4457902  1.445456
 1.4450841  1.9844295  1.0069823  2.0172522  0.5809606  1.0697705
 1.4455394  1.0053437  1.1814835  0.9920059  1.3013265  0.60946083
 0.9916794  1.4672493  1.445311   0.9916799  1.005835   1.4455516
 1.4453433  0.652971   0.66838586 1.4450642  0.692534   0.6405594
 0.61138844 0.58213997 0.97503287 0.60894877 1.7656919  0.61140597
 0.60052866 0.9559253  1.4396731  0.6091946  1.3017796  0.70002943
 1.2801102  0.95734763 1.4450378  1.4454819  0.58011645 0.84050214
 1.7656875  0.91231436 0.65069443 1.0373641  0.71682835 0.63327914
 0.63810563 1.4299902  0.8264377  0.5926949  0.5895317  0.61107147
 0.7216197  0.6654273  0.63352746 0.996575   0.6654274  0.7173814
 0.6009161  0.6198022  0.61928624 0.9749244  1.0246943  0.6435352
 0.5924277  1.5586426  0.59960115 0.64358395 0.649658   0.9749218
 1.3850682  0.57982755 0.6496581  1.025127   0.88350505 1.9109895
 0.8605931  0.9775528  0.8895692  1.0246936  0.64614964 0.66435647
 0.6108781  2.0639937  0.6383172  0.5943155  1.7859464  0.6292296
 0.6654275  1.392383   0.6509116  1.9775298  1.21955    0.6461485
 0.82397544 0.64062226 0.936815   0.6210022  0.97728735 2.5529377
 0.99659336 0.66418797 0.7176805  0.640576   0.7170003  0.67388
 0.63745    1.5037006  0.97871226 2.330626   0.6335751  0.66542745
 1.5228631  1.0018722  1.0017258  0.6381149  1.271952   0.6381035
 1.0152403  1.3965634  0.65371865 1.1551617  1.3965838  1.0363297
 0.977472   0.61638767 0.6374518  0.9772254  0.93452555 1.513501
 1.3966644  0.82307816 0.65067905 0.9966017  0.9966451  0.6641501
 0.977385   0.9425073  1.2864817  0.80976033 0.99672014 0.9163324
 0.9968509  0.9163179  0.8996315  1.3966198  0.9505632  1.0028706
 0.95938665 0.99427    2.1866686  0.9942059  0.99446464 0.99426776
 0.99417377 0.9942395  0.9942949  0.9942519  1.4104912  0.95360833
 0.6714331  0.99446577 0.9941523  0.99423695 0.99418634 0.9942766
 0.9941503  0.99432844 0.9942627  0.99414426 1.3629489  0.99572533
 0.9941423  1.41049    0.9942892  1.5228676  0.48839548 0.9965964
 0.42799872 0.8006065  0.86029285 0.86029285 0.8509167  0.42799872
 0.9966753  0.977384   0.9784577  0.9966135  0.9792692  0.8945078
 0.9090832  1.0224651  1.0357763  0.9966044  1.0021621  0.99659705
 0.9967598  0.97490185 0.9966277  0.9773813  0.996598   0.9966746
 1.3965858  0.97745603 0.9966944  0.9800185  0.9967008  0.9965925
 0.996615   1.1838206  0.9366604  0.9366616  0.9941464  1.1415665
 0.55073714 0.9967365  0.9787261  1.1663715  0.9954763  0.9773759
 0.8188903  0.97011507 0.99659055 0.9965948  0.87574327 1.2008975
 0.86633855 0.9969885  1.4104915  0.97256607 0.97763973 1.9188462
 0.99415237 0.9819227  1.3966141  0.99423045 0.99729717 1.4104924
 0.9691603  0.9966346  1.2402059  0.94856006 1.2355837  1.2008473
 0.60324407 1.3134106  1.3133937  0.47729525 0.66082096 0.9941521
 1.0015016  1.2252575  1.2009263  0.87788785 0.6608966  0.6616165
 0.9977249  0.99772096 0.99787873 0.9978331  0.99772656 1.3474256
 1.2944912  0.9977152  1.001383   0.9943053  0.9767905  0.99423754
 1.3133922  1.152934   1.3135222  0.679679   1.3133888  1.0030191
 1.3629403  0.99414855 1.36294    0.99418676 1.3133869  0.6320072
 0.9779062  0.9780023  0.99773115 0.63200647 0.7255331  0.69010895
 0.9944437  0.9941708  0.9978419  0.6616166  0.9777222  0.99180454
 0.66161716 0.6223784  1.347425   1.889604   0.6235132  1.9036248
 0.85494334 0.6616223  0.63443786 0.6326279  0.66653    0.6665302
 1.2712969  1.0050298  1.2839465  0.66161644 0.6616182  0.6616165
 0.647855   0.6616169  0.66161656 0.6665298  0.66161656 0.6616165
 0.66161954 0.87731993 0.6398104  0.77188545 0.74755734 0.8300342
 0.66427386 0.6529344  0.7492758  2.323797   0.691582   0.6581928
 0.6758539  1.1937903  1.1930679  0.66653    2.054602   0.97507477
 0.6758531  1.0172995  0.7625296  2.0390823  0.6747664  0.674763
 0.6747592  1.0452735  0.6962901  1.8324107  0.79438615 0.8292484
 0.69032747 0.66989326 1.0290871  1.0168653  0.6811063  0.9548003
 0.67585814 0.675523   0.675853   0.8292434  1.0168661  0.8735226
 0.66989404 0.73362297 0.67476106 1.0458713  0.67586046 1.0479916
 1.216788   1.0451406  1.0452845  1.045154   1.0719485  1.071726  ]
2025-06-03 10:10:37,637 - DEBUG - Edge reconstruction errors: [0.04816951 1.2483819  1.2511282  ... 0.04802044 0.04802026 1.1485754 ]
2025-06-03 10:10:37,638 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101037_update_21.json
2025-06-03 10:10:37,638 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:37,642 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101037_update_21.pth and as latest_checkpoint.pth
2025-06-03 10:10:37,642 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.3279
2025-06-03 10:10:37,642 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 10:10:37,642 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1424, MLP Score: 0.5090
2025-06-03 10:10:37,642 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.8583, MLP Score: 0.4921
2025-06-03 10:10:37,642 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0211, MLP Score: 0.4826
2025-06-03 10:10:37,642 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 3.0785, MLP Score: 0.4938
2025-06-03 10:10:37,642 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.6253, MLP Score: 0.4671
2025-06-03 10:10:37,642 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-03 10:10:37,642 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.8403, MLP Score: 0.4899
2025-06-03 10:10:37,642 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.6486, MLP Score: 0.5021
2025-06-03 10:10:37,642 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.3778, MLP Score: 0.4853
2025-06-03 10:10:37,643 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.5845, MLP Score: 0.5034
2025-06-03 10:10:37,643 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 3.0229, MLP Score: 0.4874
2025-06-03 10:10:37,643 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:37,643 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:37,643 - INFO - Starting visualization of node features.
2025-06-03 10:10:37,643 - INFO - Graph has 768 nodes and 30 features.
2025-06-03 10:10:37,643 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:37,643 - INFO - Calculating feature statistics:
2025-06-03 10:10:37,644 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,644 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,644 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(-3.973643e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3769374), 'max': np.float32(2.230049)}
2025-06-03 10:10:37,644 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-3.973643e-08), 'std': np.float32(1.0), 'min': np.float32(-2.1631608), 'max': np.float32(2.4454253)}
2025-06-03 10:10:37,644 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,644 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,644 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,644 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.44930828), 'max': np.float32(2.2256434)}
2025-06-03 10:10:37,644 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1582156), 'max': np.float32(0.8633971)}
2025-06-03 10:10:37,644 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-9.6452265), 'max': np.float32(0.106782585)}
2025-06-03 10:10:37,644 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(1.9868216e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.2294397), 'max': np.float32(1.4613175)}
2025-06-03 10:10:37,645 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-3.973643e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4336612), 'max': np.float32(3.3249848)}
2025-06-03 10:10:37,645 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2838542), 'std': np.float32(0.9629327), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:37,645 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9609375), 'std': np.float32(0.27676547), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:37,645 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.140625), 'std': np.float32(0.3623069), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:37,645 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.393229), 'std': np.float32(0.56509215), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:37,645 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-0.106782585), 'max': np.float32(9.6452265)}
2025-06-03 10:10:37,645 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.4492188), 'std': np.float32(3.060165), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:37,645 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7096353), 'std': np.float32(2.919994), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:37,645 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.596354), 'std': np.float32(1.5150589), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:37,645 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.140625), 'std': np.float32(0.3623069), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:37,645 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:10:37,645 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12835787), 'max': np.float32(15.436723)}
2025-06-03 10:10:37,645 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14113936), 'max': np.float32(7.085196)}
2025-06-03 10:10:37,646 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,646 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,646 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,646 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:37,646 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.9884863), 'max': np.float32(8.702886)}
2025-06-03 10:10:37,646 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0992216), 'max': np.float32(4.4425874)}
2025-06-03 10:10:37,658 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c3998830>
2025-06-03 10:10:37,809 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:38,013 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:38,039 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:39,278 - INFO - Node feature visualization saved to vis/node_features_20250603_101038.png
2025-06-03 10:10:39,278 - INFO - Finished visualization of node features.
2025-06-03 10:10:39,278 - INFO - Performing additional feature analysis:
2025-06-03 10:10:39,278 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:39,279 - INFO - Starting visualization of edge features.
2025-06-03 10:10:39,279 - INFO - Graph has 1644 edges and 10 edge features.
2025-06-03 10:10:39,279 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:39,279 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:39,280 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:39,280 - INFO - - count: {'name': 'count', 'unique': 16, 'mean': np.float32(6.1715326), 'std': np.float32(1.0392619), 'min': np.float32(0.0), 'max': np.float32(15.0)}
2025-06-03 10:10:39,280 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4209245), 'std': np.float32(0.505878), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:39,280 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9805355), 'std': np.float32(1.7790647), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-03 10:10:39,280 - INFO - - service: {'name': 'service', 'unique': 27, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.04259851), 'max': np.float32(31.838638)}
2025-06-03 10:10:39,280 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1102, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.06884127), 'max': np.float32(30.857605)}
2025-06-03 10:10:39,280 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1161, 'mean': np.float32(-1.1601877e-09), 'std': np.float32(1.0), 'min': np.float32(-0.061747964), 'max': np.float32(31.510572)}
2025-06-03 10:10:39,280 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 377, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.05079109), 'max': np.float32(31.80806)}
2025-06-03 10:10:39,280 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1140, 'mean': np.float32(-5.2208446e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.11862281), 'max': np.float32(18.3054)}
2025-06-03 10:10:39,280 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1156, 'mean': np.float32(-4.060657e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11623082), 'max': np.float32(20.413744)}
2025-06-03 10:10:39,280 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 425, 'mean': np.float32(2.3203754e-09), 'std': np.float32(1.0), 'min': np.float32(-0.061007544), 'max': np.float32(31.310888)}
2025-06-03 10:10:39,291 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c37b33e0>
2025-06-03 10:10:39,369 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:39,379 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c390ed80>
2025-06-03 10:10:39,458 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:39,585 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:39,696 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:39,709 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:39,715 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:40,967 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101039.png
2025-06-03 10:10:40,967 - INFO - Finished visualization of edge features.
2025-06-03 10:10:40,967 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:40,967 - INFO - - Highest correlation (1.00) between features: 'service' and 'total_orig_pkts'.
2025-06-03 10:10:40,968 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:40,968 - INFO - Graph has 1644 edges and 10 edge features.
2025-06-03 10:10:40,968 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:41,252 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101040_summary.png
2025-06-03 10:10:41,495 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101040_pca_3d.png
2025-06-03 10:10:41,652 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101040_pca_variance.png
2025-06-03 10:10:41,652 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:41,652 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-03 10:10:41,652 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-03 10:10:41,652 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-03 10:10:41,670 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-03 10:10:41,685 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-03 10:10:41,685 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-03 10:10:41,685 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-03 10:10:41,698 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-03 10:10:41,713 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-03 10:10:41,714 - INFO - Processing node updates/additions.
2025-06-03 10:10:41,717 - INFO - Processing edge updates/additions.
2025-06-03 10:10:41,725 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:41,726 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:41,726 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:41,727 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:41,734 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-03 10:10:41,735 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:41,735 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-03 10:10:41,736 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-03 10:10:41,737 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:41,740 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-03 10:10:41,741 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:41,742 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:41,743 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 3])
2025-06-03 10:10:41,744 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:41,745 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 7])
2025-06-03 10:10:41,745 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 10])
2025-06-03 10:10:41,745 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:41,747 - INFO - Performing online update...
2025-06-03 10:10:41,748 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:41,748 - DEBUG - Updated RunningStats: new_mean=0.9519118134866194, new_var=12000000000160.54, new_n=1230
2025-06-03 10:10:41,749 - DEBUG - Updated RunningStats: new_mean=0.9469833487610293, new_var=12300000000018.566, new_n=1260
2025-06-03 10:10:41,749 - DEBUG - Updated RunningStats: new_mean=1.1235698530187763, new_var=4000000000049.3057, new_n=410
2025-06-03 10:10:41,749 - DEBUG - Updated RunningStats: new_mean=1.1214525088278378, new_var=4100000000000.93, new_n=420
2025-06-03 10:10:41,749 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:41,749 - DEBUG - Online update step: 1/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 2/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 3/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 4/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 5/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 6/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 7/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 8/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 9/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 10/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 11/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 12/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,749 - DEBUG - Online update step: 13/50
2025-06-03 10:10:41,749 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 14/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 15/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 16/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 17/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 18/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 19/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 20/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 21/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 22/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 23/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 24/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 25/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 26/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 27/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 28/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 29/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 30/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 31/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 32/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 33/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 34/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 35/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 36/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 37/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,750 - DEBUG - Online update step: 38/50
2025-06-03 10:10:41,750 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 39/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 40/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 41/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 42/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 43/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 44/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 45/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 46/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 47/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 48/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 49/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - DEBUG - Online update step: 50/50
2025-06-03 10:10:41,751 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,751 - WARNING - No successful steps during online update.
2025-06-03 10:10:41,751 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.2136906e-08 -6.3578291e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7575729e-08
 -8.5586160e-09 -3.6679783e-08  2.4453188e-09  1.2226594e-08
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  3.4234464e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -3.9736432e-09  1.2226594e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1920929e-08 -3.6679783e-08], current edge mean: [ 6.1781645e+00  1.4199160e+00  4.9742050e+00 -6.2929919e-09
  0.0000000e+00  4.5767212e-09 -4.0046313e-09  5.7209015e-09
 -2.2883606e-09  5.7209015e-10]
2025-06-03 10:10:41,752 - DEBUG - Node drift difference: 8974.5518, Edge drift difference: 0.0064
2025-06-03 10:10:41,752 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:41,752 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.2136906e-08 -6.3578291e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7575729e-08
 -8.5586160e-09 -3.6679783e-08  2.4453188e-09  1.2226594e-08
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  3.4234464e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -3.9736432e-09  1.2226594e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1920929e-08 -3.6679783e-08], edge=[ 6.1781645e+00  1.4199160e+00  4.9742050e+00 -6.2929919e-09
  0.0000000e+00  4.5767212e-09 -4.0046313e-09  5.7209015e-09
 -2.2883606e-09  5.7209015e-10]
2025-06-03 10:10:41,753 - DEBUG - Updated reference std: node=[0.         0.         1.0006417  1.0006417  0.         0.
 0.         1.0006417  1.0006416  1.0006417  1.0006416  1.0006417
 1.0045444  0.29221377 0.36398143 0.5649002  1.0006417  3.058592
 2.92255    1.5183852  0.36398143 0.2506402  1.0006417  1.0006417
 0.         0.         0.         0.         1.0006417  1.0006417 ], edge=[1.0526606 0.505705  1.785948  1.0003    1.0003    1.0003    1.0003
 1.0003    1.0003    1.0003   ]
2025-06-03 10:10:41,753 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:41,753 - INFO - Running anomaly detection...
2025-06-03 10:10:41,753 - INFO - Starting anomaly detection.
2025-06-03 10:10:41,775 - DEBUG - Node reconstruction errors: [1.2209839  0.9793044  1.1454252  0.626871   1.2380521  3.108536
 2.8181844  1.0105963  1.461003   0.8116017  1.4559338  0.6306578
 1.1866405  1.0921217  0.9620007  1.8465111  0.7597007  0.7891014
 0.6658937  1.4913313  0.7891067  1.3407148  1.1629239  2.1062803
 2.9638333  1.4748883  0.7034231  0.9823948  0.7891075  1.2468593
 0.65469456 1.4749339  1.8626567  3.142219   1.9817703  2.5752156
 4.5443034  1.2126797  2.252211   1.207772   1.2849725  1.2542008
 2.634235   1.0921109  1.7222259  1.2265022  7.644518   1.7279712
 1.4997156  1.2098033  3.6770282  1.1629844  1.1456714  1.2126793
 1.4748573  1.1058764  1.302468   0.96295524 1.793874   1.854932
 5.243833   1.9574491  1.7838423  0.9469176  1.8623623  0.77007467
 2.4401667  1.1629236  1.2104115  1.4005786  1.7498543  0.9974448
 2.8487463  1.080116   2.3703513  1.4323386  1.2098032  1.318198
 1.7616997  1.0822544  1.1069958  0.99912333 0.72648585 1.0921113
 1.0393292  1.2326615  0.7264384  2.8859208  0.49132082 1.2791653
 0.7156307  2.5803914  1.3717326  1.0052164  0.8560158  5.0408297
 0.5931025  0.986566   0.9931222  0.74504244 1.2486284  0.5931024
 0.6171114  0.98945683 1.64247    0.71717906 1.457943   1.3860155
 1.3975793  1.0346562  1.2673801  0.6000617  2.5276368  2.5788596
 1.2374076  0.9973066  1.1974405  1.988329   1.0624423  0.8288203
 0.6743235  1.4750913  1.92468    1.4475257  0.8781918  0.8289362
 1.3860513  1.2844683  1.1128412  0.89127564 0.8576897  0.6371365
 0.70449203 2.5180976  1.1319125  0.7345388  0.87160164 1.0176694
 1.2440948  2.0110252  0.6107195  1.1538926  0.66112345 0.6041102
 0.60118663 1.2744111  1.1974527  0.6960818  0.9981278  1.0017321
 1.7055861  1.8402523  1.5341105  0.63713926 2.2168221  2.4028647
 0.59869736 1.2393329  1.248626   0.6330245  0.6071128  1.253442
 0.59868425 0.8581818  1.1728126  2.0053818  1.7053368  0.93017703
 1.2478358  0.88600487 1.1156036  0.8264228  0.71871567 3.901433
 0.881229   0.63739735 1.1312343  1.1572684  1.1416261  1.1416248
 0.6959199  1.4446367  0.67328775 1.9943587  1.9452192  0.8665196
 0.6441774  1.161246   0.71658576 0.58479553 1.0487868  0.9316503
 0.6057535  0.64569    1.2439747  0.52328014 3.1101425  0.73794836
 2.0329182  0.6859292  0.8976436  0.5989255  2.2920604  1.0419962
 1.1342671  1.2253759  0.99524575 2.1809552  0.9755418  1.4555538
 1.0726967  1.1674539  0.5522934  1.1093117  0.7591023  0.6323252
 1.217446   1.1974378  1.2093124  0.6456624  2.558837   0.6441786
 0.6992274  0.55229306 0.59864944 0.76934904 1.9092681  0.67856395
 1.0229571  1.3935776  1.3961425  0.82581294 1.1492876  1.1974576
 1.1974418  0.51666385 0.8900014  0.699227   0.5987567  0.70042324
 2.0582616  1.1649711  0.67284214 0.7965978  0.6544011  0.8692252
 1.0423541  0.8612293  0.6728423  0.6520573  0.7187153  0.6946268
 1.2092923  1.0216037  0.99710274 1.1399634  0.5804137  0.9500396
 0.6764442  1.1416249  1.2669228  1.6876833  0.573346   0.8194712
 0.95450646 0.83399665 1.3618858  3.5847757  1.3619481  1.2311356
 1.8002713  1.901107   1.2039965  0.89968455 1.5933745  1.1416272
 0.67320645 1.0362288  0.6960224  0.8173731  3.4920838  0.6912373
 0.8894758  0.8829622  1.0255637  0.8838568  2.6057272  1.3272247
 1.4446362  1.3319603  0.83998626 0.5651348  0.9204008  0.6543705
 1.436612   0.95146126 1.064069   1.1422813  0.5166594  0.72955346
 0.84769166 0.9856865  1.4984608  1.498462   0.98502654 0.9847906
 0.9848044  1.5740887  0.9624506  0.9852434  0.98481864 2.1184504
 0.9848472  0.5752421  1.6453391  1.1138122  1.102647   1.3985558
 0.55313087 0.52271044 1.2935582  0.78409404 0.9455445  1.4984615
 1.3628118  1.9429623  0.97776604 1.5740921  1.4383179  1.4383339
 1.3741763  0.52933294 0.9883527  1.5933776  0.9848567  1.5740839
 0.81677085 0.67373693 0.97748154 0.977629   1.0629874  0.6655687
 0.97748744 1.1144063  1.056713   1.0509037  1.4984672  0.8687516
 1.4281576  0.95870286 0.9890478  0.9622215  2.3441288  1.1219069
 0.65214616 0.58042353 0.9422623  0.9847718  1.000954   3.1459374
 1.0726902  0.9356986  1.0294588  1.0504453  1.4986218  4.3503423
 0.65528566 2.2699645  1.0790862  0.97269636 1.1236454  1.0051006
 1.1236054  1.8822342  1.2852954  1.0855285  0.67958367 1.0187596
 0.97086114 0.9847922  1.4984593  1.2571994  0.59787357 0.8432392
 1.2507933  0.7044708  0.77274585 1.6365695  1.498857   0.9853041
 1.1872425  0.9045462  0.97986186 0.89212066 1.4098512  1.4096158
 1.4093574  1.8480746  0.9729733  1.8806785  0.56695026 1.058095
 1.409672   0.97142136 1.1594048  0.9800898  1.2691841  0.59505105
 0.9798592  1.4503893  1.4095126  0.9798595  0.97185457 1.4096845
 1.4095402  0.6356118  0.6516203  1.4093426  0.6788488  0.66924655
 0.59672815 0.5624855  0.9633237  0.59267235 1.7351208  0.6052598
 0.5755595  0.9454358  1.4192538  0.5947631  1.2688777  0.6840718
 1.2479905  0.94542474 1.4093215  1.409633   0.56640893 0.8305629
 1.7447336  0.8823688  0.63205034 1.0017709  0.7019615  0.6189668
 0.6221246  1.398691   0.8065604  0.5764723  0.5741936  0.5967487
 0.7012947  0.65232235 0.61960846 0.9628217  0.65232223 0.7005624
 0.58755386 0.60621077 0.60286725 0.9632459  1.0124487  0.62888795
 0.5768389  1.540686   0.58362925 0.62893206 0.63645816 0.87118685
 1.3662     0.5654801  0.6364577  1.0127572  0.7152336  1.8884199
 0.8484828  0.96506244 0.87120724 1.012448   0.6334223  0.6492067
 0.5982676  2.0493042  0.6237432  0.5778904  1.7612834  0.6084136
 0.6523224  1.2669934  0.63559777 1.8406283  1.1897739  0.633421
 0.8047705  0.62833667 0.9245237  0.6072661  0.9645232  2.5351367
 0.96283275 0.6490629  0.70272356 0.62829816 0.7021063  0.6602099
 0.6243391  1.4801005  0.9453687  2.3206522  0.6196461  0.6523226
 1.4950092  0.9681888  0.968103   0.6221325  1.239496   0.6221228
 0.9704141  1.3624079  0.63881326 1.1262741  1.3624246  1.0006288
 0.9441898  0.60176384 0.6243399  0.9644702  0.8995901  1.4909978
 1.3624831  0.81227565 0.6320357  0.9628416  0.9628872  0.64902866
 0.9645813  0.9297969  1.2538706  0.7993773  0.9629581  0.90401745
 0.96302325 0.9040038  0.88280505 1.3624531  0.91506654 3.3330488
 0.9196382  0.9597637  2.1616125  0.9596898  0.95985776 0.9597574
 0.9596652  0.95971245 0.95977    0.9597337  1.3745462  0.9170008
 0.65488094 0.9599312  0.95965135 0.95972383 0.9596725  0.9597317
 0.9596489  0.9597672  0.95972234 0.95964634 1.3275424  0.9607476
 0.95964366 2.2449498  0.95974106 1.450261   0.47308367 0.9628368
 0.4088864  0.78257674 0.8362008  0.8362008  0.8397503  0.4088864
 0.9629081  0.94409925 0.94503146 0.96284807 0.94561744 0.86352235
 0.8718522  0.9789427  1.0002282  0.9628418  0.9685186  0.9628373
 0.9629462  0.93714035 0.9628622  0.94409305 0.96283823 0.9629074
 1.3624282  0.94417185 0.9629229  0.945918   0.9629319  0.9628345
 0.9628527  1.153567   0.92441964 0.9244209  0.95964706 1.104153
 0.5302741  0.96292955 0.9453023  1.064865   0.9608066  0.94409
 0.80678463 0.93629813 0.96283287 0.9628366  0.85533196 1.168583
 0.84772134 0.9631837  1.374546   0.93597347 0.9443035  1.875743
 0.9596507  0.9472876  1.3624433  0.9597212  0.96259797 1.3745474
 0.9328762  0.9628735  1.2049143  0.93584436 1.2013392  1.1685374
 0.58607316 1.2798696  1.279858   0.46069863 0.6397668  0.9596514
 0.96648365 1.1918098  1.1685927  0.8637135  0.6472334  0.64726526
 0.962033   0.9620298  0.96216166 0.96212393 0.9620351  1.3092405
 1.2588109  0.9620247  0.9645134  0.9597506  0.93980277 0.9597274
 1.279858   1.1213622  1.2799759  0.661791   1.2798538  0.9649494
 1.3275362  0.9596504  1.3275348  0.95968246 1.2798523  0.61833847
 0.9432032  0.9432927  0.96203625 0.6183377  0.71240413 0.6708943
 0.9599076  0.9596711  0.96213204 0.6472656  0.94307745 0.9487859
 0.64726585 0.6030417  1.3092397  1.862041   0.6040871  1.872492
 0.83494383 0.64727044 0.6173046  0.6178475  0.651263   0.65126294
 1.2329999  0.9679539  1.2484342  0.64726585 0.6472665  0.64726543
 0.6332845  0.6472654  0.6472654  0.6512628  0.64726543 0.6472654
 0.64726776 0.85477954 0.62199426 0.7230781  0.72305894 0.8127424
 0.6447499  0.6356252  0.7232181  2.1523027  0.6720424  0.6385954
 0.65079945 1.1501127  1.1496354  0.6512628  2.0158231  0.94775313
 0.65918183 0.97837615 0.7389186  2.0018811  0.648461   0.6484591
 0.6484562  0.99874896 0.6727942  1.7865644  0.76774085 0.8094721
 0.6660795  0.65266126 0.9880857  0.9779551  0.6600779  0.92830163
 0.65082157 0.65571344 0.6591824  0.94643223 0.97795546 0.8290741
 0.65080166 0.70497906 0.64845717 0.9993105  0.65085244 1.0069875
 1.1710902  0.9988097  0.9987525  0.9986375  1.0126691  1.0279461
 6.8178024  0.648459   0.83414567 0.9989378  0.86754453 1.057743
 2.9322472  1.0590776  0.99873096 1.0315661  1.0576497  0.6741952 ]
2025-06-03 10:10:41,775 - DEBUG - Edge reconstruction errors: [0.05090474 1.2510395  1.2532989  ... 0.05075609 0.05075592 1.1513077 ]
2025-06-03 10:10:41,778 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101041_update_22.json
2025-06-03 10:10:41,779 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:41,783 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101041_update_22.pth and as latest_checkpoint.pth
2025-06-03 10:10:41,784 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.3290
2025-06-03 10:10:41,784 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-03 10:10:41,784 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1085, MLP Score: 0.5091
2025-06-03 10:10:41,784 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.8182, MLP Score: 0.4921
2025-06-03 10:10:41,784 - WARNING -   Node ID: 162.159.61.3, Recon Error: 2.9638, MLP Score: 0.4827
2025-06-03 10:10:41,784 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 3.1422, MLP Score: 0.4939
2025-06-03 10:10:41,784 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.5443, MLP Score: 0.4677
2025-06-03 10:10:41,784 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:10:41,784 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.4725, MLP Score: 0.4879
2025-06-03 10:10:41,784 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.3873, MLP Score: 0.4997
2025-06-03 10:10:41,784 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 3.5531, MLP Score: 0.4934
2025-06-03 10:10:41,784 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 7.6458, MLP Score: 0.5268
2025-06-03 10:10:41,784 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 5.8896, MLP Score: 0.5283
2025-06-03 10:10:41,784 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-03 10:10:41,784 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-03 10:10:41,784 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-03 10:10:41,806 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-03 10:10:41,823 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-03 10:10:41,823 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-03 10:10:41,823 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-03 10:10:41,838 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-03 10:10:41,854 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-03 10:10:41,854 - INFO - Processing node updates/additions.
2025-06-03 10:10:41,857 - INFO - Processing edge updates/additions.
2025-06-03 10:10:41,865 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:41,866 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:41,866 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:41,866 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:41,874 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-03 10:10:41,875 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:41,875 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-03 10:10:41,876 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-03 10:10:41,877 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:41,880 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-03 10:10:41,881 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:41,882 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:41,883 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 3])
2025-06-03 10:10:41,884 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:41,884 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 7])
2025-06-03 10:10:41,884 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 10])
2025-06-03 10:10:41,884 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:41,886 - INFO - Performing online update...
2025-06-03 10:10:41,886 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:41,886 - DEBUG - Updated RunningStats: new_mean=0.951843890760102, new_var=12600000000160.508, new_n=1290
2025-06-03 10:10:41,886 - DEBUG - Updated RunningStats: new_mean=0.9471511910966761, new_var=12900000000018.557, new_n=1320
2025-06-03 10:10:41,887 - DEBUG - Updated RunningStats: new_mean=1.1269259443309974, new_var=4200000000060.357, new_n=430
2025-06-03 10:10:41,887 - DEBUG - Updated RunningStats: new_mean=1.124884890580638, new_var=4300000000000.927, new_n=440
2025-06-03 10:10:41,887 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:41,887 - DEBUG - Online update step: 1/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 2/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 3/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 4/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 5/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 6/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 7/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 8/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 9/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 10/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 11/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 12/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 13/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 14/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 15/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 16/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,887 - DEBUG - Online update step: 17/50
2025-06-03 10:10:41,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 18/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 19/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 20/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 21/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 22/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 23/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 24/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 25/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 26/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 27/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 28/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 29/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 30/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 31/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 32/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 33/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 34/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 35/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 36/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 37/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 38/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 39/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 40/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 41/50
2025-06-03 10:10:41,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,888 - DEBUG - Online update step: 42/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 43/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 44/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 45/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 46/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 47/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 48/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 49/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - DEBUG - Online update step: 50/50
2025-06-03 10:10:41,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:41,889 - WARNING - No successful steps during online update.
2025-06-03 10:10:41,889 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7743396e-09  4.0581885e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.7444999e-08
 -4.1775472e-08  1.1935849e-08  2.6258867e-08 -3.2226790e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -9.5486792e-09  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4173820e-09 -7.8776601e-08], current edge mean: [ 7.1746216e+00  1.4202561e+00  4.9732246e+00 -1.1102146e-09
  1.6653219e-09 -4.0245278e-09 -5.5510729e-10 -1.1102146e-09
  1.6653219e-09 -1.6653219e-09]
2025-06-03 10:10:41,890 - DEBUG - Node drift difference: 0.0216, Edge drift difference: 0.9466
2025-06-03 10:10:41,890 - WARNING - Feature drift detected (2 consecutive)
2025-06-03 10:10:41,890 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7743396e-09  4.0581885e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.7444999e-08
 -4.1775472e-08  1.1935849e-08  2.6258867e-08 -3.2226790e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -9.5486792e-09  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4173820e-09 -7.8776601e-08], edge=[ 7.1746216e+00  1.4202561e+00  4.9732246e+00 -1.1102146e-09
  1.6653219e-09 -4.0245278e-09 -5.5510729e-10 -1.1102146e-09
  1.6653219e-09 -1.6653219e-09]
2025-06-03 10:10:41,891 - DEBUG - Updated reference std: node=[0.         0.         1.0006263  1.0006263  0.         0.
 0.         1.0006263  1.0006263  1.0006263  1.0006263  1.0006263
 1.0016909  0.28879055 0.37459666 0.5672931  1.0006264  3.0588543
 2.925534   1.5144387  0.37459666 0.2476422  1.0006263  1.0006263
 0.         0.         0.         0.         1.0006263  1.0006263 ], edge=[1.0780852 0.5077014 1.7833711 1.0002911 1.0002912 1.0002911 1.0002912
 1.0002912 1.0002911 1.0002911]
2025-06-03 10:10:41,891 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:41,891 - INFO - Running anomaly detection...
2025-06-03 10:10:41,891 - INFO - Starting anomaly detection.
2025-06-03 10:10:41,900 - DEBUG - Node reconstruction errors: [1.3267702  1.0506591  1.2429688  0.58121806 1.2908285  3.0107298
 2.7574687  1.1817591  1.4893233  0.8312503  1.5565153  0.70980865
 1.2830504  1.0281532  1.0656787  1.7673652  0.82127666 0.8252532
 0.7003885  1.4044107  0.82525843 1.2640392  1.0931622  2.085292
 3.033421   1.3841503  0.7623284  1.096147   0.82525474 1.1687428
 0.7166426  1.3841937  1.7890365  2.812996   1.9062464  2.5434887
 4.631066   1.1367319  1.9669908  1.196211   1.1999804  1.2027093
 2.7424915  1.0281432  1.6531358  1.1457946  7.599411   1.6510459
 1.5965868  1.1327865  3.6400514  1.0932205  1.0764009  1.1367319
 1.3841187  1.0387206  1.2164081  0.90728503 1.7068647  1.9611207
 5.0904694  1.8950986  1.7319458  0.8886049  1.8305488  0.81654394
 2.3889928  1.0931623  1.1333745  1.317369   1.6940143  0.9473126
 2.7635858  1.177929   2.489761   1.3374394  1.1327863  1.2769617
 1.8290724  1.2127007  1.0356773  0.9348518  0.6623073  1.0281432
 0.97916496 1.1641867  0.6648125  2.799853   0.73071027 1.2500483
 0.6650247  2.6532557  1.4580687  1.0571862  0.8342973  4.667358
 0.65287983 0.99228585 0.9379443  0.690524   1.3581169  0.65287936
 0.57702374 1.0253212  1.5711468  0.8038093  1.3809925  1.316377
 1.3440617  1.0000795  1.2380949  0.55830324 2.3996592  2.4445436
 1.1797864  0.9520667  1.1416925  2.1069007  1.0097772  0.80801415
 0.627133   1.5191617  2.051858   1.5037081  0.93178844 0.80809426
 1.4856753  1.3908172  1.0898077  0.86625344 0.8063408  0.5861542
 0.6497433  2.4485347  1.0805321  0.6811257  0.82657844 0.9601371
 1.1809118  1.9231033  0.5618578  1.1097031  0.6150751  0.55602586
 0.55288166 1.2133138  1.1417049  0.6394614  0.9419138  0.9527485
 1.743893   1.785009   1.4735644  0.5861564  2.1829534  2.423985
 0.6805233  1.2234818  1.3581145  0.5907689  0.5584643  1.193423
 0.6805087  0.8068265  1.2851741  1.9178947  1.6411909  1.0350386
 1.2134644  0.84205914 1.2157291  0.8047009  0.6676302  3.566449
 0.9120324  0.5871337  1.0828984  1.1122643  1.2556838  1.2556822
 0.7828401  1.5286155  0.7075526  2.1199176  2.3612497  0.8896754
 0.5990605  1.2314029  0.66485506 0.66695815 1.0118812  0.98646826
 0.6619606  0.72775346 1.1807958  0.59316486 3.1692643  0.68173736
 2.1502373  0.70851904 0.8438256  0.6807916  2.3318946  1.0209954
 1.1903592  1.3200835  0.94047123 2.2880747  0.92207444 1.3998944
 1.1887496  1.1130378  0.6180223  1.0910335  0.7079506  0.69689584
 1.1613365  1.1416905  1.3230469  0.7277206  2.5732498  0.5990609
 0.64902294 0.6180218  0.68046707 0.8103192  1.8345276  0.7590998
 1.1266992  1.337168   1.4751643  0.8784818  1.0863445  1.1417091
 1.1416943  0.584787   0.9450819  0.64902294 0.6805935  0.74134487
 2.141668   1.1181406  0.6183847  0.74222374 0.7354517  0.8161694
 1.1036897  0.80536085 0.61838555 0.6750273  0.66763026 0.7586371
 1.3230243  1.0472926  1.1636653  1.0871106  0.66157657 0.8975529
 0.7340748  1.2556828  1.2211663  1.7810303  0.6367008  0.8000698
 0.9738556  0.8141445  1.3092664  3.7084787  1.3093281  1.2225262
 1.9235196  2.0311246  1.1706561  0.9243698  1.5365026  1.2556856
 0.69916207 1.1394475  0.7829591  0.89091796 3.5735133  0.71650094
 0.8464831  0.83641547 0.99530154 0.833558   2.5379744  1.4258754
 1.5286157  1.2715529  0.8125328  0.62501866 0.86706245 0.7354162
 1.3708568  0.8977605  1.0668992  1.256394   0.5845315  1.6771063
 0.95547014 0.9302468  1.4465078  1.0350391  0.9296011  0.92937076
 0.929383   1.5170188  0.9088801  0.9298139  0.92939734 2.0369458
 0.9294248  0.655265   1.5824962  1.138692   1.0459844  1.4831125
 0.615953   0.589823   1.244732   0.7595848  1.0484881  1.4465077
 1.2945707  2.0721948  0.9235913  1.5170213  1.3828713  1.3828882
 1.3203619  0.5972596  0.93285465 1.536506   0.9294344  1.5170141
 0.79279655 0.7390526  0.9233188  0.92346025 1.0058032  0.7430211
 0.9233256  1.0643203  1.0461475  0.9835336  1.4465139  0.82007605
 1.369342   1.0646311  0.93353444 1.0223483  2.3358576  1.0635486
 0.7326125  0.66158867 0.8900391  0.9293517  0.94504607 2.945666
 1.188742   0.8836852  0.9749418  1.0020885  1.4466683  4.0051703
 0.60876155 2.3561122  1.0291759  0.92990994 1.0781732  0.9593636
 0.96482545 1.8854645  1.2336977  1.0634832  0.63077724 0.96036106
 0.9588452  0.9293716  1.4465066  1.1962272  0.5507319  0.800864
 1.1887597  0.7926509  0.71576375 1.5735768  1.4440159  0.92987263
 1.1428912  1.021166   1.0962135  1.0055339  1.3589958  1.3587594
 1.3585052  1.9569453  0.9179032  1.8558071  0.6484175  1.0150002
 1.3588163  0.91638166 1.1895267  1.096458   1.0350106  0.63099265
 1.0962108  1.3828099  1.358659   1.0962113  0.9168059  1.3588294
 1.3586854  0.58582455 0.7293219  1.3584911  0.63004607 0.61727357
 0.63402975 0.63589835 0.91971475 0.54762024 1.8495526  0.6317402
 0.6508655  1.0595666  1.5138496  1.5685078  1.2184784  0.7680982
 1.203628   0.9008246  1.3584708  1.3587769  0.64775276 0.7865929
 1.8660699  0.82830846 0.58427775 0.944467   0.89718163 0.5734843
 0.5760641  1.9317456  0.7579438  0.5289575  0.5290994  0.5502182
 0.83269554 0.60474527 0.5718495  0.9076594  0.6047446  0.65022033
 0.5428321  0.5584682  0.5577692  0.91964096 0.96646446 0.5792471
 0.5318638  1.4862226  0.5377235  0.57928836 0.7027483  0.8245257
 1.3076627  0.52074283 0.7027482  0.96675223 0.6692701  1.8179989
 0.8035664  0.9213421  0.82454395 0.966464   0.58733904 0.59762406
 0.55511487 1.980872   0.57849026 0.5302878  1.6907285  0.6732547
 0.60474503 1.2036662  0.5876616  1.772417   1.1431916  0.5873379
 0.75621635 0.58335567 0.88048065 0.55946153 0.9188316  2.4902687
 0.9076708  0.5974894  0.654172   0.5833169  0.65359634 0.6863069
 0.69061786 1.4184768  0.8914484  2.2460063  0.57188505 0.6047448
 1.4285858  0.914193   0.91410786 0.5760717  1.1938176  0.5760628
 0.9159991  1.3149906  0.59439206 1.0781657  1.3150083  0.943339
 0.8902913  0.55350006 0.6906199  0.9187816  0.8452798  1.4228778
 1.3150662  0.9159634  0.5842629  0.90767825 0.9077227  0.59745675
 0.91888744 1.043144   1.2059084  0.75657165 0.9077934  1.0165889
 0.907857   1.0165745  0.82183915 1.3150375  0.86261994 3.2548375
 1.6143378  0.9037474  2.0980382  0.90367544 0.90384036 0.9037416
 0.9036506  0.9036961  0.90375364 0.9037199  1.324545   0.8637548
 0.6051859  0.90391284 0.9036371  0.9037085  0.9036587  0.9037167
 0.90363437 0.90375143 0.9037074  0.9036316  1.2787716  0.9047155
 0.9036294  2.1721232  0.9037252  1.3763404  0.44531265 0.90767384
 0.37910935 0.736863   0.8023206  0.8023206  0.79400444 0.37910935
 0.9077437  0.8902024  0.89111674 0.90768474 0.89169365 0.81378067
 0.81564933 0.9225483  0.9429418  0.90767825 0.9145187  0.90767354
 0.90778023 0.8828822  0.9076982  0.89019614 0.90767455 0.90774333
 1.3150116  0.8902741  0.9077581  0.8919879  0.907766   0.90767217
 0.9076895  1.1078892  0.8803838  0.880385   0.9036334  1.0461105
 0.49557313 0.90776473 0.89138377 1.0132722  0.9047729  0.8901933
 0.76086557 0.8828909  0.907671   0.90767294 0.90378606 1.1191992
 0.8696363  0.9080125  1.3245447  0.8817342  0.89040303 1.8063738
 0.90363634 0.8933288  1.3150281  0.9037067  0.9065314  1.3245445
 0.8786883  0.90770936 1.1441377  0.889703   1.0078467  1.1191543
 0.6406872  1.2313677  1.2313575  0.4324562  0.58930606 0.903638
 0.91226757 1.0888239  1.119208   0.9732773  0.5992096  0.59809726
 0.9044964  0.9044929  0.9046232  0.904585   0.9044974  1.2581538
 1.1950825  0.90448666 0.90693885 0.9037342  0.883649   0.9037114
 1.2313567  1.073982   1.2314733  0.6088478  1.2313527  0.9344204
 1.278765   0.83103967 1.2787641  0.90366805 1.2313513  0.68430835
 0.88824886 0.88833714 0.9044985  0.6842584  0.81162375 0.6159864
 0.9038898  0.90365696 0.904594   0.5980971  0.88812387 0.89389503
 0.5980976  0.6704296  1.2581533  1.792216   0.67170984 1.9665362
 0.9385516  0.59810174 0.6425713  0.684742   0.60083765 0.6008378
 1.1806465  0.91011715 1.1990654  0.5980971  0.59809834 0.5980977
 0.5848818  0.5980975  0.5980975  0.6008378  0.5980974  0.5980972
 0.5980997  0.9559812  0.68944126 0.81003195 0.9248333  0.9176125
 0.5555745  0.58627343 0.80203646 2.235972   0.6180755  0.707569
 0.5987646  1.0831256  1.0826677  0.60083777 1.9240593  0.8838707
 0.6074974  0.918713   0.6802728  2.0866842  0.7103264  0.7103235
 0.71031994 0.93158525 0.6146175  1.689715   0.8325643  0.7492623
 0.60975444 0.5975978  0.92492485 0.9183144  0.6027231  0.86965716
 0.59878665 0.6019961  0.6074978  0.8825363  0.9183147  0.77350175
 0.5987665  0.7716961  0.71032196 0.93214583 0.59881806 0.9440636
 1.1005164  0.93164736 0.9315886  0.93147385 0.94579035 1.2752748
 6.729466   0.7103234  0.76871717 0.9317742  0.8063975  0.98499304
 2.8614237  0.98876494 0.9315687  0.95868593 0.99172115 0.6185033
 0.9592645  0.99063456 2.9457154  0.9261147  1.2095932  0.9848215
 1.2095805  1.1237853  0.9947928  1.162441   0.959276   0.6392987
 0.63932043 1.1625136  1.1537663  0.9586962  0.98487365 0.9949257
 0.98487574]
2025-06-03 10:10:41,901 - DEBUG - Edge reconstruction errors: [0.1506974  1.3508337  1.353121   ... 0.15054648 1.2511051  0.15054715]
2025-06-03 10:10:41,902 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101041_update_23.json
2025-06-03 10:10:41,902 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:41,906 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101041_update_23.pth and as latest_checkpoint.pth
2025-06-03 10:10:41,906 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.3275
2025-06-03 10:10:41,906 - WARNING - Detected 22 anomalous nodes (reconstruction-based):
2025-06-03 10:10:41,906 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0107, MLP Score: 0.5087
2025-06-03 10:10:41,906 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.7575, MLP Score: 0.4923
2025-06-03 10:10:41,906 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0334, MLP Score: 0.4832
2025-06-03 10:10:41,906 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8130, MLP Score: 0.4950
2025-06-03 10:10:41,906 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.6311, MLP Score: 0.4670
2025-06-03 10:10:41,906 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:10:41,906 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.6292, MLP Score: 0.4869
2025-06-03 10:10:41,906 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.5301, MLP Score: 0.4990
2025-06-03 10:10:41,906 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 3.6806, MLP Score: 0.4993
2025-06-03 10:10:41,906 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 7.8248, MLP Score: 0.5253
2025-06-03 10:10:41,906 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 6.0465, MLP Score: 0.5297
2025-06-03 10:10:41,906 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-03 10:10:41,907 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-03 10:10:41,907 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-03 10:10:41,927 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-03 10:10:41,944 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-03 10:10:41,944 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-03 10:10:41,944 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-03 10:10:41,960 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-03 10:10:41,977 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-03 10:10:41,977 - INFO - Processing node updates/additions.
2025-06-03 10:10:41,981 - INFO - Processing edge updates/additions.
2025-06-03 10:10:41,991 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:41,992 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:41,992 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:41,993 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:42,000 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-03 10:10:42,005 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:42,012 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-03 10:10:42,015 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-03 10:10:42,016 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:42,020 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-03 10:10:42,021 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:42,022 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:42,023 - DEBUG - Shape of encoded categorical edge features: torch.Size([1734, 3])
2025-06-03 10:10:42,024 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:42,024 - DEBUG - Shape of scaled numerical edge features: torch.Size([1734, 7])
2025-06-03 10:10:42,024 - DEBUG - Final edge attributes tensor shape: torch.Size([1734, 10])
2025-06-03 10:10:42,024 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:42,026 - INFO - Performing online update...
2025-06-03 10:10:42,026 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:42,026 - DEBUG - Updated RunningStats: new_mean=0.9517900674186999, new_var=13200000000160.625, new_n=1350
2025-06-03 10:10:42,026 - DEBUG - Updated RunningStats: new_mean=0.9472881541604763, new_var=13500000000018.506, new_n=1380
2025-06-03 10:10:42,027 - DEBUG - Updated RunningStats: new_mean=1.130039954319294, new_var=4400000000060.358, new_n=450
2025-06-03 10:10:42,027 - DEBUG - Updated RunningStats: new_mean=1.1280044269315856, new_var=4500000000000.932, new_n=460
2025-06-03 10:10:42,027 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:42,027 - DEBUG - Online update step: 1/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 2/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 3/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 4/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 5/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 6/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 7/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 8/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 9/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 10/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 11/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 12/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 13/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 14/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 15/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 16/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 17/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,027 - DEBUG - Online update step: 18/50
2025-06-03 10:10:42,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 19/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 20/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 21/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 22/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 23/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 24/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 25/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 26/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 27/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 28/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 29/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 30/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 31/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 32/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 33/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 34/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 35/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 36/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 37/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 38/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 39/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 40/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 41/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 42/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 43/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 44/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,028 - DEBUG - Online update step: 45/50
2025-06-03 10:10:42,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - DEBUG - Online update step: 46/50
2025-06-03 10:10:42,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - DEBUG - Online update step: 47/50
2025-06-03 10:10:42,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - DEBUG - Online update step: 48/50
2025-06-03 10:10:42,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - DEBUG - Online update step: 49/50
2025-06-03 10:10:42,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - DEBUG - Online update step: 50/50
2025-06-03 10:10:42,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,029 - WARNING - No successful steps during online update.
2025-06-03 10:10:42,029 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -8.8851646e-09 -1.1846886e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.0732051e-08
  2.6063150e-08  3.3171279e-08 -7.1081314e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -2.7247838e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.7988268e-08 -1.8362673e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2936580e-09 -1.0366025e-08], current edge mean: [ 7.1730103e+00  1.4175317e+00  4.9780855e+00 -2.1999407e-09
 -1.0999703e-09 -1.0999703e-09  3.2999112e-09 -1.0999703e-09
  1.0999703e-09 -6.5998225e-09]
2025-06-03 10:10:42,029 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0054
2025-06-03 10:10:42,030 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -8.8851646e-09 -1.1846886e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.0732051e-08
  2.6063150e-08  3.3171279e-08 -7.1081314e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -2.7247838e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.7988268e-08 -1.8362673e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2936580e-09 -1.0366025e-08], edge=[ 7.1730103e+00  1.4175317e+00  4.9780855e+00 -2.1999407e-09
 -1.0999703e-09 -1.0999703e-09  3.2999112e-09 -1.0999703e-09
  1.0999703e-09 -6.5998225e-09]
2025-06-03 10:10:42,030 - DEBUG - Updated reference std: node=[0.         0.         1.0006217  1.0006217  0.         0.
 0.         1.0006217  1.0006218  1.0006217  1.0006217  1.0006217
 1.0000262  0.28773427 0.3710666  0.5675718  1.0006218  3.0480378
 2.9194205  1.52196    0.3710666  0.24671759 1.0006217  1.0006217
 0.         0.         0.         0.         1.0006217  1.0006217 ], edge=[1.0732268 0.5071372 1.7816736 1.0002885 1.0002885 1.0002885 1.0002885
 1.0002885 1.0002885 1.0002885]
2025-06-03 10:10:42,030 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:42,030 - INFO - Running anomaly detection...
2025-06-03 10:10:42,030 - INFO - Starting anomaly detection.
2025-06-03 10:10:42,039 - DEBUG - Node reconstruction errors: [1.3434342  1.0718238  1.2600116  0.5898724  1.3104675  3.0317566
 2.7598064  1.1917573  1.500394   0.83719134 1.5675662  0.72471565
 1.2991065  1.0397204  1.0861095  1.7765348  0.83055806 0.84165853
 0.7156986  1.4117283  0.8416638  1.2775795  1.1023151  2.109401
 3.067781   1.3906171  0.7687287  1.1031607  0.8416603  1.1746806
 0.7253443  1.3906592  1.8080449  2.8403997  1.9162241  2.6035495
 4.643486   1.1426758  1.9951775  1.2095449  1.2038223  1.229101
 2.7626932  1.0397105  1.6971146  1.1496233  7.627565   1.6613325
 1.6068332  1.1415266  3.674271   1.1023672  1.0858955  1.142675
 1.3905884  1.052802   1.2202836  0.9130347  1.7434156  1.9786973
 5.1008077  1.9081005  1.7424191  0.89809114 1.8378597  0.817764
 2.395778   1.1023147  1.1420726  1.3279216  1.7074865  0.9555932
 2.788207   1.1939124  2.5311916  1.3737758  1.141527   1.2889516
 1.8702533  1.2131252  1.0277123  0.94573605 0.6684193  1.0397108
 0.9874367  1.181649   0.6695583  2.8248591  0.71912616 1.2692834
 0.6760995  2.7214813  1.4729534  1.0782349  0.8527629  4.0061145
 0.6627382  1.0112458  0.9528493  0.7058345  1.3762116  0.66273785
 0.5861765  1.0453335  1.5794909  0.82117045 1.4129928  1.3501046
 1.3579171  1.0588537  1.2789645  0.567891   2.333851   2.5030606
 1.1987957  0.9733129  1.1614075  2.146995   1.0287609  0.82539624
 0.6395519  1.5321853  2.092063   1.522568   0.95287204 0.8254708
 1.5044191  1.4151055  1.0985044  0.87835056 0.8228671  0.6005716
 0.66182876 2.4766953  1.1017851  0.696602   0.8368661  0.9742153
 1.1972344  1.9575216  0.57117736 1.1333119  0.6273051  0.5702279
 0.5636594  0.93813527 1.1614201  0.65263236 0.9607722  0.9730341
 1.754074   1.7939714  1.4937674  0.6005732  2.2633882  2.4823177
 0.69658196 1.2459157  1.3762095  0.5996134  0.5691019  1.2143186
 0.69657063 0.82334733 1.3056469  1.9519806  1.6623169  1.0568486
 1.2305695  0.8617515  1.2332157  0.8206254  0.6783495  3.5957224
 0.9244758  0.6743485  1.1063731  1.1377577  1.2767991  1.2767975
 0.80009514 1.5421437  0.72190094 2.1567025  2.40486    0.8987942
 0.6114834  1.252412   0.6805261  0.68302786 1.0389193  1.0088104
 0.66544825 0.7431951  1.1971262  0.6046843  3.2022707  0.6826511
 2.1916964  0.71835494 0.85888004 0.69684297 2.3956032  1.1134859
 0.96081764 1.3633428  0.9581147  2.3071089  0.93734705 1.4224203
 1.2115694  1.1332508  0.6310505  1.1125282  0.7196054  0.7094096
 1.1808738  1.1614066  1.3448621  0.74316406 2.6396594  0.6114841
 0.66093993 0.6310502  0.69652885 0.82279456 1.86412    0.7734581
 1.1466644  1.343594   1.4842964  0.9004049  1.1011484  1.1614232
 1.161411   0.5964434  0.96742684 0.66094023 0.6966537  0.73933023
 2.1866364  1.1412528  0.63209033 0.7528389  0.75049603 0.82744324
 1.1271247  0.815961   0.63209116 0.68122643 0.67834985 0.7700454
 1.3448421  1.0697212  1.1779155  1.1060666  0.677687   0.9134034
 0.737962   1.2767977  1.2459906  1.7962898  0.6467984  0.818082
 0.9850397  0.83271116 1.3311058  3.7412324  1.3311638  1.247581
 1.9552764  2.0683365  1.1953331  0.9218599  1.5606571  1.2768003
 0.7132464  1.157151   0.80020756 0.9207197  3.6039574  0.73050785
 0.86770415 0.84799993 1.0032352  0.846727   2.5675797  1.4449766
 1.5421435  1.2862847  0.823739   0.63603026 0.88467926 0.7504627
 1.3884083  0.911527   1.0903802  1.2774886  0.59619427 1.6853513
 0.9781592  0.9462328  1.4724213  1.0484326  0.9456025  0.94538987
 0.9454013  1.5410637  0.92538226 0.9458187  0.9454135  2.0637977
 0.9454423  0.67009187 1.6004275  1.1614156  1.0640285  1.4971176
 0.62814313 0.6002263  1.2684131  0.7739384  1.0675418  1.4724222
 1.310266   2.1094117  0.9396824  1.5410652  1.4056602  1.405677
 1.342144   0.60808635 0.9485934  1.56066    0.94545007 1.5410601
 0.8074327  0.75146025 0.93943065 0.9395693  1.0212611  0.75624377
 0.9394367  1.0761158  1.070376   0.9978915  1.472426   0.8336171
 1.388771   1.0862044  0.9494632  1.0450014  2.3873022  1.0787048
 0.7467673  0.6776964  0.9055682  0.945372   0.9596211  2.9305816
 1.2115629  0.9013012  0.99344414 1.0258099  1.4725763  4.040434
 0.6219203  2.3967254  1.0508556  0.9520178  1.102238   0.98340106
 0.9760984  1.9244702  1.2579352  1.0786402  0.6434343  0.9784008
 0.9812825  0.9453908  1.4724195  1.2152842  0.56473005 0.820866
 1.20561    0.81992525 0.7309863  1.5897222  1.4674474  0.9458559
 1.1596036  1.045198   1.1202617  1.028305   1.384227   1.383999
 1.3837509  1.9777282  0.9343386  1.8753792  0.6649522  1.0339314
 1.3840538  0.9329337  1.2147739  1.1204965  1.0484076  0.646048
 1.1202598  1.4059603  1.3839015  1.12026    0.9333303  1.3840654
 1.3839258  0.59699523 0.7434742  1.3837367  0.64273566 0.62024945
 0.65056473 0.6481238  0.94151825 0.5627331  1.8758572  0.6407783
 0.66291076 1.0795778  1.531332   1.5666643  1.2420243  0.78477085
 1.2306727  0.9232131  1.3837173  1.3840166  0.66428655 0.8072284
 1.8952749  0.8449575  0.5918264  0.9636492  0.918491   0.5847732
 0.586049   1.9551713  1.840463   0.54181236 0.5399335  0.56565285
 0.8445549  0.6181735  0.58744854 0.92461365 0.6181733  0.66562504
 0.5579966  0.57359755 0.56492573 0.84300643 0.98777187 0.5942636
 0.5458137  1.4959987  0.5512745  0.5943029  0.7169359  0.8405245
 1.322396   0.5319623  0.71693665 0.9880515  0.6822108  1.8423716
 0.82300436 0.9431017  0.8430304  0.98777235 0.6006187  0.6126349
 0.5658906  2.0141706  0.5891161  0.5430605  1.7095083  0.6814814
 0.61817336 1.2181593  0.5973564  1.7967681  1.1689875  0.6006182
 0.7703215  0.59630126 0.90169525 0.5745337  0.9401465  2.4944715
 0.9246244  0.61250705 0.6674282  0.59626764 0.6668888  0.70103383
 0.70517    1.426399   0.90826994 2.3011448  0.55256236 0.6181735
 1.4332268  0.9342902  0.93420476 0.5860567  1.2205722  0.58604777
 0.9325358  1.3423665  0.60334504 1.1018401  1.3423816  0.96260315
 0.9071998  0.5660259  0.7051716  0.9400997  0.86119086 1.4371855
 1.3424356  0.93728274 0.5918142  0.9246319  0.9246728  0.6124769
 0.94020194 1.065725   1.2308794  0.7766422  0.92473793 1.0399059
 0.92480445 1.0398928  0.84589446 1.3424076  0.88027763 3.249906
 1.6330593  0.92058086 2.1092465  0.9205157  0.9206796  0.92057645
 0.9204926  0.92053634 0.92058957 0.92055637 1.3492692  0.88108426
 0.61430174 0.92073566 0.9204795  0.92054653 0.9204999  0.92055714
 0.92047787 0.9205925  0.9205485  0.92047495 1.3040913  0.9215311
 0.9204718  2.1986272  0.92056584 1.3851289  0.45024997 0.9246273
 0.3808836  0.7528385  0.79762554 0.79762554 0.8132671  0.3808836
 0.9246931  0.9071196  0.9079767  0.9246388  0.90853375 0.82336074
 0.828422   0.9391022  0.96221    0.9246333  0.93458426 0.9246287
 0.9247329  0.8966978  0.9246509  0.9071134  0.92462987 0.9246931
 1.3423841  0.9071847  0.9247069  0.9088594  0.92471415 0.92462605
 0.9246427  1.1330706  0.9015912  0.901592   0.92047536 1.0665046
 0.5008048  0.92471725 0.9082214  1.0314811  0.9215435  0.9071111
 0.7783094  0.89882106 0.92462516 0.92462695 0.9215254  1.1435065
 0.8869044  0.92494494 1.349269   0.8954837  0.90731037 1.8259482
 0.9204791  0.9101598  1.3424007  0.9205442  0.92315555 1.3492695
 0.8926362  0.92466104 1.1618696  0.91003245 1.0246737  1.1434652
 0.6488344  1.2580189  1.2580072  0.43765703 0.59532946 0.9204798
 0.9320127  1.107292   1.143516   0.9945895  0.6125161  0.610931
 0.92077184 0.9207691  0.92089283 0.9208566  0.92077297 1.2818044
 1.2137722  0.9207634  0.92316353 0.92057616 0.89625907 0.9205501
 1.2580066  1.0975822  1.2581145  0.62150586 1.2580026  0.9507704
 1.3040853  0.84073204 1.3040845  0.92050874 1.2580012  0.6983087
 0.9047236  0.9048043  0.9207746  0.6983081  0.83107823 0.62802505
 0.92071503 0.9204968  0.9208638  0.59289414 0.90460175 0.90775806
 0.610931   0.6806071  1.2818037  1.8046329  0.6818059  1.9864544
 0.9569396  0.61093533 0.6537267  0.69828105 0.6133395  0.6133394
 1.2034045  0.92592394 1.2230412  0.61093104 0.61093175 0.610931
 0.5973552  0.6109311  0.6109312  0.6133393  0.610931   0.61093086
 0.6109327  0.97402704 0.7024402  0.8246873  0.9368193  0.9377345
 0.5652904  0.59630495 0.813873   2.2470663  0.62919706 0.71950704
 0.6092265  1.101233   1.1007884  0.6133394  1.9378012  0.8960198
 0.6192981  0.93410856 0.686194   2.0612364  0.7202398  0.720237
 0.7202336  0.9439809  0.6215772  1.6895853  0.8436159  0.7623704
 0.61633766 0.6051473  0.9412864  0.93373984 0.61591476 0.88422275
 0.6092468  0.61175126 0.619298   0.89472175 0.9337404  0.7787598
 0.6092288  0.7805928  0.72023517 0.9444998  0.6092732  0.9611546
 1.117409   0.9440385  0.9439842  0.9438784  0.9604861  1.2909019
 6.7798758  0.7202371  0.77798295 0.94415355 0.8192869  0.99853224
 2.8675714  1.0020645  0.9439655  0.96727717 1.0048306  0.62806106
 0.9792151  1.036238   2.965468   0.93098515 1.222699   0.9983765
 1.2226875  1.1384073  0.9962553  1.1711322  0.9678401  0.6453803
 0.6454007  1.1712013  1.1672169  0.9672876  0.9984248  0.99638736
 0.9984263  0.6735018  0.6734997  0.6734998  0.64537925 0.67350394
 0.6735001 ]
2025-06-03 10:10:42,039 - DEBUG - Edge reconstruction errors: [0.1509249  1.3510584  1.3531994  ... 0.15078725 1.2512951  0.15078789]
2025-06-03 10:10:42,041 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101042_update_24.json
2025-06-03 10:10:42,041 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:42,045 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101042_update_24.pth and as latest_checkpoint.pth
2025-06-03 10:10:42,045 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.3283
2025-06-03 10:10:42,045 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:10:42,045 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0318, MLP Score: 0.5080
2025-06-03 10:10:42,045 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.7598, MLP Score: 0.4929
2025-06-03 10:10:42,045 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0678, MLP Score: 0.4837
2025-06-03 10:10:42,045 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8404, MLP Score: 0.4951
2025-06-03 10:10:42,045 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.6435, MLP Score: 0.4664
2025-06-03 10:10:42,045 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:10:42,045 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.2757, MLP Score: 0.4875
2025-06-03 10:10:42,046 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.2631, MLP Score: 0.4995
2025-06-03 10:10:42,046 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 3.6134, MLP Score: 0.4970
2025-06-03 10:10:42,046 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 7.6350, MLP Score: 0.5230
2025-06-03 10:10:42,046 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 5.9102, MLP Score: 0.5279
2025-06-03 10:10:42,046 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-03 10:10:42,046 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-03 10:10:42,046 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-03 10:10:42,066 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-03 10:10:42,082 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-03 10:10:42,082 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-03 10:10:42,082 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-03 10:10:42,096 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-03 10:10:42,112 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-03 10:10:42,113 - INFO - Processing node updates/additions.
2025-06-03 10:10:42,116 - INFO - Processing edge updates/additions.
2025-06-03 10:10:42,124 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:42,125 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:42,125 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:42,126 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:42,133 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-03 10:10:42,135 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:42,135 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-03 10:10:42,136 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-03 10:10:42,137 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:42,142 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-03 10:10:42,143 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:42,144 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:42,145 - DEBUG - Shape of encoded categorical edge features: torch.Size([1761, 3])
2025-06-03 10:10:42,146 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:42,146 - DEBUG - Shape of scaled numerical edge features: torch.Size([1761, 7])
2025-06-03 10:10:42,146 - DEBUG - Final edge attributes tensor shape: torch.Size([1761, 10])
2025-06-03 10:10:42,147 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:42,149 - INFO - Performing online update...
2025-06-03 10:10:42,149 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:42,149 - DEBUG - Updated RunningStats: new_mean=0.9517381610323168, new_var=13800000000160.838, new_n=1410
2025-06-03 10:10:42,149 - DEBUG - Updated RunningStats: new_mean=0.9474044224907775, new_var=14100000000018.47, new_n=1440
2025-06-03 10:10:42,150 - DEBUG - Updated RunningStats: new_mean=1.1328842004333934, new_var=4600000000060.381, new_n=470
2025-06-03 10:10:42,150 - DEBUG - Updated RunningStats: new_mean=1.1308441495919497, new_var=4700000000000.93, new_n=480
2025-06-03 10:10:42,150 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:42,150 - DEBUG - Online update step: 1/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 2/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 3/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 4/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 5/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 6/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 7/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 8/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 9/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 10/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 11/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 12/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 13/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 14/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 15/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,150 - DEBUG - Online update step: 16/50
2025-06-03 10:10:42,150 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 17/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 18/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 19/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 20/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 21/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 22/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 23/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 24/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 25/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 26/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 27/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 28/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 29/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 30/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 31/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 32/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 33/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 34/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 35/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 36/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 37/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 38/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 39/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 40/50
2025-06-03 10:10:42,151 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,151 - DEBUG - Online update step: 41/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 42/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 43/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 44/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 45/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 46/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 47/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 48/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 49/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - DEBUG - Online update step: 50/50
2025-06-03 10:10:42,152 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,152 - WARNING - No successful steps during online update.
2025-06-03 10:10:42,153 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2373566e-08
  2.4483082e-08 -1.0492749e-08 -3.0312385e-08  1.2824471e-08
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  3.0312385e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -2.0548301e-08 -3.4975830e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.1408990e-09  2.8563596e-08], current edge mean: [ 7.1714935e+00  1.4168086e+00  4.9852357e+00 -6.4986323e-09
 -5.4155269e-10  2.7077636e-09 -3.7908690e-09  0.0000000e+00
 -4.3324215e-09  1.0831054e-09]
2025-06-03 10:10:42,153 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0040
2025-06-03 10:10:42,153 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2373566e-08
  2.4483082e-08 -1.0492749e-08 -3.0312385e-08  1.2824471e-08
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  3.0312385e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -2.0548301e-08 -3.4975830e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.1408990e-09  2.8563596e-08], edge=[ 7.1714935e+00  1.4168086e+00  4.9852357e+00 -6.4986323e-09
 -5.4155269e-10  2.7077636e-09 -3.7908690e-09  0.0000000e+00
 -4.3324215e-09  1.0831054e-09]
2025-06-03 10:10:42,154 - DEBUG - Updated reference std: node=[0.         0.         1.0006118  1.0006118  0.         0.
 0.         1.0006119  1.0006119  1.0006118  1.0006118  1.0006118
 1.0033096  0.28548482 0.36737394 0.5672308  1.0006118  3.0404615
 2.9175723  1.5106635  0.36737394 0.24474926 1.0006118  1.0006118
 0.         0.         0.         0.         1.0006118  1.0006118 ], edge=[1.0660592 0.5068073 1.7747625 1.0002841 1.0002841 1.0002841 1.0002841
 1.0002841 1.0002841 1.0002841]
2025-06-03 10:10:42,154 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:42,154 - INFO - Running anomaly detection...
2025-06-03 10:10:42,154 - INFO - Starting anomaly detection.
2025-06-03 10:10:42,178 - DEBUG - Node reconstruction errors: [1.3609502  1.0917084  1.2765002  0.59595    1.3292919  3.0510933
 2.7606127  1.2042159  1.5104489  0.84257495 1.578518   0.73952484
 1.05322    1.0517929  1.107205   1.8354276  0.838369   0.85695827
 0.7301378  1.4199167  0.85696274 1.2934146  1.1109488  2.1449819
 3.0811718  1.3991672  0.77342355 1.1120123  0.8569593  1.180691
 0.732543   1.3991994  1.8283328  2.8976068  1.9247864  2.6564622
 4.7381153  1.1484853  2.0223823  1.2145749  1.2098882  1.2349465
 2.7805288  1.0517844  1.7042167  1.150542   7.7690363  1.6715108
 1.6159254  1.1530399  3.7230175  1.1109908  1.095833   1.1484859
 1.3991382  1.0699494  1.2261654  0.91654766 1.7451755  2.0074918
 5.191323   1.9189862  1.7682338  0.907881   1.8519294  0.81671333
 2.4154913  1.1109483  1.1535169  1.3407643  1.7190794  0.9618327
 2.8168414  1.2103155  2.5586786  1.3507521  1.15304    1.3009956
 1.9039134  1.2139784  1.0194733  0.95694995 0.6709402  1.0517851
 0.9979938  1.2002727  0.6709034  2.8465755  0.70428836 1.2950394
 0.6840716  2.802835   1.488872   1.0980641  0.87229943 4.0698743
 0.6713384  1.0311788  0.9712858  0.7195095  1.3951043  0.67133784
 0.5923261  1.067587   1.5875677  0.83898926 1.4090497  1.3579327
 1.3689208  1.0511094  1.2855922  0.5747727  2.3888767  2.5649142
 1.2150391  0.99355376 1.1789955  2.1903996  0.905482   0.84388936
 0.64915425 1.5455432  2.1374927  1.5420003  0.9741783  0.84395725
 1.5237994  1.4382576  1.1105129  0.8921107  0.84238976 0.6136792
 1.4812979  2.509092   1.1211456  0.71072555 0.8467979  0.9917962
 1.2325916  1.9886233  0.5793143  1.1573366  0.6367943  0.6388247
 0.5733691  0.943819   1.1790067  0.66405964 0.98254746 0.9903164
 1.7642533  1.8024602  1.5163364  0.6136808  2.1733902  2.552077
 0.7132618  1.2716595  1.395103   0.60539615 0.5784295  1.2328047
 0.7132545  0.8428543  1.3269669  1.9830071  1.6866175  1.0787574
 1.2457474  0.8791037  1.2505981  0.8377717  0.6860908  3.6579707
 0.9376687  0.6722078  1.1287901  1.1666772  1.2991374  1.2991364
 0.81785387 1.5561006  0.7356379  2.1975071  2.4745371  0.90929693
 0.62132794 1.2739005  0.69485134 0.6994733  1.0469425  0.9207064
 0.66997474 0.75891185 1.2324829  0.6162787  3.2379088  0.7367507
 2.2365754  0.7279616  0.8751865  0.71350324 2.461612   1.1303345
 0.9690247  1.3714908  0.97886926 2.3592684  0.95607936 1.4475121
 1.2357296  1.1518487  0.6421032  1.135718   0.7309138  0.72075707
 1.2003635  1.1789943  1.3683964  0.7588848  2.722721   0.6213295
 0.6697347  0.6421031  0.7132152  0.85700214 1.8914292  0.7881358
 1.1667018  1.3492687  1.4934542  0.9239464  1.1338449  1.1790099
 1.1789984  0.6083717  0.9892317  0.6697342  0.7133323  0.73619324
 2.2399454  1.1654716  0.6438313  0.85499847 0.7655131  0.8374684
 1.1511993  0.8282024  0.6438324  0.6878248  0.6860912  0.780254
 1.3683792  1.0929209  1.1949573  1.1239955  0.6943884  0.932843
 0.743726   1.2991366  1.2738711  1.8132571  0.65745986 0.8372225
 1.0961982  0.8522743  1.3565172  3.7941575  1.3565687  1.2759463
 1.9912312  2.1103203  1.220936   0.91882044 1.588673   1.299139
 0.7256224  1.1754006  0.8179526  0.9274035  3.6297922  0.7427103
 0.8864815  0.85910183 1.01762    0.8597435  2.5999107  1.4626251
 1.5561007  1.2991757  0.83543086 0.64561766 0.9046509  0.7654852
 1.4114963  0.92893064 1.1155869  1.2997646  0.6081382  1.6925346
 1.0014014  0.96540487 1.502328   1.0673193  0.9648129  0.9646314
 0.9646421  1.5689186  0.94512445 0.965033   0.96465135 2.0956013
 0.96468127 0.6848616  1.6224482  1.1847154  1.0869986  1.5111471
 0.63910896 0.6109248  1.2956632  0.7887376  1.0877838  1.5023291
 1.3234752  2.1506941  0.9585907  1.5689206  1.43104    1.4310539
 1.3692461  0.61887515 0.9673786  1.5886757  0.96468633 1.5689152
 0.8235444  0.7623913  0.958368   0.95850486 1.0379491  0.76964515
 0.9583756  1.0935273  1.0789584  1.0169479  1.5023319  0.84702295
 1.4115077  1.1080197  0.9684991  1.0689335  2.4539645  1.1013911
 0.76091427 0.69439346 0.92446226 0.964614   0.9776513  2.9131477
 1.2357247  0.9227731  1.0132658  1.0529469  1.50247    4.1107907
 0.63205075 2.4599931  1.0712142  0.9741179  1.1281122  1.0096614
 0.99222445 1.9721316  1.2833581  1.1013255  0.65284055 0.99846953
 1.0073415  0.96463174 1.5023268  1.2315265  0.57647955 0.8393591
 1.2197043  0.82908475 0.7441346  1.6035202  1.495475   0.9650352
 1.1743178  1.071255   1.1456287  1.0538197  1.4142123  1.414002
 1.4137703  2.0045586  0.9535223  1.899057   0.6813784  1.0515021
 1.4140534  0.952316   1.2418302  1.1458443  1.0732033  0.6596775
 1.1456275  1.335607   1.41391    1.1456265  0.9526621  1.4140629
 1.4139328  0.60696304 0.7577416  1.4137577  0.65213    0.62260497
 0.665955   0.6609449  0.9618043  0.5758576  1.9072444  0.6506914
 0.6938967  1.1003938  1.5453248  1.5638213  1.2686757  0.8005051
 1.2634164  0.945776   1.4137408  1.414017   0.68075526 0.82597464
 1.9299867  0.86192095 0.623006   0.98142165 0.9289698  0.5934562
 0.5934174  1.9812979  1.8390828  0.5535127  0.5470272  0.5796002
 0.9650866  0.62770677 0.6002417  0.94374937 0.6277069  0.67928946
 0.5713508  0.5867737  0.5696049  0.8513071  1.0072657  0.6063413
 0.5590781  1.5011424  0.5637934  0.6063768  0.7291624  0.8559043
 1.3330472  0.5396916  0.7291624  1.0075202  0.69436276 1.8686956
 0.83879584 0.96326476 0.8513207  1.0072654  0.61030316 0.6246379
 0.57310003 2.048283   0.59754443 0.55460227 1.7257222  0.69135386
 0.62770665 1.2299     0.60201085 1.8240379  1.1982733  0.61030203
 0.781581   0.6063024  0.92079085 0.587598   0.95954996 2.5072248
 0.9437596  0.62452465 0.6778055  0.60627    0.67733765 0.7136704
 0.7173294  1.4293338  0.9275049  2.3655744  0.5590382  0.62770665
 1.4336354  0.9556497  0.9555649  0.59342295 1.252509   0.6229869
 0.9508593  1.373598   0.6086596  1.1255581  1.3736111  0.9805615
 0.9265837  0.57360935 0.71733105 0.9595106  0.8780688  1.4462522
 1.3736604  0.9586646  0.6229862  0.9437654  0.9437994  0.62449867
 0.95960206 1.0888901  1.2582259  0.79374313 0.94385535 1.0652076
 0.9439259  1.0651973  0.8520986  1.3736339  0.9002449  3.2396696
 1.6526463  0.9390611  2.115911   0.93900806 0.9391652  0.93905866
 0.938987   0.93902844 0.9390722  0.9390421  1.3757682  0.89998996
 0.617754   0.9391975  0.9389743  0.9390339  0.9389943  0.9390487
 0.9389728  0.9390819  0.9390394  0.9389697  1.3316255  0.9399587
 0.93896717 2.2295377  0.93905693 1.389786   0.4584771  0.94376236
 0.38628468 0.76928514 0.7945214  0.7945214  0.8295185  0.38628468
 0.9438186  0.9265149  0.92727166 0.9437726  0.927791   0.8327834
 0.8419685  0.9568109  0.9801999  0.94376665 0.95588875 0.94376314
 0.9438622  0.9132391  0.94378275 0.926512   0.9437636  0.943819
 1.3736129  0.9265718  0.94383126 0.9281592  0.943837   0.9437602
 0.9437756  1.1611001  0.92069626 0.9206974  0.9389705  1.0861048
 0.50848186 0.9438469  0.92747885 1.052695   0.93990916 0.9265091
 0.78263545 0.9173861  0.943759   0.9437616  0.9395561  1.169614
 0.90431124 0.9440403  1.3757684  0.91195947 0.92668813 1.8448843
 0.9389734  0.9293757  1.373628   0.93902993 0.94128734 1.375769
 0.90946025 0.94379044 1.1789457  0.9289724  1.0390736  1.1695801
 0.654918   1.2887051  1.2886943  0.44657487 0.599302   0.9389738
 0.9521817  1.1295106  1.1696277  1.0155214  0.6213704  0.6190124
 0.93841255 0.93840986 0.93851894 0.93848735 0.93841296 1.3063242
 1.130777   0.93840516 0.94067955 0.9390665  0.91191643 0.939035
 1.2886939  1.1236538  1.2887849  0.6312771  1.2886904  0.9716147
 1.3316195  0.8521172  1.3316195  0.93899924 1.2886899  0.7115697
 0.92330873 0.9233798  0.93841517 0.71152884 0.8500632  0.63626534
 0.9391804  0.93898904 0.9384938  0.5974957  0.9231948  0.923814
 0.61901206 0.6904204  1.3063244  1.817012   0.6914695  2.004156
 0.97424823 0.6190158  0.66541183 0.7107931  0.62055486 0.62055486
 1.2267208  0.94224864 1.2486948  0.6190122  0.61901295 0.61901224
 0.60518235 0.6190124  0.6190124  0.62055486 0.6190122  0.6190124
 0.6190139  0.9896756  0.71385217 0.83694965 0.9486958  0.95614266
 0.57218325 0.60201544 0.8233927  2.251155   0.63607043 0.7284147
 0.6145529  1.117596   1.1171858  0.6205545  1.9414929  0.8875016
 0.6250214  0.9488703  0.6838731  2.0628583  0.7292119  0.7292096
 0.72920597 0.95802075 0.62390405 1.6746528  0.8501551  0.767304
 0.6167285  0.61071503 0.9562661  0.94855434 0.58913785 0.8652875
 0.61456996 0.6137936  0.62502164 0.886269   0.9485551  0.8651272
 0.6107078  0.78521156 0.7292076  0.95847136 0.6145937  0.9758116
 1.1316521  0.95807296 0.9580273  0.9579306  0.9729287  1.3031666
 6.856722   0.7292098  0.7787121  0.9581688  0.82653695 1.0088204
 2.8727617  1.0119587  0.9580095  0.9745267  1.0144144  0.63261217
 0.98494804 1.0436107  3.0036378  0.92902464 1.2154243  1.0086877
 1.2316886  1.1505     0.99278075 1.1725641  1.326698   0.6452476
 0.6452654  1.1726283  1.1733246  0.9745373  1.0087277  0.9929084
 1.0087292  0.6666822  0.6666801  0.6666803  0.64524734 0.6666843
 0.66668016 0.6666798  0.6666801  1.0164876  0.66668004 0.66668016
 1.0018735  0.7000887  0.8496916  0.84969056 0.6666802  0.68256694
 1.0164876  0.66668063]
2025-06-03 10:10:42,179 - DEBUG - Edge reconstruction errors: [0.15264988 1.3527794  1.3547018  ... 0.15253264 1.2529655  0.1525332 ]
2025-06-03 10:10:42,183 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101042_update_25.json
2025-06-03 10:10:42,184 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:42,188 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101042_update_25.pth and as latest_checkpoint.pth
2025-06-03 10:10:42,189 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.3276
2025-06-03 10:10:42,189 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:10:42,189 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0511, MLP Score: 0.5082
2025-06-03 10:10:42,189 - WARNING -   Node ID: 23.33.92.48, Recon Error: 2.7606, MLP Score: 0.4935
2025-06-03 10:10:42,189 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0812, MLP Score: 0.4835
2025-06-03 10:10:42,189 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8976, MLP Score: 0.4952
2025-06-03 10:10:42,189 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.7381, MLP Score: 0.4655
2025-06-03 10:10:42,189 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:10:42,189 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7378, MLP Score: 0.4899
2025-06-03 10:10:42,189 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.0058, MLP Score: 0.5014
2025-06-03 10:10:42,189 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 3.5069, MLP Score: 0.4950
2025-06-03 10:10:42,189 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 7.3306, MLP Score: 0.5203
2025-06-03 10:10:42,189 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 5.6919, MLP Score: 0.5260
2025-06-03 10:10:42,189 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-03 10:10:42,190 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-03 10:10:42,190 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-03 10:10:42,211 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-03 10:10:42,229 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-03 10:10:42,229 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-03 10:10:42,229 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-03 10:10:42,245 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-03 10:10:42,262 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-03 10:10:42,262 - INFO - Processing node updates/additions.
2025-06-03 10:10:42,266 - INFO - Processing edge updates/additions.
2025-06-03 10:10:42,274 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:42,275 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:42,275 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:42,276 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:42,283 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-03 10:10:42,285 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:42,285 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-03 10:10:42,286 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-03 10:10:42,287 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:42,290 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-03 10:10:42,291 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:42,292 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:42,293 - DEBUG - Shape of encoded categorical edge features: torch.Size([1786, 3])
2025-06-03 10:10:42,294 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:42,294 - DEBUG - Shape of scaled numerical edge features: torch.Size([1786, 7])
2025-06-03 10:10:42,294 - DEBUG - Final edge attributes tensor shape: torch.Size([1786, 10])
2025-06-03 10:10:42,294 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:42,296 - INFO - Performing online update...
2025-06-03 10:10:42,296 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:42,297 - DEBUG - Updated RunningStats: new_mean=0.9516749177281896, new_var=14400000000161.04, new_n=1470
2025-06-03 10:10:42,297 - DEBUG - Updated RunningStats: new_mean=0.9474856474823498, new_var=14700000000018.367, new_n=1500
2025-06-03 10:10:42,297 - DEBUG - Updated RunningStats: new_mean=1.1374935131560628, new_var=4800000000073.35, new_n=490
2025-06-03 10:10:42,297 - DEBUG - Updated RunningStats: new_mean=1.1354845562840548, new_var=4900000000000.936, new_n=500
2025-06-03 10:10:42,297 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:42,297 - DEBUG - Online update step: 1/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 2/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 3/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 4/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 5/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 6/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 7/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 8/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 9/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 10/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 11/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,297 - DEBUG - Online update step: 12/50
2025-06-03 10:10:42,297 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 13/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 14/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 15/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 16/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 17/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 18/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 19/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 20/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 21/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 22/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 23/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 24/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 25/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 26/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 27/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 28/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 29/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 30/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 31/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 32/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 33/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 34/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 35/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,298 - DEBUG - Online update step: 36/50
2025-06-03 10:10:42,298 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 37/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 38/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 39/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 40/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 41/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 42/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 43/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 44/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 45/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 46/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 47/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 48/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 49/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - DEBUG - Online update step: 50/50
2025-06-03 10:10:42,299 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:42,299 - WARNING - No successful steps during online update.
2025-06-03 10:10:42,299 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.5685433e-08  2.5952261e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.9889835e-09
  6.3882489e-08  5.3615661e-08  1.3689105e-08  2.2815176e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
 -1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -3.1513462e-08 -1.0266829e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.0230108e-08 -5.7037937e-08], current edge mean: [ 8.1623745e+00  1.4137738e+00  4.9904814e+00 -6.4076664e-09
 -3.2038332e-09  0.0000000e+00  2.1358888e-09 -3.2038332e-09
  2.6698610e-09  2.1358888e-09]
2025-06-03 10:10:42,300 - DEBUG - Node drift difference: 0.0111, Edge drift difference: 0.9295
2025-06-03 10:10:42,300 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:42,300 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.5685433e-08  2.5952261e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.9889835e-09
  6.3882489e-08  5.3615661e-08  1.3689105e-08  2.2815176e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
 -1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -3.1513462e-08 -1.0266829e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.0230108e-08 -5.7037937e-08], edge=[ 8.1623745e+00  1.4137738e+00  4.9904814e+00 -6.4076664e-09
 -3.2038332e-09  0.0000000e+00  2.1358888e-09 -3.2038332e-09
  2.6698610e-09  2.1358888e-09]
2025-06-03 10:10:42,300 - DEBUG - Updated reference std: node=[0.         0.         1.0005987  1.0005985  0.         0.
 0.         1.0005987  1.0005987  1.0005987  1.0005987  1.0005987
 0.99652076 0.2824555  0.36981332 0.5666934  1.0005987  3.0259826
 2.9103527  1.4954265  0.36981332 0.24210006 1.0005987  1.0005987
 0.         0.         0.         0.         1.0005987  1.0005987 ], edge=[1.0884964 0.506109  1.7738906 1.0002801 1.00028   1.0002801 1.0002801
 1.00028   1.0002801 1.00028  ]
2025-06-03 10:10:42,301 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:42,301 - INFO - Running anomaly detection...
2025-06-03 10:10:42,301 - INFO - Starting anomaly detection.
2025-06-03 10:10:42,309 - DEBUG - Node reconstruction errors: [1.4023175  1.1358019  1.3166938  0.6169618  1.3730099  3.1009793
 2.7743654  1.239658   1.5465134  0.86486316 1.6129074  0.77172685
 1.0709667  1.0874944  1.1517453  1.8635786  0.8638626  0.89111984
 0.7618839  1.4400054  0.89112395 1.3317959  1.1391906  2.2104862
 3.1332333  1.429109   0.79214495 1.1384531  0.8911208  1.2046349
 0.753766   1.4291365  1.8770902  2.9790735  1.955988   2.7074728
 4.8325267  1.1749058  2.0927923  1.2423539  1.2374085  1.25667
 2.8228304  1.0868572  1.7395102  1.1708757  7.9248157  1.7046446
 1.6485572  1.185865   3.8132894  1.1401583  1.1253569  1.1749064
 1.4290808  1.1090024  1.2535149  0.936014   1.8100979  2.0640714
 5.282808   1.9518087  1.7989731  0.9351898  1.8909603  0.831823
 2.4646688  1.1391902  1.1862979  1.3755414  1.7567724  0.9831684
 2.872043   1.2495595  2.594367   1.3849025  1.1858652  1.3247254
 2.001481   1.2341617  1.0255514  0.98871654 0.6872895  1.0868571
 1.0295426  1.2408444  0.68829805 2.8880355  0.70397985 1.3351846
 0.70925254 2.9702954  1.5264058  1.1427397  0.9114114  4.1622243
 0.695846   1.0650964  1.0116833  0.751194   1.4382781  0.69584566
 0.6127411  1.1050223  1.6196507  0.8758966  1.4542571  1.3884386
 1.400019   1.07766    1.3272082  0.5965048  2.4849324  2.727055
 1.2555612  1.0382227  1.2216278  2.2893417  0.92856485 0.8816811
 0.67506725 1.5808098  2.24215    1.5867358  0.89994633 0.88174415
 1.5683074  1.4860642  1.1391388  0.927025   0.881064   0.64340866
 1.5048702  2.496968   1.1653888  0.74286354 0.8731097  1.0312294
 1.255998   2.0644412  0.6021322  1.2077394  0.6632865  0.65059495
 0.6505386  0.9794289  1.2216362  0.6517897  1.0250008  0.8761063
 1.7968507  1.8527006  1.5653384  0.64340985 2.2568438  2.724642
 0.747505   1.3247241  1.4382759  0.6255947  0.6042038  1.2561264
 0.7474994  0.88151664 1.3727994  2.0584679  1.7382464  1.1242589
 1.2832729  0.8915064  1.2915785  0.87413985 0.7108429  3.744952
 0.9906599  0.68346775 1.1774849  1.2208697  1.3466046  1.346602
 0.85432273 1.5914818  0.7680456  2.2911577  2.6136928  0.9405492
 0.6480247  1.3210591  0.72705483 0.7331863  1.0697792  0.9453389
 0.68622375 0.7922017  1.2559017  0.6434107  3.3057916  0.7431603
 2.3386445  0.7560571  0.9134296  0.74773306 2.6380699  1.153127
 0.9943548  1.4005889  1.020697   2.4715416  0.9967604  1.4991895
 1.2851405  1.1954293  0.66960895 1.1849874  0.76289904 0.75162184
 1.1411375  1.2216265  1.4156657  0.79217666 2.9265087  0.64802545
 0.69566846 0.6696079  0.7474616  0.8717316  1.9551452  0.8202668
 1.2104772  1.3748022  1.5267197  0.96922237 1.1730074  1.2216398
 1.221629   0.6355334  1.0358251  0.695669   0.74757457 0.7468755
 2.3668478  1.2164174  0.6720374  0.8146918  0.797953   0.8147906
 1.2013758  0.86050504 0.67203766 0.70900893 0.7108431  0.8078731
 1.41565    1.1411182  1.2359952  1.1660846  0.72833514 0.9743168
 0.7676046  1.3466035  1.3289826  1.8537593  0.68372303 0.8492196
 1.1223255  0.8912579  1.4079944  3.8863144  1.4080406  1.3323398
 2.0661118  2.2024267  1.2740524  0.93200165 1.6448656  1.3466061
 0.7565876  1.2152901  0.85441273 0.9553135  3.687674   0.77309096
 0.92860544 0.88663745 1.0393882  0.8905736  2.6529632  1.5003802
 1.5914823  1.1499743  0.86549395 0.6706754  0.9434855  0.7979271
 1.4416153  0.9681798  1.1670963  1.3471462  0.6353038  1.7248409
 1.0487487  1.0065279  1.5604651  1.1084632  1.0059539  1.005789
 1.0058007  1.624837   0.9869186  1.0061774  1.0058086  2.161927
 1.0058376  0.71595126 1.6630194  1.2333342  1.1273116  1.5462734
 0.66684604 0.6359521  1.3492718  0.8228266  1.1308509  1.5604646
 1.3594913  2.2433243  0.9991202  1.6248386  1.4830868  1.4830992
 1.4142921  0.64398456 1.0082837  1.6448677  1.005842   1.6248351
 0.88482416 0.7904061  0.99891716 0.9990514  1.0774534  0.80147284
 0.9989245  1.1322155  1.1109177  1.0527645  1.5604686  0.8782272
 1.4597926  1.1536634  1.0095481  1.1186634  2.6153905  1.1430657
 0.79399604 0.72833824 0.96540725 1.0057737  1.0175196  2.908789
 1.2851366  0.96465147 1.0526401  1.1038898  1.5605958  4.122959
 0.6591624  2.5779746  1.1165444  1.0209465  1.1815202  1.0601231
 1.0238419  2.069761   1.3355842  1.1429983  0.67911685 1.0390267
 1.0573831  1.0057895  1.5604641  1.2687714  0.60371774 0.8813817
 1.2544785  0.8571667  0.77516496 1.6417736  1.5505577  1.0061595
 1.2088883  1.1226283  1.1961302  1.1051759  1.471573   1.4713804
 1.4711646  2.0583146  0.9946264  1.9487854  0.713769   1.0911165
 1.4714273  0.9935297  1.2958063  1.1963322  1.1088297  0.6892745
 1.1961299  1.3632057  1.471296   1.1961292  0.9938496  1.4714354
 1.4713169  0.63439643 0.7906453  1.4711554  0.67845213 0.64099205
 0.6979557  0.6900509  1.0063643  0.6048411  1.9705297  0.67677534
 0.71698326 1.144211   1.5783916  1.579754   1.3211778  0.8333864
 1.3224496  0.99158126 1.4711385  1.4713954  0.71316695 0.86713284
 1.9975141  0.90092593 0.65696543 1.0186924  0.9592134  0.6187326
 0.61731    2.0367577  1.8716623  0.58152306 0.5663969  0.60956174
 0.9865664  0.65400356 0.6290565  0.9846685  0.6540035  0.7098596
 0.6004885  0.6157127  0.5892298  0.8824365  1.0519764  0.6329403
 0.58859444 1.5238748  0.59284306 0.6329722  0.75939095 0.88243294
 1.2573359  0.55982965 0.7593917  1.0522206  0.7279131  1.9278275
 0.72383016 1.0076717  0.88244885 1.0519767  0.6369031  0.65269685
 0.5953025  2.1191869  0.65675193 0.5825108  1.7666835  0.7206093
 0.65400326 1.2610848  0.62018013 1.8819066  1.2540348  0.63690215
 0.81481236 0.6330982  0.9645651  0.61649144 1.0035006  2.546082
 0.984678   0.65259206 0.70378536 0.63307154 0.7033607  0.74616545
 0.7497517  1.4506482  0.96871567 2.5074618  0.5804728  0.65400356
 1.4518725  0.9947258  0.9946424  0.61731476 1.3102946  0.6394031
 0.9915222  1.4333272  0.62833494 1.1770017  1.4333392  1.0179578
 0.9678797  0.59373087 0.7498275  1.0034662  0.9099036  1.4775345
 1.4333816  1.0024651  0.6394031  0.9846842  0.9847145  0.6525684
 1.0035479  1.1379639  1.3119072  0.8339396  0.98476493 1.1138794
 0.9848374  1.11387    0.89345    1.4333587  0.9408137  3.240434
 1.6942787  0.97916794 2.1385062  0.9791212  0.9792746  0.97916573
 0.97910184 0.97914124 0.9791802  0.97915304 1.4332945  0.9386112
 0.63442266 0.979295   0.979089   0.9791438  0.97910875 0.9791621
 0.9790884  0.9791934  0.9791537  0.9790852  1.3866639  0.98003846
 0.9790834  2.2881615  0.9791702  1.4163234  0.4889997  0.98468095
 0.40807763 0.79269296 0.7986337  0.7986337  0.86851054 0.40807763
 0.98473334 0.96781737 0.9685175  0.9846903  0.96901554 0.85967255
 0.87509954 0.9964681  1.0176233  0.98468524 0.9949328  0.984682
 0.984778   0.9516748  0.98469985 0.9678155  0.98468244 0.98473305
 1.4333407  0.96786857 0.9847445  0.96940917 0.9847494  0.9846791
 0.9846936  1.2140077  0.96447945 0.9644802  0.9790863  1.1260659
 0.5398636  0.98476315 0.96870434 1.0991342  0.97995275 0.90200293
 0.8089819  0.95816356 0.9846776  0.9846795  0.9817542  1.2211373
 0.9456833  0.9849361  1.4332948  0.9503566  0.96797997 1.8899587
 0.9790887  0.8471544  1.4333546  0.9791407  0.98119736 1.4332951
 0.94805485 0.98470604 1.2163371  0.971448   1.0785184  1.2211072
 0.7841297  1.3452947  1.3452853  0.47671822 0.62006176 0.97908914
 0.9929956  1.1769538  1.2211497  1.0615919  0.63618624 0.64357084
 0.97765595 0.9776545  0.97775567 0.97772616 0.9776575  1.3571289
 1.1746418  0.9776509  0.9798537  0.9791799  0.94930214 0.9791453
 1.3452847  1.1749228  1.3453625  0.65830857 1.3452822  1.0110939
 1.3866585  0.8855482  1.3866584  0.9791125  1.3452803  0.743457
 0.96373284 0.9637975  0.97765976 0.7434179  0.8915603  0.66162276
 0.9792798  0.9791022  0.97773254 0.6182978  0.963623   0.96213955
 0.64357066 0.7192953  1.3571283  1.8536905  0.7202633  2.0447915
 1.0152099  0.6435741  0.6943935  0.7418621  0.6440041  0.62396675
 1.2758628  0.9800587  1.3003379  0.64357084 0.64357126 0.64357084
 0.62951714 0.6435707  0.64357066 0.64400405 0.6435708  0.6435706
 0.64357245 1.0282731  0.74377865 0.8716716  0.9839153  0.9973498
 0.59437376 0.6243269  0.8553912  2.2782028  0.6606799  0.75591403
 0.636095   1.1544255  1.1540337  0.64400387 1.9668677  0.90574956
 0.64726233 0.9856125  0.69414264 2.0847857  0.7567137  0.75671136
 0.75670785 0.99337643 0.6431893  1.6765066  0.8714851  0.7857503
 0.63219434 0.6287861  0.9897693  0.98532706 0.6071885  0.8918221
 0.6361083  0.6281578  0.64726275 0.9045853  0.9853271  0.8916843
 0.6287808  0.8100837  0.75670964 0.9937864  0.63612777 1.0120245
 1.164241   0.9934241  0.9933817  0.993294   1.0029587  1.34173
 7.021096   0.7567113  0.80100685 0.99350774 0.8554179  1.0368409
 2.9028475  1.039629   0.9933654  1.0039208  1.0264403  0.6528893
 1.0134197  1.0684353  3.0617776  0.9435558  1.2465045  1.0367252
 1.2654178  1.1802096  1.0081874  1.1978632  1.3585869  0.66138774
 0.6614034  1.1979213  1.1830561  1.003931   1.0367601  1.0083147
 1.0367604  0.67735136 0.67735034 0.67735004 0.6549584  0.9593476
 0.67735016 0.67735034 0.6773507  1.0243522  0.6773502  0.67735016
 1.0258229  0.69120175 0.8559569  0.8559551  0.67735034 0.69255936
 1.0243527  0.67735004 0.701506   0.6924759  0.67735    0.6773499
 1.6042118  0.69250894 0.6773502  0.69247574 0.6833018  0.9010619
 0.7985762  0.67734987 1.4109929  0.6925608  0.69247544 0.69120854
 1.067792   0.6924775 ]
2025-06-03 10:10:42,309 - DEBUG - Edge reconstruction errors: [0.15329483 1.4534208  1.4552034  ... 0.1531897  1.3536813  0.15319026]
2025-06-03 10:10:42,311 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101042_update_26.json
2025-06-03 10:10:42,311 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:42,315 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101042_update_26.pth and as latest_checkpoint.pth
2025-06-03 10:10:42,315 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.3280
2025-06-03 10:10:42,315 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:10:42,315 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1010, MLP Score: 0.5090
2025-06-03 10:10:42,315 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.1332, MLP Score: 0.4838
2025-06-03 10:10:42,315 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.9791, MLP Score: 0.4952
2025-06-03 10:10:42,315 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.8325, MLP Score: 0.4642
2025-06-03 10:10:42,315 - WARNING -   Node ID: 142.250.196.228, Recon Error: 2.8228, MLP Score: 0.4844
2025-06-03 10:10:42,315 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:10:42,315 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.5551, MLP Score: 0.4906
2025-06-03 10:10:42,315 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.8527, MLP Score: 0.5017
2025-06-03 10:10:42,315 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 3.5280, MLP Score: 0.4949
2025-06-03 10:10:42,315 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 7.2059, MLP Score: 0.5170
2025-06-03 10:10:42,315 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 5.6305, MLP Score: 0.5233
2025-06-03 10:10:42,315 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:42,315 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:42,316 - INFO - Starting visualization of node features.
2025-06-03 10:10:42,316 - INFO - Graph has 836 nodes and 30 features.
2025-06-03 10:10:42,316 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:42,316 - INFO - Calculating feature statistics:
2025-06-03 10:10:42,316 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,317 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,317 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(7.300856e-08), 'std': np.float32(1.0), 'min': np.float32(-2.135334), 'max': np.float32(2.476465)}
2025-06-03 10:10:42,317 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(-7.300856e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3932526), 'max': np.float32(2.2174292)}
2025-06-03 10:10:42,317 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,317 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,317 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,317 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.44849688), 'max': np.float32(2.22967)}
2025-06-03 10:10:42,317 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(6.388249e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1470786), 'max': np.float32(0.8717798)}
2025-06-03 10:10:42,317 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(4.1067317e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.501364), 'max': np.float32(0.10804326)}
2025-06-03 10:10:42,317 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(3.650428e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8107755), 'max': np.float32(1.6221251)}
2025-06-03 10:10:42,317 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(3.650428e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5880083), 'max': np.float32(2.9164724)}
2025-06-03 10:10:42,317 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2930622), 'std': np.float32(0.99592453), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:42,317 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.95933), 'std': np.float32(0.28228652), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:42,317 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14593302), 'std': np.float32(0.36959207), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:42,318 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.397129), 'std': np.float32(0.5663544), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:42,318 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10804325), 'max': np.float32(9.501365)}
2025-06-03 10:10:42,318 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3947368), 'std': np.float32(3.0241723), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:42,318 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.764354), 'std': np.float32(2.9086118), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:42,318 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6076555), 'std': np.float32(1.4945319), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:42,318 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14593302), 'std': np.float32(0.36959207), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:42,318 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9916267), 'std': np.float32(0.24195519), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:42,318 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-9.12607e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13157162), 'max': np.float32(15.581839)}
2025-06-03 10:10:42,318 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14407296), 'max': np.float32(6.9409275)}
2025-06-03 10:10:42,318 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,318 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,318 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,318 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:42,318 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.825214e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9880175), 'max': np.float32(8.806242)}
2025-06-03 10:10:42,318 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.475642e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0928262), 'max': np.float32(4.477922)}
2025-06-03 10:10:42,330 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c15a50d0>
2025-06-03 10:10:42,477 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:42,763 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:42,788 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:44,045 - INFO - Node feature visualization saved to vis/node_features_20250603_101042.png
2025-06-03 10:10:44,046 - INFO - Finished visualization of node features.
2025-06-03 10:10:44,046 - INFO - Performing additional feature analysis:
2025-06-03 10:10:44,046 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:44,047 - INFO - Starting visualization of edge features.
2025-06-03 10:10:44,047 - INFO - Graph has 1786 edges and 10 edge features.
2025-06-03 10:10:44,047 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:44,047 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:44,047 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:44,047 - INFO - - count: {'name': 'count', 'unique': 18, 'mean': np.float32(8.1623745), 'std': np.float32(1.0881916), 'min': np.float32(0.0), 'max': np.float32(17.0)}
2025-06-03 10:10:44,047 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4137738), 'std': np.float32(0.5059673), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:44,047 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9904814), 'std': np.float32(1.773394), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-03 10:10:44,047 - INFO - - service: {'name': 'service', 'unique': 31, 'mean': np.float32(3.2038332e-09), 'std': np.float32(1.0), 'min': np.float32(-0.03908268), 'max': np.float32(33.363342)}
2025-06-03 10:10:44,047 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1198, 'mean': np.float32(-4.2717776e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.062218826), 'max': np.float32(31.76485)}
2025-06-03 10:10:44,047 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1271, 'mean': np.float32(-1.0679444e-09), 'std': np.float32(1.0), 'min': np.float32(-0.057041522), 'max': np.float32(32.709427)}
2025-06-03 10:10:44,047 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 413, 'mean': np.float32(-4.2717776e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.04750299), 'max': np.float32(33.275433)}
2025-06-03 10:10:44,047 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1245, 'mean': np.float32(-5.339722e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10287142), 'max': np.float32(24.566586)}
2025-06-03 10:10:44,047 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1260, 'mean': np.float32(1.0679444e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10198911), 'max': np.float32(23.477152)}
2025-06-03 10:10:44,048 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 460, 'mean': np.float32(6.4076664e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05742444), 'max': np.float32(32.793175)}
2025-06-03 10:10:44,058 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c1757110>
2025-06-03 10:10:44,140 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:44,150 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c0cd98b0>
2025-06-03 10:10:44,231 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:44,365 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:44,472 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:44,485 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:44,490 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:45,815 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101044.png
2025-06-03 10:10:45,815 - INFO - Finished visualization of edge features.
2025-06-03 10:10:45,815 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:45,816 - INFO - - Highest correlation (1.00) between features: 'service' and 'total_orig_pkts'.
2025-06-03 10:10:45,817 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:45,817 - INFO - Graph has 1786 edges and 10 edge features.
2025-06-03 10:10:45,817 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:46,123 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101045_summary.png
2025-06-03 10:10:46,384 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101045_pca_3d.png
2025-06-03 10:10:46,543 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101045_pca_variance.png
2025-06-03 10:10:46,543 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:46,543 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-03 10:10:46,543 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-03 10:10:46,543 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-03 10:10:46,562 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-03 10:10:46,580 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-03 10:10:46,580 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-03 10:10:46,580 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-03 10:10:46,595 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-03 10:10:46,612 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-03 10:10:46,612 - INFO - Processing node updates/additions.
2025-06-03 10:10:46,617 - INFO - Processing edge updates/additions.
2025-06-03 10:10:46,628 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:46,629 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:46,629 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:46,630 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:46,638 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-03 10:10:46,639 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:46,640 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-03 10:10:46,644 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-03 10:10:46,645 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:46,649 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-03 10:10:46,651 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:46,652 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:46,653 - DEBUG - Shape of encoded categorical edge features: torch.Size([1818, 3])
2025-06-03 10:10:46,655 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:46,655 - DEBUG - Shape of scaled numerical edge features: torch.Size([1818, 7])
2025-06-03 10:10:46,655 - DEBUG - Final edge attributes tensor shape: torch.Size([1818, 10])
2025-06-03 10:10:46,655 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:46,658 - INFO - Performing online update...
2025-06-03 10:10:46,659 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:46,660 - DEBUG - Updated RunningStats: new_mean=0.9515883965155599, new_var=15000000000161.086, new_n=1530
2025-06-03 10:10:46,660 - DEBUG - Updated RunningStats: new_mean=0.9475596812595103, new_var=15300000000018.305, new_n=1560
2025-06-03 10:10:46,660 - DEBUG - Updated RunningStats: new_mean=1.1417906582265849, new_var=5000000000073.309, new_n=510
2025-06-03 10:10:46,660 - DEBUG - Updated RunningStats: new_mean=1.1397455637183662, new_var=5100000000000.937, new_n=520
2025-06-03 10:10:46,660 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:46,660 - DEBUG - Online update step: 1/50
2025-06-03 10:10:46,660 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,660 - DEBUG - Online update step: 2/50
2025-06-03 10:10:46,660 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,660 - DEBUG - Online update step: 3/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 4/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 5/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 6/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 7/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 8/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 9/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 10/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 11/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 12/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 13/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 14/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 15/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 16/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 17/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 18/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 19/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 20/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 21/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 22/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 23/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 24/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 25/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 26/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 27/50
2025-06-03 10:10:46,661 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,661 - DEBUG - Online update step: 28/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 29/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 30/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 31/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 32/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 33/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 34/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 35/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 36/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 37/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 38/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 39/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 40/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 41/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 42/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 43/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 44/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 45/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 46/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 47/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 48/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 49/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - DEBUG - Online update step: 50/50
2025-06-03 10:10:46,662 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,662 - WARNING - No successful steps during online update.
2025-06-03 10:10:46,663 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -1.52362176e-08  3.07545847e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.66797814e-09
 -1.12860865e-09  1.91863467e-08 -1.46719126e-08 -6.77165213e-09
  2.28994083e+00  2.95976329e+00  1.47928998e-01  4.39408302e+00
 -1.35433043e-08  3.37751484e+00  5.79526615e+00  7.59763336e+00
  1.47928998e-01  7.99171591e+00 -2.82152168e-09  2.53936943e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.01574775e-08  3.61154768e-08], current edge mean: [ 8.1595163e+00  1.4174918e+00  4.9939494e+00  2.0982933e-09
 -2.3605800e-09  1.5737200e-09  3.6720134e-09  5.2457333e-10
  5.2457332e-09  1.3114333e-09]
2025-06-03 10:10:46,663 - DEBUG - Node drift difference: 0.0106, Edge drift difference: 0.0073
2025-06-03 10:10:46,664 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -1.52362176e-08  3.07545847e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -3.66797814e-09
 -1.12860865e-09  1.91863467e-08 -1.46719126e-08 -6.77165213e-09
  2.28994083e+00  2.95976329e+00  1.47928998e-01  4.39408302e+00
 -1.35433043e-08  3.37751484e+00  5.79526615e+00  7.59763336e+00
  1.47928998e-01  7.99171591e+00 -2.82152168e-09  2.53936943e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.01574775e-08  3.61154768e-08], edge=[ 8.1595163e+00  1.4174918e+00  4.9939494e+00  2.0982933e-09
 -2.3605800e-09  1.5737200e-09  3.6720134e-09  5.2457333e-10
  5.2457332e-09  1.3114333e-09]
2025-06-03 10:10:46,664 - DEBUG - Updated reference std: node=[0.         0.         1.0005922  1.0005922  0.         0.
 0.         1.0005922  1.0005922  1.0005922  1.0005922  1.0005922
 0.9916503  0.28097653 0.3715423  0.5695371  1.0005922  3.015083
 2.9019485  1.5126619  0.3715423  0.24080732 1.0005922  1.0005922
 0.         0.         0.         0.         1.0005922  1.0005922 ], edge=[1.0790802 0.5064927 1.7669586 1.0002751 1.0002751 1.0002751 1.0002751
 1.0002751 1.0002751 1.0002751]
2025-06-03 10:10:46,664 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:46,664 - INFO - Running anomaly detection...
2025-06-03 10:10:46,665 - INFO - Starting anomaly detection.
2025-06-03 10:10:46,706 - DEBUG - Node reconstruction errors: [1.4152459  1.1512963  1.3260871  0.62146693 1.3873296  3.1167505
 2.7757347  1.2510914  1.5568978  0.86858916 1.6197973  0.78104687
 1.075046   1.0981517  1.1698201  1.8699989  0.8687559  0.9012968
 0.77146167 1.4166278  0.9012989  1.3418773  1.145454   2.2364552
 3.1370528  1.433427   0.7930954  1.1467426  0.9012975  1.2082318
 0.75673664 1.4334526  1.8950236  3.0233696  1.963408   2.7248874
 4.9018564  1.1791203  2.1348474  1.2476051  1.2412504  1.2637504
 2.8309648  1.0976672  1.7612277  1.1664631  8.027832   1.7151793
 1.6544645  1.1925684  3.855019   1.1481626  1.1321867  1.1791202
 1.4334105  1.1207005  1.2572715  0.9408039  1.8155072  2.0832176
 5.349093   1.9625508  1.8057762  0.94231015 1.9016911  0.8305121
 2.47677    1.145454   1.1929103  1.3829112  1.7698272  0.9891342
 2.8926704  1.2592465  2.6314301  1.3669671  1.1925683  1.3358225
 2.02303    1.2369275  1.0209229  0.99753374 0.68672556 1.0976707
 1.0386474  1.2546918  0.6886383  2.9185317  0.6976087  1.3562853
 0.7149154  2.9886065  1.5391846  1.1551691  0.9251255  4.213685
 0.70259106 1.0652255  1.025365   0.76004344 1.451945   0.7025908
 0.61771494 1.1226573  1.6280653  0.8878838  1.450438   1.3957883
 1.4091822  1.0717617  1.3322741  0.6019315  2.528613   2.7664638
 1.2678777  1.054951   1.2347906  2.315542   0.9896993  0.895074
 0.681915   1.5927047  2.273319   1.6025797  0.89926237 0.8951243
 1.5835891  1.5030613  1.1491349  0.9375837  0.8943694  0.651829
 2.0237055  2.5122428  1.1802521  0.7522394  0.8817263  1.0440505
 1.2364908  2.079283   0.6701336  1.226926   0.67055553 0.6686343
 0.6490665  0.98354894 1.234798   0.77194476 1.0402627  0.8764276
 1.8054765  1.8760735  1.5803552  0.65183055 2.2824817  2.7658641
 0.7588907  1.3456489  1.4519435  0.63009936 0.674152   1.2606504
 0.7588818  0.8946627  1.3888421  2.0732834  1.756925   1.1386849
 1.3082862  0.88782907 1.3014196  0.886835   0.71632785 3.7911005
 0.9897097  0.6816636  1.1924719  1.244946   1.3631229  1.3631221
 0.8665559  1.6023552  0.7776614  2.318616   2.6764216  0.9480728
 0.65548885 1.3368969  0.7366308  0.74321264 1.0765048  0.9495603
 0.6868407  0.80215234 1.2363257  0.6490856  3.3329995  0.76495445
 2.3639464  0.76349986 0.9255947  0.7590528  2.6781058  1.1569412
 0.89901835 1.4084134  1.0350658  2.5095494  1.0108595  1.516629
 1.3036152  1.2090935  0.67766833 1.2012937  0.77149695 0.7611743
 1.1455787  1.2347894  1.4327552  0.8021324  2.979938   0.65548974
 0.70171314 0.6776667  0.75885653 0.8764687  1.9688472  0.82909244
 1.2225863  1.3811818  1.5357932  0.9853499  1.1761116  1.2348014
 1.2347922  0.74994314 1.0500711  0.70171326 0.7589332  0.7450008
 2.3978415  1.2336464  0.67912906 0.8116293  0.80749255 0.8117053
 1.2203273  0.87310016 0.6791298  0.7134734  0.7163279  0.8152064
 1.4327427  1.1570814  1.2524854  1.1795474  0.7399229  0.9890967
 0.7720717  1.3631223  1.3497077  1.8672098  0.6910601  0.8529678
 1.1302532  0.9052232  1.4256366  3.917767   1.4256711  1.3556315
 2.0906537  2.2311263  1.2913343  0.9300587  1.6667687  1.3631238
 0.766282   1.2263683  0.8666283  0.9602177  3.7138672  0.7820014
 0.9404341  0.8957979  1.0505322  0.9009378  2.6699064  1.5130138
 1.6023548  1.164606   0.8741099  0.67813736 0.95772535 0.80747217
 1.445297   0.9817076  1.1844227  1.3635056  0.6436394  1.73294
 1.0637774  1.02068    1.5843607  1.1236316  1.0202848  1.0201427
 1.0201503  1.6467746  1.001712   1.0204133  1.020159   2.1781244
 1.0201758  0.72655594 1.6800659  1.2484168  1.146123   1.5581237
 0.67476565 0.64268184 1.3687454  0.83417577 1.1432146  1.5843602
 1.3810234  2.2719712  1.013203   1.3251116  1.5004747  1.5004842
 1.4324176  0.650841   1.0222943  1.6667703  1.0201823  1.646773
 0.8887032  0.7983006  1.013031   1.0131184  1.0730671  0.8106524
 1.013035   1.1464107  1.1245809  1.067734   1.5843629  0.8890146
 1.4748797  1.1673794  1.0226984  1.1381054  2.661592   1.1630484
 0.80067    0.7399296  0.9797692  1.0201308  1.0309527  2.8968415
 1.3036106  0.98101234 1.0613397  1.1232446  1.584449   4.1696515
 0.6666915  2.6227667  1.1321229  1.0385325  1.1995063  1.0787773
 1.0365775  2.1099958  1.1416069  1.1630071  0.6860551  1.0536376
 1.0760936  1.020143   1.5843593  1.2818987  0.61178505 0.893382
 1.2664008  0.8632332  0.74169046 1.6543233  1.5722977  1.020451
 1.2200515  1.0187418  1.2157911  1.8576553  1.4955785  1.495447
 1.4953047  2.0779698  1.0090501  1.9659673  0.7240161  1.1051234
 1.4954776  1.0081127  1.3170769  1.2159312  1.1206497  0.69868255
 1.21579    1.3697885  1.4953904  1.2157902  1.0083746  1.4954853
 1.4954053  0.64157873 0.8005536  1.495296   0.68538755 0.6749347
 0.7077099  0.6991343  1.0233436  0.6125863  1.9969897  0.6840964
 0.7178666  1.1616248  1.588722   1.5802318  1.340141   0.84435093
 1.349664   1.0094702  1.4952849  1.4954575  0.72361    0.8793842
 2.025791   0.9138685  0.6559419  1.0324531  0.9622994  0.62580466
 0.6235071  2.1130798  1.8616946  0.59033877 0.5709852  0.61907315
 0.99664825 0.66140735 0.6379573  0.99933493 0.6614071  0.7193591
 0.6096258  0.6237995  0.5933048  0.89354515 1.0685389  0.64056593
 0.5980348  1.5302143  0.6016598  0.64059234 0.7694733  0.8919599
 1.2639282  0.5647858  0.76947445 1.0687104  0.73638684 1.9536648
 0.96127284 1.0242565  0.89197063 1.0685391  0.64465153 0.66088957
 0.6011537  2.1418984  0.65679425 0.59113765 1.7803342  0.72840494
 0.6614073  1.2712649  0.6239289  1.9054375  1.2784123  0.644651
 0.82152444 0.640806   0.9806894  0.6244277  1.0196493  2.6198
 0.99934185 0.66080815 0.7043746  0.6407851  0.70402426 0.7561449
 0.76004535 1.4553412  0.98369515 2.5579038  0.5851478  0.66140753
 1.4544199  1.0092264  1.009176   0.62351197 1.3379006  0.6406018
 0.9992376  1.4593217  0.632799   1.19357    1.4593309  1.0317757
 0.9829783  0.59731406 0.7601041  1.0196226  0.92011285 1.4865117
 1.4593614  1.0172036  0.6406018  0.999347   0.9993743  0.66078675
 1.0196791  1.1586034  1.3314514  0.8459328  0.9994165  1.1341136
 0.9994564  1.1341059  0.89687234 1.4593462  0.95689046 3.2343903
 1.7119857  0.9937709  2.1441102  0.9937265  0.99382657 0.9937677
 0.9937117  0.99373966 0.9937752  0.9937536  1.4583954  0.95360124
 0.63748497 0.9938724  0.993703   0.99374706 0.99371594 0.9937515
 0.993702   0.9937727  0.9937457  0.9937002  1.4119904  0.99436325
 0.993699   2.3154593  0.99375665 1.4219902  0.49431536 0.99934393
 0.41048712 0.7997251  0.79421574 0.79421574 0.87979525 0.41048712
 0.99938655 0.98292404 0.9834889  0.9993498  0.9838449  0.8684728
 0.87736183 1.0055047  1.0315423  0.9993469  1.009422   0.9993448
 0.9994084  0.9255641  0.99935806 0.98292    0.9993447  0.9993856
 1.4593327  0.98296773 0.9993953  0.98402184 0.9994003  0.9993432
 0.9993525  1.23466    0.7997064  0.9806324  0.99370116 1.1412473
 0.54331654 0.99939847 0.9836539  1.116406   0.9944021  0.9082624
 0.8113625  0.9728367  0.999342   0.9993431  0.99876153 1.2412758
 0.9615701  0.9995525  1.4583954  0.96318316 0.9830476  1.9070204
 0.9937027  0.86082083 1.2857281  0.99374586 0.99549186 1.4583963
 0.9612683  0.99936515 1.2241457  0.98852885 1.0920222  1.2412521
 0.775897   1.3710611  1.3710558  0.48218217 0.62410223 0.9937036
 1.009256   1.1980293  1.2412801  1.0809494  0.6335822  0.650577
 0.99192834 0.9919263  0.9920057  0.991983   0.99192977 1.3801403
 1.1944377  0.99192256 0.9934252  0.9937639  0.96164346 0.99374956
 1.3710551  1.195346   1.069454   0.6656059  1.3710536  1.0265152
 1.4119853  0.8947722  1.4119841  0.9937224  1.3710526  0.753483
 0.9783638  0.97841877 0.9919297  0.7534526  0.9054037  0.6684163
 0.9938584  0.99371505 0.99198806 0.62291086 0.9782869  0.9713424
 0.6505767  0.72721344 1.3801407  1.867002   0.7280206  2.06444
 1.0314454  0.65058    0.7043343  0.7515547  0.65037996 0.6275104
 1.2978216  0.9935793  1.3254733  0.650577   0.6505781  0.65057695
 0.6364395  0.6505771  0.650577   0.6503799  0.65057683 0.6505769
 0.65057814 1.0433582  0.7528689  0.8808716  0.99412525 1.0144829
 0.60180795 0.6297468  0.8629415  2.2868237  0.6667202  0.7632709
 0.6347735  1.1690286  1.1687683  0.65038    1.9692222  0.9048136
 0.6529996  0.9990294  0.6942944  2.0868046  0.76463944 0.76463735
 0.7646356  1.0059104  0.6478693  1.6702205  0.87615836 0.78326315
 0.63476974 0.6326656  1.0046161  0.99878573 0.6114509  0.8994699
 0.6417037  0.63105243 0.6529995  0.90402806 0.99878657 0.899379
 0.63266104 0.81648725 0.76463616 1.006256   0.6417195  1.0267273
 1.1773154  1.0059484  1.0059124  1.0058423  1.0147549  1.3582872
 7.1052876  0.7646369  0.8027724  1.006027   0.8659417  1.0478219
 2.9346614  1.0497603  1.0058993  1.0152617  1.0351833  0.65810955
 1.0234483  1.0712517  3.0969267  0.9475766  1.2448056  1.0477339
 1.27988    1.1918713  1.0116023  1.2033687  1.3704703  0.66568017
 0.6656936  1.2034075  1.1770375  1.0152687  1.0477605  1.0116868
 1.0477616  0.6783799  0.678378   0.6783785  0.657353   0.94947404
 0.67837846 0.6783785  0.67434853 1.0239958  0.6783785  0.6783784
 1.0324333  0.68879676 1.1166499  0.8486388  0.6783779  0.97627705
 1.0239962  0.6783784  0.6986441  0.69367725 0.67837834 0.6783785
 1.5991937  0.6937027  0.67837876 0.6936769  0.6829111  0.8885466
 0.79432017 0.6783787  1.412969   0.6825767  0.68253285 0.6888019
 1.0677353  0.68248254 0.6986444  0.6986442  0.6986446  1.2339194
 0.7191158  1.233926   0.87218034 0.69864374 0.71911556]
2025-06-03 10:10:46,706 - DEBUG - Edge reconstruction errors: [0.15851861 1.4585979  1.4599466  ... 0.15842853 1.3588493  0.15842904]
2025-06-03 10:10:46,709 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101046_update_27.json
2025-06-03 10:10:46,709 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:46,714 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101046_update_27.pth and as latest_checkpoint.pth
2025-06-03 10:10:46,715 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.3272
2025-06-03 10:10:46,715 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:10:46,715 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1168, MLP Score: 0.5089
2025-06-03 10:10:46,715 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.1371, MLP Score: 0.4834
2025-06-03 10:10:46,715 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 3.0234, MLP Score: 0.4953
2025-06-03 10:10:46,715 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.9019, MLP Score: 0.4636
2025-06-03 10:10:46,715 - WARNING -   Node ID: 142.250.196.228, Recon Error: 2.8310, MLP Score: 0.4842
2025-06-03 10:10:46,715 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 10:10:46,715 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9645, MLP Score: 0.4912
2025-06-03 10:10:46,715 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3787, MLP Score: 0.5021
2025-06-03 10:10:46,715 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.5290, MLP Score: 0.5242
2025-06-03 10:10:46,715 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4916, MLP Score: 0.5281
2025-06-03 10:10:46,715 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.8041, MLP Score: 0.3574
2025-06-03 10:10:46,715 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-03 10:10:46,715 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-03 10:10:46,715 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-03 10:10:46,735 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-03 10:10:46,752 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-03 10:10:46,752 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-03 10:10:46,752 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-03 10:10:46,768 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-03 10:10:46,785 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-03 10:10:46,785 - INFO - Processing node updates/additions.
2025-06-03 10:10:46,789 - INFO - Processing edge updates/additions.
2025-06-03 10:10:46,798 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:46,798 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:46,799 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:46,799 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:46,806 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-03 10:10:46,808 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:46,808 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-03 10:10:46,811 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-03 10:10:46,812 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:46,815 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-03 10:10:46,817 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:46,818 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 10:10:46,819 - DEBUG - Shape of encoded categorical edge features: torch.Size([1848, 3])
2025-06-03 10:10:46,820 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:46,820 - DEBUG - Shape of scaled numerical edge features: torch.Size([1848, 7])
2025-06-03 10:10:46,821 - DEBUG - Final edge attributes tensor shape: torch.Size([1848, 10])
2025-06-03 10:10:46,821 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:46,824 - INFO - Performing online update...
2025-06-03 10:10:46,824 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:46,825 - DEBUG - Updated RunningStats: new_mean=0.9515136658340726, new_var=15600000000161.379, new_n=1590
2025-06-03 10:10:46,825 - DEBUG - Updated RunningStats: new_mean=0.947611812800301, new_var=15900000000018.195, new_n=1620
2025-06-03 10:10:46,826 - DEBUG - Updated RunningStats: new_mean=1.145722960517462, new_var=5200000000073.316, new_n=530
2025-06-03 10:10:46,826 - DEBUG - Updated RunningStats: new_mean=1.1437156158380257, new_var=5300000000000.959, new_n=540
2025-06-03 10:10:46,826 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:46,826 - DEBUG - Online update step: 1/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 2/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 3/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 4/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 5/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 6/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 7/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 8/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 9/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 10/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 11/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 12/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 13/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 14/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 15/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 16/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 17/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 18/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,826 - DEBUG - Online update step: 19/50
2025-06-03 10:10:46,826 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 20/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 21/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 22/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 23/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 24/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 25/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 26/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 27/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 28/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 29/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 30/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 31/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 32/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 33/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 34/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 35/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 36/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 37/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 38/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 39/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 40/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 41/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 42/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 43/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 44/50
2025-06-03 10:10:46,827 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,827 - DEBUG - Online update step: 45/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - DEBUG - Online update step: 46/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - DEBUG - Online update step: 47/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - DEBUG - Online update step: 48/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - DEBUG - Online update step: 49/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - DEBUG - Online update step: 50/50
2025-06-03 10:10:46,828 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:46,828 - WARNING - No successful steps during online update.
2025-06-03 10:10:46,828 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.6154463e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7255703e-08
  4.4049622e-09  0.0000000e+00  4.4049622e-09 -8.8099243e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
 -2.2024811e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -4.1847141e-08  3.7442177e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7531013e-09  7.7086835e-09], current edge mean: [ 8.1650429e+00  1.4117966e+00  4.9886365e+00  0.0000000e+00
 -6.1926904e-09  1.0321151e-09  0.0000000e+00  1.5481726e-09
  2.5802878e-09  1.0321151e-09]
2025-06-03 10:10:46,828 - DEBUG - Node drift difference: 0.0150, Edge drift difference: 0.0112
2025-06-03 10:10:46,829 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.6154463e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7255703e-08
  4.4049622e-09  0.0000000e+00  4.4049622e-09 -8.8099243e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
 -2.2024811e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -4.1847141e-08  3.7442177e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7531013e-09  7.7086835e-09], edge=[ 8.1650429e+00  1.4117966e+00  4.9886365e+00  0.0000000e+00
 -6.1926904e-09  1.0321151e-09  0.0000000e+00  1.5481726e-09
  2.5802878e-09  1.0321151e-09]
2025-06-03 10:10:46,829 - DEBUG - Updated reference std: node=[0.         0.         1.0005779  1.0005779  0.         0.
 0.         1.0005778  1.0005778  1.0005779  1.0005779  1.0005779
 0.99914396 0.28549412 0.3677101  0.5709333  1.0005779  2.9968822
 2.89626    1.4954702  0.3677101  0.23786968 1.0005778  1.0005778
 0.         0.         0.         0.         1.0005778  1.0005778 ], edge=[1.0880713 0.5053171 1.7779802 1.0002707 1.0002707 1.0002706 1.0002707
 1.0002706 1.0002707 1.0002707]
2025-06-03 10:10:46,829 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:46,829 - INFO - Running anomaly detection...
2025-06-03 10:10:46,829 - INFO - Starting anomaly detection.
2025-06-03 10:10:46,900 - DEBUG - Node reconstruction errors: [1.428477   1.1679937  1.3390199  0.62901497 1.4030408  3.1349497
 2.7756257  1.2600461  1.8788574  0.8723545  1.62793    0.792256
 1.0235492  1.1046351  1.1870265  1.8663691  0.874916   0.91354406
 0.78319544 1.401278   0.9135451  1.3494258  1.1471772  2.2118387
 3.1279693  1.4339119  0.7975365  1.1549714  0.9135447  1.211001
 0.7635008  1.4339348  1.9045317  3.115907   1.9646618  2.7437768
 4.939214   1.1792384  2.179672   1.2491156  1.240135   1.2639283
 2.8394866  1.1041718  1.7751998  1.1622149  8.041804   1.7179716
 1.6603036  1.195104   3.8294253  1.1509207  1.1368929  1.1792384
 1.4338946  1.1286064  1.2560221  0.9381348  1.8344263  2.0553975
 5.3911037  1.9659256  1.8050368  0.9463621  1.8677514  0.8288584
 2.4354353  1.1471767  1.1954256  1.387643   1.775042   0.98952216
 2.9038758  1.2718748  2.6300077  1.3731728  1.1951039  1.3417933
 2.0631614  1.2304015  1.0095266  1.0044963  0.6924485  1.1904467
 1.1909004  1.2623862  0.6927189  2.9154367  0.684848   1.3762187
 0.7238911  2.6936688  1.5503255  1.1728096  0.93853164 4.3181753
 0.7097006  1.066893   1.0340677  0.7733762  1.4671906  0.7097008
 0.62417966 1.1429007  1.6378629  0.90171903 1.469723   1.4090375
 1.4216467  1.0667874  1.3325022  0.60908467 2.5843492  2.8310256
 1.2843544  1.0756538  1.2530643  2.3628356  0.9915     0.9078437
 0.6915646  1.601539   2.3226397  1.6171924  0.9015616  0.9078902
 1.5984817  1.5243742  1.1596414  0.9447324  0.9052006  0.66510224
 2.0465264  2.5342066  1.1998388  0.7664102  0.8861058  1.0520803
 1.2402017  1.954098   0.6680728  1.246806   0.68039507 0.6658329
 0.6491361  0.98966414 1.2530712  0.7665371  1.0528201  0.88231224
 1.8118845  1.8932496  1.5934244  0.6651034  2.3258405  2.8392982
 0.7722215  1.3648467  1.4671899  0.6364762  0.671306   1.2699648
 0.7722136  0.90549016 1.406331   1.9464735  1.7710404  1.1569533
 1.3141344  0.8895891  1.3155385  0.898708   0.72497165 3.8888206
 0.9915086  0.68203795 1.210973   1.2677579  1.3817103  1.38171
 0.88046813 1.611394   0.78806126 2.3649623  2.768323   0.95993704
 0.6657098  1.3554611  0.7506891  0.756485   1.0844917  0.9576691
 0.6872034  0.81446207 1.2399796  0.65857786 3.3624322  0.75670016
 2.41154    0.8339812  0.9346551  0.77237546 2.5154407  1.1574593
 0.985519   1.4182391  1.0460819  2.5655112  1.0198368  1.5319284
 1.324156   1.2284107  0.6874905  1.2188575  0.78679943 0.76927924
 1.1500247  1.2530632  1.4534793  0.8144427  3.073743   0.6657099
 0.7106175  0.687489   0.77218956 0.8842129  2.0030963  0.84055465
 1.239235   1.38767    1.5422843  1.0060534  1.178467   1.253074
 1.2530657  0.7507867  1.0697018  0.71061707 0.77226347 0.7414311
 2.4609568  1.2517204  0.6912583  0.88946944 0.8192116  0.8134659
 1.2419642  0.88886136 0.69125825 0.71888936 0.7249716  0.8230783
 1.4534671  1.1753365  1.266485   1.1975669  0.75322014 0.9989223
 0.77509403 1.3817114  1.3685975  1.8781184  0.69691485 0.8554447
 1.1518342  0.9187653  1.4413095  3.8897796  1.4413427  1.3772304
 2.1268098  2.276709   1.310166   0.9251274  1.6841832  1.3817116
 0.77658486 1.2411078  0.8805369  0.96853256 3.7306082  0.79227346
 0.96029216 0.9009892  1.0614057  0.9076031  2.760071   1.5280448
 1.6113942  1.1712085  0.8876844  0.68531907 0.9690544  0.8191913
 1.4595095  0.99000704 1.2034429  1.382082   0.6531785  1.7403336
 1.0833381  1.0296631  1.6039823  1.1366247  1.0292681  1.0291333
 1.0291401  1.6648631  1.0113568  1.0294039  1.0291485  2.2056816
 1.0291656  0.73940665 1.6888101  1.2668539  1.1676666  1.5667597
 0.68337905 0.65059626 1.3861948  0.8456999  1.1598017  1.6039826
 1.3889185  2.3178685  1.0222055  1.3361919  1.5160172  1.5160258
 1.4509357  0.6577072  1.0311942  1.6841865  1.0291715  1.6648608
 0.9047232  0.8068789  1.0220428  1.0221303  1.0816569  0.81959873
 1.0220473  1.1587311  1.1306598  1.0825249  1.6039847  0.89604867
 1.4881475  1.1855394  1.0316974  1.1598278  2.7351043  1.18029
 0.81001216 0.7532259  0.9893875  1.029122   1.0393021  2.8792777
 1.3241521  0.99362844 1.0720519  1.1436002  1.6040677  4.2674737
 0.6771581  2.6897264  1.1534009  1.0613419  1.2188435  1.0993553
 1.0495276  2.1762626  1.1477916  1.1802478  0.69614273 1.064844
 1.0959796  1.0291348  1.6039819  1.3001107  0.6229852  0.91336536
 1.283417   0.8733398  0.7446536  1.6680648  1.589768   1.0294297
 1.2347516  0.8717338  1.2374072  1.8786746  1.5155578  1.5154301
 1.51529    2.0479994  1.0181023  1.9360553  0.73461986 1.1230344
 1.5154595  1.0172232  1.3388861  1.2375435  1.1304911  0.70932657
 1.2374057  1.3813053  1.5153738  1.2374063  1.0174707  1.5154661
 1.5153878  0.6504589  0.81020135 1.5152833  0.6954871  0.67474854
 0.71802485 0.7098059  1.0462207  0.62402713 2.0331025  0.6930964
 0.7252161  1.1797147  1.5992006  1.5760404  1.356994   0.85524297
 1.3725243  1.0324476  1.515272   1.5154383  0.73424155 0.8992016
 2.0644891  0.9237765  0.6570302  1.0405992  0.96966285 0.63558507
 0.6324406  2.132552   1.8593209  0.60236996 0.57852817 0.6310357
 1.0073237  0.6712347  0.64951706 1.0081025  0.67123467 0.7318894
 0.6210083  0.63418657 0.59898466 0.9034448  1.090454   0.6506752
 0.61041343 1.5355455  0.6138415  0.6506998  0.7788901  0.90548956
 1.2739824  0.5709638  0.77889067 1.0906196  0.75265217 1.9941429
 0.9727337  1.0471147  0.90549904 1.0904535  0.6549128  0.6696481
 0.60842574 2.1906264  0.6595489  0.60312396 1.8041627  0.73534125
 0.67123485 1.2848048  0.6280229  1.9403871  1.3010526  0.6549122
 0.83469963 0.65147823 1.0006942  0.63478374 1.0395037  2.5653548
 1.0081096  0.66956735 0.7137652  0.65145916 0.7134342  0.76643616
 0.7691693  1.4555075  0.99294263 2.6266425  0.59341115 0.6712345
 1.4528716  1.017531   1.0174801  0.6324442  1.3606315  0.64476365
 1.0082496  1.4804456  0.6379855  1.2111628  1.480454   1.0399549
 0.9922721  0.6024064  0.7692248  1.0394775  0.92413783 1.4935757
 1.4804839  1.035511   0.6447633  1.0081133  1.0081391  0.66954803
 1.0395328  1.1807728  1.3483871  0.8648892  1.0081791  1.1557575
 1.0082195  1.155749   0.89920056 1.4804677  0.96857077 3.223021
 1.7227336  1.0020252  2.148004   1.0019838  1.0020823  1.0020212
 1.00197    1.0019959  1.0020291  1.0020087  1.4778851  0.9635985
 0.63993496 1.0021209  1.0019618  1.0020024  1.0019754  1.0020078
 1.0019603  1.0020294  1.002003   1.0019585  1.4316213  1.0026056
 1.0019565  2.3381975  1.0020136  1.4249967  0.49638474 1.0081106
 0.40893617 0.80962306 0.7829354  0.7829354  0.8983079  0.40893617
 1.0081513  0.9922197  0.9927558  1.0081177  0.9931009  0.8738665
 0.886425   1.0135455  1.0397193  1.0081139  1.0177104  1.0081111
 1.0081747  0.9267359  1.0081248  0.9922174  1.0081117  1.0081508
 1.4804574  0.9922622  1.0081598  0.993293   1.0081642  1.0081095
 1.0081193  1.2529134  0.736096   1.0006392  1.0019591  1.1518422
 0.5434061  1.0081648  0.9929096  1.1303332  1.0026226  0.9125667
 0.81949466 0.9823091  1.0081095  1.0081102  1.0158501  1.2575926
 0.97969556 1.0083078  1.4778857  0.9713944  0.9923391  1.9129936
 1.0019618  0.8668676  1.2949699  1.002001   1.0036409  1.4778861
 0.96960866 1.0081308  1.2324449  1.0102174  1.1023968  1.2575699
 0.77671754 1.3911036  1.3910986  0.48397055 0.630533   1.0019618
 1.0195841  1.2146993  1.2575969  1.0992438  0.6370546  0.6583997
 0.99875396 0.99875104 0.99882764 0.9988059  0.9987544  1.3952539
 1.206524   0.99874777 1.0002204  1.00202    0.96852386 1.0020038
 1.3910983  1.2127023  1.0603238  0.67324525 1.3910964  1.0419161
 1.431616   0.9010305  1.4316154  1.0019784  1.3910962  0.7620287
 0.9868831  0.9869331  0.99875444 0.7620003  0.922191   0.67501885
 0.98172253 1.0019728  0.99880975 0.6291346  0.98680764 0.97903836
 0.6583999  0.733172   1.3952541  1.884372   0.7339379  2.075477
 1.0459164  0.65840214 0.7135481  0.75851816 0.6567225  0.6319896
 1.3104938  0.9987847  1.3444608  0.6583997  0.6584001  0.65839976
 0.6444749  0.6583997  0.6584     0.6567226  0.6583998  0.6583997
 0.65840054 1.0554054  0.75830746 0.936594   1.001863   1.0282214
 0.6100871  0.6359842  0.8702748  2.232058   0.6713022  0.76698864
 0.63767505 1.1739221  1.1736709  0.65672266 1.9738086  0.9068751
 0.6582288  1.0024174  0.6902131  2.083356   0.7671349  0.7671335
 0.7671311  1.0071021  0.6512966  1.6516778  0.8742468  0.7841265
 0.63513833 0.63680226 1.0101656  1.0021892  0.61499465 0.9061194
 0.6468108  0.6331864  0.6582293  0.9061512  1.0021895  0.9060338
 0.6367983  1.9460919  0.7671317  1.0074153  0.64682615 1.0316652
 1.178287   1.0071363  1.0071043  1.0070403  1.0155995  1.3609644
 7.1013513  0.76713306 0.8035599  1.0072078  0.87208456 1.0450671
 2.8599722  1.046882   1.0070932  1.0151292  1.0149637  0.66158736
 1.1402917  1.067323   3.1693408  0.94024473 1.239938   1.0449873
 1.2793249  1.1895031  0.99993294 1.1950114  1.3664154  0.6671022
 0.66711295 1.1950482  1.1638601  1.0151346  1.045012   1.0000159
 1.0450132  0.6753303  0.67532855 0.6753286  0.6582052  0.93337834
 0.67532885 0.6753282  0.66913056 1.0111687  0.6753286  0.67532855
 1.0254766  0.68066037 1.100192   0.8344495  0.675329   0.966679
 1.0111684  0.6753287  0.68970996 0.68822664 0.66867    0.6691287
 1.5516819  0.68825054 0.6753285  0.68822616 0.67618835 0.8656059
 0.7852669  0.6753286  1.3954277  0.67588145 0.675841   0.6806649
 1.0548011  0.6757959  0.68970996 0.7142572  0.6873101  1.2227954
 0.70823234 1.2228004  0.8533487  0.6897099  0.70823133 1.0711304
 1.071124   2.5441415  1.0711651  0.8055356  1.0455402  1.2104748
 1.0675468  0.6873101  1.0653358  1.7508426  0.6897226  1.7305064
 1.071234   0.7451487  0.71425587 1.0712255  0.90551454 0.68731785
 0.7451485  0.6873108 ]
2025-06-03 10:10:46,901 - DEBUG - Edge reconstruction errors: [0.15914665 1.4592254  1.4605126  ... 0.1590628  1.3594551  0.15906328]
2025-06-03 10:10:46,903 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101046_update_28.json
2025-06-03 10:10:46,903 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:46,909 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101046_update_28.pth and as latest_checkpoint.pth
2025-06-03 10:10:46,909 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.3275
2025-06-03 10:10:46,909 - WARNING - Detected 24 anomalous nodes (reconstruction-based):
2025-06-03 10:10:46,909 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.1349, MLP Score: 0.5094
2025-06-03 10:10:46,909 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.1280, MLP Score: 0.4837
2025-06-03 10:10:46,909 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 3.1159, MLP Score: 0.4953
2025-06-03 10:10:46,909 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.9392, MLP Score: 0.4631
2025-06-03 10:10:46,909 - WARNING -   Node ID: 142.250.196.228, Recon Error: 2.8395, MLP Score: 0.4844
2025-06-03 10:10:46,909 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 10:10:46,909 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.8162, MLP Score: 0.4916
2025-06-03 10:10:46,909 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.2514, MLP Score: 0.5026
2025-06-03 10:10:46,910 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3987, MLP Score: 0.5214
2025-06-03 10:10:46,910 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3811, MLP Score: 0.5256
2025-06-03 10:10:46,910 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.6955, MLP Score: 0.3499
2025-06-03 10:10:46,910 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-03 10:10:46,910 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-03 10:10:46,910 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-03 10:10:46,930 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-03 10:10:46,949 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-03 10:10:46,949 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-03 10:10:46,949 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-03 10:10:46,966 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-03 10:10:46,984 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-03 10:10:46,984 - INFO - Processing node updates/additions.
2025-06-03 10:10:46,987 - INFO - Processing edge updates/additions.
2025-06-03 10:10:46,996 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:46,997 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:46,997 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:46,997 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:47,005 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-03 10:10:47,007 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:47,007 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-03 10:10:47,010 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-03 10:10:47,011 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:47,016 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:10:47,018 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:47,019 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:10:47,020 - DEBUG - Shape of encoded categorical edge features: torch.Size([1887, 3])
2025-06-03 10:10:47,021 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:47,022 - DEBUG - Shape of scaled numerical edge features: torch.Size([1887, 7])
2025-06-03 10:10:47,022 - DEBUG - Final edge attributes tensor shape: torch.Size([1887, 10])
2025-06-03 10:10:47,022 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:47,026 - INFO - Performing online update...
2025-06-03 10:10:47,026 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:47,027 - DEBUG - Updated RunningStats: new_mean=0.9514481974537882, new_var=16200000000161.973, new_n=1650
2025-06-03 10:10:47,027 - DEBUG - Updated RunningStats: new_mean=0.9476310473543267, new_var=16500000000018.02, new_n=1680
2025-06-03 10:10:47,027 - DEBUG - Updated RunningStats: new_mean=1.15246262854251, new_var=5400000000093.966, new_n=550
2025-06-03 10:10:47,027 - DEBUG - Updated RunningStats: new_mean=1.1511836183967334, new_var=5500000000001.617, new_n=560
2025-06-03 10:10:47,027 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:47,027 - DEBUG - Online update step: 1/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 2/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 3/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 4/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 5/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 6/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,027 - DEBUG - Online update step: 7/50
2025-06-03 10:10:47,027 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 8/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 9/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 10/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 11/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 12/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 13/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 14/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 15/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 16/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 17/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 18/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 19/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 20/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 21/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 22/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 23/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 24/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 25/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 26/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 27/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 28/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 29/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 30/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 31/50
2025-06-03 10:10:47,028 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,028 - DEBUG - Online update step: 32/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 33/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 34/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 35/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 36/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 37/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 38/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 39/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 40/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 41/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 42/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 43/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 44/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 45/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 46/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 47/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 48/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 49/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - DEBUG - Online update step: 50/50
2025-06-03 10:10:47,029 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,029 - WARNING - No successful steps during online update.
2025-06-03 10:10:47,030 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.3468495e-08 -2.0801622e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3867747e-08
 -3.2002494e-09 -2.6668745e-09  2.3468495e-08 -1.3867747e-08
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -1.0667498e-08  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  3.1469121e-08  3.2002494e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -8.5339984e-09  7.7339358e-08], current edge mean: [ 9.1531534e+00  1.4091150e+00  5.6857448e+00 -3.0323508e-09
  2.0215671e-09  1.0107836e-09 -2.0215671e-09  2.0215671e-09
  5.0539177e-09  2.0215671e-09]
2025-06-03 10:10:47,030 - DEBUG - Node drift difference: 0.0192, Edge drift difference: 0.9081
2025-06-03 10:10:47,030 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 10:10:47,031 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.3468495e-08 -2.0801622e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3867747e-08
 -3.2002494e-09 -2.6668745e-09  2.3468495e-08 -1.3867747e-08
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -1.0667498e-08  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  3.1469121e-08  3.2002494e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -8.5339984e-09  7.7339358e-08], edge=[ 9.1531534e+00  1.4091150e+00  5.6857448e+00 -3.0323508e-09
  2.0215671e-09  1.0107836e-09 -2.0215671e-09  2.0215671e-09
  5.0539177e-09  2.0215671e-09]
2025-06-03 10:10:47,031 - DEBUG - Updated reference std: node=[0.         0.         1.0005598  1.0005598  0.         0.
 0.         1.0005598  1.0005598  1.0005598  1.0005598  1.0005598
 0.97541434 0.28107604 0.36824727 0.5703764  1.0005598  2.9711607
 2.8818514  1.4734278  0.36824727 0.23411502 1.0005598  1.0005598
 0.         0.         0.         0.         1.0005598  1.0005597 ], edge=[1.1319937 0.5045725 2.1699586 1.0002651 1.0002651 1.0002651 1.0002651
 1.0002651 1.0002651 1.0002651]
2025-06-03 10:10:47,031 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:47,031 - INFO - Running anomaly detection...
2025-06-03 10:10:47,031 - INFO - Starting anomaly detection.
2025-06-03 10:10:47,073 - DEBUG - Node reconstruction errors: [1.3914673  1.1420977  1.3023846  0.59602684 1.3695099  3.0823555
 2.7426527  1.2346028  1.8187541  0.8289853  1.581759   0.75077134
 0.9684085  1.0610517  1.1586787  1.8516365  0.8350664  0.8706766
 0.7440537  1.3599033  0.87068003 1.2999214  1.106335   2.2242234
 3.0893762  1.3770126  0.75891757 1.1238377  0.87067735 1.1684902
 0.72769034 1.3770379  1.8593959  2.8569174  1.9200305  2.710557
 4.8641114  1.1359322  2.0158083  1.1978976  1.1954916  1.2279111
 2.7926316  1.0610455  1.7314206  1.2088869  8.101712   1.6749251
 1.6116631  1.1535856  3.8369513  1.1063614  1.0963435  1.1359328
 1.3769935  1.0923556  1.2107732  0.9010837  2.640849   2.0640335
 5.31439    1.9265449  1.7762635  0.91235536 1.8666302  0.78419244
 2.4381523  1.1063355  1.1538943  1.3353716  1.7205341  0.95697176
 2.8628805  1.2385939  5.082843   1.3015475  1.1535857  1.3079243
 2.033469   1.1784055  0.9667399  0.9633978  0.65451586 1.1227938
 1.1232654  1.2152075  0.6532797  2.8704636  0.64490724 1.3495262
 0.68795985 2.6541743  1.5130905  1.1457667  0.8988956  4.00175
 0.67619205 1.0204233  0.9859563  0.7300112  1.4300495  0.67619246
 0.59408724 1.1199582  1.590031   0.8590183  1.4098905  1.3642145
 1.3826069  1.0710031  1.3113738  0.57802606 2.4846084  2.8028023
 1.24713    1.0467434  1.2180858  2.3359256  0.95362604 0.8726444
 0.65764177 1.5576564  2.300284   1.5646938  0.87270343 0.87269324
 1.5557475  1.4855291  1.1300741  0.8988083  0.8618432  0.62504995
 2.2356834  2.4954987  1.1667945  0.7237532  0.8568643  1.0055062
 1.1962311  1.9053452  0.62313    1.2062978  0.6473277  0.6207739
 0.60637635 0.9514408  1.2180932  0.7208751  0.98335594 0.84706914
 1.5283219  1.835999   1.5643914  0.6250506  2.2883017  2.8609672
 0.73270637 1.3459162  1.4300486  0.6055532  0.6265748  1.2265701
 0.7326974  0.86215806 1.3720435  1.8980774  1.7396065  1.1287894
 1.2632784  0.8613613  1.2808843  0.86367005 0.6891565  3.6271276
 0.95363307 0.6408775  1.1687769  1.2502114  1.3487836  1.3487829
 0.83905244 1.570612   0.8204658  2.3377452  2.7813945  0.9304551
 0.6329159  1.322155   0.70914334 0.7184171  1.0558453  0.92532957
 0.64207757 0.7725778  1.1960806  0.6171192  3.3297784  0.7123785
 2.378539   0.7876929  0.88860357 0.73287565 2.7693288  1.116466
 0.9467906  1.375734   0.9996423  2.53389    0.9707917  1.5057446
 1.2943078  1.1944717  0.65231407 1.1992874  0.7596565  0.73330134
 1.1169224  1.2180852  1.423886   0.7725573  3.1475215  0.632917
 0.675235   0.6523143  0.73267025 0.85101014 1.9694977  0.79741955
 1.2079409  1.3487728  1.4941964  0.98116547 1.1427547  1.218097
 1.2180873  0.7066745  1.0468642  0.6752355  0.732752   0.7027921
 2.478884   1.2308086  0.64944184 0.78567463 0.776852   0.7857653
 1.2156917  0.85977477 0.6494424  0.6818592  0.6891567  0.78706956
 1.4238744  1.1419849  1.2423881  1.1654751  0.71478856 0.9515478
 0.7283436  1.3487831  1.3485332  1.8360904  0.66567534 0.81686044
 1.1146094  0.8778609  1.418241   4.778491   1.4182785  1.356321
 2.1027057  2.2534387  1.2881691  0.96622866 1.6570454  1.3487848
 0.74154717 1.2088408  0.8391295  0.9384642  3.6967952  0.75721586
 0.93378824 0.8710982  1.0259749  0.87597585 2.7219357  1.4891064
 1.5706121  1.1279447  0.8442764  0.6540597  0.9334507  0.7768304
 1.4212698  0.9428922  1.1852303  1.3492055  0.6136647  1.6916678
 1.0586082  0.979637   1.5812138  1.1138654  0.97921574 0.97907215
 0.97908    1.6390868  0.9959558  0.9793599  0.9790888  2.159655
 0.97910845 0.7015065  1.6549156  1.2305721  1.1290953  1.5270116
 0.64563733 0.60908586 1.3651769  0.81188595 1.1304065  1.5812138
 1.3422464  2.2926984  1.0222342  1.30853    1.4900517  1.4900608
 1.4294206  0.6151265  0.9812444  1.6570464  0.97911316 1.6390839
 0.8629482  0.77202797 0.972468   0.97256064 1.036659   0.78348935
 0.9724722  1.1350703  1.0981829  1.0578092  1.581217   0.865298
 1.4605373  1.1562063  0.98181766 1.136888   2.781326   1.1533775
 0.77447814 0.7147955  0.94293237 0.9790596  0.99009985 2.8255553
 1.2943037  0.9583592  1.0348396  1.1224917  1.5813123  3.993575
 0.64358276 2.6711173  1.1230786  1.0341964  1.200612   1.0828046
 1.0235136  2.156036   1.1250659  1.1533298  0.6618369  1.0258669
 1.0728039  0.97907233 1.5812126  1.26082    0.58468705 0.88842106
 1.2440645  0.84363896 0.69975543 1.6225451  1.5650177  0.97938627
 1.2048324  0.83267486 1.2101661  1.8328644  1.493397   1.4932758
 1.493142   2.047303   0.9690447  1.9357916  0.6962019  1.092869
 1.4933041  0.9681194  1.3036611  1.2103041  1.1045861  0.67414814
 1.2101649  1.3370773  1.4932228  1.2101645  0.96837896 1.4933114
 1.4932353  0.61607754 0.77387726 1.493134   0.661144   0.63779473
 0.6815409  0.67307776 1.0191981  0.58575803 2.0052006  0.6573913
 0.68713987 0.97165567 1.5547528  1.5281379  1.334406   0.81394947
 1.3532232  1.0043639  1.4931245  1.4932841  0.6957827  0.87188876
 2.0380769  0.877341   0.621459   1.0003062  0.9333158  0.60344243
 0.60028106 2.0809977  1.8119125  0.56654114 0.5476163  0.5921667
 0.97368187 0.6368524  0.6087442  0.9587793  0.6368524  0.6905045
 0.5825207  0.5763498  0.5673616  0.8710462  1.0620555  0.6098834
 0.573259   1.4941269  0.57691497 0.6099093  0.74322253 0.87480175
 1.231195   0.5401798  0.7432228  1.0622293  0.7269773  1.969431
 0.94533974 1.0201635  0.87481177 1.0620555  0.621718   0.626879
 0.5763939  2.1658401  0.62468445 0.56727815 1.7657106  0.69009167
 0.6368524  1.2432495  0.59293205 1.9096646  1.2800075  0.6217176
 0.8048252  0.6191533  0.9731239  0.59515744 1.0105984  2.55471
 0.95878595 0.6267924  0.6763022  0.6191334  0.6759561  0.73002344
 0.7313473  1.4107682  0.94484913 2.5915558  0.55446947 0.6368524
 1.4058151  0.9772338  0.9771757  0.60028493 1.3404448  0.6108644
 0.9612199  1.4606296  0.60491586 1.1916631  1.4606366  0.9996193
 0.94413894 0.5687869  0.7313488  1.0105764  0.876331   1.4444656
 1.4606706  1.0070965  0.6108644  0.95879066 0.95881885 0.6267726
 1.01063    1.1545296  1.3282421  0.83744377 0.9588608  1.1272565
 0.9589041  1.1272498  0.8697153  1.460653   0.93369395 2.93087
 1.6862525  0.9520935  2.1073418  0.9520513  0.952159   0.95209014
 0.9520361  0.9520652  0.95209944 0.9520776  1.4570287  0.92779696
 0.6031215  0.9521961  0.95202774 0.95207125 0.9520416  0.95207876
 0.952026   0.9521007  0.95207345 0.9520244  1.4114574  0.9527162
 0.95202327 2.2384179  0.9520842  1.375545   0.60878366 0.9587881
 0.44747144 0.77970785 0.67080504 0.67080504 0.86959654 0.44747144
 0.9588312  0.9440866  0.94465345 0.95879513 0.94502234 0.8425377
 0.8521015  0.96444255 0.9993656  0.9587914  0.9774358  0.95878893
 0.95885736 0.87806094 0.95880395 0.9440823  0.95878977 0.95883065
 1.4606398  0.94412905 0.9588398  0.94523466 0.9588444  0.9587871
 0.9587985  1.2305974  0.70247513 0.9730732  0.95202583 1.1127704
 0.6603633  0.95884633 0.9448154  1.1077654  0.9527286  0.8656854
 0.78567904 0.9351466  0.95878637 0.9587875  0.9878903  1.2331952
 0.9439205  0.958997   1.4570296  0.92482406 0.94421273 1.8669003
 0.9520273  0.8293637  1.0754677  0.95206934 0.9538024  1.4570289
 0.92292786 0.958811   1.1906229  0.9813343  1.0772642  1.2331716
 0.7295124  1.3683484  1.3683435  0.58485675 0.5975057  0.95202756
 0.98056537 1.1937038  1.2332004  1.0701523  0.6016056  0.61188084
 0.947688   0.94768643 0.9477662  0.9477434  0.9476889  1.3693893
 1.1822565  0.9476822  0.9492633  0.95208967 0.9209487  0.9520737
 1.3683429  1.189962   1.0360279  0.6356981  1.3683406  1.0173762
 1.4114541  0.8547106  1.4114535  0.95204735 1.3683399  0.72178596
 0.93819237 0.9382467  0.9476897  0.7217859  0.89564425 0.6364585
 0.9324063  0.952039   0.9477483  0.59516025 0.93811363 0.93203753
 0.6227562  0.68589324 1.3693892  1.8428789  0.6866825  2.0346227
 1.0143622  0.6227583  0.67315185 0.71506625 0.61993295 0.596494
 1.2828357  0.9464628  1.3211752  0.6227557  0.6227563  0.62275577
 0.60988975 0.6227558  0.6227559  0.61993283 0.6227557  0.6227559
 0.62275666 1.0207583  0.71153355 0.9015328  0.97505915 0.99549025
 0.56779754 0.60032934 0.83766    2.2098966  0.62179184 0.71444714
 0.6007197  1.1277565  1.1274762  0.6199326  1.9192256  0.86713845
 0.61967844 0.9480867  0.6467732  2.0271769  0.71230835 0.71230656
 0.7123048  0.95229214 0.6122444  1.5838946  0.816486   0.736562
 0.5964135  0.59981    0.9675578  0.947843   0.5705412  0.86653525
 0.6091773  0.5955249  0.61967856 0.8663877  0.9478435  0.8664514
 0.5998053  1.8636887  0.7123056  0.95262283 0.60919315 0.98837316
 1.1287357  0.95232767 0.9522943  0.9522265  0.9694882  1.3246672
 7.0680304  0.7123066  0.76206857 0.9524019  0.832324   0.99312323
 2.8323476  0.99513525 0.95228153 0.9577707  0.96330094 0.6215052
 1.1052088  1.0180346  2.8902497  0.8976315  1.1167319  0.9930346
 1.241134   1.1354926  0.9508902  1.1526738  1.3256541  0.62554896
 0.62556    1.152711   1.1134173  0.95777774 0.9930613  0.9509729
 0.9930624  0.6315421  0.6315409  0.6315412  0.6174789  1.0353565
 0.63154083 0.631541   0.6223615  0.9608776  0.63154125 0.63154095
 0.96485424 0.6350278  1.0737244  0.8706164  0.6315409  0.9119844
 0.9608768  0.6315411  0.64046735 0.6313711  0.6223576  0.62435806
 1.4691627  0.6313952  0.63154083 0.6313709  0.6191349  0.8040501
 0.7356566  0.6315409  1.3342423  0.61882263 0.6187826  0.6350323
 0.98695225 0.61873645 0.6404682  0.6581987  0.6367656  1.1604102
 0.64535433 1.1604168  0.8015815  0.6404679  0.64535356 0.9976657
 0.9976574  2.48815    0.9977017  0.74053365 0.97683036 1.1479274
 1.0067109  0.6367664  1.0043244  1.6541044  0.6404807  1.6467837
 0.9977763  0.68426716 0.6581972  0.9977675  0.8350376  0.6367744
 0.68426776 0.6367668  0.99767196 0.99766666 0.99767125 0.9979611
 0.99766785 0.65584505 1.0350324  0.6558453  1.0425247  0.65584826
 0.8618074  0.8618024  0.86182076 0.9976816  0.9976996  0.9978056
 0.9976673  3.6493862  1.0358319  0.6558452  0.9977407  0.9976662
 0.9976932  1.0923226  0.99787647 0.99768144 0.99766135 1.0351847 ]
2025-06-03 10:10:47,074 - DEBUG - Edge reconstruction errors: [0.15889472 1.6589735  1.6602604  ... 1.4592009  0.15881124 1.2598411 ]
2025-06-03 10:10:47,086 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101047_update_29.json
2025-06-03 10:10:47,087 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:47,092 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101047_update_29.pth and as latest_checkpoint.pth
2025-06-03 10:10:47,092 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.3267
2025-06-03 10:10:47,092 - WARNING - Detected 25 anomalous nodes (reconstruction-based):
2025-06-03 10:10:47,092 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0824, MLP Score: 0.5096
2025-06-03 10:10:47,092 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0894, MLP Score: 0.4832
2025-06-03 10:10:47,092 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 2.8569, MLP Score: 0.4954
2025-06-03 10:10:47,092 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.8641, MLP Score: 0.4638
2025-06-03 10:10:47,092 - WARNING -   Node ID: 192.168.27.10, Recon Error: 8.1017, MLP Score: 0.4632
2025-06-03 10:10:47,092 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:47,092 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9232, MLP Score: 0.4928
2025-06-03 10:10:47,093 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3515, MLP Score: 0.5182
2025-06-03 10:10:47,093 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.5520, MLP Score: 0.5202
2025-06-03 10:10:47,093 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.5266, MLP Score: 0.5242
2025-06-03 10:10:47,093 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.7980, MLP Score: 0.3342
2025-06-03 10:10:47,093 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-03 10:10:47,093 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-03 10:10:47,093 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-03 10:10:47,115 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-03 10:10:47,134 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-03 10:10:47,134 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-03 10:10:47,134 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-03 10:10:47,151 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-03 10:10:47,170 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-03 10:10:47,170 - INFO - Processing node updates/additions.
2025-06-03 10:10:47,174 - INFO - Processing edge updates/additions.
2025-06-03 10:10:47,184 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:47,185 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:47,185 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:47,185 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:47,193 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-03 10:10:47,195 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:47,195 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-03 10:10:47,198 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-03 10:10:47,199 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:47,202 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:10:47,203 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:47,204 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:10:47,205 - DEBUG - Shape of encoded categorical edge features: torch.Size([1907, 3])
2025-06-03 10:10:47,206 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:47,206 - DEBUG - Shape of scaled numerical edge features: torch.Size([1907, 7])
2025-06-03 10:10:47,206 - DEBUG - Final edge attributes tensor shape: torch.Size([1907, 10])
2025-06-03 10:10:47,206 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:47,208 - INFO - Performing online update...
2025-06-03 10:10:47,208 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:47,208 - DEBUG - Updated RunningStats: new_mean=0.9513322840391607, new_var=16800000000161.977, new_n=1710
2025-06-03 10:10:47,209 - DEBUG - Updated RunningStats: new_mean=0.9476557273799038, new_var=17100000000018.021, new_n=1740
2025-06-03 10:10:47,209 - DEBUG - Updated RunningStats: new_mean=1.1594899773562675, new_var=5600000000093.879, new_n=570
2025-06-03 10:10:47,209 - DEBUG - Updated RunningStats: new_mean=1.158151682591283, new_var=5700000000001.623, new_n=580
2025-06-03 10:10:47,209 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:47,209 - DEBUG - Online update step: 1/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 2/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 3/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 4/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 5/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 6/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 7/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 8/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 9/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 10/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 11/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 12/50
2025-06-03 10:10:47,209 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,209 - DEBUG - Online update step: 13/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 14/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 15/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 16/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 17/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 18/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 19/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 20/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 21/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 22/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 23/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 24/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 25/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 26/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 27/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 28/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 29/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 30/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 31/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 32/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 33/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 34/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 35/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 36/50
2025-06-03 10:10:47,210 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,210 - DEBUG - Online update step: 37/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 38/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 39/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 40/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 41/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 42/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 43/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 44/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 45/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 46/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 47/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 48/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 49/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - DEBUG - Online update step: 50/50
2025-06-03 10:10:47,211 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,211 - WARNING - No successful steps during online update.
2025-06-03 10:10:47,211 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.8215415e-09  1.2966161e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.0530014e-08
  7.4092346e-09 -2.1036934e-08 -6.3507724e-09 -4.1280021e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.8920009e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.8523085e-08  1.4818469e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.8689255e-08  1.0584620e-08], current edge mean: [ 9.1504984e+00  1.4074463e+00  5.6885161e+00  2.5004570e-09
 -2.5004570e-09 -2.0003657e-09 -1.5002742e-09  5.0009141e-10
  5.0009141e-10 -2.0003657e-09]
2025-06-03 10:10:47,212 - DEBUG - Node drift difference: 0.0041, Edge drift difference: 0.0033
2025-06-03 10:10:47,212 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.8215415e-09  1.2966161e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.0530014e-08
  7.4092346e-09 -2.1036934e-08 -6.3507724e-09 -4.1280021e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.8920009e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.8523085e-08  1.4818469e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.8689255e-08  1.0584620e-08], edge=[ 9.1504984e+00  1.4074463e+00  5.6885161e+00  2.5004570e-09
 -2.5004570e-09 -2.0003657e-09 -1.5002742e-09  5.0009141e-10
  5.0009141e-10 -2.0003657e-09]
2025-06-03 10:10:47,212 - DEBUG - Updated reference std: node=[0.         0.         1.0005554  1.0005554  0.         0.
 0.         1.0005554  1.0005554  1.0005554  1.0005554  1.0005554
 0.9781268  0.28000316 0.37004966 0.57211477 1.0005554  2.9718418
 2.880792   1.4799136  0.37004966 0.23320381 1.0005554  1.0005554
 0.         0.         0.         0.         1.0005554  1.0005554 ], edge=[1.1433936 0.5051748 2.1682844 1.0002623 1.0002623 1.0002623 1.0002623
 1.0002623 1.0002623 1.0002624]
2025-06-03 10:10:47,212 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:47,213 - INFO - Running anomaly detection...
2025-06-03 10:10:47,213 - INFO - Starting anomaly detection.
2025-06-03 10:10:47,225 - DEBUG - Node reconstruction errors: [1.3389214  1.0984557  1.252706   0.5612914  1.3190874  3.0011072
 2.7007775  1.1890317  1.7656974  0.78041846 1.5226033  0.7038206
 0.92053014 1.0102729  1.1162173  1.7835863  1.0061915  0.82020664
 0.6972754  1.3058658  0.8202095  1.2366096  1.0538801  2.1912515
 3.0096927  1.3097122  0.71257615 1.0797971  0.8202078  1.1128094
 0.68329114 1.309738   1.794399   2.572206   1.8644575  2.6360857
 4.663205   1.0813676  1.8325046  1.1544106  1.132104   1.1796962
 2.719844   1.0102668  1.661562   1.1498667  7.953037   1.6171879
 1.552209   1.0918984  3.7867768  1.0539076  1.0437455  1.0813676
 1.3096931  1.0341288  1.1473248  0.86011434 2.6566758  2.0306997
 5.112116   1.8786235  3.183602   0.866551   1.8386842  0.737566
 2.3930337  1.0538797  1.0922066  1.2706548  1.6580273  0.9184843
 2.7865338  1.1898303  5.4308105  1.2743523  1.0918996  1.2622312
 1.9234918  1.1206546  0.92083323 0.91399956 0.9564708  1.0630789
 1.063541   1.156531   0.61205065 2.7957933  1.0083904  1.3028651
 0.64869773 2.5049908  1.4625057  1.1016089  0.8474461  3.7069921
 0.6387659  0.97444445 0.9404468  0.6836     1.3766083  0.638766
 0.5624155  1.0791913  1.5350671  0.80916405 1.3511243  1.3084277
 1.3391904  1.0336742  1.2568622  0.5447373  2.3540332  2.6153402
 1.1988815  1.0046867  1.1702447  2.2235117  0.9092764  0.82413405
 0.6199735  1.5081594  2.1830685  1.5073655  0.8277284  0.8241826
 1.499225   1.4277133  1.0797344  0.8509998  0.81203216 0.58149856
 2.1359894  2.4268427  1.1207814  0.6776336  0.81864005 0.9589949
 1.1461987  1.8310463  0.5805201  1.1632025  0.60977536 0.5782905
 0.5644276  0.9674626  1.170252   0.68012506 0.9306346  0.8067435
 1.4884864  1.7723807  1.5116024  0.5814998  2.1831288  2.6754594
 0.6862152  1.297474   1.3766074  0.5729984  0.58377445 1.1747348
 0.68620706 0.81234515 1.3208811  1.824119   1.6827347  1.0850303
 1.2318282  0.83049744 1.2313358  0.8155819  0.6496398  3.3328466
 0.9279595  0.59842813 1.1242219  1.2050915  1.2977233  1.2977232
 0.7904691  1.5173024  0.7689343  2.2267876  2.6272886  0.8899347
 0.5957598  1.2720945  0.664031   0.67322445 1.0110298  0.8833517
 0.5995735  0.72401917 1.1460464  0.57762367 3.251575   0.66985095
 2.262407   0.8030326  0.84353137 0.68638504 2.6057258  1.0741038
 0.9009369  1.3208833  0.9465397  2.412395   0.9253359  1.4545233
 1.2454722  1.1467102  0.6134545  1.1544086  0.72276133 0.694167
 1.0822978  1.170244   1.372883   0.7239991  2.9327834  0.59576046
 0.6363752  0.6134548  0.6861803  0.8096237  1.8918327  0.74747247
 1.1606443  1.3048319  1.4377742  0.94123346 1.1103345  1.1702555
 1.170245   0.66145784 1.005261   0.636375   0.68626106 0.6631988
 2.337203   1.18563    0.6047186  0.7423512  0.72809625 0.75545204
 1.1697367  0.81944185 0.6047193  0.63847846 0.6496399  0.74501663
 1.3728697  1.0977873  1.1964059  1.1186278  0.6695665  0.9010199
 0.6880892  1.2977233  1.3020997  1.7792695  0.6243169  0.77034825
 1.0650786  0.82762426 1.3675423  4.9383926  1.3675803  1.3084977
 2.0156713  2.1487992  1.2411861  0.91645104 1.6022795  1.2977252
 0.7000395  1.1641028  0.7905462  0.8962739  3.6044052  0.71490824
 0.89433974 0.8320619  0.9820558  0.8333247  2.6545155  1.4369445
 1.517304   1.0838712  0.7946822  0.61792547 0.88406354 0.72807515
 1.3684429  0.89169484 1.1402324  1.2981567  0.57755774 1.6357859
 1.0160801  0.9328368  1.5290163  1.0699013  0.9328327  0.93283087
 0.93283087 1.5844789  0.96102005 0.93283355 0.9328309  2.0736532
 0.9328311  0.6573022  1.5979121  1.1827914  1.060908   1.4766372
 0.6078407  0.573026   1.3164388  0.76557106 1.0838931  1.5290167
 1.2940924  2.1852362  0.9654928  1.2587819  1.4388379  1.4388461
 1.3803087  0.57976854 0.9328461  1.6022813  0.9328309  1.5844768
 0.8130526  0.7307791  0.92656404 0.9265649  0.98313504 0.7363443
 0.9265641  1.0906185  1.0512298  1.0822924  1.5290185  0.8234146
 1.4076344  1.1108943  0.93284976 1.0928813  2.6045465  1.1078073
 0.72803855 0.66957194 0.8920624  0.9328306  0.9443405  2.771757
 0.9967162  0.9085957  0.98668724 1.0795038  1.5291189  3.6909683
 0.60576445 2.5273986  1.077534   0.9916316  1.1553339  1.0408021
 0.98011893 2.0520656  1.077609   1.107758   0.6232116  0.972508
 1.0299038  0.93283087 1.5290157  1.2110995  0.544857   0.8500649
 1.1880875  0.8025977  0.65447    1.5689259  1.5109004  0.93283427
 1.1659417  0.78854203 1.1633209  1.7672292  1.4420645  1.4419385
 1.4417973  2.0158489  0.9191406  1.9079392  0.6535013  1.0527747
 1.4419686  0.9191341  1.2550699  1.1634628  1.0656699  0.6324095
 1.16332    1.2835343  1.4418815  1.16332    0.9191355  1.4419748
 1.4418952  0.57391304 0.7264027  1.4417901  0.62252724 0.5983145
 0.6400211  0.63029104 0.9767104  0.54609364 1.932505   0.6151253
 0.64313096 0.9265     1.500952   1.475647   1.28517    0.7682091
 1.3067899  0.9619142  1.4417794  1.4419469  0.6530801  0.83272654
 1.9628474  0.82983834 0.582681   0.94923633 0.888024   0.56715935
 0.61287886 2.00798    1.7804301  0.5280524  0.51323426 0.5518551
 0.9293535  0.5994024  0.56807053 0.9076865  0.59940296 0.6470346
 0.5429332  0.53448296 0.5336269  0.82900465 1.0180271  0.5690605
 0.53346145 1.4538913  0.5369665  0.5690861  0.7029164  0.8339777
 1.1805904  0.5070079  0.702916   1.0182031  0.6910353  1.8954211
 0.89911425 0.97769254 0.833988   1.0180272  0.58498996 0.58547664
 0.54233384 2.0853696  0.5864475  0.52876604 1.7018417  0.6513745
 0.5994025  1.1939064  0.55863595 1.8403519  1.2346685  0.5849889
 0.76769376 0.5825087  0.9329391  0.5550118  0.96927106 2.5142822
 0.90768623 0.58539295 0.6389408  0.5824906  0.65023905 0.68895555
 0.69165134 1.3669983  0.89375466 2.527855   0.5146859  0.59940225
 1.3596381  0.9279768  0.92792106 0.5639191  1.2937874  0.5731167
 0.9099799  1.4115399  0.5715612  1.1462214  1.4115491  0.94853777
 0.8930589  0.79599476 0.6916526  0.9692474  0.8282405  1.3922074
 1.4115822  0.96432424 0.57311654 0.90768623 0.9076865  0.5853728
 0.969302   1.1092163  1.2815018  0.7994296  0.90768653 1.081615
 0.9076868  1.0816087  0.8348811  1.4115647  0.88615745 2.8826325
 1.6104401  0.900665   2.058737   0.9006225  0.90072805 0.9006619
 0.9006078  0.9006377  0.90067077 0.9006487  1.4077498  0.8797664
 0.56855327 0.90076524 0.9006     0.9006432  0.90061307 0.90064937
 0.90059847 0.9006721  0.9006436  0.90059644 1.3642544  0.9012765
 0.90059483 2.1705325  0.90065557 1.3444917  0.6156166  0.9076863
 0.45723498 0.7394205  0.665759   0.665759   0.83014804 0.45723498
 0.90768695 0.8930069  0.8935637  0.9076863  0.89392453 0.8009642
 0.8056894  0.9128889  0.94827706 0.9076865  0.9281698  0.9076865
 0.9076869  0.82639796 0.9076865  0.8930034  0.90768623 0.9076869
 1.411552   0.89304906 0.9076869  0.8941353  0.90768677 0.90768594
 0.90768653 1.1850333  0.66157585 0.9328822  0.9005969  1.0599908
 0.66901743 0.907687   0.8937224  1.0642514  0.90128684 0.8150975
 0.746233   0.88419896 0.90768605 0.90768623 0.9467327  1.1872537
 0.9043081  0.90768856 1.4077497  0.8738773  0.8931311  1.8061718
 0.9005997  0.7821177  1.0275471  0.9006417  0.90233773 1.4077499
 0.87201536 0.9076868  1.1391085  0.9386219  1.0319084  1.187231
 0.6827848  1.3201635  1.3201562  0.58698785 0.5607465  0.90059984
 0.9314225  1.1482747  1.18726    1.0283046  0.5645872  0.572653
 0.896414   0.89641243 0.8964922  0.8964691  0.8964155  1.3233685
 1.1369964  0.8964087  0.89796525 0.90066177 0.8699568  0.9006454
 1.3201562  1.1450285  0.99000865 0.592699   1.3201538  0.97465575
 1.364252   0.80501896 1.3642513  0.90061814 1.320153   0.68260425
 0.88729024 0.8873428  0.89641595 0.6826042  0.85646206 0.59344804
 0.8798165  0.9006107  0.8964732  0.55854726 0.8872114  0.8811599
 0.5861937  0.647489   1.3233683  1.7836794  0.6474985  1.9734492
 0.9720217  0.58619565 0.6304788  0.67633504 0.58347195 0.5594147
 1.237056   0.89517033 1.2739245  0.5861932  0.5861942  0.5861931
 0.57373464 0.58455294 0.58619326 0.5834721  0.5861933  0.5861933
 0.5861942  0.97817534 0.67296064 0.8582375  0.93210167 0.95375454
 0.5282133  0.563961   0.7974041  2.1741116  0.58418083 0.67166775
 0.5630775  1.0754731  1.0751824  0.5834721  1.7993262  0.8260726
 0.5829642  0.8963823  1.5207887  1.9656549  0.67281574 0.67281544
 0.6728155  0.9004681  0.5752228  1.5313964  0.7599386  0.6978266
 0.561863   0.5625725  0.919296   0.89614373 0.5310868  0.82469785
 0.57258874 0.5605168  0.5829643  0.82531446 0.89614385 0.8246129
 0.56256884 1.7996093  0.67281556 0.9007953  0.5726035  0.9394773
 1.0764153  0.9005052  0.9004726  0.9004045  0.92115366 1.2773584
 6.980129   0.6728154  0.7228004  0.9005766  0.7921931  0.9432607
 2.786589   0.94529545 0.9004605  0.9064747  0.91240156 0.58467674
 1.0599954  0.9685583  2.6036272  0.8563073  1.0675433  0.9431716
 1.1944195  1.082125   0.8999838  1.105891   1.27735    0.58865523
 0.5886662  1.105929   1.0663886  0.9064808  0.94319874 0.9000692
 0.9431992  0.58336264 0.59434193 0.5943418  0.58033484 0.9853399
 0.5943417  0.5943419  0.5833611  0.9177796  0.59434164 0.5943419
 0.91280365 0.59892505 1.0234543  0.82399654 0.594342   0.866746
 0.917779   0.5943419  0.6021031  0.5895528  0.5833579  0.58673805
 1.4146106  0.5895763  0.5943419  0.5895525  0.5689731  0.8556825
 0.6959383  0.5943417  1.2776585  0.57692474 0.57688534 0.5989295
 0.93193805 0.5768417  0.6021035  0.6192644  0.5974492  1.1053973
 0.6025167  1.105404   0.7662554  0.6021033  0.60251564 0.9400246
 0.94001746 2.4404018  0.94006145 0.696431   0.9218101  1.092964
 0.954802   0.5974502  0.95242506 1.5895422  0.8760079  1.5908545
 0.9401365  0.6433785  0.61926335 0.9401274  0.7873926  0.82395923
 0.6433788  0.5974509  0.940032   1.2387291  0.94003135 0.94032246
 0.94007814 0.6154393  0.98177963 0.6154397  0.9892159  0.6154423
 0.8137221  0.81371635 0.8137353  0.9400407  0.9400595  0.940167
 0.94002706 3.353893   0.9825718  0.6154395  0.9402097  0.9400246
 0.940053   1.035978   0.9402377  0.94004095 0.9400215  0.98214054
 0.63543814 2.672089   0.94029456 0.9400683  0.9400328  0.6721274
 0.94002473]
2025-06-03 10:10:47,225 - DEBUG - Edge reconstruction errors: [0.15868022 1.6587595  1.6600485  ... 0.1585965  1.2596291  0.15859652]
2025-06-03 10:10:47,235 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101047_update_30.json
2025-06-03 10:10:47,235 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:47,240 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101047_update_30.pth and as latest_checkpoint.pth
2025-06-03 10:10:47,241 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.3272
2025-06-03 10:10:47,241 - WARNING - Detected 22 anomalous nodes (reconstruction-based):
2025-06-03 10:10:47,241 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0011, MLP Score: 0.5099
2025-06-03 10:10:47,241 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0097, MLP Score: 0.4832
2025-06-03 10:10:47,241 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.6632, MLP Score: 0.4654
2025-06-03 10:10:47,241 - WARNING -   Node ID: 192.168.27.10, Recon Error: 7.9530, MLP Score: 0.4647
2025-06-03 10:10:47,241 - WARNING -   Node ID: 199.232.214.172, Recon Error: 3.7868, MLP Score: 0.4950
2025-06-03 10:10:47,241 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:47,241 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.0631, MLP Score: 0.4932
2025-06-03 10:10:47,241 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3804, MLP Score: 0.5204
2025-06-03 10:10:47,241 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.5792, MLP Score: 0.5200
2025-06-03 10:10:47,241 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.5497, MLP Score: 0.5238
2025-06-03 10:10:47,241 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.8403, MLP Score: 0.3329
2025-06-03 10:10:47,241 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-03 10:10:47,241 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-03 10:10:47,241 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-03 10:10:47,265 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-03 10:10:47,287 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-03 10:10:47,287 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-03 10:10:47,287 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-03 10:10:47,306 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-03 10:10:47,326 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-03 10:10:47,326 - INFO - Processing node updates/additions.
2025-06-03 10:10:47,331 - INFO - Processing edge updates/additions.
2025-06-03 10:10:47,342 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:47,343 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:47,343 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:47,344 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:47,352 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-03 10:10:47,354 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:47,354 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-03 10:10:47,357 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-03 10:10:47,358 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:47,362 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:10:47,363 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:47,364 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:10:47,365 - DEBUG - Shape of encoded categorical edge features: torch.Size([1945, 3])
2025-06-03 10:10:47,366 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:47,366 - DEBUG - Shape of scaled numerical edge features: torch.Size([1945, 7])
2025-06-03 10:10:47,366 - DEBUG - Final edge attributes tensor shape: torch.Size([1945, 10])
2025-06-03 10:10:47,366 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:47,369 - INFO - Performing online update...
2025-06-03 10:10:47,369 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:47,369 - DEBUG - Updated RunningStats: new_mean=0.9512385879781532, new_var=17400000000161.838, new_n=1770
2025-06-03 10:10:47,370 - DEBUG - Updated RunningStats: new_mean=0.9477249033248666, new_var=17700000000018.082, new_n=1800
2025-06-03 10:10:47,370 - DEBUG - Updated RunningStats: new_mean=1.1660545632950368, new_var=5800000000093.738, new_n=590
2025-06-03 10:10:47,370 - DEBUG - Updated RunningStats: new_mean=1.1646323242733914, new_var=5900000000001.631, new_n=600
2025-06-03 10:10:47,370 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:47,370 - DEBUG - Online update step: 1/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 2/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 3/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 4/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 5/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 6/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 7/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 8/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 9/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 10/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 11/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,370 - DEBUG - Online update step: 12/50
2025-06-03 10:10:47,370 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 13/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 14/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 15/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 16/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 17/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 18/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 19/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 20/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 21/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 22/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 23/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 24/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 25/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 26/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 27/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 28/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 29/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 30/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 31/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 32/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 33/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 34/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 35/50
2025-06-03 10:10:47,371 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,371 - DEBUG - Online update step: 36/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 37/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 38/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 39/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 40/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 41/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 42/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 43/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 44/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 45/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 46/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 47/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 48/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 49/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - DEBUG - Online update step: 50/50
2025-06-03 10:10:47,372 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:47,372 - WARNING - No successful steps during online update.
2025-06-03 10:10:47,373 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.6519257e-09  4.3301405e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4389648e-08
 -4.6431627e-08 -2.1650703e-08 -1.0434073e-08 -7.3038513e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.1650703e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  2.0868147e-09  3.4432443e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6606887e-08 -2.5563480e-08], current edge mean: [ 9.1475582e+00  1.4118252e+00  5.6848330e+00 -3.4322469e-09
  1.9612840e-09  9.8064201e-10 -1.4709629e-09  3.9225680e-09
 -1.9612840e-09 -9.8064201e-10]
2025-06-03 10:10:47,373 - DEBUG - Node drift difference: 0.0147, Edge drift difference: 0.0087
2025-06-03 10:10:47,373 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.6519257e-09  4.3301405e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4389648e-08
 -4.6431627e-08 -2.1650703e-08 -1.0434073e-08 -7.3038513e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.1650703e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  2.0868147e-09  3.4432443e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6606887e-08 -2.5563480e-08], edge=[ 9.1475582e+00  1.4118252e+00  5.6848330e+00 -3.4322469e-09
  1.9612840e-09  9.8064201e-10 -1.4709629e-09  3.9225680e-09
 -1.9612840e-09 -9.8064201e-10]
2025-06-03 10:10:47,374 - DEBUG - Updated reference std: node=[0.         0.         1.0005475  1.0005475  0.         0.
 0.         1.0005475  1.0005475  1.0005475  1.0005475  1.0005475
 1.0195211  0.27804288 0.37305197 0.5736149  1.0005475  2.9805017
 2.883391   1.4932402  0.37305197 0.23153941 1.0005475  1.0005474
 0.         0.         0.         0.         1.0005475  1.0005475 ], edge=[1.132355  0.5056919 2.1673553 1.0002571 1.0002571 1.0002571 1.0002571
 1.0002571 1.0002571 1.0002573]
2025-06-03 10:10:47,374 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:47,374 - INFO - Running anomaly detection...
2025-06-03 10:10:47,374 - INFO - Starting anomaly detection.
2025-06-03 10:10:47,384 - DEBUG - Node reconstruction errors: [1.3545506  1.1183232  1.2683917  0.56870955 1.3356947  3.0250545
 2.706929   1.2136378  1.7917663  0.78929484 1.5327429  0.7169276
 0.93740964 1.0242078  1.1377383  1.814872   1.3796005  0.8332366
 0.7092798  1.3122525  0.8332398  1.2523761  1.0659778  2.2300694
 3.0417278  1.3205738  0.7158994  1.1013016  0.83323824 1.1202595
 0.6884802  1.3205968  1.8186215  2.6246066  1.8773389  2.6561193
 4.755874   1.091784   1.8368268  1.1662451  1.143618   1.2081858
 2.738366   1.0242037  1.6734099  1.1490853  8.093791   1.6336668
 1.561494   1.1056136  3.8370702  1.0660042  1.0560809  1.0917838
 1.3205544  1.0520214  1.1587011  0.87071496 2.6086776  2.0598166
 5.202773   1.8948096  3.2029064  0.87843436 1.8626574  0.74121857
 2.419103   1.0659782  1.105909   1.284123   1.6796494  0.929122
 2.8132675  1.2051075  5.272911   1.2640004  1.1056135  1.2819276
 1.9431056  1.1324649  0.92450064 0.92409855 0.9476986  1.0668081
 1.0672605  1.175888   0.61630213 2.834782   1.0081007  1.329258
 0.6576592  2.639952   1.4786108  1.1203616  0.85405993 3.7642941
 0.6483807  0.98942065 0.9574371  0.7570913  1.3931764  0.64838094
 0.5702317  1.0980585  1.5890926  0.8241181  1.3730193  1.3209065
 1.3510169  1.0285296  1.2667416  0.55313665 2.3939893  2.6464717
 1.2137265  1.0251641  1.1862129  2.2551563  0.93423235 0.8419681
 0.6301347  1.5247587  2.2140617  1.5277225  0.8377562  0.84201515
 1.5178016  1.4457304  1.101698   0.8665724  0.8299903  0.5922465
 2.309712   2.4488995  1.1384505  0.68991494 0.8320086  0.97500724
 1.1558908  1.8478681  0.58291155 1.1862792  0.62037235 0.580696
 0.56864256 0.975975   1.1862205  0.7182688  0.95681685 0.8338736
 1.4997557  1.7837625  1.5343468  0.5922477  2.1809201  2.7160456
 0.7000908  1.3227564  1.3931757  0.58025604 0.5862293  1.185188
 0.7000838  0.8303041  1.339732   1.840882   1.7061223  1.1063936
 1.2346916  0.8340438  1.247594   0.8330329  0.65843797 3.3860552
 0.9342361  0.6035606  1.1460652  1.2341956  1.316976   1.3169744
 0.80571055 1.5312705  0.7700728  2.254367   2.695568   0.9097804
 0.60663414 1.2905352  0.6766279  0.6873512  1.0318968  0.90048677
 0.69648224 0.73645616 1.1557465  0.58693576 3.282971   0.71318287
 2.2938237  0.80027956 0.8600317  0.7002585  2.6578965  1.0880083
 0.9188599  1.3350976  0.9661911  2.462658   0.9428883  1.4796364
 1.2668911  1.1631285  0.62195164 1.1791813  0.7413067  0.7066795
 1.095649   1.1862122  1.3923831  0.7364361  2.9765391  0.60663474
 0.6457943  0.6219507  0.7000571  0.963412   1.9148802  0.7587817
 1.1793834  1.3155228  1.5042855  0.9638841  1.1220589  1.1862236
 1.1862134  0.66868055 1.026727   0.64579415 0.7001372  0.7840137
 2.3739295  1.2118547  0.6141626  0.74994016 0.7401192  0.75901043
 1.1915473  0.8386692  0.61416334 0.6481653  0.65843785 0.75591415
 1.3923713  1.1221602  1.2214502  1.134541   0.68373257 0.92100334
 0.7688808  1.3169752  1.331428   1.796026   0.6348206  0.78191215
 1.0814729  0.83580273 1.3924387  4.873419   1.3924758  1.3370628
 2.0413117  2.1791732  1.2661735  0.9149296  1.6288123  1.0691472
 0.712855   1.1818275  0.80578434 0.91438216 3.6367943  0.7271872
 0.9135405  0.8454602  1.0062549  0.84825486 2.673294   1.4511913
 1.5312706  1.0992147  0.8015001  0.6287824  0.9023912  0.7400984
 1.3829247  0.91174185 1.1665488  1.317392   0.58687216 1.651569
 1.0388054  0.94988424 1.557783   1.09829    0.9498806  0.949879
 0.9498789  1.6112136  0.96939564 0.94988185 0.94987935 2.1019404
 0.94987905 0.6715438  1.6190187  1.2052194  1.0733066  1.4919733
 0.6162681  0.5819678  1.3435222  0.78161716 0.999778   1.5577838
 1.3015068  2.2138746  0.9747108  1.282714   1.4642454  1.4642531
 1.4043388  0.5880697  0.94989264 1.628814   0.9498796  1.6112106
 0.8235695  0.7422161  0.9439745  0.94397473 1.003495   0.7491564
 0.9439747  1.1058869  1.071925   1.0956479  1.5577854  0.8387768
 1.4303213  1.1314858  0.949897   1.116033   2.6478653  1.1360065
 0.74163043 0.68373865 0.9131426  0.94987863 0.9610025  2.7712102
 1.009092   0.92984927 1.0082245  1.1081538  1.5578825  3.7503815
 0.61647284 2.584526   1.0959656  1.0126075  1.182104   1.0684993
 1.0057564  2.0936742  1.1030586  1.1359582  0.63321495 0.991909
 2.0897233  0.9498787  1.5577817  1.2268798  0.5555324  0.87008506
 1.1925502  0.82128847 0.6610979  1.5858966  1.5372205  0.9498818
 1.1796662  0.8839035  1.1863198  1.7911422  1.4710199  1.4708848
 1.4707386  2.0458689  0.9372896  1.9352058  0.6664761  1.0694884
 1.4709171  0.9370657  1.2805489  1.1864575  1.0821836  0.64452285
 1.1863192  1.296196   1.4708277  1.1863196  0.93706703 1.4709247
 1.4708419  0.58553666 0.73999494 1.4707298  0.6325242  0.6032131
 0.64461726 0.6440525  0.997843   0.5566465  1.9663844  0.6446658
 0.6543115  0.94199234 1.5125054  1.4843724  1.3117187  0.78247297
 1.3400772  0.9829351  1.470719   1.4708947  0.66605854 0.85201
 1.9972259  0.84674376 0.5886932  0.9689903  0.9057144  0.57805413
 0.61415976 2.0323117  1.7852705  0.540246   0.5198185  0.56344324
 0.95304835 0.61002135 0.5783093  0.9276812  0.6100216  0.6597475
 0.55349416 0.5401815  0.54145336 0.84395295 1.0377759  0.5790869
 0.54488117 1.4627686  0.5483657  0.579111   0.7154826  0.8514229
 1.1916777  0.51259726 0.71548206 1.0379481  0.7105381  1.9255464
 0.91723716 0.9988003  0.85143226 1.0377759  0.59599555 0.5947717
 0.5511529  2.1191242  0.5931812  0.5409356  1.7243247  0.6633558
 0.61002153 1.2078222  0.56518114 1.86757    1.2656021  0.5959948
 0.785825   0.59385186 0.8274116  0.5654208  0.98893386 2.5344207
 0.92768776 0.5946897  0.6523129  0.59383297 0.65672904 0.7020372
 0.70444125 1.3759345  0.91486967 2.5548253  0.52416396 0.6100215
 1.4374646  0.9470748  0.94701576 0.57434934 1.3269132  0.580833
 0.9311923  1.4425153  0.57917184 1.1729896  1.4425246  0.96833247
 0.91419524 0.8042368  0.70444167 0.9889129  0.843251   1.4047722
 1.4425558  0.98646504 0.5808328  0.92769295 0.9277186  0.5946704
 0.98896486 1.1334933  1.3103089  0.81960803 0.9277582  1.1053351
 0.9278034  1.105329   0.8415857  1.4425391  0.9072536  2.8746362
 1.6301552  0.9211778  2.0673668  0.9211369  0.9212424  0.9211739
 0.9211226  0.9211511  0.92118376 0.9211627  1.4384614  0.9012152
 0.57450575 0.92127514 0.921113   0.92115587 0.9211274  0.92116433
 0.9211122  0.9211871  0.92115873 0.92111015 1.3964394  0.9217904
 0.9211092  2.1997924  0.9211699  1.3491493  0.60574687 0.92769045
 0.44413665 0.7553523  0.65387183 0.65387183 0.84909666 0.44413665
 0.9277316  0.91414434 0.91468924 0.9276973  0.91504997 0.8155663
 0.8232919  0.9334654  0.9680776  0.92769337 0.94726145 0.92769045
 0.9277583  0.864462   0.9277047  0.9141416  0.9276912  0.92773086
 1.442526   0.91418636 0.92774034 0.9152757  0.9277449  0.92768854
 0.92769945 1.2150189  0.6767315  0.9532015  0.9211111  1.082238
 0.6547565  0.9277481  0.9148417  1.0938591  0.9217846  0.83049405
 1.0022862  0.90535927 0.9276882  0.9276896  0.9692618  1.2163963
 0.92596376 0.92789    1.4384613  0.8941093  0.91426635 1.83023
 0.92111266 0.7975234  1.0491289  0.92115414 0.9227984  1.4384615
 0.892291   0.9277106  1.1612556  0.95912755 1.0576662  1.2163737
 0.6930451  1.3515791  1.3515732  0.57982534 0.56991756 0.92111313
 0.9502174  1.179464   1.2164029  1.052434   0.57291067 0.57844895
 0.9168615  0.91685903 0.916937   0.91691524 0.9168626  1.3549621
 1.165145   0.91685647 0.9184182  0.9211764  0.8895786  0.9211581
 1.3515726  1.1747696  0.9924418  0.60387975 1.3515706  1.0023658
 1.3964345  0.82163125 1.3964326  0.92113227 1.35157    0.69557774
 0.9081422  0.9081936  0.91686314 0.69557726 0.8799719  0.6043201
 0.896719   0.9211244  0.9169197  0.5678986  0.90806335 0.901596
 0.5966648  0.677452   1.3549616  1.8049684  0.65978926 1.9963018
 0.9948574  0.5966664  0.6444518  0.68896383 0.59363425 0.56822586
 1.2670925  0.9024409  1.3052907  0.5966644  0.59666497 0.5966645
 0.58437663 0.58803093 0.5966643  0.5936344  0.59666437 0.5966644
 0.59666556 0.99909616 0.68529284 0.8736551  0.9549034  0.97571856
 0.5394055  0.58156496 0.81643474 2.1949644  0.5939301  0.683694
 0.5707106  1.0966276  1.0963436  0.5936342  1.8106225  0.8382428
 0.5927474  0.9160311  1.5137843  1.9845287  0.6841976  0.68419725
 0.68419707 0.9192979  0.58422405 1.5345886  0.76653    0.7092439
 0.56820244 0.5712245  0.9396075  0.9158005  0.5416407  0.839793
 0.5822597  0.5660543  0.59274733 0.83751553 0.91580003 0.839712
 0.5712202  1.8018929  0.6841974  0.9196136  0.5822747  0.95971465
 1.0969775  0.9193339  0.91930044 0.91923505 0.94094145 3.5080323
 7.0439734  0.6841972  0.7369947  0.91940194 0.8086759  0.96206075
 2.8006341  0.96406764 0.91928875 0.9250534  0.9273508  0.5939537
 1.0760764  0.98721784 2.6506648  0.8674136  1.0823303  0.96197325
 1.2177088  1.1005424  0.91194326 1.1260316  1.3002326  0.59713763
 0.59714943 1.1260669  1.0817828  0.92506105 0.96199936 0.912031
 0.96200114 0.5897551  0.60226846 0.60226864 0.58866495 1.1092982
 0.6022689  0.60226876 0.5897539  0.9258803  0.6022684  0.6022685
 0.93168044 0.60051167 1.028826   0.82778907 0.6022685  0.87624043
 0.9258799  0.6022686  0.60876304 0.59667534 0.58975035 0.59433955
 1.4116956  0.5683021  0.60226864 0.56826997 0.5745283  0.8573068
 0.69759476 0.60226864 1.2922     0.5835731  0.56837404 0.60051626
 0.9486605  0.5834946  0.60876334 0.6205149  0.60245746 1.1209103
 0.60805094 1.120916   0.7668889  0.60049903 0.608051   0.9523932
 0.95238507 2.4462883  0.95242923 0.6947861  0.9384815  1.1078974
 0.96890175 0.60049886 0.9666337  1.5844544  0.8798529  1.5731066
 0.9525021  0.6410787  0.60782254 0.95249265 0.7869446  0.8272133
 0.6410789  0.60050106 0.95240015 1.2537103  0.9523994  0.9526851
 0.9524439  0.61938816 1.3335105  0.61938816 1.0015683  0.6193913
 0.817151   0.81714547 0.81716305 0.9524105  0.95242786 0.9525346
 0.9523953  3.410679   0.9952583  0.6193878  0.9525762  0.95239323
 0.95242125 1.0471865  0.95260054 0.95241046 0.9505074  0.99484855
 0.6352999  2.7076693  0.95066255 0.9524346  0.95240027 0.6734521
 1.3335065  1.2565825  1.2565701  0.9734961  0.7567387  0.6582001
 0.6582073  0.75677246 1.2565786  0.6353017  1.2565701  0.66609764
 0.64326453 1.2565812 ]
2025-06-03 10:10:47,385 - DEBUG - Edge reconstruction errors: [0.15896054 1.6590395  1.6602924  ... 0.15888046 1.2598772  0.15888046]
2025-06-03 10:10:47,386 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101047_update_31.json
2025-06-03 10:10:47,386 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:47,390 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101047_update_31.pth and as latest_checkpoint.pth
2025-06-03 10:10:47,390 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.3262
2025-06-03 10:10:47,390 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:10:47,390 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0251, MLP Score: 0.5097
2025-06-03 10:10:47,390 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0417, MLP Score: 0.4829
2025-06-03 10:10:47,390 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.7559, MLP Score: 0.4648
2025-06-03 10:10:47,391 - WARNING -   Node ID: 192.168.27.10, Recon Error: 8.0938, MLP Score: 0.4641
2025-06-03 10:10:47,391 - WARNING -   Node ID: 199.232.214.172, Recon Error: 3.8371, MLP Score: 0.4947
2025-06-03 10:10:47,391 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:10:47,391 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9754, MLP Score: 0.4936
2025-06-03 10:10:47,391 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3044, MLP Score: 0.5196
2025-06-03 10:10:47,391 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.5309, MLP Score: 0.5189
2025-06-03 10:10:47,391 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.5089, MLP Score: 0.5229
2025-06-03 10:10:47,391 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.0728, MLP Score: 0.3460
2025-06-03 10:10:47,391 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:10:47,391 - INFO - Performing visualization of node and edge features.
2025-06-03 10:10:47,392 - INFO - Starting visualization of node features.
2025-06-03 10:10:47,392 - INFO - Graph has 914 nodes and 30 features.
2025-06-03 10:10:47,392 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:10:47,392 - INFO - Calculating feature statistics:
2025-06-03 10:10:47,392 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,392 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,392 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.93445), 'max': np.float32(2.2855513)}
2025-06-03 10:10:47,392 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(6.677807e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2145884), 'max': np.float32(2.0248365)}
2025-06-03 10:10:47,393 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,393 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,393 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,393 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(3.3389036e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45365706), 'max': np.float32(2.2043083)}
2025-06-03 10:10:47,393 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-3.3389036e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1235552), 'max': np.float32(0.89003193)}
2025-06-03 10:10:47,393 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.4607703e-08), 'std': np.float32(0.99999994), 'min': np.float32(-8.997258), 'max': np.float32(0.11355595)}
2025-06-03 10:10:47,393 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(-1.6694518e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.5599065), 'max': np.float32(1.4289318)}
2025-06-03 10:10:47,393 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(-1.6694518e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4036233), 'max': np.float32(2.6719344)}
2025-06-03 10:10:47,393 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.308534), 'std': np.float32(1.0189632), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:10:47,393 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9606128), 'std': np.float32(0.27789074), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:10:47,393 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14770241), 'std': np.float32(0.37284783), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:47,393 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.405908), 'std': np.float32(0.573301), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:10:47,394 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.4607703e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.11355595), 'max': np.float32(8.997258)}
2025-06-03 10:10:47,394 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3380744), 'std': np.float32(2.9788706), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:10:47,394 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8621445), 'std': np.float32(2.881813), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:47,394 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.608315), 'std': np.float32(1.4924232), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:47,394 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14770241), 'std': np.float32(0.37284783), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:47,394 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9923415), 'std': np.float32(0.23141272), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:10:47,394 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(8.347259e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.12971735), 'max': np.float32(16.03778)}
2025-06-03 10:10:47,394 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.8781332e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.14173667), 'max': np.float32(7.0553365)}
2025-06-03 10:10:47,394 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,394 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,394 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,394 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:10:47,394 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(3.3389036e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9771747), 'max': np.float32(8.909959)}
2025-06-03 10:10:47,394 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-2.5041777e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0728782), 'max': np.float32(4.4987736)}
2025-06-03 10:10:47,407 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c2cf8800>
2025-06-03 10:10:47,719 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:10:47,770 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:10:47,796 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:10:49,058 - INFO - Node feature visualization saved to vis/node_features_20250603_101047.png
2025-06-03 10:10:49,058 - INFO - Finished visualization of node features.
2025-06-03 10:10:49,058 - INFO - Performing additional feature analysis:
2025-06-03 10:10:49,058 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:10:49,059 - INFO - Starting visualization of edge features.
2025-06-03 10:10:49,059 - INFO - Graph has 1945 edges and 10 edge features.
2025-06-03 10:10:49,059 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:49,059 - INFO - Calculating edge feature statistics:
2025-06-03 10:10:49,060 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:10:49,060 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.147558), 'std': np.float32(1.132064), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-03 10:10:49,060 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4118252), 'std': np.float32(0.5055619), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:10:49,060 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.684833), 'std': np.float32(2.166798), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:10:49,060 - INFO - - service: {'name': 'service', 'unique': 33, 'mean': np.float32(-1.961284e-09), 'std': np.float32(1.0), 'min': np.float32(-0.036451437), 'max': np.float32(34.346172)}
2025-06-03 10:10:49,060 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1302, 'mean': np.float32(1.961284e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059303977), 'max': np.float32(31.721727)}
2025-06-03 10:10:49,060 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1386, 'mean': np.float32(-1.961284e-09), 'std': np.float32(1.0), 'min': np.float32(-0.054714676), 'max': np.float32(33.220943)}
2025-06-03 10:10:49,060 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 449, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.0447149), 'max': np.float32(34.190544)}
2025-06-03 10:10:49,060 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1356, 'mean': np.float32(1.961284e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081030734), 'max': np.float32(28.903545)}
2025-06-03 10:10:49,060 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1376, 'mean': np.float32(3.922568e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08141855), 'max': np.float32(28.006592)}
2025-06-03 10:10:49,060 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 499, 'mean': np.float32(1.961284e-09), 'std': np.float32(1.0), 'min': np.float32(-0.053585816), 'max': np.float32(33.547337)}
2025-06-03 10:10:49,072 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c35b5940>
2025-06-03 10:10:49,155 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:10:49,165 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c39d3650>
2025-06-03 10:10:49,247 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:10:49,388 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:10:49,505 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:10:49,517 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:10:49,523 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:10:50,869 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101049.png
2025-06-03 10:10:50,869 - INFO - Finished visualization of edge features.
2025-06-03 10:10:50,869 - INFO - Performing additional edge feature analysis:
2025-06-03 10:10:50,870 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:10:50,871 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:10:50,871 - INFO - Graph has 1945 edges and 10 edge features.
2025-06-03 10:10:50,871 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:10:51,309 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101050_summary.png
2025-06-03 10:10:51,576 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101050_pca_3d.png
2025-06-03 10:10:51,772 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101050_pca_variance.png
2025-06-03 10:10:51,772 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:10:51,772 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-03 10:10:51,772 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-03 10:10:51,772 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-03 10:10:51,800 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-03 10:10:51,822 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-03 10:10:51,822 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-03 10:10:51,823 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-03 10:10:51,844 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-03 10:10:51,867 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-03 10:10:51,867 - INFO - Processing node updates/additions.
2025-06-03 10:10:51,872 - INFO - Processing edge updates/additions.
2025-06-03 10:10:51,885 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:51,886 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:51,886 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:51,887 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:51,897 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-03 10:10:51,903 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:51,912 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-03 10:10:51,914 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-03 10:10:51,915 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:51,919 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:10:51,920 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:51,921 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:10:51,922 - DEBUG - Shape of encoded categorical edge features: torch.Size([1958, 3])
2025-06-03 10:10:51,923 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:51,923 - DEBUG - Shape of scaled numerical edge features: torch.Size([1958, 7])
2025-06-03 10:10:51,923 - DEBUG - Final edge attributes tensor shape: torch.Size([1958, 10])
2025-06-03 10:10:51,923 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:51,926 - INFO - Performing online update...
2025-06-03 10:10:51,926 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:51,927 - DEBUG - Updated RunningStats: new_mean=0.951177798169323, new_var=18000000000161.812, new_n=1830
2025-06-03 10:10:51,927 - DEBUG - Updated RunningStats: new_mean=0.9477727461390848, new_var=18300000000018.074, new_n=1860
2025-06-03 10:10:51,927 - DEBUG - Updated RunningStats: new_mean=1.1721655203673833, new_var=6000000000093.664, new_n=610
2025-06-03 10:10:51,927 - DEBUG - Updated RunningStats: new_mean=1.1706884779279418, new_var=6100000000001.647, new_n=620
2025-06-03 10:10:51,927 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:51,927 - DEBUG - Online update step: 1/50
2025-06-03 10:10:51,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 2/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 3/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 4/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 5/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 6/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 7/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 8/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 9/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 10/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 11/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 12/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 13/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 14/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 15/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 16/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 17/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 18/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 19/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 20/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 21/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 22/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,928 - DEBUG - Online update step: 23/50
2025-06-03 10:10:51,928 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 24/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 25/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 26/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 27/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 28/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 29/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 30/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 31/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 32/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 33/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 34/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 35/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 36/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 37/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 38/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 39/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 40/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 41/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 42/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 43/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 44/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 45/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,929 - DEBUG - Online update step: 46/50
2025-06-03 10:10:51,929 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,930 - DEBUG - Online update step: 47/50
2025-06-03 10:10:51,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,930 - DEBUG - Online update step: 48/50
2025-06-03 10:10:51,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,930 - DEBUG - Online update step: 49/50
2025-06-03 10:10:51,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,930 - DEBUG - Online update step: 50/50
2025-06-03 10:10:51,930 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 10:10:51,930 - WARNING - No successful steps during online update.
2025-06-03 10:10:51,930 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  6.2851086e-08 -8.8303178e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.5061557e-08
  4.6229310e-08 -2.1816080e-08 -3.4282412e-08  8.3108871e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.7660636e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00 -5.4540199e-09  1.8699497e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.7525958e-09  3.2204689e-08], current edge mean: [ 9.1465778e+00  1.4101124e+00  5.6848826e+00 -1.4611966e-09
  1.7047294e-09  4.8706554e-09 -1.4611966e-09  9.7413111e-10
 -1.9482622e-09  4.8706555e-10]
2025-06-03 10:10:51,930 - DEBUG - Node drift difference: 0.0134, Edge drift difference: 0.0034
2025-06-03 10:10:51,931 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  6.2851086e-08 -8.8303178e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.5061557e-08
  4.6229310e-08 -2.1816080e-08 -3.4282412e-08  8.3108871e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.7660636e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00 -5.4540199e-09  1.8699497e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.7525958e-09  3.2204689e-08], edge=[ 9.1465778e+00  1.4101124e+00  5.6848826e+00 -1.4611966e-09
  1.7047294e-09  4.8706554e-09 -1.4611966e-09  9.7413111e-10
 -1.9482622e-09  4.8706555e-10]
2025-06-03 10:10:51,931 - DEBUG - Updated reference std: node=[0.         0.         1.0005451  1.0005451  0.         0.
 0.         1.0005451  1.0005451  1.0005451  1.0005451  1.0005451
 1.0198451  0.27744794 0.36818114 0.57352495 1.000545   2.9750328
 2.8805428  1.5016054  0.36818114 0.23103443 1.0005451  1.0005451
 0.         0.         0.         0.         1.0005451  1.000545  ], edge=[1.1286514  0.50530136 2.170148   1.0002555  1.0002555  1.0002555
 1.0002555  1.0002555  1.0002555  1.0002555 ]
2025-06-03 10:10:51,931 - INFO - Online update complete. Loss: 0.0000
2025-06-03 10:10:51,931 - INFO - Running anomaly detection...
2025-06-03 10:10:51,932 - INFO - Starting anomaly detection.
2025-06-03 10:10:52,420 - DEBUG - Node reconstruction errors: [1.3647044  1.132001   1.278852   0.5747235  1.3479749  3.0445588
 2.7129638  1.2275128  1.7867261  0.79785043 1.5403029  0.72708833
 0.94107544 1.0314178  1.1521147  1.8180544  1.3875979  0.84417206
 0.719512   1.3147885  0.8441748  1.260759   1.0724769  2.2456937
 3.0496907  1.326224   0.72140706 1.1146194  0.8441732  1.1255995
 0.6949713  1.3262457  1.8308389  2.6408782  1.8841172  2.6725323
 4.759517   1.0970914  1.8536189  1.1781651  1.1484234  1.2138821
 2.7548778  1.0314132  1.6843815  1.1505607  8.107865   1.6441222
 1.5688207  1.1116942  3.8579829  1.072501   1.0624528  1.0970922
 1.326204   1.0604066  1.163615   0.87705046 2.605695   2.0715384
 5.205229   1.9035621  2.8659544  0.88473094 1.873434   0.74576604
 2.4265258  1.0724772  1.1119796  1.2911694  1.6929708  0.93600464
 2.8295438  1.2150656  5.17954    1.2896118  1.1116945  1.294092
 1.9719169  1.1393542  1.0717133  0.9308777  0.94400185 1.066296
 1.0667323  1.1863347  0.6213856  2.8435037  1.0097198  1.34469
 0.6650419  2.6787317  1.4888319  1.1335148  0.8587868  3.7831273
 0.6553535  0.9999206  0.9662416  0.7570289  1.404225   0.6553534
 0.57672507 1.1113904  1.5927726  0.83527535 1.3958145  1.3341814
 1.3603013  1.0234087  1.2724124  0.5597708  2.4260907  2.6864142
 1.2252291  1.0397556  1.1979771  2.2849708  0.9401804  0.85338587
 0.63811654 1.5352745  2.2458718  1.5406977  0.8454739  0.8534325
 1.530395   1.4618422  1.1082736  0.87615305 0.8390065  0.60116726
 2.3379557  2.459377   1.1512808  0.6997868  0.8392565  0.98330253
 1.1659092  1.8643014  0.58623403 1.2012647  0.6287173  0.58406585
 0.61236477 1.0470288  1.197985   0.71835864 0.9596993  0.83847183
 1.5094081  1.8190968  1.5454048  0.601168   2.205736   2.7602944
 0.7104837  1.338146   1.404224   0.5864322  0.5895551  1.2230031
 0.7104774  0.83932    1.3521973  1.8570825  1.7177829  1.1202444
 1.2538568  0.8386351  1.2582318  0.8441225  0.66565377 3.4006648
 0.94018424 0.66507924 1.1604389  1.2505771  1.3295789  1.3295784
 0.81714475 1.5403924  0.7722636  2.2822144  2.743183   0.92324364
 0.61513484 1.3032871  0.68661803 0.6979477  1.0446609  0.9125818
 0.69596285 0.74622095 1.1657702  0.5958445  3.3056827  0.71153706
 2.3238256  0.7998608  0.86991006 0.71064913 2.379133   1.0965582
 0.924814   1.3480623  0.9758333  2.5014665  0.95207024 1.492167
 1.280738   1.1750491  0.63044685 1.1941456  0.75390244 0.71558183
 1.1032639  1.1979768  1.4053041  0.74620265 3.0276809  0.61513543
 0.6533775  0.6304472  0.7104514  0.9695016  1.9367789  0.7679389
 1.1914705  1.3238262  1.5089496  0.9781139  1.1290836  1.1979877
 1.1979784  0.67450815 1.0413073  0.65337735 0.7105316  0.78057736
 2.4098306  1.2270718  0.62264436 0.75649154 0.74974763 0.7633468
 1.2064736  0.8515612  0.6226443  0.6567516  0.6656535  0.7637777
 1.4052917  1.1371722  1.236649   1.1456848  0.6943312  0.9298489
 0.7689315  1.3295782  1.3467048  1.8061937  0.6418402  0.8175897
 1.0909044  0.84123355 1.4045001  4.8441997  1.404536   1.3533806
 2.0645263  2.2079694  1.2806153  0.9141986  1.6421931  1.075661
 0.72249955 1.1925243  0.8172161  0.92666596 3.653997   0.7365658
 0.9271812  0.8527467  1.0195147  0.85636353 2.6874402  1.4639442
 1.5403924  1.105723   0.8066222  0.63674086 0.91228896 0.74972767
 1.3980072  0.9204004  1.1817693  1.3299906  0.5957826  1.6628652
 1.0533642  0.9588188  1.5724359  1.1131684  0.95881546 0.9588145
 0.9588145  1.6246436  0.97106373 0.95881635 0.9588142  2.1203468
 0.95881474 0.68223286 1.6297143  1.2186264  1.0824172  1.502
 0.6248592  0.59068406 1.2012787  0.79267675 1.0073249  1.572437
 1.3111656  2.24208    0.97707665 1.2953912  1.476842   1.4768494
 1.4158111  0.59641635 0.9588273  1.642194   0.9588145  1.6246411
 0.83039564 0.7504942  0.95312697 0.95312816 1.0119036  0.75792193
 0.95312715 1.1132789  1.0837283  1.1032876  1.5724386  0.8471445
 1.4408116  1.1446807  0.95883244 1.1317047  2.6865697  1.1515299
 0.7507397  0.6943352  0.92217    0.9588142  0.9696837  2.771317
 1.018465   0.94119793 1.0189651  1.1235155  1.5725359  3.7701437
 0.62502205 2.6051574  1.1090409  1.0270423  1.1974809  1.0841335
 0.9991997  2.1295567  1.1114404  1.1514823  0.6414252  1.0021352
 2.108641   0.9588145  1.5724353  1.2412738  0.56430554 0.88408357
 1.1998655  0.8334928  0.66704965 1.5980533  1.5499262  0.9588169
 1.1898122  0.8912946  1.2011513  1.8104676  1.4851266  1.4849938
 1.484848   2.0604334  0.9468273  1.9487978  0.676524   1.0810336
 1.4850253  0.9468215  1.295769   1.2012866  1.0901083  0.6552061
 1.2011495  1.3091388  1.4849356  1.2011495  0.9468226  1.485032
 1.4849489  0.59379876 0.74936646 1.48484    0.6407404  0.6075957
 0.6498474  0.65408593 1.0123856  0.5654491  1.991512   0.64989483
 0.6630998  0.9530698  1.5244812  1.4908053  1.3247801  0.7938275
 1.3569527  0.9965343  1.4848292  1.485003   0.6761091  0.8647585
 2.0228732  0.88132846 0.5937244  0.9798467  0.9151122  0.5867637
 0.6162603  2.0484655  1.7900895  0.54971844 0.5276776  0.5730534
 0.96631515 0.61884713 0.58708    0.93688685 0.61884683 0.6696768
 0.5622985  0.5453752  0.54808086 0.89911485 1.0516118  0.58773917
 0.5536171  1.470856   0.5569794  0.5877624  0.72487617 0.8636986
 1.2030886  0.5196599  0.7248762  1.051782   0.72369766 1.9503163
 0.9278467  1.0133375  0.86370766 1.0516115  0.6049982  0.6032909
 0.55849725 2.1471903  0.59866554 0.550387   1.7425668  0.6721185
 0.618847   1.2211297  0.57213223 1.8895725  1.2828816  0.604998
 0.79885197 0.60272527 0.8356308  0.5742141  1.0026846  2.540742
 0.9368928  0.60321057 0.6611548  0.60270715 0.66190475 0.7120412
 0.7141314  1.3844429  0.9242591  2.5740955  0.5318468  0.61884713
 1.4356349  0.95832133 0.95826256 0.58261764 1.1984845  0.5869621
 0.94056183 1.458648   0.586084   1.1884414  1.4586557  0.97922117
 0.9236111  0.8084195  0.71413165 1.0026624  0.8512789  1.4151723
 1.4586889  1.0000336  0.58696204 0.9368989  0.93692344 0.60319215
 1.002716   1.1491249  1.3253741  0.8330893  0.93696237 1.119841
 0.93700695 1.1198344  0.8610989  1.4586715  0.9180915  2.8736281
 1.642795   0.9306688  2.0764372  0.93063086 0.9307364  0.9306667
 0.9306156  0.93064505 0.9306754  0.93065494 1.4545239  0.91302073
 0.58130795 0.9307635  0.9306076  0.93064845 0.9306214  0.93065834
 0.9306071  0.93068    0.93065155 0.9306051  1.413233   0.93127877
 0.9306037  2.2168229  0.9306638  1.3544633  0.61310863 0.936896
 0.45048645 0.7664539  0.65577614 0.65577614 0.8616657  0.45048645
 0.93693554 0.9235638  0.92409056 0.936903   0.9244468  0.82396114
 0.8339559  0.9429244  0.9789674  0.9368994  0.9585002  0.93689704
 0.9369639  0.867946   0.9369105  0.92356044 0.9368973  0.9369349
 1.4586582  0.9236028  0.93694466 0.924686   0.93694806 0.93689436
 0.93690556 1.2301254  0.6827504  0.96732765 0.93060565 1.0942785
 0.6610735  0.9369535  0.9242363  1.1094208  0.931257   0.83803624
 1.011595   0.91481113 0.93689305 0.93689543 0.98465    1.2313005
 0.9409805  0.93708897 1.4545234  0.9030085  0.9236816  1.8426025
 0.93060774 0.81229126 1.059887   0.93064654 0.932228   1.4545239
 0.90125054 0.9369155  1.1727656  0.9725187  1.0713056  1.231278
 0.69943434 1.3676362  1.3676307  0.5881985  0.57737327 0.930608
 0.9608403  1.1960014  1.2313069  1.0680697  0.57957304 0.583643
 0.92655647 0.9265546  0.926631   0.9266091  0.9265574  1.3721622
 1.1809344  0.92655116 0.9281047  0.9306701  0.89825517 0.93064934
 1.3676308  1.190174   1.0034226  0.61243093 1.3676283  1.0176748
 1.4132293  0.8303171  1.4132289  0.9306248  1.367628   0.70550627
 0.91777074 0.9178201  0.9265588  0.70550567 0.8947756  0.6248852
 0.9035053  0.93061763 0.9266137  0.59195286 0.91769314 0.910799
 0.6058541  0.6815233  1.3721623  1.8219972  0.6692221  2.0141723
 1.0102707  0.6058558  0.6553108  0.6990555  0.60280645 0.5757728
 1.283801   0.90783054 1.3216434  0.60585415 0.6058542  0.6058542
 0.5934811  0.5919521  0.6058542  0.60280645 0.6058542  0.60585403
 0.605855   1.0141536  0.6954035  0.88548416 0.969565   0.9905521
 0.54912746 0.585996   0.82955456 2.206214   0.60301393 0.6939015
 0.57770616 1.1091639  1.1088808  0.60280645 1.823098   0.8494147
 0.6018572  0.9256762  1.5146612  2.0004227  0.69429165 0.69429135
 0.69429135 0.92873317 0.59303206 1.541741   0.77304006 0.71939194
 0.57505834 0.57908285 0.95174724 0.92545426 0.5508958  0.85238844
 0.5911725  0.5744392  0.60185707 0.848695   0.9254547  0.8523077
 0.5790788  1.811363   0.6942912  0.92903745 0.5911858  0.97196954
 1.1096709  0.928768   0.9287364  0.9286724  1.7496134  3.5036266
 7.0709534  0.6942912  0.7487371  0.9288321  0.8217284  0.9743402
 2.8058767  0.9763182  0.92872465 0.9343435  0.9373611  0.60303885
 1.0838994  0.9994187  2.6676636  0.8753831  1.0233322  0.97425705
 1.2321095  1.1129653  0.9182314  1.1388392  1.3143269  0.6059132
 0.6059238  2.142287   1.0916111  0.9343502  0.97428197 0.9183169
 0.97428304 0.5970404  0.6108315  0.6108313  0.5971143  1.1182256
 0.597091   0.6108315  0.5970385  0.93260276 0.6108315  0.6108315
 0.9409006  0.60737884 1.0372695  0.8356015  0.61083156 0.8871091
 0.932604   0.6108312  0.6168496  0.57514364 0.5948552  0.5948549
 1.4190061  0.575139   0.61083126 0.5751087  0.58247435 0.86462015
 0.7046306  0.6108315  1.302834   0.59222007 0.5752085  0.607383
 0.9574238  0.59214467 0.6168501  0.62639445 0.6093036  1.1323698
 0.6168116  1.1323749  0.77347255 0.60612875 0.6168111  0.9592026
 0.959195   2.452511   0.9592391  0.6993497  0.9472544  1.1186084
 0.9790718  0.6061285  0.97684497 1.5888124  0.88787425 1.577752
 0.9593107  0.64510655 0.6127659  0.9592997  0.7930409  0.8349003
 0.6497487  0.60613036 0.95921004 1.2640971  0.9592089  0.9594878
 0.9592537  0.6262171  1.3432838  0.6262171  1.0119917  0.62621933
 0.90876174 0.825794   0.9087691  0.9592196  0.9592377  0.9593426
 0.95920455 3.43226    1.0058038  0.626217   0.9593832  0.9592026
 0.9592315  1.0573181  0.9594036  0.9592191  0.95580035 1.0054021
 0.6404406  2.720786   0.9559515  0.9592438  0.95921046 0.6768291
 1.2408295  1.2648675  1.2648549  0.978676   0.755476   0.66338426
 0.64281476 0.7639049  1.2648643  0.6404425  1.2648562  0.6713589
 0.6415459  1.2648662  1.0013855  0.64044076 0.7878252  0.97864634]
2025-06-03 10:10:52,421 - DEBUG - Edge reconstruction errors: [0.1591001  1.6591784  1.6603864  ... 0.15902431 1.2599771  0.15902431]
2025-06-03 10:10:52,480 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101052_update_32.json
2025-06-03 10:10:52,480 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:10:52,489 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101052_update_32.pth and as latest_checkpoint.pth
2025-06-03 10:10:52,489 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.3269
2025-06-03 10:10:52,489 - WARNING - Detected 22 anomalous nodes (reconstruction-based):
2025-06-03 10:10:52,489 - WARNING -   Node ID: 142.250.71.227, Recon Error: 3.0446, MLP Score: 0.5102
2025-06-03 10:10:52,489 - WARNING -   Node ID: 162.159.61.3, Recon Error: 3.0497, MLP Score: 0.4833
2025-06-03 10:10:52,489 - WARNING -   Node ID: 192.168.27.12, Recon Error: 4.7595, MLP Score: 0.4645
2025-06-03 10:10:52,489 - WARNING -   Node ID: 192.168.27.10, Recon Error: 8.1079, MLP Score: 0.4638
2025-06-03 10:10:52,489 - WARNING -   Node ID: 199.232.214.172, Recon Error: 3.8580, MLP Score: 0.4952
2025-06-03 10:10:52,489 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 10:10:52,489 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.2162, MLP Score: 0.4925
2025-06-03 10:10:52,489 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4211, MLP Score: 0.5169
2025-06-03 10:10:52,489 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4156, MLP Score: 0.5216
2025-06-03 10:10:52,489 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1331, MLP Score: 0.3457
2025-06-03 10:10:52,490 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.1371, MLP Score: 0.4052
2025-06-03 10:10:52,490 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-03 10:10:52,490 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-03 10:10:52,490 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-03 10:10:52,547 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-03 10:10:52,595 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-03 10:10:52,595 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-03 10:10:52,595 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-03 10:10:52,636 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-03 10:10:52,679 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-03 10:10:52,679 - INFO - Processing node updates/additions.
2025-06-03 10:10:52,685 - INFO - Processing edge updates/additions.
2025-06-03 10:10:52,700 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:10:52,702 - INFO - Finished updating NetworkX graph.
2025-06-03 10:10:52,702 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:10:52,703 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:10:52,715 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-03 10:10:52,720 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:10:52,729 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-03 10:10:52,731 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-03 10:10:52,732 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:10:52,737 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:10:52,738 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:10:52,739 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:10:52,741 - DEBUG - Shape of encoded categorical edge features: torch.Size([1981, 3])
2025-06-03 10:10:52,742 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:10:52,742 - DEBUG - Shape of scaled numerical edge features: torch.Size([1981, 7])
2025-06-03 10:10:52,743 - DEBUG - Final edge attributes tensor shape: torch.Size([1981, 10])
2025-06-03 10:10:52,743 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:10:52,748 - INFO - Performing online update...
2025-06-03 10:10:52,748 - INFO - Starting online update for 50 steps.
2025-06-03 10:10:52,749 - DEBUG - Updated RunningStats: new_mean=0.9511060829826549, new_var=18600000000161.617, new_n=1890
2025-06-03 10:10:52,749 - DEBUG - Updated RunningStats: new_mean=0.9478172191336539, new_var=18900000000018.105, new_n=1920
2025-06-03 10:10:52,749 - DEBUG - Updated RunningStats: new_mean=1.177877937483763, new_var=6200000000093.531, new_n=630
2025-06-03 10:10:52,749 - DEBUG - Updated RunningStats: new_mean=1.1763536716479566, new_var=6300000000001.666, new_n=640
2025-06-03 10:10:52,749 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:10:52,749 - DEBUG - Online update step: 1/50
2025-06-03 10:10:52,758 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:10:53,986 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:10:54,013 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:10:54,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:54,784 - DEBUG - Step 1: Loss=1.4586
2025-06-03 10:10:54,784 - DEBUG - Online update step: 2/50
2025-06-03 10:10:54,793 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:10:55,326 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:10:55,336 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:10:55,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:55,984 - DEBUG - Step 2: Loss=1.0030
2025-06-03 10:10:55,984 - DEBUG - Online update step: 3/50
2025-06-03 10:10:55,986 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:10:56,572 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:10:56,582 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:10:56,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:57,161 - DEBUG - Step 3: Loss=1.0174
2025-06-03 10:10:57,161 - DEBUG - Online update step: 4/50
2025-06-03 10:10:57,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:10:57,789 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:10:57,799 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:10:57,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:58,497 - DEBUG - Step 4: Loss=0.8888
2025-06-03 10:10:58,497 - DEBUG - Online update step: 5/50
2025-06-03 10:10:58,499 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:10:58,982 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:10:58,992 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:10:58,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:10:59,549 - DEBUG - Step 5: Loss=0.9120
2025-06-03 10:10:59,550 - DEBUG - Online update step: 6/50
2025-06-03 10:10:59,552 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:00,076 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:00,087 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:00,088 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:00,638 - DEBUG - Step 6: Loss=0.9349
2025-06-03 10:11:00,638 - DEBUG - Online update step: 7/50
2025-06-03 10:11:00,640 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:01,103 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:01,113 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:01,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:01,640 - DEBUG - Step 7: Loss=0.8679
2025-06-03 10:11:01,640 - DEBUG - Online update step: 8/50
2025-06-03 10:11:01,643 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:02,113 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:02,123 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:02,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:02,757 - DEBUG - Step 8: Loss=0.8466
2025-06-03 10:11:02,757 - DEBUG - Online update step: 9/50
2025-06-03 10:11:02,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:03,445 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:03,465 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:03,466 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:04,338 - DEBUG - Step 9: Loss=0.8444
2025-06-03 10:11:04,338 - DEBUG - Online update step: 10/50
2025-06-03 10:11:04,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:04,978 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:05,020 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:05,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:05,841 - DEBUG - Step 10: Loss=0.8331
2025-06-03 10:11:05,842 - DEBUG - Online update step: 11/50
2025-06-03 10:11:05,848 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:06,372 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:06,382 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:06,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:06,944 - DEBUG - Step 11: Loss=0.8199
2025-06-03 10:11:06,944 - DEBUG - Online update step: 12/50
2025-06-03 10:11:06,947 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:07,465 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:07,482 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:07,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:08,131 - DEBUG - Step 12: Loss=0.8103
2025-06-03 10:11:08,131 - DEBUG - Online update step: 13/50
2025-06-03 10:11:08,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:08,624 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:08,635 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:08,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:09,178 - DEBUG - Step 13: Loss=0.7999
2025-06-03 10:11:09,179 - DEBUG - Online update step: 14/50
2025-06-03 10:11:09,181 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:09,672 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:09,682 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:09,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:10,298 - DEBUG - Step 14: Loss=0.7898
2025-06-03 10:11:10,298 - DEBUG - Online update step: 15/50
2025-06-03 10:11:10,301 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:10,791 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:10,802 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:10,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:11,346 - DEBUG - Step 15: Loss=0.7851
2025-06-03 10:11:11,346 - DEBUG - Online update step: 16/50
2025-06-03 10:11:11,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:11,901 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:11,911 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:11,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:12,552 - DEBUG - Step 16: Loss=0.7745
2025-06-03 10:11:12,552 - DEBUG - Online update step: 17/50
2025-06-03 10:11:12,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:13,083 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:13,098 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:13,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:13,708 - DEBUG - Step 17: Loss=0.7658
2025-06-03 10:11:13,708 - DEBUG - Online update step: 18/50
2025-06-03 10:11:13,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:14,214 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:14,225 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:14,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:14,770 - DEBUG - Step 18: Loss=0.7608
2025-06-03 10:11:14,770 - DEBUG - Online update step: 19/50
2025-06-03 10:11:14,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:15,297 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:15,310 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:15,312 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:15,906 - DEBUG - Step 19: Loss=0.7519
2025-06-03 10:11:15,906 - DEBUG - Online update step: 20/50
2025-06-03 10:11:15,909 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:16,409 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:16,419 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:16,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:17,093 - DEBUG - Step 20: Loss=0.7438
2025-06-03 10:11:17,093 - DEBUG - Online update step: 21/50
2025-06-03 10:11:17,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:17,689 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:17,703 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:17,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:18,596 - DEBUG - Step 21: Loss=0.7408
2025-06-03 10:11:18,596 - DEBUG - Online update step: 22/50
2025-06-03 10:11:18,599 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:20,191 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:20,287 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:20,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:23,026 - DEBUG - Step 22: Loss=0.7346
2025-06-03 10:11:23,030 - DEBUG - Online update step: 23/50
2025-06-03 10:11:23,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:24,950 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:24,962 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:24,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:25,599 - DEBUG - Step 23: Loss=0.7277
2025-06-03 10:11:25,599 - DEBUG - Online update step: 24/50
2025-06-03 10:11:25,602 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:26,113 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:26,124 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:26,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:26,701 - DEBUG - Step 24: Loss=0.7201
2025-06-03 10:11:26,701 - DEBUG - Online update step: 25/50
2025-06-03 10:11:26,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:27,207 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:27,218 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:27,219 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:27,813 - DEBUG - Step 25: Loss=0.7161
2025-06-03 10:11:27,813 - DEBUG - Online update step: 26/50
2025-06-03 10:11:27,816 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:28,383 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:28,393 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:28,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:29,025 - DEBUG - Step 26: Loss=0.7126
2025-06-03 10:11:29,025 - DEBUG - Online update step: 27/50
2025-06-03 10:11:29,028 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:29,540 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:29,550 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:29,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:30,198 - DEBUG - Step 27: Loss=0.7042
2025-06-03 10:11:30,199 - DEBUG - Online update step: 28/50
2025-06-03 10:11:30,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:30,728 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:30,738 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:30,739 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:31,318 - DEBUG - Step 28: Loss=0.7000
2025-06-03 10:11:31,318 - DEBUG - Online update step: 29/50
2025-06-03 10:11:31,321 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:31,845 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:31,855 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:31,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:33,052 - DEBUG - Step 29: Loss=0.6996
2025-06-03 10:11:33,052 - DEBUG - Online update step: 30/50
2025-06-03 10:11:33,055 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:33,588 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:33,598 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:33,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:34,228 - DEBUG - Step 30: Loss=0.6911
2025-06-03 10:11:34,228 - DEBUG - Online update step: 31/50
2025-06-03 10:11:34,231 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:34,735 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:34,745 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:34,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:35,303 - DEBUG - Step 31: Loss=0.6903
2025-06-03 10:11:35,303 - DEBUG - Online update step: 32/50
2025-06-03 10:11:35,306 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:35,830 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:35,842 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:35,843 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:36,459 - DEBUG - Step 32: Loss=0.6840
2025-06-03 10:11:36,460 - DEBUG - Online update step: 33/50
2025-06-03 10:11:36,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:36,971 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:36,980 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:36,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:37,604 - DEBUG - Step 33: Loss=0.6824
2025-06-03 10:11:37,605 - DEBUG - Online update step: 34/50
2025-06-03 10:11:37,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:38,263 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:38,283 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:38,285 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:39,693 - DEBUG - Step 34: Loss=0.6776
2025-06-03 10:11:39,694 - DEBUG - Online update step: 35/50
2025-06-03 10:11:39,701 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:41,898 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:41,928 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:41,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:42,604 - DEBUG - Step 35: Loss=0.6744
2025-06-03 10:11:42,604 - DEBUG - Online update step: 36/50
2025-06-03 10:11:42,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:43,086 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:43,097 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:43,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:43,658 - DEBUG - Step 36: Loss=0.6727
2025-06-03 10:11:43,658 - DEBUG - Online update step: 37/50
2025-06-03 10:11:43,661 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:44,162 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:44,172 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:44,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:44,714 - DEBUG - Step 37: Loss=0.6670
2025-06-03 10:11:44,715 - DEBUG - Online update step: 38/50
2025-06-03 10:11:44,718 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:45,234 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:45,244 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:45,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:45,805 - DEBUG - Step 38: Loss=0.6653
2025-06-03 10:11:45,805 - DEBUG - Online update step: 39/50
2025-06-03 10:11:45,807 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:46,329 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:46,339 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:46,341 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:46,904 - DEBUG - Step 39: Loss=0.6618
2025-06-03 10:11:46,904 - DEBUG - Online update step: 40/50
2025-06-03 10:11:46,907 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:47,391 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:47,401 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:47,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:48,036 - DEBUG - Step 40: Loss=0.6591
2025-06-03 10:11:48,036 - DEBUG - Online update step: 41/50
2025-06-03 10:11:48,038 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:48,516 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:48,526 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:48,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:49,173 - DEBUG - Step 41: Loss=0.6557
2025-06-03 10:11:49,174 - DEBUG - Online update step: 42/50
2025-06-03 10:11:49,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:49,702 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:49,711 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:49,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:50,253 - DEBUG - Step 42: Loss=0.6537
2025-06-03 10:11:50,253 - DEBUG - Online update step: 43/50
2025-06-03 10:11:50,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:50,739 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:50,750 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:50,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:51,309 - DEBUG - Step 43: Loss=0.6515
2025-06-03 10:11:51,309 - DEBUG - Online update step: 44/50
2025-06-03 10:11:51,312 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:51,811 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:51,821 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:51,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:52,378 - DEBUG - Step 44: Loss=0.6494
2025-06-03 10:11:52,378 - DEBUG - Online update step: 45/50
2025-06-03 10:11:52,381 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:52,868 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:52,878 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:52,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:53,429 - DEBUG - Step 45: Loss=0.6471
2025-06-03 10:11:53,429 - DEBUG - Online update step: 46/50
2025-06-03 10:11:53,432 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:53,964 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:53,974 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:53,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:54,528 - DEBUG - Step 46: Loss=0.6447
2025-06-03 10:11:54,528 - DEBUG - Online update step: 47/50
2025-06-03 10:11:54,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:55,054 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:55,064 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:55,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:55,616 - DEBUG - Step 47: Loss=0.6433
2025-06-03 10:11:55,616 - DEBUG - Online update step: 48/50
2025-06-03 10:11:55,619 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:56,192 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:56,204 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:56,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:56,840 - DEBUG - Step 48: Loss=0.6413
2025-06-03 10:11:56,840 - DEBUG - Online update step: 49/50
2025-06-03 10:11:56,842 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:57,407 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:57,417 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:57,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:58,118 - DEBUG - Step 49: Loss=0.6399
2025-06-03 10:11:58,119 - DEBUG - Online update step: 50/50
2025-06-03 10:11:58,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:11:59,225 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:11:59,254 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:11:59,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:11:59,851 - DEBUG - Step 50: Loss=0.6386
2025-06-03 10:11:59,851 - INFO - Online update finished. Average loss: 0.7551, Learning rate: 0.001000
2025-06-03 10:11:59,852 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  3.62023869e-08 -1.29294238e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.31880125e-08
  6.56814763e-08 -3.46508564e-08  0.00000000e+00  4.13741574e-09
  2.30802608e+00  2.96095443e+00  1.44251630e-01  4.40780926e+00
  3.46508564e-08  3.31561828e+00  5.86117125e+00  7.59869862e+00
  1.44251630e-01  7.99240780e+00  4.13741574e-09 -9.30918542e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  2.04284891e-08 -3.36165016e-08], current edge mean: [ 9.1448765e+00  1.4124180e+00  5.6789498e+00 -1.9256423e-09
 -1.2035264e-09 -3.8512846e-09  0.0000000e+00 -6.7397479e-09
 -4.3326951e-09 -3.3698739e-09]
2025-06-03 10:11:59,852 - DEBUG - Node drift difference: 0.0042, Edge drift difference: 0.0046
2025-06-03 10:11:59,853 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  3.62023869e-08 -1.29294238e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -1.31880125e-08
  6.56814763e-08 -3.46508564e-08  0.00000000e+00  4.13741574e-09
  2.30802608e+00  2.96095443e+00  1.44251630e-01  4.40780926e+00
  3.46508564e-08  3.31561828e+00  5.86117125e+00  7.59869862e+00
  1.44251630e-01  7.99240780e+00  4.13741574e-09 -9.30918542e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  2.04284891e-08 -3.36165016e-08], edge=[ 9.1448765e+00  1.4124180e+00  5.6789498e+00 -1.9256423e-09
 -1.2035264e-09 -3.8512846e-09  0.0000000e+00 -6.7397479e-09
 -4.3326951e-09 -3.3698739e-09]
2025-06-03 10:11:59,853 - DEBUG - Updated reference std: node=[0.         0.         1.0005428  1.0005428  0.         0.
 0.         1.0005426  1.0005426  1.0005428  1.0005428  1.0005428
 1.0201662  0.2768568  0.3696031  0.5732584  1.0005428  2.978598
 2.8835957  1.5098369  0.3696031  0.23053272 1.0005428  1.0005428
 0.         0.         0.         0.         1.0005428  1.0005428 ], edge=[1.1221868 0.5055523 2.1737428 1.0002525 1.0002525 1.0002525 1.0002525
 1.0002525 1.0002525 1.0002525]
2025-06-03 10:11:59,856 - INFO - Online update complete. Loss: 0.7551
2025-06-03 10:11:59,856 - INFO - Running anomaly detection...
2025-06-03 10:11:59,857 - INFO - Starting anomaly detection.
2025-06-03 10:11:59,894 - DEBUG - Node reconstruction errors: [0.06303703 0.05937081 0.07013632 0.0132137  0.03809784 0.45732167
 0.12357353 0.08352152 0.0970751  0.06923946 0.04728528 0.01224918
 0.15389232 0.0069205  0.08804724 0.08038054 0.18992585 0.02950862
 0.01012414 0.26536778 0.02950865 0.03328652 0.00950968 0.05837058
 0.12381952 0.03832565 0.01515197 0.13363995 0.02950863 0.05241979
 0.01488403 0.03832565 0.02438455 0.06840817 0.0385296  0.11909137
 0.17024897 0.00885912 0.49705732 0.09363483 0.02474396 0.16248019
 0.072295   0.00692049 0.05024303 0.20583074 0.76574326 0.03572661
 0.05158102 0.02504261 0.16884011 0.00950968 0.00790823 0.00885911
 0.03832566 0.02948884 0.02474643 0.07059829 0.24773039 0.05157186
 0.18445805 0.03733598 0.3165622  0.01760438 0.10230435 0.01671227
 0.09096348 0.00950969 0.02504263 0.03511024 0.13717312 0.0691622
 0.16284972 0.08211853 1.3525859  0.3652142  0.02504261 0.16436893
 0.24476725 0.12011026 0.20740107 0.01840903 0.18227498 0.16152185
 0.1615219  0.0416675  0.01624706 0.10569351 0.3141548  0.18479271
 0.00542121 0.08903987 0.01998023 0.11774895 0.0840141  0.16609482
 0.01120474 0.08340204 0.00432594 0.17873792 0.03542233 0.01120473
 0.01456597 0.24137029 0.04653395 0.02479172 0.07246971 0.04903372
 0.0219524  0.2308649  0.24835083 0.01432592 0.08209587 0.17059071
 0.03753215 0.04645753 0.03394977 0.08298021 0.10381678 0.01055557
 0.00526796 0.01676088 0.127806   0.01496377 0.09884009 0.01055505
 0.02466157 0.0540754  0.10522965 0.02484949 0.01630257 0.00859887
 0.07418825 0.2011238  0.03444003 0.02558235 0.02296164 0.00479732
 0.13238549 0.04885144 0.11561899 0.07504248 0.00763961 0.06525648
 0.11562264 0.1522725  0.03394973 0.2157635  0.10239673 0.10878618
 0.4731727  0.05705111 0.07290664 0.00859888 0.05917574 0.06834359
 0.00671643 0.04763741 0.03542236 0.01303424 0.1156096  0.03739012
 0.00671645 0.01630259 0.03415513 0.04888295 0.0360942  0.05912811
 0.03721644 0.1087951  0.07282925 0.01377155 0.00527075 0.11046027
 0.10381761 0.11659444 0.05976691 0.0623927  0.03270163 0.03270165
 0.02389821 0.0399962  0.08676931 0.17476861 0.06043106 0.06223256
 0.00666476 0.03401531 0.02470361 0.00614998 0.06754107 0.1047581
 0.09287436 0.00965526 0.13238792 0.01309533 0.48755366 0.13006063
 0.09931747 0.13091971 0.01192109 0.00671657 0.07352801 0.11848798
 0.10499009 0.02057228 0.0398447  0.11611018 0.00541555 0.06723973
 0.03193901 0.03297504 0.01979744 0.05730988 0.06758567 0.01249663
 0.09402356 0.0339498  0.11277328 0.00965526 0.1564043  0.00666476
 0.00473746 0.01979745 0.00671643 0.09760208 0.08109668 0.01330432
 0.07097634 0.07560083 0.04850066 0.06880601 0.12034025 0.03394974
 0.03394977 0.05291611 0.058272   0.00473746 0.0067165  0.14676262
 0.0665376  0.0576595  0.0153265  0.09940087 0.01354458 0.10989364
 0.03397866 0.08916332 0.01532651 0.0315255  0.00527075 0.00509083
 0.11277315 0.05784303 0.12108742 0.05827128 0.00614686 0.00698518
 0.11256287 0.03270165 0.05976899 0.05010252 0.02247198 0.08226717
 0.08313752 0.06782294 0.07870175 0.20664212 0.07870173 0.04049806
 0.20846157 0.1447356  0.06191221 0.11245632 0.03326397 0.1858759
 0.00476813 0.12440573 0.02389825 0.06902616 0.12252557 0.00408083
 0.05905668 0.01104143 0.10925582 0.01054958 0.12290648 0.04937564
 0.03999623 0.02692578 0.06701234 0.01424681 0.05403938 0.01354459
 0.14820929 0.01629793 0.05655737 0.0327008  0.01309514 0.01973731
 0.060842   0.00369865 0.03234611 0.06620891 0.00369866 0.00369866
 0.00369865 0.03420508 0.0933966  0.00369865 0.00369865 0.0575038
 0.00369866 0.00569708 0.02550012 0.07158639 0.22927211 0.02577013
 0.02046294 0.01354175 0.10216466 0.01260711 0.09872648 0.0323461
 0.05168231 0.1585649  0.09575704 0.09341988 0.07115124 0.07115121
 0.22328101 0.01222359 0.00369866 0.033264   0.00369865 0.03420507
 0.05360531 0.00450277 0.00355227 0.00355227 0.00369874 0.00786485
 0.00355227 0.11265983 0.06846993 0.09402205 0.03234611 0.01044703
 0.08649693 0.06515269 0.00369867 0.03971006 0.1318457  0.07964074
 0.00668233 0.00614685 0.00606008 0.00369866 0.00415082 0.08522329
 0.11804972 0.00728432 0.1553572  0.06789252 0.0323461  0.10660227
 0.00332682 0.08253869 0.03225774 0.03248315 0.05932692 0.06777942
 0.08677702 0.05747266 0.09703641 0.07964079 0.00436815 0.0154982
 0.07623082 0.00369866 0.0323461  0.02652721 0.00669476 0.05909066
 0.0231605  0.07010936 0.07152466 0.0339421  0.05520866 0.00369866
 0.10915277 0.08242697 0.031889   0.11686584 0.05533557 0.05533575
 0.05533578 0.04276554 0.00343276 0.04634564 0.00552339 0.06380714
 0.05533564 0.00343276 0.03267961 0.03188872 0.08968094 0.00647614
 0.03188899 0.0487576  0.05533575 0.03188901 0.00343276 0.05533563
 0.05533574 0.00809696 0.00812027 0.05533581 0.00436852 0.04704167
 0.05119383 0.01047519 0.03156438 0.00655994 0.10910866 0.06458788
 0.02195834 0.07219735 0.08913413 0.01393893 0.08718821 0.02444634
 0.05367813 0.05825691 0.0553358  0.05533574 0.00552307 0.08484928
 0.11603884 0.07121796 0.03503609 0.01657522 0.16349545 0.00471791
 0.05716947 0.04829145 0.07666827 0.00633751 0.01175818 0.00865221
 0.06617477 0.00418557 0.01218696 0.07343604 0.00418557 0.02616992
 0.00655751 0.03893848 0.01455856 0.08460138 0.03249588 0.01191935
 0.00624132 0.03690732 0.00624259 0.01191934 0.00383611 0.05466778
 0.0278761  0.01213933 0.00383611 0.0324956  0.06513543 0.14983201
 0.06810428 0.03156412 0.05466805 0.03249586 0.00290716 0.01735846
 0.00811508 0.1690352  0.0364184  0.0063378  0.10206643 0.01337921
 0.00418557 0.03960628 0.02719098 0.15042318 0.03521122 0.00290716
 0.05794242 0.00340598 0.0824674  0.00843822 0.03291728 0.12570126
 0.00334103 0.01735842 0.1617802  0.00340599 0.17431314 0.00328257
 0.00377606 0.02966662 0.00229818 0.18715462 0.0148149  0.00418558
 0.02106605 0.01177687 0.01177683 0.00780639 0.08805097 0.02605297
 0.00229827 0.03260576 0.00994098 0.07031842 0.03260577 0.01657514
 0.00229818 0.03927746 0.00377606 0.03291736 0.01715087 0.05293072
 0.03260577 0.09342642 0.02605299 0.08510228 0.00334103 0.01735841
 0.03291722 0.03220193 0.07424641 0.08760682 0.00334103 0.06044888
 0.00334103 0.06044885 0.07039539 0.03260575 0.00725097 0.10491627
 0.0268942  0.00335674 0.41204178 0.00335671 0.00335673 0.00335672
 0.00335673 0.00335672 0.00335672 0.00335673 0.03541433 0.00760682
 0.02820201 0.00335672 0.00335672 0.00335672 0.00335672 0.00335673
 0.00335672 0.00335672 0.00335673 0.00335672 0.03301751 0.00335673
 0.00335672 0.10032323 0.00335673 0.01229194 0.01776777 0.00334103
 0.02875131 0.07484369 0.0541223  0.0541223  0.09504757 0.02875131
 0.00334104 0.00229818 0.00229818 0.00334103 0.00229818 0.01436398
 0.01146102 0.00335676 0.016575   0.00334103 0.01177691 0.00334103
 0.00334103 0.05797654 0.00334103 0.00229818 0.00334103 0.00334104
 0.03260578 0.00229817 0.00334103 0.00229818 0.00334104 0.00334103
 0.00334103 0.08180066 0.08024132 0.03156032 0.00335673 0.02946978
 0.02058093 0.00334102 0.00229818 0.06828789 0.00335673 0.02665543
 0.06920298 0.00274823 0.00334103 0.00334103 0.0336773  0.09207483
 0.03604458 0.00334102 0.03541433 0.00817072 0.00229818 0.03825292
 0.00335672 0.04037362 0.06930626 0.00335671 0.00335673 0.03541433
 0.00817071 0.00334103 0.19405168 0.06086068 0.06422266 0.0920748
 0.02624724 0.05780156 0.0578016  0.01788174 0.01171488 0.00335672
 0.01223603 0.05889604 0.0920748  0.03105325 0.01757539 0.02355422
 0.00351434 0.00351434 0.00351434 0.00351434 0.00351434 0.03352073
 0.05663927 0.00351434 0.00351436 0.00335673 0.00761739 0.00335671
 0.0578016  0.08436888 0.0806753  0.01042708 0.05780159 0.08008966
 0.03301752 0.01214986 0.03301749 0.00335672 0.05780156 0.00384177
 0.00217209 0.00217209 0.00351434 0.00384178 0.08017775 0.03241428
 0.02629586 0.00335672 0.00351435 0.03191709 0.00217209 0.00432415
 0.00451517 0.033546   0.03352074 0.15425768 0.00434012 0.08221914
 0.03076726 0.00451518 0.00587655 0.00397399 0.00492667 0.00639773
 0.06097125 0.0237503  0.05952836 0.00451516 0.00451519 0.00451517
 0.00293595 0.03191708 0.00451516 0.00492665 0.00451516 0.00451517
 0.00451517 0.03134929 0.00432637 0.06403066 0.07746716 0.06420586
 0.00739225 0.02211761 0.07617404 0.08108676 0.00533867 0.00461461
 0.00566608 0.0410096  0.04100947 0.00492665 0.0804663  0.15450267
 0.00533995 0.00411163 0.01961408 0.07971207 0.00493732 0.00493732
 0.00493731 0.0044612  0.00352186 0.05565161 0.05243008 0.19631928
 0.0049119  0.0036064  0.01485747 0.00411162 0.00758665 0.03133921
 0.00333653 0.02251554 0.00533994 0.15441951 0.00411163 0.03134013
 0.00360638 0.07299139 0.00493732 0.0044612  0.00333651 0.02023821
 0.04408239 0.0044612  0.00446121 0.0044612  0.07480668 0.41554788
 1.0303502  0.00493731 0.10403119 0.0044612  0.06432126 0.02103534
 0.12318062 0.02103918 0.00446121 0.00490521 0.00990105 0.00575931
 0.16867457 0.02109462 0.13154893 0.00619829 0.0826771  0.02103524
 0.06041895 0.04728888 0.01262037 0.10316721 0.03708832 0.00606568
 0.00606568 0.13432685 0.23191586 0.08547522 0.02103526 0.01262038
 0.02103528 0.00212955 0.00605424 0.00605424 0.00335636 0.09852994
 0.00503111 0.00605424 0.00212955 0.00808399 0.00605424 0.00605423
 0.00510369 0.02647465 0.0960189  0.09523729 0.00605424 0.04032276
 0.00808399 0.00605424 0.00634424 0.00922742 0.00251772 0.00251772
 0.12220518 0.00922736 0.00605424 0.00922729 0.01122235 0.10820589
 0.05685643 0.00605424 0.16322295 0.00915989 0.00915986 0.02647456
 0.00538719 0.01521542 0.00634425 0.00783687 0.00354355 0.05363848
 0.02176853 0.05363846 0.18704942 0.00244944 0.02176853 0.006103
 0.006103   0.15158066 0.00610301 0.04152709 0.00538715 0.05078916
 0.01717925 0.00244945 0.01717031 0.09746679 0.10358907 0.10513193
 0.00610299 0.00943716 0.01996331 0.00610299 0.12311801 0.07904886
 0.00864855 0.00244943 0.00610301 0.2306457  0.006103   0.00610299
 0.006103   0.00683336 0.04784513 0.00683337 0.023925   0.00683335
 0.0470227  0.06433561 0.12175724 0.00610299 0.00610298 0.00610299
 0.00610299 0.379619   0.02390054 0.00683336 0.00610298 0.00610299
 0.006103   0.01889497 0.00610299 0.006103   0.00401957 0.02389901
 0.00731149 0.18360491 0.00401957 0.00610299 0.00610299 0.01796808
 0.06067005 0.06761661 0.06761667 0.00785942 0.06017964 0.0325413
 0.02031541 0.23924764 0.06761658 0.00832121 0.06761666 0.0107289
 0.02030938 0.0676166  0.01252772 0.00731145 0.0271911  0.0072258
 0.01267155 0.01252772 0.03451406 0.01217172]
2025-06-03 10:11:59,895 - DEBUG - Edge reconstruction errors: [0.15802532 1.6586162  1.6594524  ... 0.1578896  1.2580551  0.15791132]
2025-06-03 10:11:59,898 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101159_update_33.json
2025-06-03 10:11:59,899 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:11:59,912 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101159_update_33.pth and as latest_checkpoint.pth
2025-06-03 10:11:59,912 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.3130
2025-06-03 10:11:59,912 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-03 10:11:59,912 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.4573, MLP Score: 0.4842
2025-06-03 10:11:59,912 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.4971, MLP Score: 0.4987
2025-06-03 10:11:59,912 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.7657, MLP Score: 0.4963
2025-06-03 10:11:59,912 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.3166, MLP Score: 0.4990
2025-06-03 10:11:59,912 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.3526, MLP Score: 0.4878
2025-06-03 10:11:59,912 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-03 10:11:59,912 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.5522, MLP Score: 0.4983
2025-06-03 10:11:59,912 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4477, MLP Score: 0.4979
2025-06-03 10:11:59,912 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4382, MLP Score: 0.4959
2025-06-03 10:11:59,912 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1397, MLP Score: 0.5050
2025-06-03 10:11:59,913 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.2776, MLP Score: 0.4876
2025-06-03 10:11:59,913 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-03 10:11:59,913 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-03 10:11:59,913 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-03 10:11:59,937 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-03 10:11:59,958 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-03 10:11:59,958 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-03 10:11:59,958 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-03 10:11:59,976 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-03 10:11:59,998 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-03 10:11:59,998 - INFO - Processing node updates/additions.
2025-06-03 10:12:00,002 - INFO - Processing edge updates/additions.
2025-06-03 10:12:00,013 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:12:00,014 - INFO - Finished updating NetworkX graph.
2025-06-03 10:12:00,014 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:12:00,015 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:12:00,024 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-03 10:12:00,026 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:12:00,026 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-03 10:12:00,027 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-03 10:12:00,029 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:12:00,033 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:12:00,034 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:12:00,035 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:12:00,037 - DEBUG - Shape of encoded categorical edge features: torch.Size([2007, 3])
2025-06-03 10:12:00,038 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:12:00,038 - DEBUG - Shape of scaled numerical edge features: torch.Size([2007, 7])
2025-06-03 10:12:00,038 - DEBUG - Final edge attributes tensor shape: torch.Size([2007, 10])
2025-06-03 10:12:00,038 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:12:00,041 - INFO - Performing online update...
2025-06-03 10:12:00,042 - INFO - Starting online update for 50 steps.
2025-06-03 10:12:00,042 - DEBUG - Updated RunningStats: new_mean=0.9510446728586145, new_var=19200000000161.758, new_n=1950
2025-06-03 10:12:00,043 - DEBUG - Updated RunningStats: new_mean=0.9478407502260687, new_var=19500000000018.043, new_n=1980
2025-06-03 10:12:00,043 - DEBUG - Updated RunningStats: new_mean=1.183234651511299, new_var=6400000000093.474, new_n=650
2025-06-03 10:12:00,043 - DEBUG - Updated RunningStats: new_mean=1.1816633151885563, new_var=6500000000001.675, new_n=660
2025-06-03 10:12:00,043 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:12:00,043 - DEBUG - Online update step: 1/50
2025-06-03 10:12:00,046 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:01,227 - DEBUG - Node anomaly scores shape: torch.Size([21759, 1])
2025-06-03 10:12:01,298 - DEBUG - Edge anomaly scores shape: torch.Size([45535, 1])
2025-06-03 10:12:01,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:02,254 - DEBUG - Step 1: Loss=0.6368
2025-06-03 10:12:02,254 - DEBUG - Online update step: 2/50
2025-06-03 10:12:02,258 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:02,792 - DEBUG - Node anomaly scores shape: torch.Size([20974, 1])
2025-06-03 10:12:02,803 - DEBUG - Edge anomaly scores shape: torch.Size([43776, 1])
2025-06-03 10:12:02,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:03,757 - DEBUG - Step 2: Loss=0.6349
2025-06-03 10:12:03,757 - DEBUG - Online update step: 3/50
2025-06-03 10:12:03,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:05,930 - DEBUG - Node anomaly scores shape: torch.Size([21070, 1])
2025-06-03 10:12:05,941 - DEBUG - Edge anomaly scores shape: torch.Size([43960, 1])
2025-06-03 10:12:05,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:06,566 - DEBUG - Step 3: Loss=0.6333
2025-06-03 10:12:06,566 - DEBUG - Online update step: 4/50
2025-06-03 10:12:06,569 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:07,089 - DEBUG - Node anomaly scores shape: torch.Size([21108, 1])
2025-06-03 10:12:07,127 - DEBUG - Edge anomaly scores shape: torch.Size([44054, 1])
2025-06-03 10:12:07,134 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:08,682 - DEBUG - Step 4: Loss=0.6319
2025-06-03 10:12:08,682 - DEBUG - Online update step: 5/50
2025-06-03 10:12:08,686 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:10,778 - DEBUG - Node anomaly scores shape: torch.Size([21126, 1])
2025-06-03 10:12:10,822 - DEBUG - Edge anomaly scores shape: torch.Size([44102, 1])
2025-06-03 10:12:10,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:11,656 - DEBUG - Step 5: Loss=0.6302
2025-06-03 10:12:11,656 - DEBUG - Online update step: 6/50
2025-06-03 10:12:11,659 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:12,227 - DEBUG - Node anomaly scores shape: torch.Size([21469, 1])
2025-06-03 10:12:12,239 - DEBUG - Edge anomaly scores shape: torch.Size([44888, 1])
2025-06-03 10:12:12,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:12,844 - DEBUG - Step 6: Loss=0.6293
2025-06-03 10:12:12,845 - DEBUG - Online update step: 7/50
2025-06-03 10:12:12,847 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:13,360 - DEBUG - Node anomaly scores shape: torch.Size([21083, 1])
2025-06-03 10:12:13,371 - DEBUG - Edge anomaly scores shape: torch.Size([43987, 1])
2025-06-03 10:12:13,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:14,031 - DEBUG - Step 7: Loss=0.6276
2025-06-03 10:12:14,032 - DEBUG - Online update step: 8/50
2025-06-03 10:12:14,035 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:14,528 - DEBUG - Node anomaly scores shape: torch.Size([20966, 1])
2025-06-03 10:12:14,539 - DEBUG - Edge anomaly scores shape: torch.Size([43740, 1])
2025-06-03 10:12:14,541 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:15,172 - DEBUG - Step 8: Loss=0.6259
2025-06-03 10:12:15,172 - DEBUG - Online update step: 9/50
2025-06-03 10:12:15,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:15,714 - DEBUG - Node anomaly scores shape: torch.Size([21377, 1])
2025-06-03 10:12:15,725 - DEBUG - Edge anomaly scores shape: torch.Size([44677, 1])
2025-06-03 10:12:15,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:16,413 - DEBUG - Step 9: Loss=0.6253
2025-06-03 10:12:16,414 - DEBUG - Online update step: 10/50
2025-06-03 10:12:16,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:17,140 - DEBUG - Node anomaly scores shape: torch.Size([21235, 1])
2025-06-03 10:12:17,151 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-03 10:12:17,152 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:17,884 - DEBUG - Step 10: Loss=0.6239
2025-06-03 10:12:17,884 - DEBUG - Online update step: 11/50
2025-06-03 10:12:17,887 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:18,916 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:12:18,995 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:12:19,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:20,274 - DEBUG - Step 11: Loss=0.6239
2025-06-03 10:12:20,274 - DEBUG - Online update step: 12/50
2025-06-03 10:12:20,278 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:21,761 - DEBUG - Node anomaly scores shape: torch.Size([21195, 1])
2025-06-03 10:12:21,869 - DEBUG - Edge anomaly scores shape: torch.Size([44273, 1])
2025-06-03 10:12:21,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:23,969 - DEBUG - Step 12: Loss=0.6246
2025-06-03 10:12:23,970 - DEBUG - Online update step: 13/50
2025-06-03 10:12:23,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:24,572 - DEBUG - Node anomaly scores shape: torch.Size([21120, 1])
2025-06-03 10:12:24,585 - DEBUG - Edge anomaly scores shape: torch.Size([44077, 1])
2025-06-03 10:12:24,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:25,180 - DEBUG - Step 13: Loss=0.6216
2025-06-03 10:12:25,181 - DEBUG - Online update step: 14/50
2025-06-03 10:12:25,183 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:25,666 - DEBUG - Node anomaly scores shape: torch.Size([21377, 1])
2025-06-03 10:12:25,676 - DEBUG - Edge anomaly scores shape: torch.Size([44677, 1])
2025-06-03 10:12:25,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:26,281 - DEBUG - Step 14: Loss=0.6214
2025-06-03 10:12:26,281 - DEBUG - Online update step: 15/50
2025-06-03 10:12:26,284 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:26,771 - DEBUG - Node anomaly scores shape: torch.Size([21120, 1])
2025-06-03 10:12:26,781 - DEBUG - Edge anomaly scores shape: torch.Size([44077, 1])
2025-06-03 10:12:26,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:27,333 - DEBUG - Step 15: Loss=0.6229
2025-06-03 10:12:27,333 - DEBUG - Online update step: 16/50
2025-06-03 10:12:27,336 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:27,846 - DEBUG - Node anomaly scores shape: torch.Size([21235, 1])
2025-06-03 10:12:27,863 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-03 10:12:27,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:28,413 - DEBUG - Step 16: Loss=0.6195
2025-06-03 10:12:28,414 - DEBUG - Online update step: 17/50
2025-06-03 10:12:28,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:28,991 - DEBUG - Node anomaly scores shape: torch.Size([20994, 1])
2025-06-03 10:12:29,001 - DEBUG - Edge anomaly scores shape: torch.Size([43834, 1])
2025-06-03 10:12:29,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:29,782 - DEBUG - Step 17: Loss=0.6193
2025-06-03 10:12:29,782 - DEBUG - Online update step: 18/50
2025-06-03 10:12:29,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:30,316 - DEBUG - Node anomaly scores shape: torch.Size([21158, 1])
2025-06-03 10:12:30,326 - DEBUG - Edge anomaly scores shape: torch.Size([44162, 1])
2025-06-03 10:12:30,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:30,883 - DEBUG - Step 18: Loss=0.6212
2025-06-03 10:12:30,883 - DEBUG - Online update step: 19/50
2025-06-03 10:12:30,886 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:31,393 - DEBUG - Node anomaly scores shape: torch.Size([21588, 1])
2025-06-03 10:12:31,404 - DEBUG - Edge anomaly scores shape: torch.Size([45218, 1])
2025-06-03 10:12:31,406 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:31,959 - DEBUG - Step 19: Loss=0.6161
2025-06-03 10:12:31,959 - DEBUG - Online update step: 20/50
2025-06-03 10:12:31,962 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:32,447 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:12:32,459 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:12:32,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:33,011 - DEBUG - Step 20: Loss=0.6223
2025-06-03 10:12:33,011 - DEBUG - Online update step: 21/50
2025-06-03 10:12:33,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:33,503 - DEBUG - Node anomaly scores shape: torch.Size([20970, 1])
2025-06-03 10:12:33,513 - DEBUG - Edge anomaly scores shape: torch.Size([43763, 1])
2025-06-03 10:12:33,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:34,053 - DEBUG - Step 21: Loss=0.6158
2025-06-03 10:12:34,054 - DEBUG - Online update step: 22/50
2025-06-03 10:12:34,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:34,560 - DEBUG - Node anomaly scores shape: torch.Size([21341, 1])
2025-06-03 10:12:34,570 - DEBUG - Edge anomaly scores shape: torch.Size([44603, 1])
2025-06-03 10:12:34,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:35,127 - DEBUG - Step 22: Loss=0.6203
2025-06-03 10:12:35,128 - DEBUG - Online update step: 23/50
2025-06-03 10:12:35,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:35,622 - DEBUG - Node anomaly scores shape: torch.Size([21052, 1])
2025-06-03 10:12:35,633 - DEBUG - Edge anomaly scores shape: torch.Size([43935, 1])
2025-06-03 10:12:35,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:36,203 - DEBUG - Step 23: Loss=0.6198
2025-06-03 10:12:36,203 - DEBUG - Online update step: 24/50
2025-06-03 10:12:36,206 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:36,700 - DEBUG - Node anomaly scores shape: torch.Size([21496, 1])
2025-06-03 10:12:36,710 - DEBUG - Edge anomaly scores shape: torch.Size([44968, 1])
2025-06-03 10:12:36,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:37,263 - DEBUG - Step 24: Loss=0.6152
2025-06-03 10:12:37,263 - DEBUG - Online update step: 25/50
2025-06-03 10:12:37,265 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:37,767 - DEBUG - Node anomaly scores shape: torch.Size([21120, 1])
2025-06-03 10:12:37,777 - DEBUG - Edge anomaly scores shape: torch.Size([44077, 1])
2025-06-03 10:12:37,778 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:38,391 - DEBUG - Step 25: Loss=0.6162
2025-06-03 10:12:38,391 - DEBUG - Online update step: 26/50
2025-06-03 10:12:38,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:38,950 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:12:38,961 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:12:38,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:39,506 - DEBUG - Step 26: Loss=0.6119
2025-06-03 10:12:39,506 - DEBUG - Online update step: 27/50
2025-06-03 10:12:39,511 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:40,034 - DEBUG - Node anomaly scores shape: torch.Size([21588, 1])
2025-06-03 10:12:40,044 - DEBUG - Edge anomaly scores shape: torch.Size([45218, 1])
2025-06-03 10:12:40,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:40,595 - DEBUG - Step 27: Loss=0.6146
2025-06-03 10:12:40,595 - DEBUG - Online update step: 28/50
2025-06-03 10:12:40,598 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:41,130 - DEBUG - Node anomaly scores shape: torch.Size([21089, 1])
2025-06-03 10:12:41,140 - DEBUG - Edge anomaly scores shape: torch.Size([44003, 1])
2025-06-03 10:12:41,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:41,747 - DEBUG - Step 28: Loss=0.6093
2025-06-03 10:12:41,747 - DEBUG - Online update step: 29/50
2025-06-03 10:12:41,750 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:42,271 - DEBUG - Node anomaly scores shape: torch.Size([21235, 1])
2025-06-03 10:12:42,282 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-03 10:12:42,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:42,871 - DEBUG - Step 29: Loss=0.6127
2025-06-03 10:12:42,871 - DEBUG - Online update step: 30/50
2025-06-03 10:12:42,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:43,369 - DEBUG - Node anomaly scores shape: torch.Size([20974, 1])
2025-06-03 10:12:43,379 - DEBUG - Edge anomaly scores shape: torch.Size([43776, 1])
2025-06-03 10:12:43,380 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:43,901 - DEBUG - Step 30: Loss=0.6084
2025-06-03 10:12:43,901 - DEBUG - Online update step: 31/50
2025-06-03 10:12:43,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:44,393 - DEBUG - Node anomaly scores shape: torch.Size([21235, 1])
2025-06-03 10:12:44,403 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-03 10:12:44,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:45,340 - DEBUG - Step 31: Loss=0.6112
2025-06-03 10:12:45,340 - DEBUG - Online update step: 32/50
2025-06-03 10:12:45,345 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:46,047 - DEBUG - Node anomaly scores shape: torch.Size([21469, 1])
2025-06-03 10:12:46,059 - DEBUG - Edge anomaly scores shape: torch.Size([44888, 1])
2025-06-03 10:12:46,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:46,711 - DEBUG - Step 32: Loss=0.6082
2025-06-03 10:12:46,712 - DEBUG - Online update step: 33/50
2025-06-03 10:12:46,714 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:47,243 - DEBUG - Node anomaly scores shape: torch.Size([21588, 1])
2025-06-03 10:12:47,253 - DEBUG - Edge anomaly scores shape: torch.Size([45218, 1])
2025-06-03 10:12:47,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:47,995 - DEBUG - Step 33: Loss=0.6091
2025-06-03 10:12:47,995 - DEBUG - Online update step: 34/50
2025-06-03 10:12:47,998 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:48,760 - DEBUG - Node anomaly scores shape: torch.Size([21165, 1])
2025-06-03 10:12:48,780 - DEBUG - Edge anomaly scores shape: torch.Size([44174, 1])
2025-06-03 10:12:48,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:50,506 - DEBUG - Step 34: Loss=0.6070
2025-06-03 10:12:50,507 - DEBUG - Online update step: 35/50
2025-06-03 10:12:50,513 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:52,592 - DEBUG - Node anomaly scores shape: torch.Size([21632, 1])
2025-06-03 10:12:52,669 - DEBUG - Edge anomaly scores shape: torch.Size([45326, 1])
2025-06-03 10:12:52,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:54,885 - DEBUG - Step 35: Loss=0.6083
2025-06-03 10:12:54,886 - DEBUG - Online update step: 36/50
2025-06-03 10:12:54,890 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:55,493 - DEBUG - Node anomaly scores shape: torch.Size([20970, 1])
2025-06-03 10:12:55,505 - DEBUG - Edge anomaly scores shape: torch.Size([43763, 1])
2025-06-03 10:12:55,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:56,148 - DEBUG - Step 36: Loss=0.6053
2025-06-03 10:12:56,148 - DEBUG - Online update step: 37/50
2025-06-03 10:12:56,152 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:56,651 - DEBUG - Node anomaly scores shape: torch.Size([21126, 1])
2025-06-03 10:12:56,661 - DEBUG - Edge anomaly scores shape: torch.Size([44102, 1])
2025-06-03 10:12:56,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:57,244 - DEBUG - Step 37: Loss=0.6049
2025-06-03 10:12:57,245 - DEBUG - Online update step: 38/50
2025-06-03 10:12:57,247 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:57,802 - DEBUG - Node anomaly scores shape: torch.Size([21083, 1])
2025-06-03 10:12:57,815 - DEBUG - Edge anomaly scores shape: torch.Size([43987, 1])
2025-06-03 10:12:57,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:58,403 - DEBUG - Step 38: Loss=0.6057
2025-06-03 10:12:58,403 - DEBUG - Online update step: 39/50
2025-06-03 10:12:58,407 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:12:58,932 - DEBUG - Node anomaly scores shape: torch.Size([21158, 1])
2025-06-03 10:12:58,946 - DEBUG - Edge anomaly scores shape: torch.Size([44162, 1])
2025-06-03 10:12:58,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:12:59,541 - DEBUG - Step 39: Loss=0.6040
2025-06-03 10:12:59,541 - DEBUG - Online update step: 40/50
2025-06-03 10:12:59,544 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:00,057 - DEBUG - Node anomaly scores shape: torch.Size([21341, 1])
2025-06-03 10:13:00,067 - DEBUG - Edge anomaly scores shape: torch.Size([44603, 1])
2025-06-03 10:13:00,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:00,682 - DEBUG - Step 40: Loss=0.6041
2025-06-03 10:13:00,682 - DEBUG - Online update step: 41/50
2025-06-03 10:13:00,686 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:01,214 - DEBUG - Node anomaly scores shape: torch.Size([21022, 1])
2025-06-03 10:13:01,224 - DEBUG - Edge anomaly scores shape: torch.Size([43873, 1])
2025-06-03 10:13:01,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:01,809 - DEBUG - Step 41: Loss=0.6020
2025-06-03 10:13:01,809 - DEBUG - Online update step: 42/50
2025-06-03 10:13:01,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:02,357 - DEBUG - Node anomaly scores shape: torch.Size([21588, 1])
2025-06-03 10:13:02,369 - DEBUG - Edge anomaly scores shape: torch.Size([45218, 1])
2025-06-03 10:13:02,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:02,968 - DEBUG - Step 42: Loss=0.6027
2025-06-03 10:13:02,968 - DEBUG - Online update step: 43/50
2025-06-03 10:13:02,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:03,483 - DEBUG - Node anomaly scores shape: torch.Size([21195, 1])
2025-06-03 10:13:03,494 - DEBUG - Edge anomaly scores shape: torch.Size([44273, 1])
2025-06-03 10:13:03,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:04,073 - DEBUG - Step 43: Loss=0.6008
2025-06-03 10:13:04,073 - DEBUG - Online update step: 44/50
2025-06-03 10:13:04,076 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:04,600 - DEBUG - Node anomaly scores shape: torch.Size([21158, 1])
2025-06-03 10:13:04,611 - DEBUG - Edge anomaly scores shape: torch.Size([44162, 1])
2025-06-03 10:13:04,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:05,192 - DEBUG - Step 44: Loss=0.6020
2025-06-03 10:13:05,192 - DEBUG - Online update step: 45/50
2025-06-03 10:13:05,195 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:05,714 - DEBUG - Node anomaly scores shape: torch.Size([21341, 1])
2025-06-03 10:13:05,725 - DEBUG - Edge anomaly scores shape: torch.Size([44603, 1])
2025-06-03 10:13:05,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:06,300 - DEBUG - Step 45: Loss=0.5999
2025-06-03 10:13:06,300 - DEBUG - Online update step: 46/50
2025-06-03 10:13:06,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:06,812 - DEBUG - Node anomaly scores shape: torch.Size([21165, 1])
2025-06-03 10:13:06,822 - DEBUG - Edge anomaly scores shape: torch.Size([44174, 1])
2025-06-03 10:13:06,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:07,415 - DEBUG - Step 46: Loss=0.6006
2025-06-03 10:13:07,416 - DEBUG - Online update step: 47/50
2025-06-03 10:13:07,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:07,940 - DEBUG - Node anomaly scores shape: torch.Size([21632, 1])
2025-06-03 10:13:07,949 - DEBUG - Edge anomaly scores shape: torch.Size([45326, 1])
2025-06-03 10:13:07,951 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:08,499 - DEBUG - Step 47: Loss=0.5988
2025-06-03 10:13:08,499 - DEBUG - Online update step: 48/50
2025-06-03 10:13:08,501 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:09,030 - DEBUG - Node anomaly scores shape: torch.Size([21108, 1])
2025-06-03 10:13:09,042 - DEBUG - Edge anomaly scores shape: torch.Size([44054, 1])
2025-06-03 10:13:09,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:09,679 - DEBUG - Step 48: Loss=0.5999
2025-06-03 10:13:09,679 - DEBUG - Online update step: 49/50
2025-06-03 10:13:09,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:10,189 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:13:10,199 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:13:10,200 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:10,726 - DEBUG - Step 49: Loss=0.5981
2025-06-03 10:13:10,726 - DEBUG - Online update step: 50/50
2025-06-03 10:13:10,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:11,240 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:13:11,251 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:13:11,252 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:11,846 - DEBUG - Step 50: Loss=0.5984
2025-06-03 10:13:11,846 - INFO - Online update finished. Average loss: 0.6145, Learning rate: 0.001000
2025-06-03 10:13:11,846 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.6369199e-09  1.4805436e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.0121406e-08
 -1.9400227e-08  6.5092869e-09  8.1685165e-09  1.3273840e-08
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.4677803e-08  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.6081767e-08  6.1263874e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.2629445e-08  2.3484485e-08], current edge mean: [ 9.1420031e+00  1.4110613e+00  5.6831093e+00 -9.5034813e-10
 -3.3262184e-09 -1.8709978e-09  4.0389794e-09  1.9006963e-09
  0.0000000e+00 -1.9006963e-09]
2025-06-03 10:13:11,847 - DEBUG - Node drift difference: 0.0108, Edge drift difference: 0.0027
2025-06-03 10:13:11,848 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.6369199e-09  1.4805436e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.0121406e-08
 -1.9400227e-08  6.5092869e-09  8.1685165e-09  1.3273840e-08
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.4677803e-08  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.6081767e-08  6.1263874e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.2629445e-08  2.3484485e-08], edge=[ 9.1420031e+00  1.4110613e+00  5.6831093e+00 -9.5034813e-10
 -3.3262184e-09 -1.8709978e-09  4.0389794e-09  1.9006963e-09
  0.0000000e+00 -1.9006963e-09]
2025-06-03 10:13:11,848 - DEBUG - Updated reference std: node=[0.         0.         1.0005357  1.0005357  0.         0.
 0.         1.0005357  1.0005357  1.0005358  1.0005357  1.0005357
 1.0156461  0.27510577 0.3654804  0.5750021  1.0005357  2.9664128
 2.87709    1.51188    0.3654804  0.229047   1.0005357  1.0005357
 0.         0.         0.         0.         1.0005357  1.0005357 ], edge=[1.1160322  0.50514525 2.1723423  1.0002493  1.0002493  1.0002491
 1.0002493  1.0002493  1.0002493  1.0002493 ]
2025-06-03 10:13:11,848 - INFO - Online update complete. Loss: 0.6145
2025-06-03 10:13:11,848 - INFO - Running anomaly detection...
2025-06-03 10:13:11,848 - INFO - Starting anomaly detection.
2025-06-03 10:13:11,861 - DEBUG - Node reconstruction errors: [0.0390058  0.00947508 0.01337868 0.00635842 0.00544038 0.30078432
 0.04482767 0.00965594 0.02005196 0.01721844 0.01172632 0.00861102
 0.03353477 0.00369005 0.03765717 0.00824116 0.03067038 0.01330435
 0.01010231 0.11707964 0.01330433 0.01540301 0.00563161 0.01890879
 0.04471372 0.01821616 0.01108417 0.01110459 0.01330434 0.02085502
 0.0106746  0.01821614 0.00610809 0.01756321 0.01481397 0.01318488
 0.24515706 0.00598762 0.06360196 0.01321729 0.01777784 0.03240385
 0.02786602 0.0036897  0.00759561 0.04433093 0.39695835 0.00886213
 0.0143861  0.01942464 0.06498667 0.00563324 0.00483842 0.00598762
 0.0182161  0.0226005  0.01775707 0.00572031 0.07274342 0.0130489
 0.07044517 0.03388071 0.11139334 0.00791676 0.02987591 0.00878575
 0.01496624 0.0056316  0.01942485 0.01646304 0.085279   0.02424407
 0.05110259 0.01436978 0.22860819 0.0912632  0.01942464 0.08546218
 0.17120817 0.02299338 0.01417002 0.0092684  0.01285582 0.0204001
 0.01249291 0.01574376 0.00905979 0.03597373 0.04186175 0.10773875
 0.00365856 0.03393479 0.00801155 0.0097607  0.00806433 0.03168749
 0.00508867 0.00868245 0.00203112 0.0287714  0.00510818 0.00508868
 0.00537047 0.20243491 0.00821203 0.01270478 0.00917265 0.02274308
 0.00843169 0.04282999 0.10665294 0.00493082 0.02805392 0.02625515
 0.0042841  0.00437357 0.00373297 0.02153107 0.00890679 0.00843536
 0.00294862 0.00804399 0.01134388 0.00572378 0.02165053 0.00843452
 0.00742746 0.01726701 0.00976683 0.00440736 0.00653097 0.00837648
 0.03156057 0.07660888 0.00312379 0.01295133 0.00358861 0.00226331
 0.04509861 0.01872958 0.00880841 0.03717434 0.00301355 0.00637059
 0.00880295 0.0196487  0.00373297 0.02672855 0.00878578 0.01012179
 0.20501177 0.00964515 0.0163115  0.00837649 0.02164935 0.01945006
 0.0072609  0.00620143 0.00510815 0.00639532 0.00882738 0.00480177
 0.00726093 0.00653213 0.00382237 0.01872205 0.00611749 0.01157954
 0.00463364 0.01012206 0.0144863  0.00812554 0.0034548  0.02351658
 0.00890686 0.00929843 0.01096411 0.03774943 0.00382309 0.00382309
 0.01343484 0.0100566  0.01345995 0.02064028 0.02797344 0.00920007
 0.00270788 0.00480989 0.01364502 0.00654915 0.02362891 0.00945857
 0.00619558 0.00797624 0.04509787 0.00646584 0.32883012 0.00866557
 0.02582603 0.0086724  0.00402985 0.00726131 0.02495365 0.01074436
 0.00884375 0.00422338 0.01423364 0.09133235 0.00207246 0.01530426
 0.0030857  0.02102396 0.00852533 0.01372444 0.01419478 0.00308195
 0.00980795 0.00373297 0.07362659 0.00797623 0.0172228  0.00270791
 0.00301864 0.00852533 0.00726086 0.02358162 0.01886211 0.00825068
 0.01494251 0.01233443 0.00579588 0.01468766 0.01081533 0.00373296
 0.00373297 0.00518178 0.01259501 0.00301865 0.00726107 0.00948855
 0.01753396 0.0124208  0.00852898 0.02114262 0.00761215 0.02311135
 0.00396635 0.04164471 0.00852898 0.00647854 0.00345479 0.00308452
 0.07362653 0.01024986 0.01066978 0.03792644 0.00653931 0.0022232
 0.0072881  0.00382308 0.01548319 0.01094396 0.01641553 0.00735403
 0.00964184 0.01044994 0.00852859 0.1069561  0.00852877 0.00479803
 0.04964344 0.01281845 0.01407993 0.0092757  0.00480508 0.04195344
 0.00270963 0.05058843 0.01343483 0.00906165 0.070104   0.0028118
 0.01189043 0.0044763  0.02535825 0.00469974 0.07230885 0.01342847
 0.0100566  0.0065616  0.01031749 0.00359116 0.0546954  0.00761215
 0.06654914 0.00300343 0.01181493 0.00382371 0.00646054 0.00546569
 0.01452093 0.00966829 0.00456719 0.01178301 0.00174321 0.00174319
 0.00174319 0.00554415 0.00736789 0.00966863 0.00174318 0.02233992
 0.00174322 0.00557411 0.00321937 0.01628424 0.11119679 0.00968584
 0.00793143 0.00595583 0.01561104 0.00773996 0.02094188 0.00456719
 0.02083328 0.01613525 0.11067138 0.0140355  0.01700087 0.01700089
 0.13507134 0.00604683 0.00174383 0.00480507 0.00174321 0.00554413
 0.00561761 0.00265048 0.01141152 0.00179633 0.01009814 0.00619963
 0.00179621 0.02185762 0.01078758 0.00980686 0.00456719 0.00415573
 0.0083423  0.01398788 0.00174689 0.00422836 0.01154872 0.03956068
 0.00657635 0.00653931 0.00967014 0.00174319 0.00192185 0.01537942
 0.01458108 0.00557566 0.02342511 0.01373173 0.00456729 0.02936924
 0.00248023 0.03263655 0.00364687 0.00318569 0.01431417 0.01283966
 0.01933807 0.02160782 0.0104414  0.03955982 0.00272083 0.00657317
 0.03194569 0.00174319 0.0045672  0.00344548 0.00625567 0.01303194
 0.00324199 0.01444568 0.01900463 0.00954342 0.02381477 0.00174332
 0.04826777 0.00911545 0.00366172 0.01552293 0.02140904 0.02140749
 0.02140578 0.01484564 0.00167322 0.01605532 0.00488274 0.02783344
 0.02140789 0.00167292 0.00418875 0.00366191 0.01710902 0.00630969
 0.00366172 0.02016985 0.02140685 0.00366172 0.00167308 0.02140789
 0.02140695 0.00773079 0.00627423 0.02140572 0.00273373 0.0042332
 0.00468506 0.00412498 0.00358133 0.0055476  0.00672342 0.00534898
 0.00378905 0.00879804 0.01857814 0.01023194 0.00755804 0.01515266
 0.02430185 0.02941492 0.05931005 0.02140762 0.00488194 0.00962771
 0.00674494 0.00620362 0.00362745 0.00559497 0.02440708 0.00215628
 0.00456411 0.01841813 0.04607125 0.00466142 0.0055715  0.00555489
 0.01325899 0.00242505 0.00615891 0.00710905 0.00242505 0.01617712
 0.00554101 0.0040326  0.00397723 0.01233062 0.00389675 0.00670575
 0.00508473 0.01152062 0.00508635 0.00670575 0.00223659 0.00700547
 0.00600874 0.00585633 0.00223659 0.00389695 0.01161295 0.05198808
 0.01323957 0.0035824  0.00700549 0.00389676 0.0022054  0.00687229
 0.004021   0.08355561 0.00367416 0.0046618  0.00814393 0.00241073
 0.00242505 0.00903028 0.01802384 0.05195457 0.00519007 0.00220538
 0.0148734  0.00226929 0.0131835  0.00601346 0.0044327  0.03553391
 0.00168189 0.00687224 0.02085065 0.00226716 0.0227281  0.00238395
 0.00215232 0.01261763 0.00168949 0.09505919 0.00390847 0.00242505
 0.01016154 0.00508213 0.00508165 0.00222234 0.01432292 0.0032141
 0.00171759 0.00553793 0.00694031 0.01865052 0.00553794 0.00559496
 0.00168933 0.00624801 0.00215233 0.00443269 0.00554973 0.01315038
 0.0186363  0.00972102 0.0032141  0.01597803 0.00168187 0.00687225
 0.00443274 0.00417285 0.02139238 0.01001169 0.00168189 0.02429521
 0.00168202 0.0123524  0.0084464  0.00553794 0.00420188 0.02764195
 0.0035905  0.00175427 0.17800999 0.00175428 0.00175442 0.00175428
 0.00175427 0.00175428 0.00175428 0.00175427 0.00663275 0.00427622
 0.01845741 0.00175429 0.00175425 0.00175427 0.00175428 0.00175431
 0.00175425 0.00175435 0.0017543  0.00175424 0.00643843 0.00175505
 0.00175425 0.00929341 0.00175431 0.00467197 0.01044749 0.00168188
 0.01204216 0.03431117 0.0229029  0.0229029  0.00954098 0.01204216
 0.0016819  0.00168932 0.00168961 0.00168189 0.00169002 0.00408026
 0.00529715 0.00177297 0.00559354 0.00168188 0.005082   0.00168188
 0.00168198 0.00564725 0.00168189 0.00168931 0.00168189 0.00168189
 0.00553794 0.00168931 0.00168191 0.00169077 0.00168191 0.00168187
 0.00168189 0.00714076 0.01521562 0.00416344 0.00175424 0.01544562
 0.00719186 0.00168197 0.00168961 0.00706649 0.00175454 0.00416578
 0.01351148 0.00179609 0.00168188 0.00168187 0.00554447 0.00692824
 0.00527533 0.00168198 0.00663275 0.00224205 0.00168942 0.00862858
 0.00175426 0.00496803 0.01164153 0.00175427 0.00175479 0.00663275
 0.00224119 0.00168189 0.02486654 0.02498804 0.00809974 0.00692817
 0.00325613 0.0174642  0.01746414 0.01047255 0.00254025 0.00175425
 0.00481173 0.02330314 0.00692842 0.00480819 0.00294638 0.003149
 0.00173923 0.00173924 0.00173929 0.00173928 0.00173925 0.00740017
 0.02242302 0.00173924 0.00174119 0.00175432 0.00224679 0.00175427
 0.01746413 0.00652435 0.03585679 0.00676989 0.01746413 0.01490665
 0.00643843 0.00335777 0.00643843 0.00175427 0.01746413 0.00209843
 0.00176133 0.00176135 0.00173924 0.00209841 0.00912779 0.01181489
 0.00378748 0.00175425 0.00173927 0.00335496 0.00176123 0.00202284
 0.00235114 0.00330543 0.00740018 0.04823632 0.00209441 0.02691406
 0.00575635 0.00235123 0.00434247 0.00204708 0.00231153 0.00243692
 0.01426648 0.00369287 0.0157377  0.00235114 0.00235116 0.00235114
 0.00215526 0.00335492 0.00235114 0.00231152 0.00235114 0.00235113
 0.00235121 0.00644064 0.00198562 0.01905526 0.00857486 0.01875425
 0.00505989 0.00295923 0.02110145 0.01907877 0.00233964 0.00201785
 0.00247955 0.01743542 0.01743505 0.00231153 0.01700479 0.09796982
 0.00235145 0.00168829 0.01152836 0.02147716 0.00207908 0.00207907
 0.00207907 0.00187717 0.00224441 0.0153447  0.02494056 0.02449153
 0.00550147 0.00232201 0.0050519  0.00168825 0.00468334 0.00733673
 0.00221054 0.00719771 0.00235146 0.09797058 0.00168825 0.00733664
 0.00232189 0.01479868 0.00207907 0.00187729 0.00221068 0.00536911
 0.01806625 0.00187719 0.00187717 0.00187715 0.01163234 0.1673515
 0.6726013  0.00207908 0.06316533 0.0018772  0.01815396 0.00485007
 0.03004089 0.00529201 0.00187718 0.00196533 0.00433538 0.00238659
 0.24837951 0.00555942 0.03364374 0.0050141  0.01218036 0.00528282
 0.01331818 0.0189171  0.00646336 0.00498593 0.01049139 0.00235027
 0.00235044 0.03432517 0.06965155 0.02820006 0.00528288 0.00646341
 0.00528288 0.00223522 0.00228682 0.00228683 0.00218829 0.01003702
 0.00252632 0.00228683 0.00223508 0.00642079 0.00228683 0.00228682
 0.00208945 0.00727352 0.00796271 0.02873095 0.00228683 0.00890846
 0.00642082 0.00228683 0.00220556 0.00438779 0.00236411 0.00236412
 0.02152409 0.00438777 0.00228683 0.00438774 0.00462388 0.0313637
 0.02370355 0.00228683 0.12552641 0.00440005 0.00440001 0.00727359
 0.00203879 0.00513784 0.00220555 0.00611667 0.00217926 0.02128058
 0.00560145 0.02128056 0.03283728 0.00240973 0.00560144 0.00216905
 0.00216906 0.03811497 0.00216909 0.02171911 0.00202227 0.02209942
 0.00498419 0.00240981 0.00497285 0.01989961 0.03339589 0.01821218
 0.00216914 0.0051991  0.0059907  0.00216912 0.01059982 0.04413346
 0.00519908 0.00240994 0.00216906 0.04328746 0.00216907 0.00216924
 0.00216909 0.00232168 0.01423016 0.00232166 0.00657509 0.00232172
 0.01275612 0.01671986 0.0358003  0.00216909 0.00216912 0.00384183
 0.00216907 0.14864156 0.00524586 0.00232167 0.00216922 0.00216906
 0.00216911 0.01207643 0.00216913 0.00216909 0.00250762 0.00524415
 0.00356509 0.03277193 0.00250776 0.00216909 0.00216906 0.01059735
 0.01496012 0.01489034 0.01489028 0.00285027 0.02583602 0.00568032
 0.00626457 0.1594481  0.01489039 0.0030462  0.01489028 0.00575264
 0.00626272 0.0148904  0.00434492 0.00356525 0.007258   0.00440693
 0.00449435 0.00541072 0.00553575 0.00444861 0.00712206 0.00712205
 0.0044486  0.00712206 0.00712419 0.00712197 0.00712197 0.02653477
 0.007122   0.00712198 0.00712198 0.007122  ]
2025-06-03 10:13:11,861 - DEBUG - Edge reconstruction errors: [0.1562632  1.6581181  1.6590539  ... 0.1559883  1.253809   0.15601848]
2025-06-03 10:13:11,863 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101311_update_34.json
2025-06-03 10:13:11,863 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:13:11,877 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101311_update_34.pth and as latest_checkpoint.pth
2025-06-03 10:13:11,878 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.3169
2025-06-03 10:13:11,878 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 10:13:11,878 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.3008, MLP Score: 0.5105
2025-06-03 10:13:11,878 - WARNING -   Node ID: 113.171.12.211, Recon Error: 0.1171, MLP Score: 0.5128
2025-06-03 10:13:11,878 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2452, MLP Score: 0.5073
2025-06-03 10:13:11,878 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3970, MLP Score: 0.5073
2025-06-03 10:13:11,878 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.2286, MLP Score: 0.4971
2025-06-03 10:13:11,878 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-03 10:13:11,878 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7738, MLP Score: 0.4933
2025-06-03 10:13:11,878 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.2627, MLP Score: 0.4986
2025-06-03 10:13:11,878 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4543, MLP Score: 0.4991
2025-06-03 10:13:11,878 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4439, MLP Score: 0.4996
2025-06-03 10:13:11,878 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.0541, MLP Score: 0.4978
2025-06-03 10:13:11,878 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-03 10:13:11,879 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-03 10:13:11,879 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-03 10:13:11,912 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-03 10:13:11,937 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-03 10:13:11,937 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-03 10:13:11,937 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-03 10:13:11,955 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-03 10:13:11,975 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-03 10:13:11,975 - INFO - Processing node updates/additions.
2025-06-03 10:13:11,980 - INFO - Processing edge updates/additions.
2025-06-03 10:13:11,990 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:13:11,991 - INFO - Finished updating NetworkX graph.
2025-06-03 10:13:11,992 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:13:11,993 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:13:12,002 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-03 10:13:12,003 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:13:12,003 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-03 10:13:12,005 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-03 10:13:12,006 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:13:12,010 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:13:12,011 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:13:12,012 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:13:12,013 - DEBUG - Shape of encoded categorical edge features: torch.Size([2034, 3])
2025-06-03 10:13:12,014 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:13:12,015 - DEBUG - Shape of scaled numerical edge features: torch.Size([2034, 7])
2025-06-03 10:13:12,015 - DEBUG - Final edge attributes tensor shape: torch.Size([2034, 10])
2025-06-03 10:13:12,015 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:13:12,017 - INFO - Performing online update...
2025-06-03 10:13:12,017 - INFO - Starting online update for 50 steps.
2025-06-03 10:13:12,018 - DEBUG - Updated RunningStats: new_mean=0.9509692548146988, new_var=19800000000161.91, new_n=2010
2025-06-03 10:13:12,018 - DEBUG - Updated RunningStats: new_mean=0.9478386199428853, new_var=20100000000018.004, new_n=2040
2025-06-03 10:13:12,018 - DEBUG - Updated RunningStats: new_mean=1.1882711084586557, new_var=6600000000093.522, new_n=670
2025-06-03 10:13:12,018 - DEBUG - Updated RunningStats: new_mean=1.186667459731952, new_var=6700000000001.675, new_n=680
2025-06-03 10:13:12,018 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:13:12,018 - DEBUG - Online update step: 1/50
2025-06-03 10:13:12,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:12,660 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:13:12,672 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:13:12,673 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:13,342 - DEBUG - Step 1: Loss=0.5976
2025-06-03 10:13:13,343 - DEBUG - Online update step: 2/50
2025-06-03 10:13:13,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:13,928 - DEBUG - Node anomaly scores shape: torch.Size([21380, 1])
2025-06-03 10:13:13,939 - DEBUG - Edge anomaly scores shape: torch.Size([44682, 1])
2025-06-03 10:13:13,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:14,541 - DEBUG - Step 2: Loss=0.5971
2025-06-03 10:13:14,541 - DEBUG - Online update step: 3/50
2025-06-03 10:13:14,544 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:15,111 - DEBUG - Node anomaly scores shape: torch.Size([21622, 1])
2025-06-03 10:13:15,123 - DEBUG - Edge anomaly scores shape: torch.Size([45241, 1])
2025-06-03 10:13:15,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:15,748 - DEBUG - Step 3: Loss=0.5965
2025-06-03 10:13:15,748 - DEBUG - Online update step: 4/50
2025-06-03 10:13:15,751 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:16,281 - DEBUG - Node anomaly scores shape: torch.Size([21207, 1])
2025-06-03 10:13:16,291 - DEBUG - Edge anomaly scores shape: torch.Size([44270, 1])
2025-06-03 10:13:16,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:16,883 - DEBUG - Step 4: Loss=0.5969
2025-06-03 10:13:16,883 - DEBUG - Online update step: 5/50
2025-06-03 10:13:16,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:17,413 - DEBUG - Node anomaly scores shape: torch.Size([21518, 1])
2025-06-03 10:13:17,423 - DEBUG - Edge anomaly scores shape: torch.Size([45021, 1])
2025-06-03 10:13:17,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:18,045 - DEBUG - Step 5: Loss=0.5966
2025-06-03 10:13:18,045 - DEBUG - Online update step: 6/50
2025-06-03 10:13:18,048 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:18,591 - DEBUG - Node anomaly scores shape: torch.Size([21304, 1])
2025-06-03 10:13:18,602 - DEBUG - Edge anomaly scores shape: torch.Size([44474, 1])
2025-06-03 10:13:18,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:19,214 - DEBUG - Step 6: Loss=0.5955
2025-06-03 10:13:19,214 - DEBUG - Online update step: 7/50
2025-06-03 10:13:19,217 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:19,724 - DEBUG - Node anomaly scores shape: torch.Size([21162, 1])
2025-06-03 10:13:19,735 - DEBUG - Edge anomaly scores shape: torch.Size([44177, 1])
2025-06-03 10:13:19,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:20,305 - DEBUG - Step 7: Loss=0.5950
2025-06-03 10:13:20,306 - DEBUG - Online update step: 8/50
2025-06-03 10:13:20,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:20,840 - DEBUG - Node anomaly scores shape: torch.Size([21260, 1])
2025-06-03 10:13:20,851 - DEBUG - Edge anomaly scores shape: torch.Size([44398, 1])
2025-06-03 10:13:20,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:21,437 - DEBUG - Step 8: Loss=0.5962
2025-06-03 10:13:21,437 - DEBUG - Online update step: 9/50
2025-06-03 10:13:21,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:21,967 - DEBUG - Node anomaly scores shape: torch.Size([21009, 1])
2025-06-03 10:13:21,977 - DEBUG - Edge anomaly scores shape: torch.Size([43867, 1])
2025-06-03 10:13:21,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:22,601 - DEBUG - Step 9: Loss=0.5953
2025-06-03 10:13:22,601 - DEBUG - Online update step: 10/50
2025-06-03 10:13:22,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:23,150 - DEBUG - Node anomaly scores shape: torch.Size([21201, 1])
2025-06-03 10:13:23,160 - DEBUG - Edge anomaly scores shape: torch.Size([44289, 1])
2025-06-03 10:13:23,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:23,772 - DEBUG - Step 10: Loss=0.5944
2025-06-03 10:13:23,773 - DEBUG - Online update step: 11/50
2025-06-03 10:13:23,775 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:24,324 - DEBUG - Node anomaly scores shape: torch.Size([21670, 1])
2025-06-03 10:13:24,335 - DEBUG - Edge anomaly scores shape: torch.Size([45289, 1])
2025-06-03 10:13:24,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:24,930 - DEBUG - Step 11: Loss=0.5938
2025-06-03 10:13:24,931 - DEBUG - Online update step: 12/50
2025-06-03 10:13:24,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:25,483 - DEBUG - Node anomaly scores shape: torch.Size([21690, 1])
2025-06-03 10:13:25,494 - DEBUG - Edge anomaly scores shape: torch.Size([45375, 1])
2025-06-03 10:13:25,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:26,107 - DEBUG - Step 12: Loss=0.5943
2025-06-03 10:13:26,108 - DEBUG - Online update step: 13/50
2025-06-03 10:13:26,112 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:26,681 - DEBUG - Node anomaly scores shape: torch.Size([21754, 1])
2025-06-03 10:13:26,694 - DEBUG - Edge anomaly scores shape: torch.Size([45592, 1])
2025-06-03 10:13:26,696 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:27,306 - DEBUG - Step 13: Loss=0.5932
2025-06-03 10:13:27,306 - DEBUG - Online update step: 14/50
2025-06-03 10:13:27,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:27,824 - DEBUG - Node anomaly scores shape: torch.Size([21139, 1])
2025-06-03 10:13:27,839 - DEBUG - Edge anomaly scores shape: torch.Size([44150, 1])
2025-06-03 10:13:27,841 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:28,467 - DEBUG - Step 14: Loss=0.5937
2025-06-03 10:13:28,467 - DEBUG - Online update step: 15/50
2025-06-03 10:13:28,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:29,038 - DEBUG - Node anomaly scores shape: torch.Size([21753, 1])
2025-06-03 10:13:29,049 - DEBUG - Edge anomaly scores shape: torch.Size([45536, 1])
2025-06-03 10:13:29,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:29,661 - DEBUG - Step 15: Loss=0.5932
2025-06-03 10:13:29,662 - DEBUG - Online update step: 16/50
2025-06-03 10:13:29,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:30,225 - DEBUG - Node anomaly scores shape: torch.Size([22311, 1])
2025-06-03 10:13:30,236 - DEBUG - Edge anomaly scores shape: torch.Size([46816, 1])
2025-06-03 10:13:30,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:30,863 - DEBUG - Step 16: Loss=0.5927
2025-06-03 10:13:30,863 - DEBUG - Online update step: 17/50
2025-06-03 10:13:30,865 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:31,392 - DEBUG - Node anomaly scores shape: torch.Size([21296, 1])
2025-06-03 10:13:31,403 - DEBUG - Edge anomaly scores shape: torch.Size([44493, 1])
2025-06-03 10:13:31,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:32,064 - DEBUG - Step 17: Loss=0.5920
2025-06-03 10:13:32,065 - DEBUG - Online update step: 18/50
2025-06-03 10:13:32,069 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:32,595 - DEBUG - Node anomaly scores shape: torch.Size([21598, 1])
2025-06-03 10:13:32,606 - DEBUG - Edge anomaly scores shape: torch.Size([45245, 1])
2025-06-03 10:13:32,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:33,255 - DEBUG - Step 18: Loss=0.5923
2025-06-03 10:13:33,256 - DEBUG - Online update step: 19/50
2025-06-03 10:13:33,259 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:33,765 - DEBUG - Node anomaly scores shape: torch.Size([21070, 1])
2025-06-03 10:13:33,775 - DEBUG - Edge anomaly scores shape: torch.Size([43960, 1])
2025-06-03 10:13:33,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:34,363 - DEBUG - Step 19: Loss=0.5920
2025-06-03 10:13:34,363 - DEBUG - Online update step: 20/50
2025-06-03 10:13:34,367 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:34,887 - DEBUG - Node anomaly scores shape: torch.Size([20996, 1])
2025-06-03 10:13:34,897 - DEBUG - Edge anomaly scores shape: torch.Size([43829, 1])
2025-06-03 10:13:34,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:35,487 - DEBUG - Step 20: Loss=0.5911
2025-06-03 10:13:35,488 - DEBUG - Online update step: 21/50
2025-06-03 10:13:35,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:36,051 - DEBUG - Node anomaly scores shape: torch.Size([21555, 1])
2025-06-03 10:13:36,062 - DEBUG - Edge anomaly scores shape: torch.Size([45078, 1])
2025-06-03 10:13:36,064 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:36,641 - DEBUG - Step 21: Loss=0.5909
2025-06-03 10:13:36,642 - DEBUG - Online update step: 22/50
2025-06-03 10:13:36,646 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:37,205 - DEBUG - Node anomaly scores shape: torch.Size([21861, 1])
2025-06-03 10:13:37,216 - DEBUG - Edge anomaly scores shape: torch.Size([45839, 1])
2025-06-03 10:13:37,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:37,854 - DEBUG - Step 22: Loss=0.5916
2025-06-03 10:13:37,855 - DEBUG - Online update step: 23/50
2025-06-03 10:13:37,859 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:38,435 - DEBUG - Node anomaly scores shape: torch.Size([21658, 1])
2025-06-03 10:13:38,446 - DEBUG - Edge anomaly scores shape: torch.Size([45402, 1])
2025-06-03 10:13:38,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:39,116 - DEBUG - Step 23: Loss=0.5908
2025-06-03 10:13:39,116 - DEBUG - Online update step: 24/50
2025-06-03 10:13:39,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:39,706 - DEBUG - Node anomaly scores shape: torch.Size([21270, 1])
2025-06-03 10:13:39,717 - DEBUG - Edge anomaly scores shape: torch.Size([44474, 1])
2025-06-03 10:13:39,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:40,332 - DEBUG - Step 24: Loss=0.5903
2025-06-03 10:13:40,332 - DEBUG - Online update step: 25/50
2025-06-03 10:13:40,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:40,870 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-03 10:13:40,882 - DEBUG - Edge anomaly scores shape: torch.Size([44200, 1])
2025-06-03 10:13:40,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:41,467 - DEBUG - Step 25: Loss=0.5899
2025-06-03 10:13:41,467 - DEBUG - Online update step: 26/50
2025-06-03 10:13:41,471 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:42,075 - DEBUG - Node anomaly scores shape: torch.Size([22403, 1])
2025-06-03 10:13:42,087 - DEBUG - Edge anomaly scores shape: torch.Size([47066, 1])
2025-06-03 10:13:42,089 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:42,785 - DEBUG - Step 26: Loss=0.5902
2025-06-03 10:13:42,785 - DEBUG - Online update step: 27/50
2025-06-03 10:13:42,788 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:43,328 - DEBUG - Node anomaly scores shape: torch.Size([21245, 1])
2025-06-03 10:13:43,339 - DEBUG - Edge anomaly scores shape: torch.Size([44393, 1])
2025-06-03 10:13:43,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:43,955 - DEBUG - Step 27: Loss=0.5896
2025-06-03 10:13:43,955 - DEBUG - Online update step: 28/50
2025-06-03 10:13:43,958 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:44,516 - DEBUG - Node anomaly scores shape: torch.Size([21809, 1])
2025-06-03 10:13:44,528 - DEBUG - Edge anomaly scores shape: torch.Size([45682, 1])
2025-06-03 10:13:44,530 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:45,183 - DEBUG - Step 28: Loss=0.5892
2025-06-03 10:13:45,183 - DEBUG - Online update step: 29/50
2025-06-03 10:13:45,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:45,718 - DEBUG - Node anomaly scores shape: torch.Size([21604, 1])
2025-06-03 10:13:45,731 - DEBUG - Edge anomaly scores shape: torch.Size([45216, 1])
2025-06-03 10:13:45,732 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:46,369 - DEBUG - Step 29: Loss=0.5886
2025-06-03 10:13:46,369 - DEBUG - Online update step: 30/50
2025-06-03 10:13:46,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:46,864 - DEBUG - Node anomaly scores shape: torch.Size([20966, 1])
2025-06-03 10:13:46,875 - DEBUG - Edge anomaly scores shape: torch.Size([43740, 1])
2025-06-03 10:13:46,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:47,455 - DEBUG - Step 30: Loss=0.5900
2025-06-03 10:13:47,455 - DEBUG - Online update step: 31/50
2025-06-03 10:13:47,459 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:47,972 - DEBUG - Node anomaly scores shape: torch.Size([21251, 1])
2025-06-03 10:13:47,982 - DEBUG - Edge anomaly scores shape: torch.Size([44386, 1])
2025-06-03 10:13:47,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:48,583 - DEBUG - Step 31: Loss=0.5896
2025-06-03 10:13:48,583 - DEBUG - Online update step: 32/50
2025-06-03 10:13:48,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:49,336 - DEBUG - Node anomaly scores shape: torch.Size([21303, 1])
2025-06-03 10:13:49,377 - DEBUG - Edge anomaly scores shape: torch.Size([44478, 1])
2025-06-03 10:13:49,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:50,591 - DEBUG - Step 32: Loss=0.5876
2025-06-03 10:13:50,591 - DEBUG - Online update step: 33/50
2025-06-03 10:13:50,594 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:51,546 - DEBUG - Node anomaly scores shape: torch.Size([21215, 1])
2025-06-03 10:13:51,567 - DEBUG - Edge anomaly scores shape: torch.Size([44321, 1])
2025-06-03 10:13:51,568 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:52,476 - DEBUG - Step 33: Loss=0.5875
2025-06-03 10:13:52,476 - DEBUG - Online update step: 34/50
2025-06-03 10:13:52,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:53,585 - DEBUG - Node anomaly scores shape: torch.Size([21251, 1])
2025-06-03 10:13:53,603 - DEBUG - Edge anomaly scores shape: torch.Size([44366, 1])
2025-06-03 10:13:53,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:54,626 - DEBUG - Step 34: Loss=0.5885
2025-06-03 10:13:54,626 - DEBUG - Online update step: 35/50
2025-06-03 10:13:54,632 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:55,476 - DEBUG - Node anomaly scores shape: torch.Size([21416, 1])
2025-06-03 10:13:55,494 - DEBUG - Edge anomaly scores shape: torch.Size([44760, 1])
2025-06-03 10:13:55,496 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:56,407 - DEBUG - Step 35: Loss=0.5875
2025-06-03 10:13:56,407 - DEBUG - Online update step: 36/50
2025-06-03 10:13:56,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:57,277 - DEBUG - Node anomaly scores shape: torch.Size([21675, 1])
2025-06-03 10:13:57,289 - DEBUG - Edge anomaly scores shape: torch.Size([45453, 1])
2025-06-03 10:13:57,291 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:58,167 - DEBUG - Step 36: Loss=0.5885
2025-06-03 10:13:58,168 - DEBUG - Online update step: 37/50
2025-06-03 10:13:58,171 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:13:58,856 - DEBUG - Node anomaly scores shape: torch.Size([21717, 1])
2025-06-03 10:13:58,867 - DEBUG - Edge anomaly scores shape: torch.Size([45455, 1])
2025-06-03 10:13:58,869 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:13:59,518 - DEBUG - Step 37: Loss=0.5884
2025-06-03 10:13:59,518 - DEBUG - Online update step: 38/50
2025-06-03 10:13:59,521 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:00,122 - DEBUG - Node anomaly scores shape: torch.Size([21660, 1])
2025-06-03 10:14:00,135 - DEBUG - Edge anomaly scores shape: torch.Size([45335, 1])
2025-06-03 10:14:00,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:00,836 - DEBUG - Step 38: Loss=0.5864
2025-06-03 10:14:00,836 - DEBUG - Online update step: 39/50
2025-06-03 10:14:00,839 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:01,493 - DEBUG - Node anomaly scores shape: torch.Size([21285, 1])
2025-06-03 10:14:01,504 - DEBUG - Edge anomaly scores shape: torch.Size([44513, 1])
2025-06-03 10:14:01,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:02,146 - DEBUG - Step 39: Loss=0.5868
2025-06-03 10:14:02,146 - DEBUG - Online update step: 40/50
2025-06-03 10:14:02,150 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:02,734 - DEBUG - Node anomaly scores shape: torch.Size([21169, 1])
2025-06-03 10:14:02,746 - DEBUG - Edge anomaly scores shape: torch.Size([44176, 1])
2025-06-03 10:14:02,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:03,478 - DEBUG - Step 40: Loss=0.5878
2025-06-03 10:14:03,478 - DEBUG - Online update step: 41/50
2025-06-03 10:14:03,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:04,161 - DEBUG - Node anomaly scores shape: torch.Size([21562, 1])
2025-06-03 10:14:04,171 - DEBUG - Edge anomaly scores shape: torch.Size([45090, 1])
2025-06-03 10:14:04,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:04,786 - DEBUG - Step 41: Loss=0.5858
2025-06-03 10:14:04,786 - DEBUG - Online update step: 42/50
2025-06-03 10:14:04,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:05,352 - DEBUG - Node anomaly scores shape: torch.Size([21169, 1])
2025-06-03 10:14:05,370 - DEBUG - Edge anomaly scores shape: torch.Size([44176, 1])
2025-06-03 10:14:05,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:06,203 - DEBUG - Step 42: Loss=0.5868
2025-06-03 10:14:06,204 - DEBUG - Online update step: 43/50
2025-06-03 10:14:06,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:06,809 - DEBUG - Node anomaly scores shape: torch.Size([21904, 1])
2025-06-03 10:14:06,820 - DEBUG - Edge anomaly scores shape: torch.Size([45851, 1])
2025-06-03 10:14:06,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:07,554 - DEBUG - Step 43: Loss=0.5864
2025-06-03 10:14:07,554 - DEBUG - Online update step: 44/50
2025-06-03 10:14:07,559 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:08,143 - DEBUG - Node anomaly scores shape: torch.Size([21073, 1])
2025-06-03 10:14:08,155 - DEBUG - Edge anomaly scores shape: torch.Size([43992, 1])
2025-06-03 10:14:08,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:08,821 - DEBUG - Step 44: Loss=0.5867
2025-06-03 10:14:08,821 - DEBUG - Online update step: 45/50
2025-06-03 10:14:08,826 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:09,678 - DEBUG - Node anomaly scores shape: torch.Size([21808, 1])
2025-06-03 10:14:09,701 - DEBUG - Edge anomaly scores shape: torch.Size([45716, 1])
2025-06-03 10:14:09,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:10,846 - DEBUG - Step 45: Loss=0.5859
2025-06-03 10:14:10,847 - DEBUG - Online update step: 46/50
2025-06-03 10:14:10,859 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:11,811 - DEBUG - Node anomaly scores shape: torch.Size([21257, 1])
2025-06-03 10:14:11,842 - DEBUG - Edge anomaly scores shape: torch.Size([44419, 1])
2025-06-03 10:14:11,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:12,742 - DEBUG - Step 46: Loss=0.5851
2025-06-03 10:14:12,743 - DEBUG - Online update step: 47/50
2025-06-03 10:14:12,750 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:13,468 - DEBUG - Node anomaly scores shape: torch.Size([21148, 1])
2025-06-03 10:14:13,483 - DEBUG - Edge anomaly scores shape: torch.Size([44155, 1])
2025-06-03 10:14:13,484 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:14,241 - DEBUG - Step 47: Loss=0.5850
2025-06-03 10:14:14,241 - DEBUG - Online update step: 48/50
2025-06-03 10:14:14,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:14,993 - DEBUG - Node anomaly scores shape: torch.Size([20996, 1])
2025-06-03 10:14:15,012 - DEBUG - Edge anomaly scores shape: torch.Size([43829, 1])
2025-06-03 10:14:15,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:15,851 - DEBUG - Step 48: Loss=0.5871
2025-06-03 10:14:15,852 - DEBUG - Online update step: 49/50
2025-06-03 10:14:15,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:16,806 - DEBUG - Node anomaly scores shape: torch.Size([21169, 1])
2025-06-03 10:14:16,829 - DEBUG - Edge anomaly scores shape: torch.Size([44176, 1])
2025-06-03 10:14:16,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:17,913 - DEBUG - Step 49: Loss=0.5853
2025-06-03 10:14:17,913 - DEBUG - Online update step: 50/50
2025-06-03 10:14:17,917 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:18,851 - DEBUG - Node anomaly scores shape: torch.Size([21337, 1])
2025-06-03 10:14:18,878 - DEBUG - Edge anomaly scores shape: torch.Size([44567, 1])
2025-06-03 10:14:18,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:19,804 - DEBUG - Step 50: Loss=0.5853
2025-06-03 10:14:19,804 - INFO - Online update finished. Average loss: 0.5906, Learning rate: 0.001000
2025-06-03 10:14:19,805 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.2122978e-08 -4.0409929e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.1720338e-08
 -1.0102482e-08  1.5532565e-08 -1.1112730e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -1.3512070e-08  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.5256206e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.0409929e-09 -1.8184467e-08], current edge mean: [ 9.1450348e+00  1.4105211e+00  5.6882987e+00 -2.3443321e-09
 -3.7509316e-09  2.8131986e-09 -4.6886645e-10 -1.8754658e-09
  1.8754658e-09  4.6886641e-09]
2025-06-03 10:14:19,806 - DEBUG - Node drift difference: 0.0128, Edge drift difference: 0.0027
2025-06-03 10:14:19,807 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.2122978e-08 -4.0409929e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.1720338e-08
 -1.0102482e-08  1.5532565e-08 -1.1112730e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -1.3512070e-08  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.5256206e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.0409929e-09 -1.8184467e-08], edge=[ 9.1450348e+00  1.4105211e+00  5.6882987e+00 -2.3443321e-09
 -3.7509316e-09  2.8131986e-09 -4.6886645e-10 -1.8754658e-09
  1.8754658e-09  4.6886641e-09]
2025-06-03 10:14:19,807 - DEBUG - Updated reference std: node=[0.         0.         1.0005301  1.0005301  0.         0.
 0.         1.0005301  1.0005301  1.0005301  1.0005301  1.0005301
 1.0107334  0.27367172 0.36063462 0.5744843  1.0005301  2.9573143
 2.8775678  1.49335    0.36063462 0.22783059 1.0005301  1.0005301
 0.         0.         0.         0.         1.00053    1.00053   ], edge=[1.1191256  0.50487775 2.166505   1.0002459  1.0002459  1.0002459
 1.0002459  1.0002459  1.0002459  1.0002459 ]
2025-06-03 10:14:19,808 - INFO - Online update complete. Loss: 0.5906
2025-06-03 10:14:19,809 - INFO - Running anomaly detection...
2025-06-03 10:14:19,809 - INFO - Starting anomaly detection.
2025-06-03 10:14:19,846 - DEBUG - Node reconstruction errors: [0.00935374 0.00192738 0.0041028  0.00261474 0.00187007 0.1377586
 0.02492278 0.00252029 0.01000168 0.01849804 0.00715795 0.00314233
 0.00559777 0.00300832 0.03040693 0.00417943 0.01409356 0.01422526
 0.00293509 0.06391858 0.01422522 0.0132261  0.00365198 0.00814607
 0.01207927 0.01401513 0.00421681 0.00322267 0.01422526 0.01945157
 0.00351349 0.01401513 0.00315222 0.02197723 0.00992241 0.00195709
 0.34148425 0.00391045 0.01891632 0.00696595 0.01020172 0.00552642
 0.00955527 0.00300834 0.00572913 0.02744287 0.24611452 0.0078374
 0.00897282 0.01098994 0.01608288 0.00365198 0.00320898 0.00391046
 0.01401513 0.01309318 0.01015726 0.00284458 0.01980256 0.00454589
 0.05548892 0.02074516 0.06771152 0.00419387 0.01541346 0.00523629
 0.00642474 0.00365198 0.01098954 0.01339266 0.01867528 0.01241668
 0.02326571 0.00695486 0.09495395 0.0108234  0.01098995 0.05521892
 0.10360207 0.02174156 0.00298678 0.00445344 0.0032856  0.0055664
 0.00404403 0.01445106 0.00413138 0.00897243 0.00926102 0.06587993
 0.00182901 0.01123242 0.00198646 0.00287927 0.00215751 0.0162608
 0.00314142 0.00197295 0.00280892 0.0234572  0.00238663 0.00314149
 0.0018091  0.09912688 0.007986   0.01665418 0.00575719 0.02629482
 0.00160994 0.00917447 0.0360304  0.00256725 0.00783841 0.00691916
 0.00208468 0.00247086 0.00136265 0.00735559 0.00230353 0.00203152
 0.00178244 0.00239881 0.00253112 0.00116816 0.00308003 0.00203151
 0.00151641 0.00753796 0.00214671 0.00240768 0.00406015 0.00200889
 0.03032494 0.0399499  0.00125305 0.01636601 0.00266752 0.00316574
 0.0141166  0.00510424 0.00332449 0.02875535 0.00182732 0.00262657
 0.0033269  0.00726468 0.00136265 0.01280416 0.0040262  0.00465704
 0.09882124 0.00770432 0.00379048 0.00200889 0.00534006 0.00483962
 0.00215126 0.00245476 0.00238662 0.0019071  0.00331711 0.00473924
 0.00215129 0.00406016 0.00163483 0.00505309 0.00339745 0.00202125
 0.00466877 0.00465716 0.00322817 0.00206577 0.00204985 0.01247978
 0.00230353 0.00194218 0.0016024  0.00341546 0.00137914 0.00137914
 0.0173551  0.00366394 0.00664308 0.00804843 0.0100457  0.00126446
 0.00187304 0.00132784 0.01710677 0.00178891 0.00611606 0.00236615
 0.00584701 0.00221919 0.01411495 0.00316903 0.16284923 0.00224465
 0.0101438  0.00185648 0.00126568 0.00215129 0.00681809 0.00276168
 0.00265164 0.00335144 0.02234814 0.05715557 0.00265753 0.00310558
 0.00108383 0.00776329 0.0030928  0.00195313 0.00249774 0.0025847
 0.00199418 0.00136265 0.06516892 0.00221919 0.00520639 0.00187304
 0.00225074 0.00309279 0.00215126 0.00327906 0.00597491 0.00239927
 0.00225768 0.00571793 0.00408925 0.00265565 0.00316612 0.00136266
 0.00136264 0.00276909 0.00125815 0.00225074 0.00215129 0.00245286
 0.00396345 0.0043938  0.00207007 0.00322243 0.00214943 0.00350068
 0.00083952 0.00500611 0.00207007 0.00200288 0.00204988 0.00281293
 0.06516893 0.00129443 0.00367376 0.00592118 0.00177898 0.00277527
 0.00219626 0.00137914 0.00248655 0.01087591 0.01347864 0.00158153
 0.00150008 0.00275026 0.00373839 0.03867985 0.00373839 0.00138257
 0.02634194 0.00380201 0.00103379 0.00109093 0.00244903 0.02491672
 0.00144857 0.03488033 0.01735518 0.00160354 0.03303521 0.00153562
 0.00233212 0.00284758 0.00351325 0.00369973 0.03314912 0.00459402
 0.00366395 0.00436143 0.0021651  0.0037923  0.0391254  0.00214944
 0.02703464 0.00337812 0.00088017 0.00137925 0.00315659 0.00947923
 0.00163129 0.00262099 0.0021111  0.00183607 0.00315514 0.00315514
 0.00315514 0.00283709 0.00261447 0.00262098 0.00315514 0.0060614
 0.00315513 0.00153718 0.00276348 0.00163335 0.0654681  0.00222698
 0.00289418 0.0032862  0.00451423 0.00176206 0.00260827 0.00211111
 0.02500914 0.00558818 0.07689158 0.00584714 0.00288904 0.00288903
 0.08640876 0.00309791 0.00315513 0.00244903 0.00315514 0.00283709
 0.00202282 0.00278764 0.00298644 0.00273913 0.00262094 0.00528603
 0.00273913 0.00348448 0.00108302 0.00199413 0.00211111 0.00391288
 0.00527292 0.00183748 0.00315514 0.0014279  0.00803146 0.00370699
 0.00584914 0.00177893 0.00262097 0.00315513 0.00319668 0.01376234
 0.00572144 0.00220268 0.01191963 0.00205346 0.00211111 0.00817298
 0.00178572 0.01058729 0.00089681 0.00092663 0.00103075 0.00208026
 0.00260753 0.00613747 0.0025882  0.00370693 0.00197889 0.00256129
 0.00974949 0.00315514 0.0021111  0.00347809 0.00135752 0.00227106
 0.00277253 0.00221546 0.02220489 0.00542612 0.00493684 0.00315515
 0.03226265 0.00166626 0.00103021 0.00487205 0.00424827 0.00424827
 0.00424827 0.00481737 0.00301799 0.00476573 0.00140984 0.01963112
 0.00784038 0.00301801 0.00095178 0.00103018 0.00260836 0.00134673
 0.00103021 0.02270154 0.00424828 0.00103021 0.003018   0.00424827
 0.00424827 0.00717569 0.00639359 0.00424827 0.00198131 0.00218394
 0.00184784 0.00201266 0.00086764 0.00123266 0.00223164 0.00183228
 0.00236629 0.00298313 0.00727373 0.00328945 0.00303937 0.01919327
 0.00337838 0.00393598 0.01795089 0.00424827 0.00140842 0.00353371
 0.002142   0.00132095 0.00220883 0.00275657 0.00679881 0.00190677
 0.00183806 0.00568471 0.03268614 0.00129013 0.00263916 0.00122649
 0.00167973 0.00181373 0.00141195 0.00253411 0.00181372 0.01969291
 0.0012255  0.00237041 0.00320032 0.00277742 0.00093602 0.00145976
 0.00134555 0.00343782 0.00134628 0.00145976 0.00235168 0.00288811
 0.00176074 0.00255442 0.00235167 0.000936   0.00225458 0.01613052
 0.00166754 0.00086756 0.00288811 0.00093601 0.00166821 0.00189734
 0.003026   0.05305841 0.00236143 0.00129049 0.00231089 0.00298355
 0.00181372 0.00237605 0.0124987  0.01590557 0.00095728 0.00166822
 0.00222701 0.00177911 0.00387881 0.00129171 0.00114625 0.01501262
 0.00297849 0.00189725 0.00828912 0.00177896 0.00949607 0.00149885
 0.00233891 0.00214084 0.00279957 0.04265726 0.00194908 0.00181371
 0.00387554 0.00225479 0.0022548  0.00213405 0.00459653 0.00237629
 0.00279957 0.00242662 0.00296813 0.00176922 0.0068481  0.00275657
 0.00279958 0.0033106  0.00233885 0.00114625 0.00381545 0.00381647
 0.00684807 0.00341671 0.00237632 0.0031872  0.0029785  0.00189724
 0.00114625 0.001216   0.00273935 0.00307484 0.0029785  0.00373645
 0.0029785  0.00574505 0.00133127 0.00242662 0.00238339 0.01681353
 0.00184356 0.0028628  0.02371104 0.00286279 0.00286279 0.00286279
 0.0028628  0.00286279 0.00286279 0.00286279 0.00322157 0.00241446
 0.01222701 0.00286279 0.00286278 0.00286279 0.0028628  0.00286279
 0.00286279 0.00286279 0.00286279 0.00286279 0.00270708 0.0028628
 0.00286279 0.00322521 0.00286279 0.00216191 0.00694854 0.0029785
 0.00749126 0.00433541 0.0120436  0.0120436  0.00380981 0.00749126
 0.00297851 0.00279957 0.00279955 0.00297851 0.00279958 0.00434014
 0.00164717 0.00286278 0.00275657 0.00297849 0.00225479 0.00297851
 0.00297851 0.00137866 0.0029785  0.00279957 0.00297851 0.00297851
 0.00242661 0.00279956 0.00297851 0.00279956 0.0029785  0.00297851
 0.0029785  0.00198007 0.00270926 0.0010717  0.00286278 0.02010646
 0.00470529 0.00297851 0.00279957 0.00136372 0.00286279 0.00174771
 0.00157508 0.00279868 0.00297851 0.00297849 0.00103914 0.00227903
 0.00188163 0.00297851 0.00322157 0.00326467 0.00279956 0.00239884
 0.00286279 0.00151885 0.00170832 0.00286279 0.0028628  0.00322157
 0.00326468 0.00297851 0.0179398  0.00500601 0.00124433 0.00227905
 0.00258727 0.0035214  0.00352142 0.00668784 0.00227264 0.00286279
 0.00217014 0.00425389 0.00227904 0.00138805 0.00234292 0.00188636
 0.00267562 0.00267561 0.00267561 0.00267561 0.00267561 0.00312515
 0.00324063 0.00267561 0.00267561 0.00286279 0.00327136 0.00286279
 0.0035214  0.00177136 0.00387109 0.00595524 0.00624385 0.00236184
 0.00270707 0.00166449 0.00270708 0.00286278 0.00352139 0.00224678
 0.00273969 0.00273969 0.00267559 0.00224686 0.00224496 0.00756253
 0.00316506 0.00286278 0.00267561 0.00177862 0.00273969 0.00295496
 0.00162394 0.00231923 0.00312515 0.01267563 0.00235026 0.00835932
 0.00141283 0.00162388 0.00155967 0.00211838 0.0015775  0.00181452
 0.00291974 0.00280977 0.00333063 0.00162395 0.00162393 0.00162395
 0.00152927 0.00177862 0.00162395 0.00157751 0.00162394 0.00162396
 0.00162391 0.00152392 0.0020772  0.00143129 0.00100538 0.00255172
 0.00112661 0.00139466 0.00271472 0.0077038  0.00150787 0.00202784
 0.00177546 0.0225693  0.02256933 0.00157751 0.00907702 0.06299089
 0.00153456 0.00248477 0.00254088 0.01117754 0.00213753 0.00213755
 0.00213756 0.0026325  0.0015536  0.00244022 0.02575197 0.00825573
 0.00285687 0.00164986 0.0019885  0.00248477 0.00103537 0.00132028
 0.00150388 0.00296093 0.00153455 0.06299328 0.00248477 0.00132028
 0.00164978 0.01116519 0.00213755 0.0026325  0.00150382 0.00237703
 0.02295307 0.0026325  0.00263249 0.0026325  0.00410892 0.15571767
 0.3590462  0.00213754 0.03585593 0.0026325  0.00242445 0.00270727
 0.01454769 0.00232757 0.0026325  0.00262371 0.00163507 0.00159676
 0.11333342 0.00232747 0.01037974 0.00328812 0.00399202 0.00232759
 0.00195295 0.02351817 0.00370701 0.00235954 0.00401636 0.00162449
 0.00162461 0.01509739 0.03128905 0.01653784 0.00232759 0.00370701
 0.00232759 0.00130794 0.00143184 0.00143188 0.00145398 0.003501
 0.00136776 0.00143187 0.00130735 0.00319463 0.00143184 0.00143188
 0.00254003 0.00306531 0.00266691 0.00442807 0.00143185 0.00314058
 0.00319464 0.00143188 0.00133636 0.00127833 0.00136186 0.00136185
 0.00856641 0.00127827 0.00143187 0.00127825 0.00211152 0.00647399
 0.02527782 0.00143187 0.07828005 0.00153994 0.00153988 0.00306558
 0.00256799 0.00150731 0.00133637 0.00225729 0.0013115  0.02556229
 0.00210933 0.02556231 0.02221105 0.00144603 0.00210932 0.0028837
 0.0028837  0.01867199 0.00288369 0.00675867 0.00256801 0.02580367
 0.0023337  0.00144627 0.00233376 0.00856394 0.00669494 0.0106544
 0.00288369 0.00256685 0.00382944 0.00288369 0.00722968 0.02936053
 0.00256687 0.00144687 0.0028837  0.03752793 0.0028837  0.00288368
 0.00288369 0.00156972 0.00673878 0.00156972 0.00405405 0.00156993
 0.00486856 0.00197327 0.00855629 0.0028837  0.0028837  0.00339051
 0.0028837  0.06330089 0.0040548  0.00156973 0.00339031 0.0028837
 0.0028837  0.00976448 0.00338956 0.0028837  0.0030007  0.00324106
 0.00229175 0.01198666 0.0030007  0.00288369 0.0028837  0.00845997
 0.00133265 0.00293287 0.00293287 0.00368124 0.02965365 0.00546729
 0.00367889 0.1354851  0.00293286 0.00205758 0.00293286 0.00275478
 0.00367196 0.00293285 0.00491882 0.00229266 0.00535637 0.00417957
 0.00308917 0.00507559 0.00767868 0.00388508 0.00660816 0.00660788
 0.0123537  0.00660833 0.00664055 0.0066073  0.00660712 0.01224067
 0.00660735 0.00660729 0.00660708 0.00660746 0.00660712 0.00660731
 0.00660713 0.00660723 0.00660715 0.00874596 0.00660713 0.00660713
 0.00660716 0.00660735]
2025-06-03 10:14:19,846 - DEBUG - Edge reconstruction errors: [0.15644197 1.6580802  1.6591306  ... 0.15598768 1.25386    0.15600342]
2025-06-03 10:14:19,850 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101419_update_35.json
2025-06-03 10:14:19,850 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:14:19,874 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101419_update_35.pth and as latest_checkpoint.pth
2025-06-03 10:14:19,874 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.3254
2025-06-03 10:14:19,874 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-03 10:14:19,874 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.1378, MLP Score: 0.5015
2025-06-03 10:14:19,874 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3415, MLP Score: 0.4922
2025-06-03 10:14:19,874 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.2461, MLP Score: 0.4922
2025-06-03 10:14:19,875 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0677, MLP Score: 0.4920
2025-06-03 10:14:19,875 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.0950, MLP Score: 0.4929
2025-06-03 10:14:19,875 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 10:14:19,875 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7971, MLP Score: 0.4979
2025-06-03 10:14:19,875 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.2688, MLP Score: 0.4984
2025-06-03 10:14:19,875 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4891, MLP Score: 0.4955
2025-06-03 10:14:19,875 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4736, MLP Score: 0.4965
2025-06-03 10:14:19,876 - WARNING -   Source: 192.168.27.10, Target: 77.88.21.119, Recon Error: 3.3093, MLP Score: 0.5005
2025-06-03 10:14:19,876 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-03 10:14:19,876 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-03 10:14:19,876 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-03 10:14:19,911 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-03 10:14:19,943 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-03 10:14:19,944 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-03 10:14:19,944 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-03 10:14:19,975 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-03 10:14:20,008 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-03 10:14:20,008 - INFO - Processing node updates/additions.
2025-06-03 10:14:20,014 - INFO - Processing edge updates/additions.
2025-06-03 10:14:20,032 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:14:20,036 - INFO - Finished updating NetworkX graph.
2025-06-03 10:14:20,036 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:14:20,039 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:14:20,056 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-03 10:14:20,060 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:14:20,062 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-03 10:14:20,065 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-03 10:14:20,067 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:14:20,077 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:14:20,080 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:14:20,083 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:14:20,088 - DEBUG - Shape of encoded categorical edge features: torch.Size([2059, 3])
2025-06-03 10:14:20,090 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:14:20,090 - DEBUG - Shape of scaled numerical edge features: torch.Size([2059, 7])
2025-06-03 10:14:20,090 - DEBUG - Final edge attributes tensor shape: torch.Size([2059, 10])
2025-06-03 10:14:20,090 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:14:20,096 - INFO - Performing online update...
2025-06-03 10:14:20,096 - INFO - Starting online update for 50 steps.
2025-06-03 10:14:20,098 - DEBUG - Updated RunningStats: new_mean=0.9508833367093003, new_var=20400000000162.008, new_n=2070
2025-06-03 10:14:20,098 - DEBUG - Updated RunningStats: new_mean=0.9478231949664129, new_var=20700000000018.0, new_n=2100
2025-06-03 10:14:20,098 - DEBUG - Updated RunningStats: new_mean=1.1930195769099217, new_var=6800000000093.505, new_n=690
2025-06-03 10:14:20,099 - DEBUG - Updated RunningStats: new_mean=1.1913738664977886, new_var=6900000000001.671, new_n=700
2025-06-03 10:14:20,099 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:14:20,099 - DEBUG - Online update step: 1/50
2025-06-03 10:14:20,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:21,182 - DEBUG - Node anomaly scores shape: torch.Size([21756, 1])
2025-06-03 10:14:21,220 - DEBUG - Edge anomaly scores shape: torch.Size([45560, 1])
2025-06-03 10:14:21,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:22,717 - DEBUG - Step 1: Loss=0.5861
2025-06-03 10:14:22,717 - DEBUG - Online update step: 2/50
2025-06-03 10:14:22,722 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:23,707 - DEBUG - Node anomaly scores shape: torch.Size([21261, 1])
2025-06-03 10:14:23,733 - DEBUG - Edge anomaly scores shape: torch.Size([44444, 1])
2025-06-03 10:14:23,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:24,807 - DEBUG - Step 2: Loss=0.5845
2025-06-03 10:14:24,808 - DEBUG - Online update step: 3/50
2025-06-03 10:14:24,811 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:25,791 - DEBUG - Node anomaly scores shape: torch.Size([21740, 1])
2025-06-03 10:14:25,811 - DEBUG - Edge anomaly scores shape: torch.Size([45481, 1])
2025-06-03 10:14:25,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:27,117 - DEBUG - Step 3: Loss=0.5829
2025-06-03 10:14:27,118 - DEBUG - Online update step: 4/50
2025-06-03 10:14:27,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:28,595 - DEBUG - Node anomaly scores shape: torch.Size([22520, 1])
2025-06-03 10:14:28,628 - DEBUG - Edge anomaly scores shape: torch.Size([47329, 1])
2025-06-03 10:14:28,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:30,472 - DEBUG - Step 4: Loss=0.5852
2025-06-03 10:14:30,473 - DEBUG - Online update step: 5/50
2025-06-03 10:14:30,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:31,661 - DEBUG - Node anomaly scores shape: torch.Size([22446, 1])
2025-06-03 10:14:31,685 - DEBUG - Edge anomaly scores shape: torch.Size([47180, 1])
2025-06-03 10:14:31,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:33,100 - DEBUG - Step 5: Loss=0.5840
2025-06-03 10:14:33,101 - DEBUG - Online update step: 6/50
2025-06-03 10:14:33,109 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:34,253 - DEBUG - Node anomaly scores shape: torch.Size([22010, 1])
2025-06-03 10:14:34,284 - DEBUG - Edge anomaly scores shape: torch.Size([46139, 1])
2025-06-03 10:14:34,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:35,529 - DEBUG - Step 6: Loss=0.5844
2025-06-03 10:14:35,529 - DEBUG - Online update step: 7/50
2025-06-03 10:14:35,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:36,319 - DEBUG - Node anomaly scores shape: torch.Size([22371, 1])
2025-06-03 10:14:36,338 - DEBUG - Edge anomaly scores shape: torch.Size([46955, 1])
2025-06-03 10:14:36,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:37,717 - DEBUG - Step 7: Loss=0.5842
2025-06-03 10:14:37,717 - DEBUG - Online update step: 8/50
2025-06-03 10:14:37,722 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:38,582 - DEBUG - Node anomaly scores shape: torch.Size([21777, 1])
2025-06-03 10:14:38,598 - DEBUG - Edge anomaly scores shape: torch.Size([45644, 1])
2025-06-03 10:14:38,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:39,417 - DEBUG - Step 8: Loss=0.5830
2025-06-03 10:14:39,417 - DEBUG - Online update step: 9/50
2025-06-03 10:14:39,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:39,952 - DEBUG - Node anomaly scores shape: torch.Size([20954, 1])
2025-06-03 10:14:39,963 - DEBUG - Edge anomaly scores shape: torch.Size([43714, 1])
2025-06-03 10:14:39,965 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:40,590 - DEBUG - Step 9: Loss=0.5833
2025-06-03 10:14:40,590 - DEBUG - Online update step: 10/50
2025-06-03 10:14:40,593 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:41,211 - DEBUG - Node anomaly scores shape: torch.Size([21893, 1])
2025-06-03 10:14:41,223 - DEBUG - Edge anomaly scores shape: torch.Size([45884, 1])
2025-06-03 10:14:41,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:41,948 - DEBUG - Step 10: Loss=0.5843
2025-06-03 10:14:41,949 - DEBUG - Online update step: 11/50
2025-06-03 10:14:41,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:42,613 - DEBUG - Node anomaly scores shape: torch.Size([22329, 1])
2025-06-03 10:14:42,626 - DEBUG - Edge anomaly scores shape: torch.Size([46869, 1])
2025-06-03 10:14:42,627 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:43,350 - DEBUG - Step 11: Loss=0.5825
2025-06-03 10:14:43,350 - DEBUG - Online update step: 12/50
2025-06-03 10:14:43,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:43,970 - DEBUG - Node anomaly scores shape: torch.Size([21736, 1])
2025-06-03 10:14:43,983 - DEBUG - Edge anomaly scores shape: torch.Size([45484, 1])
2025-06-03 10:14:43,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:44,855 - DEBUG - Step 12: Loss=0.5842
2025-06-03 10:14:44,855 - DEBUG - Online update step: 13/50
2025-06-03 10:14:44,859 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:45,483 - DEBUG - Node anomaly scores shape: torch.Size([21641, 1])
2025-06-03 10:14:45,497 - DEBUG - Edge anomaly scores shape: torch.Size([45278, 1])
2025-06-03 10:14:45,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:46,166 - DEBUG - Step 13: Loss=0.5844
2025-06-03 10:14:46,166 - DEBUG - Online update step: 14/50
2025-06-03 10:14:46,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:46,889 - DEBUG - Node anomaly scores shape: torch.Size([22160, 1])
2025-06-03 10:14:46,911 - DEBUG - Edge anomaly scores shape: torch.Size([46467, 1])
2025-06-03 10:14:46,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:47,778 - DEBUG - Step 14: Loss=0.5811
2025-06-03 10:14:47,778 - DEBUG - Online update step: 15/50
2025-06-03 10:14:47,781 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:48,562 - DEBUG - Node anomaly scores shape: torch.Size([22365, 1])
2025-06-03 10:14:48,576 - DEBUG - Edge anomaly scores shape: torch.Size([46964, 1])
2025-06-03 10:14:48,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:49,178 - DEBUG - Step 15: Loss=0.5820
2025-06-03 10:14:49,178 - DEBUG - Online update step: 16/50
2025-06-03 10:14:49,181 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:49,782 - DEBUG - Node anomaly scores shape: torch.Size([22209, 1])
2025-06-03 10:14:49,794 - DEBUG - Edge anomaly scores shape: torch.Size([46709, 1])
2025-06-03 10:14:49,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:50,604 - DEBUG - Step 16: Loss=0.5823
2025-06-03 10:14:50,604 - DEBUG - Online update step: 17/50
2025-06-03 10:14:50,609 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:51,409 - DEBUG - Node anomaly scores shape: torch.Size([21410, 1])
2025-06-03 10:14:51,429 - DEBUG - Edge anomaly scores shape: torch.Size([44716, 1])
2025-06-03 10:14:51,431 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:52,431 - DEBUG - Step 17: Loss=0.5819
2025-06-03 10:14:52,431 - DEBUG - Online update step: 18/50
2025-06-03 10:14:52,434 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:53,297 - DEBUG - Node anomaly scores shape: torch.Size([21128, 1])
2025-06-03 10:14:53,326 - DEBUG - Edge anomaly scores shape: torch.Size([44172, 1])
2025-06-03 10:14:53,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:54,486 - DEBUG - Step 18: Loss=0.5831
2025-06-03 10:14:54,486 - DEBUG - Online update step: 19/50
2025-06-03 10:14:54,489 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:55,480 - DEBUG - Node anomaly scores shape: torch.Size([21734, 1])
2025-06-03 10:14:55,502 - DEBUG - Edge anomaly scores shape: torch.Size([45535, 1])
2025-06-03 10:14:55,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:56,658 - DEBUG - Step 19: Loss=0.5816
2025-06-03 10:14:56,658 - DEBUG - Online update step: 20/50
2025-06-03 10:14:56,662 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:57,330 - DEBUG - Node anomaly scores shape: torch.Size([21181, 1])
2025-06-03 10:14:57,341 - DEBUG - Edge anomaly scores shape: torch.Size([44231, 1])
2025-06-03 10:14:57,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:57,941 - DEBUG - Step 20: Loss=0.5834
2025-06-03 10:14:57,941 - DEBUG - Online update step: 21/50
2025-06-03 10:14:57,945 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:14:58,533 - DEBUG - Node anomaly scores shape: torch.Size([22119, 1])
2025-06-03 10:14:58,552 - DEBUG - Edge anomaly scores shape: torch.Size([46452, 1])
2025-06-03 10:14:58,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:14:59,471 - DEBUG - Step 21: Loss=0.5833
2025-06-03 10:14:59,472 - DEBUG - Online update step: 22/50
2025-06-03 10:14:59,482 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:00,410 - DEBUG - Node anomaly scores shape: torch.Size([21905, 1])
2025-06-03 10:15:00,429 - DEBUG - Edge anomaly scores shape: torch.Size([45977, 1])
2025-06-03 10:15:00,431 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:01,088 - DEBUG - Step 22: Loss=0.5799
2025-06-03 10:15:01,088 - DEBUG - Online update step: 23/50
2025-06-03 10:15:01,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:01,726 - DEBUG - Node anomaly scores shape: torch.Size([21565, 1])
2025-06-03 10:15:01,745 - DEBUG - Edge anomaly scores shape: torch.Size([45178, 1])
2025-06-03 10:15:01,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:02,513 - DEBUG - Step 23: Loss=0.5825
2025-06-03 10:15:02,513 - DEBUG - Online update step: 24/50
2025-06-03 10:15:02,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:03,207 - DEBUG - Node anomaly scores shape: torch.Size([21503, 1])
2025-06-03 10:15:03,228 - DEBUG - Edge anomaly scores shape: torch.Size([44955, 1])
2025-06-03 10:15:03,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:03,838 - DEBUG - Step 24: Loss=0.5814
2025-06-03 10:15:03,838 - DEBUG - Online update step: 25/50
2025-06-03 10:15:03,841 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:04,556 - DEBUG - Node anomaly scores shape: torch.Size([21518, 1])
2025-06-03 10:15:04,576 - DEBUG - Edge anomaly scores shape: torch.Size([44947, 1])
2025-06-03 10:15:04,581 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:05,190 - DEBUG - Step 25: Loss=0.5820
2025-06-03 10:15:05,190 - DEBUG - Online update step: 26/50
2025-06-03 10:15:05,193 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:05,713 - DEBUG - Node anomaly scores shape: torch.Size([21290, 1])
2025-06-03 10:15:05,724 - DEBUG - Edge anomaly scores shape: torch.Size([44467, 1])
2025-06-03 10:15:05,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:06,374 - DEBUG - Step 26: Loss=0.5804
2025-06-03 10:15:06,374 - DEBUG - Online update step: 27/50
2025-06-03 10:15:06,378 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:07,112 - DEBUG - Node anomaly scores shape: torch.Size([22558, 1])
2025-06-03 10:15:07,124 - DEBUG - Edge anomaly scores shape: torch.Size([47400, 1])
2025-06-03 10:15:07,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:08,143 - DEBUG - Step 27: Loss=0.5793
2025-06-03 10:15:08,143 - DEBUG - Online update step: 28/50
2025-06-03 10:15:08,149 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:08,865 - DEBUG - Node anomaly scores shape: torch.Size([22077, 1])
2025-06-03 10:15:08,892 - DEBUG - Edge anomaly scores shape: torch.Size([46326, 1])
2025-06-03 10:15:08,893 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:09,953 - DEBUG - Step 28: Loss=0.5801
2025-06-03 10:15:09,955 - DEBUG - Online update step: 29/50
2025-06-03 10:15:09,966 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:10,672 - DEBUG - Node anomaly scores shape: torch.Size([22539, 1])
2025-06-03 10:15:10,684 - DEBUG - Edge anomaly scores shape: torch.Size([47338, 1])
2025-06-03 10:15:10,686 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:11,447 - DEBUG - Step 29: Loss=0.5799
2025-06-03 10:15:11,448 - DEBUG - Online update step: 30/50
2025-06-03 10:15:11,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:12,136 - DEBUG - Node anomaly scores shape: torch.Size([21918, 1])
2025-06-03 10:15:12,149 - DEBUG - Edge anomaly scores shape: torch.Size([45947, 1])
2025-06-03 10:15:12,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:13,052 - DEBUG - Step 30: Loss=0.5804
2025-06-03 10:15:13,053 - DEBUG - Online update step: 31/50
2025-06-03 10:15:13,059 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:13,659 - DEBUG - Node anomaly scores shape: torch.Size([21635, 1])
2025-06-03 10:15:13,676 - DEBUG - Edge anomaly scores shape: torch.Size([45268, 1])
2025-06-03 10:15:13,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:14,321 - DEBUG - Step 31: Loss=0.5815
2025-06-03 10:15:14,321 - DEBUG - Online update step: 32/50
2025-06-03 10:15:14,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:14,970 - DEBUG - Node anomaly scores shape: torch.Size([21967, 1])
2025-06-03 10:15:14,982 - DEBUG - Edge anomaly scores shape: torch.Size([46095, 1])
2025-06-03 10:15:14,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:15,630 - DEBUG - Step 32: Loss=0.5798
2025-06-03 10:15:15,630 - DEBUG - Online update step: 33/50
2025-06-03 10:15:15,632 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:16,191 - DEBUG - Node anomaly scores shape: torch.Size([21390, 1])
2025-06-03 10:15:16,203 - DEBUG - Edge anomaly scores shape: torch.Size([44704, 1])
2025-06-03 10:15:16,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:16,990 - DEBUG - Step 33: Loss=0.5797
2025-06-03 10:15:16,991 - DEBUG - Online update step: 34/50
2025-06-03 10:15:16,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:17,606 - DEBUG - Node anomaly scores shape: torch.Size([22122, 1])
2025-06-03 10:15:17,619 - DEBUG - Edge anomaly scores shape: torch.Size([46362, 1])
2025-06-03 10:15:17,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:18,767 - DEBUG - Step 34: Loss=0.5796
2025-06-03 10:15:18,768 - DEBUG - Online update step: 35/50
2025-06-03 10:15:18,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:19,525 - DEBUG - Node anomaly scores shape: torch.Size([21366, 1])
2025-06-03 10:15:19,538 - DEBUG - Edge anomaly scores shape: torch.Size([44693, 1])
2025-06-03 10:15:19,540 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:20,287 - DEBUG - Step 35: Loss=0.5795
2025-06-03 10:15:20,288 - DEBUG - Online update step: 36/50
2025-06-03 10:15:20,292 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:20,920 - DEBUG - Node anomaly scores shape: torch.Size([21991, 1])
2025-06-03 10:15:20,933 - DEBUG - Edge anomaly scores shape: torch.Size([46108, 1])
2025-06-03 10:15:20,935 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:21,674 - DEBUG - Step 36: Loss=0.5809
2025-06-03 10:15:21,674 - DEBUG - Online update step: 37/50
2025-06-03 10:15:21,680 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:22,297 - DEBUG - Node anomaly scores shape: torch.Size([21032, 1])
2025-06-03 10:15:22,308 - DEBUG - Edge anomaly scores shape: torch.Size([43900, 1])
2025-06-03 10:15:22,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:23,243 - DEBUG - Step 37: Loss=0.5816
2025-06-03 10:15:23,243 - DEBUG - Online update step: 38/50
2025-06-03 10:15:23,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:23,964 - DEBUG - Node anomaly scores shape: torch.Size([21352, 1])
2025-06-03 10:15:23,977 - DEBUG - Edge anomaly scores shape: torch.Size([44653, 1])
2025-06-03 10:15:23,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:24,682 - DEBUG - Step 38: Loss=0.5815
2025-06-03 10:15:24,682 - DEBUG - Online update step: 39/50
2025-06-03 10:15:24,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:25,323 - DEBUG - Node anomaly scores shape: torch.Size([21214, 1])
2025-06-03 10:15:25,336 - DEBUG - Edge anomaly scores shape: torch.Size([44323, 1])
2025-06-03 10:15:25,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:25,921 - DEBUG - Step 39: Loss=0.5807
2025-06-03 10:15:25,922 - DEBUG - Online update step: 40/50
2025-06-03 10:15:25,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:26,475 - DEBUG - Node anomaly scores shape: torch.Size([21701, 1])
2025-06-03 10:15:26,486 - DEBUG - Edge anomaly scores shape: torch.Size([45516, 1])
2025-06-03 10:15:26,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:27,116 - DEBUG - Step 40: Loss=0.5789
2025-06-03 10:15:27,117 - DEBUG - Online update step: 41/50
2025-06-03 10:15:27,122 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:27,809 - DEBUG - Node anomaly scores shape: torch.Size([22393, 1])
2025-06-03 10:15:27,821 - DEBUG - Edge anomaly scores shape: torch.Size([47095, 1])
2025-06-03 10:15:27,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:28,722 - DEBUG - Step 41: Loss=0.5785
2025-06-03 10:15:28,722 - DEBUG - Online update step: 42/50
2025-06-03 10:15:28,725 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:29,693 - DEBUG - Node anomaly scores shape: torch.Size([21717, 1])
2025-06-03 10:15:29,739 - DEBUG - Edge anomaly scores shape: torch.Size([45484, 1])
2025-06-03 10:15:29,752 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:30,769 - DEBUG - Step 42: Loss=0.5805
2025-06-03 10:15:30,769 - DEBUG - Online update step: 43/50
2025-06-03 10:15:30,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:31,452 - DEBUG - Node anomaly scores shape: torch.Size([21729, 1])
2025-06-03 10:15:31,463 - DEBUG - Edge anomaly scores shape: torch.Size([45576, 1])
2025-06-03 10:15:31,464 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:32,194 - DEBUG - Step 43: Loss=0.5834
2025-06-03 10:15:32,195 - DEBUG - Online update step: 44/50
2025-06-03 10:15:32,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:32,781 - DEBUG - Node anomaly scores shape: torch.Size([21762, 1])
2025-06-03 10:15:32,792 - DEBUG - Edge anomaly scores shape: torch.Size([45557, 1])
2025-06-03 10:15:32,793 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:33,461 - DEBUG - Step 44: Loss=0.5779
2025-06-03 10:15:33,461 - DEBUG - Online update step: 45/50
2025-06-03 10:15:33,465 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:34,061 - DEBUG - Node anomaly scores shape: torch.Size([21713, 1])
2025-06-03 10:15:34,073 - DEBUG - Edge anomaly scores shape: torch.Size([45436, 1])
2025-06-03 10:15:34,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:34,787 - DEBUG - Step 45: Loss=0.5859
2025-06-03 10:15:34,787 - DEBUG - Online update step: 46/50
2025-06-03 10:15:34,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:35,330 - DEBUG - Node anomaly scores shape: torch.Size([21415, 1])
2025-06-03 10:15:35,342 - DEBUG - Edge anomaly scores shape: torch.Size([44792, 1])
2025-06-03 10:15:35,343 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:35,995 - DEBUG - Step 46: Loss=0.5787
2025-06-03 10:15:35,996 - DEBUG - Online update step: 47/50
2025-06-03 10:15:36,000 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:36,573 - DEBUG - Node anomaly scores shape: torch.Size([21492, 1])
2025-06-03 10:15:36,584 - DEBUG - Edge anomaly scores shape: torch.Size([44940, 1])
2025-06-03 10:15:36,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:37,207 - DEBUG - Step 47: Loss=0.5830
2025-06-03 10:15:37,208 - DEBUG - Online update step: 48/50
2025-06-03 10:15:37,212 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:37,869 - DEBUG - Node anomaly scores shape: torch.Size([21935, 1])
2025-06-03 10:15:37,888 - DEBUG - Edge anomaly scores shape: torch.Size([46014, 1])
2025-06-03 10:15:37,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:38,658 - DEBUG - Step 48: Loss=0.5813
2025-06-03 10:15:38,658 - DEBUG - Online update step: 49/50
2025-06-03 10:15:38,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:39,444 - DEBUG - Node anomaly scores shape: torch.Size([21521, 1])
2025-06-03 10:15:39,463 - DEBUG - Edge anomaly scores shape: torch.Size([45047, 1])
2025-06-03 10:15:39,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:40,618 - DEBUG - Step 49: Loss=0.5784
2025-06-03 10:15:40,618 - DEBUG - Online update step: 50/50
2025-06-03 10:15:40,622 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:41,233 - DEBUG - Node anomaly scores shape: torch.Size([21760, 1])
2025-06-03 10:15:41,248 - DEBUG - Edge anomaly scores shape: torch.Size([45569, 1])
2025-06-03 10:15:41,252 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:41,946 - DEBUG - Step 50: Loss=0.5843
2025-06-03 10:15:41,946 - INFO - Online update finished. Average loss: 0.5819, Learning rate: 0.001000
2025-06-03 10:15:41,947 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.2137926e-08 -1.2456561e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4913123e-09
 -1.5944398e-08 -3.8615338e-09  6.9756743e-09  3.9860995e-09
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
  9.8406829e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -9.9652491e-09 -2.9895748e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4774119e-09 -5.8296706e-08], current edge mean: [ 9.1432734e+00  1.4123361e+00  5.6940260e+00 -2.7790412e-09
 -9.2634705e-10  0.0000000e+00 -3.2422147e-09  9.2634705e-10
 -9.2634705e-10 -9.2634705e-10]
2025-06-03 10:15:41,948 - DEBUG - Node drift difference: 0.0061, Edge drift difference: 0.0036
2025-06-03 10:15:41,949 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.2137926e-08 -1.2456561e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4913123e-09
 -1.5944398e-08 -3.8615338e-09  6.9756743e-09  3.9860995e-09
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
  9.8406829e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -9.9652491e-09 -2.9895748e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4774119e-09 -5.8296706e-08], edge=[ 9.1432734e+00  1.4123361e+00  5.6940260e+00 -2.7790412e-09
 -9.2634705e-10  0.0000000e+00 -3.2422147e-09  9.2634705e-10
 -9.2634705e-10 -9.2634705e-10]
2025-06-03 10:15:41,950 - DEBUG - Updated reference std: node=[0.         0.         1.0005229  1.0005229  0.         0.
 0.         1.0005229  1.0005229  1.0005229  1.0005229  1.0005229
 0.97763693 0.27184048 0.36169627 0.5735438  1.0005229  2.9591587
 2.8782218  1.4838562  0.36169627 0.22627786 1.0005229  1.0005229
 0.         0.         0.         0.         1.0005229  1.0005229 ], edge=[1.1124209 0.505041  2.159036  1.000243  1.000243  1.000243  1.000243
 1.000243  1.000243  1.000243 ]
2025-06-03 10:15:41,993 - INFO - Online update complete. Loss: 0.5819
2025-06-03 10:15:41,993 - INFO - Running anomaly detection...
2025-06-03 10:15:41,993 - INFO - Starting anomaly detection.
2025-06-03 10:15:42,015 - DEBUG - Node reconstruction errors: [0.00436326 0.00312887 0.00333403 0.0029952  0.0026762  0.02689223
 0.00769756 0.00230889 0.00439775 0.01419644 0.00494577 0.00548405
 0.00268132 0.00254606 0.03347491 0.00424919 0.00656699 0.01334405
 0.00690526 0.02618336 0.01334406 0.01041394 0.00367722 0.0066037
 0.00257858 0.00956166 0.0071135  0.00247435 0.01334407 0.01429351
 0.00586069 0.00956162 0.0055528  0.01142341 0.00304117 0.00206965
 0.34683216 0.00382766 0.00853176 0.00510278 0.00735981 0.00240828
 0.00331707 0.00254605 0.00318425 0.02178271 0.19035454 0.01383787
 0.00641186 0.008077   0.02977163 0.0036772  0.00304911 0.00382766
 0.00956162 0.00978968 0.00735731 0.00187572 0.01585087 0.00508085
 0.05068674 0.00498695 0.04153301 0.0034941  0.01317684 0.00502542
 0.00768585 0.00367721 0.00807698 0.00994897 0.02258502 0.01611779
 0.02022363 0.00271997 0.04495044 0.00876506 0.008077   0.04868485
 0.05946653 0.02053921 0.00184892 0.00630206 0.00292147 0.00336135
 0.00378784 0.01120397 0.00524641 0.00245978 0.00598511 0.03111206
 0.00252877 0.0034416  0.00306371 0.00171591 0.00468266 0.00684009
 0.00237728 0.00297976 0.0018195  0.01702358 0.00199923 0.00237727
 0.00249454 0.0593504  0.00191596 0.01397947 0.0028363  0.01985555
 0.00366295 0.00377203 0.02478931 0.00258412 0.00293316 0.00225055
 0.00231781 0.00262245 0.0016096  0.00216786 0.00196302 0.00481055
 0.00205331 0.0043207  0.00167224 0.00409807 0.00215991 0.00481054
 0.00295472 0.00611937 0.00274019 0.00283138 0.00332956 0.00443144
 0.01512993 0.01633766 0.00176527 0.01391665 0.00197699 0.00190411
 0.01083239 0.00300736 0.00362262 0.03291534 0.00193108 0.00377377
 0.00362213 0.0037056  0.0016096  0.01146874 0.00368573 0.00175056
 0.08814108 0.00214013 0.0027853  0.00443144 0.0030831  0.00263442
 0.00424428 0.00358901 0.00199924 0.00262401 0.00362386 0.00239414
 0.00424433 0.00332957 0.00193229 0.00341322 0.00164754 0.00300034
 0.00211437 0.00175056 0.00311397 0.00464986 0.00232806 0.00673796
 0.00196299 0.00406414 0.00299811 0.00286582 0.0013805  0.0013805
 0.01450997 0.0021691  0.00630784 0.00283822 0.00797066 0.0029987
 0.00171895 0.00162351 0.01447974 0.00368177 0.00311208 0.0017607
 0.00248944 0.0045457  0.01083257 0.00270894 0.04140471 0.00202298
 0.00271072 0.00212813 0.00236792 0.00424447 0.0026798  0.00281118
 0.00167666 0.00212973 0.01621496 0.02379239 0.00178582 0.00259622
 0.00148906 0.00317403 0.00364332 0.00557276 0.00325973 0.00189945
 0.00180453 0.0016096  0.05713427 0.00454568 0.00299822 0.00171896
 0.00202349 0.00364332 0.00424429 0.00273861 0.00166837 0.0046185
 0.00294965 0.00482022 0.00289408 0.00288073 0.00159678 0.0016096
 0.0016096  0.00350792 0.0038039  0.00202348 0.00424445 0.00222544
 0.00236617 0.00168498 0.00396176 0.00217302 0.00393371 0.00196759
 0.00159892 0.00409393 0.00396175 0.00396666 0.00232805 0.00218109
 0.05713426 0.00338096 0.0015123  0.00209753 0.0036726  0.00164616
 0.00184021 0.00138049 0.0027031  0.00378158 0.00857491 0.00432217
 0.00274227 0.00430777 0.00172303 0.02501281 0.00172302 0.0021858
 0.02460087 0.00166065 0.00396352 0.00265507 0.00106528 0.01652056
 0.00164332 0.02476985 0.01450995 0.0023916  0.01204805 0.00176136
 0.00277586 0.00222377 0.00264699 0.00235692 0.01233364 0.00351592
 0.0021691  0.00544339 0.00448862 0.00243369 0.04331274 0.00393373
 0.01459988 0.00207095 0.00357638 0.00138043 0.00271235 0.00318898
 0.0030644  0.00176437 0.00089209 0.00336142 0.00135474 0.00135474
 0.00135473 0.00118455 0.00180125 0.00176456 0.00135474 0.0035611
 0.00135473 0.00329437 0.00451128 0.00365457 0.02769468 0.00202679
 0.00336448 0.00249374 0.00175039 0.00455128 0.00246205 0.0008921
 0.01930402 0.0020631  0.0468304  0.00232554 0.00268192 0.00268193
 0.04638636 0.00245186 0.00135472 0.00106526 0.00135473 0.00118454
 0.00389485 0.00180992 0.00203263 0.00156033 0.00178439 0.00347012
 0.00156032 0.00300129 0.00285334 0.00180458 0.0008921  0.0023879
 0.00205438 0.00291055 0.00135473 0.00204031 0.00336342 0.0047766
 0.00377469 0.00367254 0.00188224 0.00135474 0.0016535  0.00521852
 0.00259188 0.00315748 0.01184277 0.0033555  0.00089209 0.00614735
 0.00150267 0.00495874 0.00109194 0.00148402 0.00350128 0.00310268
 0.00237646 0.00298403 0.00153832 0.00477658 0.00160045 0.00319614
 0.0047178  0.00135473 0.0008921  0.00270933 0.00325238 0.00279167
 0.00253484 0.00351514 0.0157686  0.00253708 0.00136388 0.00135473
 0.01782614 0.00199529 0.00111661 0.00156457 0.00107683 0.00107683
 0.00107684 0.00483664 0.00109299 0.00517335 0.00313266 0.01147331
 0.00314556 0.00109299 0.00126271 0.00111661 0.00242767 0.00364828
 0.00111661 0.01898274 0.00107684 0.00111661 0.00109299 0.00107684
 0.00107683 0.00530496 0.00387829 0.00107684 0.00159636 0.00153533
 0.00315806 0.00322941 0.00123342 0.00307231 0.00189768 0.00319894
 0.00328753 0.00167105 0.00557447 0.00454804 0.00197376 0.01539343
 0.00168225 0.00109181 0.00313181 0.00107684 0.00313204 0.00177625
 0.00184142 0.00183552 0.00133524 0.00284367 0.00886501 0.0014385
 0.00134737 0.0038281  0.02595706 0.00282209 0.00229163 0.00309556
 0.00323913 0.00123746 0.00311332 0.00136796 0.00123746 0.01592718
 0.00306377 0.00277442 0.00254087 0.00196344 0.00110837 0.00316364
 0.00305125 0.00198302 0.00304801 0.00316361 0.00116647 0.00226204
 0.00307085 0.00235367 0.00116647 0.00110836 0.00305507 0.00440101
 0.00301575 0.00123326 0.00226205 0.00110837 0.00130694 0.00321082
 0.00253425 0.04533705 0.00161152 0.00282213 0.00217315 0.00152359
 0.00123745 0.00323895 0.00837242 0.00456178 0.00146885 0.00130694
 0.00362653 0.00143745 0.0020939  0.00310646 0.00124767 0.01306981
 0.00096516 0.00321085 0.0068278  0.00143348 0.00922748 0.00135282
 0.00104947 0.00280995 0.00112423 0.0124649  0.00284623 0.00123746
 0.005969   0.00286021 0.0028602  0.00149554 0.00202398 0.00144594
 0.0011242  0.00086578 0.00261876 0.00396836 0.0027426  0.00284368
 0.00112422 0.00231464 0.00104948 0.00124767 0.00274454 0.00389548
 0.0027426  0.00198556 0.00144598 0.00320109 0.00096516 0.00321089
 0.00124768 0.00118226 0.00298803 0.00207424 0.00096515 0.00098628
 0.00096515 0.00256829 0.00148281 0.00086578 0.00271137 0.0092805
 0.00539396 0.00090674 0.00826556 0.00090673 0.00090673 0.00090673
 0.00090673 0.00090673 0.00090673 0.00090673 0.00124402 0.00251263
 0.0078907  0.00090673 0.00090673 0.00090674 0.00090673 0.00090673
 0.00090673 0.00090673 0.00090673 0.00090673 0.00093594 0.00090673
 0.00090673 0.00203529 0.00090673 0.00498929 0.00580691 0.00096515
 0.00519683 0.0039071  0.0061736  0.0061736  0.00175306 0.00519683
 0.00096516 0.00112422 0.00112422 0.00096516 0.00112422 0.00211334
 0.00388586 0.00090673 0.00284367 0.00096516 0.00286019 0.00096516
 0.00096516 0.00181749 0.00096515 0.00112422 0.00096515 0.00096515
 0.00086578 0.00112421 0.00096515 0.00112421 0.00096516 0.00096516
 0.00096515 0.00223595 0.00282268 0.00125233 0.00090673 0.01530683
 0.00446698 0.00096516 0.00112422 0.00255213 0.00090673 0.00180483
 0.00202404 0.00131523 0.00096516 0.00096515 0.00138762 0.00230037
 0.00220717 0.00096516 0.00124402 0.00143342 0.00112422 0.00342973
 0.00090673 0.00340396 0.00290554 0.00090673 0.00090673 0.00124401
 0.00143448 0.00096516 0.01414811 0.00293407 0.00282518 0.00230036
 0.00154881 0.00094638 0.00094637 0.00547706 0.00131717 0.00090673
 0.00277923 0.00444722 0.00230036 0.00119991 0.00138047 0.00130139
 0.00094112 0.00094112 0.00094113 0.00094112 0.00094112 0.00108715
 0.00402505 0.00094111 0.00094091 0.00090674 0.00134825 0.00090674
 0.00094638 0.00315926 0.00449013 0.00447136 0.00252847 0.00323141
 0.00093594 0.00170286 0.00093595 0.00090674 0.00094638 0.0010235
 0.00107059 0.00107059 0.00094113 0.00102351 0.00224889 0.00479223
 0.0016098  0.00090673 0.00094113 0.00117326 0.00107059 0.00126772
 0.00126833 0.00124312 0.00108715 0.00302888 0.00128811 0.00513576
 0.00155739 0.0012683  0.00258324 0.00110237 0.00130181 0.00132301
 0.00154036 0.00147035 0.0012345  0.00126833 0.00126831 0.00126832
 0.00136534 0.00117325 0.00126833 0.00130181 0.00126833 0.00126833
 0.00126833 0.00140051 0.00115216 0.00269411 0.0028612  0.00145534
 0.0027987  0.00107509 0.00312679 0.00974577 0.00130619 0.00118469
 0.00126631 0.0178215  0.0178215  0.00130181 0.00248866 0.06303828
 0.00130824 0.00094283 0.00562779 0.00307862 0.00115052 0.00115053
 0.00115053 0.00093    0.00116732 0.0029611  0.01834986 0.00622199
 0.00217519 0.00124352 0.00222654 0.00094265 0.00246266 0.00175869
 0.00131351 0.0032508  0.00130824 0.06303866 0.00094266 0.0017587
 0.00124357 0.0045824  0.00115053 0.00093019 0.00131357 0.00245898
 0.01834958 0.00092999 0.00092998 0.00092997 0.00590479 0.08299397
 0.04790979 0.00115053 0.02863741 0.00093011 0.00173143 0.00219837
 0.01393885 0.00288234 0.00092998 0.00086965 0.00221105 0.00124858
 0.06400063 0.00288234 0.00990397 0.00208085 0.0035987  0.00288233
 0.00262218 0.01882195 0.00275333 0.00300611 0.00168924 0.00111479
 0.00111604 0.00721379 0.01903492 0.01011636 0.00288234 0.00275333
 0.00288234 0.00113146 0.0010078  0.00100782 0.00106494 0.00306832
 0.00125712 0.00100782 0.00113157 0.00314982 0.00100781 0.00100781
 0.00078564 0.00327833 0.00256184 0.00316139 0.00100781 0.00166878
 0.00314981 0.00100782 0.00110321 0.00267921 0.00127652 0.00127653
 0.00651041 0.00267932 0.00100782 0.00267933 0.00280113 0.00399971
 0.01839432 0.00100782 0.03772007 0.0026226  0.00262272 0.00327833
 0.00085678 0.00302041 0.00110322 0.00331012 0.00112307 0.0194661
 0.003341   0.01946611 0.01316804 0.00121591 0.00334101 0.00082967
 0.00082967 0.02158429 0.00082968 0.00466577 0.00087296 0.01929768
 0.00215335 0.00121585 0.00215334 0.00469331 0.00427691 0.00695946
 0.00082968 0.00336245 0.00232695 0.00082968 0.00297212 0.02836238
 0.00336248 0.0012157  0.00082967 0.02515453 0.00082967 0.00082973
 0.00082969 0.00112473 0.00227656 0.00112472 0.00204234 0.00112477
 0.00163668 0.00116318 0.00390067 0.00082967 0.00082965 0.00107662
 0.00082968 0.03620584 0.00204241 0.00112472 0.00107666 0.00082967
 0.00082964 0.00551447 0.00107682 0.00082967 0.00088175 0.00246135
 0.00118003 0.00620492 0.00088173 0.00082967 0.00082968 0.0048109
 0.00178469 0.00174239 0.00174238 0.0008716  0.02125055 0.00275743
 0.00284164 0.09504159 0.00174239 0.00113577 0.00174237 0.0032587
 0.00284399 0.00174239 0.00094127 0.00118001 0.00326796 0.00118813
 0.00123377 0.00107842 0.00260821 0.00117462 0.0010299  0.00103034
 0.00458104 0.007989   0.00102665 0.00102997 0.00695971 0.00565292
 0.00102997 0.00102998 0.00102996 0.00102992 0.00102996 0.00102996
 0.00102996 0.00102997 0.00122146 0.00297942 0.00102996 0.00102996
 0.00102996 0.00102996 0.15110849 0.00325066 0.00126618 0.00297942
 0.00129948 0.00141128 0.00141129 0.00102997 0.00141131 0.00141132
 0.0041304  0.00745972 0.00745972]
2025-06-03 10:15:42,015 - DEBUG - Edge reconstruction errors: [0.15540354 1.6573378  1.6583995  ... 0.15495545 1.2521089  0.1549851 ]
2025-06-03 10:15:42,018 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101542_update_36.json
2025-06-03 10:15:42,018 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:15:42,034 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101542_update_36.pth and as latest_checkpoint.pth
2025-06-03 10:15:42,035 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.3383
2025-06-03 10:15:42,035 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 10:15:42,035 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3468, MLP Score: 0.5074
2025-06-03 10:15:42,035 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1904, MLP Score: 0.5076
2025-06-03 10:15:42,035 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0507, MLP Score: 0.5070
2025-06-03 10:15:42,035 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0487, MLP Score: 0.5103
2025-06-03 10:15:42,035 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0595, MLP Score: 0.4992
2025-06-03 10:15:42,035 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:15:42,035 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8195, MLP Score: 0.5007
2025-06-03 10:15:42,035 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.2595, MLP Score: 0.5007
2025-06-03 10:15:42,035 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9389, MLP Score: 0.4972
2025-06-03 10:15:42,036 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4015, MLP Score: 0.4989
2025-06-03 10:15:42,036 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3990, MLP Score: 0.4991
2025-06-03 10:15:42,036 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:15:42,036 - INFO - Performing visualization of node and edge features.
2025-06-03 10:15:42,037 - INFO - Starting visualization of node features.
2025-06-03 10:15:42,037 - INFO - Graph has 957 nodes and 30 features.
2025-06-03 10:15:42,038 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:15:42,038 - INFO - Calculating feature statistics:
2025-06-03 10:15:42,038 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,038 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,039 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(6.377759e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.8217037), 'max': np.float32(2.5205786)}
2025-06-03 10:15:42,039 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(3.1888796e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.4225495), 'max': np.float32(1.917514)}
2025-06-03 10:15:42,039 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,039 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,040 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,040 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-7.972199e-09), 'std': np.float32(1.0), 'min': np.float32(-0.45643547), 'max': np.float32(2.1908903)}
2025-06-03 10:15:42,040 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1047251), 'max': np.float32(0.9052025)}
2025-06-03 10:15:42,040 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(1.7937447e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.215237), 'max': np.float32(0.11082604)}
2025-06-03 10:15:42,041 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4071383), 'max': np.float32(1.5780227)}
2025-06-03 10:15:42,041 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(3.1888796e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5393881), 'max': np.float32(2.5217385)}
2025-06-03 10:15:42,041 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2967608), 'std': np.float32(0.97712606), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-03 10:15:42,041 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9623826), 'std': np.float32(0.27169842), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:15:42,042 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1368861), 'std': np.float32(0.36150724), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:15:42,042 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.415883), 'std': np.float32(0.57324404), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:15:42,042 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.9860995e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11082603), 'max': np.float32(9.215238)}
2025-06-03 10:15:42,042 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3009405), 'std': np.float32(2.9576123), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:15:42,042 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8819227), 'std': np.float32(2.8767178), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:15:42,043 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.613375), 'std': np.float32(1.4830806), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:15:42,043 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1368861), 'std': np.float32(0.36150724), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:15:42,043 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9926853), 'std': np.float32(0.2261596), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:15:42,043 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.7902697e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12672172), 'max': np.float32(16.410461)}
2025-06-03 10:15:42,043 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-1.9930498e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.13845333), 'max': np.float32(7.2226496)}
2025-06-03 10:15:42,043 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,043 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,043 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,043 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:15:42,043 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.9628908), 'max': np.float32(8.875043)}
2025-06-03 10:15:42,044 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-3.1888796e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0507768), 'max': np.float32(4.4542966)}
2025-06-03 10:15:42,065 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c1ce7ad0>
2025-06-03 10:15:42,550 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:15:42,621 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:15:42,658 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:15:44,390 - INFO - Node feature visualization saved to vis/node_features_20250603_101542.png
2025-06-03 10:15:44,390 - INFO - Finished visualization of node features.
2025-06-03 10:15:44,390 - INFO - Performing additional feature analysis:
2025-06-03 10:15:44,390 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:15:44,391 - INFO - Starting visualization of edge features.
2025-06-03 10:15:44,391 - INFO - Graph has 2059 edges and 10 edge features.
2025-06-03 10:15:44,392 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:15:44,392 - INFO - Calculating edge feature statistics:
2025-06-03 10:15:44,392 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:15:44,392 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.143273), 'std': np.float32(1.1121507), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-03 10:15:44,392 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4123361), 'std': np.float32(0.50491834), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:15:44,392 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.694026), 'std': np.float32(2.1585116), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:15:44,392 - INFO - - service: {'name': 'service', 'unique': 37, 'mean': np.float32(-1.8526941e-09), 'std': np.float32(1.0), 'min': np.float32(-0.036038693), 'max': np.float32(34.50935)}
2025-06-03 10:15:44,392 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1383, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.060220957), 'max': np.float32(29.705547)}
2025-06-03 10:15:44,392 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1464, 'mean': np.float32(-7.4107764e-09), 'std': np.float32(1.0), 'min': np.float32(-0.056335747), 'max': np.float32(32.42296)}
2025-06-03 10:15:44,392 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 485, 'mean': np.float32(-1.8526941e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.04483336), 'max': np.float32(34.36275)}
2025-06-03 10:15:44,392 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1437, 'mean': np.float32(9.2634705e-10), 'std': np.float32(1.0), 'min': np.float32(-0.08525408), 'max': np.float32(28.593983)}
2025-06-03 10:15:44,393 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1463, 'mean': np.float32(-1.8526941e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08545026), 'max': np.float32(27.641966)}
2025-06-03 10:15:44,393 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 532, 'mean': np.float32(-9.2634705e-10), 'std': np.float32(0.99999994), 'min': np.float32(-0.053957894), 'max': np.float32(33.741543)}
2025-06-03 10:15:44,408 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c26a73e0>
2025-06-03 10:15:44,521 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:15:44,538 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c26c67b0>
2025-06-03 10:15:44,688 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:15:45,167 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:15:45,370 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:15:45,396 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:15:45,407 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:15:47,075 - INFO - Edge feature visualization saved to vis/edge_features_20250603_101545.png
2025-06-03 10:15:47,076 - INFO - Finished visualization of edge features.
2025-06-03 10:15:47,076 - INFO - Performing additional edge feature analysis:
2025-06-03 10:15:47,076 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:15:47,078 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:15:47,078 - INFO - Graph has 2059 edges and 10 edge features.
2025-06-03 10:15:47,078 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:15:47,464 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_101547_summary.png
2025-06-03 10:15:47,793 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_101547_pca_3d.png
2025-06-03 10:15:47,982 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_101547_pca_variance.png
2025-06-03 10:15:47,982 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:15:47,982 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-03 10:15:47,982 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-03 10:15:47,982 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-03 10:15:48,007 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-03 10:15:48,034 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-03 10:15:48,034 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-03 10:15:48,035 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-03 10:15:48,057 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-03 10:15:48,082 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-03 10:15:48,083 - INFO - Processing node updates/additions.
2025-06-03 10:15:48,089 - INFO - Processing edge updates/additions.
2025-06-03 10:15:48,101 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:15:48,102 - INFO - Finished updating NetworkX graph.
2025-06-03 10:15:48,102 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:15:48,104 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:15:48,117 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-03 10:15:48,119 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:15:48,119 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-03 10:15:48,121 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-03 10:15:48,122 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:15:48,128 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:15:48,130 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:15:48,131 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:15:48,133 - DEBUG - Shape of encoded categorical edge features: torch.Size([2098, 3])
2025-06-03 10:15:48,134 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:15:48,134 - DEBUG - Shape of scaled numerical edge features: torch.Size([2098, 7])
2025-06-03 10:15:48,135 - DEBUG - Final edge attributes tensor shape: torch.Size([2098, 10])
2025-06-03 10:15:48,135 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:15:48,137 - INFO - Performing online update...
2025-06-03 10:15:48,137 - INFO - Starting online update for 50 steps.
2025-06-03 10:15:48,138 - DEBUG - Updated RunningStats: new_mean=0.9507737294940851, new_var=21000000000161.56, new_n=2130
2025-06-03 10:15:48,138 - DEBUG - Updated RunningStats: new_mean=0.9478208200574444, new_var=21300000000018.215, new_n=2160
2025-06-03 10:15:48,138 - DEBUG - Updated RunningStats: new_mean=1.1974903404195774, new_var=7000000000093.502, new_n=710
2025-06-03 10:15:48,138 - DEBUG - Updated RunningStats: new_mean=1.1958220854719706, new_var=7100000000001.669, new_n=720
2025-06-03 10:15:48,138 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:15:48,138 - DEBUG - Online update step: 1/50
2025-06-03 10:15:48,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:48,874 - DEBUG - Node anomaly scores shape: torch.Size([22240, 1])
2025-06-03 10:15:48,890 - DEBUG - Edge anomaly scores shape: torch.Size([46730, 1])
2025-06-03 10:15:48,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:49,661 - DEBUG - Step 1: Loss=0.5787
2025-06-03 10:15:49,661 - DEBUG - Online update step: 2/50
2025-06-03 10:15:49,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:50,365 - DEBUG - Node anomaly scores shape: torch.Size([21835, 1])
2025-06-03 10:15:50,377 - DEBUG - Edge anomaly scores shape: torch.Size([45759, 1])
2025-06-03 10:15:50,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:51,143 - DEBUG - Step 2: Loss=0.5850
2025-06-03 10:15:51,143 - DEBUG - Online update step: 3/50
2025-06-03 10:15:51,146 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:51,809 - DEBUG - Node anomaly scores shape: torch.Size([21334, 1])
2025-06-03 10:15:51,825 - DEBUG - Edge anomaly scores shape: torch.Size([44621, 1])
2025-06-03 10:15:51,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:52,630 - DEBUG - Step 3: Loss=0.5804
2025-06-03 10:15:52,630 - DEBUG - Online update step: 4/50
2025-06-03 10:15:52,633 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:53,405 - DEBUG - Node anomaly scores shape: torch.Size([22121, 1])
2025-06-03 10:15:53,425 - DEBUG - Edge anomaly scores shape: torch.Size([46386, 1])
2025-06-03 10:15:53,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:54,657 - DEBUG - Step 4: Loss=0.5811
2025-06-03 10:15:54,657 - DEBUG - Online update step: 5/50
2025-06-03 10:15:54,665 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:55,435 - DEBUG - Node anomaly scores shape: torch.Size([21593, 1])
2025-06-03 10:15:55,448 - DEBUG - Edge anomaly scores shape: torch.Size([45224, 1])
2025-06-03 10:15:55,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:56,368 - DEBUG - Step 5: Loss=0.5885
2025-06-03 10:15:56,368 - DEBUG - Online update step: 6/50
2025-06-03 10:15:56,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:57,153 - DEBUG - Node anomaly scores shape: torch.Size([22320, 1])
2025-06-03 10:15:57,165 - DEBUG - Edge anomaly scores shape: torch.Size([46870, 1])
2025-06-03 10:15:57,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:57,954 - DEBUG - Step 6: Loss=0.5854
2025-06-03 10:15:57,955 - DEBUG - Online update step: 7/50
2025-06-03 10:15:57,958 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:15:58,626 - DEBUG - Node anomaly scores shape: torch.Size([21993, 1])
2025-06-03 10:15:58,644 - DEBUG - Edge anomaly scores shape: torch.Size([46172, 1])
2025-06-03 10:15:58,645 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:15:59,447 - DEBUG - Step 7: Loss=0.5888
2025-06-03 10:15:59,447 - DEBUG - Online update step: 8/50
2025-06-03 10:15:59,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:00,090 - DEBUG - Node anomaly scores shape: torch.Size([22421, 1])
2025-06-03 10:16:00,107 - DEBUG - Edge anomaly scores shape: torch.Size([47123, 1])
2025-06-03 10:16:00,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:01,090 - DEBUG - Step 8: Loss=0.5804
2025-06-03 10:16:01,090 - DEBUG - Online update step: 9/50
2025-06-03 10:16:01,098 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:01,794 - DEBUG - Node anomaly scores shape: torch.Size([21556, 1])
2025-06-03 10:16:01,810 - DEBUG - Edge anomaly scores shape: torch.Size([45155, 1])
2025-06-03 10:16:01,811 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:02,649 - DEBUG - Step 9: Loss=0.6011
2025-06-03 10:16:02,649 - DEBUG - Online update step: 10/50
2025-06-03 10:16:02,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:03,353 - DEBUG - Node anomaly scores shape: torch.Size([22551, 1])
2025-06-03 10:16:03,365 - DEBUG - Edge anomaly scores shape: torch.Size([47437, 1])
2025-06-03 10:16:03,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:04,189 - DEBUG - Step 10: Loss=0.5941
2025-06-03 10:16:04,189 - DEBUG - Online update step: 11/50
2025-06-03 10:16:04,192 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:04,845 - DEBUG - Node anomaly scores shape: torch.Size([21784, 1])
2025-06-03 10:16:04,858 - DEBUG - Edge anomaly scores shape: torch.Size([45640, 1])
2025-06-03 10:16:04,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:05,581 - DEBUG - Step 11: Loss=0.5842
2025-06-03 10:16:05,582 - DEBUG - Online update step: 12/50
2025-06-03 10:16:05,585 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:06,268 - DEBUG - Node anomaly scores shape: torch.Size([22203, 1])
2025-06-03 10:16:06,279 - DEBUG - Edge anomaly scores shape: torch.Size([46672, 1])
2025-06-03 10:16:06,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:07,034 - DEBUG - Step 12: Loss=0.5826
2025-06-03 10:16:07,034 - DEBUG - Online update step: 13/50
2025-06-03 10:16:07,037 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:07,658 - DEBUG - Node anomaly scores shape: torch.Size([22539, 1])
2025-06-03 10:16:07,671 - DEBUG - Edge anomaly scores shape: torch.Size([47375, 1])
2025-06-03 10:16:07,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:08,418 - DEBUG - Step 13: Loss=0.5863
2025-06-03 10:16:08,419 - DEBUG - Online update step: 14/50
2025-06-03 10:16:08,422 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:09,049 - DEBUG - Node anomaly scores shape: torch.Size([21383, 1])
2025-06-03 10:16:09,061 - DEBUG - Edge anomaly scores shape: torch.Size([44747, 1])
2025-06-03 10:16:09,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:09,768 - DEBUG - Step 14: Loss=0.5793
2025-06-03 10:16:09,769 - DEBUG - Online update step: 15/50
2025-06-03 10:16:09,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:10,459 - DEBUG - Node anomaly scores shape: torch.Size([22293, 1])
2025-06-03 10:16:10,493 - DEBUG - Edge anomaly scores shape: torch.Size([46843, 1])
2025-06-03 10:16:10,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:11,296 - DEBUG - Step 15: Loss=0.5922
2025-06-03 10:16:11,297 - DEBUG - Online update step: 16/50
2025-06-03 10:16:11,300 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:12,003 - DEBUG - Node anomaly scores shape: torch.Size([22583, 1])
2025-06-03 10:16:12,019 - DEBUG - Edge anomaly scores shape: torch.Size([47471, 1])
2025-06-03 10:16:12,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:12,841 - DEBUG - Step 16: Loss=0.5854
2025-06-03 10:16:12,841 - DEBUG - Online update step: 17/50
2025-06-03 10:16:12,846 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:13,451 - DEBUG - Node anomaly scores shape: torch.Size([22034, 1])
2025-06-03 10:16:13,466 - DEBUG - Edge anomaly scores shape: torch.Size([46224, 1])
2025-06-03 10:16:13,468 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:14,279 - DEBUG - Step 17: Loss=0.5857
2025-06-03 10:16:14,280 - DEBUG - Online update step: 18/50
2025-06-03 10:16:14,287 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:15,059 - DEBUG - Node anomaly scores shape: torch.Size([21992, 1])
2025-06-03 10:16:15,073 - DEBUG - Edge anomaly scores shape: torch.Size([46067, 1])
2025-06-03 10:16:15,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:15,717 - DEBUG - Step 18: Loss=0.5804
2025-06-03 10:16:15,717 - DEBUG - Online update step: 19/50
2025-06-03 10:16:15,720 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:16,270 - DEBUG - Node anomaly scores shape: torch.Size([21302, 1])
2025-06-03 10:16:16,280 - DEBUG - Edge anomaly scores shape: torch.Size([44589, 1])
2025-06-03 10:16:16,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:16,898 - DEBUG - Step 19: Loss=0.5846
2025-06-03 10:16:16,898 - DEBUG - Online update step: 20/50
2025-06-03 10:16:16,902 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:17,508 - DEBUG - Node anomaly scores shape: torch.Size([21699, 1])
2025-06-03 10:16:17,520 - DEBUG - Edge anomaly scores shape: torch.Size([45407, 1])
2025-06-03 10:16:17,521 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:18,288 - DEBUG - Step 20: Loss=0.5791
2025-06-03 10:16:18,288 - DEBUG - Online update step: 21/50
2025-06-03 10:16:18,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:18,894 - DEBUG - Node anomaly scores shape: torch.Size([22353, 1])
2025-06-03 10:16:18,906 - DEBUG - Edge anomaly scores shape: torch.Size([46987, 1])
2025-06-03 10:16:18,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:19,560 - DEBUG - Step 21: Loss=0.5846
2025-06-03 10:16:19,560 - DEBUG - Online update step: 22/50
2025-06-03 10:16:19,563 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:20,167 - DEBUG - Node anomaly scores shape: torch.Size([22965, 1])
2025-06-03 10:16:20,179 - DEBUG - Edge anomaly scores shape: torch.Size([48430, 1])
2025-06-03 10:16:20,180 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:20,830 - DEBUG - Step 22: Loss=0.5794
2025-06-03 10:16:20,831 - DEBUG - Online update step: 23/50
2025-06-03 10:16:20,833 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:21,438 - DEBUG - Node anomaly scores shape: torch.Size([23092, 1])
2025-06-03 10:16:21,450 - DEBUG - Edge anomaly scores shape: torch.Size([48606, 1])
2025-06-03 10:16:21,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:22,137 - DEBUG - Step 23: Loss=0.5839
2025-06-03 10:16:22,137 - DEBUG - Online update step: 24/50
2025-06-03 10:16:22,143 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:22,830 - DEBUG - Node anomaly scores shape: torch.Size([21884, 1])
2025-06-03 10:16:22,849 - DEBUG - Edge anomaly scores shape: torch.Size([45897, 1])
2025-06-03 10:16:22,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:23,617 - DEBUG - Step 24: Loss=0.5796
2025-06-03 10:16:23,617 - DEBUG - Online update step: 25/50
2025-06-03 10:16:23,622 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:24,354 - DEBUG - Node anomaly scores shape: torch.Size([22185, 1])
2025-06-03 10:16:24,373 - DEBUG - Edge anomaly scores shape: torch.Size([46587, 1])
2025-06-03 10:16:24,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:25,228 - DEBUG - Step 25: Loss=0.5853
2025-06-03 10:16:25,229 - DEBUG - Online update step: 26/50
2025-06-03 10:16:25,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:25,999 - DEBUG - Node anomaly scores shape: torch.Size([22063, 1])
2025-06-03 10:16:26,012 - DEBUG - Edge anomaly scores shape: torch.Size([46249, 1])
2025-06-03 10:16:26,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:26,715 - DEBUG - Step 26: Loss=0.5802
2025-06-03 10:16:26,716 - DEBUG - Online update step: 27/50
2025-06-03 10:16:26,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:27,295 - DEBUG - Node anomaly scores shape: torch.Size([21622, 1])
2025-06-03 10:16:27,306 - DEBUG - Edge anomaly scores shape: torch.Size([45268, 1])
2025-06-03 10:16:27,307 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:27,944 - DEBUG - Step 27: Loss=0.5864
2025-06-03 10:16:27,944 - DEBUG - Online update step: 28/50
2025-06-03 10:16:27,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:28,573 - DEBUG - Node anomaly scores shape: torch.Size([22315, 1])
2025-06-03 10:16:28,585 - DEBUG - Edge anomaly scores shape: torch.Size([46860, 1])
2025-06-03 10:16:28,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:29,299 - DEBUG - Step 28: Loss=0.5816
2025-06-03 10:16:29,299 - DEBUG - Online update step: 29/50
2025-06-03 10:16:29,302 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:29,850 - DEBUG - Node anomaly scores shape: torch.Size([21360, 1])
2025-06-03 10:16:29,862 - DEBUG - Edge anomaly scores shape: torch.Size([44653, 1])
2025-06-03 10:16:29,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:30,478 - DEBUG - Step 29: Loss=0.5835
2025-06-03 10:16:30,478 - DEBUG - Online update step: 30/50
2025-06-03 10:16:30,483 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:31,048 - DEBUG - Node anomaly scores shape: torch.Size([21780, 1])
2025-06-03 10:16:31,060 - DEBUG - Edge anomaly scores shape: torch.Size([45588, 1])
2025-06-03 10:16:31,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:31,734 - DEBUG - Step 30: Loss=0.5815
2025-06-03 10:16:31,735 - DEBUG - Online update step: 31/50
2025-06-03 10:16:31,737 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:32,311 - DEBUG - Node anomaly scores shape: torch.Size([21656, 1])
2025-06-03 10:16:32,322 - DEBUG - Edge anomaly scores shape: torch.Size([45373, 1])
2025-06-03 10:16:32,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:32,951 - DEBUG - Step 31: Loss=0.5816
2025-06-03 10:16:32,951 - DEBUG - Online update step: 32/50
2025-06-03 10:16:32,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:33,547 - DEBUG - Node anomaly scores shape: torch.Size([22135, 1])
2025-06-03 10:16:33,560 - DEBUG - Edge anomaly scores shape: torch.Size([46475, 1])
2025-06-03 10:16:33,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:34,194 - DEBUG - Step 32: Loss=0.5799
2025-06-03 10:16:34,194 - DEBUG - Online update step: 33/50
2025-06-03 10:16:34,197 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:34,759 - DEBUG - Node anomaly scores shape: torch.Size([21721, 1])
2025-06-03 10:16:34,769 - DEBUG - Edge anomaly scores shape: torch.Size([45431, 1])
2025-06-03 10:16:34,771 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:35,398 - DEBUG - Step 33: Loss=0.5811
2025-06-03 10:16:35,398 - DEBUG - Online update step: 34/50
2025-06-03 10:16:35,401 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:35,992 - DEBUG - Node anomaly scores shape: torch.Size([22002, 1])
2025-06-03 10:16:36,004 - DEBUG - Edge anomaly scores shape: torch.Size([46084, 1])
2025-06-03 10:16:36,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:36,718 - DEBUG - Step 34: Loss=0.5797
2025-06-03 10:16:36,718 - DEBUG - Online update step: 35/50
2025-06-03 10:16:36,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:37,331 - DEBUG - Node anomaly scores shape: torch.Size([22398, 1])
2025-06-03 10:16:37,343 - DEBUG - Edge anomaly scores shape: torch.Size([47057, 1])
2025-06-03 10:16:37,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:38,011 - DEBUG - Step 35: Loss=0.5802
2025-06-03 10:16:38,012 - DEBUG - Online update step: 36/50
2025-06-03 10:16:38,015 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:38,608 - DEBUG - Node anomaly scores shape: torch.Size([22266, 1])
2025-06-03 10:16:38,620 - DEBUG - Edge anomaly scores shape: torch.Size([46787, 1])
2025-06-03 10:16:38,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:39,277 - DEBUG - Step 36: Loss=0.5792
2025-06-03 10:16:39,278 - DEBUG - Online update step: 37/50
2025-06-03 10:16:39,282 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:39,930 - DEBUG - Node anomaly scores shape: torch.Size([21930, 1])
2025-06-03 10:16:39,952 - DEBUG - Edge anomaly scores shape: torch.Size([46044, 1])
2025-06-03 10:16:39,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:40,861 - DEBUG - Step 37: Loss=0.5796
2025-06-03 10:16:40,861 - DEBUG - Online update step: 38/50
2025-06-03 10:16:40,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:41,559 - DEBUG - Node anomaly scores shape: torch.Size([21638, 1])
2025-06-03 10:16:41,572 - DEBUG - Edge anomaly scores shape: torch.Size([45310, 1])
2025-06-03 10:16:41,574 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:42,408 - DEBUG - Step 38: Loss=0.5780
2025-06-03 10:16:42,408 - DEBUG - Online update step: 39/50
2025-06-03 10:16:42,414 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:43,082 - DEBUG - Node anomaly scores shape: torch.Size([22267, 1])
2025-06-03 10:16:43,095 - DEBUG - Edge anomaly scores shape: torch.Size([46795, 1])
2025-06-03 10:16:43,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:43,750 - DEBUG - Step 39: Loss=0.5788
2025-06-03 10:16:43,750 - DEBUG - Online update step: 40/50
2025-06-03 10:16:43,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:44,346 - DEBUG - Node anomaly scores shape: torch.Size([22131, 1])
2025-06-03 10:16:44,358 - DEBUG - Edge anomaly scores shape: torch.Size([46433, 1])
2025-06-03 10:16:44,360 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:45,072 - DEBUG - Step 40: Loss=0.5779
2025-06-03 10:16:45,072 - DEBUG - Online update step: 41/50
2025-06-03 10:16:45,075 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:45,694 - DEBUG - Node anomaly scores shape: torch.Size([21589, 1])
2025-06-03 10:16:45,704 - DEBUG - Edge anomaly scores shape: torch.Size([45208, 1])
2025-06-03 10:16:45,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:46,440 - DEBUG - Step 41: Loss=0.5787
2025-06-03 10:16:46,440 - DEBUG - Online update step: 42/50
2025-06-03 10:16:46,446 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:47,112 - DEBUG - Node anomaly scores shape: torch.Size([22359, 1])
2025-06-03 10:16:47,126 - DEBUG - Edge anomaly scores shape: torch.Size([47036, 1])
2025-06-03 10:16:47,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:47,857 - DEBUG - Step 42: Loss=0.5770
2025-06-03 10:16:47,858 - DEBUG - Online update step: 43/50
2025-06-03 10:16:47,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:48,564 - DEBUG - Node anomaly scores shape: torch.Size([21847, 1])
2025-06-03 10:16:48,577 - DEBUG - Edge anomaly scores shape: torch.Size([45838, 1])
2025-06-03 10:16:48,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:49,277 - DEBUG - Step 43: Loss=0.5788
2025-06-03 10:16:49,277 - DEBUG - Online update step: 44/50
2025-06-03 10:16:49,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:49,846 - DEBUG - Node anomaly scores shape: torch.Size([21165, 1])
2025-06-03 10:16:49,857 - DEBUG - Edge anomaly scores shape: torch.Size([44199, 1])
2025-06-03 10:16:49,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:50,505 - DEBUG - Step 44: Loss=0.5766
2025-06-03 10:16:50,506 - DEBUG - Online update step: 45/50
2025-06-03 10:16:50,508 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:51,126 - DEBUG - Node anomaly scores shape: torch.Size([22036, 1])
2025-06-03 10:16:51,137 - DEBUG - Edge anomaly scores shape: torch.Size([46169, 1])
2025-06-03 10:16:51,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:51,836 - DEBUG - Step 45: Loss=0.5787
2025-06-03 10:16:51,836 - DEBUG - Online update step: 46/50
2025-06-03 10:16:51,840 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:52,448 - DEBUG - Node anomaly scores shape: torch.Size([22226, 1])
2025-06-03 10:16:52,460 - DEBUG - Edge anomaly scores shape: torch.Size([46703, 1])
2025-06-03 10:16:52,462 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:53,153 - DEBUG - Step 46: Loss=0.5770
2025-06-03 10:16:53,154 - DEBUG - Online update step: 47/50
2025-06-03 10:16:53,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:53,744 - DEBUG - Node anomaly scores shape: torch.Size([21327, 1])
2025-06-03 10:16:53,754 - DEBUG - Edge anomaly scores shape: torch.Size([44609, 1])
2025-06-03 10:16:53,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:54,439 - DEBUG - Step 47: Loss=0.5786
2025-06-03 10:16:54,439 - DEBUG - Online update step: 48/50
2025-06-03 10:16:54,445 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:55,125 - DEBUG - Node anomaly scores shape: torch.Size([21700, 1])
2025-06-03 10:16:55,137 - DEBUG - Edge anomaly scores shape: torch.Size([45343, 1])
2025-06-03 10:16:55,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:56,132 - DEBUG - Step 48: Loss=0.5769
2025-06-03 10:16:56,133 - DEBUG - Online update step: 49/50
2025-06-03 10:16:56,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:56,844 - DEBUG - Node anomaly scores shape: torch.Size([22829, 1])
2025-06-03 10:16:56,855 - DEBUG - Edge anomaly scores shape: torch.Size([48042, 1])
2025-06-03 10:16:56,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:57,593 - DEBUG - Step 49: Loss=0.5773
2025-06-03 10:16:57,593 - DEBUG - Online update step: 50/50
2025-06-03 10:16:57,599 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:16:58,201 - DEBUG - Node anomaly scores shape: torch.Size([21358, 1])
2025-06-03 10:16:58,212 - DEBUG - Edge anomaly scores shape: torch.Size([44633, 1])
2025-06-03 10:16:58,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:16:58,914 - DEBUG - Step 50: Loss=0.5774
2025-06-03 10:16:58,915 - INFO - Online update finished. Average loss: 0.5820, Learning rate: 0.001000
2025-06-03 10:16:58,916 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.4783635e-09  3.1723054e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.9307636e-09
 -6.1959092e-08  8.4264364e-09 -1.3878836e-08  8.9221093e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.3383164e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  4.2627853e-08 -2.3792291e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.4374509e-08 -4.9071598e-08], current edge mean: [ 9.1468067e+00  1.4180171e+00  5.6916113e+00 -3.6365084e-09
  0.0000000e+00  2.7273812e-09 -2.7273812e-09 -2.2159974e-09
 -2.3864586e-09  1.8182542e-09]
2025-06-03 10:16:58,916 - DEBUG - Node drift difference: 0.0202, Edge drift difference: 0.0112
2025-06-03 10:16:58,917 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.4783635e-09  3.1723054e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.9307636e-09
 -6.1959092e-08  8.4264364e-09 -1.3878836e-08  8.9221093e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.3383164e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  4.2627853e-08 -2.3792291e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.4374509e-08 -4.9071598e-08], edge=[ 9.1468067e+00  1.4180171e+00  5.6916113e+00 -3.6365084e-09
  0.0000000e+00  2.7273812e-09 -2.7273812e-09 -2.2159974e-09
 -2.3864586e-09  1.8182542e-09]
2025-06-03 10:16:58,917 - DEBUG - Updated reference std: node=[0.         0.         1.0005201  1.0005201  0.         0.
 0.         1.0005201  1.0005201  1.0005202  1.0005201  1.0005201
 0.96617806 0.27114588 0.36217502 0.5716872  1.0005202  2.9931998
 2.895206   1.4912298  0.36217502 0.22568905 1.0005201  1.0005201
 0.         0.         0.         0.         1.0005202  1.0005201 ], edge=[1.1136607 0.5057603 2.15267   1.0002384 1.0002384 1.0002384 1.0002384
 1.0002384 1.0002384 1.0002384]
2025-06-03 10:16:58,926 - INFO - Online update complete. Loss: 0.5820
2025-06-03 10:16:58,926 - INFO - Running anomaly detection...
2025-06-03 10:16:58,926 - INFO - Starting anomaly detection.
2025-06-03 10:16:58,941 - DEBUG - Node reconstruction errors: [0.00441071 0.00279931 0.00226127 0.00357912 0.00346421 0.01370729
 0.00645763 0.00262094 0.00380584 0.01851114 0.00442179 0.00559959
 0.00261388 0.00251549 0.0347312  0.00379524 0.00548388 0.01321124
 0.00754361 0.01217427 0.01321127 0.0095017  0.00359565 0.00632826
 0.00192278 0.00855206 0.0062541  0.00205074 0.01321126 0.01321954
 0.00498652 0.00855206 0.00761408 0.01192418 0.00286005 0.00242906
 0.372025   0.00379445 0.00973297 0.004237   0.00602706 0.00286453
 0.00273345 0.00251547 0.00264256 0.01913021 0.1614309  0.01695476
 0.00584443 0.00638108 0.02271221 0.00359563 0.00293335 0.00379444
 0.00855207 0.00778024 0.0060229  0.0024258  0.01521592 0.00574285
 0.04238589 0.00322377 0.03491205 0.00317076 0.01003835 0.00550997
 0.00797774 0.00359565 0.00638109 0.00908056 0.01752421 0.01685127
 0.01773288 0.00241997 0.02480517 0.00902795 0.00638109 0.04774529
 0.03811661 0.01789496 0.00222815 0.00531609 0.00327404 0.00241124
 0.00248409 0.01074282 0.00539848 0.00181606 0.00590801 0.01615247
 0.00325721 0.00249412 0.00411535 0.00167703 0.00496135 0.01244158
 0.0030396  0.00270265 0.0019825  0.01559946 0.00220529 0.00303962
 0.00301243 0.01251521 0.00134741 0.01376859 0.00225165 0.02013442
 0.00469505 0.0026251  0.00959116 0.00310773 0.00323988 0.00200298
 0.00309282 0.00433159 0.00228067 0.00209747 0.00184117 0.00487549
 0.00264067 0.00494921 0.00165381 0.00509669 0.0031268  0.0048755
 0.00396094 0.0059277  0.00246605 0.00394405 0.00278756 0.00407349
 0.00779525 0.00975579 0.00279208 0.01364119 0.00232581 0.00200373
 0.00767888 0.00298093 0.0031452  0.03413203 0.00250233 0.00375326
 0.00325421 0.00335435 0.00228066 0.00928564 0.00327058 0.00220293
 0.0795203  0.00168257 0.00190556 0.0040735  0.00431088 0.00214001
 0.00402291 0.00442365 0.00220529 0.0031384  0.00314516 0.00239747
 0.00402291 0.00278756 0.00248507 0.00501669 0.00169178 0.00272657
 0.00177401 0.00220291 0.001971   0.00480946 0.00295121 0.01191503
 0.00184111 0.00444778 0.00258473 0.00263356 0.00186119 0.00186118
 0.01430977 0.00257142 0.00631786 0.00195828 0.00625773 0.00281567
 0.00233522 0.00203834 0.01419823 0.00343819 0.00380764 0.0017894
 0.00244513 0.00407239 0.00767894 0.00251996 0.02398902 0.00196201
 0.00326111 0.00224261 0.00350024 0.00402292 0.00318959 0.00246523
 0.00205998 0.00262896 0.01675477 0.01737397 0.0019142  0.0020307
 0.00224326 0.00339202 0.00316786 0.00488159 0.00402795 0.00248502
 0.00221289 0.00228066 0.05257824 0.00407241 0.00244976 0.00233523
 0.00256009 0.00316786 0.00402292 0.00313401 0.00176347 0.0040593
 0.00195162 0.00411127 0.00318756 0.0026619  0.00182821 0.00228067
 0.00228066 0.00335805 0.00287081 0.00256009 0.00402292 0.00285016
 0.00202325 0.00183275 0.00334316 0.00329262 0.00327293 0.00296198
 0.00252644 0.00392909 0.00334316 0.00440472 0.00295122 0.00280988
 0.05257827 0.00355682 0.00184279 0.00200839 0.00343817 0.00186705
 0.00195437 0.00186118 0.00274171 0.00358066 0.00748671 0.00491357
 0.00271308 0.00436339 0.00173091 0.01789742 0.00173091 0.00309255
 0.024183   0.00122899 0.0029683  0.00378409 0.00128444 0.01563806
 0.00308147 0.01964142 0.01430979 0.00276373 0.00801804 0.00305427
 0.00269829 0.00250044 0.00301507 0.00271938 0.00666923 0.00305858
 0.00257142 0.008855   0.00471379 0.00298206 0.04123988 0.00327292
 0.00850668 0.00236992 0.00337408 0.00186115 0.00251996 0.00225411
 0.00266365 0.00157204 0.00111231 0.00418283 0.00152396 0.00152397
 0.00152398 0.0012209  0.00192356 0.00157203 0.00152398 0.00438004
 0.00152398 0.0031193  0.0048328  0.0025678  0.01368027 0.00264938
 0.00300468 0.00246123 0.00249258 0.00490913 0.00338342 0.00111231
 0.01963887 0.00140845 0.03574518 0.00291727 0.0019657  0.00196571
 0.02413716 0.00242593 0.00152396 0.00128445 0.00152398 0.0012209
 0.00356591 0.00243332 0.00170836 0.00175272 0.00157195 0.00330931
 0.00175271 0.00334653 0.00309982 0.00207835 0.0011123  0.00278443
 0.00165976 0.00218706 0.00152395 0.0029635  0.00395982 0.00362041
 0.00363506 0.00343818 0.00152293 0.00152396 0.00178685 0.00553814
 0.003234   0.0028287  0.01035764 0.00312152 0.0011123  0.00720421
 0.00214777 0.00451317 0.00165293 0.00243388 0.00294062 0.00301547
 0.00293405 0.00391202 0.00206126 0.00450662 0.00215462 0.00262126
 0.00428156 0.00152396 0.00111231 0.00296284 0.00307977 0.00277578
 0.0031538  0.00412962 0.01490966 0.00270913 0.0012556  0.00152396
 0.01371249 0.0020678  0.00176721 0.00214762 0.00098112 0.00098113
 0.00098114 0.00490955 0.0013359  0.00501582 0.00301536 0.01032532
 0.00410887 0.00133591 0.00185921 0.0017672  0.00331852 0.00396197
 0.00176722 0.01974696 0.00098114 0.00176721 0.00133591 0.00098113
 0.00098114 0.00496084 0.00357349 0.00098114 0.00215536 0.00230203
 0.00366084 0.00307555 0.00199316 0.00292138 0.00260212 0.00411777
 0.00290701 0.00251284 0.00466291 0.00366042 0.00176624 0.01546826
 0.00177129 0.00106239 0.00427437 0.00098113 0.00301536 0.00157904
 0.00241016 0.00299451 0.00205551 0.00234787 0.00821492 0.00220488
 0.00192565 0.0049451  0.02180656 0.0028093  0.00242083 0.00283033
 0.00344257 0.00178593 0.00284348 0.00157716 0.00178593 0.01593318
 0.0029214  0.00268615 0.00309539 0.00221863 0.00174747 0.00286299
 0.0028947  0.00230165 0.00289462 0.002863   0.00176594 0.00355882
 0.00381818 0.00241706 0.00176594 0.00174745 0.00352434 0.00480485
 0.00331284 0.0019931  0.00355884 0.00174746 0.00200719 0.00279083
 0.00316738 0.04547187 0.00242855 0.00280929 0.00336293 0.00242801
 0.00178593 0.00360118 0.00684058 0.00480639 0.00234991 0.00200719
 0.0034526  0.00211892 0.003178   0.0028953  0.00189239 0.01571146
 0.00126391 0.00279082 0.00566582 0.00211892 0.00715415 0.00285071
 0.00164507 0.00338098 0.00151695 0.00649041 0.00262982 0.00178593
 0.00556039 0.00246528 0.00246528 0.00236001 0.00277187 0.00219178
 0.00151695 0.00114827 0.00322107 0.00304422 0.00369472 0.00234786
 0.00151695 0.00238696 0.00164508 0.0018924  0.00239578 0.00375035
 0.00369472 0.0015487  0.00219178 0.00343054 0.00126392 0.00279082
 0.00189239 0.00185133 0.00269068 0.00167742 0.00126392 0.00096534
 0.00126392 0.00342857 0.00269793 0.00114826 0.00259947 0.00872559
 0.00543106 0.00131038 0.00547039 0.00131038 0.00131038 0.00131038
 0.00131039 0.00131038 0.00131038 0.00131039 0.00135279 0.00240671
 0.00638616 0.00131037 0.00131038 0.00131038 0.00131038 0.00131039
 0.00131039 0.00131039 0.00131039 0.00131039 0.0012131  0.00131039
 0.00131038 0.00299629 0.00131039 0.00596074 0.00714995 0.00126392
 0.00672536 0.0039288  0.00617784 0.00617784 0.00137298 0.00672535
 0.00126391 0.00151695 0.00151695 0.00276065 0.00151694 0.00256185
 0.00403057 0.00131036 0.00234786 0.00126391 0.00246527 0.00126391
 0.0012639  0.00312693 0.00126392 0.00151695 0.00126392 0.00126392
 0.00114827 0.00151695 0.00126391 0.00151696 0.00126391 0.00126391
 0.00126391 0.00228775 0.00345146 0.00211791 0.00131039 0.01535499
 0.00568527 0.00126391 0.00151695 0.0031756  0.00131038 0.00323901
 0.00257892 0.0016794  0.00126392 0.00126391 0.00235729 0.00214732
 0.0035638  0.0012639  0.0013528  0.00197207 0.00151695 0.0032629
 0.00131039 0.0037801  0.00364418 0.00131038 0.00131037 0.00135279
 0.00197207 0.00126392 0.01258531 0.00330583 0.00343276 0.00214732
 0.00199023 0.00107027 0.00107027 0.00703688 0.00219934 0.00131038
 0.00244092 0.00445134 0.00214731 0.00212601 0.00211692 0.00190543
 0.00138494 0.00138494 0.00138494 0.00138493 0.00138494 0.00125384
 0.00395033 0.00138494 0.00138494 0.00131039 0.00188337 0.00131039
 0.00107027 0.00395189 0.00415159 0.00389799 0.00464105 0.00396444
 0.0012131  0.00321702 0.0012131  0.00131038 0.00107028 0.00166405
 0.0015347  0.00153472 0.00138494 0.00166404 0.00224551 0.00442072
 0.00185393 0.00131038 0.00138493 0.00179225 0.0015347  0.00182594
 0.00184176 0.00173835 0.00125385 0.00330652 0.00202548 0.00390808
 0.00248012 0.00184177 0.00249097 0.00170011 0.00191329 0.00209093
 0.0015263  0.00175375 0.0012077  0.00184176 0.00184177 0.00184177
 0.00206139 0.00179225 0.00184176 0.00191328 0.00184177 0.00184177
 0.00184177 0.00213793 0.00179019 0.00347113 0.00263508 0.00139186
 0.00367994 0.00160218 0.00398367 0.00827024 0.00203673 0.00192363
 0.00208042 0.01791883 0.01791881 0.00191328 0.00244879 0.05949237
 0.00203778 0.00154448 0.00625108 0.0026631  0.00203434 0.00203435
 0.00203433 0.00161056 0.00214786 0.00360087 0.01920981 0.00514259
 0.00298978 0.00210263 0.00190102 0.00154447 0.00227703 0.00266244
 0.00218337 0.00328166 0.00203778 0.05949251 0.00154448 0.00266244
 0.00210263 0.00419787 0.00203433 0.00161056 0.00218333 0.00200519
 0.01863898 0.00161055 0.00161055 0.00161057 0.00526808 0.06097801
 0.01812596 0.00203435 0.0264893  0.00161055 0.00177568 0.00277429
 0.01434099 0.00259681 0.00161056 0.00152283 0.00230107 0.0021265
 0.04103293 0.00259674 0.01361053 0.00297836 0.00402273 0.00259685
 0.002551   0.01924619 0.00280042 0.00280539 0.0020403  0.00196957
 0.00196955 0.0056237  0.01145015 0.00776524 0.00259685 0.00280043
 0.00259685 0.00202742 0.00175521 0.00175521 0.00190875 0.00321703
 0.00250117 0.00175521 0.00202743 0.0038734  0.00175521 0.00175521
 0.00126023 0.00357969 0.00264507 0.00309645 0.00175521 0.00254315
 0.00387342 0.00175521 0.00190615 0.00357969 0.00229097 0.00229097
 0.00545506 0.00295128 0.00175522 0.00295127 0.0033764  0.00373587
 0.01894501 0.00175521 0.02061697 0.00309526 0.00309527 0.00377394
 0.00133846 0.00297905 0.00190614 0.00460907 0.00210604 0.01961281
 0.00333311 0.01961278 0.01015236 0.00234219 0.00333312 0.00140613
 0.00140613 0.01538761 0.00140612 0.00575801 0.0013385  0.01946572
 0.00237587 0.00234219 0.00237587 0.00400198 0.00392984 0.00686924
 0.00140612 0.00498437 0.00355423 0.00140613 0.00285201 0.0290564
 0.00498437 0.00234217 0.00140613 0.02193856 0.00140612 0.00140612
 0.00140613 0.00213518 0.00228595 0.00213518 0.00243216 0.00213517
 0.00198721 0.00188709 0.00317301 0.00140613 0.00140612 0.00190039
 0.00140613 0.02697072 0.00243217 0.00213518 0.0019004  0.00140613
 0.00140612 0.00415875 0.00190038 0.00140613 0.00155421 0.00271407
 0.00250684 0.00915959 0.00155421 0.00140612 0.00140613 0.00422124
 0.00231221 0.00242512 0.0024251  0.00148852 0.02065151 0.00252941
 0.00302006 0.07114743 0.00242511 0.00223778 0.0024251  0.00492806
 0.00302008 0.00242512 0.00165652 0.00250682 0.00315507 0.0020489
 0.00244708 0.00189478 0.00277372 0.00227045 0.00166163 0.00166163
 0.00319669 0.00571586 0.00166161 0.00166162 0.00545526 0.00349271
 0.00166163 0.00166162 0.00166163 0.00166162 0.00571584 0.00571585
 0.00571587 0.00571585 0.00571583 0.00240087 0.00571587 0.00571585
 0.00166163 0.00166163 0.11781558 0.00278145 0.00235166 0.00571581
 0.00251514 0.0017647  0.00318378 0.00166164 0.00176469 0.00176469
 0.003162   0.00495473 0.00495474 0.00245945 0.00495475 0.00495475
 0.00260992 0.00495468]
2025-06-03 10:16:58,941 - DEBUG - Edge reconstruction errors: [0.15528592 1.6575112  1.6585656  ... 0.15485017 1.2517881  0.15493432]
2025-06-03 10:16:58,943 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101658_update_37.json
2025-06-03 10:16:58,944 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:16:58,961 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101658_update_37.pth and as latest_checkpoint.pth
2025-06-03 10:16:58,961 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.3356
2025-06-03 10:16:58,961 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 10:16:58,961 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3720, MLP Score: 0.4966
2025-06-03 10:16:58,961 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1614, MLP Score: 0.4967
2025-06-03 10:16:58,961 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0477, MLP Score: 0.4962
2025-06-03 10:16:58,961 - WARNING -   Node ID: 185.125.190.58, Recon Error: 0.0795, MLP Score: 0.4940
2025-06-03 10:16:58,961 - WARNING -   Node ID: 142.250.198.187, Recon Error: 0.0526, MLP Score: 0.4955
2025-06-03 10:16:58,961 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:16:58,961 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8296, MLP Score: 0.5015
2025-06-03 10:16:58,962 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.2943, MLP Score: 0.5018
2025-06-03 10:16:58,962 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9563, MLP Score: 0.4991
2025-06-03 10:16:58,962 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4533, MLP Score: 0.5000
2025-06-03 10:16:58,962 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4432, MLP Score: 0.5006
2025-06-03 10:16:58,962 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-03 10:16:58,962 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-03 10:16:58,962 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-03 10:16:58,995 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-03 10:16:59,023 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-03 10:16:59,023 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-03 10:16:59,023 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-03 10:16:59,047 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-03 10:16:59,072 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-03 10:16:59,072 - INFO - Processing node updates/additions.
2025-06-03 10:16:59,077 - INFO - Processing edge updates/additions.
2025-06-03 10:16:59,089 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:16:59,090 - INFO - Finished updating NetworkX graph.
2025-06-03 10:16:59,090 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:16:59,091 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:16:59,100 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-03 10:16:59,102 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:16:59,102 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-03 10:16:59,103 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-03 10:16:59,104 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:16:59,109 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:16:59,110 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:16:59,111 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:16:59,113 - DEBUG - Shape of encoded categorical edge features: torch.Size([2150, 3])
2025-06-03 10:16:59,114 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:16:59,114 - DEBUG - Shape of scaled numerical edge features: torch.Size([2150, 7])
2025-06-03 10:16:59,114 - DEBUG - Final edge attributes tensor shape: torch.Size([2150, 10])
2025-06-03 10:16:59,114 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:16:59,116 - INFO - Performing online update...
2025-06-03 10:16:59,117 - INFO - Starting online update for 50 steps.
2025-06-03 10:16:59,117 - DEBUG - Updated RunningStats: new_mean=0.9506991059323738, new_var=21600000000161.652, new_n=2190
2025-06-03 10:16:59,117 - DEBUG - Updated RunningStats: new_mean=0.9478216125608875, new_var=21900000000018.25, new_n=2220
2025-06-03 10:16:59,117 - DEBUG - Updated RunningStats: new_mean=1.2017276767494265, new_var=7200000000093.587, new_n=730
2025-06-03 10:16:59,118 - DEBUG - Updated RunningStats: new_mean=1.200025246866846, new_var=7300000000001.655, new_n=740
2025-06-03 10:16:59,118 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:16:59,118 - DEBUG - Online update step: 1/50
2025-06-03 10:16:59,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:00,016 - DEBUG - Node anomaly scores shape: torch.Size([21639, 1])
2025-06-03 10:17:00,029 - DEBUG - Edge anomaly scores shape: torch.Size([45288, 1])
2025-06-03 10:17:00,030 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:00,797 - DEBUG - Step 1: Loss=0.5767
2025-06-03 10:17:00,797 - DEBUG - Online update step: 2/50
2025-06-03 10:17:00,801 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:01,457 - DEBUG - Node anomaly scores shape: torch.Size([22044, 1])
2025-06-03 10:17:01,472 - DEBUG - Edge anomaly scores shape: torch.Size([46323, 1])
2025-06-03 10:17:01,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:02,185 - DEBUG - Step 2: Loss=0.5764
2025-06-03 10:17:02,185 - DEBUG - Online update step: 3/50
2025-06-03 10:17:02,188 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:02,856 - DEBUG - Node anomaly scores shape: torch.Size([23139, 1])
2025-06-03 10:17:02,869 - DEBUG - Edge anomaly scores shape: torch.Size([48736, 1])
2025-06-03 10:17:02,871 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:03,756 - DEBUG - Step 3: Loss=0.5751
2025-06-03 10:17:03,756 - DEBUG - Online update step: 4/50
2025-06-03 10:17:03,762 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:04,438 - DEBUG - Node anomaly scores shape: torch.Size([22185, 1])
2025-06-03 10:17:04,449 - DEBUG - Edge anomaly scores shape: torch.Size([46553, 1])
2025-06-03 10:17:04,451 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:05,142 - DEBUG - Step 4: Loss=0.5775
2025-06-03 10:17:05,142 - DEBUG - Online update step: 5/50
2025-06-03 10:17:05,146 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:05,768 - DEBUG - Node anomaly scores shape: torch.Size([21919, 1])
2025-06-03 10:17:05,780 - DEBUG - Edge anomaly scores shape: torch.Size([46018, 1])
2025-06-03 10:17:05,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:06,460 - DEBUG - Step 5: Loss=0.5770
2025-06-03 10:17:06,461 - DEBUG - Online update step: 6/50
2025-06-03 10:17:06,463 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:07,093 - DEBUG - Node anomaly scores shape: torch.Size([22352, 1])
2025-06-03 10:17:07,107 - DEBUG - Edge anomaly scores shape: torch.Size([46998, 1])
2025-06-03 10:17:07,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:08,001 - DEBUG - Step 6: Loss=0.5757
2025-06-03 10:17:08,001 - DEBUG - Online update step: 7/50
2025-06-03 10:17:08,005 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:08,703 - DEBUG - Node anomaly scores shape: torch.Size([21857, 1])
2025-06-03 10:17:08,716 - DEBUG - Edge anomaly scores shape: torch.Size([45795, 1])
2025-06-03 10:17:08,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:09,488 - DEBUG - Step 7: Loss=0.5753
2025-06-03 10:17:09,489 - DEBUG - Online update step: 8/50
2025-06-03 10:17:09,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:10,232 - DEBUG - Node anomaly scores shape: torch.Size([23673, 1])
2025-06-03 10:17:10,246 - DEBUG - Edge anomaly scores shape: torch.Size([50103, 1])
2025-06-03 10:17:10,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:11,031 - DEBUG - Step 8: Loss=0.5765
2025-06-03 10:17:11,031 - DEBUG - Online update step: 9/50
2025-06-03 10:17:11,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:11,716 - DEBUG - Node anomaly scores shape: torch.Size([23411, 1])
2025-06-03 10:17:11,729 - DEBUG - Edge anomaly scores shape: torch.Size([49449, 1])
2025-06-03 10:17:11,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:12,440 - DEBUG - Step 9: Loss=0.5758
2025-06-03 10:17:12,441 - DEBUG - Online update step: 10/50
2025-06-03 10:17:12,445 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:13,111 - DEBUG - Node anomaly scores shape: torch.Size([22833, 1])
2025-06-03 10:17:13,134 - DEBUG - Edge anomaly scores shape: torch.Size([48145, 1])
2025-06-03 10:17:13,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:13,868 - DEBUG - Step 10: Loss=0.5764
2025-06-03 10:17:13,868 - DEBUG - Online update step: 11/50
2025-06-03 10:17:13,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:14,466 - DEBUG - Node anomaly scores shape: torch.Size([22174, 1])
2025-06-03 10:17:14,478 - DEBUG - Edge anomaly scores shape: torch.Size([46520, 1])
2025-06-03 10:17:14,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:15,200 - DEBUG - Step 11: Loss=0.5764
2025-06-03 10:17:15,200 - DEBUG - Online update step: 12/50
2025-06-03 10:17:15,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:15,908 - DEBUG - Node anomaly scores shape: torch.Size([23244, 1])
2025-06-03 10:17:15,920 - DEBUG - Edge anomaly scores shape: torch.Size([48936, 1])
2025-06-03 10:17:15,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:16,638 - DEBUG - Step 12: Loss=0.5755
2025-06-03 10:17:16,639 - DEBUG - Online update step: 13/50
2025-06-03 10:17:16,642 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:17,253 - DEBUG - Node anomaly scores shape: torch.Size([22143, 1])
2025-06-03 10:17:17,264 - DEBUG - Edge anomaly scores shape: torch.Size([46532, 1])
2025-06-03 10:17:17,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:17,952 - DEBUG - Step 13: Loss=0.5753
2025-06-03 10:17:17,952 - DEBUG - Online update step: 14/50
2025-06-03 10:17:17,956 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:18,568 - DEBUG - Node anomaly scores shape: torch.Size([22045, 1])
2025-06-03 10:17:18,579 - DEBUG - Edge anomaly scores shape: torch.Size([46258, 1])
2025-06-03 10:17:18,581 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:19,349 - DEBUG - Step 14: Loss=0.5762
2025-06-03 10:17:19,349 - DEBUG - Online update step: 15/50
2025-06-03 10:17:19,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:20,406 - DEBUG - Node anomaly scores shape: torch.Size([22574, 1])
2025-06-03 10:17:20,429 - DEBUG - Edge anomaly scores shape: torch.Size([47432, 1])
2025-06-03 10:17:20,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:21,828 - DEBUG - Step 15: Loss=0.5757
2025-06-03 10:17:21,828 - DEBUG - Online update step: 16/50
2025-06-03 10:17:21,833 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:22,830 - DEBUG - Node anomaly scores shape: torch.Size([21969, 1])
2025-06-03 10:17:22,841 - DEBUG - Edge anomaly scores shape: torch.Size([46081, 1])
2025-06-03 10:17:22,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:23,483 - DEBUG - Step 16: Loss=0.5759
2025-06-03 10:17:23,483 - DEBUG - Online update step: 17/50
2025-06-03 10:17:23,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:24,228 - DEBUG - Node anomaly scores shape: torch.Size([22973, 1])
2025-06-03 10:17:24,242 - DEBUG - Edge anomaly scores shape: torch.Size([48350, 1])
2025-06-03 10:17:24,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:24,942 - DEBUG - Step 17: Loss=0.5754
2025-06-03 10:17:24,943 - DEBUG - Online update step: 18/50
2025-06-03 10:17:24,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:25,537 - DEBUG - Node anomaly scores shape: torch.Size([22191, 1])
2025-06-03 10:17:25,549 - DEBUG - Edge anomaly scores shape: torch.Size([46666, 1])
2025-06-03 10:17:25,550 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:26,161 - DEBUG - Step 18: Loss=0.5757
2025-06-03 10:17:26,161 - DEBUG - Online update step: 19/50
2025-06-03 10:17:26,164 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:26,724 - DEBUG - Node anomaly scores shape: torch.Size([21399, 1])
2025-06-03 10:17:26,738 - DEBUG - Edge anomaly scores shape: torch.Size([44760, 1])
2025-06-03 10:17:26,740 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:27,345 - DEBUG - Step 19: Loss=0.5752
2025-06-03 10:17:27,346 - DEBUG - Online update step: 20/50
2025-06-03 10:17:27,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:27,988 - DEBUG - Node anomaly scores shape: torch.Size([22187, 1])
2025-06-03 10:17:28,002 - DEBUG - Edge anomaly scores shape: torch.Size([46558, 1])
2025-06-03 10:17:28,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:28,666 - DEBUG - Step 20: Loss=0.5753
2025-06-03 10:17:28,666 - DEBUG - Online update step: 21/50
2025-06-03 10:17:28,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:29,338 - DEBUG - Node anomaly scores shape: torch.Size([21744, 1])
2025-06-03 10:17:29,350 - DEBUG - Edge anomaly scores shape: torch.Size([45554, 1])
2025-06-03 10:17:29,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:30,020 - DEBUG - Step 21: Loss=0.5749
2025-06-03 10:17:30,020 - DEBUG - Online update step: 22/50
2025-06-03 10:17:30,023 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:30,586 - DEBUG - Node anomaly scores shape: torch.Size([21485, 1])
2025-06-03 10:17:30,596 - DEBUG - Edge anomaly scores shape: torch.Size([45017, 1])
2025-06-03 10:17:30,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:31,240 - DEBUG - Step 22: Loss=0.5762
2025-06-03 10:17:31,241 - DEBUG - Online update step: 23/50
2025-06-03 10:17:31,244 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:31,901 - DEBUG - Node anomaly scores shape: torch.Size([22609, 1])
2025-06-03 10:17:31,913 - DEBUG - Edge anomaly scores shape: torch.Size([47635, 1])
2025-06-03 10:17:31,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:32,629 - DEBUG - Step 23: Loss=0.5763
2025-06-03 10:17:32,629 - DEBUG - Online update step: 24/50
2025-06-03 10:17:32,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:33,225 - DEBUG - Node anomaly scores shape: torch.Size([22332, 1])
2025-06-03 10:17:33,238 - DEBUG - Edge anomaly scores shape: torch.Size([46919, 1])
2025-06-03 10:17:33,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:33,906 - DEBUG - Step 24: Loss=0.5739
2025-06-03 10:17:33,906 - DEBUG - Online update step: 25/50
2025-06-03 10:17:33,909 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:34,516 - DEBUG - Node anomaly scores shape: torch.Size([22588, 1])
2025-06-03 10:17:34,527 - DEBUG - Edge anomaly scores shape: torch.Size([47538, 1])
2025-06-03 10:17:34,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:35,198 - DEBUG - Step 25: Loss=0.5746
2025-06-03 10:17:35,199 - DEBUG - Online update step: 26/50
2025-06-03 10:17:35,201 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:35,830 - DEBUG - Node anomaly scores shape: torch.Size([23386, 1])
2025-06-03 10:17:35,842 - DEBUG - Edge anomaly scores shape: torch.Size([49492, 1])
2025-06-03 10:17:35,843 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:36,591 - DEBUG - Step 26: Loss=0.5757
2025-06-03 10:17:36,591 - DEBUG - Online update step: 27/50
2025-06-03 10:17:36,594 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:37,182 - DEBUG - Node anomaly scores shape: torch.Size([22994, 1])
2025-06-03 10:17:37,194 - DEBUG - Edge anomaly scores shape: torch.Size([48498, 1])
2025-06-03 10:17:37,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:37,887 - DEBUG - Step 27: Loss=0.5746
2025-06-03 10:17:37,887 - DEBUG - Online update step: 28/50
2025-06-03 10:17:37,892 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:38,491 - DEBUG - Node anomaly scores shape: torch.Size([22411, 1])
2025-06-03 10:17:38,503 - DEBUG - Edge anomaly scores shape: torch.Size([47138, 1])
2025-06-03 10:17:38,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:39,172 - DEBUG - Step 28: Loss=0.5759
2025-06-03 10:17:39,172 - DEBUG - Online update step: 29/50
2025-06-03 10:17:39,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:39,816 - DEBUG - Node anomaly scores shape: torch.Size([23493, 1])
2025-06-03 10:17:39,829 - DEBUG - Edge anomaly scores shape: torch.Size([49720, 1])
2025-06-03 10:17:39,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:40,489 - DEBUG - Step 29: Loss=0.5754
2025-06-03 10:17:40,489 - DEBUG - Online update step: 30/50
2025-06-03 10:17:40,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:41,092 - DEBUG - Node anomaly scores shape: torch.Size([22330, 1])
2025-06-03 10:17:41,108 - DEBUG - Edge anomaly scores shape: torch.Size([46876, 1])
2025-06-03 10:17:41,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:41,876 - DEBUG - Step 30: Loss=0.5746
2025-06-03 10:17:41,877 - DEBUG - Online update step: 31/50
2025-06-03 10:17:41,883 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:42,623 - DEBUG - Node anomaly scores shape: torch.Size([22010, 1])
2025-06-03 10:17:42,637 - DEBUG - Edge anomaly scores shape: torch.Size([46170, 1])
2025-06-03 10:17:42,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:43,292 - DEBUG - Step 31: Loss=0.5747
2025-06-03 10:17:43,292 - DEBUG - Online update step: 32/50
2025-06-03 10:17:43,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:43,935 - DEBUG - Node anomaly scores shape: torch.Size([22660, 1])
2025-06-03 10:17:43,946 - DEBUG - Edge anomaly scores shape: torch.Size([47676, 1])
2025-06-03 10:17:43,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:44,611 - DEBUG - Step 32: Loss=0.5758
2025-06-03 10:17:44,613 - DEBUG - Online update step: 33/50
2025-06-03 10:17:44,619 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:45,329 - DEBUG - Node anomaly scores shape: torch.Size([21807, 1])
2025-06-03 10:17:45,339 - DEBUG - Edge anomaly scores shape: torch.Size([45673, 1])
2025-06-03 10:17:45,341 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:46,031 - DEBUG - Step 33: Loss=0.5747
2025-06-03 10:17:46,032 - DEBUG - Online update step: 34/50
2025-06-03 10:17:46,035 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:46,670 - DEBUG - Node anomaly scores shape: torch.Size([22531, 1])
2025-06-03 10:17:46,682 - DEBUG - Edge anomaly scores shape: torch.Size([47418, 1])
2025-06-03 10:17:46,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:47,283 - DEBUG - Step 34: Loss=0.5752
2025-06-03 10:17:47,284 - DEBUG - Online update step: 35/50
2025-06-03 10:17:47,287 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:47,886 - DEBUG - Node anomaly scores shape: torch.Size([22832, 1])
2025-06-03 10:17:47,898 - DEBUG - Edge anomaly scores shape: torch.Size([48017, 1])
2025-06-03 10:17:47,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:48,602 - DEBUG - Step 35: Loss=0.5751
2025-06-03 10:17:48,602 - DEBUG - Online update step: 36/50
2025-06-03 10:17:48,606 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:49,207 - DEBUG - Node anomaly scores shape: torch.Size([22123, 1])
2025-06-03 10:17:49,219 - DEBUG - Edge anomaly scores shape: torch.Size([46494, 1])
2025-06-03 10:17:49,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:49,917 - DEBUG - Step 36: Loss=0.5737
2025-06-03 10:17:49,918 - DEBUG - Online update step: 37/50
2025-06-03 10:17:49,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:50,489 - DEBUG - Node anomaly scores shape: torch.Size([22012, 1])
2025-06-03 10:17:50,500 - DEBUG - Edge anomaly scores shape: torch.Size([46152, 1])
2025-06-03 10:17:50,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:51,152 - DEBUG - Step 37: Loss=0.5737
2025-06-03 10:17:51,152 - DEBUG - Online update step: 38/50
2025-06-03 10:17:51,157 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:51,915 - DEBUG - Node anomaly scores shape: torch.Size([23200, 1])
2025-06-03 10:17:51,928 - DEBUG - Edge anomaly scores shape: torch.Size([48884, 1])
2025-06-03 10:17:51,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:52,695 - DEBUG - Step 38: Loss=0.5749
2025-06-03 10:17:52,695 - DEBUG - Online update step: 39/50
2025-06-03 10:17:52,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:53,405 - DEBUG - Node anomaly scores shape: torch.Size([21715, 1])
2025-06-03 10:17:53,417 - DEBUG - Edge anomaly scores shape: torch.Size([45482, 1])
2025-06-03 10:17:53,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:54,103 - DEBUG - Step 39: Loss=0.5736
2025-06-03 10:17:54,103 - DEBUG - Online update step: 40/50
2025-06-03 10:17:54,106 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:54,724 - DEBUG - Node anomaly scores shape: torch.Size([22483, 1])
2025-06-03 10:17:54,736 - DEBUG - Edge anomaly scores shape: torch.Size([47317, 1])
2025-06-03 10:17:54,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:55,428 - DEBUG - Step 40: Loss=0.5752
2025-06-03 10:17:55,428 - DEBUG - Online update step: 41/50
2025-06-03 10:17:55,433 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:56,036 - DEBUG - Node anomaly scores shape: torch.Size([22181, 1])
2025-06-03 10:17:56,047 - DEBUG - Edge anomaly scores shape: torch.Size([46657, 1])
2025-06-03 10:17:56,048 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:56,724 - DEBUG - Step 41: Loss=0.5748
2025-06-03 10:17:56,725 - DEBUG - Online update step: 42/50
2025-06-03 10:17:56,728 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:57,380 - DEBUG - Node anomaly scores shape: torch.Size([22652, 1])
2025-06-03 10:17:57,392 - DEBUG - Edge anomaly scores shape: torch.Size([47574, 1])
2025-06-03 10:17:57,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:58,164 - DEBUG - Step 42: Loss=0.5742
2025-06-03 10:17:58,164 - DEBUG - Online update step: 43/50
2025-06-03 10:17:58,167 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:17:58,839 - DEBUG - Node anomaly scores shape: torch.Size([22631, 1])
2025-06-03 10:17:58,868 - DEBUG - Edge anomaly scores shape: torch.Size([47616, 1])
2025-06-03 10:17:58,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:17:59,809 - DEBUG - Step 43: Loss=0.5746
2025-06-03 10:17:59,809 - DEBUG - Online update step: 44/50
2025-06-03 10:17:59,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:00,541 - DEBUG - Node anomaly scores shape: torch.Size([22450, 1])
2025-06-03 10:18:00,553 - DEBUG - Edge anomaly scores shape: torch.Size([47268, 1])
2025-06-03 10:18:00,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:01,341 - DEBUG - Step 44: Loss=0.5742
2025-06-03 10:18:01,341 - DEBUG - Online update step: 45/50
2025-06-03 10:18:01,344 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:01,978 - DEBUG - Node anomaly scores shape: torch.Size([23074, 1])
2025-06-03 10:18:01,991 - DEBUG - Edge anomaly scores shape: torch.Size([48646, 1])
2025-06-03 10:18:01,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:02,697 - DEBUG - Step 45: Loss=0.5733
2025-06-03 10:18:02,697 - DEBUG - Online update step: 46/50
2025-06-03 10:18:02,700 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:03,285 - DEBUG - Node anomaly scores shape: torch.Size([21871, 1])
2025-06-03 10:18:03,296 - DEBUG - Edge anomaly scores shape: torch.Size([45911, 1])
2025-06-03 10:18:03,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:03,976 - DEBUG - Step 46: Loss=0.5747
2025-06-03 10:18:03,976 - DEBUG - Online update step: 47/50
2025-06-03 10:18:03,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:04,596 - DEBUG - Node anomaly scores shape: torch.Size([22466, 1])
2025-06-03 10:18:04,608 - DEBUG - Edge anomaly scores shape: torch.Size([47270, 1])
2025-06-03 10:18:04,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:05,351 - DEBUG - Step 47: Loss=0.5741
2025-06-03 10:18:05,352 - DEBUG - Online update step: 48/50
2025-06-03 10:18:05,355 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:06,076 - DEBUG - Node anomaly scores shape: torch.Size([22417, 1])
2025-06-03 10:18:06,091 - DEBUG - Edge anomaly scores shape: torch.Size([47021, 1])
2025-06-03 10:18:06,092 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:06,871 - DEBUG - Step 48: Loss=0.5741
2025-06-03 10:18:06,871 - DEBUG - Online update step: 49/50
2025-06-03 10:18:06,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:07,612 - DEBUG - Node anomaly scores shape: torch.Size([21556, 1])
2025-06-03 10:18:07,626 - DEBUG - Edge anomaly scores shape: torch.Size([45107, 1])
2025-06-03 10:18:07,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:08,521 - DEBUG - Step 49: Loss=0.5743
2025-06-03 10:18:08,522 - DEBUG - Online update step: 50/50
2025-06-03 10:18:08,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:09,610 - DEBUG - Node anomaly scores shape: torch.Size([22428, 1])
2025-06-03 10:18:09,627 - DEBUG - Edge anomaly scores shape: torch.Size([47066, 1])
2025-06-03 10:18:09,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:10,904 - DEBUG - Step 50: Loss=0.5741
2025-06-03 10:18:10,905 - INFO - Online update finished. Average loss: 0.5752, Learning rate: 0.001000
2025-06-03 10:18:10,906 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.5007057e-08  2.5173129e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1860417e-08
  3.8727892e-09  2.2873660e-08  1.4522960e-09  9.6819726e-09
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.2873660e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -5.2040603e-09 -3.8727890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8879847e-08  1.8637797e-08], current edge mean: [ 9.1479073e+00  1.4181396e+00  5.7032557e+00 -1.7742778e-09
  8.8713892e-10  4.4356946e-10  2.6614166e-09  1.2198160e-09
 -3.1049860e-09 -4.4356946e-10]
2025-06-03 10:18:10,906 - DEBUG - Node drift difference: 0.0114, Edge drift difference: 0.0054
2025-06-03 10:18:10,907 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.5007057e-08  2.5173129e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1860417e-08
  3.8727892e-09  2.2873660e-08  1.4522960e-09  9.6819726e-09
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.2873660e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -5.2040603e-09 -3.8727890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8879847e-08  1.8637797e-08], edge=[ 9.1479073e+00  1.4181396e+00  5.7032557e+00 -1.7742778e-09
  8.8713892e-10  4.4356946e-10  2.6614166e-09  1.2198160e-09
 -3.1049860e-09 -4.4356946e-10]
2025-06-03 10:18:10,908 - DEBUG - Updated reference std: node=[0.         0.         1.000508   1.000508   0.         0.
 0.         1.0005081  1.0005081  1.0005081  1.000508   1.000508
 0.9526825  0.2752198  0.36361656 0.57165736 1.000508   3.002603
 2.8995261  1.4748815  0.36361656 0.22303854 1.000508   1.0005081
 0.         0.         0.         0.         1.000508   1.000508  ], edge=[1.1102479 0.5054807 2.1401215 1.0002327 1.0002327 1.0002327 1.0002327
 1.0002326 1.0002327 1.0002326]
2025-06-03 10:18:10,914 - INFO - Online update complete. Loss: 0.5752
2025-06-03 10:18:10,914 - INFO - Running anomaly detection...
2025-06-03 10:18:10,914 - INFO - Starting anomaly detection.
2025-06-03 10:18:10,940 - DEBUG - Node reconstruction errors: [2.31638551e-03 1.99237559e-03 9.72109556e-04 9.38428042e-04
 1.87427364e-03 1.41697535e-02 4.98721050e-03 8.12418992e-04
 1.60695007e-03 1.50019974e-02 2.79790815e-03 3.33615392e-03
 1.27445802e-03 9.95887909e-04 2.93464456e-02 2.09892751e-03
 3.22721805e-03 1.10763069e-02 4.19556955e-03 1.34030003e-02
 1.10762967e-02 7.83698820e-03 1.24210434e-03 4.05485276e-03
 1.71678595e-03 6.15324406e-03 3.31242429e-03 4.12781286e-04
 1.10762995e-02 1.15710413e-02 2.49440735e-03 6.15324592e-03
 3.41836503e-03 5.26356744e-03 2.20897654e-03 1.19885360e-03
 4.30899322e-01 1.23880652e-03 4.50847391e-03 2.53806636e-03
 2.56696204e-03 2.32062512e-03 2.30320124e-03 9.95884533e-04
 1.41258014e-03 1.50208520e-02 1.71201989e-01 1.21688237e-02
 3.68768419e-03 2.78462190e-03 1.73887890e-02 1.24210690e-03
 1.14141090e-03 1.23880326e-03 6.15324406e-03 3.28721548e-03
 2.56610289e-03 9.54061223e-04 1.09748626e-02 4.06201603e-03
 3.88505310e-02 1.46108540e-03 3.81767601e-02 8.39837128e-04
 7.28865154e-03 1.99628947e-03 4.22046799e-03 1.24210445e-03
 2.78460933e-03 7.02476176e-03 1.06470147e-02 1.09685007e-02
 1.19934389e-02 1.63283211e-03 2.16520913e-02 8.34627636e-03
 2.78462190e-03 4.30594273e-02 2.51566414e-02 1.47249978e-02
 1.05911738e-03 2.82388763e-03 2.66801915e-03 7.68877624e-04
 1.04813266e-03 8.43243767e-03 1.56924664e-03 1.14870665e-03
 4.51906770e-03 8.44222028e-03 9.22587293e-04 1.58653513e-03
 2.84760445e-03 4.06764593e-04 2.43368954e-03 4.67816321e-03
 8.16932530e-04 9.74025752e-04 5.45326446e-04 1.32731358e-02
 7.73315900e-04 8.16927699e-04 7.16523500e-04 6.68945396e-03
 7.55732239e-04 1.27780028e-02 1.02681725e-03 1.89385470e-02
 2.55833147e-03 5.20611694e-03 6.95974566e-03 8.24546849e-04
 1.68010197e-03 9.52475762e-04 1.30830531e-03 2.39520730e-03
 6.98162592e-04 1.50576909e-03 5.04572003e-04 2.55712029e-03
 6.45497639e-04 3.32308421e-03 8.52679950e-04 1.27330120e-03
 1.13656709e-03 2.55711819e-03 1.55935774e-03 4.34329547e-03
 5.45917661e-04 1.03461568e-03 1.58296630e-03 2.35697534e-03
 5.53949177e-03 7.51102762e-03 9.40452272e-04 1.25791226e-02
 6.93845621e-04 7.37247057e-04 4.21331497e-03 1.14686100e-03
 2.05254112e-03 2.90802643e-02 5.82952925e-04 2.51501636e-03
 1.97122409e-03 1.83093292e-03 6.98162476e-04 4.90084337e-03
 2.25279038e-03 6.80477591e-04 5.82054518e-02 7.43863115e-04
 7.04167527e-04 2.35698372e-03 2.32539698e-03 6.96430856e-04
 2.26605847e-03 1.99123332e-03 7.73315027e-04 6.35717413e-04
 2.05254415e-03 1.26798928e-03 2.26605963e-03 1.58296630e-03
 7.90624297e-04 2.99614761e-03 5.04228112e-04 7.27315200e-04
 8.55139398e-04 6.80472876e-04 8.59883789e-04 2.55220127e-03
 1.03161961e-03 4.01292648e-03 5.04566124e-04 2.71366281e-03
 7.44099030e-04 1.07856106e-03 5.29151992e-04 5.29139536e-04
 1.34820323e-02 1.61726610e-03 3.65085225e-03 2.10337737e-03
 3.27290851e-03 1.22755591e-03 4.74047527e-04 9.56667063e-04
 1.33478502e-02 1.76194485e-03 1.53250142e-03 8.42803973e-04
 1.85458362e-03 2.42670369e-03 4.21326514e-03 9.99696786e-04
 1.42026655e-02 6.35323522e-04 1.45247183e-03 7.87895406e-04
 8.79133062e-04 2.26605544e-03 1.55822106e-03 6.00871339e-04
 7.20416603e-04 1.68515369e-03 1.72080621e-02 1.24837616e-02
 4.58415860e-04 4.78171598e-04 6.47069653e-04 1.64254825e-03
 1.37805706e-03 2.07157433e-03 1.71459175e-03 6.64865074e-04
 4.54777037e-04 6.98164629e-04 4.53685112e-02 1.99578749e-03
 1.30089035e-03 4.74044238e-04 8.84375127e-04 1.37805170e-03
 2.26605893e-03 1.22576870e-03 8.79710598e-04 2.51829927e-03
 1.27996271e-03 1.61486876e-03 2.23402004e-03 1.27424137e-03
 3.06076632e-04 6.98166492e-04 6.98166201e-04 2.11397535e-03
 1.14343106e-03 8.84383509e-04 2.26605986e-03 1.33636547e-03
 6.33062387e-04 3.53548297e-04 2.01563211e-03 1.23830454e-03
 1.97799387e-03 1.00757554e-03 1.06265291e-03 1.47598749e-03
 2.01563281e-03 2.59433780e-03 1.03161903e-03 1.02601189e-03
 4.53685187e-02 1.23263372e-03 3.49643262e-04 1.45711051e-03
 1.82123156e-03 3.82485741e-04 6.51864510e-04 5.29148674e-04
 6.29425864e-04 3.36132082e-03 4.15942585e-03 2.84455670e-03
 7.85085431e-04 2.27261032e-03 5.62621164e-04 1.23014059e-02
 5.62618428e-04 1.13103329e-03 2.10131053e-02 9.55740805e-04
 7.75682856e-04 1.78955635e-03 3.04927235e-04 8.72034859e-03
 1.01525045e-03 1.34019377e-02 1.34820091e-02 9.84014827e-04
 5.90623356e-03 1.19418476e-03 7.36953400e-04 4.70982777e-04
 1.04159664e-03 8.41727189e-04 4.63476311e-03 1.93203986e-03
 1.61726470e-03 6.77277334e-03 2.57079839e-03 1.05848000e-03
 3.69502530e-02 1.97800226e-03 5.76528395e-03 4.34935500e-04
 1.08855963e-03 5.29128301e-04 9.99702723e-04 1.90669275e-03
 6.60379708e-04 5.06104960e-04 2.33208164e-04 1.01727422e-03
 4.77028836e-04 4.77029389e-04 4.77029389e-04 5.12111699e-04
 6.21057174e-04 5.06104028e-04 4.77029418e-04 1.74373714e-03
 4.77029971e-04 1.61709462e-03 2.50459393e-03 8.46221403e-04
 5.62361395e-03 1.81529520e-03 1.28651166e-03 9.58191755e-04
 8.96788086e-04 2.67195632e-03 8.25828814e-04 2.33210070e-04
 1.85640641e-02 1.31627242e-03 2.51663961e-02 1.26509240e-03
 4.62888303e-04 4.62891185e-04 1.09767849e-02 8.76672333e-04
 4.77027323e-04 3.04927380e-04 4.77029418e-04 5.12110651e-04
 1.60902366e-03 8.57359555e-04 5.60552813e-04 4.88073216e-04
 5.06111188e-04 1.48805464e-03 4.88076010e-04 6.46169297e-04
 1.07622088e-03 4.34656627e-04 2.33208106e-04 9.63205181e-04
 6.11936732e-04 4.92669933e-04 4.77027643e-04 1.17541419e-03
 1.36442448e-03 1.63542526e-03 1.68962812e-03 1.82122784e-03
 4.68480808e-04 4.77028661e-04 6.73377363e-04 3.01986956e-03
 1.26915774e-03 1.71432714e-03 6.59659831e-03 9.27317247e-04
 2.33208164e-04 5.09722391e-03 4.99030808e-04 2.12055002e-03
 4.58536000e-04 6.96598319e-04 8.11241276e-04 8.93769786e-04
 7.19000353e-04 1.39126519e-03 4.97577304e-04 1.34428323e-03
 7.00585253e-04 1.71551725e-03 2.47343420e-03 4.77029011e-04
 2.33208819e-04 1.63043919e-03 1.55038061e-03 8.61531531e-04
 1.77226786e-03 1.52715424e-03 1.35982195e-02 2.52438942e-03
 7.45878380e-04 4.77027643e-04 6.67682290e-03 6.16328791e-04
 4.60220879e-04 9.65311774e-04 4.88751510e-04 4.88751917e-04
 4.88740625e-04 4.37653158e-03 3.27787333e-04 1.55466059e-02
 1.58908544e-03 5.51703572e-03 1.17852830e-03 3.27786081e-04
 5.47777861e-04 4.60213341e-04 5.94888697e-04 1.98082044e-03
 4.60223469e-04 1.89773422e-02 4.88751743e-04 4.60221316e-04
 3.27787275e-04 4.88747668e-04 4.88743710e-04 2.58597359e-03
 1.67940673e-03 4.88741149e-04 6.20193721e-04 7.30117434e-04
 1.96853187e-03 1.61544571e-03 4.85276891e-04 1.31930842e-03
 1.30995514e-03 2.05954001e-03 1.59955723e-03 9.39363614e-04
 4.54509398e-03 1.91687921e-03 2.95257254e-04 1.45846372e-02
 5.54094091e-04 4.49173531e-04 2.26518884e-03 4.88746271e-04
 1.35105767e-03 6.05010835e-04 1.06618379e-03 1.14292616e-03
 5.92091354e-04 1.46958791e-03 4.69208788e-03 4.79684735e-04
 6.14871911e-04 1.74647535e-03 1.25761684e-02 1.23851886e-03
 8.03514093e-04 1.21145428e-03 1.00636703e-03 4.39452735e-04
 1.29930431e-03 4.99173941e-04 4.39457654e-04 1.50945392e-02
 1.31929584e-03 1.56989635e-03 1.12741441e-03 6.58579345e-04
 4.35876049e-04 1.43148156e-03 1.33294740e-03 1.45877339e-03
 1.33295334e-03 1.43147283e-03 4.60844225e-04 1.08377787e-03
 2.06366810e-03 8.25175783e-04 4.60847019e-04 4.35873721e-04
 1.25272386e-03 2.87286984e-03 1.32228783e-03 4.85255558e-04
 1.08377403e-03 4.35870548e-04 3.89712921e-04 1.48871785e-03
 9.32728290e-04 4.20383923e-02 7.32570130e-04 1.23851863e-03
 1.51633599e-03 6.42998260e-04 4.39457042e-04 2.18108832e-03
 3.61896213e-03 2.92525603e-03 7.74299901e-04 3.89713445e-04
 1.23916753e-03 3.85430176e-04 9.43649386e-04 1.37340208e-03
 5.86777111e-04 1.32606225e-02 2.70618242e-04 1.48872042e-03
 3.74560175e-03 3.85433319e-04 4.27163206e-03 9.29749280e-04
 3.89528461e-04 2.17349012e-03 2.27042576e-04 6.25992147e-03
 1.35054439e-03 4.39457042e-04 2.48261495e-03 1.28843321e-03
 1.28842145e-03 5.35212865e-04 1.26055058e-03 6.13715441e-04
 2.27042983e-04 2.15208129e-04 1.05067668e-03 9.74559865e-04
 1.51652715e-03 1.46959245e-03 2.27042008e-04 1.08777161e-03
 3.89530265e-04 5.86787006e-04 1.23633037e-03 1.96115486e-03
 1.51652400e-03 6.92867616e-04 6.13717304e-04 1.19380921e-03
 2.70618068e-04 1.48871716e-03 5.86777693e-04 5.92762255e-04
 9.20489489e-04 5.11752558e-04 2.70617107e-04 3.61867569e-04
 2.70618300e-04 1.20231486e-03 7.14584196e-04 2.15207168e-04
 1.35904190e-03 6.23352174e-03 2.69275531e-03 2.22655581e-04
 4.29556612e-03 2.22658040e-04 2.22657007e-04 2.22658186e-04
 2.22657167e-04 2.22657865e-04 2.22657312e-04 2.22657982e-04
 5.93032280e-04 1.19904208e-03 3.28846020e-03 2.22656745e-04
 2.22657836e-04 2.22655755e-04 2.22657953e-04 2.22656308e-04
 2.22658025e-04 2.22656803e-04 2.22656308e-04 2.22655464e-04
 2.26066055e-04 2.22656628e-04 2.22657880e-04 9.80878016e-04
 2.22657167e-04 2.77778902e-03 3.58770904e-03 2.70618650e-04
 3.58065614e-03 1.34915137e-03 3.80708766e-03 3.80708766e-03
 6.07051828e-04 3.58065614e-03 2.70618388e-04 2.27041077e-04
 2.27040087e-04 9.80713055e-04 2.27043303e-04 1.34194433e-03
 1.90155825e-03 2.22658418e-04 1.46959769e-03 2.70617311e-04
 1.28844369e-03 2.70618533e-04 2.70618388e-04 1.03068596e-03
 2.70618679e-04 2.27041834e-04 2.70618679e-04 2.70618388e-04
 1.78057945e-03 2.27041135e-04 2.70617864e-04 2.27042197e-04
 2.70618562e-04 2.70618213e-04 2.70618562e-04 3.62605439e-04
 1.31436740e-03 5.59149077e-04 2.22657181e-04 1.49083566e-02
 2.43405905e-03 2.70618650e-04 2.27042430e-04 5.78892999e-04
 2.22658186e-04 1.08856859e-03 7.15867383e-04 2.58167536e-04
 2.70618650e-04 2.70618650e-04 1.06204883e-03 3.87152482e-04
 1.16680155e-03 2.70618417e-04 5.93033503e-04 4.78217378e-04
 2.27041164e-04 1.15701265e-03 2.22657836e-04 1.76261261e-03
 6.93100796e-04 2.22655814e-04 2.22656265e-04 5.93033910e-04
 4.78213158e-04 2.70618068e-04 1.09396596e-02 1.01341377e-03
 6.48862100e-04 3.87150736e-04 5.57437714e-04 2.36248612e-04
 2.36249703e-04 3.34110600e-03 5.53710794e-04 2.22657807e-04
 1.13092910e-03 1.24422915e-03 3.87149834e-04 5.85446542e-04
 5.43065369e-04 4.95344575e-04 1.92863532e-04 1.92862499e-04
 1.92863139e-04 1.92861931e-04 1.92862266e-04 2.42032052e-04
 1.17822445e-03 1.92862499e-04 1.92861946e-04 2.22657269e-04
 5.03735209e-04 2.22656789e-04 2.36248685e-04 9.03579115e-04
 1.25174818e-03 1.84605620e-03 1.31352304e-03 1.88791147e-03
 2.26064774e-04 9.71819682e-04 2.26065225e-04 2.22655493e-04
 2.36249398e-04 3.37573088e-04 1.97361238e-04 1.97361092e-04
 1.92862499e-04 3.37573059e-04 5.94411336e-04 2.44091707e-03
 5.09456324e-04 2.22657123e-04 1.92863445e-04 4.90213220e-04
 1.97360525e-04 4.18866082e-04 3.52305709e-04 5.07980934e-04
 2.42034032e-04 1.93785154e-03 4.94949927e-04 2.80128815e-03
 7.06739840e-04 3.52313393e-04 1.16083852e-03 3.12479795e-04
 3.57072015e-04 5.33392653e-04 3.20521998e-04 4.16266819e-04
 2.58979824e-04 3.52316711e-04 3.52315808e-04 3.52311617e-04
 3.57897195e-04 4.90211532e-04 3.52314586e-04 3.57074256e-04
 3.52314586e-04 3.52316885e-04 3.52315576e-04 5.60430170e-04
 3.41370062e-04 1.45883253e-03 5.38573484e-04 4.64844488e-04
 1.31616252e-03 4.53280838e-04 1.73258409e-03 5.87070687e-03
 3.93100374e-04 3.89076798e-04 5.05142554e-04 1.73895042e-02
 1.74440034e-02 3.57074925e-04 1.17444003e-03 4.88506220e-02
 3.93537513e-04 1.93517757e-04 2.97237583e-03 8.74778139e-04
 4.53916698e-04 4.53916698e-04 4.53920075e-04 1.90238221e-04
 4.06544015e-04 1.96239795e-03 1.94349885e-02 4.54417896e-03
 1.12415594e-03 4.34608373e-04 8.37534550e-04 1.93519925e-04
 8.48597439e-04 8.87170841e-04 3.95695970e-04 1.49019575e-03
 3.93537746e-04 4.88505736e-02 1.93519227e-04 8.87174974e-04
 4.34611196e-04 2.00793962e-03 4.53912391e-04 1.90237581e-04
 3.95697571e-04 1.00631150e-03 1.80297978e-02 1.90238236e-04
 1.90238337e-04 1.90237493e-04 2.61617661e-03 3.44361141e-02
 1.38699021e-02 4.53916698e-04 1.58523675e-02 1.90238177e-04
 6.18907216e-04 1.07691041e-03 1.10087218e-02 1.02624134e-03
 1.90237595e-04 1.99358881e-04 7.49100000e-04 4.53227665e-04
 2.77785771e-02 1.02623273e-03 7.58323772e-03 1.35021599e-03
 1.74285518e-03 1.02624367e-03 6.82998740e-04 1.84976850e-02
 1.35133008e-03 2.43303017e-03 7.10094406e-04 4.11468820e-04
 4.11460031e-04 3.39526404e-03 4.91154939e-03 4.30803234e-03
 1.02624414e-03 1.35132892e-03 1.02624402e-03 2.65020819e-04
 3.77761695e-04 3.77764401e-04 3.24034394e-04 1.24770624e-03
 4.51793603e-04 3.77764663e-04 2.65020382e-04 1.33238733e-03
 3.77762248e-04 3.77763645e-04 2.04521493e-04 1.73759088e-03
 8.45824427e-04 1.14855508e-03 3.77762248e-04 1.26469810e-03
 1.33238733e-03 3.77762248e-04 3.77499906e-04 1.44896610e-03
 3.39994644e-04 3.39994382e-04 2.78601842e-03 1.03089854e-03
 3.77762248e-04 1.03089702e-03 1.18644978e-03 1.75056490e-03
 1.86572913e-02 3.77761782e-04 1.62771437e-02 1.07884745e-03
 1.07885746e-03 1.32447470e-03 2.06035373e-04 1.23668218e-03
 3.77498771e-04 1.92572246e-03 3.09381838e-04 1.91228576e-02
 1.59015553e-03 1.91228595e-02 7.93145131e-03 3.25331785e-04
 1.59015309e-03 1.87797443e-04 1.87797050e-04 1.02321161e-02
 1.87798229e-04 2.55954196e-03 2.06035009e-04 1.86197069e-02
 8.53241712e-04 3.25335743e-04 8.53241130e-04 1.90516491e-03
 1.42383703e-03 3.17021366e-03 1.87796948e-04 1.16029568e-03
 2.83556222e-03 1.87797879e-04 1.37713284e-03 2.70334650e-02
 2.43589771e-03 3.25335102e-04 1.87797647e-04 1.95360184e-02
 6.55981712e-04 1.37209066e-03 1.87796380e-04 4.60701442e-04
 1.18122553e-03 4.60702082e-04 1.37209822e-03 4.60704061e-04
 7.61560455e-04 1.04293181e-03 1.61788252e-03 1.87797195e-04
 6.55977463e-04 6.55982119e-04 1.87797166e-04 1.75816193e-02
 1.37209112e-03 4.60702577e-04 6.55979617e-04 1.87797268e-04
 6.55979500e-04 2.36879149e-03 6.55987009e-04 1.87797516e-04
 1.20150784e-04 1.37208542e-03 3.56735400e-04 5.25500486e-03
 1.20152101e-04 6.55980781e-04 1.87796570e-04 2.13664328e-03
 8.18301400e-04 1.00082008e-03 1.00082729e-03 1.62838187e-04
 1.88227892e-02 1.32926949e-03 1.26254559e-03 4.93044220e-02
 1.00082147e-03 4.31357854e-04 1.00082613e-03 1.26013055e-03
 1.26255478e-03 1.00082264e-03 1.53375280e-04 3.56731762e-04
 1.48046424e-03 2.93299381e-04 4.49203828e-04 1.49799569e-04
 1.56178453e-03 4.06337000e-04 1.98184134e-04 1.98186084e-04
 1.59531110e-03 2.30815378e-03 1.98184440e-04 1.98185779e-04
 2.91195931e-03 1.14409009e-03 1.98185822e-04 1.98185822e-04
 1.98184513e-04 1.98185167e-04 2.30814912e-03 2.30816170e-03
 2.30815564e-03 2.30815238e-03 2.45548552e-03 1.02465344e-03
 2.30815983e-03 2.30816333e-03 2.30813143e-03 1.98184032e-04
 8.81869346e-02 2.30814191e-03 6.03311812e-04 2.30814191e-03
 6.44240878e-04 2.67415249e-04 6.84457598e-03 1.98184280e-04
 3.04878014e-03 2.67415802e-04 1.69474783e-03 1.96494069e-03
 1.96494116e-03 7.16600043e-04 1.96493790e-03 1.96493813e-03
 7.78803660e-04 4.03273245e-03 3.56088136e-03 3.86812520e-04
 3.86810512e-04 3.86807456e-04 3.86811589e-04 3.86809843e-04
 3.86813190e-04 1.54008307e-02 3.56084923e-03 7.16632465e-04
 3.65768024e-03 3.86808737e-04 2.18954543e-03 3.86810338e-04
 3.56087531e-03 7.77425827e-04 1.93909032e-03 2.43154131e-02
 3.56084644e-03 3.56085342e-03 1.82418979e-03 3.86811327e-04
 3.56083806e-03]
2025-06-03 10:18:10,940 - DEBUG - Edge reconstruction errors: [0.15533124 1.6572895  1.6583799  ... 0.15493578 1.2526348  0.15500166]
2025-06-03 10:18:10,943 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101810_update_38.json
2025-06-03 10:18:10,943 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:18:10,961 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101810_update_38.pth and as latest_checkpoint.pth
2025-06-03 10:18:10,961 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.3431
2025-06-03 10:18:10,961 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-03 10:18:10,961 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.4309, MLP Score: 0.4975
2025-06-03 10:18:10,961 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1712, MLP Score: 0.4975
2025-06-03 10:18:10,961 - WARNING -   Node ID: 185.125.190.58, Recon Error: 0.0582, MLP Score: 0.5079
2025-06-03 10:18:10,961 - WARNING -   Node ID: 142.250.198.187, Recon Error: 0.0454, MLP Score: 0.5045
2025-06-03 10:18:10,961 - WARNING -   Node ID: 151.101.1.229, Recon Error: 0.0454, MLP Score: 0.5045
2025-06-03 10:18:10,961 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:18:10,962 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8210, MLP Score: 0.4973
2025-06-03 10:18:10,962 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.4646, MLP Score: 0.4978
2025-06-03 10:18:10,962 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9661, MLP Score: 0.4964
2025-06-03 10:18:10,962 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.4839, MLP Score: 0.4964
2025-06-03 10:18:10,962 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.4694, MLP Score: 0.4969
2025-06-03 10:18:10,962 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-03 10:18:10,962 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-03 10:18:10,962 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-03 10:18:10,998 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-03 10:18:11,033 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-03 10:18:11,033 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-03 10:18:11,033 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-03 10:18:11,063 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-03 10:18:11,098 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-03 10:18:11,098 - INFO - Processing node updates/additions.
2025-06-03 10:18:11,105 - INFO - Processing edge updates/additions.
2025-06-03 10:18:11,122 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:18:11,124 - INFO - Finished updating NetworkX graph.
2025-06-03 10:18:11,124 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:18:11,126 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:18:11,140 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-03 10:18:11,144 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:18:11,145 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-03 10:18:11,148 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-03 10:18:11,150 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:18:11,159 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:18:11,161 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:18:11,163 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:18:11,166 - DEBUG - Shape of encoded categorical edge features: torch.Size([2170, 3])
2025-06-03 10:18:11,167 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:18:11,168 - DEBUG - Shape of scaled numerical edge features: torch.Size([2170, 7])
2025-06-03 10:18:11,168 - DEBUG - Final edge attributes tensor shape: torch.Size([2170, 10])
2025-06-03 10:18:11,168 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:18:11,173 - INFO - Performing online update...
2025-06-03 10:18:11,174 - INFO - Starting online update for 50 steps.
2025-06-03 10:18:11,175 - DEBUG - Updated RunningStats: new_mean=0.9506152449983636, new_var=22200000000161.59, new_n=2250
2025-06-03 10:18:11,175 - DEBUG - Updated RunningStats: new_mean=0.9478086145240107, new_var=22500000000018.26, new_n=2280
2025-06-03 10:18:11,176 - DEBUG - Updated RunningStats: new_mean=1.2057226053336008, new_var=7400000000093.596, new_n=750
2025-06-03 10:18:11,176 - DEBUG - Updated RunningStats: new_mean=1.204008861146744, new_var=7500000000001.661, new_n=760
2025-06-03 10:18:11,176 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:18:11,176 - DEBUG - Online update step: 1/50
2025-06-03 10:18:11,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:12,116 - DEBUG - Node anomaly scores shape: torch.Size([22896, 1])
2025-06-03 10:18:12,142 - DEBUG - Edge anomaly scores shape: torch.Size([48310, 1])
2025-06-03 10:18:12,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:12,979 - DEBUG - Step 1: Loss=0.5743
2025-06-03 10:18:12,979 - DEBUG - Online update step: 2/50
2025-06-03 10:18:12,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:13,626 - DEBUG - Node anomaly scores shape: torch.Size([22238, 1])
2025-06-03 10:18:13,639 - DEBUG - Edge anomaly scores shape: torch.Size([46664, 1])
2025-06-03 10:18:13,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:14,291 - DEBUG - Step 2: Loss=0.5735
2025-06-03 10:18:14,291 - DEBUG - Online update step: 3/50
2025-06-03 10:18:14,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:14,997 - DEBUG - Node anomaly scores shape: torch.Size([22848, 1])
2025-06-03 10:18:15,009 - DEBUG - Edge anomaly scores shape: torch.Size([48161, 1])
2025-06-03 10:18:15,010 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:15,822 - DEBUG - Step 3: Loss=0.5729
2025-06-03 10:18:15,822 - DEBUG - Online update step: 4/50
2025-06-03 10:18:15,827 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:16,618 - DEBUG - Node anomaly scores shape: torch.Size([23795, 1])
2025-06-03 10:18:16,632 - DEBUG - Edge anomaly scores shape: torch.Size([50346, 1])
2025-06-03 10:18:16,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:17,487 - DEBUG - Step 4: Loss=0.5741
2025-06-03 10:18:17,487 - DEBUG - Online update step: 5/50
2025-06-03 10:18:17,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:18,122 - DEBUG - Node anomaly scores shape: torch.Size([22047, 1])
2025-06-03 10:18:18,134 - DEBUG - Edge anomaly scores shape: torch.Size([46296, 1])
2025-06-03 10:18:18,135 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:18,801 - DEBUG - Step 5: Loss=0.5738
2025-06-03 10:18:18,801 - DEBUG - Online update step: 6/50
2025-06-03 10:18:18,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:19,440 - DEBUG - Node anomaly scores shape: torch.Size([22546, 1])
2025-06-03 10:18:19,452 - DEBUG - Edge anomaly scores shape: torch.Size([47405, 1])
2025-06-03 10:18:19,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:20,136 - DEBUG - Step 6: Loss=0.5749
2025-06-03 10:18:20,137 - DEBUG - Online update step: 7/50
2025-06-03 10:18:20,140 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:20,755 - DEBUG - Node anomaly scores shape: torch.Size([22840, 1])
2025-06-03 10:18:20,767 - DEBUG - Edge anomaly scores shape: torch.Size([48136, 1])
2025-06-03 10:18:20,768 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:21,485 - DEBUG - Step 7: Loss=0.5749
2025-06-03 10:18:21,485 - DEBUG - Online update step: 8/50
2025-06-03 10:18:21,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:22,182 - DEBUG - Node anomaly scores shape: torch.Size([22153, 1])
2025-06-03 10:18:22,204 - DEBUG - Edge anomaly scores shape: torch.Size([46486, 1])
2025-06-03 10:18:22,207 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:23,459 - DEBUG - Step 8: Loss=0.5731
2025-06-03 10:18:23,459 - DEBUG - Online update step: 9/50
2025-06-03 10:18:23,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:24,275 - DEBUG - Node anomaly scores shape: torch.Size([22926, 1])
2025-06-03 10:18:24,288 - DEBUG - Edge anomaly scores shape: torch.Size([48287, 1])
2025-06-03 10:18:24,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:25,055 - DEBUG - Step 9: Loss=0.5735
2025-06-03 10:18:25,055 - DEBUG - Online update step: 10/50
2025-06-03 10:18:25,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:25,688 - DEBUG - Node anomaly scores shape: torch.Size([21760, 1])
2025-06-03 10:18:25,699 - DEBUG - Edge anomaly scores shape: torch.Size([45614, 1])
2025-06-03 10:18:25,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:26,324 - DEBUG - Step 10: Loss=0.5730
2025-06-03 10:18:26,325 - DEBUG - Online update step: 11/50
2025-06-03 10:18:26,329 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:26,993 - DEBUG - Node anomaly scores shape: torch.Size([22997, 1])
2025-06-03 10:18:27,007 - DEBUG - Edge anomaly scores shape: torch.Size([48483, 1])
2025-06-03 10:18:27,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:27,815 - DEBUG - Step 11: Loss=0.5733
2025-06-03 10:18:27,815 - DEBUG - Online update step: 12/50
2025-06-03 10:18:27,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:28,478 - DEBUG - Node anomaly scores shape: torch.Size([22669, 1])
2025-06-03 10:18:28,490 - DEBUG - Edge anomaly scores shape: torch.Size([47791, 1])
2025-06-03 10:18:28,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:29,275 - DEBUG - Step 12: Loss=0.5732
2025-06-03 10:18:29,276 - DEBUG - Online update step: 13/50
2025-06-03 10:18:29,279 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:29,895 - DEBUG - Node anomaly scores shape: torch.Size([22488, 1])
2025-06-03 10:18:29,907 - DEBUG - Edge anomaly scores shape: torch.Size([47390, 1])
2025-06-03 10:18:29,908 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:30,601 - DEBUG - Step 13: Loss=0.5722
2025-06-03 10:18:30,602 - DEBUG - Online update step: 14/50
2025-06-03 10:18:30,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:31,178 - DEBUG - Node anomaly scores shape: torch.Size([21706, 1])
2025-06-03 10:18:31,189 - DEBUG - Edge anomaly scores shape: torch.Size([45502, 1])
2025-06-03 10:18:31,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:32,037 - DEBUG - Step 14: Loss=0.5734
2025-06-03 10:18:32,037 - DEBUG - Online update step: 15/50
2025-06-03 10:18:32,040 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:32,691 - DEBUG - Node anomaly scores shape: torch.Size([21548, 1])
2025-06-03 10:18:32,708 - DEBUG - Edge anomaly scores shape: torch.Size([45073, 1])
2025-06-03 10:18:32,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:33,390 - DEBUG - Step 15: Loss=0.5730
2025-06-03 10:18:33,391 - DEBUG - Online update step: 16/50
2025-06-03 10:18:33,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:34,038 - DEBUG - Node anomaly scores shape: torch.Size([22526, 1])
2025-06-03 10:18:34,049 - DEBUG - Edge anomaly scores shape: torch.Size([47396, 1])
2025-06-03 10:18:34,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:34,752 - DEBUG - Step 16: Loss=0.5722
2025-06-03 10:18:34,753 - DEBUG - Online update step: 17/50
2025-06-03 10:18:34,756 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:35,443 - DEBUG - Node anomaly scores shape: torch.Size([22227, 1])
2025-06-03 10:18:35,469 - DEBUG - Edge anomaly scores shape: torch.Size([46784, 1])
2025-06-03 10:18:35,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:36,609 - DEBUG - Step 17: Loss=0.5736
2025-06-03 10:18:36,609 - DEBUG - Online update step: 18/50
2025-06-03 10:18:36,612 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:37,377 - DEBUG - Node anomaly scores shape: torch.Size([22640, 1])
2025-06-03 10:18:37,390 - DEBUG - Edge anomaly scores shape: torch.Size([47602, 1])
2025-06-03 10:18:37,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:38,380 - DEBUG - Step 18: Loss=0.5743
2025-06-03 10:18:38,380 - DEBUG - Online update step: 19/50
2025-06-03 10:18:38,383 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:39,131 - DEBUG - Node anomaly scores shape: torch.Size([22041, 1])
2025-06-03 10:18:39,144 - DEBUG - Edge anomaly scores shape: torch.Size([46288, 1])
2025-06-03 10:18:39,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:39,840 - DEBUG - Step 19: Loss=0.5750
2025-06-03 10:18:39,841 - DEBUG - Online update step: 20/50
2025-06-03 10:18:39,844 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:40,456 - DEBUG - Node anomaly scores shape: torch.Size([22270, 1])
2025-06-03 10:18:40,469 - DEBUG - Edge anomaly scores shape: torch.Size([46837, 1])
2025-06-03 10:18:40,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:41,172 - DEBUG - Step 20: Loss=0.5778
2025-06-03 10:18:41,173 - DEBUG - Online update step: 21/50
2025-06-03 10:18:41,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:41,781 - DEBUG - Node anomaly scores shape: torch.Size([22547, 1])
2025-06-03 10:18:41,793 - DEBUG - Edge anomaly scores shape: torch.Size([47467, 1])
2025-06-03 10:18:41,794 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:42,507 - DEBUG - Step 21: Loss=0.5732
2025-06-03 10:18:42,508 - DEBUG - Online update step: 22/50
2025-06-03 10:18:42,511 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:43,143 - DEBUG - Node anomaly scores shape: torch.Size([21916, 1])
2025-06-03 10:18:43,154 - DEBUG - Edge anomaly scores shape: torch.Size([46070, 1])
2025-06-03 10:18:43,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:43,827 - DEBUG - Step 22: Loss=0.5726
2025-06-03 10:18:43,827 - DEBUG - Online update step: 23/50
2025-06-03 10:18:43,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:44,515 - DEBUG - Node anomaly scores shape: torch.Size([23212, 1])
2025-06-03 10:18:44,528 - DEBUG - Edge anomaly scores shape: torch.Size([49029, 1])
2025-06-03 10:18:44,529 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:45,206 - DEBUG - Step 23: Loss=0.5739
2025-06-03 10:18:45,207 - DEBUG - Online update step: 24/50
2025-06-03 10:18:45,212 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:45,868 - DEBUG - Node anomaly scores shape: torch.Size([23057, 1])
2025-06-03 10:18:45,881 - DEBUG - Edge anomaly scores shape: torch.Size([48672, 1])
2025-06-03 10:18:45,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:46,635 - DEBUG - Step 24: Loss=0.5750
2025-06-03 10:18:46,635 - DEBUG - Online update step: 25/50
2025-06-03 10:18:46,640 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:47,287 - DEBUG - Node anomaly scores shape: torch.Size([22140, 1])
2025-06-03 10:18:47,299 - DEBUG - Edge anomaly scores shape: torch.Size([46517, 1])
2025-06-03 10:18:47,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:48,121 - DEBUG - Step 25: Loss=0.5754
2025-06-03 10:18:48,122 - DEBUG - Online update step: 26/50
2025-06-03 10:18:48,125 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:49,137 - DEBUG - Node anomaly scores shape: torch.Size([22445, 1])
2025-06-03 10:18:49,153 - DEBUG - Edge anomaly scores shape: torch.Size([47144, 1])
2025-06-03 10:18:49,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:50,286 - DEBUG - Step 26: Loss=0.5729
2025-06-03 10:18:50,287 - DEBUG - Online update step: 27/50
2025-06-03 10:18:50,290 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:51,016 - DEBUG - Node anomaly scores shape: torch.Size([22058, 1])
2025-06-03 10:18:51,033 - DEBUG - Edge anomaly scores shape: torch.Size([46231, 1])
2025-06-03 10:18:51,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:51,805 - DEBUG - Step 27: Loss=0.5735
2025-06-03 10:18:51,805 - DEBUG - Online update step: 28/50
2025-06-03 10:18:51,808 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:52,459 - DEBUG - Node anomaly scores shape: torch.Size([23901, 1])
2025-06-03 10:18:52,473 - DEBUG - Edge anomaly scores shape: torch.Size([50574, 1])
2025-06-03 10:18:52,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:53,358 - DEBUG - Step 28: Loss=0.5730
2025-06-03 10:18:53,358 - DEBUG - Online update step: 29/50
2025-06-03 10:18:53,361 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:54,165 - DEBUG - Node anomaly scores shape: torch.Size([22905, 1])
2025-06-03 10:18:54,186 - DEBUG - Edge anomaly scores shape: torch.Size([48356, 1])
2025-06-03 10:18:54,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:55,326 - DEBUG - Step 29: Loss=0.5758
2025-06-03 10:18:55,327 - DEBUG - Online update step: 30/50
2025-06-03 10:18:55,336 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:56,261 - DEBUG - Node anomaly scores shape: torch.Size([22914, 1])
2025-06-03 10:18:56,280 - DEBUG - Edge anomaly scores shape: torch.Size([48270, 1])
2025-06-03 10:18:56,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:57,306 - DEBUG - Step 30: Loss=0.5743
2025-06-03 10:18:57,307 - DEBUG - Online update step: 31/50
2025-06-03 10:18:57,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:58,042 - DEBUG - Node anomaly scores shape: torch.Size([23589, 1])
2025-06-03 10:18:58,055 - DEBUG - Edge anomaly scores shape: torch.Size([49781, 1])
2025-06-03 10:18:58,056 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:18:58,975 - DEBUG - Step 31: Loss=0.5733
2025-06-03 10:18:58,975 - DEBUG - Online update step: 32/50
2025-06-03 10:18:58,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:18:59,665 - DEBUG - Node anomaly scores shape: torch.Size([23417, 1])
2025-06-03 10:18:59,678 - DEBUG - Edge anomaly scores shape: torch.Size([49503, 1])
2025-06-03 10:18:59,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:00,513 - DEBUG - Step 32: Loss=0.5735
2025-06-03 10:19:00,514 - DEBUG - Online update step: 33/50
2025-06-03 10:19:00,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:01,187 - DEBUG - Node anomaly scores shape: torch.Size([22515, 1])
2025-06-03 10:19:01,201 - DEBUG - Edge anomaly scores shape: torch.Size([47411, 1])
2025-06-03 10:19:01,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:01,895 - DEBUG - Step 33: Loss=0.5732
2025-06-03 10:19:01,896 - DEBUG - Online update step: 34/50
2025-06-03 10:19:01,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:02,501 - DEBUG - Node anomaly scores shape: torch.Size([21906, 1])
2025-06-03 10:19:02,513 - DEBUG - Edge anomaly scores shape: torch.Size([45909, 1])
2025-06-03 10:19:02,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:03,230 - DEBUG - Step 34: Loss=0.5729
2025-06-03 10:19:03,231 - DEBUG - Online update step: 35/50
2025-06-03 10:19:03,234 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:03,917 - DEBUG - Node anomaly scores shape: torch.Size([23343, 1])
2025-06-03 10:19:03,931 - DEBUG - Edge anomaly scores shape: torch.Size([49221, 1])
2025-06-03 10:19:03,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:04,700 - DEBUG - Step 35: Loss=0.5729
2025-06-03 10:19:04,701 - DEBUG - Online update step: 36/50
2025-06-03 10:19:04,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:05,320 - DEBUG - Node anomaly scores shape: torch.Size([23132, 1])
2025-06-03 10:19:05,331 - DEBUG - Edge anomaly scores shape: torch.Size([48831, 1])
2025-06-03 10:19:05,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:05,988 - DEBUG - Step 36: Loss=0.5725
2025-06-03 10:19:05,988 - DEBUG - Online update step: 37/50
2025-06-03 10:19:05,990 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:06,465 - DEBUG - Node anomaly scores shape: torch.Size([21460, 1])
2025-06-03 10:19:06,477 - DEBUG - Edge anomaly scores shape: torch.Size([44910, 1])
2025-06-03 10:19:06,479 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:07,050 - DEBUG - Step 37: Loss=0.5735
2025-06-03 10:19:07,050 - DEBUG - Online update step: 38/50
2025-06-03 10:19:07,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:07,592 - DEBUG - Node anomaly scores shape: torch.Size([23151, 1])
2025-06-03 10:19:07,609 - DEBUG - Edge anomaly scores shape: torch.Size([48801, 1])
2025-06-03 10:19:07,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:08,194 - DEBUG - Step 38: Loss=0.5732
2025-06-03 10:19:08,195 - DEBUG - Online update step: 39/50
2025-06-03 10:19:08,197 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:08,703 - DEBUG - Node anomaly scores shape: torch.Size([22934, 1])
2025-06-03 10:19:08,714 - DEBUG - Edge anomaly scores shape: torch.Size([48369, 1])
2025-06-03 10:19:08,715 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:09,380 - DEBUG - Step 39: Loss=0.5726
2025-06-03 10:19:09,380 - DEBUG - Online update step: 40/50
2025-06-03 10:19:09,382 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:09,976 - DEBUG - Node anomaly scores shape: torch.Size([22961, 1])
2025-06-03 10:19:09,987 - DEBUG - Edge anomaly scores shape: torch.Size([48363, 1])
2025-06-03 10:19:09,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:10,586 - DEBUG - Step 40: Loss=0.5723
2025-06-03 10:19:10,586 - DEBUG - Online update step: 41/50
2025-06-03 10:19:10,588 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:11,121 - DEBUG - Node anomaly scores shape: torch.Size([21996, 1])
2025-06-03 10:19:11,136 - DEBUG - Edge anomaly scores shape: torch.Size([46116, 1])
2025-06-03 10:19:11,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:11,731 - DEBUG - Step 41: Loss=0.5726
2025-06-03 10:19:11,731 - DEBUG - Online update step: 42/50
2025-06-03 10:19:11,735 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:12,337 - DEBUG - Node anomaly scores shape: torch.Size([22121, 1])
2025-06-03 10:19:12,349 - DEBUG - Edge anomaly scores shape: torch.Size([46447, 1])
2025-06-03 10:19:12,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:13,010 - DEBUG - Step 42: Loss=0.5724
2025-06-03 10:19:13,010 - DEBUG - Online update step: 43/50
2025-06-03 10:19:13,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:13,614 - DEBUG - Node anomaly scores shape: torch.Size([22712, 1])
2025-06-03 10:19:13,626 - DEBUG - Edge anomaly scores shape: torch.Size([47756, 1])
2025-06-03 10:19:13,627 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:14,233 - DEBUG - Step 43: Loss=0.5729
2025-06-03 10:19:14,233 - DEBUG - Online update step: 44/50
2025-06-03 10:19:14,235 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:14,758 - DEBUG - Node anomaly scores shape: torch.Size([22085, 1])
2025-06-03 10:19:14,768 - DEBUG - Edge anomaly scores shape: torch.Size([46337, 1])
2025-06-03 10:19:14,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:15,372 - DEBUG - Step 44: Loss=0.5720
2025-06-03 10:19:15,372 - DEBUG - Online update step: 45/50
2025-06-03 10:19:15,375 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:15,921 - DEBUG - Node anomaly scores shape: torch.Size([22644, 1])
2025-06-03 10:19:15,932 - DEBUG - Edge anomaly scores shape: torch.Size([47632, 1])
2025-06-03 10:19:15,933 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:16,630 - DEBUG - Step 45: Loss=0.5722
2025-06-03 10:19:16,631 - DEBUG - Online update step: 46/50
2025-06-03 10:19:16,633 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:17,219 - DEBUG - Node anomaly scores shape: torch.Size([21711, 1])
2025-06-03 10:19:17,230 - DEBUG - Edge anomaly scores shape: torch.Size([45543, 1])
2025-06-03 10:19:17,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:17,844 - DEBUG - Step 46: Loss=0.5720
2025-06-03 10:19:17,844 - DEBUG - Online update step: 47/50
2025-06-03 10:19:17,848 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:18,381 - DEBUG - Node anomaly scores shape: torch.Size([21968, 1])
2025-06-03 10:19:18,393 - DEBUG - Edge anomaly scores shape: torch.Size([46128, 1])
2025-06-03 10:19:18,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:19,038 - DEBUG - Step 47: Loss=0.5722
2025-06-03 10:19:19,038 - DEBUG - Online update step: 48/50
2025-06-03 10:19:19,041 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:19,626 - DEBUG - Node anomaly scores shape: torch.Size([22203, 1])
2025-06-03 10:19:19,638 - DEBUG - Edge anomaly scores shape: torch.Size([46602, 1])
2025-06-03 10:19:19,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:20,331 - DEBUG - Step 48: Loss=0.5722
2025-06-03 10:19:20,332 - DEBUG - Online update step: 49/50
2025-06-03 10:19:20,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:20,930 - DEBUG - Node anomaly scores shape: torch.Size([21981, 1])
2025-06-03 10:19:20,942 - DEBUG - Edge anomaly scores shape: torch.Size([46182, 1])
2025-06-03 10:19:20,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:21,606 - DEBUG - Step 49: Loss=0.5724
2025-06-03 10:19:21,606 - DEBUG - Online update step: 50/50
2025-06-03 10:19:21,609 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:22,240 - DEBUG - Node anomaly scores shape: torch.Size([21971, 1])
2025-06-03 10:19:22,252 - DEBUG - Edge anomaly scores shape: torch.Size([46121, 1])
2025-06-03 10:19:22,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:22,926 - DEBUG - Step 50: Loss=0.5728
2025-06-03 10:19:22,926 - INFO - Online update finished. Average loss: 0.5734, Learning rate: 0.001000
2025-06-03 10:19:22,927 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -3.6938090e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.8063354e-08
 -4.2454818e-08  2.3026342e-08  4.7971547e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -2.6864065e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00 -4.9170832e-09  1.7269755e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2694676e-08  1.5590752e-08], current edge mean: [ 9.1488476e+00  1.4179723e+00  5.7064514e+00  2.1974063e-09
  2.6368876e-09 -3.5158501e-09  0.0000000e+00 -4.3948126e-10
 -5.7132561e-09  1.3184438e-09]
2025-06-03 10:19:22,928 - DEBUG - Node drift difference: 0.0170, Edge drift difference: 0.0015
2025-06-03 10:19:22,929 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -3.6938090e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.8063354e-08
 -4.2454818e-08  2.3026342e-08  4.7971547e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -2.6864065e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00 -4.9170832e-09  1.7269755e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2694676e-08  1.5590752e-08], edge=[ 9.1488476e+00  1.4179723e+00  5.7064514e+00  2.1974063e-09
  2.6368876e-09 -3.5158501e-09  0.0000000e+00 -4.3948126e-10
 -5.7132561e-09  1.3184438e-09]
2025-06-03 10:19:22,930 - DEBUG - Updated reference std: node=[0.         0.         1.0005034  1.0005034  0.         0.
 0.         1.0005034  1.0005034  1.0005034  1.0005034  1.0005034
 0.9407508  0.27399415 0.3602073  0.5745763  1.0005034  3.003227
 2.8989465  1.479363   0.3602073  0.22202651 1.0005034  1.0005034
 0.         0.         0.         0.         1.0005034  1.0005034 ], edge=[1.1101032 0.5053422 2.1377213 1.0002306 1.0002306 1.0002306 1.0002306
 1.0002306 1.0002304 1.0002306]
2025-06-03 10:19:22,930 - INFO - Online update complete. Loss: 0.5734
2025-06-03 10:19:22,931 - INFO - Running anomaly detection...
2025-06-03 10:19:22,931 - INFO - Starting anomaly detection.
2025-06-03 10:19:22,954 - DEBUG - Node reconstruction errors: [4.44393326e-03 2.93746730e-03 1.54434319e-03 1.93411612e-03
 7.63123215e-04 1.32247452e-02 5.78036392e-03 9.05163586e-04
 2.63254088e-03 1.60171706e-02 2.35424447e-03 4.35722899e-03
 1.86822738e-03 3.81527119e-03 2.62479391e-02 1.28776510e-03
 3.18478141e-03 1.10940812e-02 3.14147095e-03 1.10450927e-02
 1.10940831e-02 1.08551700e-02 3.91834276e-03 4.84351907e-03
 3.50650097e-03 8.07266869e-03 4.10347758e-03 8.88740120e-04
 1.10940821e-02 1.39640765e-02 3.91575648e-03 8.07266030e-03
 1.86451490e-03 7.50631327e-03 3.55885387e-03 1.59011781e-03
 4.09530342e-01 3.72498739e-03 5.96972276e-03 2.03736941e-03
 3.15661286e-03 3.38846119e-03 2.82417377e-03 3.81528214e-03
 1.43209437e-03 1.53885335e-02 1.82784587e-01 6.29162882e-03
 2.66814022e-03 3.19866324e-03 1.30232023e-02 3.91834276e-03
 3.66083835e-03 3.72499437e-03 8.07266869e-03 3.32924863e-03
 3.16177937e-03 4.51275706e-03 5.96780330e-03 4.31309035e-03
 3.94862667e-02 3.81724141e-03 3.65600251e-02 4.27651219e-03
 6.97350549e-03 1.82705245e-03 4.42324672e-03 3.91834276e-03
 3.19867721e-03 9.45873000e-03 7.11362343e-03 6.26917789e-03
 1.04810381e-02 1.22850947e-03 1.90600585e-02 8.29960220e-03
 3.19866324e-03 4.05333601e-02 1.91854611e-02 1.72565617e-02
 5.03195636e-03 5.21140080e-03 4.46473062e-03 5.21204341e-03
 5.46235917e-03 9.81916767e-03 1.83263549e-03 2.82712770e-03
 5.07937651e-03 7.97041692e-03 2.10022344e-03 8.63607856e-04
 7.92225474e-04 1.80660642e-03 3.22027365e-03 4.46969410e-03
 1.92699779e-03 7.32948480e-04 3.37767205e-03 1.69366617e-02
 8.29575351e-04 1.92699837e-03 2.68078502e-03 6.44396665e-03
 2.10261252e-03 1.48514370e-02 1.42832927e-03 2.15553995e-02
 6.87147374e-04 8.90144333e-03 1.01901116e-02 2.37452169e-03
 1.45661109e-03 1.50920183e-03 1.04474975e-03 2.83417897e-03
 6.49637834e-04 3.42997396e-03 7.36066722e-04 2.26600445e-03
 2.00720620e-03 8.76678561e-04 2.93663004e-03 1.17109786e-03
 5.56869782e-04 2.26601469e-03 1.43333769e-03 4.36068093e-03
 6.97522541e-04 1.05931005e-03 3.87358270e-03 3.25997220e-03
 8.02690722e-03 6.97188079e-03 7.71711871e-04 1.44618247e-02
 4.10169037e-03 3.34244431e-03 2.80716852e-03 1.76049466e-03
 3.51862190e-03 2.59197541e-02 2.01601745e-03 3.33911716e-03
 3.91756464e-03 1.95806823e-03 6.49642432e-04 4.23448626e-03
 4.68288548e-03 9.65708750e-04 3.36177498e-02 2.18354585e-03
 1.89956021e-03 3.25997267e-03 1.42522319e-03 1.60662830e-03
 3.42143234e-03 6.65054831e-04 8.29573779e-04 2.60213250e-03
 3.51864356e-03 2.80718831e-03 3.42142605e-03 3.87361529e-03
 7.06491934e-04 2.05271295e-03 1.37933413e-03 6.68901077e-04
 1.34836894e-03 9.65744490e-04 1.64345116e-03 2.19072448e-03
 1.94884324e-03 5.56080928e-03 7.36075221e-04 2.15118658e-03
 4.51142725e-04 1.30388467e-03 6.89520733e-04 6.89517416e-04
 1.60640646e-02 1.39895815e-03 2.52268836e-03 5.98156359e-03
 1.01211830e-03 6.26651687e-04 4.21481533e-03 6.48508547e-04
 1.57911666e-02 3.79789528e-03 1.77968980e-03 1.25732797e-03
 4.17738920e-03 3.52002052e-03 2.80714105e-03 2.49433401e-03
 1.06648225e-02 4.64242557e-03 1.42760493e-03 2.60855118e-03
 1.10315718e-03 3.42143793e-03 1.50090503e-03 7.30099156e-04
 1.49198307e-03 1.32054812e-03 2.20681634e-02 9.30299424e-03
 3.48874694e-03 1.26232789e-03 5.61444205e-04 1.49460242e-03
 2.63293576e-03 6.92062429e-04 3.38688202e-04 1.86808745e-03
 1.00186362e-03 6.49637717e-04 4.40538377e-02 4.43826150e-03
 2.88456329e-03 1.87322230e-03 1.96321355e-03 2.63293530e-03
 3.42143094e-03 1.44059653e-03 2.86165718e-03 3.63171496e-03
 1.68476824e-03 1.43524446e-03 1.01733522e-03 7.23868958e-04
 8.77093873e-04 6.49642607e-04 6.49637834e-04 4.17739199e-03
 4.66597208e-04 1.96320447e-03 3.42143164e-03 5.45925833e-03
 1.59727538e-03 9.36714874e-04 2.99861771e-03 4.58942406e-04
 3.07715428e-03 4.71339008e-04 3.41393927e-04 1.11979514e-03
 2.99862633e-03 1.93696306e-03 3.23813339e-03 1.92013930e-03
 4.40538377e-02 5.60927612e-04 9.39561578e-04 2.23381771e-03
 3.04195541e-03 3.44863161e-03 4.48972313e-03 6.89519162e-04
 8.85006215e-04 6.99621765e-03 3.06459144e-03 1.99863920e-03
 1.08057063e-03 2.94180564e-03 1.00447633e-03 9.69327521e-03
 1.00448297e-03 6.30239549e-04 1.94964129e-02 3.89351090e-03
 5.27289405e-04 2.67425901e-03 1.25288218e-03 4.69983043e-03
 1.03887299e-03 9.67164990e-03 1.60640739e-02 1.99505268e-03
 4.25495021e-03 1.12834165e-03 6.10970252e-04 3.49210785e-03
 1.07226265e-03 3.24289454e-03 3.42306378e-03 2.95601552e-03
 1.39895070e-03 4.72769421e-03 2.56724609e-03 2.36207969e-03
 3.62430438e-02 3.07713053e-03 7.98505824e-03 2.98807397e-03
 4.90175327e-04 6.89536391e-04 2.49431981e-03 4.38871561e-03
 6.93897135e-04 4.03283723e-03 1.21963164e-03 4.85923520e-04
 3.15498048e-03 3.15498956e-03 3.15498980e-03 1.67885027e-03
 3.77662573e-03 4.03286004e-03 3.15498980e-03 1.11842586e-03
 3.15498980e-03 3.51725984e-03 8.40266643e-04 1.17686042e-03
 5.30156773e-03 5.89990173e-04 2.35547335e-03 2.56459182e-03
 1.31789071e-03 1.58971373e-03 5.46574767e-04 1.21963548e-03
 1.88856740e-02 4.72502317e-03 2.46404894e-02 1.61119679e-03
 1.49297481e-03 1.49297353e-03 8.70356429e-03 2.24129367e-03
 3.15499702e-03 1.25288102e-03 3.15499003e-03 1.67884573e-03
 1.52245106e-03 1.93792093e-03 4.53346409e-03 3.35041224e-03
 4.03304026e-03 1.87857146e-03 3.35040945e-03 1.12883130e-03
 5.97808394e-04 7.94914260e-04 1.21962570e-03 3.36363004e-03
 1.23703189e-03 7.49624567e-04 3.15501797e-03 3.78801487e-04
 1.04254519e-03 1.37553492e-03 2.09196866e-03 3.04195937e-03
 4.42537898e-03 3.15499096e-03 3.29037034e-03 5.29105309e-03
 1.07924396e-03 4.24731616e-03 6.89067459e-03 5.97311067e-04
 1.21965783e-03 5.70978504e-03 3.74988862e-03 7.02525780e-04
 6.36999845e-04 5.50614728e-04 6.61018479e-04 4.93289670e-04
 7.83072494e-04 1.37160195e-03 7.65997043e-04 9.19338840e-04
 1.87046197e-03 4.30637272e-03 6.25444169e-04 3.15500190e-03
 1.21963047e-03 9.58093093e-04 2.66848435e-03 7.29591993e-04
 9.41678998e-04 3.33849661e-04 1.53626064e-02 5.86035103e-03
 2.27483246e-03 3.15500633e-03 4.83981567e-03 1.09093194e-03
 5.64144168e-04 1.14878605e-03 1.80381164e-03 1.80381665e-03
 1.80382538e-03 4.85413242e-03 2.95765791e-03 1.23434812e-02
 3.64898401e-03 3.62461014e-03 2.01447797e-03 2.95765675e-03
 5.39405912e-04 5.64148067e-04 7.07010680e-04 1.56593206e-03
 5.64147893e-04 1.99188199e-02 1.80383923e-03 5.64148242e-04
 2.95765442e-03 1.80382177e-03 1.80384249e-03 3.26302159e-03
 2.25066487e-03 1.80382701e-03 2.67493818e-03 1.70503883e-03
 1.72361359e-03 2.71473057e-03 3.67996836e-04 2.29131430e-03
 1.80625764e-03 2.40374776e-03 2.77080876e-03 5.27523982e-04
 7.00451480e-03 8.05840828e-04 9.91618610e-04 1.74803659e-02
 1.31637906e-03 1.23379182e-03 5.68771036e-04 1.80381560e-03
 2.35193642e-03 5.23917261e-04 1.99982128e-03 1.57302618e-03
 2.64451257e-03 3.63187050e-03 3.29086790e-03 1.79323182e-03
 3.54011497e-03 1.04483799e-03 7.65527785e-03 2.24368274e-03
 1.89701526e-03 1.91862474e-03 6.10604591e-04 1.53132144e-03
 2.01907265e-03 3.44742485e-03 1.53132097e-03 1.77764837e-02
 2.29130243e-03 2.79658800e-03 2.44595786e-03 1.31147658e-03
 6.04976318e-04 2.26279465e-03 2.46350141e-03 1.52249751e-03
 2.46351329e-03 2.26279721e-03 1.66238297e-03 4.89766768e-04
 1.08259509e-03 1.95508311e-03 1.66240276e-03 6.04981440e-04
 2.82964553e-04 3.15625314e-03 9.11573472e-04 3.68028705e-04
 4.89769736e-04 6.04973116e-04 1.44862046e-03 2.19258014e-03
 2.02432694e-03 4.21996266e-02 1.51432364e-03 2.24370719e-03
 1.55393942e-03 1.67774351e-03 1.53132097e-03 1.78044045e-03
 2.72602588e-03 3.28927883e-03 5.11002087e-04 1.44861301e-03
 8.58145475e-04 1.62660214e-03 1.37086352e-03 2.28027953e-03
 6.05766138e-04 1.02426670e-02 2.76327040e-03 2.19257548e-03
 5.01329033e-03 1.62660878e-03 3.09334975e-03 9.64735344e-04
 1.49479473e-03 6.45803229e-04 2.69955280e-03 8.23656283e-03
 2.51108338e-03 1.53132132e-03 5.58090047e-04 3.39971390e-03
 3.39971855e-03 1.76276674e-03 1.21262635e-03 1.48524879e-03
 2.69956794e-03 1.03046070e-03 3.15813208e-03 1.27209164e-03
 1.45547988e-03 3.63184651e-03 2.69956165e-03 1.84619019e-03
 1.49479473e-03 6.05768641e-04 3.10512539e-03 3.14808893e-03
 1.45550992e-03 7.64285331e-04 1.48525042e-03 6.56767108e-04
 2.76326225e-03 2.19256431e-03 6.05769746e-04 5.48666751e-04
 1.73313916e-03 6.35276607e-04 2.76326132e-03 1.12158083e-03
 2.76326132e-03 9.73362126e-04 2.08513113e-03 1.03044999e-03
 3.67934350e-03 3.35620111e-03 6.59601414e-04 2.64106342e-03
 8.80795531e-03 2.64105061e-03 2.64105108e-03 2.64106342e-03
 2.64105061e-03 2.64105061e-03 2.64107366e-03 2.64106900e-03
 1.59278885e-03 3.44404113e-03 2.51637539e-03 2.64105853e-03
 2.64106458e-03 2.64106179e-03 2.64105108e-03 2.64106924e-03
 2.64106528e-03 2.64105294e-03 2.64106807e-03 2.64106458e-03
 1.01524941e-03 2.64105992e-03 2.64106458e-03 1.32205733e-03
 2.64105666e-03 7.70606508e-04 1.92119903e-03 2.76325503e-03
 1.09872781e-03 6.41210761e-04 3.41847306e-03 3.41847306e-03
 7.95535627e-04 1.09872781e-03 2.76326388e-03 2.69955699e-03
 2.69956957e-03 1.85462087e-03 2.69955653e-03 3.82747478e-03
 2.18884763e-03 2.64110789e-03 3.63184814e-03 2.76327040e-03
 3.39972926e-03 2.76327040e-03 2.76326435e-03 1.41001446e-03
 2.76326388e-03 2.69956398e-03 2.76327040e-03 2.76326085e-03
 1.76687783e-03 2.69956398e-03 2.76326388e-03 2.69955257e-03
 2.76326179e-03 2.76327040e-03 2.76327063e-03 8.07511911e-04
 4.85493481e-04 3.33054049e-04 2.64106528e-03 1.85913220e-02
 8.74759862e-04 2.76325434e-03 2.69957259e-03 6.58764795e-04
 2.64106155e-03 9.02528234e-04 7.16287526e-04 2.81707454e-03
 2.76327040e-03 2.76327040e-03 2.57084233e-04 1.02279044e-03
 4.86504228e-04 2.76327552e-03 1.59279234e-03 3.11823632e-03
 2.69955094e-03 2.28854571e-03 2.64106528e-03 1.74895127e-03
 6.72538823e-04 2.64106900e-03 2.64106598e-03 1.59279362e-03
 3.11823981e-03 2.76326411e-03 1.53041463e-02 6.32258016e-04
 6.03712921e-04 1.02279638e-03 1.70840404e-03 1.24972744e-03
 1.24972733e-03 1.83501665e-03 1.56161538e-03 2.64105061e-03
 3.08773783e-03 1.08014641e-03 1.02278974e-03 2.79945933e-04
 1.51358650e-03 1.85807073e-03 2.58452236e-03 2.58452282e-03
 2.58451584e-03 2.58452236e-03 2.58453027e-03 1.02371932e-03
 9.75966337e-04 2.58452445e-03 2.58456520e-03 2.64106924e-03
 3.02669872e-03 2.64105410e-03 1.24972698e-03 6.72546623e-04
 7.60091643e-04 2.75609037e-03 1.74676045e-03 1.11932307e-03
 1.01524917e-03 9.68860113e-04 1.01525255e-03 2.64105340e-03
 1.24972791e-03 1.43343455e-03 2.59658997e-03 2.59658275e-03
 2.58452236e-03 1.43344258e-03 4.69778985e-04 2.63242470e-03
 2.78761284e-03 2.64106807e-03 2.58452236e-03 1.98163488e-03
 2.59657274e-03 3.25420382e-03 1.41655956e-03 2.21646228e-03
 1.02371408e-03 2.74473033e-03 1.69290311e-03 1.93263695e-03
 3.14251112e-04 1.41656748e-03 2.09624390e-03 1.44399912e-03
 1.40707544e-03 1.67551124e-03 1.27843907e-03 3.11741652e-03
 1.18927972e-03 1.41655956e-03 1.41655945e-03 1.41655956e-03
 1.34584762e-03 1.98163372e-03 1.41655956e-03 1.40709092e-03
 1.41655956e-03 1.41655956e-03 1.41656899e-03 2.81071087e-04
 1.44381693e-03 1.00156700e-03 6.69636764e-04 9.68130538e-04
 8.81805143e-04 1.99124380e-03 1.42274261e-03 6.41325628e-03
 1.44513545e-03 1.50685234e-03 1.74819224e-03 2.90898848e-02
 2.10912712e-02 1.40708545e-03 1.67579809e-03 4.52920869e-02
 1.44404476e-03 2.50313827e-03 7.90841004e-04 9.30195034e-04
 1.42346695e-03 1.42346777e-03 1.42346881e-03 2.34244089e-03
 1.20245048e-03 1.06491835e-03 2.33143736e-02 7.48301484e-03
 2.04274687e-03 1.51835778e-03 2.99690501e-03 2.50312523e-03
 1.99236651e-03 3.58848076e-04 1.30527420e-03 2.45064381e-03
 1.44405698e-03 4.52917181e-02 2.50311941e-03 3.58846824e-04
 1.99567270e-03 2.27111974e-03 1.42346171e-03 2.34244275e-03
 1.30528258e-03 3.19041847e-03 2.16079634e-02 2.34244834e-03
 2.34244904e-03 2.34244717e-03 1.06146443e-03 1.93093512e-02
 1.42086698e-02 1.42347044e-03 6.55350089e-03 2.34244089e-03
 1.10727898e-03 3.36528313e-03 7.98065402e-03 3.29044135e-03
 2.34244158e-03 2.18250975e-03 2.77646165e-03 1.38007780e-03
 2.16629561e-02 3.29054613e-03 6.31223805e-03 2.93641258e-03
 4.47122555e-04 3.29045323e-03 1.11112767e-03 2.20203232e-02
 3.18545406e-03 1.22346322e-03 1.13096170e-03 1.36935851e-03
 1.36937096e-03 2.81754113e-03 3.49626550e-03 5.44494530e-03
 3.29045416e-03 3.18546453e-03 3.29045346e-03 1.36704824e-03
 1.35460112e-03 1.35461218e-03 1.26503559e-03 6.97505486e-04
 1.86762528e-03 1.35460112e-03 1.36704021e-03 3.18697025e-03
 1.35460112e-03 1.35460170e-03 2.15980085e-03 1.87889126e-03
 7.72339816e-04 1.85599353e-03 1.35459960e-03 1.20849721e-03
 3.18696140e-03 1.35459960e-03 1.32926449e-03 1.95170625e-03
 1.63050659e-03 1.63050625e-03 1.15289306e-03 1.57838617e-03
 1.35459891e-03 1.57837942e-03 1.87336816e-03 2.76263966e-03
 2.19861232e-02 1.35459891e-03 2.06049420e-02 1.63800770e-03
 1.63799827e-03 2.45618471e-03 1.20122300e-03 1.77773531e-03
 1.32926600e-03 1.74930715e-03 1.25238311e-03 2.20023748e-02
 2.01149727e-03 2.20024046e-02 9.84635390e-03 1.27554312e-03
 2.01149611e-03 2.28791824e-03 2.28792056e-03 6.73981477e-03
 2.28790054e-03 1.70589902e-03 2.18565995e-03 2.10636538e-02
 2.60134786e-03 1.27554312e-03 2.60134274e-03 1.60826743e-03
 1.45777105e-03 1.66940631e-03 2.28790054e-03 1.23391033e-03
 1.50479830e-03 2.28789984e-03 4.71701671e-04 2.64600310e-02
 1.48226321e-03 1.27554662e-03 2.28791824e-03 2.24462915e-02
 3.40158166e-03 3.03271646e-03 2.28790357e-03 1.29589927e-03
 1.37238542e-03 1.29589695e-03 3.03275883e-03 1.29589485e-03
 8.40197376e-04 1.00327947e-03 1.14717509e-03 2.28791777e-03
 2.15600003e-02 3.03235417e-03 2.28791824e-03 1.51656549e-02
 3.03233694e-03 1.29589462e-03 3.03233787e-03 3.40156490e-03
 3.40157119e-03 4.36580461e-03 3.40157514e-03 2.28791824e-03
 2.27917824e-03 3.03233764e-03 1.57857907e-03 5.01194131e-03
 2.27917614e-03 3.40157002e-03 2.28792080e-03 2.58425577e-03
 6.89103850e-04 1.10939529e-03 1.10938237e-03 2.44124979e-03
 2.12046914e-02 2.10580952e-03 1.73262204e-03 4.69330363e-02
 1.10938482e-03 1.35327002e-03 1.10938272e-03 1.24156952e-03
 1.73260213e-03 1.10938842e-03 2.44305213e-03 1.92695740e-03
 1.97380828e-03 2.82450672e-03 1.32308574e-03 2.37315008e-03
 2.32587545e-03 1.41663360e-03 2.57204915e-03 2.57206103e-03
 1.64996658e-03 1.60120404e-03 2.57205358e-03 2.57206312e-03
 2.60411249e-03 9.37513891e-04 2.57206312e-03 2.57205195e-03
 2.57202657e-03 2.57202587e-03 1.60122523e-03 1.60119927e-03
 1.60120195e-03 1.60120532e-03 1.29970768e-03 3.07259639e-03
 1.60120125e-03 1.60120067e-03 1.29973248e-03 2.57206312e-03
 7.65790939e-02 1.29977311e-03 1.45604333e-03 1.60120591e-03
 1.36920146e-03 2.47292756e-03 7.10205501e-03 2.57205428e-03
 2.46412610e-03 2.47262814e-03 6.19316800e-03 1.78124034e-03
 1.78123289e-03 1.46227481e-03 1.78124034e-03 1.78123743e-03
 1.37769850e-03 3.06498539e-03 2.88987230e-03 2.56839464e-03
 2.56838952e-03 2.56840466e-03 2.97841802e-03 2.62208302e-02
 2.56840512e-03 1.36153502e-02 2.88974424e-03 1.46222941e-03
 2.43293424e-03 2.56839069e-03 3.66980629e-03 2.56838952e-03
 2.88987113e-03 1.62271352e-03 2.97840289e-03 2.62207072e-02
 2.88974820e-03 2.88974540e-03 2.97841663e-03 2.56839697e-03
 2.88975635e-03 2.88976519e-03 2.56839464e-03 1.62271061e-03
 2.67530996e-02 2.56839488e-03 2.55366834e-03 1.51204993e-03
 1.62271189e-03 1.51205924e-03]
2025-06-03 10:19:22,954 - DEBUG - Edge reconstruction errors: [0.15589263 1.6573597  1.6583965  ... 0.15555213 1.2534581  0.15557411]
2025-06-03 10:19:22,958 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_101922_update_39.json
2025-06-03 10:19:22,958 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:19:22,987 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_101922_update_39.pth and as latest_checkpoint.pth
2025-06-03 10:19:22,987 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.3416
2025-06-03 10:19:22,987 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-03 10:19:22,987 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.4095, MLP Score: 0.5019
2025-06-03 10:19:22,987 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1828, MLP Score: 0.5019
2025-06-03 10:19:22,987 - WARNING -   Node ID: 142.250.198.187, Recon Error: 0.0441, MLP Score: 0.5013
2025-06-03 10:19:22,987 - WARNING -   Node ID: 151.101.1.229, Recon Error: 0.0441, MLP Score: 0.5013
2025-06-03 10:19:22,987 - WARNING -   Node ID: 151.101.193.16, Recon Error: 0.0453, MLP Score: 0.5034
2025-06-03 10:19:22,987 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:19:22,987 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7047, MLP Score: 0.4967
2025-06-03 10:19:22,988 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3182, MLP Score: 0.4973
2025-06-03 10:19:22,988 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.8981, MLP Score: 0.4949
2025-06-03 10:19:22,988 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.2856, MLP Score: 0.4972
2025-06-03 10:19:22,988 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3007, MLP Score: 0.4974
2025-06-03 10:19:22,988 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-03 10:19:22,988 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-03 10:19:22,988 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-03 10:19:23,037 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-03 10:19:23,070 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-03 10:19:23,070 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-03 10:19:23,070 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-03 10:19:23,096 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-03 10:19:23,123 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-03 10:19:23,124 - INFO - Processing node updates/additions.
2025-06-03 10:19:23,131 - INFO - Processing edge updates/additions.
2025-06-03 10:19:23,148 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:19:23,149 - INFO - Finished updating NetworkX graph.
2025-06-03 10:19:23,150 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:19:23,151 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:19:23,168 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-03 10:19:23,170 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:19:23,171 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-03 10:19:23,182 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-03 10:19:23,184 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:19:23,191 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:19:23,195 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:19:23,198 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:19:23,200 - DEBUG - Shape of encoded categorical edge features: torch.Size([2181, 3])
2025-06-03 10:19:23,202 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:19:23,202 - DEBUG - Shape of scaled numerical edge features: torch.Size([2181, 7])
2025-06-03 10:19:23,202 - DEBUG - Final edge attributes tensor shape: torch.Size([2181, 10])
2025-06-03 10:19:23,202 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:19:23,207 - INFO - Performing online update...
2025-06-03 10:19:23,207 - INFO - Starting online update for 50 steps.
2025-06-03 10:19:23,208 - DEBUG - Updated RunningStats: new_mean=0.950528793380522, new_var=22800000000161.45, new_n=2310
2025-06-03 10:19:23,209 - DEBUG - Updated RunningStats: new_mean=0.9478041845780595, new_var=23100000000018.293, new_n=2340
2025-06-03 10:19:23,209 - DEBUG - Updated RunningStats: new_mean=1.209504116064186, new_var=7600000000093.52, new_n=770
2025-06-03 10:19:23,209 - DEBUG - Updated RunningStats: new_mean=1.2077834364875308, new_var=7700000000001.673, new_n=780
2025-06-03 10:19:23,209 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:19:23,209 - DEBUG - Online update step: 1/50
2025-06-03 10:19:23,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:24,021 - DEBUG - Node anomaly scores shape: torch.Size([22316, 1])
2025-06-03 10:19:24,035 - DEBUG - Edge anomaly scores shape: torch.Size([46926, 1])
2025-06-03 10:19:24,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:24,913 - DEBUG - Step 1: Loss=0.5738
2025-06-03 10:19:24,913 - DEBUG - Online update step: 2/50
2025-06-03 10:19:24,916 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:25,693 - DEBUG - Node anomaly scores shape: torch.Size([22248, 1])
2025-06-03 10:19:25,705 - DEBUG - Edge anomaly scores shape: torch.Size([46643, 1])
2025-06-03 10:19:25,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:26,552 - DEBUG - Step 2: Loss=0.5745
2025-06-03 10:19:26,552 - DEBUG - Online update step: 3/50
2025-06-03 10:19:26,556 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:27,835 - DEBUG - Node anomaly scores shape: torch.Size([23626, 1])
2025-06-03 10:19:27,858 - DEBUG - Edge anomaly scores shape: torch.Size([50004, 1])
2025-06-03 10:19:27,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:28,784 - DEBUG - Step 3: Loss=0.5713
2025-06-03 10:19:28,785 - DEBUG - Online update step: 4/50
2025-06-03 10:19:28,788 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:29,530 - DEBUG - Node anomaly scores shape: torch.Size([22905, 1])
2025-06-03 10:19:29,545 - DEBUG - Edge anomaly scores shape: torch.Size([48212, 1])
2025-06-03 10:19:29,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:30,327 - DEBUG - Step 4: Loss=0.5730
2025-06-03 10:19:30,327 - DEBUG - Online update step: 5/50
2025-06-03 10:19:30,330 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:31,014 - DEBUG - Node anomaly scores shape: torch.Size([22730, 1])
2025-06-03 10:19:31,028 - DEBUG - Edge anomaly scores shape: torch.Size([47889, 1])
2025-06-03 10:19:31,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:31,919 - DEBUG - Step 5: Loss=0.5740
2025-06-03 10:19:31,919 - DEBUG - Online update step: 6/50
2025-06-03 10:19:31,922 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:32,879 - DEBUG - Node anomaly scores shape: torch.Size([22505, 1])
2025-06-03 10:19:32,929 - DEBUG - Edge anomaly scores shape: torch.Size([47273, 1])
2025-06-03 10:19:32,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:36,493 - DEBUG - Step 6: Loss=0.5728
2025-06-03 10:19:36,493 - DEBUG - Online update step: 7/50
2025-06-03 10:19:36,504 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:38,105 - DEBUG - Node anomaly scores shape: torch.Size([22558, 1])
2025-06-03 10:19:38,119 - DEBUG - Edge anomaly scores shape: torch.Size([47587, 1])
2025-06-03 10:19:38,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:38,929 - DEBUG - Step 7: Loss=0.5730
2025-06-03 10:19:38,929 - DEBUG - Online update step: 8/50
2025-06-03 10:19:38,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:39,954 - DEBUG - Node anomaly scores shape: torch.Size([22256, 1])
2025-06-03 10:19:39,967 - DEBUG - Edge anomaly scores shape: torch.Size([46755, 1])
2025-06-03 10:19:39,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:40,652 - DEBUG - Step 8: Loss=0.5713
2025-06-03 10:19:40,652 - DEBUG - Online update step: 9/50
2025-06-03 10:19:40,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:41,318 - DEBUG - Node anomaly scores shape: torch.Size([23411, 1])
2025-06-03 10:19:41,330 - DEBUG - Edge anomaly scores shape: torch.Size([49357, 1])
2025-06-03 10:19:41,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:42,157 - DEBUG - Step 9: Loss=0.5718
2025-06-03 10:19:42,157 - DEBUG - Online update step: 10/50
2025-06-03 10:19:42,160 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:42,887 - DEBUG - Node anomaly scores shape: torch.Size([22734, 1])
2025-06-03 10:19:42,902 - DEBUG - Edge anomaly scores shape: torch.Size([47971, 1])
2025-06-03 10:19:42,906 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:43,646 - DEBUG - Step 10: Loss=0.5711
2025-06-03 10:19:43,647 - DEBUG - Online update step: 11/50
2025-06-03 10:19:43,652 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:44,401 - DEBUG - Node anomaly scores shape: torch.Size([22826, 1])
2025-06-03 10:19:44,414 - DEBUG - Edge anomaly scores shape: torch.Size([48077, 1])
2025-06-03 10:19:44,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:45,251 - DEBUG - Step 11: Loss=0.5714
2025-06-03 10:19:45,251 - DEBUG - Online update step: 12/50
2025-06-03 10:19:45,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:45,993 - DEBUG - Node anomaly scores shape: torch.Size([23067, 1])
2025-06-03 10:19:46,004 - DEBUG - Edge anomaly scores shape: torch.Size([48672, 1])
2025-06-03 10:19:46,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:46,796 - DEBUG - Step 12: Loss=0.5711
2025-06-03 10:19:46,796 - DEBUG - Online update step: 13/50
2025-06-03 10:19:46,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:47,427 - DEBUG - Node anomaly scores shape: torch.Size([23374, 1])
2025-06-03 10:19:47,440 - DEBUG - Edge anomaly scores shape: torch.Size([49374, 1])
2025-06-03 10:19:47,442 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:48,704 - DEBUG - Step 13: Loss=0.5710
2025-06-03 10:19:48,705 - DEBUG - Online update step: 14/50
2025-06-03 10:19:48,714 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:49,953 - DEBUG - Node anomaly scores shape: torch.Size([22770, 1])
2025-06-03 10:19:49,965 - DEBUG - Edge anomaly scores shape: torch.Size([48003, 1])
2025-06-03 10:19:49,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:50,694 - DEBUG - Step 14: Loss=0.5715
2025-06-03 10:19:50,694 - DEBUG - Online update step: 15/50
2025-06-03 10:19:50,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:51,301 - DEBUG - Node anomaly scores shape: torch.Size([22478, 1])
2025-06-03 10:19:51,314 - DEBUG - Edge anomaly scores shape: torch.Size([47288, 1])
2025-06-03 10:19:51,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:52,018 - DEBUG - Step 15: Loss=0.5714
2025-06-03 10:19:52,019 - DEBUG - Online update step: 16/50
2025-06-03 10:19:52,024 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:52,658 - DEBUG - Node anomaly scores shape: torch.Size([22496, 1])
2025-06-03 10:19:52,669 - DEBUG - Edge anomaly scores shape: torch.Size([47345, 1])
2025-06-03 10:19:52,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:53,329 - DEBUG - Step 16: Loss=0.5713
2025-06-03 10:19:53,330 - DEBUG - Online update step: 17/50
2025-06-03 10:19:53,333 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:53,977 - DEBUG - Node anomaly scores shape: torch.Size([22906, 1])
2025-06-03 10:19:53,990 - DEBUG - Edge anomaly scores shape: torch.Size([48346, 1])
2025-06-03 10:19:53,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:54,701 - DEBUG - Step 17: Loss=0.5714
2025-06-03 10:19:54,702 - DEBUG - Online update step: 18/50
2025-06-03 10:19:54,705 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:55,283 - DEBUG - Node anomaly scores shape: torch.Size([21878, 1])
2025-06-03 10:19:55,294 - DEBUG - Edge anomaly scores shape: torch.Size([45881, 1])
2025-06-03 10:19:55,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:55,982 - DEBUG - Step 18: Loss=0.5714
2025-06-03 10:19:55,982 - DEBUG - Online update step: 19/50
2025-06-03 10:19:55,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:56,646 - DEBUG - Node anomaly scores shape: torch.Size([23599, 1])
2025-06-03 10:19:56,658 - DEBUG - Edge anomaly scores shape: torch.Size([50003, 1])
2025-06-03 10:19:56,659 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:57,402 - DEBUG - Step 19: Loss=0.5712
2025-06-03 10:19:57,402 - DEBUG - Online update step: 20/50
2025-06-03 10:19:57,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:58,077 - DEBUG - Node anomaly scores shape: torch.Size([22776, 1])
2025-06-03 10:19:58,088 - DEBUG - Edge anomaly scores shape: torch.Size([47919, 1])
2025-06-03 10:19:58,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:19:58,816 - DEBUG - Step 20: Loss=0.5708
2025-06-03 10:19:58,816 - DEBUG - Online update step: 21/50
2025-06-03 10:19:58,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:19:59,512 - DEBUG - Node anomaly scores shape: torch.Size([24117, 1])
2025-06-03 10:19:59,524 - DEBUG - Edge anomaly scores shape: torch.Size([51164, 1])
2025-06-03 10:19:59,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:00,293 - DEBUG - Step 21: Loss=0.5707
2025-06-03 10:20:00,294 - DEBUG - Online update step: 22/50
2025-06-03 10:20:00,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:00,938 - DEBUG - Node anomaly scores shape: torch.Size([22906, 1])
2025-06-03 10:20:00,950 - DEBUG - Edge anomaly scores shape: torch.Size([48314, 1])
2025-06-03 10:20:00,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:01,634 - DEBUG - Step 22: Loss=0.5708
2025-06-03 10:20:01,635 - DEBUG - Online update step: 23/50
2025-06-03 10:20:01,638 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:02,309 - DEBUG - Node anomaly scores shape: torch.Size([23847, 1])
2025-06-03 10:20:02,323 - DEBUG - Edge anomaly scores shape: torch.Size([50515, 1])
2025-06-03 10:20:02,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:03,097 - DEBUG - Step 23: Loss=0.5711
2025-06-03 10:20:03,098 - DEBUG - Online update step: 24/50
2025-06-03 10:20:03,103 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:04,310 - DEBUG - Node anomaly scores shape: torch.Size([22782, 1])
2025-06-03 10:20:04,322 - DEBUG - Edge anomaly scores shape: torch.Size([47902, 1])
2025-06-03 10:20:04,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:05,029 - DEBUG - Step 24: Loss=0.5716
2025-06-03 10:20:05,029 - DEBUG - Online update step: 25/50
2025-06-03 10:20:05,032 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:05,653 - DEBUG - Node anomaly scores shape: torch.Size([22633, 1])
2025-06-03 10:20:05,668 - DEBUG - Edge anomaly scores shape: torch.Size([47662, 1])
2025-06-03 10:20:05,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:06,370 - DEBUG - Step 25: Loss=0.5719
2025-06-03 10:20:06,370 - DEBUG - Online update step: 26/50
2025-06-03 10:20:06,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:07,056 - DEBUG - Node anomaly scores shape: torch.Size([23845, 1])
2025-06-03 10:20:07,069 - DEBUG - Edge anomaly scores shape: torch.Size([50479, 1])
2025-06-03 10:20:07,070 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:07,846 - DEBUG - Step 26: Loss=0.5723
2025-06-03 10:20:07,846 - DEBUG - Online update step: 27/50
2025-06-03 10:20:07,849 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:08,481 - DEBUG - Node anomaly scores shape: torch.Size([22682, 1])
2025-06-03 10:20:08,493 - DEBUG - Edge anomaly scores shape: torch.Size([47690, 1])
2025-06-03 10:20:08,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:09,174 - DEBUG - Step 27: Loss=0.5728
2025-06-03 10:20:09,174 - DEBUG - Online update step: 28/50
2025-06-03 10:20:09,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:09,789 - DEBUG - Node anomaly scores shape: torch.Size([22291, 1])
2025-06-03 10:20:09,806 - DEBUG - Edge anomaly scores shape: torch.Size([46873, 1])
2025-06-03 10:20:09,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:10,527 - DEBUG - Step 28: Loss=0.5718
2025-06-03 10:20:10,527 - DEBUG - Online update step: 29/50
2025-06-03 10:20:10,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:11,198 - DEBUG - Node anomaly scores shape: torch.Size([23312, 1])
2025-06-03 10:20:11,211 - DEBUG - Edge anomaly scores shape: torch.Size([49271, 1])
2025-06-03 10:20:11,212 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:11,942 - DEBUG - Step 29: Loss=0.5709
2025-06-03 10:20:11,942 - DEBUG - Online update step: 30/50
2025-06-03 10:20:11,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:12,717 - DEBUG - Node anomaly scores shape: torch.Size([23675, 1])
2025-06-03 10:20:12,729 - DEBUG - Edge anomaly scores shape: torch.Size([50060, 1])
2025-06-03 10:20:12,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:13,511 - DEBUG - Step 30: Loss=0.5706
2025-06-03 10:20:13,511 - DEBUG - Online update step: 31/50
2025-06-03 10:20:13,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:14,174 - DEBUG - Node anomaly scores shape: torch.Size([23018, 1])
2025-06-03 10:20:14,194 - DEBUG - Edge anomaly scores shape: torch.Size([48599, 1])
2025-06-03 10:20:14,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:15,261 - DEBUG - Step 31: Loss=0.5705
2025-06-03 10:20:15,261 - DEBUG - Online update step: 32/50
2025-06-03 10:20:15,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:15,911 - DEBUG - Node anomaly scores shape: torch.Size([23226, 1])
2025-06-03 10:20:15,923 - DEBUG - Edge anomaly scores shape: torch.Size([48942, 1])
2025-06-03 10:20:15,924 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:16,617 - DEBUG - Step 32: Loss=0.5710
2025-06-03 10:20:16,617 - DEBUG - Online update step: 33/50
2025-06-03 10:20:16,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:17,241 - DEBUG - Node anomaly scores shape: torch.Size([23014, 1])
2025-06-03 10:20:17,253 - DEBUG - Edge anomaly scores shape: torch.Size([48515, 1])
2025-06-03 10:20:17,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:18,230 - DEBUG - Step 33: Loss=0.5715
2025-06-03 10:20:18,230 - DEBUG - Online update step: 34/50
2025-06-03 10:20:18,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:19,419 - DEBUG - Node anomaly scores shape: torch.Size([23125, 1])
2025-06-03 10:20:19,433 - DEBUG - Edge anomaly scores shape: torch.Size([48788, 1])
2025-06-03 10:20:19,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:20,171 - DEBUG - Step 34: Loss=0.5718
2025-06-03 10:20:20,172 - DEBUG - Online update step: 35/50
2025-06-03 10:20:20,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:20,807 - DEBUG - Node anomaly scores shape: torch.Size([22947, 1])
2025-06-03 10:20:20,819 - DEBUG - Edge anomaly scores shape: torch.Size([48395, 1])
2025-06-03 10:20:20,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:21,557 - DEBUG - Step 35: Loss=0.5711
2025-06-03 10:20:21,557 - DEBUG - Online update step: 36/50
2025-06-03 10:20:21,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:22,209 - DEBUG - Node anomaly scores shape: torch.Size([23305, 1])
2025-06-03 10:20:22,221 - DEBUG - Edge anomaly scores shape: torch.Size([49250, 1])
2025-06-03 10:20:22,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:22,969 - DEBUG - Step 36: Loss=0.5708
2025-06-03 10:20:22,969 - DEBUG - Online update step: 37/50
2025-06-03 10:20:22,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:23,573 - DEBUG - Node anomaly scores shape: torch.Size([22550, 1])
2025-06-03 10:20:23,586 - DEBUG - Edge anomaly scores shape: torch.Size([47444, 1])
2025-06-03 10:20:23,587 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:24,277 - DEBUG - Step 37: Loss=0.5706
2025-06-03 10:20:24,278 - DEBUG - Online update step: 38/50
2025-06-03 10:20:24,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:25,017 - DEBUG - Node anomaly scores shape: torch.Size([22672, 1])
2025-06-03 10:20:25,032 - DEBUG - Edge anomaly scores shape: torch.Size([47736, 1])
2025-06-03 10:20:25,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:25,779 - DEBUG - Step 38: Loss=0.5706
2025-06-03 10:20:25,779 - DEBUG - Online update step: 39/50
2025-06-03 10:20:25,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:26,517 - DEBUG - Node anomaly scores shape: torch.Size([22722, 1])
2025-06-03 10:20:26,533 - DEBUG - Edge anomaly scores shape: torch.Size([47851, 1])
2025-06-03 10:20:26,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:27,260 - DEBUG - Step 39: Loss=0.5702
2025-06-03 10:20:27,260 - DEBUG - Online update step: 40/50
2025-06-03 10:20:27,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:27,866 - DEBUG - Node anomaly scores shape: torch.Size([23005, 1])
2025-06-03 10:20:27,878 - DEBUG - Edge anomaly scores shape: torch.Size([48560, 1])
2025-06-03 10:20:27,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:28,543 - DEBUG - Step 40: Loss=0.5702
2025-06-03 10:20:28,543 - DEBUG - Online update step: 41/50
2025-06-03 10:20:28,547 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:29,185 - DEBUG - Node anomaly scores shape: torch.Size([22976, 1])
2025-06-03 10:20:29,196 - DEBUG - Edge anomaly scores shape: torch.Size([48381, 1])
2025-06-03 10:20:29,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:29,887 - DEBUG - Step 41: Loss=0.5704
2025-06-03 10:20:29,887 - DEBUG - Online update step: 42/50
2025-06-03 10:20:29,890 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:30,594 - DEBUG - Node anomaly scores shape: torch.Size([22464, 1])
2025-06-03 10:20:30,611 - DEBUG - Edge anomaly scores shape: torch.Size([47283, 1])
2025-06-03 10:20:30,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:31,868 - DEBUG - Step 42: Loss=0.5702
2025-06-03 10:20:31,868 - DEBUG - Online update step: 43/50
2025-06-03 10:20:31,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:32,735 - DEBUG - Node anomaly scores shape: torch.Size([23314, 1])
2025-06-03 10:20:32,751 - DEBUG - Edge anomaly scores shape: torch.Size([49215, 1])
2025-06-03 10:20:32,752 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:34,325 - DEBUG - Step 43: Loss=0.5700
2025-06-03 10:20:34,325 - DEBUG - Online update step: 44/50
2025-06-03 10:20:34,331 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:35,178 - DEBUG - Node anomaly scores shape: torch.Size([22182, 1])
2025-06-03 10:20:35,193 - DEBUG - Edge anomaly scores shape: torch.Size([46590, 1])
2025-06-03 10:20:35,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:36,119 - DEBUG - Step 44: Loss=0.5703
2025-06-03 10:20:36,119 - DEBUG - Online update step: 45/50
2025-06-03 10:20:36,127 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:36,888 - DEBUG - Node anomaly scores shape: torch.Size([21871, 1])
2025-06-03 10:20:36,904 - DEBUG - Edge anomaly scores shape: torch.Size([45849, 1])
2025-06-03 10:20:36,906 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:37,758 - DEBUG - Step 45: Loss=0.5703
2025-06-03 10:20:37,758 - DEBUG - Online update step: 46/50
2025-06-03 10:20:37,763 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:38,585 - DEBUG - Node anomaly scores shape: torch.Size([24286, 1])
2025-06-03 10:20:38,602 - DEBUG - Edge anomaly scores shape: torch.Size([51517, 1])
2025-06-03 10:20:38,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:39,507 - DEBUG - Step 46: Loss=0.5704
2025-06-03 10:20:39,508 - DEBUG - Online update step: 47/50
2025-06-03 10:20:39,511 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:40,237 - DEBUG - Node anomaly scores shape: torch.Size([22556, 1])
2025-06-03 10:20:40,255 - DEBUG - Edge anomaly scores shape: torch.Size([47493, 1])
2025-06-03 10:20:40,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:41,112 - DEBUG - Step 47: Loss=0.5716
2025-06-03 10:20:41,112 - DEBUG - Online update step: 48/50
2025-06-03 10:20:41,116 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:41,848 - DEBUG - Node anomaly scores shape: torch.Size([22342, 1])
2025-06-03 10:20:41,863 - DEBUG - Edge anomaly scores shape: torch.Size([47011, 1])
2025-06-03 10:20:41,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:42,595 - DEBUG - Step 48: Loss=0.5748
2025-06-03 10:20:42,595 - DEBUG - Online update step: 49/50
2025-06-03 10:20:42,598 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:43,284 - DEBUG - Node anomaly scores shape: torch.Size([22806, 1])
2025-06-03 10:20:43,297 - DEBUG - Edge anomaly scores shape: torch.Size([48065, 1])
2025-06-03 10:20:43,299 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:44,061 - DEBUG - Step 49: Loss=0.5717
2025-06-03 10:20:44,062 - DEBUG - Online update step: 50/50
2025-06-03 10:20:44,065 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:44,728 - DEBUG - Node anomaly scores shape: torch.Size([22331, 1])
2025-06-03 10:20:44,741 - DEBUG - Edge anomaly scores shape: torch.Size([46919, 1])
2025-06-03 10:20:44,743 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:45,567 - DEBUG - Step 50: Loss=0.5705
2025-06-03 10:20:45,568 - INFO - Online update finished. Average loss: 0.5714, Learning rate: 0.001000
2025-06-03 10:20:45,568 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.7450258e-09 -9.5750430e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1968805e-08
  1.4362564e-09 -9.5750430e-09  1.6277573e-08 -1.9150086e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  1.3405061e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00  8.2584748e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.8353968e-08  2.0825720e-08], current edge mean: [ 9.1480970e+00  1.4204494e+00  5.7028885e+00 -8.7452939e-10
 -1.3117941e-09 -1.7490588e-09  1.7490588e-09 -3.0608529e-09
  0.0000000e+00  0.0000000e+00]
2025-06-03 10:20:45,569 - DEBUG - Node drift difference: 0.0104, Edge drift difference: 0.0049
2025-06-03 10:20:45,570 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.7450258e-09 -9.5750430e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1968805e-08
  1.4362564e-09 -9.5750430e-09  1.6277573e-08 -1.9150086e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  1.3405061e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00  8.2584748e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.8353968e-08  2.0825720e-08], edge=[ 9.1480970e+00  1.4204494e+00  5.7028885e+00 -8.7452939e-10
 -1.3117941e-09 -1.7490588e-09  1.7490588e-09 -3.0608529e-09
  0.0000000e+00  0.0000000e+00]
2025-06-03 10:20:45,570 - DEBUG - Updated reference std: node=[0.         0.         1.0005023  1.0005023  0.         0.
 0.         1.0005023  1.0005023  1.0005023  1.0005023  1.0005023
 0.9383103  0.273724   0.3638916  0.5740894  1.0005023  3.008886
 2.9010541  1.4886004  0.3638916  0.22180349 1.0005023  1.0005023
 0.         0.         0.         0.         1.0005023  1.0005023 ], edge=[1.1073493 0.5056778 2.1382785 1.0002294 1.0002294 1.0002294 1.0002294
 1.0002294 1.0002294 1.0002294]
2025-06-03 10:20:45,570 - INFO - Online update complete. Loss: 0.5714
2025-06-03 10:20:45,571 - INFO - Running anomaly detection...
2025-06-03 10:20:45,571 - INFO - Starting anomaly detection.
2025-06-03 10:20:45,591 - DEBUG - Node reconstruction errors: [1.63020054e-03 1.06633082e-03 7.80737551e-04 5.36205596e-04
 1.03352184e-03 6.61505759e-03 3.86339938e-03 8.39148241e-04
 1.37421547e-03 1.13263307e-02 1.07207510e-03 3.58110084e-03
 8.23426817e-04 3.58224468e-04 2.60358881e-02 1.28015922e-03
 2.37564906e-03 8.58842675e-03 3.77757149e-03 8.84603057e-03
 8.58842675e-03 5.69652021e-03 4.74654080e-04 3.71264084e-03
 7.45175232e-04 3.64532042e-03 2.84547568e-03 6.30100432e-04
 8.58842954e-03 8.27284716e-03 2.01439625e-03 3.64531064e-03
 1.91679760e-03 4.26293677e-03 1.31305051e-03 3.29457736e-03
 3.74937534e-01 4.83512791e-04 3.52839427e-03 2.17725709e-03
 1.30913779e-03 1.13173143e-03 1.92986301e-03 3.58223944e-04
 1.52577041e-03 8.65951367e-03 1.65390238e-01 9.47834738e-03
 1.58652361e-03 1.32434582e-03 8.48196819e-03 4.74654109e-04
 3.46676068e-04 4.83512442e-04 3.64531786e-03 1.42900995e-03
 1.30743533e-03 8.44514987e-04 1.00585409e-02 4.37637651e-03
 3.83412130e-02 1.73615618e-03 2.97360178e-02 4.27224179e-04
 7.05094170e-03 9.74146649e-04 4.37678955e-03 4.74656408e-04
 1.32433849e-03 4.63289209e-03 4.27799346e-03 6.17476040e-03
 9.68209095e-03 1.29780115e-03 1.39620407e-02 7.75164366e-03
 1.32434582e-03 4.20935303e-02 1.29727721e-02 8.51775426e-03
 9.27227142e-04 2.28954945e-03 3.54359299e-03 7.46905920e-04
 8.92033277e-04 4.90250671e-03 7.02229561e-04 4.56132169e-04
 3.51274665e-03 5.33438148e-03 6.27346337e-04 8.96856713e-04
 1.65905221e-03 5.53494494e-04 1.93425908e-03 7.45905703e-03
 4.81300201e-04 8.97043792e-04 2.34405888e-04 1.05661163e-02
 3.77385993e-04 4.81299241e-04 4.01497964e-04 5.25667192e-03
 8.22329312e-04 1.15520936e-02 1.11166644e-03 1.65746529e-02
 1.69044209e-03 3.70597490e-03 7.35065248e-03 5.39706671e-04
 6.95844472e-04 8.81512067e-04 1.19885837e-03 1.36102503e-03
 6.22079300e-04 1.04950485e-03 6.72515540e-04 1.97077752e-03
 5.71488577e-04 1.48437649e-03 8.88380047e-04 1.24425581e-03
 1.25878653e-03 1.97078614e-03 1.42280094e-03 2.70329625e-03
 6.48969610e-04 7.25365768e-04 8.86107970e-04 1.88379036e-03
 3.74867022e-03 4.13175253e-03 1.03797903e-03 1.12205334e-02
 5.56094805e-04 2.96468206e-04 1.67718600e-03 4.15541377e-04
 2.54987204e-03 2.61778627e-02 4.97396104e-04 2.48667854e-03
 2.17037811e-03 8.98681814e-04 6.22078602e-04 4.91574500e-03
 2.62767961e-03 1.10694696e-03 3.41741256e-02 8.98283033e-04
 6.97717885e-04 1.88379048e-03 9.26055189e-04 7.88417005e-04
 1.89545564e-03 1.02196017e-03 3.77389253e-04 4.18231561e-04
 2.54985155e-03 1.67718378e-03 1.89544959e-03 8.86101509e-04
 5.98982791e-04 1.46069634e-03 1.91568310e-04 1.10624242e-03
 9.40365077e-04 1.10692403e-03 6.77627744e-04 2.07472290e-03
 7.41273572e-04 3.08880722e-03 6.72504131e-04 2.46945163e-03
 1.10756082e-03 1.19429885e-03 2.99607724e-04 2.99604726e-04
 1.29566072e-02 1.05424935e-03 2.94794654e-03 2.39331718e-03
 1.79169374e-03 1.06650137e-03 6.36813929e-04 4.50078311e-04
 1.26466313e-02 1.60227576e-03 4.66513098e-04 4.89838480e-04
 1.49413326e-03 1.80267741e-03 1.67710753e-03 4.40533331e-04
 8.50086566e-03 8.16528278e-04 5.28830860e-04 6.66388427e-04
 5.88681607e-04 1.89545040e-03 6.42568106e-04 6.92398811e-04
 5.49433171e-04 1.17838685e-03 1.66998301e-02 8.95986333e-03
 2.75108090e-04 4.95828222e-04 4.96049237e-04 8.33594648e-04
 7.30051252e-04 1.44926249e-03 1.83838466e-03 5.98866900e-04
 5.44970855e-04 6.22084190e-04 4.26459238e-02 1.93182449e-03
 1.64666795e-03 4.72362473e-04 7.83394673e-04 7.30047235e-04
 1.89545646e-03 8.35815154e-04 8.96859216e-04 1.89679419e-03
 7.43160257e-04 9.11842915e-04 1.17452047e-03 8.86423688e-04
 6.36212295e-04 6.22080697e-04 6.22081978e-04 1.49413676e-03
 9.96231334e-04 7.83400727e-04 1.89545681e-03 1.16578117e-03
 7.91289902e-04 6.11226831e-04 1.35798089e-03 1.64310436e-03
 1.26572500e-03 1.28695264e-03 6.46469416e-04 1.55335583e-03
 1.35798089e-03 2.30599567e-03 6.95245457e-04 7.93424668e-04
 4.26459350e-02 1.23693352e-03 6.82789192e-04 1.23551360e-03
 1.27795350e-03 2.49883626e-04 6.71682879e-04 2.99607986e-04
 7.65641569e-04 3.08741583e-03 3.04828002e-03 2.05103890e-03
 4.72797023e-04 1.52146618e-03 3.71356320e-04 8.20284430e-03
 3.71353875e-04 8.19022942e-04 1.90492664e-02 1.12131541e-03
 8.38539563e-04 7.11931265e-04 1.13868948e-04 4.68359003e-03
 6.18707796e-04 7.23110093e-03 1.29566127e-02 7.19458912e-04
 3.64302588e-03 6.98743446e-04 1.17289869e-03 2.33340979e-04
 7.59638904e-04 5.34024846e-04 3.20961536e-03 1.07645022e-03
 1.05424714e-03 7.31594302e-03 1.52997556e-03 6.69243978e-04
 3.17448974e-02 1.26572326e-03 3.80949257e-03 2.57609499e-04
 9.44986125e-04 2.99589155e-04 4.40534874e-04 2.02787505e-03
 8.33527534e-04 4.06281964e-04 1.03944141e-04 1.00022159e-03
 3.07449925e-04 3.07449809e-04 3.07451206e-04 2.56165105e-04
 3.63250816e-04 4.06279723e-04 3.07451206e-04 6.40302198e-04
 3.07450158e-04 1.18912174e-03 1.25871005e-03 8.51910736e-04
 4.62298514e-03 1.17710652e-03 7.61939562e-04 4.82935633e-04
 1.01571192e-03 1.69378321e-03 8.57867883e-04 1.03944956e-04
 1.73041746e-02 1.57703646e-03 1.77154541e-02 8.26452102e-04
 5.38229127e-04 5.38230641e-04 6.24391902e-03 3.94759903e-04
 3.07452079e-04 1.13868649e-04 3.07450129e-04 2.56166619e-04
 1.06137851e-03 7.80161121e-04 4.60457057e-04 2.83034315e-04
 4.06305306e-04 1.56230142e-03 2.83034024e-04 4.82580013e-04
 8.28474236e-04 7.71867926e-04 1.03944665e-04 5.85468428e-04
 4.17110976e-04 6.54116215e-04 3.07453884e-04 8.86399823e-04
 3.20783933e-04 7.13269110e-04 1.74514146e-03 1.27794931e-03
 4.18963085e-04 3.07448965e-04 3.83124425e-04 1.66760222e-03
 6.89881737e-04 9.85142891e-04 5.09144831e-03 6.66122709e-04
 1.03934552e-04 3.43368854e-03 5.06742334e-04 1.19572645e-03
 3.92367976e-04 9.97454044e-04 7.63574964e-04 7.37724185e-04
 6.32164942e-04 3.70998430e-04 8.59504275e-04 1.10052770e-03
 6.53388095e-04 1.13933231e-03 1.06076594e-03 3.07449809e-04
 1.03944396e-04 9.19226790e-04 8.56382947e-04 1.12772605e-03
 8.99645092e-04 1.48263376e-03 1.32495249e-02 3.33010335e-03
 4.42147837e-04 3.07452108e-04 3.54039203e-03 5.67101699e-04
 3.70437803e-04 7.39302777e-04 2.90529686e-04 2.90526048e-04
 2.90520577e-04 3.43631441e-03 2.08759957e-04 8.72306060e-03
 8.27260839e-04 2.66892952e-03 7.06703926e-04 2.08759870e-04
 3.61746934e-04 3.70427675e-04 6.30040944e-04 8.97059159e-04
 3.70442285e-04 1.91929936e-02 2.90524069e-04 3.70443828e-04
 2.08760102e-04 2.90520285e-04 2.90523603e-04 2.47355481e-03
 1.75689138e-03 2.90521741e-04 4.88203950e-04 7.14617083e-04
 9.34679760e-04 6.32502197e-04 6.59720623e-04 6.83152291e-04
 9.13350435e-04 9.00949177e-04 7.62709999e-04 5.20290982e-04
 3.01375543e-03 1.01141841e-03 3.29249888e-04 1.60115734e-02
 6.30752766e-04 6.06399146e-04 1.48981856e-03 2.90523807e-04
 6.89355657e-04 8.54845566e-04 7.91139260e-04 4.84570017e-04
 4.37802810e-04 9.13270575e-04 4.67592990e-03 4.62566095e-04
 6.52395713e-04 7.70281418e-04 7.06988247e-03 6.32716168e-04
 3.57618061e-04 7.21863995e-04 6.48351153e-04 4.93052532e-04
 7.90920458e-04 2.63270398e-04 4.93046246e-04 1.64660756e-02
 6.83159044e-04 9.90588334e-04 6.35751407e-04 6.47531881e-04
 4.70465835e-04 8.43333371e-04 6.51856302e-04 9.62342776e-04
 6.51862414e-04 8.43332964e-04 5.18726127e-04 1.05241872e-03
 7.57195114e-04 3.82178783e-04 5.18727931e-04 4.70462313e-04
 1.35323242e-03 1.80039799e-03 8.58650485e-04 6.59595651e-04
 1.05240988e-03 4.70464962e-04 3.98327276e-04 9.67692817e-04
 4.52589185e-04 4.04403806e-02 7.47988175e-04 6.32712967e-04
 1.20680337e-03 5.90176613e-04 4.93047526e-04 1.12685829e-03
 2.89310538e-03 1.84322207e-03 6.59683777e-04 3.98327713e-04
 1.17685634e-03 4.41672339e-04 6.50148955e-04 7.43015902e-04
 6.26414025e-04 9.93926730e-03 1.68644052e-04 9.67688218e-04
 2.95087346e-03 4.41674638e-04 2.85114348e-03 5.29026904e-04
 4.66761296e-04 1.47042354e-03 1.39557102e-04 4.63427044e-03
 6.76915224e-04 4.93048807e-04 9.77710821e-04 7.28232902e-04
 7.28232495e-04 4.74217522e-04 5.48641256e-04 6.30692171e-04
 1.39554948e-04 1.84077566e-04 6.40071579e-04 8.64106172e-04
 7.79398368e-04 9.13272437e-04 1.39555865e-04 5.56505227e-04
 4.66765196e-04 6.26415364e-04 8.38397653e-04 1.88778306e-03
 7.79381604e-04 7.59045011e-04 6.30700029e-04 8.48379685e-04
 1.68645318e-04 9.67684784e-04 6.26417110e-04 5.11079037e-04
 8.94193654e-04 6.13768701e-04 1.68643324e-04 4.89573693e-04
 1.68646482e-04 6.65985979e-04 4.45821992e-04 1.84075019e-04
 6.82010839e-04 2.22400366e-03 1.12010492e-03 1.30815402e-04
 3.95532465e-03 1.30814966e-04 1.30815853e-04 1.30815562e-04
 1.30814020e-04 1.30814704e-04 1.30815562e-04 1.30816115e-04
 4.57614311e-04 6.55375421e-04 2.71049957e-03 1.30814093e-04
 1.30813671e-04 1.30814879e-04 1.30814020e-04 1.30814704e-04
 1.30813394e-04 1.30814777e-04 1.30814777e-04 1.30814020e-04
 2.18019166e-04 1.30817061e-04 1.30814020e-04 8.21691647e-04
 1.30814704e-04 2.22630915e-03 2.38608406e-03 1.68645216e-04
 3.41214403e-03 1.48318138e-03 2.50588474e-03 2.50588474e-03
 7.72567815e-04 3.41214403e-03 1.68645041e-04 1.39554948e-04
 1.39555370e-04 4.92500840e-04 1.39557349e-04 6.99485478e-04
 7.41332129e-04 1.30812827e-04 9.13269119e-04 1.68645216e-04
 7.28230283e-04 1.68644881e-04 1.68645318e-04 5.25290263e-04
 1.68643892e-04 1.39556578e-04 1.68644197e-04 1.68645565e-04
 8.35395476e-04 1.39555865e-04 1.68645493e-04 1.39557218e-04
 1.68645041e-04 1.68644197e-04 1.68643892e-04 4.86460776e-04
 1.28768524e-03 7.22909288e-04 1.30814020e-04 1.59120597e-02
 2.16849474e-03 1.68644561e-04 1.39557378e-04 6.13586861e-04
 1.30816377e-04 5.47917385e-04 7.97795074e-04 2.25740689e-04
 1.68644881e-04 1.68644052e-04 8.27691518e-04 4.25498962e-04
 1.23111729e-03 1.68644532e-04 4.57614049e-04 2.80694745e-04
 1.39556592e-04 7.78688176e-04 1.30814005e-04 7.66228244e-04
 7.90225167e-04 1.30814908e-04 1.30814791e-04 4.57618211e-04
 2.80694687e-04 1.68645318e-04 1.29671339e-02 8.99924722e-04
 6.60875521e-04 4.25496721e-04 5.71709068e-04 2.93265446e-04
 2.93267600e-04 2.19290331e-03 5.23302006e-04 1.30814020e-04
 6.75954332e-04 1.36782916e-03 4.25494218e-04 6.25560875e-04
 5.66528877e-04 4.80718649e-04 1.07591906e-04 1.07591928e-04
 1.07590924e-04 1.07589331e-04 1.07591928e-04 2.16390603e-04
 1.10493787e-03 1.07591652e-04 1.07591179e-04 1.30814704e-04
 3.23313812e-04 1.30816115e-04 2.93269346e-04 9.94662521e-04
 8.96261365e-04 1.81766017e-03 7.75762543e-04 1.11302536e-03
 2.18019952e-04 4.39261086e-04 2.18019020e-04 1.30814966e-04
 2.93266668e-04 3.95251147e-04 1.20217424e-04 1.20217359e-04
 1.07589338e-04 3.95254756e-04 5.60444139e-04 2.09542690e-03
 3.13835801e-04 1.30814515e-04 1.07592095e-04 4.08124208e-04
 1.20217635e-04 2.40926427e-04 4.00832272e-04 4.53212619e-04
 2.16391505e-04 1.64169050e-03 5.67494833e-04 2.45266920e-03
 8.05468124e-04 4.00830613e-04 6.63231069e-04 3.80255864e-04
 3.79831967e-04 4.22729587e-04 4.15753486e-04 2.54376850e-04
 3.85306485e-04 4.00836609e-04 4.00838297e-04 4.00838006e-04
 3.62377119e-04 4.08122753e-04 4.00836871e-04 3.79834149e-04
 4.00837685e-04 4.00838006e-04 4.00833640e-04 5.53832564e-04
 3.48586327e-04 1.12087722e-03 2.50435900e-04 6.96586736e-04
 9.96111427e-04 4.58893657e-04 1.37311476e-03 4.11186600e-03
 3.75845149e-04 3.37730307e-04 4.01592086e-04 2.53597740e-02
 1.75237171e-02 3.79831967e-04 1.13044283e-03 4.41157706e-02
 3.76269134e-04 1.31375942e-04 1.91801426e-03 5.48231765e-04
 4.18398064e-04 4.18395706e-04 4.18398064e-04 1.51640546e-04
 3.96477146e-04 1.28813449e-03 2.10842378e-02 4.03826311e-03
 5.07993333e-04 4.42171993e-04 5.73595054e-04 1.31377587e-04
 5.61086403e-04 9.07028443e-04 3.02295550e-04 1.19663181e-03
 3.76271055e-04 4.41154316e-02 1.31378009e-04 9.07044159e-04
 3.43380700e-04 1.10535335e-03 4.18397307e-04 1.51640372e-04
 3.02294735e-04 7.18856638e-04 1.76944304e-02 1.51641536e-04
 1.51641289e-04 1.51640765e-04 1.22993614e-03 1.25275599e-02
 1.01141641e-02 4.18395706e-04 6.77131210e-03 1.51641696e-04
 6.34688477e-04 7.77650741e-04 5.47675649e-03 7.57151574e-04
 1.51641289e-04 1.75888505e-04 5.97966020e-04 4.33707493e-04
 1.25190290e-02 7.57150876e-04 5.17020887e-03 7.43551063e-04
 9.03578242e-04 7.57149712e-04 6.10409596e-04 1.78602748e-02
 9.20789840e-04 1.75441836e-03 5.91744320e-04 4.99454967e-04
 4.99452697e-04 1.17857219e-03 3.03184893e-03 4.79623396e-03
 7.57150294e-04 9.20793391e-04 7.57147558e-04 2.93098710e-04
 4.29600856e-04 4.29602165e-04 3.25426197e-04 6.94120943e-04
 4.29274805e-04 4.29602165e-04 2.93100748e-04 7.44100078e-04
 4.29599546e-04 4.29601467e-04 1.60500742e-04 1.21782965e-03
 5.25539799e-04 1.03120331e-03 4.29602165e-04 1.05432863e-03
 7.44097750e-04 4.29600856e-04 4.25544655e-04 1.08711212e-03
 4.18838230e-04 4.18839976e-04 1.26274896e-03 8.93206452e-04
 4.29602165e-04 8.93210410e-04 1.04856642e-03 1.63904880e-03
 1.97238568e-02 4.29602893e-04 1.71960797e-02 9.50644433e-04
 9.50646703e-04 9.21694678e-04 5.06155717e-04 9.99754760e-04
 4.25541744e-04 1.15503010e-03 3.06063885e-04 1.78468525e-02
 1.43739476e-03 1.78468712e-02 7.20173586e-03 3.15582496e-04
 1.43738964e-03 1.47302970e-04 1.47305342e-04 5.34607656e-03
 1.47304134e-04 1.31104363e-03 1.75735404e-04 1.73845123e-02
 7.91547005e-04 3.15583486e-04 7.91553059e-04 1.23618741e-03
 1.00312114e-03 1.31352211e-03 1.47305502e-04 5.55926177e-04
 1.58716191e-03 1.47304367e-04 1.10956829e-03 2.73528993e-02
 1.10157009e-03 3.15585785e-04 1.47303726e-04 1.75810736e-02
 3.50252842e-04 1.20509963e-03 1.47305152e-04 4.34383313e-04
 8.20162822e-04 4.34382819e-04 1.20507751e-03 4.34381625e-04
 6.87342545e-04 9.10374743e-04 8.69193173e-04 1.47303930e-04
 1.87580790e-02 1.20506028e-03 1.47302970e-04 1.11147454e-02
 1.20505656e-03 4.34384885e-04 1.20506308e-03 3.50250513e-04
 3.50251357e-04 2.01536203e-03 3.50250484e-04 1.47303988e-04
 7.67366364e-05 1.20505481e-03 1.38701254e-03 2.66972533e-03
 7.67360762e-05 3.50251066e-04 1.47304352e-04 1.75410172e-03
 2.90881959e-03 6.95218856e-04 6.95219904e-04 1.21635472e-04
 1.83980484e-02 8.08429962e-04 1.12958858e-03 4.01082039e-02
 6.95216761e-04 3.90003144e-04 6.95222174e-04 5.69372554e-04
 1.12958474e-03 6.95221242e-04 1.15199255e-04 4.89044120e-04
 1.27757888e-03 2.91418954e-04 4.02460311e-04 6.24071326e-05
 8.92661279e-04 3.84529150e-04 1.15473013e-04 1.15471295e-04
 7.30115164e-04 9.49268579e-04 1.15473100e-04 1.15473558e-04
 1.59872358e-03 8.55845574e-04 1.15473500e-04 1.15471776e-04
 1.15473944e-04 1.15473304e-04 9.49249545e-04 9.49262758e-04
 9.49265959e-04 9.49260255e-04 7.63553777e-04 7.92297709e-04
 9.49265086e-04 9.49267473e-04 7.63511809e-04 1.15473500e-04
 6.63515776e-02 7.63493008e-04 3.81555554e-04 9.49260138e-04
 4.01867583e-04 1.14197435e-03 5.48375538e-03 1.15473631e-04
 2.08833208e-03 1.14201684e-03 7.25388341e-03 1.03954074e-03
 1.03954365e-03 4.62529249e-04 1.03954773e-03 1.03954342e-03
 4.85306780e-04 9.77067626e-04 9.53729672e-04 2.11380393e-04
 2.11380655e-04 2.20816280e-03 9.00574261e-04 2.13478003e-02
 2.11379913e-04 8.10177717e-03 9.53674433e-04 4.62539785e-04
 2.90743052e-03 2.11380524e-04 1.16250140e-03 2.11381193e-04
 9.53749812e-04 4.64602927e-04 9.00575367e-04 2.13477556e-02
 9.53677169e-04 9.53672454e-04 9.00569314e-04 2.11381499e-04
 9.53676179e-04 9.53669602e-04 2.11379127e-04 4.64606564e-04
 2.13978365e-02 2.11381441e-04 1.24365266e-03 5.02501731e-04
 4.64607234e-04 5.02499810e-04 1.92754541e-03 1.92754576e-03]
2025-06-03 10:20:45,592 - DEBUG - Edge reconstruction errors: [0.15559432 1.6572583  1.6582884  ... 0.15520515 1.2532976  0.15524286]
2025-06-03 10:20:45,594 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102045_update_40.json
2025-06-03 10:20:45,595 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:20:45,613 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102045_update_40.pth and as latest_checkpoint.pth
2025-06-03 10:20:45,614 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.3460
2025-06-03 10:20:45,614 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-03 10:20:45,614 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3749, MLP Score: 0.5007
2025-06-03 10:20:45,614 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1654, MLP Score: 0.5001
2025-06-03 10:20:45,614 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0383, MLP Score: 0.5022
2025-06-03 10:20:45,614 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0421, MLP Score: 0.5004
2025-06-03 10:20:45,614 - WARNING -   Node ID: 142.250.198.187, Recon Error: 0.0426, MLP Score: 0.5005
2025-06-03 10:20:45,614 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:20:45,614 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7064, MLP Score: 0.4996
2025-06-03 10:20:45,615 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3191, MLP Score: 0.5002
2025-06-03 10:20:45,615 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9021, MLP Score: 0.4993
2025-06-03 10:20:45,615 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.2976, MLP Score: 0.4983
2025-06-03 10:20:45,615 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3109, MLP Score: 0.4996
2025-06-03 10:20:45,615 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-03 10:20:45,615 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-03 10:20:45,615 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-03 10:20:45,652 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-03 10:20:45,687 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-03 10:20:45,688 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-03 10:20:45,688 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-03 10:20:45,716 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-03 10:20:45,747 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-03 10:20:45,747 - INFO - Processing node updates/additions.
2025-06-03 10:20:45,753 - INFO - Processing edge updates/additions.
2025-06-03 10:20:45,768 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:20:45,769 - INFO - Finished updating NetworkX graph.
2025-06-03 10:20:45,769 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:20:45,770 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:20:45,783 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-03 10:20:45,784 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:20:45,785 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-03 10:20:45,786 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-03 10:20:45,788 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:20:45,794 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:20:45,796 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:20:45,797 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:20:45,799 - DEBUG - Shape of encoded categorical edge features: torch.Size([2201, 3])
2025-06-03 10:20:45,800 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:20:45,800 - DEBUG - Shape of scaled numerical edge features: torch.Size([2201, 7])
2025-06-03 10:20:45,800 - DEBUG - Final edge attributes tensor shape: torch.Size([2201, 10])
2025-06-03 10:20:45,801 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:20:45,804 - INFO - Performing online update...
2025-06-03 10:20:45,804 - INFO - Starting online update for 50 steps.
2025-06-03 10:20:45,804 - DEBUG - Updated RunningStats: new_mean=0.9504630046717119, new_var=23400000000161.33, new_n=2370
2025-06-03 10:20:45,805 - DEBUG - Updated RunningStats: new_mean=0.9478186316389734, new_var=23700000000018.367, new_n=2400
2025-06-03 10:20:45,805 - DEBUG - Updated RunningStats: new_mean=1.2130944208530117, new_var=7800000000093.453, new_n=790
2025-06-03 10:20:45,805 - DEBUG - Updated RunningStats: new_mean=1.2113604632292871, new_var=7900000000001.674, new_n=800
2025-06-03 10:20:45,805 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:20:45,805 - DEBUG - Online update step: 1/50
2025-06-03 10:20:45,809 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:46,709 - DEBUG - Node anomaly scores shape: torch.Size([23023, 1])
2025-06-03 10:20:46,722 - DEBUG - Edge anomaly scores shape: torch.Size([48504, 1])
2025-06-03 10:20:46,723 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:47,455 - DEBUG - Step 1: Loss=0.5696
2025-06-03 10:20:47,456 - DEBUG - Online update step: 2/50
2025-06-03 10:20:47,458 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:48,305 - DEBUG - Node anomaly scores shape: torch.Size([21792, 1])
2025-06-03 10:20:48,316 - DEBUG - Edge anomaly scores shape: torch.Size([45637, 1])
2025-06-03 10:20:48,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:49,663 - DEBUG - Step 2: Loss=0.5703
2025-06-03 10:20:49,663 - DEBUG - Online update step: 3/50
2025-06-03 10:20:49,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:50,319 - DEBUG - Node anomaly scores shape: torch.Size([22820, 1])
2025-06-03 10:20:50,332 - DEBUG - Edge anomaly scores shape: torch.Size([48057, 1])
2025-06-03 10:20:50,333 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:51,056 - DEBUG - Step 3: Loss=0.5722
2025-06-03 10:20:51,056 - DEBUG - Online update step: 4/50
2025-06-03 10:20:51,061 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:51,759 - DEBUG - Node anomaly scores shape: torch.Size([23317, 1])
2025-06-03 10:20:51,772 - DEBUG - Edge anomaly scores shape: torch.Size([49234, 1])
2025-06-03 10:20:51,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:52,475 - DEBUG - Step 4: Loss=0.5705
2025-06-03 10:20:52,475 - DEBUG - Online update step: 5/50
2025-06-03 10:20:52,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:53,128 - DEBUG - Node anomaly scores shape: torch.Size([22981, 1])
2025-06-03 10:20:53,141 - DEBUG - Edge anomaly scores shape: torch.Size([48449, 1])
2025-06-03 10:20:53,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:53,910 - DEBUG - Step 5: Loss=0.5716
2025-06-03 10:20:53,910 - DEBUG - Online update step: 6/50
2025-06-03 10:20:53,915 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:54,508 - DEBUG - Node anomaly scores shape: torch.Size([22704, 1])
2025-06-03 10:20:54,521 - DEBUG - Edge anomaly scores shape: torch.Size([47898, 1])
2025-06-03 10:20:54,522 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:55,191 - DEBUG - Step 6: Loss=0.5700
2025-06-03 10:20:55,191 - DEBUG - Online update step: 7/50
2025-06-03 10:20:55,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:55,791 - DEBUG - Node anomaly scores shape: torch.Size([22526, 1])
2025-06-03 10:20:55,803 - DEBUG - Edge anomaly scores shape: torch.Size([47361, 1])
2025-06-03 10:20:55,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:56,464 - DEBUG - Step 7: Loss=0.5722
2025-06-03 10:20:56,464 - DEBUG - Online update step: 8/50
2025-06-03 10:20:56,467 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:57,119 - DEBUG - Node anomaly scores shape: torch.Size([23330, 1])
2025-06-03 10:20:57,130 - DEBUG - Edge anomaly scores shape: torch.Size([49295, 1])
2025-06-03 10:20:57,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:57,807 - DEBUG - Step 8: Loss=0.5719
2025-06-03 10:20:57,807 - DEBUG - Online update step: 9/50
2025-06-03 10:20:57,810 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:58,430 - DEBUG - Node anomaly scores shape: torch.Size([23685, 1])
2025-06-03 10:20:58,448 - DEBUG - Edge anomaly scores shape: torch.Size([50047, 1])
2025-06-03 10:20:58,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:20:59,163 - DEBUG - Step 9: Loss=0.5702
2025-06-03 10:20:59,164 - DEBUG - Online update step: 10/50
2025-06-03 10:20:59,166 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:20:59,810 - DEBUG - Node anomaly scores shape: torch.Size([23196, 1])
2025-06-03 10:20:59,823 - DEBUG - Edge anomaly scores shape: torch.Size([48909, 1])
2025-06-03 10:20:59,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:00,550 - DEBUG - Step 10: Loss=0.5709
2025-06-03 10:21:00,550 - DEBUG - Online update step: 11/50
2025-06-03 10:21:00,553 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:01,179 - DEBUG - Node anomaly scores shape: torch.Size([22596, 1])
2025-06-03 10:21:01,192 - DEBUG - Edge anomaly scores shape: torch.Size([47608, 1])
2025-06-03 10:21:01,194 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:01,858 - DEBUG - Step 11: Loss=0.5707
2025-06-03 10:21:01,858 - DEBUG - Online update step: 12/50
2025-06-03 10:21:01,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:02,508 - DEBUG - Node anomaly scores shape: torch.Size([23039, 1])
2025-06-03 10:21:02,519 - DEBUG - Edge anomaly scores shape: torch.Size([48662, 1])
2025-06-03 10:21:02,520 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:03,232 - DEBUG - Step 12: Loss=0.5702
2025-06-03 10:21:03,232 - DEBUG - Online update step: 13/50
2025-06-03 10:21:03,235 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:04,458 - DEBUG - Node anomaly scores shape: torch.Size([22746, 1])
2025-06-03 10:21:04,475 - DEBUG - Edge anomaly scores shape: torch.Size([47977, 1])
2025-06-03 10:21:04,477 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:05,196 - DEBUG - Step 13: Loss=0.5726
2025-06-03 10:21:05,196 - DEBUG - Online update step: 14/50
2025-06-03 10:21:05,199 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:05,795 - DEBUG - Node anomaly scores shape: torch.Size([23290, 1])
2025-06-03 10:21:05,808 - DEBUG - Edge anomaly scores shape: torch.Size([49238, 1])
2025-06-03 10:21:05,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:06,488 - DEBUG - Step 14: Loss=0.5716
2025-06-03 10:21:06,488 - DEBUG - Online update step: 15/50
2025-06-03 10:21:06,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:07,052 - DEBUG - Node anomaly scores shape: torch.Size([21723, 1])
2025-06-03 10:21:07,064 - DEBUG - Edge anomaly scores shape: torch.Size([45570, 1])
2025-06-03 10:21:07,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:07,680 - DEBUG - Step 15: Loss=0.5719
2025-06-03 10:21:07,680 - DEBUG - Online update step: 16/50
2025-06-03 10:21:07,684 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:08,362 - DEBUG - Node anomaly scores shape: torch.Size([24275, 1])
2025-06-03 10:21:08,375 - DEBUG - Edge anomaly scores shape: torch.Size([51484, 1])
2025-06-03 10:21:08,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:09,130 - DEBUG - Step 16: Loss=0.5717
2025-06-03 10:21:09,130 - DEBUG - Online update step: 17/50
2025-06-03 10:21:09,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:09,782 - DEBUG - Node anomaly scores shape: torch.Size([22516, 1])
2025-06-03 10:21:09,796 - DEBUG - Edge anomaly scores shape: torch.Size([47376, 1])
2025-06-03 10:21:09,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:10,516 - DEBUG - Step 17: Loss=0.5704
2025-06-03 10:21:10,516 - DEBUG - Online update step: 18/50
2025-06-03 10:21:10,519 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:11,134 - DEBUG - Node anomaly scores shape: torch.Size([22402, 1])
2025-06-03 10:21:11,149 - DEBUG - Edge anomaly scores shape: torch.Size([47220, 1])
2025-06-03 10:21:11,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:11,880 - DEBUG - Step 18: Loss=0.5708
2025-06-03 10:21:11,880 - DEBUG - Online update step: 19/50
2025-06-03 10:21:11,884 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:12,528 - DEBUG - Node anomaly scores shape: torch.Size([22786, 1])
2025-06-03 10:21:12,540 - DEBUG - Edge anomaly scores shape: torch.Size([47979, 1])
2025-06-03 10:21:12,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:13,210 - DEBUG - Step 19: Loss=0.5701
2025-06-03 10:21:13,210 - DEBUG - Online update step: 20/50
2025-06-03 10:21:13,213 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:13,850 - DEBUG - Node anomaly scores shape: torch.Size([23249, 1])
2025-06-03 10:21:13,864 - DEBUG - Edge anomaly scores shape: torch.Size([49124, 1])
2025-06-03 10:21:13,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:14,578 - DEBUG - Step 20: Loss=0.5702
2025-06-03 10:21:14,578 - DEBUG - Online update step: 21/50
2025-06-03 10:21:14,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:15,205 - DEBUG - Node anomaly scores shape: torch.Size([23554, 1])
2025-06-03 10:21:15,218 - DEBUG - Edge anomaly scores shape: torch.Size([49868, 1])
2025-06-03 10:21:15,219 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:15,910 - DEBUG - Step 21: Loss=0.5705
2025-06-03 10:21:15,910 - DEBUG - Online update step: 22/50
2025-06-03 10:21:15,913 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:16,577 - DEBUG - Node anomaly scores shape: torch.Size([23909, 1])
2025-06-03 10:21:16,589 - DEBUG - Edge anomaly scores shape: torch.Size([50693, 1])
2025-06-03 10:21:16,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:17,301 - DEBUG - Step 22: Loss=0.5703
2025-06-03 10:21:17,301 - DEBUG - Online update step: 23/50
2025-06-03 10:21:17,304 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:18,049 - DEBUG - Node anomaly scores shape: torch.Size([22463, 1])
2025-06-03 10:21:18,062 - DEBUG - Edge anomaly scores shape: torch.Size([47257, 1])
2025-06-03 10:21:18,063 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:19,893 - DEBUG - Step 23: Loss=0.5715
2025-06-03 10:21:19,894 - DEBUG - Online update step: 24/50
2025-06-03 10:21:19,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:20,797 - DEBUG - Node anomaly scores shape: torch.Size([23898, 1])
2025-06-03 10:21:20,811 - DEBUG - Edge anomaly scores shape: torch.Size([50734, 1])
2025-06-03 10:21:20,812 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:21,740 - DEBUG - Step 24: Loss=0.5705
2025-06-03 10:21:21,741 - DEBUG - Online update step: 25/50
2025-06-03 10:21:21,746 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:22,384 - DEBUG - Node anomaly scores shape: torch.Size([22824, 1])
2025-06-03 10:21:22,411 - DEBUG - Edge anomaly scores shape: torch.Size([48047, 1])
2025-06-03 10:21:22,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:23,807 - DEBUG - Step 25: Loss=0.5716
2025-06-03 10:21:23,807 - DEBUG - Online update step: 26/50
2025-06-03 10:21:23,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:24,524 - DEBUG - Node anomaly scores shape: torch.Size([23300, 1])
2025-06-03 10:21:24,536 - DEBUG - Edge anomaly scores shape: torch.Size([49208, 1])
2025-06-03 10:21:24,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:25,294 - DEBUG - Step 26: Loss=0.5698
2025-06-03 10:21:25,294 - DEBUG - Online update step: 27/50
2025-06-03 10:21:25,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:25,971 - DEBUG - Node anomaly scores shape: torch.Size([24188, 1])
2025-06-03 10:21:25,983 - DEBUG - Edge anomaly scores shape: torch.Size([51375, 1])
2025-06-03 10:21:25,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:26,737 - DEBUG - Step 27: Loss=0.5714
2025-06-03 10:21:26,737 - DEBUG - Online update step: 28/50
2025-06-03 10:21:26,740 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:27,388 - DEBUG - Node anomaly scores shape: torch.Size([23433, 1])
2025-06-03 10:21:27,402 - DEBUG - Edge anomaly scores shape: torch.Size([49591, 1])
2025-06-03 10:21:27,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:28,164 - DEBUG - Step 28: Loss=0.5717
2025-06-03 10:21:28,165 - DEBUG - Online update step: 29/50
2025-06-03 10:21:28,170 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:28,845 - DEBUG - Node anomaly scores shape: torch.Size([24311, 1])
2025-06-03 10:21:28,857 - DEBUG - Edge anomaly scores shape: torch.Size([51600, 1])
2025-06-03 10:21:28,858 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:29,578 - DEBUG - Step 29: Loss=0.5700
2025-06-03 10:21:29,578 - DEBUG - Online update step: 30/50
2025-06-03 10:21:29,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:30,766 - DEBUG - Node anomaly scores shape: torch.Size([22962, 1])
2025-06-03 10:21:30,780 - DEBUG - Edge anomaly scores shape: torch.Size([48473, 1])
2025-06-03 10:21:30,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:31,899 - DEBUG - Step 30: Loss=0.5721
2025-06-03 10:21:31,900 - DEBUG - Online update step: 31/50
2025-06-03 10:21:31,903 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:32,543 - DEBUG - Node anomaly scores shape: torch.Size([23450, 1])
2025-06-03 10:21:32,556 - DEBUG - Edge anomaly scores shape: torch.Size([49590, 1])
2025-06-03 10:21:32,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:33,362 - DEBUG - Step 31: Loss=0.5704
2025-06-03 10:21:33,362 - DEBUG - Online update step: 32/50
2025-06-03 10:21:33,365 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:33,965 - DEBUG - Node anomaly scores shape: torch.Size([22910, 1])
2025-06-03 10:21:33,977 - DEBUG - Edge anomaly scores shape: torch.Size([48384, 1])
2025-06-03 10:21:33,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:34,650 - DEBUG - Step 32: Loss=0.5708
2025-06-03 10:21:34,650 - DEBUG - Online update step: 33/50
2025-06-03 10:21:34,653 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:35,267 - DEBUG - Node anomaly scores shape: torch.Size([22372, 1])
2025-06-03 10:21:35,279 - DEBUG - Edge anomaly scores shape: torch.Size([47140, 1])
2025-06-03 10:21:35,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:35,938 - DEBUG - Step 33: Loss=0.5706
2025-06-03 10:21:35,938 - DEBUG - Online update step: 34/50
2025-06-03 10:21:35,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:36,571 - DEBUG - Node anomaly scores shape: torch.Size([23112, 1])
2025-06-03 10:21:36,583 - DEBUG - Edge anomaly scores shape: torch.Size([48813, 1])
2025-06-03 10:21:36,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:37,218 - DEBUG - Step 34: Loss=0.5716
2025-06-03 10:21:37,218 - DEBUG - Online update step: 35/50
2025-06-03 10:21:37,221 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:37,837 - DEBUG - Node anomaly scores shape: torch.Size([22808, 1])
2025-06-03 10:21:37,853 - DEBUG - Edge anomaly scores shape: torch.Size([48032, 1])
2025-06-03 10:21:37,854 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:38,534 - DEBUG - Step 35: Loss=0.5717
2025-06-03 10:21:38,535 - DEBUG - Online update step: 36/50
2025-06-03 10:21:38,538 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:39,213 - DEBUG - Node anomaly scores shape: torch.Size([23554, 1])
2025-06-03 10:21:39,226 - DEBUG - Edge anomaly scores shape: torch.Size([49853, 1])
2025-06-03 10:21:39,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:39,936 - DEBUG - Step 36: Loss=0.5715
2025-06-03 10:21:39,936 - DEBUG - Online update step: 37/50
2025-06-03 10:21:39,939 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:40,558 - DEBUG - Node anomaly scores shape: torch.Size([23401, 1])
2025-06-03 10:21:40,571 - DEBUG - Edge anomaly scores shape: torch.Size([49400, 1])
2025-06-03 10:21:40,572 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:41,299 - DEBUG - Step 37: Loss=0.5752
2025-06-03 10:21:41,299 - DEBUG - Online update step: 38/50
2025-06-03 10:21:41,302 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:41,899 - DEBUG - Node anomaly scores shape: torch.Size([23015, 1])
2025-06-03 10:21:41,912 - DEBUG - Edge anomaly scores shape: torch.Size([48566, 1])
2025-06-03 10:21:41,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:42,623 - DEBUG - Step 38: Loss=0.5716
2025-06-03 10:21:42,623 - DEBUG - Online update step: 39/50
2025-06-03 10:21:42,627 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:43,233 - DEBUG - Node anomaly scores shape: torch.Size([22029, 1])
2025-06-03 10:21:43,248 - DEBUG - Edge anomaly scores shape: torch.Size([46323, 1])
2025-06-03 10:21:43,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:44,076 - DEBUG - Step 39: Loss=0.5710
2025-06-03 10:21:44,076 - DEBUG - Online update step: 40/50
2025-06-03 10:21:44,081 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:44,760 - DEBUG - Node anomaly scores shape: torch.Size([23057, 1])
2025-06-03 10:21:44,772 - DEBUG - Edge anomaly scores shape: torch.Size([48567, 1])
2025-06-03 10:21:44,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:45,790 - DEBUG - Step 40: Loss=0.5731
2025-06-03 10:21:45,790 - DEBUG - Online update step: 41/50
2025-06-03 10:21:45,800 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:47,194 - DEBUG - Node anomaly scores shape: torch.Size([23715, 1])
2025-06-03 10:21:47,207 - DEBUG - Edge anomaly scores shape: torch.Size([50146, 1])
2025-06-03 10:21:47,209 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:47,986 - DEBUG - Step 41: Loss=0.5721
2025-06-03 10:21:47,986 - DEBUG - Online update step: 42/50
2025-06-03 10:21:47,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:48,647 - DEBUG - Node anomaly scores shape: torch.Size([23133, 1])
2025-06-03 10:21:48,661 - DEBUG - Edge anomaly scores shape: torch.Size([48748, 1])
2025-06-03 10:21:48,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:49,384 - DEBUG - Step 42: Loss=0.5763
2025-06-03 10:21:49,384 - DEBUG - Online update step: 43/50
2025-06-03 10:21:49,387 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:49,970 - DEBUG - Node anomaly scores shape: torch.Size([23179, 1])
2025-06-03 10:21:49,982 - DEBUG - Edge anomaly scores shape: torch.Size([48941, 1])
2025-06-03 10:21:49,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:51,029 - DEBUG - Step 43: Loss=0.5723
2025-06-03 10:21:51,029 - DEBUG - Online update step: 44/50
2025-06-03 10:21:51,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:51,753 - DEBUG - Node anomaly scores shape: torch.Size([23173, 1])
2025-06-03 10:21:51,766 - DEBUG - Edge anomaly scores shape: torch.Size([48875, 1])
2025-06-03 10:21:51,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:52,452 - DEBUG - Step 44: Loss=0.5737
2025-06-03 10:21:52,452 - DEBUG - Online update step: 45/50
2025-06-03 10:21:52,455 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:53,036 - DEBUG - Node anomaly scores shape: torch.Size([22441, 1])
2025-06-03 10:21:53,049 - DEBUG - Edge anomaly scores shape: torch.Size([47249, 1])
2025-06-03 10:21:53,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:53,767 - DEBUG - Step 45: Loss=0.5798
2025-06-03 10:21:53,767 - DEBUG - Online update step: 46/50
2025-06-03 10:21:53,771 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:54,475 - DEBUG - Node anomaly scores shape: torch.Size([22540, 1])
2025-06-03 10:21:54,493 - DEBUG - Edge anomaly scores shape: torch.Size([47486, 1])
2025-06-03 10:21:54,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:55,399 - DEBUG - Step 46: Loss=0.5725
2025-06-03 10:21:55,399 - DEBUG - Online update step: 47/50
2025-06-03 10:21:55,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:56,152 - DEBUG - Node anomaly scores shape: torch.Size([22951, 1])
2025-06-03 10:21:56,165 - DEBUG - Edge anomaly scores shape: torch.Size([48410, 1])
2025-06-03 10:21:56,167 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:57,030 - DEBUG - Step 47: Loss=0.5718
2025-06-03 10:21:57,030 - DEBUG - Online update step: 48/50
2025-06-03 10:21:57,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:21:58,858 - DEBUG - Node anomaly scores shape: torch.Size([24010, 1])
2025-06-03 10:21:58,870 - DEBUG - Edge anomaly scores shape: torch.Size([50842, 1])
2025-06-03 10:21:58,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:21:59,729 - DEBUG - Step 48: Loss=0.5827
2025-06-03 10:21:59,729 - DEBUG - Online update step: 49/50
2025-06-03 10:21:59,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:00,360 - DEBUG - Node anomaly scores shape: torch.Size([23493, 1])
2025-06-03 10:22:00,375 - DEBUG - Edge anomaly scores shape: torch.Size([49724, 1])
2025-06-03 10:22:00,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:01,114 - DEBUG - Step 49: Loss=0.5747
2025-06-03 10:22:01,115 - DEBUG - Online update step: 50/50
2025-06-03 10:22:01,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:01,751 - DEBUG - Node anomaly scores shape: torch.Size([22971, 1])
2025-06-03 10:22:01,763 - DEBUG - Edge anomaly scores shape: torch.Size([48388, 1])
2025-06-03 10:22:01,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:02,456 - DEBUG - Step 50: Loss=0.5869
2025-06-03 10:22:02,456 - INFO - Online update finished. Average loss: 0.5722, Learning rate: 0.001000
2025-06-03 10:22:02,457 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.3787863e-08 -4.2829686e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.9980779e-08
 -7.6141662e-09 -2.2961469e-08  3.0456665e-08 -9.5177077e-10
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  2.2961469e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -1.9392330e-08  3.6167290e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9035415e-08  1.4752447e-08], current edge mean: [ 9.1467514e+00  1.4257156e+00  5.7010450e+00  3.4663310e-09
  1.2998741e-09  4.3329138e-10  6.0660792e-09 -1.2998741e-09
 -4.3329138e-10 -1.7331655e-09]
2025-06-03 10:22:02,457 - DEBUG - Node drift difference: 0.0196, Edge drift difference: 0.0104
2025-06-03 10:22:02,458 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.3787863e-08 -4.2829686e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.9980779e-08
 -7.6141662e-09 -2.2961469e-08  3.0456665e-08 -9.5177077e-10
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  2.2961469e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -1.9392330e-08  3.6167290e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9035415e-08  1.4752447e-08], edge=[ 9.1467514e+00  1.4257156e+00  5.7010450e+00  3.4663310e-09
  1.2998741e-09  4.3329138e-10  6.0660792e-09 -1.2998741e-09
 -4.3329138e-10 -1.7331655e-09]
2025-06-03 10:22:02,458 - DEBUG - Updated reference std: node=[0.         0.         1.0004994  1.0004994  0.         0.
 0.         1.0004994  1.0004994  1.0004994  1.0004994  1.0004994
 0.93571764 0.27291828 0.3706852  0.573176   1.0004994  3.0238457
 2.9087992  1.4844369  0.3706852  0.2211384  1.0004994  1.0004994
 0.         0.         0.         0.         1.0004994  1.0004994 ], edge=[1.102394   0.50637054 2.133423   1.0002272  1.0002272  1.0002272
 1.0002272  1.0002272  1.0002272  1.0002272 ]
2025-06-03 10:22:02,463 - INFO - Online update complete. Loss: 0.5722
2025-06-03 10:22:02,463 - INFO - Running anomaly detection...
2025-06-03 10:22:02,464 - INFO - Starting anomaly detection.
2025-06-03 10:22:02,491 - DEBUG - Node reconstruction errors: [0.00167763 0.00306234 0.00313369 ... 0.00473742 0.00218922 0.00209347]
2025-06-03 10:22:02,492 - DEBUG - Edge reconstruction errors: [0.15517977 1.6571476  1.6581676  ... 0.15469325 1.252292   0.1547205 ]
2025-06-03 10:22:02,494 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102202_update_41.json
2025-06-03 10:22:02,494 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:22:02,512 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102202_update_41.pth and as latest_checkpoint.pth
2025-06-03 10:22:02,512 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.3499
2025-06-03 10:22:02,512 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 10:22:02,512 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.3345, MLP Score: 0.4981
2025-06-03 10:22:02,512 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1353, MLP Score: 0.4962
2025-06-03 10:22:02,512 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0440, MLP Score: 0.4999
2025-06-03 10:22:02,512 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0440, MLP Score: 0.4895
2025-06-03 10:22:02,512 - WARNING -   Node ID: 185.125.190.58, Recon Error: 0.0442, MLP Score: 0.5046
2025-06-03 10:22:02,513 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:22:02,513 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7215, MLP Score: 0.5028
2025-06-03 10:22:02,513 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3280, MLP Score: 0.5028
2025-06-03 10:22:02,513 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9123, MLP Score: 0.5017
2025-06-03 10:22:02,513 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3278, MLP Score: 0.5017
2025-06-03 10:22:02,513 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3366, MLP Score: 0.5023
2025-06-03 10:22:02,513 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:22:02,513 - INFO - Performing visualization of node and edge features.
2025-06-03 10:22:02,515 - INFO - Starting visualization of node features.
2025-06-03 10:22:02,515 - INFO - Graph has 1002 nodes and 30 features.
2025-06-03 10:22:02,515 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:22:02,515 - INFO - Calculating feature statistics:
2025-06-03 10:22:02,515 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,516 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,516 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(-3.0456665e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7219405), 'max': np.float32(2.4828484)}
2025-06-03 10:22:02,516 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(3.0456665e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.3828843), 'max': np.float32(1.8222367)}
2025-06-03 10:22:02,516 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,516 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,516 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,516 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.5228332e-08), 'std': np.float32(1.0), 'min': np.float32(-0.4568207), 'max': np.float32(2.1890426)}
2025-06-03 10:22:02,517 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-1.5228332e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1510109), 'max': np.float32(0.86880153)}
2025-06-03 10:22:02,517 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.5228332e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.431647), 'max': np.float32(0.10828342)}
2025-06-03 10:22:02,517 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.0456665e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683), 'max': np.float32(1.4947592)}
2025-06-03 10:22:02,517 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.4587957), 'max': np.float32(2.3851652)}
2025-06-03 10:22:02,517 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.263473), 'std': np.float32(0.93525064), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-03 10:22:02,517 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.962076), 'std': np.float32(0.27278206), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:22:02,517 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1497006), 'std': np.float32(0.37050018), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:22:02,517 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3922157), 'std': np.float32(0.57289), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:22:02,518 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.5228332e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10828342), 'max': np.float32(9.431647)}
2025-06-03 10:22:02,518 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.4391217), 'std': np.float32(3.0223362), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:22:02,518 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.773453), 'std': np.float32(2.9073474), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:22:02,518 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6127744), 'std': np.float32(1.4836959), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:22:02,518 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1497006), 'std': np.float32(0.37050018), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:22:02,518 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993014), 'std': np.float32(0.22102806), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:22:02,518 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-3.807083e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12750848), 'max': np.float32(16.537296)}
2025-06-03 10:22:02,518 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(3.0456665e-08), 'std': np.float32(1.0), 'min': np.float32(-0.13902728), 'max': np.float32(7.1928325)}
2025-06-03 10:22:02,519 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,519 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,519 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,519 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:22:02,519 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(1.5228332e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9910461), 'max': np.float32(10.423071)}
2025-06-03 10:22:02,519 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(7.614166e-09), 'std': np.float32(1.0), 'min': np.float32(-1.0946524), 'max': np.float32(4.444952)}
2025-06-03 10:22:02,538 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c26fe330>
2025-06-03 10:22:02,987 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:22:03,046 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:22:03,075 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:22:04,357 - INFO - Node feature visualization saved to vis/node_features_20250603_102203.png
2025-06-03 10:22:04,357 - INFO - Finished visualization of node features.
2025-06-03 10:22:04,357 - INFO - Performing additional feature analysis:
2025-06-03 10:22:04,357 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:22:04,359 - INFO - Starting visualization of edge features.
2025-06-03 10:22:04,359 - INFO - Graph has 2201 edges and 10 edge features.
2025-06-03 10:22:04,359 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:22:04,359 - INFO - Calculating edge feature statistics:
2025-06-03 10:22:04,359 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:22:04,359 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.146751), 'std': np.float32(1.1021434), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-03 10:22:04,359 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4257156), 'std': np.float32(0.5062555), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:22:04,359 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.701045), 'std': np.float32(2.1329384), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:22:04,360 - INFO - - service: {'name': 'service', 'unique': 39, 'mean': np.float32(-2.5997482e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.034792542), 'max': np.float32(33.148685)}
2025-06-03 10:22:04,360 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1479, 'mean': np.float32(-1.7331655e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059633393), 'max': np.float32(27.686676)}
2025-06-03 10:22:04,360 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1551, 'mean': np.float32(1.7331655e-09), 'std': np.float32(1.0), 'min': np.float32(-0.055754136), 'max': np.float32(30.756023)}
2025-06-03 10:22:04,360 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 513, 'mean': np.float32(3.466331e-09), 'std': np.float32(1.0), 'min': np.float32(-0.043352086), 'max': np.float32(33.02982)}
2025-06-03 10:22:04,360 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1524, 'mean': np.float32(-1.7331655e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08810365), 'max': np.float32(28.73232)}
2025-06-03 10:22:04,360 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1554, 'mean': np.float32(8.6658275e-10), 'std': np.float32(1.0), 'min': np.float32(-0.08785314), 'max': np.float32(27.610674)}
2025-06-03 10:22:04,360 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 567, 'mean': np.float32(-1.7331655e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0522428), 'max': np.float32(32.46071)}
2025-06-03 10:22:04,370 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c32a7b00>
2025-06-03 10:22:04,452 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:22:04,462 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c2662cf0>
2025-06-03 10:22:04,545 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:22:04,731 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:22:04,920 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:22:04,943 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:22:04,955 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:22:06,656 - INFO - Edge feature visualization saved to vis/edge_features_20250603_102205.png
2025-06-03 10:22:06,657 - INFO - Finished visualization of edge features.
2025-06-03 10:22:06,657 - INFO - Performing additional edge feature analysis:
2025-06-03 10:22:06,657 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:22:06,658 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:22:06,658 - INFO - Graph has 2201 edges and 10 edge features.
2025-06-03 10:22:06,658 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:22:06,947 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_102206_summary.png
2025-06-03 10:22:07,235 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_102206_pca_3d.png
2025-06-03 10:22:07,479 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_102206_pca_variance.png
2025-06-03 10:22:07,479 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:22:07,480 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-03 10:22:07,480 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-03 10:22:07,480 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-03 10:22:07,510 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-03 10:22:07,541 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-03 10:22:07,541 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-03 10:22:07,541 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-03 10:22:07,566 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-03 10:22:07,593 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-03 10:22:07,594 - INFO - Processing node updates/additions.
2025-06-03 10:22:07,600 - INFO - Processing edge updates/additions.
2025-06-03 10:22:07,614 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:22:07,616 - INFO - Finished updating NetworkX graph.
2025-06-03 10:22:07,616 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:22:07,617 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:22:07,633 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:22:07,635 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:22:07,635 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:22:07,638 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:22:07,639 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:22:07,648 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:22:07,650 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:22:07,651 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:22:07,653 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:22:07,654 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:22:07,654 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:22:07,655 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:22:07,655 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:22:07,660 - INFO - Performing online update...
2025-06-03 10:22:07,661 - INFO - Starting online update for 50 steps.
2025-06-03 10:22:07,663 - DEBUG - Updated RunningStats: new_mean=0.9504129627284243, new_var=24000000000161.348, new_n=2430
2025-06-03 10:22:07,663 - DEBUG - Updated RunningStats: new_mean=0.9478359609525907, new_var=24300000000018.367, new_n=2460
2025-06-03 10:22:07,664 - DEBUG - Updated RunningStats: new_mean=1.2164926336255188, new_var=8000000000093.4, new_n=810
2025-06-03 10:22:07,664 - DEBUG - Updated RunningStats: new_mean=1.214762808939509, new_var=8100000000001.689, new_n=820
2025-06-03 10:22:07,664 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:22:07,664 - DEBUG - Online update step: 1/50
2025-06-03 10:22:07,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:08,581 - DEBUG - Node anomaly scores shape: torch.Size([23801, 1])
2025-06-03 10:22:08,599 - DEBUG - Edge anomaly scores shape: torch.Size([50521, 1])
2025-06-03 10:22:08,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:09,596 - DEBUG - Step 1: Loss=0.5728
2025-06-03 10:22:09,596 - DEBUG - Online update step: 2/50
2025-06-03 10:22:09,599 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:10,298 - DEBUG - Node anomaly scores shape: torch.Size([23277, 1])
2025-06-03 10:22:10,311 - DEBUG - Edge anomaly scores shape: torch.Size([49221, 1])
2025-06-03 10:22:10,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:11,014 - DEBUG - Step 2: Loss=0.5933
2025-06-03 10:22:11,014 - DEBUG - Online update step: 3/50
2025-06-03 10:22:11,017 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:11,605 - DEBUG - Node anomaly scores shape: torch.Size([23158, 1])
2025-06-03 10:22:11,618 - DEBUG - Edge anomaly scores shape: torch.Size([48984, 1])
2025-06-03 10:22:11,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:12,314 - DEBUG - Step 3: Loss=0.5805
2025-06-03 10:22:12,314 - DEBUG - Online update step: 4/50
2025-06-03 10:22:12,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:12,938 - DEBUG - Node anomaly scores shape: torch.Size([23730, 1])
2025-06-03 10:22:12,951 - DEBUG - Edge anomaly scores shape: torch.Size([50318, 1])
2025-06-03 10:22:12,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:13,676 - DEBUG - Step 4: Loss=0.5934
2025-06-03 10:22:13,677 - DEBUG - Online update step: 5/50
2025-06-03 10:22:13,681 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:14,341 - DEBUG - Node anomaly scores shape: torch.Size([23400, 1])
2025-06-03 10:22:14,356 - DEBUG - Edge anomaly scores shape: torch.Size([49464, 1])
2025-06-03 10:22:14,358 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:15,073 - DEBUG - Step 5: Loss=0.5883
2025-06-03 10:22:15,073 - DEBUG - Online update step: 6/50
2025-06-03 10:22:15,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:15,710 - DEBUG - Node anomaly scores shape: torch.Size([23709, 1])
2025-06-03 10:22:15,722 - DEBUG - Edge anomaly scores shape: torch.Size([50207, 1])
2025-06-03 10:22:15,723 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:16,439 - DEBUG - Step 6: Loss=0.5827
2025-06-03 10:22:16,440 - DEBUG - Online update step: 7/50
2025-06-03 10:22:16,443 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:17,039 - DEBUG - Node anomaly scores shape: torch.Size([22317, 1])
2025-06-03 10:22:17,050 - DEBUG - Edge anomaly scores shape: torch.Size([46926, 1])
2025-06-03 10:22:17,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:17,721 - DEBUG - Step 7: Loss=0.5853
2025-06-03 10:22:17,721 - DEBUG - Online update step: 8/50
2025-06-03 10:22:17,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:18,349 - DEBUG - Node anomaly scores shape: torch.Size([23245, 1])
2025-06-03 10:22:18,360 - DEBUG - Edge anomaly scores shape: torch.Size([49107, 1])
2025-06-03 10:22:18,362 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:19,050 - DEBUG - Step 8: Loss=0.5764
2025-06-03 10:22:19,051 - DEBUG - Online update step: 9/50
2025-06-03 10:22:19,055 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:19,748 - DEBUG - Node anomaly scores shape: torch.Size([24060, 1])
2025-06-03 10:22:19,760 - DEBUG - Edge anomaly scores shape: torch.Size([51154, 1])
2025-06-03 10:22:19,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:20,467 - DEBUG - Step 9: Loss=0.5762
2025-06-03 10:22:20,467 - DEBUG - Online update step: 10/50
2025-06-03 10:22:20,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:21,081 - DEBUG - Node anomaly scores shape: torch.Size([23700, 1])
2025-06-03 10:22:21,092 - DEBUG - Edge anomaly scores shape: torch.Size([50217, 1])
2025-06-03 10:22:21,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:21,829 - DEBUG - Step 10: Loss=0.5842
2025-06-03 10:22:21,829 - DEBUG - Online update step: 11/50
2025-06-03 10:22:21,832 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:22,485 - DEBUG - Node anomaly scores shape: torch.Size([22733, 1])
2025-06-03 10:22:22,497 - DEBUG - Edge anomaly scores shape: torch.Size([47955, 1])
2025-06-03 10:22:22,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:23,183 - DEBUG - Step 11: Loss=0.5787
2025-06-03 10:22:23,183 - DEBUG - Online update step: 12/50
2025-06-03 10:22:23,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:23,828 - DEBUG - Node anomaly scores shape: torch.Size([23589, 1])
2025-06-03 10:22:23,840 - DEBUG - Edge anomaly scores shape: torch.Size([49835, 1])
2025-06-03 10:22:23,841 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:24,504 - DEBUG - Step 12: Loss=0.5836
2025-06-03 10:22:24,504 - DEBUG - Online update step: 13/50
2025-06-03 10:22:24,507 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:25,115 - DEBUG - Node anomaly scores shape: torch.Size([22659, 1])
2025-06-03 10:22:25,126 - DEBUG - Edge anomaly scores shape: torch.Size([47770, 1])
2025-06-03 10:22:25,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:25,782 - DEBUG - Step 13: Loss=0.5809
2025-06-03 10:22:25,782 - DEBUG - Online update step: 14/50
2025-06-03 10:22:25,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:26,412 - DEBUG - Node anomaly scores shape: torch.Size([23759, 1])
2025-06-03 10:22:26,424 - DEBUG - Edge anomaly scores shape: torch.Size([50255, 1])
2025-06-03 10:22:26,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:27,109 - DEBUG - Step 14: Loss=0.5833
2025-06-03 10:22:27,109 - DEBUG - Online update step: 15/50
2025-06-03 10:22:27,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:27,762 - DEBUG - Node anomaly scores shape: torch.Size([24316, 1])
2025-06-03 10:22:27,775 - DEBUG - Edge anomaly scores shape: torch.Size([51535, 1])
2025-06-03 10:22:27,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:28,471 - DEBUG - Step 15: Loss=0.5815
2025-06-03 10:22:28,471 - DEBUG - Online update step: 16/50
2025-06-03 10:22:28,474 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:29,130 - DEBUG - Node anomaly scores shape: torch.Size([22924, 1])
2025-06-03 10:22:29,141 - DEBUG - Edge anomaly scores shape: torch.Size([48402, 1])
2025-06-03 10:22:29,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:29,820 - DEBUG - Step 16: Loss=0.5814
2025-06-03 10:22:29,820 - DEBUG - Online update step: 17/50
2025-06-03 10:22:29,823 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:30,427 - DEBUG - Node anomaly scores shape: torch.Size([22391, 1])
2025-06-03 10:22:30,439 - DEBUG - Edge anomaly scores shape: torch.Size([47146, 1])
2025-06-03 10:22:30,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:31,136 - DEBUG - Step 17: Loss=0.5834
2025-06-03 10:22:31,136 - DEBUG - Online update step: 18/50
2025-06-03 10:22:31,139 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:31,753 - DEBUG - Node anomaly scores shape: torch.Size([23287, 1])
2025-06-03 10:22:31,765 - DEBUG - Edge anomaly scores shape: torch.Size([49134, 1])
2025-06-03 10:22:31,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:32,407 - DEBUG - Step 18: Loss=0.5755
2025-06-03 10:22:32,408 - DEBUG - Online update step: 19/50
2025-06-03 10:22:32,411 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:33,016 - DEBUG - Node anomaly scores shape: torch.Size([22432, 1])
2025-06-03 10:22:33,027 - DEBUG - Edge anomaly scores shape: torch.Size([47200, 1])
2025-06-03 10:22:33,028 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:33,705 - DEBUG - Step 19: Loss=0.5732
2025-06-03 10:22:33,705 - DEBUG - Online update step: 20/50
2025-06-03 10:22:33,708 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:34,434 - DEBUG - Node anomaly scores shape: torch.Size([23829, 1])
2025-06-03 10:22:34,446 - DEBUG - Edge anomaly scores shape: torch.Size([50405, 1])
2025-06-03 10:22:34,447 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:35,151 - DEBUG - Step 20: Loss=0.5764
2025-06-03 10:22:35,151 - DEBUG - Online update step: 21/50
2025-06-03 10:22:35,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:35,893 - DEBUG - Node anomaly scores shape: torch.Size([23399, 1])
2025-06-03 10:22:35,905 - DEBUG - Edge anomaly scores shape: torch.Size([49513, 1])
2025-06-03 10:22:35,906 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:36,543 - DEBUG - Step 21: Loss=0.5706
2025-06-03 10:22:36,543 - DEBUG - Online update step: 22/50
2025-06-03 10:22:36,546 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:37,205 - DEBUG - Node anomaly scores shape: torch.Size([23178, 1])
2025-06-03 10:22:37,222 - DEBUG - Edge anomaly scores shape: torch.Size([48945, 1])
2025-06-03 10:22:37,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:38,025 - DEBUG - Step 22: Loss=0.5798
2025-06-03 10:22:38,025 - DEBUG - Online update step: 23/50
2025-06-03 10:22:38,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:38,670 - DEBUG - Node anomaly scores shape: torch.Size([23755, 1])
2025-06-03 10:22:38,682 - DEBUG - Edge anomaly scores shape: torch.Size([50298, 1])
2025-06-03 10:22:38,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:39,334 - DEBUG - Step 23: Loss=0.5706
2025-06-03 10:22:39,334 - DEBUG - Online update step: 24/50
2025-06-03 10:22:39,337 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:39,949 - DEBUG - Node anomaly scores shape: torch.Size([22821, 1])
2025-06-03 10:22:39,961 - DEBUG - Edge anomaly scores shape: torch.Size([48065, 1])
2025-06-03 10:22:39,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:40,636 - DEBUG - Step 24: Loss=0.5824
2025-06-03 10:22:40,636 - DEBUG - Online update step: 25/50
2025-06-03 10:22:40,639 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:41,327 - DEBUG - Node anomaly scores shape: torch.Size([23531, 1])
2025-06-03 10:22:41,339 - DEBUG - Edge anomaly scores shape: torch.Size([49912, 1])
2025-06-03 10:22:41,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:42,072 - DEBUG - Step 25: Loss=0.5749
2025-06-03 10:22:42,073 - DEBUG - Online update step: 26/50
2025-06-03 10:22:42,076 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:42,751 - DEBUG - Node anomaly scores shape: torch.Size([22213, 1])
2025-06-03 10:22:42,768 - DEBUG - Edge anomaly scores shape: torch.Size([46672, 1])
2025-06-03 10:22:42,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:43,519 - DEBUG - Step 26: Loss=0.5822
2025-06-03 10:22:43,519 - DEBUG - Online update step: 27/50
2025-06-03 10:22:43,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:44,173 - DEBUG - Node anomaly scores shape: torch.Size([22154, 1])
2025-06-03 10:22:44,184 - DEBUG - Edge anomaly scores shape: torch.Size([46635, 1])
2025-06-03 10:22:44,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:44,964 - DEBUG - Step 27: Loss=0.5751
2025-06-03 10:22:44,964 - DEBUG - Online update step: 28/50
2025-06-03 10:22:44,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:45,698 - DEBUG - Node anomaly scores shape: torch.Size([23275, 1])
2025-06-03 10:22:45,714 - DEBUG - Edge anomaly scores shape: torch.Size([49211, 1])
2025-06-03 10:22:45,716 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:46,525 - DEBUG - Step 28: Loss=0.5812
2025-06-03 10:22:46,525 - DEBUG - Online update step: 29/50
2025-06-03 10:22:46,529 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:47,207 - DEBUG - Node anomaly scores shape: torch.Size([22866, 1])
2025-06-03 10:22:47,219 - DEBUG - Edge anomaly scores shape: torch.Size([48201, 1])
2025-06-03 10:22:47,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:47,965 - DEBUG - Step 29: Loss=0.5780
2025-06-03 10:22:47,965 - DEBUG - Online update step: 30/50
2025-06-03 10:22:47,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:48,677 - DEBUG - Node anomaly scores shape: torch.Size([22196, 1])
2025-06-03 10:22:48,688 - DEBUG - Edge anomaly scores shape: torch.Size([46696, 1])
2025-06-03 10:22:48,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:49,557 - DEBUG - Step 30: Loss=0.5800
2025-06-03 10:22:49,557 - DEBUG - Online update step: 31/50
2025-06-03 10:22:49,563 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:50,837 - DEBUG - Node anomaly scores shape: torch.Size([24188, 1])
2025-06-03 10:22:50,851 - DEBUG - Edge anomaly scores shape: torch.Size([51330, 1])
2025-06-03 10:22:50,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:51,653 - DEBUG - Step 31: Loss=0.5823
2025-06-03 10:22:51,653 - DEBUG - Online update step: 32/50
2025-06-03 10:22:51,656 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:52,336 - DEBUG - Node anomaly scores shape: torch.Size([23602, 1])
2025-06-03 10:22:52,353 - DEBUG - Edge anomaly scores shape: torch.Size([49972, 1])
2025-06-03 10:22:52,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:53,093 - DEBUG - Step 32: Loss=0.5740
2025-06-03 10:22:53,093 - DEBUG - Online update step: 33/50
2025-06-03 10:22:53,097 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:53,872 - DEBUG - Node anomaly scores shape: torch.Size([23830, 1])
2025-06-03 10:22:53,890 - DEBUG - Edge anomaly scores shape: torch.Size([50327, 1])
2025-06-03 10:22:53,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:54,713 - DEBUG - Step 33: Loss=0.5734
2025-06-03 10:22:54,714 - DEBUG - Online update step: 34/50
2025-06-03 10:22:54,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:55,352 - DEBUG - Node anomaly scores shape: torch.Size([22019, 1])
2025-06-03 10:22:55,364 - DEBUG - Edge anomaly scores shape: torch.Size([46296, 1])
2025-06-03 10:22:55,365 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:56,140 - DEBUG - Step 34: Loss=0.5750
2025-06-03 10:22:56,140 - DEBUG - Online update step: 35/50
2025-06-03 10:22:56,145 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:56,846 - DEBUG - Node anomaly scores shape: torch.Size([22816, 1])
2025-06-03 10:22:56,858 - DEBUG - Edge anomaly scores shape: torch.Size([48102, 1])
2025-06-03 10:22:56,859 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:57,620 - DEBUG - Step 35: Loss=0.5703
2025-06-03 10:22:57,620 - DEBUG - Online update step: 36/50
2025-06-03 10:22:57,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:58,437 - DEBUG - Node anomaly scores shape: torch.Size([23654, 1])
2025-06-03 10:22:58,453 - DEBUG - Edge anomaly scores shape: torch.Size([50113, 1])
2025-06-03 10:22:58,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:22:59,144 - DEBUG - Step 36: Loss=0.5756
2025-06-03 10:22:59,145 - DEBUG - Online update step: 37/50
2025-06-03 10:22:59,148 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:22:59,817 - DEBUG - Node anomaly scores shape: torch.Size([22213, 1])
2025-06-03 10:22:59,831 - DEBUG - Edge anomaly scores shape: torch.Size([46717, 1])
2025-06-03 10:22:59,833 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:00,661 - DEBUG - Step 37: Loss=0.5694
2025-06-03 10:23:00,661 - DEBUG - Online update step: 38/50
2025-06-03 10:23:00,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:01,313 - DEBUG - Node anomaly scores shape: torch.Size([22422, 1])
2025-06-03 10:23:01,324 - DEBUG - Edge anomaly scores shape: torch.Size([47274, 1])
2025-06-03 10:23:01,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:02,048 - DEBUG - Step 38: Loss=0.5750
2025-06-03 10:23:02,048 - DEBUG - Online update step: 39/50
2025-06-03 10:23:02,051 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:02,756 - DEBUG - Node anomaly scores shape: torch.Size([24415, 1])
2025-06-03 10:23:02,768 - DEBUG - Edge anomaly scores shape: torch.Size([51821, 1])
2025-06-03 10:23:02,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:03,520 - DEBUG - Step 39: Loss=0.5692
2025-06-03 10:23:03,520 - DEBUG - Online update step: 40/50
2025-06-03 10:23:03,525 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:04,126 - DEBUG - Node anomaly scores shape: torch.Size([22778, 1])
2025-06-03 10:23:04,137 - DEBUG - Edge anomaly scores shape: torch.Size([48092, 1])
2025-06-03 10:23:04,138 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:04,813 - DEBUG - Step 40: Loss=0.5743
2025-06-03 10:23:04,813 - DEBUG - Online update step: 41/50
2025-06-03 10:23:04,817 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:05,523 - DEBUG - Node anomaly scores shape: torch.Size([24023, 1])
2025-06-03 10:23:05,535 - DEBUG - Edge anomaly scores shape: torch.Size([50833, 1])
2025-06-03 10:23:05,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:06,278 - DEBUG - Step 41: Loss=0.5707
2025-06-03 10:23:06,278 - DEBUG - Online update step: 42/50
2025-06-03 10:23:06,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:06,907 - DEBUG - Node anomaly scores shape: torch.Size([23078, 1])
2025-06-03 10:23:06,921 - DEBUG - Edge anomaly scores shape: torch.Size([48746, 1])
2025-06-03 10:23:06,922 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:07,634 - DEBUG - Step 42: Loss=0.5728
2025-06-03 10:23:07,635 - DEBUG - Online update step: 43/50
2025-06-03 10:23:07,638 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:08,292 - DEBUG - Node anomaly scores shape: torch.Size([23886, 1])
2025-06-03 10:23:08,304 - DEBUG - Edge anomaly scores shape: torch.Size([50719, 1])
2025-06-03 10:23:08,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:09,064 - DEBUG - Step 43: Loss=0.5721
2025-06-03 10:23:09,064 - DEBUG - Online update step: 44/50
2025-06-03 10:23:09,068 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:09,752 - DEBUG - Node anomaly scores shape: torch.Size([22155, 1])
2025-06-03 10:23:09,763 - DEBUG - Edge anomaly scores shape: torch.Size([46545, 1])
2025-06-03 10:23:09,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:10,492 - DEBUG - Step 44: Loss=0.5707
2025-06-03 10:23:10,492 - DEBUG - Online update step: 45/50
2025-06-03 10:23:10,498 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:11,174 - DEBUG - Node anomaly scores shape: torch.Size([24352, 1])
2025-06-03 10:23:11,186 - DEBUG - Edge anomaly scores shape: torch.Size([51695, 1])
2025-06-03 10:23:11,187 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:11,919 - DEBUG - Step 45: Loss=0.5752
2025-06-03 10:23:11,919 - DEBUG - Online update step: 46/50
2025-06-03 10:23:11,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:12,677 - DEBUG - Node anomaly scores shape: torch.Size([24644, 1])
2025-06-03 10:23:12,689 - DEBUG - Edge anomaly scores shape: torch.Size([52363, 1])
2025-06-03 10:23:12,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:13,393 - DEBUG - Step 46: Loss=0.5711
2025-06-03 10:23:13,393 - DEBUG - Online update step: 47/50
2025-06-03 10:23:13,396 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:14,034 - DEBUG - Node anomaly scores shape: torch.Size([23997, 1])
2025-06-03 10:23:14,048 - DEBUG - Edge anomaly scores shape: torch.Size([50870, 1])
2025-06-03 10:23:14,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:14,786 - DEBUG - Step 47: Loss=0.5766
2025-06-03 10:23:14,786 - DEBUG - Online update step: 48/50
2025-06-03 10:23:14,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:15,400 - DEBUG - Node anomaly scores shape: torch.Size([22175, 1])
2025-06-03 10:23:15,412 - DEBUG - Edge anomaly scores shape: torch.Size([46594, 1])
2025-06-03 10:23:15,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:16,104 - DEBUG - Step 48: Loss=0.5713
2025-06-03 10:23:16,104 - DEBUG - Online update step: 49/50
2025-06-03 10:23:16,107 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:16,736 - DEBUG - Node anomaly scores shape: torch.Size([22874, 1])
2025-06-03 10:23:16,748 - DEBUG - Edge anomaly scores shape: torch.Size([48303, 1])
2025-06-03 10:23:16,749 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:17,409 - DEBUG - Step 49: Loss=0.5750
2025-06-03 10:23:17,409 - DEBUG - Online update step: 50/50
2025-06-03 10:23:17,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:18,034 - DEBUG - Node anomaly scores shape: torch.Size([23376, 1])
2025-06-03 10:23:18,045 - DEBUG - Edge anomaly scores shape: torch.Size([49451, 1])
2025-06-03 10:23:18,047 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:18,731 - DEBUG - Step 50: Loss=0.5705
2025-06-03 10:23:18,731 - INFO - Online update finished. Average loss: 0.5774, Learning rate: 0.001000
2025-06-03 10:23:18,733 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:23:18,733 - DEBUG - Node drift difference: 0.0040, Edge drift difference: 0.0012
2025-06-03 10:23:18,734 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:23:18,735 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-03 10:23:18,735 - INFO - Online update complete. Loss: 0.5774
2025-06-03 10:23:18,735 - INFO - Running anomaly detection...
2025-06-03 10:23:18,735 - INFO - Starting anomaly detection.
2025-06-03 10:23:18,752 - DEBUG - Node reconstruction errors: [0.00571144 0.00762268 0.00679857 ... 0.00745094 0.0066843  0.00981776]
2025-06-03 10:23:18,752 - DEBUG - Edge reconstruction errors: [0.15485086 1.6570665  1.6580344  ... 0.1543631  1.2518464  0.15437385]
2025-06-03 10:23:18,754 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102318_update_42.json
2025-06-03 10:23:18,754 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:23:18,771 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102318_update_42.pth and as latest_checkpoint.pth
2025-06-03 10:23:18,772 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.3463
2025-06-03 10:23:18,772 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-03 10:23:18,772 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0381, MLP Score: 0.4963
2025-06-03 10:23:18,772 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2616, MLP Score: 0.4930
2025-06-03 10:23:18,772 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1208, MLP Score: 0.4896
2025-06-03 10:23:18,772 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0813, MLP Score: 0.4950
2025-06-03 10:23:18,772 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0515, MLP Score: 0.4954
2025-06-03 10:23:18,772 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:23:18,772 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7222, MLP Score: 0.5006
2025-06-03 10:23:18,772 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3283, MLP Score: 0.5005
2025-06-03 10:23:18,772 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9127, MLP Score: 0.4995
2025-06-03 10:23:18,773 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3293, MLP Score: 0.5004
2025-06-03 10:23:18,773 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3379, MLP Score: 0.5006
2025-06-03 10:23:18,773 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-03 10:23:18,773 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-03 10:23:18,773 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-03 10:23:18,805 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-03 10:23:18,832 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-03 10:23:18,833 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-03 10:23:18,833 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-03 10:23:18,855 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-03 10:23:18,880 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-03 10:23:18,880 - INFO - Processing node updates/additions.
2025-06-03 10:23:18,885 - INFO - Processing edge updates/additions.
2025-06-03 10:23:18,897 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:23:18,898 - INFO - Finished updating NetworkX graph.
2025-06-03 10:23:18,898 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:23:18,899 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:23:18,908 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:23:18,909 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:23:18,910 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:23:18,911 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:23:18,912 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:23:18,916 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:23:18,918 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:23:18,919 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:23:18,920 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:23:18,921 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:23:18,921 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:23:18,921 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:23:18,921 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:23:18,924 - INFO - Performing online update...
2025-06-03 10:23:18,924 - INFO - Starting online update for 50 steps.
2025-06-03 10:23:18,925 - DEBUG - Updated RunningStats: new_mean=0.9503675692529752, new_var=24600000000161.348, new_n=2490
2025-06-03 10:23:18,925 - DEBUG - Updated RunningStats: new_mean=0.9478524650607976, new_var=24900000000018.367, new_n=2520
2025-06-03 10:23:18,925 - DEBUG - Updated RunningStats: new_mean=1.2197303204622143, new_var=8200000000093.373, new_n=830
2025-06-03 10:23:18,925 - DEBUG - Updated RunningStats: new_mean=1.2180031381873393, new_var=8300000000001.698, new_n=840
2025-06-03 10:23:18,925 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:23:18,925 - DEBUG - Online update step: 1/50
2025-06-03 10:23:18,927 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:19,642 - DEBUG - Node anomaly scores shape: torch.Size([24435, 1])
2025-06-03 10:23:19,659 - DEBUG - Edge anomaly scores shape: torch.Size([51955, 1])
2025-06-03 10:23:19,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:20,468 - DEBUG - Step 1: Loss=0.5750
2025-06-03 10:23:20,469 - DEBUG - Online update step: 2/50
2025-06-03 10:23:20,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:21,140 - DEBUG - Node anomaly scores shape: torch.Size([23584, 1])
2025-06-03 10:23:21,152 - DEBUG - Edge anomaly scores shape: torch.Size([49926, 1])
2025-06-03 10:23:21,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:21,908 - DEBUG - Step 2: Loss=0.5692
2025-06-03 10:23:21,909 - DEBUG - Online update step: 3/50
2025-06-03 10:23:21,913 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:22,576 - DEBUG - Node anomaly scores shape: torch.Size([24354, 1])
2025-06-03 10:23:22,588 - DEBUG - Edge anomaly scores shape: torch.Size([51690, 1])
2025-06-03 10:23:22,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:23,267 - DEBUG - Step 3: Loss=0.5739
2025-06-03 10:23:23,267 - DEBUG - Online update step: 4/50
2025-06-03 10:23:23,270 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:23,921 - DEBUG - Node anomaly scores shape: torch.Size([23610, 1])
2025-06-03 10:23:23,935 - DEBUG - Edge anomaly scores shape: torch.Size([49887, 1])
2025-06-03 10:23:23,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:24,668 - DEBUG - Step 4: Loss=0.5703
2025-06-03 10:23:24,668 - DEBUG - Online update step: 5/50
2025-06-03 10:23:24,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:25,293 - DEBUG - Node anomaly scores shape: torch.Size([23179, 1])
2025-06-03 10:23:25,304 - DEBUG - Edge anomaly scores shape: torch.Size([49006, 1])
2025-06-03 10:23:25,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:26,036 - DEBUG - Step 5: Loss=0.5719
2025-06-03 10:23:26,037 - DEBUG - Online update step: 6/50
2025-06-03 10:23:26,042 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:26,682 - DEBUG - Node anomaly scores shape: torch.Size([22299, 1])
2025-06-03 10:23:26,693 - DEBUG - Edge anomaly scores shape: torch.Size([46914, 1])
2025-06-03 10:23:26,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:27,398 - DEBUG - Step 6: Loss=0.5707
2025-06-03 10:23:27,398 - DEBUG - Online update step: 7/50
2025-06-03 10:23:27,401 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:28,045 - DEBUG - Node anomaly scores shape: torch.Size([22722, 1])
2025-06-03 10:23:28,056 - DEBUG - Edge anomaly scores shape: torch.Size([47843, 1])
2025-06-03 10:23:28,057 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:28,753 - DEBUG - Step 7: Loss=0.5701
2025-06-03 10:23:28,753 - DEBUG - Online update step: 8/50
2025-06-03 10:23:28,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:29,426 - DEBUG - Node anomaly scores shape: torch.Size([23628, 1])
2025-06-03 10:23:29,438 - DEBUG - Edge anomaly scores shape: torch.Size([50044, 1])
2025-06-03 10:23:29,440 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:30,233 - DEBUG - Step 8: Loss=0.5716
2025-06-03 10:23:30,233 - DEBUG - Online update step: 9/50
2025-06-03 10:23:30,237 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:31,052 - DEBUG - Node anomaly scores shape: torch.Size([23044, 1])
2025-06-03 10:23:31,069 - DEBUG - Edge anomaly scores shape: torch.Size([48539, 1])
2025-06-03 10:23:31,072 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:32,051 - DEBUG - Step 9: Loss=0.5694
2025-06-03 10:23:32,051 - DEBUG - Online update step: 10/50
2025-06-03 10:23:32,055 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:32,850 - DEBUG - Node anomaly scores shape: torch.Size([23760, 1])
2025-06-03 10:23:32,865 - DEBUG - Edge anomaly scores shape: torch.Size([50391, 1])
2025-06-03 10:23:32,867 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:33,800 - DEBUG - Step 10: Loss=0.5715
2025-06-03 10:23:33,800 - DEBUG - Online update step: 11/50
2025-06-03 10:23:33,803 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:34,632 - DEBUG - Node anomaly scores shape: torch.Size([23003, 1])
2025-06-03 10:23:34,650 - DEBUG - Edge anomaly scores shape: torch.Size([48583, 1])
2025-06-03 10:23:34,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:35,583 - DEBUG - Step 11: Loss=0.5699
2025-06-03 10:23:35,583 - DEBUG - Online update step: 12/50
2025-06-03 10:23:35,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:36,385 - DEBUG - Node anomaly scores shape: torch.Size([22604, 1])
2025-06-03 10:23:36,396 - DEBUG - Edge anomaly scores shape: torch.Size([47737, 1])
2025-06-03 10:23:36,397 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:37,205 - DEBUG - Step 12: Loss=0.5706
2025-06-03 10:23:37,205 - DEBUG - Online update step: 13/50
2025-06-03 10:23:37,208 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:37,937 - DEBUG - Node anomaly scores shape: torch.Size([23280, 1])
2025-06-03 10:23:37,955 - DEBUG - Edge anomaly scores shape: torch.Size([49291, 1])
2025-06-03 10:23:37,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:38,983 - DEBUG - Step 13: Loss=0.5702
2025-06-03 10:23:38,983 - DEBUG - Online update step: 14/50
2025-06-03 10:23:38,987 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:39,874 - DEBUG - Node anomaly scores shape: torch.Size([23564, 1])
2025-06-03 10:23:39,893 - DEBUG - Edge anomaly scores shape: torch.Size([49702, 1])
2025-06-03 10:23:39,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:40,918 - DEBUG - Step 14: Loss=0.5688
2025-06-03 10:23:40,919 - DEBUG - Online update step: 15/50
2025-06-03 10:23:40,922 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:41,765 - DEBUG - Node anomaly scores shape: torch.Size([22753, 1])
2025-06-03 10:23:41,780 - DEBUG - Edge anomaly scores shape: torch.Size([48057, 1])
2025-06-03 10:23:41,782 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:42,718 - DEBUG - Step 15: Loss=0.5712
2025-06-03 10:23:42,719 - DEBUG - Online update step: 16/50
2025-06-03 10:23:42,727 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:43,562 - DEBUG - Node anomaly scores shape: torch.Size([24028, 1])
2025-06-03 10:23:43,576 - DEBUG - Edge anomaly scores shape: torch.Size([51042, 1])
2025-06-03 10:23:43,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:44,565 - DEBUG - Step 16: Loss=0.5692
2025-06-03 10:23:44,566 - DEBUG - Online update step: 17/50
2025-06-03 10:23:44,571 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:45,415 - DEBUG - Node anomaly scores shape: torch.Size([23035, 1])
2025-06-03 10:23:45,430 - DEBUG - Edge anomaly scores shape: torch.Size([48685, 1])
2025-06-03 10:23:45,433 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:46,312 - DEBUG - Step 17: Loss=0.5706
2025-06-03 10:23:46,312 - DEBUG - Online update step: 18/50
2025-06-03 10:23:46,315 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:46,974 - DEBUG - Node anomaly scores shape: torch.Size([23812, 1])
2025-06-03 10:23:46,987 - DEBUG - Edge anomaly scores shape: torch.Size([50477, 1])
2025-06-03 10:23:46,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:47,707 - DEBUG - Step 18: Loss=0.5698
2025-06-03 10:23:47,707 - DEBUG - Online update step: 19/50
2025-06-03 10:23:47,710 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:48,333 - DEBUG - Node anomaly scores shape: torch.Size([23918, 1])
2025-06-03 10:23:48,345 - DEBUG - Edge anomaly scores shape: torch.Size([50686, 1])
2025-06-03 10:23:48,347 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:49,054 - DEBUG - Step 19: Loss=0.5698
2025-06-03 10:23:49,055 - DEBUG - Online update step: 20/50
2025-06-03 10:23:49,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:49,643 - DEBUG - Node anomaly scores shape: torch.Size([22764, 1])
2025-06-03 10:23:49,655 - DEBUG - Edge anomaly scores shape: torch.Size([47977, 1])
2025-06-03 10:23:49,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:50,328 - DEBUG - Step 20: Loss=0.5702
2025-06-03 10:23:50,329 - DEBUG - Online update step: 21/50
2025-06-03 10:23:50,332 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:50,933 - DEBUG - Node anomaly scores shape: torch.Size([22715, 1])
2025-06-03 10:23:50,946 - DEBUG - Edge anomaly scores shape: torch.Size([47983, 1])
2025-06-03 10:23:50,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:51,610 - DEBUG - Step 21: Loss=0.5705
2025-06-03 10:23:51,610 - DEBUG - Online update step: 22/50
2025-06-03 10:23:51,613 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:52,203 - DEBUG - Node anomaly scores shape: torch.Size([22517, 1])
2025-06-03 10:23:52,215 - DEBUG - Edge anomaly scores shape: torch.Size([47343, 1])
2025-06-03 10:23:52,216 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:52,868 - DEBUG - Step 22: Loss=0.5706
2025-06-03 10:23:52,868 - DEBUG - Online update step: 23/50
2025-06-03 10:23:52,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:53,447 - DEBUG - Node anomaly scores shape: torch.Size([22506, 1])
2025-06-03 10:23:53,458 - DEBUG - Edge anomaly scores shape: torch.Size([47335, 1])
2025-06-03 10:23:53,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:54,130 - DEBUG - Step 23: Loss=0.5695
2025-06-03 10:23:54,130 - DEBUG - Online update step: 24/50
2025-06-03 10:23:54,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:54,781 - DEBUG - Node anomaly scores shape: torch.Size([24146, 1])
2025-06-03 10:23:54,793 - DEBUG - Edge anomaly scores shape: torch.Size([51169, 1])
2025-06-03 10:23:54,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:55,628 - DEBUG - Step 24: Loss=0.5693
2025-06-03 10:23:55,628 - DEBUG - Online update step: 25/50
2025-06-03 10:23:55,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:56,309 - DEBUG - Node anomaly scores shape: torch.Size([23638, 1])
2025-06-03 10:23:56,324 - DEBUG - Edge anomaly scores shape: torch.Size([50117, 1])
2025-06-03 10:23:56,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:57,102 - DEBUG - Step 25: Loss=0.5691
2025-06-03 10:23:57,102 - DEBUG - Online update step: 26/50
2025-06-03 10:23:57,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:57,746 - DEBUG - Node anomaly scores shape: torch.Size([23576, 1])
2025-06-03 10:23:57,763 - DEBUG - Edge anomaly scores shape: torch.Size([49975, 1])
2025-06-03 10:23:57,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:58,599 - DEBUG - Step 26: Loss=0.5688
2025-06-03 10:23:58,600 - DEBUG - Online update step: 27/50
2025-06-03 10:23:58,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:23:59,210 - DEBUG - Node anomaly scores shape: torch.Size([22694, 1])
2025-06-03 10:23:59,222 - DEBUG - Edge anomaly scores shape: torch.Size([47888, 1])
2025-06-03 10:23:59,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:23:59,871 - DEBUG - Step 27: Loss=0.5694
2025-06-03 10:23:59,871 - DEBUG - Online update step: 28/50
2025-06-03 10:23:59,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:00,520 - DEBUG - Node anomaly scores shape: torch.Size([24642, 1])
2025-06-03 10:24:00,532 - DEBUG - Edge anomaly scores shape: torch.Size([52506, 1])
2025-06-03 10:24:00,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:01,291 - DEBUG - Step 28: Loss=0.5688
2025-06-03 10:24:01,291 - DEBUG - Online update step: 29/50
2025-06-03 10:24:01,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:01,914 - DEBUG - Node anomaly scores shape: torch.Size([23494, 1])
2025-06-03 10:24:01,926 - DEBUG - Edge anomaly scores shape: torch.Size([49668, 1])
2025-06-03 10:24:01,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:02,613 - DEBUG - Step 29: Loss=0.5696
2025-06-03 10:24:02,613 - DEBUG - Online update step: 30/50
2025-06-03 10:24:02,616 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:03,226 - DEBUG - Node anomaly scores shape: torch.Size([23551, 1])
2025-06-03 10:24:03,238 - DEBUG - Edge anomaly scores shape: torch.Size([49701, 1])
2025-06-03 10:24:03,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:03,944 - DEBUG - Step 30: Loss=0.5689
2025-06-03 10:24:03,945 - DEBUG - Online update step: 31/50
2025-06-03 10:24:03,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:04,620 - DEBUG - Node anomaly scores shape: torch.Size([23664, 1])
2025-06-03 10:24:04,636 - DEBUG - Edge anomaly scores shape: torch.Size([50045, 1])
2025-06-03 10:24:04,638 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:05,415 - DEBUG - Step 31: Loss=0.5707
2025-06-03 10:24:05,415 - DEBUG - Online update step: 32/50
2025-06-03 10:24:05,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:06,009 - DEBUG - Node anomaly scores shape: torch.Size([22939, 1])
2025-06-03 10:24:06,020 - DEBUG - Edge anomaly scores shape: torch.Size([48364, 1])
2025-06-03 10:24:06,021 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:06,696 - DEBUG - Step 32: Loss=0.5707
2025-06-03 10:24:06,696 - DEBUG - Online update step: 33/50
2025-06-03 10:24:06,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:07,248 - DEBUG - Node anomaly scores shape: torch.Size([22191, 1])
2025-06-03 10:24:07,259 - DEBUG - Edge anomaly scores shape: torch.Size([46615, 1])
2025-06-03 10:24:07,260 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:07,945 - DEBUG - Step 33: Loss=0.5685
2025-06-03 10:24:07,945 - DEBUG - Online update step: 34/50
2025-06-03 10:24:07,949 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:08,565 - DEBUG - Node anomaly scores shape: torch.Size([22414, 1])
2025-06-03 10:24:08,576 - DEBUG - Edge anomaly scores shape: torch.Size([47148, 1])
2025-06-03 10:24:08,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:09,277 - DEBUG - Step 34: Loss=0.5716
2025-06-03 10:24:09,277 - DEBUG - Online update step: 35/50
2025-06-03 10:24:09,280 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:09,943 - DEBUG - Node anomaly scores shape: torch.Size([22628, 1])
2025-06-03 10:24:09,954 - DEBUG - Edge anomaly scores shape: torch.Size([47667, 1])
2025-06-03 10:24:09,955 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:10,615 - DEBUG - Step 35: Loss=0.5719
2025-06-03 10:24:10,615 - DEBUG - Online update step: 36/50
2025-06-03 10:24:10,618 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:11,176 - DEBUG - Node anomaly scores shape: torch.Size([22752, 1])
2025-06-03 10:24:11,188 - DEBUG - Edge anomaly scores shape: torch.Size([47983, 1])
2025-06-03 10:24:11,189 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:11,866 - DEBUG - Step 36: Loss=0.5686
2025-06-03 10:24:11,866 - DEBUG - Online update step: 37/50
2025-06-03 10:24:11,869 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:12,519 - DEBUG - Node anomaly scores shape: torch.Size([23901, 1])
2025-06-03 10:24:12,531 - DEBUG - Edge anomaly scores shape: torch.Size([50640, 1])
2025-06-03 10:24:12,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:13,191 - DEBUG - Step 37: Loss=0.5722
2025-06-03 10:24:13,191 - DEBUG - Online update step: 38/50
2025-06-03 10:24:13,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:13,860 - DEBUG - Node anomaly scores shape: torch.Size([24290, 1])
2025-06-03 10:24:13,877 - DEBUG - Edge anomaly scores shape: torch.Size([51684, 1])
2025-06-03 10:24:13,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:14,618 - DEBUG - Step 38: Loss=0.5736
2025-06-03 10:24:14,619 - DEBUG - Online update step: 39/50
2025-06-03 10:24:14,622 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:15,240 - DEBUG - Node anomaly scores shape: torch.Size([23614, 1])
2025-06-03 10:24:15,252 - DEBUG - Edge anomaly scores shape: torch.Size([49984, 1])
2025-06-03 10:24:15,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:15,990 - DEBUG - Step 39: Loss=0.5715
2025-06-03 10:24:15,990 - DEBUG - Online update step: 40/50
2025-06-03 10:24:15,996 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:16,716 - DEBUG - Node anomaly scores shape: torch.Size([24402, 1])
2025-06-03 10:24:16,728 - DEBUG - Edge anomaly scores shape: torch.Size([51888, 1])
2025-06-03 10:24:16,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:17,407 - DEBUG - Step 40: Loss=0.5687
2025-06-03 10:24:17,407 - DEBUG - Online update step: 41/50
2025-06-03 10:24:17,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:18,066 - DEBUG - Node anomaly scores shape: torch.Size([24342, 1])
2025-06-03 10:24:18,079 - DEBUG - Edge anomaly scores shape: torch.Size([51755, 1])
2025-06-03 10:24:18,080 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:18,835 - DEBUG - Step 41: Loss=0.5714
2025-06-03 10:24:18,835 - DEBUG - Online update step: 42/50
2025-06-03 10:24:18,838 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:19,498 - DEBUG - Node anomaly scores shape: torch.Size([23417, 1])
2025-06-03 10:24:19,510 - DEBUG - Edge anomaly scores shape: torch.Size([49542, 1])
2025-06-03 10:24:19,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:20,193 - DEBUG - Step 42: Loss=0.5709
2025-06-03 10:24:20,193 - DEBUG - Online update step: 43/50
2025-06-03 10:24:20,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:20,772 - DEBUG - Node anomaly scores shape: torch.Size([23135, 1])
2025-06-03 10:24:20,784 - DEBUG - Edge anomaly scores shape: torch.Size([48851, 1])
2025-06-03 10:24:20,785 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:21,438 - DEBUG - Step 43: Loss=0.5682
2025-06-03 10:24:21,438 - DEBUG - Online update step: 44/50
2025-06-03 10:24:21,441 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:22,104 - DEBUG - Node anomaly scores shape: torch.Size([24286, 1])
2025-06-03 10:24:22,118 - DEBUG - Edge anomaly scores shape: torch.Size([51625, 1])
2025-06-03 10:24:22,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:22,843 - DEBUG - Step 44: Loss=0.5701
2025-06-03 10:24:22,843 - DEBUG - Online update step: 45/50
2025-06-03 10:24:22,846 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:23,424 - DEBUG - Node anomaly scores shape: torch.Size([22411, 1])
2025-06-03 10:24:23,435 - DEBUG - Edge anomaly scores shape: torch.Size([47194, 1])
2025-06-03 10:24:23,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:24,115 - DEBUG - Step 45: Loss=0.5699
2025-06-03 10:24:24,116 - DEBUG - Online update step: 46/50
2025-06-03 10:24:24,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:24,732 - DEBUG - Node anomaly scores shape: torch.Size([22734, 1])
2025-06-03 10:24:24,743 - DEBUG - Edge anomaly scores shape: torch.Size([47947, 1])
2025-06-03 10:24:24,744 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:25,583 - DEBUG - Step 46: Loss=0.5685
2025-06-03 10:24:25,583 - DEBUG - Online update step: 47/50
2025-06-03 10:24:25,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:26,335 - DEBUG - Node anomaly scores shape: torch.Size([23562, 1])
2025-06-03 10:24:26,351 - DEBUG - Edge anomaly scores shape: torch.Size([49936, 1])
2025-06-03 10:24:26,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:27,121 - DEBUG - Step 47: Loss=0.5689
2025-06-03 10:24:27,121 - DEBUG - Online update step: 48/50
2025-06-03 10:24:27,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:27,867 - DEBUG - Node anomaly scores shape: torch.Size([24517, 1])
2025-06-03 10:24:27,882 - DEBUG - Edge anomaly scores shape: torch.Size([52069, 1])
2025-06-03 10:24:27,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:28,707 - DEBUG - Step 48: Loss=0.5688
2025-06-03 10:24:28,708 - DEBUG - Online update step: 49/50
2025-06-03 10:24:28,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:29,336 - DEBUG - Node anomaly scores shape: torch.Size([24020, 1])
2025-06-03 10:24:29,350 - DEBUG - Edge anomaly scores shape: torch.Size([50989, 1])
2025-06-03 10:24:29,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:30,039 - DEBUG - Step 49: Loss=0.5689
2025-06-03 10:24:30,039 - DEBUG - Online update step: 50/50
2025-06-03 10:24:30,042 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:30,612 - DEBUG - Node anomaly scores shape: torch.Size([22701, 1])
2025-06-03 10:24:30,624 - DEBUG - Edge anomaly scores shape: torch.Size([47835, 1])
2025-06-03 10:24:30,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:31,310 - DEBUG - Step 50: Loss=0.5692
2025-06-03 10:24:31,311 - INFO - Online update finished. Average loss: 0.5702, Learning rate: 0.001000
2025-06-03 10:24:31,312 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:24:31,312 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:24:31,314 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:24:31,315 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-03 10:24:31,315 - INFO - Online update complete. Loss: 0.5702
2025-06-03 10:24:31,315 - INFO - Running anomaly detection...
2025-06-03 10:24:31,316 - INFO - Starting anomaly detection.
2025-06-03 10:24:31,350 - DEBUG - Node reconstruction errors: [0.0026825  0.00116797 0.00111993 ... 0.00113212 0.00126962 0.00920734]
2025-06-03 10:24:31,351 - DEBUG - Edge reconstruction errors: [0.15554573 1.657168   1.6581647  ... 0.15516561 1.2532696  0.1551823 ]
2025-06-03 10:24:31,353 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102431_update_43.json
2025-06-03 10:24:31,353 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:24:31,369 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102431_update_43.pth and as latest_checkpoint.pth
2025-06-03 10:24:31,369 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.3471
2025-06-03 10:24:31,369 - WARNING - Detected 18 anomalous nodes (reconstruction-based):
2025-06-03 10:24:31,369 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0246, MLP Score: 0.5026
2025-06-03 10:24:31,370 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1666, MLP Score: 0.5044
2025-06-03 10:24:31,370 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0304, MLP Score: 0.4956
2025-06-03 10:24:31,370 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0523, MLP Score: 0.5039
2025-06-03 10:24:31,370 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0245, MLP Score: 0.5011
2025-06-03 10:24:31,370 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:24:31,370 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7223, MLP Score: 0.5017
2025-06-03 10:24:31,370 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3284, MLP Score: 0.5013
2025-06-03 10:24:31,370 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9129, MLP Score: 0.5014
2025-06-03 10:24:31,370 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3294, MLP Score: 0.5015
2025-06-03 10:24:31,370 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3380, MLP Score: 0.5015
2025-06-03 10:24:31,370 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-03 10:24:31,370 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-03 10:24:31,370 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-03 10:24:31,402 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-03 10:24:31,429 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-03 10:24:31,429 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-03 10:24:31,429 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-03 10:24:31,451 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-03 10:24:31,475 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-03 10:24:31,475 - INFO - Processing node updates/additions.
2025-06-03 10:24:31,480 - INFO - Processing edge updates/additions.
2025-06-03 10:24:31,492 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:24:31,492 - INFO - Finished updating NetworkX graph.
2025-06-03 10:24:31,493 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:24:31,494 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:24:31,503 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:24:31,504 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:24:31,504 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:24:31,505 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:24:31,507 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:24:31,511 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:24:31,512 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:24:31,513 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:24:31,515 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:24:31,516 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:24:31,516 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:24:31,516 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:24:31,516 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:24:31,518 - INFO - Performing online update...
2025-06-03 10:24:31,519 - INFO - Starting online update for 50 steps.
2025-06-03 10:24:31,519 - DEBUG - Updated RunningStats: new_mean=0.9503243119410765, new_var=25200000000161.348, new_n=2550
2025-06-03 10:24:31,519 - DEBUG - Updated RunningStats: new_mean=0.9478682015360647, new_var=25500000000018.367, new_n=2580
2025-06-03 10:24:31,520 - DEBUG - Updated RunningStats: new_mean=1.2228156455654182, new_var=8400000000093.347, new_n=850
2025-06-03 10:24:31,520 - DEBUG - Updated RunningStats: new_mean=1.2210927544468984, new_var=8500000000001.707, new_n=860
2025-06-03 10:24:31,520 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:24:31,520 - DEBUG - Online update step: 1/50
2025-06-03 10:24:31,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:32,227 - DEBUG - Node anomaly scores shape: torch.Size([23342, 1])
2025-06-03 10:24:32,240 - DEBUG - Edge anomaly scores shape: torch.Size([49461, 1])
2025-06-03 10:24:32,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:33,012 - DEBUG - Step 1: Loss=0.5689
2025-06-03 10:24:33,013 - DEBUG - Online update step: 2/50
2025-06-03 10:24:33,016 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:33,667 - DEBUG - Node anomaly scores shape: torch.Size([23857, 1])
2025-06-03 10:24:33,680 - DEBUG - Edge anomaly scores shape: torch.Size([50577, 1])
2025-06-03 10:24:33,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:34,408 - DEBUG - Step 2: Loss=0.5697
2025-06-03 10:24:34,409 - DEBUG - Online update step: 3/50
2025-06-03 10:24:34,412 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:35,010 - DEBUG - Node anomaly scores shape: torch.Size([22835, 1])
2025-06-03 10:24:35,023 - DEBUG - Edge anomaly scores shape: torch.Size([48209, 1])
2025-06-03 10:24:35,024 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:35,748 - DEBUG - Step 3: Loss=0.5694
2025-06-03 10:24:35,748 - DEBUG - Online update step: 4/50
2025-06-03 10:24:35,751 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:36,399 - DEBUG - Node anomaly scores shape: torch.Size([23248, 1])
2025-06-03 10:24:36,410 - DEBUG - Edge anomaly scores shape: torch.Size([49196, 1])
2025-06-03 10:24:36,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:37,127 - DEBUG - Step 4: Loss=0.5686
2025-06-03 10:24:37,128 - DEBUG - Online update step: 5/50
2025-06-03 10:24:37,132 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:37,796 - DEBUG - Node anomaly scores shape: torch.Size([23955, 1])
2025-06-03 10:24:37,807 - DEBUG - Edge anomaly scores shape: torch.Size([50825, 1])
2025-06-03 10:24:37,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:38,526 - DEBUG - Step 5: Loss=0.5703
2025-06-03 10:24:38,526 - DEBUG - Online update step: 6/50
2025-06-03 10:24:38,529 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:39,136 - DEBUG - Node anomaly scores shape: torch.Size([22930, 1])
2025-06-03 10:24:39,149 - DEBUG - Edge anomaly scores shape: torch.Size([48431, 1])
2025-06-03 10:24:39,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:39,888 - DEBUG - Step 6: Loss=0.5684
2025-06-03 10:24:39,888 - DEBUG - Online update step: 7/50
2025-06-03 10:24:39,891 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:40,615 - DEBUG - Node anomaly scores shape: torch.Size([25088, 1])
2025-06-03 10:24:40,631 - DEBUG - Edge anomaly scores shape: torch.Size([53575, 1])
2025-06-03 10:24:40,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:41,457 - DEBUG - Step 7: Loss=0.5681
2025-06-03 10:24:41,457 - DEBUG - Online update step: 8/50
2025-06-03 10:24:41,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:42,100 - DEBUG - Node anomaly scores shape: torch.Size([23494, 1])
2025-06-03 10:24:42,112 - DEBUG - Edge anomaly scores shape: torch.Size([49756, 1])
2025-06-03 10:24:42,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:42,824 - DEBUG - Step 8: Loss=0.5687
2025-06-03 10:24:42,824 - DEBUG - Online update step: 9/50
2025-06-03 10:24:42,827 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:43,456 - DEBUG - Node anomaly scores shape: torch.Size([23013, 1])
2025-06-03 10:24:43,467 - DEBUG - Edge anomaly scores shape: torch.Size([48573, 1])
2025-06-03 10:24:43,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:44,213 - DEBUG - Step 9: Loss=0.5684
2025-06-03 10:24:44,213 - DEBUG - Online update step: 10/50
2025-06-03 10:24:44,218 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:44,879 - DEBUG - Node anomaly scores shape: torch.Size([22884, 1])
2025-06-03 10:24:44,895 - DEBUG - Edge anomaly scores shape: torch.Size([48369, 1])
2025-06-03 10:24:44,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:45,603 - DEBUG - Step 10: Loss=0.5693
2025-06-03 10:24:45,603 - DEBUG - Online update step: 11/50
2025-06-03 10:24:45,606 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:46,224 - DEBUG - Node anomaly scores shape: torch.Size([22835, 1])
2025-06-03 10:24:46,236 - DEBUG - Edge anomaly scores shape: torch.Size([48245, 1])
2025-06-03 10:24:46,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:46,989 - DEBUG - Step 11: Loss=0.5679
2025-06-03 10:24:46,989 - DEBUG - Online update step: 12/50
2025-06-03 10:24:46,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:47,627 - DEBUG - Node anomaly scores shape: torch.Size([23742, 1])
2025-06-03 10:24:47,640 - DEBUG - Edge anomaly scores shape: torch.Size([50176, 1])
2025-06-03 10:24:47,642 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:48,381 - DEBUG - Step 12: Loss=0.5689
2025-06-03 10:24:48,382 - DEBUG - Online update step: 13/50
2025-06-03 10:24:48,385 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:49,021 - DEBUG - Node anomaly scores shape: torch.Size([23705, 1])
2025-06-03 10:24:49,033 - DEBUG - Edge anomaly scores shape: torch.Size([50218, 1])
2025-06-03 10:24:49,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:49,795 - DEBUG - Step 13: Loss=0.5679
2025-06-03 10:24:49,795 - DEBUG - Online update step: 14/50
2025-06-03 10:24:49,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:50,458 - DEBUG - Node anomaly scores shape: torch.Size([23235, 1])
2025-06-03 10:24:50,470 - DEBUG - Edge anomaly scores shape: torch.Size([49102, 1])
2025-06-03 10:24:50,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:51,172 - DEBUG - Step 14: Loss=0.5698
2025-06-03 10:24:51,172 - DEBUG - Online update step: 15/50
2025-06-03 10:24:51,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:51,861 - DEBUG - Node anomaly scores shape: torch.Size([23188, 1])
2025-06-03 10:24:51,872 - DEBUG - Edge anomaly scores shape: torch.Size([48998, 1])
2025-06-03 10:24:51,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:52,501 - DEBUG - Step 15: Loss=0.5699
2025-06-03 10:24:52,501 - DEBUG - Online update step: 16/50
2025-06-03 10:24:52,504 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:53,191 - DEBUG - Node anomaly scores shape: torch.Size([23412, 1])
2025-06-03 10:24:53,202 - DEBUG - Edge anomaly scores shape: torch.Size([49466, 1])
2025-06-03 10:24:53,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:53,923 - DEBUG - Step 16: Loss=0.5678
2025-06-03 10:24:53,923 - DEBUG - Online update step: 17/50
2025-06-03 10:24:53,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:54,625 - DEBUG - Node anomaly scores shape: torch.Size([25214, 1])
2025-06-03 10:24:54,644 - DEBUG - Edge anomaly scores shape: torch.Size([53739, 1])
2025-06-03 10:24:54,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:55,443 - DEBUG - Step 17: Loss=0.5680
2025-06-03 10:24:55,444 - DEBUG - Online update step: 18/50
2025-06-03 10:24:55,449 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:56,139 - DEBUG - Node anomaly scores shape: torch.Size([23544, 1])
2025-06-03 10:24:56,157 - DEBUG - Edge anomaly scores shape: torch.Size([49878, 1])
2025-06-03 10:24:56,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:57,157 - DEBUG - Step 18: Loss=0.5691
2025-06-03 10:24:57,157 - DEBUG - Online update step: 19/50
2025-06-03 10:24:57,165 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:57,888 - DEBUG - Node anomaly scores shape: torch.Size([23349, 1])
2025-06-03 10:24:57,900 - DEBUG - Edge anomaly scores shape: torch.Size([49378, 1])
2025-06-03 10:24:57,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:24:58,751 - DEBUG - Step 19: Loss=0.5687
2025-06-03 10:24:58,751 - DEBUG - Online update step: 20/50
2025-06-03 10:24:58,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:24:59,596 - DEBUG - Node anomaly scores shape: torch.Size([23918, 1])
2025-06-03 10:24:59,618 - DEBUG - Edge anomaly scores shape: torch.Size([50698, 1])
2025-06-03 10:24:59,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:00,702 - DEBUG - Step 20: Loss=0.5694
2025-06-03 10:25:00,702 - DEBUG - Online update step: 21/50
2025-06-03 10:25:00,705 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:01,583 - DEBUG - Node anomaly scores shape: torch.Size([23794, 1])
2025-06-03 10:25:01,598 - DEBUG - Edge anomaly scores shape: torch.Size([50415, 1])
2025-06-03 10:25:01,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:02,615 - DEBUG - Step 21: Loss=0.5689
2025-06-03 10:25:02,615 - DEBUG - Online update step: 22/50
2025-06-03 10:25:02,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:03,549 - DEBUG - Node anomaly scores shape: torch.Size([25289, 1])
2025-06-03 10:25:03,565 - DEBUG - Edge anomaly scores shape: torch.Size([54128, 1])
2025-06-03 10:25:03,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:04,473 - DEBUG - Step 22: Loss=0.5680
2025-06-03 10:25:04,474 - DEBUG - Online update step: 23/50
2025-06-03 10:25:04,477 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:05,085 - DEBUG - Node anomaly scores shape: torch.Size([22836, 1])
2025-06-03 10:25:05,096 - DEBUG - Edge anomaly scores shape: torch.Size([48055, 1])
2025-06-03 10:25:05,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:05,853 - DEBUG - Step 23: Loss=0.5684
2025-06-03 10:25:05,853 - DEBUG - Online update step: 24/50
2025-06-03 10:25:05,856 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:06,456 - DEBUG - Node anomaly scores shape: torch.Size([22218, 1])
2025-06-03 10:25:06,468 - DEBUG - Edge anomaly scores shape: torch.Size([46705, 1])
2025-06-03 10:25:06,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:07,115 - DEBUG - Step 24: Loss=0.5693
2025-06-03 10:25:07,115 - DEBUG - Online update step: 25/50
2025-06-03 10:25:07,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:07,790 - DEBUG - Node anomaly scores shape: torch.Size([24442, 1])
2025-06-03 10:25:07,806 - DEBUG - Edge anomaly scores shape: torch.Size([51923, 1])
2025-06-03 10:25:07,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:08,544 - DEBUG - Step 25: Loss=0.5685
2025-06-03 10:25:08,545 - DEBUG - Online update step: 26/50
2025-06-03 10:25:08,548 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:09,202 - DEBUG - Node anomaly scores shape: torch.Size([23299, 1])
2025-06-03 10:25:09,216 - DEBUG - Edge anomaly scores shape: torch.Size([49188, 1])
2025-06-03 10:25:09,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:09,969 - DEBUG - Step 26: Loss=0.5686
2025-06-03 10:25:09,970 - DEBUG - Online update step: 27/50
2025-06-03 10:25:09,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:10,614 - DEBUG - Node anomaly scores shape: torch.Size([24091, 1])
2025-06-03 10:25:10,627 - DEBUG - Edge anomaly scores shape: torch.Size([51115, 1])
2025-06-03 10:25:10,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:11,342 - DEBUG - Step 27: Loss=0.5692
2025-06-03 10:25:11,342 - DEBUG - Online update step: 28/50
2025-06-03 10:25:11,345 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:11,994 - DEBUG - Node anomaly scores shape: torch.Size([25535, 1])
2025-06-03 10:25:12,008 - DEBUG - Edge anomaly scores shape: torch.Size([54479, 1])
2025-06-03 10:25:12,009 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:12,769 - DEBUG - Step 28: Loss=0.5697
2025-06-03 10:25:12,770 - DEBUG - Online update step: 29/50
2025-06-03 10:25:12,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:13,438 - DEBUG - Node anomaly scores shape: torch.Size([23248, 1])
2025-06-03 10:25:13,454 - DEBUG - Edge anomaly scores shape: torch.Size([49034, 1])
2025-06-03 10:25:13,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:14,251 - DEBUG - Step 29: Loss=0.5696
2025-06-03 10:25:14,252 - DEBUG - Online update step: 30/50
2025-06-03 10:25:14,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:14,977 - DEBUG - Node anomaly scores shape: torch.Size([24394, 1])
2025-06-03 10:25:14,989 - DEBUG - Edge anomaly scores shape: torch.Size([51910, 1])
2025-06-03 10:25:14,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:15,807 - DEBUG - Step 30: Loss=0.5683
2025-06-03 10:25:15,807 - DEBUG - Online update step: 31/50
2025-06-03 10:25:15,810 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:16,435 - DEBUG - Node anomaly scores shape: torch.Size([21919, 1])
2025-06-03 10:25:16,446 - DEBUG - Edge anomaly scores shape: torch.Size([46007, 1])
2025-06-03 10:25:16,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:17,137 - DEBUG - Step 31: Loss=0.5676
2025-06-03 10:25:17,137 - DEBUG - Online update step: 32/50
2025-06-03 10:25:17,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:17,791 - DEBUG - Node anomaly scores shape: torch.Size([22677, 1])
2025-06-03 10:25:17,803 - DEBUG - Edge anomaly scores shape: torch.Size([47782, 1])
2025-06-03 10:25:17,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:18,698 - DEBUG - Step 32: Loss=0.5702
2025-06-03 10:25:18,698 - DEBUG - Online update step: 33/50
2025-06-03 10:25:18,702 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:19,537 - DEBUG - Node anomaly scores shape: torch.Size([23092, 1])
2025-06-03 10:25:19,552 - DEBUG - Edge anomaly scores shape: torch.Size([48776, 1])
2025-06-03 10:25:19,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:20,338 - DEBUG - Step 33: Loss=0.5710
2025-06-03 10:25:20,338 - DEBUG - Online update step: 34/50
2025-06-03 10:25:20,342 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:21,061 - DEBUG - Node anomaly scores shape: torch.Size([22578, 1])
2025-06-03 10:25:21,073 - DEBUG - Edge anomaly scores shape: torch.Size([47626, 1])
2025-06-03 10:25:21,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:21,783 - DEBUG - Step 34: Loss=0.5681
2025-06-03 10:25:21,783 - DEBUG - Online update step: 35/50
2025-06-03 10:25:21,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:22,527 - DEBUG - Node anomaly scores shape: torch.Size([23451, 1])
2025-06-03 10:25:22,543 - DEBUG - Edge anomaly scores shape: torch.Size([49707, 1])
2025-06-03 10:25:22,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:23,360 - DEBUG - Step 35: Loss=0.5677
2025-06-03 10:25:23,360 - DEBUG - Online update step: 36/50
2025-06-03 10:25:23,363 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:24,055 - DEBUG - Node anomaly scores shape: torch.Size([24143, 1])
2025-06-03 10:25:24,075 - DEBUG - Edge anomaly scores shape: torch.Size([51288, 1])
2025-06-03 10:25:24,077 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:24,967 - DEBUG - Step 36: Loss=0.5690
2025-06-03 10:25:24,967 - DEBUG - Online update step: 37/50
2025-06-03 10:25:24,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:25,678 - DEBUG - Node anomaly scores shape: torch.Size([23979, 1])
2025-06-03 10:25:25,691 - DEBUG - Edge anomaly scores shape: torch.Size([50864, 1])
2025-06-03 10:25:25,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:26,403 - DEBUG - Step 37: Loss=0.5688
2025-06-03 10:25:26,404 - DEBUG - Online update step: 38/50
2025-06-03 10:25:26,408 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:27,099 - DEBUG - Node anomaly scores shape: torch.Size([24466, 1])
2025-06-03 10:25:27,116 - DEBUG - Edge anomaly scores shape: torch.Size([51949, 1])
2025-06-03 10:25:27,118 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:27,968 - DEBUG - Step 38: Loss=0.5686
2025-06-03 10:25:27,969 - DEBUG - Online update step: 39/50
2025-06-03 10:25:27,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:28,704 - DEBUG - Node anomaly scores shape: torch.Size([22883, 1])
2025-06-03 10:25:28,720 - DEBUG - Edge anomaly scores shape: torch.Size([48299, 1])
2025-06-03 10:25:28,721 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:29,646 - DEBUG - Step 39: Loss=0.5681
2025-06-03 10:25:29,646 - DEBUG - Online update step: 40/50
2025-06-03 10:25:29,653 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:30,606 - DEBUG - Node anomaly scores shape: torch.Size([24231, 1])
2025-06-03 10:25:30,619 - DEBUG - Edge anomaly scores shape: torch.Size([51493, 1])
2025-06-03 10:25:30,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:31,445 - DEBUG - Step 40: Loss=0.5684
2025-06-03 10:25:31,446 - DEBUG - Online update step: 41/50
2025-06-03 10:25:31,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:32,224 - DEBUG - Node anomaly scores shape: torch.Size([23092, 1])
2025-06-03 10:25:32,242 - DEBUG - Edge anomaly scores shape: torch.Size([48830, 1])
2025-06-03 10:25:32,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:33,180 - DEBUG - Step 41: Loss=0.5690
2025-06-03 10:25:33,181 - DEBUG - Online update step: 42/50
2025-06-03 10:25:33,189 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:33,892 - DEBUG - Node anomaly scores shape: torch.Size([22344, 1])
2025-06-03 10:25:33,906 - DEBUG - Edge anomaly scores shape: torch.Size([47046, 1])
2025-06-03 10:25:33,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:34,662 - DEBUG - Step 42: Loss=0.5683
2025-06-03 10:25:34,662 - DEBUG - Online update step: 43/50
2025-06-03 10:25:34,665 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:35,851 - DEBUG - Node anomaly scores shape: torch.Size([23627, 1])
2025-06-03 10:25:35,944 - DEBUG - Edge anomaly scores shape: torch.Size([50201, 1])
2025-06-03 10:25:35,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:38,648 - DEBUG - Step 43: Loss=0.5680
2025-06-03 10:25:38,648 - DEBUG - Online update step: 44/50
2025-06-03 10:25:38,652 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:40,512 - DEBUG - Node anomaly scores shape: torch.Size([22781, 1])
2025-06-03 10:25:40,555 - DEBUG - Edge anomaly scores shape: torch.Size([48120, 1])
2025-06-03 10:25:40,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:42,120 - DEBUG - Step 44: Loss=0.5685
2025-06-03 10:25:42,121 - DEBUG - Online update step: 45/50
2025-06-03 10:25:42,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:45,040 - DEBUG - Node anomaly scores shape: torch.Size([24309, 1])
2025-06-03 10:25:45,136 - DEBUG - Edge anomaly scores shape: torch.Size([51695, 1])
2025-06-03 10:25:45,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:48,342 - DEBUG - Step 45: Loss=0.5682
2025-06-03 10:25:48,343 - DEBUG - Online update step: 46/50
2025-06-03 10:25:48,346 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:49,480 - DEBUG - Node anomaly scores shape: torch.Size([23707, 1])
2025-06-03 10:25:49,493 - DEBUG - Edge anomaly scores shape: torch.Size([50198, 1])
2025-06-03 10:25:49,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:50,353 - DEBUG - Step 46: Loss=0.5686
2025-06-03 10:25:50,353 - DEBUG - Online update step: 47/50
2025-06-03 10:25:50,356 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:51,000 - DEBUG - Node anomaly scores shape: torch.Size([23993, 1])
2025-06-03 10:25:51,014 - DEBUG - Edge anomaly scores shape: torch.Size([50864, 1])
2025-06-03 10:25:51,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:51,805 - DEBUG - Step 47: Loss=0.5686
2025-06-03 10:25:51,805 - DEBUG - Online update step: 48/50
2025-06-03 10:25:51,809 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:52,535 - DEBUG - Node anomaly scores shape: torch.Size([24644, 1])
2025-06-03 10:25:52,550 - DEBUG - Edge anomaly scores shape: torch.Size([52454, 1])
2025-06-03 10:25:52,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:53,345 - DEBUG - Step 48: Loss=0.5677
2025-06-03 10:25:53,345 - DEBUG - Online update step: 49/50
2025-06-03 10:25:53,350 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:54,083 - DEBUG - Node anomaly scores shape: torch.Size([23385, 1])
2025-06-03 10:25:54,099 - DEBUG - Edge anomaly scores shape: torch.Size([49495, 1])
2025-06-03 10:25:54,101 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:54,993 - DEBUG - Step 49: Loss=0.5677
2025-06-03 10:25:54,994 - DEBUG - Online update step: 50/50
2025-06-03 10:25:54,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:55,786 - DEBUG - Node anomaly scores shape: torch.Size([23630, 1])
2025-06-03 10:25:55,802 - DEBUG - Edge anomaly scores shape: torch.Size([49984, 1])
2025-06-03 10:25:55,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:56,650 - DEBUG - Step 50: Loss=0.5685
2025-06-03 10:25:56,650 - INFO - Online update finished. Average loss: 0.5687, Learning rate: 0.001000
2025-06-03 10:25:56,651 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:25:56,651 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:25:56,652 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -1.9016437e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
 -8.6618923e-10 -3.4647569e-09 -3.0316623e-09  0.0000000e+00
  0.0000000e+00  4.3309462e-10]
2025-06-03 10:25:56,653 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-03 10:25:56,653 - INFO - Online update complete. Loss: 0.5687
2025-06-03 10:25:56,653 - INFO - Running anomaly detection...
2025-06-03 10:25:56,653 - INFO - Starting anomaly detection.
2025-06-03 10:25:56,664 - DEBUG - Node reconstruction errors: [0.00155097 0.00260946 0.00238995 ... 0.00303258 0.00281969 0.00563959]
2025-06-03 10:25:56,664 - DEBUG - Edge reconstruction errors: [0.15521859 1.656985   1.6579729  ... 0.15471652 1.2525657  0.1547135 ]
2025-06-03 10:25:56,667 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102556_update_44.json
2025-06-03 10:25:56,667 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:25:56,684 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102556_update_44.pth and as latest_checkpoint.pth
2025-06-03 10:25:56,685 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.3539
2025-06-03 10:25:56,685 - WARNING - Detected 24 anomalous nodes (reconstruction-based):
2025-06-03 10:25:56,685 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0285, MLP Score: 0.4969
2025-06-03 10:25:56,685 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0761, MLP Score: 0.5048
2025-06-03 10:25:56,685 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0249, MLP Score: 0.4971
2025-06-03 10:25:56,685 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0578, MLP Score: 0.4999
2025-06-03 10:25:56,685 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0274, MLP Score: 0.4956
2025-06-03 10:25:56,685 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:25:56,685 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7222, MLP Score: 0.4989
2025-06-03 10:25:56,685 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3282, MLP Score: 0.4987
2025-06-03 10:25:56,685 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9129, MLP Score: 0.4987
2025-06-03 10:25:56,685 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3294, MLP Score: 0.4977
2025-06-03 10:25:56,685 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3380, MLP Score: 0.4978
2025-06-03 10:25:56,686 - INFO - 
--- Processing file: nw_graph_encoded_1748870685.dot (Timestamp: 2025-06-02 15:24:45) ---
2025-06-03 10:25:56,686 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-03 10:25:56,686 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-03 10:25:56,950 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-03 10:25:56,975 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-03 10:25:56,975 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-03 10:25:56,976 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-03 10:25:56,997 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-03 10:25:57,022 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-03 10:25:57,023 - INFO - Processing node updates/additions.
2025-06-03 10:25:57,028 - INFO - Processing edge updates/additions.
2025-06-03 10:25:57,041 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:25:57,042 - INFO - Finished updating NetworkX graph.
2025-06-03 10:25:57,042 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:25:57,043 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:25:57,053 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:25:57,054 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:25:57,055 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:25:57,057 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:25:57,059 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:25:57,067 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:25:57,069 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:25:57,071 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:25:57,073 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:25:57,074 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:25:57,074 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:25:57,074 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:25:57,074 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:25:57,079 - INFO - Performing online update...
2025-06-03 10:25:57,080 - INFO - Starting online update for 50 steps.
2025-06-03 10:25:57,080 - DEBUG - Updated RunningStats: new_mean=0.9502830434692827, new_var=25800000000161.348, new_n=2610
2025-06-03 10:25:57,080 - DEBUG - Updated RunningStats: new_mean=0.9478832227152006, new_var=26100000000018.367, new_n=2640
2025-06-03 10:25:57,081 - DEBUG - Updated RunningStats: new_mean=1.2257591166513426, new_var=8600000000093.322, new_n=870
2025-06-03 10:25:57,081 - DEBUG - Updated RunningStats: new_mean=1.2240419337495505, new_var=8700000000001.716, new_n=880
2025-06-03 10:25:57,081 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:25:57,081 - DEBUG - Online update step: 1/50
2025-06-03 10:25:57,084 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:57,900 - DEBUG - Node anomaly scores shape: torch.Size([23242, 1])
2025-06-03 10:25:57,915 - DEBUG - Edge anomaly scores shape: torch.Size([49193, 1])
2025-06-03 10:25:57,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:25:58,780 - DEBUG - Step 1: Loss=0.5687
2025-06-03 10:25:58,781 - DEBUG - Online update step: 2/50
2025-06-03 10:25:58,784 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:25:59,632 - DEBUG - Node anomaly scores shape: torch.Size([23572, 1])
2025-06-03 10:25:59,647 - DEBUG - Edge anomaly scores shape: torch.Size([49919, 1])
2025-06-03 10:25:59,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:00,627 - DEBUG - Step 2: Loss=0.5695
2025-06-03 10:26:00,627 - DEBUG - Online update step: 3/50
2025-06-03 10:26:00,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:01,478 - DEBUG - Node anomaly scores shape: torch.Size([26093, 1])
2025-06-03 10:26:01,493 - DEBUG - Edge anomaly scores shape: torch.Size([55845, 1])
2025-06-03 10:26:01,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:02,405 - DEBUG - Step 3: Loss=0.5696
2025-06-03 10:26:02,406 - DEBUG - Online update step: 4/50
2025-06-03 10:26:02,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:03,218 - DEBUG - Node anomaly scores shape: torch.Size([24011, 1])
2025-06-03 10:26:03,236 - DEBUG - Edge anomaly scores shape: torch.Size([51031, 1])
2025-06-03 10:26:03,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:04,227 - DEBUG - Step 4: Loss=0.5678
2025-06-03 10:26:04,228 - DEBUG - Online update step: 5/50
2025-06-03 10:26:04,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:04,956 - DEBUG - Node anomaly scores shape: torch.Size([23236, 1])
2025-06-03 10:26:04,969 - DEBUG - Edge anomaly scores shape: torch.Size([49147, 1])
2025-06-03 10:26:04,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:05,755 - DEBUG - Step 5: Loss=0.5674
2025-06-03 10:26:05,755 - DEBUG - Online update step: 6/50
2025-06-03 10:26:05,759 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:06,565 - DEBUG - Node anomaly scores shape: torch.Size([24360, 1])
2025-06-03 10:26:06,579 - DEBUG - Edge anomaly scores shape: torch.Size([51721, 1])
2025-06-03 10:26:06,580 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:07,319 - DEBUG - Step 6: Loss=0.5679
2025-06-03 10:26:07,319 - DEBUG - Online update step: 7/50
2025-06-03 10:26:07,322 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:07,956 - DEBUG - Node anomaly scores shape: torch.Size([22863, 1])
2025-06-03 10:26:07,969 - DEBUG - Edge anomaly scores shape: torch.Size([48280, 1])
2025-06-03 10:26:07,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:08,714 - DEBUG - Step 7: Loss=0.5681
2025-06-03 10:26:08,715 - DEBUG - Online update step: 8/50
2025-06-03 10:26:08,718 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:09,547 - DEBUG - Node anomaly scores shape: torch.Size([22835, 1])
2025-06-03 10:26:09,562 - DEBUG - Edge anomaly scores shape: torch.Size([48205, 1])
2025-06-03 10:26:09,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:10,443 - DEBUG - Step 8: Loss=0.5694
2025-06-03 10:26:10,444 - DEBUG - Online update step: 9/50
2025-06-03 10:26:10,449 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:11,100 - DEBUG - Node anomaly scores shape: torch.Size([22244, 1])
2025-06-03 10:26:11,113 - DEBUG - Edge anomaly scores shape: torch.Size([46803, 1])
2025-06-03 10:26:11,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:11,991 - DEBUG - Step 9: Loss=0.5692
2025-06-03 10:26:11,991 - DEBUG - Online update step: 10/50
2025-06-03 10:26:11,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:13,063 - DEBUG - Node anomaly scores shape: torch.Size([23877, 1])
2025-06-03 10:26:13,087 - DEBUG - Edge anomaly scores shape: torch.Size([50649, 1])
2025-06-03 10:26:13,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:14,124 - DEBUG - Step 10: Loss=0.5671
2025-06-03 10:26:14,124 - DEBUG - Online update step: 11/50
2025-06-03 10:26:14,134 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:15,017 - DEBUG - Node anomaly scores shape: torch.Size([25027, 1])
2025-06-03 10:26:15,031 - DEBUG - Edge anomaly scores shape: torch.Size([53307, 1])
2025-06-03 10:26:15,033 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:15,868 - DEBUG - Step 11: Loss=0.5674
2025-06-03 10:26:15,868 - DEBUG - Online update step: 12/50
2025-06-03 10:26:15,873 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:16,529 - DEBUG - Node anomaly scores shape: torch.Size([23327, 1])
2025-06-03 10:26:16,542 - DEBUG - Edge anomaly scores shape: torch.Size([49308, 1])
2025-06-03 10:26:16,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:17,284 - DEBUG - Step 12: Loss=0.5676
2025-06-03 10:26:17,285 - DEBUG - Online update step: 13/50
2025-06-03 10:26:17,292 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:18,007 - DEBUG - Node anomaly scores shape: torch.Size([24497, 1])
2025-06-03 10:26:18,020 - DEBUG - Edge anomaly scores shape: torch.Size([52117, 1])
2025-06-03 10:26:18,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:18,840 - DEBUG - Step 13: Loss=0.5672
2025-06-03 10:26:18,840 - DEBUG - Online update step: 14/50
2025-06-03 10:26:18,845 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:19,516 - DEBUG - Node anomaly scores shape: torch.Size([23332, 1])
2025-06-03 10:26:19,529 - DEBUG - Edge anomaly scores shape: torch.Size([49408, 1])
2025-06-03 10:26:19,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:20,422 - DEBUG - Step 14: Loss=0.5679
2025-06-03 10:26:20,423 - DEBUG - Online update step: 15/50
2025-06-03 10:26:20,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:21,097 - DEBUG - Node anomaly scores shape: torch.Size([22018, 1])
2025-06-03 10:26:21,108 - DEBUG - Edge anomaly scores shape: torch.Size([46365, 1])
2025-06-03 10:26:21,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:21,925 - DEBUG - Step 15: Loss=0.5669
2025-06-03 10:26:21,925 - DEBUG - Online update step: 16/50
2025-06-03 10:26:21,931 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:22,819 - DEBUG - Node anomaly scores shape: torch.Size([23725, 1])
2025-06-03 10:26:22,838 - DEBUG - Edge anomaly scores shape: torch.Size([50359, 1])
2025-06-03 10:26:22,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:23,744 - DEBUG - Step 16: Loss=0.5678
2025-06-03 10:26:23,744 - DEBUG - Online update step: 17/50
2025-06-03 10:26:23,749 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:24,552 - DEBUG - Node anomaly scores shape: torch.Size([23035, 1])
2025-06-03 10:26:24,574 - DEBUG - Edge anomaly scores shape: torch.Size([48605, 1])
2025-06-03 10:26:24,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:25,634 - DEBUG - Step 17: Loss=0.5672
2025-06-03 10:26:25,635 - DEBUG - Online update step: 18/50
2025-06-03 10:26:25,642 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:26,537 - DEBUG - Node anomaly scores shape: torch.Size([23832, 1])
2025-06-03 10:26:26,553 - DEBUG - Edge anomaly scores shape: torch.Size([50556, 1])
2025-06-03 10:26:26,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:27,466 - DEBUG - Step 18: Loss=0.5694
2025-06-03 10:26:27,466 - DEBUG - Online update step: 19/50
2025-06-03 10:26:27,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:28,354 - DEBUG - Node anomaly scores shape: torch.Size([23923, 1])
2025-06-03 10:26:28,372 - DEBUG - Edge anomaly scores shape: torch.Size([50779, 1])
2025-06-03 10:26:28,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:29,402 - DEBUG - Step 19: Loss=0.5707
2025-06-03 10:26:29,403 - DEBUG - Online update step: 20/50
2025-06-03 10:26:29,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:30,272 - DEBUG - Node anomaly scores shape: torch.Size([23517, 1])
2025-06-03 10:26:30,291 - DEBUG - Edge anomaly scores shape: torch.Size([49760, 1])
2025-06-03 10:26:30,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:31,330 - DEBUG - Step 20: Loss=0.5690
2025-06-03 10:26:31,330 - DEBUG - Online update step: 21/50
2025-06-03 10:26:31,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:32,256 - DEBUG - Node anomaly scores shape: torch.Size([23928, 1])
2025-06-03 10:26:32,274 - DEBUG - Edge anomaly scores shape: torch.Size([50804, 1])
2025-06-03 10:26:32,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:33,267 - DEBUG - Step 21: Loss=0.5724
2025-06-03 10:26:33,267 - DEBUG - Online update step: 22/50
2025-06-03 10:26:33,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:34,347 - DEBUG - Node anomaly scores shape: torch.Size([24587, 1])
2025-06-03 10:26:34,363 - DEBUG - Edge anomaly scores shape: torch.Size([52289, 1])
2025-06-03 10:26:34,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:35,431 - DEBUG - Step 22: Loss=0.5713
2025-06-03 10:26:35,432 - DEBUG - Online update step: 23/50
2025-06-03 10:26:35,435 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:36,355 - DEBUG - Node anomaly scores shape: torch.Size([23553, 1])
2025-06-03 10:26:36,377 - DEBUG - Edge anomaly scores shape: torch.Size([49764, 1])
2025-06-03 10:26:36,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:37,485 - DEBUG - Step 23: Loss=0.5685
2025-06-03 10:26:37,486 - DEBUG - Online update step: 24/50
2025-06-03 10:26:37,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:38,341 - DEBUG - Node anomaly scores shape: torch.Size([24011, 1])
2025-06-03 10:26:38,359 - DEBUG - Edge anomaly scores shape: torch.Size([50900, 1])
2025-06-03 10:26:38,362 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:39,353 - DEBUG - Step 24: Loss=0.5695
2025-06-03 10:26:39,353 - DEBUG - Online update step: 25/50
2025-06-03 10:26:39,356 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:40,237 - DEBUG - Node anomaly scores shape: torch.Size([24310, 1])
2025-06-03 10:26:40,254 - DEBUG - Edge anomaly scores shape: torch.Size([51599, 1])
2025-06-03 10:26:40,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:41,208 - DEBUG - Step 25: Loss=0.5711
2025-06-03 10:26:41,208 - DEBUG - Online update step: 26/50
2025-06-03 10:26:41,213 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:42,103 - DEBUG - Node anomaly scores shape: torch.Size([23674, 1])
2025-06-03 10:26:42,122 - DEBUG - Edge anomaly scores shape: torch.Size([50081, 1])
2025-06-03 10:26:42,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:43,166 - DEBUG - Step 26: Loss=0.5683
2025-06-03 10:26:43,166 - DEBUG - Online update step: 27/50
2025-06-03 10:26:43,170 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:44,026 - DEBUG - Node anomaly scores shape: torch.Size([24708, 1])
2025-06-03 10:26:44,040 - DEBUG - Edge anomaly scores shape: torch.Size([52562, 1])
2025-06-03 10:26:44,041 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:44,816 - DEBUG - Step 27: Loss=0.5683
2025-06-03 10:26:44,817 - DEBUG - Online update step: 28/50
2025-06-03 10:26:44,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:45,535 - DEBUG - Node anomaly scores shape: torch.Size([24328, 1])
2025-06-03 10:26:45,552 - DEBUG - Edge anomaly scores shape: torch.Size([51751, 1])
2025-06-03 10:26:45,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:46,398 - DEBUG - Step 28: Loss=0.5702
2025-06-03 10:26:46,399 - DEBUG - Online update step: 29/50
2025-06-03 10:26:46,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:47,088 - DEBUG - Node anomaly scores shape: torch.Size([24523, 1])
2025-06-03 10:26:47,101 - DEBUG - Edge anomaly scores shape: torch.Size([52113, 1])
2025-06-03 10:26:47,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:47,893 - DEBUG - Step 29: Loss=0.5685
2025-06-03 10:26:47,893 - DEBUG - Online update step: 30/50
2025-06-03 10:26:47,896 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:48,559 - DEBUG - Node anomaly scores shape: torch.Size([24046, 1])
2025-06-03 10:26:48,574 - DEBUG - Edge anomaly scores shape: torch.Size([51055, 1])
2025-06-03 10:26:48,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:49,366 - DEBUG - Step 30: Loss=0.5696
2025-06-03 10:26:49,366 - DEBUG - Online update step: 31/50
2025-06-03 10:26:49,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:49,977 - DEBUG - Node anomaly scores shape: torch.Size([22458, 1])
2025-06-03 10:26:49,990 - DEBUG - Edge anomaly scores shape: torch.Size([47319, 1])
2025-06-03 10:26:49,993 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:50,677 - DEBUG - Step 31: Loss=0.5699
2025-06-03 10:26:50,678 - DEBUG - Online update step: 32/50
2025-06-03 10:26:50,681 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:51,316 - DEBUG - Node anomaly scores shape: torch.Size([23604, 1])
2025-06-03 10:26:51,329 - DEBUG - Edge anomaly scores shape: torch.Size([50048, 1])
2025-06-03 10:26:51,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:52,032 - DEBUG - Step 32: Loss=0.5681
2025-06-03 10:26:52,033 - DEBUG - Online update step: 33/50
2025-06-03 10:26:52,036 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:52,647 - DEBUG - Node anomaly scores shape: torch.Size([23838, 1])
2025-06-03 10:26:52,659 - DEBUG - Edge anomaly scores shape: torch.Size([50580, 1])
2025-06-03 10:26:52,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:53,441 - DEBUG - Step 33: Loss=0.5698
2025-06-03 10:26:53,441 - DEBUG - Online update step: 34/50
2025-06-03 10:26:53,445 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:54,122 - DEBUG - Node anomaly scores shape: torch.Size([23951, 1])
2025-06-03 10:26:54,135 - DEBUG - Edge anomaly scores shape: torch.Size([50735, 1])
2025-06-03 10:26:54,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:54,819 - DEBUG - Step 34: Loss=0.5714
2025-06-03 10:26:54,819 - DEBUG - Online update step: 35/50
2025-06-03 10:26:54,822 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:55,451 - DEBUG - Node anomaly scores shape: torch.Size([24219, 1])
2025-06-03 10:26:55,465 - DEBUG - Edge anomaly scores shape: torch.Size([51433, 1])
2025-06-03 10:26:55,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:56,286 - DEBUG - Step 35: Loss=0.5695
2025-06-03 10:26:56,286 - DEBUG - Online update step: 36/50
2025-06-03 10:26:56,289 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:56,872 - DEBUG - Node anomaly scores shape: torch.Size([23290, 1])
2025-06-03 10:26:56,885 - DEBUG - Edge anomaly scores shape: torch.Size([49308, 1])
2025-06-03 10:26:56,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:57,792 - DEBUG - Step 36: Loss=0.5670
2025-06-03 10:26:57,793 - DEBUG - Online update step: 37/50
2025-06-03 10:26:57,798 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:58,537 - DEBUG - Node anomaly scores shape: torch.Size([25069, 1])
2025-06-03 10:26:58,551 - DEBUG - Edge anomaly scores shape: torch.Size([53369, 1])
2025-06-03 10:26:58,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:26:59,246 - DEBUG - Step 37: Loss=0.5679
2025-06-03 10:26:59,246 - DEBUG - Online update step: 38/50
2025-06-03 10:26:59,249 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:26:59,870 - DEBUG - Node anomaly scores shape: torch.Size([24021, 1])
2025-06-03 10:26:59,882 - DEBUG - Edge anomaly scores shape: torch.Size([51004, 1])
2025-06-03 10:26:59,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:00,601 - DEBUG - Step 38: Loss=0.5672
2025-06-03 10:27:00,601 - DEBUG - Online update step: 39/50
2025-06-03 10:27:00,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:01,268 - DEBUG - Node anomaly scores shape: torch.Size([24859, 1])
2025-06-03 10:27:01,282 - DEBUG - Edge anomaly scores shape: torch.Size([52959, 1])
2025-06-03 10:27:01,283 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:02,102 - DEBUG - Step 39: Loss=0.5700
2025-06-03 10:27:02,102 - DEBUG - Online update step: 40/50
2025-06-03 10:27:02,106 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:02,849 - DEBUG - Node anomaly scores shape: torch.Size([24353, 1])
2025-06-03 10:27:02,865 - DEBUG - Edge anomaly scores shape: torch.Size([51730, 1])
2025-06-03 10:27:02,867 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:03,699 - DEBUG - Step 40: Loss=0.5691
2025-06-03 10:27:03,699 - DEBUG - Online update step: 41/50
2025-06-03 10:27:03,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:04,294 - DEBUG - Node anomaly scores shape: torch.Size([23567, 1])
2025-06-03 10:27:04,306 - DEBUG - Edge anomaly scores shape: torch.Size([49940, 1])
2025-06-03 10:27:04,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:04,971 - DEBUG - Step 41: Loss=0.5666
2025-06-03 10:27:04,971 - DEBUG - Online update step: 42/50
2025-06-03 10:27:04,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:05,599 - DEBUG - Node anomaly scores shape: torch.Size([23794, 1])
2025-06-03 10:27:05,611 - DEBUG - Edge anomaly scores shape: torch.Size([50532, 1])
2025-06-03 10:27:05,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:06,296 - DEBUG - Step 42: Loss=0.5680
2025-06-03 10:27:06,296 - DEBUG - Online update step: 43/50
2025-06-03 10:27:06,299 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:06,868 - DEBUG - Node anomaly scores shape: torch.Size([22397, 1])
2025-06-03 10:27:06,879 - DEBUG - Edge anomaly scores shape: torch.Size([47153, 1])
2025-06-03 10:27:06,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:07,570 - DEBUG - Step 43: Loss=0.5688
2025-06-03 10:27:07,570 - DEBUG - Online update step: 44/50
2025-06-03 10:27:07,573 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:08,241 - DEBUG - Node anomaly scores shape: torch.Size([24552, 1])
2025-06-03 10:27:08,253 - DEBUG - Edge anomaly scores shape: torch.Size([52314, 1])
2025-06-03 10:27:08,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:08,912 - DEBUG - Step 44: Loss=0.5697
2025-06-03 10:27:08,913 - DEBUG - Online update step: 45/50
2025-06-03 10:27:08,916 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:09,509 - DEBUG - Node anomaly scores shape: torch.Size([22419, 1])
2025-06-03 10:27:09,520 - DEBUG - Edge anomaly scores shape: torch.Size([47213, 1])
2025-06-03 10:27:09,521 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:10,192 - DEBUG - Step 45: Loss=0.5689
2025-06-03 10:27:10,193 - DEBUG - Online update step: 46/50
2025-06-03 10:27:10,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:10,852 - DEBUG - Node anomaly scores shape: torch.Size([22904, 1])
2025-06-03 10:27:10,866 - DEBUG - Edge anomaly scores shape: torch.Size([48377, 1])
2025-06-03 10:27:10,868 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:11,542 - DEBUG - Step 46: Loss=0.5678
2025-06-03 10:27:11,542 - DEBUG - Online update step: 47/50
2025-06-03 10:27:11,545 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:12,194 - DEBUG - Node anomaly scores shape: torch.Size([24577, 1])
2025-06-03 10:27:12,207 - DEBUG - Edge anomaly scores shape: torch.Size([52304, 1])
2025-06-03 10:27:12,208 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:12,933 - DEBUG - Step 47: Loss=0.5663
2025-06-03 10:27:12,934 - DEBUG - Online update step: 48/50
2025-06-03 10:27:12,937 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:13,608 - DEBUG - Node anomaly scores shape: torch.Size([24607, 1])
2025-06-03 10:27:13,622 - DEBUG - Edge anomaly scores shape: torch.Size([52447, 1])
2025-06-03 10:27:13,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:14,364 - DEBUG - Step 48: Loss=0.5668
2025-06-03 10:27:14,364 - DEBUG - Online update step: 49/50
2025-06-03 10:27:14,367 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:14,989 - DEBUG - Node anomaly scores shape: torch.Size([22799, 1])
2025-06-03 10:27:15,001 - DEBUG - Edge anomaly scores shape: torch.Size([48109, 1])
2025-06-03 10:27:15,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:15,788 - DEBUG - Step 49: Loss=0.5682
2025-06-03 10:27:15,788 - DEBUG - Online update step: 50/50
2025-06-03 10:27:15,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:16,510 - DEBUG - Node anomaly scores shape: torch.Size([23683, 1])
2025-06-03 10:27:16,522 - DEBUG - Edge anomaly scores shape: torch.Size([50286, 1])
2025-06-03 10:27:16,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:17,235 - DEBUG - Step 50: Loss=0.5677
2025-06-03 10:27:17,236 - INFO - Online update finished. Average loss: 0.5687, Learning rate: 0.001000
2025-06-03 10:27:17,237 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:27:17,237 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:27:17,238 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:27:17,238 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-03 10:27:17,239 - INFO - Online update complete. Loss: 0.5687
2025-06-03 10:27:17,239 - INFO - Running anomaly detection...
2025-06-03 10:27:17,239 - INFO - Starting anomaly detection.
2025-06-03 10:27:17,249 - DEBUG - Node reconstruction errors: [0.00150253 0.00082157 0.00073399 ... 0.00077858 0.00084043 0.00840963]
2025-06-03 10:27:17,250 - DEBUG - Edge reconstruction errors: [0.15532012 1.6571108  1.6581187  ... 0.15488702 1.253099   0.15489607]
2025-06-03 10:27:17,252 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102717_update_45.json
2025-06-03 10:27:17,252 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:27:17,269 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102717_update_45.pth and as latest_checkpoint.pth
2025-06-03 10:27:17,269 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870685.dot): 0.3541
2025-06-03 10:27:17,269 - WARNING - Detected 21 anomalous nodes (reconstruction-based):
2025-06-03 10:27:17,269 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0234, MLP Score: 0.4989
2025-06-03 10:27:17,270 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0566, MLP Score: 0.5000
2025-06-03 10:27:17,270 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0306, MLP Score: 0.4937
2025-06-03 10:27:17,270 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0331, MLP Score: 0.4963
2025-06-03 10:27:17,270 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0245, MLP Score: 0.4943
2025-06-03 10:27:17,270 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:27:17,270 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7223, MLP Score: 0.5005
2025-06-03 10:27:17,270 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3283, MLP Score: 0.5004
2025-06-03 10:27:17,270 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9130, MLP Score: 0.5011
2025-06-03 10:27:17,270 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3294, MLP Score: 0.5003
2025-06-03 10:27:17,270 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3380, MLP Score: 0.5005
2025-06-03 10:27:17,270 - INFO - 
--- Processing file: nw_graph_encoded_1748870715.dot (Timestamp: 2025-06-02 15:25:15) ---
2025-06-03 10:27:17,270 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-03 10:27:17,270 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-03 10:27:17,308 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-03 10:27:17,335 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-03 10:27:17,335 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-03 10:27:17,335 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-03 10:27:17,358 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-03 10:27:17,382 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-03 10:27:17,382 - INFO - Processing node updates/additions.
2025-06-03 10:27:17,387 - INFO - Processing edge updates/additions.
2025-06-03 10:27:17,398 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:27:17,399 - INFO - Finished updating NetworkX graph.
2025-06-03 10:27:17,399 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:27:17,400 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:27:17,409 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:27:17,411 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:27:17,411 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:27:17,412 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:27:17,413 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:27:17,418 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:27:17,420 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:27:17,421 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:27:17,422 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:27:17,423 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:27:17,423 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:27:17,423 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:27:17,423 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:27:17,426 - INFO - Performing online update...
2025-06-03 10:27:17,427 - INFO - Starting online update for 50 steps.
2025-06-03 10:27:17,427 - DEBUG - Updated RunningStats: new_mean=0.9502436297602662, new_var=26400000000161.348, new_n=2670
2025-06-03 10:27:17,427 - DEBUG - Updated RunningStats: new_mean=0.947897576286375, new_var=26700000000018.367, new_n=2700
2025-06-03 10:27:17,428 - DEBUG - Updated RunningStats: new_mean=1.2285702970358876, new_var=8800000000093.299, new_n=890
2025-06-03 10:27:17,428 - DEBUG - Updated RunningStats: new_mean=1.2268600384165294, new_var=8900000000001.725, new_n=900
2025-06-03 10:27:17,428 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:27:17,428 - DEBUG - Online update step: 1/50
2025-06-03 10:27:17,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:18,141 - DEBUG - Node anomaly scores shape: torch.Size([22628, 1])
2025-06-03 10:27:18,162 - DEBUG - Edge anomaly scores shape: torch.Size([47730, 1])
2025-06-03 10:27:18,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:18,922 - DEBUG - Step 1: Loss=0.5674
2025-06-03 10:27:18,922 - DEBUG - Online update step: 2/50
2025-06-03 10:27:18,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:19,602 - DEBUG - Node anomaly scores shape: torch.Size([23472, 1])
2025-06-03 10:27:19,616 - DEBUG - Edge anomaly scores shape: torch.Size([49728, 1])
2025-06-03 10:27:19,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:20,350 - DEBUG - Step 2: Loss=0.5663
2025-06-03 10:27:20,350 - DEBUG - Online update step: 3/50
2025-06-03 10:27:20,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:20,991 - DEBUG - Node anomaly scores shape: torch.Size([23263, 1])
2025-06-03 10:27:21,002 - DEBUG - Edge anomaly scores shape: torch.Size([49185, 1])
2025-06-03 10:27:21,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:21,710 - DEBUG - Step 3: Loss=0.5678
2025-06-03 10:27:21,710 - DEBUG - Online update step: 4/50
2025-06-03 10:27:21,713 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:22,403 - DEBUG - Node anomaly scores shape: torch.Size([24995, 1])
2025-06-03 10:27:22,416 - DEBUG - Edge anomaly scores shape: torch.Size([53269, 1])
2025-06-03 10:27:22,417 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:23,165 - DEBUG - Step 4: Loss=0.5679
2025-06-03 10:27:23,165 - DEBUG - Online update step: 5/50
2025-06-03 10:27:23,168 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:23,806 - DEBUG - Node anomaly scores shape: torch.Size([22970, 1])
2025-06-03 10:27:23,823 - DEBUG - Edge anomaly scores shape: torch.Size([48525, 1])
2025-06-03 10:27:23,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:24,595 - DEBUG - Step 5: Loss=0.5688
2025-06-03 10:27:24,595 - DEBUG - Online update step: 6/50
2025-06-03 10:27:24,598 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:25,264 - DEBUG - Node anomaly scores shape: torch.Size([24031, 1])
2025-06-03 10:27:25,276 - DEBUG - Edge anomaly scores shape: torch.Size([51009, 1])
2025-06-03 10:27:25,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:26,007 - DEBUG - Step 6: Loss=0.5686
2025-06-03 10:27:26,007 - DEBUG - Online update step: 7/50
2025-06-03 10:27:26,010 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:26,653 - DEBUG - Node anomaly scores shape: torch.Size([24411, 1])
2025-06-03 10:27:26,669 - DEBUG - Edge anomaly scores shape: torch.Size([51897, 1])
2025-06-03 10:27:26,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:27,403 - DEBUG - Step 7: Loss=0.5669
2025-06-03 10:27:27,404 - DEBUG - Online update step: 8/50
2025-06-03 10:27:27,407 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:28,071 - DEBUG - Node anomaly scores shape: torch.Size([24430, 1])
2025-06-03 10:27:28,088 - DEBUG - Edge anomaly scores shape: torch.Size([51926, 1])
2025-06-03 10:27:28,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:28,859 - DEBUG - Step 8: Loss=0.5668
2025-06-03 10:27:28,859 - DEBUG - Online update step: 9/50
2025-06-03 10:27:28,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:29,526 - DEBUG - Node anomaly scores shape: torch.Size([24705, 1])
2025-06-03 10:27:29,540 - DEBUG - Edge anomaly scores shape: torch.Size([52580, 1])
2025-06-03 10:27:29,541 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:30,312 - DEBUG - Step 9: Loss=0.5668
2025-06-03 10:27:30,312 - DEBUG - Online update step: 10/50
2025-06-03 10:27:30,316 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:30,987 - DEBUG - Node anomaly scores shape: torch.Size([25021, 1])
2025-06-03 10:27:30,999 - DEBUG - Edge anomaly scores shape: torch.Size([53370, 1])
2025-06-03 10:27:31,000 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:31,838 - DEBUG - Step 10: Loss=0.5679
2025-06-03 10:27:31,839 - DEBUG - Online update step: 11/50
2025-06-03 10:27:31,842 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:32,595 - DEBUG - Node anomaly scores shape: torch.Size([25519, 1])
2025-06-03 10:27:32,607 - DEBUG - Edge anomaly scores shape: torch.Size([54388, 1])
2025-06-03 10:27:32,609 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:33,462 - DEBUG - Step 11: Loss=0.5683
2025-06-03 10:27:33,463 - DEBUG - Online update step: 12/50
2025-06-03 10:27:33,468 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:34,209 - DEBUG - Node anomaly scores shape: torch.Size([22737, 1])
2025-06-03 10:27:34,232 - DEBUG - Edge anomaly scores shape: torch.Size([47974, 1])
2025-06-03 10:27:34,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:35,021 - DEBUG - Step 12: Loss=0.5677
2025-06-03 10:27:35,022 - DEBUG - Online update step: 13/50
2025-06-03 10:27:35,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:35,715 - DEBUG - Node anomaly scores shape: torch.Size([24222, 1])
2025-06-03 10:27:35,728 - DEBUG - Edge anomaly scores shape: torch.Size([51465, 1])
2025-06-03 10:27:35,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:36,524 - DEBUG - Step 13: Loss=0.5672
2025-06-03 10:27:36,524 - DEBUG - Online update step: 14/50
2025-06-03 10:27:36,527 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:37,197 - DEBUG - Node anomaly scores shape: torch.Size([23620, 1])
2025-06-03 10:27:37,210 - DEBUG - Edge anomaly scores shape: torch.Size([49976, 1])
2025-06-03 10:27:37,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:37,904 - DEBUG - Step 14: Loss=0.5659
2025-06-03 10:27:37,904 - DEBUG - Online update step: 15/50
2025-06-03 10:27:37,907 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:38,561 - DEBUG - Node anomaly scores shape: torch.Size([24413, 1])
2025-06-03 10:27:38,574 - DEBUG - Edge anomaly scores shape: torch.Size([51892, 1])
2025-06-03 10:27:38,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:39,366 - DEBUG - Step 15: Loss=0.5666
2025-06-03 10:27:39,366 - DEBUG - Online update step: 16/50
2025-06-03 10:27:39,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:40,070 - DEBUG - Node anomaly scores shape: torch.Size([24801, 1])
2025-06-03 10:27:40,090 - DEBUG - Edge anomaly scores shape: torch.Size([53021, 1])
2025-06-03 10:27:40,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:40,898 - DEBUG - Step 16: Loss=0.5676
2025-06-03 10:27:40,898 - DEBUG - Online update step: 17/50
2025-06-03 10:27:40,901 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:41,533 - DEBUG - Node anomaly scores shape: torch.Size([24749, 1])
2025-06-03 10:27:41,548 - DEBUG - Edge anomaly scores shape: torch.Size([52847, 1])
2025-06-03 10:27:41,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:42,357 - DEBUG - Step 17: Loss=0.5671
2025-06-03 10:27:42,357 - DEBUG - Online update step: 18/50
2025-06-03 10:27:42,360 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:43,002 - DEBUG - Node anomaly scores shape: torch.Size([23377, 1])
2025-06-03 10:27:43,014 - DEBUG - Edge anomaly scores shape: torch.Size([49459, 1])
2025-06-03 10:27:43,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:43,717 - DEBUG - Step 18: Loss=0.5675
2025-06-03 10:27:43,718 - DEBUG - Online update step: 19/50
2025-06-03 10:27:43,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:44,540 - DEBUG - Node anomaly scores shape: torch.Size([24182, 1])
2025-06-03 10:27:44,557 - DEBUG - Edge anomaly scores shape: torch.Size([51403, 1])
2025-06-03 10:27:44,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:45,352 - DEBUG - Step 19: Loss=0.5659
2025-06-03 10:27:45,353 - DEBUG - Online update step: 20/50
2025-06-03 10:27:45,358 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:46,087 - DEBUG - Node anomaly scores shape: torch.Size([24139, 1])
2025-06-03 10:27:46,100 - DEBUG - Edge anomaly scores shape: torch.Size([51193, 1])
2025-06-03 10:27:46,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:46,922 - DEBUG - Step 20: Loss=0.5662
2025-06-03 10:27:46,923 - DEBUG - Online update step: 21/50
2025-06-03 10:27:46,927 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:47,678 - DEBUG - Node anomaly scores shape: torch.Size([24343, 1])
2025-06-03 10:27:47,695 - DEBUG - Edge anomaly scores shape: torch.Size([51707, 1])
2025-06-03 10:27:47,698 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:48,523 - DEBUG - Step 21: Loss=0.5669
2025-06-03 10:27:48,523 - DEBUG - Online update step: 22/50
2025-06-03 10:27:48,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:49,304 - DEBUG - Node anomaly scores shape: torch.Size([25022, 1])
2025-06-03 10:27:49,319 - DEBUG - Edge anomaly scores shape: torch.Size([53411, 1])
2025-06-03 10:27:49,322 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:50,140 - DEBUG - Step 22: Loss=0.5667
2025-06-03 10:27:50,140 - DEBUG - Online update step: 23/50
2025-06-03 10:27:50,145 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:50,830 - DEBUG - Node anomaly scores shape: torch.Size([23415, 1])
2025-06-03 10:27:50,846 - DEBUG - Edge anomaly scores shape: torch.Size([49558, 1])
2025-06-03 10:27:50,849 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:51,656 - DEBUG - Step 23: Loss=0.5683
2025-06-03 10:27:51,657 - DEBUG - Online update step: 24/50
2025-06-03 10:27:51,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:52,326 - DEBUG - Node anomaly scores shape: torch.Size([24304, 1])
2025-06-03 10:27:52,339 - DEBUG - Edge anomaly scores shape: torch.Size([51720, 1])
2025-06-03 10:27:52,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:53,034 - DEBUG - Step 24: Loss=0.5670
2025-06-03 10:27:53,034 - DEBUG - Online update step: 25/50
2025-06-03 10:27:53,037 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:53,703 - DEBUG - Node anomaly scores shape: torch.Size([24175, 1])
2025-06-03 10:27:53,724 - DEBUG - Edge anomaly scores shape: torch.Size([51413, 1])
2025-06-03 10:27:53,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:54,427 - DEBUG - Step 25: Loss=0.5677
2025-06-03 10:27:54,427 - DEBUG - Online update step: 26/50
2025-06-03 10:27:54,431 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:55,106 - DEBUG - Node anomaly scores shape: torch.Size([23329, 1])
2025-06-03 10:27:55,121 - DEBUG - Edge anomaly scores shape: torch.Size([49413, 1])
2025-06-03 10:27:55,123 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:55,875 - DEBUG - Step 26: Loss=0.5665
2025-06-03 10:27:55,875 - DEBUG - Online update step: 27/50
2025-06-03 10:27:55,880 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:56,580 - DEBUG - Node anomaly scores shape: torch.Size([23664, 1])
2025-06-03 10:27:56,595 - DEBUG - Edge anomaly scores shape: torch.Size([50128, 1])
2025-06-03 10:27:56,599 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:57,421 - DEBUG - Step 27: Loss=0.5675
2025-06-03 10:27:57,422 - DEBUG - Online update step: 28/50
2025-06-03 10:27:57,428 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:58,271 - DEBUG - Node anomaly scores shape: torch.Size([24948, 1])
2025-06-03 10:27:58,288 - DEBUG - Edge anomaly scores shape: torch.Size([53245, 1])
2025-06-03 10:27:58,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:27:59,205 - DEBUG - Step 28: Loss=0.5666
2025-06-03 10:27:59,206 - DEBUG - Online update step: 29/50
2025-06-03 10:27:59,214 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:27:59,987 - DEBUG - Node anomaly scores shape: torch.Size([24564, 1])
2025-06-03 10:28:00,002 - DEBUG - Edge anomaly scores shape: torch.Size([52346, 1])
2025-06-03 10:28:00,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:00,775 - DEBUG - Step 29: Loss=0.5670
2025-06-03 10:28:00,775 - DEBUG - Online update step: 30/50
2025-06-03 10:28:00,778 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:01,416 - DEBUG - Node anomaly scores shape: torch.Size([23556, 1])
2025-06-03 10:28:01,428 - DEBUG - Edge anomaly scores shape: torch.Size([49937, 1])
2025-06-03 10:28:01,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:02,193 - DEBUG - Step 30: Loss=0.5676
2025-06-03 10:28:02,193 - DEBUG - Online update step: 31/50
2025-06-03 10:28:02,199 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:02,867 - DEBUG - Node anomaly scores shape: torch.Size([24966, 1])
2025-06-03 10:28:02,881 - DEBUG - Edge anomaly scores shape: torch.Size([53264, 1])
2025-06-03 10:28:02,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:03,636 - DEBUG - Step 31: Loss=0.5682
2025-06-03 10:28:03,636 - DEBUG - Online update step: 32/50
2025-06-03 10:28:03,641 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:04,254 - DEBUG - Node anomaly scores shape: torch.Size([22494, 1])
2025-06-03 10:28:04,268 - DEBUG - Edge anomaly scores shape: torch.Size([47396, 1])
2025-06-03 10:28:04,269 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:05,035 - DEBUG - Step 32: Loss=0.5707
2025-06-03 10:28:05,036 - DEBUG - Online update step: 33/50
2025-06-03 10:28:05,039 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:05,718 - DEBUG - Node anomaly scores shape: torch.Size([23782, 1])
2025-06-03 10:28:05,732 - DEBUG - Edge anomaly scores shape: torch.Size([50413, 1])
2025-06-03 10:28:05,733 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:06,487 - DEBUG - Step 33: Loss=0.5672
2025-06-03 10:28:06,488 - DEBUG - Online update step: 34/50
2025-06-03 10:28:06,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:07,164 - DEBUG - Node anomaly scores shape: torch.Size([24238, 1])
2025-06-03 10:28:07,179 - DEBUG - Edge anomaly scores shape: torch.Size([51504, 1])
2025-06-03 10:28:07,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:07,903 - DEBUG - Step 34: Loss=0.5675
2025-06-03 10:28:07,903 - DEBUG - Online update step: 35/50
2025-06-03 10:28:07,906 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:08,615 - DEBUG - Node anomaly scores shape: torch.Size([25067, 1])
2025-06-03 10:28:08,630 - DEBUG - Edge anomaly scores shape: torch.Size([53382, 1])
2025-06-03 10:28:08,631 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:09,430 - DEBUG - Step 35: Loss=0.5684
2025-06-03 10:28:09,430 - DEBUG - Online update step: 36/50
2025-06-03 10:28:09,433 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:10,045 - DEBUG - Node anomaly scores shape: torch.Size([23433, 1])
2025-06-03 10:28:10,059 - DEBUG - Edge anomaly scores shape: torch.Size([49693, 1])
2025-06-03 10:28:10,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:10,785 - DEBUG - Step 36: Loss=0.5698
2025-06-03 10:28:10,785 - DEBUG - Online update step: 37/50
2025-06-03 10:28:10,788 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:11,497 - DEBUG - Node anomaly scores shape: torch.Size([24924, 1])
2025-06-03 10:28:11,511 - DEBUG - Edge anomaly scores shape: torch.Size([53114, 1])
2025-06-03 10:28:11,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:12,352 - DEBUG - Step 37: Loss=0.5706
2025-06-03 10:28:12,353 - DEBUG - Online update step: 38/50
2025-06-03 10:28:12,360 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:13,141 - DEBUG - Node anomaly scores shape: torch.Size([25538, 1])
2025-06-03 10:28:13,156 - DEBUG - Edge anomaly scores shape: torch.Size([54490, 1])
2025-06-03 10:28:13,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:13,923 - DEBUG - Step 38: Loss=0.5662
2025-06-03 10:28:13,924 - DEBUG - Online update step: 39/50
2025-06-03 10:28:13,927 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:14,584 - DEBUG - Node anomaly scores shape: torch.Size([24004, 1])
2025-06-03 10:28:14,598 - DEBUG - Edge anomaly scores shape: torch.Size([50869, 1])
2025-06-03 10:28:14,599 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:15,365 - DEBUG - Step 39: Loss=0.5690
2025-06-03 10:28:15,365 - DEBUG - Online update step: 40/50
2025-06-03 10:28:15,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:16,193 - DEBUG - Node anomaly scores shape: torch.Size([23264, 1])
2025-06-03 10:28:16,209 - DEBUG - Edge anomaly scores shape: torch.Size([49314, 1])
2025-06-03 10:28:16,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:17,349 - DEBUG - Step 40: Loss=0.5721
2025-06-03 10:28:17,349 - DEBUG - Online update step: 41/50
2025-06-03 10:28:17,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:18,359 - DEBUG - Node anomaly scores shape: torch.Size([23821, 1])
2025-06-03 10:28:18,379 - DEBUG - Edge anomaly scores shape: torch.Size([50564, 1])
2025-06-03 10:28:18,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:19,365 - DEBUG - Step 41: Loss=0.5673
2025-06-03 10:28:19,365 - DEBUG - Online update step: 42/50
2025-06-03 10:28:19,376 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:20,186 - DEBUG - Node anomaly scores shape: torch.Size([24955, 1])
2025-06-03 10:28:20,203 - DEBUG - Edge anomaly scores shape: torch.Size([53242, 1])
2025-06-03 10:28:20,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:21,040 - DEBUG - Step 42: Loss=0.5674
2025-06-03 10:28:21,040 - DEBUG - Online update step: 43/50
2025-06-03 10:28:21,047 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:21,924 - DEBUG - Node anomaly scores shape: torch.Size([24119, 1])
2025-06-03 10:28:21,944 - DEBUG - Edge anomaly scores shape: torch.Size([51208, 1])
2025-06-03 10:28:21,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:22,966 - DEBUG - Step 43: Loss=0.5701
2025-06-03 10:28:22,967 - DEBUG - Online update step: 44/50
2025-06-03 10:28:22,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:24,384 - DEBUG - Node anomaly scores shape: torch.Size([24558, 1])
2025-06-03 10:28:24,403 - DEBUG - Edge anomaly scores shape: torch.Size([52210, 1])
2025-06-03 10:28:24,406 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:25,236 - DEBUG - Step 44: Loss=0.5670
2025-06-03 10:28:25,236 - DEBUG - Online update step: 45/50
2025-06-03 10:28:25,240 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:25,880 - DEBUG - Node anomaly scores shape: torch.Size([23883, 1])
2025-06-03 10:28:25,897 - DEBUG - Edge anomaly scores shape: torch.Size([50652, 1])
2025-06-03 10:28:25,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:26,722 - DEBUG - Step 45: Loss=0.5678
2025-06-03 10:28:26,722 - DEBUG - Online update step: 46/50
2025-06-03 10:28:26,726 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:27,606 - DEBUG - Node anomaly scores shape: torch.Size([25007, 1])
2025-06-03 10:28:27,625 - DEBUG - Edge anomaly scores shape: torch.Size([53274, 1])
2025-06-03 10:28:27,627 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:28,868 - DEBUG - Step 46: Loss=0.5678
2025-06-03 10:28:28,869 - DEBUG - Online update step: 47/50
2025-06-03 10:28:28,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:29,650 - DEBUG - Node anomaly scores shape: torch.Size([24155, 1])
2025-06-03 10:28:29,664 - DEBUG - Edge anomaly scores shape: torch.Size([51366, 1])
2025-06-03 10:28:29,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:30,401 - DEBUG - Step 47: Loss=0.5676
2025-06-03 10:28:30,401 - DEBUG - Online update step: 48/50
2025-06-03 10:28:30,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:31,044 - DEBUG - Node anomaly scores shape: torch.Size([24432, 1])
2025-06-03 10:28:31,058 - DEBUG - Edge anomaly scores shape: torch.Size([51946, 1])
2025-06-03 10:28:31,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:31,824 - DEBUG - Step 48: Loss=0.5688
2025-06-03 10:28:31,825 - DEBUG - Online update step: 49/50
2025-06-03 10:28:31,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:32,483 - DEBUG - Node anomaly scores shape: torch.Size([24250, 1])
2025-06-03 10:28:32,497 - DEBUG - Edge anomaly scores shape: torch.Size([51503, 1])
2025-06-03 10:28:32,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:33,258 - DEBUG - Step 49: Loss=0.5671
2025-06-03 10:28:33,258 - DEBUG - Online update step: 50/50
2025-06-03 10:28:33,261 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:33,967 - DEBUG - Node anomaly scores shape: torch.Size([22152, 1])
2025-06-03 10:28:33,983 - DEBUG - Edge anomaly scores shape: torch.Size([46569, 1])
2025-06-03 10:28:33,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:34,768 - DEBUG - Step 50: Loss=0.5671
2025-06-03 10:28:34,769 - INFO - Online update finished. Average loss: 0.5677, Learning rate: 0.001000
2025-06-03 10:28:34,770 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:28:34,770 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:28:34,772 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:28:34,773 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-03 10:28:34,774 - INFO - Online update complete. Loss: 0.5677
2025-06-03 10:28:34,774 - INFO - Running anomaly detection...
2025-06-03 10:28:34,774 - INFO - Starting anomaly detection.
2025-06-03 10:28:34,804 - DEBUG - Node reconstruction errors: [0.00133206 0.0008995  0.00071732 ... 0.00061906 0.0006673  0.00600252]
2025-06-03 10:28:34,804 - DEBUG - Edge reconstruction errors: [0.1553078  1.6570965  1.6581169  ... 0.15482366 1.2534077  0.15481153]
2025-06-03 10:28:34,806 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_102834_update_46.json
2025-06-03 10:28:34,807 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:28:34,826 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_102834_update_46.pth and as latest_checkpoint.pth
2025-06-03 10:28:34,826 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870715.dot): 0.3565
2025-06-03 10:28:34,826 - WARNING - Detected 21 anomalous nodes (reconstruction-based):
2025-06-03 10:28:34,827 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0245, MLP Score: 0.5060
2025-06-03 10:28:34,827 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0339, MLP Score: 0.5059
2025-06-03 10:28:34,827 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0267, MLP Score: 0.4999
2025-06-03 10:28:34,827 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0373, MLP Score: 0.5021
2025-06-03 10:28:34,827 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0229, MLP Score: 0.5036
2025-06-03 10:28:34,827 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:28:34,827 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7223, MLP Score: 0.5003
2025-06-03 10:28:34,827 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3283, MLP Score: 0.5004
2025-06-03 10:28:34,827 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9130, MLP Score: 0.5010
2025-06-03 10:28:34,827 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3294, MLP Score: 0.4997
2025-06-03 10:28:34,827 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3380, MLP Score: 0.4998
2025-06-03 10:28:34,828 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:28:34,828 - INFO - Performing visualization of node and edge features.
2025-06-03 10:28:34,829 - INFO - Starting visualization of node features.
2025-06-03 10:28:34,830 - INFO - Graph has 1003 nodes and 30 features.
2025-06-03 10:28:34,830 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:28:34,830 - INFO - Calculating feature statistics:
2025-06-03 10:28:34,830 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,830 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,830 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(-3.04263e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.7199986), 'max': np.float32(2.4740193)}
2025-06-03 10:28:34,830 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(-6.08526e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3749828), 'max': np.float32(1.8203772)}
2025-06-03 10:28:34,831 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,831 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,831 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,831 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45654544), 'max': np.float32(2.1903625)}
2025-06-03 10:28:34,831 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1496779), 'max': np.float32(0.86980885)}
2025-06-03 10:28:34,831 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-9.436405), 'max': np.float32(0.108228795)}
2025-06-03 10:28:34,831 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(-3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2662325), 'max': np.float32(1.8184673)}
2025-06-03 10:28:34,831 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7536675), 'max': np.float32(2.3832464)}
2025-06-03 10:28:34,832 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2671983), 'std': np.float32(0.94219303), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-03 10:28:34,832 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9621136), 'std': np.float32(0.27264866), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:28:34,832 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:28:34,832 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3928213), 'std': np.float32(0.5729255), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:28:34,832 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108228795), 'max': np.float32(9.436405)}
2025-06-03 10:28:34,832 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.435693), 'std': np.float32(3.0227787), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:28:34,832 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.775673), 'std': np.float32(2.906747), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:28:34,832 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6131606), 'std': np.float32(1.4830064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:28:34,833 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:28:34,833 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993021), 'std': np.float32(0.22091796), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:28:34,833 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.1409862e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12744388), 'max': np.float32(16.54554)}
2025-06-03 10:28:34,833 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-7.606575e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13895662), 'max': np.float32(7.1964903)}
2025-06-03 10:28:34,833 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,833 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,833 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,833 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:28:34,833 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(1.521315e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9900672), 'max': np.float32(10.424156)}
2025-06-03 10:28:34,834 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0934536), 'max': np.float32(4.4456067)}
2025-06-03 10:28:34,854 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222bacea090>
2025-06-03 10:28:35,088 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:28:35,164 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:28:35,200 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:28:36,582 - INFO - Node feature visualization saved to vis/node_features_20250603_102835.png
2025-06-03 10:28:36,582 - INFO - Finished visualization of node features.
2025-06-03 10:28:36,582 - INFO - Performing additional feature analysis:
2025-06-03 10:28:36,583 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:28:36,584 - INFO - Starting visualization of edge features.
2025-06-03 10:28:36,584 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-03 10:28:36,584 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:28:36,584 - INFO - Calculating edge feature statistics:
2025-06-03 10:28:36,584 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:28:36,585 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.146685), 'std': np.float32(1.1018976), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-03 10:28:36,585 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4255222), 'std': np.float32(0.50622183), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:28:36,585 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.698456), 'std': np.float32(2.1359105), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:28:36,585 - INFO - - service: {'name': 'service', 'unique': 39, 'mean': np.float32(8.6618923e-10), 'std': np.float32(0.99999994), 'min': np.float32(-0.034784652), 'max': np.float32(33.15622)}
2025-06-03 10:28:36,585 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1480, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.059619874), 'max': np.float32(27.69297)}
2025-06-03 10:28:36,585 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1552, 'mean': np.float32(-3.464757e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05574152), 'max': np.float32(30.763012)}
2025-06-03 10:28:36,585 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 513, 'mean': np.float32(3.464757e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0433423), 'max': np.float32(33.037327)}
2025-06-03 10:28:36,585 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1525, 'mean': np.float32(3.464757e-09), 'std': np.float32(1.0), 'min': np.float32(-0.088083506), 'max': np.float32(28.738836)}
2025-06-03 10:28:36,585 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1556, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.087833084), 'max': np.float32(27.616938)}
2025-06-03 10:28:36,585 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 567, 'mean': np.float32(8.6618923e-10), 'std': np.float32(1.0000001), 'min': np.float32(-0.05223109), 'max': np.float32(32.468086)}
2025-06-03 10:28:36,596 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c34b1ee0>
2025-06-03 10:28:36,679 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:28:36,689 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c3742c60>
2025-06-03 10:28:36,772 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:28:36,946 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:28:37,129 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:28:37,149 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:28:37,156 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:28:38,616 - INFO - Edge feature visualization saved to vis/edge_features_20250603_102837.png
2025-06-03 10:28:38,617 - INFO - Finished visualization of edge features.
2025-06-03 10:28:38,617 - INFO - Performing additional edge feature analysis:
2025-06-03 10:28:38,617 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-03 10:28:38,618 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:28:38,619 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-03 10:28:38,619 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:28:39,276 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_102838_summary.png
2025-06-03 10:28:39,567 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_102838_pca_3d.png
2025-06-03 10:28:39,741 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_102838_pca_variance.png
2025-06-03 10:28:39,741 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:28:39,741 - INFO - 
--- Processing file: nw_graph_encoded_1748870745.dot (Timestamp: 2025-06-02 15:25:45) ---
2025-06-03 10:28:39,741 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-03 10:28:39,741 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-03 10:28:39,767 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-03 10:28:39,789 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-03 10:28:39,790 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-03 10:28:39,790 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-03 10:28:39,811 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-03 10:28:39,836 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-03 10:28:39,836 - INFO - Processing node updates/additions.
2025-06-03 10:28:39,843 - INFO - Processing edge updates/additions.
2025-06-03 10:28:39,857 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:28:39,858 - INFO - Finished updating NetworkX graph.
2025-06-03 10:28:39,858 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:28:39,859 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:28:39,870 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 10:28:39,873 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:28:39,873 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 10:28:39,875 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 10:28:39,876 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:28:39,881 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:28:39,883 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:28:39,884 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:28:39,886 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-03 10:28:39,887 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:28:39,887 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-03 10:28:39,887 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-03 10:28:39,887 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:28:39,890 - INFO - Performing online update...
2025-06-03 10:28:39,890 - INFO - Starting online update for 50 steps.
2025-06-03 10:28:39,890 - DEBUG - Updated RunningStats: new_mean=0.9502059485219757, new_var=27000000000161.348, new_n=2730
2025-06-03 10:28:39,890 - DEBUG - Updated RunningStats: new_mean=0.9479113057892375, new_var=27300000000018.367, new_n=2760
2025-06-03 10:28:39,891 - DEBUG - Updated RunningStats: new_mean=1.2312579090518811, new_var=9000000000093.277, new_n=910
2025-06-03 10:28:39,891 - DEBUG - Updated RunningStats: new_mean=1.2295556167936394, new_var=9100000000001.732, new_n=920
2025-06-03 10:28:39,891 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:28:39,891 - DEBUG - Online update step: 1/50
2025-06-03 10:28:39,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:40,693 - DEBUG - Node anomaly scores shape: torch.Size([23880, 1])
2025-06-03 10:28:40,707 - DEBUG - Edge anomaly scores shape: torch.Size([50571, 1])
2025-06-03 10:28:40,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:41,536 - DEBUG - Step 1: Loss=0.5680
2025-06-03 10:28:41,536 - DEBUG - Online update step: 2/50
2025-06-03 10:28:41,539 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:42,259 - DEBUG - Node anomaly scores shape: torch.Size([24759, 1])
2025-06-03 10:28:42,272 - DEBUG - Edge anomaly scores shape: torch.Size([52767, 1])
2025-06-03 10:28:42,274 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:43,127 - DEBUG - Step 2: Loss=0.5682
2025-06-03 10:28:43,127 - DEBUG - Online update step: 3/50
2025-06-03 10:28:43,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:43,891 - DEBUG - Node anomaly scores shape: torch.Size([24725, 1])
2025-06-03 10:28:43,906 - DEBUG - Edge anomaly scores shape: torch.Size([52677, 1])
2025-06-03 10:28:43,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:44,707 - DEBUG - Step 3: Loss=0.5700
2025-06-03 10:28:44,707 - DEBUG - Online update step: 4/50
2025-06-03 10:28:44,711 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:45,401 - DEBUG - Node anomaly scores shape: torch.Size([23279, 1])
2025-06-03 10:28:45,413 - DEBUG - Edge anomaly scores shape: torch.Size([49204, 1])
2025-06-03 10:28:45,414 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:46,550 - DEBUG - Step 4: Loss=0.5669
2025-06-03 10:28:46,550 - DEBUG - Online update step: 5/50
2025-06-03 10:28:46,553 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:47,576 - DEBUG - Node anomaly scores shape: torch.Size([23346, 1])
2025-06-03 10:28:47,616 - DEBUG - Edge anomaly scores shape: torch.Size([49401, 1])
2025-06-03 10:28:47,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:48,485 - DEBUG - Step 5: Loss=0.5674
2025-06-03 10:28:48,486 - DEBUG - Online update step: 6/50
2025-06-03 10:28:48,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:49,197 - DEBUG - Node anomaly scores shape: torch.Size([24870, 1])
2025-06-03 10:28:49,213 - DEBUG - Edge anomaly scores shape: torch.Size([53085, 1])
2025-06-03 10:28:49,216 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:50,082 - DEBUG - Step 6: Loss=0.5700
2025-06-03 10:28:50,082 - DEBUG - Online update step: 7/50
2025-06-03 10:28:50,085 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:50,922 - DEBUG - Node anomaly scores shape: torch.Size([24044, 1])
2025-06-03 10:28:50,950 - DEBUG - Edge anomaly scores shape: torch.Size([51090, 1])
2025-06-03 10:28:50,955 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:52,226 - DEBUG - Step 7: Loss=0.5684
2025-06-03 10:28:52,226 - DEBUG - Online update step: 8/50
2025-06-03 10:28:52,230 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:52,899 - DEBUG - Node anomaly scores shape: torch.Size([24178, 1])
2025-06-03 10:28:52,913 - DEBUG - Edge anomaly scores shape: torch.Size([51329, 1])
2025-06-03 10:28:52,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:53,676 - DEBUG - Step 8: Loss=0.5677
2025-06-03 10:28:53,676 - DEBUG - Online update step: 9/50
2025-06-03 10:28:53,680 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:54,339 - DEBUG - Node anomaly scores shape: torch.Size([23452, 1])
2025-06-03 10:28:54,352 - DEBUG - Edge anomaly scores shape: torch.Size([49645, 1])
2025-06-03 10:28:54,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:55,076 - DEBUG - Step 9: Loss=0.5667
2025-06-03 10:28:55,076 - DEBUG - Online update step: 10/50
2025-06-03 10:28:55,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:55,847 - DEBUG - Node anomaly scores shape: torch.Size([24738, 1])
2025-06-03 10:28:55,874 - DEBUG - Edge anomaly scores shape: torch.Size([52583, 1])
2025-06-03 10:28:55,875 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:56,660 - DEBUG - Step 10: Loss=0.5679
2025-06-03 10:28:56,661 - DEBUG - Online update step: 11/50
2025-06-03 10:28:56,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:57,385 - DEBUG - Node anomaly scores shape: torch.Size([24279, 1])
2025-06-03 10:28:57,400 - DEBUG - Edge anomaly scores shape: torch.Size([51623, 1])
2025-06-03 10:28:57,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:58,187 - DEBUG - Step 11: Loss=0.5695
2025-06-03 10:28:58,188 - DEBUG - Online update step: 12/50
2025-06-03 10:28:58,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:28:58,891 - DEBUG - Node anomaly scores shape: torch.Size([24187, 1])
2025-06-03 10:28:58,906 - DEBUG - Edge anomaly scores shape: torch.Size([51371, 1])
2025-06-03 10:28:58,907 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:28:59,633 - DEBUG - Step 12: Loss=0.5680
2025-06-03 10:28:59,634 - DEBUG - Online update step: 13/50
2025-06-03 10:28:59,637 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:00,302 - DEBUG - Node anomaly scores shape: torch.Size([24409, 1])
2025-06-03 10:29:00,315 - DEBUG - Edge anomaly scores shape: torch.Size([51945, 1])
2025-06-03 10:29:00,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:01,004 - DEBUG - Step 13: Loss=0.5664
2025-06-03 10:29:01,005 - DEBUG - Online update step: 14/50
2025-06-03 10:29:01,008 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:03,266 - DEBUG - Node anomaly scores shape: torch.Size([24765, 1])
2025-06-03 10:29:03,368 - DEBUG - Edge anomaly scores shape: torch.Size([52668, 1])
2025-06-03 10:29:03,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:06,937 - DEBUG - Step 14: Loss=0.5659
2025-06-03 10:29:06,941 - DEBUG - Online update step: 15/50
2025-06-03 10:29:06,945 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:08,958 - DEBUG - Node anomaly scores shape: torch.Size([23506, 1])
2025-06-03 10:29:09,097 - DEBUG - Edge anomaly scores shape: torch.Size([49908, 1])
2025-06-03 10:29:09,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:10,723 - DEBUG - Step 15: Loss=0.5679
2025-06-03 10:29:10,724 - DEBUG - Online update step: 16/50
2025-06-03 10:29:10,728 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:11,934 - DEBUG - Node anomaly scores shape: torch.Size([24580, 1])
2025-06-03 10:29:11,947 - DEBUG - Edge anomaly scores shape: torch.Size([52280, 1])
2025-06-03 10:29:11,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:12,809 - DEBUG - Step 16: Loss=0.5682
2025-06-03 10:29:12,810 - DEBUG - Online update step: 17/50
2025-06-03 10:29:12,813 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:13,850 - DEBUG - Node anomaly scores shape: torch.Size([24288, 1])
2025-06-03 10:29:13,863 - DEBUG - Edge anomaly scores shape: torch.Size([51667, 1])
2025-06-03 10:29:13,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:14,576 - DEBUG - Step 17: Loss=0.5670
2025-06-03 10:29:14,576 - DEBUG - Online update step: 18/50
2025-06-03 10:29:14,579 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:15,189 - DEBUG - Node anomaly scores shape: torch.Size([23717, 1])
2025-06-03 10:29:15,202 - DEBUG - Edge anomaly scores shape: torch.Size([50262, 1])
2025-06-03 10:29:15,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:16,021 - DEBUG - Step 18: Loss=0.5669
2025-06-03 10:29:16,021 - DEBUG - Online update step: 19/50
2025-06-03 10:29:16,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:17,143 - DEBUG - Node anomaly scores shape: torch.Size([24323, 1])
2025-06-03 10:29:17,182 - DEBUG - Edge anomaly scores shape: torch.Size([51727, 1])
2025-06-03 10:29:17,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:18,654 - DEBUG - Step 19: Loss=0.5662
2025-06-03 10:29:18,654 - DEBUG - Online update step: 20/50
2025-06-03 10:29:18,657 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:19,430 - DEBUG - Node anomaly scores shape: torch.Size([24229, 1])
2025-06-03 10:29:19,442 - DEBUG - Edge anomaly scores shape: torch.Size([51415, 1])
2025-06-03 10:29:19,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:20,397 - DEBUG - Step 20: Loss=0.5664
2025-06-03 10:29:20,397 - DEBUG - Online update step: 21/50
2025-06-03 10:29:20,400 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:21,396 - DEBUG - Node anomaly scores shape: torch.Size([24932, 1])
2025-06-03 10:29:21,410 - DEBUG - Edge anomaly scores shape: torch.Size([53061, 1])
2025-06-03 10:29:21,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:22,146 - DEBUG - Step 21: Loss=0.5659
2025-06-03 10:29:22,146 - DEBUG - Online update step: 22/50
2025-06-03 10:29:22,151 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:22,741 - DEBUG - Node anomaly scores shape: torch.Size([22689, 1])
2025-06-03 10:29:22,754 - DEBUG - Edge anomaly scores shape: torch.Size([47804, 1])
2025-06-03 10:29:22,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:23,657 - DEBUG - Step 22: Loss=0.5670
2025-06-03 10:29:23,659 - DEBUG - Online update step: 23/50
2025-06-03 10:29:23,668 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:24,599 - DEBUG - Node anomaly scores shape: torch.Size([24941, 1])
2025-06-03 10:29:24,624 - DEBUG - Edge anomaly scores shape: torch.Size([53191, 1])
2025-06-03 10:29:24,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:25,716 - DEBUG - Step 23: Loss=0.5659
2025-06-03 10:29:25,716 - DEBUG - Online update step: 24/50
2025-06-03 10:29:25,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:26,979 - DEBUG - Node anomaly scores shape: torch.Size([24810, 1])
2025-06-03 10:29:27,003 - DEBUG - Edge anomaly scores shape: torch.Size([52828, 1])
2025-06-03 10:29:27,004 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:28,167 - DEBUG - Step 24: Loss=0.5660
2025-06-03 10:29:28,167 - DEBUG - Online update step: 25/50
2025-06-03 10:29:28,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:29,124 - DEBUG - Node anomaly scores shape: torch.Size([23968, 1])
2025-06-03 10:29:29,139 - DEBUG - Edge anomaly scores shape: torch.Size([50855, 1])
2025-06-03 10:29:29,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:30,088 - DEBUG - Step 25: Loss=0.5659
2025-06-03 10:29:30,088 - DEBUG - Online update step: 26/50
2025-06-03 10:29:30,091 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:31,185 - DEBUG - Node anomaly scores shape: torch.Size([24531, 1])
2025-06-03 10:29:31,202 - DEBUG - Edge anomaly scores shape: torch.Size([52281, 1])
2025-06-03 10:29:31,203 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:32,040 - DEBUG - Step 26: Loss=0.5661
2025-06-03 10:29:32,040 - DEBUG - Online update step: 27/50
2025-06-03 10:29:32,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:32,655 - DEBUG - Node anomaly scores shape: torch.Size([22862, 1])
2025-06-03 10:29:32,666 - DEBUG - Edge anomaly scores shape: torch.Size([48203, 1])
2025-06-03 10:29:32,667 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:33,633 - DEBUG - Step 27: Loss=0.5658
2025-06-03 10:29:33,633 - DEBUG - Online update step: 28/50
2025-06-03 10:29:33,638 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:34,721 - DEBUG - Node anomaly scores shape: torch.Size([24536, 1])
2025-06-03 10:29:34,739 - DEBUG - Edge anomaly scores shape: torch.Size([52163, 1])
2025-06-03 10:29:34,740 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:35,896 - DEBUG - Step 28: Loss=0.5657
2025-06-03 10:29:35,897 - DEBUG - Online update step: 29/50
2025-06-03 10:29:35,900 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:36,575 - DEBUG - Node anomaly scores shape: torch.Size([23278, 1])
2025-06-03 10:29:36,592 - DEBUG - Edge anomaly scores shape: torch.Size([49100, 1])
2025-06-03 10:29:36,594 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:37,394 - DEBUG - Step 29: Loss=0.5659
2025-06-03 10:29:37,394 - DEBUG - Online update step: 30/50
2025-06-03 10:29:37,398 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:38,059 - DEBUG - Node anomaly scores shape: torch.Size([23370, 1])
2025-06-03 10:29:38,071 - DEBUG - Edge anomaly scores shape: torch.Size([49486, 1])
2025-06-03 10:29:38,072 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:38,770 - DEBUG - Step 30: Loss=0.5660
2025-06-03 10:29:38,771 - DEBUG - Online update step: 31/50
2025-06-03 10:29:38,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:39,476 - DEBUG - Node anomaly scores shape: torch.Size([24347, 1])
2025-06-03 10:29:39,489 - DEBUG - Edge anomaly scores shape: torch.Size([51863, 1])
2025-06-03 10:29:39,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:40,297 - DEBUG - Step 31: Loss=0.5656
2025-06-03 10:29:40,298 - DEBUG - Online update step: 32/50
2025-06-03 10:29:40,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:40,990 - DEBUG - Node anomaly scores shape: torch.Size([24761, 1])
2025-06-03 10:29:41,004 - DEBUG - Edge anomaly scores shape: torch.Size([52864, 1])
2025-06-03 10:29:41,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:41,751 - DEBUG - Step 32: Loss=0.5655
2025-06-03 10:29:41,751 - DEBUG - Online update step: 33/50
2025-06-03 10:29:41,754 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:42,416 - DEBUG - Node anomaly scores shape: torch.Size([24085, 1])
2025-06-03 10:29:42,431 - DEBUG - Edge anomaly scores shape: torch.Size([51234, 1])
2025-06-03 10:29:42,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:43,152 - DEBUG - Step 33: Loss=0.5661
2025-06-03 10:29:43,152 - DEBUG - Online update step: 34/50
2025-06-03 10:29:43,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:43,870 - DEBUG - Node anomaly scores shape: torch.Size([25116, 1])
2025-06-03 10:29:43,884 - DEBUG - Edge anomaly scores shape: torch.Size([53595, 1])
2025-06-03 10:29:43,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:44,733 - DEBUG - Step 34: Loss=0.5655
2025-06-03 10:29:44,734 - DEBUG - Online update step: 35/50
2025-06-03 10:29:44,740 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:45,450 - DEBUG - Node anomaly scores shape: torch.Size([24267, 1])
2025-06-03 10:29:45,468 - DEBUG - Edge anomaly scores shape: torch.Size([51614, 1])
2025-06-03 10:29:45,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:46,280 - DEBUG - Step 35: Loss=0.5663
2025-06-03 10:29:46,280 - DEBUG - Online update step: 36/50
2025-06-03 10:29:46,284 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:47,006 - DEBUG - Node anomaly scores shape: torch.Size([25266, 1])
2025-06-03 10:29:47,025 - DEBUG - Edge anomaly scores shape: torch.Size([53936, 1])
2025-06-03 10:29:47,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:47,919 - DEBUG - Step 36: Loss=0.5661
2025-06-03 10:29:47,919 - DEBUG - Online update step: 37/50
2025-06-03 10:29:47,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:48,568 - DEBUG - Node anomaly scores shape: torch.Size([23684, 1])
2025-06-03 10:29:48,582 - DEBUG - Edge anomaly scores shape: torch.Size([50189, 1])
2025-06-03 10:29:48,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:49,402 - DEBUG - Step 37: Loss=0.5678
2025-06-03 10:29:49,403 - DEBUG - Online update step: 38/50
2025-06-03 10:29:49,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:50,140 - DEBUG - Node anomaly scores shape: torch.Size([24029, 1])
2025-06-03 10:29:50,156 - DEBUG - Edge anomaly scores shape: torch.Size([50997, 1])
2025-06-03 10:29:50,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:50,999 - DEBUG - Step 38: Loss=0.5674
2025-06-03 10:29:50,999 - DEBUG - Online update step: 39/50
2025-06-03 10:29:51,003 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:51,728 - DEBUG - Node anomaly scores shape: torch.Size([24865, 1])
2025-06-03 10:29:51,741 - DEBUG - Edge anomaly scores shape: torch.Size([52872, 1])
2025-06-03 10:29:51,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:52,506 - DEBUG - Step 39: Loss=0.5689
2025-06-03 10:29:52,506 - DEBUG - Online update step: 40/50
2025-06-03 10:29:52,510 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:53,165 - DEBUG - Node anomaly scores shape: torch.Size([23375, 1])
2025-06-03 10:29:53,178 - DEBUG - Edge anomaly scores shape: torch.Size([49544, 1])
2025-06-03 10:29:53,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:54,223 - DEBUG - Step 40: Loss=0.5682
2025-06-03 10:29:54,223 - DEBUG - Online update step: 41/50
2025-06-03 10:29:54,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:55,523 - DEBUG - Node anomaly scores shape: torch.Size([24304, 1])
2025-06-03 10:29:55,535 - DEBUG - Edge anomaly scores shape: torch.Size([51716, 1])
2025-06-03 10:29:55,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:56,445 - DEBUG - Step 41: Loss=0.5655
2025-06-03 10:29:56,446 - DEBUG - Online update step: 42/50
2025-06-03 10:29:56,449 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:57,245 - DEBUG - Node anomaly scores shape: torch.Size([23939, 1])
2025-06-03 10:29:57,284 - DEBUG - Edge anomaly scores shape: torch.Size([50915, 1])
2025-06-03 10:29:57,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:29:58,905 - DEBUG - Step 42: Loss=0.5677
2025-06-03 10:29:58,905 - DEBUG - Online update step: 43/50
2025-06-03 10:29:58,910 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:29:59,645 - DEBUG - Node anomaly scores shape: torch.Size([23212, 1])
2025-06-03 10:29:59,656 - DEBUG - Edge anomaly scores shape: torch.Size([49188, 1])
2025-06-03 10:29:59,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:00,427 - DEBUG - Step 43: Loss=0.5687
2025-06-03 10:30:00,427 - DEBUG - Online update step: 44/50
2025-06-03 10:30:00,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:01,202 - DEBUG - Node anomaly scores shape: torch.Size([24671, 1])
2025-06-03 10:30:01,221 - DEBUG - Edge anomaly scores shape: torch.Size([52521, 1])
2025-06-03 10:30:01,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:02,140 - DEBUG - Step 44: Loss=0.5669
2025-06-03 10:30:02,141 - DEBUG - Online update step: 45/50
2025-06-03 10:30:02,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:02,832 - DEBUG - Node anomaly scores shape: torch.Size([24589, 1])
2025-06-03 10:30:02,845 - DEBUG - Edge anomaly scores shape: torch.Size([52386, 1])
2025-06-03 10:30:02,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:03,538 - DEBUG - Step 45: Loss=0.5674
2025-06-03 10:30:03,539 - DEBUG - Online update step: 46/50
2025-06-03 10:30:03,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:04,240 - DEBUG - Node anomaly scores shape: torch.Size([24411, 1])
2025-06-03 10:30:04,253 - DEBUG - Edge anomaly scores shape: torch.Size([51883, 1])
2025-06-03 10:30:04,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:05,151 - DEBUG - Step 46: Loss=0.5659
2025-06-03 10:30:05,151 - DEBUG - Online update step: 47/50
2025-06-03 10:30:05,154 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:05,891 - DEBUG - Node anomaly scores shape: torch.Size([22791, 1])
2025-06-03 10:30:05,909 - DEBUG - Edge anomaly scores shape: torch.Size([48086, 1])
2025-06-03 10:30:05,911 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:06,686 - DEBUG - Step 47: Loss=0.5671
2025-06-03 10:30:06,686 - DEBUG - Online update step: 48/50
2025-06-03 10:30:06,690 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:07,314 - DEBUG - Node anomaly scores shape: torch.Size([23163, 1])
2025-06-03 10:30:07,328 - DEBUG - Edge anomaly scores shape: torch.Size([48999, 1])
2025-06-03 10:30:07,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:08,009 - DEBUG - Step 48: Loss=0.5677
2025-06-03 10:30:08,010 - DEBUG - Online update step: 49/50
2025-06-03 10:30:08,013 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:08,655 - DEBUG - Node anomaly scores shape: torch.Size([23864, 1])
2025-06-03 10:30:08,674 - DEBUG - Edge anomaly scores shape: torch.Size([50715, 1])
2025-06-03 10:30:08,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:09,429 - DEBUG - Step 49: Loss=0.5665
2025-06-03 10:30:09,429 - DEBUG - Online update step: 50/50
2025-06-03 10:30:09,434 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:10,064 - DEBUG - Node anomaly scores shape: torch.Size([23101, 1])
2025-06-03 10:30:10,075 - DEBUG - Edge anomaly scores shape: torch.Size([48890, 1])
2025-06-03 10:30:10,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:10,784 - DEBUG - Step 50: Loss=0.5681
2025-06-03 10:30:10,785 - INFO - Online update finished. Average loss: 0.5671, Learning rate: 0.001000
2025-06-03 10:30:10,785 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:30:10,786 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:30:10,787 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.6065749e-09 -3.2327943e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.7049312e-09
  7.8442799e-09 -1.7827909e-09 -6.1803420e-09 -6.6557528e-09
  2.2671983e+00  2.9621136e+00  1.4955135e-01  4.3928213e+00
  1.7827909e-09  3.4356930e+00  5.7756729e+00  7.6131606e+00
  1.4955135e-01  7.9930210e+00 -1.8897584e-08 -1.5213150e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.9016437e-09  3.9459106e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
 -8.6618923e-10 -1.7323785e-09 -2.5985676e-09  0.0000000e+00
  1.7323785e-09  2.5985676e-09]
2025-06-03 10:30:10,787 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-03 10:30:10,787 - INFO - Online update complete. Loss: 0.5671
2025-06-03 10:30:10,787 - INFO - Running anomaly detection...
2025-06-03 10:30:10,788 - INFO - Starting anomaly detection.
2025-06-03 10:30:10,815 - DEBUG - Node reconstruction errors: [0.00125162 0.00258504 0.00188982 ... 0.00390485 0.00350453 0.00556425]
2025-06-03 10:30:10,815 - DEBUG - Edge reconstruction errors: [0.15516533 1.6570084  1.6580365  ... 0.1546069  1.252943   0.15457459]
2025-06-03 10:30:10,819 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103010_update_47.json
2025-06-03 10:30:10,819 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:30:10,837 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103010_update_47.pth and as latest_checkpoint.pth
2025-06-03 10:30:10,838 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870745.dot): 0.3601
2025-06-03 10:30:10,838 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-03 10:30:10,838 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0280, MLP Score: 0.4965
2025-06-03 10:30:10,838 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0323, MLP Score: 0.4992
2025-06-03 10:30:10,838 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0188, MLP Score: 0.4954
2025-06-03 10:30:10,838 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0491, MLP Score: 0.4957
2025-06-03 10:30:10,838 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0247, MLP Score: 0.4910
2025-06-03 10:30:10,838 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:30:10,838 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7222, MLP Score: 0.4997
2025-06-03 10:30:10,838 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3282, MLP Score: 0.4996
2025-06-03 10:30:10,838 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9130, MLP Score: 0.5003
2025-06-03 10:30:10,838 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3294, MLP Score: 0.4991
2025-06-03 10:30:10,839 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3380, MLP Score: 0.4992
2025-06-03 10:30:10,839 - INFO - 
--- Processing file: nw_graph_encoded_1748870775.dot (Timestamp: 2025-06-02 15:26:15) ---
2025-06-03 10:30:10,839 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-03 10:30:10,839 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-03 10:30:10,892 - INFO - Parsed 1005 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-03 10:30:10,919 - INFO - Parsed 2207 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-03 10:30:10,920 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-03 10:30:10,920 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-03 10:30:10,943 - INFO - Parsed 1005 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-03 10:30:10,967 - INFO - Parsed 2207 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-03 10:30:10,968 - INFO - Processing node updates/additions.
2025-06-03 10:30:10,974 - INFO - Processing edge updates/additions.
2025-06-03 10:30:10,986 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:30:10,987 - INFO - Finished updating NetworkX graph.
2025-06-03 10:30:10,988 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:30:10,988 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:30:10,998 - DEBUG - Initial node features tensor shape: torch.Size([1005, 30])
2025-06-03 10:30:11,000 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:30:11,000 - DEBUG - Node features tensor shape after scaling: torch.Size([1005, 30])
2025-06-03 10:30:11,001 - DEBUG - Edge index tensor shape: torch.Size([2, 2207])
2025-06-03 10:30:11,002 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:30:11,008 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:30:11,009 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:30:11,010 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:30:11,012 - DEBUG - Shape of encoded categorical edge features: torch.Size([2207, 3])
2025-06-03 10:30:11,013 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:30:11,013 - DEBUG - Shape of scaled numerical edge features: torch.Size([2207, 7])
2025-06-03 10:30:11,013 - DEBUG - Final edge attributes tensor shape: torch.Size([2207, 10])
2025-06-03 10:30:11,013 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:30:11,016 - INFO - Performing online update...
2025-06-03 10:30:11,016 - INFO - Starting online update for 50 steps.
2025-06-03 10:30:11,017 - DEBUG - Updated RunningStats: new_mean=0.9501693608610303, new_var=27600000000161.387, new_n=2790
2025-06-03 10:30:11,017 - DEBUG - Updated RunningStats: new_mean=0.947922651917913, new_var=27900000000018.35, new_n=2820
2025-06-03 10:30:11,017 - DEBUG - Updated RunningStats: new_mean=1.2338317022331373, new_var=9200000000093.277, new_n=930
2025-06-03 10:30:11,017 - DEBUG - Updated RunningStats: new_mean=1.232135135803585, new_var=9300000000001.738, new_n=940
2025-06-03 10:30:11,017 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:30:11,017 - DEBUG - Online update step: 1/50
2025-06-03 10:30:11,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:11,756 - DEBUG - Node anomaly scores shape: torch.Size([24955, 1])
2025-06-03 10:30:11,770 - DEBUG - Edge anomaly scores shape: torch.Size([53137, 1])
2025-06-03 10:30:11,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:12,576 - DEBUG - Step 1: Loss=0.5680
2025-06-03 10:30:12,576 - DEBUG - Online update step: 2/50
2025-06-03 10:30:12,580 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:13,412 - DEBUG - Node anomaly scores shape: torch.Size([24361, 1])
2025-06-03 10:30:13,426 - DEBUG - Edge anomaly scores shape: torch.Size([51789, 1])
2025-06-03 10:30:13,429 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:14,180 - DEBUG - Step 2: Loss=0.5662
2025-06-03 10:30:14,181 - DEBUG - Online update step: 3/50
2025-06-03 10:30:14,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:14,920 - DEBUG - Node anomaly scores shape: torch.Size([25201, 1])
2025-06-03 10:30:14,938 - DEBUG - Edge anomaly scores shape: torch.Size([53729, 1])
2025-06-03 10:30:14,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:15,740 - DEBUG - Step 3: Loss=0.5679
2025-06-03 10:30:15,741 - DEBUG - Online update step: 4/50
2025-06-03 10:30:15,745 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:16,394 - DEBUG - Node anomaly scores shape: torch.Size([23140, 1])
2025-06-03 10:30:16,407 - DEBUG - Edge anomaly scores shape: torch.Size([48775, 1])
2025-06-03 10:30:16,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:17,166 - DEBUG - Step 4: Loss=0.5677
2025-06-03 10:30:17,166 - DEBUG - Online update step: 5/50
2025-06-03 10:30:17,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:17,871 - DEBUG - Node anomaly scores shape: torch.Size([24135, 1])
2025-06-03 10:30:17,884 - DEBUG - Edge anomaly scores shape: torch.Size([51195, 1])
2025-06-03 10:30:17,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:18,615 - DEBUG - Step 5: Loss=0.5651
2025-06-03 10:30:18,616 - DEBUG - Online update step: 6/50
2025-06-03 10:30:18,621 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:19,316 - DEBUG - Node anomaly scores shape: torch.Size([24354, 1])
2025-06-03 10:30:19,330 - DEBUG - Edge anomaly scores shape: torch.Size([51779, 1])
2025-06-03 10:30:19,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:20,075 - DEBUG - Step 6: Loss=0.5679
2025-06-03 10:30:20,076 - DEBUG - Online update step: 7/50
2025-06-03 10:30:20,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:20,757 - DEBUG - Node anomaly scores shape: torch.Size([23771, 1])
2025-06-03 10:30:20,771 - DEBUG - Edge anomaly scores shape: torch.Size([50480, 1])
2025-06-03 10:30:20,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:21,490 - DEBUG - Step 7: Loss=0.5694
2025-06-03 10:30:21,491 - DEBUG - Online update step: 8/50
2025-06-03 10:30:21,494 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:22,136 - DEBUG - Node anomaly scores shape: torch.Size([23604, 1])
2025-06-03 10:30:22,149 - DEBUG - Edge anomaly scores shape: torch.Size([49966, 1])
2025-06-03 10:30:22,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:22,898 - DEBUG - Step 8: Loss=0.5690
2025-06-03 10:30:22,899 - DEBUG - Online update step: 9/50
2025-06-03 10:30:22,902 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:23,582 - DEBUG - Node anomaly scores shape: torch.Size([24665, 1])
2025-06-03 10:30:23,595 - DEBUG - Edge anomaly scores shape: torch.Size([52484, 1])
2025-06-03 10:30:23,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:24,363 - DEBUG - Step 9: Loss=0.5691
2025-06-03 10:30:24,363 - DEBUG - Online update step: 10/50
2025-06-03 10:30:24,366 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:25,045 - DEBUG - Node anomaly scores shape: torch.Size([23671, 1])
2025-06-03 10:30:25,058 - DEBUG - Edge anomaly scores shape: torch.Size([50187, 1])
2025-06-03 10:30:25,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:25,769 - DEBUG - Step 10: Loss=0.5687
2025-06-03 10:30:25,769 - DEBUG - Online update step: 11/50
2025-06-03 10:30:25,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:26,393 - DEBUG - Node anomaly scores shape: torch.Size([23457, 1])
2025-06-03 10:30:26,406 - DEBUG - Edge anomaly scores shape: torch.Size([49747, 1])
2025-06-03 10:30:26,408 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:27,085 - DEBUG - Step 11: Loss=0.5668
2025-06-03 10:30:27,085 - DEBUG - Online update step: 12/50
2025-06-03 10:30:27,088 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:27,790 - DEBUG - Node anomaly scores shape: torch.Size([25331, 1])
2025-06-03 10:30:27,803 - DEBUG - Edge anomaly scores shape: torch.Size([54067, 1])
2025-06-03 10:30:27,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:28,567 - DEBUG - Step 12: Loss=0.5671
2025-06-03 10:30:28,567 - DEBUG - Online update step: 13/50
2025-06-03 10:30:28,570 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:29,198 - DEBUG - Node anomaly scores shape: torch.Size([24400, 1])
2025-06-03 10:30:29,212 - DEBUG - Edge anomaly scores shape: torch.Size([52013, 1])
2025-06-03 10:30:29,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:29,954 - DEBUG - Step 13: Loss=0.5701
2025-06-03 10:30:29,954 - DEBUG - Online update step: 14/50
2025-06-03 10:30:29,958 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:30,600 - DEBUG - Node anomaly scores shape: torch.Size([24281, 1])
2025-06-03 10:30:30,615 - DEBUG - Edge anomaly scores shape: torch.Size([51699, 1])
2025-06-03 10:30:30,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:31,306 - DEBUG - Step 14: Loss=0.5682
2025-06-03 10:30:31,307 - DEBUG - Online update step: 15/50
2025-06-03 10:30:31,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:32,012 - DEBUG - Node anomaly scores shape: torch.Size([26081, 1])
2025-06-03 10:30:32,026 - DEBUG - Edge anomaly scores shape: torch.Size([55871, 1])
2025-06-03 10:30:32,028 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:32,849 - DEBUG - Step 15: Loss=0.5688
2025-06-03 10:30:32,850 - DEBUG - Online update step: 16/50
2025-06-03 10:30:32,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:33,546 - DEBUG - Node anomaly scores shape: torch.Size([24082, 1])
2025-06-03 10:30:33,558 - DEBUG - Edge anomaly scores shape: torch.Size([51197, 1])
2025-06-03 10:30:33,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:34,308 - DEBUG - Step 16: Loss=0.5679
2025-06-03 10:30:34,308 - DEBUG - Online update step: 17/50
2025-06-03 10:30:34,311 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:34,955 - DEBUG - Node anomaly scores shape: torch.Size([23878, 1])
2025-06-03 10:30:34,968 - DEBUG - Edge anomaly scores shape: torch.Size([50773, 1])
2025-06-03 10:30:34,969 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:35,685 - DEBUG - Step 17: Loss=0.5659
2025-06-03 10:30:35,686 - DEBUG - Online update step: 18/50
2025-06-03 10:30:35,689 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:36,358 - DEBUG - Node anomaly scores shape: torch.Size([24989, 1])
2025-06-03 10:30:36,374 - DEBUG - Edge anomaly scores shape: torch.Size([53264, 1])
2025-06-03 10:30:36,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:37,148 - DEBUG - Step 18: Loss=0.5678
2025-06-03 10:30:37,148 - DEBUG - Online update step: 19/50
2025-06-03 10:30:37,151 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:37,852 - DEBUG - Node anomaly scores shape: torch.Size([23676, 1])
2025-06-03 10:30:37,864 - DEBUG - Edge anomaly scores shape: torch.Size([50167, 1])
2025-06-03 10:30:37,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:38,634 - DEBUG - Step 19: Loss=0.5701
2025-06-03 10:30:38,635 - DEBUG - Online update step: 20/50
2025-06-03 10:30:38,637 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:39,162 - DEBUG - Node anomaly scores shape: torch.Size([23927, 1])
2025-06-03 10:30:39,174 - DEBUG - Edge anomaly scores shape: torch.Size([50782, 1])
2025-06-03 10:30:39,175 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:39,820 - DEBUG - Step 20: Loss=0.5686
2025-06-03 10:30:39,820 - DEBUG - Online update step: 21/50
2025-06-03 10:30:39,824 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:40,375 - DEBUG - Node anomaly scores shape: torch.Size([23558, 1])
2025-06-03 10:30:40,386 - DEBUG - Edge anomaly scores shape: torch.Size([49990, 1])
2025-06-03 10:30:40,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:40,979 - DEBUG - Step 21: Loss=0.5670
2025-06-03 10:30:40,979 - DEBUG - Online update step: 22/50
2025-06-03 10:30:40,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:41,517 - DEBUG - Node anomaly scores shape: torch.Size([23443, 1])
2025-06-03 10:30:41,528 - DEBUG - Edge anomaly scores shape: torch.Size([49626, 1])
2025-06-03 10:30:41,529 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:42,116 - DEBUG - Step 22: Loss=0.5669
2025-06-03 10:30:42,116 - DEBUG - Online update step: 23/50
2025-06-03 10:30:42,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:42,755 - DEBUG - Node anomaly scores shape: torch.Size([23651, 1])
2025-06-03 10:30:42,771 - DEBUG - Edge anomaly scores shape: torch.Size([50198, 1])
2025-06-03 10:30:42,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:43,531 - DEBUG - Step 23: Loss=0.5655
2025-06-03 10:30:43,532 - DEBUG - Online update step: 24/50
2025-06-03 10:30:43,535 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:44,193 - DEBUG - Node anomaly scores shape: torch.Size([24734, 1])
2025-06-03 10:30:44,209 - DEBUG - Edge anomaly scores shape: torch.Size([52688, 1])
2025-06-03 10:30:44,212 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:45,044 - DEBUG - Step 24: Loss=0.5683
2025-06-03 10:30:45,044 - DEBUG - Online update step: 25/50
2025-06-03 10:30:45,047 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:45,585 - DEBUG - Node anomaly scores shape: torch.Size([23883, 1])
2025-06-03 10:30:45,599 - DEBUG - Edge anomaly scores shape: torch.Size([50815, 1])
2025-06-03 10:30:45,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:46,448 - DEBUG - Step 25: Loss=0.5692
2025-06-03 10:30:46,448 - DEBUG - Online update step: 26/50
2025-06-03 10:30:46,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:47,590 - DEBUG - Node anomaly scores shape: torch.Size([24279, 1])
2025-06-03 10:30:47,608 - DEBUG - Edge anomaly scores shape: torch.Size([51669, 1])
2025-06-03 10:30:47,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:48,500 - DEBUG - Step 26: Loss=0.5666
2025-06-03 10:30:48,500 - DEBUG - Online update step: 27/50
2025-06-03 10:30:48,504 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:49,228 - DEBUG - Node anomaly scores shape: torch.Size([25501, 1])
2025-06-03 10:30:49,244 - DEBUG - Edge anomaly scores shape: torch.Size([54486, 1])
2025-06-03 10:30:49,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:50,118 - DEBUG - Step 27: Loss=0.5671
2025-06-03 10:30:50,118 - DEBUG - Online update step: 28/50
2025-06-03 10:30:50,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:50,843 - DEBUG - Node anomaly scores shape: torch.Size([25040, 1])
2025-06-03 10:30:50,856 - DEBUG - Edge anomaly scores shape: torch.Size([53486, 1])
2025-06-03 10:30:50,857 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:51,768 - DEBUG - Step 28: Loss=0.5680
2025-06-03 10:30:51,769 - DEBUG - Online update step: 29/50
2025-06-03 10:30:51,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:52,505 - DEBUG - Node anomaly scores shape: torch.Size([25844, 1])
2025-06-03 10:30:52,522 - DEBUG - Edge anomaly scores shape: torch.Size([55259, 1])
2025-06-03 10:30:52,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:53,306 - DEBUG - Step 29: Loss=0.5663
2025-06-03 10:30:53,306 - DEBUG - Online update step: 30/50
2025-06-03 10:30:53,310 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:54,022 - DEBUG - Node anomaly scores shape: torch.Size([24973, 1])
2025-06-03 10:30:54,036 - DEBUG - Edge anomaly scores shape: torch.Size([53391, 1])
2025-06-03 10:30:54,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:54,775 - DEBUG - Step 30: Loss=0.5665
2025-06-03 10:30:54,775 - DEBUG - Online update step: 31/50
2025-06-03 10:30:54,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:55,359 - DEBUG - Node anomaly scores shape: torch.Size([24329, 1])
2025-06-03 10:30:55,373 - DEBUG - Edge anomaly scores shape: torch.Size([51766, 1])
2025-06-03 10:30:55,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:56,102 - DEBUG - Step 31: Loss=0.5676
2025-06-03 10:30:56,102 - DEBUG - Online update step: 32/50
2025-06-03 10:30:56,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:56,742 - DEBUG - Node anomaly scores shape: torch.Size([24332, 1])
2025-06-03 10:30:56,760 - DEBUG - Edge anomaly scores shape: torch.Size([51783, 1])
2025-06-03 10:30:56,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:57,547 - DEBUG - Step 32: Loss=0.5664
2025-06-03 10:30:57,548 - DEBUG - Online update step: 33/50
2025-06-03 10:30:57,550 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:58,157 - DEBUG - Node anomaly scores shape: torch.Size([24111, 1])
2025-06-03 10:30:58,175 - DEBUG - Edge anomaly scores shape: torch.Size([51287, 1])
2025-06-03 10:30:58,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:30:58,897 - DEBUG - Step 33: Loss=0.5667
2025-06-03 10:30:58,897 - DEBUG - Online update step: 34/50
2025-06-03 10:30:58,900 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:30:59,534 - DEBUG - Node anomaly scores shape: torch.Size([23847, 1])
2025-06-03 10:30:59,552 - DEBUG - Edge anomaly scores shape: torch.Size([50678, 1])
2025-06-03 10:30:59,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:00,293 - DEBUG - Step 34: Loss=0.5680
2025-06-03 10:31:00,293 - DEBUG - Online update step: 35/50
2025-06-03 10:31:00,295 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:00,986 - DEBUG - Node anomaly scores shape: torch.Size([25653, 1])
2025-06-03 10:31:01,000 - DEBUG - Edge anomaly scores shape: torch.Size([54776, 1])
2025-06-03 10:31:01,001 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:01,686 - DEBUG - Step 35: Loss=0.5675
2025-06-03 10:31:01,686 - DEBUG - Online update step: 36/50
2025-06-03 10:31:01,688 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:02,328 - DEBUG - Node anomaly scores shape: torch.Size([24210, 1])
2025-06-03 10:31:02,349 - DEBUG - Edge anomaly scores shape: torch.Size([51385, 1])
2025-06-03 10:31:02,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:03,121 - DEBUG - Step 36: Loss=0.5712
2025-06-03 10:31:03,121 - DEBUG - Online update step: 37/50
2025-06-03 10:31:03,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:03,906 - DEBUG - Node anomaly scores shape: torch.Size([23861, 1])
2025-06-03 10:31:03,920 - DEBUG - Edge anomaly scores shape: torch.Size([50739, 1])
2025-06-03 10:31:03,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:04,758 - DEBUG - Step 37: Loss=0.5695
2025-06-03 10:31:04,759 - DEBUG - Online update step: 38/50
2025-06-03 10:31:04,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:05,331 - DEBUG - Node anomaly scores shape: torch.Size([22788, 1])
2025-06-03 10:31:05,365 - DEBUG - Edge anomaly scores shape: torch.Size([48102, 1])
2025-06-03 10:31:05,367 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:06,153 - DEBUG - Step 38: Loss=0.5671
2025-06-03 10:31:06,155 - DEBUG - Online update step: 39/50
2025-06-03 10:31:06,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:06,747 - DEBUG - Node anomaly scores shape: torch.Size([23921, 1])
2025-06-03 10:31:06,759 - DEBUG - Edge anomaly scores shape: torch.Size([50873, 1])
2025-06-03 10:31:06,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:07,315 - DEBUG - Step 39: Loss=0.5656
2025-06-03 10:31:07,316 - DEBUG - Online update step: 40/50
2025-06-03 10:31:07,318 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:07,966 - DEBUG - Node anomaly scores shape: torch.Size([24480, 1])
2025-06-03 10:31:07,979 - DEBUG - Edge anomaly scores shape: torch.Size([52046, 1])
2025-06-03 10:31:07,980 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:08,698 - DEBUG - Step 40: Loss=0.5674
2025-06-03 10:31:08,698 - DEBUG - Online update step: 41/50
2025-06-03 10:31:08,700 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:09,443 - DEBUG - Node anomaly scores shape: torch.Size([25141, 1])
2025-06-03 10:31:09,456 - DEBUG - Edge anomaly scores shape: torch.Size([53685, 1])
2025-06-03 10:31:09,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:10,149 - DEBUG - Step 41: Loss=0.5666
2025-06-03 10:31:10,149 - DEBUG - Online update step: 42/50
2025-06-03 10:31:10,153 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:11,041 - DEBUG - Node anomaly scores shape: torch.Size([25059, 1])
2025-06-03 10:31:11,072 - DEBUG - Edge anomaly scores shape: torch.Size([53528, 1])
2025-06-03 10:31:11,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:11,949 - DEBUG - Step 42: Loss=0.5678
2025-06-03 10:31:11,949 - DEBUG - Online update step: 43/50
2025-06-03 10:31:11,951 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:12,643 - DEBUG - Node anomaly scores shape: torch.Size([23980, 1])
2025-06-03 10:31:12,696 - DEBUG - Edge anomaly scores shape: torch.Size([50828, 1])
2025-06-03 10:31:12,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:15,303 - DEBUG - Step 43: Loss=0.5677
2025-06-03 10:31:15,304 - DEBUG - Online update step: 44/50
2025-06-03 10:31:15,306 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:16,281 - DEBUG - Node anomaly scores shape: torch.Size([23812, 1])
2025-06-03 10:31:16,294 - DEBUG - Edge anomaly scores shape: torch.Size([50572, 1])
2025-06-03 10:31:16,295 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:18,154 - DEBUG - Step 44: Loss=0.5654
2025-06-03 10:31:18,154 - DEBUG - Online update step: 45/50
2025-06-03 10:31:18,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:19,493 - DEBUG - Node anomaly scores shape: torch.Size([24809, 1])
2025-06-03 10:31:19,505 - DEBUG - Edge anomaly scores shape: torch.Size([52882, 1])
2025-06-03 10:31:19,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:20,305 - DEBUG - Step 45: Loss=0.5672
2025-06-03 10:31:20,305 - DEBUG - Online update step: 46/50
2025-06-03 10:31:20,307 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:22,005 - DEBUG - Node anomaly scores shape: torch.Size([24532, 1])
2025-06-03 10:31:22,086 - DEBUG - Edge anomaly scores shape: torch.Size([52347, 1])
2025-06-03 10:31:22,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:22,798 - DEBUG - Step 46: Loss=0.5680
2025-06-03 10:31:22,798 - DEBUG - Online update step: 47/50
2025-06-03 10:31:22,801 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:23,964 - DEBUG - Node anomaly scores shape: torch.Size([24055, 1])
2025-06-03 10:31:23,982 - DEBUG - Edge anomaly scores shape: torch.Size([51060, 1])
2025-06-03 10:31:23,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:24,735 - DEBUG - Step 47: Loss=0.5668
2025-06-03 10:31:24,735 - DEBUG - Online update step: 48/50
2025-06-03 10:31:24,740 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:25,318 - DEBUG - Node anomaly scores shape: torch.Size([23862, 1])
2025-06-03 10:31:25,330 - DEBUG - Edge anomaly scores shape: torch.Size([50604, 1])
2025-06-03 10:31:25,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:25,953 - DEBUG - Step 48: Loss=0.5662
2025-06-03 10:31:25,953 - DEBUG - Online update step: 49/50
2025-06-03 10:31:25,955 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:26,499 - DEBUG - Node anomaly scores shape: torch.Size([23749, 1])
2025-06-03 10:31:26,518 - DEBUG - Edge anomaly scores shape: torch.Size([50415, 1])
2025-06-03 10:31:26,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:27,222 - DEBUG - Step 49: Loss=0.5671
2025-06-03 10:31:27,222 - DEBUG - Online update step: 50/50
2025-06-03 10:31:27,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:29,509 - DEBUG - Node anomaly scores shape: torch.Size([24892, 1])
2025-06-03 10:31:29,593 - DEBUG - Edge anomaly scores shape: torch.Size([53153, 1])
2025-06-03 10:31:29,645 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:30,635 - DEBUG - Step 50: Loss=0.5658
2025-06-03 10:31:30,635 - INFO - Online update finished. Average loss: 0.5675, Learning rate: 0.001000
2025-06-03 10:31:30,636 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1588150e-08
 -1.3522248e-08  4.0922593e-08 -8.5403666e-09 -1.8978594e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  1.1861621e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-09  1.5182875e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.3103826e-08 -1.7555198e-08], current edge mean: [ 9.1463528e+00  1.4245583e+00  5.7014046e+00  1.7284537e-09
  1.7284537e-09  8.6422686e-10  5.8335310e-09  0.0000000e+00
 -1.7284537e-09 -3.1328222e-09]
2025-06-03 10:31:30,636 - DEBUG - Node drift difference: 0.0048, Edge drift difference: 0.0019
2025-06-03 10:31:30,637 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.1588150e-08
 -1.3522248e-08  4.0922593e-08 -8.5403666e-09 -1.8978594e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  1.1861621e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-09  1.5182875e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.3103826e-08 -1.7555198e-08], edge=[ 9.1463528e+00  1.4245583e+00  5.7014046e+00  1.7284537e-09
  1.7284537e-09  8.6422686e-10  5.8335310e-09  0.0000000e+00
 -1.7284537e-09 -3.1328222e-09]
2025-06-03 10:31:30,637 - DEBUG - Updated reference std: node=[0.         0.         1.0004979  1.0004979  0.         0.
 0.         1.0004978  1.0004979  1.0004978  1.0004978  1.0004978
 0.94502825 0.2725181  0.37022114 0.5732797  1.0004979  3.021951
 2.9069915  1.4823681  0.37022114 0.2208081  1.0004979  1.0004979
 0.         0.         0.         0.         1.0004979  1.0004978 ], edge=[1.1009203 0.5061673 2.1348705 1.0002267 1.0002266 1.0002266 1.0002266
 1.0002266 1.0002266 1.0002266]
2025-06-03 10:31:30,637 - INFO - Online update complete. Loss: 0.5675
2025-06-03 10:31:30,637 - INFO - Running anomaly detection...
2025-06-03 10:31:30,637 - INFO - Starting anomaly detection.
2025-06-03 10:31:30,660 - DEBUG - Node reconstruction errors: [0.00065826 0.00202225 0.00107935 ... 0.00454109 0.0343414  0.0338698 ]
2025-06-03 10:31:30,660 - DEBUG - Edge reconstruction errors: [0.15478304 1.6568351  1.6578686  ... 0.15424427 1.2527428  0.15420677]
2025-06-03 10:31:30,662 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103130_update_48.json
2025-06-03 10:31:30,662 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:31:30,674 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103130_update_48.pth and as latest_checkpoint.pth
2025-06-03 10:31:30,674 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870775.dot): 0.3651
2025-06-03 10:31:30,674 - WARNING - Detected 25 anomalous nodes (reconstruction-based):
2025-06-03 10:31:30,674 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0260, MLP Score: 0.5045
2025-06-03 10:31:30,674 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0279, MLP Score: 0.4989
2025-06-03 10:31:30,674 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0219, MLP Score: 0.4932
2025-06-03 10:31:30,674 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0356, MLP Score: 0.4952
2025-06-03 10:31:30,674 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0234, MLP Score: 0.5014
2025-06-03 10:31:30,674 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:31:30,674 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7250, MLP Score: 0.4995
2025-06-03 10:31:30,674 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3299, MLP Score: 0.4996
2025-06-03 10:31:30,675 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9128, MLP Score: 0.4999
2025-06-03 10:31:30,675 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3291, MLP Score: 0.4989
2025-06-03 10:31:30,675 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3377, MLP Score: 0.4987
2025-06-03 10:31:30,675 - INFO - 
--- Processing file: nw_graph_encoded_1748870805.dot (Timestamp: 2025-06-02 15:26:45) ---
2025-06-03 10:31:30,675 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-03 10:31:30,675 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-03 10:31:30,701 - INFO - Parsed 1009 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-03 10:31:30,722 - INFO - Parsed 2219 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-03 10:31:30,722 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-03 10:31:30,723 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-03 10:31:30,743 - INFO - Parsed 1009 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-03 10:31:30,766 - INFO - Parsed 2219 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-03 10:31:30,766 - INFO - Processing node updates/additions.
2025-06-03 10:31:30,771 - INFO - Processing edge updates/additions.
2025-06-03 10:31:30,782 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:31:30,783 - INFO - Finished updating NetworkX graph.
2025-06-03 10:31:30,783 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:31:30,784 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:31:30,793 - DEBUG - Initial node features tensor shape: torch.Size([1009, 30])
2025-06-03 10:31:30,794 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:31:30,795 - DEBUG - Node features tensor shape after scaling: torch.Size([1009, 30])
2025-06-03 10:31:30,796 - DEBUG - Edge index tensor shape: torch.Size([2, 2219])
2025-06-03 10:31:30,797 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:31:30,802 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:31:30,803 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:31:30,804 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:31:30,806 - DEBUG - Shape of encoded categorical edge features: torch.Size([2219, 3])
2025-06-03 10:31:30,807 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:31:30,807 - DEBUG - Shape of scaled numerical edge features: torch.Size([2219, 7])
2025-06-03 10:31:30,807 - DEBUG - Final edge attributes tensor shape: torch.Size([2219, 10])
2025-06-03 10:31:30,807 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:31:30,810 - INFO - Performing online update...
2025-06-03 10:31:30,810 - INFO - Starting online update for 50 steps.
2025-06-03 10:31:30,810 - DEBUG - Updated RunningStats: new_mean=0.9501205486072504, new_var=28200000000161.29, new_n=2850
2025-06-03 10:31:30,811 - DEBUG - Updated RunningStats: new_mean=0.9479166687686341, new_var=28500000000018.363, new_n=2880
2025-06-03 10:31:30,811 - DEBUG - Updated RunningStats: new_mean=1.2362915469399751, new_var=9400000000093.266, new_n=950
2025-06-03 10:31:30,811 - DEBUG - Updated RunningStats: new_mean=1.23461054171664, new_var=9500000000001.754, new_n=960
2025-06-03 10:31:30,811 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:31:30,811 - DEBUG - Online update step: 1/50
2025-06-03 10:31:30,813 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:31,468 - DEBUG - Node anomaly scores shape: torch.Size([25300, 1])
2025-06-03 10:31:31,481 - DEBUG - Edge anomaly scores shape: torch.Size([53962, 1])
2025-06-03 10:31:31,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:32,340 - DEBUG - Step 1: Loss=0.5667
2025-06-03 10:31:32,341 - DEBUG - Online update step: 2/50
2025-06-03 10:31:32,343 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:32,999 - DEBUG - Node anomaly scores shape: torch.Size([24792, 1])
2025-06-03 10:31:33,012 - DEBUG - Edge anomaly scores shape: torch.Size([52679, 1])
2025-06-03 10:31:33,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:33,768 - DEBUG - Step 2: Loss=0.5681
2025-06-03 10:31:33,768 - DEBUG - Online update step: 3/50
2025-06-03 10:31:33,770 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:34,378 - DEBUG - Node anomaly scores shape: torch.Size([23993, 1])
2025-06-03 10:31:34,389 - DEBUG - Edge anomaly scores shape: torch.Size([50963, 1])
2025-06-03 10:31:34,390 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:35,165 - DEBUG - Step 3: Loss=0.5672
2025-06-03 10:31:35,165 - DEBUG - Online update step: 4/50
2025-06-03 10:31:35,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:36,384 - DEBUG - Node anomaly scores shape: torch.Size([23886, 1])
2025-06-03 10:31:36,491 - DEBUG - Edge anomaly scores shape: torch.Size([50618, 1])
2025-06-03 10:31:36,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:38,402 - DEBUG - Step 4: Loss=0.5683
2025-06-03 10:31:38,402 - DEBUG - Online update step: 5/50
2025-06-03 10:31:38,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:39,530 - DEBUG - Node anomaly scores shape: torch.Size([24048, 1])
2025-06-03 10:31:39,542 - DEBUG - Edge anomaly scores shape: torch.Size([51095, 1])
2025-06-03 10:31:39,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:40,315 - DEBUG - Step 5: Loss=0.5691
2025-06-03 10:31:40,316 - DEBUG - Online update step: 6/50
2025-06-03 10:31:40,318 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:41,073 - DEBUG - Node anomaly scores shape: torch.Size([24743, 1])
2025-06-03 10:31:41,086 - DEBUG - Edge anomaly scores shape: torch.Size([52675, 1])
2025-06-03 10:31:41,087 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:41,895 - DEBUG - Step 6: Loss=0.5671
2025-06-03 10:31:41,895 - DEBUG - Online update step: 7/50
2025-06-03 10:31:41,898 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:42,648 - DEBUG - Node anomaly scores shape: torch.Size([25717, 1])
2025-06-03 10:31:42,662 - DEBUG - Edge anomaly scores shape: torch.Size([55155, 1])
2025-06-03 10:31:42,663 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:43,769 - DEBUG - Step 7: Loss=0.5670
2025-06-03 10:31:43,769 - DEBUG - Online update step: 8/50
2025-06-03 10:31:43,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:44,512 - DEBUG - Node anomaly scores shape: torch.Size([24253, 1])
2025-06-03 10:31:44,525 - DEBUG - Edge anomaly scores shape: torch.Size([51593, 1])
2025-06-03 10:31:44,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:45,345 - DEBUG - Step 8: Loss=0.5677
2025-06-03 10:31:45,346 - DEBUG - Online update step: 9/50
2025-06-03 10:31:45,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:46,050 - DEBUG - Node anomaly scores shape: torch.Size([24501, 1])
2025-06-03 10:31:46,063 - DEBUG - Edge anomaly scores shape: torch.Size([52151, 1])
2025-06-03 10:31:46,064 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:46,880 - DEBUG - Step 9: Loss=0.5662
2025-06-03 10:31:46,880 - DEBUG - Online update step: 10/50
2025-06-03 10:31:46,884 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:48,206 - DEBUG - Node anomaly scores shape: torch.Size([24500, 1])
2025-06-03 10:31:48,246 - DEBUG - Edge anomaly scores shape: torch.Size([52158, 1])
2025-06-03 10:31:48,247 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:49,784 - DEBUG - Step 10: Loss=0.5663
2025-06-03 10:31:49,785 - DEBUG - Online update step: 11/50
2025-06-03 10:31:49,788 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:50,841 - DEBUG - Node anomaly scores shape: torch.Size([25354, 1])
2025-06-03 10:31:50,864 - DEBUG - Edge anomaly scores shape: torch.Size([54068, 1])
2025-06-03 10:31:50,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:52,358 - DEBUG - Step 11: Loss=0.5670
2025-06-03 10:31:52,359 - DEBUG - Online update step: 12/50
2025-06-03 10:31:52,364 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:31:56,696 - DEBUG - Node anomaly scores shape: torch.Size([23550, 1])
2025-06-03 10:31:56,847 - DEBUG - Edge anomaly scores shape: torch.Size([50035, 1])
2025-06-03 10:31:56,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:31:59,251 - DEBUG - Step 12: Loss=0.5658
2025-06-03 10:31:59,251 - DEBUG - Online update step: 13/50
2025-06-03 10:31:59,261 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:00,168 - DEBUG - Node anomaly scores shape: torch.Size([23924, 1])
2025-06-03 10:32:00,181 - DEBUG - Edge anomaly scores shape: torch.Size([50735, 1])
2025-06-03 10:32:00,182 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:01,368 - DEBUG - Step 13: Loss=0.5667
2025-06-03 10:32:01,369 - DEBUG - Online update step: 14/50
2025-06-03 10:32:01,372 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:02,393 - DEBUG - Node anomaly scores shape: torch.Size([24301, 1])
2025-06-03 10:32:02,405 - DEBUG - Edge anomaly scores shape: torch.Size([51678, 1])
2025-06-03 10:32:02,406 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:03,255 - DEBUG - Step 14: Loss=0.5679
2025-06-03 10:32:03,255 - DEBUG - Online update step: 15/50
2025-06-03 10:32:03,259 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:04,651 - DEBUG - Node anomaly scores shape: torch.Size([24954, 1])
2025-06-03 10:32:04,686 - DEBUG - Edge anomaly scores shape: torch.Size([53212, 1])
2025-06-03 10:32:04,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:05,657 - DEBUG - Step 15: Loss=0.5670
2025-06-03 10:32:05,657 - DEBUG - Online update step: 16/50
2025-06-03 10:32:05,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:06,577 - DEBUG - Node anomaly scores shape: torch.Size([22357, 1])
2025-06-03 10:32:06,589 - DEBUG - Edge anomaly scores shape: torch.Size([47233, 1])
2025-06-03 10:32:06,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:09,472 - DEBUG - Step 16: Loss=0.5681
2025-06-03 10:32:09,474 - DEBUG - Online update step: 17/50
2025-06-03 10:32:09,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:10,311 - DEBUG - Node anomaly scores shape: torch.Size([24188, 1])
2025-06-03 10:32:10,323 - DEBUG - Edge anomaly scores shape: torch.Size([51414, 1])
2025-06-03 10:32:10,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:11,301 - DEBUG - Step 17: Loss=0.5690
2025-06-03 10:32:11,302 - DEBUG - Online update step: 18/50
2025-06-03 10:32:11,305 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:12,158 - DEBUG - Node anomaly scores shape: torch.Size([23420, 1])
2025-06-03 10:32:12,176 - DEBUG - Edge anomaly scores shape: torch.Size([49567, 1])
2025-06-03 10:32:12,179 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:13,029 - DEBUG - Step 18: Loss=0.5672
2025-06-03 10:32:13,029 - DEBUG - Online update step: 19/50
2025-06-03 10:32:13,032 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:13,794 - DEBUG - Node anomaly scores shape: torch.Size([24866, 1])
2025-06-03 10:32:13,806 - DEBUG - Edge anomaly scores shape: torch.Size([53115, 1])
2025-06-03 10:32:13,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:14,568 - DEBUG - Step 19: Loss=0.5663
2025-06-03 10:32:14,568 - DEBUG - Online update step: 20/50
2025-06-03 10:32:14,571 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:15,244 - DEBUG - Node anomaly scores shape: torch.Size([24087, 1])
2025-06-03 10:32:15,257 - DEBUG - Edge anomaly scores shape: torch.Size([51122, 1])
2025-06-03 10:32:15,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:16,027 - DEBUG - Step 20: Loss=0.5667
2025-06-03 10:32:16,027 - DEBUG - Online update step: 21/50
2025-06-03 10:32:16,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:16,742 - DEBUG - Node anomaly scores shape: torch.Size([24943, 1])
2025-06-03 10:32:16,755 - DEBUG - Edge anomaly scores shape: torch.Size([53296, 1])
2025-06-03 10:32:16,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:17,560 - DEBUG - Step 21: Loss=0.5664
2025-06-03 10:32:17,560 - DEBUG - Online update step: 22/50
2025-06-03 10:32:17,567 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:18,243 - DEBUG - Node anomaly scores shape: torch.Size([23486, 1])
2025-06-03 10:32:18,258 - DEBUG - Edge anomaly scores shape: torch.Size([49819, 1])
2025-06-03 10:32:18,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:18,965 - DEBUG - Step 22: Loss=0.5691
2025-06-03 10:32:18,966 - DEBUG - Online update step: 23/50
2025-06-03 10:32:18,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:19,626 - DEBUG - Node anomaly scores shape: torch.Size([23417, 1])
2025-06-03 10:32:19,641 - DEBUG - Edge anomaly scores shape: torch.Size([49639, 1])
2025-06-03 10:32:19,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:20,427 - DEBUG - Step 23: Loss=0.5697
2025-06-03 10:32:20,428 - DEBUG - Online update step: 24/50
2025-06-03 10:32:20,431 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:21,114 - DEBUG - Node anomaly scores shape: torch.Size([23573, 1])
2025-06-03 10:32:21,126 - DEBUG - Edge anomaly scores shape: torch.Size([49974, 1])
2025-06-03 10:32:21,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:22,473 - DEBUG - Step 24: Loss=0.5666
2025-06-03 10:32:22,474 - DEBUG - Online update step: 25/50
2025-06-03 10:32:22,483 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:23,392 - DEBUG - Node anomaly scores shape: torch.Size([22965, 1])
2025-06-03 10:32:23,405 - DEBUG - Edge anomaly scores shape: torch.Size([48457, 1])
2025-06-03 10:32:23,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:24,139 - DEBUG - Step 25: Loss=0.5655
2025-06-03 10:32:24,139 - DEBUG - Online update step: 26/50
2025-06-03 10:32:24,143 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:24,902 - DEBUG - Node anomaly scores shape: torch.Size([23982, 1])
2025-06-03 10:32:24,919 - DEBUG - Edge anomaly scores shape: torch.Size([50988, 1])
2025-06-03 10:32:24,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:25,825 - DEBUG - Step 26: Loss=0.5667
2025-06-03 10:32:25,826 - DEBUG - Online update step: 27/50
2025-06-03 10:32:25,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:26,614 - DEBUG - Node anomaly scores shape: torch.Size([23949, 1])
2025-06-03 10:32:26,630 - DEBUG - Edge anomaly scores shape: torch.Size([50930, 1])
2025-06-03 10:32:26,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:27,433 - DEBUG - Step 27: Loss=0.5655
2025-06-03 10:32:27,434 - DEBUG - Online update step: 28/50
2025-06-03 10:32:27,437 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:28,160 - DEBUG - Node anomaly scores shape: torch.Size([25298, 1])
2025-06-03 10:32:28,174 - DEBUG - Edge anomaly scores shape: torch.Size([54049, 1])
2025-06-03 10:32:28,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:28,977 - DEBUG - Step 28: Loss=0.5668
2025-06-03 10:32:28,977 - DEBUG - Online update step: 29/50
2025-06-03 10:32:28,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:29,608 - DEBUG - Node anomaly scores shape: torch.Size([22704, 1])
2025-06-03 10:32:29,621 - DEBUG - Edge anomaly scores shape: torch.Size([47965, 1])
2025-06-03 10:32:29,622 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:30,329 - DEBUG - Step 29: Loss=0.5672
2025-06-03 10:32:30,330 - DEBUG - Online update step: 30/50
2025-06-03 10:32:30,333 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:31,036 - DEBUG - Node anomaly scores shape: torch.Size([24422, 1])
2025-06-03 10:32:31,051 - DEBUG - Edge anomaly scores shape: torch.Size([51933, 1])
2025-06-03 10:32:31,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:31,826 - DEBUG - Step 30: Loss=0.5653
2025-06-03 10:32:31,827 - DEBUG - Online update step: 31/50
2025-06-03 10:32:31,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:32,606 - DEBUG - Node anomaly scores shape: torch.Size([26147, 1])
2025-06-03 10:32:32,620 - DEBUG - Edge anomaly scores shape: torch.Size([56043, 1])
2025-06-03 10:32:32,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:33,399 - DEBUG - Step 31: Loss=0.5663
2025-06-03 10:32:33,399 - DEBUG - Online update step: 32/50
2025-06-03 10:32:33,404 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:34,131 - DEBUG - Node anomaly scores shape: torch.Size([26262, 1])
2025-06-03 10:32:34,145 - DEBUG - Edge anomaly scores shape: torch.Size([56299, 1])
2025-06-03 10:32:34,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:34,970 - DEBUG - Step 32: Loss=0.5675
2025-06-03 10:32:34,971 - DEBUG - Online update step: 33/50
2025-06-03 10:32:34,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:35,686 - DEBUG - Node anomaly scores shape: torch.Size([25906, 1])
2025-06-03 10:32:35,705 - DEBUG - Edge anomaly scores shape: torch.Size([55620, 1])
2025-06-03 10:32:35,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:36,514 - DEBUG - Step 33: Loss=0.5664
2025-06-03 10:32:36,514 - DEBUG - Online update step: 34/50
2025-06-03 10:32:36,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:37,198 - DEBUG - Node anomaly scores shape: torch.Size([24283, 1])
2025-06-03 10:32:37,212 - DEBUG - Edge anomaly scores shape: torch.Size([51603, 1])
2025-06-03 10:32:37,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:37,966 - DEBUG - Step 34: Loss=0.5658
2025-06-03 10:32:37,966 - DEBUG - Online update step: 35/50
2025-06-03 10:32:37,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:38,693 - DEBUG - Node anomaly scores shape: torch.Size([24746, 1])
2025-06-03 10:32:38,707 - DEBUG - Edge anomaly scores shape: torch.Size([52756, 1])
2025-06-03 10:32:38,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:39,569 - DEBUG - Step 35: Loss=0.5665
2025-06-03 10:32:39,569 - DEBUG - Online update step: 36/50
2025-06-03 10:32:39,572 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:40,409 - DEBUG - Node anomaly scores shape: torch.Size([24788, 1])
2025-06-03 10:32:40,431 - DEBUG - Edge anomaly scores shape: torch.Size([52797, 1])
2025-06-03 10:32:40,435 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:41,468 - DEBUG - Step 36: Loss=0.5655
2025-06-03 10:32:41,468 - DEBUG - Online update step: 37/50
2025-06-03 10:32:41,471 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:42,275 - DEBUG - Node anomaly scores shape: torch.Size([23960, 1])
2025-06-03 10:32:42,292 - DEBUG - Edge anomaly scores shape: torch.Size([50977, 1])
2025-06-03 10:32:42,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:43,172 - DEBUG - Step 37: Loss=0.5667
2025-06-03 10:32:43,172 - DEBUG - Online update step: 38/50
2025-06-03 10:32:43,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:43,874 - DEBUG - Node anomaly scores shape: torch.Size([24948, 1])
2025-06-03 10:32:43,887 - DEBUG - Edge anomaly scores shape: torch.Size([53198, 1])
2025-06-03 10:32:43,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:44,721 - DEBUG - Step 38: Loss=0.5676
2025-06-03 10:32:44,721 - DEBUG - Online update step: 39/50
2025-06-03 10:32:44,727 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:45,524 - DEBUG - Node anomaly scores shape: torch.Size([25375, 1])
2025-06-03 10:32:45,542 - DEBUG - Edge anomaly scores shape: torch.Size([54215, 1])
2025-06-03 10:32:45,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:46,542 - DEBUG - Step 39: Loss=0.5670
2025-06-03 10:32:46,542 - DEBUG - Online update step: 40/50
2025-06-03 10:32:46,545 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:47,238 - DEBUG - Node anomaly scores shape: torch.Size([23927, 1])
2025-06-03 10:32:47,258 - DEBUG - Edge anomaly scores shape: torch.Size([50768, 1])
2025-06-03 10:32:47,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:48,057 - DEBUG - Step 40: Loss=0.5685
2025-06-03 10:32:48,058 - DEBUG - Online update step: 41/50
2025-06-03 10:32:48,061 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:48,792 - DEBUG - Node anomaly scores shape: torch.Size([24427, 1])
2025-06-03 10:32:48,813 - DEBUG - Edge anomaly scores shape: torch.Size([51908, 1])
2025-06-03 10:32:48,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:49,659 - DEBUG - Step 41: Loss=0.5692
2025-06-03 10:32:49,659 - DEBUG - Online update step: 42/50
2025-06-03 10:32:49,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:50,384 - DEBUG - Node anomaly scores shape: torch.Size([23268, 1])
2025-06-03 10:32:50,399 - DEBUG - Edge anomaly scores shape: torch.Size([49265, 1])
2025-06-03 10:32:50,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:51,285 - DEBUG - Step 42: Loss=0.5670
2025-06-03 10:32:51,286 - DEBUG - Online update step: 43/50
2025-06-03 10:32:51,289 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:52,136 - DEBUG - Node anomaly scores shape: torch.Size([25144, 1])
2025-06-03 10:32:52,149 - DEBUG - Edge anomaly scores shape: torch.Size([53713, 1])
2025-06-03 10:32:52,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:53,022 - DEBUG - Step 43: Loss=0.5659
2025-06-03 10:32:53,022 - DEBUG - Online update step: 44/50
2025-06-03 10:32:53,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:53,864 - DEBUG - Node anomaly scores shape: torch.Size([25710, 1])
2025-06-03 10:32:53,879 - DEBUG - Edge anomaly scores shape: torch.Size([54824, 1])
2025-06-03 10:32:53,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:54,850 - DEBUG - Step 44: Loss=0.5663
2025-06-03 10:32:54,850 - DEBUG - Online update step: 45/50
2025-06-03 10:32:54,854 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:55,598 - DEBUG - Node anomaly scores shape: torch.Size([23994, 1])
2025-06-03 10:32:55,612 - DEBUG - Edge anomaly scores shape: torch.Size([50894, 1])
2025-06-03 10:32:55,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:56,396 - DEBUG - Step 45: Loss=0.5654
2025-06-03 10:32:56,396 - DEBUG - Online update step: 46/50
2025-06-03 10:32:56,399 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:57,243 - DEBUG - Node anomaly scores shape: torch.Size([23973, 1])
2025-06-03 10:32:57,260 - DEBUG - Edge anomaly scores shape: torch.Size([51023, 1])
2025-06-03 10:32:57,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:32:58,163 - DEBUG - Step 46: Loss=0.5665
2025-06-03 10:32:58,163 - DEBUG - Online update step: 47/50
2025-06-03 10:32:58,173 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:32:59,875 - DEBUG - Node anomaly scores shape: torch.Size([25239, 1])
2025-06-03 10:32:59,889 - DEBUG - Edge anomaly scores shape: torch.Size([53845, 1])
2025-06-03 10:32:59,890 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:03,323 - DEBUG - Step 47: Loss=0.5673
2025-06-03 10:33:03,327 - DEBUG - Online update step: 48/50
2025-06-03 10:33:03,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:04,667 - DEBUG - Node anomaly scores shape: torch.Size([24370, 1])
2025-06-03 10:33:04,680 - DEBUG - Edge anomaly scores shape: torch.Size([51882, 1])
2025-06-03 10:33:04,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:05,984 - DEBUG - Step 48: Loss=0.5665
2025-06-03 10:33:05,984 - DEBUG - Online update step: 49/50
2025-06-03 10:33:05,987 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:06,658 - DEBUG - Node anomaly scores shape: torch.Size([24296, 1])
2025-06-03 10:33:06,672 - DEBUG - Edge anomaly scores shape: torch.Size([51696, 1])
2025-06-03 10:33:06,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:07,592 - DEBUG - Step 49: Loss=0.5673
2025-06-03 10:33:07,592 - DEBUG - Online update step: 50/50
2025-06-03 10:33:07,599 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:08,311 - DEBUG - Node anomaly scores shape: torch.Size([24153, 1])
2025-06-03 10:33:08,324 - DEBUG - Edge anomaly scores shape: torch.Size([51265, 1])
2025-06-03 10:33:08,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:09,080 - DEBUG - Step 50: Loss=0.5681
2025-06-03 10:33:09,080 - INFO - Online update finished. Average loss: 0.5670, Learning rate: 0.001000
2025-06-03 10:33:09,081 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.4101778e-08 -3.4262332e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8118743e-08
  7.0887585e-09 -1.2287181e-08  1.8903355e-08 -1.2287181e-08
  2.2517345e+00  2.9623389e+00  1.4469773e-01  4.3964319e+00
  1.4177517e-08  3.4231913e+00  5.7641230e+00  7.6214075e+00
  1.4469773e-01  7.9930625e+00  1.3114203e-08 -7.5613427e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.0869430e-08  2.2920320e-08], current edge mean: [ 9.1478148e+00  1.4222623e+00  5.6998649e+00 -3.4382130e-09
  8.5955326e-10  3.4382130e-09  3.8679895e-09  3.4382130e-09
  3.4382130e-09  0.0000000e+00]
2025-06-03 10:33:09,081 - DEBUG - Node drift difference: 0.0123, Edge drift difference: 0.0045
2025-06-03 10:33:09,082 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.4101778e-08 -3.4262332e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8118743e-08
  7.0887585e-09 -1.2287181e-08  1.8903355e-08 -1.2287181e-08
  2.2517345e+00  2.9623389e+00  1.4469773e-01  4.3964319e+00
  1.4177517e-08  3.4231913e+00  5.7641230e+00  7.6214075e+00
  1.4469773e-01  7.9930625e+00  1.3114203e-08 -7.5613427e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.0869430e-08  2.2920320e-08], edge=[ 9.1478148e+00  1.4222623e+00  5.6998649e+00 -3.4382130e-09
  8.5955326e-10  3.4382130e-09  3.8679895e-09  3.4382130e-09
  3.4382130e-09  0.0000000e+00]
2025-06-03 10:33:09,083 - DEBUG - Updated reference std: node=[0.         0.         1.0004959  1.0004959  0.         0.
 0.         1.0004959  1.0004959  1.0004959  1.0004959  1.0004959
 0.95122075 0.27198726 0.3657919  0.57340807 1.0004959  3.0204818
 2.9123883  1.4690516  0.3657919  0.22037    1.0004959  1.0004959
 0.         0.         0.         0.         1.0004959  1.0004959 ], edge=[1.1028116  0.50575596 2.139005   1.0002254  1.0002254  1.0002254
 1.0002254  1.0002254  1.0002254  1.0002254 ]
2025-06-03 10:33:09,090 - INFO - Online update complete. Loss: 0.5670
2025-06-03 10:33:09,090 - INFO - Running anomaly detection...
2025-06-03 10:33:09,090 - INFO - Starting anomaly detection.
2025-06-03 10:33:09,128 - DEBUG - Node reconstruction errors: [0.00114831 0.00212449 0.00085122 ... 0.03303948 0.03303948 0.03303945]
2025-06-03 10:33:09,128 - DEBUG - Edge reconstruction errors: [0.15463738 1.6567867  1.657841   ... 0.15411867 1.2527721  0.1540794 ]
2025-06-03 10:33:09,130 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103309_update_49.json
2025-06-03 10:33:09,131 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:33:09,147 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103309_update_49.pth and as latest_checkpoint.pth
2025-06-03 10:33:09,147 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870805.dot): 0.3649
2025-06-03 10:33:09,148 - WARNING - Detected 35 anomalous nodes (reconstruction-based):
2025-06-03 10:33:09,148 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0224, MLP Score: 0.5050
2025-06-03 10:33:09,148 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0248, MLP Score: 0.5047
2025-06-03 10:33:09,148 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0189, MLP Score: 0.5008
2025-06-03 10:33:09,148 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0301, MLP Score: 0.5011
2025-06-03 10:33:09,148 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0216, MLP Score: 0.5017
2025-06-03 10:33:09,148 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:33:09,148 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7275, MLP Score: 0.5001
2025-06-03 10:33:09,148 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3314, MLP Score: 0.5001
2025-06-03 10:33:09,148 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9173, MLP Score: 0.5008
2025-06-03 10:33:09,148 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3428, MLP Score: 0.5001
2025-06-03 10:33:09,148 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3494, MLP Score: 0.5002
2025-06-03 10:33:09,148 - INFO - 
--- Processing file: nw_graph_encoded_1748870835.dot (Timestamp: 2025-06-02 15:27:15) ---
2025-06-03 10:33:09,148 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-03 10:33:09,149 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-03 10:33:09,181 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-03 10:33:09,209 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-03 10:33:09,209 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-03 10:33:09,209 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-03 10:33:09,233 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-03 10:33:09,258 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-03 10:33:09,258 - INFO - Processing node updates/additions.
2025-06-03 10:33:09,263 - INFO - Processing edge updates/additions.
2025-06-03 10:33:09,275 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:33:09,276 - INFO - Finished updating NetworkX graph.
2025-06-03 10:33:09,276 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:33:09,277 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:33:09,286 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 10:33:09,288 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:33:09,288 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 10:33:09,290 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 10:33:09,292 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:33:09,296 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:33:09,298 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:33:09,299 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:33:09,300 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-03 10:33:09,301 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:33:09,302 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-03 10:33:09,302 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-03 10:33:09,302 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:33:09,305 - INFO - Performing online update...
2025-06-03 10:33:09,305 - INFO - Starting online update for 50 steps.
2025-06-03 10:33:09,305 - DEBUG - Updated RunningStats: new_mean=0.9500694111440758, new_var=28800000000161.31, new_n=2910
2025-06-03 10:33:09,305 - DEBUG - Updated RunningStats: new_mean=0.94791014007368, new_var=29100000000018.355, new_n=2940
2025-06-03 10:33:09,306 - DEBUG - Updated RunningStats: new_mean=1.238656072693877, new_var=9600000000093.25, new_n=970
2025-06-03 10:33:09,306 - DEBUG - Updated RunningStats: new_mean=1.236984650569179, new_var=9700000000001.762, new_n=980
2025-06-03 10:33:09,306 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:33:09,306 - DEBUG - Online update step: 1/50
2025-06-03 10:33:09,308 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:10,066 - DEBUG - Node anomaly scores shape: torch.Size([24491, 1])
2025-06-03 10:33:10,079 - DEBUG - Edge anomaly scores shape: torch.Size([52102, 1])
2025-06-03 10:33:10,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:10,972 - DEBUG - Step 1: Loss=0.5665
2025-06-03 10:33:10,972 - DEBUG - Online update step: 2/50
2025-06-03 10:33:10,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:11,719 - DEBUG - Node anomaly scores shape: torch.Size([24791, 1])
2025-06-03 10:33:11,732 - DEBUG - Edge anomaly scores shape: torch.Size([52856, 1])
2025-06-03 10:33:11,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:12,581 - DEBUG - Step 2: Loss=0.5662
2025-06-03 10:33:12,581 - DEBUG - Online update step: 3/50
2025-06-03 10:33:12,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:13,375 - DEBUG - Node anomaly scores shape: torch.Size([24624, 1])
2025-06-03 10:33:13,396 - DEBUG - Edge anomaly scores shape: torch.Size([52436, 1])
2025-06-03 10:33:13,398 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:14,267 - DEBUG - Step 3: Loss=0.5670
2025-06-03 10:33:14,267 - DEBUG - Online update step: 4/50
2025-06-03 10:33:14,270 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:15,044 - DEBUG - Node anomaly scores shape: torch.Size([25757, 1])
2025-06-03 10:33:15,064 - DEBUG - Edge anomaly scores shape: torch.Size([54982, 1])
2025-06-03 10:33:15,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:16,004 - DEBUG - Step 4: Loss=0.5661
2025-06-03 10:33:16,004 - DEBUG - Online update step: 5/50
2025-06-03 10:33:16,008 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:16,758 - DEBUG - Node anomaly scores shape: torch.Size([25084, 1])
2025-06-03 10:33:16,773 - DEBUG - Edge anomaly scores shape: torch.Size([53633, 1])
2025-06-03 10:33:16,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:17,725 - DEBUG - Step 5: Loss=0.5669
2025-06-03 10:33:17,725 - DEBUG - Online update step: 6/50
2025-06-03 10:33:17,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:18,543 - DEBUG - Node anomaly scores shape: torch.Size([25273, 1])
2025-06-03 10:33:18,557 - DEBUG - Edge anomaly scores shape: torch.Size([54141, 1])
2025-06-03 10:33:18,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:19,473 - DEBUG - Step 6: Loss=0.5680
2025-06-03 10:33:19,474 - DEBUG - Online update step: 7/50
2025-06-03 10:33:19,477 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:20,276 - DEBUG - Node anomaly scores shape: torch.Size([25374, 1])
2025-06-03 10:33:20,290 - DEBUG - Edge anomaly scores shape: torch.Size([54225, 1])
2025-06-03 10:33:20,291 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:21,231 - DEBUG - Step 7: Loss=0.5662
2025-06-03 10:33:21,231 - DEBUG - Online update step: 8/50
2025-06-03 10:33:21,234 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:21,850 - DEBUG - Node anomaly scores shape: torch.Size([22756, 1])
2025-06-03 10:33:21,862 - DEBUG - Edge anomaly scores shape: torch.Size([48069, 1])
2025-06-03 10:33:21,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:22,627 - DEBUG - Step 8: Loss=0.5668
2025-06-03 10:33:22,627 - DEBUG - Online update step: 9/50
2025-06-03 10:33:22,632 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:23,443 - DEBUG - Node anomaly scores shape: torch.Size([23115, 1])
2025-06-03 10:33:23,487 - DEBUG - Edge anomaly scores shape: torch.Size([48915, 1])
2025-06-03 10:33:23,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:24,585 - DEBUG - Step 9: Loss=0.5671
2025-06-03 10:33:24,586 - DEBUG - Online update step: 10/50
2025-06-03 10:33:24,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:25,377 - DEBUG - Node anomaly scores shape: torch.Size([24413, 1])
2025-06-03 10:33:25,422 - DEBUG - Edge anomaly scores shape: torch.Size([52012, 1])
2025-06-03 10:33:25,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:26,670 - DEBUG - Step 10: Loss=0.5656
2025-06-03 10:33:26,670 - DEBUG - Online update step: 11/50
2025-06-03 10:33:26,673 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:27,642 - DEBUG - Node anomaly scores shape: torch.Size([24990, 1])
2025-06-03 10:33:27,657 - DEBUG - Edge anomaly scores shape: torch.Size([53363, 1])
2025-06-03 10:33:27,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:28,476 - DEBUG - Step 11: Loss=0.5655
2025-06-03 10:33:28,477 - DEBUG - Online update step: 12/50
2025-06-03 10:33:28,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:29,178 - DEBUG - Node anomaly scores shape: torch.Size([25003, 1])
2025-06-03 10:33:29,193 - DEBUG - Edge anomaly scores shape: torch.Size([53294, 1])
2025-06-03 10:33:29,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:31,549 - DEBUG - Step 12: Loss=0.5663
2025-06-03 10:33:31,553 - DEBUG - Online update step: 13/50
2025-06-03 10:33:31,557 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:35,605 - DEBUG - Node anomaly scores shape: torch.Size([25370, 1])
2025-06-03 10:33:35,700 - DEBUG - Edge anomaly scores shape: torch.Size([54268, 1])
2025-06-03 10:33:35,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:37,496 - DEBUG - Step 13: Loss=0.5651
2025-06-03 10:33:37,496 - DEBUG - Online update step: 14/50
2025-06-03 10:33:37,501 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:38,305 - DEBUG - Node anomaly scores shape: torch.Size([24252, 1])
2025-06-03 10:33:38,318 - DEBUG - Edge anomaly scores shape: torch.Size([51515, 1])
2025-06-03 10:33:38,320 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:39,093 - DEBUG - Step 14: Loss=0.5656
2025-06-03 10:33:39,093 - DEBUG - Online update step: 15/50
2025-06-03 10:33:39,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:39,882 - DEBUG - Node anomaly scores shape: torch.Size([24366, 1])
2025-06-03 10:33:39,894 - DEBUG - Edge anomaly scores shape: torch.Size([51852, 1])
2025-06-03 10:33:39,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:40,630 - DEBUG - Step 15: Loss=0.5666
2025-06-03 10:33:40,630 - DEBUG - Online update step: 16/50
2025-06-03 10:33:40,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:41,332 - DEBUG - Node anomaly scores shape: torch.Size([24075, 1])
2025-06-03 10:33:41,345 - DEBUG - Edge anomaly scores shape: torch.Size([51088, 1])
2025-06-03 10:33:41,346 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:42,101 - DEBUG - Step 16: Loss=0.5657
2025-06-03 10:33:42,101 - DEBUG - Online update step: 17/50
2025-06-03 10:33:42,104 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:42,788 - DEBUG - Node anomaly scores shape: torch.Size([23894, 1])
2025-06-03 10:33:42,801 - DEBUG - Edge anomaly scores shape: torch.Size([50770, 1])
2025-06-03 10:33:42,802 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:43,528 - DEBUG - Step 17: Loss=0.5676
2025-06-03 10:33:43,528 - DEBUG - Online update step: 18/50
2025-06-03 10:33:43,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:44,165 - DEBUG - Node anomaly scores shape: torch.Size([23656, 1])
2025-06-03 10:33:44,177 - DEBUG - Edge anomaly scores shape: torch.Size([50303, 1])
2025-06-03 10:33:44,178 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:44,920 - DEBUG - Step 18: Loss=0.5701
2025-06-03 10:33:44,920 - DEBUG - Online update step: 19/50
2025-06-03 10:33:44,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:45,804 - DEBUG - Node anomaly scores shape: torch.Size([25373, 1])
2025-06-03 10:33:45,822 - DEBUG - Edge anomaly scores shape: torch.Size([54142, 1])
2025-06-03 10:33:45,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:46,938 - DEBUG - Step 19: Loss=0.5689
2025-06-03 10:33:46,938 - DEBUG - Online update step: 20/50
2025-06-03 10:33:46,944 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:47,757 - DEBUG - Node anomaly scores shape: torch.Size([23436, 1])
2025-06-03 10:33:47,775 - DEBUG - Edge anomaly scores shape: torch.Size([49635, 1])
2025-06-03 10:33:47,777 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:48,710 - DEBUG - Step 20: Loss=0.5666
2025-06-03 10:33:48,710 - DEBUG - Online update step: 21/50
2025-06-03 10:33:48,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:49,525 - DEBUG - Node anomaly scores shape: torch.Size([23430, 1])
2025-06-03 10:33:49,543 - DEBUG - Edge anomaly scores shape: torch.Size([49494, 1])
2025-06-03 10:33:49,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:50,487 - DEBUG - Step 21: Loss=0.5660
2025-06-03 10:33:50,487 - DEBUG - Online update step: 22/50
2025-06-03 10:33:50,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:51,356 - DEBUG - Node anomaly scores shape: torch.Size([24725, 1])
2025-06-03 10:33:51,373 - DEBUG - Edge anomaly scores shape: torch.Size([52544, 1])
2025-06-03 10:33:51,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:52,378 - DEBUG - Step 22: Loss=0.5646
2025-06-03 10:33:52,379 - DEBUG - Online update step: 23/50
2025-06-03 10:33:52,384 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:53,041 - DEBUG - Node anomaly scores shape: torch.Size([23300, 1])
2025-06-03 10:33:53,053 - DEBUG - Edge anomaly scores shape: torch.Size([49369, 1])
2025-06-03 10:33:53,054 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:53,819 - DEBUG - Step 23: Loss=0.5658
2025-06-03 10:33:53,819 - DEBUG - Online update step: 24/50
2025-06-03 10:33:53,824 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:54,509 - DEBUG - Node anomaly scores shape: torch.Size([24916, 1])
2025-06-03 10:33:54,521 - DEBUG - Edge anomaly scores shape: torch.Size([53210, 1])
2025-06-03 10:33:54,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:55,351 - DEBUG - Step 24: Loss=0.5658
2025-06-03 10:33:55,351 - DEBUG - Online update step: 25/50
2025-06-03 10:33:55,357 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:56,008 - DEBUG - Node anomaly scores shape: torch.Size([24227, 1])
2025-06-03 10:33:56,021 - DEBUG - Edge anomaly scores shape: torch.Size([51428, 1])
2025-06-03 10:33:56,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:56,763 - DEBUG - Step 25: Loss=0.5656
2025-06-03 10:33:56,764 - DEBUG - Online update step: 26/50
2025-06-03 10:33:56,767 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:57,502 - DEBUG - Node anomaly scores shape: torch.Size([25040, 1])
2025-06-03 10:33:57,517 - DEBUG - Edge anomaly scores shape: torch.Size([53413, 1])
2025-06-03 10:33:57,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:58,276 - DEBUG - Step 26: Loss=0.5674
2025-06-03 10:33:58,276 - DEBUG - Online update step: 27/50
2025-06-03 10:33:58,281 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:33:59,008 - DEBUG - Node anomaly scores shape: torch.Size([24991, 1])
2025-06-03 10:33:59,027 - DEBUG - Edge anomaly scores shape: torch.Size([53356, 1])
2025-06-03 10:33:59,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:33:59,825 - DEBUG - Step 27: Loss=0.5672
2025-06-03 10:33:59,825 - DEBUG - Online update step: 28/50
2025-06-03 10:33:59,829 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:00,468 - DEBUG - Node anomaly scores shape: torch.Size([24158, 1])
2025-06-03 10:34:00,481 - DEBUG - Edge anomaly scores shape: torch.Size([51421, 1])
2025-06-03 10:34:00,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:01,216 - DEBUG - Step 28: Loss=0.5678
2025-06-03 10:34:01,216 - DEBUG - Online update step: 29/50
2025-06-03 10:34:01,219 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:02,136 - DEBUG - Node anomaly scores shape: torch.Size([24782, 1])
2025-06-03 10:34:02,203 - DEBUG - Edge anomaly scores shape: torch.Size([52895, 1])
2025-06-03 10:34:02,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:03,215 - DEBUG - Step 29: Loss=0.5669
2025-06-03 10:34:03,216 - DEBUG - Online update step: 30/50
2025-06-03 10:34:03,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:03,915 - DEBUG - Node anomaly scores shape: torch.Size([24852, 1])
2025-06-03 10:34:03,929 - DEBUG - Edge anomaly scores shape: torch.Size([52937, 1])
2025-06-03 10:34:03,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:04,915 - DEBUG - Step 30: Loss=0.5651
2025-06-03 10:34:04,915 - DEBUG - Online update step: 31/50
2025-06-03 10:34:04,918 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:07,838 - DEBUG - Node anomaly scores shape: torch.Size([25096, 1])
2025-06-03 10:34:08,009 - DEBUG - Edge anomaly scores shape: torch.Size([53492, 1])
2025-06-03 10:34:08,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:11,604 - DEBUG - Step 31: Loss=0.5653
2025-06-03 10:34:11,605 - DEBUG - Online update step: 32/50
2025-06-03 10:34:11,613 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:13,629 - DEBUG - Node anomaly scores shape: torch.Size([25100, 1])
2025-06-03 10:34:13,700 - DEBUG - Edge anomaly scores shape: torch.Size([53575, 1])
2025-06-03 10:34:13,717 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:14,711 - DEBUG - Step 32: Loss=0.5649
2025-06-03 10:34:14,711 - DEBUG - Online update step: 33/50
2025-06-03 10:34:14,714 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:15,534 - DEBUG - Node anomaly scores shape: torch.Size([25978, 1])
2025-06-03 10:34:15,552 - DEBUG - Edge anomaly scores shape: torch.Size([55612, 1])
2025-06-03 10:34:15,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:16,355 - DEBUG - Step 33: Loss=0.5652
2025-06-03 10:34:16,356 - DEBUG - Online update step: 34/50
2025-06-03 10:34:16,359 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:17,104 - DEBUG - Node anomaly scores shape: torch.Size([25260, 1])
2025-06-03 10:34:17,119 - DEBUG - Edge anomaly scores shape: torch.Size([53929, 1])
2025-06-03 10:34:17,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:18,092 - DEBUG - Step 34: Loss=0.5656
2025-06-03 10:34:18,092 - DEBUG - Online update step: 35/50
2025-06-03 10:34:18,107 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:19,272 - DEBUG - Node anomaly scores shape: torch.Size([25643, 1])
2025-06-03 10:34:19,302 - DEBUG - Edge anomaly scores shape: torch.Size([54839, 1])
2025-06-03 10:34:19,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:20,405 - DEBUG - Step 35: Loss=0.5649
2025-06-03 10:34:20,406 - DEBUG - Online update step: 36/50
2025-06-03 10:34:20,409 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:21,404 - DEBUG - Node anomaly scores shape: torch.Size([25854, 1])
2025-06-03 10:34:21,419 - DEBUG - Edge anomaly scores shape: torch.Size([55340, 1])
2025-06-03 10:34:21,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:22,523 - DEBUG - Step 36: Loss=0.5654
2025-06-03 10:34:22,523 - DEBUG - Online update step: 37/50
2025-06-03 10:34:22,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:23,499 - DEBUG - Node anomaly scores shape: torch.Size([24920, 1])
2025-06-03 10:34:23,572 - DEBUG - Edge anomaly scores shape: torch.Size([53137, 1])
2025-06-03 10:34:23,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:24,549 - DEBUG - Step 37: Loss=0.5652
2025-06-03 10:34:24,549 - DEBUG - Online update step: 38/50
2025-06-03 10:34:24,553 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:25,776 - DEBUG - Node anomaly scores shape: torch.Size([23672, 1])
2025-06-03 10:34:25,822 - DEBUG - Edge anomaly scores shape: torch.Size([50284, 1])
2025-06-03 10:34:25,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:28,107 - DEBUG - Step 38: Loss=0.5650
2025-06-03 10:34:28,108 - DEBUG - Online update step: 39/50
2025-06-03 10:34:28,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:29,870 - DEBUG - Node anomaly scores shape: torch.Size([23777, 1])
2025-06-03 10:34:29,884 - DEBUG - Edge anomaly scores shape: torch.Size([50527, 1])
2025-06-03 10:34:29,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:30,698 - DEBUG - Step 39: Loss=0.5652
2025-06-03 10:34:30,698 - DEBUG - Online update step: 40/50
2025-06-03 10:34:30,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:31,480 - DEBUG - Node anomaly scores shape: torch.Size([24695, 1])
2025-06-03 10:34:31,508 - DEBUG - Edge anomaly scores shape: torch.Size([52603, 1])
2025-06-03 10:34:31,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:32,428 - DEBUG - Step 40: Loss=0.5647
2025-06-03 10:34:32,428 - DEBUG - Online update step: 41/50
2025-06-03 10:34:32,431 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:33,094 - DEBUG - Node anomaly scores shape: torch.Size([23541, 1])
2025-06-03 10:34:33,109 - DEBUG - Edge anomaly scores shape: torch.Size([49863, 1])
2025-06-03 10:34:33,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:33,815 - DEBUG - Step 41: Loss=0.5652
2025-06-03 10:34:33,815 - DEBUG - Online update step: 42/50
2025-06-03 10:34:33,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:34,405 - DEBUG - Node anomaly scores shape: torch.Size([24006, 1])
2025-06-03 10:34:34,417 - DEBUG - Edge anomaly scores shape: torch.Size([50940, 1])
2025-06-03 10:34:34,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:35,212 - DEBUG - Step 42: Loss=0.5659
2025-06-03 10:34:35,212 - DEBUG - Online update step: 43/50
2025-06-03 10:34:35,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:36,843 - DEBUG - Node anomaly scores shape: torch.Size([24109, 1])
2025-06-03 10:34:36,931 - DEBUG - Edge anomaly scores shape: torch.Size([51332, 1])
2025-06-03 10:34:36,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:39,075 - DEBUG - Step 43: Loss=0.5662
2025-06-03 10:34:39,076 - DEBUG - Online update step: 44/50
2025-06-03 10:34:39,080 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:40,307 - DEBUG - Node anomaly scores shape: torch.Size([25371, 1])
2025-06-03 10:34:40,363 - DEBUG - Edge anomaly scores shape: torch.Size([54224, 1])
2025-06-03 10:34:40,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:41,986 - DEBUG - Step 44: Loss=0.5667
2025-06-03 10:34:41,986 - DEBUG - Online update step: 45/50
2025-06-03 10:34:41,991 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:42,941 - DEBUG - Node anomaly scores shape: torch.Size([26341, 1])
2025-06-03 10:34:42,970 - DEBUG - Edge anomaly scores shape: torch.Size([56511, 1])
2025-06-03 10:34:42,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:44,242 - DEBUG - Step 45: Loss=0.5661
2025-06-03 10:34:44,243 - DEBUG - Online update step: 46/50
2025-06-03 10:34:44,246 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:45,399 - DEBUG - Node anomaly scores shape: torch.Size([23844, 1])
2025-06-03 10:34:45,422 - DEBUG - Edge anomaly scores shape: torch.Size([50800, 1])
2025-06-03 10:34:45,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:46,639 - DEBUG - Step 46: Loss=0.5654
2025-06-03 10:34:46,640 - DEBUG - Online update step: 47/50
2025-06-03 10:34:46,643 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:49,117 - DEBUG - Node anomaly scores shape: torch.Size([25997, 1])
2025-06-03 10:34:49,201 - DEBUG - Edge anomaly scores shape: torch.Size([55770, 1])
2025-06-03 10:34:49,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:50,598 - DEBUG - Step 47: Loss=0.5643
2025-06-03 10:34:50,598 - DEBUG - Online update step: 48/50
2025-06-03 10:34:50,603 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:51,341 - DEBUG - Node anomaly scores shape: torch.Size([25450, 1])
2025-06-03 10:34:51,356 - DEBUG - Edge anomaly scores shape: torch.Size([54265, 1])
2025-06-03 10:34:51,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:52,400 - DEBUG - Step 48: Loss=0.5654
2025-06-03 10:34:52,400 - DEBUG - Online update step: 49/50
2025-06-03 10:34:52,403 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:53,378 - DEBUG - Node anomaly scores shape: torch.Size([24734, 1])
2025-06-03 10:34:53,391 - DEBUG - Edge anomaly scores shape: torch.Size([52740, 1])
2025-06-03 10:34:53,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:54,308 - DEBUG - Step 49: Loss=0.5659
2025-06-03 10:34:54,309 - DEBUG - Online update step: 50/50
2025-06-03 10:34:54,312 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:54,958 - DEBUG - Node anomaly scores shape: torch.Size([24591, 1])
2025-06-03 10:34:54,970 - DEBUG - Edge anomaly scores shape: torch.Size([52345, 1])
2025-06-03 10:34:54,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:55,745 - DEBUG - Step 50: Loss=0.5664
2025-06-03 10:34:55,745 - INFO - Online update finished. Average loss: 0.5661, Learning rate: 0.001000
2025-06-03 10:34:55,746 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:34:55,746 - DEBUG - Node drift difference: 0.0013, Edge drift difference: 0.0004
2025-06-03 10:34:55,747 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:34:55,748 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-03 10:34:55,748 - INFO - Online update complete. Loss: 0.5661
2025-06-03 10:34:55,748 - INFO - Running anomaly detection...
2025-06-03 10:34:55,748 - INFO - Starting anomaly detection.
2025-06-03 10:34:55,792 - DEBUG - Node reconstruction errors: [0.00150088 0.00320632 0.00177951 ... 0.02513555 0.02513558 0.02513558]
2025-06-03 10:34:55,792 - DEBUG - Edge reconstruction errors: [0.15465835 1.6568416  1.6579024  ... 0.1540957  1.2529384  0.15403838]
2025-06-03 10:34:55,794 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103455_update_50.json
2025-06-03 10:34:55,794 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:34:55,810 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103455_update_50.pth and as latest_checkpoint.pth
2025-06-03 10:34:55,811 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870835.dot): 0.3660
2025-06-03 10:34:55,811 - WARNING - Detected 35 anomalous nodes (reconstruction-based):
2025-06-03 10:34:55,811 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0226, MLP Score: 0.5021
2025-06-03 10:34:55,811 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0284, MLP Score: 0.5060
2025-06-03 10:34:55,811 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0171, MLP Score: 0.5026
2025-06-03 10:34:55,811 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0209, MLP Score: 0.5027
2025-06-03 10:34:55,811 - WARNING -   Node ID: 142.250.196.238, Recon Error: 0.0440, MLP Score: 0.5013
2025-06-03 10:34:55,811 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:34:55,811 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7283, MLP Score: 0.5005
2025-06-03 10:34:55,811 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3319, MLP Score: 0.5005
2025-06-03 10:34:55,811 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9178, MLP Score: 0.5011
2025-06-03 10:34:55,811 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3443, MLP Score: 0.5004
2025-06-03 10:34:55,811 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3507, MLP Score: 0.5005
2025-06-03 10:34:55,811 - INFO - 
--- Processing file: nw_graph_encoded_1748870865.dot (Timestamp: 2025-06-02 15:27:45) ---
2025-06-03 10:34:55,812 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-03 10:34:55,812 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-03 10:34:55,842 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-03 10:34:55,870 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-03 10:34:55,870 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-03 10:34:55,870 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-03 10:34:55,892 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-03 10:34:55,915 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-03 10:34:55,916 - INFO - Processing node updates/additions.
2025-06-03 10:34:55,920 - INFO - Processing edge updates/additions.
2025-06-03 10:34:55,932 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:34:55,932 - INFO - Finished updating NetworkX graph.
2025-06-03 10:34:55,932 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:34:55,933 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:34:55,944 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 10:34:55,945 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:34:55,945 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 10:34:55,947 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 10:34:55,948 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:34:55,952 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:34:55,953 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:34:55,954 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:34:55,956 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-03 10:34:55,957 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:34:55,957 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-03 10:34:55,957 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-03 10:34:55,957 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:34:55,961 - INFO - Performing online update...
2025-06-03 10:34:55,961 - INFO - Starting online update for 50 steps.
2025-06-03 10:34:55,961 - DEBUG - Updated RunningStats: new_mean=0.950019458650577, new_var=29400000000161.312, new_n=2970
2025-06-03 10:34:55,961 - DEBUG - Updated RunningStats: new_mean=0.9479038725265241, new_var=29700000000018.355, new_n=3000
2025-06-03 10:34:55,962 - DEBUG - Updated RunningStats: new_mean=1.2409244727503854, new_var=9800000000093.232, new_n=990
2025-06-03 10:34:55,962 - DEBUG - Updated RunningStats: new_mean=1.2392637950676164, new_var=9900000000001.77, new_n=1000
2025-06-03 10:34:55,962 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:34:55,962 - DEBUG - Online update step: 1/50
2025-06-03 10:34:55,964 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:56,742 - DEBUG - Node anomaly scores shape: torch.Size([24000, 1])
2025-06-03 10:34:56,756 - DEBUG - Edge anomaly scores shape: torch.Size([50895, 1])
2025-06-03 10:34:56,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:57,646 - DEBUG - Step 1: Loss=0.5668
2025-06-03 10:34:57,646 - DEBUG - Online update step: 2/50
2025-06-03 10:34:57,649 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:58,374 - DEBUG - Node anomaly scores shape: torch.Size([24742, 1])
2025-06-03 10:34:58,389 - DEBUG - Edge anomaly scores shape: torch.Size([52719, 1])
2025-06-03 10:34:58,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:34:59,226 - DEBUG - Step 2: Loss=0.5663
2025-06-03 10:34:59,227 - DEBUG - Online update step: 3/50
2025-06-03 10:34:59,233 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:34:59,953 - DEBUG - Node anomaly scores shape: torch.Size([24818, 1])
2025-06-03 10:34:59,967 - DEBUG - Edge anomaly scores shape: torch.Size([52987, 1])
2025-06-03 10:34:59,969 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:00,778 - DEBUG - Step 3: Loss=0.5659
2025-06-03 10:35:00,778 - DEBUG - Online update step: 4/50
2025-06-03 10:35:00,782 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:01,529 - DEBUG - Node anomaly scores shape: torch.Size([24954, 1])
2025-06-03 10:35:01,546 - DEBUG - Edge anomaly scores shape: torch.Size([53241, 1])
2025-06-03 10:35:01,547 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:02,294 - DEBUG - Step 4: Loss=0.5662
2025-06-03 10:35:02,294 - DEBUG - Online update step: 5/50
2025-06-03 10:35:02,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:02,961 - DEBUG - Node anomaly scores shape: torch.Size([24774, 1])
2025-06-03 10:35:02,975 - DEBUG - Edge anomaly scores shape: torch.Size([52756, 1])
2025-06-03 10:35:02,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:03,749 - DEBUG - Step 5: Loss=0.5659
2025-06-03 10:35:03,749 - DEBUG - Online update step: 6/50
2025-06-03 10:35:03,752 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:04,411 - DEBUG - Node anomaly scores shape: torch.Size([24567, 1])
2025-06-03 10:35:04,426 - DEBUG - Edge anomaly scores shape: torch.Size([52443, 1])
2025-06-03 10:35:04,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:05,182 - DEBUG - Step 6: Loss=0.5663
2025-06-03 10:35:05,182 - DEBUG - Online update step: 7/50
2025-06-03 10:35:05,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:05,954 - DEBUG - Node anomaly scores shape: torch.Size([25806, 1])
2025-06-03 10:35:05,967 - DEBUG - Edge anomaly scores shape: torch.Size([55207, 1])
2025-06-03 10:35:05,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:06,873 - DEBUG - Step 7: Loss=0.5660
2025-06-03 10:35:06,873 - DEBUG - Online update step: 8/50
2025-06-03 10:35:06,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:07,493 - DEBUG - Node anomaly scores shape: torch.Size([23444, 1])
2025-06-03 10:35:07,514 - DEBUG - Edge anomaly scores shape: torch.Size([49594, 1])
2025-06-03 10:35:07,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:08,401 - DEBUG - Step 8: Loss=0.5670
2025-06-03 10:35:08,401 - DEBUG - Online update step: 9/50
2025-06-03 10:35:08,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:09,081 - DEBUG - Node anomaly scores shape: torch.Size([24072, 1])
2025-06-03 10:35:09,099 - DEBUG - Edge anomaly scores shape: torch.Size([51312, 1])
2025-06-03 10:35:09,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:09,952 - DEBUG - Step 9: Loss=0.5664
2025-06-03 10:35:09,953 - DEBUG - Online update step: 10/50
2025-06-03 10:35:09,956 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:10,674 - DEBUG - Node anomaly scores shape: torch.Size([24246, 1])
2025-06-03 10:35:10,688 - DEBUG - Edge anomaly scores shape: torch.Size([51723, 1])
2025-06-03 10:35:10,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:11,462 - DEBUG - Step 10: Loss=0.5650
2025-06-03 10:35:11,462 - DEBUG - Online update step: 11/50
2025-06-03 10:35:11,466 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:12,209 - DEBUG - Node anomaly scores shape: torch.Size([25352, 1])
2025-06-03 10:35:12,230 - DEBUG - Edge anomaly scores shape: torch.Size([54154, 1])
2025-06-03 10:35:12,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:13,020 - DEBUG - Step 11: Loss=0.5650
2025-06-03 10:35:13,020 - DEBUG - Online update step: 12/50
2025-06-03 10:35:13,023 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:13,726 - DEBUG - Node anomaly scores shape: torch.Size([25255, 1])
2025-06-03 10:35:13,744 - DEBUG - Edge anomaly scores shape: torch.Size([53939, 1])
2025-06-03 10:35:13,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:14,563 - DEBUG - Step 12: Loss=0.5644
2025-06-03 10:35:14,564 - DEBUG - Online update step: 13/50
2025-06-03 10:35:14,567 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:15,183 - DEBUG - Node anomaly scores shape: torch.Size([23548, 1])
2025-06-03 10:35:15,197 - DEBUG - Edge anomaly scores shape: torch.Size([49947, 1])
2025-06-03 10:35:15,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:15,919 - DEBUG - Step 13: Loss=0.5648
2025-06-03 10:35:15,919 - DEBUG - Online update step: 14/50
2025-06-03 10:35:15,922 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:16,631 - DEBUG - Node anomaly scores shape: torch.Size([25325, 1])
2025-06-03 10:35:16,643 - DEBUG - Edge anomaly scores shape: torch.Size([54105, 1])
2025-06-03 10:35:16,645 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:17,417 - DEBUG - Step 14: Loss=0.5651
2025-06-03 10:35:17,417 - DEBUG - Online update step: 15/50
2025-06-03 10:35:17,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:18,126 - DEBUG - Node anomaly scores shape: torch.Size([24989, 1])
2025-06-03 10:35:18,140 - DEBUG - Edge anomaly scores shape: torch.Size([53197, 1])
2025-06-03 10:35:18,141 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:18,952 - DEBUG - Step 15: Loss=0.5643
2025-06-03 10:35:18,953 - DEBUG - Online update step: 16/50
2025-06-03 10:35:18,957 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:19,717 - DEBUG - Node anomaly scores shape: torch.Size([24516, 1])
2025-06-03 10:35:19,731 - DEBUG - Edge anomaly scores shape: torch.Size([52222, 1])
2025-06-03 10:35:19,732 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:20,682 - DEBUG - Step 16: Loss=0.5648
2025-06-03 10:35:20,682 - DEBUG - Online update step: 17/50
2025-06-03 10:35:20,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:21,412 - DEBUG - Node anomaly scores shape: torch.Size([24155, 1])
2025-06-03 10:35:21,448 - DEBUG - Edge anomaly scores shape: torch.Size([51413, 1])
2025-06-03 10:35:21,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:22,491 - DEBUG - Step 17: Loss=0.5643
2025-06-03 10:35:22,491 - DEBUG - Online update step: 18/50
2025-06-03 10:35:22,494 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:23,252 - DEBUG - Node anomaly scores shape: torch.Size([24865, 1])
2025-06-03 10:35:23,265 - DEBUG - Edge anomaly scores shape: torch.Size([53086, 1])
2025-06-03 10:35:23,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:24,022 - DEBUG - Step 18: Loss=0.5650
2025-06-03 10:35:24,023 - DEBUG - Online update step: 19/50
2025-06-03 10:35:24,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:24,673 - DEBUG - Node anomaly scores shape: torch.Size([25333, 1])
2025-06-03 10:35:24,686 - DEBUG - Edge anomaly scores shape: torch.Size([54145, 1])
2025-06-03 10:35:24,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:25,529 - DEBUG - Step 19: Loss=0.5650
2025-06-03 10:35:25,530 - DEBUG - Online update step: 20/50
2025-06-03 10:35:25,535 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:26,448 - DEBUG - Node anomaly scores shape: torch.Size([26310, 1])
2025-06-03 10:35:26,462 - DEBUG - Edge anomaly scores shape: torch.Size([56421, 1])
2025-06-03 10:35:26,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:27,507 - DEBUG - Step 20: Loss=0.5655
2025-06-03 10:35:27,507 - DEBUG - Online update step: 21/50
2025-06-03 10:35:27,512 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:28,413 - DEBUG - Node anomaly scores shape: torch.Size([25411, 1])
2025-06-03 10:35:28,430 - DEBUG - Edge anomaly scores shape: torch.Size([54178, 1])
2025-06-03 10:35:28,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:29,513 - DEBUG - Step 21: Loss=0.5662
2025-06-03 10:35:29,513 - DEBUG - Online update step: 22/50
2025-06-03 10:35:29,517 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:30,399 - DEBUG - Node anomaly scores shape: torch.Size([25579, 1])
2025-06-03 10:35:30,412 - DEBUG - Edge anomaly scores shape: torch.Size([54743, 1])
2025-06-03 10:35:30,414 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:31,171 - DEBUG - Step 22: Loss=0.5672
2025-06-03 10:35:31,171 - DEBUG - Online update step: 23/50
2025-06-03 10:35:31,174 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:31,907 - DEBUG - Node anomaly scores shape: torch.Size([24700, 1])
2025-06-03 10:35:31,924 - DEBUG - Edge anomaly scores shape: torch.Size([52648, 1])
2025-06-03 10:35:31,925 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:32,735 - DEBUG - Step 23: Loss=0.5687
2025-06-03 10:35:32,735 - DEBUG - Online update step: 24/50
2025-06-03 10:35:32,739 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:33,514 - DEBUG - Node anomaly scores shape: torch.Size([24626, 1])
2025-06-03 10:35:33,537 - DEBUG - Edge anomaly scores shape: torch.Size([52454, 1])
2025-06-03 10:35:33,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:34,311 - DEBUG - Step 24: Loss=0.5652
2025-06-03 10:35:34,312 - DEBUG - Online update step: 25/50
2025-06-03 10:35:34,315 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:35,119 - DEBUG - Node anomaly scores shape: torch.Size([25526, 1])
2025-06-03 10:35:35,134 - DEBUG - Edge anomaly scores shape: torch.Size([54532, 1])
2025-06-03 10:35:35,135 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:35,975 - DEBUG - Step 25: Loss=0.5648
2025-06-03 10:35:35,976 - DEBUG - Online update step: 26/50
2025-06-03 10:35:35,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:36,754 - DEBUG - Node anomaly scores shape: torch.Size([24855, 1])
2025-06-03 10:35:36,769 - DEBUG - Edge anomaly scores shape: torch.Size([53057, 1])
2025-06-03 10:35:36,771 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:37,525 - DEBUG - Step 26: Loss=0.5651
2025-06-03 10:35:37,525 - DEBUG - Online update step: 27/50
2025-06-03 10:35:37,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:38,201 - DEBUG - Node anomaly scores shape: torch.Size([24328, 1])
2025-06-03 10:35:38,215 - DEBUG - Edge anomaly scores shape: torch.Size([51811, 1])
2025-06-03 10:35:38,216 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:38,983 - DEBUG - Step 27: Loss=0.5677
2025-06-03 10:35:38,983 - DEBUG - Online update step: 28/50
2025-06-03 10:35:38,986 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:39,800 - DEBUG - Node anomaly scores shape: torch.Size([24554, 1])
2025-06-03 10:35:39,813 - DEBUG - Edge anomaly scores shape: torch.Size([52262, 1])
2025-06-03 10:35:39,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:40,626 - DEBUG - Step 28: Loss=0.5691
2025-06-03 10:35:40,628 - DEBUG - Online update step: 29/50
2025-06-03 10:35:40,635 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:41,582 - DEBUG - Node anomaly scores shape: torch.Size([25236, 1])
2025-06-03 10:35:41,595 - DEBUG - Edge anomaly scores shape: torch.Size([53900, 1])
2025-06-03 10:35:41,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:42,340 - DEBUG - Step 29: Loss=0.5657
2025-06-03 10:35:42,340 - DEBUG - Online update step: 30/50
2025-06-03 10:35:42,345 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:43,012 - DEBUG - Node anomaly scores shape: torch.Size([25247, 1])
2025-06-03 10:35:43,026 - DEBUG - Edge anomaly scores shape: torch.Size([53923, 1])
2025-06-03 10:35:43,028 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:43,867 - DEBUG - Step 30: Loss=0.5649
2025-06-03 10:35:43,867 - DEBUG - Online update step: 31/50
2025-06-03 10:35:43,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:44,785 - DEBUG - Node anomaly scores shape: torch.Size([25446, 1])
2025-06-03 10:35:44,815 - DEBUG - Edge anomaly scores shape: torch.Size([54261, 1])
2025-06-03 10:35:44,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:45,904 - DEBUG - Step 31: Loss=0.5644
2025-06-03 10:35:45,905 - DEBUG - Online update step: 32/50
2025-06-03 10:35:45,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:46,636 - DEBUG - Node anomaly scores shape: torch.Size([25442, 1])
2025-06-03 10:35:46,651 - DEBUG - Edge anomaly scores shape: torch.Size([54323, 1])
2025-06-03 10:35:46,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:47,398 - DEBUG - Step 32: Loss=0.5670
2025-06-03 10:35:47,398 - DEBUG - Online update step: 33/50
2025-06-03 10:35:47,401 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:48,094 - DEBUG - Node anomaly scores shape: torch.Size([25711, 1])
2025-06-03 10:35:48,108 - DEBUG - Edge anomaly scores shape: torch.Size([54823, 1])
2025-06-03 10:35:48,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:48,862 - DEBUG - Step 33: Loss=0.5677
2025-06-03 10:35:48,862 - DEBUG - Online update step: 34/50
2025-06-03 10:35:48,865 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:49,558 - DEBUG - Node anomaly scores shape: torch.Size([24391, 1])
2025-06-03 10:35:49,571 - DEBUG - Edge anomaly scores shape: torch.Size([51977, 1])
2025-06-03 10:35:49,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:50,326 - DEBUG - Step 34: Loss=0.5683
2025-06-03 10:35:50,326 - DEBUG - Online update step: 35/50
2025-06-03 10:35:50,330 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:51,069 - DEBUG - Node anomaly scores shape: torch.Size([25662, 1])
2025-06-03 10:35:51,085 - DEBUG - Edge anomaly scores shape: torch.Size([54968, 1])
2025-06-03 10:35:51,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:52,280 - DEBUG - Step 35: Loss=0.5668
2025-06-03 10:35:52,280 - DEBUG - Online update step: 36/50
2025-06-03 10:35:52,284 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:53,121 - DEBUG - Node anomaly scores shape: torch.Size([26640, 1])
2025-06-03 10:35:53,137 - DEBUG - Edge anomaly scores shape: torch.Size([57413, 1])
2025-06-03 10:35:53,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:54,020 - DEBUG - Step 36: Loss=0.5641
2025-06-03 10:35:54,020 - DEBUG - Online update step: 37/50
2025-06-03 10:35:54,023 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:54,682 - DEBUG - Node anomaly scores shape: torch.Size([25535, 1])
2025-06-03 10:35:54,705 - DEBUG - Edge anomaly scores shape: torch.Size([54442, 1])
2025-06-03 10:35:54,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:55,475 - DEBUG - Step 37: Loss=0.5657
2025-06-03 10:35:55,476 - DEBUG - Online update step: 38/50
2025-06-03 10:35:55,480 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:35:56,578 - DEBUG - Node anomaly scores shape: torch.Size([24768, 1])
2025-06-03 10:35:56,599 - DEBUG - Edge anomaly scores shape: torch.Size([52785, 1])
2025-06-03 10:35:56,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:35:58,664 - DEBUG - Step 38: Loss=0.5672
2025-06-03 10:35:58,664 - DEBUG - Online update step: 39/50
2025-06-03 10:35:58,669 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:01,384 - DEBUG - Node anomaly scores shape: torch.Size([26040, 1])
2025-06-03 10:36:01,460 - DEBUG - Edge anomaly scores shape: torch.Size([55812, 1])
2025-06-03 10:36:01,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:02,587 - DEBUG - Step 39: Loss=0.5667
2025-06-03 10:36:02,588 - DEBUG - Online update step: 40/50
2025-06-03 10:36:02,593 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:03,643 - DEBUG - Node anomaly scores shape: torch.Size([24731, 1])
2025-06-03 10:36:03,659 - DEBUG - Edge anomaly scores shape: torch.Size([52727, 1])
2025-06-03 10:36:03,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:04,827 - DEBUG - Step 40: Loss=0.5671
2025-06-03 10:36:04,828 - DEBUG - Online update step: 41/50
2025-06-03 10:36:04,831 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:05,750 - DEBUG - Node anomaly scores shape: torch.Size([25119, 1])
2025-06-03 10:36:05,764 - DEBUG - Edge anomaly scores shape: torch.Size([53713, 1])
2025-06-03 10:36:05,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:06,693 - DEBUG - Step 41: Loss=0.5664
2025-06-03 10:36:06,693 - DEBUG - Online update step: 42/50
2025-06-03 10:36:06,696 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:07,403 - DEBUG - Node anomaly scores shape: torch.Size([25189, 1])
2025-06-03 10:36:07,418 - DEBUG - Edge anomaly scores shape: torch.Size([53859, 1])
2025-06-03 10:36:07,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:08,331 - DEBUG - Step 42: Loss=0.5644
2025-06-03 10:36:08,331 - DEBUG - Online update step: 43/50
2025-06-03 10:36:08,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:09,059 - DEBUG - Node anomaly scores shape: torch.Size([22735, 1])
2025-06-03 10:36:09,077 - DEBUG - Edge anomaly scores shape: torch.Size([48104, 1])
2025-06-03 10:36:09,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:10,176 - DEBUG - Step 43: Loss=0.5656
2025-06-03 10:36:10,176 - DEBUG - Online update step: 44/50
2025-06-03 10:36:10,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:11,117 - DEBUG - Node anomaly scores shape: torch.Size([24809, 1])
2025-06-03 10:36:11,135 - DEBUG - Edge anomaly scores shape: torch.Size([52933, 1])
2025-06-03 10:36:11,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:12,339 - DEBUG - Step 44: Loss=0.5660
2025-06-03 10:36:12,339 - DEBUG - Online update step: 45/50
2025-06-03 10:36:12,342 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:13,298 - DEBUG - Node anomaly scores shape: torch.Size([24327, 1])
2025-06-03 10:36:13,320 - DEBUG - Edge anomaly scores shape: torch.Size([51822, 1])
2025-06-03 10:36:13,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:14,499 - DEBUG - Step 45: Loss=0.5645
2025-06-03 10:36:14,499 - DEBUG - Online update step: 46/50
2025-06-03 10:36:14,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:15,409 - DEBUG - Node anomaly scores shape: torch.Size([25486, 1])
2025-06-03 10:36:15,425 - DEBUG - Edge anomaly scores shape: torch.Size([54377, 1])
2025-06-03 10:36:15,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:16,342 - DEBUG - Step 46: Loss=0.5658
2025-06-03 10:36:16,343 - DEBUG - Online update step: 47/50
2025-06-03 10:36:16,347 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:17,194 - DEBUG - Node anomaly scores shape: torch.Size([25283, 1])
2025-06-03 10:36:17,208 - DEBUG - Edge anomaly scores shape: torch.Size([54003, 1])
2025-06-03 10:36:17,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:18,059 - DEBUG - Step 47: Loss=0.5666
2025-06-03 10:36:18,059 - DEBUG - Online update step: 48/50
2025-06-03 10:36:18,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:18,802 - DEBUG - Node anomaly scores shape: torch.Size([24566, 1])
2025-06-03 10:36:18,817 - DEBUG - Edge anomaly scores shape: torch.Size([52204, 1])
2025-06-03 10:36:18,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:19,645 - DEBUG - Step 48: Loss=0.5656
2025-06-03 10:36:19,645 - DEBUG - Online update step: 49/50
2025-06-03 10:36:19,649 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:20,370 - DEBUG - Node anomaly scores shape: torch.Size([25396, 1])
2025-06-03 10:36:20,383 - DEBUG - Edge anomaly scores shape: torch.Size([54242, 1])
2025-06-03 10:36:20,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:21,101 - DEBUG - Step 49: Loss=0.5650
2025-06-03 10:36:21,101 - DEBUG - Online update step: 50/50
2025-06-03 10:36:21,107 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:21,785 - DEBUG - Node anomaly scores shape: torch.Size([24787, 1])
2025-06-03 10:36:21,798 - DEBUG - Edge anomaly scores shape: torch.Size([52934, 1])
2025-06-03 10:36:21,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:22,635 - DEBUG - Step 50: Loss=0.5665
2025-06-03 10:36:22,635 - INFO - Online update finished. Average loss: 0.5659, Learning rate: 0.001000
2025-06-03 10:36:22,637 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:36:22,637 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:36:22,639 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:36:22,639 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-03 10:36:22,640 - INFO - Online update complete. Loss: 0.5659
2025-06-03 10:36:22,640 - INFO - Running anomaly detection...
2025-06-03 10:36:22,640 - INFO - Starting anomaly detection.
2025-06-03 10:36:22,691 - DEBUG - Node reconstruction errors: [0.00066649 0.00152751 0.00094941 ... 0.01941998 0.01941999 0.01941999]
2025-06-03 10:36:22,692 - DEBUG - Edge reconstruction errors: [0.15411349 1.6566372  1.6576853  ... 0.1534786  1.2522068  0.15338737]
2025-06-03 10:36:22,697 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103622_update_51.json
2025-06-03 10:36:22,698 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:36:22,721 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103622_update_51.pth and as latest_checkpoint.pth
2025-06-03 10:36:22,721 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870865.dot): 0.3674
2025-06-03 10:36:22,721 - WARNING - Detected 34 anomalous nodes (reconstruction-based):
2025-06-03 10:36:22,721 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0222, MLP Score: 0.4952
2025-06-03 10:36:22,721 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0170, MLP Score: 0.4986
2025-06-03 10:36:22,721 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0197, MLP Score: 0.4953
2025-06-03 10:36:22,721 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0259, MLP Score: 0.4959
2025-06-03 10:36:22,722 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0199, MLP Score: 0.4955
2025-06-03 10:36:22,722 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:36:22,722 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7281, MLP Score: 0.4998
2025-06-03 10:36:22,722 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3316, MLP Score: 0.4999
2025-06-03 10:36:22,722 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9177, MLP Score: 0.5003
2025-06-03 10:36:22,722 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3442, MLP Score: 0.4997
2025-06-03 10:36:22,722 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3506, MLP Score: 0.4998
2025-06-03 10:36:22,722 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:36:22,722 - INFO - Performing visualization of node and edge features.
2025-06-03 10:36:22,724 - INFO - Starting visualization of node features.
2025-06-03 10:36:22,724 - INFO - Graph has 1010 nodes and 30 features.
2025-06-03 10:36:22,724 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:36:22,724 - INFO - Calculating feature statistics:
2025-06-03 10:36:22,724 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,725 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,725 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(-3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-1.6894896), 'max': np.float32(3.0762463)}
2025-06-03 10:36:22,725 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-2.8924828), 'max': np.float32(1.7927723)}
2025-06-03 10:36:22,725 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,725 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,725 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,726 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.45463234), 'max': np.float32(2.1995795)}
2025-06-03 10:36:22,726 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.140475), 'max': np.float32(0.8768276)}
2025-06-03 10:36:22,726 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.399235e-08), 'std': np.float32(1.0), 'min': np.float32(-9.469644), 'max': np.float32(0.10784872)}
2025-06-03 10:36:22,726 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 28, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.1380558), 'max': np.float32(1.8795011)}
2025-06-03 10:36:22,726 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 28, 'mean': np.float32(-3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8124613), 'max': np.float32(2.262018)}
2025-06-03 10:36:22,726 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.250495), 'std': np.float32(0.9510936), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-03 10:36:22,726 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9623764), 'std': np.float32(0.2717204), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:36:22,727 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14455445), 'std': np.float32(0.36545786), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:36:22,727 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.39703), 'std': np.float32(0.5731545), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:36:22,727 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.399235e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.10784871), 'max': np.float32(9.469644)}
2025-06-03 10:36:22,727 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.4217823), 'std': np.float32(3.0178218), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:36:22,727 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7663364), 'std': np.float32(2.9103527), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:36:22,727 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6217823), 'std': np.float32(1.4676448), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:36:22,727 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14455445), 'std': np.float32(0.36545786), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:36:22,727 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993069), 'std': np.float32(0.22015184), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:36:22,728 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.1330784e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12699431), 'max': np.float32(16.603127)}
2025-06-03 10:36:22,728 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.2661569e-08), 'std': np.float32(1.0), 'min': np.float32(-0.13846499), 'max': np.float32(7.222042)}
2025-06-03 10:36:22,728 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,728 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,728 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,729 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:36:22,729 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(-7.553856e-09), 'std': np.float32(1.0), 'min': np.float32(-0.9832959), 'max': np.float32(10.431978)}
2025-06-03 10:36:22,729 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0851709), 'max': np.float32(4.450297)}
2025-06-03 10:36:22,749 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c85844d0>
2025-06-03 10:36:22,952 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:36:23,027 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:36:23,067 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:36:24,381 - INFO - Node feature visualization saved to vis/node_features_20250603_103623.png
2025-06-03 10:36:24,382 - INFO - Finished visualization of node features.
2025-06-03 10:36:24,382 - INFO - Performing additional feature analysis:
2025-06-03 10:36:24,382 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:36:24,383 - INFO - Starting visualization of edge features.
2025-06-03 10:36:24,383 - INFO - Graph has 2220 edges and 10 edge features.
2025-06-03 10:36:24,383 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:36:24,383 - INFO - Calculating edge feature statistics:
2025-06-03 10:36:24,383 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:36:24,384 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.147748), 'std': np.float32(1.1023191), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-03 10:36:24,384 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.422072), 'std': np.float32(0.5056075), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:36:24,384 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.7004504), 'std': np.float32(2.138219), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:36:24,384 - INFO - - service: {'name': 'service', 'unique': 38, 'mean': np.float32(-3.4366643e-09), 'std': np.float32(1.0), 'min': np.float32(-0.034648024), 'max': np.float32(33.291576)}
2025-06-03 10:36:24,384 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1498, 'mean': np.float32(-3.4366643e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05975268), 'max': np.float32(27.575073)}
2025-06-03 10:36:24,384 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1564, 'mean': np.float32(3.4366643e-09), 'std': np.float32(1.0), 'min': np.float32(-0.055966113), 'max': np.float32(30.770805)}
2025-06-03 10:36:24,384 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 517, 'mean': np.float32(1.7183321e-09), 'std': np.float32(1.0), 'min': np.float32(-0.043389466), 'max': np.float32(33.16996)}
2025-06-03 10:36:24,384 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1542, 'mean': np.float32(-4.2958304e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08922013), 'max': np.float32(28.79739)}
2025-06-03 10:36:24,384 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1573, 'mean': np.float32(1.7183321e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0889304), 'max': np.float32(27.677246)}
2025-06-03 10:36:24,384 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 574, 'mean': np.float32(-5.1549964e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052437916), 'max': np.float32(32.5958)}
2025-06-03 10:36:24,394 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c1255bb0>
2025-06-03 10:36:24,478 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:36:24,487 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7222c0e19640>
2025-06-03 10:36:24,572 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:36:24,881 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:36:25,204 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:36:25,221 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:36:25,227 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:36:26,681 - INFO - Edge feature visualization saved to vis/edge_features_20250603_103625.png
2025-06-03 10:36:26,682 - INFO - Finished visualization of edge features.
2025-06-03 10:36:26,682 - INFO - Performing additional edge feature analysis:
2025-06-03 10:36:26,682 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:36:26,684 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:36:26,684 - INFO - Graph has 2220 edges and 10 edge features.
2025-06-03 10:36:26,684 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:36:27,010 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_103626_summary.png
2025-06-03 10:36:27,308 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_103626_pca_3d.png
2025-06-03 10:36:27,472 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_103626_pca_variance.png
2025-06-03 10:36:27,472 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:36:27,472 - INFO - 
--- Processing file: nw_graph_encoded_1748870895.dot (Timestamp: 2025-06-02 15:28:15) ---
2025-06-03 10:36:27,472 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-03 10:36:27,472 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-03 10:36:27,497 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-03 10:36:27,516 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-03 10:36:27,516 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-03 10:36:27,516 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-03 10:36:27,533 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-03 10:36:27,552 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-03 10:36:27,552 - INFO - Processing node updates/additions.
2025-06-03 10:36:27,557 - INFO - Processing edge updates/additions.
2025-06-03 10:36:27,567 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:36:27,568 - INFO - Finished updating NetworkX graph.
2025-06-03 10:36:27,568 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:36:27,569 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:36:27,577 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 10:36:27,579 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:36:27,583 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 10:36:27,586 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 10:36:27,587 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:36:27,590 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-03 10:36:27,591 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:36:27,592 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 10:36:27,594 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-03 10:36:27,595 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:36:27,595 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-03 10:36:27,595 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-03 10:36:27,595 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:36:27,597 - INFO - Performing online update...
2025-06-03 10:36:27,597 - INFO - Starting online update for 50 steps.
2025-06-03 10:36:27,598 - DEBUG - Updated RunningStats: new_mean=0.9499714844736523, new_var=30000000000161.312, new_n=3030
2025-06-03 10:36:27,598 - DEBUG - Updated RunningStats: new_mean=0.9478978507655311, new_var=30300000000018.355, new_n=3060
2025-06-03 10:36:27,598 - DEBUG - Updated RunningStats: new_mean=1.2431030351808936, new_var=10000000000093.215, new_n=1010
2025-06-03 10:36:27,598 - DEBUG - Updated RunningStats: new_mean=1.241453561350429, new_var=10100000000001.777, new_n=1020
2025-06-03 10:36:27,598 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 10:36:27,598 - DEBUG - Online update step: 1/50
2025-06-03 10:36:27,600 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:28,396 - DEBUG - Node anomaly scores shape: torch.Size([26015, 1])
2025-06-03 10:36:28,419 - DEBUG - Edge anomaly scores shape: torch.Size([55868, 1])
2025-06-03 10:36:28,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:29,298 - DEBUG - Step 1: Loss=0.5656
2025-06-03 10:36:29,298 - DEBUG - Online update step: 2/50
2025-06-03 10:36:29,301 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:30,009 - DEBUG - Node anomaly scores shape: torch.Size([23981, 1])
2025-06-03 10:36:30,022 - DEBUG - Edge anomaly scores shape: torch.Size([50997, 1])
2025-06-03 10:36:30,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:30,814 - DEBUG - Step 2: Loss=0.5642
2025-06-03 10:36:30,814 - DEBUG - Online update step: 3/50
2025-06-03 10:36:30,817 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:31,498 - DEBUG - Node anomaly scores shape: torch.Size([24446, 1])
2025-06-03 10:36:31,511 - DEBUG - Edge anomaly scores shape: torch.Size([52087, 1])
2025-06-03 10:36:31,513 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:32,334 - DEBUG - Step 3: Loss=0.5652
2025-06-03 10:36:32,334 - DEBUG - Online update step: 4/50
2025-06-03 10:36:32,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:33,280 - DEBUG - Node anomaly scores shape: torch.Size([25555, 1])
2025-06-03 10:36:33,300 - DEBUG - Edge anomaly scores shape: torch.Size([54749, 1])
2025-06-03 10:36:33,302 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:34,307 - DEBUG - Step 4: Loss=0.5651
2025-06-03 10:36:34,307 - DEBUG - Online update step: 5/50
2025-06-03 10:36:34,311 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:35,248 - DEBUG - Node anomaly scores shape: torch.Size([26229, 1])
2025-06-03 10:36:35,268 - DEBUG - Edge anomaly scores shape: torch.Size([56334, 1])
2025-06-03 10:36:35,271 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:36,343 - DEBUG - Step 5: Loss=0.5667
2025-06-03 10:36:36,343 - DEBUG - Online update step: 6/50
2025-06-03 10:36:36,350 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:37,306 - DEBUG - Node anomaly scores shape: torch.Size([26211, 1])
2025-06-03 10:36:37,325 - DEBUG - Edge anomaly scores shape: torch.Size([56291, 1])
2025-06-03 10:36:37,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:38,336 - DEBUG - Step 6: Loss=0.5677
2025-06-03 10:36:38,336 - DEBUG - Online update step: 7/50
2025-06-03 10:36:38,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:39,090 - DEBUG - Node anomaly scores shape: torch.Size([25819, 1])
2025-06-03 10:36:39,103 - DEBUG - Edge anomaly scores shape: torch.Size([55317, 1])
2025-06-03 10:36:39,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:39,893 - DEBUG - Step 7: Loss=0.5671
2025-06-03 10:36:39,893 - DEBUG - Online update step: 8/50
2025-06-03 10:36:39,896 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:40,551 - DEBUG - Node anomaly scores shape: torch.Size([24905, 1])
2025-06-03 10:36:40,563 - DEBUG - Edge anomaly scores shape: torch.Size([53079, 1])
2025-06-03 10:36:40,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:41,292 - DEBUG - Step 8: Loss=0.5681
2025-06-03 10:36:41,293 - DEBUG - Online update step: 9/50
2025-06-03 10:36:41,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:41,938 - DEBUG - Node anomaly scores shape: torch.Size([23213, 1])
2025-06-03 10:36:41,953 - DEBUG - Edge anomaly scores shape: torch.Size([49138, 1])
2025-06-03 10:36:41,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:42,657 - DEBUG - Step 9: Loss=0.5668
2025-06-03 10:36:42,657 - DEBUG - Online update step: 10/50
2025-06-03 10:36:42,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:43,316 - DEBUG - Node anomaly scores shape: torch.Size([24213, 1])
2025-06-03 10:36:43,329 - DEBUG - Edge anomaly scores shape: torch.Size([51623, 1])
2025-06-03 10:36:43,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:44,047 - DEBUG - Step 10: Loss=0.5644
2025-06-03 10:36:44,047 - DEBUG - Online update step: 11/50
2025-06-03 10:36:44,050 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:44,740 - DEBUG - Node anomaly scores shape: torch.Size([25975, 1])
2025-06-03 10:36:44,753 - DEBUG - Edge anomaly scores shape: torch.Size([55676, 1])
2025-06-03 10:36:44,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:45,561 - DEBUG - Step 11: Loss=0.5653
2025-06-03 10:36:45,561 - DEBUG - Online update step: 12/50
2025-06-03 10:36:45,565 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:46,291 - DEBUG - Node anomaly scores shape: torch.Size([25912, 1])
2025-06-03 10:36:46,316 - DEBUG - Edge anomaly scores shape: torch.Size([55635, 1])
2025-06-03 10:36:46,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:47,107 - DEBUG - Step 12: Loss=0.5661
2025-06-03 10:36:47,107 - DEBUG - Online update step: 13/50
2025-06-03 10:36:47,110 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:47,727 - DEBUG - Node anomaly scores shape: torch.Size([23993, 1])
2025-06-03 10:36:47,740 - DEBUG - Edge anomaly scores shape: torch.Size([51023, 1])
2025-06-03 10:36:47,741 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:48,424 - DEBUG - Step 13: Loss=0.5657
2025-06-03 10:36:48,425 - DEBUG - Online update step: 14/50
2025-06-03 10:36:48,428 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:49,079 - DEBUG - Node anomaly scores shape: torch.Size([24801, 1])
2025-06-03 10:36:49,092 - DEBUG - Edge anomaly scores shape: torch.Size([53027, 1])
2025-06-03 10:36:49,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:49,811 - DEBUG - Step 14: Loss=0.5670
2025-06-03 10:36:49,811 - DEBUG - Online update step: 15/50
2025-06-03 10:36:49,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:50,498 - DEBUG - Node anomaly scores shape: torch.Size([23316, 1])
2025-06-03 10:36:50,510 - DEBUG - Edge anomaly scores shape: torch.Size([49290, 1])
2025-06-03 10:36:50,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:51,222 - DEBUG - Step 15: Loss=0.5662
2025-06-03 10:36:51,222 - DEBUG - Online update step: 16/50
2025-06-03 10:36:51,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:51,954 - DEBUG - Node anomaly scores shape: torch.Size([25684, 1])
2025-06-03 10:36:51,968 - DEBUG - Edge anomaly scores shape: torch.Size([55037, 1])
2025-06-03 10:36:51,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:52,818 - DEBUG - Step 16: Loss=0.5640
2025-06-03 10:36:52,818 - DEBUG - Online update step: 17/50
2025-06-03 10:36:52,821 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:53,591 - DEBUG - Node anomaly scores shape: torch.Size([24171, 1])
2025-06-03 10:36:53,605 - DEBUG - Edge anomaly scores shape: torch.Size([51466, 1])
2025-06-03 10:36:53,606 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:54,423 - DEBUG - Step 17: Loss=0.5657
2025-06-03 10:36:54,424 - DEBUG - Online update step: 18/50
2025-06-03 10:36:54,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:55,143 - DEBUG - Node anomaly scores shape: torch.Size([24096, 1])
2025-06-03 10:36:55,168 - DEBUG - Edge anomaly scores shape: torch.Size([51154, 1])
2025-06-03 10:36:55,169 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:56,003 - DEBUG - Step 18: Loss=0.5672
2025-06-03 10:36:56,003 - DEBUG - Online update step: 19/50
2025-06-03 10:36:56,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:56,782 - DEBUG - Node anomaly scores shape: torch.Size([25667, 1])
2025-06-03 10:36:56,797 - DEBUG - Edge anomaly scores shape: torch.Size([55002, 1])
2025-06-03 10:36:56,799 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:57,621 - DEBUG - Step 19: Loss=0.5666
2025-06-03 10:36:57,622 - DEBUG - Online update step: 20/50
2025-06-03 10:36:57,625 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:58,318 - DEBUG - Node anomaly scores shape: torch.Size([24970, 1])
2025-06-03 10:36:58,332 - DEBUG - Edge anomaly scores shape: torch.Size([53360, 1])
2025-06-03 10:36:58,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:36:59,088 - DEBUG - Step 20: Loss=0.5678
2025-06-03 10:36:59,089 - DEBUG - Online update step: 21/50
2025-06-03 10:36:59,093 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:36:59,883 - DEBUG - Node anomaly scores shape: torch.Size([26043, 1])
2025-06-03 10:36:59,900 - DEBUG - Edge anomaly scores shape: torch.Size([55761, 1])
2025-06-03 10:36:59,902 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:00,713 - DEBUG - Step 21: Loss=0.5675
2025-06-03 10:37:00,713 - DEBUG - Online update step: 22/50
2025-06-03 10:37:00,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:01,391 - DEBUG - Node anomaly scores shape: torch.Size([25320, 1])
2025-06-03 10:37:01,405 - DEBUG - Edge anomaly scores shape: torch.Size([54117, 1])
2025-06-03 10:37:01,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:02,146 - DEBUG - Step 22: Loss=0.5654
2025-06-03 10:37:02,147 - DEBUG - Online update step: 23/50
2025-06-03 10:37:02,151 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:02,862 - DEBUG - Node anomaly scores shape: torch.Size([25193, 1])
2025-06-03 10:37:02,884 - DEBUG - Edge anomaly scores shape: torch.Size([53691, 1])
2025-06-03 10:37:02,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:03,685 - DEBUG - Step 23: Loss=0.5650
2025-06-03 10:37:03,685 - DEBUG - Online update step: 24/50
2025-06-03 10:37:03,688 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:04,347 - DEBUG - Node anomaly scores shape: torch.Size([24389, 1])
2025-06-03 10:37:04,360 - DEBUG - Edge anomaly scores shape: torch.Size([51968, 1])
2025-06-03 10:37:04,362 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:05,085 - DEBUG - Step 24: Loss=0.5662
2025-06-03 10:37:05,085 - DEBUG - Online update step: 25/50
2025-06-03 10:37:05,088 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:05,786 - DEBUG - Node anomaly scores shape: torch.Size([24209, 1])
2025-06-03 10:37:05,801 - DEBUG - Edge anomaly scores shape: torch.Size([51458, 1])
2025-06-03 10:37:05,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:06,500 - DEBUG - Step 25: Loss=0.5663
2025-06-03 10:37:06,500 - DEBUG - Online update step: 26/50
2025-06-03 10:37:06,503 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:07,117 - DEBUG - Node anomaly scores shape: torch.Size([23563, 1])
2025-06-03 10:37:07,130 - DEBUG - Edge anomaly scores shape: torch.Size([49948, 1])
2025-06-03 10:37:07,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:07,816 - DEBUG - Step 26: Loss=0.5666
2025-06-03 10:37:07,817 - DEBUG - Online update step: 27/50
2025-06-03 10:37:07,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:08,523 - DEBUG - Node anomaly scores shape: torch.Size([25899, 1])
2025-06-03 10:37:08,540 - DEBUG - Edge anomaly scores shape: torch.Size([55433, 1])
2025-06-03 10:37:08,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:09,342 - DEBUG - Step 27: Loss=0.5665
2025-06-03 10:37:09,343 - DEBUG - Online update step: 28/50
2025-06-03 10:37:09,346 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:10,063 - DEBUG - Node anomaly scores shape: torch.Size([26261, 1])
2025-06-03 10:37:10,082 - DEBUG - Edge anomaly scores shape: torch.Size([56359, 1])
2025-06-03 10:37:10,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:10,922 - DEBUG - Step 28: Loss=0.5645
2025-06-03 10:37:10,922 - DEBUG - Online update step: 29/50
2025-06-03 10:37:10,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:11,551 - DEBUG - Node anomaly scores shape: torch.Size([23695, 1])
2025-06-03 10:37:11,563 - DEBUG - Edge anomaly scores shape: torch.Size([50362, 1])
2025-06-03 10:37:11,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:12,362 - DEBUG - Step 29: Loss=0.5651
2025-06-03 10:37:12,363 - DEBUG - Online update step: 30/50
2025-06-03 10:37:12,367 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:13,225 - DEBUG - Node anomaly scores shape: torch.Size([25449, 1])
2025-06-03 10:37:13,240 - DEBUG - Edge anomaly scores shape: torch.Size([54513, 1])
2025-06-03 10:37:13,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:14,049 - DEBUG - Step 30: Loss=0.5664
2025-06-03 10:37:14,049 - DEBUG - Online update step: 31/50
2025-06-03 10:37:14,052 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:14,693 - DEBUG - Node anomaly scores shape: torch.Size([24890, 1])
2025-06-03 10:37:14,706 - DEBUG - Edge anomaly scores shape: torch.Size([53094, 1])
2025-06-03 10:37:14,707 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:15,423 - DEBUG - Step 31: Loss=0.5656
2025-06-03 10:37:15,423 - DEBUG - Online update step: 32/50
2025-06-03 10:37:15,426 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:16,105 - DEBUG - Node anomaly scores shape: torch.Size([24005, 1])
2025-06-03 10:37:16,119 - DEBUG - Edge anomaly scores shape: torch.Size([51066, 1])
2025-06-03 10:37:16,120 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:16,826 - DEBUG - Step 32: Loss=0.5662
2025-06-03 10:37:16,826 - DEBUG - Online update step: 33/50
2025-06-03 10:37:16,829 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:17,478 - DEBUG - Node anomaly scores shape: torch.Size([24796, 1])
2025-06-03 10:37:17,490 - DEBUG - Edge anomaly scores shape: torch.Size([53023, 1])
2025-06-03 10:37:17,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:18,251 - DEBUG - Step 33: Loss=0.5661
2025-06-03 10:37:18,252 - DEBUG - Online update step: 34/50
2025-06-03 10:37:18,257 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:18,957 - DEBUG - Node anomaly scores shape: torch.Size([25368, 1])
2025-06-03 10:37:18,970 - DEBUG - Edge anomaly scores shape: torch.Size([54385, 1])
2025-06-03 10:37:18,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:19,698 - DEBUG - Step 34: Loss=0.5651
2025-06-03 10:37:19,698 - DEBUG - Online update step: 35/50
2025-06-03 10:37:19,702 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:20,346 - DEBUG - Node anomaly scores shape: torch.Size([23928, 1])
2025-06-03 10:37:20,360 - DEBUG - Edge anomaly scores shape: torch.Size([50816, 1])
2025-06-03 10:37:20,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:21,075 - DEBUG - Step 35: Loss=0.5662
2025-06-03 10:37:21,075 - DEBUG - Online update step: 36/50
2025-06-03 10:37:21,080 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:21,759 - DEBUG - Node anomaly scores shape: torch.Size([25336, 1])
2025-06-03 10:37:21,772 - DEBUG - Edge anomaly scores shape: torch.Size([54113, 1])
2025-06-03 10:37:21,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:22,492 - DEBUG - Step 36: Loss=0.5675
2025-06-03 10:37:22,492 - DEBUG - Online update step: 37/50
2025-06-03 10:37:22,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:23,111 - DEBUG - Node anomaly scores shape: torch.Size([23965, 1])
2025-06-03 10:37:23,132 - DEBUG - Edge anomaly scores shape: torch.Size([50981, 1])
2025-06-03 10:37:23,135 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:23,931 - DEBUG - Step 37: Loss=0.5655
2025-06-03 10:37:23,931 - DEBUG - Online update step: 38/50
2025-06-03 10:37:23,936 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:24,615 - DEBUG - Node anomaly scores shape: torch.Size([24552, 1])
2025-06-03 10:37:24,632 - DEBUG - Edge anomaly scores shape: torch.Size([52255, 1])
2025-06-03 10:37:24,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:25,329 - DEBUG - Step 38: Loss=0.5652
2025-06-03 10:37:25,329 - DEBUG - Online update step: 39/50
2025-06-03 10:37:25,333 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:25,960 - DEBUG - Node anomaly scores shape: torch.Size([23442, 1])
2025-06-03 10:37:25,973 - DEBUG - Edge anomaly scores shape: torch.Size([49558, 1])
2025-06-03 10:37:25,974 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:26,627 - DEBUG - Step 39: Loss=0.5656
2025-06-03 10:37:26,627 - DEBUG - Online update step: 40/50
2025-06-03 10:37:26,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:27,315 - DEBUG - Node anomaly scores shape: torch.Size([24892, 1])
2025-06-03 10:37:27,329 - DEBUG - Edge anomaly scores shape: torch.Size([53156, 1])
2025-06-03 10:37:27,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:28,143 - DEBUG - Step 40: Loss=0.5647
2025-06-03 10:37:28,143 - DEBUG - Online update step: 41/50
2025-06-03 10:37:28,147 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:28,808 - DEBUG - Node anomaly scores shape: torch.Size([25209, 1])
2025-06-03 10:37:28,824 - DEBUG - Edge anomaly scores shape: torch.Size([53876, 1])
2025-06-03 10:37:28,825 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:29,626 - DEBUG - Step 41: Loss=0.5657
2025-06-03 10:37:29,627 - DEBUG - Online update step: 42/50
2025-06-03 10:37:29,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:30,469 - DEBUG - Node anomaly scores shape: torch.Size([25646, 1])
2025-06-03 10:37:30,524 - DEBUG - Edge anomaly scores shape: torch.Size([54836, 1])
2025-06-03 10:37:30,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:31,814 - DEBUG - Step 42: Loss=0.5667
2025-06-03 10:37:31,814 - DEBUG - Online update step: 43/50
2025-06-03 10:37:31,819 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:32,542 - DEBUG - Node anomaly scores shape: torch.Size([25983, 1])
2025-06-03 10:37:32,559 - DEBUG - Edge anomaly scores shape: torch.Size([55626, 1])
2025-06-03 10:37:32,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:33,343 - DEBUG - Step 43: Loss=0.5657
2025-06-03 10:37:33,343 - DEBUG - Online update step: 44/50
2025-06-03 10:37:33,346 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:33,998 - DEBUG - Node anomaly scores shape: torch.Size([25260, 1])
2025-06-03 10:37:34,012 - DEBUG - Edge anomaly scores shape: torch.Size([53910, 1])
2025-06-03 10:37:34,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:34,760 - DEBUG - Step 44: Loss=0.5648
2025-06-03 10:37:34,760 - DEBUG - Online update step: 45/50
2025-06-03 10:37:34,763 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:35,404 - DEBUG - Node anomaly scores shape: torch.Size([25145, 1])
2025-06-03 10:37:35,416 - DEBUG - Edge anomaly scores shape: torch.Size([53695, 1])
2025-06-03 10:37:35,417 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:36,163 - DEBUG - Step 45: Loss=0.5650
2025-06-03 10:37:36,163 - DEBUG - Online update step: 46/50
2025-06-03 10:37:36,166 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:36,762 - DEBUG - Node anomaly scores shape: torch.Size([23488, 1])
2025-06-03 10:37:36,774 - DEBUG - Edge anomaly scores shape: torch.Size([49825, 1])
2025-06-03 10:37:36,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:37,451 - DEBUG - Step 46: Loss=0.5645
2025-06-03 10:37:37,451 - DEBUG - Online update step: 47/50
2025-06-03 10:37:37,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:38,087 - DEBUG - Node anomaly scores shape: torch.Size([24826, 1])
2025-06-03 10:37:38,100 - DEBUG - Edge anomaly scores shape: torch.Size([52925, 1])
2025-06-03 10:37:38,101 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:38,801 - DEBUG - Step 47: Loss=0.5658
2025-06-03 10:37:38,801 - DEBUG - Online update step: 48/50
2025-06-03 10:37:38,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:39,462 - DEBUG - Node anomaly scores shape: torch.Size([24355, 1])
2025-06-03 10:37:39,476 - DEBUG - Edge anomaly scores shape: torch.Size([51974, 1])
2025-06-03 10:37:39,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:40,259 - DEBUG - Step 48: Loss=0.5665
2025-06-03 10:37:40,259 - DEBUG - Online update step: 49/50
2025-06-03 10:37:40,263 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:40,971 - DEBUG - Node anomaly scores shape: torch.Size([25155, 1])
2025-06-03 10:37:40,991 - DEBUG - Edge anomaly scores shape: torch.Size([53621, 1])
2025-06-03 10:37:40,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:42,028 - DEBUG - Step 49: Loss=0.5653
2025-06-03 10:37:42,028 - DEBUG - Online update step: 50/50
2025-06-03 10:37:42,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-03 10:37:42,715 - DEBUG - Node anomaly scores shape: torch.Size([25357, 1])
2025-06-03 10:37:42,728 - DEBUG - Edge anomaly scores shape: torch.Size([54122, 1])
2025-06-03 10:37:42,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:37:43,603 - DEBUG - Step 50: Loss=0.5662
2025-06-03 10:37:43,604 - INFO - Online update finished. Average loss: 0.5659, Learning rate: 0.001000
2025-06-03 10:37:43,604 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:37:43,605 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 10:37:43,606 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  1.1330784e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.7899136e-09
  2.3133683e-08  3.8241396e-08  1.0386552e-08  1.3219248e-08
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.6352933e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -1.4163480e-08  3.7769279e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6096240e-09  3.3992350e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.2887491e-09
  8.5916607e-10  0.0000000e+00 -3.0070813e-09  0.0000000e+00
  1.7183321e-09  0.0000000e+00]
2025-06-03 10:37:43,606 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-03 10:37:43,607 - INFO - Online update complete. Loss: 0.5659
2025-06-03 10:37:43,607 - INFO - Running anomaly detection...
2025-06-03 10:37:43,607 - INFO - Starting anomaly detection.
2025-06-03 10:37:43,706 - DEBUG - Node reconstruction errors: [0.00102061 0.00223121 0.00133793 ... 0.01659624 0.01659623 0.01659623]
2025-06-03 10:37:43,706 - DEBUG - Edge reconstruction errors: [0.15436623 1.6567621  1.6578256  ... 0.15379752 1.2527022  0.15369798]
2025-06-03 10:37:43,709 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_103743_update_52.json
2025-06-03 10:37:43,709 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:37:43,728 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_103743_update_52.pth and as latest_checkpoint.pth
2025-06-03 10:37:43,728 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870895.dot): 0.3712
2025-06-03 10:37:43,728 - WARNING - Detected 34 anomalous nodes (reconstruction-based):
2025-06-03 10:37:43,728 - WARNING -   Node ID: 142.251.167.141, Recon Error: 0.0222, MLP Score: 0.5073
2025-06-03 10:37:43,728 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.0159, MLP Score: 0.5070
2025-06-03 10:37:43,728 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.0160, MLP Score: 0.5041
2025-06-03 10:37:43,728 - WARNING -   Node ID: 192.168.27.13, Recon Error: 0.0212, MLP Score: 0.5044
2025-06-03 10:37:43,728 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0193, MLP Score: 0.5046
2025-06-03 10:37:43,728 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 10:37:43,729 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7283, MLP Score: 0.5000
2025-06-03 10:37:43,729 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.3318, MLP Score: 0.5000
2025-06-03 10:37:43,729 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9178, MLP Score: 0.5004
2025-06-03 10:37:43,729 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 8.3443, MLP Score: 0.4998
2025-06-03 10:37:43,729 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.204, Recon Error: 7.3506, MLP Score: 0.4999
2025-06-03 10:37:43,729 - INFO - Finished processing all files in the directory.
