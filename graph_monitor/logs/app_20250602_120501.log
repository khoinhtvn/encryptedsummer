2025-06-02 12:05:01,364 - INFO - Application logging to file: logs/app_20250602_120501.log
2025-06-02 12:05:01,364 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 12:05:01,365 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/
2025-06-02 12:05:01,365 - INFO - 
--- Processing file: nw_graph_encoded_1748857304.dot (Timestamp: 2025-06-02 11:41:44) ---
2025-06-02 12:05:01,365 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748857304.dot
2025-06-02 12:05:01,365 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748857304.dot
2025-06-02 12:05:01,365 - INFO - Parsed 7 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748857304.dot'.
2025-06-02 12:05:01,366 - INFO - Parsed 9 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748857304.dot'.
2025-06-02 12:05:01,366 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 12:05:01,366 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 12:05:01,366 - DEBUG - Initial node features tensor shape: torch.Size([7, 30])
2025-06-02 12:05:01,366 - INFO - No node feature scaling applied.
2025-06-02 12:05:01,366 - DEBUG - Node features tensor shape after scaling: torch.Size([7, 30])
2025-06-02 12:05:01,368 - DEBUG - Edge index tensor shape: torch.Size([2, 9])
2025-06-02 12:05:01,368 - DEBUG - Sorted edge attribute keys: ['conn_state_partial_other_unknown', 'conn_state_rejected_reset', 'conn_state_successful', 'protocol_ICMP', 'protocol_TCP', 'protocol_UDP', 'protocol_UNKNOWN']
2025-06-02 12:05:01,368 - DEBUG - Initial edge attributes tensor shape: torch.Size([9, 7])
2025-06-02 12:05:01,368 - INFO - No edge attributes found.
2025-06-02 12:05:01,368 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 12:05:01,368 - INFO - Initialized main graph with 7 nodes and 9 edges.
2025-06-02 12:05:01,368 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=7, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 12:05:01,368 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=7, hidden_dim=64, embedding_dim=32
2025-06-02 12:05:01,414 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 12:05:01,415 - DEBUG - Decoder MLP layers initialized.
2025-06-02 12:05:01,415 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 12:05:01,415 - INFO - Optimizer and scheduler initialized.
2025-06-02 12:05:01,415 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 12:05:01,415 - INFO - RunningStats initialized.
2025-06-02 12:05:01,415 - INFO - RunningStats initialized.
2025-06-02 12:05:01,415 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 12:05:01,415 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 12:05:01,416 - INFO - Using device: cpu
2025-06-02 12:05:01,416 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=7)
2025-06-02 12:05:01,416 - INFO - Performing initial training for 50 epochs...
2025-06-02 12:05:01,453 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,454 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,479 - INFO - Epoch 1/50, Loss: 6.6482
2025-06-02 12:05:01,482 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,483 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,483 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,490 - INFO - Epoch 2/50, Loss: 6.4738
2025-06-02 12:05:01,493 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,494 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,501 - INFO - Epoch 3/50, Loss: 6.3279
2025-06-02 12:05:01,506 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,506 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,512 - INFO - Epoch 4/50, Loss: 6.1895
2025-06-02 12:05:01,514 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,514 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,517 - INFO - Epoch 5/50, Loss: 6.0654
2025-06-02 12:05:01,518 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,518 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,521 - INFO - Epoch 6/50, Loss: 5.9362
2025-06-02 12:05:01,523 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,523 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,526 - INFO - Epoch 7/50, Loss: 5.8072
2025-06-02 12:05:01,527 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,528 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,530 - INFO - Epoch 8/50, Loss: 5.6734
2025-06-02 12:05:01,532 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,532 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,535 - INFO - Epoch 9/50, Loss: 5.5314
2025-06-02 12:05:01,537 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,537 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,540 - INFO - Epoch 10/50, Loss: 5.3710
2025-06-02 12:05:01,542 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,542 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,542 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,545 - INFO - Epoch 11/50, Loss: 5.1948
2025-06-02 12:05:01,546 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,547 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,547 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,550 - INFO - Epoch 12/50, Loss: 5.0030
2025-06-02 12:05:01,551 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,551 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,554 - INFO - Epoch 13/50, Loss: 4.7933
2025-06-02 12:05:01,556 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,556 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,557 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,559 - INFO - Epoch 14/50, Loss: 4.5680
2025-06-02 12:05:01,561 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,561 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,564 - INFO - Epoch 15/50, Loss: 4.3265
2025-06-02 12:05:01,566 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,566 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,566 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,569 - INFO - Epoch 16/50, Loss: 4.0765
2025-06-02 12:05:01,571 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,571 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,574 - INFO - Epoch 17/50, Loss: 3.8148
2025-06-02 12:05:01,575 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,576 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,579 - INFO - Epoch 18/50, Loss: 3.4858
2025-06-02 12:05:01,580 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,580 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,581 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,583 - INFO - Epoch 19/50, Loss: 3.1348
2025-06-02 12:05:01,585 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,585 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,588 - INFO - Epoch 20/50, Loss: 2.8205
2025-06-02 12:05:01,590 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,590 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,593 - INFO - Epoch 21/50, Loss: 2.5262
2025-06-02 12:05:01,595 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,595 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,598 - INFO - Epoch 22/50, Loss: 2.2471
2025-06-02 12:05:01,600 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,600 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,603 - INFO - Epoch 23/50, Loss: 1.9913
2025-06-02 12:05:01,604 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,605 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,607 - INFO - Epoch 24/50, Loss: 1.7640
2025-06-02 12:05:01,609 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,610 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,613 - INFO - Epoch 25/50, Loss: 1.5762
2025-06-02 12:05:01,615 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,615 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,618 - INFO - Epoch 26/50, Loss: 1.4231
2025-06-02 12:05:01,620 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,620 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,623 - INFO - Epoch 27/50, Loss: 1.3039
2025-06-02 12:05:01,624 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,625 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,625 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,628 - INFO - Epoch 28/50, Loss: 1.2151
2025-06-02 12:05:01,630 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,630 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,633 - INFO - Epoch 29/50, Loss: 1.1521
2025-06-02 12:05:01,635 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,635 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,635 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,638 - INFO - Epoch 30/50, Loss: 1.1082
2025-06-02 12:05:01,640 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,640 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,644 - INFO - Epoch 31/50, Loss: 1.0793
2025-06-02 12:05:01,646 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,646 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,651 - INFO - Epoch 32/50, Loss: 1.0505
2025-06-02 12:05:01,654 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,654 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,658 - INFO - Epoch 33/50, Loss: 1.0114
2025-06-02 12:05:01,660 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,660 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,663 - INFO - Epoch 34/50, Loss: 0.9689
2025-06-02 12:05:01,665 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,665 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,668 - INFO - Epoch 35/50, Loss: 0.9205
2025-06-02 12:05:01,670 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,670 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,673 - INFO - Epoch 36/50, Loss: 0.8744
2025-06-02 12:05:01,675 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,675 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,678 - INFO - Epoch 37/50, Loss: 0.8439
2025-06-02 12:05:01,680 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,680 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,680 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,683 - INFO - Epoch 38/50, Loss: 0.8179
2025-06-02 12:05:01,685 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,685 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,688 - INFO - Epoch 39/50, Loss: 0.8045
2025-06-02 12:05:01,689 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,689 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,695 - INFO - Epoch 40/50, Loss: 0.8055
2025-06-02 12:05:01,699 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,699 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,699 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,705 - INFO - Epoch 41/50, Loss: 0.8110
2025-06-02 12:05:01,710 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,711 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,714 - INFO - Epoch 42/50, Loss: 0.8181
2025-06-02 12:05:01,718 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,718 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,724 - INFO - Epoch 43/50, Loss: 0.8272
2025-06-02 12:05:01,726 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,726 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,735 - INFO - Epoch 44/50, Loss: 0.8285
2025-06-02 12:05:01,737 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,737 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,743 - INFO - Epoch 45/50, Loss: 0.8254
2025-06-02 12:05:01,745 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,745 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,751 - INFO - Epoch 46/50, Loss: 0.8199
2025-06-02 12:05:01,760 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,760 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,767 - INFO - Epoch 47/50, Loss: 0.8104
2025-06-02 12:05:01,773 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,774 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,783 - INFO - Epoch 48/50, Loss: 0.8016
2025-06-02 12:05:01,791 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,792 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,792 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,796 - INFO - Epoch 49/50, Loss: 0.7924
2025-06-02 12:05:01,798 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 12:05:01,799 - DEBUG - Edge anomaly scores shape: torch.Size([9, 1])
2025-06-02 12:05:01,799 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 12:05:01,804 - INFO - Epoch 50/50, Loss: 0.7850
2025-06-02 12:05:01,804 - INFO - Initial training complete.
2025-06-02 12:05:01,833 - ERROR - Error loading checkpoint: Error(s) in loading state_dict for HybridGNNAnomalyDetector:
	size mismatch for autoencoder.conv1.lin.weight: copying a param with shape torch.Size([256, 29]) from checkpoint, the shape in current model is torch.Size([256, 30]).
	size mismatch for autoencoder.node_decoder.2.weight: copying a param with shape torch.Size([29, 64]) from checkpoint, the shape in current model is torch.Size([30, 64]).
	size mismatch for autoencoder.node_decoder.2.bias: copying a param with shape torch.Size([29]) from checkpoint, the shape in current model is torch.Size([30]).
2025-06-02 12:05:01,834 - INFO - Starting or resuming online updates from step: 0
2025-06-02 12:05:01,835 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-02 12:05:01,835 - INFO - Running anomaly detection...
2025-06-02 12:05:01,836 - INFO - Starting anomaly detection.
2025-06-02 12:05:01,846 - DEBUG - Node reconstruction errors: [9.195613  7.85541   9.22752   9.195613  7.959851  8.918563  4.1263247]
2025-06-02 12:05:01,847 - DEBUG - Edge reconstruction errors: [0.19362709 0.19362709 0.1822334  0.1822334  0.18432021 0.20736381
 0.20736377 0.1660195  0.1660195 ]
2025-06-02 12:05:01,853 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_120501_update_1.json
2025-06-02 12:05:01,853 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 12:05:01,865 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_120501_update_1.pth
2025-06-02 12:05:01,865 - INFO - 
Global anomaly score (after nw_graph_encoded_1748857304.dot): 1.0000
2025-06-02 12:05:01,865 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 12:05:01,865 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 12:05:01,871 - DEBUG - Embedding standard deviations before t-SNE: [0.2908275  0.         0.65327746 0.19911048 0.         0.
 0.609574   0.         0.37433222 0.29706243 0.5281526  0.
 0.32884744 0.62301576 0.10535318 0.75825685 0.18928197 0.5201126
 0.         0.         0.2930796  0.5010867  0.7054647  0.583719
 0.25367844 0.16739045 0.25487784 0.26297882 0.09223057 0.19303992
 0.66937363 0.1820264 ]
2025-06-02 12:05:02,278 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-02 12:05:02,482 - INFO - Embeddings visualization saved to vis/embeddings_1_updates_20250602_120501.png
2025-06-02 12:05:02,483 - INFO - Performing visualization of node and edge features.
2025-06-02 12:05:02,483 - INFO - Starting visualization of node features.
2025-06-02 12:05:02,483 - INFO - Graph has 7 nodes and 30 features.
2025-06-02 12:05:02,483 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 12:05:02,483 - INFO - Calculating feature statistics:
2025-06-02 12:05:02,487 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,488 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,488 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(-0.9840411), 'std': np.float32(1.1920929e-07), 'min': np.float32(-0.984041), 'max': np.float32(-0.984041)}
2025-06-02 12:05:02,488 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(-0.17794402), 'std': np.float32(1.4901161e-08), 'min': np.float32(-0.177944), 'max': np.float32(-0.177944)}
2025-06-02 12:05:02,488 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,488 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,488 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,489 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,489 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.5714286), 'std': np.float32(0.49487165), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,489 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 2, 'mean': np.float32(0.85714287), 'std': np.float32(0.3499271), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,489 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(-0.99656594), 'std': np.float32(5.9604645e-08), 'min': np.float32(-0.996566), 'max': np.float32(-0.996566)}
2025-06-02 12:05:02,489 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0828082), 'std': np.float32(0.0), 'min': np.float32(0.0828082), 'max': np.float32(0.0828082)}
2025-06-02 12:05:02,489 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 2, 'mean': np.float32(2.857143), 'std': np.float32(0.98974335), 'min': np.float32(2.0), 'max': np.float32(4.0)}
2025-06-02 12:05:02,489 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 1, 'mean': np.float32(3.0), 'std': np.float32(0.0), 'min': np.float32(3.0), 'max': np.float32(3.0)}
2025-06-02 12:05:02,489 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 2, 'mean': np.float32(0.14285715), 'std': np.float32(0.3499271), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,489 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 2, 'mean': np.float32(4.428571), 'std': np.float32(0.49487165), 'min': np.float32(4.0), 'max': np.float32(5.0)}
2025-06-02 12:05:02,490 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 2, 'mean': np.float32(0.14285715), 'std': np.float32(0.3499271), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,490 - INFO - - service_1: {'name': 'service_1', 'unique': 3, 'mean': np.float32(1.2857143), 'std': np.float32(1.1605769), 'min': np.float32(0.0), 'max': np.float32(3.0)}
2025-06-02 12:05:02,490 - INFO - - service_2: {'name': 'service_2', 'unique': 2, 'mean': np.float32(7.285714), 'std': np.float32(1.7496356), 'min': np.float32(3.0), 'max': np.float32(8.0)}
2025-06-02 12:05:02,490 - INFO - - service_3: {'name': 'service_3', 'unique': 2, 'mean': np.float32(7.142857), 'std': np.float32(2.0995626), 'min': np.float32(2.0), 'max': np.float32(8.0)}
2025-06-02 12:05:02,490 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 2, 'mean': np.float32(0.14285715), 'std': np.float32(0.3499271), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,490 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 12:05:02,490 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,490 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,490 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,490 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,491 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,491 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:02,491 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 2, 'mean': np.float32(0.5714286), 'std': np.float32(0.49487165), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,491 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 2, 'mean': np.float32(0.5714286), 'std': np.float32(0.49487165), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:02,531 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7b6615a92f90>
2025-06-02 12:05:02,745 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 12:05:02,854 - DEBUG - Plotted ranges of node feature values.
2025-06-02 12:05:02,906 - DEBUG - Plotted sparsity of node features.
2025-06-02 12:05:04,448 - INFO - Node feature visualization saved to vis/node_features_20250602_120503.png
2025-06-02 12:05:04,449 - INFO - Finished visualization of node features.
2025-06-02 12:05:04,449 - INFO - Performing additional feature analysis:
2025-06-02 12:05:04,449 - INFO - - Maximum correlation between different features: nan
2025-06-02 12:05:04,449 - INFO - Starting visualization of edge features.
2025-06-02 12:05:04,449 - INFO - Graph has 9 edges and 7 edge features.
2025-06-02 12:05:04,449 - INFO - Edge feature names: conn_state_partial_other_unknown, conn_state_rejected_reset, conn_state_successful, protocol_ICMP, protocol_TCP, protocol_UDP, protocol_UNKNOWN
2025-06-02 12:05:04,449 - INFO - Calculating edge feature statistics:
2025-06-02 12:05:04,449 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 12:05:04,449 - INFO - - conn_state_partial_other_unknown: {'name': 'conn_state_partial_other_unknown', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:04,449 - INFO - - conn_state_rejected_reset: {'name': 'conn_state_rejected_reset', 'unique': 2, 'mean': np.float32(0.44444445), 'std': np.float32(0.49690402), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - conn_state_successful: {'name': 'conn_state_successful', 'unique': 2, 'mean': np.float32(0.5555556), 'std': np.float32(0.496904), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_ICMP: {'name': 'protocol_ICMP', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_TCP: {'name': 'protocol_TCP', 'unique': 2, 'mean': np.float32(0.7777778), 'std': np.float32(0.4157397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - conn_state_successful: {'name': 'conn_state_successful', 'unique': 2, 'mean': np.float32(0.5555556), 'std': np.float32(0.496904), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_ICMP: {'name': 'protocol_ICMP', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_TCP: {'name': 'protocol_TCP', 'unique': 2, 'mean': np.float32(0.7777778), 'std': np.float32(0.4157397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_UDP: {'name': 'protocol_UDP', 'unique': 2, 'mean': np.float32(0.22222222), 'std': np.float32(0.4157397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 12:05:04,449 - INFO - - protocol_UNKNOWN: {'name': 'protocol_UNKNOWN', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 12:05:04,460 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7b66110334a0>
2025-06-02 12:05:04,498 - DEBUG - Plotted heatmap of the first 7 edge features.
2025-06-02 12:05:04,510 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7b6610d24a70>
2025-06-02 12:05:04,560 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 12:05:04,683 - DEBUG - Plotted distributions of the top 7 variable edge features.
2025-06-02 12:05:04,775 - DEBUG - Plotted boxplots of the first 4 non-constant edge features.
2025-06-02 12:05:04,795 - DEBUG - Plotted sparsity of edge features.
2025-06-02 12:05:04,806 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 12:05:06,910 - INFO - Edge feature visualization saved to vis/edge_features_20250602_120504.png
2025-06-02 12:05:06,910 - INFO - Finished visualization of edge features.
2025-06-02 12:05:06,910 - INFO - Performing additional edge feature analysis:
2025-06-02 12:05:06,910 - INFO - - 3 out of 7 edge features are constant.
2025-06-02 12:05:06,911 - INFO - - Highest correlation (1.00) between features: 'conn_state_rejected_reset' and 'conn_state_successful'.
2025-06-02 12:05:06,911 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 12:05:06,911 - INFO - Graph has 9 edges and 7 edge features.
2025-06-02 12:05:06,911 - INFO - Edge feature names: conn_state_partial_other_unknown, conn_state_rejected_reset, conn_state_successful, protocol_ICMP, protocol_TCP, protocol_UDP, protocol_UNKNOWN
