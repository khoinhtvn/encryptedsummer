2025-06-03 11:14:15,989 - INFO - Application logging to file: logs/app_20250603_111415.log
2025-06-03 11:14:15,989 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 11:14:15,990 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-03 11:14:15,990 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-03 11:14:15,990 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 11:14:15,990 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot file.
2025-06-03 11:14:15,991 - INFO - Parsed 89 nodes.
2025-06-03 11:14:15,993 - INFO - Parsed 133 edges.
2025-06-03 11:14:15,997 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:15,997 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:15,999 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-03 11:14:16,000 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:16,000 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-03 11:14:16,000 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-03 11:14:16,000 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:16,001 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:16,001 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 11:14:16,002 - DEBUG - Shape of encoded categorical edge features: torch.Size([133, 2])
2025-06-03 11:14:16,002 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:16,002 - DEBUG - Shape of scaled numerical edge features: torch.Size([133, 20])
2025-06-03 11:14:16,002 - DEBUG - Final edge attributes tensor shape: torch.Size([133, 22])
2025-06-03 11:14:16,002 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:16,002 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 11:14:16,002 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-03 11:14:16,040 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-03 11:14:16,042 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-03 11:14:16,043 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 11:14:16,043 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-03 11:14:16,044 - INFO - Replay buffer initialized with maxlen=2000, batch_size=64
2025-06-03 11:14:16,044 - INFO - RunningStats initialized.
2025-06-03 11:14:16,044 - INFO - RunningStats initialized.
2025-06-03 11:14:16,044 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 11:14:16,044 - INFO - Using device: cpu
2025-06-03 11:14:16,044 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=22)
2025-06-03 11:14:16,044 - INFO - Performing initial training for 100 epochs...
2025-06-03 11:14:16,053 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,054 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,160 - INFO - Epoch 1/100, Loss: 17.4327
2025-06-03 11:14:16,164 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,165 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,165 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,272 - INFO - Epoch 2/100, Loss: 15.4359
2025-06-03 11:14:16,287 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,288 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,341 - INFO - Epoch 3/100, Loss: 13.4265
2025-06-03 11:14:16,347 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,347 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,353 - INFO - Epoch 4/100, Loss: 12.1599
2025-06-03 11:14:16,358 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,358 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,358 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,366 - INFO - Epoch 5/100, Loss: 11.7562
2025-06-03 11:14:16,370 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,371 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,377 - INFO - Epoch 6/100, Loss: 11.4681
2025-06-03 11:14:16,382 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,383 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,388 - INFO - Epoch 7/100, Loss: 11.7172
2025-06-03 11:14:16,393 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,393 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,393 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,400 - INFO - Epoch 8/100, Loss: 9.8114
2025-06-03 11:14:16,404 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,405 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,405 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,411 - INFO - Epoch 9/100, Loss: 9.3871
2025-06-03 11:14:16,416 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,416 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,422 - INFO - Epoch 10/100, Loss: 11.8146
2025-06-03 11:14:16,426 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,427 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,432 - INFO - Epoch 11/100, Loss: 8.3209
2025-06-03 11:14:16,436 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,437 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,443 - INFO - Epoch 12/100, Loss: 7.0615
2025-06-03 11:14:16,448 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,448 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,448 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,453 - INFO - Epoch 13/100, Loss: 7.1494
2025-06-03 11:14:16,458 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,458 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,464 - INFO - Epoch 14/100, Loss: 6.6263
2025-06-03 11:14:16,469 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,470 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,475 - INFO - Epoch 15/100, Loss: 7.4645
2025-06-03 11:14:16,484 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,488 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,578 - INFO - Epoch 16/100, Loss: 7.4871
2025-06-03 11:14:16,588 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,588 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,599 - INFO - Epoch 17/100, Loss: 6.6123
2025-06-03 11:14:16,604 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,605 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,612 - INFO - Epoch 18/100, Loss: 5.4607
2025-06-03 11:14:16,616 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,617 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,623 - INFO - Epoch 19/100, Loss: 6.0094
2025-06-03 11:14:16,627 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,628 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,634 - INFO - Epoch 20/100, Loss: 5.4436
2025-06-03 11:14:16,638 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,639 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,644 - INFO - Epoch 21/100, Loss: 6.2917
2025-06-03 11:14:16,649 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,649 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,655 - INFO - Epoch 22/100, Loss: 5.5126
2025-06-03 11:14:16,659 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,659 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,665 - INFO - Epoch 23/100, Loss: 4.4437
2025-06-03 11:14:16,669 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,669 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,670 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,675 - INFO - Epoch 24/100, Loss: 5.6532
2025-06-03 11:14:16,681 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,681 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,809 - INFO - Epoch 25/100, Loss: 5.4854
2025-06-03 11:14:16,815 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,815 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,816 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,822 - INFO - Epoch 26/100, Loss: 5.2062
2025-06-03 11:14:16,827 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,827 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,835 - INFO - Epoch 27/100, Loss: 5.3500
2025-06-03 11:14:16,840 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,840 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,841 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,848 - INFO - Epoch 28/100, Loss: 4.5649
2025-06-03 11:14:16,852 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,853 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,859 - INFO - Epoch 29/100, Loss: 5.1536
2025-06-03 11:14:16,864 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,864 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,865 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,871 - INFO - Epoch 30/100, Loss: 3.9458
2025-06-03 11:14:16,875 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,876 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:16,915 - INFO - Epoch 31/100, Loss: 4.3630
2025-06-03 11:14:16,990 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:16,991 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:16,992 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,031 - INFO - Epoch 32/100, Loss: 3.9164
2025-06-03 11:14:17,036 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,036 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,042 - INFO - Epoch 33/100, Loss: 4.4981
2025-06-03 11:14:17,048 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,048 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,055 - INFO - Epoch 34/100, Loss: 4.1302
2025-06-03 11:14:17,060 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,060 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,067 - INFO - Epoch 35/100, Loss: 3.6379
2025-06-03 11:14:17,072 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,072 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,084 - INFO - Epoch 36/100, Loss: 3.4646
2025-06-03 11:14:17,092 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,093 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,101 - INFO - Epoch 37/100, Loss: 4.0708
2025-06-03 11:14:17,106 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,108 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,260 - INFO - Epoch 38/100, Loss: 4.5582
2025-06-03 11:14:17,265 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,266 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,272 - INFO - Epoch 39/100, Loss: 3.7120
2025-06-03 11:14:17,278 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,278 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,285 - INFO - Epoch 40/100, Loss: 3.4689
2025-06-03 11:14:17,290 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,290 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,329 - INFO - Epoch 41/100, Loss: 4.1384
2025-06-03 11:14:17,334 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,335 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,343 - INFO - Epoch 42/100, Loss: 3.8184
2025-06-03 11:14:17,352 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,353 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,361 - INFO - Epoch 43/100, Loss: 4.3182
2025-06-03 11:14:17,366 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,367 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,367 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,372 - INFO - Epoch 44/100, Loss: 3.6288
2025-06-03 11:14:17,378 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,378 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,379 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,385 - INFO - Epoch 45/100, Loss: 3.4053
2025-06-03 11:14:17,391 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,391 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,391 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,399 - INFO - Epoch 46/100, Loss: 3.3066
2025-06-03 11:14:17,404 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,404 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,404 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,440 - INFO - Epoch 47/100, Loss: 2.9458
2025-06-03 11:14:17,445 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,446 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,451 - INFO - Epoch 48/100, Loss: 3.6849
2025-06-03 11:14:17,457 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,457 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,466 - INFO - Epoch 49/100, Loss: 3.8165
2025-06-03 11:14:17,474 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,474 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,574 - INFO - Epoch 50/100, Loss: 3.3714
2025-06-03 11:14:17,582 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,582 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,591 - INFO - Epoch 51/100, Loss: 3.2526
2025-06-03 11:14:17,597 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,597 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,604 - INFO - Epoch 52/100, Loss: 3.5648
2025-06-03 11:14:17,609 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,610 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,616 - INFO - Epoch 53/100, Loss: 4.2779
2025-06-03 11:14:17,621 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,621 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,621 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,628 - INFO - Epoch 54/100, Loss: 3.9191
2025-06-03 11:14:17,633 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,634 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,640 - INFO - Epoch 55/100, Loss: 3.4420
2025-06-03 11:14:17,647 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,648 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,655 - INFO - Epoch 56/100, Loss: 3.5585
2025-06-03 11:14:17,660 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,660 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,789 - INFO - Epoch 57/100, Loss: 3.5258
2025-06-03 11:14:17,796 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,797 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,797 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,803 - INFO - Epoch 58/100, Loss: 3.2852
2025-06-03 11:14:17,808 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,808 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,815 - INFO - Epoch 59/100, Loss: 2.9903
2025-06-03 11:14:17,820 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,820 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,826 - INFO - Epoch 60/100, Loss: 3.8584
2025-06-03 11:14:17,831 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,832 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,838 - INFO - Epoch 61/100, Loss: 3.6444
2025-06-03 11:14:17,842 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,842 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,843 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,848 - INFO - Epoch 62/100, Loss: 3.3255
2025-06-03 11:14:17,853 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,853 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,853 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,859 - INFO - Epoch 63/100, Loss: 2.8830
2025-06-03 11:14:17,863 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,863 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,869 - INFO - Epoch 64/100, Loss: 2.8963
2025-06-03 11:14:17,873 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,874 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,874 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,879 - INFO - Epoch 65/100, Loss: 4.3614
2025-06-03 11:14:17,884 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,884 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,890 - INFO - Epoch 66/100, Loss: 2.8820
2025-06-03 11:14:17,894 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,895 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,900 - INFO - Epoch 67/100, Loss: 3.7914
2025-06-03 11:14:17,905 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,905 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,911 - INFO - Epoch 68/100, Loss: 2.7606
2025-06-03 11:14:17,915 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,915 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,921 - INFO - Epoch 69/100, Loss: 2.8344
2025-06-03 11:14:17,925 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,926 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,926 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,931 - INFO - Epoch 70/100, Loss: 3.3556
2025-06-03 11:14:17,935 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,936 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,936 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,942 - INFO - Epoch 71/100, Loss: 2.6865
2025-06-03 11:14:17,946 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,947 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,952 - INFO - Epoch 72/100, Loss: 2.7849
2025-06-03 11:14:17,956 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,957 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,962 - INFO - Epoch 73/100, Loss: 3.2366
2025-06-03 11:14:17,967 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,967 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,973 - INFO - Epoch 74/100, Loss: 2.5546
2025-06-03 11:14:17,977 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,978 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,983 - INFO - Epoch 75/100, Loss: 3.1870
2025-06-03 11:14:17,988 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:17,988 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:17,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:17,994 - INFO - Epoch 76/100, Loss: 2.9455
2025-06-03 11:14:18,002 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,003 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,119 - INFO - Epoch 77/100, Loss: 2.4037
2025-06-03 11:14:18,123 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,124 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,124 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,131 - INFO - Epoch 78/100, Loss: 2.9197
2025-06-03 11:14:18,136 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,136 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,143 - INFO - Epoch 79/100, Loss: 2.6795
2025-06-03 11:14:18,148 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,148 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,155 - INFO - Epoch 80/100, Loss: 2.7688
2025-06-03 11:14:18,160 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,160 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,167 - INFO - Epoch 81/100, Loss: 3.0710
2025-06-03 11:14:18,171 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,172 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,172 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,179 - INFO - Epoch 82/100, Loss: 3.3452
2025-06-03 11:14:18,186 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,186 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,193 - INFO - Epoch 83/100, Loss: 2.4988
2025-06-03 11:14:18,197 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,198 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,204 - INFO - Epoch 84/100, Loss: 2.4924
2025-06-03 11:14:18,209 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,210 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,257 - INFO - Epoch 85/100, Loss: 2.5197
2025-06-03 11:14:18,274 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,278 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,336 - INFO - Epoch 86/100, Loss: 2.4894
2025-06-03 11:14:18,346 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,346 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,347 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,361 - INFO - Epoch 87/100, Loss: 2.5708
2025-06-03 11:14:18,369 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,370 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,381 - INFO - Epoch 88/100, Loss: 2.4949
2025-06-03 11:14:18,388 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,389 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,400 - INFO - Epoch 89/100, Loss: 3.0143
2025-06-03 11:14:18,407 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,408 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,409 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,440 - INFO - Epoch 90/100, Loss: 3.1471
2025-06-03 11:14:18,457 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,459 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,526 - INFO - Epoch 91/100, Loss: 2.5858
2025-06-03 11:14:18,535 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,535 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,548 - INFO - Epoch 92/100, Loss: 3.0135
2025-06-03 11:14:18,556 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,557 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,569 - INFO - Epoch 93/100, Loss: 2.3624
2025-06-03 11:14:18,577 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,578 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,585 - INFO - Epoch 94/100, Loss: 2.9854
2025-06-03 11:14:18,589 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,589 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,595 - INFO - Epoch 95/100, Loss: 2.5013
2025-06-03 11:14:18,599 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,599 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,607 - INFO - Epoch 96/100, Loss: 2.5633
2025-06-03 11:14:18,615 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,616 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,628 - INFO - Epoch 97/100, Loss: 2.4054
2025-06-03 11:14:18,636 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,637 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,652 - INFO - Epoch 98/100, Loss: 3.0658
2025-06-03 11:14:18,668 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,668 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,766 - INFO - Epoch 99/100, Loss: 3.2621
2025-06-03 11:14:18,774 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 11:14:18,775 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 11:14:18,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 11:14:18,787 - INFO - Epoch 100/100, Loss: 2.2683
2025-06-03 11:14:18,787 - INFO - Initial training complete.
2025-06-03 11:14:18,806 - ERROR - Error loading checkpoint from model_checkpoints/latest_checkpoint.pth: Error(s) in loading state_dict for HybridGNNAnomalyDetector:
	Missing key(s) in state_dict: "autoencoder.batch_norms.0.module.weight", "autoencoder.batch_norms.0.module.bias", "autoencoder.batch_norms.0.module.running_mean", "autoencoder.batch_norms.0.module.running_var", "autoencoder.batch_norms.1.module.weight", "autoencoder.batch_norms.1.module.bias", "autoencoder.batch_norms.1.module.running_mean", "autoencoder.batch_norms.1.module.running_var", "autoencoder.node_decoder.2.running_mean", "autoencoder.node_decoder.2.running_var", "autoencoder.node_decoder.4.weight", "autoencoder.node_decoder.4.bias", "autoencoder.node_decoder.6.weight", "autoencoder.node_decoder.6.bias", "autoencoder.edge_decoder.2.running_mean", "autoencoder.edge_decoder.2.running_var", "autoencoder.edge_decoder.4.weight", "autoencoder.edge_decoder.4.bias", "autoencoder.edge_decoder.6.weight", "autoencoder.edge_decoder.6.bias", "node_anomaly_mlp.2.running_mean", "node_anomaly_mlp.2.running_var", "node_anomaly_mlp.4.weight", "node_anomaly_mlp.4.bias", "node_anomaly_mlp.6.weight", "node_anomaly_mlp.6.bias", "edge_anomaly_mlp.2.running_mean", "edge_anomaly_mlp.2.running_var", "edge_anomaly_mlp.4.weight", "edge_anomaly_mlp.4.bias", "edge_anomaly_mlp.6.weight", "edge_anomaly_mlp.6.bias", "global_anomaly_mlp.4.weight", "global_anomaly_mlp.4.bias", "global_anomaly_mlp.6.weight", "global_anomaly_mlp.6.bias". 
	size mismatch for autoencoder.gat_layers.0.lin_edge.weight: copying a param with shape torch.Size([512, 10]) from checkpoint, the shape in current model is torch.Size([512, 22]).
	size mismatch for autoencoder.gat_layers.1.lin_edge.weight: copying a param with shape torch.Size([512, 10]) from checkpoint, the shape in current model is torch.Size([512, 22]).
	size mismatch for autoencoder.gat_layers.2.lin_edge.weight: copying a param with shape torch.Size([64, 10]) from checkpoint, the shape in current model is torch.Size([64, 22]).
	size mismatch for autoencoder.node_decoder.0.weight: copying a param with shape torch.Size([128, 64]) from checkpoint, the shape in current model is torch.Size([256, 64]).
	size mismatch for autoencoder.node_decoder.0.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for autoencoder.node_decoder.2.weight: copying a param with shape torch.Size([30, 128]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for autoencoder.node_decoder.2.bias: copying a param with shape torch.Size([30]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for autoencoder.edge_decoder.0.weight: copying a param with shape torch.Size([128, 138]) from checkpoint, the shape in current model is torch.Size([256, 150]).
	size mismatch for autoencoder.edge_decoder.0.bias: copying a param with shape torch.Size([128]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for autoencoder.edge_decoder.2.weight: copying a param with shape torch.Size([1, 128]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for autoencoder.edge_decoder.2.bias: copying a param with shape torch.Size([1]) from checkpoint, the shape in current model is torch.Size([256]).
	size mismatch for node_anomaly_mlp.0.weight: copying a param with shape torch.Size([64, 64]) from checkpoint, the shape in current model is torch.Size([128, 64]).
	size mismatch for node_anomaly_mlp.0.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for node_anomaly_mlp.2.weight: copying a param with shape torch.Size([1, 64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for node_anomaly_mlp.2.bias: copying a param with shape torch.Size([1]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for edge_anomaly_mlp.0.weight: copying a param with shape torch.Size([64, 138]) from checkpoint, the shape in current model is torch.Size([128, 150]).
	size mismatch for edge_anomaly_mlp.0.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for edge_anomaly_mlp.2.weight: copying a param with shape torch.Size([1, 64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for edge_anomaly_mlp.2.bias: copying a param with shape torch.Size([1]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for global_anomaly_mlp.0.weight: copying a param with shape torch.Size([64, 64]) from checkpoint, the shape in current model is torch.Size([128, 64]).
	size mismatch for global_anomaly_mlp.0.bias: copying a param with shape torch.Size([64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for global_anomaly_mlp.2.weight: copying a param with shape torch.Size([1, 64]) from checkpoint, the shape in current model is torch.Size([128]).
	size mismatch for global_anomaly_mlp.2.bias: copying a param with shape torch.Size([1]) from checkpoint, the shape in current model is torch.Size([128]).
2025-06-03 11:14:18,806 - INFO - Starting or resuming online updates from step: 0
2025-06-03 11:14:18,806 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-03 11:14:18,806 - INFO - Running anomaly detection...
2025-06-03 11:14:18,807 - INFO - Starting anomaly detection.
2025-06-03 11:14:18,817 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111418_update_1.json
2025-06-03 11:14:18,817 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:18,829 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111418_update_1.pth and as latest_checkpoint.pth
2025-06-03 11:14:18,829 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.2522
2025-06-03 11:14:18,829 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-03 11:14:18,829 - WARNING -   Node ID: 162.159.61.3, Recon Error: 161.8831, MLP Score: 0.0000
2025-06-03 11:14:18,829 - WARNING -   Node ID: 192.168.27.10, Recon Error: 160.3587, MLP Score: 0.0000
2025-06-03 11:14:18,830 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-03 11:14:18,830 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.6501, MLP Score: 1.0000
2025-06-03 11:14:18,830 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 3.4893, MLP Score: 1.0000
2025-06-03 11:14:18,830 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.0219, MLP Score: 0.9865
2025-06-03 11:14:18,830 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:18,830 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:18,830 - INFO - Starting visualization of node features.
2025-06-03 11:14:18,830 - INFO - Graph has 89 nodes and 30 features.
2025-06-03 11:14:18,830 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:18,830 - INFO - Calculating feature statistics:
2025-06-03 11:14:18,830 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-3.0974324e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.24637975), 'max': np.float32(4.0978065)}
2025-06-03 11:14:18,830 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(3.0974324e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.0978065), 'max': np.float32(0.24637975)}
2025-06-03 11:14:18,830 - INFO - - server_score: {'name': 'server_score', 'unique': 7, 'mean': np.float32(-4.0182908e-08), 'std': np.float32(1.0), 'min': np.float32(-2.074784), 'max': np.float32(5.473159)}
2025-06-03 11:14:18,830 - INFO - - client_score: {'name': 'client_score', 'unique': 7, 'mean': np.float32(2.6788605e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.22028041), 'max': np.float32(5.79706)}
2025-06-03 11:14:18,830 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(-7.0320088e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3142697), 'max': np.float32(3.1819806)}
2025-06-03 11:14:18,830 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 8, 'mean': np.float32(-2.0091454e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29732358), 'max': np.float32(4.185126)}
2025-06-03 11:14:18,831 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-5.221124), 'max': np.float32(0.2736628)}
2025-06-03 11:14:18,831 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(2.059374e-08), 'std': np.float32(1.0), 'min': np.float32(-0.23076923), 'max': np.float32(5.7596154)}
2025-06-03 11:14:18,831 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.0113316), 'max': np.float32(8.045326)}
2025-06-03 11:14:18,831 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 6, 'mean': np.float32(-1.0045726e-09), 'std': np.float32(1.0), 'min': np.float32(-0.21546301), 'max': np.float32(5.572582)}
2025-06-03 11:14:18,831 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 6, 'mean': np.float32(3.7504048e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6095707), 'max': np.float32(0.5887556)}
2025-06-03 11:14:18,831 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(-9.376012e-09), 'std': np.float32(1.0), 'min': np.float32(-0.26886642), 'max': np.float32(3.719319)}
2025-06-03 11:14:18,831 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(1.4566304e-08), 'std': np.float32(1.0), 'min': np.float32(-4.09878), 'max': np.float32(0.24397503)}
2025-06-03 11:14:18,831 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(-1.3645446e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.5060302), 'max': np.float32(1.3409579)}
2025-06-03 11:14:18,831 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(-1.6240591e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3339475), 'max': np.float32(1.5135604)}
2025-06-03 11:14:18,831 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(3.6499472e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0945183), 'max': np.float32(1.7363071)}
2025-06-03 11:14:18,831 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(3.4825185e-08), 'std': np.float32(1.0), 'min': np.float32(-1.727558), 'max': np.float32(1.0981954)}
2025-06-03 11:14:18,831 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,831 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,831 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 8, 'mean': np.float32(2.6788605e-09), 'std': np.float32(1.0), 'min': np.float32(-3.920728), 'max': np.float32(0.30587068)}
2025-06-03 11:14:18,831 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,831 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,831 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 8, 'mean': np.float32(-1.6073162e-08), 'std': np.float32(1.0), 'min': np.float32(-2.183282), 'max': np.float32(2.0620248)}
2025-06-03 11:14:18,832 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,832 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:18,836 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-03 11:14:18,855 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a765986f0e0>
2025-06-03 11:14:19,020 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:19,074 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:19,102 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:20,306 - INFO - Node feature visualization saved to vis/node_features_20250603_111419.png
2025-06-03 11:14:20,307 - INFO - Finished visualization of node features.
2025-06-03 11:14:20,307 - INFO - Performing additional feature analysis:
2025-06-03 11:14:20,307 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:20,307 - INFO - Starting visualization of edge features.
2025-06-03 11:14:20,307 - INFO - Graph has 133 edges and 22 edge features.
2025-06-03 11:14:20,307 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:20,307 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:20,307 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-03 11:14:20,307 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 11:14:20,307 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot file.
2025-06-03 11:14:20,312 - INFO - Parsed 129 nodes.
2025-06-03 11:14:20,314 - INFO - Parsed 186 edges.
2025-06-03 11:14:20,321 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:20,321 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:20,323 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-03 11:14:20,324 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:20,324 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-03 11:14:20,324 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-03 11:14:20,325 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:20,326 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:20,326 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 11:14:20,326 - DEBUG - Shape of encoded categorical edge features: torch.Size([186, 2])
2025-06-03 11:14:20,327 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:20,327 - DEBUG - Shape of scaled numerical edge features: torch.Size([186, 20])
2025-06-03 11:14:20,327 - DEBUG - Final edge attributes tensor shape: torch.Size([186, 22])
2025-06-03 11:14:20,327 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:20,327 - INFO - Performing online update...
2025-06-03 11:14:20,327 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:20,327 - DEBUG - Updated RunningStats: new_mean=0.9386949589477228, new_var=30600000000026.695, new_n=3090
2025-06-03 11:14:20,327 - DEBUG - Updated RunningStats: new_mean=0.9357825311851267, new_var=30900000000009.746, new_n=3120
2025-06-03 11:14:20,328 - DEBUG - Updated RunningStats: new_mean=1.2197571340464683, new_var=10200000000035.291, new_n=1042
2025-06-03 11:14:20,328 - DEBUG - Updated RunningStats: new_mean=1.2156968496553304, new_var=10420000000002.178, new_n=1064
2025-06-03 11:14:20,328 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:20,328 - DEBUG - Online update step: 1/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 2/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 3/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 4/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 5/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 6/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 7/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 8/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 9/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 10/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 11/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 12/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 13/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 14/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 15/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 16/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 17/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 18/50
2025-06-03 11:14:20,328 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,328 - DEBUG - Online update step: 19/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 20/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 21/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 22/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 23/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 24/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 25/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 26/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 27/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 28/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 29/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 30/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 31/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 32/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 33/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 34/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 35/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 36/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 37/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 38/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 39/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 40/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 41/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 42/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 43/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 44/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,329 - DEBUG - Online update step: 45/50
2025-06-03 11:14:20,329 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - DEBUG - Online update step: 46/50
2025-06-03 11:14:20,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - DEBUG - Online update step: 47/50
2025-06-03 11:14:20,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - DEBUG - Online update step: 48/50
2025-06-03 11:14:20,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - DEBUG - Online update step: 49/50
2025-06-03 11:14:20,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - DEBUG - Online update step: 50/50
2025-06-03 11:14:20,330 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,330 - WARNING - No successful steps during online update.
2025-06-03 11:14:20,330 - DEBUG - Current node mean: [-2.0330267e-08  2.0330267e-08 -2.2178472e-08 -2.0330267e-08
 -2.2178472e-08 -1.1089236e-08 -3.3267710e-08  1.8482060e-08
  3.6964121e-09 -1.2937442e-08 -1.1089236e-08  1.8482060e-08
 -3.3729759e-08 -1.1089236e-08 -1.1089236e-08 -1.1089236e-08
 -2.5874884e-08  0.0000000e+00  0.0000000e+00  2.7723090e-09
  0.0000000e+00  0.0000000e+00 -1.1551288e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.23655915e+00  3.46774197e+00 -2.56364063e-09  0.00000000e+00
  5.12728127e-09  7.69092168e-09  2.56364063e-09 -1.79454851e-08
 -1.53818434e-08  3.20455085e-09  6.40910169e-09  3.84546084e-09
  1.02545625e-08 -2.56364068e-08  1.02545625e-08 -2.56364063e-09
 -2.56364063e-09 -2.56364063e-09 -2.56364063e-09 -2.56364063e-09
 -2.56364063e-09  7.69092168e-09]
2025-06-03 11:14:20,330 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:20,330 - INFO - Running anomaly detection...
2025-06-03 11:14:20,330 - INFO - Starting anomaly detection.
2025-06-03 11:14:20,338 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111420_update_2.json
2025-06-03 11:14:20,338 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:20,344 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111420_update_2.pth and as latest_checkpoint.pth
2025-06-03 11:14:20,344 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.2989
2025-06-03 11:14:20,344 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-03 11:14:20,344 - WARNING -   Node ID: 8.8.8.8, Recon Error: 244.4900, MLP Score: 0.0000
2025-06-03 11:14:20,344 - WARNING -   Node ID: 192.168.27.10, Recon Error: 249.6964, MLP Score: 0.0000
2025-06-03 11:14:20,344 - WARNING -   Node ID: 162.159.61.3, Recon Error: 248.2969, MLP Score: 0.0000
2025-06-03 11:14:20,344 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 11:14:20,344 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 3.6338, MLP Score: 1.0000
2025-06-03 11:14:20,344 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.5944, MLP Score: 1.0000
2025-06-03 11:14:20,344 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.0947, MLP Score: 0.9989
2025-06-03 11:14:20,345 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3433, MLP Score: 1.0000
2025-06-03 11:14:20,345 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-03 11:14:20,345 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-03 11:14:20,345 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot file.
2025-06-03 11:14:20,349 - INFO - Parsed 177 nodes.
2025-06-03 11:14:20,352 - INFO - Parsed 256 edges.
2025-06-03 11:14:20,366 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:20,366 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:20,369 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-03 11:14:20,370 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:20,370 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-03 11:14:20,370 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-03 11:14:20,370 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:20,372 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:20,372 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:20,372 - DEBUG - Shape of encoded categorical edge features: torch.Size([256, 2])
2025-06-03 11:14:20,373 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:20,373 - DEBUG - Shape of scaled numerical edge features: torch.Size([256, 20])
2025-06-03 11:14:20,373 - DEBUG - Final edge attributes tensor shape: torch.Size([256, 22])
2025-06-03 11:14:20,373 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:20,373 - INFO - Performing online update...
2025-06-03 11:14:20,373 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:20,373 - DEBUG - Updated RunningStats: new_mean=0.9268703165917207, new_var=31200000000026.02, new_n=3150
2025-06-03 11:14:20,373 - DEBUG - Updated RunningStats: new_mean=0.924118049717553, new_var=31500000000009.535, new_n=3180
2025-06-03 11:14:20,374 - DEBUG - Updated RunningStats: new_mean=1.1962202560686446, new_var=10640000000038.98, new_n=1086
2025-06-03 11:14:20,374 - DEBUG - Updated RunningStats: new_mean=1.1930950475743913, new_var=10860000000002.713, new_n=1108
2025-06-03 11:14:20,374 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:20,374 - DEBUG - Online update step: 1/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 2/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 3/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 4/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 5/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 6/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 7/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 8/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 9/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 10/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 11/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 12/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 13/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 14/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 15/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 16/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 17/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,374 - DEBUG - Online update step: 18/50
2025-06-03 11:14:20,374 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 19/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 20/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 21/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 22/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 23/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 24/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 25/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 26/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 27/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 28/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 29/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 30/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 31/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 32/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 33/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 34/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 35/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 36/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 37/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 38/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 39/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 40/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 41/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 42/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 43/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,375 - DEBUG - Online update step: 44/50
2025-06-03 11:14:20,375 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 45/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 46/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 47/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 48/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 49/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - DEBUG - Online update step: 50/50
2025-06-03 11:14:20,376 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,376 - WARNING - No successful steps during online update.
2025-06-03 11:14:20,376 - DEBUG - Current node mean: [-2.0204965e-08  2.0204965e-08 -3.2327943e-08 -2.0878463e-08
  6.1961892e-08 -3.0980946e-08  2.9633947e-08 -2.1551962e-08
 -2.6939952e-09 -5.3879905e-09  1.3469976e-09  4.1756927e-08
 -8.7554843e-09 -1.3469976e-08 -3.7715932e-08  2.6939952e-09
 -2.6939952e-08  0.0000000e+00  0.0000000e+00  1.3469976e-08
  0.0000000e+00  0.0000000e+00  1.6163971e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.2421875e+00  4.3515625e+00  9.3132257e-09  0.0000000e+00
  0.0000000e+00  3.7252903e-09 -5.5879354e-09  0.0000000e+00
  9.3132257e-09  0.0000000e+00  3.7252903e-09  7.4505806e-09
  0.0000000e+00 -5.5879354e-09  7.4505806e-09  3.7252903e-09
  3.7252903e-09  3.7252903e-09  3.7252903e-09  3.7252903e-09
  3.7252903e-09  5.1222742e-09]
2025-06-03 11:14:20,376 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.4371
2025-06-03 11:14:20,376 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 11:14:20,376 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:20,376 - INFO - Running anomaly detection...
2025-06-03 11:14:20,377 - INFO - Starting anomaly detection.
2025-06-03 11:14:20,382 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111420_update_3.json
2025-06-03 11:14:20,382 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:20,388 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111420_update_3.pth and as latest_checkpoint.pth
2025-06-03 11:14:20,388 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.3537
2025-06-03 11:14:20,388 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-03 11:14:20,388 - WARNING -   Node ID: 192.168.27.10, Recon Error: 288.8123, MLP Score: 0.0000
2025-06-03 11:14:20,388 - WARNING -   Node ID: 162.159.61.3, Recon Error: 284.2096, MLP Score: 0.0000
2025-06-03 11:14:20,388 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-03 11:14:20,388 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.0582, MLP Score: 1.0000
2025-06-03 11:14:20,388 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.9244, MLP Score: 1.0000
2025-06-03 11:14:20,388 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.2545, MLP Score: 1.0000
2025-06-03 11:14:20,389 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.2913, MLP Score: 1.0000
2025-06-03 11:14:20,389 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.6103, MLP Score: 1.0000
2025-06-03 11:14:20,389 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-03 11:14:20,389 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-03 11:14:20,389 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot file.
2025-06-03 11:14:20,394 - INFO - Parsed 256 nodes.
2025-06-03 11:14:20,398 - INFO - Parsed 395 edges.
2025-06-03 11:14:20,427 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:20,427 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:20,432 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-03 11:14:20,433 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:20,433 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-03 11:14:20,433 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-03 11:14:20,433 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:20,435 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:20,436 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:20,436 - DEBUG - Shape of encoded categorical edge features: torch.Size([395, 2])
2025-06-03 11:14:20,437 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:20,437 - DEBUG - Shape of scaled numerical edge features: torch.Size([395, 20])
2025-06-03 11:14:20,437 - DEBUG - Final edge attributes tensor shape: torch.Size([395, 22])
2025-06-03 11:14:20,437 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:20,437 - INFO - Performing online update...
2025-06-03 11:14:20,437 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:20,437 - DEBUG - Updated RunningStats: new_mean=0.9154814324177072, new_var=31800000000025.38, new_n=3210
2025-06-03 11:14:20,437 - DEBUG - Updated RunningStats: new_mean=0.9128804371583736, new_var=32100000000009.336, new_n=3240
2025-06-03 11:14:20,437 - DEBUG - Updated RunningStats: new_mean=1.1750800461103852, new_var=11080000000039.488, new_n=1130
2025-06-03 11:14:20,438 - DEBUG - Updated RunningStats: new_mean=1.1723444726214018, new_var=11300000000002.137, new_n=1152
2025-06-03 11:14:20,438 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:20,438 - DEBUG - Online update step: 1/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 2/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 3/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 4/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 5/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 6/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 7/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 8/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 9/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 10/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 11/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 12/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 13/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 14/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 15/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 16/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 17/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 18/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 19/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 20/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 21/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,438 - DEBUG - Online update step: 22/50
2025-06-03 11:14:20,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 23/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 24/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 25/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 26/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 27/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 28/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 29/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 30/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 31/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 32/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 33/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 34/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 35/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 36/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 37/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 38/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 39/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 40/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 41/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 42/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 43/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 44/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 45/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 46/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 47/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 48/50
2025-06-03 11:14:20,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,439 - DEBUG - Online update step: 49/50
2025-06-03 11:14:20,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,440 - DEBUG - Online update step: 50/50
2025-06-03 11:14:20,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,440 - WARNING - No successful steps during online update.
2025-06-03 11:14:20,440 - DEBUG - Current node mean: [ 1.8626451e-08 -1.8626451e-08  5.2154064e-08  3.9115548e-08
 -1.8626451e-08 -3.9115548e-08 -1.8626451e-08  3.5390258e-08
  0.0000000e+00  7.4505806e-09  3.1664968e-08 -1.1175871e-08
 -2.0489097e-08 -9.3132257e-09 -1.6763806e-08 -2.9802322e-08
 -3.3527613e-08  0.0000000e+00  0.0000000e+00 -4.6566129e-09
  0.0000000e+00  0.0000000e+00 -4.6566129e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.3265823e+00  4.5645571e+00  1.2071827e-09 -9.6574615e-09
  3.6215480e-09  4.8287307e-09  7.2430959e-09 -6.6395049e-09
 -3.6215480e-09  0.0000000e+00 -4.8287307e-09 -4.8287307e-09
 -2.4143654e-09  4.8287307e-09  9.6574615e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.8287307e-09]
2025-06-03 11:14:20,440 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.1926
2025-06-03 11:14:20,440 - WARNING - Feature drift detected (2 consecutive)
2025-06-03 11:14:20,440 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:20,440 - INFO - Running anomaly detection...
2025-06-03 11:14:20,441 - INFO - Starting anomaly detection.
2025-06-03 11:14:20,446 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111420_update_4.json
2025-06-03 11:14:20,446 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:20,452 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111420_update_4.pth and as latest_checkpoint.pth
2025-06-03 11:14:20,452 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.3476
2025-06-03 11:14:20,452 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-03 11:14:20,452 - WARNING -   Node ID: 192.168.27.10, Recon Error: 395.4370, MLP Score: 0.0000
2025-06-03 11:14:20,452 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:14:20,452 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.2998, MLP Score: 1.0000
2025-06-03 11:14:20,452 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.8523, MLP Score: 1.0000
2025-06-03 11:14:20,452 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.8719, MLP Score: 1.0000
2025-06-03 11:14:20,452 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.6084, MLP Score: 1.0000
2025-06-03 11:14:20,453 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.2857, MLP Score: 1.0000
2025-06-03 11:14:20,453 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-03 11:14:20,453 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-03 11:14:20,453 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot file.
2025-06-03 11:14:20,459 - INFO - Parsed 300 nodes.
2025-06-03 11:14:20,463 - INFO - Parsed 503 edges.
2025-06-03 11:14:20,652 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:20,652 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:20,658 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-03 11:14:20,659 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:20,659 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-03 11:14:20,660 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-03 11:14:20,660 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:20,662 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:20,663 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:20,663 - DEBUG - Shape of encoded categorical edge features: torch.Size([503, 2])
2025-06-03 11:14:20,664 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:20,664 - DEBUG - Shape of scaled numerical edge features: torch.Size([503, 20])
2025-06-03 11:14:20,664 - DEBUG - Final edge attributes tensor shape: torch.Size([503, 22])
2025-06-03 11:14:20,664 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:20,664 - INFO - Performing online update...
2025-06-03 11:14:20,664 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:20,665 - DEBUG - Updated RunningStats: new_mean=0.9045053872787994, new_var=32400000000024.77, new_n=3270
2025-06-03 11:14:20,665 - DEBUG - Updated RunningStats: new_mean=0.9020498067613086, new_var=32700000000009.156, new_n=3300
2025-06-03 11:14:20,665 - DEBUG - Updated RunningStats: new_mean=1.1554913088716503, new_var=11520000000039.23, new_n=1174
2025-06-03 11:14:20,665 - DEBUG - Updated RunningStats: new_mean=1.1531547308926624, new_var=11740000000001.85, new_n=1196
2025-06-03 11:14:20,665 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:20,665 - DEBUG - Online update step: 1/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 2/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 3/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 4/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 5/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 6/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 7/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,665 - DEBUG - Online update step: 8/50
2025-06-03 11:14:20,665 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 9/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 10/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 11/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 12/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 13/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 14/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 15/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 16/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 17/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 18/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 19/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 20/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 21/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 22/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 23/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 24/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 25/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 26/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 27/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 28/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 29/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 30/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 31/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 32/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 33/50
2025-06-03 11:14:20,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,666 - DEBUG - Online update step: 34/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 35/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 36/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 37/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 38/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 39/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 40/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 41/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 42/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 43/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 44/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 45/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 46/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 47/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 48/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 49/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - DEBUG - Online update step: 50/50
2025-06-03 11:14:20,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,667 - WARNING - No successful steps during online update.
2025-06-03 11:14:20,668 - DEBUG - Current node mean: [-1.9073486e-08  2.2252401e-08 -2.7020773e-08 -2.5431316e-08
  1.8278758e-08  1.5099843e-08 -1.7484028e-08  2.5431316e-08
 -1.5894572e-09  9.5367430e-09  0.0000000e+00  1.2715658e-08
 -2.5431316e-08 -6.3578289e-09 -2.3841858e-08  1.2715658e-08
  2.8610229e-08  0.0000000e+00  0.0000000e+00 -6.3578289e-09
  0.0000000e+00  0.0000000e+00  1.6490619e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.3638171e+00  4.6421471e+00  8.0578841e-09  0.0000000e+00
  3.7919454e-09  7.5838908e-09  9.4798640e-09  4.0289421e-09
  3.7919454e-09 -3.7919454e-09 -1.1375837e-08  1.8959727e-09
  4.7399318e-10 -1.7063755e-08  1.8959728e-08 -5.6879186e-09
 -5.6879186e-09 -5.6879186e-09 -5.6879186e-09 -5.6879186e-09
 -5.6879186e-09  3.7919454e-09]
2025-06-03 11:14:20,668 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0784
2025-06-03 11:14:20,668 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:20,668 - INFO - Running anomaly detection...
2025-06-03 11:14:20,668 - INFO - Starting anomaly detection.
2025-06-03 11:14:20,673 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111420_update_5.json
2025-06-03 11:14:20,674 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:20,680 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111420_update_5.pth and as latest_checkpoint.pth
2025-06-03 11:14:20,680 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.3019
2025-06-03 11:14:20,680 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:20,680 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-03 11:14:20,680 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.9091, MLP Score: 1.0000
2025-06-03 11:14:20,680 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.0601, MLP Score: 1.0000
2025-06-03 11:14:20,680 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.2189, MLP Score: 1.0000
2025-06-03 11:14:20,680 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 2.9327, MLP Score: 1.0000
2025-06-03 11:14:20,680 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7778, MLP Score: 1.0000
2025-06-03 11:14:20,680 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-03 11:14:20,680 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-03 11:14:20,680 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot file.
2025-06-03 11:14:20,691 - INFO - Parsed 366 nodes.
2025-06-03 11:14:20,697 - INFO - Parsed 657 edges.
2025-06-03 11:14:20,768 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:20,768 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:20,775 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-03 11:14:20,776 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:20,776 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-03 11:14:20,777 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-03 11:14:20,777 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:20,780 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:20,780 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:20,781 - DEBUG - Shape of encoded categorical edge features: torch.Size([657, 2])
2025-06-03 11:14:20,782 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:20,782 - DEBUG - Shape of scaled numerical edge features: torch.Size([657, 20])
2025-06-03 11:14:20,782 - DEBUG - Final edge attributes tensor shape: torch.Size([657, 22])
2025-06-03 11:14:20,782 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:20,782 - INFO - Performing online update...
2025-06-03 11:14:20,782 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:20,783 - DEBUG - Updated RunningStats: new_mean=0.893923231934962, new_var=33000000000024.19, new_n=3330
2025-06-03 11:14:20,783 - DEBUG - Updated RunningStats: new_mean=0.8916042772101839, new_var=33300000000008.99, new_n=3360
2025-06-03 11:14:20,783 - DEBUG - Updated RunningStats: new_mean=1.1373720663337905, new_var=11960000000039.395, new_n=1218
2025-06-03 11:14:20,783 - DEBUG - Updated RunningStats: new_mean=1.1353538234639777, new_var=12180000000001.531, new_n=1240
2025-06-03 11:14:20,783 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:20,783 - DEBUG - Online update step: 1/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 2/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 3/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 4/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 5/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 6/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 7/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 8/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 9/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 10/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 11/50
2025-06-03 11:14:20,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,783 - DEBUG - Online update step: 12/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 13/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 14/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 15/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 16/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 17/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 18/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 19/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 20/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 21/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 22/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 23/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 24/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 25/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 26/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 27/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 28/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 29/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 30/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 31/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 32/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 33/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 34/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 35/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,784 - DEBUG - Online update step: 36/50
2025-06-03 11:14:20,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 37/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 38/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 39/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 40/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 41/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 42/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 43/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 44/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 45/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 46/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 47/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 48/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 49/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - DEBUG - Online update step: 50/50
2025-06-03 11:14:20,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:20,785 - WARNING - No successful steps during online update.
2025-06-03 11:14:20,785 - DEBUG - Current node mean: [-1.69368395e-08  1.69368395e-08 -5.21133492e-09 -1.30283375e-08
 -1.04226698e-08 -1.36797542e-08 -2.80109251e-08 -2.60566746e-09
 -2.60566746e-09 -1.17255041e-08  3.38736790e-08  2.14967564e-08
  5.21133492e-09  2.08453397e-08  2.86623436e-08 -4.03878460e-08
  2.27995915e-08  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00  2.58938204e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.3805175e+00  4.7656012e+00  4.3546771e-09 -2.7216732e-10
  2.8123956e-09 -1.6783652e-09  8.7093541e-09  1.4515591e-09
  5.8062364e-09  5.4433467e-09  8.7093541e-09 -5.8062364e-09
 -7.2577953e-09 -1.7237264e-09 -2.9031182e-09 -1.4515591e-09
 -1.4515591e-09 -1.4515591e-09 -1.4515591e-09 -1.4515591e-09
 -1.4515591e-09 -2.9031182e-09]
2025-06-03 11:14:20,786 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0582
2025-06-03 11:14:20,786 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:20,786 - INFO - Running anomaly detection...
2025-06-03 11:14:20,786 - INFO - Starting anomaly detection.
2025-06-03 11:14:20,795 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111420_update_6.json
2025-06-03 11:14:20,795 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:20,806 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111420_update_6.pth and as latest_checkpoint.pth
2025-06-03 11:14:20,807 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.3351
2025-06-03 11:14:20,807 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:20,807 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 11:14:20,807 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.5428, MLP Score: 1.0000
2025-06-03 11:14:20,807 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.8602, MLP Score: 1.0000
2025-06-03 11:14:20,807 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.9523, MLP Score: 1.0000
2025-06-03 11:14:20,807 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.6335, MLP Score: 1.0000
2025-06-03 11:14:20,807 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 4.0618, MLP Score: 1.0000
2025-06-03 11:14:20,807 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:20,807 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:20,807 - INFO - Starting visualization of node features.
2025-06-03 11:14:20,807 - INFO - Graph has 366 nodes and 30 features.
2025-06-03 11:14:20,807 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:20,807 - INFO - Calculating feature statistics:
2025-06-03 11:14:20,808 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-0.15107578), 'max': np.float32(6.6863217)}
2025-06-03 11:14:20,808 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(1.30283375e-08), 'std': np.float32(1.0), 'min': np.float32(-6.6863217), 'max': np.float32(0.15107578)}
2025-06-03 11:14:20,808 - INFO - - server_score: {'name': 'server_score', 'unique': 10, 'mean': np.float32(-1.042267e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4653895), 'max': np.float32(4.9267626)}
2025-06-03 11:14:20,808 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.11681133), 'max': np.float32(11.080514)}
2025-06-03 11:14:20,808 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.567014), 'max': np.float32(3.9940214)}
2025-06-03 11:14:20,808 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 10, 'mean': np.float32(-1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-0.568302), 'max': np.float32(2.0543187)}
2025-06-03 11:14:20,808 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 10, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6313567), 'max': np.float32(0.5527793)}
2025-06-03 11:14:20,808 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(1.042267e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.12357184), 'max': np.float32(10.518145)}
2025-06-03 11:14:20,808 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(-1.3028337e-09), 'std': np.float32(1.0), 'min': np.float32(-3.615443), 'max': np.float32(14.461772)}
2025-06-03 11:14:20,808 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(-1.1725504e-08), 'std': np.float32(1.0), 'min': np.float32(-0.12860057), 'max': np.float32(8.708076)}
2025-06-03 11:14:20,808 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 10, 'mean': np.float32(4.169068e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2291522), 'max': np.float32(0.83115166)}
2025-06-03 11:14:20,808 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 5, 'mean': np.float32(5.211335e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.14717494), 'max': np.float32(7.050298)}
2025-06-03 11:14:20,808 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(1.4331172e-08), 'std': np.float32(0.99999994), 'min': np.float32(-5.8913436), 'max': np.float32(0.17400593)}
2025-06-03 11:14:20,808 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2045138), 'max': np.float32(2.5324697)}
2025-06-03 11:14:20,809 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(-1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5098004), 'max': np.float32(1.2227579)}
2025-06-03 11:14:20,809 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 8, 'mean': np.float32(-2.6056675e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8442478), 'max': np.float32(3.5091558)}
2025-06-03 11:14:20,809 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 8, 'mean': np.float32(1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-3.477314), 'max': np.float32(0.8536967)}
2025-06-03 11:14:20,809 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 9, 'mean': np.float32(1.5634004e-08), 'std': np.float32(1.0), 'min': np.float32(-5.5407624), 'max': np.float32(0.200816)}
2025-06-03 11:14:20,809 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 10, 'mean': np.float32(2.084534e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0776258), 'max': np.float32(3.238297)}
2025-06-03 11:14:20,809 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,809 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:20,819 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a7654182e40>
2025-06-03 11:14:20,948 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:21,004 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:21,029 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:22,193 - INFO - Node feature visualization saved to vis/node_features_20250603_111421.png
2025-06-03 11:14:22,194 - INFO - Finished visualization of node features.
2025-06-03 11:14:22,194 - INFO - Performing additional feature analysis:
2025-06-03 11:14:22,194 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:22,194 - INFO - Starting visualization of edge features.
2025-06-03 11:14:22,194 - INFO - Graph has 657 edges and 22 edge features.
2025-06-03 11:14:22,194 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:22,194 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:22,194 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-03 11:14:22,194 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-03 11:14:22,194 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot file.
2025-06-03 11:14:22,204 - INFO - Parsed 392 nodes.
2025-06-03 11:14:22,211 - INFO - Parsed 753 edges.
2025-06-03 11:14:22,290 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:22,290 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:22,297 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-03 11:14:22,298 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:22,298 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-03 11:14:22,299 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-03 11:14:22,299 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:22,303 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:22,304 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:22,304 - DEBUG - Shape of encoded categorical edge features: torch.Size([753, 2])
2025-06-03 11:14:22,305 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:22,305 - DEBUG - Shape of scaled numerical edge features: torch.Size([753, 20])
2025-06-03 11:14:22,305 - DEBUG - Final edge attributes tensor shape: torch.Size([753, 22])
2025-06-03 11:14:22,305 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:22,305 - INFO - Performing online update...
2025-06-03 11:14:22,306 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:22,306 - DEBUG - Updated RunningStats: new_mean=0.8837139738826261, new_var=33600000000023.637, new_n=3390
2025-06-03 11:14:22,306 - DEBUG - Updated RunningStats: new_mean=0.8815247521543351, new_var=33900000000008.836, new_n=3420
2025-06-03 11:14:22,306 - DEBUG - Updated RunningStats: new_mean=1.1204969578843902, new_var=12400000000039.186, new_n=1262
2025-06-03 11:14:22,306 - DEBUG - Updated RunningStats: new_mean=1.1187820705246367, new_var=12620000000001.328, new_n=1284
2025-06-03 11:14:22,306 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:22,306 - DEBUG - Online update step: 1/50
2025-06-03 11:14:22,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,306 - DEBUG - Online update step: 2/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 3/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 4/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 5/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 6/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 7/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 8/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 9/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 10/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 11/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 12/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 13/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 14/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 15/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 16/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 17/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 18/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 19/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 20/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 21/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 22/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 23/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 24/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 25/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 26/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 27/50
2025-06-03 11:14:22,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,307 - DEBUG - Online update step: 28/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 29/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 30/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 31/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 32/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 33/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 34/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 35/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 36/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 37/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 38/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 39/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 40/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 41/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 42/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 43/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 44/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 45/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 46/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 47/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 48/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 49/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - DEBUG - Online update step: 50/50
2025-06-03 11:14:22,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,308 - WARNING - No successful steps during online update.
2025-06-03 11:14:22,309 - DEBUG - Current node mean: [ 2.4328427e-08 -2.4328427e-08  2.0679163e-08 -4.8656852e-09
  2.9194112e-08  4.8656852e-09 -5.8388224e-08 -1.9462741e-08
  9.7313704e-09  2.0679163e-08  1.2164214e-08  0.0000000e+00
  2.4328427e-08  3.4668009e-08 -9.7313704e-09 -9.7313704e-09
  2.4328427e-08  0.0000000e+00  0.0000000e+00 -3.5276219e-08
  0.0000000e+00  0.0000000e+00 -7.2985280e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4037185e+00  4.8247013e+00  0.0000000e+00 -6.3324990e-09
 -5.0659992e-09  1.2664998e-09 -2.5329996e-09 -2.5329996e-09
 -7.5989988e-09  6.3324990e-09 -8.8654986e-09  2.5329996e-09
  3.1662495e-09  2.0263997e-08 -1.7730997e-08 -1.5831247e-09
 -1.5831247e-09 -1.5831247e-09 -1.5831247e-09 -1.5831247e-09
 -1.5831247e-09  6.3324990e-10]
2025-06-03 11:14:22,309 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0466
2025-06-03 11:14:22,309 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:22,309 - INFO - Running anomaly detection...
2025-06-03 11:14:22,310 - INFO - Starting anomaly detection.
2025-06-03 11:14:22,318 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111422_update_7.json
2025-06-03 11:14:22,318 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:22,324 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111422_update_7.pth and as latest_checkpoint.pth
2025-06-03 11:14:22,324 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.3446
2025-06-03 11:14:22,324 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:22,324 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:14:22,324 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.4237, MLP Score: 1.0000
2025-06-03 11:14:22,324 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.8047, MLP Score: 1.0000
2025-06-03 11:14:22,324 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.8402, MLP Score: 1.0000
2025-06-03 11:14:22,324 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.5667, MLP Score: 1.0000
2025-06-03 11:14:22,324 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 5.6306, MLP Score: 1.0000
2025-06-03 11:14:22,325 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-03 11:14:22,325 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-03 11:14:22,325 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot file.
2025-06-03 11:14:22,335 - INFO - Parsed 419 nodes.
2025-06-03 11:14:22,342 - INFO - Parsed 833 edges.
2025-06-03 11:14:22,438 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:22,438 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:22,446 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-03 11:14:22,447 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:22,448 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-03 11:14:22,448 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-03 11:14:22,448 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:22,453 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:22,453 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:22,454 - DEBUG - Shape of encoded categorical edge features: torch.Size([833, 2])
2025-06-03 11:14:22,455 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:22,455 - DEBUG - Shape of scaled numerical edge features: torch.Size([833, 20])
2025-06-03 11:14:22,455 - DEBUG - Final edge attributes tensor shape: torch.Size([833, 22])
2025-06-03 11:14:22,455 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:22,455 - INFO - Performing online update...
2025-06-03 11:14:22,456 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:22,456 - DEBUG - Updated RunningStats: new_mean=0.8738593194939196, new_var=34200000000023.11, new_n=3450
2025-06-03 11:14:22,456 - DEBUG - Updated RunningStats: new_mean=0.8717923463903389, new_var=34500000000008.695, new_n=3480
2025-06-03 11:14:22,456 - DEBUG - Updated RunningStats: new_mean=1.104743254254219, new_var=12840000000038.87, new_n=1306
2025-06-03 11:14:22,456 - DEBUG - Updated RunningStats: new_mean=1.103305417493288, new_var=13060000000001.176, new_n=1328
2025-06-03 11:14:22,457 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:22,457 - DEBUG - Online update step: 1/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 2/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 3/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 4/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 5/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 6/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 7/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 8/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 9/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 10/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 11/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 12/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 13/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 14/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 15/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 16/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 17/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 18/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 19/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 20/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,457 - DEBUG - Online update step: 21/50
2025-06-03 11:14:22,457 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 22/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 23/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 24/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 25/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 26/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 27/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 28/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 29/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 30/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 31/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 32/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 33/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 34/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 35/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 36/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 37/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 38/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 39/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 40/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 41/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 42/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 43/50
2025-06-03 11:14:22,458 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,458 - DEBUG - Online update step: 44/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 45/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 46/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 47/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 48/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 49/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - DEBUG - Online update step: 50/50
2025-06-03 11:14:22,459 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,459 - WARNING - No successful steps during online update.
2025-06-03 11:14:22,459 - DEBUG - Current node mean: [ 7.96625343e-09 -7.96625343e-09  1.59325069e-08 -9.10428977e-09
 -9.10428977e-09 -1.82085795e-08 -2.27607231e-08 -1.47944705e-08
 -1.59325069e-08 -2.27607244e-09  1.13803615e-08 -2.04846504e-08
  2.27607244e-09  1.19493802e-08 -4.15383212e-08  7.96625343e-09
  2.27607244e-09  0.00000000e+00  0.00000000e+00  2.04846504e-08
  0.00000000e+00  0.00000000e+00 -3.18650137e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4177670e+00  4.8607445e+00 -1.4310839e-09 -1.7173006e-09
  7.4416362e-09 -5.7243355e-10  0.0000000e+00  2.0750717e-09
  0.0000000e+00 -3.4346013e-09 -2.2468017e-08  1.1448671e-09
 -4.2932515e-09 -1.0590021e-08 -2.2897342e-09  2.2897342e-09
  2.2897342e-09  2.2897342e-09  2.2897342e-09  2.2897342e-09
  2.2897342e-09  5.7243355e-10]
2025-06-03 11:14:22,460 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0280
2025-06-03 11:14:22,460 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:22,460 - INFO - Running anomaly detection...
2025-06-03 11:14:22,460 - INFO - Starting anomaly detection.
2025-06-03 11:14:22,484 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111422_update_8.json
2025-06-03 11:14:22,484 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:22,490 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111422_update_8.pth and as latest_checkpoint.pth
2025-06-03 11:14:22,491 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.3225
2025-06-03 11:14:22,491 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:22,491 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:22,491 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 1.4034, MLP Score: 1.0000
2025-06-03 11:14:22,491 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.4916, MLP Score: 1.0000
2025-06-03 11:14:22,491 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8325, MLP Score: 1.0000
2025-06-03 11:14:22,491 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.8306, MLP Score: 1.0000
2025-06-03 11:14:22,491 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.0488, MLP Score: 1.0000
2025-06-03 11:14:22,491 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-03 11:14:22,491 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-03 11:14:22,491 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot file.
2025-06-03 11:14:22,505 - INFO - Parsed 439 nodes.
2025-06-03 11:14:22,513 - INFO - Parsed 919 edges.
2025-06-03 11:14:22,625 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:22,626 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:22,634 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-03 11:14:22,636 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:22,636 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-03 11:14:22,636 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-03 11:14:22,637 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:22,641 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:22,641 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:22,642 - DEBUG - Shape of encoded categorical edge features: torch.Size([919, 2])
2025-06-03 11:14:22,643 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:22,643 - DEBUG - Shape of scaled numerical edge features: torch.Size([919, 20])
2025-06-03 11:14:22,643 - DEBUG - Final edge attributes tensor shape: torch.Size([919, 22])
2025-06-03 11:14:22,643 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:22,643 - INFO - Performing online update...
2025-06-03 11:14:22,643 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:22,644 - DEBUG - Updated RunningStats: new_mean=0.8643411297229595, new_var=34800000000022.605, new_n=3510
2025-06-03 11:14:22,644 - DEBUG - Updated RunningStats: new_mean=0.8623895599844067, new_var=35100000000008.562, new_n=3540
2025-06-03 11:14:22,644 - DEBUG - Updated RunningStats: new_mean=1.0899868917693987, new_var=13280000000038.266, new_n=1350
2025-06-03 11:14:22,644 - DEBUG - Updated RunningStats: new_mean=1.0888272822562772, new_var=13500000000001.105, new_n=1372
2025-06-03 11:14:22,644 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:22,644 - DEBUG - Online update step: 1/50
2025-06-03 11:14:22,644 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,644 - DEBUG - Online update step: 2/50
2025-06-03 11:14:22,644 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,644 - DEBUG - Online update step: 3/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 4/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 5/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 6/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 7/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 8/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 9/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 10/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 11/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 12/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 13/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 14/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 15/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 16/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 17/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 18/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 19/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 20/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 21/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 22/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 23/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 24/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,645 - DEBUG - Online update step: 25/50
2025-06-03 11:14:22,645 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 26/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 27/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 28/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 29/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 30/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 31/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 32/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 33/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 34/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 35/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 36/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 37/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 38/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 39/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 40/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 41/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 42/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 43/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 44/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 45/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 46/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 47/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 48/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 49/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,646 - DEBUG - Online update step: 50/50
2025-06-03 11:14:22,646 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,647 - WARNING - No successful steps during online update.
2025-06-03 11:14:22,647 - DEBUG - Current node mean: [ 2.9327115e-08 -2.8240924e-08 -2.8512472e-09  1.4120462e-08
 -3.2585683e-09  0.0000000e+00  1.0861895e-09  9.2326102e-09
 -1.1948083e-08 -2.4982358e-08  0.0000000e+00 -3.8016630e-08
  9.7757047e-09 -2.2266883e-08 -1.2491179e-08 -5.2680186e-08
 -1.7379032e-08  0.0000000e+00  0.0000000e+00  3.8831271e-08
  0.0000000e+00  0.0000000e+00  9.5041575e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4417845e+00  4.8509250e+00  0.0000000e+00 -2.0754609e-09
  0.0000000e+00  1.0377305e-09 -2.0754609e-09 -3.1131915e-09
  2.5943263e-09  2.8537588e-09 -1.2452766e-08  1.5565957e-09
  9.8584394e-09 -8.3018437e-09 -1.4528227e-08  2.0754609e-09
  2.0754609e-09  2.0754609e-09  2.0754609e-09  2.0754609e-09
  2.0754609e-09  0.0000000e+00]
2025-06-03 11:14:22,647 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0477
2025-06-03 11:14:22,647 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:22,648 - INFO - Running anomaly detection...
2025-06-03 11:14:22,648 - INFO - Starting anomaly detection.
2025-06-03 11:14:22,658 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111422_update_9.json
2025-06-03 11:14:22,659 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:22,665 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111422_update_9.pth and as latest_checkpoint.pth
2025-06-03 11:14:22,665 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.2801
2025-06-03 11:14:22,666 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:22,666 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:22,666 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.4769, MLP Score: 1.0000
2025-06-03 11:14:22,666 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8002, MLP Score: 1.0000
2025-06-03 11:14:22,666 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.6364, MLP Score: 1.0000
2025-06-03 11:14:22,666 - WARNING -   Source: 192.168.27.10, Target: 54.230.71.128, Recon Error: 2.0509, MLP Score: 1.0000
2025-06-03 11:14:22,666 - WARNING -   Source: 192.168.27.10, Target: 142.250.197.78, Recon Error: 1.4889, MLP Score: 1.0000
2025-06-03 11:14:22,666 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-03 11:14:22,666 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-03 11:14:22,666 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot file.
2025-06-03 11:14:22,680 - INFO - Parsed 511 nodes.
2025-06-03 11:14:22,689 - INFO - Parsed 1044 edges.
2025-06-03 11:14:22,839 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:22,840 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:22,848 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-03 11:14:22,851 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:22,851 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-03 11:14:22,852 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-03 11:14:22,852 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:22,857 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:22,858 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:22,859 - DEBUG - Shape of encoded categorical edge features: torch.Size([1044, 2])
2025-06-03 11:14:22,860 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:22,860 - DEBUG - Shape of scaled numerical edge features: torch.Size([1044, 20])
2025-06-03 11:14:22,860 - DEBUG - Final edge attributes tensor shape: torch.Size([1044, 22])
2025-06-03 11:14:22,860 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:22,860 - INFO - Performing online update...
2025-06-03 11:14:22,860 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:22,861 - DEBUG - Updated RunningStats: new_mean=0.8551425889060849, new_var=35400000000022.125, new_n=3570
2025-06-03 11:14:22,861 - DEBUG - Updated RunningStats: new_mean=0.8532993501393236, new_var=35700000000008.43, new_n=3600
2025-06-03 11:14:22,861 - DEBUG - Updated RunningStats: new_mean=1.0761331793111686, new_var=13720000000037.752, new_n=1394
2025-06-03 11:14:22,861 - DEBUG - Updated RunningStats: new_mean=1.0752502355675688, new_var=13940000000001.146, new_n=1416
2025-06-03 11:14:22,861 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:22,861 - DEBUG - Online update step: 1/50
2025-06-03 11:14:22,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,861 - DEBUG - Online update step: 2/50
2025-06-03 11:14:22,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,861 - DEBUG - Online update step: 3/50
2025-06-03 11:14:22,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,861 - DEBUG - Online update step: 4/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 5/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 6/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 7/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 8/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 9/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 10/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 11/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 12/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 13/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 14/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 15/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 16/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 17/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 18/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 19/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 20/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 21/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 22/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 23/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 24/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 25/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 26/50
2025-06-03 11:14:22,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,862 - DEBUG - Online update step: 27/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 28/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 29/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 30/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 31/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 32/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 33/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 34/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 35/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 36/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 37/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 38/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 39/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 40/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 41/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 42/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 43/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 44/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 45/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 46/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 47/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 48/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 49/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - DEBUG - Online update step: 50/50
2025-06-03 11:14:22,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:22,863 - WARNING - No successful steps during online update.
2025-06-03 11:14:22,864 - DEBUG - Current node mean: [-1.4697036e-08  1.5163609e-08 -1.4930322e-08  0.0000000e+00
 -3.3593224e-08  3.3593224e-08 -4.4790966e-08  1.0264596e-08
  1.5863467e-08  1.4930322e-08 -1.1197741e-08 -3.7325805e-09
  4.1991530e-08  1.8662902e-08  2.4261773e-08 -1.4930322e-08
 -2.2395483e-08  0.0000000e+00  0.0000000e+00  5.5988707e-09
  0.0000000e+00  0.0000000e+00  2.9860644e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4061303e+00  4.8524904e+00  2.6262583e-09  0.0000000e+00
  2.7404434e-09  0.0000000e+00  7.3078490e-09 -1.3702217e-09
 -7.3078490e-09 -1.2331996e-08 -5.8234422e-09 -5.0241464e-09
  7.6504048e-09  9.5915524e-09 -1.4615698e-08 -2.7404434e-09
 -2.7404434e-09 -2.7404434e-09 -2.7404434e-09 -2.7404434e-09
 -2.7404434e-09 -1.8269622e-09]
2025-06-03 11:14:22,864 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0702
2025-06-03 11:14:22,864 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:22,864 - INFO - Running anomaly detection...
2025-06-03 11:14:22,865 - INFO - Starting anomaly detection.
2025-06-03 11:14:22,904 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111422_update_10.json
2025-06-03 11:14:22,904 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:22,910 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111422_update_10.pth and as latest_checkpoint.pth
2025-06-03 11:14:22,910 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.2600
2025-06-03 11:14:22,910 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:22,910 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:14:22,911 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 1.4435, MLP Score: 1.0000
2025-06-03 11:14:22,911 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 2.8333, MLP Score: 1.0000
2025-06-03 11:14:22,911 - WARNING -   Source: 192.168.27.10, Target: 20.189.173.8, Recon Error: 1.4348, MLP Score: 1.0000
2025-06-03 11:14:22,911 - WARNING -   Source: 192.168.27.10, Target: 23.49.104.211, Recon Error: 6.1827, MLP Score: 1.0000
2025-06-03 11:14:22,911 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.5318, MLP Score: 1.0000
2025-06-03 11:14:22,911 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-03 11:14:22,911 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-03 11:14:22,911 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot file.
2025-06-03 11:14:22,925 - INFO - Parsed 547 nodes.
2025-06-03 11:14:22,936 - INFO - Parsed 1118 edges.
2025-06-03 11:14:23,117 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:23,117 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:23,127 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-03 11:14:23,130 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:23,130 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-03 11:14:23,131 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-03 11:14:23,131 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:23,137 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:23,138 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:23,139 - DEBUG - Shape of encoded categorical edge features: torch.Size([1118, 2])
2025-06-03 11:14:23,140 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:23,141 - DEBUG - Shape of scaled numerical edge features: torch.Size([1118, 20])
2025-06-03 11:14:23,141 - DEBUG - Final edge attributes tensor shape: torch.Size([1118, 22])
2025-06-03 11:14:23,141 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:23,141 - INFO - Performing online update...
2025-06-03 11:14:23,141 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:23,142 - DEBUG - Updated RunningStats: new_mean=0.8462472893857252, new_var=36000000000021.664, new_n=3630
2025-06-03 11:14:23,142 - DEBUG - Updated RunningStats: new_mean=0.844506844687379, new_var=36300000000008.32, new_n=3660
2025-06-03 11:14:23,142 - DEBUG - Updated RunningStats: new_mean=1.0631789238648999, new_var=14160000000037.607, new_n=1438
2025-06-03 11:14:23,142 - DEBUG - Updated RunningStats: new_mean=1.0624940020560023, new_var=14380000000001.064, new_n=1460
2025-06-03 11:14:23,142 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:23,142 - DEBUG - Online update step: 1/50
2025-06-03 11:14:23,142 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,142 - DEBUG - Online update step: 2/50
2025-06-03 11:14:23,142 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,142 - DEBUG - Online update step: 3/50
2025-06-03 11:14:23,142 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,142 - DEBUG - Online update step: 4/50
2025-06-03 11:14:23,142 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,142 - DEBUG - Online update step: 5/50
2025-06-03 11:14:23,142 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 6/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 7/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 8/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 9/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 10/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 11/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 12/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 13/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 14/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 15/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 16/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 17/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 18/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 19/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 20/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 21/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 22/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 23/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 24/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 25/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 26/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 27/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 28/50
2025-06-03 11:14:23,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,143 - DEBUG - Online update step: 29/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 30/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 31/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 32/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 33/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 34/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 35/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 36/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 37/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 38/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 39/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 40/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 41/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 42/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 43/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 44/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 45/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 46/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 47/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 48/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 49/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - DEBUG - Online update step: 50/50
2025-06-03 11:14:23,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:23,144 - WARNING - No successful steps during online update.
2025-06-03 11:14:23,145 - DEBUG - Current node mean: [ 2.4408484e-08 -2.4408484e-08  3.8356188e-08 -2.6151946e-08
 -1.5691167e-08  2.7895410e-08  6.9738526e-09 -2.0921558e-08
 -3.1382335e-08 -8.7173158e-09  6.9738526e-09  1.7434632e-08
 -2.6151946e-08 -8.7173158e-10 -6.9738526e-09  1.6562899e-08
 -1.4383571e-08  0.0000000e+00  0.0000000e+00  2.3100887e-08
  0.0000000e+00  0.0000000e+00 -1.7434632e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4025044e+00  4.8944545e+00  1.7060363e-09 -8.5301816e-10
  0.0000000e+00  8.5301816e-10  8.5301819e-09  5.5446181e-09
  1.7060363e-09  4.2650909e-09 -6.3976362e-09  7.6771638e-09
  0.0000000e+00 -8.5301816e-10  5.9711271e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.5590545e-09]
2025-06-03 11:14:23,145 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0219
2025-06-03 11:14:23,146 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:23,146 - INFO - Running anomaly detection...
2025-06-03 11:14:23,146 - INFO - Starting anomaly detection.
2025-06-03 11:14:23,171 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111423_update_11.json
2025-06-03 11:14:23,171 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:23,177 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111423_update_11.pth and as latest_checkpoint.pth
2025-06-03 11:14:23,178 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.2421
2025-06-03 11:14:23,178 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:23,178 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-03 11:14:23,178 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.9939, MLP Score: 1.0000
2025-06-03 11:14:23,178 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.0368, MLP Score: 1.0000
2025-06-03 11:14:23,178 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.7537, MLP Score: 1.0000
2025-06-03 11:14:23,178 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.5134, MLP Score: 1.0000
2025-06-03 11:14:23,178 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4424, MLP Score: 1.0000
2025-06-03 11:14:23,178 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:23,178 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:23,178 - INFO - Starting visualization of node features.
2025-06-03 11:14:23,178 - INFO - Graph has 547 nodes and 30 features.
2025-06-03 11:14:23,178 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:23,178 - INFO - Calculating feature statistics:
2025-06-03 11:14:23,179 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(1.7434632e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.12311414), 'max': np.float32(8.2043)}
2025-06-03 11:14:23,179 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-1.7434632e-08), 'std': np.float32(1.0000001), 'min': np.float32(-8.2043), 'max': np.float32(0.12311414)}
2025-06-03 11:14:23,179 - INFO - - server_score: {'name': 'server_score', 'unique': 11, 'mean': np.float32(3.1818203e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4430053), 'max': np.float32(4.351648)}
2025-06-03 11:14:23,184 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(6.9738526e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09511919), 'max': np.float32(13.263146)}
2025-06-03 11:14:23,184 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-2.0921558e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64926356), 'max': np.float32(3.5786788)}
2025-06-03 11:14:23,185 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 12, 'mean': np.float32(2.9638873e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6530039), 'max': np.float32(2.8253858)}
2025-06-03 11:14:23,185 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 11, 'mean': np.float32(-3.0510605e-09), 'std': np.float32(1.0), 'min': np.float32(-2.2739558), 'max': np.float32(0.6377714)}
2025-06-03 11:14:23,185 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 7, 'mean': np.float32(-5.2303895e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09997174), 'max': np.float32(13.921706)}
2025-06-03 11:14:23,185 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-6.9738526e-09), 'std': np.float32(1.0), 'min': np.float32(-3.9443693), 'max': np.float32(15.563497)}
2025-06-03 11:14:23,185 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.10418314), 'max': np.float32(10.671389)}
2025-06-03 11:14:23,185 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 12, 'mean': np.float32(2.1357422e-08), 'std': np.float32(1.0), 'min': np.float32(-2.042388), 'max': np.float32(0.9379485)}
2025-06-03 11:14:23,185 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-1.7434632e-09), 'std': np.float32(1.0), 'min': np.float32(-0.11823206), 'max': np.float32(9.141702)}
2025-06-03 11:14:23,185 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-6.9738526e-09), 'std': np.float32(0.99999994), 'min': np.float32(-6.840797), 'max': np.float32(0.14908338)}
2025-06-03 11:14:23,185 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3379294), 'max': np.float32(2.591279)}
2025-06-03 11:14:23,185 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5481575), 'max': np.float32(1.3595055)}
2025-06-03 11:14:23,185 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 10, 'mean': np.float32(1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-0.77910113), 'max': np.float32(3.8437746)}
2025-06-03 11:14:23,185 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 10, 'mean': np.float32(-1.3947705e-08), 'std': np.float32(1.0), 'min': np.float32(-3.7928014), 'max': np.float32(0.7891658)}
2025-06-03 11:14:23,185 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 10, 'mean': np.float32(2.266502e-08), 'std': np.float32(1.0), 'min': np.float32(-6.472329), 'max': np.float32(0.17130168)}
2025-06-03 11:14:23,186 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 10, 'mean': np.float32(-1.7434632e-08), 'std': np.float32(1.0), 'min': np.float32(-3.543924), 'max': np.float32(3.657931)}
2025-06-03 11:14:23,186 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,186 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:23,200 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764e4a3f20>
2025-06-03 11:14:23,540 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:23,592 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:23,618 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:25,023 - INFO - Node feature visualization saved to vis/node_features_20250603_111423.png
2025-06-03 11:14:25,024 - INFO - Finished visualization of node features.
2025-06-03 11:14:25,024 - INFO - Performing additional feature analysis:
2025-06-03 11:14:25,024 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:25,024 - INFO - Starting visualization of edge features.
2025-06-03 11:14:25,024 - INFO - Graph has 1118 edges and 22 edge features.
2025-06-03 11:14:25,024 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:25,024 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:25,024 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-03 11:14:25,024 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-03 11:14:25,024 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot file.
2025-06-03 11:14:25,044 - INFO - Parsed 640 nodes.
2025-06-03 11:14:25,056 - INFO - Parsed 1300 edges.
2025-06-03 11:14:25,329 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:25,329 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:25,342 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-03 11:14:25,344 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:25,344 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-03 11:14:25,345 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-03 11:14:25,345 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:25,352 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:25,353 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:25,354 - DEBUG - Shape of encoded categorical edge features: torch.Size([1300, 2])
2025-06-03 11:14:25,355 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:25,355 - DEBUG - Shape of scaled numerical edge features: torch.Size([1300, 20])
2025-06-03 11:14:25,355 - DEBUG - Final edge attributes tensor shape: torch.Size([1300, 22])
2025-06-03 11:14:25,356 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:25,356 - INFO - Performing online update...
2025-06-03 11:14:25,356 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:25,356 - DEBUG - Updated RunningStats: new_mean=0.8376409354095482, new_var=36600000000021.22, new_n=3690
2025-06-03 11:14:25,356 - DEBUG - Updated RunningStats: new_mean=0.8359972882503409, new_var=36900000000008.21, new_n=3720
2025-06-03 11:14:25,357 - DEBUG - Updated RunningStats: new_mean=1.0510077939826812, new_var=14600000000037.572, new_n=1482
2025-06-03 11:14:25,357 - DEBUG - Updated RunningStats: new_mean=1.050487051896452, new_var=14820000000000.96, new_n=1504
2025-06-03 11:14:25,357 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:25,357 - DEBUG - Online update step: 1/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 2/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 3/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 4/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 5/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 6/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 7/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 8/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 9/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 10/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 11/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 12/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 13/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 14/50
2025-06-03 11:14:25,357 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,357 - DEBUG - Online update step: 15/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 16/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 17/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 18/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 19/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 20/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 21/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 22/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 23/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 24/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 25/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 26/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 27/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 28/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 29/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 30/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 31/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 32/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 33/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,358 - DEBUG - Online update step: 34/50
2025-06-03 11:14:25,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 35/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 36/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 37/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 38/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 39/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 40/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 41/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 42/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 43/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 44/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 45/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 46/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 47/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 48/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 49/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - DEBUG - Online update step: 50/50
2025-06-03 11:14:25,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,359 - WARNING - No successful steps during online update.
2025-06-03 11:14:25,360 - DEBUG - Current node mean: [-2.6822089e-08  2.6822089e-08  1.3411045e-08  8.5681675e-09
  7.5250867e-08 -2.3096799e-08 -1.1920929e-08  8.1956388e-09
  1.2293458e-08  1.3411045e-08 -9.6857544e-09  4.4703485e-09
 -7.4505806e-09  1.9371509e-08 -1.1920929e-08  7.4505807e-10
  3.7252903e-09  0.0000000e+00  0.0000000e+00  2.9802323e-09
  0.0000000e+00  0.0000000e+00  7.0780515e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4076923e+00  4.9446154e+00 -1.4671913e-09 -2.9343825e-09
  5.8687650e-09  1.4671913e-09  5.8687650e-09 -2.9343825e-09
 -1.8339891e-09 -1.1737530e-08 -8.8031475e-09 -1.1737530e-08
  1.4671913e-09 -1.3938317e-08  1.4671913e-08  5.1351692e-09
  5.1351692e-09  5.1351692e-09  5.1351692e-09  5.1351692e-09
  5.1351692e-09 -1.4671913e-09]
2025-06-03 11:14:25,360 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0267
2025-06-03 11:14:25,360 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:25,360 - INFO - Running anomaly detection...
2025-06-03 11:14:25,361 - INFO - Starting anomaly detection.
2025-06-03 11:14:25,372 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111425_update_12.json
2025-06-03 11:14:25,372 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:25,378 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111425_update_12.pth and as latest_checkpoint.pth
2025-06-03 11:14:25,379 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.2053
2025-06-03 11:14:25,379 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:25,379 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-03 11:14:25,379 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.1888, MLP Score: 1.0000
2025-06-03 11:14:25,379 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.1674, MLP Score: 1.0000
2025-06-03 11:14:25,379 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2552, MLP Score: 1.0000
2025-06-03 11:14:25,379 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.0888, MLP Score: 1.0000
2025-06-03 11:14:25,379 - WARNING -   Source: 192.168.27.13, Target: 35.213.7.90, Recon Error: 1.3753, MLP Score: 1.0000
2025-06-03 11:14:25,379 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-03 11:14:25,379 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-03 11:14:25,379 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot file.
2025-06-03 11:14:25,394 - INFO - Parsed 653 nodes.
2025-06-03 11:14:25,406 - INFO - Parsed 1355 edges.
2025-06-03 11:14:25,663 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:25,663 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:25,675 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-03 11:14:25,676 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:25,677 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-03 11:14:25,678 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-03 11:14:25,678 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:25,684 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:25,685 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:25,686 - DEBUG - Shape of encoded categorical edge features: torch.Size([1355, 2])
2025-06-03 11:14:25,688 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:25,688 - DEBUG - Shape of scaled numerical edge features: torch.Size([1355, 20])
2025-06-03 11:14:25,688 - DEBUG - Final edge attributes tensor shape: torch.Size([1355, 22])
2025-06-03 11:14:25,688 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:25,688 - INFO - Performing online update...
2025-06-03 11:14:25,688 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:25,689 - DEBUG - Updated RunningStats: new_mean=0.8293093099061961, new_var=37200000000020.8, new_n=3750
2025-06-03 11:14:25,689 - DEBUG - Updated RunningStats: new_mean=0.8277577981534454, new_var=37500000000008.12, new_n=3780
2025-06-03 11:14:25,689 - DEBUG - Updated RunningStats: new_mean=1.0395102710732547, new_var=15040000000037.174, new_n=1526
2025-06-03 11:14:25,689 - DEBUG - Updated RunningStats: new_mean=1.0391646812734598, new_var=15260000000000.926, new_n=1548
2025-06-03 11:14:25,689 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:25,689 - DEBUG - Online update step: 1/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 2/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 3/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 4/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 5/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 6/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,689 - DEBUG - Online update step: 7/50
2025-06-03 11:14:25,689 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 8/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 9/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 10/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 11/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 12/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 13/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 14/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 15/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 16/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 17/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 18/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 19/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 20/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 21/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 22/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 23/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 24/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 25/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 26/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 27/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 28/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,690 - DEBUG - Online update step: 29/50
2025-06-03 11:14:25,690 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 30/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 31/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 32/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 33/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 34/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 35/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 36/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 37/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 38/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 39/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 40/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 41/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 42/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 43/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 44/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 45/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 46/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 47/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 48/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 49/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - DEBUG - Online update step: 50/50
2025-06-03 11:14:25,691 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:25,691 - WARNING - No successful steps during online update.
2025-06-03 11:14:25,692 - DEBUG - Current node mean: [ 4.38135217e-09 -4.38135217e-09 -1.89858600e-08 -2.92090139e-08
 -1.75254087e-08  2.48276617e-08 -1.31440565e-08 -1.02231548e-08
 -2.48276617e-08 -2.59230006e-08  4.52739712e-08 -1.09533804e-08
  2.09939799e-09 -2.19067608e-08  2.82962329e-08 -3.65112673e-09
 -9.49293000e-09  0.00000000e+00  0.00000000e+00 -1.02231548e-08
  0.00000000e+00  0.00000000e+00 -4.74646491e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4169742e+00  4.9431734e+00 -1.4076373e-09  5.8944813e-09
  2.9912295e-09 -5.2786403e-10 -6.3343681e-09 -1.3372555e-08
 -1.7595467e-09  1.0557281e-09  2.5689381e-08  3.5190935e-09
 -2.1114561e-09 -2.1114561e-09 -5.6305494e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.2229122e-09]
2025-06-03 11:14:25,692 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0185
2025-06-03 11:14:25,693 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:25,693 - INFO - Running anomaly detection...
2025-06-03 11:14:25,693 - INFO - Starting anomaly detection.
2025-06-03 11:14:25,702 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111425_update_13.json
2025-06-03 11:14:25,702 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:25,708 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111425_update_13.pth and as latest_checkpoint.pth
2025-06-03 11:14:25,708 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.2086
2025-06-03 11:14:25,708 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:25,708 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:25,709 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.3148, MLP Score: 1.0000
2025-06-03 11:14:25,709 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.1664, MLP Score: 1.0000
2025-06-03 11:14:25,709 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.2843, MLP Score: 1.0000
2025-06-03 11:14:25,709 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.3974, MLP Score: 1.0000
2025-06-03 11:14:25,709 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.3950, MLP Score: 1.0000
2025-06-03 11:14:25,709 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-03 11:14:25,709 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-03 11:14:25,709 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot file.
2025-06-03 11:14:25,726 - INFO - Parsed 693 nodes.
2025-06-03 11:14:25,740 - INFO - Parsed 1448 edges.
2025-06-03 11:14:26,041 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:26,041 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:26,054 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-03 11:14:26,056 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:26,056 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-03 11:14:26,057 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-03 11:14:26,057 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:26,064 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:26,065 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:26,066 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 2])
2025-06-03 11:14:26,068 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:26,068 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 20])
2025-06-03 11:14:26,068 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 22])
2025-06-03 11:14:26,068 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:26,068 - INFO - Performing online update...
2025-06-03 11:14:26,068 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:26,069 - DEBUG - Updated RunningStats: new_mean=0.8212400201923837, new_var=37800000000020.39, new_n=3810
2025-06-03 11:14:26,069 - DEBUG - Updated RunningStats: new_mean=0.8197755730275011, new_var=38100000000008.02, new_n=3840
2025-06-03 11:14:26,069 - DEBUG - Updated RunningStats: new_mean=1.0286768436902833, new_var=15480000000037.07, new_n=1570
2025-06-03 11:14:26,069 - DEBUG - Updated RunningStats: new_mean=1.0284663407062948, new_var=15700000000000.86, new_n=1592
2025-06-03 11:14:26,069 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:26,069 - DEBUG - Online update step: 1/50
2025-06-03 11:14:26,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,069 - DEBUG - Online update step: 2/50
2025-06-03 11:14:26,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,069 - DEBUG - Online update step: 3/50
2025-06-03 11:14:26,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,069 - DEBUG - Online update step: 4/50
2025-06-03 11:14:26,069 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,069 - DEBUG - Online update step: 5/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 6/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 7/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 8/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 9/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 10/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 11/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 12/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 13/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 14/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 15/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 16/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 17/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 18/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 19/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 20/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 21/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 22/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 23/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 24/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 25/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,070 - DEBUG - Online update step: 26/50
2025-06-03 11:14:26,070 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 27/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 28/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 29/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 30/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 31/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 32/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 33/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 34/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 35/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 36/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 37/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 38/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 39/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 40/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 41/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 42/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 43/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 44/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 45/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 46/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 47/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 48/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 49/50
2025-06-03 11:14:26,071 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,071 - DEBUG - Online update step: 50/50
2025-06-03 11:14:26,072 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,072 - WARNING - No successful steps during online update.
2025-06-03 11:14:26,072 - DEBUG - Current node mean: [-8.0849016e-09  8.0849016e-09 -3.8532296e-08  1.3761534e-09
  2.4770761e-08  2.6146916e-08 -3.5779991e-08 -1.4105573e-08
  3.4403835e-09 -7.5688442e-09  2.2018455e-08  2.8211145e-08
 -2.7523068e-08 -8.2569205e-09 -2.2018455e-08 -3.3715757e-08
  2.2018455e-08  0.0000000e+00  0.0000000e+00 -2.3394609e-08
  0.0000000e+00  0.0000000e+00 -4.1284602e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.41919887e+00  4.97651911e+00  4.61030414e-09  0.00000000e+00
 -1.97584460e-09 -3.95168920e-09 -3.95168920e-09 -3.95168920e-09
  1.64653713e-09  3.95168920e-09  1.02085300e-08 -1.25136825e-08
  0.00000000e+00 -3.95168920e-09  2.63445954e-09  1.97584460e-09
  1.97584460e-09  1.97584460e-09  1.97584460e-09  1.97584460e-09
  1.97584460e-09 -6.58614885e-10]
2025-06-03 11:14:26,072 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0183
2025-06-03 11:14:26,073 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:26,073 - INFO - Running anomaly detection...
2025-06-03 11:14:26,073 - INFO - Starting anomaly detection.
2025-06-03 11:14:26,083 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111426_update_14.json
2025-06-03 11:14:26,083 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:26,090 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111426_update_14.pth and as latest_checkpoint.pth
2025-06-03 11:14:26,090 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.1959
2025-06-03 11:14:26,090 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:26,090 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:26,090 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.4001, MLP Score: 1.0000
2025-06-03 11:14:26,090 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.2535, MLP Score: 1.0000
2025-06-03 11:14:26,090 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.5356, MLP Score: 1.0000
2025-06-03 11:14:26,090 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6670, MLP Score: 1.0000
2025-06-03 11:14:26,090 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4270, MLP Score: 1.0000
2025-06-03 11:14:26,090 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-03 11:14:26,090 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-03 11:14:26,090 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot file.
2025-06-03 11:14:26,109 - INFO - Parsed 700 nodes.
2025-06-03 11:14:26,123 - INFO - Parsed 1476 edges.
2025-06-03 11:14:26,444 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:26,444 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:26,456 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-03 11:14:26,457 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:26,458 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-03 11:14:26,458 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-03 11:14:26,459 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:26,466 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:26,467 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:26,468 - DEBUG - Shape of encoded categorical edge features: torch.Size([1476, 2])
2025-06-03 11:14:26,469 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:26,469 - DEBUG - Shape of scaled numerical edge features: torch.Size([1476, 20])
2025-06-03 11:14:26,470 - DEBUG - Final edge attributes tensor shape: torch.Size([1476, 22])
2025-06-03 11:14:26,470 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:26,470 - INFO - Performing online update...
2025-06-03 11:14:26,470 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:26,470 - DEBUG - Updated RunningStats: new_mean=0.8134207236079054, new_var=38400000000020.01, new_n=3870
2025-06-03 11:14:26,470 - DEBUG - Updated RunningStats: new_mean=0.8120389194386818, new_var=38700000000007.94, new_n=3900
2025-06-03 11:14:26,471 - DEBUG - Updated RunningStats: new_mean=1.018411888844236, new_var=15920000000036.736, new_n=1614
2025-06-03 11:14:26,471 - DEBUG - Updated RunningStats: new_mean=1.0183443806019086, new_var=16140000000000.848, new_n=1636
2025-06-03 11:14:26,471 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:26,471 - DEBUG - Online update step: 1/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 2/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 3/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 4/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 5/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 6/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 7/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 8/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 9/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 10/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 11/50
2025-06-03 11:14:26,471 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,471 - DEBUG - Online update step: 12/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 13/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 14/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 15/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 16/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 17/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 18/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 19/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 20/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 21/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 22/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 23/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 24/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 25/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 26/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 27/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 28/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 29/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 30/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 31/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 32/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 33/50
2025-06-03 11:14:26,472 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,472 - DEBUG - Online update step: 34/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 35/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 36/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 37/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 38/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 39/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 40/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 41/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 42/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 43/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 44/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 45/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 46/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 47/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 48/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 49/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - DEBUG - Online update step: 50/50
2025-06-03 11:14:26,473 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,473 - WARNING - No successful steps during online update.
2025-06-03 11:14:26,474 - DEBUG - Current node mean: [-1.9073486e-08  1.9073486e-08 -2.0435879e-08 -1.9073486e-08
  6.1307635e-09  1.9073486e-08 -2.4523054e-08  2.5885445e-08
  0.0000000e+00  2.7247837e-09  1.3283321e-08  9.5367430e-09
 -2.7929033e-08 -1.4986311e-08 -1.6348702e-08 -2.1798270e-08
  8.1743510e-09  0.0000000e+00  0.0000000e+00 -1.6348702e-08
  0.0000000e+00  0.0000000e+00  1.3623919e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4214092e+00  4.9769650e+00 -1.2922416e-09  3.2306040e-09
  1.9383624e-09 -4.5228457e-09 -3.8767247e-09 -3.2306040e-09
  3.2306040e-09  5.1689666e-09  2.5844833e-09 -5.1689666e-09
 -2.5844833e-09 -1.2922416e-08 -5.1689666e-09  2.5844833e-09
  2.5844833e-09  2.5844833e-09  2.5844833e-09  2.5844833e-09
  2.5844833e-09 -2.5844833e-09]
2025-06-03 11:14:26,474 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0044
2025-06-03 11:14:26,474 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:26,474 - INFO - Running anomaly detection...
2025-06-03 11:14:26,475 - INFO - Starting anomaly detection.
2025-06-03 11:14:26,483 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111426_update_15.json
2025-06-03 11:14:26,484 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:26,490 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111426_update_15.pth and as latest_checkpoint.pth
2025-06-03 11:14:26,490 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.1955
2025-06-03 11:14:26,490 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:26,490 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:26,490 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9496, MLP Score: 1.0000
2025-06-03 11:14:26,490 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.3740, MLP Score: 1.0000
2025-06-03 11:14:26,490 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4665, MLP Score: 1.0000
2025-06-03 11:14:26,490 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6516, MLP Score: 1.0000
2025-06-03 11:14:26,490 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4281, MLP Score: 1.0000
2025-06-03 11:14:26,490 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-03 11:14:26,490 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-03 11:14:26,490 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot file.
2025-06-03 11:14:26,508 - INFO - Parsed 715 nodes.
2025-06-03 11:14:26,521 - INFO - Parsed 1521 edges.
2025-06-03 11:14:26,826 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:26,826 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:26,838 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-03 11:14:26,842 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:26,846 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-03 11:14:26,848 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-03 11:14:26,848 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:26,855 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:26,856 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:26,858 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 2])
2025-06-03 11:14:26,859 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:26,859 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 20])
2025-06-03 11:14:26,859 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 22])
2025-06-03 11:14:26,860 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:26,860 - INFO - Performing online update...
2025-06-03 11:14:26,860 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:26,860 - DEBUG - Updated RunningStats: new_mean=0.8058401490537358, new_var=39000000000019.63, new_n=3930
2025-06-03 11:14:26,860 - DEBUG - Updated RunningStats: new_mean=0.8045366378389918, new_var=39300000000007.86, new_n=3960
2025-06-03 11:14:26,861 - DEBUG - Updated RunningStats: new_mean=1.0086978320484248, new_var=16360000000036.494, new_n=1658
2025-06-03 11:14:26,861 - DEBUG - Updated RunningStats: new_mean=1.0087519356118606, new_var=16580000000000.83, new_n=1680
2025-06-03 11:14:26,861 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:26,861 - DEBUG - Online update step: 1/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 2/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 3/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 4/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 5/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 6/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 7/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 8/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 9/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 10/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 11/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 12/50
2025-06-03 11:14:26,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,861 - DEBUG - Online update step: 13/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 14/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 15/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 16/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 17/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 18/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 19/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 20/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 21/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 22/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 23/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 24/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 25/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 26/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 27/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 28/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 29/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 30/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 31/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 32/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 33/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 34/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 35/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 36/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,862 - DEBUG - Online update step: 37/50
2025-06-03 11:14:26,862 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 38/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 39/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 40/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 41/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 42/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 43/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 44/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 45/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 46/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 47/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 48/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 49/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - DEBUG - Online update step: 50/50
2025-06-03 11:14:26,863 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:26,863 - WARNING - No successful steps during online update.
2025-06-03 11:14:26,863 - DEBUG - Current node mean: [-2.6009300e-08  2.6009300e-08 -1.2671197e-08 -1.0003577e-08
 -2.7009657e-08  1.5255454e-08  2.3174954e-08 -7.6694091e-09
  1.8673344e-08  9.3366719e-09  3.2678351e-08 -6.6690511e-09
 -2.5008942e-08 -5.0684790e-08  3.0010732e-08 -1.2671197e-08
 -2.6009300e-08  0.0000000e+00  0.0000000e+00  1.0253666e-08
  0.0000000e+00  0.0000000e+00  9.3366719e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4234056e+00  4.9861932e+00  0.0000000e+00  1.2540097e-09
  1.2540097e-09  0.0000000e+00 -8.7780672e-09 -5.0160387e-09
  1.2540097e-09  3.7620289e-09  1.1286087e-08  3.7620289e-09
  6.2700484e-10  1.7242632e-08 -3.7620289e-09  3.7620289e-09
  3.7620289e-09  3.7620289e-09  3.7620289e-09  3.7620289e-09
  3.7620289e-09 -1.2540097e-09]
2025-06-03 11:14:26,864 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0052
2025-06-03 11:14:26,864 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:26,864 - INFO - Running anomaly detection...
2025-06-03 11:14:26,864 - INFO - Starting anomaly detection.
2025-06-03 11:14:26,875 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111426_update_16.json
2025-06-03 11:14:26,875 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:26,882 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111426_update_16.pth and as latest_checkpoint.pth
2025-06-03 11:14:26,882 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.1845
2025-06-03 11:14:26,882 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:26,882 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:26,882 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9523, MLP Score: 1.0000
2025-06-03 11:14:26,882 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.5631, MLP Score: 1.0000
2025-06-03 11:14:26,882 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4844, MLP Score: 1.0000
2025-06-03 11:14:26,882 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.8534, MLP Score: 1.0000
2025-06-03 11:14:26,882 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4409, MLP Score: 1.0000
2025-06-03 11:14:26,882 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:26,882 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:26,882 - INFO - Starting visualization of node features.
2025-06-03 11:14:26,882 - INFO - Graph has 715 nodes and 30 features.
2025-06-03 11:14:26,882 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:26,882 - INFO - Calculating feature statistics:
2025-06-03 11:14:26,883 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(-2.4008584e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10990211), 'max': np.float32(9.343332)}
2025-06-03 11:14:26,883 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(2.4008584e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.343332), 'max': np.float32(0.10990211)}
2025-06-03 11:14:26,883 - INFO - - server_score: {'name': 'server_score', 'unique': 12, 'mean': np.float32(-1.6005723e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4258256), 'max': np.float32(3.20116)}
2025-06-03 11:14:26,883 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-5.335241e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08440674), 'max': np.float32(15.0549135)}
2025-06-03 11:14:26,883 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-1.0670482e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65705806), 'max': np.float32(3.4821181)}
2025-06-03 11:14:26,883 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 14, 'mean': np.float32(1.0670482e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.6625487), 'max': np.float32(2.8217363)}
2025-06-03 11:14:26,883 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 13, 'mean': np.float32(1.0670482e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8603718), 'max': np.float32(0.64904284)}
2025-06-03 11:14:26,883 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-8.0028615e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08956751), 'max': np.float32(16.683014)}
2025-06-03 11:14:26,883 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.3338102e-08), 'std': np.float32(1.0), 'min': np.float32(-4.2490306), 'max': np.float32(16.674225)}
2025-06-03 11:14:26,883 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(9.336672e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.088753484), 'max': np.float32(12.425848)}
2025-06-03 11:14:26,883 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0191054), 'max': np.float32(0.95447576)}
2025-06-03 11:14:26,883 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-6.002146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.10323927), 'max': np.float32(10.45955)}
2025-06-03 11:14:26,883 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.5005366e-08), 'std': np.float32(1.0), 'min': np.float32(-7.8406706), 'max': np.float32(0.13005851)}
2025-06-03 11:14:26,884 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-4.8017167e-08), 'std': np.float32(1.0), 'min': np.float32(-1.89119), 'max': np.float32(2.6003509)}
2025-06-03 11:14:26,884 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(4.268193e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5437796), 'max': np.float32(1.9436969)}
2025-06-03 11:14:26,884 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 13, 'mean': np.float32(-1.8673344e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2804745), 'max': np.float32(3.7169163)}
2025-06-03 11:14:26,884 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 13, 'mean': np.float32(-1.6005723e-08), 'std': np.float32(1.0), 'min': np.float32(-3.639823), 'max': np.float32(1.3070177)}
2025-06-03 11:14:26,884 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(1.9340249e-08), 'std': np.float32(1.0), 'min': np.float32(-7.3598647), 'max': np.float32(0.16105923)}
2025-06-03 11:14:26,884 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(-4.0014307e-09), 'std': np.float32(0.99999994), 'min': np.float32(-3.9357996), 'max': np.float32(4.1536803)}
2025-06-03 11:14:26,884 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,884 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,885 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,885 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:26,897 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764fff4500>
2025-06-03 11:14:27,195 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:27,247 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:27,274 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:28,517 - INFO - Node feature visualization saved to vis/node_features_20250603_111427.png
2025-06-03 11:14:28,517 - INFO - Finished visualization of node features.
2025-06-03 11:14:28,517 - INFO - Performing additional feature analysis:
2025-06-03 11:14:28,517 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:28,517 - INFO - Starting visualization of edge features.
2025-06-03 11:14:28,517 - INFO - Graph has 1521 edges and 22 edge features.
2025-06-03 11:14:28,517 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:28,517 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:28,517 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-03 11:14:28,518 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-03 11:14:28,518 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot file.
2025-06-03 11:14:28,535 - INFO - Parsed 723 nodes.
2025-06-03 11:14:28,550 - INFO - Parsed 1547 edges.
2025-06-03 11:14:28,904 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:28,905 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:28,917 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-03 11:14:28,919 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:28,919 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-03 11:14:28,920 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-03 11:14:28,920 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:28,927 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:28,928 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:28,929 - DEBUG - Shape of encoded categorical edge features: torch.Size([1547, 2])
2025-06-03 11:14:28,931 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:28,931 - DEBUG - Shape of scaled numerical edge features: torch.Size([1547, 20])
2025-06-03 11:14:28,931 - DEBUG - Final edge attributes tensor shape: torch.Size([1547, 22])
2025-06-03 11:14:28,931 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:28,931 - INFO - Performing online update...
2025-06-03 11:14:28,931 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:28,932 - DEBUG - Updated RunningStats: new_mean=0.7984874901890423, new_var=39600000000019.27, new_n=3990
2025-06-03 11:14:28,932 - DEBUG - Updated RunningStats: new_mean=0.7972582683610053, new_var=39900000000007.78, new_n=4020
2025-06-03 11:14:28,932 - DEBUG - Updated RunningStats: new_mean=0.9994823120335006, new_var=16800000000036.205, new_n=1702
2025-06-03 11:14:28,932 - DEBUG - Updated RunningStats: new_mean=0.9996496065052776, new_var=17020000000000.824, new_n=1724
2025-06-03 11:14:28,932 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:28,933 - DEBUG - Online update step: 1/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 2/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 3/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 4/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 5/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 6/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 7/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 8/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 9/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 10/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 11/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 12/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 13/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 14/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 15/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 16/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 17/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 18/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 19/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 20/50
2025-06-03 11:14:28,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,933 - DEBUG - Online update step: 21/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 22/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 23/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 24/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 25/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 26/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 27/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 28/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 29/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 30/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 31/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 32/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 33/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 34/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 35/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 36/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 37/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 38/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 39/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 40/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 41/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 42/50
2025-06-03 11:14:28,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,934 - DEBUG - Online update step: 43/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 44/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 45/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 46/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 47/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 48/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 49/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - DEBUG - Online update step: 50/50
2025-06-03 11:14:28,935 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:28,935 - WARNING - No successful steps during online update.
2025-06-03 11:14:28,936 - DEBUG - Current node mean: [-2.3742929e-08  2.3742929e-08 -8.9035987e-09  2.3742929e-08
  4.6166808e-09 -3.8747142e-08  2.6381032e-08  5.2762066e-09
 -9.7280060e-09 -6.5952581e-09 -5.1443013e-08  5.2762066e-09
  2.9019136e-08  1.7147672e-08 -1.0552413e-08  5.2762066e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.3742929e-08
  0.0000000e+00  0.0000000e+00 -2.6381033e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4292178e+00  4.9864254e+00  6.1646693e-10  3.6988015e-09
  6.1646693e-10 -1.8494007e-09  4.9317355e-09  1.2329339e-09
  0.0000000e+00  7.3976030e-09  1.7261074e-08  8.6305372e-09
 -8.6305372e-09  1.3562272e-08 -3.3905680e-09 -1.2329339e-09
 -1.2329339e-09 -1.2329339e-09 -1.2329339e-09 -1.2329339e-09
 -1.2329339e-09  1.2329339e-09]
2025-06-03 11:14:28,936 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0115
2025-06-03 11:14:28,936 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:28,936 - INFO - Running anomaly detection...
2025-06-03 11:14:28,936 - INFO - Starting anomaly detection.
2025-06-03 11:14:28,945 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111428_update_17.json
2025-06-03 11:14:28,946 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:28,952 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111428_update_17.pth and as latest_checkpoint.pth
2025-06-03 11:14:28,952 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.1815
2025-06-03 11:14:28,952 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:28,952 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:28,952 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9105, MLP Score: 1.0000
2025-06-03 11:14:28,952 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.5598, MLP Score: 1.0000
2025-06-03 11:14:28,952 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4449, MLP Score: 1.0000
2025-06-03 11:14:28,953 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.0851, MLP Score: 1.0000
2025-06-03 11:14:28,953 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4502, MLP Score: 1.0000
2025-06-03 11:14:28,953 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-03 11:14:28,953 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-03 11:14:28,953 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot file.
2025-06-03 11:14:28,968 - INFO - Parsed 730 nodes.
2025-06-03 11:14:28,983 - INFO - Parsed 1559 edges.
2025-06-03 11:14:29,331 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:29,331 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:29,343 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-03 11:14:29,345 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:29,345 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-03 11:14:29,346 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-03 11:14:29,346 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:29,353 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:29,354 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:29,355 - DEBUG - Shape of encoded categorical edge features: torch.Size([1559, 2])
2025-06-03 11:14:29,356 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:29,356 - DEBUG - Shape of scaled numerical edge features: torch.Size([1559, 20])
2025-06-03 11:14:29,356 - DEBUG - Final edge attributes tensor shape: torch.Size([1559, 22])
2025-06-03 11:14:29,357 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:29,357 - INFO - Performing online update...
2025-06-03 11:14:29,357 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:29,357 - DEBUG - Updated RunningStats: new_mean=0.7913526515401867, new_var=40200000000018.93, new_n=4050
2025-06-03 11:14:29,357 - DEBUG - Updated RunningStats: new_mean=0.7901939376692402, new_var=40500000000007.72, new_n=4080
2025-06-03 11:14:29,358 - DEBUG - Updated RunningStats: new_mean=0.9907249712949392, new_var=17240000000035.895, new_n=1746
2025-06-03 11:14:29,358 - DEBUG - Updated RunningStats: new_mean=0.9909999683315838, new_var=17460000000000.838, new_n=1768
2025-06-03 11:14:29,358 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:29,358 - DEBUG - Online update step: 1/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 2/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 3/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 4/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 5/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 6/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 7/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 8/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 9/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 10/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 11/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 12/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,358 - DEBUG - Online update step: 13/50
2025-06-03 11:14:29,358 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 14/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 15/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 16/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 17/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 18/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 19/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 20/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 21/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 22/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 23/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 24/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 25/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 26/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 27/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 28/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 29/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 30/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 31/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 32/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 33/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 34/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 35/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 36/50
2025-06-03 11:14:29,359 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,359 - DEBUG - Online update step: 37/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 38/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 39/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 40/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 41/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 42/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 43/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 44/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 45/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 46/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 47/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 48/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 49/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - DEBUG - Online update step: 50/50
2025-06-03 11:14:29,360 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,360 - WARNING - No successful steps during online update.
2025-06-03 11:14:29,361 - DEBUG - Current node mean: [-5.2256128e-09  5.2256128e-09  5.2256128e-09  1.3064032e-09
 -2.6128064e-09 -3.7885691e-08 -1.3064032e-09  1.6983241e-08
  1.0451226e-08 -2.6128064e-09 -2.4168459e-08  1.0451226e-08
  1.4370435e-08 -3.7885691e-08 -3.5599488e-08  1.6983241e-08
 -1.6983241e-08  0.0000000e+00  0.0000000e+00 -1.8942846e-08
  0.0000000e+00  0.0000000e+00  2.8740869e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4271970e+00  4.9826813e+00 -1.2234437e-09  2.4468874e-09
  0.0000000e+00 -2.4468874e-09  2.4468874e-09  6.1172184e-10
 -4.8937747e-09 -4.5879136e-09  2.4468873e-08  9.7875494e-09
 -3.6703309e-09 -8.5641059e-09 -7.3406619e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  4.8937747e-09]
2025-06-03 11:14:29,361 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0040
2025-06-03 11:14:29,361 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:29,361 - INFO - Running anomaly detection...
2025-06-03 11:14:29,361 - INFO - Starting anomaly detection.
2025-06-03 11:14:29,371 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111429_update_18.json
2025-06-03 11:14:29,371 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:29,377 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111429_update_18.pth and as latest_checkpoint.pth
2025-06-03 11:14:29,377 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.1832
2025-06-03 11:14:29,377 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:29,377 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:29,377 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.6901, MLP Score: 1.0000
2025-06-03 11:14:29,377 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.6507, MLP Score: 1.0000
2025-06-03 11:14:29,378 - WARNING -   Source: 192.168.27.12, Target: 3.5.138.228, Recon Error: 1.5801, MLP Score: 1.0000
2025-06-03 11:14:29,378 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0674, MLP Score: 1.0000
2025-06-03 11:14:29,378 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.5720, MLP Score: 1.0000
2025-06-03 11:14:29,378 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-03 11:14:29,378 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-03 11:14:29,378 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot file.
2025-06-03 11:14:29,394 - INFO - Parsed 736 nodes.
2025-06-03 11:14:29,407 - INFO - Parsed 1571 edges.
2025-06-03 11:14:29,753 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:29,753 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:29,767 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-03 11:14:29,768 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:29,768 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-03 11:14:29,770 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-03 11:14:29,770 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:29,777 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:29,778 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:29,780 - DEBUG - Shape of encoded categorical edge features: torch.Size([1571, 2])
2025-06-03 11:14:29,781 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:29,781 - DEBUG - Shape of scaled numerical edge features: torch.Size([1571, 20])
2025-06-03 11:14:29,781 - DEBUG - Final edge attributes tensor shape: torch.Size([1571, 22])
2025-06-03 11:14:29,781 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:29,782 - INFO - Performing online update...
2025-06-03 11:14:29,782 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:29,782 - DEBUG - Updated RunningStats: new_mean=0.7844260987302196, new_var=40800000000018.59, new_n=4110
2025-06-03 11:14:29,782 - DEBUG - Updated RunningStats: new_mean=0.7833343447136512, new_var=41100000000007.66, new_n=4140
2025-06-03 11:14:29,783 - DEBUG - Updated RunningStats: new_mean=0.9823928679912526, new_var=17680000000035.53, new_n=1790
2025-06-03 11:14:29,783 - DEBUG - Updated RunningStats: new_mean=0.9827713635858659, new_var=17900000000000.875, new_n=1812
2025-06-03 11:14:29,783 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:29,783 - DEBUG - Online update step: 1/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 2/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 3/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 4/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 5/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 6/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 7/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 8/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 9/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 10/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 11/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 12/50
2025-06-03 11:14:29,783 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,783 - DEBUG - Online update step: 13/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 14/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 15/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 16/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 17/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 18/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 19/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 20/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 21/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 22/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 23/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 24/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 25/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 26/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 27/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 28/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 29/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 30/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 31/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 32/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 33/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 34/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 35/50
2025-06-03 11:14:29,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,784 - DEBUG - Online update step: 36/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 37/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 38/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 39/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 40/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 41/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 42/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 43/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 44/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 45/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 46/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 47/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 48/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 49/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - DEBUG - Online update step: 50/50
2025-06-03 11:14:29,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:29,785 - WARNING - No successful steps during online update.
2025-06-03 11:14:29,786 - DEBUG - Current node mean: [-2.0732051e-08  2.0732051e-08  2.5915062e-08  2.2027804e-08
 -5.5069509e-09 -4.4703484e-08 -4.5351358e-09 -1.1985716e-08
  1.2957531e-08  1.0366025e-08  3.4337457e-08  0.0000000e+00
 -2.2675680e-08  4.5351358e-09  5.1830124e-08  5.1830127e-09
  4.5351358e-09  0.0000000e+00  0.0000000e+00  1.3605408e-08
  0.0000000e+00  0.0000000e+00 -5.1830127e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4252069e+00  4.9700828e+00 -3.0352461e-09  2.4281968e-09
 -6.0704919e-10  1.2140984e-09  0.0000000e+00  0.0000000e+00
 -3.6422954e-09 -6.0704921e-09  8.4986889e-09  9.7127870e-09
 -2.4281968e-09  1.3962132e-08  1.2140984e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.4281968e-09]
2025-06-03 11:14:29,786 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0071
2025-06-03 11:14:29,786 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:29,786 - INFO - Running anomaly detection...
2025-06-03 11:14:29,786 - INFO - Starting anomaly detection.
2025-06-03 11:14:29,795 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111429_update_19.json
2025-06-03 11:14:29,795 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:29,802 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111429_update_19.pth and as latest_checkpoint.pth
2025-06-03 11:14:29,802 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.1815
2025-06-03 11:14:29,802 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:29,802 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:29,802 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.5197, MLP Score: 1.0000
2025-06-03 11:14:29,802 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.6607, MLP Score: 1.0000
2025-06-03 11:14:29,802 - WARNING -   Source: 192.168.27.12, Target: 3.5.138.228, Recon Error: 1.5695, MLP Score: 1.0000
2025-06-03 11:14:29,802 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.8736, MLP Score: 1.0000
2025-06-03 11:14:29,802 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.9982, MLP Score: 1.0000
2025-06-03 11:14:29,802 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-03 11:14:29,802 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-03 11:14:29,802 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot file.
2025-06-03 11:14:29,818 - INFO - Parsed 762 nodes.
2025-06-03 11:14:29,834 - INFO - Parsed 1619 edges.
2025-06-03 11:14:30,206 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:30,206 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:30,220 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-03 11:14:30,221 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:30,222 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-03 11:14:30,223 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-03 11:14:30,223 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:30,232 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:30,233 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:30,234 - DEBUG - Shape of encoded categorical edge features: torch.Size([1619, 2])
2025-06-03 11:14:30,236 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:30,236 - DEBUG - Shape of scaled numerical edge features: torch.Size([1619, 20])
2025-06-03 11:14:30,236 - DEBUG - Final edge attributes tensor shape: torch.Size([1619, 22])
2025-06-03 11:14:30,236 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:30,236 - INFO - Performing online update...
2025-06-03 11:14:30,236 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:30,237 - DEBUG - Updated RunningStats: new_mean=0.7776988457972046, new_var=41400000000018.27, new_n=4170
2025-06-03 11:14:30,237 - DEBUG - Updated RunningStats: new_mean=0.776670634885245, new_var=41700000000007.59, new_n=4200
2025-06-03 11:14:30,237 - DEBUG - Updated RunningStats: new_mean=0.9744698115252602, new_var=18120000000035.33, new_n=1834
2025-06-03 11:14:30,237 - DEBUG - Updated RunningStats: new_mean=0.9749324751968513, new_var=18340000000000.887, new_n=1856
2025-06-03 11:14:30,237 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:30,238 - DEBUG - Online update step: 1/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 2/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 3/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 4/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 5/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 6/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 7/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 8/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 9/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 10/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 11/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 12/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 13/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 14/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 15/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 16/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 17/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 18/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 19/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 20/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 21/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 22/50
2025-06-03 11:14:30,238 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,238 - DEBUG - Online update step: 23/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 24/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 25/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 26/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 27/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 28/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 29/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 30/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 31/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 32/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 33/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 34/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 35/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 36/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 37/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 38/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 39/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 40/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 41/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 42/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 43/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 44/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 45/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,239 - DEBUG - Online update step: 46/50
2025-06-03 11:14:30,239 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,240 - DEBUG - Online update step: 47/50
2025-06-03 11:14:30,240 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,240 - DEBUG - Online update step: 48/50
2025-06-03 11:14:30,240 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,240 - DEBUG - Online update step: 49/50
2025-06-03 11:14:30,240 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,240 - DEBUG - Online update step: 50/50
2025-06-03 11:14:30,240 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,240 - WARNING - No successful steps during online update.
2025-06-03 11:14:30,240 - DEBUG - Current node mean: [-6.4454369e-08  6.4454369e-08 -6.8834760e-09  7.5092466e-09
 -6.0699740e-08 -5.0061644e-08 -2.1901970e-08 -2.2840625e-08
 -1.6270034e-08  4.1300858e-08  1.8773116e-09 -7.1963613e-09
  8.1350171e-09 -8.7607877e-09  3.0036986e-08 -8.7607877e-09
  1.3766952e-08  0.0000000e+00  0.0000000e+00 -1.5644265e-08
  0.0000000e+00  0.0000000e+00 -2.3779281e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.42001235e+00  4.97591114e+00  1.17810295e-09 -1.47262869e-09
 -1.47262869e-09 -1.17810295e-09 -8.83577211e-10 -1.17810295e-09
  0.00000000e+00 -8.24672064e-09  1.76715442e-08 -3.53430885e-09
 -2.35620590e-09  1.17810295e-08  7.06861769e-09  1.17810295e-09
  1.17810295e-09  1.17810295e-09  1.17810295e-09  1.17810295e-09
  1.17810295e-09  0.00000000e+00]
2025-06-03 11:14:30,240 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0102
2025-06-03 11:14:30,241 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:30,241 - INFO - Running anomaly detection...
2025-06-03 11:14:30,241 - INFO - Starting anomaly detection.
2025-06-03 11:14:30,253 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111430_update_20.json
2025-06-03 11:14:30,254 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:30,261 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111430_update_20.pth and as latest_checkpoint.pth
2025-06-03 11:14:30,262 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.1665
2025-06-03 11:14:30,262 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:30,262 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:30,263 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.0703, MLP Score: 1.0000
2025-06-03 11:14:30,263 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.4826, MLP Score: 1.0000
2025-06-03 11:14:30,263 - WARNING -   Source: 192.168.27.12, Target: 3.5.138.228, Recon Error: 1.5545, MLP Score: 1.0000
2025-06-03 11:14:30,263 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.5396, MLP Score: 1.0000
2025-06-03 11:14:30,263 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7829, MLP Score: 1.0000
2025-06-03 11:14:30,263 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-03 11:14:30,263 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-03 11:14:30,263 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot file.
2025-06-03 11:14:30,282 - INFO - Parsed 768 nodes.
2025-06-03 11:14:30,298 - INFO - Parsed 1644 edges.
2025-06-03 11:14:30,687 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:30,688 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:30,703 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-03 11:14:30,705 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:30,705 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-03 11:14:30,707 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-03 11:14:30,707 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:30,717 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:30,718 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:30,720 - DEBUG - Shape of encoded categorical edge features: torch.Size([1644, 2])
2025-06-03 11:14:30,722 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:30,722 - DEBUG - Shape of scaled numerical edge features: torch.Size([1644, 20])
2025-06-03 11:14:30,723 - DEBUG - Final edge attributes tensor shape: torch.Size([1644, 22])
2025-06-03 11:14:30,723 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:30,723 - INFO - Performing online update...
2025-06-03 11:14:30,723 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:30,724 - DEBUG - Updated RunningStats: new_mean=0.7711623324767064, new_var=42000000000017.97, new_n=4230
2025-06-03 11:14:30,724 - DEBUG - Updated RunningStats: new_mean=0.7701946123300856, new_var=42300000000007.54, new_n=4260
2025-06-03 11:14:30,724 - DEBUG - Updated RunningStats: new_mean=0.9669201991752493, new_var=18560000000035.133, new_n=1878
2025-06-03 11:14:30,724 - DEBUG - Updated RunningStats: new_mean=0.9674567667816992, new_var=18780000000000.895, new_n=1900
2025-06-03 11:14:30,724 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:30,724 - DEBUG - Online update step: 1/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,724 - DEBUG - Online update step: 2/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,724 - DEBUG - Online update step: 3/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,724 - DEBUG - Online update step: 4/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,724 - DEBUG - Online update step: 5/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,724 - DEBUG - Online update step: 6/50
2025-06-03 11:14:30,724 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 7/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 8/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 9/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 10/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 11/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 12/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 13/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 14/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 15/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 16/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 17/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 18/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 19/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 20/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 21/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 22/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 23/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 24/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 25/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 26/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 27/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 28/50
2025-06-03 11:14:30,725 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,725 - DEBUG - Online update step: 29/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 30/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 31/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 32/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 33/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 34/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 35/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 36/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 37/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 38/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 39/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 40/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 41/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 42/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 43/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 44/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 45/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 46/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 47/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 48/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 49/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - DEBUG - Online update step: 50/50
2025-06-03 11:14:30,726 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:30,726 - WARNING - No successful steps during online update.
2025-06-03 11:14:30,727 - DEBUG - Current node mean: [ 2.2351742e-08 -2.2351742e-08 -2.4835268e-08 -9.9341078e-09
 -5.5879354e-09 -1.8626451e-08  5.1533181e-08  1.4901161e-08
  0.0000000e+00 -9.9341078e-09 -4.5324366e-08  2.7318796e-08
 -2.4835268e-08 -4.8428774e-08 -1.3038516e-08 -2.1109978e-08
  3.7252903e-09  0.0000000e+00  0.0000000e+00 -1.7384687e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4209245e+00  4.9805355e+00  0.0000000e+00 -2.3203754e-09
 -5.2208446e-09 -1.4502347e-09 -4.6407509e-09  4.6407509e-09
  5.8009388e-09  1.1601877e-09 -2.9004694e-09 -6.9611263e-09
  2.3203754e-09  2.2043567e-08  9.2815018e-09  2.0303286e-09
  2.0303286e-09  2.0303286e-09  2.0303286e-09  2.0303286e-09
  2.0303286e-09  2.9004693e-10]
2025-06-03 11:14:30,727 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0026
2025-06-03 11:14:30,727 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:30,728 - INFO - Running anomaly detection...
2025-06-03 11:14:30,728 - INFO - Starting anomaly detection.
2025-06-03 11:14:30,742 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111430_update_21.json
2025-06-03 11:14:30,742 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:30,751 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111430_update_21.pth and as latest_checkpoint.pth
2025-06-03 11:14:30,751 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.1651
2025-06-03 11:14:30,751 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:30,751 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:30,751 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.0396, MLP Score: 1.0000
2025-06-03 11:14:30,751 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.4590, MLP Score: 1.0000
2025-06-03 11:14:30,751 - WARNING -   Source: 192.168.27.12, Target: 3.5.138.228, Recon Error: 1.5581, MLP Score: 1.0000
2025-06-03 11:14:30,752 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.4244, MLP Score: 1.0000
2025-06-03 11:14:30,752 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7474, MLP Score: 1.0000
2025-06-03 11:14:30,752 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:30,752 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:30,752 - INFO - Starting visualization of node features.
2025-06-03 11:14:30,752 - INFO - Graph has 768 nodes and 30 features.
2025-06-03 11:14:30,752 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:30,752 - INFO - Calculating feature statistics:
2025-06-03 11:14:30,752 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.105997965), 'max': np.float32(9.687259)}
2025-06-03 11:14:30,752 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-9.687259), 'max': np.float32(0.105997965)}
2025-06-03 11:14:30,752 - INFO - - server_score: {'name': 'server_score', 'unique': 12, 'mean': np.float32(-2.4835268e-08), 'std': np.float32(1.0), 'min': np.float32(-2.392051), 'max': np.float32(3.151221)}
2025-06-03 11:14:30,752 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-2.483527e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.0812269), 'max': np.float32(15.652091)}
2025-06-03 11:14:30,752 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.65296793), 'max': np.float32(3.5086863)}
2025-06-03 11:14:30,752 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.6578672), 'max': np.float32(2.843299)}
2025-06-03 11:14:30,753 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 13, 'mean': np.float32(4.4703484e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.87836), 'max': np.float32(0.64384365)}
2025-06-03 11:14:30,753 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08533779), 'max': np.float32(18.204733)}
2025-06-03 11:14:30,753 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-4.346172e-09), 'std': np.float32(1.0), 'min': np.float32(-4.30874), 'max': np.float32(16.876358)}
2025-06-03 11:14:30,753 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(-5.5879354e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08556566), 'max': np.float32(12.881147)}
2025-06-03 11:14:30,753 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-3.973643e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0214314), 'max': np.float32(0.93711716)}
2025-06-03 11:14:30,753 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(3.1664968e-08), 'std': np.float32(1.0), 'min': np.float32(-0.09957739), 'max': np.float32(10.844884)}
2025-06-03 11:14:30,753 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-6.829699e-09), 'std': np.float32(1.0), 'min': np.float32(-7.791958), 'max': np.float32(0.13066833)}
2025-06-03 11:14:30,753 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-2.1631608), 'max': np.float32(2.4454253)}
2025-06-03 11:14:30,753 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-2.3769374), 'max': np.float32(2.230049)}
2025-06-03 11:14:30,753 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 15, 'mean': np.float32(-2.2351742e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4336612), 'max': np.float32(3.3249848)}
2025-06-03 11:14:30,753 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 15, 'mean': np.float32(2.2351742e-08), 'std': np.float32(1.0), 'min': np.float32(-3.2294397), 'max': np.float32(1.4613175)}
2025-06-03 11:14:30,753 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,753 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,753 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(3.7252903e-09), 'std': np.float32(0.99999994), 'min': np.float32(-7.3491983), 'max': np.float32(0.15944108)}
2025-06-03 11:14:30,754 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(2.483527e-09), 'std': np.float32(1.0), 'min': np.float32(-4.0183797), 'max': np.float32(4.2381268)}
2025-06-03 11:14:30,754 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,754 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:30,770 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764ff9c530>
2025-06-03 11:14:30,916 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:31,158 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:31,188 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:32,394 - INFO - Node feature visualization saved to vis/node_features_20250603_111431.png
2025-06-03 11:14:32,395 - INFO - Finished visualization of node features.
2025-06-03 11:14:32,395 - INFO - Performing additional feature analysis:
2025-06-03 11:14:32,395 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:32,395 - INFO - Starting visualization of edge features.
2025-06-03 11:14:32,395 - INFO - Graph has 1644 edges and 22 edge features.
2025-06-03 11:14:32,395 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:32,395 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:32,395 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-03 11:14:32,395 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-03 11:14:32,395 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot file.
2025-06-03 11:14:32,413 - INFO - Parsed 780 nodes.
2025-06-03 11:14:32,428 - INFO - Parsed 1667 edges.
2025-06-03 11:14:32,829 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:32,829 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:32,842 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-03 11:14:32,844 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:32,844 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-03 11:14:32,845 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-03 11:14:32,845 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:32,853 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:32,855 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:32,856 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 2])
2025-06-03 11:14:32,857 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:32,858 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 20])
2025-06-03 11:14:32,858 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 22])
2025-06-03 11:14:32,858 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:32,858 - INFO - Performing online update...
2025-06-03 11:14:32,858 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:32,859 - DEBUG - Updated RunningStats: new_mean=0.7648086360262125, new_var=42600000000017.67, new_n=4290
2025-06-03 11:14:32,859 - DEBUG - Updated RunningStats: new_mean=0.763898435094828, new_var=42900000000007.49, new_n=4320
2025-06-03 11:14:32,859 - DEBUG - Updated RunningStats: new_mean=0.9597096659194386, new_var=19000000000034.863, new_n=1922
2025-06-03 11:14:32,859 - DEBUG - Updated RunningStats: new_mean=0.9603187407046647, new_var=19220000000000.92, new_n=1944
2025-06-03 11:14:32,859 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:32,859 - DEBUG - Online update step: 1/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 2/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 3/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 4/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 5/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 6/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 7/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,859 - DEBUG - Online update step: 8/50
2025-06-03 11:14:32,859 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 9/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 10/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 11/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 12/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 13/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 14/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 15/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 16/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 17/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 18/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 19/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 20/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 21/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 22/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 23/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 24/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 25/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 26/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 27/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 28/50
2025-06-03 11:14:32,860 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,860 - DEBUG - Online update step: 29/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 30/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 31/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 32/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 33/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 34/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 35/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 36/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 37/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 38/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 39/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 40/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 41/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 42/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 43/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 44/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 45/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 46/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 47/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 48/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 49/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - DEBUG - Online update step: 50/50
2025-06-03 11:14:32,861 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:32,861 - WARNING - No successful steps during online update.
2025-06-03 11:14:32,862 - DEBUG - Current node mean: [-7.3359563e-09  7.3359563e-09 -6.1132970e-09  2.4453188e-09
  2.4453188e-09 -2.6898507e-08 -3.0566486e-08  9.7812753e-09
 -6.1132971e-10  0.0000000e+00  1.9562551e-08 -9.7812753e-09
  3.9125101e-08 -3.8895852e-08  2.3612609e-08  2.4453188e-09
  4.8906377e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  3.4845794e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4199160e+00  4.9742050e+00  5.1488116e-09  5.7209015e-10
  5.7209015e-10 -1.1441803e-09  5.4348566e-09  8.5813529e-10
 -2.2883606e-09 -9.1534424e-09 -6.8650823e-09  5.1488116e-09
 -7.4371722e-09 -2.4027788e-08 -6.8650823e-09  5.7209015e-10
  5.7209015e-10  5.7209015e-10  5.7209015e-10  5.7209015e-10
  5.7209015e-10 -2.2883606e-09]
2025-06-03 11:14:32,862 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0036
2025-06-03 11:14:32,862 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:32,863 - INFO - Running anomaly detection...
2025-06-03 11:14:32,863 - INFO - Starting anomaly detection.
2025-06-03 11:14:32,872 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111432_update_22.json
2025-06-03 11:14:32,872 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:32,878 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111432_update_22.pth and as latest_checkpoint.pth
2025-06-03 11:14:32,879 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.1544
2025-06-03 11:14:32,879 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:32,879 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:32,879 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.9480, MLP Score: 1.0000
2025-06-03 11:14:32,879 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.3964, MLP Score: 1.0000
2025-06-03 11:14:32,879 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0478, MLP Score: 1.0000
2025-06-03 11:14:32,879 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6019, MLP Score: 1.0000
2025-06-03 11:14:32,879 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4840, MLP Score: 1.0000
2025-06-03 11:14:32,879 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-03 11:14:32,879 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-03 11:14:32,879 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot file.
2025-06-03 11:14:32,897 - INFO - Parsed 799 nodes.
2025-06-03 11:14:32,914 - INFO - Parsed 1718 edges.
2025-06-03 11:14:33,321 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:33,321 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:33,334 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-03 11:14:33,336 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:33,336 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-03 11:14:33,337 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-03 11:14:33,337 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:33,346 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:33,347 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:33,348 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 2])
2025-06-03 11:14:33,350 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:33,350 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 20])
2025-06-03 11:14:33,350 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 22])
2025-06-03 11:14:33,350 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:33,350 - INFO - Performing online update...
2025-06-03 11:14:33,351 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:33,351 - DEBUG - Updated RunningStats: new_mean=0.7586301700152105, new_var=43200000000017.38, new_n=4350
2025-06-03 11:14:33,351 - DEBUG - Updated RunningStats: new_mean=0.7577746895773404, new_var=43500000000007.44, new_n=4380
2025-06-03 11:14:33,351 - DEBUG - Updated RunningStats: new_mean=0.9528245741183967, new_var=19440000000034.65, new_n=1966
2025-06-03 11:14:33,352 - DEBUG - Updated RunningStats: new_mean=0.9534959798703959, new_var=19660000000000.934, new_n=1988
2025-06-03 11:14:33,352 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:33,352 - DEBUG - Online update step: 1/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 2/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 3/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 4/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 5/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 6/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 7/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 8/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 9/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 10/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 11/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 12/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 13/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 14/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 15/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 16/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 17/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 18/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,352 - DEBUG - Online update step: 19/50
2025-06-03 11:14:33,352 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 20/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 21/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 22/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 23/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 24/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 25/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 26/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 27/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 28/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 29/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 30/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 31/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 32/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 33/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 34/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 35/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 36/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 37/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 38/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 39/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 40/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 41/50
2025-06-03 11:14:33,353 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,353 - DEBUG - Online update step: 42/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 43/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 44/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 45/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 46/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 47/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 48/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 49/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - DEBUG - Online update step: 50/50
2025-06-03 11:14:33,354 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,354 - WARNING - No successful steps during online update.
2025-06-03 11:14:33,355 - DEBUG - Current node mean: [ 1.6113395e-08 -1.6113395e-08 -2.5662075e-08 -6.5647168e-09
  1.4323018e-08  3.1629998e-08  1.4696014e-08  2.3871698e-08
  1.4323018e-08 -2.6855659e-08  2.0887736e-08 -1.2532642e-08
  5.9679244e-09  3.5807546e-09 -2.7452453e-08 -1.9544952e-08
  1.2681840e-08  0.0000000e+00  0.0000000e+00 -2.6258867e-08
  0.0000000e+00  0.0000000e+00 -4.0581885e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4202561e+00  4.9732246e+00 -1.1102146e-09  1.1102146e-09
 -2.2204292e-09 -1.1102146e-09 -5.5510729e-10 -3.8857508e-09
  4.9959654e-09  4.4408583e-09  5.5510729e-10  3.8857508e-09
 -8.0490556e-09 -6.6612875e-09  1.5543003e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  2.2204292e-09]
2025-06-03 11:14:33,355 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0007
2025-06-03 11:14:33,355 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:33,355 - INFO - Running anomaly detection...
2025-06-03 11:14:33,356 - INFO - Starting anomaly detection.
2025-06-03 11:14:33,367 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111433_update_23.json
2025-06-03 11:14:33,368 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:33,374 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111433_update_23.pth and as latest_checkpoint.pth
2025-06-03 11:14:33,374 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.2473
2025-06-03 11:14:33,374 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:33,374 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:33,374 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.9717, MLP Score: 1.0000
2025-06-03 11:14:33,374 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.4135, MLP Score: 1.0000
2025-06-03 11:14:33,374 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.1592, MLP Score: 1.0000
2025-06-03 11:14:33,374 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7053, MLP Score: 1.0000
2025-06-03 11:14:33,374 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4960, MLP Score: 1.0000
2025-06-03 11:14:33,374 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-03 11:14:33,374 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-03 11:14:33,374 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot file.
2025-06-03 11:14:33,394 - INFO - Parsed 805 nodes.
2025-06-03 11:14:33,408 - INFO - Parsed 1734 edges.
2025-06-03 11:14:33,800 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:33,801 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:33,813 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-03 11:14:33,814 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:33,815 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-03 11:14:33,816 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-03 11:14:33,816 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:33,823 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:33,824 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:33,826 - DEBUG - Shape of encoded categorical edge features: torch.Size([1734, 2])
2025-06-03 11:14:33,827 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:33,828 - DEBUG - Shape of scaled numerical edge features: torch.Size([1734, 20])
2025-06-03 11:14:33,828 - DEBUG - Final edge attributes tensor shape: torch.Size([1734, 22])
2025-06-03 11:14:33,828 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:33,828 - INFO - Performing online update...
2025-06-03 11:14:33,828 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:33,829 - DEBUG - Updated RunningStats: new_mean=0.7526197597317167, new_var=43800000000017.11, new_n=4410
2025-06-03 11:14:33,829 - DEBUG - Updated RunningStats: new_mean=0.7518164307181385, new_var=44100000000007.4, new_n=4440
2025-06-03 11:14:33,829 - DEBUG - Updated RunningStats: new_mean=0.946241604596455, new_var=19880000000034.49, new_n=2010
2025-06-03 11:14:33,829 - DEBUG - Updated RunningStats: new_mean=0.9469686051665696, new_var=20100000000000.95, new_n=2032
2025-06-03 11:14:33,829 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:33,829 - DEBUG - Online update step: 1/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 2/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 3/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 4/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 5/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 6/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,829 - DEBUG - Online update step: 7/50
2025-06-03 11:14:33,829 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 8/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 9/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 10/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 11/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 12/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 13/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 14/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 15/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 16/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 17/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 18/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 19/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 20/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 21/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 22/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 23/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 24/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 25/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 26/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 27/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 28/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 29/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 30/50
2025-06-03 11:14:33,830 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,830 - DEBUG - Online update step: 31/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 32/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 33/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 34/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 35/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 36/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 37/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 38/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 39/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 40/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 41/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 42/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 43/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 44/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 45/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 46/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 47/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 48/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 49/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - DEBUG - Online update step: 50/50
2025-06-03 11:14:33,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:33,831 - WARNING - No successful steps during online update.
2025-06-03 11:14:33,832 - DEBUG - Current node mean: [ 1.1254541e-08 -1.1254541e-08  2.6063150e-08  4.7387543e-09
  7.1081314e-09 -1.1846886e-09 -8.2928198e-09 -1.6585640e-08
 -4.7387543e-09  1.7770329e-09  1.1846886e-08 -1.1846886e-08
  2.0139707e-08 -7.1081314e-09  4.9756920e-08  1.8955017e-08
  2.3693771e-09  0.0000000e+00  0.0000000e+00 -2.4878460e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4175317e+00  4.9780855e+00 -5.4998517e-10 -5.4998517e-09
  0.0000000e+00  0.0000000e+00  6.5998225e-09  0.0000000e+00
 -2.1999407e-09  1.6499556e-09 -1.2649659e-08  6.5998225e-09
  6.5998225e-09  1.2099674e-08 -1.3199645e-08  1.0999703e-09
  1.0999703e-09  1.0999703e-09  1.0999703e-09  1.0999703e-09
  1.0999703e-09  3.8498964e-09]
2025-06-03 11:14:33,832 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0054
2025-06-03 11:14:33,832 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:33,832 - INFO - Running anomaly detection...
2025-06-03 11:14:33,832 - INFO - Starting anomaly detection.
2025-06-03 11:14:33,842 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111433_update_24.json
2025-06-03 11:14:33,842 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:33,849 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111433_update_24.pth and as latest_checkpoint.pth
2025-06-03 11:14:33,849 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.2364
2025-06-03 11:14:33,849 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:33,849 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:33,849 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.7767, MLP Score: 1.0000
2025-06-03 11:14:33,849 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.2644, MLP Score: 1.0000
2025-06-03 11:14:33,849 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7839, MLP Score: 1.0000
2025-06-03 11:14:33,849 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.4057, MLP Score: 1.0000
2025-06-03 11:14:33,849 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4990, MLP Score: 1.0000
2025-06-03 11:14:33,849 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-03 11:14:33,849 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-03 11:14:33,849 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot file.
2025-06-03 11:14:33,867 - INFO - Parsed 818 nodes.
2025-06-03 11:14:33,882 - INFO - Parsed 1761 edges.
2025-06-03 11:14:34,280 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:34,280 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:34,295 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-03 11:14:34,296 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:34,296 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-03 11:14:34,297 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-03 11:14:34,297 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:34,305 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:34,306 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:34,307 - DEBUG - Shape of encoded categorical edge features: torch.Size([1761, 2])
2025-06-03 11:14:34,308 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:34,309 - DEBUG - Shape of scaled numerical edge features: torch.Size([1761, 20])
2025-06-03 11:14:34,309 - DEBUG - Final edge attributes tensor shape: torch.Size([1761, 22])
2025-06-03 11:14:34,309 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:34,309 - INFO - Performing online update...
2025-06-03 11:14:34,309 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:34,310 - DEBUG - Updated RunningStats: new_mean=0.7467706828692834, new_var=44400000000016.84, new_n=4470
2025-06-03 11:14:34,310 - DEBUG - Updated RunningStats: new_mean=0.7460170169787359, new_var=44700000000007.36, new_n=4500
2025-06-03 11:14:34,310 - DEBUG - Updated RunningStats: new_mean=0.9399426728473446, new_var=20320000000034.36, new_n=2054
2025-06-03 11:14:34,310 - DEBUG - Updated RunningStats: new_mean=0.9407174862146963, new_var=20540000000000.957, new_n=2076
2025-06-03 11:14:34,310 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:34,310 - DEBUG - Online update step: 1/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 2/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 3/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 4/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 5/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 6/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 7/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 8/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 9/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 10/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 11/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,310 - DEBUG - Online update step: 12/50
2025-06-03 11:14:34,310 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 13/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 14/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 15/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 16/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 17/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 18/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 19/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 20/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 21/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 22/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 23/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 24/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 25/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 26/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 27/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 28/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 29/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 30/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 31/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 32/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 33/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 34/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 35/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 36/50
2025-06-03 11:14:34,311 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,311 - DEBUG - Online update step: 37/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 38/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 39/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 40/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 41/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 42/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 43/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 44/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 45/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 46/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 47/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 48/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 49/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - DEBUG - Online update step: 50/50
2025-06-03 11:14:34,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,312 - WARNING - No successful steps during online update.
2025-06-03 11:14:34,312 - DEBUG - Current node mean: [ 2.3317220e-08 -2.3317220e-08  3.0312385e-08  5.8293054e-10
  1.9819637e-08  5.8293050e-09 -2.6814803e-08  9.3268886e-09
 -5.2463744e-09  8.1610274e-09 -3.6141692e-08 -1.8945242e-08
  1.0638482e-08 -1.2824471e-08 -4.6634443e-09  1.7487915e-08
 -2.2151360e-08  0.0000000e+00  0.0000000e+00  3.6141692e-08
  0.0000000e+00  0.0000000e+00  2.5648943e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4168086e+00  4.9852357e+00 -4.3324215e-09  1.6246581e-09
  3.7908690e-09 -1.6246581e-09  2.7077636e-09 -2.1662108e-09
 -1.6246581e-09 -4.3324215e-09  2.8160741e-08 -4.7385860e-09
  1.0831054e-09  2.7077636e-09 -2.1662108e-09  2.4369873e-09
  2.4369873e-09  2.4369873e-09  2.4369873e-09  2.4369873e-09
  2.4369873e-09  0.0000000e+00]
2025-06-03 11:14:34,313 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0040
2025-06-03 11:14:34,313 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:34,313 - INFO - Running anomaly detection...
2025-06-03 11:14:34,313 - INFO - Starting anomaly detection.
2025-06-03 11:14:34,322 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111434_update_25.json
2025-06-03 11:14:34,322 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:34,329 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111434_update_25.pth and as latest_checkpoint.pth
2025-06-03 11:14:34,329 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.2318
2025-06-03 11:14:34,329 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:34,329 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:34,329 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.4908, MLP Score: 1.0000
2025-06-03 11:14:34,329 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 2.1233, MLP Score: 1.0000
2025-06-03 11:14:34,329 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.4269, MLP Score: 1.0000
2025-06-03 11:14:34,329 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.1345, MLP Score: 1.0000
2025-06-03 11:14:34,329 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5077, MLP Score: 1.0000
2025-06-03 11:14:34,329 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-03 11:14:34,329 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-03 11:14:34,329 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot file.
2025-06-03 11:14:34,348 - INFO - Parsed 836 nodes.
2025-06-03 11:14:34,365 - INFO - Parsed 1786 edges.
2025-06-03 11:14:34,799 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:34,799 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:34,813 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-03 11:14:34,815 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:34,815 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-03 11:14:34,816 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-03 11:14:34,816 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:34,824 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:34,825 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:34,827 - DEBUG - Shape of encoded categorical edge features: torch.Size([1786, 2])
2025-06-03 11:14:34,829 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:34,829 - DEBUG - Shape of scaled numerical edge features: torch.Size([1786, 20])
2025-06-03 11:14:34,829 - DEBUG - Final edge attributes tensor shape: torch.Size([1786, 22])
2025-06-03 11:14:34,829 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:34,829 - INFO - Performing online update...
2025-06-03 11:14:34,830 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:34,830 - DEBUG - Updated RunningStats: new_mean=0.7410765069484941, new_var=45000000000016.586, new_n=4530
2025-06-03 11:14:34,830 - DEBUG - Updated RunningStats: new_mean=0.7403701646036452, new_var=45300000000007.32, new_n=4560
2025-06-03 11:14:34,830 - DEBUG - Updated RunningStats: new_mean=0.933905508377968, new_var=20760000000034.227, new_n=2098
2025-06-03 11:14:34,830 - DEBUG - Updated RunningStats: new_mean=0.934726112186441, new_var=20980000000000.977, new_n=2120
2025-06-03 11:14:34,830 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:34,830 - DEBUG - Online update step: 1/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 2/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 3/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 4/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 5/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 6/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 7/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 8/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 9/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 10/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 11/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 12/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 13/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 14/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 15/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 16/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 17/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 18/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 19/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 20/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 21/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 22/50
2025-06-03 11:14:34,831 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,831 - DEBUG - Online update step: 23/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 24/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 25/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 26/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 27/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 28/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 29/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 30/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 31/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 32/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 33/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 34/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 35/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 36/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 37/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 38/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 39/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 40/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 41/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 42/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 43/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 44/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 45/50
2025-06-03 11:14:34,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,832 - DEBUG - Online update step: 46/50
2025-06-03 11:14:34,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,833 - DEBUG - Online update step: 47/50
2025-06-03 11:14:34,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,833 - DEBUG - Online update step: 48/50
2025-06-03 11:14:34,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,833 - DEBUG - Online update step: 49/50
2025-06-03 11:14:34,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,833 - DEBUG - Online update step: 50/50
2025-06-03 11:14:34,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:34,833 - WARNING - No successful steps during online update.
2025-06-03 11:14:34,833 - DEBUG - Current node mean: [-5.5326801e-08  5.5326801e-08  1.3689105e-08 -7.1297421e-09
 -7.9853111e-09 -2.2815174e-09 -4.7911868e-08 -8.0566087e-09
  9.6964490e-09  1.6541001e-08  6.8445525e-09  2.7948589e-08
  8.5556906e-10  6.8445525e-09  1.8252139e-08  9.1260697e-09
  1.0266829e-08  0.0000000e+00  0.0000000e+00 -5.1334146e-09
  0.0000000e+00  0.0000000e+00  3.0800486e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4137738e+00  4.9904814e+00  0.0000000e+00  0.0000000e+00
 -2.1358888e-09 -2.1358888e-09 -2.1358888e-09 -1.0679444e-09
  0.0000000e+00  3.2038332e-09  2.1358888e-08  5.3397220e-10
  2.6698610e-09  1.2815333e-08  1.3349305e-09  1.3349305e-09
  1.3349305e-09  1.3349305e-09  1.3349305e-09  1.3349305e-09
  1.3349305e-09  1.0679444e-09]
2025-06-03 11:14:34,833 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0060
2025-06-03 11:14:34,834 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:34,834 - INFO - Running anomaly detection...
2025-06-03 11:14:34,834 - INFO - Starting anomaly detection.
2025-06-03 11:14:34,843 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111434_update_26.json
2025-06-03 11:14:34,843 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:34,851 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111434_update_26.pth and as latest_checkpoint.pth
2025-06-03 11:14:34,851 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.2271
2025-06-03 11:14:34,851 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:34,851 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:34,852 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3345, MLP Score: 1.0000
2025-06-03 11:14:34,852 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.9828, MLP Score: 1.0000
2025-06-03 11:14:34,852 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.6645, MLP Score: 1.0000
2025-06-03 11:14:34,852 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.1475, MLP Score: 1.0000
2025-06-03 11:14:34,852 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5132, MLP Score: 1.0000
2025-06-03 11:14:34,852 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:34,852 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:34,852 - INFO - Starting visualization of node features.
2025-06-03 11:14:34,853 - INFO - Graph has 836 nodes and 30 features.
2025-06-03 11:14:34,853 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:34,853 - INFO - Calculating feature statistics:
2025-06-03 11:14:34,853 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-3.9926558e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10739667), 'max': np.float32(9.535928)}
2025-06-03 11:14:34,853 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(3.9926558e-08), 'std': np.float32(1.0), 'min': np.float32(-9.535928), 'max': np.float32(0.10739667)}
2025-06-03 11:14:34,853 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3503828), 'max': np.float32(3.121739)}
2025-06-03 11:14:34,853 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-9.12607e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.07962472), 'max': np.float32(16.384254)}
2025-06-03 11:14:34,853 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.6385997), 'max': np.float32(3.4839435)}
2025-06-03 11:14:34,854 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 15, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-0.64624476), 'max': np.float32(2.8718174)}
2025-06-03 11:14:34,854 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(-3.650428e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8944967), 'max': np.float32(0.6317122)}
2025-06-03 11:14:34,854 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-6.8445525e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.08299356), 'max': np.float32(18.016819)}
2025-06-03 11:14:34,854 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(3.4222762e-09), 'std': np.float32(1.0), 'min': np.float32(-4.44375), 'max': np.float32(17.409042)}
2025-06-03 11:14:34,854 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(2.0533658e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.08901521), 'max': np.float32(12.176297)}
2025-06-03 11:14:34,854 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-2.0395062), 'max': np.float32(0.9129791)}
2025-06-03 11:14:34,854 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(1.4829864e-08), 'std': np.float32(1.0), 'min': np.float32(-0.1015617), 'max': np.float32(10.528828)}
2025-06-03 11:14:34,854 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(2.851897e-09), 'std': np.float32(1.0), 'min': np.float32(-7.8218985), 'max': np.float32(0.12999508)}
2025-06-03 11:14:34,854 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(4.563035e-09), 'std': np.float32(1.0), 'min': np.float32(-2.3932526), 'max': np.float32(2.2174292)}
2025-06-03 11:14:34,854 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.135334), 'max': np.float32(2.476465)}
2025-06-03 11:14:34,855 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 18, 'mean': np.float32(2.2815174e-09), 'std': np.float32(1.0), 'min': np.float32(-1.5880083), 'max': np.float32(2.9164724)}
2025-06-03 11:14:34,855 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 18, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.8107755), 'max': np.float32(1.6221251)}
2025-06-03 11:14:34,855 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 11, 'mean': np.float32(-6.8445525e-09), 'std': np.float32(1.0), 'min': np.float32(-7.1788135), 'max': np.float32(0.16000512)}
2025-06-03 11:14:34,855 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 12, 'mean': np.float32(3.422276e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.9661887), 'max': np.float32(4.1211643)}
2025-06-03 11:14:34,855 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,855 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,856 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:34,867 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764f613350>
2025-06-03 11:14:34,993 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:35,209 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:35,235 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:36,506 - INFO - Node feature visualization saved to vis/node_features_20250603_111435.png
2025-06-03 11:14:36,506 - INFO - Finished visualization of node features.
2025-06-03 11:14:36,506 - INFO - Performing additional feature analysis:
2025-06-03 11:14:36,506 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:36,506 - INFO - Starting visualization of edge features.
2025-06-03 11:14:36,507 - INFO - Graph has 1786 edges and 22 edge features.
2025-06-03 11:14:36,507 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:36,507 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:36,507 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-03 11:14:36,507 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-03 11:14:36,507 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot file.
2025-06-03 11:14:36,530 - INFO - Parsed 845 nodes.
2025-06-03 11:14:36,551 - INFO - Parsed 1818 edges.
2025-06-03 11:14:37,090 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:37,090 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:37,111 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-03 11:14:37,112 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:37,112 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-03 11:14:37,116 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-03 11:14:37,117 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:37,132 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:37,134 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:37,136 - DEBUG - Shape of encoded categorical edge features: torch.Size([1818, 2])
2025-06-03 11:14:37,139 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:37,140 - DEBUG - Shape of scaled numerical edge features: torch.Size([1818, 20])
2025-06-03 11:14:37,141 - DEBUG - Final edge attributes tensor shape: torch.Size([1818, 22])
2025-06-03 11:14:37,141 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:37,141 - INFO - Performing online update...
2025-06-03 11:14:37,141 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:37,142 - DEBUG - Updated RunningStats: new_mean=0.7355311439284596, new_var=45600000000016.336, new_n=4590
2025-06-03 11:14:37,142 - DEBUG - Updated RunningStats: new_mean=0.7348699574184648, new_var=45900000000007.29, new_n=4620
2025-06-03 11:14:37,142 - DEBUG - Updated RunningStats: new_mean=0.9281189537994934, new_var=21200000000034.094, new_n=2142
2025-06-03 11:14:37,143 - DEBUG - Updated RunningStats: new_mean=0.9289786289316051, new_var=21420000000000.984, new_n=2164
2025-06-03 11:14:37,143 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:37,143 - DEBUG - Online update step: 1/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 2/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 3/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 4/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 5/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 6/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 7/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 8/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 9/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 10/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 11/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 12/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 13/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 14/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 15/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 16/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 17/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 18/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,143 - DEBUG - Online update step: 19/50
2025-06-03 11:14:37,143 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 20/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 21/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 22/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 23/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 24/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 25/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 26/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 27/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 28/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 29/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 30/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 31/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 32/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 33/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 34/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 35/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 36/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 37/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 38/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 39/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 40/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,144 - DEBUG - Online update step: 41/50
2025-06-03 11:14:37,144 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 42/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 43/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 44/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 45/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 46/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 47/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 48/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 49/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - DEBUG - Online update step: 50/50
2025-06-03 11:14:37,145 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,145 - WARNING - No successful steps during online update.
2025-06-03 11:14:37,145 - DEBUG - Current node mean: [ 3.1601044e-08 -3.1601044e-08  3.6115477e-08  3.3858261e-09
 -2.2572173e-08 -2.4829390e-08  2.9343825e-08 -1.1286087e-09
  1.3543304e-08  1.7493434e-08  2.0314955e-08  1.3543304e-08
 -4.1194216e-08  4.5144346e-09  2.2572173e-09  1.6364826e-08
 -4.5144346e-09  0.0000000e+00  0.0000000e+00  3.4563641e-09
  0.0000000e+00  0.0000000e+00 -2.7086609e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4174918e+00  4.9939494e+00  1.0491467e-09  2.0982933e-09
  1.0491467e-09 -5.2457332e-09 -4.1965866e-09 -2.0982933e-09
  2.6228666e-09  1.0491467e-09  8.3931733e-09  2.0982933e-09
  4.1965866e-09 -1.4688053e-08  1.3638907e-08 -2.0982933e-09
 -2.0982933e-09 -2.0982933e-09 -2.0982933e-09 -2.0982933e-09
 -2.0982933e-09 -1.0491467e-09]
2025-06-03 11:14:37,146 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0073
2025-06-03 11:14:37,146 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:37,146 - INFO - Running anomaly detection...
2025-06-03 11:14:37,147 - INFO - Starting anomaly detection.
2025-06-03 11:14:37,177 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111437_update_27.json
2025-06-03 11:14:37,177 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:37,186 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111437_update_27.pth and as latest_checkpoint.pth
2025-06-03 11:14:37,187 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.2254
2025-06-03 11:14:37,187 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:37,187 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:14:37,187 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.0794, MLP Score: 1.0000
2025-06-03 11:14:37,187 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.7747, MLP Score: 1.0000
2025-06-03 11:14:37,187 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.7476, MLP Score: 1.0000
2025-06-03 11:14:37,187 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.8356, MLP Score: 1.0000
2025-06-03 11:14:37,187 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5227, MLP Score: 1.0000
2025-06-03 11:14:37,187 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-03 11:14:37,187 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-03 11:14:37,187 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot file.
2025-06-03 11:14:37,212 - INFO - Parsed 866 nodes.
2025-06-03 11:14:37,233 - INFO - Parsed 1848 edges.
2025-06-03 11:14:37,788 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:37,788 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:37,807 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-03 11:14:37,809 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:37,810 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-03 11:14:37,812 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-03 11:14:37,812 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:37,824 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:37,825 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-03 11:14:37,827 - DEBUG - Shape of encoded categorical edge features: torch.Size([1848, 2])
2025-06-03 11:14:37,829 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:37,829 - DEBUG - Shape of scaled numerical edge features: torch.Size([1848, 20])
2025-06-03 11:14:37,830 - DEBUG - Final edge attributes tensor shape: torch.Size([1848, 22])
2025-06-03 11:14:37,830 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:37,830 - INFO - Performing online update...
2025-06-03 11:14:37,830 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:37,831 - DEBUG - Updated RunningStats: new_mean=0.730128860909281, new_var=46200000000016.09, new_n=4650
2025-06-03 11:14:37,831 - DEBUG - Updated RunningStats: new_mean=0.7295107228886709, new_var=46500000000007.25, new_n=4680
2025-06-03 11:14:37,832 - DEBUG - Updated RunningStats: new_mean=0.9225572671948831, new_var=21640000000033.887, new_n=2186
2025-06-03 11:14:37,832 - DEBUG - Updated RunningStats: new_mean=0.9234596452364998, new_var=21860000000001.027, new_n=2208
2025-06-03 11:14:37,832 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:37,832 - DEBUG - Online update step: 1/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 2/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 3/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 4/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 5/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 6/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 7/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 8/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 9/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,832 - DEBUG - Online update step: 10/50
2025-06-03 11:14:37,832 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 11/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 12/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 13/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 14/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 15/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 16/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 17/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 18/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 19/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 20/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 21/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 22/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 23/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 24/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 25/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 26/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 27/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 28/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 29/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 30/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 31/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 32/50
2025-06-03 11:14:37,833 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,833 - DEBUG - Online update step: 33/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 34/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 35/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 36/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 37/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 38/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 39/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 40/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 41/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 42/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 43/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 44/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 45/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 46/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 47/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 48/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 49/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - DEBUG - Online update step: 50/50
2025-06-03 11:14:37,834 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:37,834 - WARNING - No successful steps during online update.
2025-06-03 11:14:37,835 - DEBUG - Current node mean: [-5.1758306e-08  5.1758306e-08 -4.1021210e-08 -1.4316127e-08
 -3.6340939e-08 -1.0461785e-08 -1.7619849e-08  1.3214887e-08
  1.4316127e-08 -1.2664266e-08 -1.2113646e-08  3.1935976e-08
 -3.3037217e-09  3.3037217e-09  2.0372950e-08 -1.1012405e-08
  3.0834734e-08  0.0000000e+00  0.0000000e+00 -5.5062027e-10
  0.0000000e+00  0.0000000e+00  2.7531014e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4117966e+00  4.9886365e+00  1.0321151e-09  4.6445177e-09
  5.1605753e-10  5.1605753e-10 -4.1284602e-09 -1.0321151e-09
  0.0000000e+00  5.1605753e-10  2.5802876e-08 -5.1605755e-09
  0.0000000e+00 -8.7729779e-09 -1.3933553e-08  2.0642301e-09
  2.0642301e-09  2.0642301e-09  2.0642301e-09  2.0642301e-09
  2.0642301e-09  4.1284602e-09]
2025-06-03 11:14:37,835 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0112
2025-06-03 11:14:37,835 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:37,835 - INFO - Running anomaly detection...
2025-06-03 11:14:37,836 - INFO - Starting anomaly detection.
2025-06-03 11:14:37,855 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111437_update_28.json
2025-06-03 11:14:37,856 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:37,868 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111437_update_28.pth and as latest_checkpoint.pth
2025-06-03 11:14:37,868 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.2115
2025-06-03 11:14:37,868 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:37,868 - WARNING - Detected 12 anomalous edges (reconstruction-based):
2025-06-03 11:14:37,868 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.9971, MLP Score: 1.0000
2025-06-03 11:14:37,869 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.7035, MLP Score: 1.0000
2025-06-03 11:14:37,869 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 11.1470, MLP Score: 1.0000
2025-06-03 11:14:37,869 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.6158, MLP Score: 1.0000
2025-06-03 11:14:37,869 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5323, MLP Score: 1.0000
2025-06-03 11:14:37,869 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-03 11:14:37,869 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-03 11:14:37,869 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot file.
2025-06-03 11:14:37,891 - INFO - Parsed 894 nodes.
2025-06-03 11:14:37,909 - INFO - Parsed 1887 edges.
2025-06-03 11:14:38,501 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:38,501 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:38,521 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-03 11:14:38,522 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:38,523 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-03 11:14:38,525 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-03 11:14:38,525 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:38,535 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:38,536 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:38,538 - DEBUG - Shape of encoded categorical edge features: torch.Size([1887, 2])
2025-06-03 11:14:38,541 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:38,548 - DEBUG - Shape of scaled numerical edge features: torch.Size([1887, 20])
2025-06-03 11:14:38,555 - DEBUG - Final edge attributes tensor shape: torch.Size([1887, 22])
2025-06-03 11:14:38,555 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:38,555 - INFO - Performing online update...
2025-06-03 11:14:38,555 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:38,556 - DEBUG - Updated RunningStats: new_mean=0.7248641577775048, new_var=46800000000015.87, new_n=4710
2025-06-03 11:14:38,556 - DEBUG - Updated RunningStats: new_mean=0.7242870924870918, new_var=47100000000007.23, new_n=4740
2025-06-03 11:14:38,570 - DEBUG - Updated RunningStats: new_mean=0.9175308324915024, new_var=22080000000039.89, new_n=2230
2025-06-03 11:14:38,570 - DEBUG - Updated RunningStats: new_mean=0.9186383613450317, new_var=22300000000001.875, new_n=2252
2025-06-03 11:14:38,571 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:38,571 - DEBUG - Online update step: 1/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 2/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 3/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 4/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 5/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 6/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 7/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 8/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 9/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 10/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 11/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 12/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 13/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 14/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 15/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 16/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 17/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 18/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 19/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 20/50
2025-06-03 11:14:38,571 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,571 - DEBUG - Online update step: 21/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 22/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 23/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 24/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 25/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 26/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 27/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 28/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 29/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 30/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 31/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 32/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 33/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 34/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 35/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 36/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 37/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 38/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 39/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 40/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 41/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 42/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 43/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 44/50
2025-06-03 11:14:38,572 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,572 - DEBUG - Online update step: 45/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - DEBUG - Online update step: 46/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - DEBUG - Online update step: 47/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - DEBUG - Online update step: 48/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - DEBUG - Online update step: 49/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - DEBUG - Online update step: 50/50
2025-06-03 11:14:38,573 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:38,573 - WARNING - No successful steps during online update.
2025-06-03 11:14:38,576 - DEBUG - Current node mean: [-1.2800998e-08  1.2800998e-08 -4.0536491e-08 -4.2669992e-09
 -3.3069245e-08  1.0667498e-08  3.0935745e-08  8.5339984e-09
  8.5339984e-09 -1.8134747e-08  2.5601995e-08  7.4672482e-09
 -6.4004988e-09  4.2669992e-09 -2.3468495e-08 -1.0667498e-08
  8.5339984e-09  0.0000000e+00  0.0000000e+00  2.9868993e-08
  0.0000000e+00  0.0000000e+00  1.5201184e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4091150e+00  5.6857448e+00  3.0323508e-09  5.0539178e-10
 -5.0539178e-10  4.0431343e-09  6.0647016e-09 -3.0323508e-09
 -7.0754851e-09  2.5269589e-09  2.0721064e-08 -3.0323508e-09
  2.0215671e-09  2.9312725e-08 -6.0647016e-09  1.0107836e-09
  1.0107836e-09  1.0107836e-09  1.0107836e-09  1.0107836e-09
  1.0107836e-09  0.0000000e+00]
2025-06-03 11:14:38,577 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.3921
2025-06-03 11:14:38,577 - WARNING - Feature drift detected (1 consecutive)
2025-06-03 11:14:38,583 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:38,583 - INFO - Running anomaly detection...
2025-06-03 11:14:38,584 - INFO - Starting anomaly detection.
2025-06-03 11:14:38,783 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111438_update_29.json
2025-06-03 11:14:38,783 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:38,797 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111438_update_29.pth and as latest_checkpoint.pth
2025-06-03 11:14:38,797 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.2619
2025-06-03 11:14:38,797 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:38,797 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:38,798 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 1.9939, MLP Score: 1.0000
2025-06-03 11:14:38,798 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6975, MLP Score: 1.0000
2025-06-03 11:14:38,798 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 11.1127, MLP Score: 1.0000
2025-06-03 11:14:38,798 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7239, MLP Score: 1.0000
2025-06-03 11:14:38,798 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5445, MLP Score: 1.0000
2025-06-03 11:14:38,798 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-03 11:14:38,798 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-03 11:14:38,798 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot file.
2025-06-03 11:14:38,826 - INFO - Parsed 901 nodes.
2025-06-03 11:14:38,853 - INFO - Parsed 1907 edges.
2025-06-03 11:14:39,467 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:39,467 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:39,487 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-03 11:14:39,490 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:39,491 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-03 11:14:39,492 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-03 11:14:39,492 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:39,504 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:39,506 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:39,508 - DEBUG - Shape of encoded categorical edge features: torch.Size([1907, 2])
2025-06-03 11:14:39,509 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:39,510 - DEBUG - Shape of scaled numerical edge features: torch.Size([1907, 20])
2025-06-03 11:14:39,510 - DEBUG - Final edge attributes tensor shape: torch.Size([1907, 22])
2025-06-03 11:14:39,511 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:39,511 - INFO - Performing online update...
2025-06-03 11:14:39,511 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:39,512 - DEBUG - Updated RunningStats: new_mean=0.7197318277437341, new_var=47400000000015.64, new_n=4770
2025-06-03 11:14:39,512 - DEBUG - Updated RunningStats: new_mean=0.7191940355964859, new_var=47700000000007.195, new_n=4800
2025-06-03 11:14:39,513 - DEBUG - Updated RunningStats: new_mean=0.9128713949732163, new_var=22520000000039.793, new_n=2274
2025-06-03 11:14:39,513 - DEBUG - Updated RunningStats: new_mean=0.91400185392408, new_var=22740000000001.895, new_n=2296
2025-06-03 11:14:39,513 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:39,513 - DEBUG - Online update step: 1/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 2/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 3/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 4/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 5/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 6/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 7/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 8/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 9/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 10/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 11/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 12/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,513 - DEBUG - Online update step: 13/50
2025-06-03 11:14:39,513 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 14/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 15/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 16/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 17/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 18/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 19/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 20/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 21/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 22/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 23/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 24/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 25/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 26/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 27/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 28/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 29/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 30/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 31/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 32/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 33/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 34/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 35/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 36/50
2025-06-03 11:14:39,514 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,514 - DEBUG - Online update step: 37/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 38/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 39/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 40/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 41/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 42/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 43/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 44/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 45/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 46/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 47/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 48/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 49/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - DEBUG - Online update step: 50/50
2025-06-03 11:14:39,515 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:39,515 - WARNING - No successful steps during online update.
2025-06-03 11:14:39,516 - DEBUG - Current node mean: [-8.4676968e-09  8.4676968e-09 -6.3507724e-09 -4.2338484e-09
  3.7046173e-09  1.5876932e-08  3.1753864e-08  5.8215415e-09
  8.4676968e-09  1.6538470e-08 -1.0584621e-09 -2.1169241e-08
 -3.0695400e-08 -2.1169242e-09  7.4092346e-09 -3.4929247e-08
 -2.1169242e-09  0.0000000e+00  0.0000000e+00 -2.0110779e-08
  0.0000000e+00  0.0000000e+00 -1.7993855e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4074463e+00  5.6885161e+00  3.5006398e-09  1.0001828e-09
 -1.0001828e-09 -1.0001828e-09  4.0007313e-09 -2.0003657e-09
  2.3754343e-09  0.0000000e+00  0.0000000e+00  4.0007313e-09
  4.0007313e-09 -5.0009139e-09  1.2002194e-08 -1.0001828e-09
 -1.0001828e-09 -1.0001828e-09 -1.0001828e-09 -1.0001828e-09
 -1.0001828e-09 -1.0001828e-09]
2025-06-03 11:14:39,516 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0033
2025-06-03 11:14:39,516 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:39,516 - INFO - Running anomaly detection...
2025-06-03 11:14:39,517 - INFO - Starting anomaly detection.
2025-06-03 11:14:39,542 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111439_update_30.json
2025-06-03 11:14:39,543 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:39,553 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111439_update_30.pth and as latest_checkpoint.pth
2025-06-03 11:14:39,554 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.3092
2025-06-03 11:14:39,554 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:39,554 - WARNING - Detected 13 anomalous edges (reconstruction-based):
2025-06-03 11:14:39,555 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.0607, MLP Score: 1.0000
2025-06-03 11:14:39,555 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.7069, MLP Score: 1.0000
2025-06-03 11:14:39,555 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 11.1166, MLP Score: 1.0000
2025-06-03 11:14:39,555 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.7331, MLP Score: 1.0000
2025-06-03 11:14:39,555 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.5453, MLP Score: 1.0000
2025-06-03 11:14:39,555 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-03 11:14:39,555 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-03 11:14:39,555 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot file.
2025-06-03 11:14:39,578 - INFO - Parsed 914 nodes.
2025-06-03 11:14:39,601 - INFO - Parsed 1945 edges.
2025-06-03 11:14:40,229 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:40,229 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:40,248 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-03 11:14:40,250 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:40,250 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-03 11:14:40,252 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-03 11:14:40,252 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:40,267 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:40,268 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:40,271 - DEBUG - Shape of encoded categorical edge features: torch.Size([1945, 2])
2025-06-03 11:14:40,274 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:40,275 - DEBUG - Shape of scaled numerical edge features: torch.Size([1945, 20])
2025-06-03 11:14:40,275 - DEBUG - Final edge attributes tensor shape: torch.Size([1945, 22])
2025-06-03 11:14:40,275 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:40,275 - INFO - Performing online update...
2025-06-03 11:14:40,276 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:40,277 - DEBUG - Updated RunningStats: new_mean=0.7147269918690724, new_var=48000000000015.42, new_n=4830
2025-06-03 11:14:40,277 - DEBUG - Updated RunningStats: new_mean=0.7142267023961897, new_var=48300000000007.17, new_n=4860
2025-06-03 11:14:40,277 - DEBUG - Updated RunningStats: new_mean=0.908388660419811, new_var=22960000000039.64, new_n=2318
2025-06-03 11:14:40,277 - DEBUG - Updated RunningStats: new_mean=0.9095397883957379, new_var=23180000000001.914, new_n=2340
2025-06-03 11:14:40,277 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:40,277 - DEBUG - Online update step: 1/50
2025-06-03 11:14:40,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,277 - DEBUG - Online update step: 2/50
2025-06-03 11:14:40,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,277 - DEBUG - Online update step: 3/50
2025-06-03 11:14:40,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,277 - DEBUG - Online update step: 4/50
2025-06-03 11:14:40,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,277 - DEBUG - Online update step: 5/50
2025-06-03 11:14:40,277 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 6/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 7/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 8/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 9/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 10/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 11/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 12/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 13/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 14/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 15/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 16/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 17/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 18/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 19/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 20/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 21/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 22/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 23/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 24/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 25/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 26/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 27/50
2025-06-03 11:14:40,278 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,278 - DEBUG - Online update step: 28/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 29/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 30/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 31/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 32/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 33/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 34/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 35/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 36/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 37/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 38/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 39/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 40/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 41/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 42/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 43/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 44/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 45/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 46/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 47/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 48/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 49/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,279 - DEBUG - Online update step: 50/50
2025-06-03 11:14:40,279 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:40,280 - WARNING - No successful steps during online update.
2025-06-03 11:14:40,280 - DEBUG - Current node mean: [-2.6085183e-09  2.6085183e-09 -3.1302221e-08  1.9824739e-08
 -1.0694925e-08 -2.0085592e-08  2.7650294e-08 -9.9123696e-09
 -4.1736294e-09  8.5428979e-09 -3.6519257e-08 -2.9541470e-08
 -2.3998370e-08  2.6085184e-08 -7.3038513e-09 -1.4607703e-08
 -3.1302221e-08  0.0000000e+00  0.0000000e+00  1.6433665e-08
  0.0000000e+00  0.0000000e+00 -1.4607703e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4118252e+00  5.6848330e+00 -9.8064201e-10 -3.9225680e-09
  1.9612840e-09 -9.8064201e-10 -2.9419258e-09 -9.8064201e-10
  9.8064201e-10  8.8257774e-09  2.2187024e-08  1.9612840e-09
 -2.9419258e-09  7.8451361e-09 -1.3728988e-08 -7.3548145e-10
 -7.3548145e-10 -7.3548145e-10 -7.3548145e-10 -7.3548145e-10
 -7.3548145e-10  7.3548145e-10]
2025-06-03 11:14:40,280 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0087
2025-06-03 11:14:40,281 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:40,281 - INFO - Running anomaly detection...
2025-06-03 11:14:40,281 - INFO - Starting anomaly detection.
2025-06-03 11:14:40,298 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111440_update_31.json
2025-06-03 11:14:40,299 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:40,306 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111440_update_31.pth and as latest_checkpoint.pth
2025-06-03 11:14:40,306 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.3092
2025-06-03 11:14:40,306 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:40,306 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:40,306 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.0108, MLP Score: 1.0000
2025-06-03 11:14:40,306 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6637, MLP Score: 1.0000
2025-06-03 11:14:40,307 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.6872, MLP Score: 1.0000
2025-06-03 11:14:40,307 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.5740, MLP Score: 1.0000
2025-06-03 11:14:40,307 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4176, MLP Score: 1.0000
2025-06-03 11:14:40,307 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:40,307 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:40,307 - INFO - Starting visualization of node features.
2025-06-03 11:14:40,307 - INFO - Graph has 914 nodes and 30 features.
2025-06-03 11:14:40,307 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:40,307 - INFO - Calculating feature statistics:
2025-06-03 11:14:40,307 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11311445), 'max': np.float32(9.018767)}
2025-06-03 11:14:40,307 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-9.018767), 'max': np.float32(0.11311445)}
2025-06-03 11:14:40,308 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(-2.5041777e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2995923), 'max': np.float32(3.0884836)}
2025-06-03 11:14:40,308 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.8781332e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07977894), 'max': np.float32(17.155695)}
2025-06-03 11:14:40,308 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(1.0), 'min': np.float32(-0.62225133), 'max': np.float32(3.5596437)}
2025-06-03 11:14:40,308 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 15, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.62891865), 'max': np.float32(2.9409304)}
2025-06-03 11:14:40,308 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9485755), 'max': np.float32(0.61286527)}
2025-06-03 11:14:40,308 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-6.260444e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0835437), 'max': np.float32(18.616604)}
2025-06-03 11:14:40,308 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-4.1414895), 'max': np.float32(20.358973)}
2025-06-03 11:14:40,308 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.0976973), 'max': np.float32(10.889753)}
2025-06-03 11:14:40,308 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-5.0083553e-08), 'std': np.float32(1.0), 'min': np.float32(-2.046151), 'max': np.float32(0.8907357)}
2025-06-03 11:14:40,308 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-2.0868146e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10794602), 'max': np.float32(9.769954)}
2025-06-03 11:14:40,308 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-9.390666e-09), 'std': np.float32(1.0), 'min': np.float32(-7.627586), 'max': np.float32(0.13302284)}
2025-06-03 11:14:40,308 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.2145884), 'max': np.float32(2.0248365)}
2025-06-03 11:14:40,309 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(1.6694518e-08), 'std': np.float32(1.0), 'min': np.float32(-1.93445), 'max': np.float32(2.2855513)}
2025-06-03 11:14:40,309 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 20, 'mean': np.float32(-1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4036233), 'max': np.float32(2.6719344)}
2025-06-03 11:14:40,309 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 20, 'mean': np.float32(-1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-2.5599065), 'max': np.float32(1.4289318)}
2025-06-03 11:14:40,309 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 12, 'mean': np.float32(1.2520888e-08), 'std': np.float32(1.0), 'min': np.float32(-7.0711026), 'max': np.float32(0.15982148)}
2025-06-03 11:14:40,309 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 14, 'mean': np.float32(-1.6694518e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.9609456), 'max': np.float32(4.1400523)}
2025-06-03 11:14:40,309 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,309 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,310 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,310 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,310 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:40,323 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764dbf29c0>
2025-06-03 11:14:40,490 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:40,575 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:40,935 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:42,431 - INFO - Node feature visualization saved to vis/node_features_20250603_111441.png
2025-06-03 11:14:42,431 - INFO - Finished visualization of node features.
2025-06-03 11:14:42,431 - INFO - Performing additional feature analysis:
2025-06-03 11:14:42,431 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:42,432 - INFO - Starting visualization of edge features.
2025-06-03 11:14:42,432 - INFO - Graph has 1945 edges and 22 edge features.
2025-06-03 11:14:42,432 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:42,432 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:42,432 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-03 11:14:42,432 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-03 11:14:42,432 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot file.
2025-06-03 11:14:42,458 - INFO - Parsed 918 nodes.
2025-06-03 11:14:42,481 - INFO - Parsed 1958 edges.
2025-06-03 11:14:43,113 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:43,114 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:43,133 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-03 11:14:43,135 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:43,136 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-03 11:14:43,139 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-03 11:14:43,139 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:43,157 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:43,158 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:43,160 - DEBUG - Shape of encoded categorical edge features: torch.Size([1958, 2])
2025-06-03 11:14:43,163 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:43,163 - DEBUG - Shape of scaled numerical edge features: torch.Size([1958, 20])
2025-06-03 11:14:43,164 - DEBUG - Final edge attributes tensor shape: torch.Size([1958, 22])
2025-06-03 11:14:43,164 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:43,164 - INFO - Performing online update...
2025-06-03 11:14:43,164 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:43,165 - DEBUG - Updated RunningStats: new_mean=0.7098449434934848, new_var=48600000000015.21, new_n=4890
2025-06-03 11:14:43,165 - DEBUG - Updated RunningStats: new_mean=0.7093805144437102, new_var=48900000000007.15, new_n=4920
2025-06-03 11:14:43,165 - DEBUG - Updated RunningStats: new_mean=0.9040720151964033, new_var=23400000000039.53, new_n=2362
2025-06-03 11:14:43,165 - DEBUG - Updated RunningStats: new_mean=0.9052427258624931, new_var=23620000000001.945, new_n=2384
2025-06-03 11:14:43,166 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:43,166 - DEBUG - Online update step: 1/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 2/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 3/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 4/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 5/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 6/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 7/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 8/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 9/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 10/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 11/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 12/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 13/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 14/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 15/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 16/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 17/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 18/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 19/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 20/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 21/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,166 - DEBUG - Online update step: 22/50
2025-06-03 11:14:43,166 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 23/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 24/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 25/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 26/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 27/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 28/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 29/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 30/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 31/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 32/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 33/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 34/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 35/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 36/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 37/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 38/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 39/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 40/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 41/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 42/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 43/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 44/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 45/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 46/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 47/50
2025-06-03 11:14:43,167 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,167 - DEBUG - Online update step: 48/50
2025-06-03 11:14:43,168 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,168 - DEBUG - Online update step: 49/50
2025-06-03 11:14:43,168 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,168 - DEBUG - Online update step: 50/50
2025-06-03 11:14:43,168 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,168 - WARNING - No successful steps during online update.
2025-06-03 11:14:43,168 - DEBUG - Current node mean: [-8.3108871e-09  8.3108871e-09 -4.1554435e-09 -4.1554435e-09
  1.2466331e-08 -3.4282412e-08 -8.3108871e-09  1.2466331e-08
 -4.6748743e-09 -3.0126966e-08  6.4409377e-08 -3.1165829e-08
  2.2854939e-08 -9.3497485e-09  2.5452092e-08  3.8957286e-09
  5.9734502e-09  0.0000000e+00  0.0000000e+00  1.4284337e-08
  0.0000000e+00  0.0000000e+00  2.0777218e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4101124e+00  5.6848826e+00 -9.7413111e-10 -9.7413111e-10
  4.8706555e-10  1.9482622e-09 -5.8447864e-09 -3.8965244e-09
  7.7930489e-09  2.4353277e-09  4.1400572e-09 -9.7413111e-10
 -4.8706554e-09  3.4094587e-09  5.8447864e-09  2.9223932e-09
  2.9223932e-09  2.9223932e-09  2.9223932e-09  2.9223932e-09
  2.9223932e-09  0.0000000e+00]
2025-06-03 11:14:43,169 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0034
2025-06-03 11:14:43,169 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:43,169 - INFO - Running anomaly detection...
2025-06-03 11:14:43,170 - INFO - Starting anomaly detection.
2025-06-03 11:14:43,189 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111443_update_32.json
2025-06-03 11:14:43,189 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:43,200 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111443_update_32.pth and as latest_checkpoint.pth
2025-06-03 11:14:43,200 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.3015
2025-06-03 11:14:43,200 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:43,200 - WARNING - Detected 14 anomalous edges (reconstruction-based):
2025-06-03 11:14:43,200 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.1309, MLP Score: 1.0000
2025-06-03 11:14:43,200 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6127, MLP Score: 1.0000
2025-06-03 11:14:43,200 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.6754, MLP Score: 1.0000
2025-06-03 11:14:43,200 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.7136, MLP Score: 1.0000
2025-06-03 11:14:43,200 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4193, MLP Score: 1.0000
2025-06-03 11:14:43,200 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-03 11:14:43,200 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-03 11:14:43,200 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot file.
2025-06-03 11:14:43,224 - INFO - Parsed 922 nodes.
2025-06-03 11:14:43,245 - INFO - Parsed 1981 edges.
2025-06-03 11:14:43,876 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:43,876 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:43,895 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-03 11:14:43,896 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:43,897 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-03 11:14:43,898 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-03 11:14:43,898 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:43,911 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:43,913 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:43,915 - DEBUG - Shape of encoded categorical edge features: torch.Size([1981, 2])
2025-06-03 11:14:43,917 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:43,918 - DEBUG - Shape of scaled numerical edge features: torch.Size([1981, 20])
2025-06-03 11:14:43,918 - DEBUG - Final edge attributes tensor shape: torch.Size([1981, 22])
2025-06-03 11:14:43,918 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:43,918 - INFO - Performing online update...
2025-06-03 11:14:43,919 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:43,919 - DEBUG - Updated RunningStats: new_mean=0.7050812385981136, new_var=49200000000015.01, new_n=4950
2025-06-03 11:14:43,920 - DEBUG - Updated RunningStats: new_mean=0.7046510930480852, new_var=49500000000007.125, new_n=4980
2025-06-03 11:14:43,920 - DEBUG - Updated RunningStats: new_mean=0.8999127291383289, new_var=23840000000039.367, new_n=2406
2025-06-03 11:14:43,920 - DEBUG - Updated RunningStats: new_mean=0.9011014707888564, new_var=24060000000001.977, new_n=2428
2025-06-03 11:14:43,920 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:43,920 - DEBUG - Online update step: 1/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 2/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 3/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 4/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 5/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 6/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 7/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 8/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 9/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 10/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 11/50
2025-06-03 11:14:43,920 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,920 - DEBUG - Online update step: 12/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 13/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 14/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 15/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 16/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 17/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 18/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 19/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 20/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 21/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 22/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 23/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 24/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 25/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 26/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 27/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 28/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 29/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 30/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 31/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 32/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 33/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 34/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 35/50
2025-06-03 11:14:43,921 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,921 - DEBUG - Online update step: 36/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 37/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 38/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 39/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 40/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 41/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 42/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 43/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 44/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 45/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 46/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 47/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 48/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 49/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - DEBUG - Online update step: 50/50
2025-06-03 11:14:43,922 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:43,922 - WARNING - No successful steps during online update.
2025-06-03 11:14:43,923 - DEBUG - Current node mean: [-2.4824494e-08  2.4824494e-08  3.1030618e-09 -6.2061236e-09
 -1.1119305e-08  2.6376025e-08 -1.0343539e-08  2.0687079e-09
 -5.1717697e-09  1.6549663e-08  3.3616502e-08 -7.2404776e-09
 -2.9479088e-08  6.5293593e-09  1.3575895e-08  8.2748315e-09
 -9.8263619e-09  0.0000000e+00  0.0000000e+00 -2.6893202e-08
  0.0000000e+00  0.0000000e+00 -6.2061236e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4124180e+00  5.6789498e+00  9.6282116e-10  1.4442316e-09
  2.8884632e-09 -4.8141058e-10  1.4442316e-09  4.8141056e-09
 -9.6282116e-10  0.0000000e+00 -3.8512846e-09  3.8512846e-09
  4.0919899e-09  1.2516675e-08 -1.0109622e-08 -9.6282116e-10
 -9.6282116e-10 -9.6282116e-10 -9.6282116e-10 -9.6282116e-10
 -9.6282116e-10 -9.6282116e-10]
2025-06-03 11:14:43,923 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0046
2025-06-03 11:14:43,924 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:43,924 - INFO - Running anomaly detection...
2025-06-03 11:14:43,924 - INFO - Starting anomaly detection.
2025-06-03 11:14:43,943 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111443_update_33.json
2025-06-03 11:14:43,944 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:43,953 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111443_update_33.pth and as latest_checkpoint.pth
2025-06-03 11:14:43,954 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.3043
2025-06-03 11:14:43,954 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:43,954 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:43,954 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.2982, MLP Score: 1.0000
2025-06-03 11:14:43,954 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6089, MLP Score: 1.0000
2025-06-03 11:14:43,954 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.6653, MLP Score: 1.0000
2025-06-03 11:14:43,954 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.7719, MLP Score: 1.0000
2025-06-03 11:14:43,954 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4235, MLP Score: 1.0000
2025-06-03 11:14:43,954 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-03 11:14:43,954 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-03 11:14:43,954 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot file.
2025-06-03 11:14:43,978 - INFO - Parsed 934 nodes.
2025-06-03 11:14:43,999 - INFO - Parsed 2007 edges.
2025-06-03 11:14:44,617 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:44,617 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:44,639 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-03 11:14:44,641 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:44,641 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-03 11:14:44,643 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-03 11:14:44,643 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:44,656 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:44,658 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:44,661 - DEBUG - Shape of encoded categorical edge features: torch.Size([2007, 2])
2025-06-03 11:14:44,664 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:44,664 - DEBUG - Shape of scaled numerical edge features: torch.Size([2007, 20])
2025-06-03 11:14:44,665 - DEBUG - Final edge attributes tensor shape: torch.Size([2007, 22])
2025-06-03 11:14:44,665 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:44,665 - INFO - Performing online update...
2025-06-03 11:14:44,665 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:44,665 - DEBUG - Updated RunningStats: new_mean=0.7004316254211195, new_var=49800000000014.805, new_n=5010
2025-06-03 11:14:44,665 - DEBUG - Updated RunningStats: new_mean=0.7000342505003639, new_var=50100000000007.11, new_n=5040
2025-06-03 11:14:44,666 - DEBUG - Updated RunningStats: new_mean=0.8959055271989393, new_var=24280000000039.3, new_n=2450
2025-06-03 11:14:44,666 - DEBUG - Updated RunningStats: new_mean=0.8971080151975656, new_var=24500000000001.996, new_n=2472
2025-06-03 11:14:44,666 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:44,666 - DEBUG - Online update step: 1/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 2/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 3/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 4/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 5/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 6/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 7/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 8/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 9/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 10/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 11/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 12/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 13/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 14/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,666 - DEBUG - Online update step: 15/50
2025-06-03 11:14:44,666 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 16/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 17/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 18/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 19/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 20/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 21/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 22/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 23/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 24/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 25/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 26/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 27/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 28/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 29/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 30/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 31/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 32/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 33/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 34/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 35/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 36/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 37/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 38/50
2025-06-03 11:14:44,667 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,667 - DEBUG - Online update step: 39/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 40/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 41/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 42/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 43/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 44/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 45/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 46/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 47/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 48/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 49/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - DEBUG - Online update step: 50/50
2025-06-03 11:14:44,668 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:44,668 - WARNING - No successful steps during online update.
2025-06-03 11:14:44,669 - DEBUG - Current node mean: [ 4.0842583e-09 -4.0842583e-09 -1.2252775e-08 -2.4505550e-08
 -1.8379163e-08  8.6790486e-09 -2.6037148e-08  4.0842583e-09
  2.0421291e-08 -7.1474520e-09  3.6247794e-08  1.0210646e-08
 -1.2252775e-08  1.0210646e-08  5.1053228e-10  6.1263874e-09
  1.0210646e-08  0.0000000e+00  0.0000000e+00  1.3018574e-08
  0.0000000e+00  0.0000000e+00 -3.8800454e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4110613e+00  5.6831093e+00 -4.7517403e-09 -2.8510443e-09
 -3.8013925e-09  9.5034813e-10 -5.2269145e-09 -8.5531333e-09
 -2.1382833e-09 -4.2765667e-09 -5.2269145e-09 -9.5034813e-10
 -5.2269145e-09  2.8510443e-09  8.0779587e-09  3.8013925e-09
  3.8013925e-09  3.8013925e-09  3.8013925e-09  3.8013925e-09
  3.8013925e-09  0.0000000e+00]
2025-06-03 11:14:44,670 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0027
2025-06-03 11:14:44,670 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:44,670 - INFO - Running anomaly detection...
2025-06-03 11:14:44,671 - INFO - Starting anomaly detection.
2025-06-03 11:14:44,692 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111444_update_34.json
2025-06-03 11:14:44,692 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:44,702 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111444_update_34.pth and as latest_checkpoint.pth
2025-06-03 11:14:44,703 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.2933
2025-06-03 11:14:44,703 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:44,703 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:44,703 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.4052, MLP Score: 1.0000
2025-06-03 11:14:44,703 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6312, MLP Score: 1.0000
2025-06-03 11:14:44,704 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.5928, MLP Score: 1.0000
2025-06-03 11:14:44,704 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.8220, MLP Score: 1.0000
2025-06-03 11:14:44,704 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4299, MLP Score: 1.0000
2025-06-03 11:14:44,704 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-03 11:14:44,704 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-03 11:14:44,704 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot file.
2025-06-03 11:14:44,728 - INFO - Parsed 944 nodes.
2025-06-03 11:14:44,750 - INFO - Parsed 2034 edges.
2025-06-03 11:14:45,351 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:45,351 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:45,366 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-03 11:14:45,368 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:45,368 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-03 11:14:45,369 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-03 11:14:45,369 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:45,379 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:45,380 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:45,381 - DEBUG - Shape of encoded categorical edge features: torch.Size([2034, 2])
2025-06-03 11:14:45,383 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:45,383 - DEBUG - Shape of scaled numerical edge features: torch.Size([2034, 20])
2025-06-03 11:14:45,383 - DEBUG - Final edge attributes tensor shape: torch.Size([2034, 22])
2025-06-03 11:14:45,383 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:45,383 - INFO - Performing online update...
2025-06-03 11:14:45,384 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:45,384 - DEBUG - Updated RunningStats: new_mean=0.6958920359912955, new_var=50400000000014.62, new_n=5070
2025-06-03 11:14:45,384 - DEBUG - Updated RunningStats: new_mean=0.6955260184531596, new_var=50700000000007.09, new_n=5100
2025-06-03 11:14:45,384 - DEBUG - Updated RunningStats: new_mean=0.892040831369485, new_var=24720000000039.25, new_n=2494
2025-06-03 11:14:45,385 - DEBUG - Updated RunningStats: new_mean=0.8932536307055765, new_var=24940000000002.004, new_n=2516
2025-06-03 11:14:45,385 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:45,385 - DEBUG - Online update step: 1/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 2/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 3/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 4/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 5/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 6/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 7/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 8/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 9/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 10/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 11/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 12/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 13/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 14/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 15/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 16/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 17/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 18/50
2025-06-03 11:14:45,385 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,385 - DEBUG - Online update step: 19/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 20/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 21/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 22/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 23/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 24/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 25/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 26/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 27/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 28/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 29/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 30/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 31/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 32/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 33/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 34/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 35/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 36/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 37/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 38/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 39/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 40/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,386 - DEBUG - Online update step: 41/50
2025-06-03 11:14:45,386 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 42/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 43/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 44/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 45/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 46/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 47/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 48/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 49/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - DEBUG - Online update step: 50/50
2025-06-03 11:14:45,387 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:45,387 - WARNING - No successful steps during online update.
2025-06-03 11:14:45,387 - DEBUG - Current node mean: [ 6.0614891e-09 -6.0614891e-09 -1.5153723e-09 -1.8184467e-08
  3.8894555e-08 -6.0109770e-08  5.7584149e-08  9.0922336e-09
 -1.6163971e-08 -1.6163971e-08 -5.0512412e-09 -1.2122978e-08
 -6.0614891e-09  6.0614891e-09 -1.0102482e-08 -3.0307445e-09
 -3.0307445e-09  0.0000000e+00  0.0000000e+00 -1.6163971e-08
  0.0000000e+00  0.0000000e+00  1.0102482e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4105211e+00  5.6882987e+00 -2.3443321e-09 -1.4065993e-09
 -4.6886641e-09  2.3443321e-09  0.0000000e+00  4.6886641e-09
 -3.7509316e-09  4.6886645e-10  4.6886641e-09 -9.8461950e-09
 -2.1098989e-09 -6.5641301e-09  2.6256521e-08  1.4065993e-09
  1.4065993e-09  1.4065993e-09  1.4065993e-09  1.4065993e-09
  1.4065993e-09 -9.3773289e-10]
2025-06-03 11:14:45,388 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0024
2025-06-03 11:14:45,388 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:45,388 - INFO - Running anomaly detection...
2025-06-03 11:14:45,388 - INFO - Starting anomaly detection.
2025-06-03 11:14:45,403 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111445_update_35.json
2025-06-03 11:14:45,403 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:45,410 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111445_update_35.pth and as latest_checkpoint.pth
2025-06-03 11:14:45,410 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.2907
2025-06-03 11:14:45,410 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:45,410 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:45,410 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.4097, MLP Score: 1.0000
2025-06-03 11:14:45,410 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6297, MLP Score: 1.0000
2025-06-03 11:14:45,410 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.5559, MLP Score: 1.0000
2025-06-03 11:14:45,410 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.8166, MLP Score: 1.0000
2025-06-03 11:14:45,410 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4372, MLP Score: 1.0000
2025-06-03 11:14:45,410 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-03 11:14:45,410 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-03 11:14:45,410 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot file.
2025-06-03 11:14:45,432 - INFO - Parsed 957 nodes.
2025-06-03 11:14:45,449 - INFO - Parsed 2059 edges.
2025-06-03 11:14:46,031 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:46,032 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:46,047 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-03 11:14:46,048 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:46,049 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-03 11:14:46,050 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-03 11:14:46,050 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:46,059 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:46,061 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:46,062 - DEBUG - Shape of encoded categorical edge features: torch.Size([2059, 2])
2025-06-03 11:14:46,064 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:46,064 - DEBUG - Shape of scaled numerical edge features: torch.Size([2059, 20])
2025-06-03 11:14:46,064 - DEBUG - Final edge attributes tensor shape: torch.Size([2059, 22])
2025-06-03 11:14:46,064 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:46,064 - INFO - Performing online update...
2025-06-03 11:14:46,065 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:46,065 - DEBUG - Updated RunningStats: new_mean=0.6914586148368266, new_var=51000000000014.43, new_n=5130
2025-06-03 11:14:46,065 - DEBUG - Updated RunningStats: new_mean=0.6911226024298981, new_var=51300000000007.08, new_n=5160
2025-06-03 11:14:46,065 - DEBUG - Updated RunningStats: new_mean=0.8883106764979403, new_var=25160000000039.21, new_n=2538
2025-06-03 11:14:46,066 - DEBUG - Updated RunningStats: new_mean=0.8895318097057572, new_var=25380000000002.008, new_n=2560
2025-06-03 11:14:46,066 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:46,066 - DEBUG - Online update step: 1/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 2/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 3/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 4/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 5/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 6/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 7/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 8/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 9/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 10/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 11/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 12/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 13/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 14/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 15/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 16/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 17/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,066 - DEBUG - Online update step: 18/50
2025-06-03 11:14:46,066 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 19/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 20/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 21/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 22/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 23/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 24/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 25/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 26/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 27/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 28/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 29/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 30/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 31/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 32/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 33/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 34/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 35/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 36/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 37/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 38/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 39/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 40/50
2025-06-03 11:14:46,067 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,067 - DEBUG - Online update step: 41/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 42/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 43/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 44/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 45/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 46/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 47/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 48/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 49/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - DEBUG - Online update step: 50/50
2025-06-03 11:14:46,068 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:46,068 - WARNING - No successful steps during online update.
2025-06-03 11:14:46,068 - DEBUG - Current node mean: [-2.98957481e-08  2.98957481e-08 -1.64426606e-08 -1.89339726e-08
 -4.24768736e-08  1.22074297e-08  8.47046167e-09 -3.98609945e-09
  5.48088686e-09 -8.96872354e-09 -1.02766631e-08  2.98957459e-09
 -1.42004799e-08 -9.71611769e-09  1.39513485e-08  1.39513485e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  2.39165967e-08
  0.00000000e+00  0.00000000e+00  4.58401459e-08  0.00000000e+00
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  0.00000000e+00  0.00000000e+00], current edge mean: [ 1.4123361e+00  5.6940260e+00 -9.2634705e-10 -2.7790412e-09
  4.6317354e-09 -9.2634705e-10  1.8526941e-09  0.0000000e+00
 -6.0212559e-09 -3.2422147e-09 -7.8739504e-09 -3.7053882e-09
 -4.6317354e-09  1.1116165e-08  5.5580824e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -9.2634705e-10]
2025-06-03 11:14:46,069 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0036
2025-06-03 11:14:46,069 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:46,069 - INFO - Running anomaly detection...
2025-06-03 11:14:46,069 - INFO - Starting anomaly detection.
2025-06-03 11:14:46,079 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111446_update_36.json
2025-06-03 11:14:46,080 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:46,086 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111446_update_36.pth and as latest_checkpoint.pth
2025-06-03 11:14:46,086 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.2792
2025-06-03 11:14:46,086 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:46,086 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:46,086 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.4151, MLP Score: 1.0000
2025-06-03 11:14:46,086 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6205, MLP Score: 1.0000
2025-06-03 11:14:46,086 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.4882, MLP Score: 1.0000
2025-06-03 11:14:46,086 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.8107, MLP Score: 1.0000
2025-06-03 11:14:46,086 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4400, MLP Score: 1.0000
2025-06-03 11:14:46,086 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:46,086 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:46,086 - INFO - Starting visualization of node features.
2025-06-03 11:14:46,086 - INFO - Graph has 957 nodes and 30 features.
2025-06-03 11:14:46,086 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:46,086 - INFO - Calculating feature statistics:
2025-06-03 11:14:46,087 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11045059), 'max': np.float32(9.233398)}
2025-06-03 11:14:46,087 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-9.233398), 'max': np.float32(0.11045059)}
2025-06-03 11:14:46,087 - INFO - - server_score: {'name': 'server_score', 'unique': 13, 'mean': np.float32(-2.3916597e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.2690923), 'max': np.float32(3.0300078)}
2025-06-03 11:14:46,087 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(-1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-0.07773751), 'max': np.float32(17.528582)}
2025-06-03 11:14:46,087 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-4.3847095e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.6302327), 'max': np.float32(3.543696)}
2025-06-03 11:14:46,087 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(7.972199e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.63696367), 'max': np.float32(2.9310646)}
2025-06-03 11:14:46,087 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(1.1958298e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9721506), 'max': np.float32(0.62131685)}
2025-06-03 11:14:46,087 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(3.9860995e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081632435), 'max': np.float32(19.050344)}
2025-06-03 11:14:46,087 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.14600365e-08), 'std': np.float32(0.99999994), 'min': np.float32(-4.202085), 'max': np.float32(20.64691)}
2025-06-03 11:14:46,087 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(4.9826245e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.095424734), 'max': np.float32(11.145133)}
2025-06-03 11:14:46,087 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 14, 'mean': np.float32(-7.972199e-09), 'std': np.float32(1.0), 'min': np.float32(-2.037222), 'max': np.float32(0.88103837)}
2025-06-03 11:14:46,087 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(8.9687235e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10546514), 'max': np.float32(9.99889)}
2025-06-03 11:14:46,088 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-5.979149e-09), 'std': np.float32(1.0), 'min': np.float32(-7.80796), 'max': np.float32(0.12994833)}
2025-06-03 11:14:46,088 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(-7.972199e-09), 'std': np.float32(1.0), 'min': np.float32(-2.4225495), 'max': np.float32(1.917514)}
2025-06-03 11:14:46,088 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(1.5944398e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8217037), 'max': np.float32(2.5205786)}
2025-06-03 11:14:46,088 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 23, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5393881), 'max': np.float32(2.5217385)}
2025-06-03 11:14:46,088 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 23, 'mean': np.float32(-3.9860995e-09), 'std': np.float32(1.0), 'min': np.float32(-2.4071383), 'max': np.float32(1.5780227)}
2025-06-03 11:14:46,088 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,088 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,088 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(1.7937447e-08), 'std': np.float32(0.99999994), 'min': np.float32(-7.242859), 'max': np.float32(0.15562817)}
2025-06-03 11:14:46,088 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,088 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,088 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(3.7867945e-08), 'std': np.float32(1.0), 'min': np.float32(-4.0823574), 'max': np.float32(4.2654023)}
2025-06-03 11:14:46,088 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,088 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,089 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,089 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,089 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,089 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,089 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:46,100 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764f950140>
2025-06-03 11:14:46,221 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:46,274 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:46,309 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:47,752 - INFO - Node feature visualization saved to vis/node_features_20250603_111446.png
2025-06-03 11:14:47,752 - INFO - Finished visualization of node features.
2025-06-03 11:14:47,752 - INFO - Performing additional feature analysis:
2025-06-03 11:14:47,752 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:47,752 - INFO - Starting visualization of edge features.
2025-06-03 11:14:47,752 - INFO - Graph has 2059 edges and 22 edge features.
2025-06-03 11:14:47,752 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:47,753 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:47,753 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-03 11:14:47,753 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-03 11:14:47,753 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot file.
2025-06-03 11:14:47,771 - INFO - Parsed 962 nodes.
2025-06-03 11:14:47,789 - INFO - Parsed 2098 edges.
2025-06-03 11:14:48,418 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:48,419 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:48,434 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-03 11:14:48,436 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:48,436 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-03 11:14:48,437 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-03 11:14:48,437 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:48,447 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:48,449 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:48,450 - DEBUG - Shape of encoded categorical edge features: torch.Size([2098, 2])
2025-06-03 11:14:48,452 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:48,452 - DEBUG - Shape of scaled numerical edge features: torch.Size([2098, 20])
2025-06-03 11:14:48,452 - DEBUG - Final edge attributes tensor shape: torch.Size([2098, 22])
2025-06-03 11:14:48,452 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:48,453 - INFO - Performing online update...
2025-06-03 11:14:48,453 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:48,453 - DEBUG - Updated RunningStats: new_mean=0.6871276741044732, new_var=51600000000014.25, new_n=5190
2025-06-03 11:14:48,453 - DEBUG - Updated RunningStats: new_mean=0.6868204044161532, new_var=51900000000007.06, new_n=5220
2025-06-03 11:14:48,454 - DEBUG - Updated RunningStats: new_mean=0.8847060655593818, new_var=25600000000039.105, new_n=2582
2025-06-03 11:14:48,454 - DEBUG - Updated RunningStats: new_mean=0.8859348156162068, new_var=25820000000002.016, new_n=2604
2025-06-03 11:14:48,454 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:48,454 - DEBUG - Online update step: 1/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 2/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 3/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 4/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 5/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 6/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 7/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 8/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 9/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 10/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 11/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 12/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 13/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 14/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,454 - DEBUG - Online update step: 15/50
2025-06-03 11:14:48,454 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 16/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 17/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 18/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 19/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 20/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 21/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 22/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 23/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 24/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 25/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 26/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 27/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 28/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 29/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 30/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 31/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 32/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 33/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 34/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 35/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 36/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,455 - DEBUG - Online update step: 37/50
2025-06-03 11:14:48,455 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 38/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 39/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 40/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 41/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 42/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 43/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 44/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 45/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 46/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 47/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 48/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 49/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - DEBUG - Online update step: 50/50
2025-06-03 11:14:48,456 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:48,456 - WARNING - No successful steps during online update.
2025-06-03 11:14:48,457 - DEBUG - Current node mean: [ 1.1896145e-08 -1.1896145e-08 -6.9394179e-09 -1.1648309e-08
 -7.9307636e-09 -1.9826909e-09  6.5924475e-08 -2.0074745e-08
 -1.7348545e-09  9.9134541e-09 -1.7844219e-08  3.1723054e-08
  1.8339891e-08  1.9826909e-09  7.9307636e-09 -4.9567273e-10
 -1.0409127e-08  0.0000000e+00  0.0000000e+00  8.4264364e-09
  0.0000000e+00  0.0000000e+00 -1.2391818e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4180171e+00  5.6916113e+00 -9.0912711e-10  3.1819447e-09
  1.3636906e-09 -4.0910719e-09 -1.8182542e-09 -1.8182542e-09
 -9.0912711e-10 -3.6365084e-09  1.6137006e-08 -5.4547624e-09
  0.0000000e+00 -9.5458343e-09  9.5458343e-09 -2.3864586e-09
 -2.3864586e-09 -2.3864586e-09 -2.3864586e-09 -2.3864586e-09
 -2.3864586e-09  9.0912711e-10]
2025-06-03 11:14:48,457 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0112
2025-06-03 11:14:48,457 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:48,457 - INFO - Running anomaly detection...
2025-06-03 11:14:48,457 - INFO - Starting anomaly detection.
2025-06-03 11:14:48,469 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111448_update_37.json
2025-06-03 11:14:48,469 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:48,475 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111448_update_37.pth and as latest_checkpoint.pth
2025-06-03 11:14:48,475 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.2856
2025-06-03 11:14:48,476 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:48,476 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:48,476 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.4167, MLP Score: 1.0000
2025-06-03 11:14:48,476 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6369, MLP Score: 1.0000
2025-06-03 11:14:48,476 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.5565, MLP Score: 1.0000
2025-06-03 11:14:48,476 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.8140, MLP Score: 1.0000
2025-06-03 11:14:48,476 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4473, MLP Score: 1.0000
2025-06-03 11:14:48,476 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-03 11:14:48,476 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-03 11:14:48,476 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot file.
2025-06-03 11:14:48,499 - INFO - Parsed 985 nodes.
2025-06-03 11:14:48,519 - INFO - Parsed 2150 edges.
2025-06-03 11:14:49,187 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:49,187 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:49,204 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-03 11:14:49,205 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:49,205 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-03 11:14:49,207 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-03 11:14:49,207 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:49,217 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:49,218 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:49,220 - DEBUG - Shape of encoded categorical edge features: torch.Size([2150, 2])
2025-06-03 11:14:49,222 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:49,222 - DEBUG - Shape of scaled numerical edge features: torch.Size([2150, 20])
2025-06-03 11:14:49,222 - DEBUG - Final edge attributes tensor shape: torch.Size([2150, 22])
2025-06-03 11:14:49,222 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:49,222 - INFO - Performing online update...
2025-06-03 11:14:49,222 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:49,223 - DEBUG - Updated RunningStats: new_mean=0.6828957164003234, new_var=52200000000014.07, new_n=5250
2025-06-03 11:14:49,223 - DEBUG - Updated RunningStats: new_mean=0.6826159399397399, new_var=52500000000007.05, new_n=5280
2025-06-03 11:14:49,223 - DEBUG - Updated RunningStats: new_mean=0.8812245449765939, new_var=26040000000039.13, new_n=2626
2025-06-03 11:14:49,223 - DEBUG - Updated RunningStats: new_mean=0.8824569149728944, new_var=26260000000002.004, new_n=2648
2025-06-03 11:14:49,223 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:49,223 - DEBUG - Online update step: 1/50
2025-06-03 11:14:49,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,223 - DEBUG - Online update step: 2/50
2025-06-03 11:14:49,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,223 - DEBUG - Online update step: 3/50
2025-06-03 11:14:49,223 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 4/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 5/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 6/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 7/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 8/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 9/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 10/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 11/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 12/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 13/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 14/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 15/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 16/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 17/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 18/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 19/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 20/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 21/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 22/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 23/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 24/50
2025-06-03 11:14:49,224 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,224 - DEBUG - Online update step: 25/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 26/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 27/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 28/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 29/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 30/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 31/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 32/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 33/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 34/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 35/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 36/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 37/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 38/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 39/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 40/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 41/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 42/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 43/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 44/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 45/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 46/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 47/50
2025-06-03 11:14:49,225 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,225 - DEBUG - Online update step: 48/50
2025-06-03 11:14:49,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,226 - DEBUG - Online update step: 49/50
2025-06-03 11:14:49,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,226 - DEBUG - Online update step: 50/50
2025-06-03 11:14:49,226 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,226 - WARNING - No successful steps during online update.
2025-06-03 11:14:49,226 - DEBUG - Current node mean: [ 2.9045919e-09 -2.9045919e-09  3.1950510e-08 -9.6819726e-09
 -3.6307398e-08 -4.1148382e-08 -1.4522959e-08  1.9363946e-09
  8.7137755e-09  1.9363946e-09  1.5733205e-08 -9.6819726e-09
  3.9696090e-08  7.2614798e-10  2.7109524e-08  9.6819726e-09
  7.7455784e-09  0.0000000e+00  0.0000000e+00  9.6819726e-09
  0.0000000e+00  0.0000000e+00  5.8091838e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4181396e+00  5.7032557e+00  1.7742778e-09  2.2178472e-09
 -3.9921249e-09 -1.3307083e-09 -4.1030175e-09  1.0645667e-08
  8.8713892e-10  2.2178472e-09  3.5485557e-09 -5.3228333e-09
 -8.8713892e-10 -3.5485557e-09  4.4356945e-09  8.8713892e-10
  8.8713892e-10  8.8713892e-10  8.8713892e-10  8.8713892e-10
  8.8713892e-10  1.7742778e-09]
2025-06-03 11:14:49,226 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0054
2025-06-03 11:14:49,227 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:49,227 - INFO - Running anomaly detection...
2025-06-03 11:14:49,227 - INFO - Starting anomaly detection.
2025-06-03 11:14:49,239 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111449_update_38.json
2025-06-03 11:14:49,239 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:49,246 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111449_update_38.pth and as latest_checkpoint.pth
2025-06-03 11:14:49,246 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.2753
2025-06-03 11:14:49,246 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:49,246 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:49,246 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3994, MLP Score: 1.0000
2025-06-03 11:14:49,246 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.7167, MLP Score: 1.0000
2025-06-03 11:14:49,246 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.6136, MLP Score: 1.0000
2025-06-03 11:14:49,246 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 8.7024, MLP Score: 1.0000
2025-06-03 11:14:49,246 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4566, MLP Score: 1.0000
2025-06-03 11:14:49,246 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-03 11:14:49,246 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-03 11:14:49,246 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot file.
2025-06-03 11:14:49,267 - INFO - Parsed 994 nodes.
2025-06-03 11:14:49,285 - INFO - Parsed 2170 edges.
2025-06-03 11:14:49,902 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:49,902 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:49,918 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-03 11:14:49,920 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:49,920 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-03 11:14:49,921 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-03 11:14:49,921 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:49,932 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:49,933 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:49,935 - DEBUG - Shape of encoded categorical edge features: torch.Size([2170, 2])
2025-06-03 11:14:49,936 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:49,937 - DEBUG - Shape of scaled numerical edge features: torch.Size([2170, 20])
2025-06-03 11:14:49,937 - DEBUG - Final edge attributes tensor shape: torch.Size([2170, 22])
2025-06-03 11:14:49,937 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:49,937 - INFO - Performing online update...
2025-06-03 11:14:49,937 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:49,938 - DEBUG - Updated RunningStats: new_mean=0.6787593527231225, new_var=52800000000013.9, new_n=5310
2025-06-03 11:14:49,938 - DEBUG - Updated RunningStats: new_mean=0.678505941564709, new_var=53100000000007.04, new_n=5340
2025-06-03 11:14:49,938 - DEBUG - Updated RunningStats: new_mean=0.8778540578861496, new_var=26480000000039.074, new_n=2670
2025-06-03 11:14:49,938 - DEBUG - Updated RunningStats: new_mean=0.8790928708107342, new_var=26700000000002.02, new_n=2692
2025-06-03 11:14:49,938 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:49,938 - DEBUG - Online update step: 1/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 2/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 3/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 4/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 5/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 6/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,938 - DEBUG - Online update step: 7/50
2025-06-03 11:14:49,938 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 8/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 9/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 10/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 11/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 12/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 13/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 14/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 15/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 16/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 17/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 18/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 19/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 20/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 21/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 22/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 23/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 24/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 25/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 26/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 27/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 28/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 29/50
2025-06-03 11:14:49,939 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,939 - DEBUG - Online update step: 30/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 31/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 32/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 33/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 34/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 35/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 36/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 37/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 38/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 39/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 40/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 41/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 42/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 43/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 44/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 45/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 46/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 47/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 48/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 49/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - DEBUG - Online update step: 50/50
2025-06-03 11:14:49,940 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:49,940 - WARNING - No successful steps during online update.
2025-06-03 11:14:49,941 - DEBUG - Current node mean: [-1.1513171e-08  1.1513171e-08  2.4945203e-08  1.6310326e-08
  5.0849838e-08 -1.1513171e-08 -2.5904635e-08 -7.6754469e-09
  1.5350894e-08  1.0553740e-08  4.2214960e-08 -9.5943087e-10
 -8.3950207e-09 -1.5350894e-08  1.7269755e-08 -1.5350894e-08
  2.3026342e-08  0.0000000e+00  0.0000000e+00 -1.1513171e-08
  0.0000000e+00  0.0000000e+00 -2.5904635e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4179723e+00  5.7064514e+00 -2.6368876e-09  8.7896251e-10
  8.7896251e-10 -1.7579250e-09  1.7579250e-09  3.5158501e-09
  2.6368876e-09  1.7579250e-09 -2.2633284e-08 -7.0317001e-09
  3.5158501e-09  1.7579250e-09 -4.8342939e-09 -1.7579250e-09
 -1.7579250e-09 -1.7579250e-09 -1.7579250e-09 -1.7579250e-09
 -1.7579250e-09 -1.7579250e-09]
2025-06-03 11:14:49,941 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0015
2025-06-03 11:14:49,941 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:49,941 - INFO - Running anomaly detection...
2025-06-03 11:14:49,942 - INFO - Starting anomaly detection.
2025-06-03 11:14:49,955 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111449_update_39.json
2025-06-03 11:14:49,955 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:49,961 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111449_update_39.pth and as latest_checkpoint.pth
2025-06-03 11:14:49,961 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.2783
2025-06-03 11:14:49,961 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:49,961 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:49,961 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3364, MLP Score: 1.0000
2025-06-03 11:14:49,961 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6375, MLP Score: 1.0000
2025-06-03 11:14:49,961 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.9887, MLP Score: 1.0000
2025-06-03 11:14:49,961 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.7988, MLP Score: 1.0000
2025-06-03 11:14:49,961 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4583, MLP Score: 1.0000
2025-06-03 11:14:49,962 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-03 11:14:49,962 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-03 11:14:49,962 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot file.
2025-06-03 11:14:49,980 - INFO - Parsed 996 nodes.
2025-06-03 11:14:49,997 - INFO - Parsed 2181 edges.
2025-06-03 11:14:50,646 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:50,646 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:50,662 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-03 11:14:50,664 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:50,664 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-03 11:14:50,665 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-03 11:14:50,665 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:50,676 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:50,677 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:50,679 - DEBUG - Shape of encoded categorical edge features: torch.Size([2181, 2])
2025-06-03 11:14:50,680 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:50,680 - DEBUG - Shape of scaled numerical edge features: torch.Size([2181, 20])
2025-06-03 11:14:50,681 - DEBUG - Final edge attributes tensor shape: torch.Size([2181, 22])
2025-06-03 11:14:50,681 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:50,681 - INFO - Performing online update...
2025-06-03 11:14:50,681 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:50,681 - DEBUG - Updated RunningStats: new_mean=0.674715405547077, new_var=53400000000013.734, new_n=5370
2025-06-03 11:14:50,682 - DEBUG - Updated RunningStats: new_mean=0.6744872727105924, new_var=53700000000007.02, new_n=5400
2025-06-03 11:14:50,682 - DEBUG - Updated RunningStats: new_mean=0.8745915055759271, new_var=26920000000038.965, new_n=2714
2025-06-03 11:14:50,682 - DEBUG - Updated RunningStats: new_mean=0.8758369479569169, new_var=27140000000002.043, new_n=2736
2025-06-03 11:14:50,682 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:50,682 - DEBUG - Online update step: 1/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 2/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 3/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 4/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 5/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 6/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 7/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 8/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 9/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 10/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 11/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,682 - DEBUG - Online update step: 12/50
2025-06-03 11:14:50,682 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 13/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 14/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 15/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 16/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 17/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 18/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 19/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 20/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 21/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 22/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 23/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 24/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 25/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 26/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 27/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 28/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 29/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 30/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 31/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 32/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 33/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 34/50
2025-06-03 11:14:50,683 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,683 - DEBUG - Online update step: 35/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 36/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 37/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 38/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 39/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 40/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 41/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 42/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 43/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 44/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 45/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 46/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 47/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 48/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 49/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - DEBUG - Online update step: 50/50
2025-06-03 11:14:50,684 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:50,684 - WARNING - No successful steps during online update.
2025-06-03 11:14:50,685 - DEBUG - Current node mean: [-2.8725129e-09  2.8725129e-09 -1.5320069e-08  5.7450258e-09
  3.8300172e-09 -1.5320069e-08 -1.9150086e-08 -1.1430208e-08
 -1.7235077e-08 -1.1490052e-08 -2.2980103e-08 -4.4045198e-08
  1.5080694e-08 -1.7235077e-08  7.6600344e-09  5.7450258e-09
  9.5750430e-09  0.0000000e+00  0.0000000e+00 -2.6091993e-08
  0.0000000e+00  0.0000000e+00 -1.5080694e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4204494e+00  5.7028885e+00  0.0000000e+00  5.2471765e-09
 -2.6235882e-09  8.7452939e-10  8.7452939e-10  0.0000000e+00
  1.7490588e-09  3.4981176e-09  7.6521323e-09  0.0000000e+00
  1.7490588e-09  2.5798617e-08  8.7452939e-10  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-03 11:14:50,685 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0049
2025-06-03 11:14:50,685 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:50,685 - INFO - Running anomaly detection...
2025-06-03 11:14:50,685 - INFO - Starting anomaly detection.
2025-06-03 11:14:50,697 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111450_update_40.json
2025-06-03 11:14:50,697 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:50,703 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111450_update_40.pth and as latest_checkpoint.pth
2025-06-03 11:14:50,703 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.2713
2025-06-03 11:14:50,703 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:50,703 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:50,703 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3355, MLP Score: 1.0000
2025-06-03 11:14:50,703 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6367, MLP Score: 1.0000
2025-06-03 11:14:50,703 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0118, MLP Score: 1.0000
2025-06-03 11:14:50,703 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.7961, MLP Score: 1.0000
2025-06-03 11:14:50,703 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4598, MLP Score: 1.0000
2025-06-03 11:14:50,703 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-03 11:14:50,703 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-03 11:14:50,703 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot file.
2025-06-03 11:14:50,722 - INFO - Parsed 1002 nodes.
2025-06-03 11:14:50,740 - INFO - Parsed 2201 edges.
2025-06-03 11:14:51,365 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:51,365 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:51,381 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-03 11:14:51,382 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:51,382 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-03 11:14:51,383 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-03 11:14:51,383 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:51,394 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:51,395 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:51,396 - DEBUG - Shape of encoded categorical edge features: torch.Size([2201, 2])
2025-06-03 11:14:51,398 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:51,398 - DEBUG - Shape of scaled numerical edge features: torch.Size([2201, 20])
2025-06-03 11:14:51,398 - DEBUG - Final edge attributes tensor shape: torch.Size([2201, 22])
2025-06-03 11:14:51,398 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:51,398 - INFO - Performing online update...
2025-06-03 11:14:51,399 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:51,399 - DEBUG - Updated RunningStats: new_mean=0.670760823701507, new_var=54000000000013.57, new_n=5430
2025-06-03 11:14:51,399 - DEBUG - Updated RunningStats: new_mean=0.6705569158765106, new_var=54300000000007.016, new_n=5460
2025-06-03 11:14:51,399 - DEBUG - Updated RunningStats: new_mean=0.8714346084847195, new_var=27360000000038.875, new_n=2758
2025-06-03 11:14:51,399 - DEBUG - Updated RunningStats: new_mean=0.8726838087095676, new_var=27580000000002.05, new_n=2780
2025-06-03 11:14:51,399 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:51,399 - DEBUG - Online update step: 1/50
2025-06-03 11:14:51,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 2/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 3/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 4/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 5/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 6/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 7/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 8/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 9/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 10/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 11/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 12/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 13/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 14/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 15/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 16/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 17/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 18/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 19/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 20/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 21/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 22/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 23/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,400 - DEBUG - Online update step: 24/50
2025-06-03 11:14:51,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 25/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 26/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 27/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 28/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 29/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 30/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 31/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 32/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 33/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 34/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 35/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 36/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 37/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 38/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 39/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 40/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 41/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 42/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 43/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 44/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 45/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 46/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 47/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,401 - DEBUG - Online update step: 48/50
2025-06-03 11:14:51,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,402 - DEBUG - Online update step: 49/50
2025-06-03 11:14:51,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,402 - DEBUG - Online update step: 50/50
2025-06-03 11:14:51,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:51,402 - WARNING - No successful steps during online update.
2025-06-03 11:14:51,402 - DEBUG - Current node mean: [-2.4746040e-08  2.4746040e-08 -7.6141662e-09  6.6623955e-09
 -1.2373020e-08  3.4263749e-08  2.8553123e-08 -9.5177075e-09
 -1.4276562e-09  3.8070831e-09 -1.0469479e-08  1.5228332e-08
  1.6893932e-08 -1.9035415e-08 -3.0456665e-08 -1.9035415e-09
  2.9504895e-08  0.0000000e+00  0.0000000e+00  1.5109361e-08
  0.0000000e+00  0.0000000e+00  4.7588538e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4257156e+00  5.7010450e+00 -2.5997482e-09 -2.5997482e-09
  8.6658275e-10  8.6658275e-10  1.7331655e-09 -1.0398993e-08
 -5.1994964e-09  1.7331655e-09  1.1265576e-08  5.1994964e-09
  1.7331655e-09  8.6658275e-10 -6.0660792e-09 -1.7331655e-09
 -1.7331655e-09 -1.7331655e-09 -1.7331655e-09 -1.7331655e-09
 -1.7331655e-09  1.7331655e-09]
2025-06-03 11:14:51,402 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0104
2025-06-03 11:14:51,402 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:51,403 - INFO - Running anomaly detection...
2025-06-03 11:14:51,403 - INFO - Starting anomaly detection.
2025-06-03 11:14:51,414 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111451_update_41.json
2025-06-03 11:14:51,414 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:51,420 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111451_update_41.pth and as latest_checkpoint.pth
2025-06-03 11:14:51,420 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.2711
2025-06-03 11:14:51,420 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:51,420 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:51,421 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3434, MLP Score: 1.0000
2025-06-03 11:14:51,421 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6416, MLP Score: 1.0000
2025-06-03 11:14:51,421 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0545, MLP Score: 1.0000
2025-06-03 11:14:51,421 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8378, MLP Score: 1.0000
2025-06-03 11:14:51,421 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4629, MLP Score: 1.0000
2025-06-03 11:14:51,421 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:51,421 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:51,421 - INFO - Starting visualization of node features.
2025-06-03 11:14:51,421 - INFO - Graph has 1002 nodes and 30 features.
2025-06-03 11:14:51,421 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:51,421 - INFO - Calculating feature statistics:
2025-06-03 11:14:51,421 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(-1.9035415e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10779948), 'max': np.float32(9.4549055)}
2025-06-03 11:14:51,421 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(1.9035415e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.4549055), 'max': np.float32(0.10779948)}
2025-06-03 11:14:51,421 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-7.614166e-09), 'std': np.float32(0.99999994), 'min': np.float32(-2.2951245), 'max': np.float32(3.1844404)}
2025-06-03 11:14:51,421 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(2.8553124e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.075687245), 'max': np.float32(18.128239)}
2025-06-03 11:14:51,421 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-1.142125e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64128727), 'max': np.float32(3.517741)}
2025-06-03 11:14:51,422 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(3.807083e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64773375), 'max': np.float32(2.8945014)}
2025-06-03 11:14:51,422 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(2.28425e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.920527), 'max': np.float32(0.63164884)}
2025-06-03 11:14:51,422 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.07882985), 'max': np.float32(20.457922)}
2025-06-03 11:14:51,422 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-9.5177075e-09), 'std': np.float32(1.0000001), 'min': np.float32(-4.263898), 'max': np.float32(20.942154)}
2025-06-03 11:14:51,422 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(1.6655989e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.09322403), 'max': np.float32(11.406229)}
2025-06-03 11:14:51,422 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.003119), 'max': np.float32(0.9216695)}
2025-06-03 11:14:51,422 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(9.5177075e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.103043675), 'max': np.float32(10.232957)}
2025-06-03 11:14:51,422 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(1.5704218e-08), 'std': np.float32(0.99999994), 'min': np.float32(-7.992366), 'max': np.float32(0.12694868)}
2025-06-03 11:14:51,422 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3828843), 'max': np.float32(1.8222367)}
2025-06-03 11:14:51,422 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(-1.5228332e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7219405), 'max': np.float32(2.4828484)}
2025-06-03 11:14:51,422 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4587957), 'max': np.float32(2.3851652)}
2025-06-03 11:14:51,422 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.0456665e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683), 'max': np.float32(1.4947592)}
2025-06-03 11:14:51,422 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(9.5177075e-09), 'std': np.float32(1.0), 'min': np.float32(-7.408522), 'max': np.float32(0.15208052)}
2025-06-03 11:14:51,423 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.9035415e-09), 'std': np.float32(1.0), 'min': np.float32(-4.1356325), 'max': np.float32(4.347513)}
2025-06-03 11:14:51,423 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,423 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:51,434 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a76542314c0>
2025-06-03 11:14:51,554 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:51,610 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:51,824 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:52,993 - INFO - Node feature visualization saved to vis/node_features_20250603_111451.png
2025-06-03 11:14:52,993 - INFO - Finished visualization of node features.
2025-06-03 11:14:52,993 - INFO - Performing additional feature analysis:
2025-06-03 11:14:52,993 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:52,993 - INFO - Starting visualization of edge features.
2025-06-03 11:14:52,993 - INFO - Graph has 2201 edges and 22 edge features.
2025-06-03 11:14:52,993 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:52,993 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:52,993 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-03 11:14:52,993 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-03 11:14:52,993 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot file.
2025-06-03 11:14:53,013 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:53,032 - INFO - Parsed 2202 edges.
2025-06-03 11:14:53,701 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:53,701 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:53,716 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:53,718 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:53,718 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:53,720 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:53,720 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:53,730 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:53,731 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:53,733 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:53,734 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:53,734 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:53,734 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:53,735 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:53,735 - INFO - Performing online update...
2025-06-03 11:14:53,735 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:53,735 - DEBUG - Updated RunningStats: new_mean=0.6668926704355366, new_var=54600000000013.414, new_n=5490
2025-06-03 11:14:53,735 - DEBUG - Updated RunningStats: new_mean=0.6667119999307526, new_var=54900000000007.01, new_n=5520
2025-06-03 11:14:53,736 - DEBUG - Updated RunningStats: new_mean=0.8683743633893884, new_var=27800000000038.773, new_n=2802
2025-06-03 11:14:53,736 - DEBUG - Updated RunningStats: new_mean=0.8696289805062521, new_var=28020000000002.082, new_n=2824
2025-06-03 11:14:53,736 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:53,736 - DEBUG - Online update step: 1/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 2/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 3/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 4/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 5/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 6/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 7/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 8/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 9/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 10/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 11/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 12/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 13/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 14/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 15/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 16/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 17/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 18/50
2025-06-03 11:14:53,736 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,736 - DEBUG - Online update step: 19/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 20/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 21/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 22/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 23/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 24/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 25/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 26/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 27/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 28/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 29/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 30/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 31/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 32/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 33/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 34/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 35/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 36/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 37/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 38/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 39/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 40/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 41/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 42/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,737 - DEBUG - Online update step: 43/50
2025-06-03 11:14:53,737 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 44/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 45/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 46/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 47/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 48/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 49/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - DEBUG - Online update step: 50/50
2025-06-03 11:14:53,738 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:53,738 - WARNING - No successful steps during online update.
2025-06-03 11:14:53,738 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:14:53,738 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0012
2025-06-03 11:14:53,739 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:53,739 - INFO - Running anomaly detection...
2025-06-03 11:14:53,739 - INFO - Starting anomaly detection.
2025-06-03 11:14:53,751 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111453_update_42.json
2025-06-03 11:14:53,752 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:53,758 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111453_update_42.pth and as latest_checkpoint.pth
2025-06-03 11:14:53,758 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.2707
2025-06-03 11:14:53,758 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:53,758 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:53,758 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:53,758 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:53,758 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0567, MLP Score: 1.0000
2025-06-03 11:14:53,758 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8399, MLP Score: 1.0000
2025-06-03 11:14:53,758 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:53,758 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-03 11:14:53,758 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-03 11:14:53,758 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot file.
2025-06-03 11:14:53,779 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:53,799 - INFO - Parsed 2202 edges.
2025-06-03 11:14:54,433 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:54,433 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:54,449 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:54,450 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:54,450 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:54,452 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:54,452 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:54,461 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:54,462 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:54,464 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:54,466 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:54,466 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:54,466 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:54,466 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:54,466 - INFO - Performing online update...
2025-06-03 11:14:54,466 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:54,467 - DEBUG - Updated RunningStats: new_mean=0.6631081512834419, new_var=55200000000013.266, new_n=5550
2025-06-03 11:14:54,467 - DEBUG - Updated RunningStats: new_mean=0.6629497703494196, new_var=55500000000007.0, new_n=5580
2025-06-03 11:14:54,467 - DEBUG - Updated RunningStats: new_mean=0.8654097747554901, new_var=28240000000038.703, new_n=2846
2025-06-03 11:14:54,467 - DEBUG - Updated RunningStats: new_mean=0.8666678848280036, new_var=28460000000002.1, new_n=2868
2025-06-03 11:14:54,467 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:54,467 - DEBUG - Online update step: 1/50
2025-06-03 11:14:54,467 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,467 - DEBUG - Online update step: 2/50
2025-06-03 11:14:54,467 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,467 - DEBUG - Online update step: 3/50
2025-06-03 11:14:54,467 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,467 - DEBUG - Online update step: 4/50
2025-06-03 11:14:54,467 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 5/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 6/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 7/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 8/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 9/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 10/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 11/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 12/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 13/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 14/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 15/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 16/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 17/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 18/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 19/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 20/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 21/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 22/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 23/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 24/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 25/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 26/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,468 - DEBUG - Online update step: 27/50
2025-06-03 11:14:54,468 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 28/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 29/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 30/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 31/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 32/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 33/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 34/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 35/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 36/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 37/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 38/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 39/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 40/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 41/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 42/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 43/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 44/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 45/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 46/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 47/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 48/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 49/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - DEBUG - Online update step: 50/50
2025-06-03 11:14:54,469 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:54,469 - WARNING - No successful steps during online update.
2025-06-03 11:14:54,470 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:14:54,470 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:14:54,470 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:54,470 - INFO - Running anomaly detection...
2025-06-03 11:14:54,471 - INFO - Starting anomaly detection.
2025-06-03 11:14:54,483 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111454_update_43.json
2025-06-03 11:14:54,483 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:54,489 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111454_update_43.pth and as latest_checkpoint.pth
2025-06-03 11:14:54,489 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.2707
2025-06-03 11:14:54,489 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:54,489 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:54,489 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:54,489 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:54,489 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0567, MLP Score: 1.0000
2025-06-03 11:14:54,489 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8399, MLP Score: 1.0000
2025-06-03 11:14:54,490 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:54,490 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-03 11:14:54,490 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-03 11:14:54,490 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot file.
2025-06-03 11:14:54,509 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:54,528 - INFO - Parsed 2202 edges.
2025-06-03 11:14:55,145 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:55,145 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:55,161 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:55,162 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:55,163 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:55,164 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:55,164 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:55,175 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:55,176 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:55,178 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:55,179 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:55,179 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:55,180 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:55,180 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:55,180 - INFO - Performing online update...
2025-06-03 11:14:55,180 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:55,180 - DEBUG - Updated RunningStats: new_mean=0.6594045844126756, new_var=55800000000013.12, new_n=5610
2025-06-03 11:14:55,181 - DEBUG - Updated RunningStats: new_mean=0.6592675882059873, new_var=56100000000007.0, new_n=5640
2025-06-03 11:14:55,181 - DEBUG - Updated RunningStats: new_mean=0.8625354573325893, new_var=28680000000038.633, new_n=2890
2025-06-03 11:14:55,181 - DEBUG - Updated RunningStats: new_mean=0.8637962728103615, new_var=28900000000002.125, new_n=2912
2025-06-03 11:14:55,181 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:55,181 - DEBUG - Online update step: 1/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 2/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 3/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 4/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 5/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 6/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 7/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 8/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 9/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 10/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 11/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 12/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 13/50
2025-06-03 11:14:55,181 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,181 - DEBUG - Online update step: 14/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 15/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 16/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 17/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 18/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 19/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 20/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 21/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 22/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 23/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 24/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 25/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 26/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 27/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 28/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 29/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 30/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 31/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 32/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 33/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 34/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 35/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 36/50
2025-06-03 11:14:55,182 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,182 - DEBUG - Online update step: 37/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 38/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 39/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 40/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 41/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 42/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 43/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 44/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 45/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 46/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 47/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 48/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 49/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - DEBUG - Online update step: 50/50
2025-06-03 11:14:55,183 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,183 - WARNING - No successful steps during online update.
2025-06-03 11:14:55,184 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  7.6065749e-09
  5.7049312e-09  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -8.6618923e-10  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  5.1971352e-09 -2.4686392e-08  2.2520920e-08 -8.6618923e-10
 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10 -8.6618923e-10
 -8.6618923e-10  0.0000000e+00]
2025-06-03 11:14:55,184 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:14:55,184 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:55,184 - INFO - Running anomaly detection...
2025-06-03 11:14:55,184 - INFO - Starting anomaly detection.
2025-06-03 11:14:55,198 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111455_update_44.json
2025-06-03 11:14:55,198 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:55,204 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111455_update_44.pth and as latest_checkpoint.pth
2025-06-03 11:14:55,204 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.2707
2025-06-03 11:14:55,204 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:55,204 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:55,204 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:55,204 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:55,204 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0567, MLP Score: 1.0000
2025-06-03 11:14:55,204 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8399, MLP Score: 1.0000
2025-06-03 11:14:55,204 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:55,204 - INFO - 
--- Processing file: nw_graph_encoded_1748870685.dot (Timestamp: 2025-06-02 15:24:45) ---
2025-06-03 11:14:55,204 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-03 11:14:55,204 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot file.
2025-06-03 11:14:55,224 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:55,244 - INFO - Parsed 2202 edges.
2025-06-03 11:14:55,853 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:55,854 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:55,869 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:55,870 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:55,871 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:55,872 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:55,872 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:55,882 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:55,883 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:55,884 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:55,886 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:55,886 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:55,886 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:55,886 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:55,886 - INFO - Performing online update...
2025-06-03 11:14:55,887 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:55,887 - DEBUG - Updated RunningStats: new_mean=0.6557793999045136, new_var=56400000000012.97, new_n=5670
2025-06-03 11:14:55,887 - DEBUG - Updated RunningStats: new_mean=0.655662925681623, new_var=56700000000006.99, new_n=5700
2025-06-03 11:14:55,887 - DEBUG - Updated RunningStats: new_mean=0.8597473498378813, new_var=29120000000038.566, new_n=2934
2025-06-03 11:14:55,887 - DEBUG - Updated RunningStats: new_mean=0.8610101485645918, new_var=29340000000002.145, new_n=2956
2025-06-03 11:14:55,887 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:55,887 - DEBUG - Online update step: 1/50
2025-06-03 11:14:55,887 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 2/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 3/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 4/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 5/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 6/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 7/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 8/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 9/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 10/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 11/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 12/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 13/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 14/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 15/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 16/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 17/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 18/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 19/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 20/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 21/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 22/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 23/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,888 - DEBUG - Online update step: 24/50
2025-06-03 11:14:55,888 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 25/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 26/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 27/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 28/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 29/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 30/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 31/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 32/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 33/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 34/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 35/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 36/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 37/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 38/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 39/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 40/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 41/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 42/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 43/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 44/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 45/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 46/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 47/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,889 - DEBUG - Online update step: 48/50
2025-06-03 11:14:55,889 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,890 - DEBUG - Online update step: 49/50
2025-06-03 11:14:55,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,890 - DEBUG - Online update step: 50/50
2025-06-03 11:14:55,890 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:55,890 - WARNING - No successful steps during online update.
2025-06-03 11:14:55,890 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  0.0000000e+00
 -1.5213150e-08  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -4.3309458e-09  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  8.6618923e-10 -5.1971352e-09  2.2520920e-08 -3.4647569e-09
 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09
 -3.4647569e-09  0.0000000e+00]
2025-06-03 11:14:55,890 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:14:55,890 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:55,891 - INFO - Running anomaly detection...
2025-06-03 11:14:55,891 - INFO - Starting anomaly detection.
2025-06-03 11:14:55,903 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111455_update_45.json
2025-06-03 11:14:55,903 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:55,909 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111455_update_45.pth and as latest_checkpoint.pth
2025-06-03 11:14:55,909 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870685.dot): 0.2640
2025-06-03 11:14:55,909 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:55,909 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:55,909 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:55,909 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:55,909 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0568, MLP Score: 1.0000
2025-06-03 11:14:55,909 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8400, MLP Score: 1.0000
2025-06-03 11:14:55,909 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:55,909 - INFO - 
--- Processing file: nw_graph_encoded_1748870715.dot (Timestamp: 2025-06-02 15:25:15) ---
2025-06-03 11:14:55,909 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-03 11:14:55,909 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot file.
2025-06-03 11:14:55,929 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:55,949 - INFO - Parsed 2202 edges.
2025-06-03 11:14:56,587 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:56,587 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:56,605 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:56,607 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:56,607 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:56,609 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:56,609 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:56,620 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:56,621 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:56,623 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:56,624 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:56,625 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:56,625 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:56,625 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:56,625 - INFO - Performing online update...
2025-06-03 11:14:56,625 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:56,626 - DEBUG - Updated RunningStats: new_mean=0.6522301354907635, new_var=57000000000012.83, new_n=5730
2025-06-03 11:14:56,626 - DEBUG - Updated RunningStats: new_mean=0.6521333602931829, new_var=57300000000006.984, new_n=5760
2025-06-03 11:14:56,626 - DEBUG - Updated RunningStats: new_mean=0.8570416310132652, new_var=29560000000038.5, new_n=2978
2025-06-03 11:14:56,626 - DEBUG - Updated RunningStats: new_mean=0.8583057506300312, new_var=29780000000002.164, new_n=3000
2025-06-03 11:14:56,626 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:56,626 - DEBUG - Online update step: 1/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 2/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 3/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 4/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 5/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 6/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 7/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 8/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 9/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,626 - DEBUG - Online update step: 10/50
2025-06-03 11:14:56,626 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 11/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 12/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 13/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 14/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 15/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 16/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 17/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 18/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 19/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 20/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 21/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 22/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 23/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 24/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 25/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 26/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 27/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 28/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 29/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 30/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 31/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 32/50
2025-06-03 11:14:56,627 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,627 - DEBUG - Online update step: 33/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 34/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 35/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 36/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 37/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 38/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 39/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 40/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 41/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 42/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 43/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 44/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 45/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 46/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 47/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 48/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 49/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - DEBUG - Online update step: 50/50
2025-06-03 11:14:56,628 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:56,628 - WARNING - No successful steps during online update.
2025-06-03 11:14:56,629 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  0.0000000e+00
 -1.5213150e-08  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -4.3309458e-09  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  8.6618923e-10 -5.1971352e-09  2.2520920e-08 -3.4647569e-09
 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09
 -3.4647569e-09  0.0000000e+00]
2025-06-03 11:14:56,629 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:14:56,629 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:56,629 - INFO - Running anomaly detection...
2025-06-03 11:14:56,629 - INFO - Starting anomaly detection.
2025-06-03 11:14:56,643 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111456_update_46.json
2025-06-03 11:14:56,643 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:56,650 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111456_update_46.pth and as latest_checkpoint.pth
2025-06-03 11:14:56,650 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870715.dot): 0.2640
2025-06-03 11:14:56,650 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:56,650 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:56,650 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:56,650 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:56,650 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0568, MLP Score: 1.0000
2025-06-03 11:14:56,650 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8400, MLP Score: 1.0000
2025-06-03 11:14:56,650 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:56,650 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:14:56,650 - INFO - Performing visualization of node and edge features.
2025-06-03 11:14:56,650 - INFO - Starting visualization of node features.
2025-06-03 11:14:56,650 - INFO - Graph has 1003 nodes and 30 features.
2025-06-03 11:14:56,650 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:14:56,650 - INFO - Calculating feature statistics:
2025-06-03 11:14:56,650 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(1.568856e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.1077451), 'max': np.float32(9.459676)}
2025-06-03 11:14:56,651 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-1.568856e-08), 'std': np.float32(1.0000001), 'min': np.float32(-9.459676), 'max': np.float32(0.1077451)}
2025-06-03 11:14:56,651 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.2948325), 'max': np.float32(3.1858604)}
2025-06-03 11:14:56,651 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(7.606575e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.07564814), 'max': np.float32(18.139393)}
2025-06-03 11:14:56,651 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-1.521315e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6408362), 'max': np.float32(3.519414)}
2025-06-03 11:14:56,651 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(2.2819725e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64727545), 'max': np.float32(2.8959882)}
2025-06-03 11:14:56,651 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(-1.521315e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9220543), 'max': np.float32(0.6312092)}
2025-06-03 11:14:56,651 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-1.2360684e-08), 'std': np.float32(1.0), 'min': np.float32(-0.07879029), 'max': np.float32(20.468142)}
2025-06-03 11:14:56,651 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.7114793e-08), 'std': np.float32(1.0000001), 'min': np.float32(-4.265954), 'max': np.float32(20.952623)}
2025-06-03 11:14:56,651 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(2.9237771e-08), 'std': np.float32(1.0), 'min': np.float32(-0.09317699), 'max': np.float32(11.411963)}
2025-06-03 11:14:56,651 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(-1.521315e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0041893), 'max': np.float32(0.92082006)}
2025-06-03 11:14:56,651 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.10299175), 'max': np.float32(10.238108)}
2025-06-03 11:14:56,651 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-8.081986e-09), 'std': np.float32(0.9999999), 'min': np.float32(-7.996415), 'max': np.float32(0.12688437)}
2025-06-03 11:14:56,652 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(-4.563945e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3749828), 'max': np.float32(1.8203772)}
2025-06-03 11:14:56,652 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7199986), 'max': np.float32(2.4740193)}
2025-06-03 11:14:56,652 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(-7.606575e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7536675), 'max': np.float32(2.3832464)}
2025-06-03 11:14:56,652 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.2662325), 'max': np.float32(1.8184673)}
2025-06-03 11:14:56,652 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-9.508219e-10), 'std': np.float32(1.0), 'min': np.float32(-7.4122844), 'max': np.float32(0.15200283)}
2025-06-03 11:14:56,652 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(-1.9016436e-08), 'std': np.float32(0.99999994), 'min': np.float32(-4.1378107), 'max': np.float32(4.3496213)}
2025-06-03 11:14:56,652 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,652 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,653 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,653 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,653 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:14:56,664 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764e797470>
2025-06-03 11:14:56,787 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:14:56,986 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:14:57,012 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:14:58,188 - INFO - Node feature visualization saved to vis/node_features_20250603_111457.png
2025-06-03 11:14:58,188 - INFO - Finished visualization of node features.
2025-06-03 11:14:58,188 - INFO - Performing additional feature analysis:
2025-06-03 11:14:58,188 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:14:58,188 - INFO - Starting visualization of edge features.
2025-06-03 11:14:58,188 - INFO - Graph has 2202 edges and 22 edge features.
2025-06-03 11:14:58,188 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:14:58,188 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:14:58,188 - INFO - 
--- Processing file: nw_graph_encoded_1748870745.dot (Timestamp: 2025-06-02 15:25:45) ---
2025-06-03 11:14:58,188 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-03 11:14:58,188 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot file.
2025-06-03 11:14:58,242 - INFO - Parsed 1003 nodes.
2025-06-03 11:14:58,260 - INFO - Parsed 2202 edges.
2025-06-03 11:14:58,916 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:58,916 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:58,935 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-03 11:14:58,937 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:58,937 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-03 11:14:58,940 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-03 11:14:58,940 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:58,952 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:58,954 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:58,956 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 2])
2025-06-03 11:14:58,958 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:58,962 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 20])
2025-06-03 11:14:58,969 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 22])
2025-06-03 11:14:58,969 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:58,969 - INFO - Performing online update...
2025-06-03 11:14:58,969 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:58,970 - DEBUG - Updated RunningStats: new_mean=0.6487544309612362, new_var=57600000000012.695, new_n=5790
2025-06-03 11:14:58,970 - DEBUG - Updated RunningStats: new_mean=0.6486765694488345, new_var=57900000000006.984, new_n=5820
2025-06-03 11:14:58,970 - DEBUG - Updated RunningStats: new_mean=0.8544147021478042, new_var=30000000000038.438, new_n=3022
2025-06-03 11:14:58,970 - DEBUG - Updated RunningStats: new_mean=0.8556795350273503, new_var=30220000000002.184, new_n=3044
2025-06-03 11:14:58,971 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:58,971 - DEBUG - Online update step: 1/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 2/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 3/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 4/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 5/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 6/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 7/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 8/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 9/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 10/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 11/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 12/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 13/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 14/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 15/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 16/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 17/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 18/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 19/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 20/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 21/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 22/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 23/50
2025-06-03 11:14:58,971 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,971 - DEBUG - Online update step: 24/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 25/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 26/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 27/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 28/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 29/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 30/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 31/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 32/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 33/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 34/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 35/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 36/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 37/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 38/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 39/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 40/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 41/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 42/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 43/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 44/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 45/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 46/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 47/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 48/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 49/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - DEBUG - Online update step: 50/50
2025-06-03 11:14:58,972 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:58,972 - WARNING - No successful steps during online update.
2025-06-03 11:14:58,973 - DEBUG - Current node mean: [ 3.3278766e-08 -3.3278766e-08 -5.7049312e-09  6.6557528e-09
 -1.9016436e-08  2.0918081e-08 -5.7049312e-09 -1.5213150e-08
  5.7049312e-09  3.3754176e-08  7.6065749e-09  1.4262327e-08
 -1.1291010e-08 -3.1852533e-08  1.2360684e-08  0.0000000e+00
 -1.5213150e-08  0.0000000e+00  0.0000000e+00 -6.1803420e-09
  0.0000000e+00  0.0000000e+00 -1.4262327e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4255222e+00  5.6984558e+00 -1.2992838e-09  3.4647569e-09
 -8.6618923e-10 -4.3309458e-09  0.0000000e+00  0.0000000e+00
  6.0633245e-09  6.9295139e-09 -1.8623068e-08 -6.9295139e-09
  8.6618923e-10 -5.1971352e-09  2.2520920e-08 -3.4647569e-09
 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09 -3.4647569e-09
 -3.4647569e-09  0.0000000e+00]
2025-06-03 11:14:58,973 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:14:58,974 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:58,974 - INFO - Running anomaly detection...
2025-06-03 11:14:58,974 - INFO - Starting anomaly detection.
2025-06-03 11:14:58,988 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111458_update_47.json
2025-06-03 11:14:58,988 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:58,995 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111458_update_47.pth and as latest_checkpoint.pth
2025-06-03 11:14:58,995 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870745.dot): 0.2640
2025-06-03 11:14:58,995 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:58,995 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:58,995 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3440, MLP Score: 1.0000
2025-06-03 11:14:58,995 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6420, MLP Score: 1.0000
2025-06-03 11:14:58,995 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0568, MLP Score: 1.0000
2025-06-03 11:14:58,995 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8400, MLP Score: 1.0000
2025-06-03 11:14:58,995 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4632, MLP Score: 1.0000
2025-06-03 11:14:58,995 - INFO - 
--- Processing file: nw_graph_encoded_1748870775.dot (Timestamp: 2025-06-02 15:26:15) ---
2025-06-03 11:14:58,996 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-03 11:14:58,996 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot file.
2025-06-03 11:14:59,016 - INFO - Parsed 1005 nodes.
2025-06-03 11:14:59,036 - INFO - Parsed 2207 edges.
2025-06-03 11:14:59,716 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:14:59,716 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:14:59,735 - DEBUG - Initial node features tensor shape: torch.Size([1005, 30])
2025-06-03 11:14:59,736 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:14:59,737 - DEBUG - Node features tensor shape after scaling: torch.Size([1005, 30])
2025-06-03 11:14:59,739 - DEBUG - Edge index tensor shape: torch.Size([2, 2207])
2025-06-03 11:14:59,739 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:14:59,752 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:14:59,754 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:14:59,757 - DEBUG - Shape of encoded categorical edge features: torch.Size([2207, 2])
2025-06-03 11:14:59,763 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:14:59,771 - DEBUG - Shape of scaled numerical edge features: torch.Size([2207, 20])
2025-06-03 11:14:59,782 - DEBUG - Final edge attributes tensor shape: torch.Size([2207, 22])
2025-06-03 11:14:59,782 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:14:59,782 - INFO - Performing online update...
2025-06-03 11:14:59,782 - INFO - Starting online update for 50 steps.
2025-06-03 11:14:59,783 - DEBUG - Updated RunningStats: new_mean=0.6453500229189595, new_var=58200000000012.56, new_n=5850
2025-06-03 11:14:59,783 - DEBUG - Updated RunningStats: new_mean=0.6452903220967832, new_var=58500000000006.984, new_n=5880
2025-06-03 11:14:59,783 - DEBUG - Updated RunningStats: new_mean=0.851863818486956, new_var=30440000000038.402, new_n=3066
2025-06-03 11:14:59,783 - DEBUG - Updated RunningStats: new_mean=0.853128250531077, new_var=30660000000002.2, new_n=3088
2025-06-03 11:14:59,783 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:14:59,784 - DEBUG - Online update step: 1/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 2/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 3/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 4/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 5/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 6/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 7/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 8/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 9/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 10/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 11/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 12/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 13/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 14/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 15/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 16/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 17/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 18/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 19/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 20/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 21/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 22/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 23/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 24/50
2025-06-03 11:14:59,784 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,784 - DEBUG - Online update step: 25/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 26/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 27/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 28/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 29/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 30/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 31/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 32/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 33/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 34/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 35/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 36/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 37/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 38/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 39/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 40/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 41/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 42/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 43/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 44/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 45/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 46/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 47/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 48/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 49/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - DEBUG - Online update step: 50/50
2025-06-03 11:14:59,785 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:14:59,785 - WARNING - No successful steps during online update.
2025-06-03 11:14:59,786 - DEBUG - Current node mean: [ 3.4161467e-08 -3.4161467e-08 -2.0876453e-08  1.7080733e-08
 -1.6369036e-08  4.7446486e-10 -2.8349273e-08 -5.8715024e-09
 -1.4233945e-08 -1.3285016e-08  3.7957189e-09  1.3285016e-08
  3.2500843e-08 -3.7957189e-09 -2.2299847e-08 -2.1113685e-08
 -1.5420108e-08  0.0000000e+00  0.0000000e+00 -2.5621102e-08
  0.0000000e+00  0.0000000e+00  3.7957189e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4245583e+00  5.7014046e+00  3.0247940e-09  1.7284537e-09
  3.4569074e-09 -1.7284537e-09  1.7284537e-09  3.4569074e-09
  8.6422686e-10  0.0000000e+00 -1.3395516e-08  2.5926805e-09
  1.7284537e-09  1.2963403e-08 -2.1605671e-09 -1.0802835e-09
 -1.0802835e-09 -1.0802835e-09 -1.0802835e-09 -1.0802835e-09
 -1.0802835e-09 -3.4569074e-09]
2025-06-03 11:14:59,786 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0019
2025-06-03 11:14:59,786 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:14:59,786 - INFO - Running anomaly detection...
2025-06-03 11:14:59,787 - INFO - Starting anomaly detection.
2025-06-03 11:14:59,854 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111459_update_48.json
2025-06-03 11:14:59,854 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:14:59,862 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111459_update_48.pth and as latest_checkpoint.pth
2025-06-03 11:14:59,863 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870775.dot): 0.2449
2025-06-03 11:14:59,863 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:14:59,863 - WARNING - Detected 15 anomalous edges (reconstruction-based):
2025-06-03 11:14:59,863 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3451, MLP Score: 1.0000
2025-06-03 11:14:59,863 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6424, MLP Score: 1.0000
2025-06-03 11:14:59,863 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0655, MLP Score: 1.0000
2025-06-03 11:14:59,863 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8486, MLP Score: 1.0000
2025-06-03 11:14:59,863 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4641, MLP Score: 1.0000
2025-06-03 11:14:59,863 - INFO - 
--- Processing file: nw_graph_encoded_1748870805.dot (Timestamp: 2025-06-02 15:26:45) ---
2025-06-03 11:14:59,863 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-03 11:14:59,863 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot file.
2025-06-03 11:14:59,886 - INFO - Parsed 1009 nodes.
2025-06-03 11:14:59,909 - INFO - Parsed 2219 edges.
2025-06-03 11:15:00,547 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:15:00,547 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:15:00,563 - DEBUG - Initial node features tensor shape: torch.Size([1009, 30])
2025-06-03 11:15:00,564 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:15:00,564 - DEBUG - Node features tensor shape after scaling: torch.Size([1009, 30])
2025-06-03 11:15:00,566 - DEBUG - Edge index tensor shape: torch.Size([2, 2219])
2025-06-03 11:15:00,566 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:15:00,576 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:15:00,577 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:15:00,579 - DEBUG - Shape of encoded categorical edge features: torch.Size([2219, 2])
2025-06-03 11:15:00,581 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:15:00,581 - DEBUG - Shape of scaled numerical edge features: torch.Size([2219, 20])
2025-06-03 11:15:00,581 - DEBUG - Final edge attributes tensor shape: torch.Size([2219, 22])
2025-06-03 11:15:00,581 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:15:00,581 - INFO - Performing online update...
2025-06-03 11:15:00,581 - INFO - Starting online update for 50 steps.
2025-06-03 11:15:00,582 - DEBUG - Updated RunningStats: new_mean=0.6420147367022204, new_var=58800000000012.43, new_n=5910
2025-06-03 11:15:00,582 - DEBUG - Updated RunningStats: new_mean=0.6419724774567609, new_var=59100000000006.98, new_n=5940
2025-06-03 11:15:00,582 - DEBUG - Updated RunningStats: new_mean=0.8493833327446708, new_var=30880000000038.33, new_n=3110
2025-06-03 11:15:00,582 - DEBUG - Updated RunningStats: new_mean=0.8506486060785292, new_var=31100000000002.23, new_n=3132
2025-06-03 11:15:00,582 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:15:00,582 - DEBUG - Online update step: 1/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,582 - DEBUG - Online update step: 2/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,582 - DEBUG - Online update step: 3/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,582 - DEBUG - Online update step: 4/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,582 - DEBUG - Online update step: 5/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,582 - DEBUG - Online update step: 6/50
2025-06-03 11:15:00,582 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 7/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 8/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 9/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 10/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 11/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 12/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 13/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 14/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 15/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 16/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 17/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 18/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 19/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 20/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 21/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 22/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 23/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 24/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 25/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 26/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 27/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 28/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 29/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,583 - DEBUG - Online update step: 30/50
2025-06-03 11:15:00,583 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 31/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 32/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 33/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 34/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 35/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 36/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 37/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 38/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 39/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 40/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 41/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 42/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 43/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 44/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 45/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 46/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 47/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 48/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 49/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - DEBUG - Online update step: 50/50
2025-06-03 11:15:00,584 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:00,584 - WARNING - No successful steps during online update.
2025-06-03 11:15:00,585 - DEBUG - Current node mean: [-8.9790939e-09  8.9790939e-09  2.4574362e-08 -1.2464400e-08
  5.1984230e-09 -2.0321108e-08 -7.5613427e-09  1.3232349e-08
 -5.1984230e-09  2.0793692e-08  3.7806711e-08  3.3080874e-09
  7.5613427e-09 -2.2211443e-08  9.4516783e-10 -1.4177517e-08
  8.9790939e-09  0.0000000e+00  0.0000000e+00 -3.4853063e-08
  0.0000000e+00  0.0000000e+00 -2.4574362e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4222623e+00  5.6998649e+00  3.4382130e-09  0.0000000e+00
  0.0000000e+00  3.4382130e-09  1.7191065e-09 -1.7191065e-09
 -2.5786597e-09  1.7191065e-09  3.4382130e-09  1.0314639e-08
  0.0000000e+00 -1.6331512e-08  1.7191065e-08 -8.5955326e-10
 -8.5955326e-10 -8.5955326e-10 -8.5955326e-10 -8.5955326e-10
 -8.5955326e-10  5.1573195e-09]
2025-06-03 11:15:00,585 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0045
2025-06-03 11:15:00,585 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:15:00,585 - INFO - Running anomaly detection...
2025-06-03 11:15:00,585 - INFO - Starting anomaly detection.
2025-06-03 11:15:00,599 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111500_update_49.json
2025-06-03 11:15:00,600 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:15:00,606 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111500_update_49.pth and as latest_checkpoint.pth
2025-06-03 11:15:00,606 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870805.dot): 0.2519
2025-06-03 11:15:00,606 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:15:00,606 - WARNING - Detected 16 anomalous edges (reconstruction-based):
2025-06-03 11:15:00,606 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3420, MLP Score: 1.0000
2025-06-03 11:15:00,606 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6399, MLP Score: 1.0000
2025-06-03 11:15:00,606 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0560, MLP Score: 1.0000
2025-06-03 11:15:00,606 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8391, MLP Score: 1.0000
2025-06-03 11:15:00,606 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4656, MLP Score: 1.0000
2025-06-03 11:15:00,606 - INFO - 
--- Processing file: nw_graph_encoded_1748870835.dot (Timestamp: 2025-06-02 15:27:15) ---
2025-06-03 11:15:00,606 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-03 11:15:00,606 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot file.
2025-06-03 11:15:00,623 - INFO - Parsed 1010 nodes.
2025-06-03 11:15:00,641 - INFO - Parsed 2220 edges.
2025-06-03 11:15:01,270 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:15:01,270 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:15:01,287 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 11:15:01,289 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:15:01,289 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 11:15:01,290 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 11:15:01,290 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:15:01,300 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:15:01,301 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:15:01,303 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 2])
2025-06-03 11:15:01,304 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:15:01,305 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 20])
2025-06-03 11:15:01,305 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 22])
2025-06-03 11:15:01,305 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:15:01,305 - INFO - Performing online update...
2025-06-03 11:15:01,305 - INFO - Starting online update for 50 steps.
2025-06-03 11:15:01,306 - DEBUG - Updated RunningStats: new_mean=0.6387464850946044, new_var=59400000000012.305, new_n=5970
2025-06-03 11:15:01,306 - DEBUG - Updated RunningStats: new_mean=0.6387209882095214, new_var=59700000000006.98, new_n=6000
2025-06-03 11:15:01,306 - DEBUG - Updated RunningStats: new_mean=0.8469733534279386, new_var=31320000000038.277, new_n=3154
2025-06-03 11:15:01,306 - DEBUG - Updated RunningStats: new_mean=0.8482376842491112, new_var=31540000000002.25, new_n=3176
2025-06-03 11:15:01,306 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:15:01,306 - DEBUG - Online update step: 1/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 2/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 3/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 4/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 5/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 6/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 7/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 8/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 9/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 10/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 11/50
2025-06-03 11:15:01,306 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,306 - DEBUG - Online update step: 12/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 13/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 14/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 15/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 16/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 17/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 18/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 19/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 20/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 21/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 22/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 23/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 24/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 25/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 26/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 27/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 28/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 29/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 30/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 31/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 32/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 33/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 34/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,307 - DEBUG - Online update step: 35/50
2025-06-03 11:15:01,307 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 36/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 37/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 38/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 39/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 40/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 41/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 42/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 43/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 44/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 45/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 46/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 47/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 48/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 49/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - DEBUG - Online update step: 50/50
2025-06-03 11:15:01,308 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:01,308 - WARNING - No successful steps during online update.
2025-06-03 11:15:01,309 - DEBUG - Current node mean: [ 1.8884641e-09 -1.8884641e-09  9.4423198e-09  2.6438496e-08
 -5.3113048e-08  1.6051944e-08  4.2490438e-09 -1.6996175e-08
 -3.5408700e-09  1.7940408e-08 -9.4423198e-09  0.0000000e+00
 -2.3605800e-08  3.3048120e-09 -3.7769279e-08  5.6653922e-09
 -9.4423203e-10  0.0000000e+00  0.0000000e+00  2.4550031e-08
  0.0000000e+00  0.0000000e+00 -4.0601975e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4220721e+00  5.7004504e+00  0.0000000e+00 -1.7183321e-09
 -8.5916607e-10  8.5916607e-10  8.5916607e-10  0.0000000e+00
  0.0000000e+00 -5.1549964e-09  2.1049567e-08 -1.7183321e-09
 -1.7183321e-09  0.0000000e+00 -1.1169159e-08  6.4437455e-10
  6.4437455e-10  6.4437455e-10  6.4437455e-10  6.4437455e-10
  6.4437455e-10 -3.8662473e-09]
2025-06-03 11:15:01,309 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0004
2025-06-03 11:15:01,309 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:15:01,309 - INFO - Running anomaly detection...
2025-06-03 11:15:01,309 - INFO - Starting anomaly detection.
2025-06-03 11:15:01,322 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111501_update_50.json
2025-06-03 11:15:01,322 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:15:01,329 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111501_update_50.pth and as latest_checkpoint.pth
2025-06-03 11:15:01,329 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870835.dot): 0.2517
2025-06-03 11:15:01,329 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:15:01,329 - WARNING - Detected 16 anomalous edges (reconstruction-based):
2025-06-03 11:15:01,329 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3424, MLP Score: 1.0000
2025-06-03 11:15:01,329 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6402, MLP Score: 1.0000
2025-06-03 11:15:01,329 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0581, MLP Score: 1.0000
2025-06-03 11:15:01,329 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8412, MLP Score: 1.0000
2025-06-03 11:15:01,329 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4658, MLP Score: 1.0000
2025-06-03 11:15:01,329 - INFO - 
--- Processing file: nw_graph_encoded_1748870865.dot (Timestamp: 2025-06-02 15:27:45) ---
2025-06-03 11:15:01,329 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-03 11:15:01,329 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot file.
2025-06-03 11:15:01,348 - INFO - Parsed 1010 nodes.
2025-06-03 11:15:01,368 - INFO - Parsed 2220 edges.
2025-06-03 11:15:01,994 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:15:01,994 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:15:02,010 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 11:15:02,012 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:15:02,012 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 11:15:02,013 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 11:15:02,013 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:15:02,024 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:15:02,025 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:15:02,027 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 2])
2025-06-03 11:15:02,028 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:15:02,029 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 20])
2025-06-03 11:15:02,029 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 22])
2025-06-03 11:15:02,029 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:15:02,029 - INFO - Performing online update...
2025-06-03 11:15:02,029 - INFO - Starting online update for 50 steps.
2025-06-03 11:15:02,030 - DEBUG - Updated RunningStats: new_mean=0.6355432718372731, new_var=60000000000012.18, new_n=6030
2025-06-03 11:15:02,030 - DEBUG - Updated RunningStats: new_mean=0.6355338848879698, new_var=60300000000006.98, new_n=6060
2025-06-03 11:15:02,030 - DEBUG - Updated RunningStats: new_mean=0.8446295833799068, new_var=31760000000038.223, new_n=3198
2025-06-03 11:15:02,030 - DEBUG - Updated RunningStats: new_mean=0.8458926509665842, new_var=31980000000002.27, new_n=3220
2025-06-03 11:15:02,030 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:15:02,030 - DEBUG - Online update step: 1/50
2025-06-03 11:15:02,030 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,030 - DEBUG - Online update step: 2/50
2025-06-03 11:15:02,030 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,030 - DEBUG - Online update step: 3/50
2025-06-03 11:15:02,030 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,030 - DEBUG - Online update step: 4/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 5/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 6/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 7/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 8/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 9/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 10/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 11/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 12/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 13/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 14/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 15/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 16/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 17/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 18/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 19/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 20/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 21/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 22/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 23/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 24/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 25/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,031 - DEBUG - Online update step: 26/50
2025-06-03 11:15:02,031 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 27/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 28/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 29/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 30/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 31/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 32/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 33/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 34/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 35/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 36/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 37/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 38/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 39/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 40/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 41/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 42/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 43/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 44/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 45/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 46/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 47/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 48/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,032 - DEBUG - Online update step: 49/50
2025-06-03 11:15:02,032 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,033 - DEBUG - Online update step: 50/50
2025-06-03 11:15:02,033 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:02,033 - WARNING - No successful steps during online update.
2025-06-03 11:15:02,033 - DEBUG - Current node mean: [ 1.8884641e-09 -1.8884641e-09  9.4423198e-09  2.6438496e-08
 -5.3113048e-08  1.6051944e-08  4.2490438e-09 -1.6996175e-08
 -3.5408700e-09  1.7940408e-08 -9.4423198e-09  0.0000000e+00
 -2.3605800e-08  3.3048120e-09 -3.7769279e-08  5.6653922e-09
 -9.4423203e-10  0.0000000e+00  0.0000000e+00  2.4550031e-08
  0.0000000e+00  0.0000000e+00 -4.0601975e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4220721e+00  5.7004504e+00  0.0000000e+00 -1.7183321e-09
 -8.5916607e-10  8.5916607e-10  8.5916607e-10  0.0000000e+00
  0.0000000e+00 -5.1549964e-09  2.1049567e-08 -1.7183321e-09
 -1.7183321e-09  0.0000000e+00 -1.1169159e-08  6.4437455e-10
  6.4437455e-10  6.4437455e-10  6.4437455e-10  6.4437455e-10
  6.4437455e-10 -3.8662473e-09]
2025-06-03 11:15:02,033 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:15:02,033 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:15:02,034 - INFO - Running anomaly detection...
2025-06-03 11:15:02,034 - INFO - Starting anomaly detection.
2025-06-03 11:15:02,048 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111502_update_51.json
2025-06-03 11:15:02,049 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:15:02,055 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111502_update_51.pth and as latest_checkpoint.pth
2025-06-03 11:15:02,055 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870865.dot): 0.2517
2025-06-03 11:15:02,055 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:15:02,055 - WARNING - Detected 16 anomalous edges (reconstruction-based):
2025-06-03 11:15:02,055 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3424, MLP Score: 1.0000
2025-06-03 11:15:02,055 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6402, MLP Score: 1.0000
2025-06-03 11:15:02,055 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0581, MLP Score: 1.0000
2025-06-03 11:15:02,055 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8412, MLP Score: 1.0000
2025-06-03 11:15:02,055 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4658, MLP Score: 1.0000
2025-06-03 11:15:02,055 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 11:15:02,055 - INFO - Performing visualization of node and edge features.
2025-06-03 11:15:02,055 - INFO - Starting visualization of node features.
2025-06-03 11:15:02,055 - INFO - Graph has 1010 nodes and 30 features.
2025-06-03 11:15:02,055 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, activity_span_hours, connection_consistency, http_ratio, user_agent_diversity, http_error_ratio, ssl_ratio, ssl_version_diversity, ssl_cipher_diversity, ssl_resumption_ratio, sni_usage_ratio, degree_centrality, betweenness_centrality, clustering_coefficient
2025-06-03 11:15:02,055 - INFO - Calculating feature statistics:
2025-06-03 11:15:02,056 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(1.3219248e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10736676), 'max': np.float32(9.492987)}
2025-06-03 11:15:02,056 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-1.3219248e-08), 'std': np.float32(1.0), 'min': np.float32(-9.492987), 'max': np.float32(0.10736676)}
2025-06-03 11:15:02,056 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(7.553856e-09), 'std': np.float32(1.0), 'min': np.float32(-2.293084), 'max': np.float32(3.180346)}
2025-06-03 11:15:02,056 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.7940408e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.075362094), 'max': np.float32(18.190908)}
2025-06-03 11:15:02,056 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-4.5323137e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-03 11:15:02,056 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6501608), 'max': np.float32(2.8871508)}
2025-06-03 11:15:02,056 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(7.553856e-09), 'std': np.float32(1.0), 'min': np.float32(-2.908423), 'max': np.float32(0.6337527)}
2025-06-03 11:15:02,056 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(-1.0386552e-08), 'std': np.float32(1.0), 'min': np.float32(-0.0785151), 'max': np.float32(20.539549)}
2025-06-03 11:15:02,056 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-03 11:15:02,056 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(2.7854844e-08), 'std': np.float32(1.0), 'min': np.float32(-0.09284631), 'max': np.float32(11.452029)}
2025-06-03 11:15:02,056 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(-7.553856e-09), 'std': np.float32(0.99999994), 'min': np.float32(-2.002105), 'max': np.float32(0.9204403)}
2025-06-03 11:15:02,057 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-5.665392e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-03 11:15:02,057 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.888464e-08), 'std': np.float32(0.9999998), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-03 11:15:02,057 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-2.8924828), 'max': np.float32(1.7927723)}
2025-06-03 11:15:02,057 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(4.5323137e-08), 'std': np.float32(1.0), 'min': np.float32(-1.6894896), 'max': np.float32(3.0762463)}
2025-06-03 11:15:02,057 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 28, 'mean': np.float32(1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8124613), 'max': np.float32(2.262018)}
2025-06-03 11:15:02,057 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 28, 'mean': np.float32(1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-2.1380558), 'max': np.float32(1.8795011)}
2025-06-03 11:15:02,057 - INFO - - activity_span_hours: {'name': 'activity_span_hours', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,057 - INFO - - connection_consistency: {'name': 'connection_consistency', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,057 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(1.7940408e-08), 'std': np.float32(1.0), 'min': np.float32(-7.438571), 'max': np.float32(0.15145907)}
2025-06-03 11:15:02,057 - INFO - - user_agent_diversity: {'name': 'user_agent_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,057 - INFO - - http_error_ratio: {'name': 'http_error_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,057 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(-3.8713512e-08), 'std': np.float32(0.99999994), 'min': np.float32(-4.1491838), 'max': np.float32(4.3604383)}
2025-06-03 11:15:02,057 - INFO - - ssl_version_diversity: {'name': 'ssl_version_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,057 - INFO - - ssl_cipher_diversity: {'name': 'ssl_cipher_diversity', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,058 - INFO - - ssl_resumption_ratio: {'name': 'ssl_resumption_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,058 - INFO - - sni_usage_ratio: {'name': 'sni_usage_ratio', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,058 - INFO - - degree_centrality: {'name': 'degree_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,058 - INFO - - betweenness_centrality: {'name': 'betweenness_centrality', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,058 - INFO - - clustering_coefficient: {'name': 'clustering_coefficient', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 11:15:02,069 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7a764e7942f0>
2025-06-03 11:15:02,192 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 11:15:02,397 - DEBUG - Plotted ranges of node feature values.
2025-06-03 11:15:02,424 - DEBUG - Plotted sparsity of node features.
2025-06-03 11:15:03,654 - INFO - Node feature visualization saved to vis/node_features_20250603_111502.png
2025-06-03 11:15:03,654 - INFO - Finished visualization of node features.
2025-06-03 11:15:03,654 - INFO - Performing additional feature analysis:
2025-06-03 11:15:03,654 - INFO - - Maximum correlation between different features: nan
2025-06-03 11:15:03,654 - INFO - Starting visualization of edge features.
2025-06-03 11:15:03,654 - INFO - Graph has 2220 edges and 22 edge features.
2025-06-03 11:15:03,654 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 11:15:03,655 - ERROR - Error during visualization: Expected 22 names, got 10
2025-06-03 11:15:03,655 - INFO - 
--- Processing file: nw_graph_encoded_1748870895.dot (Timestamp: 2025-06-02 15:28:15) ---
2025-06-03 11:15:03,655 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-03 11:15:03,655 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot file.
2025-06-03 11:15:03,673 - INFO - Parsed 1010 nodes.
2025-06-03 11:15:03,693 - INFO - Parsed 2220 edges.
2025-06-03 11:15:04,364 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 11:15:04,365 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'activity_span_hours', 'connection_consistency', 'http_ratio', 'user_agent_diversity', 'http_error_ratio', 'ssl_ratio', 'ssl_version_diversity', 'ssl_cipher_diversity', 'ssl_resumption_ratio', 'sni_usage_ratio', 'degree_centrality', 'betweenness_centrality', 'clustering_coefficient']
2025-06-03 11:15:04,381 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-03 11:15:04,382 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 11:15:04,382 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-03 11:15:04,383 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-03 11:15:04,383 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 11:15:04,394 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 11:15:04,395 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 11:15:04,397 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 2])
2025-06-03 11:15:04,399 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 11:15:04,399 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 20])
2025-06-03 11:15:04,399 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 22])
2025-06-03 11:15:04,399 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 11:15:04,399 - INFO - Performing online update...
2025-06-03 11:15:04,399 - INFO - Starting online update for 50 steps.
2025-06-03 11:15:04,400 - DEBUG - Updated RunningStats: new_mean=0.6324031760825494, new_var=60600000000012.055, new_n=6090
2025-06-03 11:15:04,400 - DEBUG - Updated RunningStats: new_mean=0.6324092737884094, new_var=60900000000006.98, new_n=6120
2025-06-03 11:15:04,400 - DEBUG - Updated RunningStats: new_mean=0.8423494320130062, new_var=32200000000038.168, new_n=3242
2025-06-03 11:15:04,400 - DEBUG - Updated RunningStats: new_mean=0.8436108416205959, new_var=32420000000002.29, new_n=3264
2025-06-03 11:15:04,400 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 11:15:04,400 - DEBUG - Online update step: 1/50
2025-06-03 11:15:04,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,400 - DEBUG - Online update step: 2/50
2025-06-03 11:15:04,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,400 - DEBUG - Online update step: 3/50
2025-06-03 11:15:04,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 4/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 5/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 6/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 7/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 8/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 9/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 10/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 11/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 12/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 13/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 14/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 15/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 16/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 17/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 18/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 19/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 20/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 21/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 22/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 23/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 24/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 25/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,401 - DEBUG - Online update step: 26/50
2025-06-03 11:15:04,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 27/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 28/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 29/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 30/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 31/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 32/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 33/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 34/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 35/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 36/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 37/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 38/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 39/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 40/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 41/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 42/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 43/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 44/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 45/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 46/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 47/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 48/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 49/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,402 - DEBUG - Online update step: 50/50
2025-06-03 11:15:04,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-03 11:15:04,403 - WARNING - No successful steps during online update.
2025-06-03 11:15:04,403 - DEBUG - Current node mean: [ 1.8884641e-09 -1.8884641e-09  9.4423198e-09  2.6438496e-08
 -5.3113048e-08  1.6051944e-08  4.2490438e-09 -1.6996175e-08
 -3.5408700e-09  1.7940408e-08 -9.4423198e-09  0.0000000e+00
 -2.3605800e-08  3.3048120e-09 -3.7769279e-08  5.6653922e-09
 -9.4423203e-10  0.0000000e+00  0.0000000e+00  2.4550031e-08
  0.0000000e+00  0.0000000e+00 -4.0601975e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00], current edge mean: [ 1.4220721e+00  5.7004504e+00  0.0000000e+00 -1.7183321e-09
 -8.5916607e-10  8.5916607e-10  8.5916607e-10  0.0000000e+00
  0.0000000e+00 -5.1549964e-09  2.1049567e-08 -1.7183321e-09
 -1.7183321e-09  0.0000000e+00 -1.1169159e-08  6.4437455e-10
  6.4437455e-10  6.4437455e-10  6.4437455e-10  6.4437455e-10
  6.4437455e-10 -3.8662473e-09]
2025-06-03 11:15:04,403 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-03 11:15:04,403 - INFO - Online update complete. Loss: 0.0000
2025-06-03 11:15:04,403 - INFO - Running anomaly detection...
2025-06-03 11:15:04,404 - INFO - Starting anomaly detection.
2025-06-03 11:15:04,416 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_111504_update_52.json
2025-06-03 11:15:04,416 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 11:15:04,422 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_111504_update_52.pth and as latest_checkpoint.pth
2025-06-03 11:15:04,422 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870895.dot): 0.2517
2025-06-03 11:15:04,422 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-03 11:15:04,422 - WARNING - Detected 16 anomalous edges (reconstruction-based):
2025-06-03 11:15:04,422 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 2.3424, MLP Score: 1.0000
2025-06-03 11:15:04,422 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 1.6402, MLP Score: 1.0000
2025-06-03 11:15:04,422 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.0581, MLP Score: 1.0000
2025-06-03 11:15:04,422 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 9.8412, MLP Score: 1.0000
2025-06-03 11:15:04,423 - WARNING -   Source: 192.168.27.13, Target: 156.146.44.89, Recon Error: 1.4658, MLP Score: 1.0000
2025-06-03 11:15:04,423 - INFO - Finished processing all files in the directory.
