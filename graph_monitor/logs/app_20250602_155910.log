2025-06-02 15:59:10,873 - INFO - Application logging to file: logs/app_20250602_155910.log
2025-06-02 15:59:10,873 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 15:59:10,873 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-02 15:59:10,874 - INFO - 
--- Processing file: nw_graph_encoded_1748869125.dot (Timestamp: 2025-06-02 14:58:45) ---
2025-06-02 15:59:10,874 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:59:10,874 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869125.dot
2025-06-02 15:59:10,874 - INFO - Parsed 7 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:59:10,874 - INFO - Parsed 5 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869125.dot'.
2025-06-02 15:59:10,874 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:10,874 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:10,874 - DEBUG - Initial node features tensor shape: torch.Size([7, 30])
2025-06-02 15:59:10,875 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:10,875 - DEBUG - Node features tensor shape after scaling: torch.Size([7, 30])
2025-06-02 15:59:10,875 - DEBUG - Edge index tensor shape: torch.Size([2, 5])
2025-06-02 15:59:10,876 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:10,876 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 3
2025-06-02 15:59:10,876 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-02 15:59:10,876 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 3
2025-06-02 15:59:10,876 - DEBUG - Shape of encoded categorical edge features: torch.Size([5, 3])
2025-06-02 15:59:10,877 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:10,877 - DEBUG - Shape of scaled numerical edge features: torch.Size([5, 7])
2025-06-02 15:59:10,877 - DEBUG - Final edge attributes tensor shape: torch.Size([5, 10])
2025-06-02 15:59:10,877 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:10,877 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 15:59:10,877 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=64, embedding_dim=32
2025-06-02 15:59:10,911 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 15:59:10,911 - DEBUG - Decoder MLP layers initialized.
2025-06-02 15:59:10,912 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 15:59:10,912 - INFO - Optimizer and scheduler initialized.
2025-06-02 15:59:10,912 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 15:59:10,912 - INFO - RunningStats initialized.
2025-06-02 15:59:10,912 - INFO - RunningStats initialized.
2025-06-02 15:59:10,912 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 15:59:10,912 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 15:59:10,912 - INFO - Using device: cpu
2025-06-02 15:59:10,912 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-02 15:59:10,913 - INFO - Performing initial training for 100 epochs...
2025-06-02 15:59:10,916 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,916 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,924 - INFO - Epoch 1/100, Loss: 6.4911
2025-06-02 15:59:10,926 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,927 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,933 - INFO - Epoch 2/100, Loss: 6.3936
2025-06-02 15:59:10,936 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,936 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,936 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,942 - INFO - Epoch 3/100, Loss: 6.2911
2025-06-02 15:59:10,945 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,946 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,952 - INFO - Epoch 4/100, Loss: 6.1810
2025-06-02 15:59:10,955 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,955 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,962 - INFO - Epoch 5/100, Loss: 6.0934
2025-06-02 15:59:10,965 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,966 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,972 - INFO - Epoch 6/100, Loss: 6.0113
2025-06-02 15:59:10,975 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,976 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,983 - INFO - Epoch 7/100, Loss: 5.9328
2025-06-02 15:59:10,986 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,987 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:10,993 - INFO - Epoch 8/100, Loss: 5.8582
2025-06-02 15:59:10,996 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:10,997 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:10,997 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,004 - INFO - Epoch 9/100, Loss: 5.7743
2025-06-02 15:59:11,007 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,007 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,014 - INFO - Epoch 10/100, Loss: 5.6848
2025-06-02 15:59:11,018 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,018 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,019 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,025 - INFO - Epoch 11/100, Loss: 5.5857
2025-06-02 15:59:11,028 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,029 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,036 - INFO - Epoch 12/100, Loss: 5.4797
2025-06-02 15:59:11,039 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,039 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,046 - INFO - Epoch 13/100, Loss: 5.3691
2025-06-02 15:59:11,049 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,050 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,057 - INFO - Epoch 14/100, Loss: 5.2495
2025-06-02 15:59:11,060 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,060 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,067 - INFO - Epoch 15/100, Loss: 5.1180
2025-06-02 15:59:11,071 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,071 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,080 - INFO - Epoch 16/100, Loss: 4.9783
2025-06-02 15:59:11,084 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,084 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,096 - INFO - Epoch 17/100, Loss: 4.8308
2025-06-02 15:59:11,110 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,110 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,126 - INFO - Epoch 18/100, Loss: 4.6732
2025-06-02 15:59:11,134 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,134 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,151 - INFO - Epoch 19/100, Loss: 4.5047
2025-06-02 15:59:11,157 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,158 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,177 - INFO - Epoch 20/100, Loss: 4.3245
2025-06-02 15:59:11,186 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,186 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,199 - INFO - Epoch 21/100, Loss: 4.1359
2025-06-02 15:59:11,204 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,204 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,205 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,214 - INFO - Epoch 22/100, Loss: 3.9376
2025-06-02 15:59:11,219 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,219 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,220 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,228 - INFO - Epoch 23/100, Loss: 3.7308
2025-06-02 15:59:11,232 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,233 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,234 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,244 - INFO - Epoch 24/100, Loss: 3.5182
2025-06-02 15:59:11,248 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,248 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,258 - INFO - Epoch 25/100, Loss: 3.3013
2025-06-02 15:59:11,262 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,262 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,271 - INFO - Epoch 26/100, Loss: 3.0776
2025-06-02 15:59:11,275 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,275 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,276 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,285 - INFO - Epoch 27/100, Loss: 2.8574
2025-06-02 15:59:11,291 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,292 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,309 - INFO - Epoch 28/100, Loss: 2.6389
2025-06-02 15:59:11,316 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,317 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,341 - INFO - Epoch 29/100, Loss: 2.4258
2025-06-02 15:59:11,343 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,343 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,357 - INFO - Epoch 30/100, Loss: 2.2216
2025-06-02 15:59:11,371 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,372 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,389 - INFO - Epoch 31/100, Loss: 2.0274
2025-06-02 15:59:11,396 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,396 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,399 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,405 - INFO - Epoch 32/100, Loss: 1.8535
2025-06-02 15:59:11,408 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,408 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,410 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,414 - INFO - Epoch 33/100, Loss: 1.7037
2025-06-02 15:59:11,416 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,416 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,419 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,425 - INFO - Epoch 34/100, Loss: 1.5810
2025-06-02 15:59:11,427 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,428 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,431 - INFO - Epoch 35/100, Loss: 1.4865
2025-06-02 15:59:11,434 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,434 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,440 - INFO - Epoch 36/100, Loss: 1.4169
2025-06-02 15:59:11,444 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,445 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,445 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,448 - INFO - Epoch 37/100, Loss: 1.3732
2025-06-02 15:59:11,452 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,452 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,464 - INFO - Epoch 38/100, Loss: 1.3444
2025-06-02 15:59:11,468 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,469 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,474 - INFO - Epoch 39/100, Loss: 1.3221
2025-06-02 15:59:11,477 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,478 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,485 - INFO - Epoch 40/100, Loss: 1.2952
2025-06-02 15:59:11,489 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,489 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,496 - INFO - Epoch 41/100, Loss: 1.2658
2025-06-02 15:59:11,502 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,503 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,522 - INFO - Epoch 42/100, Loss: 1.2285
2025-06-02 15:59:11,526 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,526 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,541 - INFO - Epoch 43/100, Loss: 1.1916
2025-06-02 15:59:11,589 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,589 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,600 - INFO - Epoch 44/100, Loss: 1.1489
2025-06-02 15:59:11,602 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,602 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,620 - INFO - Epoch 45/100, Loss: 1.1130
2025-06-02 15:59:11,628 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,628 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,642 - INFO - Epoch 46/100, Loss: 1.0820
2025-06-02 15:59:11,648 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,649 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,660 - INFO - Epoch 47/100, Loss: 1.0532
2025-06-02 15:59:11,666 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,667 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,691 - INFO - Epoch 48/100, Loss: 1.0403
2025-06-02 15:59:11,697 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,697 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,698 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,702 - INFO - Epoch 49/100, Loss: 1.0316
2025-06-02 15:59:11,751 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,751 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,859 - INFO - Epoch 50/100, Loss: 1.0256
2025-06-02 15:59:11,862 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,862 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,878 - INFO - Epoch 51/100, Loss: 1.0291
2025-06-02 15:59:11,880 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,880 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,886 - INFO - Epoch 52/100, Loss: 1.0309
2025-06-02 15:59:11,890 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,891 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,895 - INFO - Epoch 53/100, Loss: 1.0343
2025-06-02 15:59:11,898 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,899 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,903 - INFO - Epoch 54/100, Loss: 1.0375
2025-06-02 15:59:11,908 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,909 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,909 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,919 - INFO - Epoch 55/100, Loss: 1.0362
2025-06-02 15:59:11,930 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,930 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,946 - INFO - Epoch 56/100, Loss: 1.0347
2025-06-02 15:59:11,955 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,956 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,971 - INFO - Epoch 57/100, Loss: 1.0284
2025-06-02 15:59:11,976 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,977 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,977 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:11,989 - INFO - Epoch 58/100, Loss: 1.0218
2025-06-02 15:59:11,994 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:11,995 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:11,995 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,006 - INFO - Epoch 59/100, Loss: 1.0112
2025-06-02 15:59:12,013 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,013 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,027 - INFO - Epoch 60/100, Loss: 1.0040
2025-06-02 15:59:12,031 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,031 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,039 - INFO - Epoch 61/100, Loss: 0.9932
2025-06-02 15:59:12,044 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,044 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,045 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,052 - INFO - Epoch 62/100, Loss: 0.9842
2025-06-02 15:59:12,056 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,057 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,066 - INFO - Epoch 63/100, Loss: 0.9753
2025-06-02 15:59:12,070 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,071 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,078 - INFO - Epoch 64/100, Loss: 0.9690
2025-06-02 15:59:12,082 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,082 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,090 - INFO - Epoch 65/100, Loss: 0.9629
2025-06-02 15:59:12,093 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,094 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,101 - INFO - Epoch 66/100, Loss: 0.9544
2025-06-02 15:59:12,104 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,105 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,118 - INFO - Epoch 67/100, Loss: 0.9517
2025-06-02 15:59:12,122 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,123 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,140 - INFO - Epoch 68/100, Loss: 0.9459
2025-06-02 15:59:12,151 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,151 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,174 - INFO - Epoch 69/100, Loss: 0.9405
2025-06-02 15:59:12,184 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,185 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,210 - INFO - Epoch 70/100, Loss: 0.9352
2025-06-02 15:59:12,223 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,223 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,227 - INFO - Epoch 71/100, Loss: 0.9253
2025-06-02 15:59:12,229 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,230 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,230 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,233 - INFO - Epoch 72/100, Loss: 0.9229
2025-06-02 15:59:12,237 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,237 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,238 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,241 - INFO - Epoch 73/100, Loss: 0.9170
2025-06-02 15:59:12,244 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,244 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,248 - INFO - Epoch 74/100, Loss: 0.9057
2025-06-02 15:59:12,250 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,250 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,255 - INFO - Epoch 75/100, Loss: 0.8982
2025-06-02 15:59:12,258 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,258 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,261 - INFO - Epoch 76/100, Loss: 0.8925
2025-06-02 15:59:12,263 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,263 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,267 - INFO - Epoch 77/100, Loss: 0.8827
2025-06-02 15:59:12,270 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,270 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,270 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,274 - INFO - Epoch 78/100, Loss: 0.8775
2025-06-02 15:59:12,276 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,276 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,280 - INFO - Epoch 79/100, Loss: 0.8727
2025-06-02 15:59:12,282 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,282 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,285 - INFO - Epoch 80/100, Loss: 0.8645
2025-06-02 15:59:12,287 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,287 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,288 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,291 - INFO - Epoch 81/100, Loss: 0.8594
2025-06-02 15:59:12,293 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,293 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,297 - INFO - Epoch 82/100, Loss: 0.8555
2025-06-02 15:59:12,299 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,299 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,299 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,302 - INFO - Epoch 83/100, Loss: 0.8477
2025-06-02 15:59:12,304 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,304 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,307 - INFO - Epoch 84/100, Loss: 0.8443
2025-06-02 15:59:12,309 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,309 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,312 - INFO - Epoch 85/100, Loss: 0.8405
2025-06-02 15:59:12,315 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,315 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,318 - INFO - Epoch 86/100, Loss: 0.8332
2025-06-02 15:59:12,321 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,321 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,326 - INFO - Epoch 87/100, Loss: 0.8275
2025-06-02 15:59:12,331 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,331 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,338 - INFO - Epoch 88/100, Loss: 0.8238
2025-06-02 15:59:12,344 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,344 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,353 - INFO - Epoch 89/100, Loss: 0.8173
2025-06-02 15:59:12,362 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,362 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,373 - INFO - Epoch 90/100, Loss: 0.8124
2025-06-02 15:59:12,376 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,377 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,378 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,387 - INFO - Epoch 91/100, Loss: 0.8098
2025-06-02 15:59:12,393 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,394 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,413 - INFO - Epoch 92/100, Loss: 0.8017
2025-06-02 15:59:12,426 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,427 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,443 - INFO - Epoch 93/100, Loss: 0.7976
2025-06-02 15:59:12,448 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,449 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,457 - INFO - Epoch 94/100, Loss: 0.7943
2025-06-02 15:59:12,461 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,462 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,470 - INFO - Epoch 95/100, Loss: 0.7858
2025-06-02 15:59:12,475 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,476 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,483 - INFO - Epoch 96/100, Loss: 0.7829
2025-06-02 15:59:12,487 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,487 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,488 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,495 - INFO - Epoch 97/100, Loss: 0.7798
2025-06-02 15:59:12,498 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,499 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,506 - INFO - Epoch 98/100, Loss: 0.7726
2025-06-02 15:59:12,511 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,511 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,519 - INFO - Epoch 99/100, Loss: 0.7672
2025-06-02 15:59:12,523 - DEBUG - Node anomaly scores shape: torch.Size([7, 1])
2025-06-02 15:59:12,523 - DEBUG - Edge anomaly scores shape: torch.Size([5, 1])
2025-06-02 15:59:12,524 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:12,533 - INFO - Epoch 100/100, Loss: 0.7633
2025-06-02 15:59:12,535 - INFO - Initial training complete.
2025-06-02 15:59:12,535 - INFO - No checkpoint found. Starting from scratch.
2025-06-02 15:59:12,535 - INFO - Starting or resuming online updates from step: 0
2025-06-02 15:59:12,535 - INFO - No running statistics file found. Starting with new statistics.
2025-06-02 15:59:12,536 - INFO - Running anomaly detection...
2025-06-02 15:59:12,536 - INFO - Starting anomaly detection.
2025-06-02 15:59:12,542 - DEBUG - Node reconstruction errors: [0.08506919 0.19324036 0.21971154 0.10919502 0.10926858 0.09559615
 0.93696415]
2025-06-02 15:59:12,543 - DEBUG - Edge reconstruction errors: [0.40469578 0.11295464 0.10651042 0.78909147 0.7217937 ]
2025-06-02 15:59:12,545 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155912_update_1.json
2025-06-02 15:59:12,545 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:12,559 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155912_update_1.pth and as latest_checkpoint.pth
2025-06-02 15:59:12,559 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869125.dot): 0.3031
2025-06-02 15:59:12,560 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:59:12,560 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-02 15:59:12,570 - DEBUG - Embedding standard deviations before t-SNE: [3.064185   0.         0.         0.         3.6035926  0.
 0.25973773 0.         0.         1.8316247  2.9157267  0.28256354
 0.         0.8082939  0.         1.7272999  1.4669119  0.
 0.         0.9061227  0.         0.         0.         0.9807773
 0.         2.636567   0.         0.         0.         0.
 1.830049   0.        ]
2025-06-02 15:59:12,671 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-02 15:59:12,772 - INFO - Embeddings visualization saved to vis/embeddings_1_updates_20250602_155912.png
2025-06-02 15:59:12,772 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:12,772 - INFO - Starting visualization of node features.
2025-06-02 15:59:12,772 - INFO - Graph has 7 nodes and 30 features.
2025-06-02 15:59:12,772 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:12,772 - INFO - Calculating feature statistics:
2025-06-02 15:59:12,772 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 2, 'mean': np.float32(3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5811388), 'max': np.float32(0.6324556)}
2025-06-02 15:59:12,773 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,773 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 2, 'mean': np.float32(2.5714285), 'std': np.float32(0.9035079), 'min': np.float32(2.0), 'max': np.float32(4.0)}
2025-06-02 15:59:12,774 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.4285715), 'std': np.float32(0.9035078), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:12,774 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:59:12,774 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 1, 'mean': np.float32(5.0), 'std': np.float32(0.0), 'min': np.float32(5.0), 'max': np.float32(5.0)}
2025-06-02 15:59:12,774 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:59:12,774 - INFO - - service_1: {'name': 'service_1', 'unique': 3, 'mean': np.float32(2.0), 'std': np.float32(0.75592893), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:12,774 - INFO - - service_2: {'name': 'service_2', 'unique': 2, 'mean': np.float32(7.142857), 'std': np.float32(2.0995626), 'min': np.float32(2.0), 'max': np.float32(8.0)}
2025-06-02 15:59:12,774 - INFO - - service_3: {'name': 'service_3', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:12,774 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 2, 'mean': np.float32(0.2857143), 'std': np.float32(0.45175397), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:59:12,774 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(6.0), 'std': np.float32(3.1622777), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:12,774 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:59:12,775 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-3.40598e-08), 'std': np.float32(1.0), 'min': np.float32(-0.6324556), 'max': np.float32(1.5811388)}
2025-06-02 15:59:12,775 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,775 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,775 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,775 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,775 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,775 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:12,795 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0aa62be60>
2025-06-02 15:59:12,941 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:12,998 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:13,033 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:14,158 - INFO - Node feature visualization saved to vis/node_features_20250602_155913.png
2025-06-02 15:59:14,159 - INFO - Finished visualization of node features.
2025-06-02 15:59:14,159 - INFO - Performing additional feature analysis:
2025-06-02 15:59:14,159 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:14,159 - INFO - Starting visualization of edge features.
2025-06-02 15:59:14,159 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:59:14,159 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:14,159 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:14,160 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:14,160 - INFO - - count: {'name': 'count', 'unique': 3, 'mean': np.float32(0.6), 'std': np.float32(0.8), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:14,160 - INFO - - dst_port: {'name': 'dst_port', 'unique': 2, 'mean': np.float32(0.2), 'std': np.float32(0.4), 'min': np.float32(0.0), 'max': np.float32(1.0)}
2025-06-02 15:59:14,160 - INFO - - protocol: {'name': 'protocol', 'unique': 3, 'mean': np.float32(1.4), 'std': np.float32(0.8), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:14,160 - INFO - - service: {'name': 'service', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5), 'max': np.float32(2.0)}
2025-06-02 15:59:14,160 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.9816251), 'max': np.float32(0.66214883)}
2025-06-02 15:59:14,160 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 5, 'mean': np.float32(-2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3328124), 'max': np.float32(1.2915914)}
2025-06-02 15:59:14,160 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 5, 'mean': np.float32(2.3841858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.94280905), 'max': np.float32(1.8856181)}
2025-06-02 15:59:14,160 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.9906747), 'max': np.float32(1.7452797)}
2025-06-02 15:59:14,160 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 5, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.9290494), 'max': np.float32(1.7669864)}
2025-06-02 15:59:14,160 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.0758877), 'max': np.float32(1.2000285)}
2025-06-02 15:59:14,175 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a16f4980>
2025-06-02 15:59:14,234 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:14,253 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1f06600>
2025-06-02 15:59:14,348 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:14,497 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:14,639 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:14,662 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:14,673 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:16,050 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155914.png
2025-06-02 15:59:16,050 - INFO - Finished visualization of edge features.
2025-06-02 15:59:16,050 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:16,051 - INFO - - Highest correlation (1.00) between features: 'service' and 'dst_port'.
2025-06-02 15:59:16,051 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:16,051 - INFO - Graph has 5 edges and 10 edge features.
2025-06-02 15:59:16,051 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:16,393 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155916_summary.png
2025-06-02 15:59:16,568 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155916_pca_3d.png
2025-06-02 15:59:16,737 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155916_pca_variance.png
2025-06-02 15:59:16,737 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:16,737 - INFO - 
--- Processing file: nw_graph_encoded_1748869155.dot (Timestamp: 2025-06-02 14:59:15) ---
2025-06-02 15:59:16,737 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:59:16,737 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:59:16,737 - INFO - Parsed 19 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:59:16,738 - INFO - Parsed 26 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:59:16,738 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:59:16,738 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869155.dot
2025-06-02 15:59:16,738 - INFO - Parsed 19 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:59:16,738 - INFO - Parsed 26 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869155.dot'.
2025-06-02 15:59:16,738 - INFO - Processing node updates/additions.
2025-06-02 15:59:16,738 - INFO - Processing edge updates/additions.
2025-06-02 15:59:16,739 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:16,739 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:16,739 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:16,739 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:16,739 - DEBUG - Initial node features tensor shape: torch.Size([19, 30])
2025-06-02 15:59:16,740 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:16,740 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 30])
2025-06-02 15:59:16,740 - DEBUG - Edge index tensor shape: torch.Size([2, 26])
2025-06-02 15:59:16,740 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:16,740 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 6
2025-06-02 15:59:16,740 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-02 15:59:16,741 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-02 15:59:16,741 - DEBUG - Shape of encoded categorical edge features: torch.Size([26, 3])
2025-06-02 15:59:16,741 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:16,741 - DEBUG - Shape of scaled numerical edge features: torch.Size([26, 7])
2025-06-02 15:59:16,741 - DEBUG - Final edge attributes tensor shape: torch.Size([26, 10])
2025-06-02 15:59:16,741 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:16,741 - INFO - Performing online update...
2025-06-02 15:59:16,742 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:16,742 - DEBUG - Initialized RunningStats with first batch: mean=1.1263157971072615, var=5.449233648754995, n=30
2025-06-02 15:59:16,742 - DEBUG - Updated RunningStats: new_mean=0.9033028665864676, new_var=177.90182608402392, new_n=60
2025-06-02 15:59:16,742 - DEBUG - Initialized RunningStats with first batch: mean=0.4769230735989717, var=0.8544970357382805, n=10
2025-06-02 15:59:16,742 - DEBUG - Updated RunningStats: new_mean=0.7733030370221687, new_var=11.367266843516887, new_n=20
2025-06-02 15:59:16,742 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:16,742 - DEBUG - Online update step: 1/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 2/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 3/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 4/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 5/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 6/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 7/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 8/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 9/50
2025-06-02 15:59:16,742 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,742 - DEBUG - Online update step: 10/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 11/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 12/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 13/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 14/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 15/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 16/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 17/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 18/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 19/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 20/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 21/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 22/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 23/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 24/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 25/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 26/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 27/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 28/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 29/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 30/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 31/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 32/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 33/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 34/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,743 - DEBUG - Online update step: 35/50
2025-06-02 15:59:16,743 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 36/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 37/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 38/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 39/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 40/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 41/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 42/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 43/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 44/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 45/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 46/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 47/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 48/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 49/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - DEBUG - Online update step: 50/50
2025-06-02 15:59:16,744 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,744 - WARNING - No successful steps during online update.
2025-06-02 15:59:16,744 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], current edge mean: [ 2.0384614e+00  1.5384616e-01  2.5769231e+00  1.3754918e-08
 -1.3754918e-08 -2.2924864e-09 -1.8339891e-08  4.5849728e-09
  4.5849728e-09  9.1699457e-09]
2025-06-02 15:59:16,745 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -9.4112593e-09 -1.5685433e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.2741732e-09  1.2548346e-08  0.0000000e+00  3.7645037e-08
  2.5263157e+00  2.5789473e+00  2.1052632e-01  4.3157897e+00
 -1.2548346e-08  1.5789474e+00  7.3684211e+00  7.0000000e+00
  2.1052632e-01  8.0000000e+00  1.2548346e-08  1.2548346e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.8822519e-08  1.8822519e-08], edge=[ 2.0384614e+00  1.5384616e-01  2.5769231e+00  1.3754918e-08
 -1.3754918e-08 -2.2924864e-09 -1.8339891e-08  4.5849728e-09
  4.5849728e-09  9.1699457e-09]
2025-06-02 15:59:16,745 - DEBUG - Updated reference std: node=[0.         0.         1.0274023  1.0274024  0.         0.
 0.         0.         1.0274024  1.0274024  1.0274023  1.0274024
 1.1239029  0.8377078  0.4188539  0.88522637 1.0274024  1.1212983
 1.9209524  2.3804762  0.4188539  0.         1.0274024  1.0274024
 0.         0.         0.         0.         1.0274024  1.0274024 ], edge=[1.6366006  0.36794648 1.5536557  1.0198039  1.0198039  1.0198039
 1.0198039  1.0198039  1.0198039  1.0198039 ]
2025-06-02 15:59:16,745 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:16,745 - INFO - Running anomaly detection...
2025-06-02 15:59:16,745 - INFO - Starting anomaly detection.
2025-06-02 15:59:16,747 - DEBUG - Node reconstruction errors: [0.57211804 1.9649595  2.231701   0.28213328 0.28213328 0.2695988
 1.9610379  0.54593086 0.5459309  0.5794682  0.54593086 0.5774127
 2.643852   0.47135922 1.6303157  0.59288865 0.8425589  0.57740223
 0.80688226]
2025-06-02 15:59:16,747 - DEBUG - Edge reconstruction errors: [0.45068726 0.30749127 0.35916787 0.13288155 0.2514258  0.36688092
 0.65383685 0.33892325 0.13283591 0.8198261  0.91982764 0.7760811
 2.3896463  0.04096651 0.44037357 0.97768825 0.2491063  0.15092923
 0.34704474 0.43403935 0.4409984  1.890084   0.8475511  1.232016
 0.5985052  0.39187032]
2025-06-02 15:59:16,748 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155916_update_2.json
2025-06-02 15:59:16,748 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:16,750 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155916_update_2.pth and as latest_checkpoint.pth
2025-06-02 15:59:16,750 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869155.dot): 0.3148
2025-06-02 15:59:16,750 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-02 15:59:16,750 - WARNING - Detected 1 anomalous edges (reconstruction-based):
2025-06-02 15:59:16,750 - WARNING -   Source: 192.168.27.10, Target: 8.8.8.8, Recon Error: 2.3896, MLP Score: 0.5567
2025-06-02 15:59:16,750 - INFO - 
--- Processing file: nw_graph_encoded_1748869185.dot (Timestamp: 2025-06-02 14:59:45) ---
2025-06-02 15:59:16,750 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:59:16,750 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:59:16,751 - INFO - Parsed 32 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:59:16,751 - INFO - Parsed 45 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:59:16,751 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:59:16,751 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869185.dot
2025-06-02 15:59:16,752 - INFO - Parsed 32 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:59:16,752 - INFO - Parsed 45 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869185.dot'.
2025-06-02 15:59:16,752 - INFO - Processing node updates/additions.
2025-06-02 15:59:16,753 - INFO - Processing edge updates/additions.
2025-06-02 15:59:16,753 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:16,753 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:16,753 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:16,753 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:16,753 - DEBUG - Initial node features tensor shape: torch.Size([32, 30])
2025-06-02 15:59:16,754 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:16,754 - DEBUG - Node features tensor shape after scaling: torch.Size([32, 30])
2025-06-02 15:59:16,754 - DEBUG - Edge index tensor shape: torch.Size([2, 45])
2025-06-02 15:59:16,754 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:16,754 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 6
2025-06-02 15:59:16,755 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-02 15:59:16,755 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-02 15:59:16,755 - DEBUG - Shape of encoded categorical edge features: torch.Size([45, 3])
2025-06-02 15:59:16,755 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:16,755 - DEBUG - Shape of scaled numerical edge features: torch.Size([45, 7])
2025-06-02 15:59:16,755 - DEBUG - Final edge attributes tensor shape: torch.Size([45, 10])
2025-06-02 15:59:16,755 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:16,756 - INFO - Performing online update...
2025-06-02 15:59:16,756 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:16,756 - DEBUG - Updated RunningStats: new_mean=0.9831046891665598, new_var=10846.83337104342, new_n=90
2025-06-02 15:59:16,756 - DEBUG - Updated RunningStats: new_mean=0.8958028946660067, new_var=976227.2075093095, new_n=120
2025-06-02 15:59:16,756 - DEBUG - Updated RunningStats: new_mean=0.6733131377021131, new_var=236.57143804689375, new_n=30
2025-06-02 15:59:16,756 - DEBUG - Updated RunningStats: new_mean=0.7701097427397711, new_var=7099.361807922272, new_n=40
2025-06-02 15:59:16,756 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:16,756 - DEBUG - Online update step: 1/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,756 - DEBUG - Online update step: 2/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,756 - DEBUG - Online update step: 3/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,756 - DEBUG - Online update step: 4/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,756 - DEBUG - Online update step: 5/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,756 - DEBUG - Online update step: 6/50
2025-06-02 15:59:16,756 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 7/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 8/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 9/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 10/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 11/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 12/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 13/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 14/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 15/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 16/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 17/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 18/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 19/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 20/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 21/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 22/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 23/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 24/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 25/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 26/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 27/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 28/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,757 - DEBUG - Online update step: 29/50
2025-06-02 15:59:16,757 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 30/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 31/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 32/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 33/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 34/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 35/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 36/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 37/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 38/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 39/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 40/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 41/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 42/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 43/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 44/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 45/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 46/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 47/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 48/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 49/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - DEBUG - Online update step: 50/50
2025-06-02 15:59:16,758 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,758 - WARNING - No successful steps during online update.
2025-06-02 15:59:16,759 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], current edge mean: [ 1.93333328e+00  1.33333340e-01  2.66666675e+00  1.05963815e-08
 -2.64909539e-09 -5.29819077e-09  0.00000000e+00  1.32454769e-09
  6.62273836e-09  1.58945728e-08]
2025-06-02 15:59:16,759 - DEBUG - Node drift difference: 0.3282, Edge drift difference: 0.0642
2025-06-02 15:59:16,759 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:16,759 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.4505806e-09  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.9802322e-08  0.0000000e+00  2.9802322e-08 -2.9802322e-08
  2.5000000e+00  2.6875000e+00  1.2500000e-01  4.3125000e+00
  0.0000000e+00  1.5625000e+00  7.1875000e+00  7.7812500e+00
  1.2500000e-01  8.0000000e+00 -3.7252903e-08  4.4703484e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4505806e-09  0.0000000e+00], edge=[ 1.93333328e+00  1.33333340e-01  2.66666675e+00  1.05963815e-08
 -2.64909539e-09 -5.29819077e-09  0.00000000e+00  1.32454769e-09
  6.62273836e-09  1.58945728e-08]
2025-06-02 15:59:16,760 - DEBUG - Updated reference std: node=[0.         0.         1.016001   1.016001   0.         0.
 0.         0.         1.016001   1.016001   1.016001   1.016001
 1.016001   0.73780406 0.33601075 0.89577866 1.016001   1.0757593
 2.206113   1.2374369  0.33601075 0.         1.016001   1.016001
 0.         0.         0.         0.         1.016001   1.016001  ], edge=[1.5724908  0.34377584 1.6096301  1.0112998  1.0112998  1.0112998
 1.0112997  1.0112998  1.0112998  1.0112998 ]
2025-06-02 15:59:16,760 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:16,760 - INFO - Running anomaly detection...
2025-06-02 15:59:16,760 - INFO - Starting anomaly detection.
2025-06-02 15:59:16,761 - DEBUG - Node reconstruction errors: [0.46361238 1.901115   2.4176342  0.36270615 0.36281583 0.34643832
 2.5376623  0.6750706  0.6750706  0.7099062  0.6750706  0.69610757
 3.643962   0.48305878 0.4680338  0.7088606  0.9678556  0.69610655
 0.95634294 0.6328889  0.6454608  0.4680338  0.67891866 0.63504857
 0.46803376 0.43131018 0.4680338  0.6406702  0.64546067 0.46803376
 0.63288885 0.6789185 ]
2025-06-02 15:59:16,762 - DEBUG - Edge reconstruction errors: [0.43204913 0.49397695 0.32574645 0.09231839 0.27097082 0.30548963
 0.31910548 0.35408634 0.37113658 0.0923133  0.5647178  0.6647227
 0.44912416 0.49164256 0.31741887 0.47819993 0.8095827  2.21849
 0.2717361  0.12822732 0.59308654 0.48949426 0.08944103 0.41177264
 0.49121523 0.3185869  0.12556894 0.12829365 0.5083128  0.35381606
 0.4208803  0.3264742  0.31349626 2.4328501  0.6333843  0.4352436
 0.04527392 0.31516075 0.3229566  0.30712727 2.499735   0.31952593
 0.3217877  0.51608276 0.11661284]
2025-06-02 15:59:16,762 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155916_update_3.json
2025-06-02 15:59:16,762 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:16,765 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155916_update_3.pth and as latest_checkpoint.pth
2025-06-02 15:59:16,765 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869185.dot): 0.3173
2025-06-02 15:59:16,765 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:59:16,765 - WARNING -   Node ID: 192.168.27.10, Recon Error: 3.6440, MLP Score: 0.4692
2025-06-02 15:59:16,765 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-02 15:59:16,765 - WARNING -   Source: 192.168.27.10, Target: 8.8.8.8, Recon Error: 2.2185, MLP Score: 0.5534
2025-06-02 15:59:16,765 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.4329, MLP Score: 0.5357
2025-06-02 15:59:16,765 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.4997, MLP Score: 0.5928
2025-06-02 15:59:16,765 - INFO - 
--- Processing file: nw_graph_encoded_1748869215.dot (Timestamp: 2025-06-02 15:00:15) ---
2025-06-02 15:59:16,765 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:59:16,765 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:59:16,766 - INFO - Parsed 49 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:59:16,767 - INFO - Parsed 66 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:59:16,767 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:59:16,767 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869215.dot
2025-06-02 15:59:16,768 - INFO - Parsed 49 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:59:16,769 - INFO - Parsed 66 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869215.dot'.
2025-06-02 15:59:16,769 - INFO - Processing node updates/additions.
2025-06-02 15:59:16,769 - INFO - Processing edge updates/additions.
2025-06-02 15:59:16,770 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:16,770 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:16,770 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:16,770 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:16,771 - DEBUG - Initial node features tensor shape: torch.Size([49, 30])
2025-06-02 15:59:16,771 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:16,771 - DEBUG - Node features tensor shape after scaling: torch.Size([49, 30])
2025-06-02 15:59:16,772 - DEBUG - Edge index tensor shape: torch.Size([2, 66])
2025-06-02 15:59:16,772 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:16,772 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 7
2025-06-02 15:59:16,772 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-02 15:59:16,773 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:16,773 - DEBUG - Shape of encoded categorical edge features: torch.Size([66, 3])
2025-06-02 15:59:16,773 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:16,773 - DEBUG - Shape of scaled numerical edge features: torch.Size([66, 7])
2025-06-02 15:59:16,773 - DEBUG - Final edge attributes tensor shape: torch.Size([66, 10])
2025-06-02 15:59:16,773 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:16,774 - INFO - Performing online update...
2025-06-02 15:59:16,774 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:16,774 - DEBUG - Updated RunningStats: new_mean=0.948070886640343, new_var=117147441.79238482, new_n=150
2025-06-02 15:59:16,774 - DEBUG - Updated RunningStats: new_mean=0.9018458811016488, new_var=17572116280.104534, new_n=180
2025-06-02 15:59:16,774 - DEBUG - Updated RunningStats: new_mean=0.7354817317343998, new_var=283988.2526321894, new_n=50
2025-06-02 15:59:16,774 - DEBUG - Updated RunningStats: new_mean=0.7976444108964046, new_var=14199415.736716194, new_n=60
2025-06-02 15:59:16,774 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:16,774 - DEBUG - Online update step: 1/50
2025-06-02 15:59:16,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,774 - DEBUG - Online update step: 2/50
2025-06-02 15:59:16,774 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 3/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 4/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 5/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 6/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 7/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 8/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 9/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 10/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 11/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 12/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 13/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 14/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 15/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 16/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 17/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 18/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 19/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,775 - DEBUG - Online update step: 20/50
2025-06-02 15:59:16,775 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 21/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 22/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 23/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 24/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 25/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 26/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 27/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 28/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 29/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 30/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 31/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 32/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 33/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 34/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 35/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 36/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 37/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 38/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 39/50
2025-06-02 15:59:16,776 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,776 - DEBUG - Online update step: 40/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 41/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 42/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 43/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 44/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 45/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 46/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 47/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 48/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 49/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - DEBUG - Online update step: 50/50
2025-06-02 15:59:16,777 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,777 - WARNING - No successful steps during online update.
2025-06-02 15:59:16,777 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], current edge mean: [ 2.7272727e+00  1.3636364e-01  3.1060605e+00 -1.3546511e-08
  3.6124028e-09  0.0000000e+00  9.0310071e-09 -5.4186042e-09
 -3.6124028e-09 -7.2248056e-09]
2025-06-02 15:59:16,778 - DEBUG - Node drift difference: 0.2913, Edge drift difference: 0.5049
2025-06-02 15:59:16,778 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:59:16,778 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.3380634e-08  1.5813477e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09 -2.4328427e-08 -9.7313704e-09  3.8925482e-08
  2.7959185e+00  2.7959185e+00  1.0204082e-01  4.4489794e+00
  2.9194112e-08  1.3673469e+00  7.3673468e+00  7.7346940e+00
  1.0204082e-01  8.0000000e+00  9.7313704e-09 -4.8656855e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.8656852e-09  2.4328427e-08], edge=[ 2.7272727e+00  1.3636364e-01  3.1060605e+00 -1.3546511e-08
  3.6124028e-09  0.0000000e+00  9.0310071e-09 -5.4186042e-09
 -3.6124028e-09 -7.2248056e-09]
2025-06-02 15:59:16,778 - DEBUG - Updated reference std: node=[0.         0.         1.010363   1.010363   0.         0.
 0.         1.010363   1.010363   1.010363   1.010363   1.010363
 1.6953317  0.61167777 0.30583888 0.81805724 1.010363   1.0346875
 1.9223887  1.3034492  0.30583888 0.         1.010363   1.010363
 0.         0.         0.         0.         1.010363   1.010363  ], edge=[1.5144987 0.345804  2.1706347 1.007663  1.007663  1.007663  1.0076629
 1.0076629 1.0076629 1.0076629]
2025-06-02 15:59:16,778 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:16,778 - INFO - Running anomaly detection...
2025-06-02 15:59:16,779 - INFO - Starting anomaly detection.
2025-06-02 15:59:16,781 - DEBUG - Node reconstruction errors: [0.5962886  2.2825065  3.308383   0.417515   0.41754025 0.39896977
 3.1475818  0.8362943  0.8366098  0.86972046 0.83552223 0.8247913
 5.6342564  1.5529945  0.39482254 0.8333943  1.1010334  0.82479125
 1.205688   0.58022344 0.61745614 0.3946882  0.65030384 0.58695996
 0.5026881  0.34923497 0.50509167 2.6752706  0.6137473  0.50484776
 0.5899238  0.649442   0.90523285 0.20951073 0.34946397 0.72045064
 0.3158718  0.58692974 0.47919315 0.8539545  0.8293922  0.72045064
 0.58693004 0.4013364  0.4394402  0.72045064 1.388996   2.2601435
 0.9491845 ]
2025-06-02 15:59:16,781 - DEBUG - Edge reconstruction errors: [0.5280386  0.63980657 0.555047   0.33924326 0.5374293  0.54243046
 0.58227324 0.5439328  0.5423492  0.54657304 0.5581157  0.58624005
 0.3392319  0.775801   0.8758042  0.6680183  0.66534436 0.6011394
 0.61149025 0.8266438  2.0851395  0.04073682 0.42824435 0.02823236
 0.69805753 0.7375415  0.33750632 0.6481501  0.63813156 0.6824445
 0.03113989 0.02821522 0.6428602  0.5671648  0.5842923  0.55598617
 0.54836464 2.8676498  0.71666086 0.6889532  0.16546878 0.6032735
 0.80329764 0.04069388 0.6796359  0.55128926 0.5953775  1.2396059
 0.55198973 0.55132145 0.3234164  0.03573702 3.6210961  0.07302658
 0.64268124 0.02729778 0.02823603 0.02825317 0.03063326 0.5721477
 0.61718524 0.54981226 0.56127095 0.55133146 0.6380778  0.02998986]
2025-06-02 15:59:16,782 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155916_update_4.json
2025-06-02 15:59:16,782 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:16,784 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155916_update_4.pth and as latest_checkpoint.pth
2025-06-02 15:59:16,784 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869215.dot): 0.3195
2025-06-02 15:59:16,784 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-02 15:59:16,785 - WARNING -   Node ID: 192.168.27.10, Recon Error: 5.6343, MLP Score: 0.4851
2025-06-02 15:59:16,785 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-02 15:59:16,785 - WARNING -   Source: 192.168.27.10, Target: 8.8.8.8, Recon Error: 2.0851, MLP Score: 0.5288
2025-06-02 15:59:16,785 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.8676, MLP Score: 0.5248
2025-06-02 15:59:16,785 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 3.6211, MLP Score: 0.5958
2025-06-02 15:59:16,785 - INFO - 
--- Processing file: nw_graph_encoded_1748869245.dot (Timestamp: 2025-06-02 15:00:45) ---
2025-06-02 15:59:16,785 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:59:16,785 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:59:16,786 - INFO - Parsed 54 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:59:16,787 - INFO - Parsed 71 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:59:16,787 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:59:16,787 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869245.dot
2025-06-02 15:59:16,789 - INFO - Parsed 54 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:59:16,790 - INFO - Parsed 71 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869245.dot'.
2025-06-02 15:59:16,790 - INFO - Processing node updates/additions.
2025-06-02 15:59:16,790 - INFO - Processing edge updates/additions.
2025-06-02 15:59:16,790 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:16,791 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:16,791 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:16,791 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:16,791 - DEBUG - Initial node features tensor shape: torch.Size([54, 30])
2025-06-02 15:59:16,792 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:16,792 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 30])
2025-06-02 15:59:16,793 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-02 15:59:16,793 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:16,793 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-02 15:59:16,793 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:16,794 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:16,794 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 3])
2025-06-02 15:59:16,794 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:16,795 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 7])
2025-06-02 15:59:16,795 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 10])
2025-06-02 15:59:16,795 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:16,795 - INFO - Performing online update...
2025-06-02 15:59:16,795 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:16,795 - DEBUG - Updated RunningStats: new_mean=0.9395010550904108, new_var=1800000000176.674, new_n=210
2025-06-02 15:59:16,795 - DEBUG - Updated RunningStats: new_mean=0.9074599084831132, new_var=2100000000011.152, new_n=240
2025-06-02 15:59:16,796 - DEBUG - Updated RunningStats: new_mean=0.7971760920371974, new_var=851964962.6812222, new_n=70
2025-06-02 15:59:16,796 - DEBUG - Updated RunningStats: new_mean=0.83745803313708, new_var=59637547390.591934, new_n=80
2025-06-02 15:59:16,796 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:16,796 - DEBUG - Online update step: 1/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 2/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 3/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 4/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 5/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 6/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 7/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 8/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 9/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 10/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 11/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 12/50
2025-06-02 15:59:16,796 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,796 - DEBUG - Online update step: 13/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 14/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 15/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 16/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 17/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 18/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 19/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 20/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 21/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 22/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 23/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 24/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 25/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 26/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 27/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 28/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 29/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 30/50
2025-06-02 15:59:16,797 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,797 - DEBUG - Online update step: 31/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 32/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 33/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 34/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 35/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 36/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 37/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 38/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 39/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 40/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 41/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 42/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 43/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 44/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 45/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 46/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 47/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 48/50
2025-06-02 15:59:16,798 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,798 - DEBUG - Online update step: 49/50
2025-06-02 15:59:16,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,799 - DEBUG - Online update step: 50/50
2025-06-02 15:59:16,799 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,799 - WARNING - No successful steps during online update.
2025-06-02 15:59:16,799 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], current edge mean: [ 3.7464788e+00  1.1126760e+00  3.0845070e+00  0.0000000e+00
 -1.0074024e-08  6.7160162e-09  0.0000000e+00 -3.3580081e-09
 -6.7160162e-09 -6.7160162e-09]
2025-06-02 15:59:16,799 - DEBUG - Node drift difference: 0.2719, Edge drift difference: 2.8233
2025-06-02 15:59:16,799 - WARNING - Feature drift detected (3 consecutive)
2025-06-02 15:59:16,799 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-02 15:59:16,799 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-02 15:59:16,800 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-02 15:59:16,800 - INFO - Optimizer and scheduler reset.
2025-06-02 15:59:16,801 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.8566747e-08 -6.6227384e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3245477e-08
  0.0000000e+00 -2.6490953e-08  2.6490953e-08 -8.8303178e-09
  2.9444444e+00  2.8148148e+00  1.8518518e-01  4.4444447e+00
  2.6490953e-08  1.3333334e+00  7.2962961e+00  7.7592592e+00
  1.8518518e-01  8.0000000e+00  3.9736431e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -7.0642542e-08], edge=[ 3.7464788e+00  1.1126760e+00  3.0845070e+00  0.0000000e+00
 -1.0074024e-08  6.7160162e-09  0.0000000e+00 -3.3580081e-09
 -6.7160162e-09 -6.7160162e-09]
2025-06-02 15:59:16,801 - DEBUG - Updated reference std: node=[0.         0.         1.0093899  1.0093899  0.         0.
 0.         1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.7420079  0.58516484 0.47875917 0.7930516  1.0093899  1.0279124
 2.0339537  1.2428693  0.47875917 0.         1.0093899  1.0093899
 0.         0.         0.         0.         1.0093899  1.0093899 ], edge=[1.6276039  0.36052722 2.1563625  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175 ]
2025-06-02 15:59:16,801 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:16,801 - INFO - Running anomaly detection...
2025-06-02 15:59:16,801 - INFO - Starting anomaly detection.
2025-06-02 15:59:16,804 - DEBUG - Node reconstruction errors: [18.790781 14.234027 16.53417  20.389286 20.38865  18.755836 15.762477
 16.21239  16.210173 17.785818 16.218328 16.387468 13.736815 13.964198
 18.4559   16.386112 19.69001  16.387468 16.845133 17.288958 17.090948
 18.457039 18.73505  17.245575 18.760809 20.547153 18.760809 14.200571
 17.120249 18.76081  13.661994 18.744509 18.741482 21.694431 20.793396
 19.914833 19.115896 17.245665 17.663767 16.483843 22.786674 19.914833
 17.245663 20.19708  19.659054 18.960415 23.170906 26.700796 18.49601
 31.209799 32.514225 20.69949  22.137827 19.152122]
2025-06-02 15:59:16,804 - DEBUG - Edge reconstruction errors: [0.6817469  0.8121612  0.7790015  0.5052183  0.68926704 0.7196335
 0.76062566 0.72207046 0.71754324 0.7234864  0.7351943  0.7861293
 0.50512826 0.9490628  1.0510759  0.83994573 0.8364245  0.7705604
 0.78930944 0.73855126 1.7721996  2.108403   0.19656675 0.58998287
 0.18175939 0.8756233  0.91373384 0.51065016 0.82455903 0.81180567
 0.8554576  0.19386216 0.18174115 0.81478864 0.74358076 0.7588407
 0.7305072  0.7239932  3.106567   0.89219314 0.8628788  0.3239358
 0.77666557 0.9798942  0.19722328 0.8536273  0.728682   0.7719528
 1.4149805  1.2713104  0.72772235 0.72677404 0.48855507 0.19192559
 3.8261597  0.07776459 0.81499547 0.19660516 0.18519852 0.18521668
 0.20345218 0.749656   0.87902284 0.72939205 0.73835236 0.7799465
 0.81678766 0.18962175 0.7322641  0.8073641  0.19042915]
2025-06-02 15:59:16,805 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155916_update_5.json
2025-06-02 15:59:16,805 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:16,808 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155916_update_5.pth and as latest_checkpoint.pth
2025-06-02 15:59:16,808 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869245.dot): 0.3155
2025-06-02 15:59:16,808 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:59:16,808 - WARNING -   Node ID: ff02::2, Recon Error: 31.2098, MLP Score: 0.0045
2025-06-02 15:59:16,808 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 32.5142, MLP Score: 0.0040
2025-06-02 15:59:16,808 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-02 15:59:16,808 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 3.1066, MLP Score: 0.2005
2025-06-02 15:59:16,808 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 3.8262, MLP Score: 0.4810
2025-06-02 15:59:16,808 - INFO - 
--- Processing file: nw_graph_encoded_1748869275.dot (Timestamp: 2025-06-02 15:01:15) ---
2025-06-02 15:59:16,808 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:59:16,808 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:59:16,810 - INFO - Parsed 62 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:59:16,811 - INFO - Parsed 86 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:59:16,811 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:59:16,811 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869275.dot
2025-06-02 15:59:16,813 - INFO - Parsed 62 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:59:16,815 - INFO - Parsed 86 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869275.dot'.
2025-06-02 15:59:16,815 - INFO - Processing node updates/additions.
2025-06-02 15:59:16,815 - INFO - Processing edge updates/additions.
2025-06-02 15:59:16,816 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:16,816 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:16,816 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:16,816 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:16,817 - DEBUG - Initial node features tensor shape: torch.Size([62, 30])
2025-06-02 15:59:16,817 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:16,818 - DEBUG - Node features tensor shape after scaling: torch.Size([62, 30])
2025-06-02 15:59:16,818 - DEBUG - Edge index tensor shape: torch.Size([2, 86])
2025-06-02 15:59:16,818 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:16,818 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-02 15:59:16,819 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:16,819 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:16,819 - DEBUG - Shape of encoded categorical edge features: torch.Size([86, 3])
2025-06-02 15:59:16,820 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:16,820 - DEBUG - Shape of scaled numerical edge features: torch.Size([86, 7])
2025-06-02 15:59:16,820 - DEBUG - Final edge attributes tensor shape: torch.Size([86, 10])
2025-06-02 15:59:16,820 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:16,820 - INFO - Performing online update...
2025-06-02 15:59:16,820 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:16,821 - DEBUG - Updated RunningStats: new_mean=0.9345282815010671, new_var=2400000000173.375, new_n=270
2025-06-02 15:59:16,821 - DEBUG - Updated RunningStats: new_mean=0.9103535389801057, new_var=2700000000011.498, new_n=300
2025-06-02 15:59:16,821 - DEBUG - Updated RunningStats: new_mean=0.8338128254016743, new_var=800000000019.0879, new_n=90
2025-06-02 15:59:16,821 - DEBUG - Updated RunningStats: new_mean=0.8617902080893969, new_var=900000000002.6854, new_n=100
2025-06-02 15:59:16,821 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:16,821 - DEBUG - Online update step: 1/50
2025-06-02 15:59:16,821 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,821 - DEBUG - Online update step: 2/50
2025-06-02 15:59:16,821 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,821 - DEBUG - Online update step: 3/50
2025-06-02 15:59:16,821 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,821 - DEBUG - Online update step: 4/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 5/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 6/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 7/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 8/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 9/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 10/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 11/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 12/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 13/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 14/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 15/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 16/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 17/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 18/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 19/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,822 - DEBUG - Online update step: 20/50
2025-06-02 15:59:16,822 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 21/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 22/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 23/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 24/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 25/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 26/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 27/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 28/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 29/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 30/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 31/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 32/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 33/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 34/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 35/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 36/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,823 - DEBUG - Online update step: 37/50
2025-06-02 15:59:16,823 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 38/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 39/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 40/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 41/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 42/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 43/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 44/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 45/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 46/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 47/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 48/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 49/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - DEBUG - Online update step: 50/50
2025-06-02 15:59:16,824 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:16,824 - WARNING - No successful steps during online update.
2025-06-02 15:59:16,825 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], current edge mean: [ 3.7790697e+00  1.0930233e+00  3.1744187e+00 -1.6633855e-08
  6.9307728e-09  6.9307728e-09 -1.3861545e-09  8.3169276e-09
 -1.3515007e-08 -5.5446181e-09]
2025-06-02 15:59:16,825 - DEBUG - Node drift difference: 0.1437, Edge drift difference: 0.0545
2025-06-02 15:59:16,825 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  4.03773406e-08  8.65228742e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.61455301e-08
 -1.53818434e-08  3.07636867e-08 -1.73045738e-08 -1.92273042e-08
  2.98387098e+00  2.74193549e+00  1.45161286e-01  4.45161295e+00
 -3.07636867e-08  1.25806451e+00  7.22580624e+00  7.58064508e+00
  1.45161286e-01  8.00000000e+00  3.84546084e-08  1.15363825e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  7.69092168e-09  5.76819126e-08], edge=[ 3.7790697e+00  1.0930233e+00  3.1744187e+00 -1.6633855e-08
  6.9307728e-09  6.9307728e-09 -1.3861545e-09  8.3169276e-09
 -1.3515007e-08 -5.5446181e-09]
2025-06-02 15:59:16,826 - DEBUG - Updated reference std: node=[0.         0.         1.0081633  1.0081635  0.         0.
 0.         1.0081633  1.0081635  1.0081635  1.0081635  1.0081635
 1.6936907  0.6759446  0.43783274 0.78254354 1.0081635  0.9907024
 2.051943   1.6149749  0.43783274 0.         1.0081635  1.0081633
 0.         0.         0.         0.         1.0081635  1.0081635 ], edge=[1.6549474  0.32998776 2.1098752  1.0058651  1.0058652  1.0058652
 1.0058652  1.0058652  1.0058651  1.0058651 ]
2025-06-02 15:59:16,826 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:16,826 - INFO - Running anomaly detection...
2025-06-02 15:59:16,826 - INFO - Starting anomaly detection.
2025-06-02 15:59:16,828 - DEBUG - Node reconstruction errors: [18.315691 16.72819  16.044533 19.071676 19.06994  17.413298 11.500428
 16.083998 16.081003 17.660791 16.091728 14.136884 12.788295 13.718079
 18.016502 16.15878  19.539585 16.229662 16.253809 16.868969 16.672354
 18.017765 18.304846 16.815657 18.186588 18.758959 18.186588 13.873318
 16.709635 18.186588 12.688181 18.316072 17.741964 21.16579  20.254072
 18.933956 18.595592 16.815744 17.220232 16.05924  21.761538 18.933956
 16.815742 19.734276 19.23501  17.995546 22.66236  25.899029 17.547218
 30.17347  31.357141 19.695364 19.654356 18.12401  18.64701  21.950073
 18.764568 18.944887 19.190248 20.72921  13.956771 23.012402]
2025-06-02 15:59:16,829 - DEBUG - Edge reconstruction errors: [0.83250964 0.8230856  0.8781454  0.51990783 0.7132109  0.718145
 0.76216125 0.72076255 0.8096714  0.7114286  0.7183396  0.7310059
 0.8301946  0.5194147  0.9623527  1.0628922  0.85285246 0.8903525
 0.9740026  0.7897262  0.73607713 0.8081065  0.7141955  0.17875187
 0.7558994  0.7228405  2.05966    2.168086   0.19236325 0.5905921
 0.18320186 0.87676644 0.92373663 0.5211687  0.8343243  0.8236033
 0.874105   0.19343665 0.24842001 1.142852   0.82311815 0.746749
 0.76363206 0.7327604  0.7248702  3.309288   0.9065887  0.8742676
 0.32210007 0.9399536  1.1445392  0.19419168 0.86429274 0.7298224
 0.77624446 1.472364   1.3046862  0.7289247  0.7280473  0.514894
 0.19146372 4.074906   0.07894988 0.81526774 0.19404088 0.18442151
 0.18444155 0.20026721 0.75258386 0.8906732  0.7299851  0.7396848
 0.7842848  0.82478386 0.18708804 0.733126   0.8061888  0.1871902
 0.76089126 0.19164202 0.54928464 0.9182939  0.63362753 0.8238893
 0.7254645  0.818569  ]
2025-06-02 15:59:16,830 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155916_update_6.json
2025-06-02 15:59:16,830 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:16,833 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155916_update_6.pth and as latest_checkpoint.pth
2025-06-02 15:59:16,833 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869275.dot): 0.3197
2025-06-02 15:59:16,833 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:59:16,833 - WARNING -   Node ID: ff02::2, Recon Error: 30.1735, MLP Score: 0.0048
2025-06-02 15:59:16,833 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.3571, MLP Score: 0.0043
2025-06-02 15:59:16,833 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-02 15:59:16,833 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 3.3093, MLP Score: 0.3357
2025-06-02 15:59:16,833 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 4.0749, MLP Score: 0.5568
2025-06-02 15:59:16,835 - DEBUG - Embedding standard deviations before t-SNE: [0.8820435  0.         0.         0.         0.98190117 0.
 0.20332617 0.         0.         1.4305706  1.7347971  0.5645947
 0.         0.52935505 0.         0.73709905 1.672605   0.
 0.         0.2771085  0.         0.         0.         0.74960196
 0.         0.679203   0.         0.         0.         0.
 0.39528722 0.1430614 ]
2025-06-02 15:59:16,950 - INFO - Embeddings visualization saved to vis/embeddings_6_updates_20250602_155916.png
2025-06-02 15:59:16,950 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:16,950 - INFO - Starting visualization of node features.
2025-06-02 15:59:16,950 - INFO - Graph has 62 nodes and 30 features.
2025-06-02 15:59:16,951 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:16,951 - INFO - Calculating feature statistics:
2025-06-02 15:59:16,951 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,951 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,951 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(1.9227304e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1658509), 'max': np.float32(1.8922695)}
2025-06-02 15:59:16,951 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(3.845461e-09), 'std': np.float32(0.99999994), 'min': np.float32(-1.8845364), 'max': np.float32(1.1707802)}
2025-06-02 15:59:16,951 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,951 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,951 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,951 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.2978431e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18257418), 'max': np.float32(5.4772253)}
2025-06-02 15:59:16,951 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-2.4995495e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7679477), 'max': np.float32(1.3021721)}
2025-06-02 15:59:16,951 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0000001), 'min': np.float32(-3.3477669), 'max': np.float32(0.3117721)}
2025-06-02 15:59:16,951 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 4, 'mean': np.float32(-1.15363825e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5117006), 'max': np.float32(1.3328699)}
2025-06-02 15:59:16,952 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 4, 'mean': np.float32(-3.0763687e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.3289211), 'max': np.float32(1.5174078)}
2025-06-02 15:59:16,952 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.983871), 'std': np.float32(1.6799763), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:59:16,952 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.7419355), 'std': np.float32(0.67047125), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:16,952 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:16,952 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.451613), 'std': np.float32(0.776207), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:16,952 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(7.690922e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.3117721), 'max': np.float32(3.3477669)}
2025-06-02 15:59:16,952 - INFO - - service_1: {'name': 'service_1', 'unique': 4, 'mean': np.float32(1.2580645), 'std': np.float32(0.98268044), 'min': np.float32(0.0), 'max': np.float32(3.0)}
2025-06-02 15:59:16,952 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(7.225806), 'std': np.float32(2.0353281), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:16,952 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.580645), 'std': np.float32(1.6018978), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:16,952 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14516129), 'std': np.float32(0.43428746), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:16,952 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:16,952 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-5.7681913e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.3601238), 'max': np.float32(3.699454)}
2025-06-02 15:59:16,952 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(4.806826e-09), 'std': np.float32(1.0), 'min': np.float32(-0.38490018), 'max': np.float32(2.598076)}
2025-06-02 15:59:16,952 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,952 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,953 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,953 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:16,953 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(6.7295565e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.6187041), 'max': np.float32(4.672282)}
2025-06-02 15:59:16,953 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 3, 'mean': np.float32(5.864328e-08), 'std': np.float32(1.0), 'min': np.float32(-0.72994643), 'max': np.float32(2.890588)}
2025-06-02 15:59:16,966 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0aa4c20c0>
2025-06-02 15:59:17,143 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:17,205 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:17,245 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:18,548 - INFO - Node feature visualization saved to vis/node_features_20250602_155917.png
2025-06-02 15:59:18,548 - INFO - Finished visualization of node features.
2025-06-02 15:59:18,548 - INFO - Performing additional feature analysis:
2025-06-02 15:59:18,548 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:18,548 - INFO - Starting visualization of edge features.
2025-06-02 15:59:18,548 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:59:18,548 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:18,548 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:18,549 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:18,549 - INFO - - count: {'name': 'count', 'unique': 8, 'mean': np.float32(3.7790697), 'std': np.float32(1.6452974), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 15:59:18,549 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.0930233), 'std': np.float32(0.32806367), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:18,549 - INFO - - protocol: {'name': 'protocol', 'unique': 6, 'mean': np.float32(3.1744187), 'std': np.float32(2.0975726), 'min': np.float32(0.0), 'max': np.float32(5.0)}
2025-06-02 15:59:18,549 - INFO - - service: {'name': 'service', 'unique': 9, 'mean': np.float32(4.505002e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19846956), 'max': np.float32(6.5811143)}
2025-06-02 15:59:18,549 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 67, 'mean': np.float32(8.6634655e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19461668), 'max': np.float32(9.082401)}
2025-06-02 15:59:18,549 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 76, 'mean': np.float32(-2.4257705e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.22627027), 'max': np.float32(9.036156)}
2025-06-02 15:59:18,549 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 48, 'mean': np.float32(3.4653864e-09), 'std': np.float32(1.0), 'min': np.float32(-0.4426339), 'max': np.float32(5.668144)}
2025-06-02 15:59:18,549 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 64, 'mean': np.float32(-2.079232e-09), 'std': np.float32(1.0), 'min': np.float32(-0.19641176), 'max': np.float32(8.896037)}
2025-06-02 15:59:18,549 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 76, 'mean': np.float32(4.158464e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.2043706), 'max': np.float32(8.886798)}
2025-06-02 15:59:18,549 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 51, 'mean': np.float32(5.1980793e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3688732), 'max': np.float32(7.6698503)}
2025-06-02 15:59:18,559 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a15d6f00>
2025-06-02 15:59:18,618 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:18,629 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a15853d0>
2025-06-02 15:59:18,695 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:18,792 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:18,928 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:18,947 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:18,954 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:20,236 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155919.png
2025-06-02 15:59:20,236 - INFO - Finished visualization of edge features.
2025-06-02 15:59:20,236 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:20,236 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:59:20,236 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:20,237 - INFO - Graph has 86 edges and 10 edge features.
2025-06-02 15:59:20,237 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:20,546 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155920_summary.png
2025-06-02 15:59:20,740 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155920_pca_3d.png
2025-06-02 15:59:20,922 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155920_pca_variance.png
2025-06-02 15:59:20,923 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:20,923 - INFO - 
--- Processing file: nw_graph_encoded_1748869305.dot (Timestamp: 2025-06-02 15:01:45) ---
2025-06-02 15:59:20,923 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:59:20,923 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:59:20,924 - INFO - Parsed 70 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:59:20,925 - INFO - Parsed 95 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:59:20,925 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:59:20,925 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869305.dot
2025-06-02 15:59:20,926 - INFO - Parsed 70 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:59:20,927 - INFO - Parsed 95 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869305.dot'.
2025-06-02 15:59:20,927 - INFO - Processing node updates/additions.
2025-06-02 15:59:20,928 - INFO - Processing edge updates/additions.
2025-06-02 15:59:20,928 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:20,928 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:20,928 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:20,928 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:20,929 - DEBUG - Initial node features tensor shape: torch.Size([70, 30])
2025-06-02 15:59:20,930 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:20,930 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 30])
2025-06-02 15:59:20,930 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-02 15:59:20,930 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:20,931 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-02 15:59:20,931 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:20,931 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:20,931 - DEBUG - Shape of encoded categorical edge features: torch.Size([95, 3])
2025-06-02 15:59:20,932 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:20,932 - DEBUG - Shape of scaled numerical edge features: torch.Size([95, 7])
2025-06-02 15:59:20,932 - DEBUG - Final edge attributes tensor shape: torch.Size([95, 10])
2025-06-02 15:59:20,932 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:20,932 - INFO - Performing online update...
2025-06-02 15:59:20,932 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:20,932 - DEBUG - Updated RunningStats: new_mean=0.9322694510337768, new_var=3000000000173.692, new_n=330
2025-06-02 15:59:20,932 - DEBUG - Updated RunningStats: new_mean=0.911676146017906, new_var=3300000000011.2827, new_n=360
2025-06-02 15:59:20,932 - DEBUG - Updated RunningStats: new_mean=0.8569384665016193, new_var=1000000000019.2502, new_n=110
2025-06-02 15:59:20,933 - DEBUG - Updated RunningStats: new_mean=0.8775308227204817, new_var=1100000000002.475, new_n=120
2025-06-02 15:59:20,933 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:20,933 - DEBUG - Online update step: 1/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 2/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 3/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 4/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 5/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 6/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 7/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 8/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 9/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 10/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 11/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 12/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 13/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 14/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 15/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 16/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 17/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 18/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 19/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 20/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 21/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 22/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,933 - DEBUG - Online update step: 23/50
2025-06-02 15:59:20,933 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 24/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 25/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 26/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 27/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 28/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 29/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 30/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 31/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 32/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 33/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 34/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 35/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 36/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 37/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 38/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 39/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 40/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 41/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 42/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 43/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 44/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 45/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 46/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 47/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 48/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 49/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,934 - DEBUG - Online update step: 50/50
2025-06-02 15:59:20,934 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,935 - WARNING - No successful steps during online update.
2025-06-02 15:59:20,935 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], current edge mean: [ 3.7052631e+00  1.0842105e+00  3.2947369e+00 -1.7567684e-08
  1.2548347e-09  7.5290076e-09 -1.1293512e-08  8.7838421e-09
 -2.5096694e-09  5.0193387e-09]
2025-06-02 15:59:20,935 - DEBUG - Node drift difference: 0.0664, Edge drift difference: 0.0570
2025-06-02 15:59:20,935 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.0871758e-08 -6.8119597e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.3623919e-08
 -6.4713618e-08  5.4495676e-08  3.2356809e-08 -1.7029899e-08
  2.8714285e+00  2.7714286e+00  1.4285715e-01  4.4428573e+00
 -5.4495676e-08  1.3142858e+00  7.2285714e+00  7.6285715e+00
  1.4285715e-01  8.0000000e+00 -4.4277737e-08  3.4059799e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.4713618e-08 -5.4495676e-08], edge=[ 3.7052631e+00  1.0842105e+00  3.2947369e+00 -1.7567684e-08
  1.2548347e-09  7.5290076e-09 -1.1293512e-08  8.7838421e-09
 -2.5096694e-09  5.0193387e-09]
2025-06-02 15:59:20,936 - DEBUG - Updated reference std: node=[0.        0.        1.0072203 1.0072203 0.        0.        0.
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.6233927 0.6409103
 0.4268426 0.8100047 1.0072203 0.9712215 2.0442314 1.5244046 0.4268426
 0.        1.0072203 1.0072203 0.        0.        0.        0.
 1.0072203 1.0072203], edge=[1.5903544 0.3149859 2.0979915 1.0053052 1.005305  1.005305  1.005305
 1.0053052 1.005305  1.005305 ]
2025-06-02 15:59:20,936 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:20,936 - INFO - Running anomaly detection...
2025-06-02 15:59:20,936 - INFO - Starting anomaly detection.
2025-06-02 15:59:20,938 - DEBUG - Node reconstruction errors: [18.226116  16.709217  16.31027   19.262291  19.260895  17.61982
 12.263024  16.096195  16.094173  17.648808  16.101742  14.19771
 13.153296  13.817378  17.930931  16.255444  19.552746  16.277796
 16.386057  16.801466  16.60721   17.932117  18.218718  13.153616
 18.120375  18.860659  18.096872  13.977941  16.63866   18.098383
 13.079196  18.227684  17.522211  21.112087  20.195711  18.755632
 18.549643  16.761211  17.164976  16.007704  21.532524  18.73271
 16.76121   19.627617  19.17984   17.801233  22.527964  25.694752
 17.34247   30.184322  31.501894  19.452059  19.620977  17.910511
 18.432339  21.747404  18.561066  18.539412  19.088358  20.470715
 13.4636135 22.630318  19.754019  18.547224  19.919725  18.432339
 21.747408  18.432339  19.754017  19.754019 ]
2025-06-02 15:59:20,938 - DEBUG - Edge reconstruction errors: [0.74602425 0.8201036  0.8325198  0.5168062  0.6629343  0.71525174
 0.7493949  0.7174999  0.80890584 0.70900077 0.7153021  0.72605854
 3.3639505  0.5165252  0.94911397 1.049594   0.8423998  0.86522985
 0.9038261  0.77050984 0.73003733 0.8074334  0.7104666  0.1800443
 0.8478514  0.7189114  0.7178942  0.71128976 0.82287717 0.7107505
 1.641568   1.9481136  0.19032028 0.5910596  0.18322997 0.854039
 0.9208215  0.5184975  0.8290361  0.82097954 0.82978034 0.19286616
 0.24075627 1.0792055  0.79355055 0.7398727  0.7533426  0.7282553
 0.721163   3.1285374  0.87230676 0.8391898  0.31501216 0.8872721
 1.0913357  0.19119029 0.83149254 0.7251096  0.7602278  1.3188319
 2.1633792  0.72493464 0.7238966  0.48334256 0.18398045 0.7146532
 3.5408185  0.08036114 0.8123384  0.19514506 0.18476053 0.1847796
 0.1995784  0.74386394 0.8523943  0.72606117 0.73377985 0.76862943
 0.8105574  0.18786633 0.7285145  0.80507785 0.18813601 0.7550573
 0.749212   0.22580686 1.1336994  0.74671555 0.18813989 0.5381639
 0.9172601  0.6284927  0.8214965  0.7226171  0.81771445]
2025-06-02 15:59:20,939 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155920_update_7.json
2025-06-02 15:59:20,939 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:20,941 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155920_update_7.pth and as latest_checkpoint.pth
2025-06-02 15:59:20,941 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869305.dot): 0.3185
2025-06-02 15:59:20,941 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:59:20,941 - WARNING -   Node ID: ff02::2, Recon Error: 30.1843, MLP Score: 0.0046
2025-06-02 15:59:20,941 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.5019, MLP Score: 0.0041
2025-06-02 15:59:20,941 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-02 15:59:20,941 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.3640, MLP Score: 0.0885
2025-06-02 15:59:20,941 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 3.1285, MLP Score: 0.3260
2025-06-02 15:59:20,941 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 3.5408, MLP Score: 0.5942
2025-06-02 15:59:20,941 - INFO - 
--- Processing file: nw_graph_encoded_1748869335.dot (Timestamp: 2025-06-02 15:02:15) ---
2025-06-02 15:59:20,941 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:59:20,941 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:59:20,943 - INFO - Parsed 77 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:59:20,944 - INFO - Parsed 106 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:59:20,944 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:59:20,944 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869335.dot
2025-06-02 15:59:20,945 - INFO - Parsed 77 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:59:20,946 - INFO - Parsed 106 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869335.dot'.
2025-06-02 15:59:20,947 - INFO - Processing node updates/additions.
2025-06-02 15:59:20,947 - INFO - Processing edge updates/additions.
2025-06-02 15:59:20,947 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:20,948 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:20,948 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:20,948 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:20,948 - DEBUG - Initial node features tensor shape: torch.Size([77, 30])
2025-06-02 15:59:20,949 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:20,949 - DEBUG - Node features tensor shape after scaling: torch.Size([77, 30])
2025-06-02 15:59:20,949 - DEBUG - Edge index tensor shape: torch.Size([2, 106])
2025-06-02 15:59:20,949 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:20,950 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-02 15:59:20,950 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:20,950 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:20,951 - DEBUG - Shape of encoded categorical edge features: torch.Size([106, 3])
2025-06-02 15:59:20,951 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:20,951 - DEBUG - Shape of scaled numerical edge features: torch.Size([106, 7])
2025-06-02 15:59:20,951 - DEBUG - Final edge attributes tensor shape: torch.Size([106, 10])
2025-06-02 15:59:20,951 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:20,951 - INFO - Performing online update...
2025-06-02 15:59:20,951 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:20,952 - DEBUG - Updated RunningStats: new_mean=0.9304583003668586, new_var=3600000000173.2173, new_n=390
2025-06-02 15:59:20,952 - DEBUG - Updated RunningStats: new_mean=0.9137070405847387, new_var=3900000000011.651, new_n=420
2025-06-02 15:59:20,952 - DEBUG - Updated RunningStats: new_mean=0.8728731536989244, new_var=1200000000019.4834, new_n=130
2025-06-02 15:59:20,952 - DEBUG - Updated RunningStats: new_mean=0.8888497894266022, new_var=1300000000002.1628, new_n=140
2025-06-02 15:59:20,952 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:20,952 - DEBUG - Online update step: 1/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 2/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 3/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 4/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 5/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 6/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 7/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,952 - DEBUG - Online update step: 8/50
2025-06-02 15:59:20,952 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 9/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 10/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 11/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 12/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 13/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 14/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 15/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 16/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 17/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 18/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 19/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 20/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 21/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 22/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 23/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 24/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 25/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 26/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 27/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 28/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 29/50
2025-06-02 15:59:20,953 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,953 - DEBUG - Online update step: 30/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 31/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 32/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 33/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 34/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 35/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 36/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 37/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 38/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 39/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 40/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 41/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 42/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 43/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 44/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 45/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 46/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 47/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 48/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 49/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - DEBUG - Online update step: 50/50
2025-06-02 15:59:20,954 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,954 - WARNING - No successful steps during online update.
2025-06-02 15:59:20,955 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], current edge mean: [ 3.6509433e+00  1.1226416e+00  3.3962264e+00 -7.8723117e-09
  6.7476957e-09 -4.4984638e-09 -1.7993855e-08  6.7476957e-09
  6.7476957e-09  1.5744623e-08]
2025-06-02 15:59:20,955 - DEBUG - Node drift difference: 0.2246, Edge drift difference: 0.1220
2025-06-02 15:59:20,955 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:20,955 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00 -4.02524876e-08 -9.28903532e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -4.33488339e-08
 -2.01262438e-08  2.47707614e-08  1.08372085e-08  1.54817259e-09
  2.87012982e+00  2.79220772e+00  1.29870132e-01  4.41558456e+00
 -2.47707614e-08  1.53246748e+00  7.14285707e+00  7.66233778e+00
  1.29870132e-01  8.00000000e+00  1.23853807e-08 -2.78671060e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  6.19269036e-09 -2.16744169e-08], edge=[ 3.6509433e+00  1.1226416e+00  3.3962264e+00 -7.8723117e-09
  6.7476957e-09 -4.4984638e-09 -1.7993855e-08  6.7476957e-09
  6.7476957e-09  1.5744623e-08]
2025-06-02 15:59:20,956 - DEBUG - Updated reference std: node=[0.        0.        1.0065575 1.0065575 0.        0.        0.
 1.0065575 1.0065575 1.0065575 1.0065575 1.0065575 1.5757258 0.6142531
 0.408806  0.7838946 1.0065575 1.4196405 2.131927  1.4564773 0.408806
 0.        1.0065575 1.0065575 0.        0.        0.        0.
 1.0065575 1.0065575], edge=[1.5246699 0.3573135 2.0502229 1.0047506 1.0047506 1.0047506 1.0047506
 1.0047506 1.0047506 1.0047506]
2025-06-02 15:59:20,956 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:20,956 - INFO - Running anomaly detection...
2025-06-02 15:59:20,956 - INFO - Starting anomaly detection.
2025-06-02 15:59:20,958 - DEBUG - Node reconstruction errors: [18.309778  17.158909  16.563898  19.215708  19.214855  17.58724
 12.688416  15.9779625 15.97696   17.52007   15.981884  14.046029
 13.328276  13.922052  17.772787  16.204937  19.519901  16.234875
 16.382008  16.678423  16.413776  17.77358   18.00797   13.0448
 17.992682  18.735518  17.888538  13.649639  16.437006  17.889265
 13.338442  18.014246  17.280043  21.14377   20.234653  18.459166
 18.590488  16.64725   17.062502  15.865249  21.174963  18.442656
 16.647247  19.436298  18.831526  17.488638  22.329767  25.365604
 17.023888  30.123724  31.52759   19.104918  19.376913  17.676727
 18.083342  18.632656  18.477966  18.122925  18.779903  20.31148
 14.056     22.154608  19.363855  18.128674  19.56952   18.083374
 21.369942  18.083357  19.318237  19.319439  19.102388  22.470242
 20.27442   18.559042  18.021238  18.837053  20.411612 ]
2025-06-02 15:59:20,958 - DEBUG - Edge reconstruction errors: [0.72272676 0.8440408  0.80956435 0.5405984  0.65941864 0.73791385
 0.75968945 0.7396931  0.8350263  0.7322064  0.7371039  0.7439494
 4.9995494  0.5402653  1.0026084  1.1030552  0.8572337  0.8681595
 0.9097617  0.7713164  0.74702066 0.8340953  0.73371243 0.20760421
 0.96937895 0.73419434 0.6379413  0.8424809  0.740324   0.7342206
 0.8058123  0.7339109  0.7412714  0.7711572  0.76917845 0.75326705
 0.7923526  0.7350565  1.1591057  1.316206   0.21991135 0.6188267
 0.21099328 0.8608783  0.94471145 0.54224366 0.8494822  0.8450823
 0.853373   0.21958627 0.25959536 1.1357641  0.785546   0.7562281
 0.7621775  0.7480814  0.74269086 2.7424939  0.8521923  0.8218637
 0.33569685 0.9573044  1.1598508  0.21759452 0.8172933  0.7451737
 0.76789623 1.0843532  3.1614726  0.7458408  0.74440503 0.44127324
 0.2187573  0.7368323  2.5423684  0.10716464 0.8354074  0.22290003
 0.21255727 0.21257076 0.22677259 0.7577991  0.82946956 0.7461924
 0.7515851  0.77558076 0.8137254  0.21458213 0.74774754 0.83085555
 0.21530147 0.7714197  0.7593893  0.24360849 0.99378765 0.75734264
 0.6416321  0.84494823 0.7412171  0.16270865 0.5539134  0.9433732
 0.64942384 0.84586036 0.7464119  0.8438447 ]
2025-06-02 15:59:20,959 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155920_update_8.json
2025-06-02 15:59:20,959 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:20,961 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155920_update_8.pth and as latest_checkpoint.pth
2025-06-02 15:59:20,961 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869335.dot): 0.3452
2025-06-02 15:59:20,962 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:59:20,962 - WARNING -   Node ID: ff02::2, Recon Error: 30.1237, MLP Score: 0.0045
2025-06-02 15:59:20,962 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.5276, MLP Score: 0.0040
2025-06-02 15:59:20,962 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-02 15:59:20,962 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.9995, MLP Score: 0.1522
2025-06-02 15:59:20,962 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.7425, MLP Score: 0.2394
2025-06-02 15:59:20,962 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.1615, MLP Score: 0.4479
2025-06-02 15:59:20,962 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.5424, MLP Score: 0.4890
2025-06-02 15:59:20,962 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-02 15:59:20,962 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:59:20,962 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:59:20,964 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:59:20,966 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:59:20,966 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:59:20,966 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-02 15:59:20,968 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:59:20,970 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-02 15:59:20,970 - INFO - Processing node updates/additions.
2025-06-02 15:59:20,970 - INFO - Processing edge updates/additions.
2025-06-02 15:59:20,971 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:20,971 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:20,971 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:20,971 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:20,972 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-02 15:59:20,973 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:20,973 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-02 15:59:20,974 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-02 15:59:20,974 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:20,974 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-02 15:59:20,975 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:20,975 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:20,975 - DEBUG - Shape of encoded categorical edge features: torch.Size([133, 3])
2025-06-02 15:59:20,976 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:20,976 - DEBUG - Shape of scaled numerical edge features: torch.Size([133, 7])
2025-06-02 15:59:20,976 - DEBUG - Final edge attributes tensor shape: torch.Size([133, 10])
2025-06-02 15:59:20,976 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:20,976 - INFO - Performing online update...
2025-06-02 15:59:20,976 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:20,977 - DEBUG - Updated RunningStats: new_mean=0.9299467952461821, new_var=4200000000167.249, new_n=450
2025-06-02 15:59:20,977 - DEBUG - Updated RunningStats: new_mean=0.9179123252082413, new_var=4500000000014.057, new_n=480
2025-06-02 15:59:20,977 - DEBUG - Updated RunningStats: new_mean=0.8845806046153586, new_var=1400000000019.401, new_n=150
2025-06-02 15:59:20,977 - DEBUG - Updated RunningStats: new_mean=0.8972435006709286, new_var=1500000000001.7769, new_n=160
2025-06-02 15:59:20,977 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:20,977 - DEBUG - Online update step: 1/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 2/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 3/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 4/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 5/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 6/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 7/50
2025-06-02 15:59:20,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,977 - DEBUG - Online update step: 8/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 9/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 10/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 11/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 12/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 13/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 14/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 15/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 16/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 17/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 18/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 19/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 20/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 21/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 22/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 23/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 24/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 25/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,978 - DEBUG - Online update step: 26/50
2025-06-02 15:59:20,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 27/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 28/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 29/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 30/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 31/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 32/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 33/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 34/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 35/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 36/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 37/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 38/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 39/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 40/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 41/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 42/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 43/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 44/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,979 - DEBUG - Online update step: 45/50
2025-06-02 15:59:20,979 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - DEBUG - Online update step: 46/50
2025-06-02 15:59:20,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - DEBUG - Online update step: 47/50
2025-06-02 15:59:20,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - DEBUG - Online update step: 48/50
2025-06-02 15:59:20,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - DEBUG - Online update step: 49/50
2025-06-02 15:59:20,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - DEBUG - Online update step: 50/50
2025-06-02 15:59:20,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:20,980 - WARNING - No successful steps during online update.
2025-06-02 15:59:20,980 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], current edge mean: [ 3.56390977e+00  1.22556388e+00  3.45864654e+00 -7.17048376e-09
 -8.96310404e-09  0.00000000e+00 -7.17048376e-09 -7.17048376e-09
  0.00000000e+00  1.43409675e-08]
2025-06-02 15:59:20,980 - DEBUG - Node drift difference: 0.3056, Edge drift difference: 0.2880
2025-06-02 15:59:20,980 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:59:20,981 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -7.9026385e-08  4.6880057e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2770314e-08
 -2.1430884e-08  3.2146325e-08  3.0806895e-08  6.8310939e-08
  2.7977529e+00  2.8202248e+00  2.1348314e-01  4.4044943e+00
 -3.2146325e-08  1.9662921e+00  6.7415729e+00  7.5617976e+00
  2.1348314e-01  8.0000000e+00 -3.7504048e-08 -5.3577209e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.6788605e-08  5.3577209e-09], edge=[ 3.56390977e+00  1.22556388e+00  3.45864654e+00 -7.17048376e-09
 -8.96310404e-09  0.00000000e+00 -7.17048376e-09 -7.17048376e-09
  0.00000000e+00  1.43409675e-08]
2025-06-02 15:59:20,981 - DEBUG - Updated reference std: node=[0.         0.         1.0056658  1.0056658  0.         0.
 0.         1.0056658  1.0056658  1.0056657  1.0056658  1.0056658
 1.5013614  0.5752825  0.46397272 0.7342142  1.0056657  2.2281742
 2.4426517  1.6442397  0.46397272 0.         1.0056658  1.0056658
 0.         0.         0.         0.         1.0056658  1.0056658 ], edge=[1.421445   0.43721816 1.9867412  1.0037807  1.0037807  1.0037807
 1.0037807  1.0037807  1.0037807  1.0037807 ]
2025-06-02 15:59:20,981 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:20,981 - INFO - Running anomaly detection...
2025-06-02 15:59:20,981 - INFO - Starting anomaly detection.
2025-06-02 15:59:20,984 - DEBUG - Node reconstruction errors: [18.04766   17.1144    12.439882  19.389912  17.699808  17.75629
 13.989892  16.226068  16.225252  17.761333  16.228727  14.565938
 14.2320385 13.819043  17.932047  16.535044  19.83063   16.543262
 16.844032  16.879124  16.583702  17.932783  18.169956  13.555055
 18.155857  18.795956  18.021057  14.043632  16.600761  18.021818
 13.786319  18.174562  17.347982  19.7725    18.756136  18.487988
 17.136312  16.870705  17.306494  16.078653  21.179903  18.471277
 16.870707  19.591927  18.99889   17.512785  22.52215   25.468594
 17.066446  30.120783  31.688118  19.124603  19.324057  17.781368
 17.877455  14.961656  18.719072  18.012403  18.635723  18.727724
 13.595884  21.977173  19.21094   14.517553  19.356905  17.877455
 19.660368  17.877455  19.163622  19.164694  18.670969  22.012419
 20.035675  18.35227   18.453556  18.558796  20.021639  18.40399
 18.40399   18.403992  21.918798  18.40399   18.92631   20.72473
 20.108015  20.700064  18.810917  18.40399   18.40399  ]
2025-06-02 15:59:20,984 - DEBUG - Edge reconstruction errors: [0.7509202  0.8503465  0.8120949  0.54630446 1.5759525  0.7419661
 0.76363647 0.74343395 0.8417843  0.21969832 0.7661478  0.7473018
 0.81901056 0.21807969 0.74454606 0.9021552  0.62901884 0.7765221
 0.7375565  0.7389289  0.6635337  0.86800456 0.74957013 5.8584304
 0.5454988  1.0636472  1.163907   0.8620846  0.8723373  0.9747809
 0.77694315 0.75265634 0.84010834 0.7385829  0.22099677 0.9722933
 0.74262416 0.6473255  0.85113466 0.7466826  0.7391166  0.81394863
 0.7388022  0.7463939  0.7762959  0.77392155 0.7510543  0.7975501
 0.75284535 0.6382774  0.8425354  0.6414885  0.84574085 0.64990026
 0.85412    0.649331   0.8535578  0.6423593  0.8466011  0.63518196
 0.83953995 0.70084304 0.9049313  1.2216231  1.6108514  0.22930777
 0.6263421  0.21868205 0.8658393  0.95042145 0.5480137  0.8550463
 0.8509835  0.8545596  0.22669517 0.26850224 1.1498649  0.7911359
 0.76290894 0.7697284  0.75475633 0.74912673 2.7756946  0.8585674
 0.8277166  0.34302542 0.9663686  1.1687486  0.2250411  0.82308525
 0.7515736  0.77389055 1.1051669  3.2661989  0.7523107  0.750977
 0.45394516 0.22614555 0.744178   2.626053   0.11404429 0.8422716
 0.22978264 0.2198119  0.21982676 0.2332106  0.7645053  0.83551663
 0.75269496 0.7580488  0.7816729  0.82055974 0.22168545 0.75422513
 0.83727574 0.22226796 0.7777579  0.7647355  0.25348863 0.7493768
 0.9978409  0.7632422  0.64938956 0.8528432  0.74693704 0.7475348
 0.1568862  0.58268905 0.94916624 0.6764313  0.8517409  0.75225896
 0.8498896 ]
2025-06-02 15:59:20,985 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155920_update_9.json
2025-06-02 15:59:20,985 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:20,988 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155920_update_9.pth and as latest_checkpoint.pth
2025-06-02 15:59:20,988 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.3514
2025-06-02 15:59:20,988 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-02 15:59:20,988 - WARNING -   Node ID: ff02::2, Recon Error: 30.1208, MLP Score: 0.0043
2025-06-02 15:59:20,988 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.6881, MLP Score: 0.0038
2025-06-02 15:59:20,988 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-02 15:59:20,988 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.8584, MLP Score: 0.2251
2025-06-02 15:59:20,988 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.7757, MLP Score: 0.2198
2025-06-02 15:59:20,988 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.2662, MLP Score: 0.4736
2025-06-02 15:59:20,988 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.6261, MLP Score: 0.4986
2025-06-02 15:59:20,988 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-02 15:59:20,988 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:59:20,988 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:59:20,992 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:59:20,994 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:59:20,994 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:59:20,994 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-02 15:59:20,997 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:59:21,000 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-02 15:59:21,000 - INFO - Processing node updates/additions.
2025-06-02 15:59:21,001 - INFO - Processing edge updates/additions.
2025-06-02 15:59:21,002 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:21,002 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:21,002 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:21,002 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:21,004 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-02 15:59:21,005 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:21,005 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-02 15:59:21,005 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-02 15:59:21,005 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:21,006 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 9
2025-06-02 15:59:21,006 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:21,007 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-02 15:59:21,007 - DEBUG - Shape of encoded categorical edge features: torch.Size([186, 3])
2025-06-02 15:59:21,008 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:21,008 - DEBUG - Shape of scaled numerical edge features: torch.Size([186, 7])
2025-06-02 15:59:21,008 - DEBUG - Final edge attributes tensor shape: torch.Size([186, 10])
2025-06-02 15:59:21,008 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:21,008 - INFO - Performing online update...
2025-06-02 15:59:21,008 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:21,009 - DEBUG - Updated RunningStats: new_mean=0.932225735956973, new_var=4800000000168.395, new_n=510
2025-06-02 15:59:21,009 - DEBUG - Updated RunningStats: new_mean=0.9207073983532016, new_var=5100000000014.268, new_n=540
2025-06-02 15:59:21,009 - DEBUG - Updated RunningStats: new_mean=0.893072946660668, new_var=1600000000019.4407, new_n=170
2025-06-02 15:59:21,009 - DEBUG - Updated RunningStats: new_mean=0.9047651253077805, new_var=1700000000001.9795, new_n=180
2025-06-02 15:59:21,009 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:21,009 - DEBUG - Online update step: 1/50
2025-06-02 15:59:21,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,009 - DEBUG - Online update step: 2/50
2025-06-02 15:59:21,009 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 3/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 4/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 5/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 6/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 7/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 8/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 9/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 10/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 11/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 12/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 13/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 14/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 15/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 16/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 17/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 18/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 19/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,010 - DEBUG - Online update step: 20/50
2025-06-02 15:59:21,010 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 21/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 22/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 23/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 24/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 25/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 26/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 27/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 28/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 29/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 30/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 31/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 32/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 33/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 34/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 35/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 36/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 37/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 38/50
2025-06-02 15:59:21,011 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,011 - DEBUG - Online update step: 39/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 40/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 41/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 42/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 43/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 44/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 45/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 46/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 47/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 48/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 49/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - DEBUG - Online update step: 50/50
2025-06-02 15:59:21,012 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,012 - WARNING - No successful steps during online update.
2025-06-02 15:59:21,013 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], current edge mean: [ 3.5591397e+00  1.2365592e+00  3.4677420e+00  2.5636406e-09
 -1.2818203e-09 -1.4100023e-08 -7.6909217e-09  0.0000000e+00
  2.5636406e-09 -4.4863713e-09]
2025-06-02 15:59:21,013 - DEBUG - Node drift difference: 0.0969, Edge drift difference: 0.0251
2025-06-02 15:59:21,013 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.6964121e-09 -2.2178472e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.3763110e-08
  3.3267710e-08  1.2937442e-08  4.6205151e-09 -3.4191810e-08
  2.6744187e+00  2.8759689e+00  2.0155039e-01  4.4263568e+00
 -1.2937442e-08  2.0930233e+00  6.6666665e+00  7.6976743e+00
  2.0155039e-01  8.0000000e+00 -1.4785648e-08  4.0660534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7459517e-08 -4.6205152e-08], edge=[ 3.5591397e+00  1.2365592e+00  3.4677420e+00  2.5636406e-09
 -1.2818203e-09 -1.4100023e-08 -7.6909217e-09  0.0000000e+00
  2.5636406e-09 -4.4863713e-09]
2025-06-02 15:59:21,014 - DEBUG - Updated reference std: node=[0.         0.         1.0038986  1.0038986  0.         0.
 0.         1.0038986  1.0038987  1.0038986  1.0038986  1.0038986
 1.4040276  0.484248   0.43981254 0.7156203  1.0038986  2.3433478
 2.4947863  1.3784312  0.43981254 0.         1.0038986  1.0038986
 0.         0.         0.         0.         1.0038986  1.0038986 ], edge=[1.5558946 0.4386182 2.0219157 1.002699  1.002699  1.002699  1.002699
 1.002699  1.002699  1.002699 ]
2025-06-02 15:59:21,014 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:21,014 - INFO - Running anomaly detection...
2025-06-02 15:59:21,014 - INFO - Starting anomaly detection.
2025-06-02 15:59:21,016 - DEBUG - Node reconstruction errors: [18.442648  17.427181  14.512287  19.343754  17.103182  17.754633
 15.420452  16.293055  16.292929  17.799248  16.293238  14.876563
 15.447668  14.646692  17.83273   16.639791  19.885796  16.64495
 17.375275  16.8591    16.527863  17.832857  18.072502  13.8413
 18.01223   18.677147  17.855976  13.907025  16.529604  17.856134
 13.9969425 18.073376  17.18691   19.331232  18.404856  18.181557
 16.870174  16.85635   17.292759  16.113506  20.770773  18.178324
 16.85635   19.440647  18.830193  17.260212  22.404875  25.159876
 16.849693  29.993034  31.80979   18.826075  19.045391  17.621426
 17.427404  14.673287  18.909185  17.623426  18.57907   18.469908
 13.727426  21.332472  18.665464  14.512201  18.889704  17.42744
 18.937342  16.995358  18.64222   18.642447  17.98288   17.734222
 19.53214   17.444921  18.737324  17.44491   19.22903   18.083849
 18.083849  18.083845  20.811554  18.083849  18.028048  19.869108
 19.05495   19.665571  18.497929  18.083845  18.08385   20.18587
 19.084332  20.72949   20.72949   19.156233  19.140741  27.219358
 22.01081   19.14224   19.940916  17.890617  19.145193  22.010672
 19.77586   18.08385   18.673708  18.663172  19.29901   14.664088
 19.665571  25.376     18.925428  20.867212  14.851658  19.665571
 19.08425   19.78364   19.77598   18.658754  18.795723  19.138044
 21.728458  20.7295    20.72949   20.7295    18.658758  19.137968
 15.531802  13.918963  19.151102 ]
2025-06-02 15:59:21,017 - DEBUG - Edge reconstruction errors: [0.7043352  0.9506982  0.78810185 0.5470973  7.1689634  0.7424522
 0.7589803  0.7440735  0.9448076  0.22436927 0.76079124 0.7461505
 0.88364637 0.22680639 0.7456279  1.7358092  0.7319773  0.800371
 0.2648499  1.8658962  0.22436927 0.85563976 1.0793836  0.23140533
 0.77137685 0.22436927 0.7444813  0.86680895 0.74507177 0.74104375
 0.8024334  0.74602765 0.7461615  1.846958   0.74499494 0.7440697
 0.7375407  0.74399316 1.2951508  1.4973861  0.7478857  4.746111
 0.54466593 1.1166406  1.2168622  0.85572356 0.9629447  0.887814
 0.7681354  0.750255   0.9443406  0.737758   0.22935466 0.8942226
 0.7428406  0.6460468  0.8490905  0.7438894  0.7382152  0.79987675
 0.73839396 0.7447304  0.65252453 0.8553228  0.76506907 0.7629881
 0.6516909  0.8544933  0.7393876  0.7803653  0.64602995 0.8488096
 0.7472344  0.64187884 0.8448023  0.64438486 0.84730816 0.65047723
 0.8533857  0.6499357  0.8528486  0.64503497 0.847952   0.6392215
 0.8422385  0.68705595 0.8899208  0.91578543 1.1188678  0.86823595
 1.071089   0.7424135  0.7508947  0.7445232  0.22037478 0.96463054
 0.22074904 0.22037478 0.22074904 0.64159906 0.84448445 0.74404806
 0.22684206 0.7442717  0.22037478 0.22838902 0.743344   0.78575003
 0.7694544  0.7847882  0.8190559  0.7438422  0.760009   1.0714608
 1.3379023  0.2372635  0.72875065 0.21967812 0.95885444 1.049919
 0.5471401  0.85211194 0.95076966 0.81336606 0.22858492 0.2646031
 1.0336173  0.77340245 0.7557543  0.7630964  0.7493228  0.7455654
 2.0894787  0.81796503 0.7979553  0.34399596 0.86117    1.0632598
 0.23137371 0.7943846  0.7481771  0.7626868  1.1141657  2.9582038
 0.7476435  0.7472546  0.38776416 0.23491482 0.74642783 2.4390912
 0.1162196  0.94126576 0.23196961 0.2204694  0.22048324 0.23519276
 0.75789213 0.805469   0.7500889  0.75228643 0.7672616  0.7928273
 0.22154622 0.75145304 0.93722606 0.22275728 0.7655703  0.75535595
 0.25226098 0.7496728  0.92059    0.75604826 0.6800319  0.8823025
 0.74413925 0.7453571  0.72878546 0.759437   0.15729928 0.5685771
 1.0496981  0.66538346 0.85077906 0.7511032  0.950353   0.74123526]
2025-06-02 15:59:21,018 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155921_update_10.json
2025-06-02 15:59:21,018 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:21,021 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155921_update_10.pth and as latest_checkpoint.pth
2025-06-02 15:59:21,021 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869395.dot): 0.3737
2025-06-02 15:59:21,021 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-02 15:59:21,021 - WARNING -   Node ID: ff02::2, Recon Error: 29.9930, MLP Score: 0.0041
2025-06-02 15:59:21,021 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 31.8098, MLP Score: 0.0036
2025-06-02 15:59:21,021 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 27.2194, MLP Score: 0.0043
2025-06-02 15:59:21,021 - WARNING -   Node ID: ff02::fb, Recon Error: 25.3760, MLP Score: 0.0049
2025-06-02 15:59:21,021 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-02 15:59:21,021 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.1690, MLP Score: 0.5668
2025-06-02 15:59:21,021 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7461, MLP Score: 0.2787
2025-06-02 15:59:21,021 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.9582, MLP Score: 0.3963
2025-06-02 15:59:21,021 - INFO - 
--- Processing file: nw_graph_encoded_1748869425.dot (Timestamp: 2025-06-02 15:03:45) ---
2025-06-02 15:59:21,021 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:59:21,022 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:59:21,026 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:59:21,030 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:59:21,030 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:59:21,030 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869425.dot
2025-06-02 15:59:21,034 - INFO - Parsed 177 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:59:21,038 - INFO - Parsed 256 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869425.dot'.
2025-06-02 15:59:21,038 - INFO - Processing node updates/additions.
2025-06-02 15:59:21,040 - INFO - Processing edge updates/additions.
2025-06-02 15:59:21,042 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:21,042 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:21,042 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:21,042 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:21,044 - DEBUG - Initial node features tensor shape: torch.Size([177, 30])
2025-06-02 15:59:21,045 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:21,045 - DEBUG - Node features tensor shape after scaling: torch.Size([177, 30])
2025-06-02 15:59:21,046 - DEBUG - Edge index tensor shape: torch.Size([2, 256])
2025-06-02 15:59:21,046 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:21,047 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-02 15:59:21,047 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:21,047 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:21,048 - DEBUG - Shape of encoded categorical edge features: torch.Size([256, 3])
2025-06-02 15:59:21,048 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:21,048 - DEBUG - Shape of scaled numerical edge features: torch.Size([256, 7])
2025-06-02 15:59:21,049 - DEBUG - Final edge attributes tensor shape: torch.Size([256, 10])
2025-06-02 15:59:21,049 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:21,049 - INFO - Performing online update...
2025-06-02 15:59:21,049 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:21,049 - DEBUG - Updated RunningStats: new_mean=0.9334048283173413, new_var=5400000000169.0205, new_n=570
2025-06-02 15:59:21,050 - DEBUG - Updated RunningStats: new_mean=0.9222412610521001, new_var=5700000000013.945, new_n=600
2025-06-02 15:59:21,050 - DEBUG - Updated RunningStats: new_mean=0.9101681123395581, new_var=1800000000030.5046, new_n=190
2025-06-02 15:59:21,050 - DEBUG - Updated RunningStats: new_mean=0.9215229465771544, new_var=1900000000002.808, new_n=200
2025-06-02 15:59:21,050 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:21,050 - DEBUG - Online update step: 1/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 2/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 3/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 4/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 5/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 6/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 7/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 8/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 9/50
2025-06-02 15:59:21,050 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,050 - DEBUG - Online update step: 10/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 11/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 12/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 13/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 14/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 15/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 16/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 17/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 18/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 19/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 20/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 21/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 22/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 23/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 24/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 25/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 26/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 27/50
2025-06-02 15:59:21,051 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,051 - DEBUG - Online update step: 28/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 29/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 30/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 31/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 32/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 33/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 34/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 35/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 36/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 37/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 38/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 39/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 40/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 41/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 42/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 43/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 44/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 45/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 46/50
2025-06-02 15:59:21,052 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,052 - DEBUG - Online update step: 47/50
2025-06-02 15:59:21,053 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,053 - DEBUG - Online update step: 48/50
2025-06-02 15:59:21,053 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,053 - DEBUG - Online update step: 49/50
2025-06-02 15:59:21,053 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,053 - DEBUG - Online update step: 50/50
2025-06-02 15:59:21,053 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:21,053 - WARNING - No successful steps during online update.
2025-06-02 15:59:21,053 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], current edge mean: [ 4.4804688e+00  1.2421875e+00  4.3515625e+00  9.3132257e-09
  1.3969839e-08  4.6566129e-09  4.1909516e-09  0.0000000e+00
  7.4505806e-09 -4.6566129e-10]
2025-06-02 15:59:21,053 - DEBUG - Node drift difference: 0.0695, Edge drift difference: 0.5922
2025-06-02 15:59:21,053 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:21,054 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.2869655e-08  1.3806725e-07
  0.0000000e+00  0.0000000e+00  0.0000000e+00  4.8491913e-08
  2.6939952e-09  2.6939952e-09 -3.1654444e-08  1.4816973e-08
  2.6610169e+00  2.9096045e+00  1.8079096e-01  4.3785310e+00
  2.6939952e-09  2.1186440e+00  6.7175140e+00  7.7118645e+00
  1.8079096e-01  8.0000000e+00 -2.4245956e-08  5.3879905e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -4.0409930e-08  1.6163971e-08], edge=[ 4.4804688e+00  1.2421875e+00  4.3515625e+00  9.3132257e-09
  1.3969839e-08  4.6566129e-09  4.1909516e-09  0.0000000e+00
  7.4505806e-09 -4.6566129e-10]
2025-06-02 15:59:21,054 - DEBUG - Updated reference std: node=[0.         0.         1.002837   1.0028368  0.         0.
 0.         1.002837   1.002837   1.0028368  1.002837   1.0028368
 1.3349775  0.4166538  0.41433606 0.65556365 1.0028368  2.234172
 2.4678338  1.3320888  0.41433606 0.         1.0028368  1.002837
 0.         0.         0.         0.         1.002837   1.002837  ], edge=[1.5439984 0.4382871 2.3766506 1.0019588 1.0019588 1.0019588 1.0019588
 1.0019588 1.0019588 1.0019588]
2025-06-02 15:59:21,054 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:21,054 - INFO - Running anomaly detection...
2025-06-02 15:59:21,054 - INFO - Starting anomaly detection.
2025-06-02 15:59:21,058 - DEBUG - Node reconstruction errors: [18.995716  18.01382   16.276608  19.34212   18.122824  17.893671
 17.440254  16.465788  16.465803  17.931362  16.465776  15.349141
 16.776098  15.368934  18.01022   16.90611   20.079535  16.904335
 18.065283  17.058455  16.652683  18.01026   18.136866  14.277019
 18.013693  18.588226  17.99219   14.021193  16.652763  17.992224
 14.419982  18.137306  17.328209  19.589746  18.622797  18.290596
 17.121012  17.058613  13.884792  16.360758  20.809834  18.289938
 17.058615  19.912958  18.964535  17.342485  22.507143  25.170506
 16.930933  30.189829  32.2348    18.869638  18.889463  17.76766
 17.320848  15.3763    19.640772  17.695557  19.022318  19.031347
 14.740046  21.271862  18.682728  15.115658  18.718683  17.320852
 19.085714  17.234282  18.679056  18.679049  17.790142  18.774555
 19.295416  18.490835  18.88253   18.490824  22.070076  18.995714
 18.995714  18.995714  20.887396  19.23065   18.203503  19.780338
 18.82623   19.792965  19.307934  18.995716  18.99571   18.82513
 19.381372  20.47857   20.47857   18.591698  18.825048  27.465727
 21.585917  18.824675  19.798597  17.976645  18.825094  21.58474
 19.822191  18.99571   18.795328  18.386585  19.387148  15.277651
 19.792965  25.91191   18.868761  20.903484  15.505037  19.792965
 19.208845  19.82377   19.822212  15.151393  18.830053  18.824045
 21.644758  20.478579  20.47857   20.478579  19.564604  18.824038
 16.610199  15.015354  18.82595   21.58505   20.430813  18.830048
 18.795269  15.809468  18.830057  18.40071   22.561543  19.798042
 18.830254  18.830221  18.832527  21.544441  19.822205  18.830374
 21.408152  18.836924  18.830305  18.831757  18.787006  18.831503
 24.850868  15.737676  19.494371  18.830048  19.64167   15.8029995
 18.824505  18.830051  19.842043  22.547705  18.84527   15.809248
 18.824043  20.430044  19.564604  16.633139  19.4014    21.58772
 15.810223  18.8339    18.82687   18.824024  19.822216  28.227755
 18.82403   18.567186  18.83142  ]
2025-06-02 15:59:21,059 - DEBUG - Edge reconstruction errors: [0.7988745  1.0654505  0.9906933  0.7624155  8.2523985  0.95944875
 0.97216535 0.9603809  1.0621195  0.34410378 0.97437865 0.9621274
 1.0757385  0.35214302 0.9637827  0.8634351  1.0647043  5.850163
 0.8521859  1.0057136  0.37462386 1.8637298  0.34410378 1.0752952
 1.2154877  0.35473594 0.98300666 0.34410378 0.9602808  1.2067794
 0.9881656  0.95915735 1.0089082  0.96160847 0.961876   1.9050817
 0.96079683 0.8597504  0.9632561  1.7023171  0.96185946 0.9616361
 0.85039806 1.0653969  0.8604437  1.0316616  0.35443002 1.00642
 1.567153   0.9628981  0.35599288 1.0672243  1.0496892  1.0661677
 1.1901778  0.978006   0.35007727 0.99181795 1.3619385  0.9633081
 0.9839997  0.9613238  0.96158636 1.1140684  0.9727209  0.9741217
 0.9726316  0.96255594 0.35443854 1.0321429  0.85170513 1.0478879
 0.35484472 0.9639263  0.9615909  0.96164125 0.86264217 1.0636597
 0.95857716 0.9648725  1.3981414  1.5991597  0.9668243  5.469361
 0.76245713 1.3084732  1.4085791  1.0694867  1.0735434  1.0602896
 0.98280954 0.96866906 1.0620329  0.9580808  0.35516033 1.0697768
 0.9636945  0.86675775 1.0680182  0.962234   0.9584802  1.0104917
 0.9591542  0.96482307 0.8711184  1.0722218  0.9779095  0.9776623
 0.87044233 1.0715467  1.3154504  0.99214935 0.86654866 1.0676358
 0.96488214 0.8643621  1.0653937  0.865199   1.0665207  0.8695537
 1.0708715  0.8691853  1.0705041  0.8655681  1.0668882  0.86063486
 1.062092   0.8966681  1.0979716  1.0943178  1.2956151  1.272829
 1.4742324  0.34931806 0.9609582  0.9682545  0.96224976 0.34502974
 1.1384906  0.34567687 0.34502974 0.34567687 0.8631976  1.0644717
 0.9619377  0.35355914 0.97779924 0.34502974 0.35457408 0.96379524
 0.9909025  0.97992045 1.1164045  1.0138338  0.9925386  0.9895858
 0.9798182  0.97538906 1.0565     0.35369995 1.0385201  0.96213
 0.861814   1.0631394  0.8740668  1.0753338  0.9617121  0.34989336
 0.9614316  0.96204996 0.9762388  1.1746902  1.2604196  0.3573566
 0.84886956 0.33932853 1.0705496  1.2647601  0.7624028  1.0662658
 1.0653867  1.0078777  0.346498   0.37690523 1.1729348  0.9800679
 0.9676119  0.97532606 0.9625045  0.9599816  1.8287494  1.0086643
 0.99635214 0.46085975 1.0102013  1.211265   0.35262913 0.99341756
 0.962557   0.97249323 1.1682088  2.7866275  0.9612933  0.9616548
 0.4589888  0.35530537 0.9639914  2.349024   0.23672329 1.0622087
 0.8683287  1.0694621  0.35019398 0.33974665 0.33975926 0.35266298
 0.9910815  1.0039084  0.96475476 0.96534044 0.97519726 0.99096787
 0.34048128 0.9661685  1.0546234  0.34086186 0.97398555 0.9670657
 0.36653048 0.97985286 1.0927995  0.9688615  0.9389813  1.1401939
 0.9675616  0.960797   0.85136044 0.9706425  1.0391852  1.2403932
 0.878795   1.0799575  0.9616671  0.97819024 0.9617391  0.97291267
 0.9632227  0.04221801 0.77711856 1.2646947  0.87518275 1.0655111
 0.9658194  1.0651205  0.8569714  0.85695803]
2025-06-02 15:59:21,060 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155921_update_11.json
2025-06-02 15:59:21,061 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:21,064 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155921_update_11.pth and as latest_checkpoint.pth
2025-06-02 15:59:21,064 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869425.dot): 0.3779
2025-06-02 15:59:21,064 - WARNING - Detected 5 anomalous nodes (reconstruction-based):
2025-06-02 15:59:21,064 - WARNING -   Node ID: ff02::2, Recon Error: 30.1898, MLP Score: 0.0038
2025-06-02 15:59:21,064 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 32.2348, MLP Score: 0.0034
2025-06-02 15:59:21,064 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 27.4657, MLP Score: 0.0040
2025-06-02 15:59:21,064 - WARNING -   Node ID: ff02::fb, Recon Error: 25.9119, MLP Score: 0.0042
2025-06-02 15:59:21,064 - WARNING -   Node ID: fe80::3674:28:2588:1274, Recon Error: 28.2278, MLP Score: 0.0039
2025-06-02 15:59:21,064 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-02 15:59:21,064 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 8.2524, MLP Score: 0.7451
2025-06-02 15:59:21,064 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.8502, MLP Score: 0.4451
2025-06-02 15:59:21,064 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.4694, MLP Score: 0.4736
2025-06-02 15:59:21,064 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 2.7866, MLP Score: 0.2946
2025-06-02 15:59:21,067 - DEBUG - Embedding standard deviations before t-SNE: [1.0837867  0.         0.         0.         1.0166796  0.
 0.39077154 0.         0.         1.5779333  2.0679967  0.34848043
 0.         0.54521716 0.         0.54733795 1.5847791  0.
 0.         0.35788876 0.         0.         0.         0.8284591
 0.         0.8783333  0.01341934 0.         0.         0.
 0.5507168  0.26573223]
2025-06-02 15:59:21,423 - INFO - Embeddings visualization saved to vis/embeddings_11_updates_20250602_155921.png
2025-06-02 15:59:21,423 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:21,424 - INFO - Starting visualization of node features.
2025-06-02 15:59:21,424 - INFO - Graph has 177 nodes and 30 features.
2025-06-02 15:59:21,424 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:21,424 - INFO - Calculating feature statistics:
2025-06-02 15:59:21,424 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,424 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,424 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8533714), 'max': np.float32(0.91034335)}
2025-06-02 15:59:21,424 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.90634286), 'max': np.float32(1.8645692)}
2025-06-02 15:59:21,424 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,424 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,424 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,425 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:59:21,425 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-1.064204), 'max': np.float32(0.9396695)}
2025-06-02 15:59:21,425 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-4.897244), 'max': np.float32(0.21041438)}
2025-06-02 15:59:21,425 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 6, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-2.4087965), 'max': np.float32(0.73897755)}
2025-06-02 15:59:21,425 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 6, 'mean': np.float32(4.3103924e-08), 'std': np.float32(1.0), 'min': np.float32(-0.73631406), 'max': np.float32(2.423313)}
2025-06-02 15:59:21,425 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.661017), 'std': np.float32(1.3312011), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:59:21,425 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9096045), 'std': np.float32(0.4154752), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:21,425 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:21,425 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.378531), 'std': np.float32(0.6537092), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:21,425 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-5.3879905e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.21041438), 'max': np.float32(4.897244)}
2025-06-02 15:59:21,425 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(2.118644), 'std': np.float32(2.227852), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:59:21,425 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.717514), 'std': np.float32(2.4608526), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:21,425 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.7118645), 'std': np.float32(1.3283206), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:21,425 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.18079096), 'std': np.float32(0.41316396), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:21,426 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:21,426 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(-4.3103924e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.2046888), 'max': np.float32(6.382569)}
2025-06-02 15:59:21,426 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.3879905e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.21757132), 'max': np.float32(4.5961943)}
2025-06-02 15:59:21,426 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,426 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,426 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,426 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:21,426 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-2.3572458e-08), 'std': np.float32(1.0), 'min': np.float32(-0.8935937), 'max': np.float32(5.248779)}
2025-06-02 15:59:21,426 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-8.081986e-09), 'std': np.float32(1.0), 'min': np.float32(-0.99771225), 'max': np.float32(4.353653)}
2025-06-02 15:59:21,438 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1848c80>
2025-06-02 15:59:21,575 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:21,629 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:21,661 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:23,741 - INFO - Node feature visualization saved to vis/node_features_20250602_155921.png
2025-06-02 15:59:23,741 - INFO - Finished visualization of node features.
2025-06-02 15:59:23,741 - INFO - Performing additional feature analysis:
2025-06-02 15:59:23,741 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:23,742 - INFO - Starting visualization of edge features.
2025-06-02 15:59:23,742 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:59:23,742 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:23,742 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:23,743 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:23,743 - INFO - - count: {'name': 'count', 'unique': 11, 'mean': np.float32(4.4804688), 'std': np.float32(1.5409797), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 15:59:23,743 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.2421875), 'std': np.float32(0.43743023), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:23,743 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.3515625), 'std': np.float32(2.3720043), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 15:59:23,743 - INFO - - service: {'name': 'service', 'unique': 17, 'mean': np.float32(1.4901161e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.11696286), 'max': np.float32(11.802426)}
2025-06-02 15:59:23,743 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 175, 'mean': np.float32(1.4901161e-08), 'std': np.float32(1.0), 'min': np.float32(-0.20738153), 'max': np.float32(10.820693)}
2025-06-02 15:59:23,743 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 204, 'mean': np.float32(3.7252903e-09), 'std': np.float32(1.0), 'min': np.float32(-0.18580021), 'max': np.float32(11.406377)}
2025-06-02 15:59:23,743 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 100, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.14294389), 'max': np.float32(11.675713)}
2025-06-02 15:59:23,743 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 180, 'mean': np.float32(-3.7252903e-09), 'std': np.float32(1.0), 'min': np.float32(-0.26953164), 'max': np.float32(7.853787)}
2025-06-02 15:59:23,743 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 197, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.26466182), 'max': np.float32(8.580755)}
2025-06-02 15:59:23,743 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 104, 'mean': np.float32(-7.450581e-09), 'std': np.float32(1.0), 'min': np.float32(-0.15828094), 'max': np.float32(11.456623)}
2025-06-02 15:59:23,766 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1dd4170>
2025-06-02 15:59:23,895 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:23,915 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0aa539c40>
2025-06-02 15:59:24,121 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:24,440 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:24,629 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:24,651 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:24,661 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:26,586 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155924.png
2025-06-02 15:59:26,586 - INFO - Finished visualization of edge features.
2025-06-02 15:59:26,586 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:26,587 - INFO - - Highest correlation (1.00) between features: 'service' and 'total_orig_pkts'.
2025-06-02 15:59:26,587 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:26,587 - INFO - Graph has 256 edges and 10 edge features.
2025-06-02 15:59:26,587 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:26,888 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155926_summary.png
2025-06-02 15:59:27,081 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155926_pca_3d.png
2025-06-02 15:59:27,255 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155926_pca_variance.png
2025-06-02 15:59:27,255 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:27,255 - INFO - 
--- Processing file: nw_graph_encoded_1748869455.dot (Timestamp: 2025-06-02 15:04:15) ---
2025-06-02 15:59:27,255 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:59:27,255 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:59:27,260 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:59:27,264 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:59:27,264 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:59:27,264 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869455.dot
2025-06-02 15:59:27,269 - INFO - Parsed 256 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:59:27,272 - INFO - Parsed 395 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869455.dot'.
2025-06-02 15:59:27,272 - INFO - Processing node updates/additions.
2025-06-02 15:59:27,273 - INFO - Processing edge updates/additions.
2025-06-02 15:59:27,275 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:27,275 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:27,275 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:27,275 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:27,277 - DEBUG - Initial node features tensor shape: torch.Size([256, 30])
2025-06-02 15:59:27,278 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:27,278 - DEBUG - Node features tensor shape after scaling: torch.Size([256, 30])
2025-06-02 15:59:27,279 - DEBUG - Edge index tensor shape: torch.Size([2, 395])
2025-06-02 15:59:27,279 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:27,280 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-02 15:59:27,280 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:27,280 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:27,281 - DEBUG - Shape of encoded categorical edge features: torch.Size([395, 3])
2025-06-02 15:59:27,281 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:27,281 - DEBUG - Shape of scaled numerical edge features: torch.Size([395, 7])
2025-06-02 15:59:27,281 - DEBUG - Final edge attributes tensor shape: torch.Size([395, 10])
2025-06-02 15:59:27,281 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:27,282 - INFO - Performing online update...
2025-06-02 15:59:27,282 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:27,282 - DEBUG - Updated RunningStats: new_mean=0.9337999609244829, new_var=6000000000166.255, new_n=630
2025-06-02 15:59:27,282 - DEBUG - Updated RunningStats: new_mean=0.9242769022321714, new_var=6300000000015.69, new_n=660
2025-06-02 15:59:27,282 - DEBUG - Updated RunningStats: new_mean=0.9264172733116244, new_var=2000000000031.1426, new_n=210
2025-06-02 15:59:27,282 - DEBUG - Updated RunningStats: new_mean=0.9343319951406481, new_var=2100000000002.0076, new_n=220
2025-06-02 15:59:27,283 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:27,283 - DEBUG - Online update step: 1/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 2/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 3/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 4/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 5/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 6/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 7/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 8/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 9/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 10/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 11/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 12/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 13/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 14/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 15/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 16/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 17/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 18/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 19/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 20/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 21/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 22/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 23/50
2025-06-02 15:59:27,283 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,283 - DEBUG - Online update step: 24/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 25/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 26/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 27/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 28/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 29/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 30/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 31/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 32/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 33/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 34/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 35/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 36/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 37/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 38/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 39/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 40/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 41/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 42/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 43/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 44/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 45/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 46/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 47/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,284 - DEBUG - Online update step: 48/50
2025-06-02 15:59:27,284 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,285 - DEBUG - Online update step: 49/50
2025-06-02 15:59:27,285 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,285 - DEBUG - Online update step: 50/50
2025-06-02 15:59:27,285 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,285 - WARNING - No successful steps during online update.
2025-06-02 15:59:27,285 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], current edge mean: [ 4.3518987e+00  1.3265823e+00  4.5645571e+00  1.3279010e-08
 -2.4143654e-09 -3.6215480e-09  7.2430959e-09  1.2071827e-09
  7.2430959e-09 -1.2071827e-09]
2025-06-02 15:59:27,285 - DEBUG - Node drift difference: 0.2039, Edge drift difference: 0.1926
2025-06-02 15:59:27,285 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:59:27,286 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.7055225e-08  7.4505806e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6763806e-08
  1.8626451e-08  3.7252903e-09 -1.1175871e-08 -5.5879354e-09
  2.6054688e+00  2.9296875e+00  1.8750000e-01  4.3476562e+00
 -3.7252903e-09  2.5742188e+00  6.4804688e+00  7.6367188e+00
  1.8750000e-01  8.0000000e+00  4.4703484e-08 -2.4214387e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.2829121e-08  2.2351742e-08], edge=[ 4.3518987e+00  1.3265823e+00  4.5645571e+00  1.3279010e-08
 -2.4143654e-09 -3.6215480e-09  7.2430959e-09  1.2071827e-09
  7.2430959e-09 -1.2071827e-09]
2025-06-02 15:59:27,286 - DEBUG - Updated reference std: node=[0.         0.         1.0019588  1.0019588  0.         0.
 0.         1.0019588  1.0019588  1.0019588  1.0019588  1.0019588
 1.209687   0.36907077 0.41064274 0.6137592  1.0019588  2.614132
 2.6151161  1.4622234  0.41064274 0.         1.0019588  1.0019588
 0.         0.         0.         0.         1.0019588  1.0019588 ], edge=[1.3215185  0.47493222 2.200083   1.0012683  1.0012683  1.0012683
 1.0012683  1.0012681  1.0012683  1.0012683 ]
2025-06-02 15:59:27,286 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:27,286 - INFO - Running anomaly detection...
2025-06-02 15:59:27,286 - INFO - Starting anomaly detection.
2025-06-02 15:59:27,289 - DEBUG - Node reconstruction errors: [21.042236  20.28084   17.798462  19.536936  18.501478  18.03674
 19.017284  17.14973   17.149805  18.567595  17.149485  16.751837
 22.782019  16.968357  18.665558  17.653852  20.777193  17.626312
 19.221035  17.754797  17.275763  18.665527  18.722864  15.671967
 18.584103  18.713694  18.621555  15.561614  17.274225  18.621529
 15.800471  18.72259   15.107423  19.67853   18.71205   18.900455
 17.266443  17.756874  14.904672  17.27241   21.329317  18.900991
 17.756874  20.393574  19.629549  17.913816  23.171453  25.761454
 17.507298  31.226845  33.986244  19.420567  18.941742  22.100481
 17.382765  15.835301  23.466366  18.33385   19.321657  19.38168
 15.506646  21.744743  19.241146  16.47059   18.766705  17.743885
 19.101479  17.364452  19.243856  19.243795  17.764862  19.027254
 19.266415  18.78329   19.916485  18.783281  22.463203  19.23724
 19.237242  19.145863  20.76435   19.443157  18.187944  20.24293
 19.003635  16.795496  19.532925  19.237242  19.237246  19.77871
 19.30684   15.517487  20.30653   19.785076  18.694979  28.791636
 21.368135  18.694946  20.2674    17.919434  19.778698  21.368052
 19.697758  19.237265  18.720158  18.27646   19.496979  15.481629
 19.70551   26.470707  19.261635  20.769321  15.033     15.6429615
 19.438301  19.77589   19.511265  15.522737  19.707457  18.694883
 21.368528  20.306528  16.23479   20.306528  19.73369   18.694881
 16.825216  15.150676  19.778685  21.368109  20.817719  18.706478
 18.720165  15.96975   18.706396  18.300087  22.937567  20.267658
 18.707054  18.70647   18.707523  21.35327   19.69776   18.706516
 21.16755   18.709143  18.706509  18.707193  19.26082   18.70708
 24.820137  15.941904  20.487305  18.706478  19.674429  16.071672
 18.694925  19.775766  19.709822  22.317064  18.713314  15.969635
 18.694885  20.817934  19.733696  16.852913  20.481808  21.368406
 15.459072  18.708158  18.695055  18.69488   19.697762  29.467346
 18.69488   18.551548  18.707014  20.299547  20.355944  19.315664
 18.90256   20.963898  19.813545  15.730253  20.963898  20.299658
 20.339298  20.917322  20.339317  19.315582  20.355751  20.299553
 20.918367  18.877985  19.697779  20.916706  19.184092  19.69776
 17.089548  21.368109  20.267618  18.694918  15.377105  21.368929
 19.713419  20.30653   20.357477  16.825401  20.267672  20.267672
 22.043009  19.329533  19.315584  19.713419  20.299557  19.709648
 20.299543  19.713419  19.316254  18.694881  20.963898  20.339285
 20.339314  19.31558   18.694881  20.261806  20.299618  18.69488
 19.315584  20.283346  20.306528  20.355951  21.35375   19.713457
 19.713423  20.9167    20.268393  20.339293  18.694881  21.570871
 20.963898  20.267664  19.329405  18.70648   19.31564   18.706402
 19.319117  20.29956   19.329405  18.894733  19.697828  19.709696
 19.315666  18.694887  19.713438  19.713442 ]
2025-06-02 15:59:27,290 - DEBUG - Edge reconstruction errors: [0.8372197  0.81460494 1.1160161  1.025673   0.81409174 7.887554
 1.009028   1.0136449  1.0093195  1.1139418  0.40763053 1.0181049
 1.0113548  1.0633216  0.4065881  1.0130724  0.91234857 1.1134155
 5.174377   0.9055647  1.0233263  0.4179761  1.3707191  0.39890555
 1.0735792  1.0967562  0.4061952  1.0197654  0.93969804 1.1407202
 0.40448686 0.93205273 1.1329111  1.013596   0.9155248  1.1163502
 1.1182916  1.0209627  1.0098604  1.0267417  1.0336938  1.2343731
 1.0139844  0.9129259  1.1136831  1.0138234  0.9129891  1.1137949
 1.2507937  1.0100151  0.90935177 1.0118136  1.312005   1.0138339
 0.9145479  1.1152978  1.010219   0.9070185  1.1150173  0.9125894
 1.031576   0.40812346 1.024451   1.615253   1.011774   0.40891775
 1.0563701  1.0474468  1.0540944  1.1037054  1.0173037  0.40341604
 1.0191996  1.1607958  1.0123277  1.018279   1.010194   1.0108553
 1.0723263  1.0152503  1.0461524  1.0151769  1.0109792  0.40817252
 1.0428168  0.9054803  1.0450525  0.40893272 1.0244951  1.0155348
 1.0154492  0.9126779  1.113465   1.0114473  1.0156727  1.0168437
 0.3998816  0.9121912  1.1130873  0.9120309  1.112927   1.022454
 0.9251112  1.1260033  0.91217697 1.113073   1.0116464  0.9121743
 1.1130704  0.91129917 1.1122751  0.92027533 1.1211668  1.0100176
 0.91806614 1.1189587  1.0105555  0.9174724  1.1183355  0.9130745
 1.1139401  0.9160066  1.1171025  0.91479987 1.1157458  0.9148156
 1.1156795  1.0104067  1.0109422  1.0106773  1.0164069  0.95863163
 1.1594927  1.0111097  1.0111585  0.9161327  1.1169956  0.9132688
 1.1141342  0.9424438  1.1433067  1.0105528  1.0110047  1.0081449
 1.0130086  1.0679308  1.268854   1.0106019  8.092303   0.81407475
 1.3349369  1.4350103  1.1175474  1.1260836  1.0667293  1.0162448
 1.0120184  1.1138338  1.0084655  0.40850455 1.0678445  1.0179117
 0.9137235  1.1148125  1.0112273  1.0121399  1.022196   1.0097942
 1.0136492  0.91586334 1.116732   1.0167006  1.0187713  0.91562015
 1.1164892  2.5940752  1.0227692  0.91402113 1.1148721  1.0110233
 0.913391   1.1141763  0.9136889  1.1145669  1.0136352  0.91495925
 1.1159704  0.9147679  1.1157794  0.91344845 1.1144606  0.9118653
 1.1129824  0.92488194 1.1258863  0.9751984  1.1762022  1.1199362
 1.3210244  0.4061768  1.0172763  1.0103154  1.0121795  1.0106239
 0.40485954 0.92219484 1.1234252  1.1259638  0.94807076 1.1488316
 0.3993093  0.4040406  0.91986716 1.1209034  0.3993093  0.91247886
 1.1134626  1.010498   0.40741032 1.018525   0.39899197 0.4081269
 1.0135146  1.0253398  0.9131373  1.113957   1.0175637  1.0727149
 1.0349591  0.91610545 1.1169225  1.0254228  0.91861045 1.1194255
 1.0216973  1.0167027  1.015625   1.0361428  0.4052248  1.0432099
 1.0105623  0.91204816 1.1131016  0.9168212  1.1178017  1.0104604
 0.4032215  1.010377   1.011061   1.0163008  0.40973017 1.0173858
 0.39899197 1.0277845  0.4060295  1.0210036  1.0104594  1.0146415
 1.0111295  1.0216794  1.010569   0.40726513 1.0181389  1.1087123
 1.0100926  1.0104367  1.0105226  1.0122437  1.0104605  0.3991864
 1.0212364  1.0309347  1.011958   1.011927   1.0114589  1.0108101
 1.0571245  0.3999313  1.0191637  1.0136169  0.3999313  0.9171023
 1.1181312  0.3999313  1.1507125  1.1128689  1.0328082  0.3999313
 1.0145938  1.010751   1.0167025  1.0164502  1.017077   1.0196478
 1.010797   1.0108407  1.0114775  0.40810674 1.0547717  1.0109859
 1.0072662  1.0262047  0.41441208 0.9188963  1.1190175  0.9085464
 0.40339994 1.1188099  1.3160852  0.81493676 1.1165545  1.1163064
 1.0333049  0.40602505 0.42131487 1.0954131  1.0202768  1.0158229
 1.0165379  1.0140157  1.0122775  1.4437308  1.0346988  1.0272362
 0.514373   1.0381268  1.2384057  0.4111363  1.0264237  1.0135384
 1.0177102  1.0005894  1.5551074  1.0129527  1.0132728  0.4509954
 0.41339368 1.0158231  1.4350902  0.30174598 1.1143651  0.91720897
 1.1176969  0.40760076 0.40359774 0.4036006  0.40896598 1.0229394
 1.0293233  1.0135887  1.014074   1.0192982  1.0271678  0.40984058
 0.91564894 1.1160519  1.0141884  5.8518624  0.40414536 1.0190972
 1.0151812  0.4188777  1.0223143  1.0569835  1.0148398  0.94861186
 1.1488835  1.0160282  1.0132347  0.90882546 1.0166034  1.018529
 1.2187856  0.92117774 1.1214111  1.0129946  1.0197393  1.0133352
 1.017656   1.0139309  1.0127788  1.0127807  1.0172675  1.0133944
 1.0128808  0.0111133  0.8210753  1.3182236  0.9201941  1.1161641
 1.0161235  1.1161749  1.4176683  0.9099591  0.9099994 ]
2025-06-02 15:59:27,291 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155927_update_12.json
2025-06-02 15:59:27,291 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:27,294 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155927_update_12.pth and as latest_checkpoint.pth
2025-06-02 15:59:27,294 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869455.dot): 0.4134
2025-06-02 15:59:27,294 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 15:59:27,294 - WARNING -   Node ID: 150.171.28.10, Recon Error: 25.7615, MLP Score: 0.0110
2025-06-02 15:59:27,294 - WARNING -   Node ID: ff02::2, Recon Error: 31.2268, MLP Score: 0.0031
2025-06-02 15:59:27,294 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 33.9862, MLP Score: 0.0027
2025-06-02 15:59:27,294 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 28.7916, MLP Score: 0.0032
2025-06-02 15:59:27,294 - WARNING -   Node ID: ff02::fb, Recon Error: 26.4707, MLP Score: 0.0034
2025-06-02 15:59:27,294 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-02 15:59:27,294 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.8876, MLP Score: 0.4059
2025-06-02 15:59:27,294 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.1744, MLP Score: 0.1848
2025-06-02 15:59:27,294 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 8.0923, MLP Score: 0.4757
2025-06-02 15:59:27,294 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.8519, MLP Score: 0.7592
2025-06-02 15:59:27,294 - INFO - 
--- Processing file: nw_graph_encoded_1748869485.dot (Timestamp: 2025-06-02 15:04:45) ---
2025-06-02 15:59:27,294 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:59:27,294 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:59:27,301 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:59:27,307 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:59:27,307 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:59:27,307 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869485.dot
2025-06-02 15:59:27,314 - INFO - Parsed 300 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:59:27,320 - INFO - Parsed 503 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869485.dot'.
2025-06-02 15:59:27,320 - INFO - Processing node updates/additions.
2025-06-02 15:59:27,321 - INFO - Processing edge updates/additions.
2025-06-02 15:59:27,324 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:27,324 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:27,324 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:27,325 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:27,327 - DEBUG - Initial node features tensor shape: torch.Size([300, 30])
2025-06-02 15:59:27,329 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:27,329 - DEBUG - Node features tensor shape after scaling: torch.Size([300, 30])
2025-06-02 15:59:27,329 - DEBUG - Edge index tensor shape: torch.Size([2, 503])
2025-06-02 15:59:27,330 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:27,331 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 11
2025-06-02 15:59:27,331 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:27,332 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:27,332 - DEBUG - Shape of encoded categorical edge features: torch.Size([503, 3])
2025-06-02 15:59:27,333 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:27,333 - DEBUG - Shape of scaled numerical edge features: torch.Size([503, 7])
2025-06-02 15:59:27,333 - DEBUG - Final edge attributes tensor shape: torch.Size([503, 10])
2025-06-02 15:59:27,333 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:27,334 - INFO - Performing online update...
2025-06-02 15:59:27,334 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:27,334 - DEBUG - Updated RunningStats: new_mean=0.9347527855032551, new_var=6600000000164.882, new_n=690
2025-06-02 15:59:27,334 - DEBUG - Updated RunningStats: new_mean=0.9262884809244796, new_var=6900000000016.829, new_n=720
2025-06-02 15:59:27,334 - DEBUG - Updated RunningStats: new_mean=0.9386738579789974, new_var=2200000000031.61, new_n=230
2025-06-02 15:59:27,334 - DEBUG - Updated RunningStats: new_mean=0.9449763220646484, new_var=2300000000001.7407, new_n=240
2025-06-02 15:59:27,334 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:27,335 - DEBUG - Online update step: 1/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 2/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 3/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 4/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 5/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 6/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 7/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 8/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 9/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 10/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 11/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 12/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 13/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 14/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 15/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 16/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 17/50
2025-06-02 15:59:27,335 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,335 - DEBUG - Online update step: 18/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 19/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 20/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 21/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 22/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 23/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 24/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 25/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 26/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 27/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 28/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 29/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 30/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 31/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 32/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 33/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 34/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 35/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 36/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 37/50
2025-06-02 15:59:27,336 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,336 - DEBUG - Online update step: 38/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 39/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 40/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 41/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 42/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 43/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 44/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 45/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 46/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 47/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 48/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 49/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - DEBUG - Online update step: 50/50
2025-06-02 15:59:27,337 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,337 - WARNING - No successful steps during online update.
2025-06-02 15:59:27,338 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], current edge mean: [ 4.3359842e+00  1.3638171e+00  4.6421471e+00  1.3745803e-08
 -1.4219796e-09  0.0000000e+00 -3.3179524e-09  0.0000000e+00
  2.8439593e-09  2.3699660e-09]
2025-06-02 15:59:27,338 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0784
2025-06-02 15:59:27,338 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.4504802e-08  8.2651773e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.7815501e-08
  2.7020773e-08 -7.9472864e-09  2.2252401e-08  1.5894572e-09
  2.6233332e+00  2.9400001e+00  1.6666667e-01  4.3433332e+00
  9.5367430e-09  2.8033333e+00  6.3033333e+00  7.6100001e+00
  1.6666667e-01  8.0000000e+00 -4.1325887e-08 -7.9472864e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.5894573e-08 -3.2583873e-08], edge=[ 4.3359842e+00  1.3638171e+00  4.6421471e+00  1.3745803e-08
 -1.4219796e-09  0.0000000e+00 -3.3179524e-09  0.0000000e+00
  2.8439593e-09  2.3699660e-09]
2025-06-02 15:59:27,339 - DEBUG - Updated reference std: node=[0.         0.         1.0016708  1.0016708  0.         0.
 0.         1.0016708  1.0016708  1.0016708  1.0016708  1.0016708
 1.1858089  0.34174448 0.39080855 0.5999907  1.0016708  2.8067029
 2.7072284  1.5051417  0.39080855 0.         1.0016708  1.0016708
 0.         0.         0.         0.         1.0016708  1.0016708 ], edge=[1.2860101 0.4856947 2.1206565 1.0009955 1.0009955 1.0009955 1.0009955
 1.0009955 1.0009955 1.0009955]
2025-06-02 15:59:27,339 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:27,339 - INFO - Running anomaly detection...
2025-06-02 15:59:27,339 - INFO - Starting anomaly detection.
2025-06-02 15:59:27,343 - DEBUG - Node reconstruction errors: [21.618853  20.91568   19.912306  19.851885  14.495513  18.854046
 19.912306  17.466566  17.466679  18.895927  17.466284  17.271746
 25.685371  17.194971  19.0073    18.057364  21.184835  18.023748
 19.892458  18.117878  17.568884  19.007242  19.324799  16.108257
 18.882357  18.959742  18.940361  15.95367   17.567055  18.940304
 16.215347  19.018822  15.61343   19.957588  18.959814  19.21645
 18.018488  18.120554  15.878831  17.574306  21.623537  19.217707
 18.120554  20.646097  20.004217  18.180067  23.541182  26.094988
 17.771328  31.69267   34.81129   19.696747  19.15752   22.587198
 17.895075  16.125727  24.504332  18.646029  19.888838  19.888838
 15.757066  22.019907  19.518953  16.864965  18.973532  17.89509
 18.286827  17.916075  19.523977  19.523886  17.927824  19.282827
 19.436811  19.502562  20.07379   19.049526  22.701403  19.928858
 19.73686   19.530024  20.933468  19.96604   18.429665  20.747763
 18.8421    17.083435  20.027987  19.736721  19.942831  20.007748
 19.477362  15.911675  20.466625  19.809294  18.814484  29.566315
 21.490976  20.007755  20.496708  18.038517  20.007744  21.490948
 19.8551    19.488386  18.93652   18.406649  19.642561  15.750403
 19.908041  26.817524  19.512815  20.934338  15.322191  15.892365
 19.689331  20.007698  19.753132  15.614036  19.800806  18.814789
 21.494303  20.466623  16.463121  20.466623  19.956686  18.814787
 17.114477  15.670814  20.007715  21.684895  20.990593  18.814665
 18.936584  17.419569  20.007772  18.40734   23.173899  20.497068
 18.813818  20.007765  18.813116  21.490965  19.855103  18.814604
 21.245869  18.8111    20.00776   18.813608  19.448353  18.813778
 25.034138  16.45649   20.71152   18.814661  19.780315  15.739606
 18.814653  20.21441   20.00776   22.454546  18.812267  16.226238
 18.814787  20.99106   19.956707  16.555038  20.898207  19.800745
 15.7220745 18.812183  19.800781  18.81479   19.855099  30.1869
 20.007761  18.785662  20.007673  20.518093  20.469496  19.412224
 19.01385   17.698875  19.970058  15.977903  21.1232    20.518236
 20.469429  20.978273  20.469433  19.412243  20.469442  20.315609
 20.97951   18.989668  19.8551    20.9779    19.361486  19.8551
 17.371569  21.490967  20.497023  18.814674  15.631199  20.51671
 20.225227  20.466625  20.532106  16.896826  20.497091  20.950043
 22.144024  19.412222  20.978146  19.956686  20.5181    19.8551
 20.518091  19.956684  19.41253   18.989683  21.1232    20.469427
 20.469435  20.97814   18.814787  20.344372  20.518183  18.814789
 19.412197  20.466623  17.371674  20.469505  20.007761  19.956736
 19.956686  20.977896  20.344372  20.46943   18.814789  21.68548
 21.1232    20.49708   19.412228  18.814661  19.412207  20.007774
 19.414366  20.518108  19.412228  18.981905  19.855095  19.855091
 19.412222  18.814787  19.956707  19.95672   19.412243  21.152258
 20.4695    19.412224  21.449888  21.138418  21.138418  19.412241
 19.412237  19.412224  21.367205  21.138418  21.367067  20.979082
 21.1232    21.1232    20.344372  23.890842  21.367178  20.97827
 20.469427  20.978657  19.013798  19.412228  20.344372  20.469433
 22.14402   23.890852  19.412237  22.878916  20.518148  16.801281
 17.698883  19.969978  20.977907  22.144136  20.597725  19.412226
 19.970089  21.15263   19.412224  20.469683  20.977901  19.54726  ]
2025-06-02 15:59:27,345 - DEBUG - Edge reconstruction errors: [0.841266   0.81926566 1.1204382  1.0376348  0.8187543  7.726438
 1.0148786  1.0182136  1.0136387  1.1186521  0.4132236  1.0230364
 1.0157342  1.0699345  0.4124358  1.0180465  0.9174721  1.1183994
 5.301672   0.91137993 1.0282769  0.42301154 1.3734744  0.40477228
 1.0777014  1.1026361  0.41206646 1.0247221  0.946155   1.1470889
 0.41039443 0.93855613 1.1393107  1.0185356  0.92063856 1.1211977
 1.1250459  1.0252357  1.0148814  1.0324044  1.0447979  1.2452371
 1.0188602  0.917989   1.1184832  1.018706   0.9180216  1.1185611
 1.272695   1.0144267  0.914984   1.0161816  1.3134588  1.0186582
 0.92604744 1.1265748  1.0146466  0.9130824  1.125792   0.9176475
 1.038      0.973122   1.1735228  0.41154215 1.0293128  0.91641396
 1.1172565  1.6196347  1.0165204  0.4142942  1.0607646  1.051478
 1.0580633  1.10727    1.0251322  0.9198815  1.1203679  0.40862167
 1.0292885  0.91753244 1.1180933  1.1655521  1.0164516  1.0229665
 1.0146083  1.0152068  1.07628    1.023091   0.91872174 1.1192096
 1.0501422  1.0197387  1.0188948  0.92029107 1.1207769  0.41132018
 1.0462499  0.918296   1.1192476  0.91125244 1.0526243  0.9177255
 1.1182151  0.41438806 1.0292188  1.0200069  1.0199239  0.917971
 1.1184089  1.0193347  0.91759276 1.1180824  1.0201694  1.0245222
 0.91786665 1.1183562  0.40571457 0.9172673  1.1179447  0.91711324
 1.1177907  1.0372034  0.93021077 1.130875   0.9172593  1.1179367
 1.0160438  0.91771126 1.1181737  0.917399   1.1182433  0.92544997
 1.126118   1.0144222  0.92317104 1.1238412  1.0149825  0.9225754
 1.1232007  0.9181573  1.1187878  0.9211223  1.122057   0.92004484
 1.1207899  0.9201524  1.1206127  1.0148929  1.0154157  1.0151566
 1.0209705  0.9666673  1.1672868  1.0203569  1.0204065  0.9211096
 1.1217345  0.91831475 1.1189445  0.9495147  1.1501389  1.015049
 1.0155065  1.1167272  1.1222323  0.932354   1.133262   0.93767273
 1.1382942  1.0157264  0.9167222  1.1174682  0.9312687  1.1320096
 1.0180907  1.0220666  1.0795819  1.280484   0.41110718 1.015172
 9.035567   0.8187543  1.338946   1.4390085  1.1220479  1.1345546
 1.0858582  1.0211276  1.0166532  1.1186291  1.0185646  0.41430417
 1.1160237  1.0229222  0.9189225  1.119849   1.0330758  1.0172709
 1.0273631  1.018461   1.0242883  0.9213469  1.1218871  1.0210873
 1.024029   0.92108065 1.1216333  6.3527074  1.0282348  0.9194871
 1.1200154  1.0160393  0.91875964 1.1191964  1.019078   0.9191581
 1.1197196  1.0236841  0.9209531  1.1214651  1.0190688  0.92076826
 1.1212809  1.0654335  0.92522126 1.1259241  0.9179544  1.118529
 1.0192039  0.9308504  1.1313967  1.0198525  0.98466027 1.1853566
 1.1316445  1.3325127  0.41242254 1.0223242  1.0146286  1.0166231
 1.0155052  0.41286454 0.9285905  1.1294934  1.1366026  0.9559599
 1.1563588  0.4058328  0.41060594 0.9251775  1.1259605  0.4058328
 0.91806483 1.1187409  1.0153804  0.4134701  1.0238272  0.4055267
 0.41409156 1.0229583  1.0304304  0.9186057  1.1190941  1.025746
 0.92020917 1.1206952  1.0771941  1.0399061  0.92148036 1.1219637
 1.0305957  0.92397594 1.124456   1.0264719  1.0253365  0.9196978
 1.1201845  1.0205021  1.045891   0.9307918  1.1313256  0.4131694
 1.0487429  0.953503   1.1543366  1.015446   0.91755646 1.1183412
 0.9223784  1.1230482  1.0229304  0.9184446  1.118933   0.40862167
 1.0152493  1.0195082  1.0420475  0.91795945 1.1184988  0.4133466
 1.0215461  0.919839   1.1206553  0.4055267  1.0923421  0.41227296
 1.026273   1.0153282  1.0194457  1.0153933  1.0562351  1.01545
 0.41333318 1.0234187  1.1141099  1.0144788  1.0153062  1.0304455
 1.0167211  1.0153294  0.41352147 1.0194314  1.0353252  1.0465038
 1.0163049  1.016275   1.0160146  1.0157536  1.0616653  0.40625778
 1.0243384  1.0186954  0.40625778 0.92253786 1.1232734  0.40625778
 1.1618562  1.1182592  1.0375025  0.41344264 1.0189605  1.0256515
 1.0157897  1.0216373  1.0213755  1.0217142  1.0240827  1.0209211
 1.021024   1.01571    0.41405904 1.0602837  1.0286037  1.0250134
 1.0187306  0.41344267 1.0188929  1.0206318  0.41451195 1.018757
 1.0182686  1.0395533  1.0212897  1.0156757  1.0203336  1.0275443
 1.0313523  1.0151558  1.0241103  0.40625778 0.40625778 1.0449749
 1.020406   0.91163003 1.0215771  1.0205755  1.0180848  1.0159049
 1.0164495  0.91163003 0.91163003 0.911376   1.021043   1.0165167
 1.0211136  0.9188501  1.1193112  1.0158844  1.0614012  1.0512673
 0.41904834 0.93071777 1.1308221  0.91355616 0.40939194 1.1232424
 1.3204492  0.8194281  1.1209514  1.1206759  1.0375844  0.41161138
 0.42676735 1.1001385  1.024928   1.0203775  1.0214845  1.0186108
 1.0169351  1.4338385  1.0388024  1.0317307  0.520016   1.0408245
 1.2409841  0.41695166 1.0308732  1.0247651  1.0222455  1.0102532
 1.5926532  1.017585   1.0179002  0.45660907 0.41853395 1.0204892
 1.465106   0.30792367 1.1196703  0.9343729  1.1345875  1.0642059
 0.4129331  0.40963265 0.40963578 0.4141115  1.0277216  1.0338951
 1.018294   1.018773   1.0237811  1.0313755  0.41587883 0.92062277
 1.1208829  1.0188537  6.206391   0.41016278 1.0234586  1.0197582
 0.42382148 1.0269245  1.0624403  1.0195702  0.9529233  1.1530241
 1.0204518  1.1113336  0.91369855 1.0211523  1.0297996  1.2299272
 1.1823816  0.92629045 1.1264417  1.0322269  1.0175729  1.0242053
 1.0178756  1.0221344  1.0184126  1.0207754  0.96526194 1.1654109
 1.0173517  1.0217296  1.0179344  1.017457   1.020185   1.0203956
 1.017561   0.9222612  1.1223638  0.92849237 1.128594   0.9210087
 1.1211115  0.9755343  1.1756825  1.0209173  1.0197531  1.0191516
 1.0231953  0.01606865 0.8255586  1.3225588  0.9246943  1.1206467
 1.020657   1.1205744  1.4220158  0.91491634 0.91496503]
2025-06-02 15:59:27,347 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155927_update_13.json
2025-06-02 15:59:27,347 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:27,349 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155927_update_13.pth and as latest_checkpoint.pth
2025-06-02 15:59:27,350 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869485.dot): 0.4408
2025-06-02 15:59:27,350 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:59:27,350 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.6854, MLP Score: 0.0318
2025-06-02 15:59:27,350 - WARNING -   Node ID: 150.171.28.10, Recon Error: 26.0950, MLP Score: 0.0105
2025-06-02 15:59:27,350 - WARNING -   Node ID: ff02::2, Recon Error: 31.6927, MLP Score: 0.0027
2025-06-02 15:59:27,350 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 34.8113, MLP Score: 0.0024
2025-06-02 15:59:27,350 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 29.5663, MLP Score: 0.0029
2025-06-02 15:59:27,350 - WARNING - Detected 5 anomalous edges (reconstruction-based):
2025-06-02 15:59:27,350 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.7264, MLP Score: 0.3702
2025-06-02 15:59:27,350 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.3017, MLP Score: 0.1663
2025-06-02 15:59:27,350 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 9.0356, MLP Score: 0.5352
2025-06-02 15:59:27,350 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.3527, MLP Score: 0.2257
2025-06-02 15:59:27,350 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 6.2064, MLP Score: 0.8010
2025-06-02 15:59:27,350 - INFO - 
--- Processing file: nw_graph_encoded_1748869515.dot (Timestamp: 2025-06-02 15:05:15) ---
2025-06-02 15:59:27,350 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:59:27,350 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:59:27,360 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:59:27,368 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:59:27,368 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:59:27,369 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869515.dot
2025-06-02 15:59:27,377 - INFO - Parsed 366 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:59:27,386 - INFO - Parsed 657 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869515.dot'.
2025-06-02 15:59:27,386 - INFO - Processing node updates/additions.
2025-06-02 15:59:27,388 - INFO - Processing edge updates/additions.
2025-06-02 15:59:27,392 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:27,392 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:27,392 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:27,392 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:27,396 - DEBUG - Initial node features tensor shape: torch.Size([366, 30])
2025-06-02 15:59:27,397 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:27,398 - DEBUG - Node features tensor shape after scaling: torch.Size([366, 30])
2025-06-02 15:59:27,398 - DEBUG - Edge index tensor shape: torch.Size([2, 657])
2025-06-02 15:59:27,399 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:27,400 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 12
2025-06-02 15:59:27,401 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:27,401 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:27,402 - DEBUG - Shape of encoded categorical edge features: torch.Size([657, 3])
2025-06-02 15:59:27,402 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:27,402 - DEBUG - Shape of scaled numerical edge features: torch.Size([657, 7])
2025-06-02 15:59:27,403 - DEBUG - Final edge attributes tensor shape: torch.Size([657, 10])
2025-06-02 15:59:27,403 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:27,403 - INFO - Performing online update...
2025-06-02 15:59:27,404 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:27,404 - DEBUG - Updated RunningStats: new_mean=0.935834391445297, new_var=7200000000163.704, new_n=750
2025-06-02 15:59:27,404 - DEBUG - Updated RunningStats: new_mean=0.9281153465791945, new_var=7500000000017.779, new_n=780
2025-06-02 15:59:27,404 - DEBUG - Updated RunningStats: new_mean=0.9528028395010771, new_var=2400000000039.6445, new_n=250
2025-06-02 15:59:27,404 - DEBUG - Updated RunningStats: new_mean=0.9575293021547624, new_var=2500000000001.4126, new_n=260
2025-06-02 15:59:27,404 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:27,404 - DEBUG - Online update step: 1/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 2/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 3/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 4/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 5/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 6/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 7/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 8/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 9/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 10/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 11/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 12/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 13/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 14/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 15/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 16/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 17/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 18/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,405 - DEBUG - Online update step: 19/50
2025-06-02 15:59:27,405 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 20/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 21/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 22/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 23/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 24/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 25/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 26/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 27/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 28/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 29/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 30/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 31/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 32/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 33/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 34/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 35/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 36/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 37/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 38/50
2025-06-02 15:59:27,406 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,406 - DEBUG - Online update step: 39/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 40/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 41/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 42/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 43/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 44/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 45/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 46/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 47/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 48/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 49/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - DEBUG - Online update step: 50/50
2025-06-02 15:59:27,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,407 - WARNING - No successful steps during online update.
2025-06-02 15:59:27,408 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], current edge mean: [ 5.2602739e+00  1.3805175e+00  4.7656012e+00  4.3546771e-09
  4.3546771e-09  5.4433467e-09 -7.2577955e-10 -8.7093541e-09
 -1.4515591e-09  2.1773385e-09]
2025-06-02 15:59:27,408 - DEBUG - Node drift difference: 0.0954, Edge drift difference: 0.7187
2025-06-02 15:59:27,408 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:27,408 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.7588256e-08  5.6021850e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.4753842e-08
 -3.9085013e-08 -2.6056675e-09  2.6056675e-08 -5.3090474e-08
  2.5655737e+00  2.9508197e+00  1.4480874e-01  4.3879781e+00
  2.6056675e-09  3.0710382e+00  6.0846996e+00  7.5983605e+00
  1.4480874e-01  8.0000000e+00  5.2113349e-09 -1.0422670e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.5176512e-08  1.6936839e-08], edge=[ 5.2602739e+00  1.3805175e+00  4.7656012e+00  4.3546771e-09
  4.3546771e-09  5.4433467e-09 -7.2577955e-10 -8.7093541e-09
 -1.4515591e-09  2.1773385e-09]
2025-06-02 15:59:27,409 - DEBUG - Updated reference std: node=[0.         0.         1.0013689  1.0013689  0.         0.
 0.         1.0013689  1.001369   1.0013689  1.001369   1.0013689
 1.1053125  0.31016898 0.38222542 0.589653   1.0013689  2.9452322
 2.8023348  1.5205975  0.38222542 0.         1.001369   1.001369
 0.         0.         0.         0.         1.0013689  1.0013689 ], edge=[1.2472489  0.49827543 2.0060513  1.0007619  1.0007619  1.0007619
 1.0007619  1.0007619  1.0007619  1.0007619 ]
2025-06-02 15:59:27,409 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:27,409 - INFO - Running anomaly detection...
2025-06-02 15:59:27,409 - INFO - Starting anomaly detection.
2025-06-02 15:59:27,413 - DEBUG - Node reconstruction errors: [22.045872  21.4409    21.344332  20.073282  14.560876  18.938972
 21.344332  17.679142  17.67919   19.130083  17.678944  17.447779
 27.814383  17.550753  19.151592  18.219404  18.514563  18.190863
 20.561754  18.258636  17.939964  19.151548  20.448864  17.157177
 19.030739  19.156837  19.064798  16.159464  17.752434  19.06476
 16.29745   19.226208  16.103834  20.131193  19.156897  22.094524
 18.11427   18.260567  17.580864  17.537281  21.768959  19.324806
 18.26057   22.029123  20.171446  19.906023  23.699614  18.380367
 17.933784  32.520176  35.016045  19.851782  19.325504  22.967663
 17.950193  16.542046  25.206598  18.70953   20.49312   20.49312
 16.230663  22.670336  19.58671   16.913054  19.069328  17.950226
 18.329065  17.925783  19.58905   19.588985  18.033123  19.39889
 19.568668  19.34015   20.090319  19.185741  22.656456  19.98434
 19.764822  19.554596  20.953209  20.032204  18.493887  20.745113
 18.697548  16.737728  20.090067  19.55443   19.764812  20.53451
 19.502123  15.965746  20.448605  19.822826  19.379368  29.777073
 21.444283  20.046263  20.626043  18.114712  20.046247  21.444338
 22.77112   19.597717  16.819168  18.451107  19.827473  15.942774
 19.944149  26.454376  19.412226  21.191862  15.461194  16.006052
 19.785011  20.046139  19.81999   15.6565485 19.804655  18.851202
 20.171467  20.4486    16.512627  17.463999  20.011162  18.851213
 17.24442   15.792916  20.046225  21.60275   21.342077  18.851004
 18.941076  17.491228  20.046278  18.452742  23.50096   20.469421
 18.849579  20.046268  18.848417  21.301847  19.860304  18.850918
 21.22941   20.045774  20.046265  18.84923   19.79533   19.804527
 25.010557  16.8189    20.449402  18.851     19.789684  15.804693
 18.850988  20.260345  20.046267  22.38653   18.836647  16.39606
 18.851208  21.340261  20.019728  16.617239  20.691263  19.804586
 15.84348   20.04596   19.804602  18.993477  19.86031   29.08731
 20.046247  18.81207   20.046186  20.531624  20.6124    20.612402
 18.985968  17.769884  20.039421  16.326908  21.05249   20.531557
 20.399706  20.637451  20.39969   19.379578  19.577051  20.590767
 20.898712  18.992676  19.860294  20.899982  19.380945  19.860315
 15.917536  21.444296  20.469381  18.85102   15.748508  19.804487
 20.26924   20.448605  20.882027  16.94933   20.841257  20.748974
 21.559723  20.612402  20.899784  20.046265  20.531614  19.860312
 20.531622  20.019749  20.927713  18.992931  16.498024  20.399714
 20.399696  20.899788  18.851213  20.303734  20.531586  18.851213
 20.37097   20.4486    17.46399   20.612398  20.046268  20.019701
 20.019749  20.899984  20.303743  20.399712  18.851215  21.601393
 16.357317  20.99543   19.37936   20.326971  19.379086  20.046284
 20.61211   20.531614  19.379356  19.163233  19.860243  19.86024
 20.927814  19.804655  20.019726  20.019718  19.379578  21.054857
 20.399445  19.37933   21.289213  21.070372  21.070372  19.379574
 19.379507  19.764612  21.289915  21.070372  21.289852  20.899183
 21.05249   21.05249   20.630116  23.96656   21.28998   20.8997
 20.399715  20.899397  18.985619  19.379364  20.303745  20.399683
 22.035149  23.735909  19.37949   22.749811  16.176792  16.917313
 17.769894  19.936052  19.764593  22.035006  20.744244  19.379341
 19.936184  21.055164  19.37932   20.397877  20.899977  19.506306
 21.585407  21.753948  21.75483   21.754824  21.75453   21.754766
 21.754717  21.754824  21.754766  21.753254  21.754587  21.754599
 21.754587  21.585594  20.833746  20.19716   20.76334   21.733086
 21.585567  21.106688  21.052053  21.055279  20.303707  21.754824
 20.3997    16.07778   21.27737   21.75479   20.984158  21.289783
 22.164461  21.585588  21.72592   21.28994   21.754515  21.754736
 20.01228   20.39969   21.278929  21.27853   21.537214  19.936243
 21.278952  21.28994   21.75462   21.289865  21.754522  22.972664
 20.883263  22.03451   21.748579  19.577335  21.052488  21.133175
 19.9191    20.899782  21.753912  21.75484   21.055294  21.055119
 20.531612  21.75437   21.27899   21.754814  21.754814  37.14501  ]
2025-06-02 15:59:27,415 - DEBUG - Edge reconstruction errors: [ 0.9456156   0.92496365  1.2259012   1.1416687   0.82438165  7.3176136
  1.1215695   1.124362    1.1206534   1.2245994   0.5217977   1.1254686
  1.1352105   1.1223752   1.1654295   0.52034587  1.1289495   1.0242126
  1.2247218   5.078049    1.0194892   1.1322284   0.5303985   1.4432769
  0.5143943   1.178209    1.2269537   0.5200947   1.1304002   1.047103
  1.2476143   0.51873744  1.0401227   1.2405487   1.1249044   1.0269326
  1.227235    1.2426555   1.1310662   1.1215696   1.1357462   1.125822
  1.3260885   1.1251888   1.0245316   1.2248145   1.1250497   1.0246414
  1.2249372   1.8197818   1.1266286   1.0276288   1.2250727   1.1224556
  1.3912374   1.1250185   1.0313809   1.231674    1.1213136   1.020505
  1.237508    1.0241052   1.1397473   1.0665512   1.2667737   0.519621
  1.1329937   1.0232128   1.2236629   1.7255834   1.1229944   0.5221036
  1.1632745   1.1578455   1.0257654   1.226061    1.1606789   1.2079039
  1.026426    1.2267061   1.1308566   1.0262624   1.2265424   0.41499504
  1.1338203   1.0242338   1.2245322   1.2572731   1.028274    1.2285539
  1.1227055   1.1283426   1.1213051   1.1247025   1.0279301   1.2283429
  1.1768187   1.1290361   1.0252258   1.225506    1.1536344   1.1259403
  1.1252085   1.0266181   1.2268982   0.5192909   1.1503323   1.0250857
  1.225623    1.0192528   1.1555234   1.0242977   1.224578    0.52209735
  1.1346579   1.1261187   1.1260407   1.024515    1.2247672   1.1256473
  1.0241843   1.2244648   1.129418    1.0245874   1.224865    1.1302266
  1.0243849   1.2246653   0.5151374   1.0240282   1.2243823   1.0238811
  1.2242352   1.1419027   1.0354358   1.2357814   1.0242274   1.2245078
  1.1226057   1.0242667   1.2245353   1.0240452   1.2245016   1.0310984
  1.2314469   1.1211593   1.0292057   1.2295554   1.1216115   1.0286497
  1.2289729   1.0247754   1.2250992   1.0276799   1.2281992   1.026163
  1.2265489   1.0266638   1.2269113   1.1214678   1.1219528   1.1217134
  1.1297427   1.0243566   1.2246226   1.0623465   1.2626686   1.1263149
  1.126363    1.0275832   1.2279062   1.0249814   1.225305    1.0489188
  1.2492416   1.1215873   1.1219814   1.223553    1.2285883   1.0359704
  1.2364694   1.0555081   1.2560383   0.3203749   1.1220887   1.0235864
  1.2239729   1.0356768   1.2358587   1.1218169   1.0247083   1.224932
  1.0289676   1.2292475   1.226278    1.1244053   1.12794     1.2897017
  1.4901254   0.5194222   1.1218357  10.779228    0.82438165  1.4430052
  1.5430514   1.2275637   1.2389126   1.2169166   1.1265932   1.1228254
  1.2245772   1.1246924   0.5220323   1.2084255   1.1289332   1.0255444
  1.2260531   1.1363521   1.1235925   1.131135    1.1247239   1.1299931
  1.0379487   1.2382556   1.1269263   1.1298126   1.0274093   1.2277083
  7.612506    1.1331059   1.0259312   1.2262238   1.1225067   1.0252401
  1.2254922   1.1254289   1.0319852   1.2322857   1.1297159   1.0350142
  1.2353286   1.1253623   1.0347748   1.235075    1.1672935   1.0311671
  1.2315371   1.0247245   1.2250358   1.1254877   1.0471071   1.2474196
  1.1259838   1.0767019   1.2770704   1.2024059   1.4027948   0.52031076
  1.1285764   1.1211065   1.1226227   1.1219922   0.52070236  1.0340466
  1.2345403   1.2195117   1.0873364   1.2875574   0.515251    0.5188515
  1.0313861   1.2318019   0.5214836   1.1249534   1.0328395   1.233238
  1.1218796   0.5213542   1.1296573   0.51495844  0.5218528   1.1289514
  1.135676    1.025082    1.2253622   1.1313579   1.0265454   1.2268254
  1.177717    1.1443192   1.0277971   1.2280768   1.136036    1.0304767
  1.2306607   1.1334656   1.130799    1.0260973   1.2263774   1.1264186
  1.1462708   1.0347773   1.2350724   0.5209611   1.1522325   1.0527357
  1.2531824   1.1219351   1.0243708   1.2247792   1.0286095   1.2289591
  1.1358691   1.024959    1.2252393   0.41499504  1.1255412   1.1256157
  1.1457305   1.0305712   1.230866    0.52137965  1.1276934   1.0266154
  1.2270386   0.51495844  1.1858686   1.0414194   1.241714    0.5202378
  1.1316206   1.1218592   1.1256216   1.1218778   1.1566286   1.1251236
  1.0256331   1.2259285   0.52032983  1.1289997   1.0958221   1.2962991
  1.2211804   1.121209    1.1218381   1.1355109   1.1230212   1.1218601
  0.52137     1.125848    1.1399485   1.1500485   1.1225766   1.122548
  1.1357311   1.1221281   1.1663643   1.0269022   1.2271532   0.5208403
  1.0261931   1.2266418   1.1322145   1.0315878   1.2318531   1.1254253
  0.515485    1.0289186   1.2292992   0.51980466  1.0315058   1.2320273
  1.242809    1.0260934   1.2263595   1.2262478   1.1421975   0.521273
  1.1253668   1.131277    1.122214    1.1303055   1.0260199   1.226271
  1.1300608   1.0250757   1.2253417   1.1308737   1.0256928   1.225959
  1.1318201   1.0259564   1.22618     1.126778    1.126876    1.124967
  1.0334908   1.2338177   0.52034163  1.1607032   1.024608    1.2251364
  1.1365507   1.0246644   1.224951    1.1381054   1.1251472   1.0364856
  1.2367321   0.5212731   1.1253027   1.1265777   0.522279    1.1250999
  1.1241307   1.162415    1.1271251   1.1222014   1.1262344   1.1328113
  1.1358584   1.1216661   1.1293173   0.515485    0.515485    1.1450797
  1.1262465   1.0193588   1.1276109   1.1340674   1.1239564   1.1222361
  1.1226712   1.0193588   1.0193588   1.0192646   1.126906    1.1237065
  1.1271976   1.0252922   1.2255605   1.1222156   1.1294451   1.2211765
  0.52180713  1.1495777   1.9992379   1.1270943   1.1220313   1.1276894
  1.044499    1.24487     1.0298203   1.2301434   0.515664    1.126359
  1.1432071   1.16528     1.1238489   0.5162333   1.1267503   1.1228445
  1.1311922   1.1263028   1.0266752   1.2269853   1.1229663   1.4113606
  1.2119843   0.5248161   1.0354149   1.2355068   1.126125    1.0200996
  0.51727843  1.2286003   1.4258124   0.8248304   1.2263451   1.2259945
  1.141351    0.523893    1.126533    0.5325939   1.1968119   1.1297907
  1.1258266   1.1262039   1.1243052   1.1225718   1.5200858   1.1431133
  1.1360239   0.62655723  1.1370783   1.3371387   0.5238015   1.1353465
  1.3000829   1.1275487   1.096872    1.5839312   1.123197    1.135574
  0.5597386   0.52490044  1.1289462   1.4844862   0.31488433  1.2246739
  1.0383021   1.2385736   1.3056997   0.52006954  0.5175462   0.5175485
  0.5242903   1.1461776   1.1411861   1.149152    1.1237663   1.1241895
  1.1291039   1.1550466   0.52347916  1.0346415   1.2346984   1.1287783
  1.1242665   5.087192    0.5180055   1.1395093   1.1252464   0.52986157
  1.131911    1.1614354   1.124797    1.115145    1.3152035   1.1260892
  1.1953132   1.0202985   1.1316961   1.1117109   1.3117907   1.2493532
  1.0311412   1.2312213   1.1355784   1.1232939   1.1453063   1.3303931
  1.1506532   1.1741652   1.1356202   1.0673381   1.2674165   1.1329519
  1.1474276   1.1236846   1.1311996   1.0301663   1.2302457   1.1257074
  1.1398417   1.1274139   1.0277737   1.2278525   1.1273392   1.0329311
  1.2330096   1.1358039   1.0267531   1.2268318   1.133578    1.0692511
  1.2693284   1.1803796   1.1253406   1.1248732   1.1284924   1.0428507
  1.2429305   1.1306002   1.0294573   1.2295357   1.1460823   1.0277053
  1.2277838   1.13155     1.0282289   1.2283074   1.1302189   1.0296216
  1.2297003   1.1305451   1.1438631   1.0312228   1.2313011   1.1374779
  1.1236075   1.1744124   1.1234006   1.1256796   1.1282296   1.1314975
  1.1276599   1.1283681   1.1348803   1.128265    1.0265287   1.2266027
  0.521237    1.127007    1.1305778   1.126101    1.1271256   1.1257074
  1.333182    1.133131    1.1259966   1.1275942   1.1462356   1.1378262
  1.1237234   1.1243548   1.1238812   1.126543    1.2192672   1.1237061
  1.1249899   1.1260096   1.1246686   1.1255647   1.1233996   6.0237484
  1.1250159   1.1336116   1.1243572   1.1266233   1.1237271   1.1239213
  1.1236538   1.1240417   1.1358331   0.02180331  0.8305533   1.4277555
  0.9297297   1.2260778   1.1261607   1.225907    1.5272413   1.0201716
  1.0215029   0.02185189  0.02159914]
2025-06-02 15:59:27,417 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155927_update_14.json
2025-06-02 15:59:27,417 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:27,420 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155927_update_14.pth and as latest_checkpoint.pth
2025-06-02 15:59:27,420 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869515.dot): 0.4800
2025-06-02 15:59:27,420 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:59:27,420 - WARNING -   Node ID: 192.168.27.10, Recon Error: 27.8144, MLP Score: 0.0433
2025-06-02 15:59:27,420 - WARNING -   Node ID: ff02::2, Recon Error: 32.5202, MLP Score: 0.0023
2025-06-02 15:59:27,420 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 35.0160, MLP Score: 0.0023
2025-06-02 15:59:27,420 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 29.7771, MLP Score: 0.0028
2025-06-02 15:59:27,420 - WARNING -   Node ID: ff02::fb, Recon Error: 26.4544, MLP Score: 0.0030
2025-06-02 15:59:27,420 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:59:27,420 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 7.3176, MLP Score: 0.2142
2025-06-02 15:59:27,420 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 5.0780, MLP Score: 0.0969
2025-06-02 15:59:27,420 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 10.7792, MLP Score: 0.5138
2025-06-02 15:59:27,420 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 7.6125, MLP Score: 0.2190
2025-06-02 15:59:27,420 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 5.0872, MLP Score: 0.4581
2025-06-02 15:59:27,420 - INFO - 
--- Processing file: nw_graph_encoded_1748869545.dot (Timestamp: 2025-06-02 15:05:45) ---
2025-06-02 15:59:27,420 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:59:27,421 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:59:27,430 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:59:27,442 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:59:27,442 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:59:27,442 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869545.dot
2025-06-02 15:59:27,451 - INFO - Parsed 392 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:59:27,459 - INFO - Parsed 753 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869545.dot'.
2025-06-02 15:59:27,459 - INFO - Processing node updates/additions.
2025-06-02 15:59:27,461 - INFO - Processing edge updates/additions.
2025-06-02 15:59:27,465 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:27,465 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:27,465 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:27,466 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:27,469 - DEBUG - Initial node features tensor shape: torch.Size([392, 30])
2025-06-02 15:59:27,470 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:27,471 - DEBUG - Node features tensor shape after scaling: torch.Size([392, 30])
2025-06-02 15:59:27,471 - DEBUG - Edge index tensor shape: torch.Size([2, 753])
2025-06-02 15:59:27,472 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:27,473 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 13
2025-06-02 15:59:27,474 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:27,475 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:27,475 - DEBUG - Shape of encoded categorical edge features: torch.Size([753, 3])
2025-06-02 15:59:27,476 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:27,476 - DEBUG - Shape of scaled numerical edge features: torch.Size([753, 7])
2025-06-02 15:59:27,476 - DEBUG - Final edge attributes tensor shape: torch.Size([753, 10])
2025-06-02 15:59:27,476 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:27,477 - INFO - Performing online update...
2025-06-02 15:59:27,477 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:27,478 - DEBUG - Updated RunningStats: new_mean=0.9366923291696736, new_var=7800000000161.547, new_n=810
2025-06-02 15:59:27,478 - DEBUG - Updated RunningStats: new_mean=0.9296538844306128, new_var=8100000000018.608, new_n=840
2025-06-02 15:59:27,478 - DEBUG - Updated RunningStats: new_mean=0.9646012830360566, new_var=2600000000040.038, new_n=270
2025-06-02 15:59:27,478 - DEBUG - Updated RunningStats: new_mean=0.9682632617504949, new_var=2700000000001.2305, new_n=280
2025-06-02 15:59:27,478 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:27,478 - DEBUG - Online update step: 1/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 2/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 3/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 4/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 5/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 6/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 7/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 8/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,478 - DEBUG - Online update step: 9/50
2025-06-02 15:59:27,478 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 10/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 11/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 12/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 13/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 14/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 15/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 16/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 17/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 18/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 19/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 20/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 21/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 22/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 23/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 24/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 25/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 26/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 27/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 28/50
2025-06-02 15:59:27,479 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,479 - DEBUG - Online update step: 29/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 30/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 31/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 32/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 33/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 34/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 35/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 36/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 37/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 38/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 39/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 40/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 41/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 42/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 43/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 44/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 45/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 46/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 47/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 48/50
2025-06-02 15:59:27,480 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,480 - DEBUG - Online update step: 49/50
2025-06-02 15:59:27,481 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,481 - DEBUG - Online update step: 50/50
2025-06-02 15:59:27,481 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,481 - WARNING - No successful steps during online update.
2025-06-02 15:59:27,481 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], current edge mean: [ 5.2563081e+00  1.4037185e+00  4.8247013e+00 -1.2664998e-09
  6.3324990e-10 -3.7994994e-09  0.0000000e+00 -5.0659992e-09
  1.2664998e-09  8.2322487e-09]
2025-06-02 15:59:27,481 - DEBUG - Node drift difference: 0.0876, Edge drift difference: 0.0466
2025-06-02 15:59:27,482 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1626954e-08  4.8656852e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1626954e-08
 -3.8925482e-08  2.0679163e-08  4.8656852e-09 -2.7369479e-08
  2.4974489e+00  2.9540815e+00  1.3775510e-01  4.3596940e+00
  1.2164213e-09  3.2857144e+00  5.8392859e+00  7.5790815e+00
  1.3775510e-01  8.0000000e+00 -7.2985280e-09 -3.1626954e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.1556002e-08 -5.3218434e-09], edge=[ 5.2563081e+00  1.4037185e+00  4.8247013e+00 -1.2664998e-09
  6.3324990e-10 -3.7994994e-09  0.0000000e+00 -5.0659992e-09
  1.2664998e-09  8.2322487e-09]
2025-06-02 15:59:27,482 - DEBUG - Updated reference std: node=[0.         0.         1.0012779  1.0012779  0.         0.
 0.         1.001278   1.0012779  1.0012779  1.0012779  1.0012779
 1.0559748  0.29992953 0.37355423 0.58165294 1.0012779  3.045268
 2.8914173  1.55179    0.37355423 0.         1.0012779  1.0012779
 0.         0.         0.         0.         1.0012779  1.0012779 ], edge=[1.2309898  0.50168544 1.9340388  1.0006647  1.0006647  1.0006646
 1.0006647  1.0006647  1.0006647  1.0006647 ]
2025-06-02 15:59:27,482 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:27,482 - INFO - Running anomaly detection...
2025-06-02 15:59:27,483 - INFO - Starting anomaly detection.
2025-06-02 15:59:27,490 - DEBUG - Node reconstruction errors: [22.271984 22.171043 22.046774 20.271595 15.210046 19.085676 22.046774
 17.861982 17.862047 19.32229  17.861826 17.778324 28.95972  17.714342
 19.347792 18.430132 18.806288 18.398653 20.995401 18.452717 18.08625
 19.347757 18.234123 17.431126 19.229225 19.33437  19.254747 16.634417
 17.941406 19.254713 16.582571 19.412182 16.373827 20.329222 19.334436
 22.26031  20.05332  18.45441  16.627531 17.700304 21.968952 19.514336
 18.45441  22.189827 20.381975 20.040287 23.931599 18.669191 18.11831
 32.742817 35.441944 20.029266 19.494144 23.339394 18.066484 16.700811
 25.7747   18.894787 20.861738 20.861738 16.405296 22.804558 19.775866
 17.734646 19.24992  18.226555 18.622755 18.040047 19.777803 19.777771
 18.172707 19.5729   19.728107 19.471888 20.284964 19.365847 22.811558
 20.139027 19.960178 19.679865 21.11515  20.263252 16.744402 20.874084
 18.748474 16.914879 20.246197 19.94491  19.892752 20.90421  19.658762
 16.068676 20.59384  19.951647 19.468    30.214426 21.591526 20.192108
 20.772228 18.237514 20.192102 21.591581 22.890137 19.774788 16.984007
 18.566853 19.963036 16.130817 17.66521  26.6737   19.573313 21.335041
 15.868333 16.146965 20.21483  20.192013 19.977573 16.233736 19.924446
 18.974516 20.286537 20.593838 16.644    17.654823 20.12609  18.974522
 17.44766  15.950257 20.19208  21.73766  21.44692  18.974344 19.08946
 17.6316   20.192122 18.568258 23.615192 20.626936 19.274914 20.192114
 18.972172 21.452436 20.011023 19.276396 19.276659 20.19175  20.458853
 18.972858 19.895945 19.924307 25.177675 16.983541 20.64229  18.97434
 19.916542 16.180847 18.97433  20.697746 20.192114 22.53084  18.962484
 16.578548 18.97452  21.444874 20.45887  16.752707 20.915699 20.188477
 16.002281 20.191887 19.924366 19.103281 20.01102  29.458199 20.188526
 18.917608 20.188398 20.672575 20.737047 20.737047 19.080654 17.9501
 20.149141 16.462648 17.233513 20.737013 20.530548 20.765676 20.530529
 19.481379 20.478163 20.71136  21.00275  19.102669 20.324175 21.00377
 19.535408 20.011026 16.01751  21.59155  20.626913 18.974361 16.421253
 20.188272 20.41814  20.59384  20.989786 17.082487 20.975548 20.931181
 21.692802 20.737047 21.003613 20.213179 20.737057 20.011026 20.672575
 20.179861 21.06914  19.102865 16.725702 20.71299  20.530535 21.003618
 18.97452  20.41207  20.737034 18.97452  20.4687   20.593838 17.65482
 20.737041 20.192112 20.458862 20.179857 21.003767 20.412083 20.530552
 18.974524 21.73626  16.329298 20.931133 19.48119  20.458862 19.48096
 20.192125 20.736769 20.672558 19.481188 19.244932 20.010965 20.01095
 21.069221 19.924444 20.179829 20.179815 19.481373 21.191078 20.530256
 20.737047 21.214643 21.194908 21.194908 19.481373 20.468737 19.842903
 21.472906 21.194908 21.472874 20.737005 17.580694 17.233456 20.748577
 24.072792 21.487917 20.737041 20.530558 21.454802 19.080359 20.73705
 20.685965 20.664877 20.468649 23.857492 19.4813   22.874067 16.31439
 17.078735 17.950104 17.65247  19.842962 22.163292 20.829754 19.481178
 20.061382 21.191359 20.737047 20.735968 21.003767 19.630201 20.08741
 21.861912 21.865377 21.865374 21.864183 21.865322 21.865267 21.865377
 21.864872 21.863714 21.86516  21.806293 21.865133 21.652945 18.779306
 20.265537 20.868122 21.833965 21.652922 21.192133 21.187948 21.191465
 20.671822 21.865377 20.53054  16.227253 21.39758  21.80627  21.214577
 21.214556 22.150705 21.65294  21.84063  21.48789  21.865068 21.806313
 20.087805 20.530529 21.398994 21.398525 21.59076  20.061428 21.398998
 21.214577 21.86516  21.48784  21.865095 23.08354  21.056227 22.16259
 21.847961 19.659325 21.17516  21.24967  20.04391  21.003607 21.863213
 21.865395 21.19148  21.191309 20.672544 21.864876 21.399042 21.865355
 21.865356 37.53365  21.147276 21.24963  20.087965 21.147005 20.092873
 20.087301 20.087986 20.087461 20.093405 21.865374 21.205942 22.35563
 20.992956 21.865309 20.782213 20.08798  20.087976 22.80548  20.087986
 21.249548 19.695528 17.567501 21.93563  21.8628   22.592232 21.249672]
2025-06-02 15:59:27,493 - DEBUG - Edge reconstruction errors: [ 0.9440401   0.9251495   1.2259257   1.1461567   0.8245283  10.390994
  1.1246945   1.1243246   1.1209134   1.2247875   0.5224154   1.125449
  1.1335629   1.1310263   1.1624964   0.5210165   1.1283308   1.024343
  1.2247363   7.1336174   1.0248033   1.2292862   1.1315782   0.5292869
  1.3939303   0.5218341   1.1253824   1.1693562   1.2149395   0.5208038
  1.1368259   1.0457246   1.2461331   0.52155167  1.0409579   1.2412728
  1.1286579   1.1285492   1.0267801   1.2270122   1.2288191   1.1296026
  1.1218997   1.135298    1.119116    1.3193374   1.1252421   1.0246891
  1.2249198   1.1251174   1.024737    1.2249775   1.8043374   1.1259639
  1.0272257   1.2306311   1.1224517   1.3481724   1.1292262   1.0309062
  1.2311114   1.1215004   1.0211704   1.2582455   1.0243901   1.1394031
  1.0654659   1.2656596   0.52033615  1.132846    1.0235006   1.2238829
  1.725492    1.1230997   0.5226248   1.157051    1.152487    1.0256147
  1.2258551   1.1544423   1.1947027   1.0262773   1.2265054   1.1300104
  1.0310322   1.231257    0.41545543  1.1330367   1.0243716   1.2246168
  1.238477    1.0277443   1.2279721   1.1292486   1.1352603   1.121475
  1.124753    1.0272402   1.2275811   1.16822     1.1284587   1.0252515
  1.2254795   1.1601219   1.1254051   1.1252694   1.0264362   1.226664
  0.520024    1.1459329   1.0248706   1.2253324   1.0198878   1.1616391
  1.0244673   1.2247055   0.52266264  1.1331282   1.1255484   1.1254847
  1.0247345   1.2249281   1.125487    1.1256092   1.024393    1.224621
  1.1287817   1.0247447   1.2249702   1.1295305   1.0245941   1.2248223
  0.5160639   1.0242206   1.2245195   1.0241023   1.2244014   1.1388136
  1.0342278   1.2344525   1.1254172   1.0245472   1.2247512   1.1225648
  1.0244696   1.2246889   1.0242617   1.2246016   1.0303802   1.2306783
  1.1213365   1.0286747   1.2289732   1.1258054   1.0282099   1.2284847
  1.0248764   1.2251515   1.0276014   1.2279266   0.52166283  1.02631
  1.2266219   1.0264566   1.2266525   1.1255155   1.1248488   1.1220657
  1.1218688   1.1290643   1.0245589   1.224778    1.0610527   1.2612698
  1.1296178   1.1257563   1.1257936   1.02733     1.2275488   1.1257278
  1.0250039   1.2252789   1.0483114   1.2485292   1.1254307   1.1217831
  1.1221279   1.2234877   1.2308639   1.124977    1.0353826   1.2357551
  1.0532634   1.2537051   0.3210073   1.154543    1.0240192   1.2242509
  1.0241175   1.2243395   1.0353664   1.2355249   1.1219538   1.0248524
  1.2250472   1.0281255   1.2283527   1.2258404   1.8310337   1.22692
  1.0241216   1.1230965   1.1226251   1.1329503   1.1229401   1.133653
  1.2119408   1.1355608   1.1228107   1.1324444   1.1314703   1.1277773
  1.1230167   1.126718    1.1226413   1.1226826   1.1231267   1.1227312
  1.1782188   1.1220001   1.1240515   1.124633    1.127712    1.5393354
  1.7396219   0.52025867  1.1220645  10.102054    0.8245283   1.440017
  1.5400585   1.2272538   1.2366613   1.2024143   1.1264819   1.1230745
  1.2247698   1.1245036   0.52260876  1.1983787   1.1283178   1.0254459
  1.2258383   1.1354665   1.1247644   1.1310372   1.1246057   1.1293398
  1.0358245   1.2360784   1.1263825   1.1291624   1.0270729   1.2273186
  6.590298    1.1322851   1.0258483   1.2260877   1.1225893   1.0253339
  1.2255274   1.1254708   1.0309256   1.2311718   1.1289145   1.0337963
  1.2340173   1.1254643   1.0989931   1.2992307   1.1605793   1.030264
  1.230572    1.0247049   1.2249655   1.1254905   1.043975    1.2442362
  1.1259693   1.0742674   1.2745776   1.7807723   1.9810331   0.5209896
  1.1278473   1.1213735   1.1228489   1.1221249   0.5213138   1.0327182
  1.2330872   1.2129667   1.0845947   1.284787    0.51615405  0.5196389
  1.0301187   1.2304996   0.5220978   1.1249913   1.0316811   1.2320005
  1.1220301   0.5219951   1.1290184   0.5159205   0.52245605  1.1283677
  1.1340284   1.025158    1.225386    1.1304632   1.0263747   1.2266027
  1.1689723   1.1412297   1.0273516   1.2275794   1.1349344   1.0301498
  1.2302929   1.1319829   1.1301267   1.0259899   1.2262177   1.1259041
  1.145299    1.0342373   1.2344772   0.52156657  1.1478318   1.0683391
  1.2686663   1.1220794   1.0245004   1.2248228   1.0283148   1.2285398
  1.1254386   1.1341121   1.0341733   1.2344102   0.41545543  1.1250792
  1.1250901   1.1427785   1.0388759   1.2391123   0.5216917   1.1271652
  1.0261091   1.2264801   0.5159205   1.1819007   1.0867368   1.2869711
  0.52166283  1.1311411   1.1457281   1.3460448   1.121994    1.1251235
  1.1219631   1.1526543   1.1251835   1.0255735   1.2258139   0.5210257
  1.1284294   1.091932    1.2922887   1.2215145   1.1213794   1.1219773
  1.1334347   1.1230533   1.1219949   0.5220077   1.1256988   1.1371388
  1.1455632   1.1226271   1.1226044   1.136472    1.0273882   1.2276016
  1.1222608   1.1598921   1.0266912   1.2269026   0.52171487  1.0262395
  1.2265325   1.1320479   1.0306876   1.2309061   1.1254147   0.5197923
  1.0331345   1.2335092   1.0282624   1.2285736   0.52113074  1.0305742
  1.2309322   1.2341272   1.0260924   1.2263114   1.2258165   1.1394213
  0.5219299   1.1253222   1.1297963   1.1223376   1.1295866   1.0259141
  1.2261255   1.1293651   1.0251548   1.2253739   1.1301782   1.0256236
  1.2258426   1.1310148   1.0258793   1.226074    1.1261345   1.1262131
  1.125015    1.0322547   1.232539    0.5210443   1.1559724   1.0247033
  1.2250937   1.1348177   1.0247583   1.2249898   1.1459455   1.1252404
  1.0354905   1.2356858   0.5219299   1.1252704   1.1259661   0.5227642
  1.1251485   1.1241331   1.1607757   1.4523616   1.6525562   1.1293083
  1.0254608   1.2256799   1.1231945   1.1285795   1.0269963   1.227215
  1.1312524   1.136271    1.0245215   1.2248333   1.1218629   1.1309569
  1.0264913   1.2267103   0.51979214  1.0393276   1.239703    0.519438
  1.0233575   1.2237529   1.1463816   1.0364994   1.2367177   1.1256975
  1.0199717   1.1297623   1.02687     1.2270947   1.1325259   1.1268295
  1.0247281   1.2249595   1.1223718   1.1227324   1.0199717   1.0199717
  1.0199292   1.1291206   1.0257497   1.2259687   1.1278585   1.1264024
  1.0253325   1.2255516   1.1223562   1.1287433   1.0274023   1.2276058
  1.2215562   0.5224204   1.1474442   1.983068    1.1265055   1.1221447
  1.1271423   1.0593206   1.2596269   1.0294544   1.2297289   0.5165471
  1.1258217   1.14144     1.1588666   1.1240444   0.5170825   1.1322144
  1.1229224   1.1304625   1.1257861   1.0263635   1.2266184   1.1230425
  1.045681    1.2459338   1.0248927   1.2251914   1.0261118   1.2263669
  1.0276512   1.2278568   1.0344441   1.2346987   1.0250463   1.2252682
  1.3328323   1.2218618   0.52493656  1.0414535   1.2415386   1.1260818
  1.0206014   0.5179138   1.228111    1.4258611   0.82494986  1.2262796
  1.2260169   1.1388836   0.5243781   1.1264143   0.5317294   1.1864606
  1.128929    1.1255262   1.1262498   1.1241633   1.1226243   1.4420513
  1.139624    1.133891    0.6264892   1.1460423   1.3460777   0.5241744
  1.1332535   1.5905899   1.1269943   1.0929115   1.5749707   1.1231225
  1.1337322   0.5536657   0.52510333  1.1286275   1.4797325   0.31617144
  1.2256846   1.0368088   1.2369297   1.4991801   0.52066374  0.5181699
  0.5181721   0.52468336  1.2673429   1.1388419   1.1454809   1.1239179
  1.1240932   1.1282214   1.1490692   0.5239427   1.0330931   1.2331487
  1.1283098   1.1244361   4.9842134   0.51872575  1.1365702   1.1249299
  0.5290966   1.1381766   1.157005    1.1247492   1.1000556   1.3001039
  1.1256548   1.1929272   1.0208744   1.1304594   1.1072617   1.3073295
  1.2457733   1.0304865   1.2305552   1.1348401   1.1233585   1.16262
  1.3226126   1.1478624   1.1718485   1.1343458   1.0602144   1.2602818
  1.1318558   1.1431159   1.1236418   1.1303645   1.0374274   1.2374964
  1.1254197   1.1470436   1.1268419   1.0275397   1.2276074   1.1271011
  1.0534205   1.2534894   1.1346598   1.029988    1.230058    1.1320515
  1.1082911   1.3083576   1.1774195   1.1250924   1.1246588   1.1277231
  1.0535463   1.2536141   1.1298676   1.0354549   1.2355233   1.1431823
  1.0274067   1.2274742   1.1307067   1.034252    1.2343205   1.1294849
  1.0358189   1.2358873   1.1298766   1.1401827   1.0302651   1.2303324
  1.1370418   1.1236573   1.1729087   1.1234595   1.1255001   1.127511
  1.130865    1.0268891   1.2269682   1.1270398   1.1277467   1.134153
  1.1275629   1.0263704   1.2264345   0.5266181   1.127373    1.1268338
  1.1303592   1.1283739   1.027323    1.2273896   1.12665     1.125651
  1.2911005   1.1440471   1.1256019   1.12722     1.1449083   1.1359406
  1.1237862   1.1287905   1.1239369   1.1264269   1.3211769   1.1237689
  1.1248802   1.1259254   1.1271892   1.0266137   1.2266805   1.1256628
  1.1234484   5.9191737   1.1249168   1.1320664   1.1243114   1.1347406
  1.1237894   1.1239822   1.1237278   1.1266721   1.0308541   1.2309203
  1.1646562   1.1243733   1.2576003   1.1237991   1.1476759   1.1251892
  1.1243678   1.027175    1.2272484   0.02199811  0.8297201   1.427475
  0.9290534   1.2260834   1.1261506   1.2259614   1.5270572   1.020506
  1.0218027   0.0221181   0.02187422]
2025-06-02 15:59:27,500 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155927_update_15.json
2025-06-02 15:59:27,500 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:27,504 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155927_update_15.pth and as latest_checkpoint.pth
2025-06-02 15:59:27,504 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869545.dot): 0.4907
2025-06-02 15:59:27,504 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:59:27,504 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.9597, MLP Score: 0.0435
2025-06-02 15:59:27,504 - WARNING -   Node ID: ff02::2, Recon Error: 32.7428, MLP Score: 0.0022
2025-06-02 15:59:27,504 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 35.4419, MLP Score: 0.0022
2025-06-02 15:59:27,504 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 30.2144, MLP Score: 0.0027
2025-06-02 15:59:27,504 - WARNING -   Node ID: ff02::fb, Recon Error: 26.6737, MLP Score: 0.0029
2025-06-02 15:59:27,504 - WARNING - Detected 6 anomalous edges (reconstruction-based):
2025-06-02 15:59:27,504 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 10.3910, MLP Score: 0.5014
2025-06-02 15:59:27,504 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 7.1336, MLP Score: 0.2043
2025-06-02 15:59:27,505 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 10.1021, MLP Score: 0.4981
2025-06-02 15:59:27,505 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.5903, MLP Score: 0.1530
2025-06-02 15:59:27,505 - WARNING -   Source: 192.168.27.10, Target: 199.232.210.172, Recon Error: 4.9842, MLP Score: 0.4453
2025-06-02 15:59:27,505 - INFO - 
--- Processing file: nw_graph_encoded_1748869575.dot (Timestamp: 2025-06-02 15:06:15) ---
2025-06-02 15:59:27,505 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:59:27,505 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:59:27,517 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:59:27,532 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:59:27,532 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:59:27,532 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869575.dot
2025-06-02 15:59:27,545 - INFO - Parsed 419 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:59:27,557 - INFO - Parsed 833 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869575.dot'.
2025-06-02 15:59:27,557 - INFO - Processing node updates/additions.
2025-06-02 15:59:27,560 - INFO - Processing edge updates/additions.
2025-06-02 15:59:27,566 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:27,567 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:27,567 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:27,568 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:27,574 - DEBUG - Initial node features tensor shape: torch.Size([419, 30])
2025-06-02 15:59:27,575 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:27,575 - DEBUG - Node features tensor shape after scaling: torch.Size([419, 30])
2025-06-02 15:59:27,576 - DEBUG - Edge index tensor shape: torch.Size([2, 833])
2025-06-02 15:59:27,577 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:27,580 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 13
2025-06-02 15:59:27,580 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:27,581 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:27,582 - DEBUG - Shape of encoded categorical edge features: torch.Size([833, 3])
2025-06-02 15:59:27,583 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:27,583 - DEBUG - Shape of scaled numerical edge features: torch.Size([833, 7])
2025-06-02 15:59:27,583 - DEBUG - Final edge attributes tensor shape: torch.Size([833, 10])
2025-06-02 15:59:27,583 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:27,585 - INFO - Performing online update...
2025-06-02 15:59:27,585 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:27,585 - DEBUG - Updated RunningStats: new_mean=0.9375496702229122, new_var=8400000000160.704, new_n=870
2025-06-02 15:59:27,586 - DEBUG - Updated RunningStats: new_mean=0.9310258721915188, new_var=8700000000019.0625, new_n=900
2025-06-02 15:59:27,586 - DEBUG - Updated RunningStats: new_mean=0.9746687215953754, new_var=2800000000040.338, new_n=290
2025-06-02 15:59:27,586 - DEBUG - Updated RunningStats: new_mean=0.9775671693659521, new_var=2900000000001.1084, new_n=300
2025-06-02 15:59:27,586 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:27,586 - DEBUG - Online update step: 1/50
2025-06-02 15:59:27,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,586 - DEBUG - Online update step: 2/50
2025-06-02 15:59:27,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,586 - DEBUG - Online update step: 3/50
2025-06-02 15:59:27,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,586 - DEBUG - Online update step: 4/50
2025-06-02 15:59:27,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,586 - DEBUG - Online update step: 5/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 6/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 7/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 8/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 9/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 10/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 11/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 12/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 13/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 14/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 15/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 16/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 17/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 18/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 19/50
2025-06-02 15:59:27,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,587 - DEBUG - Online update step: 20/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 21/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 22/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 23/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 24/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 25/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 26/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 27/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 28/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 29/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 30/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 31/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 32/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 33/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 34/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 35/50
2025-06-02 15:59:27,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,588 - DEBUG - Online update step: 36/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 37/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 38/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 39/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 40/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 41/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 42/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 43/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 44/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 45/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 46/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 47/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 48/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 49/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - DEBUG - Online update step: 50/50
2025-06-02 15:59:27,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:27,589 - WARNING - No successful steps during online update.
2025-06-02 15:59:27,590 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], current edge mean: [ 5.2617044e+00  1.4177670e+00  4.8607445e+00  6.8692025e-09
 -5.1519020e-09  4.5794684e-09 -4.5794684e-09  6.8692025e-09
 -3.4346013e-09 -1.7173006e-09]
2025-06-02 15:59:27,590 - DEBUG - Node drift difference: 0.0666, Edge drift difference: 0.0280
2025-06-02 15:59:27,591 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.9420210e-08  4.7797521e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.8693230e-08
  9.1042898e-09 -1.5932507e-08  9.1042898e-09 -1.8208580e-08
  2.4582338e+00  2.9427207e+00  1.4081146e-01  4.3436756e+00
  1.5932507e-08  3.4797137e+00  5.6467781e+00  7.6062055e+00
  1.4081146e-01  8.0000000e+00 -2.2760724e-09  2.0484650e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.6174831e-08 -2.2760723e-08], edge=[ 5.2617044e+00  1.4177670e+00  4.8607445e+00  6.8692025e-09
 -5.1519020e-09  4.5794684e-09 -4.5794684e-09  6.8692025e-09
 -3.4346013e-09 -1.7173006e-09]
2025-06-02 15:59:27,591 - DEBUG - Updated reference std: node=[0.        0.        1.0011954 1.0011954 0.        0.        0.
 1.0011954 1.0011954 1.0011954 1.0011954 1.0011954 1.0142751 0.3339817
 0.3747156 0.5714724 1.0011954 3.1244435 2.942724  1.5043986 0.3747156
 0.        1.0011954 1.0011955 0.        0.        0.        0.
 1.0011954 1.0011955], edge=[1.2291279 0.5031357 1.8797524 1.0006008 1.0006008 1.0006008 1.0006007
 1.0006008 1.0006008 1.0006008]
2025-06-02 15:59:27,591 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:27,592 - INFO - Running anomaly detection...
2025-06-02 15:59:27,592 - INFO - Starting anomaly detection.
2025-06-02 15:59:27,597 - DEBUG - Node reconstruction errors: [22.305197  21.964746  21.836182  20.282297  14.912901  18.839512
 21.836182  17.809298  17.809315  19.27146   17.809162  17.489965
 28.413715  17.71385   19.296637  18.361122  18.450195  18.338875
 20.424112  18.377796  17.930763  19.296612  18.061644  16.968039
 19.176218  19.328302  19.19405   16.169561  17.866255  19.194027
 17.872717  19.349413  16.070105  20.336338  19.328335  22.106592
 19.75707   18.378876  16.204361  17.590155  21.884817  19.43466
 18.378878  22.018137  20.30903   19.842457  23.389828  17.645292
 18.025417  32.945164  35.890335  19.94982   19.469423  21.148647
 18.059359  16.364664  25.762007  18.777678  20.31113   20.31113
 16.020176  22.605412  19.675438  17.24416   19.213743  18.05937
 18.466616  18.05936   19.676624  19.676584  18.31762   19.34713
 19.680182  19.186092  20.17415   19.156332  22.637388  19.845667
 19.618834  19.3787    21.031273  19.921976  16.355581  20.696255
 18.60189   16.799309  19.94818   19.602417  19.589355  20.793392
 19.56048   16.25674   17.782099  19.622858  19.448664  30.65316
 21.459566  19.879692  20.575264  18.118336  19.879686  21.459593
 22.694923  19.547606  16.575836  18.430412  20.00041   15.782169
 17.271929  26.875212  19.401827  21.205763  15.518741  15.762881
 19.880291  19.87962   20.105074  16.120108  19.829233  19.278784
 20.125528  17.782097  16.024622  17.781887  19.807224  20.785667
 16.957426  16.06538   19.879665  21.579155  21.215189  19.08863
 18.95239   17.360704  19.879707  18.431845  23.380291  20.447323
 19.086952  19.8797    18.84356   21.141901  19.892124  19.088554
 19.088703  19.879412  20.105066  18.844015  19.660994  19.604687
 24.999914  16.5755    20.21413   19.088627  19.632483  16.046127
 19.278597  20.407274  19.879694  22.389946  18.837002  16.212627
 19.278717  21.21467   20.105083  16.456285  20.491434  19.829142
 15.614359  19.879513  19.60474   18.943188  19.892124  29.805355
 19.829199  18.7823    19.829092  20.634129  20.361164  20.361166
 18.882364  17.552155  19.91797   16.073095  16.894417  20.361147
 20.508091  20.38206   20.508062  19.305733  20.366636  20.318653
 20.82149   18.942778  20.14262   20.822124  19.4004    20.339972
 15.644538  21.459568  20.447304  18.84504   16.08122   19.829044
 20.329817  20.450987  20.763523  16.809322  20.74648   20.457092
 21.3073    20.361166  20.822027  19.853306  20.36117   19.892124
 20.361172  20.10508   20.68252   18.942913  16.293083  20.710838
 20.355865  20.822033  18.845152  20.566948  20.361162  18.84515
 20.087637  20.450985  17.283396  20.361164  19.879696  20.105074
 20.105074  20.82213   20.087667  20.355875  18.84515   21.57843
 15.936318  20.457363  19.30562   20.105076  19.305481  19.879704
 20.36098   20.335844  19.305616  19.044544  19.892088  19.892082
 20.682579  19.604792  20.317959  20.317959  19.305729  20.966425
 20.355684  20.361166  20.717741  17.695318  20.993374  19.30573
 20.087667  19.589504  20.971964  20.993374  20.971716  20.36114
 17.265623  16.894358  21.052303  23.811974  20.994343  20.361164
 20.355879  21.066431  18.88207   20.361166  20.30041   20.440592
 20.08761   23.62346   19.305695  22.639977  15.984526  16.65384
 17.552158  17.23109   19.589487  21.979479  20.562813  19.305613
 19.876062  20.966585  20.361164  20.360645  20.822126  19.444958
 20.92106   21.571405  21.580536  21.573416  21.57259   21.573378
 21.57335   21.28519   21.572023  21.572515  21.573267  21.285196
 21.57328   21.622414  18.19534   20.85127   20.48594   21.58833
 21.411541  20.973484  21.00702   20.966652  20.291756  21.580534
 20.355867  15.8193035 21.141266  21.28517   20.71832   20.718239
 21.64907   21.411549  21.559296  20.994326  21.57323   21.285208
 19.848766  20.355864  21.142242  21.142025  21.309893  19.8761
 21.142254  20.718334  21.58053   20.971813  21.580505  22.827166
 20.641344  21.573788  21.565905  20.361164  20.976915  20.848612
 20.02362   20.822031  21.571957  21.573423  20.966663  20.966562
 20.335842  21.573158  21.142275  21.573406  21.573404  37.884697
 21.124956  20.848593  19.84886   20.914118  19.841265  19.848505
 19.848875  19.848623  21.068525  21.573412  20.961653  20.457548
 20.959774  21.573366  20.479952  19.848873  19.848867  22.566366
 19.848873  20.84853   19.43188   17.111694  21.442204  21.571661
 22.342577  20.848612  21.568485  20.489635  22.054699  22.055439
 22.056183  22.705622  22.2723    22.705622  20.489754  22.091778
 22.055294  22.275757  21.568462  20.486633  21.45398   19.75651
 22.092299  20.91421   22.05576   20.489634  22.274176  22.055202
 22.055632  21.0917    20.442238  22.056248  20.914242 ]
2025-06-02 15:59:27,600 - DEBUG - Edge reconstruction errors: [ 0.9463744   0.9295484   1.2302854   1.1472099   0.82872903  9.449744
  1.1284857   1.1275394   1.1247057   1.2290672   0.52601826  1.1292508
  1.136222    1.1326655   1.1546724   0.52470404  1.1315501   1.0279429
  1.228532    6.4539213   1.028857    1.2328812   1.1325946   0.532162
  1.354823    0.5253522   1.1291457   1.1657698   1.1980973   0.5244562
  1.1383072   1.0430593   1.2436634   0.52516377  1.0390193   1.2395611
  1.1312977   1.1318395   1.0301312   1.2304453   1.2302251   1.1320665
  1.1277277   1.1359212   1.0956953   1.2959988   1.1327574   1.0284173
  1.228724    1.1319586   1.02851     1.2288294   1.5723345   1.1292828
  1.0310541   1.2385662   1.1263095   1.317711    1.1442171   1.0332923
  1.2335625   1.125148    1.0250984   1.257733    1.0284895   1.1384144
  1.0555321   1.2557995   0.52400297  1.1337534   1.027123    1.2276397
  1.729451    1.126832    0.5260958   1.1562254   1.1523912   1.0293441
  1.2296652   1.153526    1.1879628   1.0297596   1.2300687   1.1330619
  1.0336701   1.2339756   0.419298    1.1348851   1.0282098   1.2285346
  1.2218938   1.0311214   1.2314302   1.131924    1.1362659   1.1251518
  1.1286205   1.0308349   1.2313081   1.1649029   1.1317704   1.0289137
  1.229223    1.1718144   1.1286473   1.1290308   1.0298982   1.2302072
  0.52374774  1.1468678   1.0285195   1.2291293   1.023611    1.15974
  1.0282258   1.2285454   0.52626514  1.1358232   1.1337053   1.1335633
  1.0285068   1.228773    1.1292901   1.129358    1.0281631   1.2284724
  1.1320404   1.0284451   1.2287517   1.1325798   1.0282887   1.2285981
  0.5195668   1.028217    1.2285235   1.1339414   1.0281097   1.2284163
  1.1318243   1.1403558   1.036226    1.2365317   1.1291953   1.0283619
  1.22863     1.129623    1.1260786   1.0282445   1.2285396   1.0279253
  1.2284623   1.033093    1.2334105   1.1295463   1.1380963   1.0318058
  1.2321235   1.1293662   1.1339252   1.0312166   1.2315949   1.0287181
  1.2290174   1.1298329   1.0310303   1.2314787   0.52541363  1.1291295
  1.029629    1.2299412   1.1292268   1.0300596   1.2303281   1.1293035
  1.1382556   1.129406    1.1289536   1.132271    1.0282855   1.2285849
  1.0531801   1.2534782   1.1327707   1.128982    1.1290175   1.0307723
  1.231071    1.1294208   1.0288954   1.2291918   1.1292442   1.0443765
  1.2446749   1.1292037   1.125405    1.1256783   1.2272096   1.2341989
  1.1316125   1.0359211   1.2364647   1.0487512   1.2493632   0.324287
  1.1489792   1.027896    1.2282083   1.0279983   1.2282965   1.036549
  1.2367146   1.1255798   1.0285735   1.228842    1.0317231   1.2320328
  1.2295567   1.8342768   1.2308002   1.0282556   1.1304141   1.1263201
  1.1356664   1.1266654   1.1341753   1.1869398   1.1365446   1.1264583
  1.1349933   1.134008    1.1297983   1.1266577   1.129728    1.1263342
  1.126361    1.1267751   1.1263912   1.1737796   1.1287125   1.1277559
  1.1272062   1.1273198   1.1457735   1.1271497   1.1265348   1.2265085
  1.1496557   1.2291529   1.1284378   1.130649    1.6240231   1.8243984
  0.5238963   1.1253988  11.493324    0.82872903  1.4425884   1.5426383
  1.2313507   1.2429146   1.2077011   1.1289802   1.1264479   1.2290509
  1.1287577   0.52619123  1.1866084   1.1315382   1.0289013   1.2294902
  1.13563     1.1280005   1.1313621   1.127956    1.1324046   1.0380108
  1.238345    1.1294476   1.1322937   1.0304512   1.2307785   6.1152997
  1.1344573   1.0294043   1.2297244   1.1273106   1.0290295   1.2292955
  1.1292752   1.0337154   1.2340426   1.1323177   1.0359132   1.2362103
  1.1292527   1.0856974   1.2860168   1.1590297   1.0330087   1.2334373
  1.028556    1.2289096   1.1292117   1.044306    1.244642    1.1295553
  1.0624437   1.2628707   1.5750846   1.7754599   0.52462834  1.1363653
  1.1252141   1.1261885   1.1294813   0.5251602   1.0351001   1.2356383
  1.133654    1.1917804   1.0694684   1.2697345   0.52565753  1.1302177
  0.5246563   1.0335375   1.234155    1.1316471   0.5256574   1.1394653
  1.0342257   1.2346691   1.1294817   0.5259667   1.1446812   0.5254433
  1.1296065   0.52603835  1.1363165   1.1365035   1.0287971   1.2291063
  1.1333951   1.0298462   1.2301551   1.1654891   1.1426921   1.0307778
  1.2310866   1.1435395   1.0333867   1.2335621   1.1409521   1.1329281
  1.0295316   1.2298408   1.1342707   1.1428225   1.0352151   1.2355359
  0.5252159   1.1568661   1.059614    1.2601345   1.1322923   1.0282258
  1.2286772   1.0314676   1.2317736   1.129213    1.1366694   1.0364739
  1.2367918   0.419298    1.1283765   1.1284654   1.1435198   1.0517987
  1.2521137   0.5252068   1.1305605   1.0296203   1.2301099   0.51943624
  1.1692774   1.071529    1.2718455   0.52541363  1.1337445   1.1120358
  1.3124596   1.1257831   1.1284811   1.1257937   1.1497638   1.1289902
  1.029214    1.2295351   0.5246994   1.1315619   1.0750885   1.2756733
  1.2254251   1.1250912   1.1257678   1.135493    1.1263016   1.1257839
  0.52552307  1.1294874   1.1386714   1.1461661   1.1265248   1.1265038
  1.1386467   1.0362438   1.2365309   1.1259868   1.1583261   1.0301086
  1.2303995   0.5253287   1.0295845   1.2300832   1.1335571   1.0334102
  1.2337085   1.131954    0.52342594  1.033953    1.2344418   1.0317323
  1.2320558   1.129192    0.52480817  1.0335166   1.2341063   1.207523
  1.0294842   1.2297833   1.2295346   1.1412145   0.52545476  1.1291358
  1.1325862   1.1260306   1.1326499   1.0294993   1.2297901   1.1324798
  1.0288026   1.2291018   1.1329908   1.0292687   1.2295679   1.1336664
  1.0294755   1.2297438   1.1295285   1.1295998   1.1288583   1.0347012
  1.235068    0.5246581   1.1536657   1.0282166   1.2288319   1.1371114
  1.0285381   1.2288504   1.145282    1.1290581   1.0366505   1.2369183
  0.52545476  1.1290891   1.1291742   0.52623564  1.1289563   1.1273144
  1.1572667   1.3267567   1.5270373   1.1324999   1.0290629   1.2293619
  1.1268367   1.1318568   1.030489    1.2307876   1.1335766   1.1381009
  1.0282893   1.2287016   1.1254524   1.1335957   1.0298723   1.2301712
  0.52342564  1.0378277   1.2383163   0.5230838   1.0271751   1.2276362
  1.1436905   1.0371604   1.2374586   1.1289363   1.0238189   1.1327784
  1.0302472   1.2305496   1.1349597   1.1301384   1.0285167   1.2288288
  1.1260531   1.1265789   1.0238189   1.0280377   1.2288841   1.0236963
  1.1323456   1.0293449   1.229644    1.1310235   1.1294491   1.0903631
  1.2906537   1.1260378   1.1322622   1.0310636   1.231331    1.2254881
  0.52600366  1.1455027   1.9795319   1.129699    1.1257267   1.1327603
  1.0297811   1.2300801   1.0553545   1.2557565   1.0319151   1.2322937
  0.5200565   1.1292316   1.14308     1.0398089   1.2401749   1.1569842
  1.1273493   0.5205914   1.1373243   1.0335996   1.2338885   1.1295162
  1.1344045   1.0291344   1.2293324   1.1290336   1.0299537   1.230301
  1.126857    1.0458084   1.2461463   1.0297513   1.2299213   1.0295162
  1.2298648   1.0309952   1.2312655   1.0351592   1.2355065   1.0287645
  1.2290624   1.2256899   1.1270913   1.237285    1.1300339   1.1266422
  1.2291534   1.1305821   1.1296594   1.1296381   1.1295832   1.2978789
  1.19195     0.52918345  1.0434332   1.2435343   1.1302145   1.0248524
  0.5220644   1.2321233   1.430288    0.82922727  1.2305292   1.2304186
  1.141121    0.5284232   1.1304172   0.5346666   1.1800206   1.1319448
  1.1293201   1.129219    1.1281238   1.1266819   1.4177711   1.141767
  1.1362888   0.6300851   1.1616832   1.3617307   0.52817523  1.1358422
  1.5926269   1.1305723   1.07717     4.8903947   1.1271416   1.1361386
  0.5523485   0.52933455  1.1321626   1.3942196   0.3195636   1.2296898
  1.0392977   1.2393739   1.4810611   0.52399135  0.5223227   0.5223241
  0.5289088   1.3178      1.1398337   1.1456739   1.1277593   1.127857
  1.1316397   1.1505235   0.5279803   1.0452662   1.2453252   1.1319914
  1.1281565   7.054453    0.52271235  1.1391934   1.128686    0.5329706
  1.1404223   1.1535752   1.1282634   1.1861856   1.3862731   1.1295056
  1.174155    1.0248353   1.1332817   1.0863276   1.28642     1.2095913
  1.0336773   1.2337699   1.1365759   1.1273285   1.1612266   1.2618154
  1.1462978   1.160828    1.1368811   1.0598325   1.2599237   1.1339735
  1.1450472   1.1276301   1.1338627   1.0402551   1.2403483   1.1292707
  1.1475929   1.1304953   1.0313431   1.2314343   1.1311376   1.0517664
  1.2518593   1.1369046   1.0335408   1.2336345   1.1357098   1.0870925
  1.2871836   1.1658953   1.1289403   1.1284919   1.1310549   1.054276
  1.2543677   1.1334596   1.0385166   1.238609    1.1443008   1.0313343
  1.2314256   1.1341012   1.0372887   1.2373811   1.1331966   1.0385085
  1.238601    1.1333699   1.1422658   1.0436734   1.2437664   1.137597
  1.1275586   1.1634079   1.0574136   1.2575059   1.1274241   1.128981
  1.1308867   1.13416     1.0307508   1.230889    1.1304761   1.1309222
  1.1350715   1.1310055   1.0304896   1.2305788   0.53070533  1.1313523
  1.1298907   1.132159    1.1322649   1.0312742   1.2313645   1.1329701
  1.033006    1.2330958   1.1301196   1.0315608   1.2316883   1.2816111
  1.145391    1.129373    1.1303645   1.1425829   1.1377224   1.1305544
  1.0323327   1.2324226   1.1452228   1.1278063   1.1324214   1.03194
  1.23203     1.2592485   1.1305417   1.0328635   1.2329535   1.1286966
  1.1308879   1.13124     1.0306673   1.2307576   1.129455    1.127507
  4.2617555   1.128601    1.1348957   1.1281583   1.1377343   1.127706
  1.1278288   1.1305048   1.0322582   1.2323481   1.1307884   1.0345263
  1.2346162   1.1581168   1.128251    1.3984756   1.1277202   1.1488798
  1.129123    1.1283548   1.0311716   1.2312592   1.0335039   1.2336503
  1.0353636   1.2354517   1.0329342   1.2330524   1.1322385   1.0905682
  1.2906563   1.0358052   1.2358948   1.169621    1.0640473   1.2641361
  1.1500908   1.0385798   1.238669    1.0933186   1.2934065   1.0691494
  1.2692379   1.0815303   1.2816185   1.1218306   1.3219177   0.02679125
  0.83351886  1.4317576   0.9329334   1.2304599   1.13194     1.2304158
  1.5313904   1.0253724   1.0266138   0.02689519  0.02667168]
2025-06-02 15:59:27,602 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155927_update_16.json
2025-06-02 15:59:27,602 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:27,605 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155927_update_16.pth and as latest_checkpoint.pth
2025-06-02 15:59:27,605 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869575.dot): 0.4863
2025-06-02 15:59:27,606 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:59:27,606 - WARNING -   Node ID: 192.168.27.10, Recon Error: 28.4137, MLP Score: 0.0433
2025-06-02 15:59:27,606 - WARNING -   Node ID: ff02::2, Recon Error: 32.9452, MLP Score: 0.0021
2025-06-02 15:59:27,606 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 35.8903, MLP Score: 0.0021
2025-06-02 15:59:27,606 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 30.6532, MLP Score: 0.0025
2025-06-02 15:59:27,606 - WARNING -   Node ID: ff02::fb, Recon Error: 26.8752, MLP Score: 0.0027
2025-06-02 15:59:27,606 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-02 15:59:27,606 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.4497, MLP Score: 0.3584
2025-06-02 15:59:27,606 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.4539, MLP Score: 0.1690
2025-06-02 15:59:27,606 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 11.4933, MLP Score: 0.5390
2025-06-02 15:59:27,606 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 6.1153, MLP Score: 0.1381
2025-06-02 15:59:27,606 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.8904, MLP Score: 0.2354
2025-06-02 15:59:27,610 - DEBUG - Embedding standard deviations before t-SNE: [1.9363796  0.2538492  0.         0.         1.7661227  0.
 0.5014845  0.         0.         1.7075769  2.3375182  0.3421193
 0.         0.5427505  0.         0.49321926 1.5667152  0.
 0.         0.37737402 0.         0.         0.         1.5353367
 0.         1.5607234  0.07666047 0.         0.         0.
 0.81177795 0.4353421 ]
2025-06-02 15:59:28,069 - INFO - Embeddings visualization saved to vis/embeddings_16_updates_20250602_155927.png
2025-06-02 15:59:28,069 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:28,070 - INFO - Starting visualization of node features.
2025-06-02 15:59:28,070 - INFO - Graph has 419 nodes and 30 features.
2025-06-02 15:59:28,070 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:28,070 - INFO - Calculating feature statistics:
2025-06-02 15:59:28,070 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,070 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,070 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.551785), 'max': np.float32(1.4956648)}
2025-06-02 15:59:28,070 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(-3.641716e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4676753), 'max': np.float32(2.5807602)}
2025-06-02 15:59:28,070 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,070 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,071 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,071 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.4141085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.41278455), 'max': np.float32(2.4225714)}
2025-06-02 15:59:28,071 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.13803615e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.2852621), 'max': np.float32(0.77805144)}
2025-06-02 15:59:28,071 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-7.1329055), 'max': np.float32(0.14374286)}
2025-06-02 15:59:28,071 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 9, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-3.6133795), 'max': np.float32(1.0095472)}
2025-06-02 15:59:28,071 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 9, 'mean': np.float32(1.820858e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9946777), 'max': np.float32(3.6515121)}
2025-06-02 15:59:28,071 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 6, 'mean': np.float32(2.4582338), 'std': np.float32(1.0130639), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 15:59:28,071 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9427207), 'std': np.float32(0.3335829), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:28,071 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:28,071 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3436756), 'std': np.float32(0.5707901), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:28,071 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.14374286), 'max': np.float32(7.1329055)}
2025-06-02 15:59:28,071 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.4797137), 'std': np.float32(3.120713), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:59:28,071 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.646778), 'std': np.float32(2.9392102), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:28,072 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6062055), 'std': np.float32(1.5026023), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:28,072 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14081146), 'std': np.float32(0.37426817), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:28,072 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:28,072 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(4.09693e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.15512793), 'max': np.float32(12.03211)}
2025-06-02 15:59:28,072 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(1.3656434e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.17170915), 'max': np.float32(5.823802)}
2025-06-02 15:59:28,072 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,072 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,072 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,072 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:28,072 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-3.1865014e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0751959), 'max': np.float32(8.647978)}
2025-06-02 15:59:28,072 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.9346615e-08), 'std': np.float32(1.0), 'min': np.float32(-1.2040381), 'max': np.float32(4.401428)}
2025-06-02 15:59:28,083 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a14a03b0>
2025-06-02 15:59:28,211 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:28,261 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:28,286 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:29,592 - INFO - Node feature visualization saved to vis/node_features_20250602_155928.png
2025-06-02 15:59:29,592 - INFO - Finished visualization of node features.
2025-06-02 15:59:29,592 - INFO - Performing additional feature analysis:
2025-06-02 15:59:29,592 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:29,593 - INFO - Starting visualization of edge features.
2025-06-02 15:59:29,593 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:59:29,593 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:29,593 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:29,593 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:29,593 - INFO - - count: {'name': 'count', 'unique': 13, 'mean': np.float32(5.2617044), 'std': np.float32(1.2283897), 'min': np.float32(0.0), 'max': np.float32(12.0)}
2025-06-02 15:59:29,593 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.417767), 'std': np.float32(0.50283355), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:29,593 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.8607445), 'std': np.float32(1.8786238), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 15:59:29,593 - INFO - - service: {'name': 'service', 'unique': 21, 'mean': np.float32(9.158937e-09), 'std': np.float32(1.0), 'min': np.float32(-0.068577066), 'max': np.float32(19.334204)}
2025-06-02 15:59:29,594 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 558, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.113668054), 'max': np.float32(19.650415)}
2025-06-02 15:59:29,594 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 595, 'mean': np.float32(4.5794684e-09), 'std': np.float32(1.0), 'min': np.float32(-0.103927135), 'max': np.float32(19.133987)}
2025-06-02 15:59:29,594 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 206, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.087794885), 'max': np.float32(19.022947)}
2025-06-02 15:59:29,594 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 570, 'mean': np.float32(2.2897342e-09), 'std': np.float32(1.0), 'min': np.float32(-0.10684508), 'max': np.float32(21.271181)}
2025-06-02 15:59:29,594 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 590, 'mean': np.float32(2.2897342e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.109008655), 'max': np.float32(21.061152)}
2025-06-02 15:59:29,594 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 222, 'mean': np.float32(-2.2897342e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.104697414), 'max': np.float32(18.497808)}
2025-06-02 15:59:29,607 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1d20770>
2025-06-02 15:59:29,689 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:29,699 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a81b9550>
2025-06-02 15:59:29,811 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:30,079 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:30,247 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:30,271 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:30,281 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:32,026 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155930.png
2025-06-02 15:59:32,026 - INFO - Finished visualization of edge features.
2025-06-02 15:59:32,026 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:32,026 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:59:32,027 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:32,027 - INFO - Graph has 833 edges and 10 edge features.
2025-06-02 15:59:32,027 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:32,353 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155932_summary.png
2025-06-02 15:59:32,560 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155932_pca_3d.png
2025-06-02 15:59:32,735 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155932_pca_variance.png
2025-06-02 15:59:32,735 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:32,735 - INFO - 
--- Processing file: nw_graph_encoded_1748869605.dot (Timestamp: 2025-06-02 15:06:45) ---
2025-06-02 15:59:32,735 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:59:32,735 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:59:32,743 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:59:32,752 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:59:32,752 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:59:32,752 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869605.dot
2025-06-02 15:59:32,760 - INFO - Parsed 439 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:59:32,768 - INFO - Parsed 919 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869605.dot'.
2025-06-02 15:59:32,768 - INFO - Processing node updates/additions.
2025-06-02 15:59:32,770 - INFO - Processing edge updates/additions.
2025-06-02 15:59:32,775 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:32,776 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:32,776 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:32,776 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:32,780 - DEBUG - Initial node features tensor shape: torch.Size([439, 30])
2025-06-02 15:59:32,782 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:32,782 - DEBUG - Node features tensor shape after scaling: torch.Size([439, 30])
2025-06-02 15:59:32,783 - DEBUG - Edge index tensor shape: torch.Size([2, 919])
2025-06-02 15:59:32,783 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:32,785 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 14
2025-06-02 15:59:32,786 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:32,786 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:32,787 - DEBUG - Shape of encoded categorical edge features: torch.Size([919, 3])
2025-06-02 15:59:32,788 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:32,788 - DEBUG - Shape of scaled numerical edge features: torch.Size([919, 7])
2025-06-02 15:59:32,788 - DEBUG - Final edge attributes tensor shape: torch.Size([919, 10])
2025-06-02 15:59:32,788 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:32,789 - INFO - Performing online update...
2025-06-02 15:59:32,789 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:32,790 - DEBUG - Updated RunningStats: new_mean=0.9383308154483265, new_var=9000000000159.291, new_n=930
2025-06-02 15:59:32,790 - DEBUG - Updated RunningStats: new_mean=0.9323558082069221, new_var=9300000000019.541, new_n=960
2025-06-02 15:59:32,790 - DEBUG - Updated RunningStats: new_mean=0.9864378137744814, new_var=3000000000049.502, new_n=310
2025-06-02 15:59:32,790 - DEBUG - Updated RunningStats: new_mean=0.9887163291501435, new_var=3100000000001.0605, new_n=320
2025-06-02 15:59:32,790 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:32,790 - DEBUG - Online update step: 1/50
2025-06-02 15:59:32,790 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,790 - DEBUG - Online update step: 2/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 3/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 4/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 5/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 6/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 7/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 8/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 9/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 10/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 11/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 12/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 13/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 14/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 15/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 16/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 17/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 18/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 19/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 20/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 21/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 22/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,791 - DEBUG - Online update step: 23/50
2025-06-02 15:59:32,791 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 24/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 25/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 26/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 27/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 28/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 29/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 30/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 31/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 32/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 33/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 34/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 35/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 36/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 37/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 38/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 39/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 40/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 41/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 42/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 43/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 44/50
2025-06-02 15:59:32,792 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,792 - DEBUG - Online update step: 45/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - DEBUG - Online update step: 46/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - DEBUG - Online update step: 47/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - DEBUG - Online update step: 48/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - DEBUG - Online update step: 49/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - DEBUG - Online update step: 50/50
2025-06-02 15:59:32,793 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,793 - WARNING - No successful steps during online update.
2025-06-02 15:59:32,793 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], current edge mean: [ 6.2328620e+00  1.4417845e+00  4.8509250e+00  5.1886523e-10
 -6.7452484e-09  1.5565957e-09  3.6320567e-09  4.1509218e-09
 -5.1886526e-09 -3.1131915e-09]
2025-06-02 15:59:32,794 - DEBUG - Node drift difference: 0.0619, Edge drift difference: 0.7901
2025-06-02 15:59:32,794 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:32,794 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.3896167e-08 -2.8240924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6068546e-08
 -4.3447579e-09  1.1948083e-08 -2.0637598e-08 -3.2585682e-08
  2.4510250e+00  2.9453304e+00  1.6400911e-01  4.3280182e+00
 -2.0637598e-08  3.6173120e+00  5.4715261e+00  7.5831437e+00
  1.6400911e-01  8.0000000e+00 -1.3034273e-08 -2.4982358e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.7886838e-09 -2.4982358e-08], edge=[ 6.2328620e+00  1.4417845e+00  4.8509250e+00  5.1886523e-10
 -6.7452484e-09  1.5565957e-09  3.6320567e-09  4.1509218e-09
 -5.1886526e-09 -3.1131915e-09]
2025-06-02 15:59:32,795 - DEBUG - Updated reference std: node=[0.         0.         1.0011408  1.0011408  0.         0.
 0.         1.0011408  1.001141   1.001141   1.0011408  1.001141
 1.003074   0.3264865  0.39457318 0.56690574 1.001141   3.2002099
 2.9714756  1.5429286  0.39457318 0.         1.001141   1.0011408
 0.         0.         0.         0.         1.001141   1.001141  ], edge=[1.2118548 0.5077134 1.870123  1.0005445 1.0005445 1.0005445 1.0005445
 1.0005445 1.0005445 1.0005445]
2025-06-02 15:59:32,795 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:32,795 - INFO - Running anomaly detection...
2025-06-02 15:59:32,795 - INFO - Starting anomaly detection.
2025-06-02 15:59:32,888 - DEBUG - Node reconstruction errors: [22.520674 22.011284 22.2927   20.426836 15.381552 19.427094 22.2927
 18.101782 18.101803 19.53631  18.10166  18.047022 29.423512 17.85205
 19.637352 18.6675   18.958708 18.646349 20.893747 18.700045 18.212887
 19.637325 18.323084 17.494255 19.527256 19.452518 19.547009 16.804249
 18.165615 19.54698  18.35314  19.629692 16.956842 20.482403 19.452541
 22.38641  20.684542 18.701088 16.883543 16.929237 22.19756  19.77771
 18.701088 22.283825 20.61782  18.752642 23.619987 18.114294 18.323215
 32.726    36.227383 20.232164 19.595638 21.504883 18.124424 16.480215
 26.302877 19.094292 20.555208 20.555206 16.150213 22.850903 20.000528
 18.050367 19.349707 18.12443  18.527353 18.124422 20.001942 20.0019
 18.376799 19.514519 19.80201  19.324484 20.751368 19.331446 22.90568
 19.984161 19.72652  19.511288 21.14712  20.039814 16.48942  20.943583
 18.97088  16.911467 20.087912 19.714106 19.722372 21.18238  19.672329
 16.381243 17.889578 20.208218 19.599268 30.98183  21.553259 20.00889
 20.855513 18.21687  20.008888 21.553284 22.759033 19.71448  16.702429
 18.518852 20.064123 15.952284 17.415497 27.541027 20.041601 21.30151
 15.62473  16.73219  19.99642  20.008842 20.213037 16.17706  19.931854
 19.309622 20.199566 17.889576 16.099237 17.889372 19.928274 20.816633
 17.06048  16.151876 20.008875 21.999987 21.438803 19.140615 19.042551
 17.844872 20.46101  18.890556 23.607439 20.740425 19.139357 15.97674
 19.307848 21.705479 20.392601 19.140554 19.140673 20.008709 20.213034
 18.9284   19.90041  20.177654 25.10811  16.702106 20.805918 19.140615
 19.771395 16.113493 19.309448 20.492603 20.008894 22.479105 18.92322
 16.372274 19.30955  21.438099 20.213043 15.957575 21.094751 20.177637
 15.746748 20.177362 19.728424 19.309484 19.993593 30.067808 20.177694
 19.27113  20.177626 20.707912 20.4602   20.4602   18.942244 17.698402
 19.965727 16.160526 16.947868 20.460184 20.568607 20.484076 20.568586
 19.362707 20.874973 20.415257 20.881523 19.01256  20.214195 20.882124
 19.494785 20.392155 15.727067 22.00015  20.740395 18.929157 16.193401
 19.931694 20.439365 17.88959  20.994255 17.2805   21.00997  21.031363
 21.414526 20.4602   20.88203  19.956768 20.460209 19.993595 20.460205
 20.21304  20.78963  19.012661 17.256474 20.747068 20.432959 20.882036
 18.929234 20.636503 20.460201 18.929235 20.17992  20.537712 17.4403
 20.460201 20.177753 20.21304  20.213036 20.882124 20.179943 20.432974
 18.929235 21.658848 16.380354 21.217133 19.362621 20.177757 19.36251
 20.67527  20.722565 20.458239 19.362617 19.08762  19.993557 19.993555
 20.789696 19.728462 20.460997 20.428808 19.362707 21.231503 20.432795
 20.460205 21.291851 17.818296 21.046516 19.362705 20.17994  19.750929
 21.545301 21.046518 21.545134 20.46018  17.31481  16.94781  21.464863
 24.02867  21.584595 20.460197 20.671722 21.163317 18.942017 20.460197
 21.239332 20.492155 20.636364 23.852867 19.362675 22.879297 16.46996
 16.787209 17.698408 17.348152 19.94383  22.049608 20.783337 19.362614
 19.946678 21.231691 20.4602   20.459726 20.882122 19.505472 20.98519
 21.804771 22.148426 22.148428 21.806055 21.80686  21.806828 21.87251
 21.80548  21.805931 21.806744 21.872509 21.806753 21.615236 19.006573
 21.112692 20.56458  21.619087 21.43109  21.013914 21.814508 21.231768
 20.382387 22.148428 20.747498 16.384306 21.39211  21.872496 21.292326
 21.292244 22.212198 21.43109  21.792562 21.584583 21.806704 21.872519
 20.046425 20.432959 21.393099 21.39286  21.48538  19.946703 21.39311
 21.81498  22.148418 21.545195 22.148407 23.050774 21.230597 21.656511
 21.798683 20.707884 21.037548 20.939417 20.073627 20.882032 21.805403
 21.806906 21.231775 21.231663 20.458239 21.806618 21.393133 22.146585
 22.148096 30.670658 21.142029 20.9394   20.985218 21.19812  20.70376
 20.98519  20.91333  16.70518  21.500996 22.395607 20.997576 20.677752
 21.340994 21.806849 22.14843  19.872538 20.046518 21.68846  19.87254
 20.98521  19.460022 17.22052  22.02882  21.805107 22.548208 20.985216
 21.566223 20.47284  22.621534 22.622206 22.622889 22.800518 22.469292
 22.800518 20.472937 22.066746 22.622072 22.47569  21.566198 20.469912
 22.009447 19.774998 22.067232 20.956617 22.622501 20.47284  22.474031
 22.622    22.622385 21.089155 20.475622 22.62295  20.956642 21.566334
 21.566345 20.472507 21.56605  20.472712 17.900381 21.933043 20.47294
 23.237366 17.854404 22.249014 22.337324 20.057772 22.620432 21.493937
 22.623014 22.622171 20.472935 21.494427 22.249016]
2025-06-02 15:59:32,892 - DEBUG - Edge reconstruction errors: [ 1.0481882   1.0303961   1.3310573   1.2474426   0.9298449   9.791141
  1.2302957   1.2289928   1.2262827   1.3299376   0.6275766   1.2304964
  1.23716     1.2339933   1.269528    0.6263358   1.2326329   1.1293349
  1.3297327   6.7685876   1.1298879   1.3337122   1.2340428   0.63343203
  1.4471828   0.6270359   1.2303567   1.2656411   1.2979033   0.6261147
  1.2392136   1.1444452   1.3448545   0.6277901   1.1411471   1.3414186
  1.2329987   1.2329818   1.1313612   1.3316994   1.329168    1.2333472
  1.2291099   1.2372258   1.1968175   1.3971221   1.2338626   1.1297121
  1.3300369   1.2330853   1.1297866   1.3301289   1.6821791   1.2305536
  1.1319647   1.3391441   1.2276833   1.411209    1.2448314   1.1402541
  1.3405132   1.2266996   1.1272699   1.3574812   1.1295371   1.2398117
  1.1865464   1.3867962   0.62643355  1.235475    1.1308011   1.3312094
  1.834062    1.2282163   0.6277106   1.2563189   1.2526325   1.1358399
  1.3361752   1.2538029   1.3025384   1.1424173   1.3427467   1.2341557
  1.1347728   1.3350933   0.42025605  1.2360543   1.1323923   1.3327476
  1.3199654   1.1322814   1.3326061   1.2331103   1.2374287   1.230318
  1.2329233   1.132013    1.3324447   1.2765754   1.2366898   1.1390474
  1.3394582   0.4257191   1.2712458   1.2349875   1.2334285   1.1311438
  1.3314638   0.62531257  1.2573537   1.1297778   1.3301879   1.1252673
  1.2597618   1.1323363   1.3326751   0.6277927   1.2367778   1.2347932
  1.2346588   1.1298014   1.330059    1.2305241   1.2305777   1.132433
  1.3327725   1.2331603   1.132382    1.3327212   1.233701    1.1318754
  1.332215    0.6216905   1.1295156   1.3298404   1.2351215   1.1294142
  1.329739    1.2329692   1.2411131   1.1372583   1.3375784   1.2304429
  1.129666    1.3299242   1.2308424   1.2275862   1.129551    1.3298542
  1.12926     1.3297093   1.134256    1.3345947   1.2307994   1.2389945
  1.133035    1.3333536   1.2382082   1.2350442   1.1324347   1.332823
  1.1300067   1.3303171   1.231047    1.1321929   1.3326336   0.62707275
  1.2303237   1.130944    1.3312732   1.2304658   1.1312722   1.3315302
  1.2305381   1.2391042   1.2306801   1.2302355   1.2333947   1.1295906
  1.3299015   1.1546879   1.3549932   1.2338685   1.2302759   1.230309
  1.1319486   1.332257    1.2306663   1.1301633   1.3304708   1.2304889
  1.1458402   1.3461477   1.230451    1.2268918   1.2271575   1.3284104
  1.3349851   1.2327135   1.157321    1.3577763   1.2302631   1.1751144
  1.3755487   0.4267128   1.2329711   1.250374    1.1930245   1.3933632
  1.1292822   1.3295941   1.1378021   1.3379228   1.2305198   1.1298718
  1.3301312   1.1327981   1.3331254   1.3305726   1.9349824   1.3317288
  1.1293122   1.2349575   1.2302067   1.133402    1.3337384   1.2367845
  1.1289093   1.329361    1.2305282   1.1290506   1.3294334   1.2577622
  1.1289884   1.3294203   0.6264167   1.2889762   1.2402047   1.1331824
  1.3334773   1.2316412   1.2384254   1.1315132   1.3318254   1.2354902
  1.1304419   1.3306686   1.2342358   1.1315715   1.3318866   1.2305808
  1.1296123   1.3299078   1.2309844   1.2276536   1.2276808   1.2281352
  1.2278169   1.273614    1.1298113   1.3299571   1.2299427   1.2306491
  1.1292263   1.3296351   1.228625    1.2286047   1.2460619   1.2284908
  1.2278998   1.3276842   1.2504885   1.3300735   1.1327835   1.3329031
  1.2295479   1.2700403   1.4703734   1.2313216   1.2312833   1.2342219
  1.1320096   1.3323631   1.2371467   1.2279075   1.2281365   1.2297349
  1.2320861   1.7202642   1.9205683   0.62609875  1.2270163  11.890453
  0.9298449   1.5427898   1.6428286   1.3321505   1.343106    1.3055196
  1.230453    1.2279496   1.3299223   1.2301239   0.62773764  1.286403
  1.2326217   1.1302484   1.3306459   1.2369983   1.2293837   1.2330877
  1.2293305   1.23354     1.1388732   1.3392329   1.2307816   1.233429
  1.1316558   1.3320106   7.795794    1.2356012   1.1306559   1.3309976
  1.2286872   1.1302997   1.330557    1.2305099   1.1347867   1.3351383
  1.2334017   1.1369514   1.3372548   1.2304955   1.1857992   1.386124
  1.2590411   1.1341568   1.3345755   1.1298151   1.3301902   1.2304635
  1.1450398   1.3453958   1.2308074   1.1639723   1.3643895   1.6729561
  1.8732728   0.62626797  1.2371979   1.226688    1.2276783   1.2307519
  0.62699383  1.1362635   1.3367226   1.2349942   1.2928046   1.1710615
  1.3713113   0.62730366  1.2314472   0.6263287   1.1346661   1.3350873
  1.2327635   0.62730354  1.2403988   1.1353225   1.335743    1.230733
  0.62755156  1.2453884   0.6271014   1.2308242   0.627603    1.2372605
  1.237448    1.1300778   1.3304046   1.2344853   1.1310806   1.3314067
  1.2653432   1.2433643   1.1319535   1.3322785   1.2604619   1.1344683
  1.334587    1.2417774   1.234074    1.1307765   1.3311026   1.23537
  1.2441589   1.136491    1.3368312   0.6268951   1.2568874   1.16079
  1.361236    1.2336538   1.1295527   1.3299786   1.1326398   1.3329618
  1.23046     1.2443644   1.137434    1.3377682   0.42025605  1.234182
  1.2342991   1.2531184   1.152045    1.3523661   0.62669337  1.244377
  1.1307807   1.3311212   0.6271014   1.2305017   1.2704531   1.1729714
  1.3733022   0.62707275  1.2348261   1.2137378   1.4141628   1.227255
  1.2298324   1.2302663   1.250645    1.2302432   1.130464    1.3308059
  0.6262958   1.232647    1.1765691   1.376967    1.3267294   1.2266358
  1.2272406   1.2365595   1.2278392   1.2272558   0.62719107  1.2306721
  1.2395979   1.246648    1.2278594   1.2278396   1.2398835   1.1376438
  1.3377885   1.2274104   1.2583922   1.1313386   1.3316338   0.6279388
  1.1314691   1.331695    1.2348797   1.1345209   1.3348279   1.233071
  0.6251776   1.1353654   1.3357056   1.1328622   1.3332084   1.2304355
  0.62694615  1.1348675   1.3353137   1.308396    1.130834    1.3311121
  1.3305515   1.2419356   0.62711495  1.2303464   1.2336948   1.227474
  1.2337699   1.1307441   1.3310393   1.2336044   1.1300843   1.3303944
  1.2341305   1.1305174   1.3308271   1.234783    1.1307306   1.330989
  1.2307327   1.2308004   1.2301073   1.1357615   1.3361381   0.62633383
  1.2541264   1.1295964   1.3300171   1.2380389   1.1298124   1.3301413
  1.2460637   1.2303052   1.137809    1.3380643   0.62711495  1.2303022
  1.2304572   0.6278253   1.2302158   1.2287372   1.2577431   1.4288065
  1.6290689   1.2336099   1.1303337   1.3306438   1.2281934   1.2329979
  1.1316764   1.3319851   1.2347107   1.2390311   1.129589    1.3299878
  1.2278483   1.2347218   1.1311232   1.3314327   0.6251774   1.1393601
  1.3397006   0.62487686  1.1285286   1.3288944   1.2450055   1.1383549
  1.3386614   1.2302418   1.1253666   1.2344114   1.1321452   1.3322861
  1.2360208   1.2313935   1.1297909   1.3301197   1.2274797   1.2279181
  1.1253666   1.1291184   1.3299143   1.1253259   1.2334605   1.1305966
  1.3309063   1.2426751   1.230743    1.1917431   1.3920273   1.2274654
  1.2333344   1.1322004   1.332456    1.3267757   0.62631136  1.2459393
  1.354481    1.5548915   2.0949595   1.2309253   1.2271967   1.2429322
  1.1310445   1.3313515   1.1560445   1.3564367   1.1331766   1.333565
  0.62210137  1.2304543   1.2441757   1.1410817   1.3414592   1.3209748
  1.2287043   0.6225519   1.2381963   1.1402408   1.3405269   1.2306998
  1.2355354   1.1304455   1.330599    1.2341983   1.1311544   1.331525
  1.2281594   1.1466439   1.3469263   1.2304662   1.130992    1.3311157
  1.1309626   1.3312571   1.2308426   1.1321889   1.3324524   1.1364793
  1.3368498   1.1393174   1.3396204   1.3269389   1.228388    1.3396398
  1.2311697   1.2278616   1.3300741   1.2316961   1.2307695   1.230749
  1.230747    0.42632684  1.2304868   0.62754613  1.2328256   1.2279674
  1.2278117   0.62293947  0.6275303   1.2335727   1.2313275   0.62293947
  1.2306514   1.1275401   1.2398617   1.2276311   1.3934399   1.3247373
  0.6302455   1.1438336   1.3439119   1.2311836   1.1266683   0.6245387
  1.3328762   1.5310584   0.93023264  1.3313977   1.3311822   1.2416016
  0.6295204   1.2315637   0.63553005  1.2793931   1.2334044   1.230714
  1.2308818   1.229693    1.2283782   1.503119    1.2426144   1.2375782
  0.73128015  1.2877288   1.4877654   0.62938285  1.2371309   1.688298
  1.2318649   1.1779945   5.0494695   1.2288107   1.2372957   0.65350944
  0.63033473  1.2331991   1.4991308   0.42834413  1.3307327   1.1846569
  1.3847129   1.573853    0.62583536  0.62475413  0.62475556  0.6299506
  1.4191023   1.2409402   1.2462301   1.229195    1.2294594   1.2329509
  1.2507437   0.6291891   1.157432    1.357472    1.2329942   1.2295771
  7.2496166   0.62504905  1.24        1.2301837   0.6337742   1.2485564
  1.2545278   1.2298336   1.2804496   1.4805111   1.2307677   1.276027
  1.1275157   1.2345315   1.1876987   1.3877511   1.3118448   1.134699
  1.3347521   1.2375798   1.228782    1.2610906   1.3647029   1.2471927
  1.2623081   1.237729    1.1595836   1.3596358   1.2353156   1.2454314
  1.2290589   1.2345589   1.1406232   1.3407047   1.2304981   1.2480719
  1.2316442   1.1324258   1.3324782   1.2321355   1.1523199   1.3523726
  1.2378004   1.1345147   1.3345675   1.236448    1.18845     1.3885018
  1.2670627   1.2302338   1.2298894   1.2323556   1.1542312   1.3542836
  1.2343649   1.1392119   1.3392643   1.2448547   1.1323962   1.3324486
  1.234996    1.1535076   1.3535601   1.2340952   1.1392685   1.3393209
  1.2343022   1.2429736   1.1441307   1.3441833   1.2387291   1.229011
  1.2648921   1.1934351   1.3934875   1.2288753   1.2304038   1.232193
  1.2352495   1.132053    1.3321472   1.2318021   1.2322612   1.236502
  1.2322049   1.1316117   1.3316685   0.6316426   1.2367133   1.2312859
  1.2336081   1.2332028   1.1323334   1.3323852   1.2338922   1.133973
  1.3340247   1.2313292   1.1327704   1.3328508   1.3742105   1.24596
  1.2306811   1.2317104   1.2439945   1.2386732   1.231574    1.1333338
  1.3333855   1.2457769   1.2316778   1.1962186   1.3962697   1.2334396
  1.1329633   1.333015    1.3625581   1.2315614   1.133865    1.3339168
  1.2299691   1.2321789   1.2322243   1.1317528   1.3318046   1.2311486
  1.1407729   1.3408254   1.2289006   4.4223194   1.2299801   1.2358856
  1.2295418   1.2385732   1.2315767   1.1334776   1.3335292   1.2317024
  1.3973434   1.59739     1.2315265   1.1332589   1.3333107   1.2317938
  1.1353984   1.3354502   1.2591386   1.229622    1.4852982   1.2315791
  1.1398135   1.3398656   1.2492216   1.2308141   1.1336782   1.3337246
  1.2317791   1.132209    1.3322607   1.1322517   1.3323072   1.1346766
  1.3347814   1.1362861   1.3363422   1.1341568   1.3342403   1.2333724
  1.1927438   1.3927978   1.1368681   1.3369225   1.2962898   1.1656917
  1.365746    1.2503918   1.1395764   1.339631    1.1953303   1.3953841
  1.1706673   1.3707215   1.1834345   1.3834887   1.2243929   1.4244466
  1.137762    1.337892    1.1859326   1.3859867   1.2928027   1.4928656
  1.1334893   1.3335438   1.1347998   1.3349327   1.1373144   1.3373697
  0.0273075   0.93788224  1.5324033   1.0371307   1.3312156   1.2326642
  1.331121    1.6320516   1.1264437   1.1276519   0.02742618  0.02755032
  1.1280468 ]
2025-06-02 15:59:32,894 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155932_update_17.json
2025-06-02 15:59:32,894 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:32,898 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155932_update_17.pth and as latest_checkpoint.pth
2025-06-02 15:59:32,898 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869605.dot): 0.4902
2025-06-02 15:59:32,898 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 15:59:32,898 - WARNING -   Node ID: 192.168.27.10, Recon Error: 29.4235, MLP Score: 0.0355
2025-06-02 15:59:32,898 - WARNING -   Node ID: ff02::2, Recon Error: 32.7260, MLP Score: 0.0021
2025-06-02 15:59:32,898 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 36.2274, MLP Score: 0.0020
2025-06-02 15:59:32,898 - WARNING -   Node ID: 192.168.209.130, Recon Error: 26.3029, MLP Score: 0.0083
2025-06-02 15:59:32,898 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 30.9818, MLP Score: 0.0024
2025-06-02 15:59:32,899 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-02 15:59:32,899 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 9.7911, MLP Score: 0.4170
2025-06-02 15:59:32,899 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 6.7686, MLP Score: 0.1877
2025-06-02 15:59:32,899 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 11.8905, MLP Score: 0.6330
2025-06-02 15:59:32,899 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 7.7958, MLP Score: 0.2418
2025-06-02 15:59:32,899 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 5.0495, MLP Score: 0.2626
2025-06-02 15:59:32,899 - INFO - 
--- Processing file: nw_graph_encoded_1748869635.dot (Timestamp: 2025-06-02 15:07:15) ---
2025-06-02 15:59:32,899 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:59:32,899 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:59:32,916 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:59:32,931 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:59:32,931 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:59:32,931 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869635.dot
2025-06-02 15:59:32,943 - INFO - Parsed 511 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:59:32,955 - INFO - Parsed 1044 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869635.dot'.
2025-06-02 15:59:32,955 - INFO - Processing node updates/additions.
2025-06-02 15:59:32,958 - INFO - Processing edge updates/additions.
2025-06-02 15:59:32,963 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:32,964 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:32,964 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:32,964 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:32,969 - DEBUG - Initial node features tensor shape: torch.Size([511, 30])
2025-06-02 15:59:32,970 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:32,970 - DEBUG - Node features tensor shape after scaling: torch.Size([511, 30])
2025-06-02 15:59:32,971 - DEBUG - Edge index tensor shape: torch.Size([2, 1044])
2025-06-02 15:59:32,972 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:32,974 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:32,975 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:32,975 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:32,976 - DEBUG - Shape of encoded categorical edge features: torch.Size([1044, 3])
2025-06-02 15:59:32,977 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:32,977 - DEBUG - Shape of scaled numerical edge features: torch.Size([1044, 7])
2025-06-02 15:59:32,977 - DEBUG - Final edge attributes tensor shape: torch.Size([1044, 10])
2025-06-02 15:59:32,977 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:32,979 - INFO - Performing online update...
2025-06-02 15:59:32,979 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:32,979 - DEBUG - Updated RunningStats: new_mean=0.939023237065151, new_var=9600000000159.58, new_n=990
2025-06-02 15:59:32,980 - DEBUG - Updated RunningStats: new_mean=0.9331223368345892, new_var=9900000000019.148, new_n=1020
2025-06-02 15:59:32,980 - DEBUG - Updated RunningStats: new_mean=0.9965759647952315, new_var=3200000000049.315, new_n=330
2025-06-02 15:59:32,980 - DEBUG - Updated RunningStats: new_mean=0.9984465739633648, new_var=3300000000001.121, new_n=340
2025-06-02 15:59:32,980 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:32,980 - DEBUG - Online update step: 1/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 2/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 3/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 4/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 5/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 6/50
2025-06-02 15:59:32,980 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,980 - DEBUG - Online update step: 7/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 8/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 9/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 10/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 11/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 12/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 13/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 14/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 15/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 16/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 17/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 18/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 19/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 20/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 21/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 22/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 23/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 24/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,981 - DEBUG - Online update step: 25/50
2025-06-02 15:59:32,981 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 26/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 27/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 28/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 29/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 30/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 31/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 32/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 33/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 34/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 35/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 36/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 37/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 38/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 39/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 40/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 41/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 42/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 43/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,982 - DEBUG - Online update step: 44/50
2025-06-02 15:59:32,982 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 45/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 46/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 47/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 48/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 49/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - DEBUG - Online update step: 50/50
2025-06-02 15:59:32,983 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:32,983 - WARNING - No successful steps during online update.
2025-06-02 15:59:32,983 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], current edge mean: [ 6.2222223e+00  1.4061303e+00  4.8524904e+00 -1.8269622e-09
 -1.8269622e-09 -4.5674056e-09  1.3702217e-09 -5.4808869e-09
 -2.7404434e-09  2.2837028e-09]
2025-06-02 15:59:32,984 - DEBUG - Node drift difference: 0.0883, Edge drift difference: 0.0702
2025-06-02 15:59:32,984 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4261773e-08  4.2924675e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.3593224e-08
  4.2924675e-08  1.3064032e-08  6.5320158e-09  1.8662902e-09
  2.4637964e+00  2.9491193e+00  1.2915851e-01  4.3170257e+00
 -1.3064032e-08  3.3874755e+00  5.5890412e+00  7.6066537e+00
  1.2915851e-01  8.0000000e+00  2.9860644e-08 -1.4930322e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.7994354e-09 -4.3857820e-08], edge=[ 6.2222223e+00  1.4061303e+00  4.8524904e+00 -1.8269622e-09
 -1.8269622e-09 -4.5674056e-09  1.3702217e-09 -5.4808869e-09
 -2.7404434e-09  2.2837028e-09]
2025-06-02 15:59:32,985 - DEBUG - Updated reference std: node=[0.         0.         1.0009799  1.0009799  0.         0.
 0.         1.0009799  1.0009799  1.0009799  1.0009799  1.0009799
 0.99121654 0.31522512 0.3527915  0.5612344  1.0009799  3.1126812
 2.953794   1.5002859  0.3527915  0.         1.0009799  1.0009799
 0.         0.         0.         0.         1.0009799  1.0009799 ], edge=[1.183315  0.5010064 1.9140905 1.0004793 1.0004793 1.0004792 1.0004792
 1.0004792 1.0004792 1.0004792]
2025-06-02 15:59:32,985 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:32,985 - INFO - Running anomaly detection...
2025-06-02 15:59:32,985 - INFO - Starting anomaly detection.
2025-06-02 15:59:32,997 - DEBUG - Node reconstruction errors: [23.317358 22.952843 25.651419 20.727236 15.502102 19.63977  23.869411
 18.47179  18.47181  19.888062 18.471754 18.675781 31.563698 18.445568
 20.005283 19.014553 19.549068 19.000296 21.499155 19.052668 18.550568
 20.005276 18.654217 18.276205 19.910217 19.715979 19.916443 17.319466
 18.524889 19.91643  18.936138 19.972948 17.469952 20.673428 19.618927
 22.66592  20.800219 19.053032 17.6561   17.384403 22.526405 20.130068
 19.053032 22.56381  20.95769  18.946264 23.848906 18.944618 18.673607
 33.344753 37.370926 20.547518 19.834196 22.070215 18.205563 16.368584
 27.489803 19.395718 21.002333 20.825672 16.459116 23.076887 20.328587
 18.537657 19.595272 18.205564 18.59192  18.205566 20.329159 20.329153
 18.432835 19.901495 18.832573 19.691023 21.226355 19.737179 23.137045
 20.344202 20.4811   19.857115 21.227911 20.298878 15.393428 21.167265
 19.114962 17.108398 20.445507 20.037855 20.0708   21.551619 19.757782
 16.572016 18.202782 20.398838 19.704853 32.05798  21.673021 20.339083
 21.091074 18.595512 20.339079 21.673033 22.717518 20.105644 16.85593
 18.972513 20.280052 16.190586 17.591778 28.097506 20.2901   21.35125
 15.778361 17.271631 20.12259  20.518414 20.30643  16.652523 20.003592
 19.372276 20.219748 18.202782 16.354502 18.202717 20.254007 20.872934
 17.366327 16.436495 20.339075 22.048466 21.605442 19.127068 19.109789
 17.544573 20.518536 18.869951 23.751757 20.98565  16.49933  16.0326
 19.27017  21.738287 20.378145 19.453056 19.1271   20.133135 20.306427
 18.956259 20.088842 20.21505  25.18936  17.321678 21.250156 19.127068
 20.114454 16.30281  19.372217 20.660618 20.339085 22.483055 18.953045
 17.322353 19.372234 21.604984 20.521053 16.017717 21.549265 20.45151
 16.61107  20.214943 20.049776 19.37223  20.043615 31.051258 20.673975
 19.297718 20.215034 20.728321 20.739157 20.739157 19.471931 18.034573
 19.953121 16.402346 16.597033 20.516136 20.688046 20.694027 20.87844
 19.860783 21.13032  20.864332 20.939941 19.118204 17.418821 21.379526
 17.988182 20.562582 16.196072 22.048521 21.07096  19.371916 16.405981
 20.231215 20.664503 18.202784 21.170002 17.435997 21.231995 21.455715
 20.960878 20.516157 20.940113 20.17919  20.516163 20.673523 20.516161
 20.306435 21.072914 19.118237 17.645288 20.687933 20.426159 20.940113
 19.372282 20.88012  16.409382 19.054907 20.449974 20.564058 17.808306
 21.187696 20.215082 20.30643  20.306429 21.38507  20.789448 20.42616
 19.372143 21.761421 16.58491  21.606344 19.331392 20.215084 19.428698
 20.518524 20.928265 20.947866 19.331392 19.08817  20.043596 20.151546
 21.072945 20.45154  20.518524 20.530397 19.428762 21.429102 20.535767
 20.73916  21.682243 18.129042 21.0828   19.428766 20.449984 19.839046
 21.94358  21.0828   21.943542 20.739147 17.429987 17.092781 21.736212
 24.135843 21.985481 20.739157 20.625694 21.444479 19.023888 20.739159
 21.383076 20.471914 20.645617 23.973505 19.428747 23.017189 16.706495
 17.106873 18.034575 17.437452 20.014248 22.101868 20.90047  19.428732
 17.52326  21.429169 20.739159 20.739006 20.940142 19.570871 21.123
 21.923939 22.485756 22.485754 21.92453  21.924772 21.924757 22.235312
 22.088396 21.924358 21.924734 22.552794 21.924723 21.553152 19.37257
 21.372099 22.500288 18.955458 21.399408 21.19398  22.188538 20.108303
 20.654703 22.485756 19.175968 16.597359 21.5664   22.23531  21.68241
 21.682383 22.608757 21.399412 21.920563 21.98548  21.92471  22.235315
 20.017042 20.53581  21.566685 21.566559 21.780682 20.026217 21.566683
 22.188673 22.485746 21.94355  22.485748 23.169212 21.645868 20.670462
 21.920784 20.960865 21.075478 21.46467  20.13514  20.940115 21.924314
 21.924788 21.4292   21.429152 20.960882 21.924652 21.566698 22.485329
 22.485655 23.906973 21.02555  17.731548 20.962849 21.179943 20.662678
 20.96283  20.878195 16.669497 21.807312 22.742403 20.901491 20.788425
 21.657736 21.924768 22.485756 16.684849 19.913874 21.635725 17.785788
 21.203848 19.369621 17.282848 22.403378 21.92423  22.502392 21.203846
 21.732605 21.732601 22.931192 22.931517 22.931864 22.930016 22.477055
 22.763998 20.389103 22.430473 22.931444 22.47887  21.471272 21.732464
 22.343939 19.695824 21.732601 16.737148 22.93166  21.732607 22.478365
 22.931429 22.931622 20.90553  20.481203 22.93189  20.873964 21.396763
 20.40147  20.388676 21.396517 20.286276 18.091679 21.78876  20.389103
 23.157433 18.033339 22.14423  22.629156 19.995077 22.930643 21.413935
 22.931915 22.931501 20.3891   21.414217 22.14423  21.992178 21.992022
 23.60055  23.65925  23.6592   23.659204 17.483917 22.453362 22.455048
 22.455006 20.876091 21.938503 21.992167 20.876095 23.100925 21.992174
 21.99239  20.476667 20.286345 23.047039 20.28633  20.286386 20.476664
 20.28639  19.18481  20.47597  20.476583 21.515205 21.831486 17.808277
 21.831541 21.515205 20.285143 20.476343 17.808172 22.454998 20.285051
 20.286388 20.286386 21.992119 20.875938 23.04704  18.35718  21.396778
 20.875526 18.058666 22.116957 21.99217  17.808302 22.654633 21.831545
 20.286327 21.992184 20.874874 21.396717 20.876091 20.476498 20.87546
 25.748648 23.100916 20.876095 20.875946 21.593111 20.875942 21.513262
 22.116957 22.654633 23.100828 20.834576 23.394466 21.992168 22.65463 ]
2025-06-02 15:59:32,998 - DEBUG - Edge reconstruction errors: [1.0499812  1.041663   1.3420075  ... 0.03900351 0.0374793  1.1376554 ]
2025-06-02 15:59:33,003 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155933_update_18.json
2025-06-02 15:59:33,003 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:33,007 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155933_update_18.pth and as latest_checkpoint.pth
2025-06-02 15:59:33,007 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869635.dot): 0.5000
2025-06-02 15:59:33,007 - WARNING - Detected 7 anomalous nodes (reconstruction-based):
2025-06-02 15:59:33,007 - WARNING -   Node ID: 192.168.27.10, Recon Error: 31.5637, MLP Score: 0.0343
2025-06-02 15:59:33,007 - WARNING -   Node ID: ff02::2, Recon Error: 33.3448, MLP Score: 0.0018
2025-06-02 15:59:33,007 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 37.3709, MLP Score: 0.0018
2025-06-02 15:59:33,007 - WARNING -   Node ID: 192.168.209.130, Recon Error: 27.4898, MLP Score: 0.0073
2025-06-02 15:59:33,007 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 32.0580, MLP Score: 0.0021
2025-06-02 15:59:33,007 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:33,007 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 16.3992, MLP Score: 0.9742
2025-06-02 15:59:33,007 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 10.8299, MLP Score: 0.6442
2025-06-02 15:59:33,008 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.4091, MLP Score: 0.1880
2025-06-02 15:59:33,008 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.3243, MLP Score: 0.0698
2025-06-02 15:59:33,008 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0476, MLP Score: 0.1406
2025-06-02 15:59:33,008 - INFO - 
--- Processing file: nw_graph_encoded_1748869665.dot (Timestamp: 2025-06-02 15:07:45) ---
2025-06-02 15:59:33,008 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:59:33,008 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:59:33,025 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:59:33,041 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:59:33,042 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:59:33,042 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869665.dot
2025-06-02 15:59:33,057 - INFO - Parsed 547 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:59:33,072 - INFO - Parsed 1118 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869665.dot'.
2025-06-02 15:59:33,073 - INFO - Processing node updates/additions.
2025-06-02 15:59:33,077 - INFO - Processing edge updates/additions.
2025-06-02 15:59:33,084 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:33,085 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:33,085 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:33,086 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:33,092 - DEBUG - Initial node features tensor shape: torch.Size([547, 30])
2025-06-02 15:59:33,096 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:33,097 - DEBUG - Node features tensor shape after scaling: torch.Size([547, 30])
2025-06-02 15:59:33,098 - DEBUG - Edge index tensor shape: torch.Size([2, 1118])
2025-06-02 15:59:33,099 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:33,103 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:33,104 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:33,105 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:33,106 - DEBUG - Shape of encoded categorical edge features: torch.Size([1118, 3])
2025-06-02 15:59:33,107 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:33,107 - DEBUG - Shape of scaled numerical edge features: torch.Size([1118, 7])
2025-06-02 15:59:33,107 - DEBUG - Final edge attributes tensor shape: torch.Size([1118, 10])
2025-06-02 15:59:33,107 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:33,109 - INFO - Performing online update...
2025-06-02 15:59:33,109 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:33,110 - DEBUG - Updated RunningStats: new_mean=0.9394032845836933, new_var=10200000000160.22, new_n=1050
2025-06-02 15:59:33,110 - DEBUG - Updated RunningStats: new_mean=0.9337921956015183, new_var=10500000000018.914, new_n=1080
2025-06-02 15:59:33,110 - DEBUG - Updated RunningStats: new_mean=1.0056465925465958, new_var=3400000000049.4365, new_n=350
2025-06-02 15:59:33,110 - DEBUG - Updated RunningStats: new_mean=1.006958950143122, new_var=3500000000001.0415, new_n=360
2025-06-02 15:59:33,110 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:33,110 - DEBUG - Online update step: 1/50
2025-06-02 15:59:33,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,110 - DEBUG - Online update step: 2/50
2025-06-02 15:59:33,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,110 - DEBUG - Online update step: 3/50
2025-06-02 15:59:33,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,110 - DEBUG - Online update step: 4/50
2025-06-02 15:59:33,110 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,110 - DEBUG - Online update step: 5/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 6/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 7/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 8/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 9/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 10/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 11/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 12/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 13/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 14/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 15/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 16/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 17/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 18/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 19/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 20/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,111 - DEBUG - Online update step: 21/50
2025-06-02 15:59:33,111 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 22/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 23/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 24/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 25/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 26/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 27/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 28/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 29/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 30/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 31/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 32/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 33/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 34/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 35/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 36/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 37/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 38/50
2025-06-02 15:59:33,112 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,112 - DEBUG - Online update step: 39/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 40/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 41/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 42/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 43/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 44/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 45/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 46/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 47/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 48/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 49/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - DEBUG - Online update step: 50/50
2025-06-02 15:59:33,113 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,113 - WARNING - No successful steps during online update.
2025-06-02 15:59:33,114 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], current edge mean: [ 6.2075133e+00  1.4025044e+00  4.8944545e+00 -2.1325455e-09
  2.5590545e-09 -2.1325455e-09 -5.9711271e-09 -1.7060363e-09
  8.5301816e-10 -3.4120726e-09]
2025-06-02 15:59:33,114 - DEBUG - Node drift difference: 0.0277, Edge drift difference: 0.0219
2025-06-02 15:59:33,115 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7073502e-08 -9.5890469e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.3947705e-08
  2.2665020e-08  4.3586578e-08 -1.7761531e-08  2.0485691e-08
  2.4442413e+00  2.9524679e+00  1.2065814e-01  4.3254113e+00
 -4.3586578e-08  3.3436928e+00  5.6709323e+00  7.6106033e+00
  1.2065814e-01  8.0000000e+00 -1.7434632e-08  2.7895410e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.1793289e-08  6.7995060e-08], edge=[ 6.2075133e+00  1.4025044e+00  4.8944545e+00 -2.1325455e-09
  2.5590545e-09 -2.1325455e-09 -5.9711271e-09 -1.7060363e-09
  8.5301816e-10 -3.4120726e-09]
2025-06-02 15:59:33,115 - DEBUG - Updated reference std: node=[0.         0.         1.0009154  1.0009153  0.         0.
 0.         1.0009153  1.0009153  1.0009153  1.0009153  1.0009153
 1.0682304  0.30491748 0.34246618 0.56139016 1.0009153  3.063846
 2.9354372  1.4923851  0.34246618 0.         1.0009153  1.0009153
 0.         0.         0.         0.         1.0009153  1.0009153 ], edge=[1.1447818  0.49966237 1.8813379  1.0004475  1.0004475  1.0004475
 1.0004475  1.0004475  1.0004475  1.0004475 ]
2025-06-02 15:59:33,115 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:33,115 - INFO - Running anomaly detection...
2025-06-02 15:59:33,115 - INFO - Starting anomaly detection.
2025-06-02 15:59:33,122 - DEBUG - Node reconstruction errors: [23.509956 23.331102 26.51597  20.899181 15.985017 20.133394 24.697472
 18.543892 18.543919 19.97505  18.543873 18.764812 32.52814  18.6131
 20.034464 19.05855  19.615139 19.044964 21.749306 19.083496 18.540468
 20.034458 18.932222 18.24621  19.938541 19.885296 19.943398 17.39072
 18.591097 19.943388 19.147848 20.04782  17.76237  20.842554 19.789034
 22.663063 20.865763 19.083775 17.68698  17.406244 22.558805 20.151258
 19.083773 22.913279 21.013775 19.13733  23.820631 17.671095 18.713017
 33.596954 37.915276 20.601696 19.999311 22.303804 18.338446 17.358736
 28.15262  19.388937 21.348112 21.174042 16.741957 23.04165  20.346712
 18.494198 19.757954 18.338446 18.71207  18.338446 20.34719  20.347187
 18.557884 20.183714 18.945454 19.956072 21.596714 20.024567 23.113873
 20.609499 20.708372 20.116804 21.358166 20.570833 15.642617 23.868868
 19.197147 17.372967 20.707674 20.706295 20.331934 22.398886 19.892082
 16.807821 18.458652 20.643425 19.672535 32.593628 21.7868   21.520622
 21.011549 18.707119 20.599926 21.786812 22.796562 21.376373 17.128956
 19.077974 20.363823 16.505083 17.879793 28.543915 20.53792  21.464537
 16.0145   17.354277 20.39756  20.773663 20.574522 16.626127 20.262129
 19.46186  20.318659 18.458652 16.571085 18.701202 20.503698 20.957163
 17.613981 16.930965 20.599918 22.314684 21.555035 19.224003 19.224682
 17.741087 20.773762 18.96923  24.05476  20.936848 16.7475   16.243702
 19.356066 21.992641 20.463432 19.524595 19.224026 20.41209  20.574518
 19.08048  20.018913 20.45992  25.349789 17.56854  21.120934 19.223999
 20.372705 16.528214 19.461815 21.19458  20.599932 22.583937 19.077847
 17.57629  19.461824 21.55462  20.771486 16.222443 21.421726 20.925224
 16.85466  20.459805 20.302338 19.63344  20.166256 31.525429 20.895943
 19.401903 20.459908 20.975092 20.980822 20.980822 19.549444 18.303837
 20.043776 16.62097  16.85542  20.775768 20.937815 20.94608  19.408894
 19.925144 21.17606  21.084665 21.033688 19.22979  16.748209 21.425495
 18.252974 20.635847 16.39579  22.121675 20.999706 19.461548 17.085018
 20.473415 20.926947 18.458654 21.127337 17.608425 21.127348 21.311031
 21.189981 20.77579  21.03382  21.112226 20.775791 20.74778  20.775793
 20.574522 21.326565 19.229815 17.740095 20.937706 20.52217  21.03382
 19.46187  21.101805 16.622149 19.177301 20.683119 20.666466 18.088884
 21.394209 20.695398 20.574516 20.574522 21.4304   21.026527 20.522175
 19.46174  21.86505  16.806917 21.44378  19.426046 20.45996  19.526176
 20.773748 21.394215 21.19663  19.426046 19.511805 20.166243 20.279911
 21.326582 20.680977 20.773748 20.800653 19.931744 21.772738 20.637905
 20.980825 22.010134 18.390255 21.163342 19.931786 20.68313  20.160099
 21.788578 21.163342 21.788536 20.980808 17.255896 17.02254  21.654459
 21.772215 21.824005 20.980822 20.702227 21.68813  19.54935  21.435843
 21.669847 20.56089  20.88377  23.890951 19.526215 22.938974 16.898228
 17.993769 18.303839 18.138325 22.609211 22.649803 20.82524  19.526201
 17.761162 21.333282 21.135567 20.980715 21.43053  19.663532 21.333818
 21.78823  22.286798 22.286795 21.788662 21.788813 21.788801 22.059
 21.937763 21.788515 21.788794 21.863926 21.788782 21.59417  19.545801
 21.405449 22.744598 19.168507 21.457775 21.430305 22.015192 20.091225
 20.882399 22.286797 19.254667 16.805767 21.445103 22.059002 21.523571
 21.52355  22.485239 21.457777 21.786182 21.824001 21.788774 22.059004
 20.251137 20.637941 21.44529  21.44519  21.68758  20.121822 21.445286
 22.015356 22.217861 21.788544 22.286787 23.070868 21.5118   20.891092
 21.785902 21.408327 18.07789  21.668612 20.224308 19.931732 22.122898
 21.788824 21.333302 21.333271 21.189981 21.788725 21.445295 22.286339
 22.286674 24.4151   21.082462 17.187386 21.199776 21.43577  21.512989
 21.199759 21.10574  17.08369  21.664804 22.554213 20.96662  20.669617
 21.608053 21.788809 22.286798 16.927715 19.971027 21.866753 18.019268
 21.422367 19.446371 17.536255 22.23691  21.78847  22.740831 21.422365
 21.923946 21.923944 22.720642 22.720955 22.721275 23.151945 22.3088
 22.990551 20.428982 22.645176 22.720879 22.309881 22.205746 21.923828
 22.159092 19.769348 21.923946 16.96612  22.72108  21.923946 22.309572
 22.720861 22.721048 20.926569 20.54967  22.721296 20.940897 21.432121
 20.42779  20.428625 21.431934 20.320124 17.570776 21.823174 20.607195
 22.895254 18.25562  22.16024  22.420738 20.04663  22.720121 21.897074
 22.72132  22.720928 20.42898  21.6319   18.282373 21.98859  21.988525
 21.76077  23.642206 23.642178 23.642178 17.68167  22.429691 22.431028
 22.431038 20.877157 22.10087  21.988588 20.87716  22.894474 21.988592
 21.97777  20.495075 20.32019  23.065178 20.32017  20.320225 20.495068
 20.32023  29.20635  20.494476 20.495003 21.555614 21.84474  18.044817
 21.844793 21.55561  20.318962 20.494753 18.044714 22.43103  20.318853
 20.320232 20.320225 21.988567 20.876923 23.24764  18.56333  21.432127
 20.876743 18.27986  22.124767 21.98859  18.044836 22.646917 21.844793
 20.320173 21.988598 20.876186 21.432093 20.877161 20.49493  20.876518
 25.84954  22.894463 20.877115 20.877052 21.618416 20.877047 21.54238
 22.124775 22.646917 22.894049 20.833202 23.363842 21.988586 22.646915
 22.89446  21.76341  21.98834  22.89444  21.988558 22.894468 22.894457
 21.988594 21.76353  22.894243 23.418827 22.894463 22.431044 22.124714
 21.988514 21.763523 18.601915 22.894234 22.10087  21.98859  22.894459
 22.894426 20.877157 20.87641  22.394018 21.737017 20.877153 22.894371
 22.39401  22.89432  22.394016 21.985504 22.894135 21.763384 21.76317
 22.894398]
2025-06-02 15:59:33,122 - DEBUG - Edge reconstruction errors: [1.051244   1.0444856  1.3446734  ... 0.04186289 0.04047434 1.1408093 ]
2025-06-02 15:59:33,125 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155933_update_19.json
2025-06-02 15:59:33,125 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:33,128 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155933_update_19.pth and as latest_checkpoint.pth
2025-06-02 15:59:33,129 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869665.dot): 0.5071
2025-06-02 15:59:33,129 - WARNING - Detected 9 anomalous nodes (reconstruction-based):
2025-06-02 15:59:33,129 - WARNING -   Node ID: 192.168.27.13, Recon Error: 26.5160, MLP Score: 0.0238
2025-06-02 15:59:33,129 - WARNING -   Node ID: 192.168.27.10, Recon Error: 32.5281, MLP Score: 0.0402
2025-06-02 15:59:33,129 - WARNING -   Node ID: ff02::2, Recon Error: 33.5970, MLP Score: 0.0017
2025-06-02 15:59:33,129 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 37.9153, MLP Score: 0.0017
2025-06-02 15:59:33,129 - WARNING -   Node ID: 192.168.209.130, Recon Error: 28.1526, MLP Score: 0.0068
2025-06-02 15:59:33,129 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:33,129 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 17.1331, MLP Score: 0.9883
2025-06-02 15:59:33,129 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 12.6572, MLP Score: 0.8518
2025-06-02 15:59:33,129 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.7142, MLP Score: 0.1301
2025-06-02 15:59:33,129 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 3.7822, MLP Score: 0.0562
2025-06-02 15:59:33,130 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.8732, MLP Score: 0.1088
2025-06-02 15:59:33,130 - INFO - 
--- Processing file: nw_graph_encoded_1748869695.dot (Timestamp: 2025-06-02 15:08:15) ---
2025-06-02 15:59:33,130 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:59:33,130 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:59:33,148 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:59:33,166 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:59:33,166 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:59:33,166 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869695.dot
2025-06-02 15:59:33,182 - INFO - Parsed 640 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:59:33,199 - INFO - Parsed 1300 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869695.dot'.
2025-06-02 15:59:33,199 - INFO - Processing node updates/additions.
2025-06-02 15:59:33,204 - INFO - Processing edge updates/additions.
2025-06-02 15:59:33,214 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:33,215 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:33,215 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:33,216 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:33,225 - DEBUG - Initial node features tensor shape: torch.Size([640, 30])
2025-06-02 15:59:33,227 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:33,227 - DEBUG - Node features tensor shape after scaling: torch.Size([640, 30])
2025-06-02 15:59:33,228 - DEBUG - Edge index tensor shape: torch.Size([2, 1300])
2025-06-02 15:59:33,229 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:33,233 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:33,234 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:33,235 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:33,237 - DEBUG - Shape of encoded categorical edge features: torch.Size([1300, 3])
2025-06-02 15:59:33,238 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:33,238 - DEBUG - Shape of scaled numerical edge features: torch.Size([1300, 7])
2025-06-02 15:59:33,238 - DEBUG - Final edge attributes tensor shape: torch.Size([1300, 10])
2025-06-02 15:59:33,238 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:33,241 - INFO - Performing online update...
2025-06-02 15:59:33,242 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:33,242 - DEBUG - Updated RunningStats: new_mean=0.9398242755673138, new_var=10800000000161.262, new_n=1110
2025-06-02 15:59:33,243 - DEBUG - Updated RunningStats: new_mean=0.9344638998201199, new_var=11100000000018.777, new_n=1140
2025-06-02 15:59:33,243 - DEBUG - Updated RunningStats: new_mean=1.0136294985506853, new_var=3600000000049.563, new_n=370
2025-06-02 15:59:33,243 - DEBUG - Updated RunningStats: new_mean=1.0143631995081772, new_var=3700000000000.9355, new_n=380
2025-06-02 15:59:33,243 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:33,243 - DEBUG - Online update step: 1/50
2025-06-02 15:59:33,243 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,243 - DEBUG - Online update step: 2/50
2025-06-02 15:59:33,243 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,243 - DEBUG - Online update step: 3/50
2025-06-02 15:59:33,243 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 4/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 5/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 6/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 7/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 8/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 9/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 10/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 11/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 12/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 13/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 14/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 15/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 16/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 17/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 18/50
2025-06-02 15:59:33,244 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,244 - DEBUG - Online update step: 19/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 20/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 21/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 22/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 23/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 24/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 25/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 26/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 27/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 28/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 29/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 30/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 31/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 32/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 33/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,245 - DEBUG - Online update step: 34/50
2025-06-02 15:59:33,245 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 35/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 36/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 37/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 38/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 39/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 40/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 41/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 42/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 43/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 44/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 45/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 46/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 47/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 48/50
2025-06-02 15:59:33,246 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,246 - DEBUG - Online update step: 49/50
2025-06-02 15:59:33,247 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,247 - DEBUG - Online update step: 50/50
2025-06-02 15:59:33,247 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,247 - WARNING - No successful steps during online update.
2025-06-02 15:59:33,247 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], current edge mean: [ 6.1853848e+00  1.4076923e+00  4.9446154e+00 -8.0695521e-09
 -1.4671913e-09  0.0000000e+00  1.4671913e-09 -1.4671913e-09
 -4.4015738e-09 -1.4671913e-09]
2025-06-02 15:59:33,248 - DEBUG - Node drift difference: 0.1134, Edge drift difference: 0.0267
2025-06-02 15:59:33,249 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -8.9406971e-09 -2.9802323e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.7136335e-08
  4.4703484e-08  5.9604646e-09 -2.9802323e-09  2.9802323e-09
  2.3671875e+00  2.9562500e+00  1.2968750e-01  4.3890624e+00
 -5.9604646e-09  3.3890624e+00  5.7390623e+00  7.6093750e+00
  1.2968750e-01  8.0000000e+00  2.9057265e-08 -3.3527612e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.2154064e-08  2.9802322e-08], edge=[ 6.1853848e+00  1.4076923e+00  4.9446154e+00 -8.0695521e-09
 -1.4671913e-09  0.0000000e+00  1.4671913e-09 -1.4671913e-09
 -4.4015738e-09 -1.4671913e-09]
2025-06-02 15:59:33,249 - DEBUG - Updated reference std: node=[0.         0.         1.0007821  1.0007823  0.         0.
 0.         1.0007821  1.0007821  1.0007821  1.0007821  1.0007821
 1.0366606  0.29277956 0.3543513  0.5707029  1.0007821  3.053545
 2.915992   1.4961315  0.3543513  0.         1.0007821  1.0007821
 0.         0.         0.         0.         1.0007821  1.0007821 ], edge=[1.0811287  0.50090224 1.8303767  1.0003848  1.0003848  1.0003848
 1.0003848  1.0003848  1.0003848  1.0003848 ]
2025-06-02 15:59:33,249 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:33,249 - INFO - Running anomaly detection...
2025-06-02 15:59:33,249 - INFO - Starting anomaly detection.
2025-06-02 15:59:33,282 - DEBUG - Node reconstruction errors: [24.019142 21.9033   28.438028 21.122738 16.386845 20.775698 26.572046
 18.87215  18.872168 20.345997 18.872133 19.400862 35.326965 19.158154
 20.328894 19.313457 20.217012 19.304386 22.399797 19.356823 18.873592
 20.32889  19.400564 18.818748 20.241123 20.152662 20.24481  17.964533
 18.924446 20.244802 19.911524 20.418896 18.307835 21.085928 20.072548
 20.826443 22.07456  19.357038 18.245329 17.85186  22.865274 20.441027
 19.357038 23.141573 21.321466 19.588531 24.043669 18.568895 19.042133
 34.08836  39.08363  20.950235 20.25396  22.922058 18.559801 17.713762
 29.527193 19.655306 21.815458 21.665257 17.194193 21.241901 20.617254
 19.058119 19.974459 18.559803 18.910135 18.559795 20.617603 20.617596
 18.764595 20.60918  19.135944 20.363333 22.120855 20.4635   23.363874
 21.00724  21.04952  20.510403 21.549168 20.99196  15.964148 24.337477
 19.344828 17.73443  21.104504 21.060577 20.729475 22.82751  20.08735
 17.399559 18.779497 21.014797 19.89141  33.73862  21.923801 21.872768
 21.19324  18.866821 20.9869   21.923811 22.888414 21.744137 17.488977
 19.23954  20.61854  16.996014 18.278526 28.93667  20.817095 21.631409
 16.418959 17.906816 20.836016 21.173573 20.99716  16.929237 20.672617
 20.283392 20.461033 18.779505 16.920279 18.862373 21.407558 20.283308
 17.924082 17.26995  22.129112 22.347467 21.801517 19.403364 19.341393
 18.090645 21.173615 19.095276 24.17597  21.132837 17.120722 16.5931
 19.515814 22.34032  20.574505 19.655079 19.403383 20.852    20.99716
 19.28996  20.240902 20.848993 25.553776 18.123545 21.693775 19.403362
 20.75309  16.895624 19.604445 21.549076 20.9869   22.728643 19.287899
 17.96816  19.604458 21.80116  21.140947 16.567827 22.012346 21.236956
 17.224806 21.057035 20.67885  19.754683 20.335163 32.599464 21.476738
 19.587069 21.501184 21.35438  21.330038 21.330034 19.629639 18.643654
 20.126768 16.967926 17.136906 21.177185 20.968605 21.32158  19.476826
 20.021149 21.557957 21.40906  21.169508 19.409918 17.12146  21.482323
 17.928278 20.702702 16.719347 22.19342  21.157017 19.604235 17.478071
 20.83271  21.330996 18.779503 21.38165  17.882942 21.290316 21.868126
 21.517366 21.177195 21.169605 21.976013 21.177193 20.819353 22.256659
 20.99716  21.701313 19.409939 18.215672 20.968523 20.654089 21.169605
 19.604492 21.422556 17.200031 19.368517 21.022089 20.794138 18.451002
 21.880983 21.297602 20.99716  20.99716  21.486107 21.384949 20.654093
 19.60439  21.989521 17.166815 21.880148 19.591848 20.849026 19.674932
 21.522114 21.728039 21.789919 19.591848 19.625484 20.33515  20.426672
 21.701326 21.018852 21.173609 21.229092 20.026423 21.865458 20.746471
 21.330036 22.771788 18.716963 21.22891  20.026451 21.022099 20.344112
 22.339212 22.858377 22.339193 21.330027 17.509687 17.32709  22.046412
 22.049349 22.38199  21.330034 20.776615 22.0301   19.62957  21.73701
 18.407091 20.650692 21.258266 24.051695 20.557407 23.12134  18.010756
 18.321491 18.643654 18.440683 20.554693 22.651348 21.009912 19.674957
 18.05491  21.48519  21.42696  21.33     21.486206 19.75378  21.887241
 21.89517  22.80373  22.80373  21.89561  21.895771 21.895758 22.596638
 22.023172 21.89546  21.89575  22.52362  21.895735 21.646017 20.020525
 21.72285  23.116306 19.4093   21.538086 21.486032 22.545345 20.330252
 21.214087 22.803732 19.643248 17.132067 21.58275  22.596638 22.063845
 22.063831 23.050959 21.971462 21.89305  22.381992 21.895727 22.596632
 20.838673 20.746498 21.582945 21.582844 21.79533  20.22204  21.582943
 22.54545  22.586891 22.339184 22.803724 23.221022 22.061197 21.208427
 21.892754 21.97533  19.00955  22.519972 20.302334 20.026411 22.36974
 21.895784 21.485205 21.485172 21.517366 21.308664 20.76795  22.619415
 22.803661 25.340334 21.12611  17.927233 21.55233  22.004128 21.880175
 21.442701 22.373423 17.602758 22.101019 23.080671 21.011051 20.833345
 22.014061 21.895765 22.80373  17.28424  20.36478  22.214197 18.364288
 21.726566 19.519823 17.854286 22.763763 21.89541  23.104483 21.726562
 22.175205 22.175207 23.204931 23.205158 23.205395 23.418379 22.357098
 23.28327  20.478914 22.953001 23.205105 22.35836  22.487345 22.17512
 22.650673 19.869953 22.175203 17.292439 23.205254 22.175203 22.358004
 23.205095 23.205233 20.899744 20.599188 23.205416 21.019188 21.74331
 20.448637 20.478626 22.22278  20.366665 17.812382 21.809032 20.62908
 23.153316 18.557947 22.113424 22.888788 20.068682 23.204552 22.205418
 23.205427 23.205147 20.478914 21.843157 18.439106 22.606098 22.075373
 21.798958 23.55965  23.55962  23.559626 17.949402 23.433247 22.390259
 22.390266 20.830833 22.306458 21.905958 20.830835 22.88347  21.905958
 21.953672 20.500134 20.670109 23.053068 22.222795 21.97958  20.500132
 20.366743 19.980654 20.669537 20.500082 21.557789 22.22279  18.388594
 21.875364 21.557787 21.979488 21.90441  17.856047 22.361803 22.222317
 21.979586 21.979582 22.07566  20.830635 23.20918  18.544416 21.433338
 20.830482 17.63095  22.046947 21.905956 18.837801 22.530447 23.19134
 22.222792 22.075705 22.143215 21.433306 22.461405 20.668756 22.461346
 26.267632 22.88346  20.830797 20.830744 21.742922 20.83074  21.51795
 22.04695  22.530447 23.082527 22.081474 23.304403 21.905956 22.530445
 21.997612 21.997766 21.905684 23.81549  21.905924 23.066816 22.883453
 21.905958 22.430656 22.883226 21.801119 23.083504 22.390278 22.046917
 21.905872 23.628668 18.817772 22.883219 22.306458 21.905956 22.883455
 22.883419 20.830833 22.461346 22.612732 21.77113  22.143372 22.883364
 22.612724 22.883307 22.612728 22.63203  22.883116 21.996843 21.996387
 21.994425 23.465433 21.203083 23.465504 23.465359 23.465448 23.46552
 23.465479 23.46544  23.465464 23.465519 22.378815 23.070557 23.465305
 23.465527 23.465471 23.465513 23.46546  23.465532 23.465433 23.465473
 23.465534 23.465502 23.464611 23.465536 23.465498 23.465454 21.905956
 24.728598 22.883457 25.211895 22.655935 29.58843  29.58843  22.089672
 25.211895 22.883398 23.083586 23.083378 22.883448 23.0823   22.883434
 22.882915 23.465542 21.801765 22.883455 21.996975 22.88346  22.883368
 23.080309 22.883432 23.08359  22.883457 22.883404 23.083557 23.083519
 22.88339  23.082037 22.883385 22.883461 22.883446 23.383411 22.414991
 22.414991 23.465534 21.636435 24.319834 22.883383 23.08257  23.465525
 23.46458  23.083591 22.595339 22.882097 22.88346  22.883457 22.427149
 23.930063 22.414991 22.88319  23.465515 23.08122  23.083406 20.780201
 23.465527 23.080814 22.882885 23.465479 23.463919 23.465536 22.883442
 22.883429 21.56055  22.41499 ]
2025-06-02 15:59:33,282 - DEBUG - Edge reconstruction errors: [1.0521773  1.0491056  0.6447426  ... 0.04264591 0.04142938 1.1418383 ]
2025-06-02 15:59:33,284 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155933_update_20.json
2025-06-02 15:59:33,285 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:33,288 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155933_update_20.pth and as latest_checkpoint.pth
2025-06-02 15:59:33,288 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869695.dot): 0.5312
2025-06-02 15:59:33,288 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:59:33,289 - WARNING -   Node ID: 192.168.27.13, Recon Error: 28.4380, MLP Score: 0.0239
2025-06-02 15:59:33,289 - WARNING -   Node ID: 192.168.27.10, Recon Error: 35.3270, MLP Score: 0.0389
2025-06-02 15:59:33,289 - WARNING -   Node ID: ff02::2, Recon Error: 34.0884, MLP Score: 0.0015
2025-06-02 15:59:33,289 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 39.0836, MLP Score: 0.0014
2025-06-02 15:59:33,289 - WARNING -   Node ID: 192.168.209.130, Recon Error: 29.5272, MLP Score: 0.0060
2025-06-02 15:59:33,289 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:33,289 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.1654, MLP Score: 0.9921
2025-06-02 15:59:33,289 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 13.8358, MLP Score: 0.9041
2025-06-02 15:59:33,289 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.1248, MLP Score: 0.1168
2025-06-02 15:59:33,289 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.0553, MLP Score: 0.0459
2025-06-02 15:59:33,289 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0404, MLP Score: 0.0941
2025-06-02 15:59:33,289 - INFO - 
--- Processing file: nw_graph_encoded_1748869725.dot (Timestamp: 2025-06-02 15:08:45) ---
2025-06-02 15:59:33,289 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:59:33,289 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:59:33,309 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:59:33,328 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:59:33,328 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:59:33,328 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869725.dot
2025-06-02 15:59:33,344 - INFO - Parsed 653 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:59:33,362 - INFO - Parsed 1355 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869725.dot'.
2025-06-02 15:59:33,362 - INFO - Processing node updates/additions.
2025-06-02 15:59:33,366 - INFO - Processing edge updates/additions.
2025-06-02 15:59:33,375 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:33,375 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:33,376 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:33,377 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:33,385 - DEBUG - Initial node features tensor shape: torch.Size([653, 30])
2025-06-02 15:59:33,387 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:33,388 - DEBUG - Node features tensor shape after scaling: torch.Size([653, 30])
2025-06-02 15:59:33,389 - DEBUG - Edge index tensor shape: torch.Size([2, 1355])
2025-06-02 15:59:33,391 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:33,395 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:33,397 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:33,398 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:33,400 - DEBUG - Shape of encoded categorical edge features: torch.Size([1355, 3])
2025-06-02 15:59:33,401 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:33,401 - DEBUG - Shape of scaled numerical edge features: torch.Size([1355, 7])
2025-06-02 15:59:33,401 - DEBUG - Final edge attributes tensor shape: torch.Size([1355, 10])
2025-06-02 15:59:33,402 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:33,404 - INFO - Performing online update...
2025-06-02 15:59:33,405 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:33,406 - DEBUG - Updated RunningStats: new_mean=0.9401717470158093, new_var=11400000000160.668, new_n=1170
2025-06-02 15:59:33,406 - DEBUG - Updated RunningStats: new_mean=0.935138272560361, new_var=11700000000019.045, new_n=1200
2025-06-02 15:59:33,406 - DEBUG - Updated RunningStats: new_mean=1.0205064076874752, new_var=3800000000049.4624, new_n=390
2025-06-02 15:59:33,406 - DEBUG - Updated RunningStats: new_mean=1.0209899872766681, new_var=3900000000000.9087, new_n=400
2025-06-02 15:59:33,406 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:33,407 - DEBUG - Online update step: 1/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 2/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 3/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 4/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 5/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 6/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 7/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 8/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 9/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 10/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 11/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 12/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 13/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,407 - DEBUG - Online update step: 14/50
2025-06-02 15:59:33,407 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 15/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 16/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 17/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 18/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 19/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 20/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 21/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 22/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 23/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 24/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 25/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 26/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 27/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 28/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,408 - DEBUG - Online update step: 29/50
2025-06-02 15:59:33,408 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 30/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 31/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 32/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 33/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 34/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 35/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 36/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 37/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 38/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 39/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 40/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 41/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 42/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 43/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 44/50
2025-06-02 15:59:33,409 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,409 - DEBUG - Online update step: 45/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - DEBUG - Online update step: 46/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - DEBUG - Online update step: 47/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - DEBUG - Online update step: 48/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - DEBUG - Online update step: 49/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - DEBUG - Online update step: 50/50
2025-06-02 15:59:33,410 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:33,410 - WARNING - No successful steps during online update.
2025-06-02 15:59:33,411 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], current edge mean: [ 6.1793356e+00  1.4169742e+00  4.9431734e+00 -1.0557281e-09
  3.5190934e-10  3.5190935e-09  2.1114561e-09 -2.1114561e-09
  7.0381867e-10 -8.0939149e-09]
2025-06-02 15:59:33,411 - DEBUG - Node drift difference: 0.0281, Edge drift difference: 0.0185
2025-06-02 15:59:33,412 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4827662e-08 -3.1399690e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.0223155e-08
  4.5273971e-08  5.8418030e-09  6.2069154e-09 -2.8478789e-08
  2.3614089e+00  2.9571209e+00  1.3935682e-01  4.3767228e+00
 -5.8418030e-09  3.4747319e+00  5.6738133e+00  7.5895867e+00
  1.3935682e-01  8.0000000e+00  2.5557888e-08  3.6511267e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.8843901e-08 -4.3813522e-08], edge=[ 6.1793356e+00  1.4169742e+00  4.9431734e+00 -1.0557281e-09
  3.5190934e-10  3.5190935e-09  2.1114561e-09 -2.1114561e-09
  7.0381867e-10 -8.0939149e-09]
2025-06-02 15:59:33,413 - DEBUG - Updated reference std: node=[0.         0.         1.0007665  1.0007666  0.         0.
 0.         1.0007665  1.0007665  1.0007665  1.0007665  1.0007666
 1.0142448  0.28991058 0.3638549  0.56661487 1.0007665  3.0958197
 2.9316137  1.5298709  0.3638549  0.         1.0007666  1.0007666
 0.         0.         0.         0.         1.0007666  1.0007665 ], edge=[1.0690424  0.50653744 1.8203317  1.0003692  1.0003692  1.0003692
 1.0003692  1.0003692  1.0003692  1.0003692 ]
2025-06-02 15:59:33,413 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:33,413 - INFO - Running anomaly detection...
2025-06-02 15:59:33,413 - INFO - Starting anomaly detection.
2025-06-02 15:59:33,514 - DEBUG - Node reconstruction errors: [24.017426 21.73799  28.771772 21.18736  16.475912 20.863329 26.876993
 18.941946 18.941961 20.421713 18.941925 19.563965 35.80869  19.156738
 20.405691 19.388027 20.372343 19.379059 22.56338  19.4334   18.945833
 20.405687 19.257902 18.968994 20.320122 20.20823  20.32377  18.088781
 18.995634 20.323765 20.103275 20.496052 18.68206  21.150047 20.127462
 21.067553 22.174507 19.433613 18.566416 17.968962 22.947428 20.51842
 19.433613 23.21046  21.403904 19.649456 24.1073   18.700686 19.113926
 34.193584 39.28903  21.024454 20.310352 23.077372 18.6153   17.801785
 29.994715 19.73219  21.948198 21.796835 17.302588 21.296947 20.692041
 19.707428 20.042284 18.615305 18.959782 18.615297 20.692387 20.692385
 18.818716 20.715553 19.185028 20.46479  22.242676 20.571041 24.135895
 21.108461 21.139101 20.610466 21.608212 21.095192 16.066519 24.438295
 19.37119  17.845528 21.205605 21.152004 20.830408 22.93339  20.147959
 17.48832  18.891016 21.109724 19.955671 33.935116 21.98141  22.162354
 21.259947 18.90342  21.088348 21.981419 22.93476  22.788092 17.599955
 19.276646 20.652666 17.109806 18.396511 29.252235 21.14083  21.687778
 16.515335 18.02486  20.939062 21.267271 21.09509  17.010393 20.771156
 20.339048 20.504538 18.891022 17.012089 18.961794 21.496862 20.338827
 18.032013 17.362339 22.215975 22.389477 21.86314  19.44779  19.390797
 18.178246 21.26731  19.129145 24.229593 21.201075 17.21238  16.6794
 19.552229 22.433657 20.61465  19.68116  19.840914 20.953068 21.095089
 19.338686 20.29713  20.943573 25.624353 18.219088 21.833645 19.44779
 20.85156  18.134773 19.648293 21.641422 21.08835  22.7822   19.336617
 18.06472  19.648298 21.862785 21.23929  16.653389 22.156544 21.323574
 17.317242 21.146555 20.77734  19.79497  20.39304  32.78086  21.560844
 19.641712 21.598738 21.443205 21.42632  21.42632  19.65929  18.75936
 20.180187 17.060783 17.216274 21.270023 21.001749 21.420004 19.503017
 20.058226 21.654558 21.49687  21.211142 19.459751 17.213137 21.513103
 18.26966  20.739326 16.8031   22.24207  21.221792 19.648083 17.569391
 20.928133 21.431887 18.89102  21.435282 17.959764 21.355124 22.004955
 21.609556 21.270027 21.211245 22.062449 21.27003  20.869198 22.349636
 21.095093 21.802448 19.459766 18.319204 21.001665 20.706371 21.211245
 19.648333 21.51241  17.27441  19.4199   21.11544  20.845509 18.569147
 21.963318 21.607058 21.09509  21.095087 21.51693  21.478254 20.70638
 19.648235 22.045034 17.256613 21.993877 19.63523  20.943605 19.721169
 21.607046 21.81821  21.88035  19.635227 19.664179 20.39303  20.486567
 21.802467 21.110289 21.267305 21.331373 20.06349  21.91797  20.80132
 21.426323 22.893785 18.8309   21.277487 20.06352  21.115448 20.40163
 22.474882 22.861723 22.474863 21.426313 17.587282 17.41131  22.148445
 21.688377 22.521282 21.426321 20.827013 22.123936 19.659224 21.82433
 18.491993 20.703573 21.561928 24.116804 20.610344 23.17987  18.091131
 18.414965 18.759361 18.541725 20.607431 22.689474 21.057474 19.721188
 18.152632 21.548439 21.511553 21.426298 21.517029 19.799181 21.963629
 21.95297  22.936972 22.93697  21.953419 21.953573 21.953562 22.733778
 22.077023 21.953268 21.953552 22.62763  21.953539 21.676966 20.424107
 21.811728 23.205921 19.509838 21.573036 21.516857 22.676588 20.397257
 21.305595 22.936972 19.664507 17.221292 21.6437   22.733778 22.200045
 22.200026 23.189138 21.990143 21.950874 22.521278 21.953527 22.733788
 20.873749 20.801352 21.64389  21.643797 21.849745 20.27811  21.643892
 22.676716 22.842304 22.474852 22.936968 23.276258 22.18862  21.297724
 21.950544 22.059633 18.1542   22.601978 20.355574 20.063482 22.412022
 21.95359  21.548456 21.548426 21.609556 21.34594  20.80974  22.99127
 22.936907 25.6135   21.15848  18.765797 21.638645 22.079256 22.62744
 21.522932 22.217424 17.677803 22.209724 23.215557 21.042456 20.882324
 22.116022 21.953571 22.936972 17.373257 20.379206 22.303894 18.455713
 21.816273 19.548952 17.957523 22.8948   21.953217 23.198372 21.816267
 22.25656  22.256557 23.329872 23.330086 23.330334 23.523394 22.406464
 23.38849  20.51283  23.032469 23.330038 22.40771  22.572111 22.256477
 22.773388 19.909529 22.256556 17.37545  23.330181 22.256557 22.407356
 23.330025 23.330158 20.931494 20.641777 23.330349 21.055805 21.762518
 20.477875 20.512543 22.294779 20.386038 17.890564 21.831512 20.658842
 23.237011 18.649738 22.146236 23.009    20.09348  23.329498 22.28472
 23.33037  23.330072 20.512835 21.923586 18.500242 22.654795 22.09164
 21.832125 23.581835 23.581799 23.5818   18.02492  23.503752 22.402098
 22.402102 20.83988  22.380583 21.927217 21.006443 22.92188  21.927217
 21.969606 20.515303 20.679075 23.083836 22.294794 22.057886 20.515299
 20.38612  20.07938  20.676607 20.515247 21.599052 22.294792 18.4816
 21.898909 21.59905  22.057789 21.973742 18.108181 22.43042  22.294308
 22.05789  22.057886 22.091938 20.839687 23.236017 18.61804  21.461243
 20.839535 17.708094 22.066736 21.92722  18.920149 22.548779 18.164942
 22.294792 22.09198  22.209158 21.75907  22.529978 20.677713 22.52992
 26.39894  22.921879 20.83985  20.839794 21.76182  20.839792 21.553951
 22.066734 22.548779 23.114235 18.812653 21.006397 21.927216 22.548779
 22.02451  22.024668 21.926937 23.93138  21.927189 23.088041 23.931389
 21.927221 22.514378 23.931372 21.834217 23.115198 22.402111 22.06671
 22.52997  23.645308 18.9088   23.931347 22.380583 21.92722  22.921871
 22.921839 20.839882 22.52992  22.690197 23.601572 22.430487 22.921785
 22.690191 22.921732 22.690195 22.705797 23.931364 22.02376  22.02331
 22.012747 23.491993 21.229797 23.492054 23.491907 23.492002 23.492073
 23.492035 23.491995 23.492018 23.492071 22.401924 23.080017 23.491865
 23.492086 23.49203  23.49207  23.492018 23.49209  23.491987 23.49203
 23.492088 23.492054 23.49116  23.492092 24.206133 23.492012 21.927217
 24.702581 22.921873 25.182247 22.725483 29.568962 29.568962 22.166683
 25.182247 22.921816 23.115286 23.114511 22.92187  23.114004 22.92185
 22.653837 23.492098 21.834848 22.921871 22.0239   22.921875 22.921787
 23.112017 22.921852 23.11529  22.921875 22.92182  23.115246 23.115215
 22.921812 23.113735 22.921804 22.921875 22.921864 23.757261 22.490894
 22.490889 23.49209  21.676239 24.294088 22.9218   23.11427  23.492086
 23.491133 23.11529  22.662573 22.920591 22.921877 22.921873 22.437834
 24.032127 22.490894 22.92162  24.206135 23.11294  23.115107 20.906431
 23.492086 23.112518 23.931349 23.492031 23.48954  23.49209  22.921864
 22.921846 21.59489  22.490889 23.492077 24.03219  24.24762  24.362497
 24.362514 25.265812 22.43788  23.492086 23.487362 24.362482 24.032118
 23.2003   22.433754]
2025-06-02 15:59:33,514 - DEBUG - Edge reconstruction errors: [1.051971   1.0494695  0.6445323  ... 0.04248315 0.04132586 1.1419424 ]
2025-06-02 15:59:33,518 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155933_update_21.json
2025-06-02 15:59:33,519 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:33,526 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155933_update_21.pth and as latest_checkpoint.pth
2025-06-02 15:59:33,526 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869725.dot): 0.5365
2025-06-02 15:59:33,526 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 15:59:33,526 - WARNING -   Node ID: 192.168.27.13, Recon Error: 28.7718, MLP Score: 0.0238
2025-06-02 15:59:33,526 - WARNING -   Node ID: 192.168.27.10, Recon Error: 35.8087, MLP Score: 0.0385
2025-06-02 15:59:33,526 - WARNING -   Node ID: ff02::2, Recon Error: 34.1936, MLP Score: 0.0015
2025-06-02 15:59:33,527 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 39.2890, MLP Score: 0.0014
2025-06-02 15:59:33,527 - WARNING -   Node ID: 192.168.209.130, Recon Error: 29.9947, MLP Score: 0.0064
2025-06-02 15:59:33,527 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:33,527 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.2476, MLP Score: 0.9926
2025-06-02 15:59:33,527 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 14.4763, MLP Score: 0.9356
2025-06-02 15:59:33,528 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.3887, MLP Score: 0.1303
2025-06-02 15:59:33,528 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.0588, MLP Score: 0.0447
2025-06-02 15:59:33,528 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0652, MLP Score: 0.0916
2025-06-02 15:59:33,535 - DEBUG - Embedding standard deviations before t-SNE: [2.2937007  0.4056755  0.         0.0038205  2.2178118  0.
 0.6180123  0.         0.         1.5806211  2.2912385  0.39824718
 0.         0.5527937  0.         0.39177737 1.2634425  0.
 0.         0.43190166 0.         0.         0.00978593 2.0217562
 0.         1.896039   0.043747   0.         0.         0.
 0.90784174 0.40429765]
2025-06-02 15:59:34,145 - INFO - Embeddings visualization saved to vis/embeddings_21_updates_20250602_155933.png
2025-06-02 15:59:34,145 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:34,146 - INFO - Starting visualization of node features.
2025-06-02 15:59:34,146 - INFO - Graph has 653 nodes and 30 features.
2025-06-02 15:59:34,147 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:34,147 - INFO - Calculating feature statistics:
2025-06-02 15:59:34,147 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,147 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,147 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5793545), 'max': np.float32(1.4206686)}
2025-06-02 15:59:34,147 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.3954121), 'max': np.float32(2.629857)}
2025-06-02 15:59:34,147 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,147 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,147 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,147 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4277511), 'max': np.float32(2.337808)}
2025-06-02 15:59:34,147 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(4.6734424e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1985687), 'max': np.float32(0.8343284)}
2025-06-02 15:59:34,147 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-8.865789), 'max': np.float32(0.11624347)}
2025-06-02 15:59:34,148 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 11, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-3.7988932), 'max': np.float32(0.8994265)}
2025-06-02 15:59:34,148 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 11, 'mean': np.float32(-2.3367212e-08), 'std': np.float32(1.0), 'min': np.float32(-0.88663286), 'max': np.float32(3.8624964)}
2025-06-02 15:59:34,148 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.361409), 'std': np.float32(1.0134679), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:59:34,148 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.957121), 'std': np.float32(0.28968853), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:34,148 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:34,148 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.376723), 'std': np.float32(0.5661809), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:34,148 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(2.9209015e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.11624347), 'max': np.float32(8.865789)}
2025-06-02 15:59:34,148 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.474732), 'std': np.float32(3.0934484), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:59:34,148 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.6738133), 'std': np.float32(2.9293683), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:34,148 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5895867), 'std': np.float32(1.528699), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:34,148 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.13935682), 'std': np.float32(0.36357617), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:34,148 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:34,148 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.9209015e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1343134), 'max': np.float32(14.483462)}
2025-06-02 15:59:34,148 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(5.841803e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14801767), 'max': np.float32(6.75595)}
2025-06-02 15:59:34,149 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,149 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,149 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,149 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:34,149 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.1683606e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0165796), 'max': np.float32(8.674318)}
2025-06-02 15:59:34,149 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.8418028e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1326946), 'max': np.float32(4.414677)}
2025-06-02 15:59:34,160 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a0ed82c0>
2025-06-02 15:59:34,288 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:34,339 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:34,366 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:35,816 - INFO - Node feature visualization saved to vis/node_features_20250602_155934.png
2025-06-02 15:59:35,817 - INFO - Finished visualization of node features.
2025-06-02 15:59:35,817 - INFO - Performing additional feature analysis:
2025-06-02 15:59:35,817 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:35,818 - INFO - Starting visualization of edge features.
2025-06-02 15:59:35,818 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:59:35,818 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:35,818 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:35,818 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:35,818 - INFO - - count: {'name': 'count', 'unique': 15, 'mean': np.float32(6.1793356), 'std': np.float32(1.068648), 'min': np.float32(0.0), 'max': np.float32(14.0)}
2025-06-02 15:59:35,818 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4169742), 'std': np.float32(0.5063505), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:35,818 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9431734), 'std': np.float32(1.8196598), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 15:59:35,818 - INFO - - service: {'name': 'service', 'unique': 24, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.04759762), 'max': np.float32(27.940474)}
2025-06-02 15:59:35,818 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 904, 'mean': np.float32(-1.4076373e-09), 'std': np.float32(1.0), 'min': np.float32(-0.072767064), 'max': np.float32(27.607315)}
2025-06-02 15:59:35,818 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 960, 'mean': np.float32(1.4076373e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.06579117), 'max': np.float32(27.892584)}
2025-06-02 15:59:35,818 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 316, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.056002725), 'max': np.float32(27.88871)}
2025-06-02 15:59:35,818 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 937, 'mean': np.float32(-2.8152747e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.12164314), 'max': np.float32(19.201406)}
2025-06-02 15:59:35,818 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 955, 'mean': np.float32(7.0381867e-10), 'std': np.float32(1.0), 'min': np.float32(-0.119738415), 'max': np.float32(18.085634)}
2025-06-02 15:59:35,818 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 353, 'mean': np.float32(-2.8152747e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06595535), 'max': np.float32(27.347694)}
2025-06-02 15:59:35,829 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1b383e0>
2025-06-02 15:59:35,931 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:35,945 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a19cb7d0>
2025-06-02 15:59:36,056 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:36,735 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:36,893 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:36,906 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:37,077 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:38,331 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155937.png
2025-06-02 15:59:38,331 - INFO - Finished visualization of edge features.
2025-06-02 15:59:38,331 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:38,332 - INFO - - Highest correlation (1.00) between features: 'total_orig_bytes' and 'total_orig_ip_bytes'.
2025-06-02 15:59:38,332 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:38,333 - INFO - Graph has 1355 edges and 10 edge features.
2025-06-02 15:59:38,333 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:38,646 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155938_summary.png
2025-06-02 15:59:38,901 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155938_pca_3d.png
2025-06-02 15:59:39,066 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155938_pca_variance.png
2025-06-02 15:59:39,066 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:39,066 - INFO - 
--- Processing file: nw_graph_encoded_1748869755.dot (Timestamp: 2025-06-02 15:09:15) ---
2025-06-02 15:59:39,066 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:59:39,066 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:59:39,079 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:59:39,092 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:59:39,092 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:59:39,092 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869755.dot
2025-06-02 15:59:39,104 - INFO - Parsed 693 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:59:39,117 - INFO - Parsed 1448 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869755.dot'.
2025-06-02 15:59:39,117 - INFO - Processing node updates/additions.
2025-06-02 15:59:39,121 - INFO - Processing edge updates/additions.
2025-06-02 15:59:39,130 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:39,131 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:39,131 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:39,132 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:39,140 - DEBUG - Initial node features tensor shape: torch.Size([693, 30])
2025-06-02 15:59:39,141 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:39,142 - DEBUG - Node features tensor shape after scaling: torch.Size([693, 30])
2025-06-02 15:59:39,145 - DEBUG - Edge index tensor shape: torch.Size([2, 1448])
2025-06-02 15:59:39,146 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:39,149 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:39,150 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:39,151 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:39,153 - DEBUG - Shape of encoded categorical edge features: torch.Size([1448, 3])
2025-06-02 15:59:39,154 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:39,154 - DEBUG - Shape of scaled numerical edge features: torch.Size([1448, 7])
2025-06-02 15:59:39,154 - DEBUG - Final edge attributes tensor shape: torch.Size([1448, 10])
2025-06-02 15:59:39,154 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:39,157 - INFO - Performing online update...
2025-06-02 15:59:39,158 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:39,159 - DEBUG - Updated RunningStats: new_mean=0.940599945244928, new_var=12000000000161.371, new_n=1230
2025-06-02 15:59:39,159 - DEBUG - Updated RunningStats: new_mean=0.9357146834184095, new_var=12300000000018.945, new_n=1260
2025-06-02 15:59:39,159 - DEBUG - Updated RunningStats: new_mean=1.0267490913560497, new_var=4000000000049.6562, new_n=410
2025-06-02 15:59:39,159 - DEBUG - Updated RunningStats: new_mean=1.0269264425874485, new_var=4100000000000.848, new_n=420
2025-06-02 15:59:39,159 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:39,159 - DEBUG - Online update step: 1/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 2/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 3/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 4/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 5/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 6/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 7/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 8/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 9/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 10/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 11/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 12/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 13/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 14/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 15/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 16/50
2025-06-02 15:59:39,160 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,160 - DEBUG - Online update step: 17/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 18/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 19/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 20/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 21/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 22/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 23/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 24/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 25/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 26/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 27/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 28/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 29/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 30/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 31/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 32/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 33/50
2025-06-02 15:59:39,161 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,161 - DEBUG - Online update step: 34/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 35/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 36/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 37/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 38/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 39/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 40/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 41/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 42/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 43/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 44/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 45/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 46/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 47/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 48/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 49/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - DEBUG - Online update step: 50/50
2025-06-02 15:59:39,162 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,162 - WARNING - No successful steps during online update.
2025-06-02 15:59:39,163 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], current edge mean: [ 6.1754146e+00  1.4191989e+00  4.9765191e+00 -1.3172298e-09
 -1.3172298e-09  4.6103041e-09 -1.3172298e-09  2.6344595e-09
  0.0000000e+00  1.3172298e-09]
2025-06-02 15:59:39,163 - DEBUG - Node drift difference: 0.0304, Edge drift difference: 0.0183
2025-06-02 15:59:39,164 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.7133256e-08  3.0619415e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.0229598e-08
  4.1284602e-09  5.5046137e-09  3.0275377e-08 -3.0275377e-08
  2.3362193e+00  2.9595959e+00  1.3708514e-01  4.3939395e+00
 -5.5046137e-09  3.4992785e+00  5.6955266e+00  7.6132755e+00
  1.3708514e-01  8.0000000e+00 -3.3027682e-08  1.6513841e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4403836e-08  1.5137688e-08], edge=[ 6.1754146e+00  1.4191989e+00  4.9765191e+00 -1.3172298e-09
 -1.3172298e-09  4.6103041e-09 -1.3172298e-09  2.6344595e-09
  0.0000000e+00  1.3172298e-09]
2025-06-02 15:59:39,165 - DEBUG - Updated reference std: node=[0.         0.         1.0007223  1.0007223  0.         0.
 0.         1.0007223  1.0007223  1.0007224  1.0007223  1.0007223
 0.98739225 0.28158483 0.36058903 0.565704   1.0007224  3.083906
 2.926053   1.4880826  0.36058903 0.         1.0007223  1.0007223
 0.         0.         0.         0.         1.0007223  1.0007223 ], edge=[1.0506998 0.5060425 1.7828178 1.0003455 1.0003455 1.0003455 1.0003455
 1.0003455 1.0003455 1.0003455]
2025-06-02 15:59:39,165 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:39,165 - INFO - Running anomaly detection...
2025-06-02 15:59:39,165 - INFO - Starting anomaly detection.
2025-06-02 15:59:39,271 - DEBUG - Node reconstruction errors: [24.389215 22.403112 29.939749 21.29437  16.685934 21.0501   27.990955
 19.120691 19.120703 20.59984  19.120672 19.947395 37.51798  19.257092
 20.551344 19.524683 20.735865 19.516819 22.974474 19.582357 19.148134
 20.551344 19.450127 19.319754 20.47303  20.311924 20.476057 18.421404
 19.184696 20.476057 20.587542 20.672436 19.254921 21.269812 20.247995
 21.369883 22.371864 19.582567 18.863628 18.202763 23.118225 20.667027
 19.582563 23.330585 21.552273 19.798498 24.22575  19.026907 19.30679
 34.456482 39.877113 21.200172 20.40797  23.48665  18.730196 17.811005
 30.699535 19.891022 22.246119 22.121117 17.526999 21.591927 20.840176
 20.028307 20.146313 18.730198 19.055635 18.730183 20.840471 20.840467
 18.929377 20.911303 19.281046 20.65966  22.562035 20.773235 24.207756
 21.29659  21.301691 20.798077 21.716942 21.281548 16.7225   24.694204
 19.42382  18.048855 21.390041 21.318727 21.023003 23.150486 20.248468
 17.680656 19.070557 21.276821 20.10636  34.497047 22.05981  22.307447
 21.383192 18.974236 21.265974 22.059816 23.00112  22.955849 18.62715
 19.328133 20.856874 17.359455 18.630636 29.42985  21.317156 21.784496
 17.98454  18.309435 21.141428 21.45026  21.290096 17.174854 20.966438
 20.464323 20.559118 20.314274 17.577637 19.11373  21.668514 20.464077
 18.198023 17.525509 22.712809 21.662508 21.981571 19.518364 19.465546
 18.38449  21.45028  19.189762 24.304552 21.328724 17.393593 16.888737
 19.602947 22.620083 20.65663  19.71964  19.865595 21.157347 21.290096
 19.436121 20.429121 21.127174 25.72736  18.626911 22.190565 19.518362
 21.039421 18.348507 19.725458 22.825579 21.26598  22.870218 19.434044
 18.275808 19.72547  21.981274 21.408068 16.86074  22.513807 21.467064
 17.494854 21.315748 20.956583 20.68855  20.482256 33.316154 21.69588
 19.771755 21.800934 21.61805  21.585442 21.585445 19.685879 18.949316
 20.24001  17.244474 17.372034 21.456816 21.023798 21.586485 19.539396
 20.093454 21.827822 21.637781 21.879028 19.55377  17.394297 21.544674
 18.421282 20.916138 16.976788 22.294422 21.35326  19.725283 17.77764
 21.098135 21.62455  19.070555 21.554585 18.107082 21.469952 22.354021
 21.756844 21.456823 21.270256 22.239925 21.456823 20.903801 23.25311
 21.290098 21.977907 19.553785 18.554344 21.02372  20.761103 21.270256
 19.725494 21.664787 17.449284 19.516928 21.2757   20.931515 19.745539
 22.094921 22.283142 21.290104 21.290096 21.548077 21.861427 20.76111
 19.725412 22.789728 17.451778 22.250654 19.70053  21.127209 19.802652
 21.770336 21.95634  22.044975 19.70053  19.72225  20.482243 20.569252
 21.977917 22.296568 21.45028  21.533072 20.097599 22.004492 21.473154
 21.585442 23.19639  19.008005 21.326128 20.724455 22.157042 20.529497
 22.827475 23.047327 22.827465 22.789986 17.731594 17.572271 22.385113
 21.801714 22.863865 21.585442 20.87261  22.290508 19.68582  21.957228
 19.628393 20.760378 21.70084  24.228102 23.451906 23.281435 18.28598
 18.580263 18.949324 19.178688 20.941927 22.706993 21.16143  19.802673
 18.320896 21.659224 22.652555 21.585457 21.548168 19.83443  22.068913
 22.043339 23.26053  23.260529 22.043715 22.043846 22.043837 23.06856
 22.158129 22.043583 22.043827 23.117317 22.043812 20.512575 20.720966
 21.962908 23.383188 19.650043 21.611988 21.69865  23.018675 20.548767
 21.469015 23.26053  19.687502 17.39551  21.746704 23.068552 22.543354
 22.543344 23.554798 21.984463 22.041574 22.863861 22.043802 23.06856
 21.188822 20.868305 21.746866 21.746782 21.948162 20.325636 21.74686
 23.759138 23.01137  22.827454 23.260527 23.370667 22.535975 21.445992
 22.04129  22.180187 18.986076 22.71926  20.383677 20.097595 22.466967
 22.043854 21.659239 21.659214 21.756847 21.432333 20.918425 23.238035
 23.260502 26.07114  21.177162 18.95688  21.803473 22.211199 22.852264
 21.669825 23.117094 17.850086 22.479206 23.547468 21.072517 20.993456
 22.327602 22.043846 23.26053  17.549646 20.378597 22.477787 18.640516
 21.952356 19.590233 18.969275 23.235456 22.043543 23.370768 21.952343
 22.36613  22.852606 23.65198  23.65216  23.652346 23.740923 22.473108
 23.634617 20.977545 23.175884 23.65212  22.474152 22.69458  22.366066
 23.096588 19.965874 22.366129 17.541414 23.652233 22.36613  22.473858
 23.65211  23.652214 21.208652 20.651546 23.652353 21.09008  21.73197
 20.498528 20.522688 22.414951 20.395102 18.026848 21.828962 20.64431
 23.351934 18.803373 22.144522 23.324093 20.098724 23.956612 22.428692
 23.652374 23.652151 20.522911 22.07174  18.590984 22.720247 22.046618
 21.898338 23.57724  23.577208 23.57721  18.162138 23.61828  22.39679
 22.396793 20.815788 22.478466 21.893547 20.966698 22.954885 21.893543
 21.977106 20.513084 20.660435 23.099867 22.414955 22.195843 20.513084
 20.395172 20.249395 20.654264 20.513031 21.589556 22.414953 18.66545
 21.929754 21.589556 22.195776 22.091734 18.275005 22.539846 22.414684
 22.19584  22.19584  22.04687  20.815609 23.244972 18.81329  21.464914
 20.815472 17.88367  22.0221   21.893547 19.070894 22.506157 18.321198
 23.188908 22.046906 22.31387  21.728634 22.636774 20.659214 22.636723
 26.718025 22.954882 20.815752 20.815706 21.731298 20.815704 21.560247
 22.022102 22.506157 23.13313  18.96723  20.966658 21.893549 22.506159
 22.078945 22.079084 21.893312 24.201878 21.893518 23.10993  24.20188
 24.898842 23.418392 24.201864 21.900208 23.13397  22.396797 22.022074
 22.63677  23.6458   19.0387   24.20186  22.478464 21.893549 22.954872
 22.954845 20.815788 22.636726 22.824284 23.87364  22.539888 22.954802
 22.787193 22.954752 22.78719  23.002455 24.201853 22.078278 22.077873
 22.06842  23.49271  21.250525 23.492765 23.492643 23.49272  23.492788
 23.492754 23.492712 23.492737 24.464508 22.436083 23.007954 23.492598
 23.492796 23.492744 23.492779 23.492737 23.492796 23.492706 23.492744
 23.4928   24.745737 23.491982 23.492804 24.464506 23.49273  21.893547
 24.733915 22.954876 25.190716 22.83733  29.482416 29.482416 22.296457
 25.190716 22.954832 23.134047 23.13337  22.954872 23.132921 22.95486
 21.879333 23.476353 21.900778 22.954872 22.078396 22.954876 22.954803
 23.13117  22.95486  23.13405  22.954876 22.954832 24.201874 23.133986
 22.95482  23.13268  22.954813 22.954876 22.954866 24.03468  22.619425
 22.619425 23.4928   21.755915 24.328978 22.954811 23.133158 24.697445
 23.491964 23.13405  22.755434 23.338316 22.954882 22.954882 22.87621
 24.298384 22.619423 22.95465  24.46451  23.131992 23.13389  21.178602
 23.492798 23.131613 24.201841 23.492746 23.490564 24.46451  22.954865
 22.954851 21.67843  22.619425 23.492788 24.298426 24.185177 24.629665
 24.629675 25.260372 22.379375 23.492796 23.488655 24.629658 24.298376
 23.264563 22.375822 22.910122 24.08154  24.081543 24.081444 24.08147
 24.08154  24.081532 24.08147  24.081545 24.079546 23.49272  23.492567
 23.49274  24.629675 24.571331 24.629572 21.849653 24.629679 23.492262
 23.492802 23.492798 23.492779 23.49277  24.629677 22.512135 23.70224
 23.702171 24.081537 22.512152 23.26452  22.385445 23.492605 23.492779
 24.081463 22.910118 23.702343 23.691004 22.91012  23.050503 24.08154 ]
2025-06-02 15:59:39,272 - DEBUG - Edge reconstruction errors: [1.052303   1.0510349  0.6447369  ... 0.04277401 0.04167722 1.142327  ]
2025-06-02 15:59:39,273 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155939_update_22.json
2025-06-02 15:59:39,274 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:39,277 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155939_update_22.pth and as latest_checkpoint.pth
2025-06-02 15:59:39,277 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869755.dot): 0.5541
2025-06-02 15:59:39,277 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:39,278 - WARNING -   Node ID: 192.168.27.13, Recon Error: 29.9397, MLP Score: 0.0242
2025-06-02 15:59:39,278 - WARNING -   Node ID: 192.168.27.12, Recon Error: 27.9910, MLP Score: 0.0241
2025-06-02 15:59:39,278 - WARNING -   Node ID: 192.168.27.10, Recon Error: 37.5180, MLP Score: 0.0381
2025-06-02 15:59:39,278 - WARNING -   Node ID: ff02::2, Recon Error: 34.4565, MLP Score: 0.0014
2025-06-02 15:59:39,278 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 39.8771, MLP Score: 0.0013
2025-06-02 15:59:39,278 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:39,278 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.7547, MLP Score: 0.9940
2025-06-02 15:59:39,278 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.0188, MLP Score: 0.9476
2025-06-02 15:59:39,278 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.5577, MLP Score: 0.1183
2025-06-02 15:59:39,278 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.2266, MLP Score: 0.0399
2025-06-02 15:59:39,278 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1310, MLP Score: 0.0812
2025-06-02 15:59:39,278 - INFO - 
--- Processing file: nw_graph_encoded_1748869785.dot (Timestamp: 2025-06-02 15:09:45) ---
2025-06-02 15:59:39,278 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:59:39,278 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:59:39,298 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:59:39,317 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:59:39,317 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:59:39,317 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869785.dot
2025-06-02 15:59:39,333 - INFO - Parsed 700 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:59:39,350 - INFO - Parsed 1476 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869785.dot'.
2025-06-02 15:59:39,350 - INFO - Processing node updates/additions.
2025-06-02 15:59:39,355 - INFO - Processing edge updates/additions.
2025-06-02 15:59:39,367 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:39,368 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:39,368 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:39,369 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:39,378 - DEBUG - Initial node features tensor shape: torch.Size([700, 30])
2025-06-02 15:59:39,380 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:39,380 - DEBUG - Node features tensor shape after scaling: torch.Size([700, 30])
2025-06-02 15:59:39,382 - DEBUG - Edge index tensor shape: torch.Size([2, 1476])
2025-06-02 15:59:39,383 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:39,388 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:39,389 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:39,391 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:39,392 - DEBUG - Shape of encoded categorical edge features: torch.Size([1476, 3])
2025-06-02 15:59:39,393 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:39,393 - DEBUG - Shape of scaled numerical edge features: torch.Size([1476, 7])
2025-06-02 15:59:39,394 - DEBUG - Final edge attributes tensor shape: torch.Size([1476, 10])
2025-06-02 15:59:39,394 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:39,397 - INFO - Performing online update...
2025-06-02 15:59:39,397 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:39,398 - DEBUG - Updated RunningStats: new_mean=0.9408962908400099, new_var=12600000000160.984, new_n=1290
2025-06-02 15:59:39,398 - DEBUG - Updated RunningStats: new_mean=0.9362716635058301, new_var=12900000000019.05, new_n=1320
2025-06-02 15:59:39,398 - DEBUG - Updated RunningStats: new_mean=1.0322764865301615, new_var=4200000000049.594, new_n=430
2025-06-02 15:59:39,398 - DEBUG - Updated RunningStats: new_mean=1.032296575887931, new_var=4300000000000.8423, new_n=440
2025-06-02 15:59:39,399 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:39,399 - DEBUG - Online update step: 1/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 2/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 3/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 4/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 5/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 6/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 7/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 8/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 9/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 10/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 11/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 12/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 13/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,399 - DEBUG - Online update step: 14/50
2025-06-02 15:59:39,399 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 15/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 16/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 17/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 18/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 19/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 20/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 21/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 22/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 23/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 24/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 25/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 26/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 27/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 28/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 29/50
2025-06-02 15:59:39,400 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,400 - DEBUG - Online update step: 30/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 31/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 32/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 33/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 34/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 35/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 36/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 37/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 38/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 39/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 40/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 41/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 42/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 43/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 44/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,401 - DEBUG - Online update step: 45/50
2025-06-02 15:59:39,401 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - DEBUG - Online update step: 46/50
2025-06-02 15:59:39,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - DEBUG - Online update step: 47/50
2025-06-02 15:59:39,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - DEBUG - Online update step: 48/50
2025-06-02 15:59:39,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - DEBUG - Online update step: 49/50
2025-06-02 15:59:39,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - DEBUG - Online update step: 50/50
2025-06-02 15:59:39,402 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,402 - WARNING - No successful steps during online update.
2025-06-02 15:59:39,403 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], current edge mean: [ 6.1714091e+00  1.4214092e+00  4.9769650e+00 -5.1689666e-09
  0.0000000e+00 -6.4612082e-10 -4.5228457e-09  2.5844833e-09
  1.2922416e-09 -2.2614228e-09]
2025-06-02 15:59:39,403 - DEBUG - Node drift difference: 0.0145, Edge drift difference: 0.0044
2025-06-02 15:59:39,404 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.1798270e-08  5.1770890e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.8392290e-08
  4.7683717e-08 -2.4523054e-08 -8.1743510e-09 -1.2261527e-08
  2.3414285e+00  2.9600000e+00  1.4000000e-01  4.3857141e+00
  2.4523054e-08  3.5214286e+00  5.6671429e+00  7.5999999e+00
  1.4000000e-01  8.0000000e+00 -1.8392290e-08  5.3133284e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.7683715e-09 -8.1743510e-09], edge=[ 6.1714091e+00  1.4214092e+00  4.9769650e+00 -5.1689666e-09
  0.0000000e+00 -6.4612082e-10 -4.5228457e-09  2.5844833e-09
  1.2922416e-09 -2.2614228e-09]
2025-06-02 15:59:39,405 - DEBUG - Updated reference std: node=[0.         0.         1.000715   1.000715   0.         0.
 0.         1.0007151  1.000715   1.000715   1.000715   1.0007151
 0.9945478  0.2802002  0.36725795 0.5633757  1.000715   3.0975275
 2.9325864  1.5110466  0.36725795 0.         1.000715   1.000715
 0.         0.         0.         0.         1.000715   1.000715  ], edge=[1.041392  0.507492  1.7803478 1.0003389 1.0003389 1.0003389 1.0003389
 1.0003389 1.0003389 1.0003389]
2025-06-02 15:59:39,405 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:39,405 - INFO - Running anomaly detection...
2025-06-02 15:59:39,405 - INFO - Starting anomaly detection.
2025-06-02 15:59:39,454 - DEBUG - Node reconstruction errors: [24.409819 22.47675  30.092205 21.329197 17.187075 21.083496 28.123823
 19.163996 19.164007 20.637426 19.163979 20.054285 37.736874 19.561363
 20.597157 19.56976  20.83358  19.561207 23.067678 19.633043 19.19952
 20.597149 19.69935  19.400723 20.523098 20.34598  20.52615  18.487112
 19.233425 20.526142 20.695257 20.71215  19.288967 21.306366 20.276764
 21.380806 22.41375  19.633253 18.912432 18.270184 23.171318 20.716097
 19.633259 23.358025 21.597734 19.819101 24.260351 19.065952 19.35847
 34.624554 40.234592 21.247784 20.445665 23.57073  18.771431 17.832546
 30.808939 19.945368 22.329597 22.200005 17.590029 21.602388 20.889715
 20.089973 20.192732 18.771433 19.089539 18.771418 20.890018 20.890017
 19.595211 20.987988 19.310036 20.727915 22.62716  20.850494 24.217842
 21.365429 21.34715  20.865574 21.755793 21.341997 16.751455 24.748356
 19.43356  18.106995 22.403973 21.36038  21.090954 23.687225 20.28514
 17.721136 19.137867 21.326513 20.140965 34.604248 22.099604 22.34382
 21.426006 18.995152 21.335379 22.099611 23.028929 22.989725 18.656713
 19.351627 20.857418 17.431225 18.701672 29.445644 21.353228 21.820168
 18.024233 18.37042  21.200499 21.500204 21.347645 17.214851 21.0222
 20.481747 20.588804 20.34696  17.614464 19.157335 21.708956 20.481504
 18.26137  17.572796 22.758944 21.674006 22.013592 19.540852 19.499508
 18.426256 21.500214 19.209156 24.32357  21.375002 17.436598 16.931314
 19.620333 22.660946 20.680473 19.729944 19.867414 21.220968 21.347649
 19.463854 20.465786 21.175753 25.769703 18.656462 22.276926 19.540852
 21.109924 18.379744 19.750237 22.857159 21.33538  22.9056   19.46213
 18.320465 19.750246 22.013287 21.471624 16.902935 22.602385 21.511831
 17.535341 21.795452 21.023226 20.694933 20.516958 33.415268 21.72631
 19.792326 21.852053 23.34412  21.647827 21.647831 19.700705 19.02823
 20.27692  17.30346  17.849447 21.512333 21.039305 21.644503 19.550085
 20.103811 21.885944 21.677301 21.873644 19.58918  17.437304 21.558512
 16.916056 20.92548  17.022978 22.322649 21.385094 19.75007  17.823212
 21.159044 21.68378  19.137867 21.588465 18.153948 21.508324 22.433725
 21.811758 21.51233  21.300323 22.531658 22.196196 20.924564 23.287128
 21.347649 22.04233  19.589201 18.611294 21.039227 20.791388 21.300325
 19.750269 21.717512 17.472717 19.554436 21.3354   20.966858 19.77993
 22.124199 22.311913 21.347649 21.347645 21.561947 21.89051  20.79139
 19.75019  22.789694 17.500196 22.785658 19.724886 21.175781 19.835846
 21.80072  21.998283 22.086073 19.724886 19.740435 20.516954 20.612444
 22.042347 22.318237 22.121893 21.591368 20.107912 22.027971 21.47321
 21.64783  23.247896 19.080717 21.360167 20.739946 22.189018 20.554432
 22.905836 23.120249 22.905832 22.813232 17.772457 17.6167   22.440111
 22.029783 22.94473  21.647831 20.902258 22.350779 19.700647 22.003195
 19.650255 20.795816 21.729122 24.265064 23.489025 23.318684 18.314543
 18.62866  19.028233 19.20713  20.94642  22.723295 21.189705 19.835867
 18.370794 21.699379 22.685612 21.647844 21.562035 19.86877  22.100473
 22.076355 23.332148 23.332148 22.076735 22.076872 22.076855 23.147833
 22.186188 22.076605 22.076849 23.148537 22.076838 20.513084 20.327272
 22.014126 23.432716 19.703592 21.6359   21.703764 23.089306 20.578804
 21.5275   23.332146 19.68915  17.448233 21.782667 23.147835 22.621876
 22.621859 23.636602 21.985697 22.074604 22.944729 22.076834 23.147831
 21.183264 20.906782 21.78283  21.782742 21.978506 20.360003 21.782827
 23.797962 23.052717 22.905817 23.332148 23.404097 22.620205 21.49839
 22.074286 22.451515 19.024538 22.753292 20.414846 20.10791  22.478224
 22.076878 21.699396 21.699371 21.811756 21.442007 20.934696 23.408281
 23.332119 26.14024  21.19654  18.987465 21.849398 22.237774 22.895847
 21.706758 23.148386 18.413366 22.544783 23.619354 21.092413 21.024897
 22.391827 22.07687  23.332144 17.597757 20.375902 22.524273 18.681591
 22.00573  19.61056  18.99535  23.314808 22.076567 23.419035 22.661043
 22.40574  22.868996 23.721933 23.722105 23.72229  23.79607  22.49665
 23.684898 20.964195 23.214027 23.722067 22.497698 22.737476 22.40569
 23.165    20.596779 22.40574  17.58198  23.722178 22.40574  22.497398
 23.722055 23.722162 21.384298 20.679499 23.722303 21.114601 21.734358
 20.51018  20.53458  22.43973  20.814125 18.066217 22.319452 20.649364
 23.850079 18.856314 22.16133  23.390636 20.568428 24.004606 22.464851
 23.722319 23.722094 20.964577 22.10622  19.235418 22.730524 22.044462
 21.909967 23.580538 23.58051  23.580513 18.197409 23.643332 22.39364
 22.393644 20.814562 22.515377 21.900936 20.957895 22.967503 21.900938
 21.977663 20.516064 20.654823 23.113253 22.439734 22.23109  20.51606
 20.404844 20.298052 20.648651 20.516016 21.60788  22.439734 19.33401
 22.393616 21.607878 22.23103  22.11493  18.737541 22.5632   22.43947
 22.231087 22.23109  22.044714 20.814379 23.250921 18.823114 21.480522
 20.814243 17.917082 22.030285 21.900936 19.099325 22.508205 18.344208
 23.214546 22.044752 22.334309 21.73096  22.659254 20.653597 22.659204
 26.782919 22.967499 20.814526 20.814478 21.73368  20.814474 21.577559
 22.030285 20.458294 23.13608  18.988379 20.957853 21.900932 22.508207
 22.081013 22.08115  21.900692 24.247814 21.90091  23.112753 24.247814
 24.881596 23.458563 24.247797 21.911812 23.136919 22.393652 22.03026
 22.659246 23.640343 19.084496 24.247799 22.515377 21.900938 22.967491
 22.967468 20.814558 22.659204 22.849537 23.917725 22.563227 22.967417
 22.82691  22.967371 22.826914 23.038858 24.247797 22.080349 22.079939
 22.070507 23.49236  21.248257 23.492413 23.492287 23.492365 23.492428
 23.492395 23.492361 23.49238  24.507923 22.434414 22.99914  23.492247
 23.492441 23.49239  23.492426 23.492376 23.49244  23.492353 23.492388
 23.492443 24.776205 23.491625 23.492443 24.507917 23.492373 21.900938
 24.78167  22.967497 25.230003 22.861153 29.5088   29.5088   22.328718
 25.230003 22.967447 23.136993 23.13632  22.96749  23.135864 22.96748
 21.876171 23.475897 21.912384 22.967495 22.080475 22.967497 22.967417
 23.134111 22.96748  23.136997 22.967495 22.96745  24.247808 23.13693
 22.96744  23.135624 22.967434 22.967499 22.96749  24.07833  22.89532
 22.653759 23.492441 21.76282  24.377014 22.96743  23.136108 24.726507
 23.491608 23.136997 22.774908 23.330841 22.967499 22.967495 22.896206
 24.339542 22.653765 22.967272 24.507923 23.134943 23.136837 21.229961
 23.492441 23.13455  24.247784 23.492392 23.490221 24.507921 22.967487
 22.967472 21.681536 22.653759 24.776209 24.339582 24.17977  24.673565
 24.673576 25.29308  22.373892 23.492437 22.623388 24.673555 24.339535
 23.291378 22.37024  22.890982 24.066765 24.066767 24.06666  24.066687
 24.066763 24.066755 25.053057 24.06677  24.064636 23.492365 23.492208
 23.492382 24.673578 24.602057 24.673473 21.843954 24.673582 24.776173
 24.776209 23.492441 24.77621  23.492418 24.673582 22.507338 23.690487
 23.690422 24.066761 22.507355 23.291334 22.365137 23.492249 23.492428
 24.06668  22.890984 23.69059  23.679203 22.890978 23.03147  24.066763
 21.783636 24.739714 22.002474 21.941622 22.890726 21.941622 23.031483]
2025-06-02 15:59:39,454 - DEBUG - Edge reconstruction errors: [1.0511533  1.0506012  0.6436482  ... 0.04178299 0.04078378 1.1412483 ]
2025-06-02 15:59:39,457 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155939_update_23.json
2025-06-02 15:59:39,457 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:39,461 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155939_update_23.pth and as latest_checkpoint.pth
2025-06-02 15:59:39,461 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869785.dot): 0.5567
2025-06-02 15:59:39,461 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:39,461 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.0922, MLP Score: 0.0241
2025-06-02 15:59:39,461 - WARNING -   Node ID: 192.168.27.12, Recon Error: 28.1238, MLP Score: 0.0239
2025-06-02 15:59:39,461 - WARNING -   Node ID: 192.168.27.10, Recon Error: 37.7369, MLP Score: 0.0377
2025-06-02 15:59:39,461 - WARNING -   Node ID: ff02::2, Recon Error: 34.6246, MLP Score: 0.0013
2025-06-02 15:59:39,461 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.2346, MLP Score: 0.0012
2025-06-02 15:59:39,461 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:39,461 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.6372, MLP Score: 0.9934
2025-06-02 15:59:39,462 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.0062, MLP Score: 0.9450
2025-06-02 15:59:39,462 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.6893, MLP Score: 0.2007
2025-06-02 15:59:39,462 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.4748, MLP Score: 0.0419
2025-06-02 15:59:39,462 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1298, MLP Score: 0.0794
2025-06-02 15:59:39,462 - INFO - 
--- Processing file: nw_graph_encoded_1748869815.dot (Timestamp: 2025-06-02 15:10:15) ---
2025-06-02 15:59:39,462 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:59:39,462 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:59:39,483 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:59:39,504 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:59:39,504 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:59:39,504 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869815.dot
2025-06-02 15:59:39,521 - INFO - Parsed 715 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:59:39,538 - INFO - Parsed 1521 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869815.dot'.
2025-06-02 15:59:39,538 - INFO - Processing node updates/additions.
2025-06-02 15:59:39,543 - INFO - Processing edge updates/additions.
2025-06-02 15:59:39,553 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:39,554 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:39,554 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:39,555 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:39,566 - DEBUG - Initial node features tensor shape: torch.Size([715, 30])
2025-06-02 15:59:39,567 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:39,568 - DEBUG - Node features tensor shape after scaling: torch.Size([715, 30])
2025-06-02 15:59:39,569 - DEBUG - Edge index tensor shape: torch.Size([2, 1521])
2025-06-02 15:59:39,570 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:39,575 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:39,576 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:39,577 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:39,579 - DEBUG - Shape of encoded categorical edge features: torch.Size([1521, 3])
2025-06-02 15:59:39,580 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:39,580 - DEBUG - Shape of scaled numerical edge features: torch.Size([1521, 7])
2025-06-02 15:59:39,580 - DEBUG - Final edge attributes tensor shape: torch.Size([1521, 10])
2025-06-02 15:59:39,580 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:39,583 - INFO - Performing online update...
2025-06-02 15:59:39,584 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:39,585 - DEBUG - Updated RunningStats: new_mean=0.9411957479889629, new_var=13200000000160.975, new_n=1350
2025-06-02 15:59:39,585 - DEBUG - Updated RunningStats: new_mean=0.9367650206579131, new_var=13500000000019.027, new_n=1380
2025-06-02 15:59:39,585 - DEBUG - Updated RunningStats: new_mean=1.0373104833647409, new_var=4400000000049.627, new_n=450
2025-06-02 15:59:39,585 - DEBUG - Updated RunningStats: new_mean=1.0371769739640275, new_var=4500000000000.824, new_n=460
2025-06-02 15:59:39,585 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:39,585 - DEBUG - Online update step: 1/50
2025-06-02 15:59:39,585 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,585 - DEBUG - Online update step: 2/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 3/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 4/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 5/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 6/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 7/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 8/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 9/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 10/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 11/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 12/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 13/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 14/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 15/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 16/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 17/50
2025-06-02 15:59:39,586 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,586 - DEBUG - Online update step: 18/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 19/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 20/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 21/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 22/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 23/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 24/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 25/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 26/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 27/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 28/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 29/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 30/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 31/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 32/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 33/50
2025-06-02 15:59:39,587 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,587 - DEBUG - Online update step: 34/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 35/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 36/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 37/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 38/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 39/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 40/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 41/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 42/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 43/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 44/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 45/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 46/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 47/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 48/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,588 - DEBUG - Online update step: 49/50
2025-06-02 15:59:39,588 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,589 - DEBUG - Online update step: 50/50
2025-06-02 15:59:39,589 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,589 - WARNING - No successful steps during online update.
2025-06-02 15:59:39,590 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], current edge mean: [ 6.1696253e+00  1.4234056e+00  4.9861932e+00  8.7780672e-09
  2.5080193e-09 -1.2540097e-09  1.2540097e-09  2.5080193e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:59:39,590 - DEBUG - Node drift difference: 0.0255, Edge drift difference: 0.0052
2025-06-02 15:59:39,591 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.00071533e-08 -1.09705894e-07
  0.00000000e+00  0.00000000e+00  0.00000000e+00 -2.00071537e-09
 -2.13409646e-08 -1.20042918e-08 -2.93438251e-08 -2.66762057e-09
  2.31608391e+00  2.96083927e+00  1.39860138e-01  4.39300680e+00
  1.20042918e-08  3.52027965e+00  5.65734243e+00  7.60839176e+00
  1.39860138e-01  8.00000000e+00 -1.80064390e-08  2.66762057e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
  3.96808559e-08 -2.13409646e-08], edge=[ 6.1696253e+00  1.4234056e+00  4.9861932e+00  8.7780672e-09
  2.5080193e-09 -1.2540097e-09  1.2540097e-09  2.5080193e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 15:59:39,591 - DEBUG - Updated reference std: node=[0.         0.         1.0007     1.0007     0.         0.
 0.         1.0007     1.0007     1.0007001  1.0007     1.0007
 1.017057   0.27730066 0.3667061  0.56330985 1.0007001  3.0911584
 2.9346402  1.4961902  0.3667061  0.         1.0007001  1.0007
 0.         0.         0.         0.         1.0007     1.0007    ], edge=[1.0337199 0.5073971 1.7682712 1.0003289 1.0003289 1.0003289 1.0003289
 1.0003289 1.0003289 1.0003289]
2025-06-02 15:59:39,591 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:39,591 - INFO - Running anomaly detection...
2025-06-02 15:59:39,591 - INFO - Starting anomaly detection.
2025-06-02 15:59:39,637 - DEBUG - Node reconstruction errors: [24.633991 22.824133 30.55947  21.347198 17.165682 21.06297  28.58243
 19.215843 19.215855 20.670776 19.215826 20.176325 38.424355 19.797024
 20.639433 19.614885 20.935177 19.606873 23.210104 19.686167 19.264595
 20.639427 19.69436  19.476889 20.573101 20.36165  20.575886 18.55405
 19.29514  20.575878 20.83538  21.418175 19.299496 21.345827 20.314032
 21.361317 22.881693 19.68637  18.95063  18.306902 23.227922 20.763025
 19.686373 23.372063 21.640484 19.821775 24.280836 19.087812 19.424097
 34.679825 40.40954  21.301474 20.467308 23.70212  18.789558 18.043615
 31.054296 20.002947 22.432667 22.319796 17.61021  21.5795   20.937464
 20.129335 20.219362 18.789558 19.101007 18.789545 20.937738 20.937737
 19.546383 21.0228   19.314402 20.754663 23.127705 20.888496 24.200024
 21.38716  21.328821 20.88904  21.792747 21.353209 16.952423 24.788994
 19.423927 18.11471  22.343666 21.339964 21.115263 23.65583  20.311
 17.725666 19.134985 21.321064 20.16286  34.827824 22.112759 22.404879
 21.457602 19.003534 21.352179 22.112766 23.040964 22.957094 18.613302
 19.34013  20.98154  17.486734 18.743406 29.474981 21.353151 21.84835
 19.004263 18.423025 21.227465 22.075222 21.37072  17.206305 21.047342
 20.471792 20.594595 20.294567 17.589724 19.125921 21.687939 20.471544
 18.257435 17.558252 22.747581 21.643133 22.034763 19.551537 19.522219
 18.275963 21.510262 19.212347 24.316957 21.410917 17.43935  16.962248
 20.154236 22.646975 20.677416 19.71705  19.985634 21.2546   21.370722
 19.484911 20.501057 21.187157 25.781391 19.385216 22.369774 19.551535
 22.834412 18.371115 19.736874 22.81884  21.352182 22.932533 19.975851
 17.842653 19.736881 22.034494 21.477182 16.933184 22.693218 21.490578
 18.181707 21.74934  21.04268  20.664904 20.536947 33.627007 21.903309
 20.150486 21.860735 23.320936 21.644615 21.644613 19.670357 19.045143
 20.271986 17.320179 17.798712 21.53116  21.019707 21.645288 19.534977
 20.070118 21.896755 21.65113  21.809605 19.603277 17.440062 21.529652
 16.867594 20.896454 17.028522 21.07435  21.395514 19.736727 17.83307
 21.167665 21.691952 19.134989 21.61286  19.369907 21.53185  22.51578
 21.7945   21.531157 21.302027 22.496468 22.148859 20.897135 23.266508
 21.37072  22.03824  19.603296 18.644436 21.01962  20.79992  21.302025
 19.736904 21.708536 17.467491 19.57304  21.33924  19.833008 19.72001
 22.080078 23.025446 21.37072  21.37072  21.532763 21.84537  20.799921
 19.736835 22.721615 18.093893 22.771484 19.736797 21.187181 19.844183
 22.22245  21.971455 22.077097 19.736795 19.717588 20.536932 20.62775
 22.038258 22.252947 22.075243 21.617031 20.073828 22.024385 21.408033
 21.644617 23.276783 19.086338 21.35666  20.72417  22.144829 20.55595
 22.98937  23.155025 22.98937  23.149136 17.757586 17.605133 22.457388
 21.999498 23.02069  21.644615 20.885048 22.354929 19.67031  22.306284
 19.619251 20.789673 21.6998   24.284227 23.478308 23.342794 18.511343
 18.61036  19.045147 19.162354 20.908976 22.687784 21.20767  19.844202
 18.769306 22.331486 22.632917 21.644646 21.532843 19.863726 22.046654
 22.086664 23.389744 23.389742 22.087013 22.087126 22.087118 23.219507
 22.189543 22.086891 22.087107 23.126108 22.087095 20.456734 20.336794
 21.999186 23.284525 19.672182 21.623009 21.65858  23.15901  21.190489
 21.531403 23.389742 19.657467 17.452637 21.800087 23.219505 22.700678
 22.700666 23.719748 21.931047 22.085075 23.020693 22.087095 23.219507
 21.348894 20.911232 21.800234 21.800158 21.998182 20.355661 21.800232
 23.809423 23.040533 22.989353 23.389742 23.42114  22.713903 21.488735
 22.084791 22.383953 19.028076 22.699049 20.404005 20.073822 22.450235
 22.087135 21.72468  26.919237 21.7945   21.424044 20.94524  23.389383
 23.38972  26.293964 21.182564 19.438755 21.849958 22.203089 23.125736
 23.17816  23.125954 18.382391 22.58625  23.68054  21.089579 21.046772
 22.422062 22.087126 23.38974  18.41916  20.334839 22.090912 18.419079
 21.979023 19.610918 18.942509 23.389381 22.086853 23.42404  22.575375
 22.355219 22.77733  23.778248 23.778385 23.778538 23.840069 22.49052
 23.74517  20.881279 23.19407  23.77835  22.491463 22.697536 22.35517
 23.230028 20.528385 22.35522  17.575687 23.778444 22.355217 22.491198
 23.778345 23.77843  21.310091 20.660198 23.778543 21.108307 21.678123
 20.798338 20.500156 22.401407 20.74224  18.653208 20.798332 20.876383
 23.760994 18.841963 22.121088 23.450552 20.48502  24.5534   22.44501
 23.778557 23.778376 20.881626 22.089485 19.159534 22.695024 21.976665
 21.89107  24.009735 22.309845 22.309877 18.58913  23.808538 22.350899
 22.350912 21.044212 22.470804 21.850924 20.894596 22.940039 21.85092
 20.802921 20.750193 20.604794 23.695675 22.401403 22.211018 20.482943
 20.92153  20.29228  20.598017 20.482885 21.572584 22.401402 19.523535
 22.321962 21.57258  22.210966 22.074053 18.494007 22.500347 22.401134
 22.616833 22.211012 21.976904 20.769754 23.215895 18.786865 22.005363
 20.769596 18.289854 21.973703 21.850922 19.069727 22.453388 18.330725
 23.91002  21.976942 22.286808 21.674706 22.83167  20.603447 22.616232
 26.865639 22.940033 20.769918 20.769863 21.677303 21.218956 21.533678
 21.973703 20.39076  23.088781 18.976505 20.894548 21.850922 20.63524
 22.044153 22.044277 21.850668 24.787834 21.850887 23.067913 24.256197
 24.798162 23.549213 24.256182 21.892714 23.08953  22.35092  21.973677
 22.616272 23.58496  19.061626 24.256178 22.470802 21.850924 22.940027
 22.939999 20.769958 22.616224 22.772657 23.931011 22.518087 22.93996
 22.77757  22.939915 22.777576 22.985168 24.256174 22.04356  22.043205
 22.034838 23.436195 21.192339 23.436247 23.436127 23.436207 23.43627
 23.436235 23.4362   23.43622  24.509766 22.388493 22.92127  23.43609
 23.436274 23.436228 23.43626  23.43622  23.436275 23.436192 23.436228
 23.436275 24.755423 23.435518 23.43628  24.509762 23.436213 21.85092
 24.751099 22.94003  25.176859 23.07168  29.411562 29.411562 22.305153
 25.176859 22.939985 23.0896   23.088995 22.940025 23.088596 22.94001
 21.828762 23.421446 21.89322  22.940025 22.043678 22.94003  22.93996
 23.087029 22.940008 23.089602 22.94003  22.939991 24.256193 23.089546
 22.939978 23.088377 22.93997  22.940033 22.940022 24.096916 22.831701
 22.8317   23.436275 21.732975 24.347239 22.93997  23.08881  24.714642
 23.435509 23.089603 22.72345  23.266087 22.940033 22.940031 22.84741
 24.351126 22.626526 22.939827 24.509764 23.087767 23.089458 21.243536
 23.436275 23.087421 24.25616  23.436226 23.434267 24.509764 22.940022
 22.940006 21.654743 22.626526 25.30467  24.351166 24.095814 24.679491
 24.679502 25.233473 22.296862 23.436274 22.558754 25.194624 24.351122
 23.210688 22.293432 22.789652 23.984015 23.984013 23.983915 23.983942
 23.984009 25.294725 25.302996 23.984015 23.982111 23.436209 23.43606
 23.436226 24.679502 24.591845 24.679413 21.770914 24.679502 24.755384
 24.755424 23.436275 24.75542  23.43625  24.6795   22.423615 23.617592
 23.617533 23.984005 22.423632 23.210659 22.263374 23.436092 23.436266
 23.983934 22.789654 23.617697 23.606943 22.789652 22.918327 25.294727
 21.697584 23.102722 21.887257 21.827444 22.789446 21.827446 22.918337
 23.322079 23.322079 25.758585 24.579868 25.198437 22.789654 22.789616
 22.789654 22.97098  22.789656 22.789663 23.322079 22.78966  22.789654
 22.78956 ]
2025-06-02 15:59:39,637 - DEBUG - Edge reconstruction errors: [1.0501447  1.0503381  0.64262706 ... 0.04077525 0.03979571 1.1402727 ]
2025-06-02 15:59:39,641 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155939_update_24.json
2025-06-02 15:59:39,642 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:39,645 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155939_update_24.pth and as latest_checkpoint.pth
2025-06-02 15:59:39,645 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869815.dot): 0.5697
2025-06-02 15:59:39,645 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:39,646 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.5595, MLP Score: 0.0245
2025-06-02 15:59:39,646 - WARNING -   Node ID: 192.168.27.12, Recon Error: 28.5824, MLP Score: 0.0242
2025-06-02 15:59:39,646 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.4244, MLP Score: 0.0379
2025-06-02 15:59:39,646 - WARNING -   Node ID: ff02::2, Recon Error: 34.6798, MLP Score: 0.0012
2025-06-02 15:59:39,646 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.4095, MLP Score: 0.0012
2025-06-02 15:59:39,646 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:39,646 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.6809, MLP Score: 0.9933
2025-06-02 15:59:39,646 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.4240, MLP Score: 0.9555
2025-06-02 15:59:39,646 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.7052, MLP Score: 0.1898
2025-06-02 15:59:39,646 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.8626, MLP Score: 0.0438
2025-06-02 15:59:39,647 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1320, MLP Score: 0.0738
2025-06-02 15:59:39,647 - INFO - 
--- Processing file: nw_graph_encoded_1748869845.dot (Timestamp: 2025-06-02 15:10:45) ---
2025-06-02 15:59:39,647 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:59:39,647 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:59:39,668 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:59:39,689 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:59:39,689 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:59:39,689 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869845.dot
2025-06-02 15:59:39,706 - INFO - Parsed 723 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:59:39,722 - INFO - Parsed 1547 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869845.dot'.
2025-06-02 15:59:39,722 - INFO - Processing node updates/additions.
2025-06-02 15:59:39,726 - INFO - Processing edge updates/additions.
2025-06-02 15:59:39,734 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:39,735 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:39,735 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:39,737 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:39,744 - DEBUG - Initial node features tensor shape: torch.Size([723, 30])
2025-06-02 15:59:39,747 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:39,747 - DEBUG - Node features tensor shape after scaling: torch.Size([723, 30])
2025-06-02 15:59:39,748 - DEBUG - Edge index tensor shape: torch.Size([2, 1547])
2025-06-02 15:59:39,749 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:39,753 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 15
2025-06-02 15:59:39,754 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:39,756 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:39,757 - DEBUG - Shape of encoded categorical edge features: torch.Size([1547, 3])
2025-06-02 15:59:39,758 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:39,759 - DEBUG - Shape of scaled numerical edge features: torch.Size([1547, 7])
2025-06-02 15:59:39,759 - DEBUG - Final edge attributes tensor shape: torch.Size([1547, 10])
2025-06-02 15:59:39,759 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:39,762 - INFO - Performing online update...
2025-06-02 15:59:39,763 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:39,764 - DEBUG - Updated RunningStats: new_mean=0.9414760517616573, new_var=13800000000160.807, new_n=1410
2025-06-02 15:59:39,764 - DEBUG - Updated RunningStats: new_mean=0.9372416511682102, new_var=14100000000019.094, new_n=1440
2025-06-02 15:59:39,764 - DEBUG - Updated RunningStats: new_mean=1.0418873563900621, new_var=4600000000049.615, new_n=470
2025-06-02 15:59:39,765 - DEBUG - Updated RunningStats: new_mean=1.0416509007585266, new_var=4700000000000.816, new_n=480
2025-06-02 15:59:39,765 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:39,765 - DEBUG - Online update step: 1/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 2/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 3/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 4/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 5/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 6/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 7/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 8/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 9/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 10/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 11/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,765 - DEBUG - Online update step: 12/50
2025-06-02 15:59:39,765 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 13/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 14/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 15/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 16/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 17/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 18/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 19/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 20/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 21/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 22/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 23/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 24/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 25/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 26/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 27/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 28/50
2025-06-02 15:59:39,766 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,766 - DEBUG - Online update step: 29/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 30/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 31/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 32/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 33/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 34/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 35/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 36/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 37/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 38/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 39/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 40/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 41/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 42/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 43/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 44/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 45/50
2025-06-02 15:59:39,767 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,767 - DEBUG - Online update step: 46/50
2025-06-02 15:59:39,768 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,768 - DEBUG - Online update step: 47/50
2025-06-02 15:59:39,768 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,768 - DEBUG - Online update step: 48/50
2025-06-02 15:59:39,768 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,768 - DEBUG - Online update step: 49/50
2025-06-02 15:59:39,768 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,768 - DEBUG - Online update step: 50/50
2025-06-02 15:59:39,768 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,768 - WARNING - No successful steps during online update.
2025-06-02 15:59:39,768 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], current edge mean: [ 6.1700063e+00  1.4292178e+00  4.9864254e+00 -7.3976030e-09
  0.0000000e+00  2.4658677e-09 -1.2329339e-09 -3.0823346e-09
 -2.4658677e-09  1.2329339e-09]
2025-06-02 15:59:39,769 - DEBUG - Node drift difference: 0.0184, Edge drift difference: 0.0115
2025-06-02 15:59:39,770 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.9019136e-08  3.4295343e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.1871465e-08
  1.8466723e-08 -6.5952581e-09 -1.3190516e-09  2.9019136e-08
  2.3098202e+00  2.9612725e+00  1.4661135e-01  4.3900414e+00
  6.5952581e-09  3.5532503e+00  5.6334715e+00  7.6044259e+00
  1.4661135e-01  8.0000000e+00  0.0000000e+00 -3.2976292e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.9678662e-09 -1.8466723e-08], edge=[ 6.1700063e+00  1.4292178e+00  4.9864254e+00 -7.3976030e-09
  0.0000000e+00  2.4658677e-09 -1.2329339e-09 -3.0823346e-09
 -2.4658677e-09  1.2329339e-09]
2025-06-02 15:59:39,770 - DEBUG - Updated reference std: node=[0.         0.         1.0006922  1.0006922  0.         0.
 0.         1.0006924  1.0006922  1.0006924  1.0006922  1.0006922
 1.0100604  0.27579054 0.37301496 0.5619617  1.0006924  3.101849
 2.9398093  1.5029361  0.37301496 0.         1.0006922  1.0006924
 0.         0.         0.         0.         1.0006922  1.0006924 ], edge=[1.0325518  0.50802064 1.7625387  1.0003234  1.0003234  1.0003233
 1.0003234  1.0003234  1.0003234  1.0003234 ]
2025-06-02 15:59:39,770 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:39,770 - INFO - Running anomaly detection...
2025-06-02 15:59:39,770 - INFO - Starting anomaly detection.
2025-06-02 15:59:39,809 - DEBUG - Node reconstruction errors: [24.601648 22.585604 30.755524 21.392796 17.215296 21.11457  28.765783
 19.272902 19.272915 20.720106 19.272886 20.280096 38.70506  19.774427
 20.691822 19.668737 21.03342  19.66096  23.314453 19.742327 19.325888
 20.691816 19.963316 19.5683   20.627916 20.403803 20.630657 18.631792
 19.354439 20.630653 20.954414 21.445326 19.361101 21.391417 20.355318
 21.397066 22.934338 19.742525 19.018282 18.386011 23.286709 20.816217
 19.742527 23.41724  21.693277 19.865934 24.32992  19.159277 19.484081
 34.738808 40.534897 21.35161  20.51003  23.802177 18.838953 18.088947
 31.463217 20.059198 22.521013 22.405542 17.681726 21.613098 20.98946
 20.694193 20.26563  18.838955 19.144466 18.83894  20.989733 20.989725
 19.578003 21.098879 19.3537   20.82873  23.200079 20.967793 24.231726
 21.461082 21.385162 20.962025 21.833866 21.42027  16.994886 24.858398
 19.445335 18.178776 22.395142 21.396978 21.188639 23.720293 20.349157
 17.781673 19.205711 21.380575 20.209602 34.957455 22.152586 22.445984
 21.502838 19.03525  21.42024  22.152592 23.074474 23.01274  18.662449
 19.372295 20.996626 17.787474 18.817402 29.950945 21.84754  21.887245
 19.061724 18.494493 21.291162 22.118559 21.432585 17.258204 21.106075
 20.510565 20.627329 20.349632 17.643286 19.185366 21.742659 20.510317
 18.326782 17.61932  22.814594 21.677097 22.075045 19.580988 19.558203
 18.319952 21.568644 19.241186 24.350452 21.456997 17.49628  17.014277
 20.16344  22.706005 20.707369 19.740713 19.999897 21.31906  21.432587
 19.516851 20.546679 21.242725 25.824362 19.443628 22.460651 19.580984
 22.8906   18.423346 19.766232 22.876442 21.420244 22.969927 19.9902
 17.889353 19.766235 22.07477  21.542433 16.984735 22.786049 21.551538
 18.220171 21.790197 21.11399  20.698446 20.57155  33.751102 21.947567
 20.177336 21.924984 23.379194 21.70773  21.707726 19.696264 19.119148
 20.310383 17.382393 17.839455 22.63038  21.043312 21.708307 19.557259
 20.092081 21.963596 21.704054 21.824526 19.641764 17.496986 21.553902
 16.91549  20.920033 17.08428  21.100433 21.440556 19.766079 17.893225
 21.236307 21.756908 19.205713 21.654823 19.398615 21.575111 22.603617
 21.853981 21.590605 21.334425 22.552586 22.187592 20.926302 23.325806
 21.432585 22.104565 19.641777 18.71117  21.043236 20.830397 21.334425
 19.766258 21.771719 17.509085 19.612549 21.401978 19.879377 19.775785
 22.128193 23.079565 21.432585 21.432583 21.557013 21.893194 20.8304
 19.766186 22.740662 18.137651 22.832394 19.76468  21.242748 19.876612
 22.256878 22.026608 22.129267 19.76468  19.750101 20.571537 20.668875
 22.104582 22.300905 22.11858  21.679125 20.095795 22.057932 21.4255
 21.70773  23.349997 19.159288 21.39037  20.759684 22.195671 20.595892
 23.075294 23.126806 23.075296 23.207895 17.809412 17.660946 22.526745
 22.239307 23.10818  21.70773  20.919691 22.42109  19.69621  22.341127
 19.667664 20.82682  21.744146 24.3245   23.542223 23.382925 18.551092
 18.671751 19.119152 19.208483 20.93933  22.713633 21.243538 19.876623
 18.816185 22.35615  22.683775 21.707756 21.557095 20.621817 22.091434
 22.121733 23.470745 23.470745 22.122076 22.12219  22.122185 23.30419
 22.222624 22.121958 22.122175 23.182154 22.122158 20.471647 20.661074
 22.058184 23.317816 19.73314  21.649254 21.678577 23.241184 21.21967
 21.59641  23.470753 19.67531  17.512463 21.839529 23.30419  22.786295
 22.786283 23.809505 21.946798 22.120176 23.108175 22.122158 23.30419
 21.370096 20.94816  21.839678 21.839598 22.032267 20.389061 21.839672
 24.131807 23.101723 23.075281 23.470743 23.458649 22.802052 21.547737
 22.119865 22.428152 19.086504 22.750637 20.435934 20.095787 22.474798
 22.1222   21.76606  26.967737 21.85398  21.451258 20.97522  23.4457
 23.47073  26.63192  21.205294 19.473969 21.904936 22.25043  23.181791
 23.232483 23.182009 18.421886 22.660208 24.045471 21.112795 21.084333
 23.496912 22.122192 23.470747 18.45379  20.34662  22.126604 18.453714
 22.035892 19.63495  18.986559 23.473946 22.121925 23.477942 22.616854
 22.404501 22.81557  23.85608  23.856213 23.856361 23.903881 22.517729
 23.805086 20.88706  23.238886 23.856182 22.518654 22.751173 22.404451
 23.30876  20.546606 22.404501 17.62787  23.856272 22.404503 22.518393
 23.856176 23.856258 21.315666 20.688135 23.856373 21.132921 21.689627
 20.812254 20.517277 22.445337 20.745424 18.683498 20.812252 20.882137
 23.80033  18.901163 22.140331 23.526007 20.492758 24.615662 22.49306
 23.856384 23.856205 20.88741  22.13222  19.190294 22.717834 21.982195
 21.912983 24.002527 22.304935 22.304964 18.62208  23.839409 22.355387
 22.355389 21.041115 22.51852  21.86152  20.89652  22.95865  21.861523
 20.796303 20.753353 20.612864 23.694109 22.445341 22.260096 20.494593
 20.917938 20.347067 20.606205 20.494537 21.592577 22.445341 19.55137
 22.322382 21.592583 22.260033 22.112288 18.529797 22.528818 22.445082
 22.65495  22.260096 21.982431 20.77703  23.229725 18.816826 22.005407
 20.776873 18.323025 21.985338 21.861523 19.110867 22.459446 18.36923
 23.9566   21.98247  22.321093 21.68644  22.866077 20.611536 22.656385
 26.94236  22.958643 20.777191 20.77714  21.688997 21.209997 21.556896
 21.985338 20.426165 23.10191  19.005186 20.896473 21.861519 20.663969
 22.060495 22.060629 21.861292 24.846228 21.861498 23.081087 24.319265
 24.798159 23.59824  24.319244 21.91458  23.102692 22.3554   21.985317
 22.656431 23.592804 19.108486 24.31925  22.518522 21.86152  22.958637
 22.958616 20.777233 22.656385 22.813055 23.992735 22.552603 22.958574
 22.822386 22.958532 22.82239  23.240202 24.319246 22.059917 22.05956
 22.05129  23.445524 21.200998 23.445574 23.445456 23.445528 23.44559
 23.445557 23.445524 23.445545 24.568535 22.398895 22.918074 23.445414
 23.445599 23.445553 23.445581 23.445538 23.4456   23.445517 23.445549
 23.4456   24.807959 23.44483  23.445606 24.568535 23.445534 21.861523
 24.704382 22.958643 25.127928 23.099464 29.38659  29.38659  22.34306
 25.127928 22.9586   23.10276  23.102133 22.95864  23.10171  22.95863
 21.846464 23.42994  21.915077 22.95864  22.060036 22.958645 22.958574
 23.10014  22.958626 23.102762 22.958643 22.958601 24.319258 23.102705
 22.95859  23.101477 22.958586 22.958643 22.958635 24.158247 22.866096
 22.866098 23.445604 21.754263 24.299994 22.958584 23.101933 24.76652
 23.44482  23.102762 22.752073 23.276415 22.958647 22.958645 23.431746
 24.408323 22.6666   22.958445 24.568537 23.100895 23.102617 21.308477
 23.445597 23.100527 24.319231 23.445553 23.443531 24.56854  22.958632
 22.958624 21.668936 22.666601 25.351994 24.408358 24.097042 24.738436
 24.738443 25.174023 22.296917 23.445599 22.563719 25.240057 24.408318
 23.499962 22.293417 22.778345 23.981    23.981007 23.980913 23.980936
 23.980997 25.335367 25.35237  23.981012 23.979116 23.445526 23.445381
 23.445547 24.738443 24.64258  24.738361 21.770376 24.738451 24.807917
 24.807955 23.445597 24.807953 23.445578 24.738453 22.42483  23.622118
 23.622057 23.980999 22.424843 23.410866 22.25182  23.445423 23.445585
 23.980932 22.778341 23.622217 23.611519 22.77834  22.908384 25.335363
 21.69456  23.087032 19.291569 23.969316 22.778135 21.814732 22.908394
 23.298885 23.298887 25.793894 24.563307 25.246094 22.778345 22.778301
 22.778345 22.954058 22.778343 22.778349 23.29889  22.778343 22.778345
 22.778246 24.210423 23.434858 23.902851 23.902855 24.21044  22.195286
 23.298893 24.21044 ]
2025-06-02 15:59:39,809 - DEBUG - Edge reconstruction errors: [1.0504652  1.0514473  0.6430438  ... 0.04122839 0.04028625 1.1410166 ]
2025-06-02 15:59:39,812 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155939_update_25.json
2025-06-02 15:59:39,812 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:39,816 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155939_update_25.pth and as latest_checkpoint.pth
2025-06-02 15:59:39,816 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869845.dot): 0.5733
2025-06-02 15:59:39,816 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:39,816 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.7555, MLP Score: 0.0245
2025-06-02 15:59:39,816 - WARNING -   Node ID: 192.168.27.12, Recon Error: 28.7658, MLP Score: 0.0240
2025-06-02 15:59:39,816 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.7051, MLP Score: 0.0377
2025-06-02 15:59:39,817 - WARNING -   Node ID: ff02::2, Recon Error: 34.7388, MLP Score: 0.0012
2025-06-02 15:59:39,817 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.5349, MLP Score: 0.0012
2025-06-02 15:59:39,817 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:39,817 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.6339, MLP Score: 0.9932
2025-06-02 15:59:39,817 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.9205, MLP Score: 0.9681
2025-06-02 15:59:39,817 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.6296, MLP Score: 0.1819
2025-06-02 15:59:39,817 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.8609, MLP Score: 0.0435
2025-06-02 15:59:39,817 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.1288, MLP Score: 0.0716
2025-06-02 15:59:39,817 - INFO - 
--- Processing file: nw_graph_encoded_1748869875.dot (Timestamp: 2025-06-02 15:11:15) ---
2025-06-02 15:59:39,817 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:59:39,817 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:59:39,840 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:59:39,863 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:59:39,863 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:59:39,864 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869875.dot
2025-06-02 15:59:39,882 - INFO - Parsed 730 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:59:39,902 - INFO - Parsed 1559 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869875.dot'.
2025-06-02 15:59:39,902 - INFO - Processing node updates/additions.
2025-06-02 15:59:39,906 - INFO - Processing edge updates/additions.
2025-06-02 15:59:39,915 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:39,916 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:39,916 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:39,917 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:39,925 - DEBUG - Initial node features tensor shape: torch.Size([730, 30])
2025-06-02 15:59:39,927 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:39,927 - DEBUG - Node features tensor shape after scaling: torch.Size([730, 30])
2025-06-02 15:59:39,929 - DEBUG - Edge index tensor shape: torch.Size([2, 1559])
2025-06-02 15:59:39,930 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:39,934 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-02 15:59:39,935 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:39,936 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:39,937 - DEBUG - Shape of encoded categorical edge features: torch.Size([1559, 3])
2025-06-02 15:59:39,938 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:39,939 - DEBUG - Shape of scaled numerical edge features: torch.Size([1559, 7])
2025-06-02 15:59:39,939 - DEBUG - Final edge attributes tensor shape: torch.Size([1559, 10])
2025-06-02 15:59:39,939 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:39,941 - INFO - Performing online update...
2025-06-02 15:59:39,941 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:39,942 - DEBUG - Updated RunningStats: new_mean=0.9417411459336562, new_var=14400000000160.809, new_n=1470
2025-06-02 15:59:39,942 - DEBUG - Updated RunningStats: new_mean=0.9376691856178527, new_var=14700000000019.037, new_n=1500
2025-06-02 15:59:39,942 - DEBUG - Updated RunningStats: new_mean=1.046081609655385, new_var=4800000000049.645, new_n=490
2025-06-02 15:59:39,942 - DEBUG - Updated RunningStats: new_mean=1.0458354462647295, new_var=4900000000000.826, new_n=500
2025-06-02 15:59:39,942 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:39,942 - DEBUG - Online update step: 1/50
2025-06-02 15:59:39,942 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,942 - DEBUG - Online update step: 2/50
2025-06-02 15:59:39,942 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,942 - DEBUG - Online update step: 3/50
2025-06-02 15:59:39,942 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,942 - DEBUG - Online update step: 4/50
2025-06-02 15:59:39,942 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,942 - DEBUG - Online update step: 5/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 6/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 7/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 8/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 9/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 10/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 11/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 12/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 13/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 14/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 15/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 16/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 17/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 18/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 19/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 20/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 21/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 22/50
2025-06-02 15:59:39,943 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,943 - DEBUG - Online update step: 23/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 24/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 25/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 26/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 27/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 28/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 29/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 30/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 31/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 32/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 33/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 34/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 35/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 36/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 37/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 38/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 39/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 40/50
2025-06-02 15:59:39,944 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,944 - DEBUG - Online update step: 41/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 42/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 43/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 44/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 45/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 46/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 47/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 48/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 49/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - DEBUG - Online update step: 50/50
2025-06-02 15:59:39,945 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:39,945 - WARNING - No successful steps during online update.
2025-06-02 15:59:39,946 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], current edge mean: [ 6.1776781e+00  1.4271970e+00  4.9826813e+00  0.0000000e+00
  3.6703309e-09 -2.4468874e-09  1.2234437e-09 -2.4468874e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:59:39,946 - DEBUG - Node drift difference: 0.0086, Edge drift difference: 0.0074
2025-06-02 15:59:39,947 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.5320158e-08  1.1757629e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  6.2054153e-09
 -4.1804903e-08 -3.9192094e-09 -7.8384188e-09  6.5320158e-09
  2.3013699e+00  2.9589040e+00  1.4657535e-01  4.3876715e+00
  3.9192094e-09  3.5342467e+00  5.6561642e+00  7.5999999e+00
  1.4657535e-01  8.0000000e+00  1.1104427e-08  2.4168459e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.1151701e-08  0.0000000e+00], edge=[ 6.1776781e+00  1.4271970e+00  4.9826813e+00  0.0000000e+00
  3.6703309e-09 -2.4468874e-09  1.2234437e-09 -2.4468874e-09
  4.8937747e-09  0.0000000e+00]
2025-06-02 15:59:39,947 - DEBUG - Updated reference std: node=[0.         0.         1.0006856  1.0006857  0.         0.
 0.         1.0006856  1.0006857  1.0006857  1.0006856  1.0006856
 1.0018492  0.28392488 0.37280026 0.56569636 1.0006857  3.0937886
 2.9347494  1.5104574  0.37280026 0.         1.0006857  1.0006857
 0.         0.         0.         0.         1.0006856  1.0006856 ], edge=[1.0597621 0.5076354 1.7680905 1.0003209 1.0003209 1.0003209 1.0003209
 1.0003209 1.0003209 1.0003209]
2025-06-02 15:59:39,947 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:39,947 - INFO - Running anomaly detection...
2025-06-02 15:59:39,947 - INFO - Starting anomaly detection.
2025-06-02 15:59:39,970 - DEBUG - Node reconstruction errors: [24.723066 22.402678 30.62786  21.325592 17.005491 20.956236 28.671165
 19.168968 19.168982 20.646048 19.168955 20.05674  38.392227 19.820038
 20.618475 19.575884 20.803026 19.569479 23.018711 19.651384 19.223505
 20.618473 19.777773 19.310396 20.557396 20.34269  20.559778 18.400146
 19.253601 20.559774 20.589117 24.561483 19.087961 21.3493   20.314817
 21.286125 22.707594 19.651554 18.78604  18.181103 23.20797  20.74246
 19.651554 23.339119 21.621796 19.724133 24.250505 18.87954  19.382334
 34.78219  40.633755 21.272095 20.449028 23.501701 18.736757 17.855234
 31.330017 19.963627 22.273998 23.317055 17.50622  21.497255 20.912683
 20.384045 20.198505 18.73676  19.069227 18.73675  20.912928 20.912926
 19.432682 20.955471 19.268124 20.68063  22.924082 20.826393 24.131437
 21.308416 21.220903 20.80968  21.791048 21.271418 16.779585 24.64021
 19.391308 19.07802  22.19541  21.236673 21.036608 23.464571 20.309492
 17.57963  19.002232 21.22388  20.069796 35.06023  22.081413 22.22816
 21.410824 18.979654 21.265589 22.081415 23.017162 22.833496 18.445139
 19.29006  21.079998 17.555788 18.621325 29.950583 21.63391  21.8413
 18.820843 18.285847 21.138985 21.925768 21.276806 17.061466 20.9526
 20.350218 20.578712 20.109388 17.431513 18.963346 21.579268 20.349997
 18.128683 17.41184  22.579288 21.513315 21.985441 19.530329 19.50431
 18.099327 21.405905 19.180737 24.25102  21.368643 17.296017 16.83472
 20.070534 22.493885 20.650875 19.678352 19.918087 21.169094 21.276804
 19.47219  20.435297 21.082027 25.765001 19.197111 22.220348 19.530329
 19.062963 18.211617 19.68377  22.643192 21.26559  22.920559 19.910217
 17.667631 19.683773 21.985193 21.380714 16.8063   22.539532 21.369251
 17.990759 21.600677 20.956673 20.526001 20.527643 33.85592  21.760223
 20.023617 21.724613 23.132029 21.544392 21.544392 19.599907 18.926363
 20.217855 17.192554 17.613838 22.420174 20.972849 21.551584 19.484163
 20.01096  21.768805 21.5332   21.709955 19.558008 17.296675 21.457113
 16.707256 20.847116 16.898914 20.982012 21.305239 19.683638 17.683998
 21.07173  21.605293 18.266897 21.560425 19.193079 21.478504 22.355974
 21.682892 21.430613 21.252943 22.322598 22.444216 20.846998 23.070383
 21.276804 21.938318 19.55802  18.498695 20.97278  20.779388 21.252943
 19.683796 21.593512 17.304157 19.531773 21.235556 19.626516 19.540747
 21.94724  22.818947 21.276806 21.276802 21.45969  21.712162 20.77939
 19.683733 22.629642 17.906721 22.584827 19.712828 21.08205  19.789755
 22.054705 21.85155  21.952702 19.712828 19.649454 20.527637 20.59064
 21.938335 22.090239 21.925789 21.522644 20.01411  21.94335  21.323757
 21.544392 23.063745 18.957829 21.306389 20.592459 21.995932 20.439463
 22.823181 22.855635 22.823195 22.954798 17.613338 17.454182 22.297466
 22.06297  22.848553 21.54439  20.825596 22.251259 19.599863 22.136475
 19.42771  20.740181 21.561213 24.2345   23.259857 23.292189 18.327389
 18.452251 18.926365 18.985754 20.761015 22.616602 21.144667 19.78977
 18.594086 22.222729 22.451782 21.544428 21.459759 20.457394 21.895914
 22.012915 23.195679 23.195679 22.013218 22.013315 22.01331  23.037825
 22.106909 22.013103 22.013298 22.92272  22.013287 20.375496 20.320814
 21.867464 23.095589 19.510012 21.557272 21.57331  22.980402 21.009544
 21.430464 23.195679 19.59206  17.314547 21.737131 23.03782  22.532372
 22.532368 23.543493 21.834814 22.011604 22.848547 22.013285 23.037825
 21.177507 20.86061  21.73725  21.73718  21.939886 20.3182   21.737246
 23.821932 22.859037 22.823162 23.195675 23.36126  22.55832  21.373383
 22.011248 22.231352 18.851067 22.535404 20.36063  20.014105 22.344156
 22.013325 21.668406 26.707825 21.682888 21.302565 20.84976  23.185919
 23.195673 26.692682 21.13635  19.225197 21.730627 22.05539  22.922401
 22.98334  22.922604 18.187895 22.423412 23.760998 21.045881 20.959595
 23.232094 22.013313 23.195679 18.209827 20.261932 21.92713  18.209755
 22.854342 19.569002 18.759321 23.207935 22.01309  23.306158 22.41212
 22.217764 22.605764 23.57408  23.574179 23.57428  23.613062 22.395945
 23.518496 20.77175  23.054358 23.574154 22.396732 22.539848 22.21772
 23.04211  20.405317 22.217764 17.41681  23.574217 22.217762 22.396505
 23.574154 23.57421  21.201061 20.606546 23.57429  21.07107  21.596224
 20.659657 20.430225 22.24189  20.647337 18.665142 20.659643 20.766668
 23.586905 18.67933  22.031189 23.252113 20.36117  24.299297 22.304453
 23.574299 23.57417  20.772104 21.949163 18.665144 22.544651 21.880764
 21.758831 23.883965 22.18093  22.18096  18.378162 23.626945 22.252249
 22.690067 20.933788 22.314869 21.768795 20.797543 22.820871 21.768799
 20.669157 20.65373  20.521448 23.584227 22.241896 22.067915 20.41209
 20.808037 20.116474 20.800035 20.412052 21.503124 22.241894 19.294289
 22.206263 21.50312  22.067873 21.91897  18.738455 22.317425 22.241749
 22.439503 22.067915 21.881016 20.686491 23.13371  18.572044 21.889835
 20.686375 18.093449 21.881048 21.768799 18.877745 22.361012 18.148558
 23.675505 21.881056 22.121208 21.592747 22.64402  20.520409 22.446014
 26.59883  22.820868 20.686619 21.23216  21.595562 21.091919 21.439007
 21.881048 20.174288 22.95544  18.762415 20.79751  21.768793 20.399134
 21.895802 21.895908 21.768534 24.52177  21.768766 22.93811  24.004734
 24.674492 23.324945 24.004723 21.76014  22.956024 22.252258 21.881025
 22.44605  23.451088 18.886469 24.004726 22.314867 21.768797 22.820864
 22.820843 20.686646 22.446016 22.608206 23.687742 22.352468 22.820812
 22.621296 22.820774 22.621304 23.265629 24.004723 21.8953   21.894985
 21.888165 23.287092 21.024323 23.28713  23.28704  23.287102 23.287144
 23.287119 23.287092 23.287111 24.245531 22.225689 22.804836 23.287012
 23.28715  23.287113 23.28714  23.28711  23.28715  23.287086 23.287111
 23.28715  24.47237  23.286552 23.287159 24.245527 23.287104 21.768793
 24.525457 22.820866 24.929256 22.86429  29.219027 29.219027 22.153936
 24.929256 22.820831 22.956076 22.9556   22.82086  22.955275 22.820852
 22.07111  23.274858 21.76057  22.820864 21.895426 22.820866 22.820814
 22.953976 22.820854 22.95608  22.820864 22.820833 24.00473  22.956038
 22.820827 22.95507  22.820826 22.820868 22.820856 23.855614 22.644041
 22.644041 23.28715  21.573744 24.118235 22.82082  22.955456 24.440472
 23.286564 22.95608  22.54672  23.115139 22.820868 22.820864 23.195667
 24.097178 22.476677 22.820711 24.245531 22.954634 22.955969 20.986712
 23.287151 22.954285 24.004705 23.287119 23.285593 24.245533 22.82086
 22.820848 21.49928  22.476677 25.005358 24.097202 23.961836 24.418457
 24.41846  24.976807 22.185925 23.28715  22.382    24.890425 24.097176
 23.2627   22.18189  22.645908 23.796175 23.796179 23.796104 23.796124
 23.796171 24.977152 25.009731 23.79618  23.794704 23.287096 23.286991
 23.287111 24.41846  24.318417 24.418402 21.649109 24.418457 24.596544
 24.472372 23.287151 24.472372 23.287134 24.41846  22.303194 23.44971
 23.449667 23.796175 22.303205 23.171125 22.112741 23.287014 23.28714
 23.79612  22.64591  23.449787 23.441435 22.64591  22.767853 24.977152
 21.499748 22.934721 19.02359  23.72434  22.645664 21.675978 22.767859
 23.143297 23.1433   25.426353 24.351198 24.90158  22.645916 22.645864
 22.645912 22.809345 22.645916 22.645916 23.1433   22.645916 22.645912
 22.645794 23.958395 23.27323  23.650614 23.897005 23.958408 22.051334
 23.143305 23.89701  26.014177 23.669426 23.81673  23.681208 23.543724
 23.544262 23.143293]
2025-06-02 15:59:39,971 - DEBUG - Edge reconstruction errors: [1.0511407  1.0520793  0.64421797 ... 0.04246784 0.04153342 1.1422002 ]
2025-06-02 15:59:39,976 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155939_update_26.json
2025-06-02 15:59:39,976 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:39,980 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155939_update_26.pth and as latest_checkpoint.pth
2025-06-02 15:59:39,980 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869875.dot): 0.5650
2025-06-02 15:59:39,980 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:39,981 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.6279, MLP Score: 0.0244
2025-06-02 15:59:39,981 - WARNING -   Node ID: 192.168.27.12, Recon Error: 28.6712, MLP Score: 0.0240
2025-06-02 15:59:39,981 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.3922, MLP Score: 0.0382
2025-06-02 15:59:39,981 - WARNING -   Node ID: ff02::2, Recon Error: 34.7822, MLP Score: 0.0012
2025-06-02 15:59:39,981 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.6338, MLP Score: 0.0012
2025-06-02 15:59:39,981 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:39,981 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.0102, MLP Score: 0.9975
2025-06-02 15:59:39,981 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 14.9385, MLP Score: 0.9488
2025-06-02 15:59:39,981 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 7.1970, MLP Score: 0.1688
2025-06-02 15:59:39,981 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 5.0508, MLP Score: 0.0517
2025-06-02 15:59:39,981 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 4.0338, MLP Score: 0.0724
2025-06-02 15:59:40,000 - DEBUG - Embedding standard deviations before t-SNE: [2.4748802  0.48117852 0.         0.01360584 2.3921313  0.
 0.6098711  0.         0.         1.5648495  2.3413904  0.4042977
 0.         0.58137363 0.         0.3708567  1.1914835  0.
 0.         0.4274795  0.         0.         0.01043702 2.2049046
 0.         2.0342023  0.0450339  0.         0.         0.
 0.9365619  0.37560514]
2025-06-02 15:59:40,976 - INFO - Embeddings visualization saved to vis/embeddings_26_updates_20250602_155939.png
2025-06-02 15:59:40,977 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:40,978 - INFO - Starting visualization of node features.
2025-06-02 15:59:40,978 - INFO - Graph has 730 nodes and 30 features.
2025-06-02 15:59:40,978 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:40,978 - INFO - Calculating feature statistics:
2025-06-02 15:59:40,978 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,978 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,978 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.5024931), 'max': np.float32(2.2060432)}
2025-06-02 15:59:40,978 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(-4.1804903e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.137797), 'max': np.float32(2.5623133)}
2025-06-02 15:59:40,978 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,978 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,979 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,979 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-5.225613e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.43019173), 'max': np.float32(2.3245447)}
2025-06-02 15:59:40,979 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-4.7030515e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1705256), 'max': np.float32(0.8543171)}
2025-06-02 15:59:40,979 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-9.39341), 'max': np.float32(0.10967602)}
2025-06-02 15:59:40,979 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 14, 'mean': np.float32(2.0902451e-08), 'std': np.float32(0.99999994), 'min': np.float32(-3.5601614), 'max': np.float32(1.563953)}
2025-06-02 15:59:40,979 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5274093), 'max': np.float32(3.6428556)}
2025-06-02 15:59:40,979 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.30137), 'std': np.float32(1.0011629), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:59:40,979 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.958904), 'std': np.float32(0.28373036), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:40,979 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:40,979 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3876715), 'std': np.float32(0.56530875), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:40,979 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-1.0451226e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10967602), 'max': np.float32(9.39341)}
2025-06-02 15:59:40,979 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.5342467), 'std': np.float32(3.091669), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:59:40,979 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.656164), 'std': np.float32(2.9327388), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:40,980 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6), 'std': np.float32(1.5094225), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:40,980 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14657535), 'std': np.float32(0.37254483), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:40,980 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-02 15:59:40,980 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.838419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13171281), 'max': np.float32(15.049921)}
2025-06-02 15:59:40,980 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.874087e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14484136), 'max': np.float32(6.904105)}
2025-06-02 15:59:40,980 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,980 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,980 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,980 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:40,980 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(3.6579287e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.0050753), 'max': np.float32(8.777658)}
2025-06-02 15:59:40,980 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(5.225613e-09), 'std': np.float32(1.0), 'min': np.float32(-1.108116), 'max': np.float32(4.419843)}
2025-06-02 15:59:40,992 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a0d03200>
2025-06-02 15:59:41,124 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:41,175 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:41,203 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:42,507 - INFO - Node feature visualization saved to vis/node_features_20250602_155941.png
2025-06-02 15:59:42,507 - INFO - Finished visualization of node features.
2025-06-02 15:59:42,507 - INFO - Performing additional feature analysis:
2025-06-02 15:59:42,507 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:42,508 - INFO - Starting visualization of edge features.
2025-06-02 15:59:42,508 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:59:42,508 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:42,508 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:42,509 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:42,509 - INFO - - count: {'name': 'count', 'unique': 16, 'mean': np.float32(6.177678), 'std': np.float32(1.0594223), 'min': np.float32(0.0), 'max': np.float32(15.0)}
2025-06-02 15:59:42,509 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.427197), 'std': np.float32(0.50747263), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:42,509 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9826813), 'std': np.float32(1.7675233), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 15:59:42,509 - INFO - - service: {'name': 'service', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-0.045147676), 'max': np.float32(30.35215)}
2025-06-02 15:59:42,509 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1049, 'mean': np.float32(2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0737332), 'max': np.float32(29.76732)}
2025-06-02 15:59:42,509 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1107, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(1.0), 'min': np.float32(-0.065595634), 'max': np.float32(30.237577)}
2025-06-02 15:59:42,509 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 347, 'mean': np.float32(4.8937747e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.053769764), 'max': np.float32(30.348267)}
2025-06-02 15:59:42,509 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1081, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.12731944), 'max': np.float32(19.25056)}
2025-06-02 15:59:42,509 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1095, 'mean': np.float32(-6.1172184e-10), 'std': np.float32(1.0), 'min': np.float32(-0.124131665), 'max': np.float32(20.257381)}
2025-06-02 15:59:42,509 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 404, 'mean': np.float32(-2.4468874e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.06376676), 'max': np.float32(29.849796)}
2025-06-02 15:59:42,520 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a16caea0>
2025-06-02 15:59:42,601 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:42,611 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a099f75d60>
2025-06-02 15:59:42,697 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:42,910 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:43,179 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:43,191 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:43,196 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:44,457 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155943.png
2025-06-02 15:59:44,458 - INFO - Finished visualization of edge features.
2025-06-02 15:59:44,458 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:44,458 - INFO - - Highest correlation (1.00) between features: 'service' and 'total_orig_pkts'.
2025-06-02 15:59:44,459 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:44,459 - INFO - Graph has 1559 edges and 10 edge features.
2025-06-02 15:59:44,459 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:44,762 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155944_summary.png
2025-06-02 15:59:45,007 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155944_pca_3d.png
2025-06-02 15:59:45,207 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155944_pca_variance.png
2025-06-02 15:59:45,207 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:45,207 - INFO - 
--- Processing file: nw_graph_encoded_1748869905.dot (Timestamp: 2025-06-02 15:11:45) ---
2025-06-02 15:59:45,207 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:59:45,207 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:59:45,221 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:59:45,236 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:59:45,236 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:59:45,236 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869905.dot
2025-06-02 15:59:45,252 - INFO - Parsed 736 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:59:45,270 - INFO - Parsed 1571 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869905.dot'.
2025-06-02 15:59:45,270 - INFO - Processing node updates/additions.
2025-06-02 15:59:45,275 - INFO - Processing edge updates/additions.
2025-06-02 15:59:45,285 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:45,286 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:45,286 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:45,288 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:45,295 - DEBUG - Initial node features tensor shape: torch.Size([736, 30])
2025-06-02 15:59:45,297 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:45,297 - DEBUG - Node features tensor shape after scaling: torch.Size([736, 30])
2025-06-02 15:59:45,299 - DEBUG - Edge index tensor shape: torch.Size([2, 1571])
2025-06-02 15:59:45,300 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:45,303 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-02 15:59:45,304 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:45,305 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:45,307 - DEBUG - Shape of encoded categorical edge features: torch.Size([1571, 3])
2025-06-02 15:59:45,308 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:45,308 - DEBUG - Shape of scaled numerical edge features: torch.Size([1571, 7])
2025-06-02 15:59:45,308 - DEBUG - Final edge attributes tensor shape: torch.Size([1571, 10])
2025-06-02 15:59:45,308 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:45,310 - INFO - Performing online update...
2025-06-02 15:59:45,310 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:45,311 - DEBUG - Updated RunningStats: new_mean=0.9419710684142605, new_var=15000000000160.754, new_n=1530
2025-06-02 15:59:45,311 - DEBUG - Updated RunningStats: new_mean=0.9380401861293707, new_var=15300000000019.012, new_n=1560
2025-06-02 15:59:45,311 - DEBUG - Updated RunningStats: new_mean=1.0499790858948073, new_var=5000000000049.513, new_n=510
2025-06-02 15:59:45,311 - DEBUG - Updated RunningStats: new_mean=1.049691325651369, new_var=5100000000000.852, new_n=520
2025-06-02 15:59:45,312 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:45,312 - DEBUG - Online update step: 1/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 2/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 3/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 4/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 5/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 6/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 7/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 8/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 9/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 10/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 11/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 12/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 13/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,312 - DEBUG - Online update step: 14/50
2025-06-02 15:59:45,312 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 15/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 16/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 17/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 18/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 19/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 20/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 21/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 22/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 23/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 24/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 25/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 26/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 27/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 28/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 29/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 30/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 31/50
2025-06-02 15:59:45,313 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,313 - DEBUG - Online update step: 32/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 33/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 34/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 35/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 36/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 37/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 38/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 39/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 40/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 41/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 42/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 43/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 44/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 45/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 46/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 47/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 48/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 49/50
2025-06-02 15:59:45,314 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,314 - DEBUG - Online update step: 50/50
2025-06-02 15:59:45,315 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,315 - WARNING - No successful steps during online update.
2025-06-02 15:59:45,315 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], current edge mean: [ 6.1763210e+00  1.4252069e+00  4.9700828e+00 -6.0704921e-09
 -4.2493444e-09  6.0704919e-10 -3.6422954e-09 -4.2493444e-09
  6.0704919e-10  1.8211477e-09]
2025-06-02 15:59:45,315 - DEBUG - Node drift difference: 0.0102, Edge drift difference: 0.0071
2025-06-02 15:59:45,316 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.7942866e-08 -1.6844790e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.1266424e-09
  2.9802322e-08 -9.0702716e-09  1.1661778e-08  2.5915063e-09
  2.2975543e+00  2.9592392e+00  1.4673913e-01  4.3885870e+00
  9.0702716e-09  3.5027175e+00  5.6752715e+00  7.5951085e+00
  1.4673913e-01  8.0000000e+00  2.4619309e-08 -8.4223952e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.4985334e-08 -6.4787656e-08], edge=[ 6.1763210e+00  1.4252069e+00  4.9700828e+00 -6.0704921e-09
 -4.2493444e-09  6.0704919e-10 -3.6422954e-09 -4.2493444e-09
  6.0704919e-10  1.8211477e-09]
2025-06-02 15:59:45,316 - DEBUG - Updated reference std: node=[0.         0.         1.0006801  1.0006801  0.         0.
 0.         1.00068    1.00068    1.0006801  1.00068    1.0006801
 0.9868769  0.2827878  0.37280363 0.5652814  1.0006801  3.0891504
 2.9303455  1.5187457  0.37280363 0.         1.0006801  1.0006801
 0.         0.         0.         0.         1.0006801  1.0006801 ], edge=[1.0558177 0.507248  1.784861  1.0003184 1.0003184 1.0003184 1.0003184
 1.0003184 1.0003184 1.0003184]
2025-06-02 15:59:45,317 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:45,317 - INFO - Running anomaly detection...
2025-06-02 15:59:45,317 - INFO - Starting anomaly detection.
2025-06-02 15:59:45,323 - DEBUG - Node reconstruction errors: [24.696085 22.547585 30.760242 21.353298 17.039356 21.001026 28.796926
 19.207893 19.207909 20.680882 19.207882 20.142578 38.577564 19.827295
 20.655712 19.611752 20.883512 19.605291 23.092573 19.69213  19.278303
 20.655708 19.802864 19.382923 20.59963  20.374678 20.601892 18.463379
 19.298803 20.601889 20.680683 24.613148 19.129154 21.38087  20.345154
 21.310402 22.744078 19.69229  18.838778 18.246508 23.255566 20.783314
 19.69229  23.377253 21.661213 19.76113  24.294807 18.929754 19.430748
 34.830265 40.735245 21.317665 20.484415 23.582119 18.781466 17.883509
 31.591038 20.009577 22.342451 23.336998 17.571468 21.519587 20.954449
 20.424952 20.234985 18.781466 19.111662 18.781454 20.954685 20.954685
 19.456762 21.028166 19.30467  20.749147 22.975462 20.900145 24.154997
 21.376993 21.275702 20.87722  21.825724 21.333305 16.802608 24.589514
 19.41221  19.093292 22.236776 21.28678  21.104403 23.982876 20.34231
 17.624638 19.06168  21.27766  20.11073  35.15886  22.117367 22.253849
 21.449709 19.010271 21.334171 22.11737  23.047132 22.879978 18.477783
 19.321835 21.078909 17.813341 18.683352 29.954428 21.654707 21.87637
 18.859991 18.344402 21.198442 21.957703 21.334135 17.103998 21.00893
 20.380598 20.60753  20.14768  17.473011 19.008852 21.627047 20.380384
 18.186363 17.465021 22.6343   21.533693 22.023611 19.5597   19.535984
 18.12902  21.458668 19.208687 24.279226 21.40807  17.344973 16.878395
 20.075548 22.54052  20.677835 19.701519 19.93056  21.229916 21.334135
 19.502983 20.476501 21.134119 25.803984 19.236113 22.298153 19.559702
 19.075409 18.251808 19.715467 22.686718 21.334173 22.952995 19.922976
 17.702492 19.715467 22.023363 21.446138 16.849583 22.61945  21.422205
 18.015497 21.632977 21.022684 20.549202 20.557512 33.958347 22.239851
 20.04057  21.777973 23.174019 21.607716 21.607716 19.624989 18.991394
 20.251856 17.246788 17.641417 22.590132 20.993187 21.609962 19.505371
 20.034082 22.82775  21.579302 21.721727 19.5942   17.345577 21.480516
 16.740011 20.866034 16.947453 21.000994 21.339289 19.71534  17.73309
 21.134613 21.66513  18.285988 21.5996   19.201406 21.515358 22.429943
 21.74179  21.485126 21.284517 22.364489 22.455837 20.872929 23.113466
 21.334137 22.001514 19.594213 18.55522  20.99312  20.805902 21.284513
 19.715488 21.65022  17.334269 19.568232 21.296352 19.653868 19.578749
 21.986835 22.853502 21.33414  21.334133 21.483051 21.751507 20.805904
 19.715433 22.642416 17.935596 22.62882  19.740274 21.134144 19.822844
 22.078655 21.899754 21.999239 19.740274 19.680182 20.557505 20.625845
 22.001526 22.127672 21.95772  21.581022 20.037174 21.968952 21.335964
 21.607716 23.118353 19.019703 21.337574 20.619684 22.038246 20.472612
 22.89465  22.869787 22.894659 22.999424 17.655855 17.499552 22.355072
 22.073053 22.922451 21.607716 20.85632  22.311647 19.624947 22.158834
 19.896767 20.773731 21.599155 24.271048 23.471346 23.328918 18.35317
 18.504194 18.991394 19.017954 20.781328 22.639439 21.178894 19.822853
 18.624523 22.236416 22.489782 21.607756 21.48312  20.46357  21.937433
 22.041935 23.262026 23.262028 22.042233 22.042328 22.042322 23.108986
 22.132845 22.04212  22.04231  19.568932 22.042301 20.389746 20.61141
 21.921562 23.115881 19.557426 21.583372 21.591501 23.046865 21.023684
 21.489855 23.262032 19.608992 17.36506  21.770327 23.108995 22.604147
 22.60414  23.618475 21.848946 22.04071  22.922447 22.042297 23.108995
 21.403267 20.892426 21.770443 21.770376 21.969095 20.348337 21.77044
 23.858263 22.90787  22.89463  23.262026 23.394552 22.632961 21.42987
 22.040308 22.264872 18.895048 22.57903  20.389809 20.03717  22.360636
 22.042336 21.703428 26.732977 21.741793 21.323061 20.871845 23.226044
 23.262026 26.757647 21.15604  19.243433 21.777285 22.090668 22.961765
 23.02084  22.961956 18.743967 22.485537 23.794146 21.066313 20.993158
 23.261625 22.042328 23.262032 18.229666 20.273262 21.953455 18.229603
 22.88084  19.592632 18.78708  23.278467 22.042109 23.353582 22.445566
 22.261433 22.634548 23.636604 23.636711 23.636822 23.661797 22.41739
 23.561703 20.775738 23.094086 23.636683 22.41813  22.587337 22.261393
 23.105457 20.417479 22.26143  17.459919 23.636757 22.26143  22.41792
 23.636679 23.636742 21.200348 20.631945 23.636824 21.093086 21.602533
 20.667915 20.44946  22.275692 20.64847  18.669353 20.6679   20.77077
 23.620337 18.730627 22.048096 23.312248 20.365767 24.340532 22.343803
 23.636833 23.636705 20.776094 21.986595 18.66935  22.556139 21.881975
 21.775658 21.205957 22.167162 22.167196 18.3993   22.772732 21.251253
 22.673943 20.928654 22.355343 21.774988 20.799208 22.832796 21.774988
 20.657766 20.654715 20.528687 23.57507  22.2757   22.107866 20.424368
 20.801428 20.157568 20.79391  20.424328 21.521395 22.275692 19.309742
 22.204145 21.521395 22.10783  21.949535 18.73954  22.335667 22.275564
 22.465328 22.107866 21.882221 20.693941 23.143444 18.587729 21.88126
 22.857021 18.113214 21.890724 21.774988 18.91146  22.364672 18.175537
 23.703    21.882257 22.14741  21.599125 22.66624  20.527697 22.476038
 26.655832 22.832794 20.694063 21.205183 21.601908 21.079157 21.458261
 21.890724 20.194805 22.961397 18.777674 20.799175 21.774992 20.64555
 21.906319 21.906431 22.342522 24.559313 21.774963 22.943493 24.050201
 24.666872 23.357616 24.050188 21.776875 22.96198  22.257923 21.890703
 22.476074 23.455969 18.92354  24.050194 22.355345 21.774988 22.832788
 22.832764 20.694088 22.47604  22.641432 23.731098 22.381771 22.832733
 22.664425 22.832695 22.664429 23.268805 24.050184 21.905844 21.905529
 21.898722 23.286285 21.026508 23.286322 23.286224 23.28629  23.286335
 23.286312 23.286285 23.286295 24.286602 22.230076 22.798079 23.286203
 23.286346 23.286308 23.286333 23.286295 23.286346 23.286278 23.286303
 23.286346 24.504763 23.285725 23.286346 24.286608 23.28629  21.774992
 24.515911 22.83279  24.91014  22.877428 29.182484 29.182484 22.187693
 24.91014  22.832754 22.962036 22.961554 22.832787 22.961212 22.832773
 22.05962  23.273643 21.777288 22.832783 21.905972 22.832787 22.832731
 22.959875 22.832775 22.962032 22.832788 22.832756 24.050198 22.961994
 22.832747 22.96099  22.832743 22.832792 22.832783 23.898588 22.666252
 22.666258 23.286346 21.586983 24.107552 22.832737 22.961407 24.471252
 23.285753 22.962034 22.570068 23.112814 22.832794 22.83279  23.205484
 24.135952 22.512785 22.832624 24.286608 22.960583 22.961914 21.030302
 23.286343 22.96018  24.050173 23.28631  23.28479  24.286604 22.83278
 22.832773 21.504435 22.512781 25.029016 24.135977 24.460867 24.459436
 24.459444 24.954603 22.180882 23.286343 22.379244 24.911882 24.135946
 23.274721 22.177265 22.628471 23.781902 23.78191  23.78184  23.781853
 23.781904 24.99491  25.038603 23.78191  23.780382 23.286285 23.286186
 23.286306 24.459444 24.34924  24.459387 21.643986 24.459446 24.60815
 24.504763 23.286345 24.504765 23.286324 24.459448 22.30171  23.441687
 23.441637 23.781904 22.301723 23.184841 22.095251 23.286207 23.286333
 23.781849 22.628471 23.441763 23.43314  22.628471 22.754047 24.994911
 21.488953 22.913073 19.244392 23.731932 22.628298 21.662415 22.754053
 23.112522 23.112526 25.438023 24.323538 24.92828  22.628471 22.628437
 22.628471 22.784336 22.628468 22.628468 23.112528 22.628473 22.628466
 22.628386 23.96038  23.245203 23.654047 23.890085 23.9604   22.020521
 23.112532 23.890093 25.99873  23.617716 23.772745 23.635271 23.504856
 23.505405 23.112528 19.44989  22.486513 23.635275 24.901947 24.275967
 24.39646 ]
2025-06-02 15:59:45,324 - DEBUG - Edge reconstruction errors: [1.0509813  1.0518918  0.6444333  ... 0.04270804 0.04177966 1.1424063 ]
2025-06-02 15:59:45,325 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155945_update_27.json
2025-06-02 15:59:45,325 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:45,329 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155945_update_27.pth and as latest_checkpoint.pth
2025-06-02 15:59:45,329 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869905.dot): 0.5660
2025-06-02 15:59:45,329 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:45,329 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.7602, MLP Score: 0.0244
2025-06-02 15:59:45,329 - WARNING -   Node ID: 192.168.27.12, Recon Error: 28.7969, MLP Score: 0.0239
2025-06-02 15:59:45,329 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.5776, MLP Score: 0.0380
2025-06-02 15:59:45,329 - WARNING -   Node ID: ff02::2, Recon Error: 34.8303, MLP Score: 0.0012
2025-06-02 15:59:45,329 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.7352, MLP Score: 0.0012
2025-06-02 15:59:45,329 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 15:59:45,329 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 19.7131, MLP Score: 0.9973
2025-06-02 15:59:45,329 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.8856, MLP Score: 0.9745
2025-06-02 15:59:45,329 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 6.8803, MLP Score: 0.1430
2025-06-02 15:59:45,330 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 5.0970, MLP Score: 0.0530
2025-06-02 15:59:45,330 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.9581, MLP Score: 0.0667
2025-06-02 15:59:45,330 - INFO - 
--- Processing file: nw_graph_encoded_1748869935.dot (Timestamp: 2025-06-02 15:12:15) ---
2025-06-02 15:59:45,330 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:59:45,330 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:59:45,351 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:59:45,371 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:59:45,371 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:59:45,371 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869935.dot
2025-06-02 15:59:45,387 - INFO - Parsed 762 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:59:45,404 - INFO - Parsed 1619 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869935.dot'.
2025-06-02 15:59:45,404 - INFO - Processing node updates/additions.
2025-06-02 15:59:45,408 - INFO - Processing edge updates/additions.
2025-06-02 15:59:45,416 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:45,417 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:45,417 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:45,418 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:45,425 - DEBUG - Initial node features tensor shape: torch.Size([762, 30])
2025-06-02 15:59:45,426 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:45,426 - DEBUG - Node features tensor shape after scaling: torch.Size([762, 30])
2025-06-02 15:59:45,427 - DEBUG - Edge index tensor shape: torch.Size([2, 1619])
2025-06-02 15:59:45,428 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:45,431 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-02 15:59:45,432 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:45,433 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:45,434 - DEBUG - Shape of encoded categorical edge features: torch.Size([1619, 3])
2025-06-02 15:59:45,435 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:45,435 - DEBUG - Shape of scaled numerical edge features: torch.Size([1619, 7])
2025-06-02 15:59:45,435 - DEBUG - Final edge attributes tensor shape: torch.Size([1619, 10])
2025-06-02 15:59:45,435 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:45,437 - INFO - Performing online update...
2025-06-02 15:59:45,437 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:45,437 - DEBUG - Updated RunningStats: new_mean=0.9421525034829301, new_var=15600000000160.803, new_n=1590
2025-06-02 15:59:45,437 - DEBUG - Updated RunningStats: new_mean=0.9383199389642939, new_var=15900000000018.898, new_n=1620
2025-06-02 15:59:45,438 - DEBUG - Updated RunningStats: new_mean=1.0536030081021899, new_var=5200000000049.518, new_n=530
2025-06-02 15:59:45,438 - DEBUG - Updated RunningStats: new_mean=1.0532406954793467, new_var=5300000000000.8545, new_n=540
2025-06-02 15:59:45,438 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:45,438 - DEBUG - Online update step: 1/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 2/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 3/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 4/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 5/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 6/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 7/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 8/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 9/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 10/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 11/50
2025-06-02 15:59:45,438 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,438 - DEBUG - Online update step: 12/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 13/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 14/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 15/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 16/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 17/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 18/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 19/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 20/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 21/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 22/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 23/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 24/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 25/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 26/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 27/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 28/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 29/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 30/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 31/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,439 - DEBUG - Online update step: 32/50
2025-06-02 15:59:45,439 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 33/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 34/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 35/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 36/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 37/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 38/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 39/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 40/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 41/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 42/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 43/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 44/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 45/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 46/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 47/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 48/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 49/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - DEBUG - Online update step: 50/50
2025-06-02 15:59:45,440 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,440 - WARNING - No successful steps during online update.
2025-06-02 15:59:45,441 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], current edge mean: [ 6.1741815e+00  1.4200124e+00  4.9759111e+00  2.3562059e-09
 -1.7671544e-09  3.5343088e-09 -4.1233603e-09  0.0000000e+00
 -1.7671544e-09  5.8905147e-10]
2025-06-02 15:59:45,441 - DEBUG - Node drift difference: 0.0179, Edge drift difference: 0.0102
2025-06-02 15:59:45,442 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.1288529e-08 -4.8810104e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.5043151e-08
 -2.2527740e-08  3.7546233e-09 -8.1350171e-09 -2.0024657e-08
  2.2979002e+00  2.9606299e+00  1.4041995e-01  4.3923883e+00
 -3.7546233e-09  3.4475067e+00  5.7073493e+00  7.5931759e+00
  1.4041995e-01  8.0000000e+00 -6.8834760e-09  7.5092466e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2515411e-08  3.0036986e-08], edge=[ 6.1741815e+00  1.4200124e+00  4.9759111e+00  2.3562059e-09
 -1.7671544e-09  3.5343088e-09 -4.1233603e-09  0.0000000e+00
 -1.7671544e-09  5.8905147e-10]
2025-06-02 15:59:45,442 - DEBUG - Updated reference std: node=[0.         0.         1.0006568  1.0006568  0.         0.
 0.         1.0006568  1.0006567  1.0006567  1.0006568  1.0006568
 0.97361827 0.27801365 0.36245453 0.5658664  1.0006567  3.0614383
 2.9225075  1.5215856  0.36245453 0.         1.0006568  1.0006568
 0.         0.         0.         0.         1.0006568  1.0006568 ], edge=[1.0473584 0.5060766 1.7847834 1.000309  1.000309  1.000309  1.000309
 1.000309  1.000309  1.000309 ]
2025-06-02 15:59:45,442 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:45,442 - INFO - Running anomaly detection...
2025-06-02 15:59:45,442 - INFO - Starting anomaly detection.
2025-06-02 15:59:45,465 - DEBUG - Node reconstruction errors: [25.06593  22.74954  31.425484 21.430256 17.147957 21.094812 30.357557
 19.347748 19.347761 20.794218 19.347744 20.428965 39.551456 20.124853
 20.780996 19.739296 21.148577 19.733486 23.381702 19.834133 19.451715
 20.780994 20.083752 19.633091 20.736053 20.456533 20.737768 18.673626
 19.450413 20.737766 21.019613 24.77846  19.279604 21.487957 20.43805
 21.393618 22.892561 19.834263 19.005459 19.39375  23.40468  20.914572
 19.834267 23.49692  20.840788 19.927162 24.428253 19.114553 19.587524
 35.01048  41.113102 21.449724 20.571146 23.878958 18.863485 17.973467
 31.974333 20.15661  22.515749 23.445593 17.696432 21.59368  21.0849
 20.580301 20.319447 18.863487 19.179142 18.863482 21.085083 21.085085
 19.466068 21.144981 19.35465  20.856377 23.156694 21.028751 24.224295
 21.494413 21.330294 20.972591 21.93035  21.462166 16.867083 24.673777
 19.477776 19.092094 22.227278 21.357445 21.216513 24.113459 20.435884
 17.744598 19.149069 21.372133 20.276697 35.52465  22.17501  22.315374
 21.56181  19.091534 21.421045 22.175016 23.129065 22.954535 19.160652
 19.31783  19.143267 17.852226 18.862532 29.997803 21.776344 21.979742
 18.98181  18.523579 21.35332  22.036997 21.48149  17.143341 21.156017
 20.51652  20.682617 20.26817  17.499617 19.163927 21.697084 20.516357
 18.27018  17.518242 23.195282 21.65964  22.123274 19.634638 19.611607
 18.209602 21.593906 19.279453 24.356112 21.521265 18.168854 17.010685
 20.073019 22.660395 20.742405 19.755568 19.949774 21.38644  21.481495
 19.582743 20.595636 21.268091 25.83553  19.354614 22.549507 19.634632
 19.168905 18.403708 19.72591  22.824764 21.42105  23.043705 19.943823
 17.787975 19.725914 22.123068 21.51926  16.980616 22.87123  21.449968
 18.256887 21.707897 21.103817 20.664494 20.637947 34.331543 22.211462
 20.090834 21.92114  23.289242 21.663582 21.663582 19.591475 19.09542
 20.288664 17.310091 17.625088 22.571096 21.032406 21.703815 19.54989
 20.002993 23.105776 21.645502 21.690954 19.639915 18.169476 21.488092
 16.811556 20.905552 17.004263 20.99057  21.442225 19.725773 17.870699
 21.201725 21.776335 18.22541  21.703959 19.330366 21.621895 22.67048
 21.779432 21.62455  21.325201 22.501837 22.468943 20.86105  23.233747
 21.481495 22.059929 19.639929 18.755388 21.032354 20.869787 21.325201
 19.725935 22.784779 17.424196 19.621527 21.346958 19.727468 19.597528
 22.030285 23.171766 21.481497 21.481493 21.49095  21.79639  20.869791
 19.725864 22.62505  17.995335 22.759367 19.806356 21.268106 19.845198
 22.088177 21.976236 22.112692 19.806356 20.43819  20.637938 20.677155
 22.059937 22.199144 22.037004 21.73176  20.006481 22.037304 21.275785
 21.663582 23.299417 19.10876  21.37378  20.741423 22.709484 20.611223
 23.131754 23.103495 23.131771 23.170097 17.676361 17.533949 22.54226
 22.1034   23.154428 21.663582 20.876152 22.366434 19.591421 22.311916
 19.953316 20.802298 21.686993 24.36457  23.584267 23.418318 18.426003
 18.556519 19.095425 19.09366  21.438866 22.640585 21.265924 19.845213
 16.436007 22.273138 22.634947 21.663588 21.491024 20.599821 21.906065
 22.115992 23.46898  23.468983 22.116234 22.1163   22.116293 23.330168
 22.197868 22.116137 22.116293 19.823418 22.11628  20.32544  20.706104
 22.042112 23.14596  19.598196 21.59865  21.581806 23.269642 21.099262
 21.556408 23.468983 18.12188  17.415531 21.861658 23.330164 22.835594
 22.835588 23.854588 21.821135 22.115093 23.15443  22.116278 23.330168
 21.44386  20.910564 21.861742 21.86169  22.056675 20.354649 21.861748
 23.993538 23.09749  23.623158 23.46898  23.477995 22.876265 21.46234
 22.114674 22.295717 19.060705 22.6688   20.390633 20.006481 22.399448
 22.116308 21.800457 26.809338 21.779428 21.371668 20.955221 23.342337
 23.468987 27.012857 21.189484 19.742805 21.895515 22.17492  23.072939
 23.126139 23.07312  18.756311 22.663591 23.941576 21.111055 21.080395
 23.396086 22.116299 23.46898  18.268309 20.280634 22.007666 18.468267
 22.907188 19.64228  18.849575 23.500637 22.116137 23.469055 22.393946
 22.244953 22.566935 23.831757 23.831831 23.831915 23.74989  22.466228
 23.71858  20.673487 23.176662 23.831812 22.466774 22.686596 22.244902
 23.313438 20.37276  22.244951 17.56778  23.831865 22.244953 22.466616
 23.831812 23.831856 21.166178 20.61519  23.831917 21.134855 21.592703
 20.606697 21.108366 22.346802 20.621403 18.564695 20.606693 20.668005
 23.550703 18.766045 22.006617 23.507221 20.248533 24.476414 22.435734
 23.831923 23.831827 20.67388  22.070759 18.564692 22.573421 21.85149
 21.802599 21.107227 22.092619 22.242773 18.43432  22.74639  21.151085
 22.587551 20.877539 23.256863 21.759418 20.770044 22.844357 21.759422
 20.588694 20.62644  20.519434 23.517174 22.3468   22.198181 20.429192
 20.7515   20.260935 20.745861 20.429163 21.472683 22.3468   19.335228
 22.167006 21.472681 22.198158 22.012966 18.952702 22.362827 22.34677
 23.121862 22.198183 21.851677 20.679941 23.143639 18.620747 21.830362
 21.15008  18.7266   24.154278 21.75942  19.757874 22.335854 18.24453
 23.772913 21.851711 22.966444 21.589888 22.699524 20.51868  22.531921
 26.85946  22.844349 20.68004  21.10652  21.592213 21.10709  21.431852
 21.805822 20.22926  22.957014 18.80739  20.770018 21.759418 20.62222
 21.916712 21.916798 22.242327 24.680168 22.24286  22.942833 24.190058
 24.604973 23.44129  24.19005  21.803469 22.957449 22.235394 21.8058
 22.53195  23.435272 19.000196 24.190056 22.323376 22.411505 22.844349
 22.844332 20.680063 22.531921 22.583382 23.871407 22.431799 22.844309
 22.634022 22.84427  22.634024 23.446522 24.190046 22.372091 21.916084
 22.552153 23.255589 21.002829 23.255615 23.255535 23.25559  23.255627
 23.255604 23.255587 23.255596 24.409313 22.860792 22.73047  23.255524
 23.255632 23.255604 23.25562  23.25559  23.255634 23.255575 23.255596
 23.255636 24.603046 23.255123 23.255638 24.40931  23.255589 20.622232
 24.638096 22.844349 25.009579 23.526583 29.22352  29.22352  22.25558
 25.009579 22.844324 22.957485 22.957119 22.844347 22.956856 25.06649
 21.997671 23.245094 21.803791 22.844347 21.916462 22.844349 22.8443
 23.4183   22.844336 22.957483 22.84435  22.844326 24.190054 22.957458
 22.844316 22.956661 22.844316 22.844349 22.844343 24.040625 22.699533
 22.699537 23.255638 21.605093 24.229582 22.844307 22.957018 24.574902
 23.255165 22.957485 22.60021  23.089447 22.844349 22.844349 23.599768
 24.261106 22.578901 22.844229 24.409313 23.419096 22.9574   21.176184
 23.255632 22.956026 24.190037 23.255604 23.25443  24.409313 23.42072
 22.844336 21.52047  22.5789   25.105442 24.261126 24.277102 24.585524
 24.585524 25.034458 22.125128 23.255634 22.343245 24.983232 24.2611
 23.140043 22.1218   22.52992  23.712025 23.712023 23.711967 23.71198
 23.712019 25.046349 25.124043 23.712023 23.710758 23.255583 23.920176
 23.255602 24.585527 24.450453 24.585485 21.586212 24.585527 24.230085
 24.603048 23.255629 24.603048 23.255617 24.585524 22.174063 23.39427
 23.394243 23.712023 22.17407  23.041935 21.993448 23.255527 23.255621
 23.711977 22.52993  23.394339 23.715117 22.529928 22.58119  25.04635
 19.446163 23.041296 19.468967 23.57473  22.529732 21.486437 22.581194
 22.967104 22.967108 25.470272 24.198181 25.009756 22.529932 22.529888
 22.529932 22.662457 22.529932 22.52993  22.96711  22.529932 22.529932
 22.529829 24.225883 23.020689 23.463278 23.665516 23.780176 21.870573
 22.967113 23.665518 25.865973 23.417246 23.491365 23.437204 23.337866
 23.33829  22.967108 19.348072 22.278116 23.437235 24.71875  24.067934
 19.815748 23.999565 23.999569 23.999567 25.268944 23.937895 22.019506
 24.117311 22.27949  25.342073 23.608664 23.849937 24.718939 22.335382
 24.037231 23.437107 24.037445 23.437231 22.279491 24.718939 24.147152
 23.608652 23.444832 23.999567 25.268902 23.437075 23.661083]
2025-06-02 15:59:45,465 - DEBUG - Edge reconstruction errors: [1.0527666  1.0535731  0.6472618  ... 0.04559144 0.04470035 1.1452117 ]
2025-06-02 15:59:45,473 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155945_update_28.json
2025-06-02 15:59:45,474 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:45,477 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155945_update_28.pth and as latest_checkpoint.pth
2025-06-02 15:59:45,478 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869935.dot): 0.5786
2025-06-02 15:59:45,478 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:45,478 - WARNING -   Node ID: 192.168.27.13, Recon Error: 31.4255, MLP Score: 0.0248
2025-06-02 15:59:45,478 - WARNING -   Node ID: 192.168.27.12, Recon Error: 30.3576, MLP Score: 0.0249
2025-06-02 15:59:45,478 - WARNING -   Node ID: 192.168.27.10, Recon Error: 39.5515, MLP Score: 0.0378
2025-06-02 15:59:45,478 - WARNING -   Node ID: ff02::2, Recon Error: 35.0105, MLP Score: 0.0012
2025-06-02 15:59:45,478 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 41.1131, MLP Score: 0.0011
2025-06-02 15:59:45,478 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 15:59:45,478 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.3141, MLP Score: 0.9991
2025-06-02 15:59:45,478 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.5707, MLP Score: 0.9693
2025-06-02 15:59:45,478 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.1206, MLP Score: 0.0141
2025-06-02 15:59:45,478 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.9857, MLP Score: 0.0782
2025-06-02 15:59:45,478 - WARNING -   Source: 192.168.27.12, Target: 8.8.8.8, Recon Error: 4.7559, MLP Score: 0.0450
2025-06-02 15:59:45,478 - INFO - 
--- Processing file: nw_graph_encoded_1748869965.dot (Timestamp: 2025-06-02 15:12:45) ---
2025-06-02 15:59:45,479 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:59:45,479 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:59:45,502 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:59:45,527 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:59:45,528 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:59:45,528 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869965.dot
2025-06-02 15:59:45,550 - INFO - Parsed 768 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:59:45,572 - INFO - Parsed 1644 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869965.dot'.
2025-06-02 15:59:45,572 - INFO - Processing node updates/additions.
2025-06-02 15:59:45,577 - INFO - Processing edge updates/additions.
2025-06-02 15:59:45,587 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:45,587 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:45,588 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:45,589 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:45,596 - DEBUG - Initial node features tensor shape: torch.Size([768, 30])
2025-06-02 15:59:45,598 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:45,598 - DEBUG - Node features tensor shape after scaling: torch.Size([768, 30])
2025-06-02 15:59:45,600 - DEBUG - Edge index tensor shape: torch.Size([2, 1644])
2025-06-02 15:59:45,601 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:45,605 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-02 15:59:45,606 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:45,607 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:45,608 - DEBUG - Shape of encoded categorical edge features: torch.Size([1644, 3])
2025-06-02 15:59:45,609 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:45,609 - DEBUG - Shape of scaled numerical edge features: torch.Size([1644, 7])
2025-06-02 15:59:45,609 - DEBUG - Final edge attributes tensor shape: torch.Size([1644, 10])
2025-06-02 15:59:45,609 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:45,611 - INFO - Performing online update...
2025-06-02 15:59:45,612 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:45,612 - DEBUG - Updated RunningStats: new_mean=0.9422744119933412, new_var=16200000000160.84, new_n=1650
2025-06-02 15:59:45,612 - DEBUG - Updated RunningStats: new_mean=0.9385665205305781, new_var=16500000000018.895, new_n=1680
2025-06-02 15:59:45,613 - DEBUG - Updated RunningStats: new_mean=1.056950851329632, new_var=5400000000049.514, new_n=550
2025-06-02 15:59:45,613 - DEBUG - Updated RunningStats: new_mean=1.0565184183182055, new_var=5500000000000.849, new_n=560
2025-06-02 15:59:45,613 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:45,613 - DEBUG - Online update step: 1/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 2/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 3/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 4/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 5/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 6/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 7/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 8/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 9/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 10/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 11/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 12/50
2025-06-02 15:59:45,613 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,613 - DEBUG - Online update step: 13/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 14/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 15/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 16/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 17/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 18/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 19/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 20/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 21/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 22/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 23/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 24/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 25/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 26/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 27/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 28/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 29/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 30/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,614 - DEBUG - Online update step: 31/50
2025-06-02 15:59:45,614 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 32/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 33/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 34/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 35/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 36/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 37/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 38/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 39/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 40/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 41/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 42/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 43/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 44/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 45/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 46/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 47/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 48/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 49/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,615 - DEBUG - Online update step: 50/50
2025-06-02 15:59:45,615 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,616 - WARNING - No successful steps during online update.
2025-06-02 15:59:45,616 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], current edge mean: [ 6.1715326e+00  1.4209245e+00  4.9805355e+00 -1.7402816e-09
 -2.7554459e-09 -8.7014079e-10 -5.8009386e-10 -2.6104223e-09
 -2.3203754e-09  8.7014079e-10]
2025-06-02 15:59:45,616 - DEBUG - Node drift difference: 0.0144, Edge drift difference: 0.0026
2025-06-02 15:59:45,617 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.2285850e-08 -1.9868216e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.1044085e-08
  2.6077032e-08 -3.7252903e-09  1.2417635e-09 -2.2351742e-08
  2.2838542e+00  2.9609375e+00  1.4062500e-01  4.3932290e+00
  3.7252903e-09  3.4492188e+00  5.7096353e+00  7.5963540e+00
  1.4062500e-01  8.0000000e+00  1.2417635e-09 -3.2906730e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.4835269e-09  4.9670539e-09], edge=[ 6.1715326e+00  1.4209245e+00  4.9805355e+00 -1.7402816e-09
 -2.7554459e-09 -8.7014079e-10 -5.8009386e-10 -2.6104223e-09
 -2.3203754e-09  8.7014079e-10]
2025-06-02 15:59:45,617 - DEBUG - Updated reference std: node=[0.         0.         1.0006517  1.0006517  0.         0.
 0.         1.0006517  1.0006517  1.0006516  1.0006517  1.0006516
 0.96356016 0.27694583 0.362543   0.56546044 1.0006516  3.062159
 2.921897   1.5160462  0.362543   0.         1.0006517  1.0006517
 0.         0.         0.         0.         1.0006517  1.0006516 ], edge=[1.0395782  0.50603193 1.779606   1.0003043  1.0003043  1.0003042
 1.0003042  1.0003042  1.0003042  1.0003043 ]
2025-06-02 15:59:45,618 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:45,618 - INFO - Running anomaly detection...
2025-06-02 15:59:45,618 - INFO - Starting anomaly detection.
2025-06-02 15:59:45,624 - DEBUG - Node reconstruction errors: [25.041521 23.02261  31.513422 21.457096 17.184    21.140562 30.44491
 19.389465 19.389473 20.828115 19.389458 20.52661  39.68492  20.078514
 20.819407 19.777391 21.24069  19.771498 23.460005 19.878944 19.509491
 20.819405 20.104301 19.71443  20.778738 20.48757  20.780474 18.745853
 19.498104 20.78047  21.114256 24.142092 19.326904 21.517038 20.465519
 21.41758  22.931065 19.879076 19.064392 19.42107  23.45251  20.956757
 19.879076 23.533993 20.875471 19.846323 24.473415 19.168308 19.638498
 35.047405 41.198994 21.491508 20.60686  23.965601 18.914795 18.000856
 32.05188  20.20644  22.586882 23.46314  17.764814 21.615662 21.128422
 21.055712 20.355577 18.914795 19.223742 18.914791 21.12859  21.12859
 19.97636  21.22106  19.390566 20.9278   23.212158 21.105688 24.248089
 21.56585  21.385914 21.043219 21.964546 21.530909 16.89249  24.700714
 20.948824 18.928062 22.266998 21.412413 21.287302 24.142063 20.469202
 17.794994 19.21696  21.432705 20.320112 35.607014 22.212952 22.345968
 21.602415 19.122131 21.492289 22.21296  23.158155 23.00192  19.163296
 19.350508 19.147005 17.868624 18.933628 29.986153 21.79992  22.014452
 19.023323 18.587654 21.41837  22.074074 21.546196 17.189312 21.216824
 20.548143 20.713736 20.314419 17.54395  19.21715  21.750149 20.54799
 18.331022 17.5731   23.20527  21.680264 22.161882 19.664032 19.644445
 18.240755 21.653925 19.30768  24.383854 21.56304  18.184013 17.059694
 20.07593  22.712696 20.76987  19.779236 19.960854 21.454033 21.546196
 19.613598 20.63911  21.32416  25.87571  19.39823  22.636946 19.664032
 19.183435 18.448364 19.757015 22.87218  21.49229  23.075846 19.955566
 17.824514 19.757017 22.161716 21.58683  17.029247 22.961056 21.50423
 18.271467 21.741787 21.173132 20.687742 20.668427 34.421432 22.432093
 20.10737  21.980833 23.334455 21.729378 21.729378 19.617155 19.170284
 20.326002 17.369286 17.654446 22.570768 21.052423 21.769617 19.572186
 20.026947 23.11164  21.697575 22.112383 19.67503  18.184671 21.51325
 16.847502 21.414    17.057    21.008823 21.477655 19.756891 17.92325
 21.267447 21.842607 18.241735 21.743992 19.322874 21.660149 22.753271
 21.84018  21.687222 21.358768 22.547567 22.68001  20.886747 23.89154
 21.54619  22.125849 19.675041 18.818014 21.052374 20.897991 21.358772
 19.757038 22.78483  17.458612 19.656715 21.410913 19.756933 19.337812
 22.075195 23.41427  21.546194 21.546194 21.515692 21.840435 20.897993
 19.756979 23.077711 18.026882 22.806738 19.83408  22.540478 19.877346
 22.09997  22.030342 22.164202 19.83408  20.425253 20.668423 20.711086
 22.125853 22.243221 22.07408  21.796152 20.029894 22.063772 21.68572
 21.72938  23.359459 19.17541  21.407106 20.769903 22.727623 20.646416
 23.212114 23.174206 23.212128 23.218254 17.722229 17.58319  22.606218
 22.111855 23.237604 21.72938  20.909    22.430355 19.617102 22.325163
 19.965696 20.83853  21.727823 24.40109  23.611395 23.454517 18.454004
 18.611235 19.170286 19.128782 21.426497 22.6637   21.301123 19.87736
 18.168737 22.288097 22.680237 21.729387 21.515764 20.595663 21.948544
 22.14699  23.54366  23.54366  22.147194 22.147268 22.14726  23.410847
 22.225271 22.147123 22.147257 19.821001 22.14725  20.339788 20.958597
 22.106037 24.182041 19.654778 21.62694  21.600855 23.344004 21.113277
 21.619024 23.543661 18.135008 17.470076 21.896503 23.410847 22.916348
 22.916334 23.93585  21.836338 22.146053 23.237604 22.14725  23.41085
 21.440294 20.941334 21.896587 21.896544 22.099003 20.386152 21.896587
 24.4642   23.15152  23.83138  23.543661 23.511787 22.961199 21.521257
 22.145863 22.332487 19.108633 22.720247 20.421124 20.029888 22.416647
 22.14727  21.837475 26.83636  21.840178 21.392975 20.983107 23.385212
 23.543669 27.066643 21.209904 19.740347 21.950897 22.216675 23.116282
 23.167727 23.11645  18.764595 22.733534 24.254526 21.132996 21.116495
 23.429712 22.14726  23.54366  18.290712 20.29174  22.037416 18.479189
 22.905674 19.667522 18.882263 23.581392 22.147108 23.521587 22.429317
 22.29453  22.599733 23.903568 23.90363  23.9037   23.800404 22.489786
 23.76286  20.677195 23.220692 23.903614 22.490343 22.743013 22.294489
 23.385496 20.384645 22.29453  17.616953 23.903654 22.294533 22.490185
 23.903612 23.90365  21.165174 20.641788 23.903696 21.158024 21.599325
 20.615166 21.082954 22.385656 20.62246  18.570856 20.615166 21.07065
 23.584642 18.822287 22.024824 23.57636  20.254189 24.522379 22.481794
 23.903706 23.903624 20.677544 22.112541 18.57086  22.586382 22.374695
 21.821695 21.081745 22.077808 22.21801  19.842329 22.955395 21.127373
 22.570162 20.87328  23.248209 21.766958 20.772741 22.857922 21.766962
 20.5766   20.626749 20.526552 23.505241 22.385653 22.244587 20.441792
 20.743528 20.310307 20.73791  20.441765 21.492556 22.385653 19.351963
 22.165977 21.492554 22.244572 22.048958 19.18658  22.387949 22.385681
 23.116488 22.244587 21.853554 20.688166 23.153128 18.639366 21.821537
 21.126408 18.713766 22.434216 21.766958 19.749805 22.339785 18.277906
 23.803453 21.85358  22.95684  21.596914 22.726189 20.525824 22.567421
 26.919245 22.857918 20.688251 21.081165 21.59885  21.081633 21.453041
 21.816006 20.256166 22.965206 18.825884 20.772715 21.766958 20.623772
 21.929491 21.92956  22.217625 24.722765 22.218079 22.952808 24.242786
 24.594816 23.478716 24.242775 21.822605 22.965654 22.24245  21.815985
 22.567453 23.441254 19.042786 24.242777 22.366886 22.375154 22.857916
 22.8579   20.688276 22.56743  22.622206 23.921581 22.464392 22.857876
 22.679678 22.85785  22.679678 23.41857  24.24277  22.355356 21.928953
 22.523876 23.259497 21.00874  23.259521 23.259457 23.259499 23.259531
 23.259514 23.259493 23.259504 24.45806  22.825762 22.7228   23.259436
 23.259539 23.259512 23.259527 23.2595   23.259535 23.259493 23.259512
 23.25954  24.641663 23.25909  23.259542 24.458061 23.259499 20.62379
 24.679615 22.857916 25.040533 23.518517 29.217247 29.217247 22.29421
 25.040533 22.857891 22.965694 22.96533  22.857914 22.965088 25.043047
 21.995852 23.25063  21.822893 22.857916 21.929228 22.857916 22.857876
 23.398985 22.857908 22.965698 22.857918 22.857893 24.242773 22.965664
 22.857887 22.964949 22.857883 22.857922 22.857914 24.09052  22.726194
 22.726198 23.25954  21.620665 24.270885 22.857883 22.965218 24.611223
 23.25909  22.965698 22.627697 23.090696 22.85792  22.857916 23.588648
 24.3072   23.317205 22.857801 24.458063 23.399546 22.965609 21.228235
 23.259535 22.964363 24.242762 23.259514 23.258345 24.458063 23.401125
 22.857906 21.531775 22.618994 25.133017 24.307215 24.2499   24.634274
 24.634275 25.06335  22.121786 23.259535 22.341736 25.010326 24.307192
 23.155645 22.119204 22.513187 23.70148  23.701477 23.701427 23.701443
 23.701479 25.069466 25.158924 23.701483 23.700392 23.259497 23.883432
 23.25951  24.634275 24.486513 24.63424  21.582325 24.634277 24.497416
 24.641663 23.259539 24.641659 23.259525 24.634275 22.173433 23.388681
 23.388647 23.701475 22.173449 23.055965 21.976292 23.259436 23.259527
 23.701439 22.51319  23.38874  23.693108 22.513191 22.99718  25.069466
 19.419016 22.996815 19.250847 23.76532  22.513056 21.473377 22.567078
 22.936073 22.936073 25.488096 24.17301  25.044195 22.513193 22.51316
 22.513191 22.637577 22.513191 22.51319  22.936077 22.513191 22.513191
 22.513128 23.98563  22.992016 23.468054 23.883146 23.7869   21.838696
 23.236792 23.658598 25.84648  23.365908 23.44632  23.390661 23.302141
 23.3025   22.936077 19.689152 24.229525 23.390686 24.674784 24.018307
 19.777225 23.936283 23.936281 23.936285 25.205591 23.873545 21.984842
 24.051332 22.231356 25.281101 23.550873 23.796778 24.674978 22.2886
 24.153395 23.390593 23.983799 23.390676 22.23136  24.674976 24.13325
 23.55086  23.381634 23.936283 25.205324 23.390564 23.619844 23.829092
 25.20565  25.205587 25.20564  24.148495 24.148655]
2025-06-02 15:59:45,624 - DEBUG - Edge reconstruction errors: [1.0530416  1.054359   0.64763033 ... 0.04597043 0.04508702 1.1456015 ]
2025-06-02 15:59:45,625 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155945_update_29.json
2025-06-02 15:59:45,625 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:45,628 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155945_update_29.pth and as latest_checkpoint.pth
2025-06-02 15:59:45,628 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869965.dot): 0.5817
2025-06-02 15:59:45,628 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 15:59:45,629 - WARNING -   Node ID: 192.168.27.13, Recon Error: 31.5134, MLP Score: 0.0247
2025-06-02 15:59:45,629 - WARNING -   Node ID: 192.168.27.12, Recon Error: 30.4449, MLP Score: 0.0247
2025-06-02 15:59:45,629 - WARNING -   Node ID: 192.168.27.10, Recon Error: 39.6849, MLP Score: 0.0375
2025-06-02 15:59:45,629 - WARNING -   Node ID: ff02::2, Recon Error: 35.0474, MLP Score: 0.0012
2025-06-02 15:59:45,629 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 41.1990, MLP Score: 0.0011
2025-06-02 15:59:45,629 - WARNING - Detected 11 anomalous edges (reconstruction-based):
2025-06-02 15:59:45,629 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.7042, MLP Score: 0.9976
2025-06-02 15:59:45,629 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.2396, MLP Score: 0.9420
2025-06-02 15:59:45,629 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.9775, MLP Score: 0.2323
2025-06-02 15:59:45,629 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 5.1775, MLP Score: 0.1573
2025-06-02 15:59:45,629 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.1839, MLP Score: 0.0138
2025-06-02 15:59:45,629 - INFO - 
--- Processing file: nw_graph_encoded_1748869995.dot (Timestamp: 2025-06-02 15:13:15) ---
2025-06-02 15:59:45,629 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:59:45,629 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:59:45,649 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:59:45,671 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:59:45,671 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:59:45,672 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869995.dot
2025-06-02 15:59:45,692 - INFO - Parsed 780 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:59:45,713 - INFO - Parsed 1667 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869995.dot'.
2025-06-02 15:59:45,714 - INFO - Processing node updates/additions.
2025-06-02 15:59:45,720 - INFO - Processing edge updates/additions.
2025-06-02 15:59:45,733 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:45,734 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:45,734 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:45,736 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:45,746 - DEBUG - Initial node features tensor shape: torch.Size([780, 30])
2025-06-02 15:59:45,749 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:45,750 - DEBUG - Node features tensor shape after scaling: torch.Size([780, 30])
2025-06-02 15:59:45,752 - DEBUG - Edge index tensor shape: torch.Size([2, 1667])
2025-06-02 15:59:45,754 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:45,759 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 16
2025-06-02 15:59:45,761 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:45,762 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:45,764 - DEBUG - Shape of encoded categorical edge features: torch.Size([1667, 3])
2025-06-02 15:59:45,765 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:45,765 - DEBUG - Shape of scaled numerical edge features: torch.Size([1667, 7])
2025-06-02 15:59:45,765 - DEBUG - Final edge attributes tensor shape: torch.Size([1667, 10])
2025-06-02 15:59:45,765 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:45,767 - INFO - Performing online update...
2025-06-02 15:59:45,768 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:45,768 - DEBUG - Updated RunningStats: new_mean=0.9423680974794084, new_var=16800000000160.652, new_n=1710
2025-06-02 15:59:45,769 - DEBUG - Updated RunningStats: new_mean=0.9389637560575538, new_var=17100000000018.463, new_n=1740
2025-06-02 15:59:45,769 - DEBUG - Updated RunningStats: new_mean=1.0600396487656811, new_var=5600000000049.518, new_n=570
2025-06-02 15:59:45,769 - DEBUG - Updated RunningStats: new_mean=1.0596017478731583, new_var=5700000000000.858, new_n=580
2025-06-02 15:59:45,769 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:45,769 - DEBUG - Online update step: 1/50
2025-06-02 15:59:45,769 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,769 - DEBUG - Online update step: 2/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 3/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 4/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 5/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 6/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 7/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 8/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 9/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 10/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 11/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 12/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 13/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 14/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 15/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 16/50
2025-06-02 15:59:45,770 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,770 - DEBUG - Online update step: 17/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 18/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 19/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 20/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 21/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 22/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 23/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 24/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 25/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 26/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 27/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 28/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 29/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 30/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 31/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,771 - DEBUG - Online update step: 32/50
2025-06-02 15:59:45,771 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 33/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 34/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 35/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 36/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 37/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 38/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 39/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 40/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 41/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 42/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 43/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 44/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 45/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 46/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 47/50
2025-06-02 15:59:45,772 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,772 - DEBUG - Online update step: 48/50
2025-06-02 15:59:45,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,773 - DEBUG - Online update step: 49/50
2025-06-02 15:59:45,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,773 - DEBUG - Online update step: 50/50
2025-06-02 15:59:45,773 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,773 - WARNING - No successful steps during online update.
2025-06-02 15:59:45,773 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], current edge mean: [ 6.1781645e+00  1.4199160e+00  4.9742050e+00 -4.5767212e-09
 -2.0023156e-09  5.7209015e-10  2.8604508e-09  4.5767212e-09
 -2.2883606e-09  6.1499694e-09]
2025-06-02 15:59:45,774 - DEBUG - Node drift difference: 8974.5518, Edge drift difference: 0.0064
2025-06-02 15:59:45,774 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 15:59:45,775 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.2574354e-08 -8.3140840e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2924864e-08
 -2.4453188e-09 -3.1789146e-08 -1.8339891e-09 -6.7246266e-09
  2.2884614e+00  2.9564102e+00  1.4230770e-01  4.3961539e+00
  2.9343825e-08  3.4333334e+00  5.7128205e+00  7.5948720e+00
  1.4230770e-01  7.9910254e+00 -4.2793080e-09 -1.0545437e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.2226594e-08 -4.5238398e-08], edge=[ 6.1781645e+00  1.4199160e+00  4.9742050e+00 -4.5767212e-09
 -2.0023156e-09  5.7209015e-10  2.8604508e-09  4.5767212e-09
 -2.2883606e-09  6.1499694e-09]
2025-06-02 15:59:45,775 - DEBUG - Updated reference std: node=[0.         0.         1.0006417  1.0006417  0.         0.
 0.         1.0006417  1.0006416  1.0006417  1.0006416  1.0006417
 1.0045444  0.29221377 0.36398143 0.5649002  1.0006417  3.058592
 2.92255    1.5183852  0.36398143 0.2506402  1.0006417  1.0006417
 0.         0.         0.         0.         1.0006417  1.0006417 ], edge=[1.0526606 0.505705  1.785948  1.0003    1.0003    1.0003    1.0003
 1.0003    1.0003    1.0003   ]
2025-06-02 15:59:45,775 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:45,775 - INFO - Running anomaly detection...
2025-06-02 15:59:45,775 - INFO - Starting anomaly detection.
2025-06-02 15:59:45,783 - DEBUG - Node reconstruction errors: [24.90594  22.695673 31.09106  21.396566 16.906199 20.953814 30.053902
 19.239056 19.239061 20.729334 19.239044 20.17729  38.829353 19.661852
 20.713652 19.635565 20.887873 19.63042  22.945644 19.739866 19.355171
 20.713652 19.842968 19.31753  20.671976 20.438295 20.673466 18.40386
 19.346956 20.673464 20.50428  23.67842  19.483084 21.46305  20.420235
 21.26038  22.619202 19.73997  18.727453 19.044067 23.333523 20.84632
 19.73997  23.42399  20.3865   19.368143 24.367245 18.753206 19.484123
 35.130207 41.38283  21.379099 20.55289  23.443743 18.818993 17.700409
 31.83157  20.055086 22.17204  22.965117 17.545044 21.450508 21.01355
 20.55435  20.285198 18.81899  19.152466 18.818989 21.013674 21.013672
 19.7635   21.083073 19.325567 20.778961 22.803476 20.972692 24.81875
 21.401148 21.20847  20.893148 21.907562 21.353832 16.624163 24.284145
 20.664635 18.615948 22.068523 21.22768  21.126133 23.762499 20.421717
 17.52304  18.9533   21.243017 20.124207 35.7807   22.137247 22.077206
 21.465767 19.062775 21.337408 22.137257 23.086987 22.803179 18.839485
 19.279886 19.023823 17.556658 18.678127 30.00944  21.496471 21.953775
 18.68429  18.288095 21.245426 21.846968 21.366596 16.933756 21.039644
 20.32468  20.650732 19.988861 17.273487 18.907907 21.5581   20.324512
 18.095795 17.337181 22.83956  21.453314 22.036642 19.60867  19.578339
 17.951426 21.465017 19.239948 24.242575 21.429106 17.869328 16.813498
 19.973755 22.448986 20.697798 19.708315 19.869976 21.282637 21.366589
 19.565437 20.480047 21.138031 25.81384  19.601301 22.274843 19.608673
 18.82265  18.150814 19.69089  22.568151 21.337408 23.012083 19.86653
 17.541891 19.690895 22.036554 21.424446 16.784872 22.595947 21.32127
 17.958284 21.52015  21.017323 20.447254 20.61301  34.60284  22.155684
 19.909115 21.726559 23.00448  21.56003  21.56003  19.52981  18.916147
 20.216877 17.122576 18.139278 22.489222 20.96449  21.588627 19.486492
 19.946161 22.977991 21.489904 21.949205 19.606358 17.870049 21.412195
 16.589947 21.27705  16.814886 20.876287 21.27456  19.690805 17.646912
 21.103987 21.66949  17.94774  21.610497 19.033298 21.516092 22.381105
 21.661604 21.50004  21.27433  22.242134 22.403347 20.800861 23.48907
 21.366594 21.943125 19.606367 18.522106 20.964458 20.829292 21.27433
 19.690912 22.512878 17.180407 19.588037 21.240822 19.435057 19.017588
 21.856314 23.020514 21.366594 21.366594 21.413612 21.620422 20.829298
 19.690868 22.90945  17.719433 22.466228 19.774738 22.270506 19.80817
 22.032602 21.821188 22.92995  19.774738 20.244009 20.613008 20.636236
 21.943136 21.975166 21.846975 21.61403  19.947819 21.894148 21.531237
 21.56003  22.935225 18.939034 21.315195 20.534607 22.421867 20.426212
 22.82743  22.761507 22.82743  22.875027 17.473503 17.316969 22.287382
 21.857002 22.852783 21.560026 20.80082  22.243778 19.529768 22.07527
 19.796328 20.739746 21.512932 24.26861  23.230764 23.320515 18.156567
 18.348225 18.916157 18.849573 21.11508  22.555952 21.158031 19.808186
 17.836756 22.094168 22.360266 21.560047 21.413656 20.393974 21.73839
 21.984562 23.137064 23.137062 21.984686 21.984741 21.984737 23.01576
 22.052721 21.984652 21.984734 19.618692 21.984734 20.239624 20.405148
 21.855968 23.81489  19.36498  21.527855 21.48989  22.948414 20.819086
 21.429626 23.137062 17.999311 17.2135   21.743696 23.01576  22.534435
 22.534431 23.536879 21.714891 21.983711 22.852785 21.98473  23.015764
 21.1403   20.86745  21.74377  21.743742 21.961256 20.309044 21.74377
 23.967434 22.809937 23.425816 23.137064 23.371387 22.591148 21.342098
 21.98393  22.096916 18.779356 22.44147  20.339254 19.947813 22.227169
 21.984747 21.691265 26.476118 21.6616   21.174887 20.799023 23.02429
 23.137049 27.196728 21.120272 19.361626 21.74453  21.986034 22.758015
 22.828257 22.758108 18.420042 22.39706  23.844475 21.050625 20.930164
 23.060997 21.984741 23.137064 17.978575 20.192678 21.801544 18.150797
 22.629923 19.587385 18.593792 23.187347 21.984612 23.32945  22.205044
 22.08849  22.366581 23.484987 23.485016 23.48505  23.324625 22.306664
 23.282202 20.557426 23.008379 23.48501  22.307127 22.46783  22.088463
 22.981646 20.2315   22.08849  17.343962 23.485033 22.08849  22.307003
 23.485006 23.485033 21.028593 20.550589 23.485052 21.075314 22.096241
 20.450743 20.921953 22.144903 20.505327 18.407293 21.039925 20.915598
 23.350033 18.559866 21.915436 23.160831 20.123669 24.057405 22.255245
 23.48506  23.485016 20.557634 21.897274 18.229939 22.325115 22.19247
 21.59094  20.93012  21.926472 22.051441 19.40702  22.646807 20.97063
 22.401497 20.743116 22.95152  21.649158 20.652578 22.6551   21.64916
 20.423443 20.507776 20.417421 23.354086 22.1449   22.016674 20.34152
 20.61305  20.005663 20.608435 20.341496 21.391382 22.809828 19.024878
 22.025599 21.391382 22.016659 22.705616 18.776394 22.13141  22.144863
 22.809832 22.016672 21.726255 20.576582 23.028015 18.30332  21.682247
 20.969858 18.351086 22.24339  21.649158 18.495989 22.212008 18.592978
 23.420961 21.726269 22.647732 21.482277 22.461172 20.416832 22.317331
 27.421194 22.6551   20.576654 20.929655 21.483076 20.93004  21.31355
 21.693554 19.926916 22.751291 18.498928 20.652557 21.649158 20.265741
 21.687582 21.687618 22.051273 24.245508 22.05147  22.745337 23.78515
 24.43324  23.099962 23.78515  21.591784 22.751637 22.10871  21.693537
 22.31734  23.243046 18.757572 23.785143 22.147749 22.192755 22.655096
 22.655085 20.576668 22.31733  22.393194 23.467342 22.223919 22.655062
 22.462984 22.655056 22.462982 23.274244 23.785147 22.071293 26.391424
 22.226816 23.030926 20.77233  23.030952 23.030918 23.030933 23.030956
 23.030945 23.030935 23.030943 23.98511  22.513834 22.573156 23.030886
 23.030958 23.030943 23.030952 23.030947 23.030964 23.03094  23.030947
 23.030962 24.151365 23.030718 23.030962 20.779856 23.030941 19.561409
 24.442831 22.655098 24.77715  23.20419  29.005438 29.005438 22.069292
 24.77715  22.65508  22.751661 22.751415 22.655098 22.751274 24.811716
 22.047556 23.026579 21.591957 22.655102 21.68734  22.6551   22.655077
 23.12683  22.655094 22.751667 22.655102 22.65508  23.78515  22.751642
 22.655079 22.751268 22.655071 22.6551   22.655096 23.635265 22.461182
 22.46118  23.030962 21.351969 24.02786  22.655079 22.751324 24.705805
 23.030645 22.751669 22.380169 22.860395 22.655102 22.655096 23.266422
 23.838623 23.011774 22.655006 23.98511  23.126917 22.751614 20.738686
 23.030964 22.75094  23.785147 23.030943 23.030071 23.985107 23.128044
 22.655088 21.280682 22.393404 24.624447 23.838636 24.048685 24.161804
 24.161802 24.802715 22.612417 23.030962 22.07235  24.502838 23.83863
 22.885775 21.980986 22.347872 23.43702  23.437023 23.43699  23.436998
 23.43702  24.54769  24.65429  23.437021 23.436464 23.030943 23.570316
 23.030943 24.161804 24.001764 24.161776 21.432741 24.161804 24.054712
 24.151367 23.030962 24.151361 23.030949 24.161804 22.028984 23.141518
 23.14149  23.437021 22.028992 22.786785 21.800209 23.03089  23.030952
 23.437    22.347872 23.141546 23.40833  22.347872 22.78085  24.54769
 19.03067  22.780571 18.858938 23.448673 22.347778 21.314322 22.3966
 22.743189 22.743193 24.947348 23.870403 24.539753 22.347872 22.347858
 22.347876 22.4593   22.347872 22.347872 22.74319  22.347874 22.347874
 22.34784  23.656586 22.793844 23.556078 23.556072 23.495295 21.655449
 23.012753 23.760027 25.237278 23.12771  23.217913 23.308174 22.942421
 22.942623 22.74319  19.267273 23.854223 23.16497  24.335794 23.792015
 19.367077 23.674316 23.674318 23.67432  24.832249 23.772366 21.548424
 23.807487 22.022646 25.046003 23.466505 23.438807 24.335949 22.078077
 23.793362 23.307793 23.749292 23.164968 23.854282 24.335949 23.9852
 23.30813  23.115686 23.67432  24.832031 23.307291 23.279125 23.433641
 24.832226 24.832247 24.832283 23.949581 23.773703 20.652454 23.67432
 23.888    24.832159 24.216564 24.2967   29.446314 24.296022 24.832253
 25.359217 24.296745 23.613432]
2025-06-02 15:59:45,783 - DEBUG - Edge reconstruction errors: [1.0554682  1.0565503  0.6503062  ... 0.04875728 0.04789648 1.1483984 ]
2025-06-02 15:59:45,786 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155945_update_30.json
2025-06-02 15:59:45,787 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:45,791 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155945_update_30.pth and as latest_checkpoint.pth
2025-06-02 15:59:45,791 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869995.dot): 0.5615
2025-06-02 15:59:45,791 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 15:59:45,791 - WARNING -   Node ID: 192.168.27.13, Recon Error: 31.0911, MLP Score: 0.0236
2025-06-02 15:59:45,791 - WARNING -   Node ID: 192.168.27.12, Recon Error: 30.0539, MLP Score: 0.0239
2025-06-02 15:59:45,791 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.8294, MLP Score: 0.0375
2025-06-02 15:59:45,791 - WARNING -   Node ID: ff02::2, Recon Error: 35.1302, MLP Score: 0.0011
2025-06-02 15:59:45,791 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 41.3828, MLP Score: 0.0011
2025-06-02 15:59:45,791 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:59:45,791 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 19.1714, MLP Score: 0.9686
2025-06-02 15:59:45,791 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 14.3980, MLP Score: 0.7736
2025-06-02 15:59:45,792 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.1567, MLP Score: 0.1136
2025-06-02 15:59:45,792 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.3567, MLP Score: 0.0733
2025-06-02 15:59:45,792 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.4606, MLP Score: 0.0166
2025-06-02 15:59:45,792 - INFO - 
--- Processing file: nw_graph_encoded_1748870025.dot (Timestamp: 2025-06-02 15:13:45) ---
2025-06-02 15:59:45,792 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:59:45,792 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:59:45,815 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:59:45,838 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:59:45,838 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:59:45,838 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870025.dot
2025-06-02 15:59:45,856 - INFO - Parsed 799 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:59:45,875 - INFO - Parsed 1718 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870025.dot'.
2025-06-02 15:59:45,875 - INFO - Processing node updates/additions.
2025-06-02 15:59:45,880 - INFO - Processing edge updates/additions.
2025-06-02 15:59:45,891 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:45,892 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:45,892 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:45,893 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:45,903 - DEBUG - Initial node features tensor shape: torch.Size([799, 30])
2025-06-02 15:59:45,905 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:45,905 - DEBUG - Node features tensor shape after scaling: torch.Size([799, 30])
2025-06-02 15:59:45,907 - DEBUG - Edge index tensor shape: torch.Size([2, 1718])
2025-06-02 15:59:45,908 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:45,913 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-02 15:59:45,914 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:45,916 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:45,917 - DEBUG - Shape of encoded categorical edge features: torch.Size([1718, 3])
2025-06-02 15:59:45,918 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:45,919 - DEBUG - Shape of scaled numerical edge features: torch.Size([1718, 7])
2025-06-02 15:59:45,919 - DEBUG - Final edge attributes tensor shape: torch.Size([1718, 10])
2025-06-02 15:59:45,919 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:45,922 - INFO - Performing online update...
2025-06-02 15:59:45,922 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:45,923 - DEBUG - Updated RunningStats: new_mean=0.942642110264984, new_var=17400000000160.617, new_n=1770
2025-06-02 15:59:45,923 - DEBUG - Updated RunningStats: new_mean=0.9393541601867237, new_var=17700000000018.457, new_n=1800
2025-06-02 15:59:45,924 - DEBUG - Updated RunningStats: new_mean=1.0646391798603378, new_var=5800000000060.685, new_n=590
2025-06-02 15:59:45,924 - DEBUG - Updated RunningStats: new_mean=1.064180519851252, new_var=5900000000000.856, new_n=600
2025-06-02 15:59:45,924 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:45,924 - DEBUG - Online update step: 1/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 2/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 3/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 4/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 5/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 6/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 7/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 8/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,924 - DEBUG - Online update step: 9/50
2025-06-02 15:59:45,924 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 10/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 11/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 12/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 13/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 14/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 15/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 16/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 17/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 18/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 19/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 20/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 21/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 22/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 23/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 24/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,925 - DEBUG - Online update step: 25/50
2025-06-02 15:59:45,925 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 26/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 27/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 28/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 29/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 30/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 31/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 32/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 33/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 34/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 35/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 36/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 37/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 38/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 39/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 40/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 41/50
2025-06-02 15:59:45,926 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,926 - DEBUG - Online update step: 42/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 43/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 44/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 45/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 46/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 47/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 48/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 49/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - DEBUG - Online update step: 50/50
2025-06-02 15:59:45,927 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:45,927 - WARNING - No successful steps during online update.
2025-06-02 15:59:45,928 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], current edge mean: [ 7.1746216e+00  1.4202561e+00  4.9732246e+00 -8.8817167e-09
 -1.9428754e-09 -5.5510729e-10  5.5510729e-10  5.5510729e-10
 -5.5510729e-10  2.2204292e-09]
2025-06-02 15:59:45,928 - DEBUG - Node drift difference: 0.0216, Edge drift difference: 0.9466
2025-06-02 15:59:45,928 - WARNING - Feature drift detected (2 consecutive)
2025-06-02 15:59:45,929 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4323018e-08  2.1484528e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -4.2670660e-08
 -3.5807545e-08  1.6710189e-08  2.3871698e-08 -2.6258867e-08
  2.2966208e+00  2.9574468e+00  1.5018773e-01  4.3942428e+00
 -1.9097358e-08  3.4367959e+00  5.7058825e+00  7.5969963e+00
  1.5018773e-01  7.9912391e+00  1.1935849e-08  6.8631132e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.0145471e-08 -8.5938112e-08], edge=[ 7.1746216e+00  1.4202561e+00  4.9732246e+00 -8.8817167e-09
 -1.9428754e-09 -5.5510729e-10  5.5510729e-10  5.5510729e-10
 -5.5510729e-10  2.2204292e-09]
2025-06-02 15:59:45,929 - DEBUG - Updated reference std: node=[0.         0.         1.0006263  1.0006263  0.         0.
 0.         1.0006263  1.0006263  1.0006263  1.0006263  1.0006263
 1.0016909  0.28879055 0.37459666 0.5672931  1.0006264  3.0588543
 2.925534   1.5144387  0.37459666 0.2476422  1.0006263  1.0006263
 0.         0.         0.         0.         1.0006263  1.0006263 ], edge=[1.0780852 0.5077014 1.7833711 1.0002911 1.0002912 1.0002911 1.0002912
 1.0002912 1.0002911 1.0002911]
2025-06-02 15:59:45,930 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:45,930 - INFO - Running anomaly detection...
2025-06-02 15:59:45,930 - INFO - Starting anomaly detection.
2025-06-02 15:59:45,941 - DEBUG - Node reconstruction errors: [24.63254  22.375444 30.505835 21.363455 17.477669 20.965277 32.064682
 19.20102  19.201027 20.686924 19.20101  20.131033 38.471294 19.640226
 20.671093 19.608906 20.833744 19.602093 23.034891 19.712748 19.319496
 20.671093 19.69515  19.271254 20.633718 20.431456 20.63562  19.666876
 19.309553 20.635616 20.560513 23.544292 19.519812 21.364647 20.33269
 20.360258 22.812117 19.712873 18.605679 19.248955 23.284029 20.802206
 19.712873 23.366917 20.26882  19.450712 24.325735 19.393799 19.444458
 35.89604  40.346134 21.336788 20.552767 23.521484 18.878792 18.026243
 31.251043 20.017824 22.324768 22.939735 18.16411  21.357958 20.963343
 20.422832 20.322786 18.878801 19.168701 18.878765 20.963503 20.963493
 19.798126 21.47706  19.378208 21.18738  23.579554 21.36474  24.667788
 21.831097 21.491457 21.299934 21.794342 21.51797  16.418684 24.104364
 23.139584 18.858038 22.44932  22.809368 21.5636   23.920176 20.325
 18.104578 19.615934 21.4105   20.157227 34.762295 22.10705  22.155878
 21.391888 18.961128 21.743305 22.10705  22.960253 22.929865 18.605707
 19.34961  18.78881  17.369514 18.558363 29.43667  21.498386 21.837696
 18.537626 18.172258 21.076902 21.632927 21.191908 17.727354 20.873728
 20.34653  20.547533 20.401196 18.051487 19.339966 21.727589 20.346346
 18.728697 18.069706 23.071354 21.44638  21.97252  19.49884  19.483767
 17.782784 21.2828   19.131296 24.149044 21.358448 17.678057 16.688263
 19.834621 22.260029 20.59032  19.598692 19.742807 21.113874 21.191916
 19.452688 20.410091 20.964659 25.746738 19.584463 22.198496 19.498837
 18.887114 18.47224  19.72444  22.609362 21.743305 22.890705 19.739218
 17.37882  19.724453 21.97241  21.833273 16.659946 22.518805 21.732735
 18.048655 21.315071 21.42497  20.46085  20.506777 33.554497 22.277351
 19.75041  21.552069 22.804796 21.968079 21.968079 19.59706  19.567785
 20.219463 17.889275 19.674307 22.593517 20.839705 21.802273 19.363276
 19.971342 22.987146 21.649853 21.89089  19.651728 17.678797 21.393955
 16.653666 21.105234 17.6037   20.85453  21.163418 19.724346 18.088984
 22.942297 21.840109 18.663877 21.546518 19.626396 21.437716 22.297787
 22.070904 21.317894 21.263845 22.288729 22.1487   20.821856 23.25593
 21.191916 22.437231 19.651737 18.774921 20.83967  20.719122 21.263842
 19.72446  22.701836 17.027739 19.634697 21.65092  19.259241 19.625563
 22.022198 22.79936  21.191914 21.191914 21.395641 21.77525  20.719122
 19.72442  22.84182  18.264956 22.29261  19.659729 22.022596 19.841614
 21.781183 21.97153  22.64579  19.659729 20.216162 20.506773 20.661448
 22.437231 22.241425 23.107483 21.442858 19.973381 21.789228 21.520748
 21.968082 22.818316 19.574717 21.288757 20.548737 22.961218 20.446796
 22.736103 22.6026   22.736101 23.0166   18.175447 18.086693 22.24583
 24.536968 22.761042 21.968079 20.784472 22.658245 19.59701  22.336615
 20.013607 20.7221   21.312544 24.170864 23.470392 23.238878 17.994093
 19.080896 19.56779  18.659258 21.084257 22.50984  21.079071 19.841627
 17.618355 21.970087 22.560925 21.968111 21.395695 19.34107  22.14442
 21.877989 23.027594 24.148932 21.878147 21.878222 21.878218 22.914888
 21.940792 21.878113 21.878216 19.394157 21.878208 20.255695 20.459301
 22.13517  23.558819 20.013773 21.509007 21.467657 22.848595 20.799572
 21.862278 23.027592 17.78063  17.98252  21.652157 22.914886 22.443668
 22.443663 23.462503 21.684702 21.876892 22.761044 21.878206 22.91489
 21.121988 20.877708 21.652246 21.65221  21.848059 20.33317  21.652246
 23.9904   22.968903 23.196806 23.027592 23.286205 22.498344 21.753664
 21.877178 22.235048 18.906694 24.151348 20.36704  19.973375 22.099142
 21.878227 21.603966 25.808516 22.070906 21.05581  20.701603 22.832561
 23.027584 26.175198 20.990679 19.828838 21.54615  21.767893 22.568264
 22.625288 23.534765 18.708805 22.245373 24.151194 20.903856 20.83391
 23.186459 21.878218 23.027592 17.784311 20.053255 21.579657 17.9418
 23.032219 19.464268 18.39083  23.078058 21.878054 23.107075 22.606195
 22.491444 22.765226 23.358437 23.35849  23.358547 23.447716 22.17953
 23.261099 20.56231  22.772877 23.358479 22.180109 22.735159 22.491419
 24.148937 20.219896 22.491438 17.187674 23.358515 22.491442 22.179953
 23.358477 23.35851  20.860895 20.570034 23.358555 20.950825 21.865557
 20.433191 20.905098 21.916796 20.343977 19.133694 20.999414 20.896889
 23.750824 19.282707 21.1592   23.03528  20.178062 23.902225 22.041252
 23.358559 23.358482 20.562563 21.684519 18.964848 22.14795  21.96458
 21.451826 21.733454 21.731037 21.839785 19.932814 22.35594  20.769428
 22.190916 20.56823  23.563389 21.48561  20.487972 22.5052   21.48561
 20.22829  20.34644  20.26632  23.146069 21.916792 21.799185 20.198019
 20.440098 19.82267  20.435234 20.197996 21.389215 22.51852  18.811882
 21.846981 21.389215 21.799166 22.431818 18.541203 21.888369 21.916773
 22.51852  21.799187 21.55392  20.420252 22.851452 18.110828 21.500637
 20.768644 18.10682  22.205458 21.48561  18.25879  22.048471 18.34624
 23.199736 21.553946 22.356926 21.324799 22.206814 20.26573  22.076323
 27.338795 22.505192 20.42032  20.73139  21.325733 20.73186  21.283373
 21.68094  19.711815 22.589928 18.303247 20.487951 21.48561  20.018227
 21.53856  21.538599 21.83959  24.079124 21.839825 22.582075 23.632578
 24.231611 22.887644 23.63258  21.452883 22.59037  21.931236 21.680922
 22.076338 23.097864 18.567896 23.632566 22.55561  21.964916 22.50519
 22.505177 20.42034  22.076323 22.791128 23.316597 21.997019 22.50515
 22.871828 22.505144 22.871832 22.995619 23.632574 21.878408 26.139046
 20.803953 22.853092 20.577417 22.853132 22.853083 22.8531   22.853132
 22.853125 22.853102 22.853113 23.819708 22.283539 22.382704 22.853039
 22.853142 22.853115 22.853132 22.85312  22.853144 22.85311  22.85312
 22.853144 23.970417 22.852821 22.853148 20.534733 22.853117 19.296467
 24.147917 22.505194 24.468052 22.908876 28.69718  28.69718  21.846302
 24.468052 22.505169 22.590416 22.590082 22.505188 22.589901 24.618275
 21.790373 22.84738  21.453106 22.50519  21.53825  22.505192 22.505169
 22.924847 22.505184 22.590416 22.505192 22.505175 23.632578 22.590384
 22.505165 22.589893 22.50516  22.505196 22.50519  23.476027 22.20682
 22.206821 22.853144 21.1922   23.738163 22.50517  22.589966 24.483095
 22.852728 22.590418 22.134148 22.687466 22.505194 22.505192 23.344007
 23.666817 22.987413 22.50508  23.819708 22.924967 22.590343 20.616383
 22.853142 22.589458 23.632572 22.853117 22.851969 23.819706 22.926449
 22.505184 21.12215  22.16345  24.686346 23.666838 23.923258 23.989838
 23.98984  24.482523 22.350843 22.853144 21.890251 24.874048 23.66682
 23.271673 21.792818 22.13061  23.227316 23.227314 23.227268 23.227278
 23.227312 24.337288 24.917982 23.227316 23.22658  22.853113 23.336895
 22.853113 23.989838 23.81682  23.989798 21.244823 23.989841 24.146442
 23.970419 23.112514 23.970419 22.853128 23.989841 22.002388 22.951021
 22.950989 23.227314 22.0024   23.192684 21.584866 22.853045 22.85313
 23.227274 22.13061  22.951061 23.188478 22.13061  22.719563 24.337286
 18.741096 22.71916  19.553537 23.814672 22.130499 21.788767 22.352356
 22.493532 22.493536 24.714813 23.630352 24.340569 22.130613 22.130592
 22.130613 22.229221 22.130615 22.130613 22.493534 22.130613 22.130613
 22.130568 24.015814 22.732553 23.931496 24.595522 23.875862 21.786583
 22.731098 24.124537 25.29816  22.838129 23.136114 23.007128 22.666046
 22.666307 22.493534 18.963123 23.507982 22.879534 24.058657 23.515049
 20.01494  23.56971  23.569714 23.56971  24.5134   23.434315 21.208807
 23.647997 21.757238 24.746124 23.148022 23.152533 24.058859 21.804487
 23.425566 23.006683 23.449    22.879528 23.508036 24.058859 23.627382
 23.007084 23.031067 23.56971  24.513128 23.006086 23.006853 23.11628
 24.513376 24.513401 24.513453 23.622774 25.58071  20.438913 23.56971
 23.524328 24.513296 23.841375 23.9462   29.236076 23.943916 24.51341
 24.99696  23.942015 23.292814 24.99668  23.942822 45.503735 26.7219
 25.999006 23.94631  25.999012 23.593117 26.168928 25.66798  24.99668
 23.730986 23.730051 25.667952 23.854418 24.996956 23.946278 26.168928
 23.946272]
2025-06-02 15:59:45,942 - DEBUG - Edge reconstruction errors: [1.155377   1.1570286  0.7501332  ... 0.14768732 1.2480698  0.14905103]
2025-06-02 15:59:45,944 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155945_update_31.json
2025-06-02 15:59:45,944 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:45,948 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155945_update_31.pth and as latest_checkpoint.pth
2025-06-02 15:59:45,948 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870025.dot): 0.5925
2025-06-02 15:59:45,948 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:59:45,948 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.5058, MLP Score: 0.0254
2025-06-02 15:59:45,948 - WARNING -   Node ID: 192.168.27.12, Recon Error: 32.0647, MLP Score: 0.0358
2025-06-02 15:59:45,948 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.4713, MLP Score: 0.0392
2025-06-02 15:59:45,948 - WARNING -   Node ID: ff02::2, Recon Error: 35.8960, MLP Score: 0.0012
2025-06-02 15:59:45,948 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.3461, MLP Score: 0.0012
2025-06-02 15:59:45,949 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:59:45,949 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 19.5048, MLP Score: 0.9760
2025-06-02 15:59:45,949 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 14.7142, MLP Score: 0.8303
2025-06-02 15:59:45,949 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.2943, MLP Score: 0.1244
2025-06-02 15:59:45,949 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.4943, MLP Score: 0.0806
2025-06-02 15:59:45,949 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.6822, MLP Score: 0.0213
2025-06-02 15:59:45,967 - DEBUG - Embedding standard deviations before t-SNE: [2.6140797  0.5339934  0.         0.018847   2.498681   0.
 0.60205853 0.         0.         1.6459491  2.4396966  0.40112668
 0.         0.54501474 0.         0.3915407  1.1184664  0.
 0.         0.42888784 0.         0.         0.01024533 2.3029587
 0.         2.152391   0.04759239 0.         0.         0.
 0.95246774 0.34046265]
2025-06-02 15:59:47,143 - INFO - Embeddings visualization saved to vis/embeddings_31_updates_20250602_155945.png
2025-06-02 15:59:47,143 - INFO - Performing visualization of node and edge features.
2025-06-02 15:59:47,144 - INFO - Starting visualization of node features.
2025-06-02 15:59:47,144 - INFO - Graph has 799 nodes and 30 features.
2025-06-02 15:59:47,144 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 15:59:47,144 - INFO - Calculating feature statistics:
2025-06-02 15:59:47,145 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,145 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,145 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-2.2631247), 'max': np.float32(2.2575989)}
2025-06-02 15:59:47,145 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(0.9999999), 'min': np.float32(-2.1910229), 'max': np.float32(2.3384998)}
2025-06-02 15:59:47,145 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,145 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,145 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,145 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.4509027), 'max': np.float32(2.2177732)}
2025-06-02 15:59:47,145 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1530161), 'max': np.float32(0.86729056)}
2025-06-02 15:59:47,145 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(2.8646037e-08), 'std': np.float32(1.0), 'min': np.float32(-9.285732), 'max': np.float32(0.11055708)}
2025-06-02 15:59:47,145 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 16, 'mean': np.float32(3.8194717e-08), 'std': np.float32(1.0), 'min': np.float32(-3.0355306), 'max': np.float32(1.4744775)}
2025-06-02 15:59:47,146 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 16, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4472969), 'max': np.float32(3.1356149)}
2025-06-02 15:59:47,146 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2966208), 'std': np.float32(1.0010638), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 15:59:47,146 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9574468), 'std': np.float32(0.28860977), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 15:59:47,146 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:47,146 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.394243), 'std': np.float32(0.566938), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 15:59:47,146 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11055708), 'max': np.float32(9.285733)}
2025-06-02 15:59:47,146 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.436796), 'std': np.float32(3.0569396), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 15:59:47,146 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7058825), 'std': np.float32(2.923703), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:47,146 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5969963), 'std': np.float32(1.5134907), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:47,146 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.15018773), 'std': np.float32(0.37436214), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:47,146 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.991239), 'std': np.float32(0.24748717), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 15:59:47,146 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-2.3871698e-09), 'std': np.float32(1.0), 'min': np.float32(-0.13463752), 'max': np.float32(15.2332735)}
2025-06-02 15:59:47,146 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-4.7743396e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14744195), 'max': np.float32(6.78233)}
2025-06-02 15:59:47,147 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,147 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,147 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,147 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 15:59:47,147 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(-1.9097358e-08), 'std': np.float32(1.0), 'min': np.float32(-0.98786825), 'max': np.float32(8.7366495)}
2025-06-02 15:59:47,147 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-5.7292073e-08), 'std': np.float32(1.0), 'min': np.float32(-1.096277), 'max': np.float32(4.459275)}
2025-06-02 15:59:47,160 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a184b470>
2025-06-02 15:59:47,296 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 15:59:47,348 - DEBUG - Plotted ranges of node feature values.
2025-06-02 15:59:47,378 - DEBUG - Plotted sparsity of node features.
2025-06-02 15:59:49,072 - INFO - Node feature visualization saved to vis/node_features_20250602_155947.png
2025-06-02 15:59:49,073 - INFO - Finished visualization of node features.
2025-06-02 15:59:49,073 - INFO - Performing additional feature analysis:
2025-06-02 15:59:49,073 - INFO - - Maximum correlation between different features: nan
2025-06-02 15:59:49,074 - INFO - Starting visualization of edge features.
2025-06-02 15:59:49,074 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:59:49,074 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:49,074 - INFO - Calculating edge feature statistics:
2025-06-02 15:59:49,075 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 15:59:49,075 - INFO - - count: {'name': 'count', 'unique': 17, 'mean': np.float32(7.1746216), 'std': np.float32(1.0777713), 'min': np.float32(0.0), 'max': np.float32(16.0)}
2025-06-02 15:59:49,075 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4202561), 'std': np.float32(0.5075536), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 15:59:49,075 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9732246), 'std': np.float32(1.7828522), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 15:59:49,075 - INFO - - service: {'name': 'service', 'unique': 28, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.04193423), 'max': np.float32(32.319332)}
2025-06-02 15:59:49,075 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1147, 'mean': np.float32(2.2204292e-09), 'std': np.float32(1.0), 'min': np.float32(-0.07043896), 'max': np.float32(30.815102)}
2025-06-02 15:59:49,075 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1215, 'mean': np.float32(-4.4408583e-09), 'std': np.float32(1.0), 'min': np.float32(-0.06402923), 'max': np.float32(31.744682)}
2025-06-02 15:59:49,075 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 393, 'mean': np.float32(4.4408583e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052897945), 'max': np.float32(32.174114)}
2025-06-02 15:59:49,075 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1192, 'mean': np.float32(2.2204292e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0993745), 'max': np.float32(26.157907)}
2025-06-02 15:59:49,075 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1209, 'mean': np.float32(1.1102146e-09), 'std': np.float32(1.0), 'min': np.float32(-0.09994787), 'max': np.float32(25.52512)}
2025-06-02 15:59:49,075 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 446, 'mean': np.float32(-1.1102146e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.06595439), 'max': np.float32(31.160322)}
2025-06-02 15:59:49,087 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a099aeeb40>
2025-06-02 15:59:49,309 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 15:59:49,324 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a834d130>
2025-06-02 15:59:49,451 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 15:59:49,622 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 15:59:49,792 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 15:59:49,813 - DEBUG - Plotted sparsity of edge features.
2025-06-02 15:59:49,820 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 15:59:51,143 - INFO - Edge feature visualization saved to vis/edge_features_20250602_155949.png
2025-06-02 15:59:51,144 - INFO - Finished visualization of edge features.
2025-06-02 15:59:51,144 - INFO - Performing additional edge feature analysis:
2025-06-02 15:59:51,144 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 15:59:51,145 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 15:59:51,145 - INFO - Graph has 1718 edges and 10 edge features.
2025-06-02 15:59:51,145 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 15:59:51,452 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_155951_summary.png
2025-06-02 15:59:51,694 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_155951_pca_3d.png
2025-06-02 15:59:51,857 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_155951_pca_variance.png
2025-06-02 15:59:51,857 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 15:59:51,857 - INFO - 
--- Processing file: nw_graph_encoded_1748870055.dot (Timestamp: 2025-06-02 15:14:15) ---
2025-06-02 15:59:51,857 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:59:51,857 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:59:51,871 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:59:51,886 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:59:51,886 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:59:51,886 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870055.dot
2025-06-02 15:59:51,900 - INFO - Parsed 805 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:59:51,916 - INFO - Parsed 1734 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870055.dot'.
2025-06-02 15:59:51,916 - INFO - Processing node updates/additions.
2025-06-02 15:59:51,920 - INFO - Processing edge updates/additions.
2025-06-02 15:59:51,931 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:51,932 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:51,932 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:51,933 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:51,942 - DEBUG - Initial node features tensor shape: torch.Size([805, 30])
2025-06-02 15:59:51,944 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:51,953 - DEBUG - Node features tensor shape after scaling: torch.Size([805, 30])
2025-06-02 15:59:51,956 - DEBUG - Edge index tensor shape: torch.Size([2, 1734])
2025-06-02 15:59:51,957 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:51,962 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-02 15:59:51,964 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:51,965 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:51,967 - DEBUG - Shape of encoded categorical edge features: torch.Size([1734, 3])
2025-06-02 15:59:51,969 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:51,969 - DEBUG - Shape of scaled numerical edge features: torch.Size([1734, 7])
2025-06-02 15:59:51,969 - DEBUG - Final edge attributes tensor shape: torch.Size([1734, 10])
2025-06-02 15:59:51,969 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:51,972 - INFO - Performing online update...
2025-06-02 15:59:51,972 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:51,973 - DEBUG - Updated RunningStats: new_mean=0.9429041022205888, new_var=18000000000160.73, new_n=1830
2025-06-02 15:59:51,973 - DEBUG - Updated RunningStats: new_mean=0.9397072950483281, new_var=18300000000018.41, new_n=1860
2025-06-02 15:59:51,974 - DEBUG - Updated RunningStats: new_mean=1.0689785893587747, new_var=6000000000060.675, new_n=610
2025-06-02 15:59:51,974 - DEBUG - Updated RunningStats: new_mean=1.0684532200866124, new_var=6100000000000.856, new_n=620
2025-06-02 15:59:51,974 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:51,974 - DEBUG - Online update step: 1/50
2025-06-02 15:59:51,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,974 - DEBUG - Online update step: 2/50
2025-06-02 15:59:51,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,974 - DEBUG - Online update step: 3/50
2025-06-02 15:59:51,974 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,974 - DEBUG - Online update step: 4/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 5/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 6/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 7/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 8/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 9/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 10/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 11/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 12/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 13/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 14/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 15/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 16/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 17/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,975 - DEBUG - Online update step: 18/50
2025-06-02 15:59:51,975 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 19/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 20/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 21/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 22/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 23/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 24/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 25/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 26/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 27/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 28/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 29/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 30/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 31/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 32/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,976 - DEBUG - Online update step: 33/50
2025-06-02 15:59:51,976 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 34/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 35/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 36/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 37/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 38/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 39/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 40/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 41/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 42/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 43/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 44/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 45/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 46/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 47/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,977 - DEBUG - Online update step: 48/50
2025-06-02 15:59:51,977 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,978 - DEBUG - Online update step: 49/50
2025-06-02 15:59:51,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,978 - DEBUG - Online update step: 50/50
2025-06-02 15:59:51,978 - WARNING - No training batch available in replay buffer. Skipping this step.
2025-06-02 15:59:51,978 - WARNING - No successful steps during online update.
2025-06-02 15:59:51,978 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], current edge mean: [ 7.1730103e+00  1.4175317e+00  4.9780855e+00  2.1999407e-09
  1.0999703e-09  0.0000000e+00  1.0999703e-09 -1.7874519e-09
  6.8748146e-10 -1.0999703e-09]
2025-06-02 15:59:51,979 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0054
2025-06-02 15:59:51,980 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.9234428e-10 -3.9094722e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.5470804e-08
  2.0139707e-08  2.6063150e-08 -2.3693771e-09  1.8955017e-08
  2.2968943e+00  2.9577639e+00  1.4658386e-01  4.3987579e+00
 -1.8955017e-08  3.4161491e+00  5.7304349e+00  7.5925465e+00
  1.4658386e-01  7.9913044e+00  2.0732051e-08 -2.3693772e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2196150e-09 -4.7387543e-09], edge=[ 7.1730103e+00  1.4175317e+00  4.9780855e+00  2.1999407e-09
  1.0999703e-09  0.0000000e+00  1.0999703e-09 -1.7874519e-09
  6.8748146e-10 -1.0999703e-09]
2025-06-02 15:59:51,980 - DEBUG - Updated reference std: node=[0.         0.         1.0006217  1.0006217  0.         0.
 0.         1.0006217  1.0006218  1.0006217  1.0006217  1.0006217
 1.0000262  0.28773427 0.3710666  0.5675718  1.0006218  3.0480378
 2.9194205  1.52196    0.3710666  0.24671759 1.0006217  1.0006217
 0.         0.         0.         0.         1.0006217  1.0006217 ], edge=[1.0732268 0.5071372 1.7816736 1.0002885 1.0002885 1.0002885 1.0002885
 1.0002885 1.0002885 1.0002885]
2025-06-02 15:59:51,980 - INFO - Online update complete. Loss: 0.0000
2025-06-02 15:59:51,980 - INFO - Running anomaly detection...
2025-06-02 15:59:51,981 - INFO - Starting anomaly detection.
2025-06-02 15:59:52,053 - DEBUG - Node reconstruction errors: [24.71982  22.374996 30.748653 21.367016 17.476969 20.95706  32.357944
 19.216318 19.216326 20.70011  19.216309 20.16524  38.81075  19.843153
 20.68208  19.622755 20.861856 19.616297 23.082685 19.729967 19.34385
 20.682085 19.679144 19.29541  20.649443 20.435974 20.65109  19.822426
 19.327736 20.651089 20.613134 23.5187   19.47917  21.37647  20.34097
 20.32583  22.801064 19.730076 18.614906 19.22808  23.302635 20.816341
 19.730078 23.38317  20.25462  19.574057 24.338404 19.358532 19.464102
 35.881065 40.42639  21.353876 20.55641  23.570454 18.884909 18.013197
 31.310495 20.035528 22.357744 22.942192 18.177437 21.353973 20.977762
 20.393202 20.32307  18.884912 19.173714 18.884884 20.9779   20.9779
 19.76056  21.486483 19.37788  21.195295 23.74179  21.375582 24.620327
 21.836702 21.484068 21.30638  21.805859 21.518026 17.051077 24.081
 23.0964   18.808084 22.424109 22.75531  21.571342 23.89224  20.335016
 18.106564 19.609549 21.406015 20.167206 35.132565 22.106524 22.12835
 21.401855 18.966387 21.746038 22.10653  22.965767 22.913239 18.549694
 19.344439 18.902946 17.662157 18.561117 29.032446 21.969881 21.8486
 19.336813 18.187128 21.077765 21.607822 21.190733 17.729725 20.87453
 20.34577  20.546234 20.38603  18.04716  19.334475 21.716564 20.345604
 18.724947 18.065935 23.01684  21.436525 21.98113  19.506166 19.48638
 17.768482 21.277214 19.133945 24.149645 21.368767 17.636662 16.692804
 19.813852 22.244114 20.585974 19.596308 19.72928  22.40133  21.190733
 19.461916 20.419237 20.960623 25.744202 19.527853 22.226805 19.506165
 19.402012 18.46909  19.718554 22.593468 21.746037 22.898884 19.725485
 17.355522 19.718557 21.981035 21.83218  16.664335 22.544384 21.722795
 18.00877  21.29116  21.429523 20.453226 20.513641 33.633144 22.223146
 20.44144  21.545658 22.788496 21.964643 21.96464  19.584743 19.567858
 20.212542 17.897621 19.62143  22.525208 20.827845 21.797478 19.357307
 19.957964 23.120998 21.63733  21.842228 19.649944 17.63734  21.380445
 16.632536 21.065113 17.615965 20.832384 21.165873 19.718464 18.088644
 23.230078 23.053282 19.16915  21.5538   19.944672 21.445656 22.32215
 22.06259  21.314249 21.25834  22.275091 22.09428  20.810873 23.210672
 21.190733 22.437868 19.64996  18.782787 20.82781  20.715948 21.258339
 19.71857  22.645947 17.017279 19.633375 21.649332 19.222958 19.571192
 22.003906 22.758564 21.19074  21.190733 21.382015 21.755959 20.715952
 19.718534 22.792439 18.24892  22.281445 19.66511  21.971643 19.836452
 21.727917 21.95704  22.579393 19.665104 20.175447 20.513636 20.658905
 22.437876 22.224144 23.049948 21.44225  19.95985  21.78576  21.472647
 21.964643 22.822414 19.57381  21.281618 20.544178 22.900951 20.447979
 22.761087 22.616787 22.761091 23.004923 18.179623 18.08626  22.247593
 24.4802   22.780445 21.964643 20.774677 22.654661 19.584698 22.82819
 19.972881 20.715624 21.29333  24.179365 23.414711 23.242836 17.978884
 19.073015 19.56786  18.629688 21.046288 22.4953   21.08336  19.836464
 17.568533 21.956661 22.545593 21.964684 21.382061 19.27221  22.122488
 21.878193 23.03912  24.102892 21.878332 21.878399 21.878391 22.931444
 21.937357 21.878298 21.878391 19.341738 21.87839  20.233097 20.411798
 22.13375  23.503298 19.996592 21.497631 21.449514 22.868628 20.77867
 21.861246 23.03912  17.726942 17.986778 21.656149 22.93145  22.465593
 22.465595 23.488253 21.66217  21.877281 22.780443 21.878386 22.931444
 21.091259 20.871012 21.656223 21.656193 21.850044 20.32616  21.656221
 23.947649 22.967531 23.155058 23.039118 23.28758  22.525642 21.747242
 21.877462 22.205982 18.901905 24.09741  20.35828  19.959845 22.087461
 21.878405 21.61035  25.750406 22.062592 21.046074 20.703531 22.818518
 23.039112 26.225157 20.978191 19.774252 21.53517  21.745    22.552061
 22.608664 23.478598 18.670368 22.251709 24.097279 20.900831 20.835392
 23.16454  21.878395 23.039124 17.746574 20.036655 21.550163 17.894773
 23.346935 19.461805 18.358166 23.095572 21.878256 23.096777 22.57407
 22.471317 22.729956 23.367699 23.367746 23.367798 23.457825 22.170778
 23.281614 20.529696 22.753368 23.367737 22.171274 22.723646 22.471296
 24.102896 20.195568 22.47132  17.17319  23.367767 22.471317 22.171143
 23.367733 23.367765 20.83161  20.557165 23.367794 20.940847 21.798868
 20.405844 20.848677 21.890568 20.317137 19.08375  20.935728 20.841166
 23.714808 19.274588 21.079393 23.047743 20.146244 23.891317 22.02225
 23.367798 23.367743 20.529926 21.667135 18.926186 22.127218 21.902754
 21.437895 21.839703 21.687632 21.788446 19.869556 19.171715 20.723328
 22.148258 20.53672  23.49502  21.459648 20.462238 22.487185 21.459646
 20.188862 20.319916 20.245148 23.104828 22.811537 21.779425 20.181526
 20.406862 19.803448 20.401794 20.181501 21.370064 22.455433 18.773027
 21.818964 21.370066 21.779408 22.371016 18.487461 21.851656 21.890581
 22.811537 21.779425 21.523247 20.39906  22.83026  18.0866   21.462334
 20.722498 18.388926 22.140337 21.459646 18.199476 22.022856 18.293074
 23.16917  21.523272 22.290892 21.30033  22.169373 20.24452  22.046362
 27.30589  22.487183 20.399132 20.683966 21.301477 20.684374 21.261238
 21.65269  19.67061  22.567467 18.276796 21.097857 21.459646 19.960302
 21.519432 21.519476 21.788206 24.064692 21.788488 22.56022  23.623987
 24.191326 22.864714 23.623987 21.438786 22.567846 21.907568 21.652676
 22.046377 23.07308  18.542522 23.623976 22.534021 21.903131 22.487179
 22.487164 20.399149 22.046364 22.76029  23.310865 21.968716 22.487144
 22.848915 22.48713  22.848919 23.11575  23.623983 21.837175 26.085442
 20.74871  22.823772 20.547985 22.823792 22.823755 22.823772 22.823803
 22.82379  22.823774 22.823784 23.807043 22.226248 22.346048 22.82372
 22.823809 22.823784 22.823803 22.823786 22.823805 22.82378  22.823784
 22.823812 23.949678 22.82352  22.823809 20.477776 22.823784 19.227264
 24.135227 22.487179 24.446974 22.843653 28.668863 28.668863 21.82513
 24.446974 22.487154 22.567883 22.567593 22.487177 22.567427 24.569849
 21.726301 22.81852  21.43899  22.487179 21.519173 22.48718  22.487156
 22.88047  22.487171 22.567888 22.487175 22.48716  23.623987 22.567862
 22.487152 22.567413 22.487148 22.487183 22.487177 23.471933 22.169374
 22.169378 22.823809 21.172646 23.72602  22.487154 22.5675   24.43705
 22.823452 22.56789  22.813122 22.659166 22.487179 22.48718  23.272884
 23.658588 22.914831 22.487078 23.807041 22.880629 22.567816 20.609684
 22.823809 22.567019 23.623976 22.823786 22.822807 23.807041 22.881899
 22.48717  21.107403 22.14033  24.831156 23.658602 23.85978  23.978533
 23.978537 24.457539 22.272835 22.823803 21.860054 24.810085 23.658588
 23.21982  21.755917 22.080933 23.184618 23.184624 23.184578 23.184591
 23.18462  24.301485 24.848145 23.184622 23.183949 22.823782 23.274603
 22.823784 23.97854  23.800625 23.978497 21.211405 23.97854  24.095861
 23.949684 23.039248 23.949678 22.823795 23.97854  21.963692 22.916195
 22.91616  23.184618 21.963703 23.144073 21.539354 22.823725 22.823797
 23.184587 22.524908 22.916231 23.137608 22.080938 22.64239  24.301483
 19.231768 22.642046 19.488989 23.737158 22.080801 21.703657 22.300293
 22.432861 22.432861 24.676998 23.57308  24.316767 22.08094  22.080914
 22.080938 22.172607 22.080936 22.080938 22.432861 22.080936 22.08094
 22.080885 23.933445 22.666643 23.852613 24.516653 23.81553  21.701471
 22.653723 24.033514 25.245152 22.772434 23.054388 22.922865 22.598352
 22.598593 22.432861 18.886988 23.426691 22.80433  23.983225 23.442347
 20.291412 23.473108 23.473108 23.47311  24.421286 23.332682 21.114502
 23.547907 21.686178 24.658173 23.053293 23.074053 23.983398 21.729265
 23.340496 22.922472 23.373407 22.804329 23.426788 23.983398 23.736597
 22.922829 22.930964 23.473108 24.42105  22.921946 22.937534 23.02997
 24.421267 24.421288 24.421326 23.52445  25.495228 20.372673 23.473108
 23.43334  24.421198 23.749704 23.840101 29.152548 23.838076 24.421295
 24.886055 23.836393 23.201347 24.87942  23.80251  45.444515 26.608187
 25.908587 23.840197 25.908587 23.487038 26.054264 25.58065  24.88582
 23.62161  23.620789 25.580627 23.755743 24.886047 23.840166 26.054262
 23.840162 24.065084 24.065119 24.065117 23.621649 24.065037 24.065119]
2025-06-02 15:59:52,054 - DEBUG - Edge reconstruction errors: [1.1556945  1.1567373  0.7503833  ... 0.14794649 1.2484899  0.14929827]
2025-06-02 15:59:52,056 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_155952_update_32.json
2025-06-02 15:59:52,056 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 15:59:52,060 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_155952_update_32.pth and as latest_checkpoint.pth
2025-06-02 15:59:52,060 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870055.dot): 0.5958
2025-06-02 15:59:52,060 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 15:59:52,060 - WARNING -   Node ID: 192.168.27.13, Recon Error: 30.7487, MLP Score: 0.0257
2025-06-02 15:59:52,060 - WARNING -   Node ID: 192.168.27.12, Recon Error: 32.3579, MLP Score: 0.0361
2025-06-02 15:59:52,060 - WARNING -   Node ID: 192.168.27.10, Recon Error: 38.8107, MLP Score: 0.0395
2025-06-02 15:59:52,060 - WARNING -   Node ID: ff02::2, Recon Error: 35.8811, MLP Score: 0.0012
2025-06-02 15:59:52,060 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 40.4264, MLP Score: 0.0012
2025-06-02 15:59:52,060 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 15:59:52,061 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 18.9041, MLP Score: 0.9754
2025-06-02 15:59:52,061 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 16.1959, MLP Score: 0.9187
2025-06-02 15:59:52,061 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.1929, MLP Score: 0.1180
2025-06-02 15:59:52,061 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.3930, MLP Score: 0.0763
2025-06-02 15:59:52,061 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.9241, MLP Score: 0.0242
2025-06-02 15:59:52,061 - INFO - 
--- Processing file: nw_graph_encoded_1748870085.dot (Timestamp: 2025-06-02 15:14:45) ---
2025-06-02 15:59:52,061 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:59:52,061 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:59:52,086 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:59:52,110 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:59:52,110 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:59:52,110 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870085.dot
2025-06-02 15:59:52,130 - INFO - Parsed 818 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:59:52,153 - INFO - Parsed 1761 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870085.dot'.
2025-06-02 15:59:52,153 - INFO - Processing node updates/additions.
2025-06-02 15:59:52,159 - INFO - Processing edge updates/additions.
2025-06-02 15:59:52,173 - INFO - Processing deletions (nodes and edges).
2025-06-02 15:59:52,174 - INFO - Finished updating NetworkX graph.
2025-06-02 15:59:52,174 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 15:59:52,175 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 15:59:52,186 - DEBUG - Initial node features tensor shape: torch.Size([818, 30])
2025-06-02 15:59:52,189 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 15:59:52,189 - DEBUG - Node features tensor shape after scaling: torch.Size([818, 30])
2025-06-02 15:59:52,191 - DEBUG - Edge index tensor shape: torch.Size([2, 1761])
2025-06-02 15:59:52,193 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 15:59:52,199 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 17
2025-06-02 15:59:52,201 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 15:59:52,203 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 15:59:52,205 - DEBUG - Shape of encoded categorical edge features: torch.Size([1761, 3])
2025-06-02 15:59:52,206 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 15:59:52,206 - DEBUG - Shape of scaled numerical edge features: torch.Size([1761, 7])
2025-06-02 15:59:52,206 - DEBUG - Final edge attributes tensor shape: torch.Size([1761, 10])
2025-06-02 15:59:52,207 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 15:59:52,210 - INFO - Performing online update...
2025-06-02 15:59:52,210 - INFO - Starting online update for 50 steps.
2025-06-02 15:59:52,211 - DEBUG - Updated RunningStats: new_mean=0.9431474725346277, new_var=18600000000160.938, new_n=1890
2025-06-02 15:59:52,211 - DEBUG - Updated RunningStats: new_mean=0.9400313981362496, new_var=18900000000018.375, new_n=1920
2025-06-02 15:59:52,212 - DEBUG - Updated RunningStats: new_mean=1.0730389432930463, new_var=6200000000060.6875, new_n=630
2025-06-02 15:59:52,212 - DEBUG - Updated RunningStats: new_mean=1.0724439873047815, new_var=6300000000000.851, new_n=640
2025-06-02 15:59:52,212 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 15:59:52,212 - DEBUG - Online update step: 1/50
2025-06-02 15:59:52,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:52,292 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:52,296 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:52,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:52,485 - DEBUG - Step 1: Loss=18.5979
2025-06-02 15:59:52,485 - DEBUG - Online update step: 2/50
2025-06-02 15:59:52,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:52,558 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:52,561 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:52,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:52,674 - DEBUG - Step 2: Loss=16.1528
2025-06-02 15:59:52,675 - DEBUG - Online update step: 3/50
2025-06-02 15:59:52,677 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:52,822 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:52,829 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:52,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:52,970 - DEBUG - Step 3: Loss=14.1481
2025-06-02 15:59:52,970 - DEBUG - Online update step: 4/50
2025-06-02 15:59:52,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:53,036 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:53,039 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:53,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:53,197 - DEBUG - Step 4: Loss=12.5125
2025-06-02 15:59:53,197 - DEBUG - Online update step: 5/50
2025-06-02 15:59:53,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:53,290 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:53,295 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:53,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:53,441 - DEBUG - Step 5: Loss=11.1779
2025-06-02 15:59:53,441 - DEBUG - Online update step: 6/50
2025-06-02 15:59:53,444 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:53,562 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:53,566 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:53,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:53,694 - DEBUG - Step 6: Loss=10.0823
2025-06-02 15:59:53,694 - DEBUG - Online update step: 7/50
2025-06-02 15:59:53,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:53,760 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:53,763 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:53,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:53,939 - DEBUG - Step 7: Loss=9.1666
2025-06-02 15:59:53,939 - DEBUG - Online update step: 8/50
2025-06-02 15:59:53,942 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:54,023 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:54,027 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:54,028 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:54,190 - DEBUG - Step 8: Loss=8.3750
2025-06-02 15:59:54,190 - DEBUG - Online update step: 9/50
2025-06-02 15:59:54,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:54,289 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:54,292 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:54,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:54,487 - DEBUG - Step 9: Loss=7.7172
2025-06-02 15:59:54,488 - DEBUG - Online update step: 10/50
2025-06-02 15:59:54,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:54,565 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:54,572 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:54,573 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:54,712 - DEBUG - Step 10: Loss=7.1640
2025-06-02 15:59:54,712 - DEBUG - Online update step: 11/50
2025-06-02 15:59:54,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:54,813 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:54,817 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:54,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:55,026 - DEBUG - Step 11: Loss=6.6892
2025-06-02 15:59:55,026 - DEBUG - Online update step: 12/50
2025-06-02 15:59:55,030 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:55,255 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:55,260 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:55,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:55,408 - DEBUG - Step 12: Loss=6.2684
2025-06-02 15:59:55,409 - DEBUG - Online update step: 13/50
2025-06-02 15:59:55,414 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:55,499 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:55,513 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:55,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:55,663 - DEBUG - Step 13: Loss=5.9037
2025-06-02 15:59:55,664 - DEBUG - Online update step: 14/50
2025-06-02 15:59:55,669 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:55,779 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:55,782 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:55,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:55,926 - DEBUG - Step 14: Loss=5.5929
2025-06-02 15:59:55,927 - DEBUG - Online update step: 15/50
2025-06-02 15:59:55,932 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:56,097 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:56,100 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:56,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:56,210 - DEBUG - Step 15: Loss=5.2951
2025-06-02 15:59:56,211 - DEBUG - Online update step: 16/50
2025-06-02 15:59:56,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:56,271 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:56,275 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:56,276 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:56,441 - DEBUG - Step 16: Loss=5.0176
2025-06-02 15:59:56,441 - DEBUG - Online update step: 17/50
2025-06-02 15:59:56,447 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:56,517 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:56,520 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:56,522 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:56,637 - DEBUG - Step 17: Loss=4.7834
2025-06-02 15:59:56,637 - DEBUG - Online update step: 18/50
2025-06-02 15:59:56,642 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:56,751 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:56,755 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:56,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:56,885 - DEBUG - Step 18: Loss=4.5911
2025-06-02 15:59:56,885 - DEBUG - Online update step: 19/50
2025-06-02 15:59:56,891 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:57,098 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:57,105 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:57,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:57,250 - DEBUG - Step 19: Loss=4.4058
2025-06-02 15:59:57,251 - DEBUG - Online update step: 20/50
2025-06-02 15:59:57,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:57,366 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:57,370 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:57,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:57,508 - DEBUG - Step 20: Loss=4.2153
2025-06-02 15:59:57,509 - DEBUG - Online update step: 21/50
2025-06-02 15:59:57,514 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:57,615 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:57,639 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:57,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:57,862 - DEBUG - Step 21: Loss=4.0169
2025-06-02 15:59:57,862 - DEBUG - Online update step: 22/50
2025-06-02 15:59:57,865 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:57,934 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:57,938 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:57,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:58,070 - DEBUG - Step 22: Loss=3.8113
2025-06-02 15:59:58,070 - DEBUG - Online update step: 23/50
2025-06-02 15:59:58,073 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:58,193 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:58,196 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:58,197 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:58,368 - DEBUG - Step 23: Loss=3.6026
2025-06-02 15:59:58,369 - DEBUG - Online update step: 24/50
2025-06-02 15:59:58,372 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:58,451 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:58,454 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:58,455 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:58,572 - DEBUG - Step 24: Loss=3.3935
2025-06-02 15:59:58,572 - DEBUG - Online update step: 25/50
2025-06-02 15:59:58,575 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:58,680 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:58,684 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:58,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:58,830 - DEBUG - Step 25: Loss=3.1838
2025-06-02 15:59:58,830 - DEBUG - Online update step: 26/50
2025-06-02 15:59:58,833 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:58,913 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:58,916 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:58,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:59,025 - DEBUG - Step 26: Loss=2.9840
2025-06-02 15:59:59,025 - DEBUG - Online update step: 27/50
2025-06-02 15:59:59,028 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:59,142 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:59,145 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:59,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:59,264 - DEBUG - Step 27: Loss=2.7981
2025-06-02 15:59:59,264 - DEBUG - Online update step: 28/50
2025-06-02 15:59:59,267 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:59,339 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:59,341 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:59,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:59,478 - DEBUG - Step 28: Loss=2.6152
2025-06-02 15:59:59,478 - DEBUG - Online update step: 29/50
2025-06-02 15:59:59,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:59,549 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:59,553 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:59,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:59,672 - DEBUG - Step 29: Loss=2.4346
2025-06-02 15:59:59,672 - DEBUG - Online update step: 30/50
2025-06-02 15:59:59,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:59,787 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:59,790 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:59,792 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 15:59:59,895 - DEBUG - Step 30: Loss=2.2598
2025-06-02 15:59:59,896 - DEBUG - Online update step: 31/50
2025-06-02 15:59:59,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 15:59:59,951 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 15:59:59,954 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 15:59:59,955 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:00,098 - DEBUG - Step 31: Loss=2.0971
2025-06-02 16:00:00,099 - DEBUG - Online update step: 32/50
2025-06-02 16:00:00,102 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:00,201 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:00,204 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:00,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:00,323 - DEBUG - Step 32: Loss=1.9558
2025-06-02 16:00:00,323 - DEBUG - Online update step: 33/50
2025-06-02 16:00:00,327 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:00,416 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:00,419 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:00,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:00,559 - DEBUG - Step 33: Loss=1.8369
2025-06-02 16:00:00,559 - DEBUG - Online update step: 34/50
2025-06-02 16:00:00,562 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:00,636 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:00,640 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:00,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:00,808 - DEBUG - Step 34: Loss=1.7361
2025-06-02 16:00:00,808 - DEBUG - Online update step: 35/50
2025-06-02 16:00:00,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:00,893 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:00,897 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:00,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:01,033 - DEBUG - Step 35: Loss=1.6568
2025-06-02 16:00:01,033 - DEBUG - Online update step: 36/50
2025-06-02 16:00:01,036 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:01,116 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:01,121 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:01,122 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:01,287 - DEBUG - Step 36: Loss=1.6005
2025-06-02 16:00:01,287 - DEBUG - Online update step: 37/50
2025-06-02 16:00:01,293 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:01,368 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:01,372 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:01,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:01,496 - DEBUG - Step 37: Loss=1.5592
2025-06-02 16:00:01,496 - DEBUG - Online update step: 38/50
2025-06-02 16:00:01,500 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:01,604 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:01,610 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:01,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:01,757 - DEBUG - Step 38: Loss=1.5296
2025-06-02 16:00:01,757 - DEBUG - Online update step: 39/50
2025-06-02 16:00:01,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:01,838 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:01,842 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:01,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:01,971 - DEBUG - Step 39: Loss=1.5171
2025-06-02 16:00:01,972 - DEBUG - Online update step: 40/50
2025-06-02 16:00:01,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:02,066 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:02,074 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:02,075 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:02,228 - DEBUG - Step 40: Loss=1.5179
2025-06-02 16:00:02,229 - DEBUG - Online update step: 41/50
2025-06-02 16:00:02,233 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:02,314 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:02,317 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:02,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:02,457 - DEBUG - Step 41: Loss=1.5244
2025-06-02 16:00:02,457 - DEBUG - Online update step: 42/50
2025-06-02 16:00:02,461 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:02,531 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:02,538 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:02,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:02,696 - DEBUG - Step 42: Loss=1.5262
2025-06-02 16:00:02,696 - DEBUG - Online update step: 43/50
2025-06-02 16:00:02,700 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:02,797 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:02,800 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:02,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:02,972 - DEBUG - Step 43: Loss=1.5184
2025-06-02 16:00:02,973 - DEBUG - Online update step: 44/50
2025-06-02 16:00:02,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:03,058 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:03,061 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:03,063 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:03,195 - DEBUG - Step 44: Loss=1.5055
2025-06-02 16:00:03,195 - DEBUG - Online update step: 45/50
2025-06-02 16:00:03,202 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:03,297 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:03,300 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:03,301 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:03,445 - DEBUG - Step 45: Loss=1.4865
2025-06-02 16:00:03,445 - DEBUG - Online update step: 46/50
2025-06-02 16:00:03,450 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:03,534 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:03,538 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:03,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:03,665 - DEBUG - Step 46: Loss=1.4615
2025-06-02 16:00:03,666 - DEBUG - Online update step: 47/50
2025-06-02 16:00:03,669 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:03,745 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:03,749 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:03,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:03,916 - DEBUG - Step 47: Loss=1.4323
2025-06-02 16:00:03,917 - DEBUG - Online update step: 48/50
2025-06-02 16:00:03,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:04,010 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:04,013 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:04,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:04,127 - DEBUG - Step 48: Loss=1.4028
2025-06-02 16:00:04,128 - DEBUG - Online update step: 49/50
2025-06-02 16:00:04,130 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:04,188 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:04,191 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:04,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:04,385 - DEBUG - Step 49: Loss=1.3786
2025-06-02 16:00:04,386 - DEBUG - Online update step: 50/50
2025-06-02 16:00:04,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:04,469 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:04,472 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:04,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:04,630 - DEBUG - Step 50: Loss=1.3581
2025-06-02 16:00:04,631 - INFO - Online update finished. Average loss: 4.6112, Learning rate: 0.001000
2025-06-02 16:00:04,632 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], current edge mean: [ 7.1714935e+00  1.4168086e+00  4.9852357e+00 -2.1662108e-09
  1.6246581e-09  1.0831054e-09 -4.3324215e-09 -3.3847045e-10
  6.7694089e-10 -2.1662108e-09]
2025-06-02 16:00:04,633 - DEBUG - Node drift difference: 0.0096, Edge drift difference: 0.0040
2025-06-02 16:00:04,636 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.9819637e-08  3.3227039e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  5.4795468e-08
  3.0312385e-08 -9.3268886e-09 -2.7980665e-08  0.0000000e+00
  2.3019559e+00  2.9584353e+00  1.4303179e-01  4.4034228e+00
  2.7980665e-08  3.4156480e+00  5.7371640e+00  7.5990219e+00
  1.4303179e-01  7.9914427e+00 -1.9819637e-08 -3.8327681e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -5.8293054e-10  2.4483082e-08], edge=[ 7.1714935e+00  1.4168086e+00  4.9852357e+00 -2.1662108e-09
  1.6246581e-09  1.0831054e-09 -4.3324215e-09 -3.3847045e-10
  6.7694089e-10 -2.1662108e-09]
2025-06-02 16:00:04,637 - DEBUG - Updated reference std: node=[0.         0.         1.0006118  1.0006118  0.         0.
 0.         1.0006119  1.0006119  1.0006118  1.0006118  1.0006118
 1.0033096  0.28548482 0.36737394 0.5672308  1.0006118  3.0404615
 2.9175723  1.5106635  0.36737394 0.24474926 1.0006118  1.0006118
 0.         0.         0.         0.         1.0006118  1.0006118 ], edge=[1.0660592 0.5068073 1.7747625 1.0002841 1.0002841 1.0002841 1.0002841
 1.0002841 1.0002841 1.0002841]
2025-06-02 16:00:04,638 - INFO - Online update complete. Loss: 4.6112
2025-06-02 16:00:04,638 - INFO - Running anomaly detection...
2025-06-02 16:00:04,639 - INFO - Starting anomaly detection.
2025-06-02 16:00:04,664 - DEBUG - Node reconstruction errors: [ 1.8880903   7.857804   19.621363    1.1003186   2.206135    1.3818624
 19.749481    1.1179712   1.1179711   1.171934    1.1179711   1.935355
 25.943136    2.360725    0.8991654   1.2335088   2.005961    1.2335057
  3.8216753   1.0809811   0.70557654  0.8991654   0.6856693   1.4028761
  0.82923186  0.8056048   0.829232    3.023895    0.9538925   0.8292319
  4.4936805   2.0906057   2.8058114   0.9424399   0.82160467  0.79887706
  1.6967828   1.0809814   2.018695    1.4343438   0.8960454   0.7556006
  1.0809811   0.7345016   1.3060507   1.4936413   1.3893409   1.5015508
  0.81403375  2.160274    5.8372846   0.75543386  0.669014    3.3784323
  0.4497462   1.7956597  11.320414    0.8322716   3.2260356   3.2428126
  1.390983    0.47862858  0.63095677  1.4709638   0.6372598   0.4497462
  0.39039227  0.4497472   0.6309568   0.63095677  0.49469388  0.9830261
  0.33552253  1.2942307   1.6455729   1.0542082   0.71037513  0.99821347
  1.0488011   1.1295956   0.5587412   0.84200037  2.5786667   3.264767
  1.2268783   1.2235484   0.85741675  1.198362    1.2277527   1.3107041
  0.48006588  2.016465    1.1057498   1.0019783   0.31826162  5.185817
  0.46950966  1.0068879   0.40125135  0.36628392  0.8207445   0.46950966
  0.51238555  1.3778995   1.2889205   0.327929    1.1925724   1.0012726
  1.1725587   1.2081679   0.8758461   0.47028574  2.1084049   1.8815155
  0.85700446  0.7436173   0.7973805   1.7825649   1.1350595   0.32424527
  0.3677145   1.1546482   1.5457515   1.0492903   1.0775628   0.3242068
  0.9790808   0.82107353  1.1507915   0.38865143  0.4127884   0.27381957
  1.2034835   1.9647471   0.7686476   0.3314233   0.49855897  0.43662342
  1.0164608   1.7941693   0.2906984   0.78923005  0.34722456  0.4768295
  0.26789838  0.9067497   0.797381    0.33509323  0.36378282  0.99057555
  1.5160637   1.4746444   1.2524836   0.27381957  2.2534854   2.040475
  0.2524164   0.7447232   0.8207449   0.58242553  0.26789856  0.8280324
  0.25241628  0.41278842  0.7849177   1.7936248   0.9206617   0.9934346
  0.9359499   0.9656502   1.06927     0.34206375  0.43870863  6.424976
  1.0518949   0.55815816  0.9772562   0.77975374  0.73599017  0.7359901
  0.29640898  1.1314092   0.43235284  1.5292689   2.2804916   1.0455985
  0.30343392  0.73016614  0.2984675   0.22134024  1.124248    1.0999924
  0.38369936  0.29228908  1.0164275   0.27199608  2.3010993   0.5316341
  1.7858233   0.3907038   0.36764914  0.25241634  1.6629064   1.2318493
  0.99587667  1.0202442   0.52634114  2.5046582   0.37595835  1.2205281
  0.71034163  0.74878824  0.32163128  1.0127366   1.077687    0.33967814
  0.85703474  0.7973806   0.94710124  0.29228908  1.8086158   0.30343398
  0.3676725   0.32163128  0.25241628  1.198194    1.7669609   0.32706425
  0.98454577  1.1031342   1.0481242   1.0256684   1.165416    0.79738134
  0.7973804   0.27199605  0.92728305  0.36767253  0.25241628  0.46350354
  1.8733953   0.99457496  0.27584988  1.128329    0.26890847  1.0326087
  0.6855236   0.8956896   0.27584988  0.40129027  0.43870863  0.4376903
  0.9471024   1.0395675   0.8476763   0.88921344  0.22134012  0.32123566
  0.399113    0.73599     1.1351391   1.3451827   0.5616137   0.2915118
  1.1794126   0.28420264  1.2864226   4.3167963   1.2864206   0.74793535
  1.5450654   1.5085512   0.9684252   0.62681985  0.8382989   0.73599035
  0.35557282  1.1040673   0.29640886  1.1114383   2.7910516   0.37609768
  0.9150012   0.5179176   1.2001892   0.4012656   2.3249857   0.92042756
  1.131409    0.7597104   0.41676039  0.34057915  0.29454222  0.26890847
  1.8061937   0.33860576  1.0218024   0.73599553  0.27199605  1.3484563
  0.90100545  0.32116568  0.77716976  1.357079    0.32116574  0.32116586
  0.32116574  0.7985833   0.30454728  0.32116574  0.32116577  2.2809548
  0.32116574  0.20939077  1.2535018   0.95909715  1.143446    1.0405369
  0.28423235  0.27502817  1.2644645   0.3542587   1.0753617   0.7771696
  0.87451935  1.5129018   0.3425775   0.7985838   1.1693105   1.1693133
  1.7810745   0.2617141   0.32116562  0.8382994   0.32116577  0.79858464
  0.3479747   0.3680934   0.34257755  0.3425775   0.3211612   0.41261283
  0.34257752  1.3978101   1.1978754   1.1148021   0.7771699   0.37528104
  1.251939    0.95928556  0.32116577  0.681806    1.795136    0.94140244
  0.38473043  0.22134015  0.30142444  0.32116574  0.36853594  3.306678
  0.71034175  0.3086534   0.55967045  1.0029956   0.7771693   5.6028337
  0.29354823  2.385497    0.68242186  0.6555873   0.9034195   0.99102026
  1.1189681   1.6641121   0.9374782   0.9414367   0.3161546   0.31670058
  1.1083311   0.32116586  0.77716964  0.787332    0.2119406   0.8790882
  0.8155061   1.181902    0.31438667  1.1479472   0.8703519   0.32116577
  0.98792464  0.6566382   0.6298665   0.6296046   0.8214878   0.82148784
  0.82148767  2.9824946   0.29366937  2.9815319   0.21639709  0.7714065
  0.8214877   0.29366937  0.63354796  0.6298645   1.4170234   0.24983335
  0.62986636  0.95570093  0.8214878   0.62986666  0.29366934  0.82148784
  0.8214878   0.33175194  0.36590174  0.8214878   0.31615457  0.39908925
  0.24077018  0.3091222   0.6287626   0.21765517  1.6143882   0.38142213
  0.4176068   0.7669223   0.9051157   1.1467892   1.1319613   0.29026255
  0.85654724  0.7282689   0.82148784  0.821488    0.21639714  0.95958877
  1.5676523   0.28919485  0.4514895   0.29765075  0.7013599   0.2889411
  0.31445333  1.9738674   2.0606897   0.27048936  0.29981935  0.22256969
  1.1596597   0.27203825  0.21272565  0.285777    0.2720382   0.3116933
  0.21765518  0.20696738  0.3296973   0.7944099   0.63705933  0.20593432
  0.23800854  1.1982316   0.23800866  0.20593432  0.28718212  0.6983258
  0.91231936  0.2730862   0.28718212  0.63705635  1.0125351   1.7589656
  0.83595383  0.6287563   0.7944108   0.6370594   0.26768288  0.21258989
  0.31128833  1.9406466   0.29075438  0.27048942  1.7276499   0.3593626
  0.2720382   0.84111667  0.49306998  1.7235256   0.63022727  0.2676829
  0.90307593  0.26749644  0.61467767  0.20696743  0.61268353  3.525773
  0.28577694  0.21258989  0.4776858   0.26749623  0.47768593  0.30613735
  0.27661255  1.0278127   0.28749314  2.1727247   0.4140229   0.27203825
  1.0664535   0.30275783  0.30275786  0.31445333  0.83777493  0.45148936
  0.2874929   0.7179366   0.4353695   0.85569024  0.7179376   0.2976507
  0.2874932   0.27243412  0.27661255  0.6126864   0.36143193  0.8885877
  0.7179355   0.9562349   0.4514893   0.28577694  0.28577694  0.21258983
  0.612685    0.60836434  1.046677    0.9275614   0.28577694  0.7383662
  0.28577676  0.7383662   0.4936413   0.7179352   0.37490723  3.8281806
  1.1736237   0.2975036   2.3425143   0.29750362  0.29750365  0.29750362
  0.29750362  0.29750362  0.29750362  0.29750362  0.71036476  0.42774174
  0.5096577   0.29750362  0.29750362  0.29750362  0.29750362  0.2975036
  0.29750362  0.2975036   0.29750362  0.29750362  0.7196589   0.29750365
  0.29750362  2.1143904   0.2975036   0.9695849   0.5618674   0.285777
  0.78673786  0.7723165   2.3097475   2.3097475   0.9443566   0.78673786
  0.28577688  0.28749314  0.2874932   0.28577694  0.2874932   0.38955134
  0.39475682  0.29750338  0.2976507   0.285777    0.30275783  0.285777
  0.28577694  0.35188356  0.28577694  0.28749314  0.28577688  0.28577676
  0.7179367   0.28749314  0.285777    0.28749302  0.28577694  0.285777
  0.28577694  1.1021651   0.61467767  0.614678    0.29750362  0.40168032
  0.61618775  0.285777    0.28749314  1.2494708   0.29750365  0.2874932
  0.9936208   0.299055    0.285777    0.285777    0.6601727   1.0962125
  0.6827057   0.28577694  0.71036476  0.35188368  0.28749314  1.0596882
  0.29750362  0.28749305  0.7179361   0.29750362  0.29750362  0.7103646
  0.3518836   0.285777    0.64443415  0.7337268   1.3591499   1.0962125
  0.37320963  0.7868159   0.7868159   0.5569642   0.4032369   0.29750362
  0.33015087  0.9300803   1.0962126   0.623209    0.279318    0.3057634
  0.32854313  0.32854316  0.32854304  0.3285431   0.32854304  0.74215335
  1.0300395   0.32854316  0.3285431   0.29750362  0.3997212   0.29750362
  0.7868158   1.1051528   0.78681606  0.33743456  0.78681624  1.1366588
  0.7196607   0.44488573  0.7196616   0.29750362  0.7868159   0.28524002
  0.30828878  0.30828884  0.32854316  0.28524002  0.96783864  0.36732337
  0.2975036   0.29750362  0.3285431   0.42183685  0.30828878  0.35941252
  0.3057634   0.38757592  0.7421535   1.8665696   0.38757598  1.8970813
  0.68977815  0.30576336  0.39600793  0.31296256  0.3519486   0.3519486
  0.8353201   0.37950087  0.8007413   0.3057634   0.3057634   0.3057634
  0.3197546   0.30576336  0.3057634   0.3519486   0.3057634   0.3057634
  0.3057634   0.70539206  0.36009777  1.0482463   1.1706861   0.7712584
  0.42707065  0.40803197  1.0941827   3.2546046   0.4174924   0.42651707
  0.4497569   0.5836246   0.5836245   0.35194862  1.987554    1.2450393
  0.4174923   0.45027542  0.6730334   2.0978148   0.5127366   0.5127366
  0.5127367   0.54079616  0.5460108   1.2743566   0.6412103   0.6151507
  0.497445    0.5477686   0.52632946  0.45027545  0.52846605  0.8206412
  0.4497568   0.46059704  0.4174923   1.2450448   0.45027536  0.8206472
  0.5477685   0.5841195   0.5127366   0.54079616  0.44975683  0.4856262
  0.6788826   0.54079616  0.5407962   0.5407962   0.63162386  0.9333491
  6.790731    0.5127366   1.0880547   0.54079616  0.87860924  0.699424
  3.8455667   0.6994241   0.5407963   0.650923    0.6994242   0.502237
  0.6509231   0.6994217   6.7294674   0.70452076  1.1211978   0.6994241
  1.0618426   0.79495263  0.8275754   1.3702099   1.0378884   0.6100744
  0.6100744   1.3702099   0.9674037   0.6509231   0.6994241   0.8275754
  0.699424    0.73903936  0.73903936  0.73903936  0.6100744   0.7390394
  0.73903936  0.7390395   0.7390395   0.9680494   0.7390395   0.73903936
  0.780763    0.7956785   1.289065    1.289065    0.73903936  0.73095876
  0.96804965  0.73903954]
2025-06-02 16:00:04,665 - DEBUG - Edge reconstruction errors: [1.1570451  1.1579858  0.752559   ... 0.1525331  1.2529657  0.15253335]
2025-06-02 16:00:04,668 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160004_update_33.json
2025-06-02 16:00:04,669 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:00:04,690 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160004_update_33.pth and as latest_checkpoint.pth
2025-06-02 16:00:04,690 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870085.dot): 0.2086
2025-06-02 16:00:04,690 - WARNING - Detected 11 anomalous nodes (reconstruction-based):
2025-06-02 16:00:04,690 - WARNING -   Node ID: 192.168.239.101, Recon Error: 7.8578, MLP Score: 0.5554
2025-06-02 16:00:04,690 - WARNING -   Node ID: 192.168.27.13, Recon Error: 19.6214, MLP Score: 0.5498
2025-06-02 16:00:04,691 - WARNING -   Node ID: 192.168.27.12, Recon Error: 19.7495, MLP Score: 0.5807
2025-06-02 16:00:04,691 - WARNING -   Node ID: 192.168.27.10, Recon Error: 25.9431, MLP Score: 0.5845
2025-06-02 16:00:04,691 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 5.8373, MLP Score: 0.6012
2025-06-02 16:00:04,691 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:00:04,691 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.4070, MLP Score: 0.4782
2025-06-02 16:00:04,692 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.7984, MLP Score: 0.6193
2025-06-02 16:00:04,692 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.0342, MLP Score: 0.5145
2025-06-02 16:00:04,692 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.2342, MLP Score: 0.4488
2025-06-02 16:00:04,692 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.8071, MLP Score: 0.8691
2025-06-02 16:00:04,692 - INFO - 
--- Processing file: nw_graph_encoded_1748870115.dot (Timestamp: 2025-06-02 15:15:15) ---
2025-06-02 16:00:04,692 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 16:00:04,692 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 16:00:04,715 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 16:00:04,736 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 16:00:04,736 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 16:00:04,736 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870115.dot
2025-06-02 16:00:04,753 - INFO - Parsed 836 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 16:00:04,771 - INFO - Parsed 1786 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870115.dot'.
2025-06-02 16:00:04,772 - INFO - Processing node updates/additions.
2025-06-02 16:00:04,776 - INFO - Processing edge updates/additions.
2025-06-02 16:00:04,787 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:00:04,788 - INFO - Finished updating NetworkX graph.
2025-06-02 16:00:04,788 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:00:04,789 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:00:04,798 - DEBUG - Initial node features tensor shape: torch.Size([836, 30])
2025-06-02 16:00:04,800 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:00:04,800 - DEBUG - Node features tensor shape after scaling: torch.Size([836, 30])
2025-06-02 16:00:04,802 - DEBUG - Edge index tensor shape: torch.Size([2, 1786])
2025-06-02 16:00:04,804 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:00:04,810 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-02 16:00:04,812 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:00:04,813 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 16:00:04,816 - DEBUG - Shape of encoded categorical edge features: torch.Size([1786, 3])
2025-06-02 16:00:04,817 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:00:04,817 - DEBUG - Shape of scaled numerical edge features: torch.Size([1786, 7])
2025-06-02 16:00:04,817 - DEBUG - Final edge attributes tensor shape: torch.Size([1786, 10])
2025-06-02 16:00:04,817 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:00:04,819 - INFO - Performing online update...
2025-06-02 16:00:04,819 - INFO - Starting online update for 50 steps.
2025-06-02 16:00:04,820 - DEBUG - Updated RunningStats: new_mean=0.9433641257131974, new_var=19200000000161.137, new_n=1950
2025-06-02 16:00:04,820 - DEBUG - Updated RunningStats: new_mean=0.940316357224152, new_var=19500000000018.273, new_n=1980
2025-06-02 16:00:04,821 - DEBUG - Updated RunningStats: new_mean=1.078355048514588, new_var=6400000000073.763, new_n=650
2025-06-02 16:00:04,821 - DEBUG - Updated RunningStats: new_mean=1.0777291488333922, new_var=6500000000000.854, new_n=660
2025-06-02 16:00:04,821 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:00:04,821 - DEBUG - Online update step: 1/50
2025-06-02 16:00:04,823 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:04,982 - DEBUG - Node anomaly scores shape: torch.Size([14493, 1])
2025-06-02 16:00:04,988 - DEBUG - Edge anomaly scores shape: torch.Size([29643, 1])
2025-06-02 16:00:04,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:05,135 - DEBUG - Step 1: Loss=1.3403
2025-06-02 16:00:05,136 - DEBUG - Online update step: 2/50
2025-06-02 16:00:05,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:05,261 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 16:00:05,265 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 16:00:05,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:05,466 - DEBUG - Step 2: Loss=1.3222
2025-06-02 16:00:05,467 - DEBUG - Online update step: 3/50
2025-06-02 16:00:05,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:05,703 - DEBUG - Node anomaly scores shape: torch.Size([15057, 1])
2025-06-02 16:00:05,707 - DEBUG - Edge anomaly scores shape: torch.Size([30865, 1])
2025-06-02 16:00:05,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:05,971 - DEBUG - Step 3: Loss=1.3100
2025-06-02 16:00:05,975 - DEBUG - Online update step: 4/50
2025-06-02 16:00:05,983 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:06,333 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 16:00:06,337 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 16:00:06,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:07,020 - DEBUG - Step 4: Loss=1.3031
2025-06-02 16:00:07,020 - DEBUG - Online update step: 5/50
2025-06-02 16:00:07,032 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:07,381 - DEBUG - Node anomaly scores shape: torch.Size([14780, 1])
2025-06-02 16:00:07,384 - DEBUG - Edge anomaly scores shape: torch.Size([30341, 1])
2025-06-02 16:00:07,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:07,562 - DEBUG - Step 5: Loss=1.2912
2025-06-02 16:00:07,562 - DEBUG - Online update step: 6/50
2025-06-02 16:00:07,565 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:07,734 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 16:00:07,754 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 16:00:07,759 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:08,324 - DEBUG - Step 6: Loss=1.2833
2025-06-02 16:00:08,324 - DEBUG - Online update step: 7/50
2025-06-02 16:00:08,327 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:08,424 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 16:00:08,428 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 16:00:08,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:08,602 - DEBUG - Step 7: Loss=1.2782
2025-06-02 16:00:08,602 - DEBUG - Online update step: 8/50
2025-06-02 16:00:08,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:08,677 - DEBUG - Node anomaly scores shape: torch.Size([15114, 1])
2025-06-02 16:00:08,681 - DEBUG - Edge anomaly scores shape: torch.Size([30953, 1])
2025-06-02 16:00:08,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:08,823 - DEBUG - Step 8: Loss=1.2669
2025-06-02 16:00:08,823 - DEBUG - Online update step: 9/50
2025-06-02 16:00:08,826 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:08,920 - DEBUG - Node anomaly scores shape: torch.Size([14366, 1])
2025-06-02 16:00:08,924 - DEBUG - Edge anomaly scores shape: torch.Size([29331, 1])
2025-06-02 16:00:08,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:09,080 - DEBUG - Step 9: Loss=1.2624
2025-06-02 16:00:09,080 - DEBUG - Online update step: 10/50
2025-06-02 16:00:09,084 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:09,157 - DEBUG - Node anomaly scores shape: torch.Size([14384, 1])
2025-06-02 16:00:09,160 - DEBUG - Edge anomaly scores shape: torch.Size([29379, 1])
2025-06-02 16:00:09,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:09,330 - DEBUG - Step 10: Loss=1.2541
2025-06-02 16:00:09,330 - DEBUG - Online update step: 11/50
2025-06-02 16:00:09,333 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:09,470 - DEBUG - Node anomaly scores shape: torch.Size([14410, 1])
2025-06-02 16:00:09,475 - DEBUG - Edge anomaly scores shape: torch.Size([29427, 1])
2025-06-02 16:00:09,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:09,664 - DEBUG - Step 11: Loss=1.2440
2025-06-02 16:00:09,664 - DEBUG - Online update step: 12/50
2025-06-02 16:00:09,670 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:09,738 - DEBUG - Node anomaly scores shape: torch.Size([14846, 1])
2025-06-02 16:00:09,741 - DEBUG - Edge anomaly scores shape: torch.Size([30495, 1])
2025-06-02 16:00:09,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:09,929 - DEBUG - Step 12: Loss=1.2282
2025-06-02 16:00:09,930 - DEBUG - Online update step: 13/50
2025-06-02 16:00:09,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:10,022 - DEBUG - Node anomaly scores shape: torch.Size([14599, 1])
2025-06-02 16:00:10,025 - DEBUG - Edge anomaly scores shape: torch.Size([29880, 1])
2025-06-02 16:00:10,027 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:10,210 - DEBUG - Step 13: Loss=1.2192
2025-06-02 16:00:10,211 - DEBUG - Online update step: 14/50
2025-06-02 16:00:10,218 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:10,318 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 16:00:10,321 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 16:00:10,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:10,509 - DEBUG - Step 14: Loss=1.2103
2025-06-02 16:00:10,510 - DEBUG - Online update step: 15/50
2025-06-02 16:00:10,515 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:10,594 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 16:00:10,597 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 16:00:10,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:10,718 - DEBUG - Step 15: Loss=1.1961
2025-06-02 16:00:10,719 - DEBUG - Online update step: 16/50
2025-06-02 16:00:10,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:10,907 - DEBUG - Node anomaly scores shape: torch.Size([14754, 1])
2025-06-02 16:00:10,910 - DEBUG - Edge anomaly scores shape: torch.Size([30245, 1])
2025-06-02 16:00:10,911 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:11,176 - DEBUG - Step 16: Loss=1.1876
2025-06-02 16:00:11,176 - DEBUG - Online update step: 17/50
2025-06-02 16:00:11,179 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:11,268 - DEBUG - Node anomaly scores shape: torch.Size([14846, 1])
2025-06-02 16:00:11,271 - DEBUG - Edge anomaly scores shape: torch.Size([30495, 1])
2025-06-02 16:00:11,273 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:11,418 - DEBUG - Step 17: Loss=1.1780
2025-06-02 16:00:11,418 - DEBUG - Online update step: 18/50
2025-06-02 16:00:11,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:11,533 - DEBUG - Node anomaly scores shape: torch.Size([15084, 1])
2025-06-02 16:00:11,536 - DEBUG - Edge anomaly scores shape: torch.Size([30912, 1])
2025-06-02 16:00:11,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:11,692 - DEBUG - Step 18: Loss=1.1678
2025-06-02 16:00:11,692 - DEBUG - Online update step: 19/50
2025-06-02 16:00:11,696 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:11,758 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 16:00:11,761 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 16:00:11,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:11,883 - DEBUG - Step 19: Loss=1.1631
2025-06-02 16:00:11,883 - DEBUG - Online update step: 20/50
2025-06-02 16:00:11,888 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:11,981 - DEBUG - Node anomaly scores shape: torch.Size([15017, 1])
2025-06-02 16:00:11,984 - DEBUG - Edge anomaly scores shape: torch.Size([30812, 1])
2025-06-02 16:00:11,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:12,109 - DEBUG - Step 20: Loss=1.1515
2025-06-02 16:00:12,109 - DEBUG - Online update step: 21/50
2025-06-02 16:00:12,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:12,178 - DEBUG - Node anomaly scores shape: torch.Size([14635, 1])
2025-06-02 16:00:12,180 - DEBUG - Edge anomaly scores shape: torch.Size([29954, 1])
2025-06-02 16:00:12,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:12,345 - DEBUG - Step 21: Loss=1.1468
2025-06-02 16:00:12,346 - DEBUG - Online update step: 22/50
2025-06-02 16:00:12,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:12,491 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 16:00:12,501 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 16:00:12,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:12,680 - DEBUG - Step 22: Loss=1.1419
2025-06-02 16:00:12,681 - DEBUG - Online update step: 23/50
2025-06-02 16:00:12,688 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:12,824 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 16:00:12,831 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 16:00:12,834 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:13,110 - DEBUG - Step 23: Loss=1.1317
2025-06-02 16:00:13,111 - DEBUG - Online update step: 24/50
2025-06-02 16:00:13,122 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:13,240 - DEBUG - Node anomaly scores shape: torch.Size([14347, 1])
2025-06-02 16:00:13,247 - DEBUG - Edge anomaly scores shape: torch.Size([29280, 1])
2025-06-02 16:00:13,249 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:13,429 - DEBUG - Step 24: Loss=1.1272
2025-06-02 16:00:13,429 - DEBUG - Online update step: 25/50
2025-06-02 16:00:13,436 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:13,523 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 16:00:13,526 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 16:00:13,527 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:13,664 - DEBUG - Step 25: Loss=1.1212
2025-06-02 16:00:13,665 - DEBUG - Online update step: 26/50
2025-06-02 16:00:13,670 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:13,743 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 16:00:13,746 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 16:00:13,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:13,877 - DEBUG - Step 26: Loss=1.1150
2025-06-02 16:00:13,878 - DEBUG - Online update step: 27/50
2025-06-02 16:00:13,882 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:13,943 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 16:00:13,946 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 16:00:13,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:14,083 - DEBUG - Step 27: Loss=1.1071
2025-06-02 16:00:14,084 - DEBUG - Online update step: 28/50
2025-06-02 16:00:14,089 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:14,163 - DEBUG - Node anomaly scores shape: torch.Size([14378, 1])
2025-06-02 16:00:14,166 - DEBUG - Edge anomaly scores shape: torch.Size([29354, 1])
2025-06-02 16:00:14,171 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:14,297 - DEBUG - Step 28: Loss=1.1009
2025-06-02 16:00:14,298 - DEBUG - Online update step: 29/50
2025-06-02 16:00:14,302 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:14,374 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 16:00:14,383 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 16:00:14,385 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:14,603 - DEBUG - Step 29: Loss=1.0921
2025-06-02 16:00:14,603 - DEBUG - Online update step: 30/50
2025-06-02 16:00:14,608 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:14,709 - DEBUG - Node anomaly scores shape: torch.Size([14846, 1])
2025-06-02 16:00:14,715 - DEBUG - Edge anomaly scores shape: torch.Size([30495, 1])
2025-06-02 16:00:14,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:14,935 - DEBUG - Step 30: Loss=1.0850
2025-06-02 16:00:14,936 - DEBUG - Online update step: 31/50
2025-06-02 16:00:14,939 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:15,036 - DEBUG - Node anomaly scores shape: torch.Size([14635, 1])
2025-06-02 16:00:15,040 - DEBUG - Edge anomaly scores shape: torch.Size([29954, 1])
2025-06-02 16:00:15,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:15,213 - DEBUG - Step 31: Loss=1.0797
2025-06-02 16:00:15,214 - DEBUG - Online update step: 32/50
2025-06-02 16:00:15,219 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:15,294 - DEBUG - Node anomaly scores shape: torch.Size([15114, 1])
2025-06-02 16:00:15,297 - DEBUG - Edge anomaly scores shape: torch.Size([30953, 1])
2025-06-02 16:00:15,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:15,410 - DEBUG - Step 32: Loss=1.0741
2025-06-02 16:00:15,410 - DEBUG - Online update step: 33/50
2025-06-02 16:00:15,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:15,549 - DEBUG - Node anomaly scores shape: torch.Size([15076, 1])
2025-06-02 16:00:15,554 - DEBUG - Edge anomaly scores shape: torch.Size([30903, 1])
2025-06-02 16:00:15,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:15,722 - DEBUG - Step 33: Loss=1.0679
2025-06-02 16:00:15,722 - DEBUG - Online update step: 34/50
2025-06-02 16:00:15,728 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:15,848 - DEBUG - Node anomaly scores shape: torch.Size([14310, 1])
2025-06-02 16:00:15,852 - DEBUG - Edge anomaly scores shape: torch.Size([29212, 1])
2025-06-02 16:00:15,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:15,962 - DEBUG - Step 34: Loss=1.0652
2025-06-02 16:00:15,962 - DEBUG - Online update step: 35/50
2025-06-02 16:00:15,965 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:16,028 - DEBUG - Node anomaly scores shape: torch.Size([14599, 1])
2025-06-02 16:00:16,031 - DEBUG - Edge anomaly scores shape: torch.Size([29880, 1])
2025-06-02 16:00:16,032 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:16,212 - DEBUG - Step 35: Loss=1.0598
2025-06-02 16:00:16,212 - DEBUG - Online update step: 36/50
2025-06-02 16:00:16,217 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:16,297 - DEBUG - Node anomaly scores shape: torch.Size([14416, 1])
2025-06-02 16:00:16,301 - DEBUG - Edge anomaly scores shape: torch.Size([29439, 1])
2025-06-02 16:00:16,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:16,424 - DEBUG - Step 36: Loss=1.0565
2025-06-02 16:00:16,425 - DEBUG - Online update step: 37/50
2025-06-02 16:00:16,430 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:16,543 - DEBUG - Node anomaly scores shape: torch.Size([14431, 1])
2025-06-02 16:00:16,547 - DEBUG - Edge anomaly scores shape: torch.Size([29477, 1])
2025-06-02 16:00:16,549 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:16,719 - DEBUG - Step 37: Loss=1.0518
2025-06-02 16:00:16,719 - DEBUG - Online update step: 38/50
2025-06-02 16:00:16,722 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:16,809 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 16:00:16,813 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 16:00:16,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:17,010 - DEBUG - Step 38: Loss=1.0472
2025-06-02 16:00:17,011 - DEBUG - Online update step: 39/50
2025-06-02 16:00:17,016 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:17,093 - DEBUG - Node anomaly scores shape: torch.Size([14341, 1])
2025-06-02 16:00:17,096 - DEBUG - Edge anomaly scores shape: torch.Size([29264, 1])
2025-06-02 16:00:17,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:17,227 - DEBUG - Step 39: Loss=1.0429
2025-06-02 16:00:17,227 - DEBUG - Online update step: 40/50
2025-06-02 16:00:17,231 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:17,350 - DEBUG - Node anomaly scores shape: torch.Size([14506, 1])
2025-06-02 16:00:17,354 - DEBUG - Edge anomaly scores shape: torch.Size([29698, 1])
2025-06-02 16:00:17,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:17,527 - DEBUG - Step 40: Loss=1.0389
2025-06-02 16:00:17,528 - DEBUG - Online update step: 41/50
2025-06-02 16:00:17,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:17,648 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 16:00:17,654 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 16:00:17,655 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:17,862 - DEBUG - Step 41: Loss=1.0318
2025-06-02 16:00:17,862 - DEBUG - Online update step: 42/50
2025-06-02 16:00:17,865 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:17,950 - DEBUG - Node anomaly scores shape: torch.Size([14890, 1])
2025-06-02 16:00:17,954 - DEBUG - Edge anomaly scores shape: torch.Size([30603, 1])
2025-06-02 16:00:17,955 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:18,138 - DEBUG - Step 42: Loss=1.0282
2025-06-02 16:00:18,138 - DEBUG - Online update step: 43/50
2025-06-02 16:00:18,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:18,217 - DEBUG - Node anomaly scores shape: torch.Size([14453, 1])
2025-06-02 16:00:18,222 - DEBUG - Edge anomaly scores shape: torch.Size([29550, 1])
2025-06-02 16:00:18,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:18,348 - DEBUG - Step 43: Loss=1.0279
2025-06-02 16:00:18,348 - DEBUG - Online update step: 44/50
2025-06-02 16:00:18,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:18,449 - DEBUG - Node anomaly scores shape: torch.Size([14416, 1])
2025-06-02 16:00:18,454 - DEBUG - Edge anomaly scores shape: torch.Size([29439, 1])
2025-06-02 16:00:18,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:18,639 - DEBUG - Step 44: Loss=1.0239
2025-06-02 16:00:18,639 - DEBUG - Online update step: 45/50
2025-06-02 16:00:18,645 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:18,729 - DEBUG - Node anomaly scores shape: torch.Size([15097, 1])
2025-06-02 16:00:18,733 - DEBUG - Edge anomaly scores shape: torch.Size([30932, 1])
2025-06-02 16:00:18,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:18,896 - DEBUG - Step 45: Loss=1.0181
2025-06-02 16:00:18,896 - DEBUG - Online update step: 46/50
2025-06-02 16:00:18,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:18,968 - DEBUG - Node anomaly scores shape: torch.Size([14969, 1])
2025-06-02 16:00:18,971 - DEBUG - Edge anomaly scores shape: torch.Size([30742, 1])
2025-06-02 16:00:18,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:19,086 - DEBUG - Step 46: Loss=1.0136
2025-06-02 16:00:19,087 - DEBUG - Online update step: 47/50
2025-06-02 16:00:19,090 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:19,157 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 16:00:19,160 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 16:00:19,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:19,405 - DEBUG - Step 47: Loss=1.0112
2025-06-02 16:00:19,405 - DEBUG - Online update step: 48/50
2025-06-02 16:00:19,408 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:19,583 - DEBUG - Node anomaly scores shape: torch.Size([14599, 1])
2025-06-02 16:00:19,591 - DEBUG - Edge anomaly scores shape: torch.Size([29880, 1])
2025-06-02 16:00:19,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:19,805 - DEBUG - Step 48: Loss=1.0088
2025-06-02 16:00:19,808 - DEBUG - Online update step: 49/50
2025-06-02 16:00:19,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:20,670 - DEBUG - Node anomaly scores shape: torch.Size([14890, 1])
2025-06-02 16:00:20,764 - DEBUG - Edge anomaly scores shape: torch.Size([30603, 1])
2025-06-02 16:00:20,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:22,739 - DEBUG - Step 49: Loss=1.0043
2025-06-02 16:00:22,743 - DEBUG - Online update step: 50/50
2025-06-02 16:00:22,766 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:23,976 - DEBUG - Node anomaly scores shape: torch.Size([14727, 1])
2025-06-02 16:00:24,051 - DEBUG - Edge anomaly scores shape: torch.Size([30165, 1])
2025-06-02 16:00:24,106 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:26,321 - DEBUG - Step 50: Loss=1.0017
2025-06-02 16:00:26,321 - INFO - Online update finished. Average loss: 1.1356, Learning rate: 0.001000
2025-06-02 16:00:26,327 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], current edge mean: [ 8.1623745e+00  1.4137738e+00  4.9904814e+00  1.0679444e-09
  3.2038332e-09  3.2038332e-09  2.1358888e-09 -7.4756104e-09
  4.2717776e-09  4.8057496e-09]
2025-06-02 16:00:26,328 - DEBUG - Node drift difference: 0.0111, Edge drift difference: 0.9295
2025-06-02 16:00:26,328 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 16:00:26,330 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.4811502e-08  5.5611988e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -5.7750911e-09
  7.0727040e-08  5.5897178e-08  1.9392898e-08  1.9392898e-08
  2.2930622e+00  2.9593301e+00  1.4593302e-01  4.3971291e+00
  1.1407587e-09  3.3947368e+00  5.7643542e+00  7.6076555e+00
  1.4593302e-01  7.9916267e+00 -1.9392898e-08 -1.5400243e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -2.3955934e-08 -5.9319454e-08], edge=[ 8.1623745e+00  1.4137738e+00  4.9904814e+00  1.0679444e-09
  3.2038332e-09  3.2038332e-09  2.1358888e-09 -7.4756104e-09
  4.2717776e-09  4.8057496e-09]
2025-06-02 16:00:26,334 - DEBUG - Updated reference std: node=[0.         0.         1.0005987  1.0005985  0.         0.
 0.         1.0005987  1.0005987  1.0005987  1.0005987  1.0005987
 0.99652076 0.2824555  0.36981332 0.5666934  1.0005987  3.0259826
 2.9103527  1.4954265  0.36981332 0.24210006 1.0005987  1.0005987
 0.         0.         0.         0.         1.0005987  1.0005987 ], edge=[1.0884964 0.506109  1.7738906 1.0002801 1.00028   1.0002801 1.0002801
 1.00028   1.0002801 1.00028  ]
2025-06-02 16:00:26,334 - INFO - Online update complete. Loss: 1.1356
2025-06-02 16:00:26,335 - INFO - Running anomaly detection...
2025-06-02 16:00:26,335 - INFO - Starting anomaly detection.
2025-06-02 16:00:26,824 - DEBUG - Node reconstruction errors: [ 0.8329326   7.158752   18.042889    0.79281574  1.4345863   0.42246255
 17.79736     0.7433688   0.74336874  0.80110663  0.7433689   1.6990447
 23.345213    1.3970845   0.575467    0.70224684  1.8100047   0.7022464
  2.9976172   0.58934295  0.43049812  0.57546693  0.39258358  1.1076194
  0.5173541   0.55262446  0.5173541   1.8939056   0.6334037   0.51735413
  3.2974386   0.6677521   1.7070141   0.6662064   0.569333    0.49701205
  0.43461964  0.58934283  1.1637434   1.1360085   0.6406111   0.4657812
  0.58934295  0.47619167  1.0357322   1.0273734   0.9468138   1.109339
  0.5377416   1.3470109   4.8805137   0.49448487  0.46181056  2.6233468
  0.25770196  1.0868968  10.801914    0.4026579   2.715486    2.6328394
  1.064214    0.21781     0.3687973   1.0863626   0.40875357  0.257702
  0.18711804  0.25770184  0.3687973   0.3687973   0.27029237  0.37696812
  0.18368486  0.33142942  0.41298378  0.41459894  0.41810212  0.28600082
  0.23685211  0.34968874  0.37114418  0.2202589   1.8898679   3.0350428
  0.26891607  1.0054553   0.18980809  0.26423115  0.36765492  0.29706198
  0.27096218  1.3405635   1.0767757   0.23804846  0.12694612  4.3473735
  0.3040839   0.3109321   0.17924246  0.23714195  0.23095892  0.3040838
  0.35049883  0.39842448  1.0899882   0.21021882  1.0510632   0.831832
  1.1239737   0.9147741   0.7118639   0.290198    1.361382    1.0830251
  0.23483805  0.10817295  0.20816237  1.252979    0.26016074  0.12101759
  0.17208077  1.0347618   0.99607605  0.87618804  0.3283083   0.12102153
  0.9074062   0.74351776  0.24260943  0.15909798  0.26435244  0.16502473
  0.93792427  1.3909806   0.16930415  0.21879183  0.29505292  0.21309727
  0.8532203   1.249453    0.15775326  0.19031484  0.15009941  0.28900486
  0.28900486  0.23456755  0.20816222  0.28900483  0.20562363  0.25986797
  1.704609    1.1990823   0.37211582  0.16502473  1.465036    1.3258008
  0.13686271  0.09554227  0.23095922  0.41982648  0.14394537  0.853219
  0.13686268  0.26435238  0.18547496  1.2492983   0.25898865  0.21342246
  0.7419962   0.30370137  0.32270116  0.12977718  0.23964106  5.276912
  0.30778345  0.26412427  0.20885228  0.10382801  0.16810414  0.16810413
  0.187757    1.1142226   0.1792675   1.0102673   1.4851254   0.21196295
  0.1063786   0.17538907  0.1957948   0.11621653  0.25270635  0.24723381
  0.23460767  0.17664461  0.8532234   0.1779624   1.7533791   0.25386587
  1.2631627   0.1783486   0.15545882  0.13686268  1.0204002   0.28695413
  0.2047225   0.8626606   0.3596922   1.6963478   0.15340535  0.32747528
  0.13179892  0.19156514  0.2353488   0.18568863  0.20758452  0.14391622
  0.29262814  0.20816237  0.23742673  0.17664455  1.0789348   0.1063786
  0.1766456   0.23534876  0.13686268  0.2683424   1.2319475   0.20822458
  0.26051915  1.0156895   0.91328967  0.19428489  0.3088929   0.20816247
  0.20816228  0.1779624   0.17312466  0.17664562  0.13686271  0.23478992
  1.2709746   0.1809592   0.18201251  0.3277369   0.16934803  0.3277368
  0.11072589  0.16285089  0.18201254  0.18576367  0.23964106  0.2454101
  0.23742692  0.20113297  0.14724272  0.23307937  0.11621651  0.09641377
  0.15539847  0.16810411  0.23063602  1.3063484   0.2786786   0.2546654
  0.27069098  0.10641836  0.32224438  4.0823817   0.32224637  0.09622101
  1.0185366   0.99165404  0.2006372   0.36701515  0.19531627  0.1681041
  0.16569693  0.35992754  0.18775702  0.25186583  1.803269    0.18834089
  0.17314757  0.33930925  0.24247138  0.21349566  1.5209521   0.8909369
  1.1142228   0.66444796  0.18340057  0.16941352  0.17222004  0.16934803
  1.3002942   0.09637892  0.1947398   0.16810618  0.17796235  1.1314356
  0.17156163  0.11078165  0.15087584  0.28431448  0.11078166  0.11078166
  0.11078166  0.18607742  0.08953144  0.11078165  0.11078166  1.5392469
  0.11078166  0.10862863  0.8679689   0.23274247  0.26553014  0.9986608
  0.2118701   0.17427182  0.2864069   0.11928034  0.26983044  0.15087596
  0.7376776   0.9960705   0.12774742  0.18607768  0.3092377   0.309238
  0.5373535   0.17283699  0.11078174  0.19531636  0.11078166  0.18607765
  0.30802953  0.18328397  0.12774742  0.12774743  0.11078127  0.16871466
  0.12774742  0.29245418  0.29113644  0.20702595  0.15087573  0.18432863
  0.33504122  0.2240198   0.11078156  0.08045656  1.0780045   0.15534067
  0.14033741  0.11621653  0.07073645  0.11078166  0.1552946   3.0816054
  0.13179888  0.17220113  0.39351052  0.17823152  0.15088138  4.83993
  0.10215085  1.596138    0.1461025   0.09604757  0.15854715  0.1775823
  0.22662082  1.0812527   0.21363512  0.1553414   0.12709469  0.19538218
  0.20153297  0.11078166  0.1508758   0.69642615  0.11910836  0.15543132
  0.71166766  0.27192986  0.23036209  0.98638403  0.20121473  0.11078167
  0.42436817  0.07073604  0.0998367   0.07323713  0.16113439  0.1611345
  0.16113451  2.482692    0.07942285  2.4608502   0.11440991  0.23781726
  0.16113453  0.07942285  0.1066923   0.0998357   0.32125714  0.09833146
  0.09983678  0.78713644  0.1611345   0.09983665  0.0794229   0.1611345
  0.1611343   0.05958267  0.12506378  0.16113442  0.12709472  0.12556738
  0.10036606  0.16684327  0.09932572  0.12456241  1.106601    0.18759619
  0.23978657  0.17956088  0.90501994  1.0129123   0.24125451  0.18255459
  0.11151465  0.14456736  0.1611344   0.16113442  0.11440986  0.21417755
  1.073913    0.07224178  0.19075872  0.19064699  0.42414472  0.05478864
  0.06651156  1.2855178   1.5400147   0.15910645  0.21432835  0.13547401
  0.28686848  0.06763778  0.13540296  0.06121381  0.06763779  0.2062868
  0.12456242  0.12294368  0.12274735  0.17023675  0.11975265  0.1291606
  0.1340125   1.1520725   0.13401252  0.1291606   0.09758689  0.17023684
  0.79374987  0.19313966  0.09758689  0.11975233  0.20460364  1.1699299
  0.32143158  0.09932056  0.17023668  0.11975266  0.05539864  0.1431698
  0.13709766  1.3712512   0.16205144  0.1591064   1.1818362   0.09498143
  0.06763779  0.7257847   0.19468114  1.1588178   0.07666317  0.05539864
  0.19344689  0.06152713  0.10123619  0.12294366  0.11243885  2.6709998
  0.0612138   0.14316982  0.33205897  0.06152717  0.33205897  0.11438689
  0.07430746  0.92937416  0.05259072  1.505251    0.25081393  0.06763778
  0.9320946   0.18765704  0.18765704  0.06651156  0.12215769  0.1478046
  0.05259068  0.1193215   0.2451283   0.17575222  0.11932192  0.19064704
  0.05259072  0.21826105  0.07430746  0.11243881  0.25834852  0.76843506
  0.11932257  0.21101288  0.14780463  0.06121381  0.06121381  0.14316984
  0.11243881  0.09427606  0.2355822   0.20827153  0.0612138   0.13084859
  0.06121379  0.13084851  0.22348866  0.11932078  0.22238016  3.61651
  0.8084884   0.05621687  1.8758142   0.05621687  0.05621687  0.05621687
  0.05621693  0.05621686  0.05621687  0.05621693  0.13966104  0.26255912
  0.19641869  0.05621687  0.05621693  0.05621687  0.05621687  0.05621687
  0.05621687  0.05621687  0.05621687  0.05621687  0.13204615  0.05621685
  0.05621687  1.3579443   0.05621693  0.76904446  0.21373017  0.06121381
  0.27114278  0.25106347  1.6603214   1.6603214   0.22681688  0.27114278
  0.06121381  0.05259071  0.05259069  0.0612138   0.05259072  0.12918665
  0.2017303   0.05621675  0.19064705  0.06121381  0.18765709  0.0612138
  0.06121381  0.07410414  0.06121381  0.05259071  0.0612138   0.06121381
  0.11932197  0.05259071  0.06121381  0.05259068  0.06121381  0.06121381
  0.06121381  0.20672235  0.1012363   0.1012363   0.05621687  0.26425463
  0.22371764  0.0612138   0.05259072  0.2905119   0.05621687  0.18497322
  0.2764941   0.05186159  0.06121381  0.06121381  0.13823031  0.22391227
  0.11702231  0.06121381  0.13966109  0.07410414  0.05259072  0.7414803
  0.05621687  0.24894173  0.11931928  0.05621693  0.05621687  0.13966097
  0.07410414  0.0612138   0.46545818  0.16015103  0.3554288   0.22391233
  0.19507483  0.1383329   0.13833292  0.20532705  0.10897184  0.05621687
  0.21030325  0.19104236  0.2239123   0.10812649  0.14265305  0.06186871
  0.06441101  0.06441101  0.06441101  0.06441101  0.06441101  0.16364488
  0.26905873  0.06441101  0.06441098  0.05621693  0.09452142  0.05621686
  0.13833292  0.21673323  0.13833289  0.06250255  0.13833286  0.27646255
  0.1320478   0.14047392  0.13204785  0.05621687  0.13833295  0.06451087
  0.05391323  0.05391322  0.06441101  0.06451087  0.21916392  0.07122446
  0.05621687  0.05621687  0.06441101  0.11365067  0.05391323  0.07321247
  0.06186871  0.09720664  0.16364479  1.3350921   0.09720664  1.4068681
  0.16831274  0.06186873  0.23835501  0.06814805  0.08036026  0.15738182
  0.1913357   0.08601124  0.15537553  0.06186871  0.0618687   0.06186875
  0.06289415  0.06186873  0.06186876  0.08036027  0.06186872  0.06186876
  0.06186873  0.20960075  0.08673979  0.32058924  0.3701933   0.19515868
  0.27726144  0.10338013  0.34780163  2.665042    0.11226659  0.1187747
  0.12612115  0.40859523  0.40859523  0.08036025  1.5041491   0.45649484
  0.11226655  0.12086415  0.28048724  1.5803524   0.16428551  0.1642855
  0.16428551  0.16886565  0.17754507  1.0380737   0.49165457  0.43720576
  0.20114048  0.17724243  0.35376617  0.12086415  0.3482478   0.33198592
  0.1261211   0.35698304  0.11226662  0.4564966   0.12086415  0.3319859
  0.17724246  0.18817851  0.16428551  0.16886565  0.12612113  0.33360633
  0.47593373  0.16886555  0.16886555  0.16886555  0.428758    0.37024465
  4.433088    0.16428551  0.42535287  0.16886555  0.35676187  0.4842467
  2.873699    0.48424676  0.16886565  0.22966512  0.5187978   0.15756707
  0.2296652   0.48424658  5.4692125   0.30219918  0.45040083  0.4842468
  0.41230008  0.5576875   0.34846506  0.5117171   0.4755885   0.2155706
  0.2155705   0.511717    0.67012596  0.22966512  0.4842468   0.34846503
  0.48424676  0.28849062  0.28849062  0.28849062  0.24170418  0.65824395
  0.28849062  0.28849062  0.28849062  0.5123457   0.28849062  0.28849062
  0.30590615  0.60140955  0.6348133   0.63481325  0.28849062  0.5111216
  0.5123457   0.28849062  0.3792694   0.5111215   0.2884906   0.28849062
  1.0613362   0.5111215   0.2884906   0.51112145  0.54922086  0.7670538
  0.7051327   0.2884906   0.8324454   0.51112145  0.5111215   0.6014097
  0.40034825  0.51112145]
2025-06-02 16:00:26,825 - DEBUG - Edge reconstruction errors: [1.2581015  1.2581389  0.8532134  ... 0.15319014 1.3536816  0.1531904 ]
2025-06-02 16:00:26,971 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160026_update_34.json
2025-06-02 16:00:26,974 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:00:26,997 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160026_update_34.pth and as latest_checkpoint.pth
2025-06-02 16:00:26,997 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870115.dot): 0.1907
2025-06-02 16:00:26,997 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:00:26,997 - WARNING -   Node ID: 192.168.239.101, Recon Error: 7.1588, MLP Score: 0.4451
2025-06-02 16:00:26,997 - WARNING -   Node ID: 192.168.27.13, Recon Error: 18.0429, MLP Score: 0.5034
2025-06-02 16:00:26,997 - WARNING -   Node ID: 192.168.27.12, Recon Error: 17.7974, MLP Score: 0.5053
2025-06-02 16:00:26,997 - WARNING -   Node ID: 192.168.27.10, Recon Error: 23.3452, MLP Score: 0.5077
2025-06-02 16:00:26,997 - WARNING -   Node ID: fe80::680a:1fff:fe44:d7ee, Recon Error: 4.8805, MLP Score: 0.6176
2025-06-02 16:00:26,997 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:00:26,997 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1670, MLP Score: 0.4903
2025-06-02 16:00:26,997 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 16.0425, MLP Score: 0.5586
2025-06-02 16:00:26,998 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.0191, MLP Score: 0.4671
2025-06-02 16:00:26,998 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 4.2191, MLP Score: 0.4234
2025-06-02 16:00:26,998 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.0215, MLP Score: 0.8639
2025-06-02 16:00:26,998 - INFO - 
--- Processing file: nw_graph_encoded_1748870145.dot (Timestamp: 2025-06-02 15:15:45) ---
2025-06-02 16:00:26,998 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 16:00:26,998 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 16:00:27,025 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 16:00:27,055 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 16:00:27,055 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 16:00:27,055 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870145.dot
2025-06-02 16:00:27,084 - INFO - Parsed 845 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 16:00:27,113 - INFO - Parsed 1818 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870145.dot'.
2025-06-02 16:00:27,113 - INFO - Processing node updates/additions.
2025-06-02 16:00:27,121 - INFO - Processing edge updates/additions.
2025-06-02 16:00:27,136 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:00:27,138 - INFO - Finished updating NetworkX graph.
2025-06-02 16:00:27,138 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:00:27,139 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:00:27,151 - DEBUG - Initial node features tensor shape: torch.Size([845, 30])
2025-06-02 16:00:27,156 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:00:27,163 - DEBUG - Node features tensor shape after scaling: torch.Size([845, 30])
2025-06-02 16:00:27,168 - DEBUG - Edge index tensor shape: torch.Size([2, 1818])
2025-06-02 16:00:27,170 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:00:27,175 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-02 16:00:27,177 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:00:27,183 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 16:00:27,188 - DEBUG - Shape of encoded categorical edge features: torch.Size([1818, 3])
2025-06-02 16:00:27,189 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:00:27,189 - DEBUG - Shape of scaled numerical edge features: torch.Size([1818, 7])
2025-06-02 16:00:27,189 - DEBUG - Final edge attributes tensor shape: torch.Size([1818, 10])
2025-06-02 16:00:27,189 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:00:27,192 - INFO - Performing online update...
2025-06-02 16:00:27,192 - INFO - Starting online update for 50 steps.
2025-06-02 16:00:27,193 - DEBUG - Updated RunningStats: new_mean=0.9435463496370878, new_var=19800000000161.184, new_n=2010
2025-06-02 16:00:27,193 - DEBUG - Updated RunningStats: new_mean=0.9405838327777333, new_var=20100000000018.215, new_n=2040
2025-06-02 16:00:27,193 - DEBUG - Updated RunningStats: new_mean=1.0833913369669144, new_var=6600000000073.713, new_n=670
2025-06-02 16:00:27,194 - DEBUG - Updated RunningStats: new_mean=1.082686254714448, new_var=6700000000000.848, new_n=680
2025-06-02 16:00:27,194 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:00:27,194 - DEBUG - Online update step: 1/50
2025-06-02 16:00:27,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:28,064 - DEBUG - Node anomaly scores shape: torch.Size([15115, 1])
2025-06-02 16:00:28,072 - DEBUG - Edge anomaly scores shape: torch.Size([30992, 1])
2025-06-02 16:00:28,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:28,576 - DEBUG - Step 1: Loss=1.0001
2025-06-02 16:00:28,577 - DEBUG - Online update step: 2/50
2025-06-02 16:00:28,580 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:29,090 - DEBUG - Node anomaly scores shape: torch.Size([14857, 1])
2025-06-02 16:00:29,096 - DEBUG - Edge anomaly scores shape: torch.Size([30462, 1])
2025-06-02 16:00:29,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:29,406 - DEBUG - Step 2: Loss=0.9976
2025-06-02 16:00:29,406 - DEBUG - Online update step: 3/50
2025-06-02 16:00:29,412 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:29,526 - DEBUG - Node anomaly scores shape: torch.Size([14570, 1])
2025-06-02 16:00:29,529 - DEBUG - Edge anomaly scores shape: torch.Size([29817, 1])
2025-06-02 16:00:29,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:29,721 - DEBUG - Step 3: Loss=0.9967
2025-06-02 16:00:29,721 - DEBUG - Online update step: 4/50
2025-06-02 16:00:29,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:29,817 - DEBUG - Node anomaly scores shape: torch.Size([14446, 1])
2025-06-02 16:00:29,822 - DEBUG - Edge anomaly scores shape: torch.Size([29522, 1])
2025-06-02 16:00:29,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:29,977 - DEBUG - Step 4: Loss=0.9929
2025-06-02 16:00:29,977 - DEBUG - Online update step: 5/50
2025-06-02 16:00:29,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:30,078 - DEBUG - Node anomaly scores shape: torch.Size([14589, 1])
2025-06-02 16:00:30,083 - DEBUG - Edge anomaly scores shape: torch.Size([29897, 1])
2025-06-02 16:00:30,084 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:30,282 - DEBUG - Step 5: Loss=0.9914
2025-06-02 16:00:30,282 - DEBUG - Online update step: 6/50
2025-06-02 16:00:30,285 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:30,376 - DEBUG - Node anomaly scores shape: torch.Size([14857, 1])
2025-06-02 16:00:30,382 - DEBUG - Edge anomaly scores shape: torch.Size([30515, 1])
2025-06-02 16:00:30,383 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:30,541 - DEBUG - Step 6: Loss=0.9870
2025-06-02 16:00:30,542 - DEBUG - Online update step: 7/50
2025-06-02 16:00:30,545 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:30,628 - DEBUG - Node anomaly scores shape: torch.Size([14636, 1])
2025-06-02 16:00:30,631 - DEBUG - Edge anomaly scores shape: torch.Size([29995, 1])
2025-06-02 16:00:30,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:30,802 - DEBUG - Step 7: Loss=0.9865
2025-06-02 16:00:30,803 - DEBUG - Online update step: 8/50
2025-06-02 16:00:30,806 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:30,903 - DEBUG - Node anomaly scores shape: torch.Size([15244, 1])
2025-06-02 16:00:30,910 - DEBUG - Edge anomaly scores shape: torch.Size([31297, 1])
2025-06-02 16:00:30,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:31,134 - DEBUG - Step 8: Loss=0.9821
2025-06-02 16:00:31,134 - DEBUG - Online update step: 9/50
2025-06-02 16:00:31,142 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:31,247 - DEBUG - Node anomaly scores shape: torch.Size([15602, 1])
2025-06-02 16:00:31,254 - DEBUG - Edge anomaly scores shape: torch.Size([32180, 1])
2025-06-02 16:00:31,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:31,454 - DEBUG - Step 9: Loss=0.9762
2025-06-02 16:00:31,454 - DEBUG - Online update step: 10/50
2025-06-02 16:00:31,458 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:31,540 - DEBUG - Node anomaly scores shape: torch.Size([15085, 1])
2025-06-02 16:00:31,544 - DEBUG - Edge anomaly scores shape: torch.Size([30935, 1])
2025-06-02 16:00:31,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:31,714 - DEBUG - Step 10: Loss=0.9770
2025-06-02 16:00:31,714 - DEBUG - Online update step: 11/50
2025-06-02 16:00:31,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:31,814 - DEBUG - Node anomaly scores shape: torch.Size([15160, 1])
2025-06-02 16:00:31,818 - DEBUG - Edge anomaly scores shape: torch.Size([31144, 1])
2025-06-02 16:00:31,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:31,978 - DEBUG - Step 11: Loss=0.9730
2025-06-02 16:00:31,978 - DEBUG - Online update step: 12/50
2025-06-02 16:00:31,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:32,078 - DEBUG - Node anomaly scores shape: torch.Size([15192, 1])
2025-06-02 16:00:32,085 - DEBUG - Edge anomaly scores shape: torch.Size([31123, 1])
2025-06-02 16:00:32,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:32,239 - DEBUG - Step 12: Loss=0.9731
2025-06-02 16:00:32,239 - DEBUG - Online update step: 13/50
2025-06-02 16:00:32,242 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:32,322 - DEBUG - Node anomaly scores shape: torch.Size([15267, 1])
2025-06-02 16:00:32,326 - DEBUG - Edge anomaly scores shape: torch.Size([31442, 1])
2025-06-02 16:00:32,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:32,480 - DEBUG - Step 13: Loss=0.9686
2025-06-02 16:00:32,480 - DEBUG - Online update step: 14/50
2025-06-02 16:00:32,483 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:32,596 - DEBUG - Node anomaly scores shape: torch.Size([14347, 1])
2025-06-02 16:00:32,602 - DEBUG - Edge anomaly scores shape: torch.Size([29280, 1])
2025-06-02 16:00:32,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:32,769 - DEBUG - Step 14: Loss=0.9699
2025-06-02 16:00:32,769 - DEBUG - Online update step: 15/50
2025-06-02 16:00:32,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:32,870 - DEBUG - Node anomaly scores shape: torch.Size([15375, 1])
2025-06-02 16:00:32,873 - DEBUG - Edge anomaly scores shape: torch.Size([31641, 1])
2025-06-02 16:00:32,875 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:33,032 - DEBUG - Step 15: Loss=0.9653
2025-06-02 16:00:33,032 - DEBUG - Online update step: 16/50
2025-06-02 16:00:33,035 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:33,132 - DEBUG - Node anomaly scores shape: torch.Size([14846, 1])
2025-06-02 16:00:33,137 - DEBUG - Edge anomaly scores shape: torch.Size([30495, 1])
2025-06-02 16:00:33,138 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:33,297 - DEBUG - Step 16: Loss=0.9639
2025-06-02 16:00:33,297 - DEBUG - Online update step: 17/50
2025-06-02 16:00:33,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:33,547 - DEBUG - Node anomaly scores shape: torch.Size([15244, 1])
2025-06-02 16:00:33,557 - DEBUG - Edge anomaly scores shape: torch.Size([31250, 1])
2025-06-02 16:00:33,560 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:33,774 - DEBUG - Step 17: Loss=0.9629
2025-06-02 16:00:33,775 - DEBUG - Online update step: 18/50
2025-06-02 16:00:33,778 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:33,867 - DEBUG - Node anomaly scores shape: torch.Size([14515, 1])
2025-06-02 16:00:33,871 - DEBUG - Edge anomaly scores shape: torch.Size([29730, 1])
2025-06-02 16:00:33,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:34,012 - DEBUG - Step 18: Loss=0.9622
2025-06-02 16:00:34,012 - DEBUG - Online update step: 19/50
2025-06-02 16:00:34,016 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:34,129 - DEBUG - Node anomaly scores shape: torch.Size([14499, 1])
2025-06-02 16:00:34,135 - DEBUG - Edge anomaly scores shape: torch.Size([29638, 1])
2025-06-02 16:00:34,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:34,321 - DEBUG - Step 19: Loss=0.9601
2025-06-02 16:00:34,321 - DEBUG - Online update step: 20/50
2025-06-02 16:00:34,324 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:34,416 - DEBUG - Node anomaly scores shape: torch.Size([14792, 1])
2025-06-02 16:00:34,419 - DEBUG - Edge anomaly scores shape: torch.Size([30316, 1])
2025-06-02 16:00:34,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:34,570 - DEBUG - Step 20: Loss=0.9578
2025-06-02 16:00:34,571 - DEBUG - Online update step: 21/50
2025-06-02 16:00:34,574 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:34,655 - DEBUG - Node anomaly scores shape: torch.Size([15035, 1])
2025-06-02 16:00:34,659 - DEBUG - Edge anomaly scores shape: torch.Size([30945, 1])
2025-06-02 16:00:34,659 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:34,843 - DEBUG - Step 21: Loss=0.9542
2025-06-02 16:00:34,844 - DEBUG - Online update step: 22/50
2025-06-02 16:00:34,851 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:34,936 - DEBUG - Node anomaly scores shape: torch.Size([15012, 1])
2025-06-02 16:00:34,940 - DEBUG - Edge anomaly scores shape: torch.Size([30874, 1])
2025-06-02 16:00:34,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:35,105 - DEBUG - Step 22: Loss=0.9533
2025-06-02 16:00:35,105 - DEBUG - Online update step: 23/50
2025-06-02 16:00:35,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:35,218 - DEBUG - Node anomaly scores shape: torch.Size([15085, 1])
2025-06-02 16:00:35,222 - DEBUG - Edge anomaly scores shape: torch.Size([30935, 1])
2025-06-02 16:00:35,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:35,398 - DEBUG - Step 23: Loss=0.9525
2025-06-02 16:00:35,399 - DEBUG - Online update step: 24/50
2025-06-02 16:00:35,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:35,496 - DEBUG - Node anomaly scores shape: torch.Size([15005, 1])
2025-06-02 16:00:35,501 - DEBUG - Edge anomaly scores shape: torch.Size([30779, 1])
2025-06-02 16:00:35,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:35,694 - DEBUG - Step 24: Loss=0.9484
2025-06-02 16:00:35,695 - DEBUG - Online update step: 25/50
2025-06-02 16:00:35,704 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:35,794 - DEBUG - Node anomaly scores shape: torch.Size([14780, 1])
2025-06-02 16:00:35,799 - DEBUG - Edge anomaly scores shape: torch.Size([30296, 1])
2025-06-02 16:00:35,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:35,984 - DEBUG - Step 25: Loss=0.9510
2025-06-02 16:00:35,985 - DEBUG - Online update step: 26/50
2025-06-02 16:00:35,988 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:36,088 - DEBUG - Node anomaly scores shape: torch.Size([14996, 1])
2025-06-02 16:00:36,095 - DEBUG - Edge anomaly scores shape: torch.Size([30799, 1])
2025-06-02 16:00:36,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:36,302 - DEBUG - Step 26: Loss=0.9453
2025-06-02 16:00:36,302 - DEBUG - Online update step: 27/50
2025-06-02 16:00:36,305 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:36,535 - DEBUG - Node anomaly scores shape: torch.Size([15184, 1])
2025-06-02 16:00:36,558 - DEBUG - Edge anomaly scores shape: torch.Size([31151, 1])
2025-06-02 16:00:36,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:36,793 - DEBUG - Step 27: Loss=0.9446
2025-06-02 16:00:36,793 - DEBUG - Online update step: 28/50
2025-06-02 16:00:36,796 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:36,891 - DEBUG - Node anomaly scores shape: torch.Size([14790, 1])
2025-06-02 16:00:36,896 - DEBUG - Edge anomaly scores shape: torch.Size([30278, 1])
2025-06-02 16:00:36,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:37,082 - DEBUG - Step 28: Loss=0.9436
2025-06-02 16:00:37,083 - DEBUG - Online update step: 29/50
2025-06-02 16:00:37,091 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:37,213 - DEBUG - Node anomaly scores shape: torch.Size([14718, 1])
2025-06-02 16:00:37,221 - DEBUG - Edge anomaly scores shape: torch.Size([30153, 1])
2025-06-02 16:00:37,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:37,458 - DEBUG - Step 29: Loss=0.9405
2025-06-02 16:00:37,459 - DEBUG - Online update step: 30/50
2025-06-02 16:00:37,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:37,606 - DEBUG - Node anomaly scores shape: torch.Size([14859, 1])
2025-06-02 16:00:37,619 - DEBUG - Edge anomaly scores shape: torch.Size([30449, 1])
2025-06-02 16:00:37,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:37,842 - DEBUG - Step 30: Loss=0.9403
2025-06-02 16:00:37,843 - DEBUG - Online update step: 31/50
2025-06-02 16:00:37,846 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:37,948 - DEBUG - Node anomaly scores shape: torch.Size([15134, 1])
2025-06-02 16:00:37,953 - DEBUG - Edge anomaly scores shape: torch.Size([31039, 1])
2025-06-02 16:00:37,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:38,098 - DEBUG - Step 31: Loss=0.9368
2025-06-02 16:00:38,098 - DEBUG - Online update step: 32/50
2025-06-02 16:00:38,102 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:38,169 - DEBUG - Node anomaly scores shape: torch.Size([15114, 1])
2025-06-02 16:00:38,172 - DEBUG - Edge anomaly scores shape: torch.Size([31115, 1])
2025-06-02 16:00:38,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:38,300 - DEBUG - Step 32: Loss=0.9357
2025-06-02 16:00:38,300 - DEBUG - Online update step: 33/50
2025-06-02 16:00:38,304 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:38,372 - DEBUG - Node anomaly scores shape: torch.Size([14477, 1])
2025-06-02 16:00:38,375 - DEBUG - Edge anomaly scores shape: torch.Size([29577, 1])
2025-06-02 16:00:38,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:38,529 - DEBUG - Step 33: Loss=0.9370
2025-06-02 16:00:38,529 - DEBUG - Online update step: 34/50
2025-06-02 16:00:38,532 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:38,615 - DEBUG - Node anomaly scores shape: torch.Size([15093, 1])
2025-06-02 16:00:38,618 - DEBUG - Edge anomaly scores shape: torch.Size([30944, 1])
2025-06-02 16:00:38,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:38,750 - DEBUG - Step 34: Loss=0.9320
2025-06-02 16:00:38,751 - DEBUG - Online update step: 35/50
2025-06-02 16:00:38,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:38,831 - DEBUG - Node anomaly scores shape: torch.Size([14675, 1])
2025-06-02 16:00:38,834 - DEBUG - Edge anomaly scores shape: torch.Size([30038, 1])
2025-06-02 16:00:38,835 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:38,983 - DEBUG - Step 35: Loss=0.9348
2025-06-02 16:00:38,983 - DEBUG - Online update step: 36/50
2025-06-02 16:00:38,988 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:39,073 - DEBUG - Node anomaly scores shape: torch.Size([14492, 1])
2025-06-02 16:00:39,076 - DEBUG - Edge anomaly scores shape: torch.Size([29622, 1])
2025-06-02 16:00:39,077 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:39,184 - DEBUG - Step 36: Loss=0.9299
2025-06-02 16:00:39,185 - DEBUG - Online update step: 37/50
2025-06-02 16:00:39,188 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:39,284 - DEBUG - Node anomaly scores shape: torch.Size([14734, 1])
2025-06-02 16:00:39,288 - DEBUG - Edge anomaly scores shape: torch.Size([30136, 1])
2025-06-02 16:00:39,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:39,411 - DEBUG - Step 37: Loss=0.9305
2025-06-02 16:00:39,411 - DEBUG - Online update step: 38/50
2025-06-02 16:00:39,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:39,486 - DEBUG - Node anomaly scores shape: torch.Size([15143, 1])
2025-06-02 16:00:39,489 - DEBUG - Edge anomaly scores shape: torch.Size([31032, 1])
2025-06-02 16:00:39,490 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:39,608 - DEBUG - Step 38: Loss=0.9264
2025-06-02 16:00:39,608 - DEBUG - Online update step: 39/50
2025-06-02 16:00:39,611 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:39,697 - DEBUG - Node anomaly scores shape: torch.Size([15042, 1])
2025-06-02 16:00:39,702 - DEBUG - Edge anomaly scores shape: torch.Size([30973, 1])
2025-06-02 16:00:39,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:39,861 - DEBUG - Step 39: Loss=0.9267
2025-06-02 16:00:39,861 - DEBUG - Online update step: 40/50
2025-06-02 16:00:39,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:39,968 - DEBUG - Node anomaly scores shape: torch.Size([15315, 1])
2025-06-02 16:00:39,975 - DEBUG - Edge anomaly scores shape: torch.Size([31512, 1])
2025-06-02 16:00:39,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:40,129 - DEBUG - Step 40: Loss=0.9210
2025-06-02 16:00:40,130 - DEBUG - Online update step: 41/50
2025-06-02 16:00:40,135 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:40,224 - DEBUG - Node anomaly scores shape: torch.Size([14636, 1])
2025-06-02 16:00:40,228 - DEBUG - Edge anomaly scores shape: torch.Size([29995, 1])
2025-06-02 16:00:40,229 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:40,370 - DEBUG - Step 41: Loss=0.9223
2025-06-02 16:00:40,370 - DEBUG - Online update step: 42/50
2025-06-02 16:00:40,375 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:40,499 - DEBUG - Node anomaly scores shape: torch.Size([14518, 1])
2025-06-02 16:00:40,504 - DEBUG - Edge anomaly scores shape: torch.Size([29701, 1])
2025-06-02 16:00:40,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:40,701 - DEBUG - Step 42: Loss=0.9220
2025-06-02 16:00:40,701 - DEBUG - Online update step: 43/50
2025-06-02 16:00:40,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:40,834 - DEBUG - Node anomaly scores shape: torch.Size([15548, 1])
2025-06-02 16:00:40,838 - DEBUG - Edge anomaly scores shape: torch.Size([32053, 1])
2025-06-02 16:00:40,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:41,042 - DEBUG - Step 43: Loss=0.9157
2025-06-02 16:00:41,042 - DEBUG - Online update step: 44/50
2025-06-02 16:00:41,046 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:41,198 - DEBUG - Node anomaly scores shape: torch.Size([14615, 1])
2025-06-02 16:00:41,203 - DEBUG - Edge anomaly scores shape: torch.Size([29914, 1])
2025-06-02 16:00:41,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:41,372 - DEBUG - Step 44: Loss=0.9180
2025-06-02 16:00:41,373 - DEBUG - Online update step: 45/50
2025-06-02 16:00:41,379 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:41,459 - DEBUG - Node anomaly scores shape: torch.Size([14712, 1])
2025-06-02 16:00:41,462 - DEBUG - Edge anomaly scores shape: torch.Size([30128, 1])
2025-06-02 16:00:41,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:41,624 - DEBUG - Step 45: Loss=0.9136
2025-06-02 16:00:41,625 - DEBUG - Online update step: 46/50
2025-06-02 16:00:41,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:41,711 - DEBUG - Node anomaly scores shape: torch.Size([15606, 1])
2025-06-02 16:00:41,717 - DEBUG - Edge anomaly scores shape: torch.Size([32235, 1])
2025-06-02 16:00:41,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:41,897 - DEBUG - Step 46: Loss=0.9089
2025-06-02 16:00:41,897 - DEBUG - Online update step: 47/50
2025-06-02 16:00:41,901 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:41,980 - DEBUG - Node anomaly scores shape: torch.Size([15034, 1])
2025-06-02 16:00:41,983 - DEBUG - Edge anomaly scores shape: torch.Size([30893, 1])
2025-06-02 16:00:41,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:42,107 - DEBUG - Step 47: Loss=0.9099
2025-06-02 16:00:42,108 - DEBUG - Online update step: 48/50
2025-06-02 16:00:42,110 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:42,185 - DEBUG - Node anomaly scores shape: torch.Size([14418, 1])
2025-06-02 16:00:42,189 - DEBUG - Edge anomaly scores shape: torch.Size([29438, 1])
2025-06-02 16:00:42,190 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:42,330 - DEBUG - Step 48: Loss=0.9106
2025-06-02 16:00:42,331 - DEBUG - Online update step: 49/50
2025-06-02 16:00:42,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:42,411 - DEBUG - Node anomaly scores shape: torch.Size([15162, 1])
2025-06-02 16:00:42,417 - DEBUG - Edge anomaly scores shape: torch.Size([31083, 1])
2025-06-02 16:00:42,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:42,551 - DEBUG - Step 49: Loss=0.9097
2025-06-02 16:00:42,552 - DEBUG - Online update step: 50/50
2025-06-02 16:00:42,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:42,628 - DEBUG - Node anomaly scores shape: torch.Size([15069, 1])
2025-06-02 16:00:42,632 - DEBUG - Edge anomaly scores shape: torch.Size([30892, 1])
2025-06-02 16:00:42,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:42,758 - DEBUG - Step 50: Loss=0.9086
2025-06-02 16:00:42,758 - INFO - Online update finished. Average loss: 0.9494, Learning rate: 0.001000
2025-06-02 16:00:42,759 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], current edge mean: [ 8.1595163e+00  1.4174918e+00  4.9939494e+00  4.1965866e-09
 -3.1474401e-09 -1.0491467e-09 -4.7211599e-09  1.0491467e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 16:00:42,759 - DEBUG - Node drift difference: 0.0106, Edge drift difference: 0.0073
2025-06-02 16:00:42,761 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.5236218e-08  3.9783455e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.6929130e-09
 -9.0288692e-09  1.6929130e-08 -5.6430434e-09  3.3858261e-09
  2.2899408e+00  2.9597633e+00  1.4792900e-01  4.3940830e+00
 -9.0288692e-09  3.3775148e+00  5.7952662e+00  7.5976334e+00
  1.4792900e-01  7.9917159e+00 -5.6430434e-09  2.8497368e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -9.0288692e-09  3.1601044e-08], edge=[ 8.1595163e+00  1.4174918e+00  4.9939494e+00  4.1965866e-09
 -3.1474401e-09 -1.0491467e-09 -4.7211599e-09  1.0491467e-09
  0.0000000e+00  0.0000000e+00]
2025-06-02 16:00:42,761 - DEBUG - Updated reference std: node=[0.         0.         1.0005922  1.0005922  0.         0.
 0.         1.0005922  1.0005922  1.0005922  1.0005922  1.0005922
 0.9916503  0.28097653 0.3715423  0.5695371  1.0005922  3.015083
 2.9019485  1.5126619  0.3715423  0.24080732 1.0005922  1.0005922
 0.         0.         0.         0.         1.0005922  1.0005922 ], edge=[1.0790802 0.5064927 1.7669586 1.0002751 1.0002751 1.0002751 1.0002751
 1.0002751 1.0002751 1.0002751]
2025-06-02 16:00:42,761 - INFO - Online update complete. Loss: 0.9494
2025-06-02 16:00:42,762 - INFO - Running anomaly detection...
2025-06-02 16:00:42,762 - INFO - Starting anomaly detection.
2025-06-02 16:00:42,771 - DEBUG - Node reconstruction errors: [ 0.72098124  6.044759   18.12444     0.5672236   0.9148361   0.39542592
 17.753086    0.49791425  0.49791425  0.539584    0.49791428  1.4174606
 23.220049    1.2407998   0.4169488   0.51154417  1.5389843   0.51142544
  1.9629276   0.4272667   0.2745679   0.41694865  0.33494714  0.9436024
  0.37593356  0.37054828  0.3759702   1.2135035   0.4190677   0.3759703
  2.540506    0.6684835   1.1540225   0.47240555  0.37263972  0.36679608
  0.39034113  0.42726678  0.7009359   1.0293758   0.47691736  0.33615243
  0.42726678  0.3747109   0.89499444  1.0350431   0.7612676   1.031729
  0.3529003   1.312136    3.6747525   0.30385524  0.31032827  1.7122502
  0.19412981  0.64492077  9.5577755   0.28990278  1.7762947   1.7624115
  1.0009171   0.17373367  0.2652155   0.94618416  0.28572732  0.19412977
  0.13458404  0.1941298   0.2652145   0.26521417  0.23602992  0.38308427
  0.11801393  0.3097662   0.32805803  0.42490354  0.3403472   0.29529485
  0.19964498  0.30086252  0.26397306  0.24083845  1.4507576   2.7389104
  0.21275449  0.8341134   0.16309884  0.21678744  0.32273898  0.24747019
  0.18825111  0.830933    0.90243286  0.20419878  0.08830373  3.6111825
  0.21411632  0.24595712  0.12755488  0.15401179  0.23745205  0.21411595
  0.2726095   0.31395233  0.95853686  0.14132932  0.9167259   0.74670273
  0.96027285  1.1966329   0.6069756   0.20605117  0.8427598   0.5977043
  0.24442285  0.10909654  0.21359125  0.7704302   0.24038865  0.08917361
  0.11826292  0.86248225  0.5887311   0.7158253   0.25455493  0.08917257
  0.74964005  0.64005506  0.19310339  0.10139532  0.14692391  0.09551573
  0.91490644  0.9815317   0.17474827  0.14059563  0.22841181  0.15204114
  0.89333415  0.76806235  0.2668011   0.15075588  0.1040476   0.266801
  0.22115861  0.20574237  0.21359123  0.40938243  0.10334914  0.18956785
  1.4657966   1.0469433   0.28252965  0.09551574  0.8922896   0.7777275
  0.08338831  0.11509966  0.23745205  0.32424605  0.26680115  0.7705517
  0.08338835  0.14689812  0.1937127   0.7681213   0.24160582  0.16252007
  0.841435    0.22646023  0.26935452  0.09928275  0.16442779  4.121204
  0.24039131  0.2645598   0.1693862   0.10637907  0.17110239  0.17110233
  0.12593219  0.92774284  0.08875854  0.6036655   0.91837585  0.15333383
  0.07196495  0.18733259  0.1250821   0.0706765   0.19208361  0.18253775
  0.16966633  0.11066608  0.89333856  0.11902104  1.3348421   0.2554717
  0.78009796  0.10535595  0.09752195  0.08338834  0.58031833  0.2551325
  0.2537907   0.7722107   0.22592002  1.157475    0.10905108  0.24111287
  0.13583347  0.19237995  0.16468205  0.15250655  0.14068894  0.09931978
  0.22253688  0.21359114  0.23671801  0.11066608  0.5987035   0.07196517
  0.11963285  0.16468202  0.08338835  0.2001168   0.75328267  0.13338089
  0.20326169  0.8846432   0.7713101   0.15099339  0.24297383  0.21359107
  0.2135911   0.24207033  0.13310784  0.11963283  0.08338834  0.18565398
  0.7559753   0.1438693   0.11061697  0.2467008   0.10867555  0.24670094
  0.12272267  0.13861206  0.11061697  0.16477421  0.16442777  0.16713937
  0.23671825  0.14885192  0.14171477  0.23474073  0.07067645  0.06666651
  0.1187722   0.17110232  0.14202021  1.1151559   0.19805346  0.24533501
  0.20982975  0.07640501  0.2326938   2.6845253   0.2326941   0.10659974
  0.62695634  0.58856887  0.16271353  0.2813853   0.1737352   0.17110236
  0.08726539  0.32660446  0.12593219  0.18345493  1.2689939   0.10318936
  0.1232536   0.26140526  0.18684389  0.1522789   1.0345963   0.7794181
  0.92774314  0.6454502   0.14776972  0.11839724  0.09052987  0.10867552
  1.0206095   0.06872597  0.14197992  0.1710975   0.11924214  0.92931813
  0.10924265  0.07654062  0.12359913  0.17726456  0.07653957  0.07653979
  0.07653984  0.15651228  0.06029246  0.07654043  0.0765398   0.92885697
  0.07653981  0.06735127  0.78380394  0.17330997  0.2094582   0.8383558
  0.15192927  0.11655586  0.19812909  0.12012477  0.21663329  0.12359913
  0.75080264  0.59271264  0.08916713  0.2056963   0.21519165  0.21519208
  0.40483734  0.11833131  0.07653593  0.17373545  0.07653986  0.15651229
  0.25035474  0.12172462  0.08916751  0.08916803  0.07685961  0.10904679
  0.08916757  0.19248848  0.25734457  0.15141493  0.12359908  0.12998267
  0.28083423  0.16760439  0.07654818  0.0888952   0.6004029   0.15051033
  0.08866224  0.07067645  0.04622263  0.07653984  0.10960691  2.7166057
  0.13583331  0.08254934  0.32688802  0.12899174  0.12359677  4.1886
  0.06667796  1.0011973   0.14179967  0.08945748  0.11247359  0.12517935
  0.1610658   0.6393973   0.20639843  0.15050875  0.08558568  0.10413469
  0.137043    0.0765398   0.1235991   0.61246467  0.06861258  0.09827342
  0.6249009   0.19400512  0.25988108  0.8536042   0.19313675  0.07653947
  0.43606657  0.1797924   0.09205986  0.78848994  0.15088885  0.15088886
  0.15088895  1.6000654   0.05290729  1.5979812   0.07331931  0.23800208
  0.15088879  0.05290722  0.10314845  0.09206183  0.20984305  0.07952847
  0.09205985  0.68258786  0.15088889  0.09205985  0.05290724  0.1508889
  0.15088885  0.03486574  0.07754306  0.15088892  0.08443262  0.15878709
  0.08051761  0.11500416  0.08714234  0.07477157  0.68095034  0.15479441
  0.17476842  0.19144243  0.7975693   0.840868    0.17782049  0.12305737
  0.08073684  0.13049953  0.15088883  0.15088886  0.07331927  0.14753817
  0.65628064  0.03250044  0.14080855  0.1065672   0.35235894  0.03311032
  0.04230874  0.9475272   0.9518063   0.1017869   0.14672118  0.08494477
  0.20897093  0.04268009  0.08594648  0.03870249  0.04268002  0.1348471
  0.07477153  0.07361548  0.08805658  0.17000581  0.10909556  0.07855432
  0.08216227  0.9970696   0.08216229  0.07855432  0.05960387  0.1329796
  0.68692166  0.12859347  0.05960385  0.10909581  0.12736994  0.7348136
  0.22911626  0.08714291  0.13297962  0.10909556  0.03333175  0.09289739
  0.09688547  0.86661536  0.12315635  0.10178693  0.7434279   0.05872158
  0.04268001  0.62972087  0.14731173  0.73803014  0.07383595  0.0333318
  0.11352657  0.0379591   0.08069517  0.07361548  0.09419473  1.7982389
  0.03870251  0.09289739  0.27309996  0.0379074   0.27309993  0.048762
  0.0427584   0.7940965   0.03081563  1.014784    0.17482823  0.04268001
  0.79477614  0.10133804  0.10133807  0.04231507  0.08369575  0.10706857
  0.03081958  0.0766276   0.19585499  0.11898888  0.07662786  0.1065672
  0.03081565  0.1566671   0.04275846  0.09419444  0.15851738  0.6522643
  0.07662741  0.13862935  0.10706882  0.0387025   0.03870251  0.09289739
  0.09419462  0.07917644  0.11998563  0.13896747  0.03870251  0.11331714
  0.03870237  0.11331711  0.14991124  0.07662792  0.12294657  3.2477994
  0.68139106  0.03380879  1.3584851   0.0338086   0.03380831  0.03380872
  0.03380863  0.03380856  0.03380867  0.03380871  0.08708502  0.15502171
  0.15111531  0.03380879  0.03380867  0.0338087   0.0338086   0.03380848
  0.03380867  0.03380845  0.03380855  0.03380867  0.07966709  0.03380727
  0.0338087   0.80124557  0.03380851  0.64038163  0.16200407  0.03870247
  0.20135316  0.19712056  1.5747693   1.5747693   0.15392326  0.20135316
  0.03870253  0.03081568  0.03081569  0.03870249  0.03081563  0.08543389
  0.1536978   0.03377593  0.10656723  0.03870248  0.10133804  0.03870246
  0.03870238  0.1428208   0.03870255  0.03081567  0.03870249  0.03870255
  0.07662769  0.03081565  0.03870255  0.0308157   0.0387025   0.03870251
  0.03870249  0.13686925  0.19712049  0.08069517  0.0338087   0.16304263
  0.14772968  0.03870236  0.03081565  0.16428807  0.03380905  0.10883185
  0.17893976  0.02915661  0.03870251  0.03870249  0.11421849  0.14420818
  0.08926138  0.03870253  0.08708504  0.04422373  0.03081566  0.63992876
  0.03380867  0.23017982  0.19839932  0.03380867  0.03381077  0.08708494
  0.04422369  0.0387025   0.3859965   0.13313468  0.22119783  0.14420809
  0.13139409  0.11702915  0.11702935  0.15232438  0.07219353  0.03380865
  0.12123286  0.16548042  0.14420818  0.08242856  0.0980747   0.03833325
  0.03814354  0.03814354  0.0381436   0.03814356  0.03814356  0.10013121
  0.19888213  0.03814351  0.03813817  0.03380845  0.05613099  0.03380872
  0.11702924  0.13657719  0.23127054  0.03807413  0.11702922  0.20086208
  0.0796674   0.07317207  0.07966746  0.0338087   0.11702915  0.03526741
  0.03010453  0.03010449  0.03814351  0.03526741  0.13800879  0.04470886
  0.03380881  0.03380871  0.03814359  0.07203346  0.03010456  0.04131229
  0.03833327  0.05380933  0.1001311   0.8755258   0.05380491  1.0064512
  0.12847772  0.03833372  0.16747001  0.03709454  0.05006685  0.10045609
  0.15126835  0.05163215  0.12566595  0.0383333   0.03833347  0.03833325
  0.03742654  0.03833326  0.03833332  0.05006689  0.0383333   0.03833331
  0.03833398  0.16150887  0.04819433  0.2182303   0.27370435  0.14804797
  0.19352324  0.06311017  0.24130209  1.6999062   0.07139861  0.06867747
  0.13806984  0.27647525  0.27651724  0.05006683  0.9645659   0.33311775
  0.07111638  0.07422393  0.21735267  1.0379174   0.098385    0.098385
  0.09838496  0.10566037  0.11296709  0.8216574   0.3678026   0.3590346
  0.14060774  0.11216717  0.23575692  0.07422328  0.24694175  0.25970805
  0.07869291  0.2722402   0.07111635  0.33311647  0.07422329  0.2597081
  0.11216769  0.11941851  0.09838497  0.10566109  0.07869127  0.2244604
  0.32716095  0.10566037  0.10566022  0.10566024  0.29240793  0.2643262
  2.943339    0.09838499  0.2991348   0.10566078  0.27465293  0.33842698
  1.90685     0.33824044  0.10566031  0.14605951  0.35792747  0.10125103
  0.14608088  0.33406126  4.260032    0.20754962  0.3986357   0.3384259
  0.3256825   0.3868937   0.24086742  0.35351798  0.35240525  0.14070664
  0.14070651  0.35351804  0.50913274  0.14605945  0.33842677  0.24086699
  0.33842722  0.18951914  0.18951915  0.18951935  0.1566992   0.5066213
  0.18951935  0.18951933  0.21002421  0.37955564  0.1895191   0.18951932
  0.19567241  0.4535629   0.53671676  0.47741225  0.18951915  0.48044592
  0.3795554   0.18951933  0.24934737  0.37679103  0.18951933  0.18951938
  0.86317563  0.3767915   0.18951936  0.37679115  0.39902458  0.5920383
  0.515734    0.18951936  0.6290384   0.3990239   0.3990256   0.45356417
  0.25497073  0.3990223   0.24934742  0.24934728  0.2493474   0.5355151
  0.45505485  0.53551567  0.6433811   0.24934736  0.45505497]
2025-06-02 16:00:42,772 - DEBUG - Edge reconstruction errors: [1.2628763  1.2628162  0.8584488  ... 0.15842892 1.3588495  0.15842918]
2025-06-02 16:00:42,774 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160042_update_35.json
2025-06-02 16:00:42,774 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:00:42,783 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160042_update_35.pth and as latest_checkpoint.pth
2025-06-02 16:00:42,783 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870145.dot): 0.1680
2025-06-02 16:00:42,783 - WARNING - Detected 8 anomalous nodes (reconstruction-based):
2025-06-02 16:00:42,783 - WARNING -   Node ID: 192.168.239.101, Recon Error: 6.0448, MLP Score: 0.3681
2025-06-02 16:00:42,784 - WARNING -   Node ID: 192.168.27.13, Recon Error: 18.1244, MLP Score: 0.4987
2025-06-02 16:00:42,784 - WARNING -   Node ID: 192.168.27.12, Recon Error: 17.7531, MLP Score: 0.5000
2025-06-02 16:00:42,784 - WARNING -   Node ID: 192.168.27.10, Recon Error: 23.2200, MLP Score: 0.5006
2025-06-02 16:00:42,784 - WARNING -   Node ID: 192.168.209.130, Recon Error: 9.5578, MLP Score: 0.3680
2025-06-02 16:00:42,784 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 16:00:42,784 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.8041, MLP Score: 0.5168
2025-06-02 16:00:42,784 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.0261, MLP Score: 0.5176
2025-06-02 16:00:42,784 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.1462, MLP Score: 0.4523
2025-06-02 16:00:42,784 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.3462, MLP Score: 0.4383
2025-06-02 16:00:42,784 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.9854, MLP Score: 0.7641
2025-06-02 16:00:42,784 - INFO - 
--- Processing file: nw_graph_encoded_1748870175.dot (Timestamp: 2025-06-02 15:16:15) ---
2025-06-02 16:00:42,784 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 16:00:42,784 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 16:00:42,812 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 16:00:42,837 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 16:00:42,837 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 16:00:42,837 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870175.dot
2025-06-02 16:00:42,856 - INFO - Parsed 866 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 16:00:42,875 - INFO - Parsed 1848 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870175.dot'.
2025-06-02 16:00:42,875 - INFO - Processing node updates/additions.
2025-06-02 16:00:42,879 - INFO - Processing edge updates/additions.
2025-06-02 16:00:42,888 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:00:42,889 - INFO - Finished updating NetworkX graph.
2025-06-02 16:00:42,889 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:00:42,890 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:00:42,897 - DEBUG - Initial node features tensor shape: torch.Size([866, 30])
2025-06-02 16:00:42,898 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:00:42,898 - DEBUG - Node features tensor shape after scaling: torch.Size([866, 30])
2025-06-02 16:00:42,900 - DEBUG - Edge index tensor shape: torch.Size([2, 1848])
2025-06-02 16:00:42,901 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:00:42,905 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 18
2025-06-02 16:00:42,906 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:00:42,907 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-02 16:00:42,908 - DEBUG - Shape of encoded categorical edge features: torch.Size([1848, 3])
2025-06-02 16:00:42,909 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:00:42,909 - DEBUG - Shape of scaled numerical edge features: torch.Size([1848, 7])
2025-06-02 16:00:42,909 - DEBUG - Final edge attributes tensor shape: torch.Size([1848, 10])
2025-06-02 16:00:42,909 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:00:42,911 - INFO - Performing online update...
2025-06-02 16:00:42,911 - INFO - Starting online update for 50 steps.
2025-06-02 16:00:42,912 - DEBUG - Updated RunningStats: new_mean=0.9437220506251973, new_var=20400000000161.473, new_n=2070
2025-06-02 16:00:42,912 - DEBUG - Updated RunningStats: new_mean=0.940823358502129, new_var=20700000000018.105, new_n=2100
2025-06-02 16:00:42,912 - DEBUG - Updated RunningStats: new_mean=1.0881045349889862, new_var=6800000000073.71, new_n=690
2025-06-02 16:00:42,912 - DEBUG - Updated RunningStats: new_mean=1.0873791323152566, new_var=6900000000000.869, new_n=700
2025-06-02 16:00:42,912 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:00:42,913 - DEBUG - Online update step: 1/50
2025-06-02 16:00:42,914 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:42,984 - DEBUG - Node anomaly scores shape: torch.Size([15241, 1])
2025-06-02 16:00:42,988 - DEBUG - Edge anomaly scores shape: torch.Size([31344, 1])
2025-06-02 16:00:42,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:43,136 - DEBUG - Step 1: Loss=0.9032
2025-06-02 16:00:43,136 - DEBUG - Online update step: 2/50
2025-06-02 16:00:43,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:43,210 - DEBUG - Node anomaly scores shape: torch.Size([14676, 1])
2025-06-02 16:00:43,213 - DEBUG - Edge anomaly scores shape: torch.Size([30054, 1])
2025-06-02 16:00:43,214 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:43,341 - DEBUG - Step 2: Loss=0.9041
2025-06-02 16:00:43,341 - DEBUG - Online update step: 3/50
2025-06-02 16:00:43,344 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:43,415 - DEBUG - Node anomaly scores shape: torch.Size([15200, 1])
2025-06-02 16:00:43,422 - DEBUG - Edge anomaly scores shape: torch.Size([31197, 1])
2025-06-02 16:00:43,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:43,572 - DEBUG - Step 3: Loss=0.9010
2025-06-02 16:00:43,572 - DEBUG - Online update step: 4/50
2025-06-02 16:00:43,575 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:43,685 - DEBUG - Node anomaly scores shape: torch.Size([15418, 1])
2025-06-02 16:00:43,690 - DEBUG - Edge anomaly scores shape: torch.Size([31686, 1])
2025-06-02 16:00:43,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:43,818 - DEBUG - Step 4: Loss=0.8978
2025-06-02 16:00:43,818 - DEBUG - Online update step: 5/50
2025-06-02 16:00:43,821 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:43,901 - DEBUG - Node anomaly scores shape: torch.Size([15010, 1])
2025-06-02 16:00:43,911 - DEBUG - Edge anomaly scores shape: torch.Size([30801, 1])
2025-06-02 16:00:43,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:44,065 - DEBUG - Step 5: Loss=0.9020
2025-06-02 16:00:44,066 - DEBUG - Online update step: 6/50
2025-06-02 16:00:44,070 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:44,175 - DEBUG - Node anomaly scores shape: torch.Size([14850, 1])
2025-06-02 16:00:44,183 - DEBUG - Edge anomaly scores shape: torch.Size([30380, 1])
2025-06-02 16:00:44,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:44,291 - DEBUG - Step 6: Loss=0.8973
2025-06-02 16:00:44,292 - DEBUG - Online update step: 7/50
2025-06-02 16:00:44,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:44,363 - DEBUG - Node anomaly scores shape: torch.Size([15721, 1])
2025-06-02 16:00:44,367 - DEBUG - Edge anomaly scores shape: torch.Size([32436, 1])
2025-06-02 16:00:44,368 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:44,518 - DEBUG - Step 7: Loss=0.8963
2025-06-02 16:00:44,519 - DEBUG - Online update step: 8/50
2025-06-02 16:00:44,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:44,646 - DEBUG - Node anomaly scores shape: torch.Size([15461, 1])
2025-06-02 16:00:44,655 - DEBUG - Edge anomaly scores shape: torch.Size([31822, 1])
2025-06-02 16:00:44,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:44,859 - DEBUG - Step 8: Loss=0.8922
2025-06-02 16:00:44,859 - DEBUG - Online update step: 9/50
2025-06-02 16:00:44,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:44,936 - DEBUG - Node anomaly scores shape: torch.Size([15547, 1])
2025-06-02 16:00:44,940 - DEBUG - Edge anomaly scores shape: torch.Size([32003, 1])
2025-06-02 16:00:44,941 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:45,197 - DEBUG - Step 9: Loss=0.8928
2025-06-02 16:00:45,198 - DEBUG - Online update step: 10/50
2025-06-02 16:00:45,204 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:45,286 - DEBUG - Node anomaly scores shape: torch.Size([15785, 1])
2025-06-02 16:00:45,289 - DEBUG - Edge anomaly scores shape: torch.Size([32524, 1])
2025-06-02 16:00:45,291 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:45,445 - DEBUG - Step 10: Loss=0.8903
2025-06-02 16:00:45,446 - DEBUG - Online update step: 11/50
2025-06-02 16:00:45,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:45,533 - DEBUG - Node anomaly scores shape: torch.Size([15499, 1])
2025-06-02 16:00:45,537 - DEBUG - Edge anomaly scores shape: torch.Size([31960, 1])
2025-06-02 16:00:45,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:45,720 - DEBUG - Step 11: Loss=0.8868
2025-06-02 16:00:45,720 - DEBUG - Online update step: 12/50
2025-06-02 16:00:45,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:45,796 - DEBUG - Node anomaly scores shape: torch.Size([15099, 1])
2025-06-02 16:00:45,800 - DEBUG - Edge anomaly scores shape: torch.Size([31019, 1])
2025-06-02 16:00:45,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:45,938 - DEBUG - Step 12: Loss=0.8886
2025-06-02 16:00:45,938 - DEBUG - Online update step: 13/50
2025-06-02 16:00:45,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:46,034 - DEBUG - Node anomaly scores shape: torch.Size([16369, 1])
2025-06-02 16:00:46,038 - DEBUG - Edge anomaly scores shape: torch.Size([33779, 1])
2025-06-02 16:00:46,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:46,223 - DEBUG - Step 13: Loss=0.8856
2025-06-02 16:00:46,223 - DEBUG - Online update step: 14/50
2025-06-02 16:00:46,228 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:46,300 - DEBUG - Node anomaly scores shape: torch.Size([15907, 1])
2025-06-02 16:00:46,303 - DEBUG - Edge anomaly scores shape: torch.Size([32898, 1])
2025-06-02 16:00:46,304 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:46,435 - DEBUG - Step 14: Loss=0.8857
2025-06-02 16:00:46,436 - DEBUG - Online update step: 15/50
2025-06-02 16:00:46,439 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:46,542 - DEBUG - Node anomaly scores shape: torch.Size([15966, 1])
2025-06-02 16:00:46,546 - DEBUG - Edge anomaly scores shape: torch.Size([32845, 1])
2025-06-02 16:00:46,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:46,712 - DEBUG - Step 15: Loss=0.8823
2025-06-02 16:00:46,712 - DEBUG - Online update step: 16/50
2025-06-02 16:00:46,718 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:46,804 - DEBUG - Node anomaly scores shape: torch.Size([15466, 1])
2025-06-02 16:00:46,807 - DEBUG - Edge anomaly scores shape: torch.Size([31773, 1])
2025-06-02 16:00:46,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:46,967 - DEBUG - Step 16: Loss=0.8817
2025-06-02 16:00:46,968 - DEBUG - Online update step: 17/50
2025-06-02 16:00:46,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:47,056 - DEBUG - Node anomaly scores shape: torch.Size([14963, 1])
2025-06-02 16:00:47,060 - DEBUG - Edge anomaly scores shape: torch.Size([30706, 1])
2025-06-02 16:00:47,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:47,205 - DEBUG - Step 17: Loss=0.8819
2025-06-02 16:00:47,205 - DEBUG - Online update step: 18/50
2025-06-02 16:00:47,209 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:47,289 - DEBUG - Node anomaly scores shape: torch.Size([14636, 1])
2025-06-02 16:00:47,294 - DEBUG - Edge anomaly scores shape: torch.Size([29927, 1])
2025-06-02 16:00:47,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:47,443 - DEBUG - Step 18: Loss=0.8811
2025-06-02 16:00:47,444 - DEBUG - Online update step: 19/50
2025-06-02 16:00:47,448 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:47,543 - DEBUG - Node anomaly scores shape: torch.Size([15078, 1])
2025-06-02 16:00:47,549 - DEBUG - Edge anomaly scores shape: torch.Size([31041, 1])
2025-06-02 16:00:47,550 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:47,688 - DEBUG - Step 19: Loss=0.8779
2025-06-02 16:00:47,689 - DEBUG - Online update step: 20/50
2025-06-02 16:00:47,694 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:47,795 - DEBUG - Node anomaly scores shape: torch.Size([15349, 1])
2025-06-02 16:00:47,798 - DEBUG - Edge anomaly scores shape: torch.Size([31497, 1])
2025-06-02 16:00:47,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:47,977 - DEBUG - Step 20: Loss=0.8796
2025-06-02 16:00:47,978 - DEBUG - Online update step: 21/50
2025-06-02 16:00:47,983 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:48,060 - DEBUG - Node anomaly scores shape: torch.Size([14611, 1])
2025-06-02 16:00:48,067 - DEBUG - Edge anomaly scores shape: torch.Size([29867, 1])
2025-06-02 16:00:48,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:48,248 - DEBUG - Step 21: Loss=0.8791
2025-06-02 16:00:48,248 - DEBUG - Online update step: 22/50
2025-06-02 16:00:48,254 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:48,344 - DEBUG - Node anomaly scores shape: torch.Size([16359, 1])
2025-06-02 16:00:48,349 - DEBUG - Edge anomaly scores shape: torch.Size([33826, 1])
2025-06-02 16:00:48,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:48,590 - DEBUG - Step 22: Loss=0.8717
2025-06-02 16:00:48,590 - DEBUG - Online update step: 23/50
2025-06-02 16:00:48,596 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:48,722 - DEBUG - Node anomaly scores shape: torch.Size([16003, 1])
2025-06-02 16:00:48,728 - DEBUG - Edge anomaly scores shape: torch.Size([33022, 1])
2025-06-02 16:00:48,730 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:48,923 - DEBUG - Step 23: Loss=0.8702
2025-06-02 16:00:48,923 - DEBUG - Online update step: 24/50
2025-06-02 16:00:48,928 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:49,001 - DEBUG - Node anomaly scores shape: torch.Size([15699, 1])
2025-06-02 16:00:49,004 - DEBUG - Edge anomaly scores shape: torch.Size([32409, 1])
2025-06-02 16:00:49,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:49,172 - DEBUG - Step 24: Loss=0.8691
2025-06-02 16:00:49,173 - DEBUG - Online update step: 25/50
2025-06-02 16:00:49,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:49,283 - DEBUG - Node anomaly scores shape: torch.Size([15023, 1])
2025-06-02 16:00:49,286 - DEBUG - Edge anomaly scores shape: torch.Size([30834, 1])
2025-06-02 16:00:49,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:49,420 - DEBUG - Step 25: Loss=0.8735
2025-06-02 16:00:49,420 - DEBUG - Online update step: 26/50
2025-06-02 16:00:49,426 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:49,502 - DEBUG - Node anomaly scores shape: torch.Size([15308, 1])
2025-06-02 16:00:49,505 - DEBUG - Edge anomaly scores shape: torch.Size([31405, 1])
2025-06-02 16:00:49,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:49,639 - DEBUG - Step 26: Loss=0.8721
2025-06-02 16:00:49,639 - DEBUG - Online update step: 27/50
2025-06-02 16:00:49,645 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:49,730 - DEBUG - Node anomaly scores shape: torch.Size([15201, 1])
2025-06-02 16:00:49,733 - DEBUG - Edge anomaly scores shape: torch.Size([31174, 1])
2025-06-02 16:00:49,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:49,903 - DEBUG - Step 27: Loss=0.8670
2025-06-02 16:00:49,903 - DEBUG - Online update step: 28/50
2025-06-02 16:00:49,909 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:49,994 - DEBUG - Node anomaly scores shape: torch.Size([15661, 1])
2025-06-02 16:00:49,998 - DEBUG - Edge anomaly scores shape: torch.Size([32213, 1])
2025-06-02 16:00:49,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:50,204 - DEBUG - Step 28: Loss=0.8643
2025-06-02 16:00:50,204 - DEBUG - Online update step: 29/50
2025-06-02 16:00:50,209 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:50,299 - DEBUG - Node anomaly scores shape: torch.Size([15232, 1])
2025-06-02 16:00:50,302 - DEBUG - Edge anomaly scores shape: torch.Size([31269, 1])
2025-06-02 16:00:50,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:50,482 - DEBUG - Step 29: Loss=0.8670
2025-06-02 16:00:50,482 - DEBUG - Online update step: 30/50
2025-06-02 16:00:50,485 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:50,558 - DEBUG - Node anomaly scores shape: torch.Size([14759, 1])
2025-06-02 16:00:50,564 - DEBUG - Edge anomaly scores shape: torch.Size([30229, 1])
2025-06-02 16:00:50,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:50,784 - DEBUG - Step 30: Loss=0.8671
2025-06-02 16:00:50,784 - DEBUG - Online update step: 31/50
2025-06-02 16:00:50,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:50,874 - DEBUG - Node anomaly scores shape: torch.Size([15540, 1])
2025-06-02 16:00:50,878 - DEBUG - Edge anomaly scores shape: torch.Size([31992, 1])
2025-06-02 16:00:50,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:51,043 - DEBUG - Step 31: Loss=0.8600
2025-06-02 16:00:51,043 - DEBUG - Online update step: 32/50
2025-06-02 16:00:51,046 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:51,107 - DEBUG - Node anomaly scores shape: torch.Size([14813, 1])
2025-06-02 16:00:51,110 - DEBUG - Edge anomaly scores shape: torch.Size([30338, 1])
2025-06-02 16:00:51,111 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:51,240 - DEBUG - Step 32: Loss=0.8608
2025-06-02 16:00:51,240 - DEBUG - Online update step: 33/50
2025-06-02 16:00:51,243 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:51,326 - DEBUG - Node anomaly scores shape: torch.Size([15813, 1])
2025-06-02 16:00:51,330 - DEBUG - Edge anomaly scores shape: torch.Size([32588, 1])
2025-06-02 16:00:51,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:51,487 - DEBUG - Step 33: Loss=0.8569
2025-06-02 16:00:51,488 - DEBUG - Online update step: 34/50
2025-06-02 16:00:51,491 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:51,567 - DEBUG - Node anomaly scores shape: torch.Size([15356, 1])
2025-06-02 16:00:51,573 - DEBUG - Edge anomaly scores shape: torch.Size([31560, 1])
2025-06-02 16:00:51,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:51,755 - DEBUG - Step 34: Loss=0.8564
2025-06-02 16:00:51,756 - DEBUG - Online update step: 35/50
2025-06-02 16:00:51,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:51,859 - DEBUG - Node anomaly scores shape: torch.Size([15271, 1])
2025-06-02 16:00:51,863 - DEBUG - Edge anomaly scores shape: torch.Size([31276, 1])
2025-06-02 16:00:51,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:51,988 - DEBUG - Step 35: Loss=0.8573
2025-06-02 16:00:51,988 - DEBUG - Online update step: 36/50
2025-06-02 16:00:51,991 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:52,054 - DEBUG - Node anomaly scores shape: torch.Size([15302, 1])
2025-06-02 16:00:52,057 - DEBUG - Edge anomaly scores shape: torch.Size([31403, 1])
2025-06-02 16:00:52,058 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:52,247 - DEBUG - Step 36: Loss=0.8549
2025-06-02 16:00:52,247 - DEBUG - Online update step: 37/50
2025-06-02 16:00:52,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:52,326 - DEBUG - Node anomaly scores shape: torch.Size([15703, 1])
2025-06-02 16:00:52,329 - DEBUG - Edge anomaly scores shape: torch.Size([32361, 1])
2025-06-02 16:00:52,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:52,494 - DEBUG - Step 37: Loss=0.8521
2025-06-02 16:00:52,494 - DEBUG - Online update step: 38/50
2025-06-02 16:00:52,497 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:52,584 - DEBUG - Node anomaly scores shape: torch.Size([15568, 1])
2025-06-02 16:00:52,588 - DEBUG - Edge anomaly scores shape: torch.Size([32058, 1])
2025-06-02 16:00:52,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:52,760 - DEBUG - Step 38: Loss=0.8509
2025-06-02 16:00:52,761 - DEBUG - Online update step: 39/50
2025-06-02 16:00:52,764 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:52,844 - DEBUG - Node anomaly scores shape: torch.Size([15576, 1])
2025-06-02 16:00:52,848 - DEBUG - Edge anomaly scores shape: torch.Size([31992, 1])
2025-06-02 16:00:52,849 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:52,972 - DEBUG - Step 39: Loss=0.8486
2025-06-02 16:00:52,972 - DEBUG - Online update step: 40/50
2025-06-02 16:00:52,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:53,041 - DEBUG - Node anomaly scores shape: torch.Size([15240, 1])
2025-06-02 16:00:53,045 - DEBUG - Edge anomaly scores shape: torch.Size([31233, 1])
2025-06-02 16:00:53,050 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:53,181 - DEBUG - Step 40: Loss=0.8506
2025-06-02 16:00:53,181 - DEBUG - Online update step: 41/50
2025-06-02 16:00:53,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:53,324 - DEBUG - Node anomaly scores shape: torch.Size([15148, 1])
2025-06-02 16:00:53,328 - DEBUG - Edge anomaly scores shape: torch.Size([31098, 1])
2025-06-02 16:00:53,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:53,496 - DEBUG - Step 41: Loss=0.8465
2025-06-02 16:00:53,497 - DEBUG - Online update step: 42/50
2025-06-02 16:00:53,502 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:53,617 - DEBUG - Node anomaly scores shape: torch.Size([16312, 1])
2025-06-02 16:00:53,622 - DEBUG - Edge anomaly scores shape: torch.Size([33659, 1])
2025-06-02 16:00:53,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:53,773 - DEBUG - Step 42: Loss=0.8426
2025-06-02 16:00:53,773 - DEBUG - Online update step: 43/50
2025-06-02 16:00:53,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:53,891 - DEBUG - Node anomaly scores shape: torch.Size([15026, 1])
2025-06-02 16:00:53,895 - DEBUG - Edge anomaly scores shape: torch.Size([30809, 1])
2025-06-02 16:00:53,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:54,016 - DEBUG - Step 43: Loss=0.8440
2025-06-02 16:00:54,016 - DEBUG - Online update step: 44/50
2025-06-02 16:00:54,019 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:54,122 - DEBUG - Node anomaly scores shape: torch.Size([15695, 1])
2025-06-02 16:00:54,125 - DEBUG - Edge anomaly scores shape: torch.Size([32388, 1])
2025-06-02 16:00:54,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:54,398 - DEBUG - Step 44: Loss=0.8409
2025-06-02 16:00:54,398 - DEBUG - Online update step: 45/50
2025-06-02 16:00:54,404 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:54,628 - DEBUG - Node anomaly scores shape: torch.Size([14701, 1])
2025-06-02 16:00:54,698 - DEBUG - Edge anomaly scores shape: torch.Size([30126, 1])
2025-06-02 16:00:54,700 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:54,875 - DEBUG - Step 45: Loss=0.8442
2025-06-02 16:00:54,876 - DEBUG - Online update step: 46/50
2025-06-02 16:00:54,881 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:54,957 - DEBUG - Node anomaly scores shape: torch.Size([15123, 1])
2025-06-02 16:00:54,961 - DEBUG - Edge anomaly scores shape: torch.Size([31131, 1])
2025-06-02 16:00:54,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:55,174 - DEBUG - Step 46: Loss=0.8408
2025-06-02 16:00:55,177 - DEBUG - Online update step: 47/50
2025-06-02 16:00:55,183 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:55,305 - DEBUG - Node anomaly scores shape: torch.Size([15371, 1])
2025-06-02 16:00:55,312 - DEBUG - Edge anomaly scores shape: torch.Size([31671, 1])
2025-06-02 16:00:55,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:55,543 - DEBUG - Step 47: Loss=0.8361
2025-06-02 16:00:55,544 - DEBUG - Online update step: 48/50
2025-06-02 16:00:55,549 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:55,629 - DEBUG - Node anomaly scores shape: torch.Size([15262, 1])
2025-06-02 16:00:55,633 - DEBUG - Edge anomaly scores shape: torch.Size([31348, 1])
2025-06-02 16:00:55,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:55,817 - DEBUG - Step 48: Loss=0.8356
2025-06-02 16:00:55,817 - DEBUG - Online update step: 49/50
2025-06-02 16:00:55,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:55,901 - DEBUG - Node anomaly scores shape: torch.Size([15293, 1])
2025-06-02 16:00:55,905 - DEBUG - Edge anomaly scores shape: torch.Size([31344, 1])
2025-06-02 16:00:55,906 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:56,088 - DEBUG - Step 49: Loss=0.8366
2025-06-02 16:00:56,088 - DEBUG - Online update step: 50/50
2025-06-02 16:00:56,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:00:56,182 - DEBUG - Node anomaly scores shape: torch.Size([15965, 1])
2025-06-02 16:00:56,186 - DEBUG - Edge anomaly scores shape: torch.Size([32967, 1])
2025-06-02 16:00:56,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:00:56,422 - DEBUG - Step 50: Loss=0.8337
2025-06-02 16:00:56,423 - INFO - Online update finished. Average loss: 0.8692, Learning rate: 0.001000
2025-06-02 16:00:56,423 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], current edge mean: [ 8.1650429e+00  1.4117966e+00  4.9886365e+00 -2.0642301e-09
  0.0000000e+00  0.0000000e+00  2.0642301e-09 -4.1284602e-09
  2.0642301e-09 -2.0642301e-09]
2025-06-02 16:00:56,424 - DEBUG - Node drift difference: 0.0150, Edge drift difference: 0.0112
2025-06-02 16:00:56,425 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.7344538e-08  5.7815130e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8081635e-08
  1.3214887e-08 -5.5062026e-09  9.9111652e-09  1.1012405e-09
  2.3048499e+00  2.9584296e+00  1.4434180e-01  4.4006929e+00
  5.5062026e-09  3.3418014e+00  5.8198614e+00  7.6073904e+00
  1.4434180e-01  7.9919167e+00 -3.7992798e-08  3.1935976e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.6074435e-09  3.3037217e-09], edge=[ 8.1650429e+00  1.4117966e+00  4.9886365e+00 -2.0642301e-09
  0.0000000e+00  0.0000000e+00  2.0642301e-09 -4.1284602e-09
  2.0642301e-09 -2.0642301e-09]
2025-06-02 16:00:56,425 - DEBUG - Updated reference std: node=[0.         0.         1.0005779  1.0005779  0.         0.
 0.         1.0005778  1.0005778  1.0005779  1.0005779  1.0005779
 0.99914396 0.28549412 0.3677101  0.5709333  1.0005779  2.9968822
 2.89626    1.4954702  0.3677101  0.23786968 1.0005778  1.0005778
 0.         0.         0.         0.         1.0005778  1.0005778 ], edge=[1.0880713 0.5053171 1.7779802 1.0002707 1.0002707 1.0002706 1.0002707
 1.0002706 1.0002707 1.0002707]
2025-06-02 16:00:56,425 - INFO - Online update complete. Loss: 0.8692
2025-06-02 16:00:56,426 - INFO - Running anomaly detection...
2025-06-02 16:00:56,426 - INFO - Starting anomaly detection.
2025-06-02 16:00:56,439 - DEBUG - Node reconstruction errors: [6.71261489e-01 4.61529875e+00 1.75261021e+01 2.65806019e-01
 6.08689368e-01 3.47283423e-01 1.71606026e+01 2.43474707e-01
 2.43474171e-01 3.38346004e-01 2.43473917e-01 1.02019930e+00
 2.21966763e+01 1.00295806e+00 1.64811343e-01 2.65350401e-01
 1.17137480e+00 2.65355825e-01 1.17789125e+00 2.28718832e-01
 1.50793582e-01 1.64811358e-01 2.39648744e-01 7.17640698e-01
 1.49125502e-01 2.30684057e-01 1.49153844e-01 7.30164170e-01
 2.10896045e-01 1.49153888e-01 2.04113793e+00 5.04728317e-01
 6.78151369e-01 2.23480329e-01 2.28254378e-01 2.55505413e-01
 3.31023335e-01 2.28719532e-01 4.20463562e-01 8.78695130e-01
 2.86679924e-01 1.34128436e-01 2.28719532e-01 2.95490474e-01
 7.31409907e-01 8.48550856e-01 6.12918198e-01 8.05774629e-01
 1.85280889e-01 1.27335787e+00 2.55520654e+00 1.96516037e-01
 2.04171941e-01 1.10214758e+00 1.28742784e-01 3.52276683e-01
 8.05648994e+00 1.68239370e-01 1.13055563e+00 1.23429680e+00
 9.21598792e-01 3.58659446e-01 1.07995987e-01 7.98026502e-01
 1.19579144e-01 1.28742635e-01 7.32330829e-02 1.28742233e-01
 1.07996389e-01 3.58659476e-01 1.75806612e-01 3.60757947e-01
 6.84993714e-02 3.34939450e-01 2.94122428e-01 3.97876650e-01
 3.10900837e-01 3.21501702e-01 1.77492633e-01 2.97423750e-01
 1.41708091e-01 2.22677067e-01 1.21933806e+00 2.34243298e+00
 1.92794487e-01 1.19136512e+00 2.08992928e-01 1.87897608e-01
 2.99226195e-01 1.76638827e-01 8.08700323e-02 5.49920857e-01
 6.83742464e-01 1.88691899e-01 4.83975932e-02 2.82537913e+00
 1.26849905e-01 2.17930228e-01 5.91462739e-02 1.06067210e-01
 2.32303798e-01 1.26849785e-01 1.98634893e-01 2.73318380e-01
 7.89640009e-01 1.03064999e-01 8.10853601e-01 6.02340758e-01
 7.17687905e-01 1.40614152e+00 5.16118646e-01 1.20632626e-01
 4.30222452e-01 3.47934097e-01 2.24890053e-01 1.03606597e-01
 1.96853191e-01 5.00181258e-01 2.11210787e-01 5.02396226e-02
 5.92505075e-02 6.77390039e-01 3.21076035e-01 5.63982069e-01
 2.32732266e-01 5.02377339e-02 5.68507254e-01 5.26288688e-01
 1.74480096e-01 7.74550661e-02 1.22584991e-01 5.70839904e-02
 5.32529056e-01 5.40530205e-01 1.61849409e-01 1.00524701e-01
 2.02277601e-01 6.75192028e-02 7.51726329e-01 5.28448939e-01
 1.90267429e-01 1.36939183e-01 5.96856438e-02 1.90257937e-01
 1.58857346e-01 1.90727040e-01 1.96855456e-01 3.39043260e-01
 5.36973849e-02 1.91326007e-01 1.06885326e+00 9.23310101e-01
 2.52410442e-01 5.70840202e-02 4.91494477e-01 4.85985219e-01
 5.17351739e-02 1.14108540e-01 2.32302457e-01 2.21511915e-01
 1.90225795e-01 6.23684943e-01 5.17351963e-02 1.22581527e-01
 1.94166109e-01 5.28437734e-01 2.36784980e-01 1.83849961e-01
 6.60113692e-01 2.25088522e-01 2.67006934e-01 5.73840812e-02
 7.27471784e-02 3.13785815e+00 2.11210579e-01 1.71654493e-01
 1.54770538e-01 1.23580791e-01 1.72182098e-01 1.72181159e-01
 9.67783108e-02 6.88164115e-01 4.97467443e-02 3.67412418e-01
 5.10744870e-01 1.38113469e-01 4.58037816e-02 1.77735776e-01
 9.48384255e-02 4.79542650e-02 1.79552868e-01 1.63596630e-01
 1.38833433e-01 6.59023747e-02 7.51873553e-01 1.08796850e-01
 1.14260399e+00 2.26406664e-01 5.21365225e-01 2.48060733e-01
 6.01004325e-02 5.17350212e-02 4.45808351e-01 2.31344312e-01
 2.49256074e-01 6.20692849e-01 1.89848319e-01 6.58845663e-01
 5.37489839e-02 2.18534604e-01 1.41570404e-01 1.76385775e-01
 1.40733421e-01 1.48749381e-01 1.34450004e-01 6.46212846e-02
 2.04488307e-01 1.96852908e-01 2.30273709e-01 6.59025386e-02
 3.49275857e-01 4.58037257e-02 5.76152168e-02 1.40733451e-01
 5.17352037e-02 1.97760731e-01 4.78392482e-01 7.87520707e-02
 2.09030852e-01 6.95332468e-01 6.32616162e-01 1.65335491e-01
 2.18246400e-01 1.96856245e-01 1.96853295e-01 1.65014371e-01
 1.25504434e-01 5.76152317e-02 5.17352447e-02 1.67132795e-01
 4.58808780e-01 1.35918841e-01 7.24284202e-02 2.25039631e-01
 7.16253221e-02 2.25444525e-01 1.20731935e-01 1.28712714e-01
 7.24284500e-02 1.10914513e-01 7.27471784e-02 7.62832984e-02
 2.30249912e-01 1.30126417e-01 1.25228897e-01 2.24342316e-01
 4.79712076e-02 3.99185494e-02 1.06549717e-01 1.72181383e-01
 1.37395039e-01 8.40196490e-01 1.46471158e-01 1.39111936e-01
 2.63515472e-01 4.51476015e-02 2.38201320e-01 2.12622380e+00
 2.38154963e-01 1.02977477e-01 3.64357263e-01 3.29420358e-01
 1.57144383e-01 2.53869027e-01 1.71473891e-01 1.72185197e-01
 4.81793880e-02 3.38337004e-01 9.67776105e-02 1.71979427e-01
 8.05759609e-01 5.26354760e-02 1.21484190e-01 2.09319368e-01
 2.00009003e-01 1.07194826e-01 7.40368187e-01 6.45284057e-01
 6.88164115e-01 5.16321898e-01 2.02528253e-01 9.61851329e-02
 6.33153766e-02 7.16251954e-02 9.10046995e-01 5.23744449e-02
 1.19727880e-01 1.73115760e-01 1.08805738e-01 7.70595551e-01
 1.32186726e-01 3.81805226e-02 1.22933783e-01 1.66131124e-01
 3.81801799e-02 3.81804854e-02 3.81804705e-02 1.53447375e-01
 3.17492969e-02 3.81805710e-02 3.81804071e-02 4.98170584e-01
 3.81804556e-02 4.82759103e-02 6.21665061e-01 1.47274494e-01
 1.73881978e-01 6.36392891e-01 1.35479107e-01 1.06535926e-01
 2.04458341e-01 6.45901412e-02 2.32904211e-01 1.22933909e-01
 5.97952008e-01 3.45423311e-01 4.34155092e-02 1.82604119e-01
 1.93740591e-01 1.93737924e-01 3.54277015e-01 1.08058564e-01
 3.81759964e-02 1.71474606e-01 3.81804742e-02 1.53448015e-01
 1.72851384e-01 6.05867058e-02 4.34158258e-02 4.34159525e-02
 3.82517651e-02 6.01407327e-02 4.34158519e-02 1.80009216e-01
 2.22237676e-01 1.65400788e-01 1.22932300e-01 9.91847515e-02
 2.48590156e-01 1.80762544e-01 3.81827578e-02 8.67675245e-02
 3.20593476e-01 1.64577425e-01 5.08808456e-02 4.79714870e-02
 3.10869180e-02 3.81804891e-02 5.14299832e-02 2.21447277e+00
 1.41567022e-01 4.99452688e-02 2.65712202e-01 1.56871229e-01
 1.22770213e-01 3.54541183e+00 3.80758457e-02 5.35105348e-01
 1.28475010e-01 8.18232596e-02 1.16351098e-01 1.47851214e-01
 1.77376479e-01 3.16676617e-01 2.12795600e-01 1.64582208e-01
 4.52492051e-02 6.76635206e-02 1.41857967e-01 3.81804593e-02
 1.22933120e-01 5.14199615e-01 4.98085655e-02 9.90373120e-02
 5.23089826e-01 1.72184527e-01 1.78764835e-01 6.76041961e-01
 1.71448395e-01 3.81799787e-02 4.08599168e-01 2.58260638e-01
 9.55237374e-02 3.68047863e-01 1.30388469e-01 1.30423009e-01
 1.30466208e-01 1.07111907e+00 2.91062817e-02 1.07710874e+00
 5.28786592e-02 2.15242252e-01 1.30411386e-01 2.91076712e-02
 8.80093873e-02 9.58730876e-02 1.91969261e-01 5.19502945e-02
 9.55231190e-02 5.47635496e-01 1.30437329e-01 9.55227688e-02
 2.91074440e-02 1.30415112e-01 1.30439132e-01 2.89236810e-02
 4.74432446e-02 1.30465358e-01 4.51444611e-02 1.29539177e-01
 5.40698655e-02 7.51147047e-02 7.60238245e-02 5.50390929e-02
 3.24117541e-01 9.18725505e-02 1.09916143e-01 1.80213615e-01
 6.57154381e-01 6.56129122e-01 1.57434464e-01 9.74461883e-02
 9.35341492e-02 1.30833998e-01 1.30467013e-01 1.30418986e-01
 5.28833829e-02 1.46017969e-01 3.19718957e-01 2.30772365e-02
 1.08096674e-01 7.68096745e-02 2.74230599e-01 2.90499907e-02
 3.65212113e-02 4.87382442e-01 4.61800605e-01 6.95430115e-02
 1.22138552e-01 6.39351904e-02 2.33408451e-01 2.94864476e-02
 6.74951077e-02 2.41326988e-02 2.94864308e-02 1.04165480e-01
 5.50944395e-02 5.59660718e-02 7.83819780e-02 1.48515150e-01
 9.56021398e-02 6.10864349e-02 5.84719181e-02 7.62231827e-01
 5.85997738e-02 6.10869788e-02 3.56101058e-02 1.16036482e-01
 5.56305051e-01 1.13649949e-01 3.56101133e-02 9.56052318e-02
 1.21328540e-01 3.68220121e-01 2.76166290e-01 7.62739256e-02
 1.16044991e-01 9.56020802e-02 2.53543425e-02 7.53189027e-02
 8.10915679e-02 5.19524515e-01 1.02812976e-01 6.95607215e-02
 3.48208219e-01 4.84568588e-02 2.94864308e-02 5.24534762e-01
 1.13216408e-01 3.70873392e-01 8.41972977e-02 2.53543667e-02
 1.11985333e-01 2.81479452e-02 6.53780252e-02 5.59763312e-02
 7.74328038e-02 1.26485014e+00 2.41327342e-02 7.53173605e-02
 2.39908382e-01 2.81416718e-02 2.39906698e-01 3.06564197e-02
 2.93055549e-02 6.04931593e-01 2.06320044e-02 6.39404237e-01
 1.08298063e-01 2.94864308e-02 6.13561630e-01 6.97054341e-02
 6.97086155e-02 3.65213491e-02 9.64113995e-02 8.39822665e-02
 2.06423886e-02 7.07771406e-02 1.67621389e-01 1.29888296e-01
 7.07754046e-02 7.67648071e-02 2.06327159e-02 1.40249535e-01
 2.93054711e-02 7.74343312e-02 1.35039017e-01 4.97694969e-01
 7.07629174e-02 1.55198365e-01 8.39822739e-02 2.41327304e-02
 2.41326783e-02 7.53168836e-02 7.74324909e-02 7.86418766e-02
 1.16209395e-01 1.35779127e-01 2.41325963e-02 1.22019641e-01
 2.41327100e-02 1.22019105e-01 1.05927520e-01 7.07718506e-02
 7.21509606e-02 2.74958348e+00 5.54469526e-01 2.32888833e-02
 8.41531634e-01 2.32889727e-02 2.32890453e-02 2.32889485e-02
 2.32889671e-02 2.32889410e-02 2.32889466e-02 2.32889634e-02
 7.50093162e-02 8.85987207e-02 1.11667030e-01 2.32887883e-02
 2.32889764e-02 2.32889578e-02 2.32889187e-02 2.32889671e-02
 2.32889690e-02 2.32889894e-02 2.32889242e-02 2.32889764e-02
 6.73088133e-02 2.32891347e-02 2.32889485e-02 3.72539043e-01
 2.32889410e-02 5.15814781e-01 1.47704154e-01 2.41327249e-02
 2.00533107e-01 1.74951047e-01 1.45854342e+00 1.45854342e+00
 1.47578821e-01 2.00533107e-01 2.41326746e-02 2.06328277e-02
 2.06324179e-02 2.41327081e-02 2.06325017e-02 7.81004503e-02
 8.61117095e-02 2.32942905e-02 7.67675266e-02 2.41327155e-02
 6.97191805e-02 2.41327118e-02 2.41328012e-02 1.05399996e-01
 2.41327118e-02 2.06328239e-02 2.41327118e-02 2.41326820e-02
 7.07770213e-02 2.06327550e-02 2.41326932e-02 2.06332467e-02
 2.41326690e-02 2.41327286e-02 2.41327081e-02 1.21567681e-01
 2.36998722e-01 6.53629676e-02 2.32889485e-02 1.18192799e-01
 1.31330043e-01 2.41327602e-02 2.06322297e-02 1.50778219e-01
 2.32885405e-02 8.19558799e-02 1.69164211e-01 2.12616585e-02
 2.41327118e-02 2.41327286e-02 1.15154341e-01 1.27330005e-01
 7.57814273e-02 2.41325535e-02 7.50092044e-02 3.44529934e-02
 2.06327848e-02 4.96311367e-01 2.32889690e-02 1.23529226e-01
 1.70396596e-01 2.32889261e-02 2.32875179e-02 7.50092193e-02
 3.44537906e-02 2.41327044e-02 3.22655678e-01 1.19728118e-01
 1.94419608e-01 1.27321050e-01 9.17962864e-02 9.14472863e-02
 9.14479569e-02 1.39257848e-01 5.31731024e-02 2.32889540e-02
 8.14128444e-02 1.17827334e-01 1.27344474e-01 7.43010193e-02
 7.04650655e-02 3.00703645e-02 2.64590122e-02 2.64589954e-02
 2.64589712e-02 2.64589880e-02 2.64590252e-02 7.87777230e-02
 1.68318436e-01 2.64590029e-02 2.64593232e-02 2.32889540e-02
 3.95902321e-02 2.32889354e-02 9.14480016e-02 1.21270470e-01
 2.30727851e-01 3.17410417e-02 9.14471895e-02 2.22391680e-01
 6.73083961e-02 5.22225127e-02 6.73082843e-02 2.32889615e-02
 9.14470851e-02 2.70604324e-02 2.13521738e-02 2.13521048e-02
 2.64590196e-02 2.70604994e-02 1.17567018e-01 3.42054032e-02
 9.31638405e-02 2.32889634e-02 2.64589898e-02 4.75010276e-02
 2.13521440e-02 2.94816867e-02 3.00703999e-02 3.61002758e-02
 7.87776634e-02 4.19648439e-01 3.61002088e-02 5.11529505e-01
 1.06237061e-01 3.00703384e-02 1.00183509e-01 2.88005751e-02
 3.57927456e-02 5.88257201e-02 1.09581329e-01 3.35655957e-02
 9.34501514e-02 3.00703999e-02 3.00704148e-02 3.00704017e-02
 2.85166539e-02 3.00704017e-02 3.00703999e-02 3.57927158e-02
 3.00703775e-02 3.00703999e-02 3.00704632e-02 1.26530915e-01
 3.41866426e-02 2.63426036e-01 2.77003914e-01 1.24656431e-01
 1.18383385e-01 3.90377529e-02 1.99064702e-01 1.13641465e+00
 4.49135788e-02 4.27769944e-02 7.42405280e-02 1.83859542e-01
 1.83867425e-01 3.57927606e-02 5.21684110e-01 3.25688243e-01
 4.49246764e-02 4.46027890e-02 1.36785358e-01 5.19306779e-01
 5.49929179e-02 5.49929217e-02 5.49929552e-02 5.94034232e-02
 6.04818054e-02 6.08308554e-01 2.67242640e-01 3.00045341e-01
 8.95026922e-02 6.05673008e-02 1.41026646e-01 4.46028076e-02
 1.44379273e-01 1.91472158e-01 4.59464937e-02 1.97115734e-01
 4.49247137e-02 3.24239612e-01 4.46028076e-02 1.91472694e-01
 6.05668463e-02 6.94894731e-01 5.49929217e-02 5.94036020e-02
 4.59469780e-02 1.42192751e-01 2.08375290e-01 5.94033636e-02
 5.94034009e-02 5.94033003e-02 1.68969259e-01 1.99503660e-01
 2.56552362e+00 5.49929217e-02 2.38498241e-01 5.94034977e-02
 1.95753798e-01 1.98944584e-01 1.29755986e+00 1.98931962e-01
 5.94033860e-02 7.78246075e-02 2.22855061e-01 5.77625670e-02
 3.70991528e-01 1.97987080e-01 2.92550731e+00 1.22944914e-01
 2.90337652e-01 1.98941723e-01 2.36123845e-01 2.38386139e-01
 1.38510928e-01 3.00281227e-01 2.63737470e-01 7.47960359e-02
 7.47989267e-02 3.00343961e-01 3.69401753e-01 7.78246149e-02
 1.98942691e-01 1.38510928e-01 1.98942930e-01 9.62425247e-02
 9.62424576e-02 9.62424800e-02 7.91217014e-02 4.03167099e-01
 9.62424502e-02 9.62425321e-02 1.04156502e-01 2.43873030e-01
 9.62424651e-02 9.62425098e-02 1.00020476e-01 2.87724435e-01
 5.07402956e-01 3.68404061e-01 9.62424576e-02 3.50868225e-01
 2.43873283e-01 9.62424949e-02 1.25832975e-01 2.26417601e-01
 1.17182620e-01 1.04156472e-01 6.96387589e-01 2.26418093e-01
 9.62424427e-02 2.26417631e-01 2.33394712e-01 4.53172505e-01
 3.37980896e-01 9.62424502e-02 4.68486726e-01 2.33389705e-01
 2.33389676e-01 2.87725508e-01 1.30141303e-01 2.33388364e-01
 1.25832900e-01 1.70119718e-01 1.37440339e-01 3.18935007e-01
 2.70686954e-01 3.18935364e-01 4.65115696e-01 1.25832900e-01
 2.70686954e-01 1.70651853e-01 1.70651779e-01 1.44394636e+00
 1.70651808e-01 2.50504524e-01 1.30150482e-01 3.30866128e-01
 2.90740967e-01 1.37440428e-01 2.90792465e-01 5.80631673e-01
 1.25832975e-01 8.57232928e-01 1.70651838e-01 2.04313770e-01
 1.70119703e-01 1.70651928e-01 5.46233773e-01 1.37440369e-01
 2.04313770e-01 1.37440354e-01]
2025-06-02 16:00:56,440 - DEBUG - Edge reconstruction errors: [1.2639682  1.2631848  0.85908175 ... 0.1590631  1.3594553  0.1590634 ]
2025-06-02 16:00:56,442 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160056_update_36.json
2025-06-02 16:00:56,442 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:00:56,451 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160056_update_36.pth and as latest_checkpoint.pth
2025-06-02 16:00:56,451 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870175.dot): 0.1410
2025-06-02 16:00:56,451 - WARNING - Detected 6 anomalous nodes (reconstruction-based):
2025-06-02 16:00:56,451 - WARNING -   Node ID: 192.168.239.101, Recon Error: 4.6153, MLP Score: 0.4398
2025-06-02 16:00:56,451 - WARNING -   Node ID: 192.168.27.13, Recon Error: 17.5261, MLP Score: 0.4963
2025-06-02 16:00:56,451 - WARNING -   Node ID: 192.168.27.12, Recon Error: 17.1606, MLP Score: 0.4928
2025-06-02 16:00:56,452 - WARNING -   Node ID: 192.168.27.10, Recon Error: 22.1967, MLP Score: 0.4917
2025-06-02 16:00:56,452 - WARNING -   Node ID: 192.168.209.130, Recon Error: 8.0565, MLP Score: 0.4399
2025-06-02 16:00:56,452 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 16:00:56,452 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.6955, MLP Score: 0.4762
2025-06-02 16:00:56,452 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 14.6481, MLP Score: 0.5075
2025-06-02 16:00:56,452 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.1083, MLP Score: 0.4747
2025-06-02 16:00:56,452 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.3083, MLP Score: 0.4635
2025-06-02 16:00:56,452 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 3.8289, MLP Score: 0.6296
2025-06-02 16:00:56,458 - DEBUG - Embedding standard deviations before t-SNE: [1.9589922e+00 1.1861489e+00 4.0720233e-01 9.7998667e-01 9.4285703e-01
 0.0000000e+00 2.3371866e+00 0.0000000e+00 1.4942927e+00 1.1308784e+00
 2.7997005e+00 5.4262769e-03 0.0000000e+00 2.1891110e+00 0.0000000e+00
 0.0000000e+00 1.2544222e+00 0.0000000e+00 0.0000000e+00 0.0000000e+00
 0.0000000e+00 9.4005799e-01 2.6699232e-03 8.2011354e-01 0.0000000e+00
 1.6995357e+00 1.4825559e-01 8.0512905e-01 7.8190613e-01 1.4148452e+00
 1.0553904e+00 3.5639536e-01]
2025-06-02 16:00:57,401 - INFO - Embeddings visualization saved to vis/embeddings_36_updates_20250602_160056.png
2025-06-02 16:00:57,401 - INFO - Performing visualization of node and edge features.
2025-06-02 16:00:57,403 - INFO - Starting visualization of node features.
2025-06-02 16:00:57,403 - INFO - Graph has 866 nodes and 30 features.
2025-06-02 16:00:57,403 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 16:00:57,403 - INFO - Calculating feature statistics:
2025-06-02 16:00:57,403 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,403 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,403 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(-3.5239697e-08), 'std': np.float32(1.0), 'min': np.float32(-2.0430336), 'max': np.float32(2.4478908)}
2025-06-02 16:00:57,403 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(-7.0479395e-08), 'std': np.float32(1.0), 'min': np.float32(-2.36622), 'max': np.float32(2.1294224)}
2025-06-02 16:00:57,403 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,403 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,403 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,404 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45955282), 'max': np.float32(2.1760283)}
2025-06-02 16:00:57,404 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1335609), 'max': np.float32(0.88217574)}
2025-06-02 16:00:57,404 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-9.6710415), 'max': np.float32(0.106151916)}
2025-06-02 16:00:57,404 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6916394), 'max': np.float32(1.5956728)}
2025-06-02 16:00:57,404 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 19, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-1.5623697), 'max': np.float32(2.8000467)}
2025-06-02 16:00:57,404 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.3048499), 'std': np.float32(0.9985669), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 16:00:57,404 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9584296), 'std': np.float32(0.28532922), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 16:00:57,404 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:00:57,404 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.400693), 'std': np.float32(0.57060355), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 16:00:57,404 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(1.7619849e-08), 'std': np.float32(1.0), 'min': np.float32(-0.106151916), 'max': np.float32(9.6710415)}
2025-06-02 16:00:57,404 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(3.3418014), 'std': np.float32(2.995151), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 16:00:57,404 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8198614), 'std': np.float32(2.8945873), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:00:57,404 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6073904), 'std': np.float32(1.4946064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:00:57,404 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.1443418), 'std': np.float32(0.3674977), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:00:57,405 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.9919167), 'std': np.float32(0.23773229), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:00:57,405 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.982233e-08), 'std': np.float32(1.0), 'min': np.float32(-0.133326), 'max': np.float32(15.61126)}
2025-06-02 16:00:57,405 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.4227292e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.14569288), 'max': np.float32(6.8637533)}
2025-06-02 16:00:57,405 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,405 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,405 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,405 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:00:57,405 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.809924e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.9807018), 'max': np.float32(8.856608)}
2025-06-02 16:00:57,405 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.6429774e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.0817144), 'max': np.float32(4.494266)}
2025-06-02 16:00:57,416 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a80cdc10>
2025-06-02 16:00:57,546 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 16:00:57,812 - DEBUG - Plotted ranges of node feature values.
2025-06-02 16:00:57,842 - DEBUG - Plotted sparsity of node features.
2025-06-02 16:00:59,152 - INFO - Node feature visualization saved to vis/node_features_20250602_160057.png
2025-06-02 16:00:59,152 - INFO - Finished visualization of node features.
2025-06-02 16:00:59,152 - INFO - Performing additional feature analysis:
2025-06-02 16:00:59,152 - INFO - - Maximum correlation between different features: nan
2025-06-02 16:00:59,153 - INFO - Starting visualization of edge features.
2025-06-02 16:00:59,153 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 16:00:59,153 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:00:59,153 - INFO - Calculating edge feature statistics:
2025-06-02 16:00:59,154 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 16:00:59,154 - INFO - - count: {'name': 'count', 'unique': 18, 'mean': np.float32(8.165043), 'std': np.float32(1.0877768), 'min': np.float32(0.0), 'max': np.float32(17.0)}
2025-06-02 16:00:59,154 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4117966), 'std': np.float32(0.5051803), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:00:59,154 - INFO - - protocol: {'name': 'protocol', 'unique': 7, 'mean': np.float32(4.9886365), 'std': np.float32(1.777499), 'min': np.float32(0.0), 'max': np.float32(6.0)}
2025-06-02 16:00:59,154 - INFO - - service: {'name': 'service', 'unique': 32, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.036982697), 'max': np.float32(35.559486)}
2025-06-02 16:00:59,154 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1235, 'mean': np.float32(2.0642301e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.057673346), 'max': np.float32(34.11734)}
2025-06-02 16:00:59,154 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1316, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.05346426), 'max': np.float32(34.903465)}
2025-06-02 16:00:59,154 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 421, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.045245998), 'max': np.float32(35.391674)}
2025-06-02 16:00:59,154 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1284, 'mean': np.float32(-2.0642301e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.08053714), 'max': np.float32(28.465456)}
2025-06-02 16:00:59,154 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1305, 'mean': np.float32(2.0642301e-09), 'std': np.float32(1.0), 'min': np.float32(-0.081029944), 'max': np.float32(27.663824)}
2025-06-02 16:00:59,154 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 468, 'mean': np.float32(2.0642301e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05446046), 'max': np.float32(34.686768)}
2025-06-02 16:00:59,165 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1ebd100>
2025-06-02 16:00:59,246 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 16:00:59,256 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a130f110>
2025-06-02 16:00:59,338 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 16:00:59,560 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 16:00:59,729 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 16:00:59,746 - DEBUG - Plotted sparsity of edge features.
2025-06-02 16:00:59,752 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 16:01:01,049 - INFO - Edge feature visualization saved to vis/edge_features_20250602_160059.png
2025-06-02 16:01:01,050 - INFO - Finished visualization of edge features.
2025-06-02 16:01:01,050 - INFO - Performing additional edge feature analysis:
2025-06-02 16:01:01,050 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 16:01:01,051 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 16:01:01,051 - INFO - Graph has 1848 edges and 10 edge features.
2025-06-02 16:01:01,051 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:01:01,362 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_160101_summary.png
2025-06-02 16:01:01,616 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_160101_pca_3d.png
2025-06-02 16:01:01,780 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_160101_pca_variance.png
2025-06-02 16:01:01,780 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 16:01:01,780 - INFO - 
--- Processing file: nw_graph_encoded_1748870205.dot (Timestamp: 2025-06-02 15:16:45) ---
2025-06-02 16:01:01,780 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 16:01:01,780 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 16:01:01,795 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 16:01:01,812 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 16:01:01,812 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 16:01:01,812 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870205.dot
2025-06-02 16:01:01,827 - INFO - Parsed 894 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 16:01:01,844 - INFO - Parsed 1887 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870205.dot'.
2025-06-02 16:01:01,845 - INFO - Processing node updates/additions.
2025-06-02 16:01:01,851 - INFO - Processing edge updates/additions.
2025-06-02 16:01:01,863 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:01:01,865 - INFO - Finished updating NetworkX graph.
2025-06-02 16:01:01,865 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:01:01,867 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:01:01,882 - DEBUG - Initial node features tensor shape: torch.Size([894, 30])
2025-06-02 16:01:01,888 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:01:01,894 - DEBUG - Node features tensor shape after scaling: torch.Size([894, 30])
2025-06-02 16:01:01,900 - DEBUG - Edge index tensor shape: torch.Size([2, 1887])
2025-06-02 16:01:01,903 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:01:01,912 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:01:01,914 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:01:01,916 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:01:01,918 - DEBUG - Shape of encoded categorical edge features: torch.Size([1887, 3])
2025-06-02 16:01:01,920 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:01:01,920 - DEBUG - Shape of scaled numerical edge features: torch.Size([1887, 7])
2025-06-02 16:01:01,920 - DEBUG - Final edge attributes tensor shape: torch.Size([1887, 10])
2025-06-02 16:01:01,920 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:01:01,924 - INFO - Performing online update...
2025-06-02 16:01:01,925 - INFO - Starting online update for 50 steps.
2025-06-02 16:01:01,926 - DEBUG - Updated RunningStats: new_mean=0.9438908178123014, new_var=21000000000162.062, new_n=2130
2025-06-02 16:01:01,926 - DEBUG - Updated RunningStats: new_mean=0.9410268868966298, new_var=21300000000017.93, new_n=2160
2025-06-02 16:01:01,926 - DEBUG - Updated RunningStats: new_mean=1.0949484588257372, new_var=7000000000094.541, new_n=710
2025-06-02 16:01:01,926 - DEBUG - Updated RunningStats: new_mean=1.0947524810695328, new_var=7100000000001.568, new_n=720
2025-06-02 16:01:01,926 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:01:01,926 - DEBUG - Online update step: 1/50
2025-06-02 16:01:01,930 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:02,038 - DEBUG - Node anomaly scores shape: torch.Size([16074, 1])
2025-06-02 16:01:02,050 - DEBUG - Edge anomaly scores shape: torch.Size([33211, 1])
2025-06-02 16:01:02,054 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:02,309 - DEBUG - Step 1: Loss=0.8312
2025-06-02 16:01:02,310 - DEBUG - Online update step: 2/50
2025-06-02 16:01:02,313 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:02,407 - DEBUG - Node anomaly scores shape: torch.Size([16246, 1])
2025-06-02 16:01:02,414 - DEBUG - Edge anomaly scores shape: torch.Size([33594, 1])
2025-06-02 16:01:02,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:02,613 - DEBUG - Step 2: Loss=0.8298
2025-06-02 16:01:02,613 - DEBUG - Online update step: 3/50
2025-06-02 16:01:02,616 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:02,704 - DEBUG - Node anomaly scores shape: torch.Size([15021, 1])
2025-06-02 16:01:02,708 - DEBUG - Edge anomaly scores shape: torch.Size([30807, 1])
2025-06-02 16:01:02,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:02,907 - DEBUG - Step 3: Loss=0.8295
2025-06-02 16:01:02,907 - DEBUG - Online update step: 4/50
2025-06-02 16:01:02,910 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:03,002 - DEBUG - Node anomaly scores shape: torch.Size([15753, 1])
2025-06-02 16:01:03,007 - DEBUG - Edge anomaly scores shape: torch.Size([32361, 1])
2025-06-02 16:01:03,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:03,198 - DEBUG - Step 4: Loss=0.8264
2025-06-02 16:01:03,198 - DEBUG - Online update step: 5/50
2025-06-02 16:01:03,201 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:03,295 - DEBUG - Node anomaly scores shape: torch.Size([15808, 1])
2025-06-02 16:01:03,299 - DEBUG - Edge anomaly scores shape: torch.Size([32595, 1])
2025-06-02 16:01:03,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:03,488 - DEBUG - Step 5: Loss=0.8247
2025-06-02 16:01:03,489 - DEBUG - Online update step: 6/50
2025-06-02 16:01:03,496 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:03,579 - DEBUG - Node anomaly scores shape: torch.Size([14979, 1])
2025-06-02 16:01:03,583 - DEBUG - Edge anomaly scores shape: torch.Size([30687, 1])
2025-06-02 16:01:03,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:03,758 - DEBUG - Step 6: Loss=0.8275
2025-06-02 16:01:03,758 - DEBUG - Online update step: 7/50
2025-06-02 16:01:03,761 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:03,856 - DEBUG - Node anomaly scores shape: torch.Size([15698, 1])
2025-06-02 16:01:03,861 - DEBUG - Edge anomaly scores shape: torch.Size([32236, 1])
2025-06-02 16:01:03,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:04,071 - DEBUG - Step 7: Loss=0.8250
2025-06-02 16:01:04,072 - DEBUG - Online update step: 8/50
2025-06-02 16:01:04,075 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:04,158 - DEBUG - Node anomaly scores shape: torch.Size([16232, 1])
2025-06-02 16:01:04,162 - DEBUG - Edge anomaly scores shape: torch.Size([33481, 1])
2025-06-02 16:01:04,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:04,378 - DEBUG - Step 8: Loss=0.8202
2025-06-02 16:01:04,379 - DEBUG - Online update step: 9/50
2025-06-02 16:01:04,382 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:04,464 - DEBUG - Node anomaly scores shape: torch.Size([15191, 1])
2025-06-02 16:01:04,469 - DEBUG - Edge anomaly scores shape: torch.Size([31119, 1])
2025-06-02 16:01:04,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:04,725 - DEBUG - Step 9: Loss=0.8199
2025-06-02 16:01:04,725 - DEBUG - Online update step: 10/50
2025-06-02 16:01:04,730 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:04,809 - DEBUG - Node anomaly scores shape: torch.Size([14753, 1])
2025-06-02 16:01:04,812 - DEBUG - Edge anomaly scores shape: torch.Size([30237, 1])
2025-06-02 16:01:04,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:04,964 - DEBUG - Step 10: Loss=0.8197
2025-06-02 16:01:04,965 - DEBUG - Online update step: 11/50
2025-06-02 16:01:04,969 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:05,049 - DEBUG - Node anomaly scores shape: torch.Size([15089, 1])
2025-06-02 16:01:05,053 - DEBUG - Edge anomaly scores shape: torch.Size([30939, 1])
2025-06-02 16:01:05,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:05,184 - DEBUG - Step 11: Loss=0.8190
2025-06-02 16:01:05,184 - DEBUG - Online update step: 12/50
2025-06-02 16:01:05,189 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:05,322 - DEBUG - Node anomaly scores shape: torch.Size([15970, 1])
2025-06-02 16:01:05,327 - DEBUG - Edge anomaly scores shape: torch.Size([32927, 1])
2025-06-02 16:01:05,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:05,487 - DEBUG - Step 12: Loss=0.8181
2025-06-02 16:01:05,488 - DEBUG - Online update step: 13/50
2025-06-02 16:01:05,493 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:05,607 - DEBUG - Node anomaly scores shape: torch.Size([16273, 1])
2025-06-02 16:01:05,611 - DEBUG - Edge anomaly scores shape: torch.Size([33679, 1])
2025-06-02 16:01:05,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:05,791 - DEBUG - Step 13: Loss=0.8152
2025-06-02 16:01:05,792 - DEBUG - Online update step: 14/50
2025-06-02 16:01:05,798 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:05,951 - DEBUG - Node anomaly scores shape: torch.Size([16361, 1])
2025-06-02 16:01:05,955 - DEBUG - Edge anomaly scores shape: torch.Size([33802, 1])
2025-06-02 16:01:05,957 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:06,110 - DEBUG - Step 14: Loss=0.8101
2025-06-02 16:01:06,111 - DEBUG - Online update step: 15/50
2025-06-02 16:01:06,115 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:06,248 - DEBUG - Node anomaly scores shape: torch.Size([15965, 1])
2025-06-02 16:01:06,252 - DEBUG - Edge anomaly scores shape: torch.Size([32966, 1])
2025-06-02 16:01:06,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:06,399 - DEBUG - Step 15: Loss=0.8082
2025-06-02 16:01:06,399 - DEBUG - Online update step: 16/50
2025-06-02 16:01:06,404 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:06,527 - DEBUG - Node anomaly scores shape: torch.Size([15522, 1])
2025-06-02 16:01:06,531 - DEBUG - Edge anomaly scores shape: torch.Size([31991, 1])
2025-06-02 16:01:06,533 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:06,679 - DEBUG - Step 16: Loss=0.8085
2025-06-02 16:01:06,679 - DEBUG - Online update step: 17/50
2025-06-02 16:01:06,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:06,813 - DEBUG - Node anomaly scores shape: torch.Size([15379, 1])
2025-06-02 16:01:06,818 - DEBUG - Edge anomaly scores shape: torch.Size([31532, 1])
2025-06-02 16:01:06,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:06,975 - DEBUG - Step 17: Loss=0.8107
2025-06-02 16:01:06,975 - DEBUG - Online update step: 18/50
2025-06-02 16:01:06,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:07,120 - DEBUG - Node anomaly scores shape: torch.Size([15677, 1])
2025-06-02 16:01:07,124 - DEBUG - Edge anomaly scores shape: torch.Size([32298, 1])
2025-06-02 16:01:07,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:07,255 - DEBUG - Step 18: Loss=0.8074
2025-06-02 16:01:07,255 - DEBUG - Online update step: 19/50
2025-06-02 16:01:07,258 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:07,402 - DEBUG - Node anomaly scores shape: torch.Size([15969, 1])
2025-06-02 16:01:07,406 - DEBUG - Edge anomaly scores shape: torch.Size([32960, 1])
2025-06-02 16:01:07,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:07,562 - DEBUG - Step 19: Loss=0.8024
2025-06-02 16:01:07,562 - DEBUG - Online update step: 20/50
2025-06-02 16:01:07,565 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:07,683 - DEBUG - Node anomaly scores shape: torch.Size([15346, 1])
2025-06-02 16:01:07,688 - DEBUG - Edge anomaly scores shape: torch.Size([31458, 1])
2025-06-02 16:01:07,689 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:07,867 - DEBUG - Step 20: Loss=0.8017
2025-06-02 16:01:07,867 - DEBUG - Online update step: 21/50
2025-06-02 16:01:07,873 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:08,007 - DEBUG - Node anomaly scores shape: torch.Size([16469, 1])
2025-06-02 16:01:08,012 - DEBUG - Edge anomaly scores shape: torch.Size([34038, 1])
2025-06-02 16:01:08,013 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:08,175 - DEBUG - Step 21: Loss=0.7996
2025-06-02 16:01:08,175 - DEBUG - Online update step: 22/50
2025-06-02 16:01:08,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:08,332 - DEBUG - Node anomaly scores shape: torch.Size([16561, 1])
2025-06-02 16:01:08,336 - DEBUG - Edge anomaly scores shape: torch.Size([34241, 1])
2025-06-02 16:01:08,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:08,491 - DEBUG - Step 22: Loss=0.7998
2025-06-02 16:01:08,491 - DEBUG - Online update step: 23/50
2025-06-02 16:01:08,494 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:08,617 - DEBUG - Node anomaly scores shape: torch.Size([15363, 1])
2025-06-02 16:01:08,622 - DEBUG - Edge anomaly scores shape: torch.Size([31690, 1])
2025-06-02 16:01:08,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:08,784 - DEBUG - Step 23: Loss=0.7970
2025-06-02 16:01:08,784 - DEBUG - Online update step: 24/50
2025-06-02 16:01:08,790 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:08,915 - DEBUG - Node anomaly scores shape: torch.Size([15508, 1])
2025-06-02 16:01:08,919 - DEBUG - Edge anomaly scores shape: torch.Size([31860, 1])
2025-06-02 16:01:08,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:09,089 - DEBUG - Step 24: Loss=0.7932
2025-06-02 16:01:09,089 - DEBUG - Online update step: 25/50
2025-06-02 16:01:09,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:09,240 - DEBUG - Node anomaly scores shape: torch.Size([14981, 1])
2025-06-02 16:01:09,243 - DEBUG - Edge anomaly scores shape: torch.Size([30714, 1])
2025-06-02 16:01:09,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:09,387 - DEBUG - Step 25: Loss=0.7923
2025-06-02 16:01:09,387 - DEBUG - Online update step: 26/50
2025-06-02 16:01:09,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:09,585 - DEBUG - Node anomaly scores shape: torch.Size([16065, 1])
2025-06-02 16:01:09,589 - DEBUG - Edge anomaly scores shape: torch.Size([33194, 1])
2025-06-02 16:01:09,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:09,752 - DEBUG - Step 26: Loss=0.7897
2025-06-02 16:01:09,752 - DEBUG - Online update step: 27/50
2025-06-02 16:01:09,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:09,924 - DEBUG - Node anomaly scores shape: torch.Size([15674, 1])
2025-06-02 16:01:09,928 - DEBUG - Edge anomaly scores shape: torch.Size([32227, 1])
2025-06-02 16:01:09,929 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:10,097 - DEBUG - Step 27: Loss=0.7892
2025-06-02 16:01:10,097 - DEBUG - Online update step: 28/50
2025-06-02 16:01:10,102 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:10,239 - DEBUG - Node anomaly scores shape: torch.Size([15975, 1])
2025-06-02 16:01:10,242 - DEBUG - Edge anomaly scores shape: torch.Size([32844, 1])
2025-06-02 16:01:10,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:10,387 - DEBUG - Step 28: Loss=0.7845
2025-06-02 16:01:10,387 - DEBUG - Online update step: 29/50
2025-06-02 16:01:10,390 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:10,531 - DEBUG - Node anomaly scores shape: torch.Size([15718, 1])
2025-06-02 16:01:10,535 - DEBUG - Edge anomaly scores shape: torch.Size([32321, 1])
2025-06-02 16:01:10,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:10,710 - DEBUG - Step 29: Loss=0.7810
2025-06-02 16:01:10,710 - DEBUG - Online update step: 30/50
2025-06-02 16:01:10,713 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:10,839 - DEBUG - Node anomaly scores shape: torch.Size([15271, 1])
2025-06-02 16:01:10,843 - DEBUG - Edge anomaly scores shape: torch.Size([31423, 1])
2025-06-02 16:01:10,843 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:10,985 - DEBUG - Step 30: Loss=0.7787
2025-06-02 16:01:10,986 - DEBUG - Online update step: 31/50
2025-06-02 16:01:10,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:11,116 - DEBUG - Node anomaly scores shape: torch.Size([16148, 1])
2025-06-02 16:01:11,124 - DEBUG - Edge anomaly scores shape: torch.Size([33430, 1])
2025-06-02 16:01:11,126 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:11,321 - DEBUG - Step 31: Loss=0.7752
2025-06-02 16:01:11,322 - DEBUG - Online update step: 32/50
2025-06-02 16:01:11,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:11,462 - DEBUG - Node anomaly scores shape: torch.Size([16215, 1])
2025-06-02 16:01:11,466 - DEBUG - Edge anomaly scores shape: torch.Size([33524, 1])
2025-06-02 16:01:11,467 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:11,683 - DEBUG - Step 32: Loss=0.7725
2025-06-02 16:01:11,684 - DEBUG - Online update step: 33/50
2025-06-02 16:01:11,687 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:11,770 - DEBUG - Node anomaly scores shape: torch.Size([16156, 1])
2025-06-02 16:01:11,775 - DEBUG - Edge anomaly scores shape: torch.Size([33393, 1])
2025-06-02 16:01:11,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:11,989 - DEBUG - Step 33: Loss=0.7697
2025-06-02 16:01:11,989 - DEBUG - Online update step: 34/50
2025-06-02 16:01:11,992 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:12,077 - DEBUG - Node anomaly scores shape: torch.Size([16219, 1])
2025-06-02 16:01:12,081 - DEBUG - Edge anomaly scores shape: torch.Size([33347, 1])
2025-06-02 16:01:12,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:12,291 - DEBUG - Step 34: Loss=0.7682
2025-06-02 16:01:12,292 - DEBUG - Online update step: 35/50
2025-06-02 16:01:12,299 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:12,395 - DEBUG - Node anomaly scores shape: torch.Size([15704, 1])
2025-06-02 16:01:12,400 - DEBUG - Edge anomaly scores shape: torch.Size([32296, 1])
2025-06-02 16:01:12,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:12,627 - DEBUG - Step 35: Loss=0.7681
2025-06-02 16:01:12,627 - DEBUG - Online update step: 36/50
2025-06-02 16:01:12,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:12,729 - DEBUG - Node anomaly scores shape: torch.Size([16957, 1])
2025-06-02 16:01:12,734 - DEBUG - Edge anomaly scores shape: torch.Size([35124, 1])
2025-06-02 16:01:12,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:12,986 - DEBUG - Step 36: Loss=0.7585
2025-06-02 16:01:12,986 - DEBUG - Online update step: 37/50
2025-06-02 16:01:12,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:13,064 - DEBUG - Node anomaly scores shape: torch.Size([15614, 1])
2025-06-02 16:01:13,069 - DEBUG - Edge anomaly scores shape: torch.Size([32159, 1])
2025-06-02 16:01:13,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:13,271 - DEBUG - Step 37: Loss=0.7568
2025-06-02 16:01:13,271 - DEBUG - Online update step: 38/50
2025-06-02 16:01:13,274 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:13,346 - DEBUG - Node anomaly scores shape: torch.Size([14920, 1])
2025-06-02 16:01:13,351 - DEBUG - Edge anomaly scores shape: torch.Size([30542, 1])
2025-06-02 16:01:13,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:13,565 - DEBUG - Step 38: Loss=0.7553
2025-06-02 16:01:13,565 - DEBUG - Online update step: 39/50
2025-06-02 16:01:13,568 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:13,657 - DEBUG - Node anomaly scores shape: torch.Size([16170, 1])
2025-06-02 16:01:13,662 - DEBUG - Edge anomaly scores shape: torch.Size([33217, 1])
2025-06-02 16:01:13,663 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:13,904 - DEBUG - Step 39: Loss=0.7494
2025-06-02 16:01:13,904 - DEBUG - Online update step: 40/50
2025-06-02 16:01:13,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:13,998 - DEBUG - Node anomaly scores shape: torch.Size([15571, 1])
2025-06-02 16:01:14,002 - DEBUG - Edge anomaly scores shape: torch.Size([32004, 1])
2025-06-02 16:01:14,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:14,231 - DEBUG - Step 40: Loss=0.7490
2025-06-02 16:01:14,231 - DEBUG - Online update step: 41/50
2025-06-02 16:01:14,235 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:14,322 - DEBUG - Node anomaly scores shape: torch.Size([16252, 1])
2025-06-02 16:01:14,329 - DEBUG - Edge anomaly scores shape: torch.Size([33563, 1])
2025-06-02 16:01:14,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:14,527 - DEBUG - Step 41: Loss=0.7441
2025-06-02 16:01:14,527 - DEBUG - Online update step: 42/50
2025-06-02 16:01:14,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:14,617 - DEBUG - Node anomaly scores shape: torch.Size([15171, 1])
2025-06-02 16:01:14,623 - DEBUG - Edge anomaly scores shape: torch.Size([31133, 1])
2025-06-02 16:01:14,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:14,839 - DEBUG - Step 42: Loss=0.7396
2025-06-02 16:01:14,839 - DEBUG - Online update step: 43/50
2025-06-02 16:01:14,842 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:14,926 - DEBUG - Node anomaly scores shape: torch.Size([15496, 1])
2025-06-02 16:01:14,930 - DEBUG - Edge anomaly scores shape: torch.Size([31805, 1])
2025-06-02 16:01:14,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:15,151 - DEBUG - Step 43: Loss=0.7371
2025-06-02 16:01:15,152 - DEBUG - Online update step: 44/50
2025-06-02 16:01:15,155 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:15,271 - DEBUG - Node anomaly scores shape: torch.Size([15892, 1])
2025-06-02 16:01:15,278 - DEBUG - Edge anomaly scores shape: torch.Size([32758, 1])
2025-06-02 16:01:15,279 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:15,528 - DEBUG - Step 44: Loss=0.7356
2025-06-02 16:01:15,529 - DEBUG - Online update step: 45/50
2025-06-02 16:01:15,532 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:15,623 - DEBUG - Node anomaly scores shape: torch.Size([14956, 1])
2025-06-02 16:01:15,629 - DEBUG - Edge anomaly scores shape: torch.Size([30718, 1])
2025-06-02 16:01:15,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:15,890 - DEBUG - Step 45: Loss=0.7333
2025-06-02 16:01:15,890 - DEBUG - Online update step: 46/50
2025-06-02 16:01:15,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:16,009 - DEBUG - Node anomaly scores shape: torch.Size([15337, 1])
2025-06-02 16:01:16,017 - DEBUG - Edge anomaly scores shape: torch.Size([31482, 1])
2025-06-02 16:01:16,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:16,230 - DEBUG - Step 46: Loss=0.7281
2025-06-02 16:01:16,231 - DEBUG - Online update step: 47/50
2025-06-02 16:01:16,234 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:16,335 - DEBUG - Node anomaly scores shape: torch.Size([15178, 1])
2025-06-02 16:01:16,339 - DEBUG - Edge anomaly scores shape: torch.Size([31262, 1])
2025-06-02 16:01:16,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:16,519 - DEBUG - Step 47: Loss=0.7266
2025-06-02 16:01:16,520 - DEBUG - Online update step: 48/50
2025-06-02 16:01:16,523 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:16,608 - DEBUG - Node anomaly scores shape: torch.Size([15702, 1])
2025-06-02 16:01:16,612 - DEBUG - Edge anomaly scores shape: torch.Size([32263, 1])
2025-06-02 16:01:16,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:16,808 - DEBUG - Step 48: Loss=0.7224
2025-06-02 16:01:16,808 - DEBUG - Online update step: 49/50
2025-06-02 16:01:16,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:16,936 - DEBUG - Node anomaly scores shape: torch.Size([16695, 1])
2025-06-02 16:01:16,941 - DEBUG - Edge anomaly scores shape: torch.Size([34493, 1])
2025-06-02 16:01:16,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:17,170 - DEBUG - Step 49: Loss=0.7184
2025-06-02 16:01:17,171 - DEBUG - Online update step: 50/50
2025-06-02 16:01:17,174 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:17,258 - DEBUG - Node anomaly scores shape: torch.Size([15077, 1])
2025-06-02 16:01:17,265 - DEBUG - Edge anomaly scores shape: torch.Size([30898, 1])
2025-06-02 16:01:17,266 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:17,468 - DEBUG - Step 50: Loss=0.7203
2025-06-02 16:01:17,469 - INFO - Online update finished. Average loss: 0.7838, Learning rate: 0.001000
2025-06-02 16:01:17,469 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], current edge mean: [ 9.1531534e+00  1.4091150e+00  5.6857448e+00 -4.0431343e-09
  2.0215671e-09  2.0215671e-09  0.0000000e+00 -7.5808770e-10
  4.5485260e-09  3.0323508e-09]
2025-06-02 16:01:17,470 - DEBUG - Node drift difference: 0.0192, Edge drift difference: 0.9081
2025-06-02 16:01:17,470 - WARNING - Feature drift detected (1 consecutive)
2025-06-02 16:01:17,471 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.2669992e-09 -2.7202120e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.6001247e-08
  4.2669992e-09 -6.9338735e-09  1.3867747e-08 -7.4672482e-09
  2.2941835e+00  2.9597316e+00  1.4541388e-01  4.4116330e+00
 -2.1334996e-09  3.3221476e+00  5.8680091e+00  7.6196866e+00
  1.4541388e-01  7.9921699e+00  1.8134747e-08  1.1734247e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -7.4672482e-09  8.1072983e-08], edge=[ 9.1531534e+00  1.4091150e+00  5.6857448e+00 -4.0431343e-09
  2.0215671e-09  2.0215671e-09  0.0000000e+00 -7.5808770e-10
  4.5485260e-09  3.0323508e-09]
2025-06-02 16:01:17,471 - DEBUG - Updated reference std: node=[0.         0.         1.0005598  1.0005598  0.         0.
 0.         1.0005598  1.0005598  1.0005598  1.0005598  1.0005598
 0.97541434 0.28107604 0.36824727 0.5703764  1.0005598  2.9711607
 2.8818514  1.4734278  0.36824727 0.23411502 1.0005598  1.0005598
 0.         0.         0.         0.         1.0005598  1.0005597 ], edge=[1.1319937 0.5045725 2.1699586 1.0002651 1.0002651 1.0002651 1.0002651
 1.0002651 1.0002651 1.0002651]
2025-06-02 16:01:17,472 - INFO - Online update complete. Loss: 0.7838
2025-06-02 16:01:17,472 - INFO - Running anomaly detection...
2025-06-02 16:01:17,472 - INFO - Starting anomaly detection.
2025-06-02 16:01:17,483 - DEBUG - Node reconstruction errors: [0.60345775 1.9522178  2.8502822  0.12684862 0.28628138 0.2274224
 2.3739204  0.10490587 0.10490593 0.21520835 0.10490593 0.7552687
 4.211822   0.786934   0.0431518  0.12374801 0.86465955 0.12375025
 0.58323324 0.11620033 0.08661758 0.0431518  0.3500899  0.53309023
 0.03729352 0.1486817  0.03729356 0.440345   0.10012329 0.03729356
 1.3382164  0.32436618 0.39255732 0.11258616 0.15023965 0.22191381
 0.21646191 0.11620037 0.23093347 0.7273471  0.18996848 0.0362646
 0.11620037 0.20245244 0.57856274 0.68692017 0.46868357 0.7408403
 0.09687098 1.1672345  1.1394087  0.145981   0.1416556  0.5795782
 0.07813919 0.19471626 2.0693514  0.10270799 0.58003944 0.67996544
 0.70359135 0.32545045 0.03154765 0.7036479  0.03401339 0.07813911
 0.03720064 0.07813932 0.03154759 0.32545042 0.13999608 0.2080262
 0.04244837 0.2484688  0.22336677 0.22974284 0.23690973 0.19062862
 0.12039458 0.17201015 0.08519113 0.1709253  1.060034   1.9112077
 0.15036657 0.86941403 0.1542612  0.14985901 0.21131903 0.16482161
 0.02649335 0.32156134 0.4733346  0.15368514 0.16989253 2.0806322
 0.07684519 0.16834122 0.01978676 0.07724815 0.13390322 0.07684517
 0.13530307 0.2777471  0.6061625  0.08122661 0.6418963  0.5021266
 0.51382476 1.3613529  0.53430086 0.06827143 0.29530352 0.20039706
 0.13758348 0.08486871 0.11936335 0.265924   0.15926892 0.04368904
 0.02119209 0.47554106 0.19511777 0.42429197 0.20284162 0.04368735
 0.41418287 0.4084625  0.20752153 0.04956242 0.11138835 0.03801129
 0.27291316 0.2630793  0.10271372 0.07706974 0.13509366 0.02498882
 0.5919353  0.27558836 0.14759342 0.11120685 0.02250823 0.1475939
 0.12407421 0.17492716 0.11936343 0.279857   0.17574702 0.14403623
 1.0272973  0.7257615  0.16223134 0.03801129 0.24628176 0.24928929
 0.0363795  0.13281055 0.13390303 0.15567826 0.1475921  0.5035459
 0.03637953 0.11138832 0.11294432 0.27581042 0.13038655 0.1069671
 0.5296109  0.19442526 0.15955481 0.05007685 0.02845083 1.8221958
 0.15927067 0.12438933 0.10912808 0.11748853 0.09991865 0.09991866
 0.07904949 0.4804141  0.1870143  0.24732113 0.28991842 0.11348525
 0.02067144 0.1304314  0.077993   0.03734035 0.15159084 0.1282793
 0.11960743 0.0422148  0.5919378  0.10030048 0.98181164 0.19489641
 0.28199145 0.1922728  0.02856601 0.03637974 0.3214435  0.19124715
 0.18395384 0.49831882 0.16764107 0.36163697 0.01812624 0.14314038
 0.08399272 0.10656547 0.12439771 0.15714058 0.11639493 0.02902228
 0.16171464 0.11936355 0.18899743 0.04221475 0.20709413 0.02067145
 0.0259099  0.12439771 0.03637949 0.156203   0.25596756 0.05022896
 0.12994438 0.48953027 0.47753865 0.15538663 0.17290956 0.11936307
 0.11936331 0.1234192  0.11537023 0.0259099  0.03637958 0.12039936
 0.23745379 0.11642723 0.05171679 0.20231046 0.05083226 0.20231085
 0.10887694 0.12229395 0.05171679 0.08556499 0.02845083 0.02742468
 0.18899779 0.09549869 0.11943479 0.1585187  0.03733803 0.01855049
 0.08700851 0.09991863 0.10417552 0.59754443 0.1192422  0.0996911
 0.19224007 0.14378738 0.16409054 1.5028014  0.16409168 0.08168042
 0.2738104  0.21106625 0.13343367 0.2513716  0.09776465 0.09991862
 0.01890389 0.27625656 0.07904948 0.12379224 0.7332717  0.02054302
 0.08868337 0.15078211 0.17313698 0.07228018 0.43465742 0.48853528
 0.48041403 0.3974582  0.14344297 0.05343385 0.05821624 0.05083226
 0.7511202  0.03404109 0.09561547 0.09992667 0.10029876 0.5986503
 0.08490708 0.02078542 0.07488208 0.12552075 0.02078542 0.02078542
 0.02078542 0.09009815 0.16915928 0.02078545 0.02078542 0.2403112
 0.02078542 0.03641577 0.5233532  0.1188391  0.17278606 0.4351452
 0.12228168 0.09904781 0.14541173 0.04821744 0.16851695 0.07488213
 0.49834198 0.22746699 0.20114265 0.17446612 0.1362717  0.13627154
 0.27827826 0.09943933 0.02078542 0.09776463 0.02078542 0.09009803
 0.12206086 0.0257207  0.01753259 0.0175326  0.020786   0.03781598
 0.01753259 0.13690138 0.15415348 0.14574023 0.07488211 0.06341752
 0.19322534 0.11162158 0.02078547 0.08911037 0.18318246 0.13560933
 0.03109843 0.03733806 0.01795796 0.02078542 0.02234665 1.6393269
 0.0839927  0.03629682 0.2342612  0.15235618 0.07487781 2.594165
 0.01890336 0.29621902 0.08200912 0.0613832  0.11354797 0.13373798
 0.15209474 0.17660624 0.15318206 0.13559052 0.0238277  0.05039363
 0.11241861 0.02078542 0.07488214 0.40931466 0.03853353 0.07893097
 0.41572878 0.13471667 0.13379481 0.5128089  0.12002755 0.02078543
 0.31161398 0.18377134 0.06137482 0.20584819 0.10045063 0.10048788
 0.10053054 0.5866485  0.02005314 0.5928863  0.03728102 0.17403252
 0.10047733 0.02005314 0.06629677 0.06137235 0.14025024 0.03809564
 0.06137491 0.45570487 0.10050359 0.06137484 0.02005316 0.10047753
 0.10050137 0.02613701 0.03560311 0.10053176 0.02382438 0.11066766
 0.03825402 0.04946858 0.05703185 0.03945893 0.18778627 0.06015662
 0.07281743 0.14724909 0.5015019  0.442963   0.15520403 0.07693205
 0.07278325 0.10355579 0.10053433 0.10048407 0.03728084 0.12967417
 0.19017954 0.01836313 0.09086329 0.05318891 0.21307534 0.02104673
 0.02790919 0.22540201 0.22461186 0.04345533 0.09762179 0.04380563
 0.18661219 0.02210335 0.04855365 0.01969767 0.02210335 0.07762332
 0.03945796 0.10869806 0.04715534 0.11927208 0.06625286 0.04665827
 0.04059326 0.5209906  0.04059338 0.04665827 0.02237094 0.09763308
 0.44408703 0.09966393 0.02237094 0.06625353 0.10583671 0.2908101
 0.18497019 0.05704127 0.0976328  0.06625286 0.01815337 0.05646562
 0.05197685 0.26788288 0.08652783 0.04345542 0.19827074 0.04031388
 0.02210335 0.41777375 0.10342225 0.28881344 0.08003581 0.01815337
 0.08585747 0.01716508 0.05219681 0.04147714 0.05791084 0.79689705
 0.01969767 0.0564656  0.20314004 0.01716504 0.20313992 0.01788506
 0.02201154 0.41054145 0.01623654 0.3538212  0.06551145 0.02210335
 0.40948662 0.04584162 0.04584159 0.02790918 0.0723333  0.06962277
 0.01623667 0.0530739  0.11140806 0.13423365 0.05307399 0.05318886
 0.01623654 0.12194049 0.02201154 0.05791084 0.11301555 0.36815578
 0.05307321 0.1381447  0.06962277 0.01969767 0.01969767 0.05646556
 0.05791016 0.0533881  0.10413996 0.12702462 0.01969767 0.0992503
 0.01969767 0.09925037 0.11392965 0.05307455 0.04234214 1.9224375
 0.43540028 0.02022945 0.7461977  0.02022945 0.02022943 0.02022945
 0.02022945 0.02022945 0.02022945 0.02022945 0.05787884 0.04755645
 0.09943806 0.02022945 0.02022945 0.02022945 0.02022945 0.02022945
 0.02022945 0.02022945 0.02022945 0.02022945 0.05346308 0.02022943
 0.02022945 0.20030268 0.02022945 0.37576774 0.08955326 0.01969767
 0.12959006 0.12541766 1.0781556  1.0781556  0.13519216 0.12959006
 0.01969767 0.01623654 0.01623655 0.01969767 0.01623655 0.04975022
 0.05240597 0.02022948 0.0531888  0.01969767 0.04584161 0.01969767
 0.01969767 0.08924074 0.01969767 0.01623654 0.01969767 0.01969767
 0.05307379 0.01623654 0.01969767 0.01623656 0.01969767 0.01969767
 0.01969767 0.13789628 0.16048759 0.05219718 0.02022945 0.08696311
 0.08365571 0.01969767 0.01623655 0.11688069 0.02022946 0.06853827
 0.11502112 0.01641511 0.01969767 0.01969767 0.09748305 0.14483494
 0.06209073 0.01969767 0.05787889 0.02729366 0.01623654 0.36900482
 0.02022945 0.07518323 0.16639322 0.02022945 0.02022944 0.05787884
 0.02729366 0.01969767 0.27605826 0.09806874 0.13304214 0.14483468
 0.07847675 0.08166639 0.08166907 0.08654286 0.04147691 0.02022945
 0.04988582 0.09816272 0.144835   0.05121154 0.05616362 0.07828986
 0.02164875 0.02164875 0.02164874 0.02164874 0.02164875 0.06126778
 0.1006429  0.02164875 0.02164873 0.02022945 0.03003603 0.02022945
 0.08167008 0.13823324 0.14434293 0.03341465 0.08166953 0.16852912
 0.0534627  0.04044757 0.05346261 0.02022945 0.08166984 0.02256542
 0.01731203 0.01731203 0.02164875 0.02256544 0.12066891 0.03388429
 0.07528938 0.02022945 0.02164874 0.03432248 0.01731198 0.02227146
 0.02413019 0.02761722 0.06126778 0.30386135 0.02761721 0.30814272
 0.06738594 0.0241302  0.0535052  0.02411071 0.02629667 0.03913291
 0.09443968 0.02382056 0.08438664 0.02413019 0.02413019 0.02413019
 0.02113012 0.02413019 0.02413019 0.02629667 0.02413019 0.02413019
 0.0241302  0.07913589 0.02631485 0.16564064 0.18693547 0.10136881
 0.06186112 0.02532045 0.15269779 0.64669746 0.02947745 0.02953509
 0.04387932 0.11763574 0.11763587 0.02629667 0.29990104 0.22641037
 0.02947568 0.02699601 0.09083501 0.25670177 0.03358116 0.03358116
 0.03358116 0.03103978 0.03256488 0.3700747  0.18620893 0.2465063
 0.04478525 0.03557069 0.07350484 0.02699603 0.07258368 0.12018638
 0.02779195 0.12882785 0.02947568 0.22643314 0.02699602 0.12018705
 0.03557065 0.49914742 0.03358116 0.03103975 0.02779194 0.07856603
 0.12881613 0.03103978 0.03103978 0.03103977 0.08574297 0.1246818
 2.0712845  0.03358116 0.18643413 0.03103978 0.14118041 0.10388443
 0.82842165 0.10388497 0.03103977 0.03654559 0.10189259 0.03344794
 0.25604337 0.1038939  1.3317531  0.05520295 0.26084393 0.10388441
 0.16776663 0.14174229 0.05723842 0.23118639 0.16072132 0.03870817
 0.03870817 0.23118624 0.25610128 0.03654559 0.10388442 0.05723841
 0.10388442 0.04598929 0.04598931 0.04598929 0.03855645 0.3037015
 0.04598929 0.04598929 0.05024816 0.12303171 0.04598929 0.04598929
 0.04423587 0.15380624 0.3507346  0.27565444 0.04598929 0.22058304
 0.12303171 0.04598929 0.05506356 0.1227545  0.05024819 0.04665782
 0.51913446 0.12275455 0.04598929 0.12275448 0.11894048 0.3008232
 0.19886054 0.04598929 0.36384076 0.11894046 0.1189404  0.15380625
 0.05404659 0.11894037 0.05506359 0.06084405 0.05637852 0.18198754
 0.14191385 0.18198754 0.31739548 0.05506359 0.14191385 0.06825569
 0.06825569 0.81016165 0.06825569 0.10813982 0.05404657 0.18219991
 0.14012839 0.05637851 0.14012791 0.38672718 0.05506363 0.6176146
 0.06825572 0.06915192 0.06084405 0.06825569 0.35321614 0.05637847
 0.06915192 0.05637849 0.06825573 0.06825569 0.06825573 0.06825578
 0.06825569 0.06784084 0.16775732 0.06784083 0.16775867 0.0678408
 0.31480607 0.31480616 0.31480604 0.06825569 0.06825569 0.06825574
 0.06825569 1.7521045  0.16775748 0.06784084 0.06825572 0.06825569
 0.06825569 0.0829865  0.06825572 0.06825569 0.06825569 0.16775745]
2025-06-02 16:01:17,484 - DEBUG - Edge reconstruction errors: [1.3637102  1.3629311  0.9588297  ... 1.4592011  0.15881138 1.2598411 ]
2025-06-02 16:01:17,488 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160117_update_37.json
2025-06-02 16:01:17,488 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:01:17,497 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160117_update_37.pth and as latest_checkpoint.pth
2025-06-02 16:01:17,497 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870205.dot): 0.0948
2025-06-02 16:01:17,498 - WARNING - Detected 23 anomalous nodes (reconstruction-based):
2025-06-02 16:01:17,498 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.9522, MLP Score: 0.5777
2025-06-02 16:01:17,498 - WARNING -   Node ID: 192.168.27.13, Recon Error: 2.8503, MLP Score: 0.4842
2025-06-02 16:01:17,498 - WARNING -   Node ID: 192.168.27.12, Recon Error: 2.3739, MLP Score: 0.5192
2025-06-02 16:01:17,498 - WARNING -   Node ID: 192.168.27.10, Recon Error: 4.2118, MLP Score: 0.5261
2025-06-02 16:01:17,498 - WARNING -   Node ID: 199.232.214.172, Recon Error: 1.3382, MLP Score: 0.4241
2025-06-02 16:01:17,498 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 16:01:17,498 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.7980, MLP Score: 0.5085
2025-06-02 16:01:17,498 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.0104, MLP Score: 0.5432
2025-06-02 16:01:17,498 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.5201, MLP Score: 0.4804
2025-06-02 16:01:17,498 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.5229, MLP Score: 0.5579
2025-06-02 16:01:17,499 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9232, MLP Score: 0.4660
2025-06-02 16:01:17,499 - INFO - 
--- Processing file: nw_graph_encoded_1748870235.dot (Timestamp: 2025-06-02 15:17:15) ---
2025-06-02 16:01:17,499 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 16:01:17,499 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 16:01:17,527 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 16:01:17,553 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 16:01:17,553 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 16:01:17,553 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870235.dot
2025-06-02 16:01:17,574 - INFO - Parsed 901 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 16:01:17,594 - INFO - Parsed 1907 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870235.dot'.
2025-06-02 16:01:17,595 - INFO - Processing node updates/additions.
2025-06-02 16:01:17,600 - INFO - Processing edge updates/additions.
2025-06-02 16:01:17,612 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:01:17,613 - INFO - Finished updating NetworkX graph.
2025-06-02 16:01:17,613 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:01:17,614 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:01:17,624 - DEBUG - Initial node features tensor shape: torch.Size([901, 30])
2025-06-02 16:01:17,625 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:01:17,626 - DEBUG - Node features tensor shape after scaling: torch.Size([901, 30])
2025-06-02 16:01:17,629 - DEBUG - Edge index tensor shape: torch.Size([2, 1907])
2025-06-02 16:01:17,631 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:01:17,635 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:01:17,636 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:01:17,637 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:01:17,639 - DEBUG - Shape of encoded categorical edge features: torch.Size([1907, 3])
2025-06-02 16:01:17,640 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:01:17,640 - DEBUG - Shape of scaled numerical edge features: torch.Size([1907, 7])
2025-06-02 16:01:17,640 - DEBUG - Final edge attributes tensor shape: torch.Size([1907, 10])
2025-06-02 16:01:17,640 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:01:17,643 - INFO - Performing online update...
2025-06-02 16:01:17,643 - INFO - Starting online update for 50 steps.
2025-06-02 16:01:17,644 - DEBUG - Updated RunningStats: new_mean=0.944007361581552, new_var=21600000000162.066, new_n=2190
2025-06-02 16:01:17,644 - DEBUG - Updated RunningStats: new_mean=0.9412247215304804, new_var=21900000000017.934, new_n=2220
2025-06-02 16:01:17,644 - DEBUG - Updated RunningStats: new_mean=1.1020112974763216, new_var=7200000000094.446, new_n=730
2025-06-02 16:01:17,644 - DEBUG - Updated RunningStats: new_mean=1.1017391026589007, new_var=7300000000001.567, new_n=740
2025-06-02 16:01:17,644 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:01:17,644 - DEBUG - Online update step: 1/50
2025-06-02 16:01:17,647 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:17,867 - DEBUG - Node anomaly scores shape: torch.Size([15585, 1])
2025-06-02 16:01:17,871 - DEBUG - Edge anomaly scores shape: torch.Size([32164, 1])
2025-06-02 16:01:17,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:18,043 - DEBUG - Step 1: Loss=0.7201
2025-06-02 16:01:18,044 - DEBUG - Online update step: 2/50
2025-06-02 16:01:18,046 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:18,220 - DEBUG - Node anomaly scores shape: torch.Size([16950, 1])
2025-06-02 16:01:18,225 - DEBUG - Edge anomaly scores shape: torch.Size([35086, 1])
2025-06-02 16:01:18,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:18,495 - DEBUG - Step 2: Loss=0.7152
2025-06-02 16:01:18,496 - DEBUG - Online update step: 3/50
2025-06-02 16:01:18,508 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:18,637 - DEBUG - Node anomaly scores shape: torch.Size([15119, 1])
2025-06-02 16:01:18,642 - DEBUG - Edge anomaly scores shape: torch.Size([31077, 1])
2025-06-02 16:01:18,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:18,862 - DEBUG - Step 3: Loss=0.7117
2025-06-02 16:01:18,863 - DEBUG - Online update step: 4/50
2025-06-02 16:01:18,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:18,957 - DEBUG - Node anomaly scores shape: torch.Size([16887, 1])
2025-06-02 16:01:18,961 - DEBUG - Edge anomaly scores shape: torch.Size([34870, 1])
2025-06-02 16:01:18,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:19,171 - DEBUG - Step 4: Loss=0.7071
2025-06-02 16:01:19,171 - DEBUG - Online update step: 5/50
2025-06-02 16:01:19,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:19,326 - DEBUG - Node anomaly scores shape: torch.Size([17165, 1])
2025-06-02 16:01:19,335 - DEBUG - Edge anomaly scores shape: torch.Size([35606, 1])
2025-06-02 16:01:19,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:19,646 - DEBUG - Step 5: Loss=0.7051
2025-06-02 16:01:19,646 - DEBUG - Online update step: 6/50
2025-06-02 16:01:19,654 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:19,750 - DEBUG - Node anomaly scores shape: torch.Size([16234, 1])
2025-06-02 16:01:19,754 - DEBUG - Edge anomaly scores shape: torch.Size([33493, 1])
2025-06-02 16:01:19,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:19,949 - DEBUG - Step 6: Loss=0.7055
2025-06-02 16:01:19,950 - DEBUG - Online update step: 7/50
2025-06-02 16:01:19,953 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:20,049 - DEBUG - Node anomaly scores shape: torch.Size([17070, 1])
2025-06-02 16:01:20,054 - DEBUG - Edge anomaly scores shape: torch.Size([35418, 1])
2025-06-02 16:01:20,056 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:20,317 - DEBUG - Step 7: Loss=0.7067
2025-06-02 16:01:20,318 - DEBUG - Online update step: 8/50
2025-06-02 16:01:20,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:20,430 - DEBUG - Node anomaly scores shape: torch.Size([16231, 1])
2025-06-02 16:01:20,435 - DEBUG - Edge anomaly scores shape: torch.Size([33383, 1])
2025-06-02 16:01:20,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:20,657 - DEBUG - Step 8: Loss=0.7022
2025-06-02 16:01:20,658 - DEBUG - Online update step: 9/50
2025-06-02 16:01:20,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:20,758 - DEBUG - Node anomaly scores shape: torch.Size([16673, 1])
2025-06-02 16:01:20,762 - DEBUG - Edge anomaly scores shape: torch.Size([34423, 1])
2025-06-02 16:01:20,764 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:20,990 - DEBUG - Step 9: Loss=0.6990
2025-06-02 16:01:20,990 - DEBUG - Online update step: 10/50
2025-06-02 16:01:20,996 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:21,090 - DEBUG - Node anomaly scores shape: torch.Size([15910, 1])
2025-06-02 16:01:21,094 - DEBUG - Edge anomaly scores shape: torch.Size([32764, 1])
2025-06-02 16:01:21,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:21,347 - DEBUG - Step 10: Loss=0.6979
2025-06-02 16:01:21,347 - DEBUG - Online update step: 11/50
2025-06-02 16:01:21,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:21,466 - DEBUG - Node anomaly scores shape: torch.Size([15975, 1])
2025-06-02 16:01:21,473 - DEBUG - Edge anomaly scores shape: torch.Size([32889, 1])
2025-06-02 16:01:21,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:21,777 - DEBUG - Step 11: Loss=0.6989
2025-06-02 16:01:21,778 - DEBUG - Online update step: 12/50
2025-06-02 16:01:21,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:21,935 - DEBUG - Node anomaly scores shape: torch.Size([16452, 1])
2025-06-02 16:01:21,941 - DEBUG - Edge anomaly scores shape: torch.Size([34049, 1])
2025-06-02 16:01:21,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:22,249 - DEBUG - Step 12: Loss=0.6945
2025-06-02 16:01:22,249 - DEBUG - Online update step: 13/50
2025-06-02 16:01:22,260 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:22,381 - DEBUG - Node anomaly scores shape: torch.Size([16124, 1])
2025-06-02 16:01:22,387 - DEBUG - Edge anomaly scores shape: torch.Size([33176, 1])
2025-06-02 16:01:22,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:22,714 - DEBUG - Step 13: Loss=0.6935
2025-06-02 16:01:22,715 - DEBUG - Online update step: 14/50
2025-06-02 16:01:22,725 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:22,832 - DEBUG - Node anomaly scores shape: torch.Size([15679, 1])
2025-06-02 16:01:22,838 - DEBUG - Edge anomaly scores shape: torch.Size([32126, 1])
2025-06-02 16:01:22,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:23,124 - DEBUG - Step 14: Loss=0.6938
2025-06-02 16:01:23,125 - DEBUG - Online update step: 15/50
2025-06-02 16:01:23,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:23,256 - DEBUG - Node anomaly scores shape: torch.Size([16766, 1])
2025-06-02 16:01:23,262 - DEBUG - Edge anomaly scores shape: torch.Size([34798, 1])
2025-06-02 16:01:23,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:23,521 - DEBUG - Step 15: Loss=0.6924
2025-06-02 16:01:23,521 - DEBUG - Online update step: 16/50
2025-06-02 16:01:23,524 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:23,635 - DEBUG - Node anomaly scores shape: torch.Size([14783, 1])
2025-06-02 16:01:23,640 - DEBUG - Edge anomaly scores shape: torch.Size([30240, 1])
2025-06-02 16:01:23,641 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:23,934 - DEBUG - Step 16: Loss=0.6882
2025-06-02 16:01:23,935 - DEBUG - Online update step: 17/50
2025-06-02 16:01:23,944 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:24,088 - DEBUG - Node anomaly scores shape: torch.Size([16265, 1])
2025-06-02 16:01:24,093 - DEBUG - Edge anomaly scores shape: torch.Size([33412, 1])
2025-06-02 16:01:24,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:24,417 - DEBUG - Step 17: Loss=0.6848
2025-06-02 16:01:24,417 - DEBUG - Online update step: 18/50
2025-06-02 16:01:24,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:24,558 - DEBUG - Node anomaly scores shape: torch.Size([16043, 1])
2025-06-02 16:01:24,563 - DEBUG - Edge anomaly scores shape: torch.Size([32990, 1])
2025-06-02 16:01:24,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:24,822 - DEBUG - Step 18: Loss=0.6833
2025-06-02 16:01:24,822 - DEBUG - Online update step: 19/50
2025-06-02 16:01:24,825 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:24,964 - DEBUG - Node anomaly scores shape: torch.Size([16228, 1])
2025-06-02 16:01:24,968 - DEBUG - Edge anomaly scores shape: torch.Size([33435, 1])
2025-06-02 16:01:24,969 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:25,261 - DEBUG - Step 19: Loss=0.6834
2025-06-02 16:01:25,262 - DEBUG - Online update step: 20/50
2025-06-02 16:01:25,272 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:25,402 - DEBUG - Node anomaly scores shape: torch.Size([17570, 1])
2025-06-02 16:01:25,410 - DEBUG - Edge anomaly scores shape: torch.Size([36467, 1])
2025-06-02 16:01:25,412 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:25,664 - DEBUG - Step 20: Loss=0.6828
2025-06-02 16:01:25,664 - DEBUG - Online update step: 21/50
2025-06-02 16:01:25,668 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:25,783 - DEBUG - Node anomaly scores shape: torch.Size([15210, 1])
2025-06-02 16:01:25,787 - DEBUG - Edge anomaly scores shape: torch.Size([31169, 1])
2025-06-02 16:01:25,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:26,022 - DEBUG - Step 21: Loss=0.6820
2025-06-02 16:01:26,022 - DEBUG - Online update step: 22/50
2025-06-02 16:01:26,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:26,130 - DEBUG - Node anomaly scores shape: torch.Size([16020, 1])
2025-06-02 16:01:26,135 - DEBUG - Edge anomaly scores shape: torch.Size([33018, 1])
2025-06-02 16:01:26,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:26,352 - DEBUG - Step 22: Loss=0.6785
2025-06-02 16:01:26,353 - DEBUG - Online update step: 23/50
2025-06-02 16:01:26,356 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:26,484 - DEBUG - Node anomaly scores shape: torch.Size([17294, 1])
2025-06-02 16:01:26,491 - DEBUG - Edge anomaly scores shape: torch.Size([35720, 1])
2025-06-02 16:01:26,492 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:26,723 - DEBUG - Step 23: Loss=0.6770
2025-06-02 16:01:26,723 - DEBUG - Online update step: 24/50
2025-06-02 16:01:26,726 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:26,850 - DEBUG - Node anomaly scores shape: torch.Size([14911, 1])
2025-06-02 16:01:26,855 - DEBUG - Edge anomaly scores shape: torch.Size([30473, 1])
2025-06-02 16:01:26,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:27,132 - DEBUG - Step 24: Loss=0.6781
2025-06-02 16:01:27,132 - DEBUG - Online update step: 25/50
2025-06-02 16:01:27,136 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:27,285 - DEBUG - Node anomaly scores shape: torch.Size([16122, 1])
2025-06-02 16:01:27,292 - DEBUG - Edge anomaly scores shape: torch.Size([33286, 1])
2025-06-02 16:01:27,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:27,530 - DEBUG - Step 25: Loss=0.6712
2025-06-02 16:01:27,530 - DEBUG - Online update step: 26/50
2025-06-02 16:01:27,538 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:27,687 - DEBUG - Node anomaly scores shape: torch.Size([16522, 1])
2025-06-02 16:01:27,698 - DEBUG - Edge anomaly scores shape: torch.Size([34357, 1])
2025-06-02 16:01:27,699 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:27,881 - DEBUG - Step 26: Loss=0.6712
2025-06-02 16:01:27,881 - DEBUG - Online update step: 27/50
2025-06-02 16:01:27,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:27,985 - DEBUG - Node anomaly scores shape: torch.Size([16003, 1])
2025-06-02 16:01:27,990 - DEBUG - Edge anomaly scores shape: torch.Size([32957, 1])
2025-06-02 16:01:27,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:28,263 - DEBUG - Step 27: Loss=0.6764
2025-06-02 16:01:28,263 - DEBUG - Online update step: 28/50
2025-06-02 16:01:28,266 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:28,371 - DEBUG - Node anomaly scores shape: torch.Size([16013, 1])
2025-06-02 16:01:28,379 - DEBUG - Edge anomaly scores shape: torch.Size([33056, 1])
2025-06-02 16:01:28,380 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:28,648 - DEBUG - Step 28: Loss=0.6700
2025-06-02 16:01:28,649 - DEBUG - Online update step: 29/50
2025-06-02 16:01:28,652 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:28,808 - DEBUG - Node anomaly scores shape: torch.Size([16888, 1])
2025-06-02 16:01:28,816 - DEBUG - Edge anomaly scores shape: torch.Size([34826, 1])
2025-06-02 16:01:28,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:29,185 - DEBUG - Step 29: Loss=0.6702
2025-06-02 16:01:29,186 - DEBUG - Online update step: 30/50
2025-06-02 16:01:29,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:29,306 - DEBUG - Node anomaly scores shape: torch.Size([15997, 1])
2025-06-02 16:01:29,312 - DEBUG - Edge anomaly scores shape: torch.Size([32975, 1])
2025-06-02 16:01:29,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:29,533 - DEBUG - Step 30: Loss=0.6683
2025-06-02 16:01:29,534 - DEBUG - Online update step: 31/50
2025-06-02 16:01:29,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:29,689 - DEBUG - Node anomaly scores shape: torch.Size([15913, 1])
2025-06-02 16:01:29,694 - DEBUG - Edge anomaly scores shape: torch.Size([32762, 1])
2025-06-02 16:01:29,696 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:29,959 - DEBUG - Step 31: Loss=0.6681
2025-06-02 16:01:29,960 - DEBUG - Online update step: 32/50
2025-06-02 16:01:29,963 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:30,074 - DEBUG - Node anomaly scores shape: torch.Size([16006, 1])
2025-06-02 16:01:30,079 - DEBUG - Edge anomaly scores shape: torch.Size([33057, 1])
2025-06-02 16:01:30,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:30,331 - DEBUG - Step 32: Loss=0.6616
2025-06-02 16:01:30,332 - DEBUG - Online update step: 33/50
2025-06-02 16:01:30,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:30,485 - DEBUG - Node anomaly scores shape: torch.Size([15509, 1])
2025-06-02 16:01:30,489 - DEBUG - Edge anomaly scores shape: torch.Size([31933, 1])
2025-06-02 16:01:30,490 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:30,705 - DEBUG - Step 33: Loss=0.6646
2025-06-02 16:01:30,705 - DEBUG - Online update step: 34/50
2025-06-02 16:01:30,709 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:30,908 - DEBUG - Node anomaly scores shape: torch.Size([16479, 1])
2025-06-02 16:01:30,937 - DEBUG - Edge anomaly scores shape: torch.Size([34044, 1])
2025-06-02 16:01:30,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:31,359 - DEBUG - Step 34: Loss=0.6615
2025-06-02 16:01:31,359 - DEBUG - Online update step: 35/50
2025-06-02 16:01:31,363 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:31,592 - DEBUG - Node anomaly scores shape: torch.Size([16677, 1])
2025-06-02 16:01:31,607 - DEBUG - Edge anomaly scores shape: torch.Size([34568, 1])
2025-06-02 16:01:31,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:31,939 - DEBUG - Step 35: Loss=0.6599
2025-06-02 16:01:31,939 - DEBUG - Online update step: 36/50
2025-06-02 16:01:31,942 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:32,111 - DEBUG - Node anomaly scores shape: torch.Size([16638, 1])
2025-06-02 16:01:32,124 - DEBUG - Edge anomaly scores shape: torch.Size([34629, 1])
2025-06-02 16:01:32,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:32,533 - DEBUG - Step 36: Loss=0.6619
2025-06-02 16:01:32,533 - DEBUG - Online update step: 37/50
2025-06-02 16:01:32,537 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:32,691 - DEBUG - Node anomaly scores shape: torch.Size([16652, 1])
2025-06-02 16:01:32,696 - DEBUG - Edge anomaly scores shape: torch.Size([34386, 1])
2025-06-02 16:01:32,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:32,958 - DEBUG - Step 37: Loss=0.6582
2025-06-02 16:01:32,959 - DEBUG - Online update step: 38/50
2025-06-02 16:01:32,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:33,138 - DEBUG - Node anomaly scores shape: torch.Size([15433, 1])
2025-06-02 16:01:33,146 - DEBUG - Edge anomaly scores shape: torch.Size([31686, 1])
2025-06-02 16:01:33,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:33,603 - DEBUG - Step 38: Loss=0.6568
2025-06-02 16:01:33,604 - DEBUG - Online update step: 39/50
2025-06-02 16:01:33,607 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:33,751 - DEBUG - Node anomaly scores shape: torch.Size([17021, 1])
2025-06-02 16:01:33,756 - DEBUG - Edge anomaly scores shape: torch.Size([35341, 1])
2025-06-02 16:01:33,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:34,073 - DEBUG - Step 39: Loss=0.6532
2025-06-02 16:01:34,074 - DEBUG - Online update step: 40/50
2025-06-02 16:01:34,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:34,183 - DEBUG - Node anomaly scores shape: torch.Size([16402, 1])
2025-06-02 16:01:34,193 - DEBUG - Edge anomaly scores shape: torch.Size([33855, 1])
2025-06-02 16:01:34,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:34,445 - DEBUG - Step 40: Loss=0.6533
2025-06-02 16:01:34,446 - DEBUG - Online update step: 41/50
2025-06-02 16:01:34,451 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:34,612 - DEBUG - Node anomaly scores shape: torch.Size([15046, 1])
2025-06-02 16:01:34,639 - DEBUG - Edge anomaly scores shape: torch.Size([30895, 1])
2025-06-02 16:01:34,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:35,162 - DEBUG - Step 41: Loss=0.6565
2025-06-02 16:01:35,162 - DEBUG - Online update step: 42/50
2025-06-02 16:01:35,166 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:35,356 - DEBUG - Node anomaly scores shape: torch.Size([16460, 1])
2025-06-02 16:01:35,364 - DEBUG - Edge anomaly scores shape: torch.Size([34058, 1])
2025-06-02 16:01:35,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:35,828 - DEBUG - Step 42: Loss=0.6549
2025-06-02 16:01:35,828 - DEBUG - Online update step: 43/50
2025-06-02 16:01:35,832 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:35,997 - DEBUG - Node anomaly scores shape: torch.Size([15441, 1])
2025-06-02 16:01:36,005 - DEBUG - Edge anomaly scores shape: torch.Size([31789, 1])
2025-06-02 16:01:36,007 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:36,540 - DEBUG - Step 43: Loss=0.6518
2025-06-02 16:01:36,541 - DEBUG - Online update step: 44/50
2025-06-02 16:01:36,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:36,702 - DEBUG - Node anomaly scores shape: torch.Size([16169, 1])
2025-06-02 16:01:36,708 - DEBUG - Edge anomaly scores shape: torch.Size([33320, 1])
2025-06-02 16:01:36,711 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:36,982 - DEBUG - Step 44: Loss=0.6511
2025-06-02 16:01:36,983 - DEBUG - Online update step: 45/50
2025-06-02 16:01:36,992 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:37,147 - DEBUG - Node anomaly scores shape: torch.Size([16849, 1])
2025-06-02 16:01:37,154 - DEBUG - Edge anomaly scores shape: torch.Size([34827, 1])
2025-06-02 16:01:37,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:37,621 - DEBUG - Step 45: Loss=0.6498
2025-06-02 16:01:37,621 - DEBUG - Online update step: 46/50
2025-06-02 16:01:37,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:37,812 - DEBUG - Node anomaly scores shape: torch.Size([15702, 1])
2025-06-02 16:01:37,819 - DEBUG - Edge anomaly scores shape: torch.Size([32236, 1])
2025-06-02 16:01:37,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:38,156 - DEBUG - Step 46: Loss=0.6479
2025-06-02 16:01:38,157 - DEBUG - Online update step: 47/50
2025-06-02 16:01:38,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:38,306 - DEBUG - Node anomaly scores shape: torch.Size([17057, 1])
2025-06-02 16:01:38,317 - DEBUG - Edge anomaly scores shape: torch.Size([35340, 1])
2025-06-02 16:01:38,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:38,793 - DEBUG - Step 47: Loss=0.6521
2025-06-02 16:01:38,794 - DEBUG - Online update step: 48/50
2025-06-02 16:01:38,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:38,909 - DEBUG - Node anomaly scores shape: torch.Size([15576, 1])
2025-06-02 16:01:38,916 - DEBUG - Edge anomaly scores shape: torch.Size([31941, 1])
2025-06-02 16:01:38,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:39,146 - DEBUG - Step 48: Loss=0.6501
2025-06-02 16:01:39,147 - DEBUG - Online update step: 49/50
2025-06-02 16:01:39,150 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:39,243 - DEBUG - Node anomaly scores shape: torch.Size([15280, 1])
2025-06-02 16:01:39,247 - DEBUG - Edge anomaly scores shape: torch.Size([31290, 1])
2025-06-02 16:01:39,248 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:39,473 - DEBUG - Step 49: Loss=0.6462
2025-06-02 16:01:39,474 - DEBUG - Online update step: 50/50
2025-06-02 16:01:39,477 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:39,591 - DEBUG - Node anomaly scores shape: torch.Size([14492, 1])
2025-06-02 16:01:39,597 - DEBUG - Edge anomaly scores shape: torch.Size([29574, 1])
2025-06-02 16:01:39,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:39,894 - DEBUG - Step 50: Loss=0.6473
2025-06-02 16:01:39,895 - INFO - Online update finished. Average loss: 0.6763, Learning rate: 0.001000
2025-06-02 16:01:39,896 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], current edge mean: [ 9.1504984e+00  1.4074463e+00  5.6885161e+00 -1.0001828e-09
 -1.0001828e-09  2.0003657e-09 -9.0016457e-09 -1.2502285e-09
  5.0009141e-10  2.0003657e-09]
2025-06-02 16:01:39,896 - DEBUG - Node drift difference: 0.0041, Edge drift difference: 0.0033
2025-06-02 16:01:39,897 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.2756934e-08  4.4984638e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.2227704e-08
  2.1169242e-09 -1.0452313e-08 -8.9969276e-09 -4.2338481e-08
  2.2941177e+00  2.9600444e+00  1.4428413e-01  4.4139843e+00
  1.0452313e-08  3.3218646e+00  5.8712540e+00  7.6159821e+00
  1.4428413e-01  7.9922309e+00 -1.0055389e-08  1.1643083e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.9747715e-08  9.5261585e-09], edge=[ 9.1504984e+00  1.4074463e+00  5.6885161e+00 -1.0001828e-09
 -1.0001828e-09  2.0003657e-09 -9.0016457e-09 -1.2502285e-09
  5.0009141e-10  2.0003657e-09]
2025-06-02 16:01:39,898 - DEBUG - Updated reference std: node=[0.         0.         1.0005554  1.0005554  0.         0.
 0.         1.0005554  1.0005554  1.0005554  1.0005554  1.0005554
 0.9781268  0.28000316 0.37004966 0.57211477 1.0005554  2.9718418
 2.880792   1.4799136  0.37004966 0.23320381 1.0005554  1.0005554
 0.         0.         0.         0.         1.0005554  1.0005554 ], edge=[1.1433936 0.5051748 2.1682844 1.0002623 1.0002623 1.0002623 1.0002623
 1.0002623 1.0002623 1.0002624]
2025-06-02 16:01:39,898 - INFO - Online update complete. Loss: 0.6763
2025-06-02 16:01:39,898 - INFO - Running anomaly detection...
2025-06-02 16:01:39,898 - INFO - Starting anomaly detection.
2025-06-02 16:01:39,908 - DEBUG - Node reconstruction errors: [0.5886827  2.328054   0.3315191  0.07040474 0.12658915 0.18552531
 0.18293656 0.07684617 0.0768462  0.17860076 0.07684619 0.11509902
 0.9756745  0.44671077 0.01410026 0.07358985 0.1504404  0.07360702
 0.2918626  0.07178345 0.06527546 0.01410026 0.3065177  0.08732631
 0.01179158 0.11742997 0.01179133 0.28022587 0.0743571  0.01179133
 0.39097628 0.29214492 0.23108119 0.06478456 0.33149678 0.18838347
 0.19587997 0.07178344 0.11888096 0.45439252 0.1300722  0.01277922
 0.07178344 0.14864561 0.12408695 0.2739768  0.22894411 0.43112686
 0.0721711  0.89273834 0.43616396 0.1220449  0.11390721 0.30787164
 0.05516466 0.09862069 0.9020096  0.06942871 0.30146438 0.3649589
 0.42479938 0.28139797 0.01169004 0.22160101 0.27744403 0.05516465
 0.02452783 0.05516458 0.01169004 0.28139794 0.11252795 0.10898821
 0.02781927 0.2148347  0.19960591 0.1209192  0.1877574  0.10783087
 0.10112336 0.11463702 0.0565878  0.13116392 0.672327   0.77063984
 0.1248422  0.15198237 0.12984824 0.12629412 0.16390066 0.18637806
 0.0095693  0.18080045 0.04570582 0.12804653 0.14728482 1.3662335
 0.05492216 0.12794025 0.00824894 0.05276845 0.07217861 0.05492216
 0.10154092 0.2724347  0.11558677 0.05594203 0.19354424 0.19877657
 0.04770857 0.94750404 0.4604451  0.04690427 0.15572725 0.09084307
 0.08298838 0.07314385 0.07194927 0.10916258 0.12303122 0.02803911
 0.00968145 0.03565644 0.08146502 0.07868072 0.161071   0.02803915
 0.07722961 0.14962739 0.15249154 0.04297023 0.09579624 0.02438763
 0.13949993 0.20887044 0.06743743 0.05204493 0.10481178 0.01022783
 0.266764   0.13518861 0.12358962 0.09559881 0.01310537 0.12358964
 0.10186863 0.2086653  0.07194997 0.21345358 0.14878052 0.1095031
 0.8376894  0.17813821 0.11530857 0.02438763 0.11362579 0.10092421
 0.02123863 0.12499572 0.07217881 0.11585639 0.12358955 0.16958204
 0.02123859 0.09579621 0.06451365 0.13519219 0.07571254 0.07916458
 0.22206941 0.16315846 0.11198675 0.03472276 0.0113537  0.4949555
 0.15839444 0.10188845 0.0906418  0.11232909 0.05880916 0.05880916
 0.05588954 0.08133052 0.1529066  0.12120707 0.14901134 0.08962601
 0.01305415 0.09259507 0.05182812 0.0207603  0.11421442 0.09771166
 0.10128709 0.02791675 0.2667741  0.08024827 0.61334777 0.16872403
 0.12196188 0.23664752 0.02274558 0.02123862 0.17974892 0.15904918
 0.13752851 0.16512045 0.14160942 0.2828204  0.00910786 0.10637175
 0.053973   0.06593875 0.10191274 0.12718497 0.09894729 0.01920605
 0.14311336 0.07194968 0.14764546 0.02791676 0.10137188 0.01305416
 0.01102202 0.10191274 0.0212386  0.12998824 0.10399251 0.03551858
 0.0985352  0.03240522 0.10507706 0.14115399 0.16383068 0.07194921
 0.07194924 0.10234329 0.09929148 0.01102202 0.02123861 0.0982479
 0.09684685 0.09718628 0.03611278 0.1635658  0.03504609 0.18333003
 0.08690279 0.11681099 0.03611275 0.06597194 0.01135371 0.010943
 0.1476459  0.08019272 0.11975566 0.10413537 0.02076039 0.01257532
 0.07303012 0.0588092  0.08781648 0.09023937 0.07321782 0.08214681
 0.13277704 0.12013992 0.12924106 0.41079012 0.12925504 0.07969083
 0.13499591 0.09358845 0.11017045 0.20153274 0.06201057 0.05880917
 0.00895398 0.22630835 0.05588951 0.09034715 0.27911308 0.00827425
 0.07509365 0.11772449 0.14660533 0.05504107 0.251025   0.11320933
 0.08133053 0.16000006 0.12127521 0.04218117 0.05202428 0.03504611
 0.31873226 0.02840585 0.08469062 0.05882571 0.08024848 0.11952149
 0.0703635  0.00966192 0.05313226 0.10168251 0.00966192 0.0096619
 0.00966189 0.05873001 0.17649356 0.00966191 0.0096619  0.1187589
 0.0096619  0.02038807 0.18865973 0.09934173 0.21913615 0.05181066
 0.09936047 0.07880261 0.11818191 0.03430425 0.13062195 0.05313221
 0.21292081 0.10529874 0.17502022 0.16250013 0.10462596 0.10462623
 0.25706783 0.07805184 0.00966205 0.06201047 0.00966189 0.0587301
 0.09651016 0.01040951 0.00795059 0.00795059 0.00966471 0.02309905
 0.00795059 0.11587817 0.10077318 0.14310764 0.05313237 0.04914971
 0.1414144  0.08598871 0.00966202 0.07857679 0.08342334 0.12944588
 0.01878686 0.02076039 0.01259598 0.0096619  0.00984202 0.5438929
 0.1802412  0.02035806 0.1747212  0.13124922 0.0531035  1.507915
 0.00889009 0.1548852  0.05609402 0.05024228 0.09095704 0.11918953
 0.11955202 0.08284105 0.1020534  0.12943213 0.01093891 0.03308422
 0.09923215 0.00966189 0.05313315 0.14825396 0.02138371 0.06848287
 0.19532874 0.10512128 0.10770801 0.09596959 0.07793963 0.00966191
 0.21396336 0.1340065  0.04660757 0.1017969  0.0706173  0.07064198
 0.07066916 0.34100786 0.00968707 0.34606144 0.02035547 0.10742494
 0.07063619 0.00968702 0.04937496 0.04660745 0.15272509 0.02153384
 0.04660746 0.18027303 0.07065305 0.04660753 0.00968704 0.07063463
 0.07064965 0.01921044 0.02321144 0.07067087 0.0109391  0.09256507
 0.09514393 0.03093284 0.04736179 0.02128195 0.08025018 0.03936726
 0.05165786 0.11791491 0.16308229 0.02739338 0.12562844 0.05708834
 0.06403312 0.07268631 0.07067309 0.07064017 0.02035544 0.11429277
 0.08108686 0.01197452 0.07284865 0.0326371  0.14851783 0.01354762
 0.11752303 0.09495988 0.13458557 0.02231963 0.07552847 0.023461
 0.13643089 0.01152951 0.02822761 0.00993591 0.01152955 0.05362143
 0.02128198 0.08021789 0.0396339  0.10629138 0.05072756 0.02794709
 0.02222977 0.08885335 0.02222982 0.02794709 0.0099641  0.08922351
 0.15596016 0.07751952 0.0099641  0.05072695 0.08493917 0.15691988
 0.11954136 0.0473275  0.08922114 0.05072761 0.00953659 0.03585512
 0.04246685 0.17433019 0.07210355 0.02231969 0.09173676 0.02896019
 0.01152951 0.14913116 0.06686723 0.15805998 0.07197022 0.00953659
 0.06166805 0.00994514 0.04616374 0.02318486 0.04856767 0.4611285
 0.00993591 0.03585515 0.14412794 0.00994514 0.16289136 0.00831481
 0.01006901 0.04754968 0.00820722 0.24510874 0.04022679 0.01152951
 0.03141764 0.02568271 0.02568265 0.01984749 0.06091072 0.05513861
 0.00820795 0.04605899 0.08975017 0.10492346 0.04605695 0.03263687
 0.00820721 0.10872222 0.01006901 0.04856757 0.09118975 0.10408536
 0.04604365 0.12439711 0.05513861 0.00993591 0.00993591 0.03585512
 0.04856762 0.04518105 0.08637062 0.11162337 0.00993593 0.07932205
 0.00993591 0.07932517 0.11755464 0.04605156 0.02142176 0.80735415
 0.1835849  0.01026828 0.5559422  0.01026832 0.0102683  0.01026832
 0.01026831 0.01026832 0.01026832 0.0102683  0.04881217 0.02191969
 0.06557375 0.01026831 0.01026831 0.0102683  0.01026831 0.01026831
 0.01026831 0.01026831 0.01026828 0.01026831 0.04612459 0.01026834
 0.01026831 0.09752291 0.01026831 0.11321708 0.05873641 0.00993591
 0.07894681 0.10424907 0.69654095 0.69654095 0.12276984 0.07894681
 0.00993593 0.00820722 0.0082072  0.00993591 0.00820724 0.04168935
 0.03210029 0.01026878 0.03263685 0.00993591 0.02568271 0.00993591
 0.00993593 0.07554888 0.00993592 0.00820723 0.00993591 0.00993593
 0.04605477 0.00820721 0.00993592 0.00820724 0.00993593 0.00993591
 0.00993591 0.11162338 0.1038253  0.04616381 0.01026831 0.05947418
 0.06112013 0.00993593 0.00820724 0.08308862 0.0102683  0.0582738
 0.06550209 0.00916226 0.00993591 0.00993591 0.0764002  0.11888976
 0.05615263 0.00993591 0.04881221 0.0196189  0.00820719 0.09222897
 0.01026831 0.05017578 0.10694318 0.01026832 0.01026834 0.04881205
 0.01961883 0.00993591 0.2114809  0.0783226  0.08504687 0.11889971
 0.05808044 0.06377534 0.06377606 0.05706108 0.02926671 0.01026831
 0.02598693 0.07414133 0.11889097 0.04472844 0.04101349 0.05750658
 0.01046935 0.01046935 0.01046935 0.01046934 0.01046935 0.04879033
 0.07384992 0.01046935 0.01046938 0.01026831 0.02005063 0.0102683
 0.06377657 0.10935899 0.11678918 0.02530947 0.06377694 0.12661296
 0.04612212 0.03209567 0.04612245 0.01026832 0.0637771  0.01033483
 0.00848416 0.00848415 0.01046935 0.01033483 0.10053416 0.02574303
 0.05898216 0.01026832 0.01046934 0.02066358 0.00848416 0.0133777
 0.01225926 0.01375806 0.04879046 0.1646482  0.01375807 0.15331064
 0.05215778 0.01225924 0.02362388 0.01070946 0.01230374 0.02115365
 0.06686807 0.01065124 0.06393777 0.01225926 0.01225926 0.01225926
 0.01005205 0.07570735 0.01225926 0.01230374 0.01225926 0.01225926
 0.01225926 0.05762948 0.0108621  0.08333031 0.12737966 0.08564701
 0.02483342 0.01102145 0.1029401  0.40394136 0.01232312 0.01122709
 0.02224374 0.07216072 0.07216068 0.01230374 0.108519   0.1434844
 0.01232327 0.01108608 0.03014705 0.11630252 0.01198318 0.01198318
 0.01198318 0.0118621  0.01128743 0.07447936 0.11283045 0.18275054
 0.03368301 0.01548694 0.02998839 0.01108607 0.02760538 0.07640512
 0.01071919 0.09151937 0.01232327 0.14342861 0.01108607 0.07640847
 0.01548695 0.15283877 0.01198318 0.01186209 0.01071919 0.03610792
 0.07466258 0.0118621  0.01186209 0.01186209 0.03452171 0.0727301
 1.6009648  0.01198318 0.13952811 0.01186208 0.10800476 0.0461451
 0.49420625 0.04614532 0.01186209 0.01277092 0.03895138 0.01275518
 0.17026888 0.04614995 0.47561976 0.03921013 0.13357167 0.0461451
 0.09503446 0.07981439 0.03952724 0.13969247 0.08619115 0.01351292
 0.01351291 0.13967757 0.17426968 0.01277092 0.0461451  0.03952725
 0.0461451  0.0160517  0.01465965 0.01465965 0.01223719 0.14117965
 0.01465965 0.01465965 0.0160517  0.09087821 0.01465965 0.01465965
 0.01413486 0.09391229 0.19230086 0.13670336 0.01465965 0.12531656
 0.09087812 0.01465964 0.01648818 0.05752926 0.0160517  0.0137541
 0.2714445  0.05752927 0.01465964 0.05752929 0.04869234 0.16110805
 0.13234062 0.01465965 0.2856878  0.05212753 0.05212753 0.09391225
 0.01666045 0.05212754 0.01648813 0.03597384 0.0163325  0.09517797
 0.06792525 0.09517796 0.24686006 0.01648813 0.06792525 0.02006258
 0.02006258 0.5075284  0.0200626  0.06186055 0.01666011 0.08809174
 0.05993565 0.0163325  0.05993531 0.16573852 0.15435947 0.29449666
 0.0200626  0.0359242  0.03597384 0.0200626  0.21349402 0.20803179
 0.0359242  0.0163325  0.02006258 0.23948081 0.02006258 0.02006255
 0.0200626  0.0195197  0.0762812  0.0195197  0.07628203 0.0195197
 0.19232447 0.19232471 0.19232248 0.02006259 0.0200626  0.0200626
 0.02006258 1.0666432  0.0762814  0.0195197  0.0200626  0.02006258
 0.0200626  0.03623027 0.0200626  0.02006259 0.02006258 0.07628124
 0.02308099 0.56967705 0.02079208 0.02006258 0.02006259 0.03477021
 0.02006258]
2025-06-02 16:01:39,909 - DEBUG - Edge reconstruction errors: [1.3638985  1.3627243  0.9586152  ... 0.15859668 1.2596291  0.15859668]
2025-06-02 16:01:39,912 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160139_update_38.json
2025-06-02 16:01:39,913 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:01:39,922 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160139_update_38.pth and as latest_checkpoint.pth
2025-06-02 16:01:39,922 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870235.dot): 0.0925
2025-06-02 16:01:39,922 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-02 16:01:39,923 - WARNING -   Node ID: 1.1.1.1, Recon Error: 0.5887, MLP Score: 0.4870
2025-06-02 16:01:39,923 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.3281, MLP Score: 0.5826
2025-06-02 16:01:39,923 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.9757, MLP Score: 0.5237
2025-06-02 16:01:39,923 - WARNING -   Node ID: ff02::2, Recon Error: 0.8927, MLP Score: 0.4951
2025-06-02 16:01:39,923 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.9020, MLP Score: 0.5155
2025-06-02 16:01:39,923 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 16:01:39,923 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.8403, MLP Score: 0.5244
2025-06-02 16:01:39,923 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 15.0551, MLP Score: 0.5196
2025-06-02 16:01:39,923 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.5263, MLP Score: 0.4766
2025-06-02 16:01:39,923 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.6674, MLP Score: 0.4610
2025-06-02 16:01:39,923 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.0631, MLP Score: 0.4669
2025-06-02 16:01:39,924 - INFO - 
--- Processing file: nw_graph_encoded_1748870265.dot (Timestamp: 2025-06-02 15:17:45) ---
2025-06-02 16:01:39,924 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 16:01:39,924 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 16:01:39,953 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 16:01:39,985 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 16:01:39,985 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 16:01:39,985 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870265.dot
2025-06-02 16:01:40,014 - INFO - Parsed 914 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 16:01:40,045 - INFO - Parsed 1945 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870265.dot'.
2025-06-02 16:01:40,045 - INFO - Processing node updates/additions.
2025-06-02 16:01:40,054 - INFO - Processing edge updates/additions.
2025-06-02 16:01:40,071 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:01:40,073 - INFO - Finished updating NetworkX graph.
2025-06-02 16:01:40,073 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:01:40,074 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:01:40,089 - DEBUG - Initial node features tensor shape: torch.Size([914, 30])
2025-06-02 16:01:40,094 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:01:40,094 - DEBUG - Node features tensor shape after scaling: torch.Size([914, 30])
2025-06-02 16:01:40,096 - DEBUG - Edge index tensor shape: torch.Size([2, 1945])
2025-06-02 16:01:40,098 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:01:40,104 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:01:40,106 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:01:40,107 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:01:40,109 - DEBUG - Shape of encoded categorical edge features: torch.Size([1945, 3])
2025-06-02 16:01:40,111 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:01:40,111 - DEBUG - Shape of scaled numerical edge features: torch.Size([1945, 7])
2025-06-02 16:01:40,111 - DEBUG - Final edge attributes tensor shape: torch.Size([1945, 10])
2025-06-02 16:01:40,111 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:01:40,114 - INFO - Performing online update...
2025-06-02 16:01:40,115 - INFO - Starting online update for 50 steps.
2025-06-02 16:01:40,115 - DEBUG - Updated RunningStats: new_mean=0.9441289852880805, new_var=22200000000161.926, new_n=2250
2025-06-02 16:01:40,116 - DEBUG - Updated RunningStats: new_mean=0.9414485711235131, new_var=22500000000018.0, new_n=2280
2025-06-02 16:01:40,116 - DEBUG - Updated RunningStats: new_mean=1.1087082032090037, new_var=7400000000094.296, new_n=750
2025-06-02 16:01:40,117 - DEBUG - Updated RunningStats: new_mean=1.1083399402983103, new_var=7500000000001.567, new_n=760
2025-06-02 16:01:40,117 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:01:40,117 - DEBUG - Online update step: 1/50
2025-06-02 16:01:40,120 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:40,500 - DEBUG - Node anomaly scores shape: torch.Size([16525, 1])
2025-06-02 16:01:40,520 - DEBUG - Edge anomaly scores shape: torch.Size([34173, 1])
2025-06-02 16:01:40,522 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:40,891 - DEBUG - Step 1: Loss=0.6443
2025-06-02 16:01:40,891 - DEBUG - Online update step: 2/50
2025-06-02 16:01:40,896 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:41,041 - DEBUG - Node anomaly scores shape: torch.Size([16613, 1])
2025-06-02 16:01:41,048 - DEBUG - Edge anomaly scores shape: torch.Size([34375, 1])
2025-06-02 16:01:41,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:41,349 - DEBUG - Step 2: Loss=0.6470
2025-06-02 16:01:41,350 - DEBUG - Online update step: 3/50
2025-06-02 16:01:41,353 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:41,519 - DEBUG - Node anomaly scores shape: torch.Size([16202, 1])
2025-06-02 16:01:41,527 - DEBUG - Edge anomaly scores shape: torch.Size([33449, 1])
2025-06-02 16:01:41,528 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:41,869 - DEBUG - Step 3: Loss=0.6450
2025-06-02 16:01:41,870 - DEBUG - Online update step: 4/50
2025-06-02 16:01:41,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:42,058 - DEBUG - Node anomaly scores shape: torch.Size([17016, 1])
2025-06-02 16:01:42,067 - DEBUG - Edge anomaly scores shape: torch.Size([35232, 1])
2025-06-02 16:01:42,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:42,402 - DEBUG - Step 4: Loss=0.6438
2025-06-02 16:01:42,403 - DEBUG - Online update step: 5/50
2025-06-02 16:01:42,406 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:42,609 - DEBUG - Node anomaly scores shape: torch.Size([16472, 1])
2025-06-02 16:01:42,620 - DEBUG - Edge anomaly scores shape: torch.Size([34056, 1])
2025-06-02 16:01:42,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:43,006 - DEBUG - Step 5: Loss=0.6427
2025-06-02 16:01:43,007 - DEBUG - Online update step: 6/50
2025-06-02 16:01:43,016 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:43,148 - DEBUG - Node anomaly scores shape: torch.Size([17945, 1])
2025-06-02 16:01:43,155 - DEBUG - Edge anomaly scores shape: torch.Size([37294, 1])
2025-06-02 16:01:43,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:43,454 - DEBUG - Step 6: Loss=0.6432
2025-06-02 16:01:43,455 - DEBUG - Online update step: 7/50
2025-06-02 16:01:43,465 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:43,613 - DEBUG - Node anomaly scores shape: torch.Size([16220, 1])
2025-06-02 16:01:43,620 - DEBUG - Edge anomaly scores shape: torch.Size([33428, 1])
2025-06-02 16:01:43,623 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:43,924 - DEBUG - Step 7: Loss=0.6397
2025-06-02 16:01:43,924 - DEBUG - Online update step: 8/50
2025-06-02 16:01:43,927 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:44,071 - DEBUG - Node anomaly scores shape: torch.Size([15640, 1])
2025-06-02 16:01:44,077 - DEBUG - Edge anomaly scores shape: torch.Size([32092, 1])
2025-06-02 16:01:44,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:44,394 - DEBUG - Step 8: Loss=0.6393
2025-06-02 16:01:44,394 - DEBUG - Online update step: 9/50
2025-06-02 16:01:44,398 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:44,599 - DEBUG - Node anomaly scores shape: torch.Size([17269, 1])
2025-06-02 16:01:44,633 - DEBUG - Edge anomaly scores shape: torch.Size([35641, 1])
2025-06-02 16:01:44,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:45,000 - DEBUG - Step 9: Loss=0.6373
2025-06-02 16:01:45,001 - DEBUG - Online update step: 10/50
2025-06-02 16:01:45,014 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:45,194 - DEBUG - Node anomaly scores shape: torch.Size([15378, 1])
2025-06-02 16:01:45,201 - DEBUG - Edge anomaly scores shape: torch.Size([31543, 1])
2025-06-02 16:01:45,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:45,556 - DEBUG - Step 10: Loss=0.6412
2025-06-02 16:01:45,557 - DEBUG - Online update step: 11/50
2025-06-02 16:01:45,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:45,735 - DEBUG - Node anomaly scores shape: torch.Size([16980, 1])
2025-06-02 16:01:45,746 - DEBUG - Edge anomaly scores shape: torch.Size([35163, 1])
2025-06-02 16:01:45,755 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:46,168 - DEBUG - Step 11: Loss=0.6438
2025-06-02 16:01:46,169 - DEBUG - Online update step: 12/50
2025-06-02 16:01:46,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:46,290 - DEBUG - Node anomaly scores shape: torch.Size([16070, 1])
2025-06-02 16:01:46,296 - DEBUG - Edge anomaly scores shape: torch.Size([33100, 1])
2025-06-02 16:01:46,297 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:46,555 - DEBUG - Step 12: Loss=0.6374
2025-06-02 16:01:46,556 - DEBUG - Online update step: 13/50
2025-06-02 16:01:46,559 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:46,656 - DEBUG - Node anomaly scores shape: torch.Size([16602, 1])
2025-06-02 16:01:46,660 - DEBUG - Edge anomaly scores shape: torch.Size([34328, 1])
2025-06-02 16:01:46,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:46,878 - DEBUG - Step 13: Loss=0.6364
2025-06-02 16:01:46,878 - DEBUG - Online update step: 14/50
2025-06-02 16:01:46,881 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:46,956 - DEBUG - Node anomaly scores shape: torch.Size([16791, 1])
2025-06-02 16:01:46,959 - DEBUG - Edge anomaly scores shape: torch.Size([34793, 1])
2025-06-02 16:01:46,960 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:47,178 - DEBUG - Step 14: Loss=0.6360
2025-06-02 16:01:47,178 - DEBUG - Online update step: 15/50
2025-06-02 16:01:47,181 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:47,258 - DEBUG - Node anomaly scores shape: torch.Size([16119, 1])
2025-06-02 16:01:47,262 - DEBUG - Edge anomaly scores shape: torch.Size([33262, 1])
2025-06-02 16:01:47,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:47,494 - DEBUG - Step 15: Loss=0.6373
2025-06-02 16:01:47,494 - DEBUG - Online update step: 16/50
2025-06-02 16:01:47,497 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:47,584 - DEBUG - Node anomaly scores shape: torch.Size([16103, 1])
2025-06-02 16:01:47,591 - DEBUG - Edge anomaly scores shape: torch.Size([33215, 1])
2025-06-02 16:01:47,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:47,813 - DEBUG - Step 16: Loss=0.6379
2025-06-02 16:01:47,814 - DEBUG - Online update step: 17/50
2025-06-02 16:01:47,817 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:47,915 - DEBUG - Node anomaly scores shape: torch.Size([16992, 1])
2025-06-02 16:01:47,921 - DEBUG - Edge anomaly scores shape: torch.Size([35117, 1])
2025-06-02 16:01:47,922 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:48,164 - DEBUG - Step 17: Loss=0.6361
2025-06-02 16:01:48,164 - DEBUG - Online update step: 18/50
2025-06-02 16:01:48,167 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:48,254 - DEBUG - Node anomaly scores shape: torch.Size([16454, 1])
2025-06-02 16:01:48,258 - DEBUG - Edge anomaly scores shape: torch.Size([33919, 1])
2025-06-02 16:01:48,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:48,459 - DEBUG - Step 18: Loss=0.6393
2025-06-02 16:01:48,459 - DEBUG - Online update step: 19/50
2025-06-02 16:01:48,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:48,586 - DEBUG - Node anomaly scores shape: torch.Size([17239, 1])
2025-06-02 16:01:48,591 - DEBUG - Edge anomaly scores shape: torch.Size([35734, 1])
2025-06-02 16:01:48,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:48,816 - DEBUG - Step 19: Loss=0.6364
2025-06-02 16:01:48,816 - DEBUG - Online update step: 20/50
2025-06-02 16:01:48,819 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:48,909 - DEBUG - Node anomaly scores shape: torch.Size([15495, 1])
2025-06-02 16:01:48,913 - DEBUG - Edge anomaly scores shape: torch.Size([31934, 1])
2025-06-02 16:01:48,914 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:49,091 - DEBUG - Step 20: Loss=0.6394
2025-06-02 16:01:49,091 - DEBUG - Online update step: 21/50
2025-06-02 16:01:49,094 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:49,183 - DEBUG - Node anomaly scores shape: torch.Size([16221, 1])
2025-06-02 16:01:49,187 - DEBUG - Edge anomaly scores shape: torch.Size([33493, 1])
2025-06-02 16:01:49,188 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:49,402 - DEBUG - Step 21: Loss=0.6335
2025-06-02 16:01:49,402 - DEBUG - Online update step: 22/50
2025-06-02 16:01:49,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:49,493 - DEBUG - Node anomaly scores shape: torch.Size([16373, 1])
2025-06-02 16:01:49,497 - DEBUG - Edge anomaly scores shape: torch.Size([33852, 1])
2025-06-02 16:01:49,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:49,694 - DEBUG - Step 22: Loss=0.6420
2025-06-02 16:01:49,694 - DEBUG - Online update step: 23/50
2025-06-02 16:01:49,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:49,798 - DEBUG - Node anomaly scores shape: torch.Size([16935, 1])
2025-06-02 16:01:49,803 - DEBUG - Edge anomaly scores shape: torch.Size([35047, 1])
2025-06-02 16:01:49,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:50,014 - DEBUG - Step 23: Loss=0.6395
2025-06-02 16:01:50,015 - DEBUG - Online update step: 24/50
2025-06-02 16:01:50,018 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:50,119 - DEBUG - Node anomaly scores shape: torch.Size([17127, 1])
2025-06-02 16:01:50,126 - DEBUG - Edge anomaly scores shape: torch.Size([35418, 1])
2025-06-02 16:01:50,128 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:50,328 - DEBUG - Step 24: Loss=0.6398
2025-06-02 16:01:50,329 - DEBUG - Online update step: 25/50
2025-06-02 16:01:50,332 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:50,425 - DEBUG - Node anomaly scores shape: torch.Size([15855, 1])
2025-06-02 16:01:50,429 - DEBUG - Edge anomaly scores shape: torch.Size([32688, 1])
2025-06-02 16:01:50,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:50,646 - DEBUG - Step 25: Loss=0.6357
2025-06-02 16:01:50,646 - DEBUG - Online update step: 26/50
2025-06-02 16:01:50,649 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:50,731 - DEBUG - Node anomaly scores shape: torch.Size([16310, 1])
2025-06-02 16:01:50,738 - DEBUG - Edge anomaly scores shape: torch.Size([33493, 1])
2025-06-02 16:01:50,739 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:50,934 - DEBUG - Step 26: Loss=0.6354
2025-06-02 16:01:50,935 - DEBUG - Online update step: 27/50
2025-06-02 16:01:50,938 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:51,024 - DEBUG - Node anomaly scores shape: torch.Size([16146, 1])
2025-06-02 16:01:51,028 - DEBUG - Edge anomaly scores shape: torch.Size([33251, 1])
2025-06-02 16:01:51,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:51,244 - DEBUG - Step 27: Loss=0.6332
2025-06-02 16:01:51,244 - DEBUG - Online update step: 28/50
2025-06-02 16:01:51,249 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:51,334 - DEBUG - Node anomaly scores shape: torch.Size([16527, 1])
2025-06-02 16:01:51,338 - DEBUG - Edge anomaly scores shape: torch.Size([34088, 1])
2025-06-02 16:01:51,339 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:51,551 - DEBUG - Step 28: Loss=0.6369
2025-06-02 16:01:51,551 - DEBUG - Online update step: 29/50
2025-06-02 16:01:51,555 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:51,667 - DEBUG - Node anomaly scores shape: torch.Size([16694, 1])
2025-06-02 16:01:51,672 - DEBUG - Edge anomaly scores shape: torch.Size([34521, 1])
2025-06-02 16:01:51,673 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:51,886 - DEBUG - Step 29: Loss=0.6367
2025-06-02 16:01:51,887 - DEBUG - Online update step: 30/50
2025-06-02 16:01:51,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:52,004 - DEBUG - Node anomaly scores shape: torch.Size([16948, 1])
2025-06-02 16:01:52,010 - DEBUG - Edge anomaly scores shape: torch.Size([34957, 1])
2025-06-02 16:01:52,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:52,242 - DEBUG - Step 30: Loss=0.6351
2025-06-02 16:01:52,242 - DEBUG - Online update step: 31/50
2025-06-02 16:01:52,245 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:52,338 - DEBUG - Node anomaly scores shape: torch.Size([15204, 1])
2025-06-02 16:01:52,343 - DEBUG - Edge anomaly scores shape: torch.Size([31246, 1])
2025-06-02 16:01:52,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:52,581 - DEBUG - Step 31: Loss=0.6358
2025-06-02 16:01:52,582 - DEBUG - Online update step: 32/50
2025-06-02 16:01:52,585 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:52,671 - DEBUG - Node anomaly scores shape: torch.Size([17075, 1])
2025-06-02 16:01:52,675 - DEBUG - Edge anomaly scores shape: torch.Size([35433, 1])
2025-06-02 16:01:52,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:52,888 - DEBUG - Step 32: Loss=0.6300
2025-06-02 16:01:52,889 - DEBUG - Online update step: 33/50
2025-06-02 16:01:52,895 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:52,991 - DEBUG - Node anomaly scores shape: torch.Size([17918, 1])
2025-06-02 16:01:52,995 - DEBUG - Edge anomaly scores shape: torch.Size([37286, 1])
2025-06-02 16:01:52,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:53,194 - DEBUG - Step 33: Loss=0.6282
2025-06-02 16:01:53,194 - DEBUG - Online update step: 34/50
2025-06-02 16:01:53,200 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:53,309 - DEBUG - Node anomaly scores shape: torch.Size([17897, 1])
2025-06-02 16:01:53,315 - DEBUG - Edge anomaly scores shape: torch.Size([37181, 1])
2025-06-02 16:01:53,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:53,578 - DEBUG - Step 34: Loss=0.6315
2025-06-02 16:01:53,578 - DEBUG - Online update step: 35/50
2025-06-02 16:01:53,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:53,669 - DEBUG - Node anomaly scores shape: torch.Size([16477, 1])
2025-06-02 16:01:53,673 - DEBUG - Edge anomaly scores shape: torch.Size([34127, 1])
2025-06-02 16:01:53,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:53,879 - DEBUG - Step 35: Loss=0.6354
2025-06-02 16:01:53,879 - DEBUG - Online update step: 36/50
2025-06-02 16:01:53,882 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:53,982 - DEBUG - Node anomaly scores shape: torch.Size([17565, 1])
2025-06-02 16:01:53,986 - DEBUG - Edge anomaly scores shape: torch.Size([36303, 1])
2025-06-02 16:01:53,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:54,207 - DEBUG - Step 36: Loss=0.6284
2025-06-02 16:01:54,207 - DEBUG - Online update step: 37/50
2025-06-02 16:01:54,210 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:54,302 - DEBUG - Node anomaly scores shape: torch.Size([15628, 1])
2025-06-02 16:01:54,307 - DEBUG - Edge anomaly scores shape: torch.Size([32088, 1])
2025-06-02 16:01:54,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:54,523 - DEBUG - Step 37: Loss=0.6351
2025-06-02 16:01:54,523 - DEBUG - Online update step: 38/50
2025-06-02 16:01:54,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:54,640 - DEBUG - Node anomaly scores shape: torch.Size([17291, 1])
2025-06-02 16:01:54,645 - DEBUG - Edge anomaly scores shape: torch.Size([35854, 1])
2025-06-02 16:01:54,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:54,896 - DEBUG - Step 38: Loss=0.6297
2025-06-02 16:01:54,897 - DEBUG - Online update step: 39/50
2025-06-02 16:01:54,900 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:54,992 - DEBUG - Node anomaly scores shape: torch.Size([16140, 1])
2025-06-02 16:01:54,998 - DEBUG - Edge anomaly scores shape: torch.Size([33172, 1])
2025-06-02 16:01:54,999 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:55,244 - DEBUG - Step 39: Loss=0.6364
2025-06-02 16:01:55,245 - DEBUG - Online update step: 40/50
2025-06-02 16:01:55,248 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:55,332 - DEBUG - Node anomaly scores shape: torch.Size([15912, 1])
2025-06-02 16:01:55,336 - DEBUG - Edge anomaly scores shape: torch.Size([32824, 1])
2025-06-02 16:01:55,337 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:55,556 - DEBUG - Step 40: Loss=0.6312
2025-06-02 16:01:55,557 - DEBUG - Online update step: 41/50
2025-06-02 16:01:55,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:55,661 - DEBUG - Node anomaly scores shape: torch.Size([16457, 1])
2025-06-02 16:01:55,665 - DEBUG - Edge anomaly scores shape: torch.Size([34097, 1])
2025-06-02 16:01:55,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:55,877 - DEBUG - Step 41: Loss=0.6436
2025-06-02 16:01:55,878 - DEBUG - Online update step: 42/50
2025-06-02 16:01:55,881 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:55,974 - DEBUG - Node anomaly scores shape: torch.Size([17176, 1])
2025-06-02 16:01:55,980 - DEBUG - Edge anomaly scores shape: torch.Size([35582, 1])
2025-06-02 16:01:55,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:56,184 - DEBUG - Step 42: Loss=0.6493
2025-06-02 16:01:56,184 - DEBUG - Online update step: 43/50
2025-06-02 16:01:56,189 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:56,271 - DEBUG - Node anomaly scores shape: torch.Size([15712, 1])
2025-06-02 16:01:56,275 - DEBUG - Edge anomaly scores shape: torch.Size([32329, 1])
2025-06-02 16:01:56,277 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:56,481 - DEBUG - Step 43: Loss=0.6290
2025-06-02 16:01:56,481 - DEBUG - Online update step: 44/50
2025-06-02 16:01:56,484 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:56,573 - DEBUG - Node anomaly scores shape: torch.Size([16805, 1])
2025-06-02 16:01:56,578 - DEBUG - Edge anomaly scores shape: torch.Size([34836, 1])
2025-06-02 16:01:56,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:56,787 - DEBUG - Step 44: Loss=0.6576
2025-06-02 16:01:56,787 - DEBUG - Online update step: 45/50
2025-06-02 16:01:56,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:56,886 - DEBUG - Node anomaly scores shape: torch.Size([15896, 1])
2025-06-02 16:01:56,890 - DEBUG - Edge anomaly scores shape: torch.Size([32770, 1])
2025-06-02 16:01:56,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:57,076 - DEBUG - Step 45: Loss=0.6633
2025-06-02 16:01:57,077 - DEBUG - Online update step: 46/50
2025-06-02 16:01:57,080 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:57,177 - DEBUG - Node anomaly scores shape: torch.Size([16821, 1])
2025-06-02 16:01:57,181 - DEBUG - Edge anomaly scores shape: torch.Size([34693, 1])
2025-06-02 16:01:57,182 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:57,391 - DEBUG - Step 46: Loss=0.6497
2025-06-02 16:01:57,391 - DEBUG - Online update step: 47/50
2025-06-02 16:01:57,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:57,478 - DEBUG - Node anomaly scores shape: torch.Size([15372, 1])
2025-06-02 16:01:57,482 - DEBUG - Edge anomaly scores shape: torch.Size([31544, 1])
2025-06-02 16:01:57,484 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:57,683 - DEBUG - Step 47: Loss=0.6350
2025-06-02 16:01:57,683 - DEBUG - Online update step: 48/50
2025-06-02 16:01:57,694 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:57,784 - DEBUG - Node anomaly scores shape: torch.Size([16217, 1])
2025-06-02 16:01:57,789 - DEBUG - Edge anomaly scores shape: torch.Size([33435, 1])
2025-06-02 16:01:57,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:58,013 - DEBUG - Step 48: Loss=0.6345
2025-06-02 16:01:58,013 - DEBUG - Online update step: 49/50
2025-06-02 16:01:58,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:58,123 - DEBUG - Node anomaly scores shape: torch.Size([16672, 1])
2025-06-02 16:01:58,127 - DEBUG - Edge anomaly scores shape: torch.Size([34569, 1])
2025-06-02 16:01:58,129 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:58,357 - DEBUG - Step 49: Loss=0.6281
2025-06-02 16:01:58,357 - DEBUG - Online update step: 50/50
2025-06-02 16:01:58,363 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:58,460 - DEBUG - Node anomaly scores shape: torch.Size([16485, 1])
2025-06-02 16:01:58,464 - DEBUG - Edge anomaly scores shape: torch.Size([33948, 1])
2025-06-02 16:01:58,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:58,672 - DEBUG - Step 50: Loss=0.6360
2025-06-02 16:01:58,673 - INFO - Online update finished. Average loss: 0.6384, Learning rate: 0.001000
2025-06-02 16:01:58,673 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], current edge mean: [ 9.1475582e+00  1.4118252e+00  5.6848330e+00 -5.8838516e-09
 -9.8064201e-10 -9.8064201e-10 -1.9612840e-09  3.9225680e-09
  9.8064201e-10  1.9612840e-09]
2025-06-02 16:01:58,674 - DEBUG - Node drift difference: 0.0147, Edge drift difference: 0.0087
2025-06-02 16:01:58,675 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.6519257e-09  3.4954144e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.7128591e-08
 -3.9649478e-08 -2.2694110e-08 -2.6085183e-09 -6.7821477e-09
  2.3085339e+00  2.9606128e+00  1.4770241e-01  4.4059081e+00
  2.2694110e-08  3.3380744e+00  5.8621445e+00  7.6083150e+00
  1.4770241e-01  7.9923415e+00  3.1302221e-09  3.7301813e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.0780516e-08 -2.2954962e-08], edge=[ 9.1475582e+00  1.4118252e+00  5.6848330e+00 -5.8838516e-09
 -9.8064201e-10 -9.8064201e-10 -1.9612840e-09  3.9225680e-09
  9.8064201e-10  1.9612840e-09]
2025-06-02 16:01:58,675 - DEBUG - Updated reference std: node=[0.         0.         1.0005475  1.0005475  0.         0.
 0.         1.0005475  1.0005475  1.0005475  1.0005475  1.0005475
 1.0195211  0.27804288 0.37305197 0.5736149  1.0005475  2.9805017
 2.883391   1.4932402  0.37305197 0.23153941 1.0005475  1.0005474
 0.         0.         0.         0.         1.0005475  1.0005475 ], edge=[1.132355  0.5056919 2.1673553 1.0002571 1.0002571 1.0002571 1.0002571
 1.0002571 1.0002571 1.0002573]
2025-06-02 16:01:58,679 - INFO - Online update complete. Loss: 0.6384
2025-06-02 16:01:58,679 - INFO - Running anomaly detection...
2025-06-02 16:01:58,679 - INFO - Starting anomaly detection.
2025-06-02 16:01:58,689 - DEBUG - Node reconstruction errors: [0.4603638  2.5532024  0.15645623 0.05271534 0.06569251 0.12706545
 0.10388592 0.06415408 0.06415404 0.13955538 0.06415407 0.07306398
 0.71214825 0.2951835  0.00761564 0.06117963 0.0971403  0.06118633
 0.10374951 0.06121611 0.05332575 0.00761564 0.21018529 0.06150995
 0.00737036 0.09125527 0.00737012 0.17058147 0.06351039 0.00737012
 0.20147939 0.22873001 0.1499339  0.04921093 0.20349294 0.12787275
 0.14919434 0.06121602 0.10200495 0.3550552  0.09663832 0.00730798
 0.06121602 0.11537585 0.05219907 0.12928301 0.18469411 0.38098258
 0.06313344 0.6279403  0.23676907 0.09144095 0.08983205 0.11758783
 0.04720519 0.084745   0.5201868  0.06182218 0.09684657 0.16457732
 0.28283343 0.20592302 0.00709813 0.17780595 0.262981   0.04720512
 0.01886332 0.04720508 0.00709815 0.20592304 0.07917814 0.07074587
 0.02034599 0.17305952 0.21447654 0.07638904 0.14136437 0.08065872
 0.07462311 0.08553587 0.045107   0.0995886  0.5712026  0.56024337
 0.10164645 0.10549145 0.11982196 0.09747174 0.12138582 0.1717918
 0.0076704  0.09929172 0.02386688 0.11387345 0.09586339 0.94090015
 0.04537665 0.09394344 0.00672338 0.15859695 0.04869294 0.04537665
 0.08643171 0.24012941 0.14214924 0.04971045 0.15469497 0.09653714
 0.02402314 0.6747595  0.38500887 0.04045444 0.07803208 0.0786523
 0.05588056 0.06112188 0.0498382  0.07364162 0.11304338 0.02107921
 0.00932611 0.01427931 0.07225874 0.06139129 0.12196133 0.02107912
 0.06166552 0.0793181  0.12236969 0.03872664 0.07307801 0.02159854
 0.10136101 0.1959889  0.0485776  0.0458312  0.08390006 0.00694841
 0.18096955 0.06357092 0.07905217 0.08782461 0.0130073  0.07905231
 0.06480426 0.18435031 0.04984093 0.19778211 0.11580066 0.12769204
 0.75469    0.12724075 0.09704909 0.02159854 0.0760965  0.06376338
 0.01904787 0.10901718 0.04869336 0.09438954 0.07905178 0.07153139
 0.01904786 0.07307791 0.04491762 0.0635638  0.05692708 0.06343168
 0.09772004 0.12768917 0.08973376 0.02422945 0.00773711 0.17949274
 0.11304019 0.06503637 0.07202595 0.08972359 0.04338697 0.04338691
 0.04924953 0.05517068 0.1134758  0.10547502 0.07678397 0.07110274
 0.01298435 0.07256374 0.04493802 0.01863457 0.08627232 0.07441705
 0.11085007 0.02627496 0.18098012 0.06281875 0.50354034 0.17442241
 0.08589017 0.17367496 0.0217692  0.01904785 0.08977889 0.1135666
 0.11410054 0.06998    0.11833432 0.23525208 0.00853658 0.08998848
 0.04096796 0.04767619 0.08474863 0.10896496 0.08561055 0.01859455
 0.10494224 0.0498385  0.1293152  0.02627498 0.08935776 0.01298435
 0.00765889 0.08474863 0.01904786 0.13055581 0.07028786 0.03266246
 0.08475887 0.00943511 0.13775155 0.11993121 0.12149171 0.04983972
 0.04983799 0.06447148 0.09211291 0.00765889 0.01904788 0.16442439
 0.06306291 0.08157635 0.03191327 0.12881732 0.03239939 0.14252298
 0.07146303 0.1055233  0.03191327 0.04133829 0.00773711 0.00927562
 0.1293158  0.06364777 0.10639865 0.07876391 0.01863473 0.01231231
 0.14921197 0.04338702 0.07770485 0.05840538 0.05603956 0.05327243
 0.09665268 0.07976756 0.10392356 0.2468403  0.10394502 0.06824735
 0.12107542 0.08300711 0.09614075 0.1572239  0.04956719 0.19439098
 0.00923761 0.22277257 0.04924957 0.07010391 0.17685169 0.00757494
 0.06397547 0.08990077 0.10851708 0.04137788 0.16738234 0.07414386
 0.0551707  0.08088718 0.07978794 0.03887661 0.05158277 0.03239939
 0.21223517 0.02611603 0.07328212 0.04350686 0.06281902 0.07890816
 0.06431548 0.0072154  0.04406018 0.08444252 0.00721541 0.00721539
 0.0072154  0.04834719 0.12944292 0.00721541 0.0072154  0.0561115
 0.00721542 0.01812942 0.08674619 0.08812914 0.19367224 0.03327798
 0.08356983 0.05915207 0.09514661 0.02317141 0.1181166  0.04406005
 0.09867022 0.09279548 0.12939881 0.14902118 0.09230364 0.09229817
 0.22988111 0.06137645 0.00721548 0.04956656 0.00721542 0.04834783
 0.06525053 0.00904765 0.00678711 0.00678711 0.00721967 0.02001383
 0.00678711 0.13834015 0.07658482 0.10492925 0.04405993 0.038071
 0.11568151 0.07424401 0.00721555 0.06566311 0.07300779 0.10461483
 0.01760895 0.01863473 0.01231212 0.00721539 0.00704507 0.44576934
 0.15743735 0.01853713 0.15985231 0.11112278 0.04401227 0.92065734
 0.00748993 0.07900166 0.0446334  0.04278884 0.08371811 0.10284775
 0.09133165 0.07235047 0.10343601 0.10459627 0.00766715 0.03130883
 0.08567894 0.00721539 0.04406093 0.07148048 0.01791478 0.06230724
 0.08244495 0.08552144 0.07593943 0.0654439  0.0591393  0.00721542
 0.20268568 0.09002104 0.03859306 0.08388567 0.05493842 0.05498351
 0.05503665 0.11201219 0.00742423 0.11555551 0.0176454  0.10291068
 0.05497219 0.00742415 0.04132177 0.03858691 0.11976438 0.01649832
 0.03859334 0.08629408 0.05500399 0.03859325 0.00742417 0.05497059
 0.05499919 0.01986701 0.02053859 0.05503929 0.00766714 0.07283203
 0.06462251 0.02005187 0.0414798  0.01721268 0.07128813 0.06462274
 0.03213655 0.0963388  0.11924629 0.01263978 0.11136402 0.04823119
 0.05365143 0.06412998 0.055043   0.05498044 0.01764536 0.11027201
 0.07319022 0.01046531 0.05800573 0.03100353 0.1464313  0.01324745
 0.08862334 0.04787947 0.10124494 0.0157466  0.05753297 0.01935052
 0.10300381 0.00804285 0.02394449 0.00771494 0.00804285 0.04286177
 0.01721268 0.05179352 0.03703107 0.09690186 0.04312852 0.02451013
 0.01633413 0.06454529 0.0163341  0.02451012 0.00876917 0.08237448
 0.06854379 0.05890258 0.00876917 0.0431288  0.0774753  0.12910819
 0.08620489 0.04138703 0.08235459 0.04312855 0.00788901 0.03053664
 0.03731591 0.17721057 0.05823559 0.01574657 0.07634135 0.02501887
 0.00804285 0.07079992 0.05342275 0.1298152  0.06422004 0.00788901
 0.05703614 0.00945385 0.11465918 0.0199357  0.04303341 0.23757665
 0.00771495 0.0305367  0.13855572 0.00945385 0.15857382 0.00753157
 0.00872778 0.029895   0.00734997 0.23688063 0.02492273 0.00804285
 0.02270482 0.02450352 0.02450347 0.01836322 0.05134077 0.04521747
 0.00735137 0.0405085  0.07774892 0.10326514 0.04050454 0.03100338
 0.00734995 0.07023714 0.00872778 0.04303326 0.07495327 0.08354969
 0.04048185 0.12239987 0.04521747 0.00771495 0.00771497 0.03053669
 0.04303272 0.03830379 0.08308861 0.11155894 0.00771496 0.06775736
 0.00771494 0.06776463 0.08869163 0.04049534 0.016628   0.5828038
 0.08157136 0.00809091 0.473375   0.00809092 0.00809097 0.00809092
 0.00809091 0.00809092 0.00809091 0.00809091 0.04233452 0.01630899
 0.05294771 0.00809091 0.00809091 0.00809092 0.00809091 0.00809091
 0.00809091 0.00809092 0.00809091 0.00809091 0.04073703 0.00809097
 0.00809091 0.07671852 0.00809092 0.07668043 0.05301242 0.00771495
 0.06965696 0.09202179 0.5482417  0.5482417  0.12109239 0.06965696
 0.00771497 0.00734993 0.00734997 0.00771496 0.00735002 0.03595074
 0.0208899  0.00809186 0.03100331 0.00771495 0.02450353 0.00771495
 0.00771494 0.09208134 0.00771497 0.00734993 0.00771495 0.00771497
 0.04050225 0.00734992 0.00771497 0.00734999 0.00771497 0.00771495
 0.00771495 0.10155939 0.08805329 0.0416779  0.00809091 0.05493159
 0.06231005 0.00771494 0.00734999 0.07447133 0.00809097 0.04950364
 0.06845173 0.00896755 0.00771495 0.00771495 0.0601591  0.10958429
 0.05159827 0.00771494 0.04233453 0.01809098 0.00734992 0.07992101
 0.00809091 0.03351717 0.08416852 0.00809092 0.00809099 0.04233424
 0.01809089 0.00771496 0.19654436 0.06875693 0.07131808 0.10959704
 0.04504641 0.05342854 0.05343207 0.05248969 0.02528894 0.00809091
 0.02423486 0.06770761 0.10957899 0.03832839 0.03425544 0.04481105
 0.00855666 0.00855666 0.00855668 0.00855667 0.00855666 0.04181658
 0.06127647 0.00855666 0.00855677 0.00809092 0.01819388 0.00809092
 0.05343309 0.10006808 0.11753257 0.02271161 0.05343385 0.10292706
 0.04073556 0.02902278 0.0407361  0.00809092 0.05343448 0.00878656
 0.00772235 0.00772236 0.00855666 0.00878656 0.09823761 0.02339835
 0.0462804  0.00809091 0.00855667 0.01829117 0.00772234 0.01265155
 0.00887777 0.05837195 0.0418167  0.13712445 0.01315961 0.09944223
 0.04240521 0.00887778 0.01578432 0.00900159 0.00904525 0.01823725
 0.05524773 0.04840753 0.0540496  0.00887777 0.00887779 0.00887777
 0.0083854  0.057617   0.00887777 0.00904525 0.00887777 0.00887777
 0.00887779 0.04392953 0.00919109 0.06349798 0.10573537 0.07074098
 0.01617305 0.04518966 0.09086018 0.14353718 0.00932787 0.00952996
 0.01840688 0.06176157 0.06176148 0.00904525 0.06964269 0.13515739
 0.0093278  0.00939694 0.01265971 0.08228233 0.00980447 0.00980447
 0.00980447 0.00988426 0.00866306 0.05265356 0.09691386 0.17178419
 0.03073604 0.01313763 0.02424099 0.00939692 0.01657229 0.05398562
 0.00864235 0.07456677 0.0093278  0.13496009 0.00939692 0.05401367
 0.01313763 0.09673376 0.00980447 0.00988427 0.00864238 0.0308329
 0.06222374 0.00988425 0.00988427 0.00988428 0.0245325  1.0194343
 1.1527294  0.00980447 0.13106456 0.00988425 0.08113542 0.03188423
 0.21975413 0.03188466 0.00988426 0.01058053 0.02101192 0.00934582
 0.17855713 0.03189313 0.26850733 0.03333538 0.11232258 0.03188416
 0.06781812 0.06318664 0.03005915 0.12407929 0.06129127 0.00955294
 0.00955294 0.12404374 0.18081227 0.01058053 0.03188417 0.03005913
 0.03188419 0.01067618 0.01000413 0.01000413 0.00891761 0.13095945
 0.01000413 0.01000413 0.01067618 0.07456391 0.01000413 0.01000413
 0.01148571 0.07238162 0.14203264 0.10518102 0.01000413 0.07893888
 0.07456394 0.01000413 0.01059803 0.03326331 0.01067619 0.00934262
 0.1672919  0.02283506 0.01000413 0.02283506 0.02394416 0.1256128
 0.10961771 0.01000413 0.27292135 0.02695925 0.02283508 0.07238171
 0.01247634 0.02695926 0.01059803 0.03148545 0.00998677 0.06619252
 0.03612898 0.06619252 0.23408654 0.01143502 0.03612898 0.01366947
 0.01366946 0.1931844  0.01366945 0.05319609 0.01247576 0.05989421
 0.0335365  0.01143502 0.03353591 0.10514565 0.0939506  0.16825506
 0.0136695  0.03117113 0.05734462 0.01366949 0.18244956 0.15048598
 0.03117114 0.011435   0.01366946 0.22702411 0.01366946 0.0136695
 0.0136695  0.01163385 0.0956383  0.01163385 0.04331651 0.01163386
 0.12720601 0.12720758 0.12720126 0.01366945 0.0136695  0.01366949
 0.01366947 0.8473334  0.04331501 0.01163385 0.01366949 0.01366947
 0.01366948 0.0347178  0.01366951 0.01366945 0.0131989  0.04331489
 0.01323235 0.31712157 0.01319887 0.01366945 0.01366946 0.02990383
 0.09563698 0.11963296 0.11963546 0.01521085 0.07526188 0.07675306
 0.07675312 0.07526191 0.11963329 0.01323235 0.11963538 0.03070386
 0.04828162 0.11963249]
2025-06-02 16:01:58,689 - DEBUG - Edge reconstruction errors: [1.3639675  1.3628509  0.95889825 ... 0.15888062 1.2598772  0.15888062]
2025-06-02 16:01:58,691 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160158_update_39.json
2025-06-02 16:01:58,692 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:01:58,701 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160158_update_39.pth and as latest_checkpoint.pth
2025-06-02 16:01:58,701 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870265.dot): 0.0981
2025-06-02 16:01:58,701 - WARNING - Detected 20 anomalous nodes (reconstruction-based):
2025-06-02 16:01:58,701 - WARNING -   Node ID: 1.1.1.1, Recon Error: 0.4604, MLP Score: 0.5006
2025-06-02 16:01:58,701 - WARNING -   Node ID: 192.168.239.101, Recon Error: 2.5532, MLP Score: 0.5563
2025-06-02 16:01:58,701 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.7121, MLP Score: 0.5069
2025-06-02 16:01:58,701 - WARNING -   Node ID: ff02::2, Recon Error: 0.6279, MLP Score: 0.5128
2025-06-02 16:01:58,701 - WARNING -   Node ID: 192.168.209.130, Recon Error: 0.5202, MLP Score: 0.5195
2025-06-02 16:01:58,701 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 16:01:58,702 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.0728, MLP Score: 0.5532
2025-06-02 16:01:58,702 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 16.7947, MLP Score: 0.5237
2025-06-02 16:01:58,702 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.5104, MLP Score: 0.5088
2025-06-02 16:01:58,702 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.8271, MLP Score: 0.4604
2025-06-02 16:01:58,702 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 3.9754, MLP Score: 0.5025
2025-06-02 16:01:58,702 - INFO - 
--- Processing file: nw_graph_encoded_1748870295.dot (Timestamp: 2025-06-02 15:18:15) ---
2025-06-02 16:01:58,702 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 16:01:58,702 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 16:01:58,735 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 16:01:58,761 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 16:01:58,761 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 16:01:58,761 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870295.dot
2025-06-02 16:01:58,781 - INFO - Parsed 918 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 16:01:58,800 - INFO - Parsed 1958 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870295.dot'.
2025-06-02 16:01:58,801 - INFO - Processing node updates/additions.
2025-06-02 16:01:58,805 - INFO - Processing edge updates/additions.
2025-06-02 16:01:58,814 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:01:58,815 - INFO - Finished updating NetworkX graph.
2025-06-02 16:01:58,815 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:01:58,816 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:01:58,823 - DEBUG - Initial node features tensor shape: torch.Size([918, 30])
2025-06-02 16:01:58,826 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:01:58,826 - DEBUG - Node features tensor shape after scaling: torch.Size([918, 30])
2025-06-02 16:01:58,827 - DEBUG - Edge index tensor shape: torch.Size([2, 1958])
2025-06-02 16:01:58,828 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:01:58,832 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:01:58,833 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:01:58,834 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:01:58,835 - DEBUG - Shape of encoded categorical edge features: torch.Size([1958, 3])
2025-06-02 16:01:58,836 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:01:58,836 - DEBUG - Shape of scaled numerical edge features: torch.Size([1958, 7])
2025-06-02 16:01:58,836 - DEBUG - Final edge attributes tensor shape: torch.Size([1958, 10])
2025-06-02 16:01:58,836 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:01:58,838 - INFO - Performing online update...
2025-06-02 16:01:58,838 - INFO - Starting online update for 50 steps.
2025-06-02 16:01:58,839 - DEBUG - Updated RunningStats: new_mean=0.9442654921479535, new_var=22800000000161.9, new_n=2310
2025-06-02 16:01:58,839 - DEBUG - Updated RunningStats: new_mean=0.9416475316370125, new_var=23100000000017.992, new_n=2340
2025-06-02 16:01:58,839 - DEBUG - Updated RunningStats: new_mean=1.1150388668706985, new_var=7600000000094.213, new_n=770
2025-06-02 16:01:58,839 - DEBUG - Updated RunningStats: new_mean=1.114597200489305, new_var=7700000000001.577, new_n=780
2025-06-02 16:01:58,839 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:01:58,839 - DEBUG - Online update step: 1/50
2025-06-02 16:01:58,841 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:59,025 - DEBUG - Node anomaly scores shape: torch.Size([16299, 1])
2025-06-02 16:01:59,030 - DEBUG - Edge anomaly scores shape: torch.Size([33741, 1])
2025-06-02 16:01:59,031 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:59,181 - DEBUG - Step 1: Loss=0.6321
2025-06-02 16:01:59,181 - DEBUG - Online update step: 2/50
2025-06-02 16:01:59,184 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:59,314 - DEBUG - Node anomaly scores shape: torch.Size([16242, 1])
2025-06-02 16:01:59,318 - DEBUG - Edge anomaly scores shape: torch.Size([33470, 1])
2025-06-02 16:01:59,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:59,490 - DEBUG - Step 2: Loss=0.6330
2025-06-02 16:01:59,490 - DEBUG - Online update step: 3/50
2025-06-02 16:01:59,493 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:59,662 - DEBUG - Node anomaly scores shape: torch.Size([16901, 1])
2025-06-02 16:01:59,667 - DEBUG - Edge anomaly scores shape: torch.Size([34981, 1])
2025-06-02 16:01:59,668 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:01:59,838 - DEBUG - Step 3: Loss=0.6310
2025-06-02 16:01:59,839 - DEBUG - Online update step: 4/50
2025-06-02 16:01:59,844 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:01:59,977 - DEBUG - Node anomaly scores shape: torch.Size([18381, 1])
2025-06-02 16:01:59,982 - DEBUG - Edge anomaly scores shape: torch.Size([38051, 1])
2025-06-02 16:01:59,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:00,165 - DEBUG - Step 4: Loss=0.6263
2025-06-02 16:02:00,165 - DEBUG - Online update step: 5/50
2025-06-02 16:02:00,168 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:00,319 - DEBUG - Node anomaly scores shape: torch.Size([15975, 1])
2025-06-02 16:02:00,324 - DEBUG - Edge anomaly scores shape: torch.Size([32919, 1])
2025-06-02 16:02:00,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:00,549 - DEBUG - Step 5: Loss=0.6269
2025-06-02 16:02:00,549 - DEBUG - Online update step: 6/50
2025-06-02 16:02:00,552 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:00,676 - DEBUG - Node anomaly scores shape: torch.Size([17007, 1])
2025-06-02 16:02:00,681 - DEBUG - Edge anomaly scores shape: torch.Size([35161, 1])
2025-06-02 16:02:00,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:00,934 - DEBUG - Step 6: Loss=0.6292
2025-06-02 16:02:00,935 - DEBUG - Online update step: 7/50
2025-06-02 16:02:00,938 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:01,029 - DEBUG - Node anomaly scores shape: torch.Size([16643, 1])
2025-06-02 16:02:01,035 - DEBUG - Edge anomaly scores shape: torch.Size([34527, 1])
2025-06-02 16:02:01,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:01,264 - DEBUG - Step 7: Loss=0.6245
2025-06-02 16:02:01,265 - DEBUG - Online update step: 8/50
2025-06-02 16:02:01,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:01,365 - DEBUG - Node anomaly scores shape: torch.Size([16241, 1])
2025-06-02 16:02:01,369 - DEBUG - Edge anomaly scores shape: torch.Size([33546, 1])
2025-06-02 16:02:01,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:01,558 - DEBUG - Step 8: Loss=0.6333
2025-06-02 16:02:01,559 - DEBUG - Online update step: 9/50
2025-06-02 16:02:01,564 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:01,661 - DEBUG - Node anomaly scores shape: torch.Size([16967, 1])
2025-06-02 16:02:01,665 - DEBUG - Edge anomaly scores shape: torch.Size([35070, 1])
2025-06-02 16:02:01,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:01,870 - DEBUG - Step 9: Loss=0.6301
2025-06-02 16:02:01,871 - DEBUG - Online update step: 10/50
2025-06-02 16:02:01,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:01,973 - DEBUG - Node anomaly scores shape: torch.Size([16770, 1])
2025-06-02 16:02:01,984 - DEBUG - Edge anomaly scores shape: torch.Size([34678, 1])
2025-06-02 16:02:01,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:02,227 - DEBUG - Step 10: Loss=0.6235
2025-06-02 16:02:02,227 - DEBUG - Online update step: 11/50
2025-06-02 16:02:02,230 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:02,325 - DEBUG - Node anomaly scores shape: torch.Size([16209, 1])
2025-06-02 16:02:02,329 - DEBUG - Edge anomaly scores shape: torch.Size([33464, 1])
2025-06-02 16:02:02,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:02,515 - DEBUG - Step 11: Loss=0.6243
2025-06-02 16:02:02,515 - DEBUG - Online update step: 12/50
2025-06-02 16:02:02,518 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:02,619 - DEBUG - Node anomaly scores shape: torch.Size([18184, 1])
2025-06-02 16:02:02,640 - DEBUG - Edge anomaly scores shape: torch.Size([37837, 1])
2025-06-02 16:02:02,642 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:02,875 - DEBUG - Step 12: Loss=0.6257
2025-06-02 16:02:02,876 - DEBUG - Online update step: 13/50
2025-06-02 16:02:02,879 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:02,976 - DEBUG - Node anomaly scores shape: torch.Size([18181, 1])
2025-06-02 16:02:02,980 - DEBUG - Edge anomaly scores shape: torch.Size([37679, 1])
2025-06-02 16:02:02,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:03,241 - DEBUG - Step 13: Loss=0.6223
2025-06-02 16:02:03,242 - DEBUG - Online update step: 14/50
2025-06-02 16:02:03,244 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:03,321 - DEBUG - Node anomaly scores shape: torch.Size([17213, 1])
2025-06-02 16:02:03,325 - DEBUG - Edge anomaly scores shape: torch.Size([35487, 1])
2025-06-02 16:02:03,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:03,564 - DEBUG - Step 14: Loss=0.6274
2025-06-02 16:02:03,564 - DEBUG - Online update step: 15/50
2025-06-02 16:02:03,569 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:03,675 - DEBUG - Node anomaly scores shape: torch.Size([17806, 1])
2025-06-02 16:02:03,679 - DEBUG - Edge anomaly scores shape: torch.Size([37077, 1])
2025-06-02 16:02:03,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:03,921 - DEBUG - Step 15: Loss=0.6238
2025-06-02 16:02:03,921 - DEBUG - Online update step: 16/50
2025-06-02 16:02:03,924 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:04,015 - DEBUG - Node anomaly scores shape: torch.Size([16859, 1])
2025-06-02 16:02:04,022 - DEBUG - Edge anomaly scores shape: torch.Size([35049, 1])
2025-06-02 16:02:04,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:04,221 - DEBUG - Step 16: Loss=0.6267
2025-06-02 16:02:04,222 - DEBUG - Online update step: 17/50
2025-06-02 16:02:04,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:04,323 - DEBUG - Node anomaly scores shape: torch.Size([16763, 1])
2025-06-02 16:02:04,328 - DEBUG - Edge anomaly scores shape: torch.Size([34619, 1])
2025-06-02 16:02:04,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:04,546 - DEBUG - Step 17: Loss=0.6261
2025-06-02 16:02:04,546 - DEBUG - Online update step: 18/50
2025-06-02 16:02:04,549 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:04,647 - DEBUG - Node anomaly scores shape: torch.Size([17349, 1])
2025-06-02 16:02:04,651 - DEBUG - Edge anomaly scores shape: torch.Size([35995, 1])
2025-06-02 16:02:04,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:04,876 - DEBUG - Step 18: Loss=0.6191
2025-06-02 16:02:04,876 - DEBUG - Online update step: 19/50
2025-06-02 16:02:04,883 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:04,981 - DEBUG - Node anomaly scores shape: torch.Size([16151, 1])
2025-06-02 16:02:04,985 - DEBUG - Edge anomaly scores shape: torch.Size([33345, 1])
2025-06-02 16:02:04,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:05,220 - DEBUG - Step 19: Loss=0.6188
2025-06-02 16:02:05,221 - DEBUG - Online update step: 20/50
2025-06-02 16:02:05,224 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:05,309 - DEBUG - Node anomaly scores shape: torch.Size([17649, 1])
2025-06-02 16:02:05,313 - DEBUG - Edge anomaly scores shape: torch.Size([36593, 1])
2025-06-02 16:02:05,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:05,527 - DEBUG - Step 20: Loss=0.6238
2025-06-02 16:02:05,527 - DEBUG - Online update step: 21/50
2025-06-02 16:02:05,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:05,628 - DEBUG - Node anomaly scores shape: torch.Size([17681, 1])
2025-06-02 16:02:05,633 - DEBUG - Edge anomaly scores shape: torch.Size([36742, 1])
2025-06-02 16:02:05,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:05,864 - DEBUG - Step 21: Loss=0.6192
2025-06-02 16:02:05,865 - DEBUG - Online update step: 22/50
2025-06-02 16:02:05,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:05,975 - DEBUG - Node anomaly scores shape: torch.Size([18033, 1])
2025-06-02 16:02:05,980 - DEBUG - Edge anomaly scores shape: torch.Size([37420, 1])
2025-06-02 16:02:05,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:06,235 - DEBUG - Step 22: Loss=0.6233
2025-06-02 16:02:06,235 - DEBUG - Online update step: 23/50
2025-06-02 16:02:06,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:06,333 - DEBUG - Node anomaly scores shape: torch.Size([16676, 1])
2025-06-02 16:02:06,337 - DEBUG - Edge anomaly scores shape: torch.Size([34452, 1])
2025-06-02 16:02:06,339 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:06,527 - DEBUG - Step 23: Loss=0.6216
2025-06-02 16:02:06,527 - DEBUG - Online update step: 24/50
2025-06-02 16:02:06,534 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:06,619 - DEBUG - Node anomaly scores shape: torch.Size([16177, 1])
2025-06-02 16:02:06,625 - DEBUG - Edge anomaly scores shape: torch.Size([33312, 1])
2025-06-02 16:02:06,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:06,829 - DEBUG - Step 24: Loss=0.6199
2025-06-02 16:02:06,829 - DEBUG - Online update step: 25/50
2025-06-02 16:02:06,832 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:06,920 - DEBUG - Node anomaly scores shape: torch.Size([15893, 1])
2025-06-02 16:02:06,924 - DEBUG - Edge anomaly scores shape: torch.Size([32633, 1])
2025-06-02 16:02:06,925 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:07,110 - DEBUG - Step 25: Loss=0.6184
2025-06-02 16:02:07,110 - DEBUG - Online update step: 26/50
2025-06-02 16:02:07,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:07,216 - DEBUG - Node anomaly scores shape: torch.Size([17339, 1])
2025-06-02 16:02:07,221 - DEBUG - Edge anomaly scores shape: torch.Size([35813, 1])
2025-06-02 16:02:07,223 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:07,444 - DEBUG - Step 26: Loss=0.6203
2025-06-02 16:02:07,444 - DEBUG - Online update step: 27/50
2025-06-02 16:02:07,447 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:07,546 - DEBUG - Node anomaly scores shape: torch.Size([16549, 1])
2025-06-02 16:02:07,550 - DEBUG - Edge anomaly scores shape: torch.Size([34121, 1])
2025-06-02 16:02:07,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:07,740 - DEBUG - Step 27: Loss=0.6161
2025-06-02 16:02:07,740 - DEBUG - Online update step: 28/50
2025-06-02 16:02:07,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:07,826 - DEBUG - Node anomaly scores shape: torch.Size([15910, 1])
2025-06-02 16:02:07,830 - DEBUG - Edge anomaly scores shape: torch.Size([32764, 1])
2025-06-02 16:02:07,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:08,048 - DEBUG - Step 28: Loss=0.6243
2025-06-02 16:02:08,049 - DEBUG - Online update step: 29/50
2025-06-02 16:02:08,055 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:08,158 - DEBUG - Node anomaly scores shape: torch.Size([17451, 1])
2025-06-02 16:02:08,162 - DEBUG - Edge anomaly scores shape: torch.Size([36247, 1])
2025-06-02 16:02:08,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:08,387 - DEBUG - Step 29: Loss=0.6212
2025-06-02 16:02:08,388 - DEBUG - Online update step: 30/50
2025-06-02 16:02:08,395 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:08,510 - DEBUG - Node anomaly scores shape: torch.Size([17143, 1])
2025-06-02 16:02:08,515 - DEBUG - Edge anomaly scores shape: torch.Size([35585, 1])
2025-06-02 16:02:08,517 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:08,747 - DEBUG - Step 30: Loss=0.6190
2025-06-02 16:02:08,747 - DEBUG - Online update step: 31/50
2025-06-02 16:02:08,753 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:08,825 - DEBUG - Node anomaly scores shape: torch.Size([15057, 1])
2025-06-02 16:02:08,828 - DEBUG - Edge anomaly scores shape: torch.Size([30909, 1])
2025-06-02 16:02:08,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:08,974 - DEBUG - Step 31: Loss=0.6193
2025-06-02 16:02:08,975 - DEBUG - Online update step: 32/50
2025-06-02 16:02:08,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:09,059 - DEBUG - Node anomaly scores shape: torch.Size([16607, 1])
2025-06-02 16:02:09,063 - DEBUG - Edge anomaly scores shape: torch.Size([34326, 1])
2025-06-02 16:02:09,065 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:09,225 - DEBUG - Step 32: Loss=0.6193
2025-06-02 16:02:09,226 - DEBUG - Online update step: 33/50
2025-06-02 16:02:09,229 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:09,338 - DEBUG - Node anomaly scores shape: torch.Size([16410, 1])
2025-06-02 16:02:09,343 - DEBUG - Edge anomaly scores shape: torch.Size([34024, 1])
2025-06-02 16:02:09,344 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:09,556 - DEBUG - Step 33: Loss=0.6168
2025-06-02 16:02:09,556 - DEBUG - Online update step: 34/50
2025-06-02 16:02:09,559 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:09,653 - DEBUG - Node anomaly scores shape: torch.Size([17738, 1])
2025-06-02 16:02:09,657 - DEBUG - Edge anomaly scores shape: torch.Size([36915, 1])
2025-06-02 16:02:09,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:09,881 - DEBUG - Step 34: Loss=0.6176
2025-06-02 16:02:09,882 - DEBUG - Online update step: 35/50
2025-06-02 16:02:09,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:09,968 - DEBUG - Node anomaly scores shape: torch.Size([16900, 1])
2025-06-02 16:02:09,973 - DEBUG - Edge anomaly scores shape: torch.Size([35100, 1])
2025-06-02 16:02:09,974 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:10,184 - DEBUG - Step 35: Loss=0.6155
2025-06-02 16:02:10,184 - DEBUG - Online update step: 36/50
2025-06-02 16:02:10,187 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:10,288 - DEBUG - Node anomaly scores shape: torch.Size([17700, 1])
2025-06-02 16:02:10,292 - DEBUG - Edge anomaly scores shape: torch.Size([36859, 1])
2025-06-02 16:02:10,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:10,557 - DEBUG - Step 36: Loss=0.6196
2025-06-02 16:02:10,557 - DEBUG - Online update step: 37/50
2025-06-02 16:02:10,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:10,647 - DEBUG - Node anomaly scores shape: torch.Size([16735, 1])
2025-06-02 16:02:10,650 - DEBUG - Edge anomaly scores shape: torch.Size([34639, 1])
2025-06-02 16:02:10,651 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:10,859 - DEBUG - Step 37: Loss=0.6184
2025-06-02 16:02:10,859 - DEBUG - Online update step: 38/50
2025-06-02 16:02:10,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:10,976 - DEBUG - Node anomaly scores shape: torch.Size([17192, 1])
2025-06-02 16:02:10,981 - DEBUG - Edge anomaly scores shape: torch.Size([35595, 1])
2025-06-02 16:02:10,982 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:11,224 - DEBUG - Step 38: Loss=0.6156
2025-06-02 16:02:11,224 - DEBUG - Online update step: 39/50
2025-06-02 16:02:11,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:11,309 - DEBUG - Node anomaly scores shape: torch.Size([16239, 1])
2025-06-02 16:02:11,313 - DEBUG - Edge anomaly scores shape: torch.Size([33447, 1])
2025-06-02 16:02:11,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:11,546 - DEBUG - Step 39: Loss=0.6147
2025-06-02 16:02:11,546 - DEBUG - Online update step: 40/50
2025-06-02 16:02:11,549 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:11,667 - DEBUG - Node anomaly scores shape: torch.Size([16983, 1])
2025-06-02 16:02:11,675 - DEBUG - Edge anomaly scores shape: torch.Size([35141, 1])
2025-06-02 16:02:11,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:11,920 - DEBUG - Step 40: Loss=0.6163
2025-06-02 16:02:11,920 - DEBUG - Online update step: 41/50
2025-06-02 16:02:11,923 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:12,060 - DEBUG - Node anomaly scores shape: torch.Size([17835, 1])
2025-06-02 16:02:12,072 - DEBUG - Edge anomaly scores shape: torch.Size([36978, 1])
2025-06-02 16:02:12,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:12,384 - DEBUG - Step 41: Loss=0.6138
2025-06-02 16:02:12,385 - DEBUG - Online update step: 42/50
2025-06-02 16:02:12,389 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:12,536 - DEBUG - Node anomaly scores shape: torch.Size([17401, 1])
2025-06-02 16:02:12,541 - DEBUG - Edge anomaly scores shape: torch.Size([35986, 1])
2025-06-02 16:02:12,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:12,886 - DEBUG - Step 42: Loss=0.6155
2025-06-02 16:02:12,886 - DEBUG - Online update step: 43/50
2025-06-02 16:02:12,889 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:12,974 - DEBUG - Node anomaly scores shape: torch.Size([16939, 1])
2025-06-02 16:02:12,978 - DEBUG - Edge anomaly scores shape: torch.Size([35361, 1])
2025-06-02 16:02:12,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:13,598 - DEBUG - Step 43: Loss=0.6129
2025-06-02 16:02:13,599 - DEBUG - Online update step: 44/50
2025-06-02 16:02:13,601 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:13,767 - DEBUG - Node anomaly scores shape: torch.Size([17245, 1])
2025-06-02 16:02:13,771 - DEBUG - Edge anomaly scores shape: torch.Size([35755, 1])
2025-06-02 16:02:13,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:13,994 - DEBUG - Step 44: Loss=0.6168
2025-06-02 16:02:13,994 - DEBUG - Online update step: 45/50
2025-06-02 16:02:13,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:14,093 - DEBUG - Node anomaly scores shape: torch.Size([17285, 1])
2025-06-02 16:02:14,097 - DEBUG - Edge anomaly scores shape: torch.Size([35824, 1])
2025-06-02 16:02:14,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:14,333 - DEBUG - Step 45: Loss=0.6149
2025-06-02 16:02:14,334 - DEBUG - Online update step: 46/50
2025-06-02 16:02:14,337 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:14,440 - DEBUG - Node anomaly scores shape: torch.Size([16271, 1])
2025-06-02 16:02:14,444 - DEBUG - Edge anomaly scores shape: torch.Size([33617, 1])
2025-06-02 16:02:14,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:14,652 - DEBUG - Step 46: Loss=0.6134
2025-06-02 16:02:14,652 - DEBUG - Online update step: 47/50
2025-06-02 16:02:14,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:14,797 - DEBUG - Node anomaly scores shape: torch.Size([15975, 1])
2025-06-02 16:02:14,802 - DEBUG - Edge anomaly scores shape: torch.Size([32834, 1])
2025-06-02 16:02:14,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:15,309 - DEBUG - Step 47: Loss=0.6124
2025-06-02 16:02:15,309 - DEBUG - Online update step: 48/50
2025-06-02 16:02:15,312 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:15,498 - DEBUG - Node anomaly scores shape: torch.Size([15495, 1])
2025-06-02 16:02:15,502 - DEBUG - Edge anomaly scores shape: torch.Size([31797, 1])
2025-06-02 16:02:15,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:15,793 - DEBUG - Step 48: Loss=0.6146
2025-06-02 16:02:15,793 - DEBUG - Online update step: 49/50
2025-06-02 16:02:15,802 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:15,909 - DEBUG - Node anomaly scores shape: torch.Size([15548, 1])
2025-06-02 16:02:15,914 - DEBUG - Edge anomaly scores shape: torch.Size([31810, 1])
2025-06-02 16:02:15,916 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:16,323 - DEBUG - Step 49: Loss=0.6130
2025-06-02 16:02:16,323 - DEBUG - Online update step: 50/50
2025-06-02 16:02:16,329 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:16,447 - DEBUG - Node anomaly scores shape: torch.Size([18445, 1])
2025-06-02 16:02:16,451 - DEBUG - Edge anomaly scores shape: torch.Size([38403, 1])
2025-06-02 16:02:16,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:16,679 - DEBUG - Step 50: Loss=0.6107
2025-06-02 16:02:16,680 - INFO - Online update finished. Average loss: 0.6208, Learning rate: 0.001000
2025-06-02 16:02:16,680 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], current edge mean: [ 9.1465778e+00  1.4101124e+00  5.6848826e+00 -1.9482622e-09
 -4.8706555e-10  4.3835899e-09 -4.8706555e-10  1.4611966e-09
  2.4353277e-09  1.4611966e-09]
2025-06-02 16:02:16,681 - DEBUG - Node drift difference: 0.0134, Edge drift difference: 0.0034
2025-06-02 16:02:16,682 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  5.4540198e-08 -1.7141206e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -2.6750669e-08
  4.8826461e-08 -1.6102344e-08 -1.4544053e-08  7.2720265e-09
  2.3082788e+00  2.9607842e+00  1.4270152e-01  4.4074073e+00
  1.1946900e-08  3.3213508e+00  5.8714595e+00  7.6034861e+00
  1.4270152e-01  7.9923749e+00  1.2985761e-09  9.0900327e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.4024622e-08  4.9865324e-08], edge=[ 9.1465778e+00  1.4101124e+00  5.6848826e+00 -1.9482622e-09
 -4.8706555e-10  4.3835899e-09 -4.8706555e-10  1.4611966e-09
  2.4353277e-09  1.4611966e-09]
2025-06-02 16:02:16,682 - DEBUG - Updated reference std: node=[0.         0.         1.0005451  1.0005451  0.         0.
 0.         1.0005451  1.0005451  1.0005451  1.0005451  1.0005451
 1.0198451  0.27744794 0.36818114 0.57352495 1.000545   2.9750328
 2.8805428  1.5016054  0.36818114 0.23103443 1.0005451  1.0005451
 0.         0.         0.         0.         1.0005451  1.000545  ], edge=[1.1286514  0.50530136 2.170148   1.0002555  1.0002555  1.0002555
 1.0002555  1.0002555  1.0002555  1.0002555 ]
2025-06-02 16:02:16,682 - INFO - Online update complete. Loss: 0.6208
2025-06-02 16:02:16,683 - INFO - Running anomaly detection...
2025-06-02 16:02:16,683 - INFO - Starting anomaly detection.
2025-06-02 16:02:16,692 - DEBUG - Node reconstruction errors: [0.3667141  1.6513239  0.13520022 0.03534809 0.04534813 0.09086455
 0.09485505 0.04912255 0.04912253 0.09937917 0.04912256 0.0259406
 0.60993385 0.22893013 0.00376193 0.04577198 0.02878221 0.0457742
 0.04732521 0.04608921 0.04186956 0.00376194 0.13759512 0.0262304
 0.00400643 0.0579419  0.00400635 0.10261241 0.04838475 0.00400635
 0.12493106 0.1963143  0.08970845 0.02965021 0.13047478 0.08723034
 0.11821381 0.0460891  0.10796053 0.23631151 0.03526765 0.00338362
 0.0460891  0.0660813  0.0286617  0.06703541 0.06498209 0.35611394
 0.04783846 0.35885817 0.15182799 0.05292904 0.05564281 0.05160054
 0.037734   0.09222689 0.3001756  0.04730739 0.04034894 0.08061586
 0.23511465 0.13450958 0.00311943 0.08743703 0.24834757 0.03773398
 0.01263426 0.03773394 0.00311947 0.1345094  0.05707088 0.05075075
 0.01351105 0.13517809 0.15740976 0.05509352 0.16610835 0.07094376
 0.0546876  0.06737182 0.02424129 0.07312353 0.5445518  0.1942642
 0.07880443 0.05398817 0.11962207 0.07171814 0.09383489 0.17006959
 0.00458275 0.05987999 0.01221825 0.09064443 0.05883573 0.3841093
 0.02506765 0.07044019 0.00290383 0.10519084 0.03811583 0.02506765
 0.03943787 0.22933795 0.07000922 0.03886218 0.08847625 0.05749575
 0.01166282 0.39651552 0.2912039  0.02367219 0.05041058 0.07525747
 0.0443036  0.05687075 0.03920824 0.05387528 0.08586915 0.01314827
 0.00589101 0.00831594 0.07099001 0.02640364 0.09226611 0.01314758
 0.02945563 0.05513667 0.09290789 0.02561909 0.03843689 0.01432663
 0.060843   0.26740578 0.04025866 0.03649174 0.03385171 0.00290117
 0.15145788 0.04245997 0.04961706 0.08652166 0.00871578 0.04961711
 0.07016058 0.1772065  0.03920716 0.15514229 0.07034516 0.10098974
 0.6576731  0.08093705 0.0834043  0.01432663 0.04899647 0.04677487
 0.01153369 0.09024181 0.03811587 0.04078382 0.04961689 0.05195802
 0.01153369 0.0384369  0.03687166 0.04243547 0.04955567 0.05119675
 0.0528987  0.10089981 0.07433139 0.01526367 0.00421208 0.21347359
 0.08586903 0.08280847 0.05581485 0.07423361 0.03426564 0.03426582
 0.03840896 0.03094056 0.06763735 0.08743878 0.05252786 0.05454193
 0.00842466 0.05513162 0.03591105 0.01103025 0.06576313 0.05673959
 0.06736376 0.01564266 0.15146393 0.03464623 0.4787508  0.11628377
 0.06401996 0.11486252 0.01479769 0.0115337  0.05365739 0.08516213
 0.08528052 0.03269412 0.07891926 0.18935248 0.00446118 0.07686971
 0.03384315 0.03673483 0.04762327 0.0833713  0.06389538 0.01215993
 0.07854155 0.03920812 0.12869123 0.01564266 0.07750187 0.00842466
 0.00409834 0.04762327 0.01153369 0.09787048 0.05152803 0.01974789
 0.07214628 0.00661654 0.06432647 0.09718724 0.09234235 0.03920756
 0.0392082  0.03913082 0.07446032 0.00409834 0.01153369 0.11846308
 0.04578052 0.06153776 0.02092835 0.09764268 0.01949164 0.10935678
 0.05588971 0.09947506 0.02092835 0.02636242 0.00421208 0.004088
 0.12869184 0.04948839 0.09584265 0.06283171 0.01103031 0.00731133
 0.09806773 0.03426559 0.06489868 0.03331593 0.04024474 0.0579804
 0.07221992 0.04820818 0.08283331 0.16282973 0.08284938 0.05822427
 0.11472717 0.07390649 0.07887463 0.10395703 0.043387   0.17158145
 0.00517406 0.20068073 0.03840897 0.05139076 0.14811924 0.00375403
 0.05166734 0.02842381 0.08278879 0.01450364 0.14029516 0.05216534
 0.03094056 0.04231512 0.04857576 0.02366528 0.04578886 0.01949164
 0.1733462  0.01610612 0.05867016 0.03416916 0.03464624 0.03626384
 0.05424932 0.00303675 0.03869452 0.06584801 0.00303672 0.00303673
 0.00303674 0.04049167 0.08258765 0.00303674 0.00303674 0.0418244
 0.00303674 0.01053112 0.04341445 0.07510195 0.19574107 0.01763855
 0.04589713 0.03268973 0.11623527 0.01503345 0.09024178 0.03869438
 0.05600196 0.07947747 0.08314332 0.14490005 0.07971153 0.07970485
 0.20636962 0.03283499 0.00303681 0.04338579 0.00303674 0.04049278
 0.03876196 0.00385476 0.00286322 0.00286323 0.0030388  0.01205415
 0.00286322 0.11056182 0.0571596  0.07853622 0.03869389 0.0139628
 0.09475034 0.06261835 0.00303683 0.05430441 0.06952286 0.09194279
 0.01009317 0.01103031 0.00719219 0.00303673 0.00293423 0.10750096
 0.14650112 0.01130399 0.14432688 0.0894726  0.03862607 0.21263677
 0.00407052 0.05268437 0.03452533 0.03600068 0.06873474 0.0833307
 0.08035161 0.07533585 0.08512508 0.09192512 0.00408518 0.01987195
 0.05366341 0.00303673 0.03869572 0.05024256 0.01170305 0.0507194
 0.04063742 0.06633691 0.05313585 0.03521047 0.05157369 0.00303674
 0.18465717 0.0654894  0.03093631 0.09475236 0.04689876 0.04697153
 0.04705562 0.04780189 0.00322192 0.05041545 0.01009618 0.08838649
 0.04695377 0.00322187 0.03270441 0.03090438 0.0946518  0.00995053
 0.03093764 0.05466553 0.04700432 0.03093733 0.00322188 0.04695057
 0.04699618 0.0123554  0.01261494 0.04706002 0.00408521 0.04758064
 0.03717671 0.01171249 0.03327078 0.01118087 0.07241973 0.03717624
 0.0184594  0.08582397 0.08536323 0.00798642 0.09006743 0.03768559
 0.04676837 0.05255144 0.04706612 0.04696683 0.0100962  0.09409576
 0.07107132 0.07224812 0.03741069 0.01978259 0.12544896 0.00803379
 0.05758721 0.03390654 0.06520851 0.01013952 0.02715118 0.01249744
 0.07950969 0.00432764 0.01545772 0.00347102 0.00432764 0.03456591
 0.01118089 0.03058109 0.02127299 0.10875072 0.03347506 0.01576504
 0.01063366 0.02321082 0.01063366 0.01576503 0.00357795 0.07539045
 0.0388718  0.02889692 0.00357795 0.03345684 0.0612344  0.12555474
 0.06354367 0.03286616 0.07536697 0.0334751  0.00417486 0.01999843
 0.01796768 0.16749273 0.03804209 0.01013951 0.0854992  0.01514446
 0.00432764 0.04571184 0.04137946 0.12611029 0.05378467 0.00417486
 0.04670185 0.00550382 0.10631308 0.01286512 0.03312935 0.14664422
 0.00347103 0.01999843 0.12714471 0.00550384 0.13337882 0.00352979
 0.00356735 0.01901949 0.00317675 0.22627026 0.01540305 0.00432764
 0.01676314 0.01536234 0.01536233 0.01146649 0.12242573 0.02901782
 0.00317746 0.03512168 0.0303995  0.08506449 0.03511674 0.01978253
 0.00317673 0.03677308 0.00356735 0.03312777 0.0365497  0.05084886
 0.03509133 0.10503864 0.02901782 0.00347103 0.00347101 0.01999843
 0.03311931 0.03043307 0.07206561 0.09473057 0.00347101 0.05478104
 0.00347102 0.054788   0.06930254 0.0351058  0.00997097 0.22946945
 0.04602404 0.00375629 0.30355647 0.00375627 0.00375629 0.00375631
 0.00375628 0.00375627 0.00375628 0.00375628 0.03483077 0.00969145
 0.04185187 0.0037563  0.00375628 0.00375628 0.00375628 0.00375629
 0.00375628 0.00375628 0.00375628 0.00375628 0.03464397 0.00375631
 0.00375628 0.08582327 0.00375628 0.03826425 0.0468228  0.00347103
 0.05993515 0.08607717 0.1286976  0.1286976  0.10494471 0.05993515
 0.003471   0.00317674 0.00317675 0.00347103 0.00317676 0.01627514
 0.01259074 0.00375674 0.01978249 0.00347103 0.01536235 0.00347103
 0.00347101 0.06076693 0.00347103 0.00317674 0.00347103 0.003471
 0.03511371 0.00317674 0.003471   0.00317678 0.00347101 0.00347102
 0.00347103 0.08133462 0.067871   0.03310589 0.00375628 0.04204344
 0.06036473 0.00347102 0.00317676 0.05999492 0.00375631 0.0321911
 0.04842576 0.00442345 0.00347102 0.00347103 0.04729248 0.09067558
 0.045685   0.00347102 0.0348309  0.01068805 0.00317675 0.04846396
 0.00375628 0.03045776 0.0642078  0.00375627 0.00375637 0.03483061
 0.01068803 0.00347101 0.17821798 0.05486412 0.05518316 0.09068782
 0.02763883 0.04265464 0.04265729 0.04820776 0.01572051 0.00375628
 0.01533117 0.06430406 0.09067311 0.03118479 0.02164156 0.02873146
 0.00415541 0.00415541 0.00415543 0.00415543 0.00415541 0.03502611
 0.05563441 0.00415541 0.00415548 0.00375628 0.01081061 0.00375628
 0.04265807 0.08236832 0.0994291  0.01614775 0.04265905 0.08298694
 0.03464307 0.01864416 0.03464355 0.00375628 0.04265947 0.00363187
 0.00340964 0.00340963 0.00415541 0.00363187 0.08460673 0.03445702
 0.02832594 0.00375628 0.00415542 0.03707539 0.00340961 0.00725756
 0.00478991 0.03553154 0.03502622 0.12995617 0.00658341 0.0712997
 0.03544418 0.00478991 0.00829951 0.00376133 0.00491566 0.01101537
 0.04297005 0.02907133 0.0423414  0.00478991 0.00478991 0.00478991
 0.00436533 0.03707539 0.00478991 0.00491566 0.00478991 0.00478991
 0.00478991 0.03520304 0.0038971  0.05001025 0.08573834 0.05589262
 0.00995525 0.02869271 0.07653534 0.06488772 0.00502894 0.00406805
 0.01119015 0.04650216 0.04650219 0.00491566 0.05136185 0.13158359
 0.00502894 0.0050252  0.01260964 0.06198384 0.00438043 0.00438043
 0.00438043 0.00560574 0.00479466 0.03650907 0.06119597 0.15639496
 0.01183241 0.00774081 0.01534232 0.00502518 0.00984927 0.0425558
 0.00451012 0.0341609  0.00502894 0.1312864  0.00502518 0.04259729
 0.00774081 0.05715878 0.00438043 0.00560579 0.00451011 0.02009089
 0.04636944 0.00560575 0.00560575 0.00560574 0.09166161 0.2500898
 1.0792308  0.00438043 0.11397842 0.00560576 0.06259482 0.01998159
 0.12689342 0.01998171 0.00560572 0.00631322 0.00984174 0.00528372
 0.16162589 0.01998452 0.1793367  0.00863384 0.08006068 0.01998155
 0.04999335 0.04644794 0.01473314 0.10598521 0.0485567  0.00566294
 0.00566293 0.09720027 0.16316237 0.00631322 0.01998155 0.01473317
 0.01998156 0.0069526  0.00612887 0.00612887 0.00514398 0.10216449
 0.0130308  0.00612887 0.0069526  0.01681002 0.00612887 0.00612887
 0.00731348 0.0311751  0.111928   0.09095518 0.00612887 0.05700701
 0.01681001 0.00612887 0.00692327 0.0100572  0.0093571  0.0093571
 0.12077464 0.0100572  0.00612887 0.0100572  0.01176542 0.10961811
 0.0660979  0.00612887 0.23603565 0.01509111 0.01005722 0.03117516
 0.00863649 0.01509111 0.00692327 0.01093065 0.00666875 0.04852566
 0.02107058 0.04852564 0.20151888 0.00803285 0.02107058 0.01024284
 0.01024284 0.09584791 0.01024285 0.05054884 0.00863621 0.04262954
 0.01609387 0.00803285 0.01609359 0.06624987 0.0680965  0.11513527
 0.01024282 0.01118828 0.0226343  0.01024281 0.1603165  0.12167247
 0.01073438 0.00803286 0.01024284 0.1991193  0.01024284 0.01024283
 0.01024284 0.00801326 0.07028664 0.00801326 0.02203193 0.00801326
 0.07928632 0.09312166 0.07928602 0.01024283 0.01024285 0.01024282
 0.01024284 0.7483319  0.02203124 0.00801326 0.01024281 0.01024284
 0.01024285 0.02901036 0.01024281 0.01024283 0.0103135  0.02203121
 0.00944477 0.19428778 0.01031351 0.01024283 0.01024283 0.02391898
 0.07507426 0.08425627 0.0842613  0.01218371 0.04538635 0.03210582
 0.02039964 0.05238297 0.08425797 0.00944477 0.08426116 0.01110101
 0.02039964 0.08425629 0.01447467 0.00944477 0.03029952 0.01218371]
2025-06-02 16:02:16,692 - DEBUG - Edge reconstruction errors: [1.3646271  1.3628083  0.95904124 ... 0.15902448 1.2599771  0.15902448]
2025-06-02 16:02:16,694 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160216_update_40.json
2025-06-02 16:02:16,695 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:02:16,703 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160216_update_40.pth and as latest_checkpoint.pth
2025-06-02 16:02:16,704 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870295.dot): 0.0992
2025-06-02 16:02:16,704 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 16:02:16,704 - WARNING -   Node ID: 1.1.1.1, Recon Error: 0.3667, MLP Score: 0.4888
2025-06-02 16:02:16,704 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6513, MLP Score: 0.5266
2025-06-02 16:02:16,704 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.6099, MLP Score: 0.4830
2025-06-02 16:02:16,704 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.3561, MLP Score: 0.4753
2025-06-02 16:02:16,704 - WARNING -   Node ID: ff02::2, Recon Error: 0.3589, MLP Score: 0.4859
2025-06-02 16:02:16,704 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-02 16:02:16,704 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1331, MLP Score: 0.4860
2025-06-02 16:02:16,704 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.1371, MLP Score: 0.4605
2025-06-02 16:02:16,704 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4790, MLP Score: 0.4720
2025-06-02 16:02:16,705 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 4.8774, MLP Score: 0.4092
2025-06-02 16:02:16,705 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.2162, MLP Score: 0.4754
2025-06-02 16:02:16,705 - INFO - 
--- Processing file: nw_graph_encoded_1748870325.dot (Timestamp: 2025-06-02 15:18:45) ---
2025-06-02 16:02:16,705 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 16:02:16,705 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 16:02:16,734 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 16:02:16,761 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 16:02:16,761 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 16:02:16,761 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870325.dot
2025-06-02 16:02:16,783 - INFO - Parsed 922 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 16:02:16,805 - INFO - Parsed 1981 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870325.dot'.
2025-06-02 16:02:16,805 - INFO - Processing node updates/additions.
2025-06-02 16:02:16,810 - INFO - Processing edge updates/additions.
2025-06-02 16:02:16,820 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:02:16,821 - INFO - Finished updating NetworkX graph.
2025-06-02 16:02:16,821 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:02:16,822 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:02:16,831 - DEBUG - Initial node features tensor shape: torch.Size([922, 30])
2025-06-02 16:02:16,833 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:02:16,833 - DEBUG - Node features tensor shape after scaling: torch.Size([922, 30])
2025-06-02 16:02:16,834 - DEBUG - Edge index tensor shape: torch.Size([2, 1981])
2025-06-02 16:02:16,835 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:02:16,839 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:02:16,840 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:02:16,841 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:02:16,842 - DEBUG - Shape of encoded categorical edge features: torch.Size([1981, 3])
2025-06-02 16:02:16,843 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:02:16,843 - DEBUG - Shape of scaled numerical edge features: torch.Size([1981, 7])
2025-06-02 16:02:16,843 - DEBUG - Final edge attributes tensor shape: torch.Size([1981, 10])
2025-06-02 16:02:16,844 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:02:16,846 - INFO - Performing online update...
2025-06-02 16:02:16,846 - INFO - Starting online update for 50 steps.
2025-06-02 16:02:16,846 - DEBUG - Updated RunningStats: new_mean=0.9443832966486937, new_var=23400000000161.7, new_n=2370
2025-06-02 16:02:16,846 - DEBUG - Updated RunningStats: new_mean=0.9418362403986674, new_var=23700000000018.027, new_n=2400
2025-06-02 16:02:16,847 - DEBUG - Updated RunningStats: new_mean=1.1210405831534358, new_var=7800000000094.071, new_n=790
2025-06-02 16:02:16,847 - DEBUG - Updated RunningStats: new_mean=1.1205316374139198, new_var=7900000000001.589, new_n=800
2025-06-02 16:02:16,847 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:02:16,847 - DEBUG - Online update step: 1/50
2025-06-02 16:02:16,849 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:16,984 - DEBUG - Node anomaly scores shape: torch.Size([16672, 1])
2025-06-02 16:02:17,004 - DEBUG - Edge anomaly scores shape: torch.Size([34368, 1])
2025-06-02 16:02:17,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:17,182 - DEBUG - Step 1: Loss=0.6098
2025-06-02 16:02:17,182 - DEBUG - Online update step: 2/50
2025-06-02 16:02:17,185 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:17,312 - DEBUG - Node anomaly scores shape: torch.Size([17845, 1])
2025-06-02 16:02:17,317 - DEBUG - Edge anomaly scores shape: torch.Size([37031, 1])
2025-06-02 16:02:17,318 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:17,504 - DEBUG - Step 2: Loss=0.6128
2025-06-02 16:02:17,504 - DEBUG - Online update step: 3/50
2025-06-02 16:02:17,507 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:17,656 - DEBUG - Node anomaly scores shape: torch.Size([15787, 1])
2025-06-02 16:02:17,660 - DEBUG - Edge anomaly scores shape: torch.Size([32479, 1])
2025-06-02 16:02:17,661 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:17,811 - DEBUG - Step 3: Loss=0.6120
2025-06-02 16:02:17,811 - DEBUG - Online update step: 4/50
2025-06-02 16:02:17,814 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:17,979 - DEBUG - Node anomaly scores shape: torch.Size([16605, 1])
2025-06-02 16:02:17,985 - DEBUG - Edge anomaly scores shape: torch.Size([34384, 1])
2025-06-02 16:02:17,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:18,141 - DEBUG - Step 4: Loss=0.6108
2025-06-02 16:02:18,142 - DEBUG - Online update step: 5/50
2025-06-02 16:02:18,145 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:18,274 - DEBUG - Node anomaly scores shape: torch.Size([18006, 1])
2025-06-02 16:02:18,279 - DEBUG - Edge anomaly scores shape: torch.Size([37330, 1])
2025-06-02 16:02:18,280 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:18,469 - DEBUG - Step 5: Loss=0.6078
2025-06-02 16:02:18,469 - DEBUG - Online update step: 6/50
2025-06-02 16:02:18,472 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:18,616 - DEBUG - Node anomaly scores shape: torch.Size([17245, 1])
2025-06-02 16:02:18,621 - DEBUG - Edge anomaly scores shape: torch.Size([35804, 1])
2025-06-02 16:02:18,622 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:18,792 - DEBUG - Step 6: Loss=0.6118
2025-06-02 16:02:18,792 - DEBUG - Online update step: 7/50
2025-06-02 16:02:18,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:18,934 - DEBUG - Node anomaly scores shape: torch.Size([16077, 1])
2025-06-02 16:02:18,938 - DEBUG - Edge anomaly scores shape: torch.Size([33133, 1])
2025-06-02 16:02:18,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:19,092 - DEBUG - Step 7: Loss=0.6102
2025-06-02 16:02:19,093 - DEBUG - Online update step: 8/50
2025-06-02 16:02:19,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:19,233 - DEBUG - Node anomaly scores shape: torch.Size([17501, 1])
2025-06-02 16:02:19,238 - DEBUG - Edge anomaly scores shape: torch.Size([36310, 1])
2025-06-02 16:02:19,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:19,420 - DEBUG - Step 8: Loss=0.6091
2025-06-02 16:02:19,420 - DEBUG - Online update step: 9/50
2025-06-02 16:02:19,423 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:19,541 - DEBUG - Node anomaly scores shape: torch.Size([16296, 1])
2025-06-02 16:02:19,545 - DEBUG - Edge anomaly scores shape: torch.Size([33733, 1])
2025-06-02 16:02:19,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:19,704 - DEBUG - Step 9: Loss=0.6081
2025-06-02 16:02:19,705 - DEBUG - Online update step: 10/50
2025-06-02 16:02:19,708 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:19,837 - DEBUG - Node anomaly scores shape: torch.Size([17141, 1])
2025-06-02 16:02:19,842 - DEBUG - Edge anomaly scores shape: torch.Size([35467, 1])
2025-06-02 16:02:19,843 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:20,101 - DEBUG - Step 10: Loss=0.6100
2025-06-02 16:02:20,102 - DEBUG - Online update step: 11/50
2025-06-02 16:02:20,111 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:20,233 - DEBUG - Node anomaly scores shape: torch.Size([16506, 1])
2025-06-02 16:02:20,238 - DEBUG - Edge anomaly scores shape: torch.Size([34013, 1])
2025-06-02 16:02:20,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:20,472 - DEBUG - Step 11: Loss=0.6087
2025-06-02 16:02:20,473 - DEBUG - Online update step: 12/50
2025-06-02 16:02:20,479 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:20,563 - DEBUG - Node anomaly scores shape: torch.Size([15219, 1])
2025-06-02 16:02:20,566 - DEBUG - Edge anomaly scores shape: torch.Size([31221, 1])
2025-06-02 16:02:20,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:20,760 - DEBUG - Step 12: Loss=0.6093
2025-06-02 16:02:20,760 - DEBUG - Online update step: 13/50
2025-06-02 16:02:20,763 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:20,859 - DEBUG - Node anomaly scores shape: torch.Size([17877, 1])
2025-06-02 16:02:20,863 - DEBUG - Edge anomaly scores shape: torch.Size([37111, 1])
2025-06-02 16:02:20,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:21,074 - DEBUG - Step 13: Loss=0.6056
2025-06-02 16:02:21,074 - DEBUG - Online update step: 14/50
2025-06-02 16:02:21,078 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:21,171 - DEBUG - Node anomaly scores shape: torch.Size([16178, 1])
2025-06-02 16:02:21,175 - DEBUG - Edge anomaly scores shape: torch.Size([33262, 1])
2025-06-02 16:02:21,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:21,381 - DEBUG - Step 14: Loss=0.6093
2025-06-02 16:02:21,381 - DEBUG - Online update step: 15/50
2025-06-02 16:02:21,384 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:21,490 - DEBUG - Node anomaly scores shape: torch.Size([17903, 1])
2025-06-02 16:02:21,495 - DEBUG - Edge anomaly scores shape: torch.Size([37266, 1])
2025-06-02 16:02:21,497 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:21,721 - DEBUG - Step 15: Loss=0.6068
2025-06-02 16:02:21,721 - DEBUG - Online update step: 16/50
2025-06-02 16:02:21,724 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:21,817 - DEBUG - Node anomaly scores shape: torch.Size([16310, 1])
2025-06-02 16:02:21,822 - DEBUG - Edge anomaly scores shape: torch.Size([33662, 1])
2025-06-02 16:02:21,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:22,046 - DEBUG - Step 16: Loss=0.6066
2025-06-02 16:02:22,046 - DEBUG - Online update step: 17/50
2025-06-02 16:02:22,049 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:22,147 - DEBUG - Node anomaly scores shape: torch.Size([17693, 1])
2025-06-02 16:02:22,152 - DEBUG - Edge anomaly scores shape: torch.Size([36774, 1])
2025-06-02 16:02:22,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:22,376 - DEBUG - Step 17: Loss=0.6043
2025-06-02 16:02:22,377 - DEBUG - Online update step: 18/50
2025-06-02 16:02:22,380 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:22,486 - DEBUG - Node anomaly scores shape: torch.Size([16942, 1])
2025-06-02 16:02:22,491 - DEBUG - Edge anomaly scores shape: torch.Size([35160, 1])
2025-06-02 16:02:22,492 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:22,699 - DEBUG - Step 18: Loss=0.6080
2025-06-02 16:02:22,699 - DEBUG - Online update step: 19/50
2025-06-02 16:02:22,702 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:22,809 - DEBUG - Node anomaly scores shape: torch.Size([17453, 1])
2025-06-02 16:02:22,814 - DEBUG - Edge anomaly scores shape: torch.Size([36251, 1])
2025-06-02 16:02:22,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:23,072 - DEBUG - Step 19: Loss=0.6049
2025-06-02 16:02:23,072 - DEBUG - Online update step: 20/50
2025-06-02 16:02:23,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:23,196 - DEBUG - Node anomaly scores shape: torch.Size([18286, 1])
2025-06-02 16:02:23,201 - DEBUG - Edge anomaly scores shape: torch.Size([37965, 1])
2025-06-02 16:02:23,206 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:23,488 - DEBUG - Step 20: Loss=0.6052
2025-06-02 16:02:23,489 - DEBUG - Online update step: 21/50
2025-06-02 16:02:23,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:23,591 - DEBUG - Node anomaly scores shape: torch.Size([16558, 1])
2025-06-02 16:02:23,595 - DEBUG - Edge anomaly scores shape: torch.Size([34242, 1])
2025-06-02 16:02:23,597 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:23,837 - DEBUG - Step 21: Loss=0.6037
2025-06-02 16:02:23,837 - DEBUG - Online update step: 22/50
2025-06-02 16:02:23,840 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:23,965 - DEBUG - Node anomaly scores shape: torch.Size([16810, 1])
2025-06-02 16:02:23,975 - DEBUG - Edge anomaly scores shape: torch.Size([34617, 1])
2025-06-02 16:02:23,978 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:24,401 - DEBUG - Step 22: Loss=0.6066
2025-06-02 16:02:24,401 - DEBUG - Online update step: 23/50
2025-06-02 16:02:24,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:24,569 - DEBUG - Node anomaly scores shape: torch.Size([15477, 1])
2025-06-02 16:02:24,575 - DEBUG - Edge anomaly scores shape: torch.Size([31873, 1])
2025-06-02 16:02:24,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:24,837 - DEBUG - Step 23: Loss=0.6050
2025-06-02 16:02:24,837 - DEBUG - Online update step: 24/50
2025-06-02 16:02:24,840 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:24,944 - DEBUG - Node anomaly scores shape: torch.Size([16217, 1])
2025-06-02 16:02:24,948 - DEBUG - Edge anomaly scores shape: torch.Size([33349, 1])
2025-06-02 16:02:24,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:25,129 - DEBUG - Step 24: Loss=0.6043
2025-06-02 16:02:25,130 - DEBUG - Online update step: 25/50
2025-06-02 16:02:25,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:25,276 - DEBUG - Node anomaly scores shape: torch.Size([17848, 1])
2025-06-02 16:02:25,285 - DEBUG - Edge anomaly scores shape: torch.Size([37065, 1])
2025-06-02 16:02:25,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:25,647 - DEBUG - Step 25: Loss=0.6011
2025-06-02 16:02:25,647 - DEBUG - Online update step: 26/50
2025-06-02 16:02:25,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:25,749 - DEBUG - Node anomaly scores shape: torch.Size([16144, 1])
2025-06-02 16:02:25,753 - DEBUG - Edge anomaly scores shape: torch.Size([33345, 1])
2025-06-02 16:02:25,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:25,965 - DEBUG - Step 26: Loss=0.6062
2025-06-02 16:02:25,965 - DEBUG - Online update step: 27/50
2025-06-02 16:02:25,969 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:26,055 - DEBUG - Node anomaly scores shape: torch.Size([16159, 1])
2025-06-02 16:02:26,059 - DEBUG - Edge anomaly scores shape: torch.Size([33440, 1])
2025-06-02 16:02:26,060 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:26,288 - DEBUG - Step 27: Loss=0.6032
2025-06-02 16:02:26,288 - DEBUG - Online update step: 28/50
2025-06-02 16:02:26,291 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:26,396 - DEBUG - Node anomaly scores shape: torch.Size([17685, 1])
2025-06-02 16:02:26,402 - DEBUG - Edge anomaly scores shape: torch.Size([36655, 1])
2025-06-02 16:02:26,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:26,670 - DEBUG - Step 28: Loss=0.6035
2025-06-02 16:02:26,670 - DEBUG - Online update step: 29/50
2025-06-02 16:02:26,673 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:26,753 - DEBUG - Node anomaly scores shape: torch.Size([15981, 1])
2025-06-02 16:02:26,757 - DEBUG - Edge anomaly scores shape: torch.Size([32858, 1])
2025-06-02 16:02:26,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:27,008 - DEBUG - Step 29: Loss=0.6019
2025-06-02 16:02:27,009 - DEBUG - Online update step: 30/50
2025-06-02 16:02:27,012 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:27,161 - DEBUG - Node anomaly scores shape: torch.Size([16397, 1])
2025-06-02 16:02:27,166 - DEBUG - Edge anomaly scores shape: torch.Size([33854, 1])
2025-06-02 16:02:27,169 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:27,457 - DEBUG - Step 30: Loss=0.6053
2025-06-02 16:02:27,458 - DEBUG - Online update step: 31/50
2025-06-02 16:02:27,466 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:27,593 - DEBUG - Node anomaly scores shape: torch.Size([16046, 1])
2025-06-02 16:02:27,598 - DEBUG - Edge anomaly scores shape: torch.Size([33166, 1])
2025-06-02 16:02:27,600 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:27,812 - DEBUG - Step 31: Loss=0.6038
2025-06-02 16:02:27,813 - DEBUG - Online update step: 32/50
2025-06-02 16:02:27,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:27,893 - DEBUG - Node anomaly scores shape: torch.Size([15036, 1])
2025-06-02 16:02:27,896 - DEBUG - Edge anomaly scores shape: torch.Size([30745, 1])
2025-06-02 16:02:27,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:28,090 - DEBUG - Step 32: Loss=0.6033
2025-06-02 16:02:28,090 - DEBUG - Online update step: 33/50
2025-06-02 16:02:28,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:28,204 - DEBUG - Node anomaly scores shape: torch.Size([17861, 1])
2025-06-02 16:02:28,209 - DEBUG - Edge anomaly scores shape: torch.Size([37168, 1])
2025-06-02 16:02:28,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:28,417 - DEBUG - Step 33: Loss=0.6008
2025-06-02 16:02:28,417 - DEBUG - Online update step: 34/50
2025-06-02 16:02:28,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:28,546 - DEBUG - Node anomaly scores shape: torch.Size([17773, 1])
2025-06-02 16:02:28,551 - DEBUG - Edge anomaly scores shape: torch.Size([36951, 1])
2025-06-02 16:02:28,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:28,848 - DEBUG - Step 34: Loss=0.6025
2025-06-02 16:02:28,848 - DEBUG - Online update step: 35/50
2025-06-02 16:02:28,852 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:28,996 - DEBUG - Node anomaly scores shape: torch.Size([17095, 1])
2025-06-02 16:02:29,001 - DEBUG - Edge anomaly scores shape: torch.Size([35379, 1])
2025-06-02 16:02:29,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:29,289 - DEBUG - Step 35: Loss=0.6012
2025-06-02 16:02:29,289 - DEBUG - Online update step: 36/50
2025-06-02 16:02:29,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:29,414 - DEBUG - Node anomaly scores shape: torch.Size([16442, 1])
2025-06-02 16:02:29,419 - DEBUG - Edge anomaly scores shape: torch.Size([33938, 1])
2025-06-02 16:02:29,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:29,702 - DEBUG - Step 36: Loss=0.6016
2025-06-02 16:02:29,703 - DEBUG - Online update step: 37/50
2025-06-02 16:02:29,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:29,931 - DEBUG - Node anomaly scores shape: torch.Size([16890, 1])
2025-06-02 16:02:29,946 - DEBUG - Edge anomaly scores shape: torch.Size([34801, 1])
2025-06-02 16:02:29,949 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:30,188 - DEBUG - Step 37: Loss=0.5996
2025-06-02 16:02:30,189 - DEBUG - Online update step: 38/50
2025-06-02 16:02:30,192 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:30,318 - DEBUG - Node anomaly scores shape: torch.Size([17556, 1])
2025-06-02 16:02:30,324 - DEBUG - Edge anomaly scores shape: torch.Size([36522, 1])
2025-06-02 16:02:30,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:30,600 - DEBUG - Step 38: Loss=0.6025
2025-06-02 16:02:30,600 - DEBUG - Online update step: 39/50
2025-06-02 16:02:30,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:30,725 - DEBUG - Node anomaly scores shape: torch.Size([16535, 1])
2025-06-02 16:02:30,730 - DEBUG - Edge anomaly scores shape: torch.Size([34167, 1])
2025-06-02 16:02:30,731 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:31,029 - DEBUG - Step 39: Loss=0.6006
2025-06-02 16:02:31,029 - DEBUG - Online update step: 40/50
2025-06-02 16:02:31,035 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:31,218 - DEBUG - Node anomaly scores shape: torch.Size([18349, 1])
2025-06-02 16:02:31,223 - DEBUG - Edge anomaly scores shape: torch.Size([38154, 1])
2025-06-02 16:02:31,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:31,535 - DEBUG - Step 40: Loss=0.6000
2025-06-02 16:02:31,535 - DEBUG - Online update step: 41/50
2025-06-02 16:02:31,538 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:31,661 - DEBUG - Node anomaly scores shape: torch.Size([17037, 1])
2025-06-02 16:02:31,670 - DEBUG - Edge anomaly scores shape: torch.Size([35347, 1])
2025-06-02 16:02:31,671 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:31,915 - DEBUG - Step 41: Loss=0.5983
2025-06-02 16:02:31,916 - DEBUG - Online update step: 42/50
2025-06-02 16:02:31,919 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:32,030 - DEBUG - Node anomaly scores shape: torch.Size([17285, 1])
2025-06-02 16:02:32,035 - DEBUG - Edge anomaly scores shape: torch.Size([35776, 1])
2025-06-02 16:02:32,036 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:32,263 - DEBUG - Step 42: Loss=0.6014
2025-06-02 16:02:32,263 - DEBUG - Online update step: 43/50
2025-06-02 16:02:32,266 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:32,368 - DEBUG - Node anomaly scores shape: torch.Size([16418, 1])
2025-06-02 16:02:32,372 - DEBUG - Edge anomaly scores shape: torch.Size([33879, 1])
2025-06-02 16:02:32,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:32,579 - DEBUG - Step 43: Loss=0.5997
2025-06-02 16:02:32,580 - DEBUG - Online update step: 44/50
2025-06-02 16:02:32,583 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:32,708 - DEBUG - Node anomaly scores shape: torch.Size([17589, 1])
2025-06-02 16:02:32,714 - DEBUG - Edge anomaly scores shape: torch.Size([36578, 1])
2025-06-02 16:02:32,715 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:32,967 - DEBUG - Step 44: Loss=0.5992
2025-06-02 16:02:32,968 - DEBUG - Online update step: 45/50
2025-06-02 16:02:32,976 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:33,128 - DEBUG - Node anomaly scores shape: torch.Size([16834, 1])
2025-06-02 16:02:33,135 - DEBUG - Edge anomaly scores shape: torch.Size([34652, 1])
2025-06-02 16:02:33,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:33,520 - DEBUG - Step 45: Loss=0.5978
2025-06-02 16:02:33,521 - DEBUG - Online update step: 46/50
2025-06-02 16:02:33,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:33,630 - DEBUG - Node anomaly scores shape: torch.Size([16879, 1])
2025-06-02 16:02:33,635 - DEBUG - Edge anomaly scores shape: torch.Size([34826, 1])
2025-06-02 16:02:33,637 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:33,862 - DEBUG - Step 46: Loss=0.6008
2025-06-02 16:02:33,862 - DEBUG - Online update step: 47/50
2025-06-02 16:02:33,869 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:33,967 - DEBUG - Node anomaly scores shape: torch.Size([16606, 1])
2025-06-02 16:02:33,972 - DEBUG - Edge anomaly scores shape: torch.Size([34395, 1])
2025-06-02 16:02:33,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:34,187 - DEBUG - Step 47: Loss=0.5991
2025-06-02 16:02:34,187 - DEBUG - Online update step: 48/50
2025-06-02 16:02:34,190 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:34,303 - DEBUG - Node anomaly scores shape: torch.Size([17562, 1])
2025-06-02 16:02:34,308 - DEBUG - Edge anomaly scores shape: torch.Size([36437, 1])
2025-06-02 16:02:34,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:34,563 - DEBUG - Step 48: Loss=0.5987
2025-06-02 16:02:34,563 - DEBUG - Online update step: 49/50
2025-06-02 16:02:34,567 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:34,707 - DEBUG - Node anomaly scores shape: torch.Size([18507, 1])
2025-06-02 16:02:34,712 - DEBUG - Edge anomaly scores shape: torch.Size([38573, 1])
2025-06-02 16:02:34,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:34,975 - DEBUG - Step 49: Loss=0.5963
2025-06-02 16:02:34,975 - DEBUG - Online update step: 50/50
2025-06-02 16:02:34,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:35,130 - DEBUG - Node anomaly scores shape: torch.Size([17877, 1])
2025-06-02 16:02:35,138 - DEBUG - Edge anomaly scores shape: torch.Size([37280, 1])
2025-06-02 16:02:35,140 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:35,534 - DEBUG - Step 50: Loss=0.5997
2025-06-02 16:02:35,535 - INFO - Online update finished. Average loss: 0.6044, Learning rate: 0.001000
2025-06-02 16:02:35,536 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], current edge mean: [ 9.1448765e+00  1.4124180e+00  5.6789498e+00  0.0000000e+00
 -3.3698739e-09  0.0000000e+00 -1.9256423e-09 -4.3326951e-09
  1.2035264e-09 -2.8884632e-09]
2025-06-02 16:02:35,536 - DEBUG - Node drift difference: 0.0042, Edge drift difference: 0.0046
2025-06-02 16:02:35,538 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  2.7927555e-08  3.6202388e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7584016e-08
  7.2404774e-08 -3.7236742e-08 -1.0343539e-09  8.2748315e-09
  2.3080261e+00  2.9609544e+00  1.4425163e-01  4.4078093e+00
  3.7236742e-08  3.3156183e+00  5.8611712e+00  7.5986986e+00
  1.4425163e-01  7.9924078e+00 -6.2061236e-09 -2.5858848e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.7066840e-08 -3.2064971e-08], edge=[ 9.1448765e+00  1.4124180e+00  5.6789498e+00  0.0000000e+00
 -3.3698739e-09  0.0000000e+00 -1.9256423e-09 -4.3326951e-09
  1.2035264e-09 -2.8884632e-09]
2025-06-02 16:02:35,539 - DEBUG - Updated reference std: node=[0.         0.         1.0005428  1.0005428  0.         0.
 0.         1.0005426  1.0005426  1.0005428  1.0005428  1.0005428
 1.0201662  0.2768568  0.3696031  0.5732584  1.0005428  2.978598
 2.8835957  1.5098369  0.3696031  0.23053272 1.0005428  1.0005428
 0.         0.         0.         0.         1.0005428  1.0005428 ], edge=[1.1221868 0.5055523 2.1737428 1.0002525 1.0002525 1.0002525 1.0002525
 1.0002525 1.0002525 1.0002525]
2025-06-02 16:02:35,554 - INFO - Online update complete. Loss: 0.6044
2025-06-02 16:02:35,555 - INFO - Running anomaly detection...
2025-06-02 16:02:35,555 - INFO - Starting anomaly detection.
2025-06-02 16:02:35,570 - DEBUG - Node reconstruction errors: [0.22519381 1.4078109  0.10867237 0.01385924 0.03417399 0.05103058
 0.09539445 0.02987549 0.02987543 0.02553238 0.02987549 0.01562545
 0.55887264 0.1566972  0.00317691 0.04144416 0.01790067 0.04144626
 0.03007981 0.04132395 0.03247575 0.00317691 0.08317573 0.00963017
 0.00365252 0.00781734 0.00365241 0.05260479 0.0296357  0.00365242
 0.10791731 0.10250054 0.04597216 0.01208152 0.0737149  0.05959318
 0.08701668 0.04132392 0.10358693 0.13565475 0.01261123 0.00284165
 0.04132392 0.04426409 0.01967113 0.03250193 0.03454135 0.28124133
 0.0295929  0.21184823 0.12228584 0.00839511 0.0075167  0.03706289
 0.02813711 0.08476858 0.19971278 0.04180311 0.0249653  0.05747954
 0.22509053 0.06570719 0.00256944 0.01682749 0.13970089 0.02813702
 0.01011401 0.02813699 0.00256944 0.06570726 0.04166238 0.0345033
 0.01103933 0.07103655 0.06921706 0.0377373  0.10354788 0.05897796
 0.03997995 0.0562887  0.01038029 0.05796675 0.42657354 0.04579009
 0.04103123 0.02879488 0.09356737 0.06148133 0.06945837 0.16656981
 0.00319787 0.04212712 0.0089755  0.04568942 0.03325022 0.22821587
 0.01120925 0.04446762 0.00272684 0.07250658 0.02608392 0.01120924
 0.02048272 0.21810053 0.01269724 0.02921698 0.01797109 0.04897403
 0.00820164 0.26818684 0.19362542 0.01333737 0.04592991 0.11921845
 0.03320873 0.05022774 0.02802441 0.03716177 0.04335286 0.01095076
 0.00377768 0.00732768 0.07152601 0.01298768 0.04694632 0.01094974
 0.01629597 0.04176339 0.05556175 0.01415484 0.00817272 0.00937732
 0.03747753 0.22924235 0.03019633 0.02635097 0.02136217 0.00218802
 0.12771027 0.0345416  0.04406898 0.08271265 0.00516645 0.02910525
 0.04406906 0.1149694  0.02802053 0.10863221 0.03803767 0.04672276
 0.5225094  0.01612842 0.07030983 0.00937732 0.03746038 0.03574543
 0.00835667 0.08100109 0.02608377 0.01662857 0.04406882 0.01960952
 0.00835667 0.00817273 0.02585453 0.03450143 0.03647448 0.04200143
 0.02066226 0.04655142 0.06249254 0.01215875 0.00268816 0.11820434
 0.04335081 0.04430171 0.04332082 0.06911872 0.02267197 0.02267205
 0.02923549 0.01787799 0.0278283  0.0812291  0.04515118 0.03976414
 0.00488764 0.04511371 0.02622946 0.00787512 0.03779979 0.04239466
 0.03730453 0.00910268 0.12771544 0.00733319 0.4126975  0.05587232
 0.04129718 0.05467495 0.00936489 0.00835668 0.04017614 0.06196131
 0.04022314 0.01846012 0.02745367 0.15539756 0.00362815 0.06463453
 0.02347369 0.02516879 0.00717413 0.06530079 0.04125487 0.00663088
 0.0424678  0.0280251  0.11465818 0.00910266 0.07692755 0.00488764
 0.002543   0.00717413 0.00835667 0.06787014 0.03570713 0.01053001
 0.06059837 0.01668884 0.01051883 0.07880345 0.04844203 0.0280229
 0.02802435 0.02276127 0.05873455 0.002543   0.00835668 0.06804861
 0.03425766 0.04640569 0.01132227 0.04514171 0.01037286 0.04788471
 0.04484775 0.08401489 0.01132227 0.01690229 0.00268816 0.00293002
 0.11465181 0.03789311 0.04604017 0.05319954 0.00787511 0.00474492
 0.0464213  0.02267194 0.05441146 0.02256259 0.03091608 0.03222202
 0.04486797 0.02783791 0.0626884  0.17028853 0.06270739 0.05125113
 0.11854838 0.07322894 0.06381122 0.0651796  0.03220409 0.12376329
 0.00322339 0.15752722 0.02923552 0.03103464 0.12917253 0.00257888
 0.04140669 0.01176026 0.06985211 0.00676254 0.12832348 0.03389164
 0.01787798 0.01944511 0.02836116 0.01511271 0.04279489 0.01037285
 0.14829792 0.00908574 0.04398023 0.02273149 0.00733241 0.00827724
 0.04382734 0.00213703 0.02918996 0.03814173 0.00213699 0.002137
 0.002137   0.02906648 0.03898521 0.00213699 0.002137   0.0354141
 0.002137   0.00739611 0.02001126 0.06163036 0.1928359  0.0120576
 0.00728025 0.0083357  0.06103563 0.01168433 0.04283872 0.02919003
 0.04482283 0.07681182 0.03959322 0.09178302 0.06749015 0.06748542
 0.17696209 0.00711944 0.00213716 0.03220391 0.002137   0.02906584
 0.02287608 0.00272361 0.00252049 0.00252049 0.00214181 0.00951288
 0.00252049 0.05203998 0.03918824 0.04243403 0.02918978 0.00783062
 0.0729133  0.05185653 0.00213715 0.044325   0.06976175 0.08799146
 0.00800571 0.00787511 0.00454004 0.002137   0.00212195 0.06452248
 0.09034244 0.00834515 0.13077392 0.07228614 0.02917895 0.07958957
 0.00265182 0.03830153 0.02296878 0.02684113 0.05472272 0.06543293
 0.05210979 0.03376193 0.03878361 0.0879748  0.0024299  0.01126726
 0.03848641 0.002137   0.02919021 0.01844205 0.00814248 0.0402726
 0.01906453 0.04085357 0.03879968 0.01668226 0.04204348 0.00213699
 0.10089202 0.03881274 0.0199778  0.08927558 0.03803499 0.03804779
 0.03806659 0.02837673 0.00224406 0.02839277 0.00700171 0.04529632
 0.03804446 0.002244   0.02284992 0.01992304 0.04519615 0.007483
 0.01997876 0.04909999 0.03805475 0.01997848 0.00224403 0.03804368
 0.03805282 0.00811995 0.01002589 0.03806786 0.00242989 0.02164971
 0.02047854 0.00860219 0.02300513 0.00768244 0.06795658 0.02463001
 0.01199516 0.06491438 0.05120353 0.00475936 0.06836148 0.02944711
 0.04316581 0.04573077 0.03806943 0.03804692 0.00700174 0.07249169
 0.06811574 0.0340901  0.01671648 0.01138666 0.10949819 0.00435005
 0.02612345 0.03268174 0.06061601 0.00742537 0.00575604 0.00774604
 0.06292515 0.00247539 0.00877352 0.0315709  0.00247539 0.02633511
 0.00768246 0.01825168 0.01496593 0.07487779 0.02195597 0.00896068
 0.0077983  0.01388209 0.00779829 0.00896068 0.00250342 0.06161619
 0.02732415 0.00593409 0.00250342 0.02191499 0.04330165 0.11856116
 0.04477606 0.0224984  0.06160271 0.02195597 0.00253706 0.01083459
 0.01002752 0.1430853  0.01730465 0.00742536 0.07334661 0.00695443
 0.00247539 0.03471052 0.03309707 0.11878116 0.04638844 0.00253706
 0.03751228 0.00329134 0.03924664 0.00804929 0.02137453 0.11211649
 0.00243149 0.0108346  0.11668434 0.00329134 0.11312004 0.0023875
 0.00250429 0.01219291 0.00245248 0.18731333 0.01050599 0.00247539
 0.00466801 0.00939968 0.00939964 0.00580157 0.08504103 0.01303423
 0.00245384 0.02661467 0.01662325 0.07156917 0.02661185 0.01138634
 0.00245243 0.01866444 0.00250429 0.02137861 0.00868987 0.03006397
 0.02659898 0.08221873 0.01303423 0.04531971 0.00243149 0.01083461
 0.02136714 0.01940215 0.06139593 0.0748053  0.00243149 0.04442682
 0.0024315  0.04443046 0.03183895 0.02660589 0.0078833  0.07324692
 0.02730548 0.00267584 0.2557448  0.00267584 0.00267586 0.00267584
 0.00267584 0.00267584 0.00267584 0.00267588 0.02507352 0.00780509
 0.03362759 0.00267586 0.00267584 0.00267583 0.00267584 0.00267584
 0.00267584 0.00267584 0.00267584 0.00267584 0.02640222 0.00267592
 0.00267584 0.069618   0.00267584 0.00549819 0.0351313  0.00243149
 0.04315722 0.07280317 0.03424065 0.03424065 0.08288563 0.04315722
 0.0024315  0.00245243 0.00245248 0.00243149 0.00245251 0.01223099
 0.00937021 0.00267687 0.01138632 0.00243149 0.00939974 0.00243149
 0.00243149 0.02835095 0.00243149 0.00245243 0.00243149 0.00243149
 0.02661003 0.00245244 0.00243149 0.00245252 0.0024315  0.00243149
 0.00243149 0.05840306 0.04203924 0.02267199 0.00267584 0.03019058
 0.04323374 0.00243149 0.00245249 0.04336681 0.00267591 0.01549297
 0.03402676 0.00326926 0.00243149 0.00243149 0.03867886 0.0669979
 0.03766304 0.0024315  0.02507352 0.0056219  0.00245245 0.02917881
 0.00267584 0.01837985 0.03832208 0.00267584 0.002676   0.02507347
 0.00562175 0.00243149 0.16364919 0.04510229 0.03955178 0.0670011
 0.01205057 0.034881   0.03488185 0.03507958 0.0071267  0.00267584
 0.00942655 0.05668022 0.06699788 0.02075784 0.00955251 0.012099
 0.00298409 0.00298409 0.00298412 0.00298412 0.00298409 0.02704382
 0.05376305 0.00298409 0.00298423 0.00267584 0.00521079 0.00267584
 0.03488214 0.05805332 0.09312984 0.01262129 0.03488254 0.06716502
 0.02640199 0.00898901 0.02640228 0.00267584 0.03488273 0.00255796
 0.00258139 0.00258139 0.00298409 0.00255796 0.06374915 0.01164283
 0.01230192 0.00267584 0.0029841  0.01582128 0.00258137 0.00392915
 0.00279676 0.01517341 0.02704386 0.1207288  0.00329668 0.06143868
 0.02507198 0.00279676 0.00628508 0.00266971 0.00280653 0.00422009
 0.03455204 0.01130413 0.0345921  0.00279676 0.00279676 0.00279676
 0.00246778 0.01582128 0.00279676 0.00280653 0.00279676 0.00279676
 0.00279676 0.02319966 0.00273725 0.03900851 0.06601208 0.04362472
 0.00695384 0.01153851 0.05537148 0.03721561 0.00277234 0.0028187
 0.00383063 0.03407435 0.03407429 0.00280653 0.04001526 0.11825721
 0.00277233 0.00332808 0.00662122 0.03678822 0.00295528 0.00295528
 0.00295528 0.00355042 0.00206977 0.0224639  0.03206947 0.14151865
 0.00800061 0.00271742 0.01007151 0.00332806 0.00696169 0.03052305
 0.00214349 0.00712486 0.00277233 0.1179914  0.00332806 0.03058863
 0.00271741 0.02365318 0.00295528 0.00355046 0.00214349 0.01248719
 0.03460195 0.00355041 0.00355041 0.00355041 0.0625059  0.13266309
 1.0284334  0.00295528 0.08334164 0.00355042 0.04739701 0.01331904
 0.08351542 0.01331956 0.00355042 0.00383037 0.00811749 0.00279955
 0.14807849 0.01332907 0.10282486 0.00655299 0.05495896 0.013319
 0.03703486 0.03516204 0.01178473 0.06978784 0.03574323 0.00293088
 0.00293087 0.08262589 0.23616269 0.04012179 0.01331902 0.01178472
 0.01331903 0.00195619 0.00316814 0.00316814 0.00211014 0.08567474
 0.00346771 0.00316814 0.0019562  0.01091706 0.00316814 0.00316814
 0.00418485 0.00807194 0.07957562 0.06436525 0.00316814 0.03653122
 0.01091707 0.00316814 0.00342359 0.00761924 0.00238921 0.00238921
 0.08198734 0.00761924 0.00316814 0.00761923 0.00839841 0.07825351
 0.03028747 0.00316814 0.20429496 0.00743081 0.00743081 0.00807189
 0.00475172 0.00995625 0.0034236  0.00787274 0.00245684 0.03702323
 0.01333843 0.0370232  0.16577965 0.00226589 0.01333844 0.00558628
 0.00558628 0.06080174 0.00558626 0.04209751 0.00475098 0.03454452
 0.01200895 0.00226589 0.0120084  0.03342823 0.07559577 0.07741075
 0.00558627 0.00834199 0.0069393  0.00558628 0.10992821 0.09625359
 0.00874861 0.00226589 0.00558628 0.18635906 0.00558628 0.00558629
 0.00558626 0.00394965 0.05390376 0.00394965 0.01579712 0.00394965
 0.05487332 0.06457662 0.11962191 0.00558628 0.00558626 0.00558627
 0.00558628 0.51176363 0.01579567 0.00394965 0.00558627 0.00558628
 0.00558626 0.01797053 0.00558627 0.00558628 0.00463324 0.01579564
 0.00381168 0.09994688 0.00463326 0.00558626 0.00558628 0.01420398
 0.05617119 0.05729055 0.05728884 0.00670282 0.03413036 0.01096852
 0.01216113 0.26921144 0.05728984 0.00472039 0.05728894 0.00909681
 0.01216119 0.05729039 0.00815002 0.00381168 0.01767493 0.00584078
 0.00578137 0.00815001 0.01369372 0.00647352]
2025-06-02 16:02:35,571 - DEBUG - Edge reconstruction errors: [1.3649046  1.3626812  0.958913   ... 0.15889631 1.2598501  0.15889631]
2025-06-02 16:02:35,574 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160235_update_41.json
2025-06-02 16:02:35,574 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:02:35,592 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160235_update_41.pth and as latest_checkpoint.pth
2025-06-02 16:02:35,593 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870325.dot): 0.1046
2025-06-02 16:02:35,593 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:02:35,593 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.4078, MLP Score: 0.5351
2025-06-02 16:02:35,593 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.5589, MLP Score: 0.5042
2025-06-02 16:02:35,593 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.2812, MLP Score: 0.4952
2025-06-02 16:02:35,593 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.4266, MLP Score: 0.5430
2025-06-02 16:02:35,593 - WARNING -   Node ID: ff02::fb, Recon Error: 0.2682, MLP Score: 0.4840
2025-06-02 16:02:35,594 - WARNING - Detected 7 anomalous edges (reconstruction-based):
2025-06-02 16:02:35,594 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1409, MLP Score: 0.5045
2025-06-02 16:02:35,594 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.2783, MLP Score: 0.4890
2025-06-02 16:02:35,594 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4853, MLP Score: 0.5024
2025-06-02 16:02:35,595 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 5.0109, MLP Score: 0.4299
2025-06-02 16:02:35,595 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.5527, MLP Score: 0.5091
2025-06-02 16:02:35,604 - DEBUG - Embedding standard deviations before t-SNE: [1.7878612  0.9945687  0.82104933 0.8553817  1.0667574  0.
 2.441375   0.         1.5831865  1.565113   1.8397002  0.22550918
 0.0525202  1.4607844  0.         0.         1.3342284  0.03036498
 0.         0.         0.04228242 1.4318377  0.4949253  0.5958349
 0.15336934 1.0016522  0.6560409  1.0781235  0.87247854 1.5396123
 1.525293   0.4105075 ]
2025-06-02 16:02:36,665 - INFO - Embeddings visualization saved to vis/embeddings_41_updates_20250602_160235.png
2025-06-02 16:02:36,665 - INFO - Performing visualization of node and edge features.
2025-06-02 16:02:36,667 - INFO - Starting visualization of node features.
2025-06-02 16:02:36,667 - INFO - Graph has 922 nodes and 30 features.
2025-06-02 16:02:36,667 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 16:02:36,667 - INFO - Calculating feature statistics:
2025-06-02 16:02:36,667 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,667 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,667 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(3.3099326e-08), 'std': np.float32(1.0), 'min': np.float32(-1.9147569), 'max': np.float32(2.4391384)}
2025-06-02 16:02:36,667 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.352639), 'max': np.float32(2.006021)}
2025-06-02 16:02:36,667 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,667 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,667 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,668 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.46169025), 'max': np.float32(2.165954)}
2025-06-02 16:02:36,668 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(6.619865e-08), 'std': np.float32(1.0), 'min': np.float32(-1.1199458), 'max': np.float32(0.8929003)}
2025-06-02 16:02:36,668 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-9.039497), 'max': np.float32(0.11300867)}
2025-06-02 16:02:36,668 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.4760993), 'max': np.float32(1.4725882)}
2025-06-02 16:02:36,668 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 21, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4442264), 'max': np.float32(2.5885324)}
2025-06-02 16:02:36,668 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.308026), 'std': np.float32(1.0196128), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 16:02:36,668 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9609544), 'std': np.float32(0.27670658), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 16:02:36,668 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:02:36,668 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4078093), 'std': np.float32(0.5729474), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 16:02:36,668 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(2.896191e-08), 'std': np.float32(1.0), 'min': np.float32(-0.11300867), 'max': np.float32(9.039497)}
2025-06-02 16:02:36,668 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.3156183), 'std': np.float32(2.9769824), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 16:02:36,668 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8611712), 'std': np.float32(2.8820314), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:02:36,668 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5986986), 'std': np.float32(1.5090178), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:02:36,668 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14425163), 'std': np.float32(0.3694026), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:02:36,669 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992408), 'std': np.float32(0.23040767), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:02:36,669 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-4.1374157e-09), 'std': np.float32(1.0000001), 'min': np.float32(-0.12914392), 'max': np.float32(16.107769)}
2025-06-02 16:02:36,669 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-6.2061236e-09), 'std': np.float32(1.0), 'min': np.float32(-0.14110813), 'max': np.float32(7.086764)}
2025-06-02 16:02:36,669 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,669 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,669 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,669 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:02:36,669 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 5, 'mean': np.float32(8.2748315e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.974236), 'max': np.float32(8.896596)}
2025-06-02 16:02:36,669 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-1.6549663e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0681784), 'max': np.float32(4.4855456)}
2025-06-02 16:02:36,680 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a8383bf0>
2025-06-02 16:02:36,810 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 16:02:37,128 - DEBUG - Plotted ranges of node feature values.
2025-06-02 16:02:37,156 - DEBUG - Plotted sparsity of node features.
2025-06-02 16:02:38,594 - INFO - Node feature visualization saved to vis/node_features_20250602_160237.png
2025-06-02 16:02:38,594 - INFO - Finished visualization of node features.
2025-06-02 16:02:38,594 - INFO - Performing additional feature analysis:
2025-06-02 16:02:38,594 - INFO - - Maximum correlation between different features: nan
2025-06-02 16:02:38,595 - INFO - Starting visualization of edge features.
2025-06-02 16:02:38,595 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 16:02:38,595 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:02:38,595 - INFO - Calculating edge feature statistics:
2025-06-02 16:02:38,596 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 16:02:38,596 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.1448765), 'std': np.float32(1.1219035), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-02 16:02:38,596 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.412418), 'std': np.float32(0.5054246), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:02:38,596 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.67895), 'std': np.float32(2.1731942), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 16:02:38,596 - INFO - - service: {'name': 'service', 'unique': 34, 'mean': np.float32(0.0), 'std': np.float32(1.0000001), 'min': np.float32(-0.03646034), 'max': np.float32(34.218254)}
2025-06-02 16:02:38,596 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1323, 'mean': np.float32(-3.8512846e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.058690593), 'max': np.float32(31.43086)}
2025-06-02 16:02:38,596 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1409, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.05430731), 'max': np.float32(33.032013)}
2025-06-02 16:02:38,596 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 468, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.044447273), 'max': np.float32(34.08441)}
2025-06-02 16:02:38,596 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1380, 'mean': np.float32(-1.4442316e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.0819718), 'max': np.float32(28.840654)}
2025-06-02 16:02:38,596 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1404, 'mean': np.float32(1.9256423e-09), 'std': np.float32(1.0), 'min': np.float32(-0.082216784), 'max': np.float32(27.85083)}
2025-06-02 16:02:38,596 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 509, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052967753), 'max': np.float32(33.503876)}
2025-06-02 16:02:38,607 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a81e82c0>
2025-06-02 16:02:38,689 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 16:02:38,699 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a07317f0>
2025-06-02 16:02:38,781 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 16:02:39,077 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 16:02:39,266 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 16:02:39,286 - DEBUG - Plotted sparsity of edge features.
2025-06-02 16:02:39,295 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 16:02:40,722 - INFO - Edge feature visualization saved to vis/edge_features_20250602_160239.png
2025-06-02 16:02:40,723 - INFO - Finished visualization of edge features.
2025-06-02 16:02:40,723 - INFO - Performing additional edge feature analysis:
2025-06-02 16:02:40,723 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 16:02:40,726 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 16:02:40,726 - INFO - Graph has 1981 edges and 10 edge features.
2025-06-02 16:02:40,726 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:02:41,149 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_160240_summary.png
2025-06-02 16:02:41,411 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_160240_pca_3d.png
2025-06-02 16:02:41,581 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_160240_pca_variance.png
2025-06-02 16:02:41,581 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 16:02:41,582 - INFO - 
--- Processing file: nw_graph_encoded_1748870355.dot (Timestamp: 2025-06-02 15:19:15) ---
2025-06-02 16:02:41,582 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 16:02:41,582 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 16:02:41,598 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 16:02:41,617 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 16:02:41,617 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 16:02:41,617 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870355.dot
2025-06-02 16:02:41,634 - INFO - Parsed 934 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 16:02:41,656 - INFO - Parsed 2007 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870355.dot'.
2025-06-02 16:02:41,657 - INFO - Processing node updates/additions.
2025-06-02 16:02:41,665 - INFO - Processing edge updates/additions.
2025-06-02 16:02:41,681 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:02:41,683 - INFO - Finished updating NetworkX graph.
2025-06-02 16:02:41,683 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:02:41,685 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:02:41,698 - DEBUG - Initial node features tensor shape: torch.Size([934, 30])
2025-06-02 16:02:41,700 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:02:41,701 - DEBUG - Node features tensor shape after scaling: torch.Size([934, 30])
2025-06-02 16:02:41,707 - DEBUG - Edge index tensor shape: torch.Size([2, 2007])
2025-06-02 16:02:41,710 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:02:41,716 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:02:41,718 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:02:41,720 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:02:41,722 - DEBUG - Shape of encoded categorical edge features: torch.Size([2007, 3])
2025-06-02 16:02:41,723 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:02:41,723 - DEBUG - Shape of scaled numerical edge features: torch.Size([2007, 7])
2025-06-02 16:02:41,724 - DEBUG - Final edge attributes tensor shape: torch.Size([2007, 10])
2025-06-02 16:02:41,724 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:02:41,727 - INFO - Performing online update...
2025-06-02 16:02:41,727 - INFO - Starting online update for 50 steps.
2025-06-02 16:02:41,728 - DEBUG - Updated RunningStats: new_mean=0.9445000116300595, new_var=24000000000161.836, new_n=2430
2025-06-02 16:02:41,728 - DEBUG - Updated RunningStats: new_mean=0.942001057574944, new_var=24300000000017.97, new_n=2460
2025-06-02 16:02:41,728 - DEBUG - Updated RunningStats: new_mean=1.1267425723097226, new_var=8000000000094.004, new_n=810
2025-06-02 16:02:41,728 - DEBUG - Updated RunningStats: new_mean=1.1261667659914367, new_var=8100000000001.592, new_n=820
2025-06-02 16:02:41,728 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:02:41,728 - DEBUG - Online update step: 1/50
2025-06-02 16:02:41,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:41,837 - DEBUG - Node anomaly scores shape: torch.Size([16709, 1])
2025-06-02 16:02:41,865 - DEBUG - Edge anomaly scores shape: torch.Size([34547, 1])
2025-06-02 16:02:41,866 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:42,161 - DEBUG - Step 1: Loss=0.5990
2025-06-02 16:02:42,162 - DEBUG - Online update step: 2/50
2025-06-02 16:02:42,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:42,276 - DEBUG - Node anomaly scores shape: torch.Size([16993, 1])
2025-06-02 16:02:42,280 - DEBUG - Edge anomaly scores shape: torch.Size([35141, 1])
2025-06-02 16:02:42,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:42,483 - DEBUG - Step 2: Loss=0.5984
2025-06-02 16:02:42,484 - DEBUG - Online update step: 3/50
2025-06-02 16:02:42,487 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:42,610 - DEBUG - Node anomaly scores shape: torch.Size([16639, 1])
2025-06-02 16:02:42,615 - DEBUG - Edge anomaly scores shape: torch.Size([34537, 1])
2025-06-02 16:02:42,616 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:42,847 - DEBUG - Step 3: Loss=0.5967
2025-06-02 16:02:42,847 - DEBUG - Online update step: 4/50
2025-06-02 16:02:42,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:42,973 - DEBUG - Node anomaly scores shape: torch.Size([17187, 1])
2025-06-02 16:02:42,980 - DEBUG - Edge anomaly scores shape: torch.Size([35745, 1])
2025-06-02 16:02:42,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:43,214 - DEBUG - Step 4: Loss=0.5989
2025-06-02 16:02:43,214 - DEBUG - Online update step: 5/50
2025-06-02 16:02:43,217 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:43,319 - DEBUG - Node anomaly scores shape: torch.Size([17336, 1])
2025-06-02 16:02:43,325 - DEBUG - Edge anomaly scores shape: torch.Size([35908, 1])
2025-06-02 16:02:43,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:43,561 - DEBUG - Step 5: Loss=0.5972
2025-06-02 16:02:43,561 - DEBUG - Online update step: 6/50
2025-06-02 16:02:43,564 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:43,679 - DEBUG - Node anomaly scores shape: torch.Size([18973, 1])
2025-06-02 16:02:43,686 - DEBUG - Edge anomaly scores shape: torch.Size([39527, 1])
2025-06-02 16:02:43,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:43,907 - DEBUG - Step 6: Loss=0.5967
2025-06-02 16:02:43,907 - DEBUG - Online update step: 7/50
2025-06-02 16:02:43,910 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:44,023 - DEBUG - Node anomaly scores shape: torch.Size([17532, 1])
2025-06-02 16:02:44,028 - DEBUG - Edge anomaly scores shape: torch.Size([36445, 1])
2025-06-02 16:02:44,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:44,252 - DEBUG - Step 7: Loss=0.5955
2025-06-02 16:02:44,253 - DEBUG - Online update step: 8/50
2025-06-02 16:02:44,256 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:44,370 - DEBUG - Node anomaly scores shape: torch.Size([18044, 1])
2025-06-02 16:02:44,375 - DEBUG - Edge anomaly scores shape: torch.Size([37507, 1])
2025-06-02 16:02:44,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:44,585 - DEBUG - Step 8: Loss=0.5981
2025-06-02 16:02:44,585 - DEBUG - Online update step: 9/50
2025-06-02 16:02:44,589 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:44,683 - DEBUG - Node anomaly scores shape: torch.Size([17499, 1])
2025-06-02 16:02:44,688 - DEBUG - Edge anomaly scores shape: torch.Size([36288, 1])
2025-06-02 16:02:44,690 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:44,912 - DEBUG - Step 9: Loss=0.5964
2025-06-02 16:02:44,913 - DEBUG - Online update step: 10/50
2025-06-02 16:02:44,917 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:45,009 - DEBUG - Node anomaly scores shape: torch.Size([18253, 1])
2025-06-02 16:02:45,015 - DEBUG - Edge anomaly scores shape: torch.Size([37789, 1])
2025-06-02 16:02:45,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:45,259 - DEBUG - Step 10: Loss=0.5960
2025-06-02 16:02:45,260 - DEBUG - Online update step: 11/50
2025-06-02 16:02:45,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:45,352 - DEBUG - Node anomaly scores shape: torch.Size([17470, 1])
2025-06-02 16:02:45,356 - DEBUG - Edge anomaly scores shape: torch.Size([36205, 1])
2025-06-02 16:02:45,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:45,550 - DEBUG - Step 11: Loss=0.5944
2025-06-02 16:02:45,550 - DEBUG - Online update step: 12/50
2025-06-02 16:02:45,553 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:45,658 - DEBUG - Node anomaly scores shape: torch.Size([18955, 1])
2025-06-02 16:02:45,664 - DEBUG - Edge anomaly scores shape: torch.Size([39435, 1])
2025-06-02 16:02:45,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:45,941 - DEBUG - Step 12: Loss=0.5966
2025-06-02 16:02:45,941 - DEBUG - Online update step: 13/50
2025-06-02 16:02:45,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:46,061 - DEBUG - Node anomaly scores shape: torch.Size([17764, 1])
2025-06-02 16:02:46,066 - DEBUG - Edge anomaly scores shape: torch.Size([36866, 1])
2025-06-02 16:02:46,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:46,306 - DEBUG - Step 13: Loss=0.5951
2025-06-02 16:02:46,307 - DEBUG - Online update step: 14/50
2025-06-02 16:02:46,313 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:46,419 - DEBUG - Node anomaly scores shape: torch.Size([16620, 1])
2025-06-02 16:02:46,424 - DEBUG - Edge anomaly scores shape: torch.Size([34198, 1])
2025-06-02 16:02:46,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:46,675 - DEBUG - Step 14: Loss=0.5962
2025-06-02 16:02:46,675 - DEBUG - Online update step: 15/50
2025-06-02 16:02:46,680 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:46,773 - DEBUG - Node anomaly scores shape: torch.Size([18154, 1])
2025-06-02 16:02:46,777 - DEBUG - Edge anomaly scores shape: torch.Size([37854, 1])
2025-06-02 16:02:46,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:46,993 - DEBUG - Step 15: Loss=0.5933
2025-06-02 16:02:46,993 - DEBUG - Online update step: 16/50
2025-06-02 16:02:46,998 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:47,104 - DEBUG - Node anomaly scores shape: torch.Size([17502, 1])
2025-06-02 16:02:47,108 - DEBUG - Edge anomaly scores shape: torch.Size([36321, 1])
2025-06-02 16:02:47,110 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:47,327 - DEBUG - Step 16: Loss=0.5959
2025-06-02 16:02:47,327 - DEBUG - Online update step: 17/50
2025-06-02 16:02:47,331 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:47,432 - DEBUG - Node anomaly scores shape: torch.Size([16128, 1])
2025-06-02 16:02:47,437 - DEBUG - Edge anomaly scores shape: torch.Size([33268, 1])
2025-06-02 16:02:47,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:47,657 - DEBUG - Step 17: Loss=0.5945
2025-06-02 16:02:47,657 - DEBUG - Online update step: 18/50
2025-06-02 16:02:47,663 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:47,755 - DEBUG - Node anomaly scores shape: torch.Size([15798, 1])
2025-06-02 16:02:47,759 - DEBUG - Edge anomaly scores shape: torch.Size([32445, 1])
2025-06-02 16:02:47,761 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:47,955 - DEBUG - Step 18: Loss=0.5947
2025-06-02 16:02:47,955 - DEBUG - Online update step: 19/50
2025-06-02 16:02:47,959 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:48,038 - DEBUG - Node anomaly scores shape: torch.Size([16534, 1])
2025-06-02 16:02:48,042 - DEBUG - Edge anomaly scores shape: torch.Size([34156, 1])
2025-06-02 16:02:48,043 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:48,253 - DEBUG - Step 19: Loss=0.5933
2025-06-02 16:02:48,254 - DEBUG - Online update step: 20/50
2025-06-02 16:02:48,257 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:48,365 - DEBUG - Node anomaly scores shape: torch.Size([17063, 1])
2025-06-02 16:02:48,370 - DEBUG - Edge anomaly scores shape: torch.Size([35211, 1])
2025-06-02 16:02:48,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:48,587 - DEBUG - Step 20: Loss=0.5960
2025-06-02 16:02:48,588 - DEBUG - Online update step: 21/50
2025-06-02 16:02:48,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:48,711 - DEBUG - Node anomaly scores shape: torch.Size([19684, 1])
2025-06-02 16:02:48,717 - DEBUG - Edge anomaly scores shape: torch.Size([41042, 1])
2025-06-02 16:02:48,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:48,993 - DEBUG - Step 21: Loss=0.5944
2025-06-02 16:02:48,993 - DEBUG - Online update step: 22/50
2025-06-02 16:02:48,998 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:49,132 - DEBUG - Node anomaly scores shape: torch.Size([16791, 1])
2025-06-02 16:02:49,142 - DEBUG - Edge anomaly scores shape: torch.Size([34689, 1])
2025-06-02 16:02:49,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:49,466 - DEBUG - Step 22: Loss=0.5944
2025-06-02 16:02:49,466 - DEBUG - Online update step: 23/50
2025-06-02 16:02:49,469 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:49,601 - DEBUG - Node anomaly scores shape: torch.Size([16991, 1])
2025-06-02 16:02:49,607 - DEBUG - Edge anomaly scores shape: torch.Size([35153, 1])
2025-06-02 16:02:49,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:49,858 - DEBUG - Step 23: Loss=0.5975
2025-06-02 16:02:49,858 - DEBUG - Online update step: 24/50
2025-06-02 16:02:49,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:49,971 - DEBUG - Node anomaly scores shape: torch.Size([16862, 1])
2025-06-02 16:02:49,975 - DEBUG - Edge anomaly scores shape: torch.Size([34766, 1])
2025-06-02 16:02:49,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:50,181 - DEBUG - Step 24: Loss=0.6014
2025-06-02 16:02:50,182 - DEBUG - Online update step: 25/50
2025-06-02 16:02:50,185 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:50,303 - DEBUG - Node anomaly scores shape: torch.Size([17792, 1])
2025-06-02 16:02:50,310 - DEBUG - Edge anomaly scores shape: torch.Size([36982, 1])
2025-06-02 16:02:50,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:50,568 - DEBUG - Step 25: Loss=0.5934
2025-06-02 16:02:50,568 - DEBUG - Online update step: 26/50
2025-06-02 16:02:50,571 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:50,722 - DEBUG - Node anomaly scores shape: torch.Size([19849, 1])
2025-06-02 16:02:50,729 - DEBUG - Edge anomaly scores shape: torch.Size([41473, 1])
2025-06-02 16:02:50,731 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:51,044 - DEBUG - Step 26: Loss=0.5989
2025-06-02 16:02:51,044 - DEBUG - Online update step: 27/50
2025-06-02 16:02:51,047 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:51,154 - DEBUG - Node anomaly scores shape: torch.Size([15986, 1])
2025-06-02 16:02:51,160 - DEBUG - Edge anomaly scores shape: torch.Size([32917, 1])
2025-06-02 16:02:51,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:51,383 - DEBUG - Step 27: Loss=0.5938
2025-06-02 16:02:51,383 - DEBUG - Online update step: 28/50
2025-06-02 16:02:51,386 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:51,518 - DEBUG - Node anomaly scores shape: torch.Size([17917, 1])
2025-06-02 16:02:51,524 - DEBUG - Edge anomaly scores shape: torch.Size([37082, 1])
2025-06-02 16:02:51,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:51,776 - DEBUG - Step 28: Loss=0.5995
2025-06-02 16:02:51,776 - DEBUG - Online update step: 29/50
2025-06-02 16:02:51,780 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:51,912 - DEBUG - Node anomaly scores shape: torch.Size([18811, 1])
2025-06-02 16:02:51,918 - DEBUG - Edge anomaly scores shape: torch.Size([39144, 1])
2025-06-02 16:02:51,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:52,155 - DEBUG - Step 29: Loss=0.5959
2025-06-02 16:02:52,156 - DEBUG - Online update step: 30/50
2025-06-02 16:02:52,160 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:52,256 - DEBUG - Node anomaly scores shape: torch.Size([15655, 1])
2025-06-02 16:02:52,260 - DEBUG - Edge anomaly scores shape: torch.Size([32160, 1])
2025-06-02 16:02:52,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:52,479 - DEBUG - Step 30: Loss=0.5971
2025-06-02 16:02:52,480 - DEBUG - Online update step: 31/50
2025-06-02 16:02:52,487 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:52,602 - DEBUG - Node anomaly scores shape: torch.Size([17773, 1])
2025-06-02 16:02:52,608 - DEBUG - Edge anomaly scores shape: torch.Size([36927, 1])
2025-06-02 16:02:52,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:52,847 - DEBUG - Step 31: Loss=0.5948
2025-06-02 16:02:52,847 - DEBUG - Online update step: 32/50
2025-06-02 16:02:52,851 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:52,947 - DEBUG - Node anomaly scores shape: torch.Size([17072, 1])
2025-06-02 16:02:52,951 - DEBUG - Edge anomaly scores shape: torch.Size([35556, 1])
2025-06-02 16:02:52,952 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:53,173 - DEBUG - Step 32: Loss=0.5990
2025-06-02 16:02:53,174 - DEBUG - Online update step: 33/50
2025-06-02 16:02:53,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:53,284 - DEBUG - Node anomaly scores shape: torch.Size([16318, 1])
2025-06-02 16:02:53,288 - DEBUG - Edge anomaly scores shape: torch.Size([33780, 1])
2025-06-02 16:02:53,289 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:53,491 - DEBUG - Step 33: Loss=0.5938
2025-06-02 16:02:53,492 - DEBUG - Online update step: 34/50
2025-06-02 16:02:53,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:53,579 - DEBUG - Node anomaly scores shape: torch.Size([16382, 1])
2025-06-02 16:02:53,584 - DEBUG - Edge anomaly scores shape: torch.Size([33821, 1])
2025-06-02 16:02:53,585 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:53,810 - DEBUG - Step 34: Loss=0.5988
2025-06-02 16:02:53,810 - DEBUG - Online update step: 35/50
2025-06-02 16:02:53,813 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:53,904 - DEBUG - Node anomaly scores shape: torch.Size([17072, 1])
2025-06-02 16:02:53,908 - DEBUG - Edge anomaly scores shape: torch.Size([35450, 1])
2025-06-02 16:02:53,909 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:54,110 - DEBUG - Step 35: Loss=0.5932
2025-06-02 16:02:54,110 - DEBUG - Online update step: 36/50
2025-06-02 16:02:54,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:54,205 - DEBUG - Node anomaly scores shape: torch.Size([16853, 1])
2025-06-02 16:02:54,209 - DEBUG - Edge anomaly scores shape: torch.Size([34807, 1])
2025-06-02 16:02:54,211 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:54,423 - DEBUG - Step 36: Loss=0.6009
2025-06-02 16:02:54,424 - DEBUG - Online update step: 37/50
2025-06-02 16:02:54,427 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:54,518 - DEBUG - Node anomaly scores shape: torch.Size([17157, 1])
2025-06-02 16:02:54,522 - DEBUG - Edge anomaly scores shape: torch.Size([35631, 1])
2025-06-02 16:02:54,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:54,742 - DEBUG - Step 37: Loss=0.5929
2025-06-02 16:02:54,742 - DEBUG - Online update step: 38/50
2025-06-02 16:02:54,745 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:54,837 - DEBUG - Node anomaly scores shape: torch.Size([16896, 1])
2025-06-02 16:02:54,841 - DEBUG - Edge anomaly scores shape: torch.Size([34980, 1])
2025-06-02 16:02:54,842 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:55,038 - DEBUG - Step 38: Loss=0.5980
2025-06-02 16:02:55,038 - DEBUG - Online update step: 39/50
2025-06-02 16:02:55,041 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:55,146 - DEBUG - Node anomaly scores shape: torch.Size([17276, 1])
2025-06-02 16:02:55,150 - DEBUG - Edge anomaly scores shape: torch.Size([35835, 1])
2025-06-02 16:02:55,151 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:55,389 - DEBUG - Step 39: Loss=0.5911
2025-06-02 16:02:55,389 - DEBUG - Online update step: 40/50
2025-06-02 16:02:55,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:55,499 - DEBUG - Node anomaly scores shape: torch.Size([18110, 1])
2025-06-02 16:02:55,506 - DEBUG - Edge anomaly scores shape: torch.Size([37564, 1])
2025-06-02 16:02:55,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:55,726 - DEBUG - Step 40: Loss=0.5979
2025-06-02 16:02:55,726 - DEBUG - Online update step: 41/50
2025-06-02 16:02:55,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:55,819 - DEBUG - Node anomaly scores shape: torch.Size([17709, 1])
2025-06-02 16:02:55,823 - DEBUG - Edge anomaly scores shape: torch.Size([36646, 1])
2025-06-02 16:02:55,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:56,027 - DEBUG - Step 41: Loss=0.5914
2025-06-02 16:02:56,027 - DEBUG - Online update step: 42/50
2025-06-02 16:02:56,030 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:56,126 - DEBUG - Node anomaly scores shape: torch.Size([17842, 1])
2025-06-02 16:02:56,130 - DEBUG - Edge anomaly scores shape: torch.Size([37001, 1])
2025-06-02 16:02:56,131 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:56,354 - DEBUG - Step 42: Loss=0.5958
2025-06-02 16:02:56,355 - DEBUG - Online update step: 43/50
2025-06-02 16:02:56,358 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:56,451 - DEBUG - Node anomaly scores shape: torch.Size([17937, 1])
2025-06-02 16:02:56,456 - DEBUG - Edge anomaly scores shape: torch.Size([37457, 1])
2025-06-02 16:02:56,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:56,691 - DEBUG - Step 43: Loss=0.5916
2025-06-02 16:02:56,692 - DEBUG - Online update step: 44/50
2025-06-02 16:02:56,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:56,782 - DEBUG - Node anomaly scores shape: torch.Size([17656, 1])
2025-06-02 16:02:56,788 - DEBUG - Edge anomaly scores shape: torch.Size([36672, 1])
2025-06-02 16:02:56,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:57,014 - DEBUG - Step 44: Loss=0.5972
2025-06-02 16:02:57,014 - DEBUG - Online update step: 45/50
2025-06-02 16:02:57,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:57,134 - DEBUG - Node anomaly scores shape: torch.Size([17959, 1])
2025-06-02 16:02:57,140 - DEBUG - Edge anomaly scores shape: torch.Size([37409, 1])
2025-06-02 16:02:57,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:57,402 - DEBUG - Step 45: Loss=0.5909
2025-06-02 16:02:57,403 - DEBUG - Online update step: 46/50
2025-06-02 16:02:57,409 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:57,498 - DEBUG - Node anomaly scores shape: torch.Size([17476, 1])
2025-06-02 16:02:57,502 - DEBUG - Edge anomaly scores shape: torch.Size([36235, 1])
2025-06-02 16:02:57,504 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:57,703 - DEBUG - Step 46: Loss=0.5944
2025-06-02 16:02:57,704 - DEBUG - Online update step: 47/50
2025-06-02 16:02:57,710 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:57,799 - DEBUG - Node anomaly scores shape: torch.Size([17713, 1])
2025-06-02 16:02:57,804 - DEBUG - Edge anomaly scores shape: torch.Size([36697, 1])
2025-06-02 16:02:57,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:58,166 - DEBUG - Step 47: Loss=0.5900
2025-06-02 16:02:58,167 - DEBUG - Online update step: 48/50
2025-06-02 16:02:58,173 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:58,315 - DEBUG - Node anomaly scores shape: torch.Size([16973, 1])
2025-06-02 16:02:58,322 - DEBUG - Edge anomaly scores shape: torch.Size([35156, 1])
2025-06-02 16:02:58,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:58,556 - DEBUG - Step 48: Loss=0.5949
2025-06-02 16:02:58,556 - DEBUG - Online update step: 49/50
2025-06-02 16:02:58,559 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:58,687 - DEBUG - Node anomaly scores shape: torch.Size([18170, 1])
2025-06-02 16:02:58,693 - DEBUG - Edge anomaly scores shape: torch.Size([37670, 1])
2025-06-02 16:02:58,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:58,960 - DEBUG - Step 49: Loss=0.5899
2025-06-02 16:02:58,961 - DEBUG - Online update step: 50/50
2025-06-02 16:02:58,964 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:59,091 - DEBUG - Node anomaly scores shape: torch.Size([17976, 1])
2025-06-02 16:02:59,097 - DEBUG - Edge anomaly scores shape: torch.Size([37309, 1])
2025-06-02 16:02:59,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:59,369 - DEBUG - Step 50: Loss=0.5940
2025-06-02 16:02:59,369 - INFO - Online update finished. Average loss: 0.5956, Learning rate: 0.001000
2025-06-02 16:02:59,370 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], current edge mean: [ 9.1420031e+00  1.4110613e+00  5.6831093e+00  1.9006963e-09
  4.7517407e-10 -4.7517407e-10  0.0000000e+00  1.9006963e-09
  2.3758702e-09  3.8013925e-09]
2025-06-02 16:02:59,371 - DEBUG - Node drift difference: 0.0108, Edge drift difference: 0.0027
2025-06-02 16:02:59,372 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.6369199e-09 -9.7001136e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  3.3184598e-08
 -2.2463421e-08 -4.2118913e-09  8.1685165e-09  4.5947908e-09
  2.3062098e+00  2.9614561e+00  1.4025696e-01  4.4132762e+00
 -1.9144961e-09  3.2944326e+00  5.8822269e+00  7.5974302e+00
  1.4025696e-01  7.9925056e+00 -1.0465912e-08  3.0631937e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -3.6247794e-08  1.2252775e-08], edge=[ 9.1420031e+00  1.4110613e+00  5.6831093e+00  1.9006963e-09
  4.7517407e-10 -4.7517407e-10  0.0000000e+00  1.9006963e-09
  2.3758702e-09  3.8013925e-09]
2025-06-02 16:02:59,372 - DEBUG - Updated reference std: node=[0.         0.         1.0005357  1.0005357  0.         0.
 0.         1.0005357  1.0005357  1.0005358  1.0005357  1.0005357
 1.0156461  0.27510577 0.3654804  0.5750021  1.0005357  2.9664128
 2.87709    1.51188    0.3654804  0.229047   1.0005357  1.0005357
 0.         0.         0.         0.         1.0005357  1.0005357 ], edge=[1.1160322  0.50514525 2.1723423  1.0002493  1.0002493  1.0002491
 1.0002493  1.0002493  1.0002493  1.0002493 ]
2025-06-02 16:02:59,372 - INFO - Online update complete. Loss: 0.5956
2025-06-02 16:02:59,373 - INFO - Running anomaly detection...
2025-06-02 16:02:59,373 - INFO - Starting anomaly detection.
2025-06-02 16:02:59,382 - DEBUG - Node reconstruction errors: [1.48174539e-01 1.16213083e+00 9.45234522e-02 1.25886705e-02
 3.31980586e-02 3.41786854e-02 1.21406399e-01 2.33341455e-02
 2.33341753e-02 2.01629642e-02 2.33341716e-02 1.38219083e-02
 5.22512674e-01 1.46372512e-01 2.61729863e-03 2.96031442e-02
 3.95122766e-02 2.96041965e-02 1.54162263e-02 2.96393353e-02
 2.63063069e-02 2.61729490e-03 6.96478933e-02 6.01781765e-03
 2.68575060e-03 5.16623212e-03 2.68581021e-03 4.05365601e-02
 2.31624227e-02 2.68581021e-03 8.58539641e-02 8.82416666e-02
 3.37736234e-02 1.11760944e-02 4.22403812e-02 4.21470329e-02
 7.04709217e-02 2.96393819e-02 9.07690302e-02 1.15873329e-01
 1.19491499e-02 2.21757824e-03 2.96393819e-02 2.69261580e-02
 1.42648872e-02 2.34012380e-02 2.30767764e-02 2.43957490e-01
 2.31363960e-02 1.43593088e-01 7.33629689e-02 4.78647184e-03
 4.78786323e-03 2.37240717e-02 2.35585105e-02 6.63872510e-02
 1.34151936e-01 3.04721110e-02 1.27545586e-02 3.58255841e-02
 1.88068882e-01 3.04179303e-02 1.92277494e-03 7.11522065e-03
 9.88732576e-02 2.35584620e-02 6.40558871e-03 2.35584788e-02
 1.92275573e-03 4.80656810e-02 3.19190770e-02 2.27424707e-02
 6.90629380e-03 3.65064740e-02 3.82499807e-02 2.65678130e-02
 5.84434904e-02 5.02185002e-02 3.13966349e-02 4.34529744e-02
 9.63458698e-03 4.26540859e-02 3.72253805e-01 2.99153216e-02
 3.23766135e-02 1.71771068e-02 6.07073940e-02 3.46065499e-02
 4.61968333e-02 1.45722181e-01 2.80518807e-03 3.59913781e-02
 5.31519856e-03 2.67882422e-02 1.99231599e-02 1.18021742e-01
 9.76357423e-03 2.68353391e-02 1.67556643e-03 4.59437780e-02
 1.70345139e-02 9.76359379e-03 1.80774238e-02 1.99952185e-01
 6.33528689e-03 2.45260857e-02 9.11180116e-03 4.06599082e-02
 4.97647189e-03 1.87328920e-01 1.45862013e-01 1.10065965e-02
 3.95667404e-02 8.69091973e-02 2.01810170e-02 2.38363110e-02
 1.75332259e-02 3.35472189e-02 2.55543850e-02 8.08137376e-03
 2.81481957e-03 4.09338670e-03 6.04121797e-02 6.63082628e-03
 2.64301430e-02 8.07812717e-03 9.00591910e-03 2.61755288e-02
 3.33944373e-02 7.97815062e-03 5.22149401e-03 5.78503869e-03
 3.34478207e-02 1.86680466e-01 1.79037414e-02 2.25128699e-02
 1.56319626e-02 1.58846157e-03 1.23682976e-01 3.37373987e-02
 2.27614548e-02 5.22959456e-02 3.42181162e-03 1.70590505e-02
 2.27614716e-02 5.76626696e-02 1.75298825e-02 8.82304907e-02
 2.03658734e-02 3.45001630e-02 3.88984770e-01 8.57405271e-03
 5.37227876e-02 5.78503869e-03 3.50686572e-02 3.38212736e-02
 4.88486188e-03 5.72426543e-02 1.70343854e-02 1.63473487e-02
 2.27615107e-02 1.17980707e-02 4.88486188e-03 5.22149447e-03
 1.63819138e-02 3.36995795e-02 2.95740664e-02 3.45604233e-02
 1.22583294e-02 3.42927389e-02 4.67769541e-02 8.85304809e-03
 2.48108502e-03 7.01611415e-02 2.55582202e-02 2.29029059e-02
 3.39133181e-02 5.61269931e-02 1.42986458e-02 1.42985834e-02
 2.47868355e-02 9.69182327e-03 1.29016740e-02 7.21228942e-02
 4.59687002e-02 2.69931275e-02 3.20803677e-03 3.28746624e-02
 2.26777475e-02 4.55311639e-03 3.53567451e-02 2.54586712e-02
 2.13469062e-02 4.79179155e-03 1.23684861e-01 5.18728653e-03
 3.73953819e-01 2.55565383e-02 3.64955179e-02 2.46586334e-02
 6.43388880e-03 4.88486793e-03 3.55170965e-02 3.66958044e-02
 2.46965718e-02 1.18394438e-02 2.31812317e-02 1.33839220e-01
 2.01889197e-03 5.07725663e-02 1.43573694e-02 7.37869889e-02
 4.05962579e-03 5.21969460e-02 2.54809726e-02 4.10298957e-03
 2.69329567e-02 1.75338145e-02 1.02801055e-01 4.79179155e-03
 6.75239637e-02 3.20803677e-03 2.26669130e-03 4.05962579e-03
 4.88487305e-03 4.38048691e-02 3.18824016e-02 5.76349162e-03
 4.50991541e-02 8.82054772e-03 4.34753159e-03 5.61907515e-02
 3.01617384e-02 1.75318792e-02 1.75332222e-02 1.27905523e-02
 4.14306894e-02 2.26669130e-03 4.88486653e-03 3.55426595e-02
 3.16732340e-02 3.23119611e-02 6.84851268e-03 2.73890290e-02
 5.62736299e-03 2.94065941e-02 3.06668077e-02 5.57398722e-02
 6.84850104e-03 1.03973299e-02 2.48108502e-03 2.62621627e-03
 1.02800690e-01 2.99130753e-02 2.93496158e-02 4.56419364e-02
 4.55277879e-03 2.59388378e-03 2.08544321e-02 1.42985350e-02
 4.32477184e-02 1.29237762e-02 2.55032070e-02 1.87159441e-02
 2.77782064e-02 2.16435622e-02 3.84866484e-02 1.22676678e-01
 3.85007747e-02 3.33558507e-02 1.08633451e-01 6.34410679e-02
 4.50927280e-02 3.72160524e-02 2.62683500e-02 8.12489241e-02
 2.22651241e-03 1.36057764e-01 2.47868467e-02 2.33627670e-02
 1.12121090e-01 1.98848196e-03 3.32809314e-02 1.10242758e-02
 4.13660370e-02 6.65214658e-03 1.11300901e-01 1.99910961e-02
 9.69182514e-03 1.17723681e-02 2.19132788e-02 1.15003139e-02
 3.80398110e-02 5.62736532e-03 1.46374121e-01 4.66926256e-03
 3.31735797e-02 1.43487630e-02 5.18733822e-03 5.16710104e-03
 3.45056504e-02 2.52826437e-02 2.39020307e-02 1.97858475e-02
 1.57043419e-03 1.57042895e-03 1.57042616e-03 2.18696911e-02
 1.74961686e-02 2.52826400e-02 1.57042441e-03 3.31131481e-02
 1.57042441e-03 4.22700541e-03 1.37783913e-02 4.45376746e-02
 1.45935237e-01 6.61296723e-03 4.07674303e-03 6.01691799e-03
 4.43317033e-02 9.06390045e-03 2.14953516e-02 2.39018928e-02
 3.79746519e-02 6.72148317e-02 1.40386969e-01 6.12164028e-02
 5.11374958e-02 5.11319973e-02 1.39645591e-01 5.01765171e-03
 1.57044234e-03 2.62677390e-02 1.57042441e-03 2.18690559e-02
 1.43897682e-02 2.34436453e-03 2.98294798e-02 1.63083780e-03
 2.52857208e-02 6.20015431e-03 1.63081777e-03 2.74232961e-02
 2.69595739e-02 2.69207582e-02 2.39015445e-02 7.24775624e-03
 4.44881208e-02 3.95112373e-02 1.57045375e-03 2.61334665e-02
 6.00421950e-02 6.28922284e-02 5.20771602e-03 4.55277879e-03
 2.52828039e-02 1.57042895e-03 1.53459539e-03 5.20543568e-02
 5.10787256e-02 4.49868618e-03 1.26299992e-01 4.70378287e-02
 2.38774382e-02 4.40295860e-02 2.16796831e-03 3.55273485e-02
 1.27725862e-02 1.50257330e-02 3.79689522e-02 4.09840196e-02
 2.71255337e-02 3.12123951e-02 2.53714994e-02 6.28813356e-02
 2.14228616e-03 5.88435074e-03 3.54405530e-02 1.57042616e-03
 2.39026360e-02 1.23749617e-02 5.15584229e-03 3.22098695e-02
 1.28911883e-02 2.55015418e-02 3.07119880e-02 9.14750155e-03
 3.82009000e-02 1.57042849e-03 1.11147813e-01 2.44395100e-02
 1.12481080e-02 6.87957928e-02 3.45157944e-02 3.45604829e-02
 3.46120708e-02 1.34575777e-02 1.69249822e-03 1.33450031e-02
 3.96187417e-03 4.76237126e-02 3.45501713e-02 1.69247761e-03
 1.45156784e-02 1.12368157e-02 2.33337674e-02 4.62602871e-03
 1.12483827e-02 4.10803407e-02 3.45810317e-02 1.12483539e-02
 1.69247633e-03 3.45470272e-02 3.45748924e-02 5.46450354e-03
 6.66892389e-03 3.46155092e-02 2.14227801e-03 9.85654071e-03
 1.09559475e-02 5.30678313e-03 1.28229382e-02 4.81583411e-03
 5.70827909e-02 1.22765265e-02 7.11552519e-03 2.99378429e-02
 2.70759333e-02 3.09095299e-03 4.01180610e-02 2.54626982e-02
 3.70716453e-02 3.80305871e-02 9.72652435e-02 3.45578305e-02
 3.96183180e-03 4.44797389e-02 5.79392202e-02 1.59111898e-02
 7.62440776e-03 5.97555283e-03 1.03609405e-01 2.77356408e-03
 1.14664575e-02 3.22062075e-02 5.62666282e-02 4.81562782e-03
 4.36863257e-03 4.54119779e-03 4.66860309e-02 2.16081482e-03
 5.11404546e-03 1.73136536e-02 2.16081482e-03 2.34871898e-02
 4.81580524e-03 1.08301034e-02 1.12093305e-02 4.09074388e-02
 1.16817998e-02 5.25100576e-03 5.08974632e-03 7.29438476e-03
 5.08981943e-03 5.25102066e-03 2.03436380e-03 3.11732888e-02
 1.80989541e-02 4.58292104e-03 2.03436380e-03 1.16302306e-02
 2.73052417e-02 1.07065693e-01 2.57868059e-02 1.22158686e-02
 3.11564840e-02 1.16819097e-02 2.09933170e-03 6.41109981e-03
 9.12584458e-03 1.24439910e-01 8.19532108e-03 4.81566321e-03
 5.89678921e-02 3.76308197e-03 2.16081482e-03 2.21190695e-02
 2.71049142e-02 1.07196331e-01 3.03355213e-02 2.09932704e-03
 2.99632456e-02 2.41082534e-03 2.99140532e-02 4.76775737e-03
 1.09234555e-02 7.58862123e-02 1.79954886e-03 6.41112449e-03
 1.11464247e-01 2.41078739e-03 9.97869521e-02 1.75673491e-03
 1.97701505e-03 6.20402722e-03 1.78872899e-03 1.51718423e-01
 6.72856579e-03 2.16081482e-03 2.97259237e-03 4.75676078e-03
 4.75676218e-03 3.28812399e-03 5.22867851e-02 6.21687341e-03
 1.78903888e-03 2.14431863e-02 1.57148559e-02 5.02331108e-02
 2.14415882e-02 5.97539637e-03 1.78870955e-03 1.29815936e-02
 1.97701342e-03 1.09321838e-02 5.22442162e-03 1.50313461e-02
 7.05919936e-02 5.17059118e-02 6.21687341e-03 2.21131966e-02
 1.79954839e-03 6.41112914e-03 1.09111620e-02 1.07384771e-02
 4.59423773e-02 4.65607829e-02 1.79954502e-03 3.62053178e-02
 1.79953943e-03 4.86171953e-02 1.68508496e-02 2.14383341e-02
 4.50356537e-03 5.25045358e-02 1.82909966e-02 1.92593283e-03
 2.48558089e-01 1.92593725e-03 1.92594132e-03 1.92593248e-03
 1.92593678e-03 1.92593655e-03 1.92593248e-03 1.92593248e-03
 1.85342338e-02 4.44149971e-03 2.76181512e-02 1.92592398e-03
 1.92593527e-03 1.92593248e-03 1.92593981e-03 1.92593248e-03
 1.92593527e-03 1.92593248e-03 1.92593457e-03 1.92593527e-03
 2.07377765e-02 1.92593609e-03 1.92593527e-03 5.73955886e-02
 1.92593248e-03 3.19023873e-03 2.51389705e-02 1.79954374e-03
 3.08596864e-02 4.96542118e-02 1.96216237e-02 1.96216237e-02
 5.17295748e-02 3.08596864e-02 1.79954572e-03 1.78869313e-03
 1.78871781e-03 1.79954374e-03 1.78872305e-03 9.17027518e-03
 6.32190611e-03 1.92633527e-03 5.97537216e-03 1.79954374e-03
 4.75681573e-03 1.79954886e-03 1.79954502e-03 1.32772652e-02
 1.79954967e-03 1.78869313e-03 1.79954374e-03 1.79954222e-03
 2.14404278e-02 1.78870268e-03 1.79954222e-03 1.78872317e-03
 1.79954502e-03 1.79954886e-03 1.79954374e-03 3.34645174e-02
 2.42397692e-02 1.21509191e-02 1.92593527e-03 2.53113322e-02
 2.96234023e-02 1.79954502e-03 1.78872899e-03 2.42804028e-02
 1.92594412e-03 8.50599539e-03 2.41842531e-02 2.14962568e-03
 1.79955037e-03 1.79954374e-03 2.14783493e-02 3.78826745e-02
 1.86855067e-02 1.79954467e-03 1.85342170e-02 3.18152737e-03
 1.78868754e-03 1.53099699e-02 1.92593527e-03 1.25668664e-02
 2.05210261e-02 1.92593865e-03 1.92599848e-03 1.85342990e-02
 3.18147475e-03 1.79954967e-03 1.53730646e-01 3.57597135e-02
 2.12303475e-02 3.78857292e-02 5.51495748e-03 2.99363341e-02
 2.99377516e-02 2.49009561e-02 3.64226056e-03 1.92593527e-03
 4.82834876e-03 4.01849821e-02 3.78831476e-02 1.10624488e-02
 4.58345376e-03 5.32393064e-03 2.12257332e-03 2.12258054e-03
 2.12256750e-03 2.12256750e-03 2.12257332e-03 2.05087606e-02
 3.73586752e-02 2.12258054e-03 2.12261616e-03 1.92593248e-03
 3.02394759e-03 1.92593248e-03 2.99383048e-02 3.27416919e-02
 6.37688860e-02 8.96812975e-03 2.99392827e-02 4.83572893e-02
 2.07377449e-02 5.95033774e-03 2.07379572e-02 1.92593655e-03
 2.99396329e-02 1.96703407e-03 1.88639318e-03 1.88639329e-03
 2.12257332e-03 1.96702546e-03 3.92964631e-02 6.28612516e-03
 5.96891204e-03 1.92593760e-03 2.12256378e-03 6.82733767e-03
 1.88638165e-03 2.47621583e-03 2.36122566e-03 6.59847958e-03
 2.05088202e-02 1.10630527e-01 2.00097612e-03 5.94751500e-02
 1.32290898e-02 2.36123032e-03 3.51105980e-03 2.03158846e-03
 2.23662052e-03 2.34410493e-03 2.80296840e-02 5.47217717e-03
 2.84998808e-02 2.36122217e-03 2.36122357e-03 2.36122217e-03
 1.98067725e-03 6.82733767e-03 2.36122217e-03 2.23662052e-03
 2.36122217e-03 2.36122217e-03 2.36121286e-03 1.21396361e-02
 1.98203837e-03 2.95951031e-02 3.82722542e-02 3.33546475e-02
 4.13997797e-03 5.05238958e-03 3.09060737e-02 1.97896417e-02
 2.11367710e-03 1.96107081e-03 2.12212978e-03 2.89930459e-02
 2.89930012e-02 2.23662052e-03 3.40832397e-02 1.04682647e-01
 2.11372925e-03 2.19454011e-03 4.23209323e-03 3.41529883e-02
 1.98162789e-03 1.98162789e-03 1.98162789e-03 2.31196638e-03
 1.48403912e-03 1.15330657e-02 2.81546749e-02 1.29018083e-01
 7.50584900e-03 1.73182902e-03 5.45246433e-03 2.19454477e-03
 4.04819613e-03 1.63524020e-02 1.63675414e-03 4.03363444e-03
 2.11372925e-03 1.04482941e-01 2.19454477e-03 1.64114051e-02
 1.73183274e-03 1.57464407e-02 1.98162789e-03 2.31198082e-03
 1.63674378e-03 6.93336781e-03 2.97081508e-02 2.31196871e-03
 2.31196452e-03 2.31195474e-03 3.80258113e-02 1.47382632e-01
 9.38238919e-01 1.98162789e-03 1.14845380e-01 2.31196126e-03
 3.44342329e-02 4.26439289e-03 4.70663309e-02 7.73032010e-03
 2.31196033e-03 2.46175332e-03 4.53172624e-03 2.05145800e-03
 4.22584653e-01 7.73386890e-03 5.24776056e-02 5.31802420e-03
 3.92046236e-02 7.73010589e-03 2.80580595e-02 3.03569827e-02
 8.89902934e-03 4.08068746e-02 2.48775352e-02 2.03095586e-03
 2.03098822e-03 7.12570921e-02 1.87489748e-01 2.80281305e-02
 7.73011055e-03 8.89904238e-03 7.73010170e-03 1.30480703e-03
 2.04063044e-03 2.04063370e-03 1.41528831e-03 5.46316393e-02
 1.66206679e-03 2.04063044e-03 1.30480027e-03 9.49772820e-03
 2.04063044e-03 2.04063044e-03 2.65625748e-03 4.41307900e-03
 4.69937772e-02 4.59700674e-02 2.04063044e-03 2.11509392e-02
 9.49773006e-03 2.04063044e-03 2.17611110e-03 4.12632478e-03
 1.33218628e-03 1.33218395e-03 4.45862152e-02 4.12632665e-03
 2.04063044e-03 4.12633410e-03 4.50500287e-03 5.38704172e-02
 2.64730416e-02 2.04063044e-03 1.86815813e-01 4.03670967e-03
 4.03671665e-03 4.41309111e-03 2.96981167e-03 5.74844237e-03
 2.17611250e-03 6.23081718e-03 1.33732706e-03 3.13387513e-02
 8.07565171e-03 3.13388146e-02 1.45335525e-01 1.16100768e-03
 8.07564985e-03 3.25498730e-03 3.25498637e-03 3.61360274e-02
 3.25497822e-03 3.44097503e-02 2.96943146e-03 2.99258865e-02
 6.94157463e-03 1.16100686e-03 6.94134366e-03 1.91500783e-02
 5.30354939e-02 4.93573770e-02 3.25497496e-03 6.71905372e-03
 3.95132834e-03 3.25497496e-03 6.72563314e-02 7.05567822e-02
 6.71905372e-03 1.16101454e-03 3.25499033e-03 1.64121136e-01
 3.25499033e-03 3.25498404e-03 3.25498404e-03 2.15165829e-03
 3.79316732e-02 2.15165969e-03 5.05513372e-03 2.15166667e-03
 3.45258377e-02 4.49394435e-02 7.87493065e-02 3.25498288e-03
 3.25497822e-03 2.66398606e-03 3.25499033e-03 3.26475918e-01
 9.39073507e-03 2.15165829e-03 3.25498031e-03 3.25498730e-03
 3.25498264e-03 1.35238385e-02 3.25496541e-03 3.25498288e-03
 2.38396437e-03 9.39070992e-03 1.59006438e-03 4.64677811e-02
 2.38397601e-03 3.25497822e-03 3.25498288e-03 1.03547256e-02
 3.85842435e-02 3.91984507e-02 3.92010398e-02 3.79323540e-03
 2.79696994e-02 5.55616803e-03 7.33549707e-03 2.27438718e-01
 3.91998291e-02 2.37113913e-03 3.92009877e-02 6.36898493e-03
 7.33537273e-03 3.91992331e-02 4.60155215e-03 1.59005681e-03
 9.75766871e-03 3.01469071e-03 2.85074371e-03 3.84481298e-03
 6.58167340e-03 3.22175049e-03 5.70645509e-03 5.70648815e-03
 3.22173326e-03 5.70645509e-03 5.70654357e-03 5.70644857e-03
 5.70646627e-03 7.26083741e-02 5.70645230e-03 5.70644857e-03
 5.70646627e-03 5.70646115e-03]
2025-06-02 16:02:59,383 - DEBUG - Edge reconstruction errors: [1.3649857  1.3623579  0.9586074  ... 0.15859084 1.2595415  0.15859084]
2025-06-02 16:02:59,384 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160259_update_42.json
2025-06-02 16:02:59,385 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:02:59,393 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160259_update_42.pth and as latest_checkpoint.pth
2025-06-02 16:02:59,393 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870355.dot): 0.1065
2025-06-02 16:02:59,394 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:02:59,394 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.1621, MLP Score: 0.5072
2025-06-02 16:02:59,394 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.5225, MLP Score: 0.4994
2025-06-02 16:02:59,394 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.2440, MLP Score: 0.4729
2025-06-02 16:02:59,394 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.3723, MLP Score: 0.5157
2025-06-02 16:02:59,394 - WARNING -   Node ID: 142.251.111.94, Recon Error: 0.2000, MLP Score: 0.5092
2025-06-02 16:02:59,394 - WARNING - Detected 8 anomalous edges (reconstruction-based):
2025-06-02 16:02:59,394 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.0554, MLP Score: 0.4547
2025-06-02 16:02:59,394 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.4295, MLP Score: 0.4441
2025-06-02 16:02:59,394 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4856, MLP Score: 0.4740
2025-06-02 16:02:59,394 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 5.3196, MLP Score: 0.3627
2025-06-02 16:02:59,394 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7744, MLP Score: 0.4753
2025-06-02 16:02:59,394 - INFO - 
--- Processing file: nw_graph_encoded_1748870385.dot (Timestamp: 2025-06-02 15:19:45) ---
2025-06-02 16:02:59,394 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 16:02:59,395 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 16:02:59,424 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 16:02:59,450 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 16:02:59,450 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 16:02:59,450 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870385.dot
2025-06-02 16:02:59,469 - INFO - Parsed 944 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 16:02:59,489 - INFO - Parsed 2034 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870385.dot'.
2025-06-02 16:02:59,489 - INFO - Processing node updates/additions.
2025-06-02 16:02:59,494 - INFO - Processing edge updates/additions.
2025-06-02 16:02:59,503 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:02:59,504 - INFO - Finished updating NetworkX graph.
2025-06-02 16:02:59,504 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:02:59,505 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:02:59,514 - DEBUG - Initial node features tensor shape: torch.Size([944, 30])
2025-06-02 16:02:59,515 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:02:59,515 - DEBUG - Node features tensor shape after scaling: torch.Size([944, 30])
2025-06-02 16:02:59,517 - DEBUG - Edge index tensor shape: torch.Size([2, 2034])
2025-06-02 16:02:59,518 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:02:59,525 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:02:59,526 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:02:59,527 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:02:59,529 - DEBUG - Shape of encoded categorical edge features: torch.Size([2034, 3])
2025-06-02 16:02:59,530 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:02:59,530 - DEBUG - Shape of scaled numerical edge features: torch.Size([2034, 7])
2025-06-02 16:02:59,530 - DEBUG - Final edge attributes tensor shape: torch.Size([2034, 10])
2025-06-02 16:02:59,530 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:02:59,532 - INFO - Performing online update...
2025-06-02 16:02:59,532 - INFO - Starting online update for 50 steps.
2025-06-02 16:02:59,533 - DEBUG - Updated RunningStats: new_mean=0.9445968346702539, new_var=24600000000161.99, new_n=2490
2025-06-02 16:02:59,533 - DEBUG - Updated RunningStats: new_mean=0.9421383733471721, new_var=24900000000017.93, new_n=2520
2025-06-02 16:02:59,533 - DEBUG - Updated RunningStats: new_mean=1.13216940090386, new_var=8200000000094.044, new_n=830
2025-06-02 16:02:59,533 - DEBUG - Updated RunningStats: new_mean=1.1315390865483712, new_var=8300000000001.585, new_n=840
2025-06-02 16:02:59,533 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:02:59,534 - DEBUG - Online update step: 1/50
2025-06-02 16:02:59,535 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:02:59,697 - DEBUG - Node anomaly scores shape: torch.Size([18055, 1])
2025-06-02 16:02:59,708 - DEBUG - Edge anomaly scores shape: torch.Size([37495, 1])
2025-06-02 16:02:59,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:02:59,887 - DEBUG - Step 1: Loss=0.5902
2025-06-02 16:02:59,887 - DEBUG - Online update step: 2/50
2025-06-02 16:02:59,890 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:00,045 - DEBUG - Node anomaly scores shape: torch.Size([17655, 1])
2025-06-02 16:03:00,053 - DEBUG - Edge anomaly scores shape: torch.Size([36549, 1])
2025-06-02 16:03:00,057 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:00,407 - DEBUG - Step 2: Loss=0.5945
2025-06-02 16:03:00,408 - DEBUG - Online update step: 3/50
2025-06-02 16:03:00,411 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:00,568 - DEBUG - Node anomaly scores shape: torch.Size([16824, 1])
2025-06-02 16:03:00,573 - DEBUG - Edge anomaly scores shape: torch.Size([34842, 1])
2025-06-02 16:03:00,574 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:00,834 - DEBUG - Step 3: Loss=0.5906
2025-06-02 16:03:00,834 - DEBUG - Online update step: 4/50
2025-06-02 16:03:00,837 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:00,980 - DEBUG - Node anomaly scores shape: torch.Size([16938, 1])
2025-06-02 16:03:00,987 - DEBUG - Edge anomaly scores shape: torch.Size([35025, 1])
2025-06-02 16:03:00,988 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:01,267 - DEBUG - Step 4: Loss=0.5939
2025-06-02 16:03:01,268 - DEBUG - Online update step: 5/50
2025-06-02 16:03:01,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:01,408 - DEBUG - Node anomaly scores shape: torch.Size([17311, 1])
2025-06-02 16:03:01,415 - DEBUG - Edge anomaly scores shape: torch.Size([35795, 1])
2025-06-02 16:03:01,416 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:01,771 - DEBUG - Step 5: Loss=0.5887
2025-06-02 16:03:01,771 - DEBUG - Online update step: 6/50
2025-06-02 16:03:01,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:01,883 - DEBUG - Node anomaly scores shape: torch.Size([17085, 1])
2025-06-02 16:03:01,890 - DEBUG - Edge anomaly scores shape: torch.Size([35524, 1])
2025-06-02 16:03:01,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:02,181 - DEBUG - Step 6: Loss=0.5951
2025-06-02 16:03:02,182 - DEBUG - Online update step: 7/50
2025-06-02 16:03:02,191 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:02,341 - DEBUG - Node anomaly scores shape: torch.Size([18049, 1])
2025-06-02 16:03:02,347 - DEBUG - Edge anomaly scores shape: torch.Size([37481, 1])
2025-06-02 16:03:02,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:02,667 - DEBUG - Step 7: Loss=0.5893
2025-06-02 16:03:02,668 - DEBUG - Online update step: 8/50
2025-06-02 16:03:02,671 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:02,813 - DEBUG - Node anomaly scores shape: torch.Size([17370, 1])
2025-06-02 16:03:02,820 - DEBUG - Edge anomaly scores shape: torch.Size([36106, 1])
2025-06-02 16:03:02,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:03,150 - DEBUG - Step 8: Loss=0.5933
2025-06-02 16:03:03,151 - DEBUG - Online update step: 9/50
2025-06-02 16:03:03,154 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:03,318 - DEBUG - Node anomaly scores shape: torch.Size([17827, 1])
2025-06-02 16:03:03,326 - DEBUG - Edge anomaly scores shape: torch.Size([37066, 1])
2025-06-02 16:03:03,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:03,708 - DEBUG - Step 9: Loss=0.5892
2025-06-02 16:03:03,709 - DEBUG - Online update step: 10/50
2025-06-02 16:03:03,713 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:03,889 - DEBUG - Node anomaly scores shape: torch.Size([18730, 1])
2025-06-02 16:03:03,895 - DEBUG - Edge anomaly scores shape: torch.Size([39086, 1])
2025-06-02 16:03:03,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:04,246 - DEBUG - Step 10: Loss=0.5936
2025-06-02 16:03:04,247 - DEBUG - Online update step: 11/50
2025-06-02 16:03:04,250 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:04,385 - DEBUG - Node anomaly scores shape: torch.Size([18394, 1])
2025-06-02 16:03:04,390 - DEBUG - Edge anomaly scores shape: torch.Size([38389, 1])
2025-06-02 16:03:04,392 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:04,644 - DEBUG - Step 11: Loss=0.5886
2025-06-02 16:03:04,645 - DEBUG - Online update step: 12/50
2025-06-02 16:03:04,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:04,777 - DEBUG - Node anomaly scores shape: torch.Size([17896, 1])
2025-06-02 16:03:04,783 - DEBUG - Edge anomaly scores shape: torch.Size([37095, 1])
2025-06-02 16:03:04,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:05,150 - DEBUG - Step 12: Loss=0.5927
2025-06-02 16:03:05,150 - DEBUG - Online update step: 13/50
2025-06-02 16:03:05,162 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:05,321 - DEBUG - Node anomaly scores shape: torch.Size([18208, 1])
2025-06-02 16:03:05,329 - DEBUG - Edge anomaly scores shape: torch.Size([37780, 1])
2025-06-02 16:03:05,332 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:05,778 - DEBUG - Step 13: Loss=0.5881
2025-06-02 16:03:05,778 - DEBUG - Online update step: 14/50
2025-06-02 16:03:05,781 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:05,903 - DEBUG - Node anomaly scores shape: torch.Size([19584, 1])
2025-06-02 16:03:05,909 - DEBUG - Edge anomaly scores shape: torch.Size([41187, 1])
2025-06-02 16:03:05,910 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:06,191 - DEBUG - Step 14: Loss=0.5938
2025-06-02 16:03:06,192 - DEBUG - Online update step: 15/50
2025-06-02 16:03:06,197 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:06,295 - DEBUG - Node anomaly scores shape: torch.Size([15746, 1])
2025-06-02 16:03:06,299 - DEBUG - Edge anomaly scores shape: torch.Size([32478, 1])
2025-06-02 16:03:06,300 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:06,591 - DEBUG - Step 15: Loss=0.5887
2025-06-02 16:03:06,591 - DEBUG - Online update step: 16/50
2025-06-02 16:03:06,601 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:06,708 - DEBUG - Node anomaly scores shape: torch.Size([15898, 1])
2025-06-02 16:03:06,713 - DEBUG - Edge anomaly scores shape: torch.Size([32690, 1])
2025-06-02 16:03:06,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:06,938 - DEBUG - Step 16: Loss=0.5928
2025-06-02 16:03:06,939 - DEBUG - Online update step: 17/50
2025-06-02 16:03:06,945 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:07,046 - DEBUG - Node anomaly scores shape: torch.Size([16132, 1])
2025-06-02 16:03:07,051 - DEBUG - Edge anomaly scores shape: torch.Size([33296, 1])
2025-06-02 16:03:07,052 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:07,298 - DEBUG - Step 17: Loss=0.5876
2025-06-02 16:03:07,298 - DEBUG - Online update step: 18/50
2025-06-02 16:03:07,301 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:07,424 - DEBUG - Node anomaly scores shape: torch.Size([17531, 1])
2025-06-02 16:03:07,431 - DEBUG - Edge anomaly scores shape: torch.Size([36415, 1])
2025-06-02 16:03:07,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:07,708 - DEBUG - Step 18: Loss=0.5913
2025-06-02 16:03:07,708 - DEBUG - Online update step: 19/50
2025-06-02 16:03:07,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:07,855 - DEBUG - Node anomaly scores shape: torch.Size([17030, 1])
2025-06-02 16:03:07,861 - DEBUG - Edge anomaly scores shape: torch.Size([35133, 1])
2025-06-02 16:03:07,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:08,148 - DEBUG - Step 19: Loss=0.5872
2025-06-02 16:03:08,148 - DEBUG - Online update step: 20/50
2025-06-02 16:03:08,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:08,349 - DEBUG - Node anomaly scores shape: torch.Size([18215, 1])
2025-06-02 16:03:08,365 - DEBUG - Edge anomaly scores shape: torch.Size([37772, 1])
2025-06-02 16:03:08,420 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:08,694 - DEBUG - Step 20: Loss=0.5904
2025-06-02 16:03:08,694 - DEBUG - Online update step: 21/50
2025-06-02 16:03:08,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:08,860 - DEBUG - Node anomaly scores shape: torch.Size([17759, 1])
2025-06-02 16:03:08,866 - DEBUG - Edge anomaly scores shape: torch.Size([37068, 1])
2025-06-02 16:03:08,867 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:09,166 - DEBUG - Step 21: Loss=0.5873
2025-06-02 16:03:09,166 - DEBUG - Online update step: 22/50
2025-06-02 16:03:09,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:09,345 - DEBUG - Node anomaly scores shape: torch.Size([18285, 1])
2025-06-02 16:03:09,352 - DEBUG - Edge anomaly scores shape: torch.Size([38080, 1])
2025-06-02 16:03:09,354 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:09,746 - DEBUG - Step 22: Loss=0.5922
2025-06-02 16:03:09,747 - DEBUG - Online update step: 23/50
2025-06-02 16:03:09,750 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:09,919 - DEBUG - Node anomaly scores shape: torch.Size([17990, 1])
2025-06-02 16:03:09,927 - DEBUG - Edge anomaly scores shape: torch.Size([37374, 1])
2025-06-02 16:03:09,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:10,305 - DEBUG - Step 23: Loss=0.5877
2025-06-02 16:03:10,306 - DEBUG - Online update step: 24/50
2025-06-02 16:03:10,309 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:10,457 - DEBUG - Node anomaly scores shape: torch.Size([18790, 1])
2025-06-02 16:03:10,464 - DEBUG - Edge anomaly scores shape: torch.Size([39069, 1])
2025-06-02 16:03:10,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:10,794 - DEBUG - Step 24: Loss=0.5909
2025-06-02 16:03:10,795 - DEBUG - Online update step: 25/50
2025-06-02 16:03:10,798 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:10,953 - DEBUG - Node anomaly scores shape: torch.Size([16585, 1])
2025-06-02 16:03:10,960 - DEBUG - Edge anomaly scores shape: torch.Size([34414, 1])
2025-06-02 16:03:10,962 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:11,216 - DEBUG - Step 25: Loss=0.5868
2025-06-02 16:03:11,216 - DEBUG - Online update step: 26/50
2025-06-02 16:03:11,219 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:11,337 - DEBUG - Node anomaly scores shape: torch.Size([17936, 1])
2025-06-02 16:03:11,344 - DEBUG - Edge anomaly scores shape: torch.Size([37334, 1])
2025-06-02 16:03:11,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:11,677 - DEBUG - Step 26: Loss=0.5911
2025-06-02 16:03:11,678 - DEBUG - Online update step: 27/50
2025-06-02 16:03:11,696 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:11,848 - DEBUG - Node anomaly scores shape: torch.Size([18169, 1])
2025-06-02 16:03:11,853 - DEBUG - Edge anomaly scores shape: torch.Size([37849, 1])
2025-06-02 16:03:11,854 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:12,169 - DEBUG - Step 27: Loss=0.5858
2025-06-02 16:03:12,169 - DEBUG - Online update step: 28/50
2025-06-02 16:03:12,174 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:12,321 - DEBUG - Node anomaly scores shape: torch.Size([18960, 1])
2025-06-02 16:03:12,328 - DEBUG - Edge anomaly scores shape: torch.Size([39590, 1])
2025-06-02 16:03:12,329 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:12,649 - DEBUG - Step 28: Loss=0.5894
2025-06-02 16:03:12,650 - DEBUG - Online update step: 29/50
2025-06-02 16:03:12,660 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:12,844 - DEBUG - Node anomaly scores shape: torch.Size([17823, 1])
2025-06-02 16:03:12,854 - DEBUG - Edge anomaly scores shape: torch.Size([37018, 1])
2025-06-02 16:03:12,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:13,194 - DEBUG - Step 29: Loss=0.5864
2025-06-02 16:03:13,195 - DEBUG - Online update step: 30/50
2025-06-02 16:03:13,198 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:13,331 - DEBUG - Node anomaly scores shape: torch.Size([18488, 1])
2025-06-02 16:03:13,340 - DEBUG - Edge anomaly scores shape: torch.Size([38563, 1])
2025-06-02 16:03:13,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:13,740 - DEBUG - Step 30: Loss=0.5905
2025-06-02 16:03:13,740 - DEBUG - Online update step: 31/50
2025-06-02 16:03:13,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:13,870 - DEBUG - Node anomaly scores shape: torch.Size([17304, 1])
2025-06-02 16:03:13,875 - DEBUG - Edge anomaly scores shape: torch.Size([35902, 1])
2025-06-02 16:03:13,876 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:14,172 - DEBUG - Step 31: Loss=0.5870
2025-06-02 16:03:14,173 - DEBUG - Online update step: 32/50
2025-06-02 16:03:14,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:14,297 - DEBUG - Node anomaly scores shape: torch.Size([18403, 1])
2025-06-02 16:03:14,302 - DEBUG - Edge anomaly scores shape: torch.Size([38628, 1])
2025-06-02 16:03:14,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:14,626 - DEBUG - Step 32: Loss=0.5901
2025-06-02 16:03:14,626 - DEBUG - Online update step: 33/50
2025-06-02 16:03:14,629 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:14,766 - DEBUG - Node anomaly scores shape: torch.Size([18927, 1])
2025-06-02 16:03:14,772 - DEBUG - Edge anomaly scores shape: torch.Size([39557, 1])
2025-06-02 16:03:14,773 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:15,046 - DEBUG - Step 33: Loss=0.5849
2025-06-02 16:03:15,046 - DEBUG - Online update step: 34/50
2025-06-02 16:03:15,049 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:15,176 - DEBUG - Node anomaly scores shape: torch.Size([19473, 1])
2025-06-02 16:03:15,182 - DEBUG - Edge anomaly scores shape: torch.Size([40784, 1])
2025-06-02 16:03:15,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:15,480 - DEBUG - Step 34: Loss=0.5906
2025-06-02 16:03:15,480 - DEBUG - Online update step: 35/50
2025-06-02 16:03:15,483 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:15,622 - DEBUG - Node anomaly scores shape: torch.Size([16091, 1])
2025-06-02 16:03:15,631 - DEBUG - Edge anomaly scores shape: torch.Size([33228, 1])
2025-06-02 16:03:15,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:16,016 - DEBUG - Step 35: Loss=0.5862
2025-06-02 16:03:16,016 - DEBUG - Online update step: 36/50
2025-06-02 16:03:16,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:16,240 - DEBUG - Node anomaly scores shape: torch.Size([19801, 1])
2025-06-02 16:03:16,252 - DEBUG - Edge anomaly scores shape: torch.Size([41609, 1])
2025-06-02 16:03:16,261 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:16,711 - DEBUG - Step 36: Loss=0.5889
2025-06-02 16:03:16,711 - DEBUG - Online update step: 37/50
2025-06-02 16:03:16,719 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:16,966 - DEBUG - Node anomaly scores shape: torch.Size([17490, 1])
2025-06-02 16:03:17,006 - DEBUG - Edge anomaly scores shape: torch.Size([36327, 1])
2025-06-02 16:03:17,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:17,485 - DEBUG - Step 37: Loss=0.5851
2025-06-02 16:03:17,486 - DEBUG - Online update step: 38/50
2025-06-02 16:03:17,508 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:17,835 - DEBUG - Node anomaly scores shape: torch.Size([17893, 1])
2025-06-02 16:03:17,847 - DEBUG - Edge anomaly scores shape: torch.Size([37238, 1])
2025-06-02 16:03:17,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:18,306 - DEBUG - Step 38: Loss=0.5898
2025-06-02 16:03:18,306 - DEBUG - Online update step: 39/50
2025-06-02 16:03:18,316 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:18,454 - DEBUG - Node anomaly scores shape: torch.Size([16910, 1])
2025-06-02 16:03:18,461 - DEBUG - Edge anomaly scores shape: torch.Size([34936, 1])
2025-06-02 16:03:18,465 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:18,957 - DEBUG - Step 39: Loss=0.5853
2025-06-02 16:03:18,957 - DEBUG - Online update step: 40/50
2025-06-02 16:03:18,961 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:19,276 - DEBUG - Node anomaly scores shape: torch.Size([17718, 1])
2025-06-02 16:03:19,286 - DEBUG - Edge anomaly scores shape: torch.Size([36832, 1])
2025-06-02 16:03:19,287 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:19,750 - DEBUG - Step 40: Loss=0.5890
2025-06-02 16:03:19,750 - DEBUG - Online update step: 41/50
2025-06-02 16:03:19,755 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:20,099 - DEBUG - Node anomaly scores shape: torch.Size([19884, 1])
2025-06-02 16:03:20,113 - DEBUG - Edge anomaly scores shape: torch.Size([41511, 1])
2025-06-02 16:03:20,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:20,668 - DEBUG - Step 41: Loss=0.5843
2025-06-02 16:03:20,668 - DEBUG - Online update step: 42/50
2025-06-02 16:03:20,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:20,961 - DEBUG - Node anomaly scores shape: torch.Size([17160, 1])
2025-06-02 16:03:20,969 - DEBUG - Edge anomaly scores shape: torch.Size([35739, 1])
2025-06-02 16:03:20,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:21,275 - DEBUG - Step 42: Loss=0.5907
2025-06-02 16:03:21,276 - DEBUG - Online update step: 43/50
2025-06-02 16:03:21,279 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:21,414 - DEBUG - Node anomaly scores shape: torch.Size([19116, 1])
2025-06-02 16:03:21,425 - DEBUG - Edge anomaly scores shape: torch.Size([39918, 1])
2025-06-02 16:03:21,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:21,836 - DEBUG - Step 43: Loss=0.5850
2025-06-02 16:03:21,837 - DEBUG - Online update step: 44/50
2025-06-02 16:03:21,853 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:22,050 - DEBUG - Node anomaly scores shape: torch.Size([17637, 1])
2025-06-02 16:03:22,070 - DEBUG - Edge anomaly scores shape: torch.Size([36660, 1])
2025-06-02 16:03:22,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:22,472 - DEBUG - Step 44: Loss=0.5885
2025-06-02 16:03:22,472 - DEBUG - Online update step: 45/50
2025-06-02 16:03:22,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:22,679 - DEBUG - Node anomaly scores shape: torch.Size([17869, 1])
2025-06-02 16:03:22,700 - DEBUG - Edge anomaly scores shape: torch.Size([37099, 1])
2025-06-02 16:03:22,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:23,134 - DEBUG - Step 45: Loss=0.5846
2025-06-02 16:03:23,134 - DEBUG - Online update step: 46/50
2025-06-02 16:03:23,138 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:23,406 - DEBUG - Node anomaly scores shape: torch.Size([18479, 1])
2025-06-02 16:03:23,422 - DEBUG - Edge anomaly scores shape: torch.Size([38487, 1])
2025-06-02 16:03:23,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:23,833 - DEBUG - Step 46: Loss=0.5889
2025-06-02 16:03:23,834 - DEBUG - Online update step: 47/50
2025-06-02 16:03:23,837 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:24,097 - DEBUG - Node anomaly scores shape: torch.Size([17800, 1])
2025-06-02 16:03:24,110 - DEBUG - Edge anomaly scores shape: torch.Size([36925, 1])
2025-06-02 16:03:24,114 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:24,535 - DEBUG - Step 47: Loss=0.5843
2025-06-02 16:03:24,536 - DEBUG - Online update step: 48/50
2025-06-02 16:03:24,557 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:24,890 - DEBUG - Node anomaly scores shape: torch.Size([17985, 1])
2025-06-02 16:03:24,898 - DEBUG - Edge anomaly scores shape: torch.Size([37536, 1])
2025-06-02 16:03:24,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:25,260 - DEBUG - Step 48: Loss=0.5880
2025-06-02 16:03:25,260 - DEBUG - Online update step: 49/50
2025-06-02 16:03:25,263 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:25,450 - DEBUG - Node anomaly scores shape: torch.Size([17844, 1])
2025-06-02 16:03:25,456 - DEBUG - Edge anomaly scores shape: torch.Size([37236, 1])
2025-06-02 16:03:25,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:25,944 - DEBUG - Step 49: Loss=0.5846
2025-06-02 16:03:25,944 - DEBUG - Online update step: 50/50
2025-06-02 16:03:25,947 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:26,097 - DEBUG - Node anomaly scores shape: torch.Size([16763, 1])
2025-06-02 16:03:26,105 - DEBUG - Edge anomaly scores shape: torch.Size([34747, 1])
2025-06-02 16:03:26,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:26,440 - DEBUG - Step 50: Loss=0.5896
2025-06-02 16:03:26,440 - INFO - Online update finished. Average loss: 0.5891, Learning rate: 0.001000
2025-06-02 16:03:26,441 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], current edge mean: [ 9.1450348e+00  1.4105211e+00  5.6882987e+00 -3.7509316e-09
  0.0000000e+00 -2.8131986e-09 -3.7509316e-09 -9.3773289e-10
  3.7509316e-09  2.8131986e-09]
2025-06-02 16:03:26,441 - DEBUG - Node drift difference: 0.0128, Edge drift difference: 0.0027
2025-06-02 16:03:26,442 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.0204965e-08 -2.0204965e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  1.5658847e-08
 -1.2122978e-08  2.3993396e-09 -1.9194717e-08 -3.0307445e-09
  2.3029661e+00  2.9618645e+00  1.3559322e-01  4.4152541e+00
 -3.7884307e-10  3.2870762e+00  5.8845339e+00  7.6080508e+00
  1.3559322e-01  7.9925847e+00 -2.2225461e-08 -6.0614891e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  8.0819857e-09 -2.0204965e-08], edge=[ 9.1450348e+00  1.4105211e+00  5.6882987e+00 -3.7509316e-09
  0.0000000e+00 -2.8131986e-09 -3.7509316e-09 -9.3773289e-10
  3.7509316e-09  2.8131986e-09]
2025-06-02 16:03:26,443 - DEBUG - Updated reference std: node=[0.         0.         1.0005301  1.0005301  0.         0.
 0.         1.0005301  1.0005301  1.0005301  1.0005301  1.0005301
 1.0107334  0.27367172 0.36063462 0.5744843  1.0005301  2.9573143
 2.8775678  1.49335    0.36063462 0.22783059 1.0005301  1.0005301
 0.         0.         0.         0.         1.00053    1.00053   ], edge=[1.1191256  0.50487775 2.166505   1.0002459  1.0002459  1.0002459
 1.0002459  1.0002459  1.0002459  1.0002459 ]
2025-06-02 16:03:26,446 - INFO - Online update complete. Loss: 0.5891
2025-06-02 16:03:26,446 - INFO - Running anomaly detection...
2025-06-02 16:03:26,446 - INFO - Starting anomaly detection.
2025-06-02 16:03:26,458 - DEBUG - Node reconstruction errors: [0.10292898 0.9579163  0.08874753 0.00867195 0.03189445 0.02629237
 0.13838294 0.02258226 0.02258226 0.01986696 0.02258226 0.01215275
 0.48473006 0.14975534 0.00280238 0.02430782 0.02156346 0.02430824
 0.01118008 0.02390814 0.02395337 0.00280239 0.04948017 0.00547514
 0.00277075 0.00565952 0.00277057 0.04239632 0.02233224 0.00277056
 0.06478693 0.08346342 0.03291275 0.00750915 0.02486758 0.03070371
 0.0621168  0.02390813 0.07326265 0.09729899 0.00763674 0.00242484
 0.02390813 0.01572625 0.0127547  0.01265402 0.01878167 0.22132461
 0.02232207 0.12017953 0.09031831 0.00525647 0.00518901 0.0151949
 0.02178508 0.05252622 0.10333475 0.02380261 0.00799001 0.02750068
 0.17174989 0.01586227 0.00214868 0.00436694 0.04568782 0.02178504
 0.00596407 0.02178493 0.00214865 0.02628383 0.02497783 0.01385496
 0.00576663 0.02805368 0.02840959 0.01468379 0.03162817 0.07904895
 0.02094231 0.02494458 0.00637831 0.03092477 0.30930537 0.02315866
 0.02599814 0.01100155 0.04765157 0.02418548 0.02498581 0.11786187
 0.00233934 0.03628046 0.00542797 0.02017085 0.01034787 0.06661759
 0.00660577 0.01937502 0.00186698 0.03042676 0.00889176 0.00660577
 0.01159113 0.1466369  0.00437192 0.02324593 0.00397446 0.03411157
 0.00452529 0.14548945 0.11827729 0.00737216 0.03751487 0.06467865
 0.01043788 0.01187631 0.00916966 0.02971095 0.01923663 0.00619709
 0.00231846 0.00589278 0.04982983 0.00747678 0.02010061 0.00619536
 0.00758706 0.01895274 0.02457147 0.00490941 0.00500508 0.00589145
 0.13965379 0.16384274 0.00893708 0.02107308 0.0095863  0.0018077
 0.11981001 0.03132856 0.0128538  0.04237019 0.00268499 0.00948736
 0.01285336 0.02719601 0.00916725 0.09068262 0.01112931 0.02763646
 0.3232764  0.00538377 0.03154391 0.00589145 0.0333209  0.02945631
 0.00490554 0.040413   0.00889124 0.01074513 0.01285463 0.0075548
 0.00490555 0.00500508 0.00779317 0.0313054  0.01579933 0.02116456
 0.00820301 0.02737843 0.02558592 0.00646417 0.00212923 0.04834592
 0.01924602 0.01294242 0.02156685 0.0492297  0.00725126 0.00725099
 0.02352759 0.00839691 0.00806055 0.06181732 0.04421635 0.01950388
 0.00261585 0.02694315 0.02124401 0.00452501 0.03312862 0.01933085
 0.01269369 0.00513085 0.1198094  0.0047133  0.32595438 0.01250065
 0.03148452 0.01194812 0.00389648 0.00490559 0.03377955 0.02627682
 0.01937416 0.00837785 0.02194127 0.12082066 0.00210694 0.02996584
 0.00659777 0.04079654 0.00397558 0.03962179 0.01722655 0.00333719
 0.02127218 0.0091701  0.09573071 0.00513082 0.05658579 0.00261585
 0.00197591 0.00397558 0.00490553 0.03194455 0.02707296 0.0054948
 0.02446784 0.00491878 0.00307879 0.03892465 0.02353184 0.00916854
 0.00916978 0.0073125  0.02894303 0.0019759  0.00490555 0.01906075
 0.02796968 0.02509107 0.00609046 0.02149507 0.00520308 0.02327196
 0.02458638 0.0443967  0.00609046 0.00666422 0.00212923 0.0025439
 0.09572903 0.02014123 0.02344577 0.04050518 0.00452418 0.00254173
 0.01013258 0.00725122 0.02664808 0.01081827 0.02006336 0.010006
 0.02075881 0.01151507 0.01617056 0.10950121 0.01618461 0.02074385
 0.09483115 0.05331308 0.0291884  0.01871024 0.01409639 0.07522701
 0.00205116 0.08863414 0.02352762 0.01751563 0.10296972 0.00189149
 0.02094822 0.00717312 0.03002608 0.00442491 0.10257513 0.01566655
 0.00839691 0.00833671 0.01160761 0.00764497 0.03706256 0.00520309
 0.13871434 0.00389127 0.02295659 0.00738013 0.0047129  0.01200525
 0.02070876 0.01286268 0.01329161 0.01089967 0.00178717 0.00178717
 0.00178718 0.01384006 0.0091083  0.01286269 0.00178719 0.03146052
 0.00178718 0.004183   0.00935356 0.02508649 0.11641189 0.0064603
 0.00384703 0.00521768 0.03559195 0.00635702 0.01530223 0.01329166
 0.03230068 0.0569538  0.13563256 0.03695987 0.03002558 0.03002165
 0.10887751 0.0045326  0.00178731 0.01409659 0.00178719 0.01383891
 0.0076702  0.00233669 0.01539304 0.00184553 0.01286732 0.00581033
 0.00184553 0.02054308 0.02067168 0.02126527 0.01329166 0.00489111
 0.01796271 0.02267175 0.00178724 0.0180219  0.0351634  0.04947762
 0.00544344 0.00452419 0.01286295 0.00178718 0.00175923 0.04197032
 0.02501708 0.00428004 0.11334565 0.03114819 0.01329537 0.02573372
 0.00196694 0.03641869 0.00727306 0.00734739 0.02642534 0.02680481
 0.01925894 0.02976417 0.02059845 0.04946723 0.00190294 0.00502331
 0.03645881 0.00178717 0.01329159 0.00844677 0.00489529 0.02054825
 0.00889812 0.01649701 0.02345926 0.00701927 0.03140818 0.00178719
 0.10636795 0.01857099 0.00550843 0.05344042 0.02937202 0.0293987
 0.02942914 0.01057894 0.00182768 0.01000198 0.00388537 0.04717264
 0.04741269 0.00182757 0.00822092 0.00552054 0.01626384 0.00421553
 0.00550825 0.03507856 0.02941114 0.00550829 0.00182763 0.02939044
 0.02940685 0.00559171 0.00599621 0.02943155 0.00190363 0.00543864
 0.00642833 0.00403521 0.00658655 0.00450725 0.04648662 0.00721974
 0.00480572 0.01376672 0.01916719 0.00385802 0.01552677 0.02420874
 0.03000469 0.03574368 0.08587494 0.02939727 0.00388528 0.02253157
 0.04774931 0.00730608 0.0043659  0.00477854 0.09677356 0.00237905
 0.00582722 0.03008917 0.04738902 0.00421196 0.00392564 0.00430224
 0.03381249 0.00193815 0.0045382  0.00871201 0.00193815 0.0220226
 0.00450676 0.00638752 0.00686834 0.01869399 0.00667406 0.00481927
 0.00440298 0.00660978 0.00440391 0.00481925 0.00217091 0.01647558
 0.01286056 0.00410514 0.00217091 0.0066658  0.01708779 0.09513521
 0.01754451 0.00632095 0.01646171 0.00667406 0.00203884 0.0052201
 0.00581599 0.1122473  0.00473719 0.00421211 0.04691698 0.00316504
 0.00193815 0.01550165 0.02108431 0.09519415 0.02079016 0.00203882
 0.02053431 0.00223374 0.02249593 0.00460674 0.00613361 0.05701046
 0.00191276 0.00522006 0.10138991 0.00223363 0.09638593 0.00181631
 0.00217747 0.00554616 0.00210786 0.13290331 0.00464709 0.00193815
 0.00269676 0.00412179 0.00412175 0.00259671 0.02846227 0.00378804
 0.00210861 0.01351681 0.00954243 0.03233726 0.04344814 0.00477819
 0.00210783 0.00811085 0.00217747 0.00614076 0.00454465 0.01140092
 0.04336489 0.02454551 0.00378803 0.01472059 0.00191277 0.00522007
 0.0061266  0.00508931 0.0272534  0.02449781 0.00191276 0.03212404
 0.00191277 0.02977391 0.00801688 0.01351301 0.00387206 0.03776778
 0.01324567 0.00204333 0.24304222 0.00204333 0.00204333 0.00204333
 0.00204333 0.00204333 0.00204334 0.00204333 0.01302587 0.00382846
 0.02153134 0.00204332 0.00204333 0.00204334 0.00204333 0.00204334
 0.00204333 0.00204333 0.00204333 0.00204333 0.01305604 0.00204334
 0.00204333 0.04587828 0.00204334 0.00351562 0.02427897 0.00191276
 0.02316394 0.03977948 0.01771155 0.01771155 0.02504036 0.02316394
 0.00191277 0.00210782 0.00210786 0.00191276 0.00210787 0.00556009
 0.00455336 0.00204393 0.00477812 0.00191276 0.00412185 0.00191276
 0.00191277 0.00634526 0.00191276 0.00210782 0.00191276 0.00191277
 0.01351453 0.00210783 0.00191277 0.00210787 0.00191277 0.00191276
 0.00191276 0.01378049 0.01652382 0.0062184  0.00204333 0.02424632
 0.02308859 0.00191277 0.00210787 0.01185367 0.00204337 0.00447285
 0.01888188 0.00239412 0.00191276 0.00191276 0.01725715 0.01483533
 0.00891904 0.00191278 0.01302581 0.00293752 0.00210784 0.01241342
 0.00204333 0.0067448  0.01245531 0.00204334 0.00204347 0.01302579
 0.0029374  0.00191276 0.13635927 0.05337005 0.0111069  0.01483669
 0.00366651 0.02603307 0.02603356 0.02369031 0.00266307 0.00204333
 0.00402402 0.0319323  0.01483583 0.00488663 0.00301418 0.00318236
 0.00214288 0.00214289 0.00214288 0.00214288 0.00214288 0.01294497
 0.02967543 0.00214289 0.00214293 0.00204334 0.00284117 0.00204333
 0.02603379 0.01382403 0.05117598 0.00669053 0.03976552 0.03463274
 0.01305602 0.00339607 0.01305636 0.00204333 0.02603455 0.00222194
 0.00223048 0.00223049 0.00214288 0.00222195 0.02043742 0.00552247
 0.00410228 0.00204333 0.00214288 0.00372512 0.00223049 0.00250613
 0.00203862 0.00389982 0.01294501 0.09993079 0.00226597 0.05709356
 0.00583938 0.00203866 0.00335788 0.00223845 0.00188629 0.00196404
 0.02422222 0.00376588 0.02491185 0.00203863 0.00203864 0.00203862
 0.00186682 0.00372512 0.00203863 0.00188629 0.00203862 0.00203862
 0.00203864 0.00556012 0.00218744 0.01972208 0.02167516 0.02900054
 0.00384732 0.00411471 0.02039738 0.0177482  0.00176655 0.00216936
 0.0017852  0.02670653 0.02670647 0.00188629 0.02862475 0.09627756
 0.0017677  0.00214994 0.00449329 0.03052972 0.00217366 0.00217366
 0.00217366 0.00219811 0.0015151  0.00913973 0.02594904 0.11033656
 0.00439601 0.00163187 0.00431073 0.0021499  0.00377409 0.00918965
 0.0015974  0.00315016 0.0017677  0.09607872 0.0021499  0.00923179
 0.00163182 0.01319283 0.00217366 0.00219812 0.00159746 0.00510362
 0.02731866 0.00219813 0.00219811 0.00219811 0.02578615 0.15333945
 0.8864366  0.00217366 0.08693401 0.00219813 0.02984092 0.00360414
 0.03755727 0.00560305 0.00219812 0.00228329 0.00399131 0.00167666
 0.33967474 0.00561028 0.0341886  0.00395577 0.02157555 0.00560258
 0.02388924 0.02795536 0.00643225 0.0155036  0.01621972 0.00166057
 0.00166072 0.06736612 0.16071984 0.0221197  0.00560257 0.00643223
 0.00560259 0.00146897 0.00164883 0.00164884 0.00149962 0.03254974
 0.00158894 0.00164884 0.00146895 0.00715093 0.00164884 0.00164884
 0.00239292 0.00311039 0.02529994 0.02634825 0.00164884 0.0134768
 0.00715093 0.00164883 0.00166972 0.0038574  0.00148239 0.00148239
 0.02845759 0.00385741 0.00164884 0.0038574  0.003718   0.03007355
 0.02435995 0.00164884 0.158344   0.00373776 0.0037378  0.0031104
 0.00253976 0.00457148 0.00166972 0.00380856 0.00156065 0.02895924
 0.00598512 0.02895924 0.12579001 0.00150388 0.00598512 0.00274219
 0.00274219 0.03270991 0.00274219 0.00801613 0.00253926 0.02793361
 0.0050151  0.00150388 0.00501473 0.01538832 0.03042095 0.03322679
 0.0027422  0.0041161  0.00304889 0.0027422  0.03145582 0.05950185
 0.00411612 0.00150391 0.00274221 0.14211318 0.00274221 0.00274222
 0.00274219 0.00175673 0.02626007 0.00175673 0.00441042 0.00175675
 0.02372621 0.03554239 0.05770097 0.0027422  0.00274219 0.00290928
 0.00274221 0.2070861  0.0044073  0.00175673 0.00290928 0.00274219
 0.00274219 0.00987494 0.00290931 0.0027422  0.00279362 0.00650942
 0.00170981 0.0320497  0.00279363 0.00274219 0.0027422  0.00621425
 0.03118998 0.0303051  0.03030496 0.0030736  0.02458742 0.00369575
 0.00586887 0.19727547 0.03030504 0.0018266  0.03030495 0.00393133
 0.00586855 0.03030506 0.00362263 0.00170982 0.00773204 0.00330239
 0.00211908 0.00378369 0.00515214 0.00307893 0.00438663 0.00438668
 0.03670858 0.00438663 0.00438679 0.00438663 0.00438662 0.05779387
 0.00438663 0.00438662 0.00438662 0.00438662 0.00438662 0.00438662
 0.00438662 0.00438662 0.00438662 0.00854078 0.00438662 0.00438662
 0.00438662 0.00438663]
2025-06-02 16:03:26,459 - DEBUG - Edge reconstruction errors: [1.3648198 1.3621979 0.9584495 ... 0.1584327 1.2593846 0.1584327]
2025-06-02 16:03:26,461 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160326_update_43.json
2025-06-02 16:03:26,462 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:03:26,471 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160326_update_43.pth and as latest_checkpoint.pth
2025-06-02 16:03:26,471 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870385.dot): 0.1117
2025-06-02 16:03:26,471 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:03:26,471 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.9579, MLP Score: 0.5274
2025-06-02 16:03:26,471 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4847, MLP Score: 0.5157
2025-06-02 16:03:26,472 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.2213, MLP Score: 0.4860
2025-06-02 16:03:26,472 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.1717, MLP Score: 0.4911
2025-06-02 16:03:26,472 - WARNING -   Node ID: 142.250.71.227, Recon Error: 0.3093, MLP Score: 0.5242
2025-06-02 16:03:26,472 - WARNING - Detected 9 anomalous edges (reconstruction-based):
2025-06-02 16:03:26,472 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.0553, MLP Score: 0.5194
2025-06-02 16:03:26,472 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.4804, MLP Score: 0.4966
2025-06-02 16:03:26,472 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4930, MLP Score: 0.5048
2025-06-02 16:03:26,472 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 5.5660, MLP Score: 0.3982
2025-06-02 16:03:26,472 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7975, MLP Score: 0.5098
2025-06-02 16:03:26,472 - INFO - 
--- Processing file: nw_graph_encoded_1748870415.dot (Timestamp: 2025-06-02 15:20:15) ---
2025-06-02 16:03:26,472 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 16:03:26,472 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 16:03:26,502 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 16:03:26,535 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 16:03:26,535 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 16:03:26,536 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870415.dot
2025-06-02 16:03:26,566 - INFO - Parsed 957 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 16:03:26,600 - INFO - Parsed 2059 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870415.dot'.
2025-06-02 16:03:26,600 - INFO - Processing node updates/additions.
2025-06-02 16:03:26,607 - INFO - Processing edge updates/additions.
2025-06-02 16:03:26,623 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:03:26,624 - INFO - Finished updating NetworkX graph.
2025-06-02 16:03:26,625 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:03:26,627 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:03:26,639 - DEBUG - Initial node features tensor shape: torch.Size([957, 30])
2025-06-02 16:03:26,641 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:03:26,641 - DEBUG - Node features tensor shape after scaling: torch.Size([957, 30])
2025-06-02 16:03:26,643 - DEBUG - Edge index tensor shape: torch.Size([2, 2059])
2025-06-02 16:03:26,644 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:03:26,650 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:03:26,651 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:03:26,653 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:03:26,655 - DEBUG - Shape of encoded categorical edge features: torch.Size([2059, 3])
2025-06-02 16:03:26,656 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:03:26,656 - DEBUG - Shape of scaled numerical edge features: torch.Size([2059, 7])
2025-06-02 16:03:26,656 - DEBUG - Final edge attributes tensor shape: torch.Size([2059, 10])
2025-06-02 16:03:26,656 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:03:26,660 - INFO - Performing online update...
2025-06-02 16:03:26,660 - INFO - Starting online update for 50 steps.
2025-06-02 16:03:26,661 - DEBUG - Updated RunningStats: new_mean=0.944677028690125, new_var=25200000000162.082, new_n=2550
2025-06-02 16:03:26,661 - DEBUG - Updated RunningStats: new_mean=0.9422583820159048, new_var=25500000000017.926, new_n=2580
2025-06-02 16:03:26,662 - DEBUG - Updated RunningStats: new_mean=1.137344080178307, new_var=8400000000094.018, new_n=850
2025-06-02 16:03:26,662 - DEBUG - Updated RunningStats: new_mean=1.1366519379443802, new_var=8500000000001.575, new_n=860
2025-06-02 16:03:26,662 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:03:26,662 - DEBUG - Online update step: 1/50
2025-06-02 16:03:26,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:27,040 - DEBUG - Node anomaly scores shape: torch.Size([16725, 1])
2025-06-02 16:03:27,055 - DEBUG - Edge anomaly scores shape: torch.Size([34556, 1])
2025-06-02 16:03:27,057 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:27,437 - DEBUG - Step 1: Loss=0.5851
2025-06-02 16:03:27,437 - DEBUG - Online update step: 2/50
2025-06-02 16:03:27,449 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:27,593 - DEBUG - Node anomaly scores shape: torch.Size([19266, 1])
2025-06-02 16:03:27,598 - DEBUG - Edge anomaly scores shape: torch.Size([40284, 1])
2025-06-02 16:03:27,599 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:28,045 - DEBUG - Step 2: Loss=0.5872
2025-06-02 16:03:28,047 - DEBUG - Online update step: 3/50
2025-06-02 16:03:28,063 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:28,216 - DEBUG - Node anomaly scores shape: torch.Size([17240, 1])
2025-06-02 16:03:28,226 - DEBUG - Edge anomaly scores shape: torch.Size([35646, 1])
2025-06-02 16:03:28,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:28,675 - DEBUG - Step 3: Loss=0.5838
2025-06-02 16:03:28,676 - DEBUG - Online update step: 4/50
2025-06-02 16:03:28,686 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:28,822 - DEBUG - Node anomaly scores shape: torch.Size([18459, 1])
2025-06-02 16:03:28,828 - DEBUG - Edge anomaly scores shape: torch.Size([38506, 1])
2025-06-02 16:03:28,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:29,211 - DEBUG - Step 4: Loss=0.5885
2025-06-02 16:03:29,211 - DEBUG - Online update step: 5/50
2025-06-02 16:03:29,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:29,365 - DEBUG - Node anomaly scores shape: torch.Size([17873, 1])
2025-06-02 16:03:29,370 - DEBUG - Edge anomaly scores shape: torch.Size([37164, 1])
2025-06-02 16:03:29,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:29,708 - DEBUG - Step 5: Loss=0.5837
2025-06-02 16:03:29,708 - DEBUG - Online update step: 6/50
2025-06-02 16:03:29,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:29,819 - DEBUG - Node anomaly scores shape: torch.Size([16834, 1])
2025-06-02 16:03:29,824 - DEBUG - Edge anomaly scores shape: torch.Size([34788, 1])
2025-06-02 16:03:29,825 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:30,092 - DEBUG - Step 6: Loss=0.5877
2025-06-02 16:03:30,092 - DEBUG - Online update step: 7/50
2025-06-02 16:03:30,095 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:30,227 - DEBUG - Node anomaly scores shape: torch.Size([18604, 1])
2025-06-02 16:03:30,236 - DEBUG - Edge anomaly scores shape: torch.Size([38940, 1])
2025-06-02 16:03:30,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:30,527 - DEBUG - Step 7: Loss=0.5838
2025-06-02 16:03:30,528 - DEBUG - Online update step: 8/50
2025-06-02 16:03:30,552 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:30,709 - DEBUG - Node anomaly scores shape: torch.Size([18280, 1])
2025-06-02 16:03:30,721 - DEBUG - Edge anomaly scores shape: torch.Size([38117, 1])
2025-06-02 16:03:30,723 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:31,104 - DEBUG - Step 8: Loss=0.5887
2025-06-02 16:03:31,104 - DEBUG - Online update step: 9/50
2025-06-02 16:03:31,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:31,248 - DEBUG - Node anomaly scores shape: torch.Size([16923, 1])
2025-06-02 16:03:31,254 - DEBUG - Edge anomaly scores shape: torch.Size([34986, 1])
2025-06-02 16:03:31,256 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:31,614 - DEBUG - Step 9: Loss=0.5842
2025-06-02 16:03:31,615 - DEBUG - Online update step: 10/50
2025-06-02 16:03:31,619 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:31,767 - DEBUG - Node anomaly scores shape: torch.Size([17154, 1])
2025-06-02 16:03:31,773 - DEBUG - Edge anomaly scores shape: torch.Size([35640, 1])
2025-06-02 16:03:31,775 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:32,073 - DEBUG - Step 10: Loss=0.5877
2025-06-02 16:03:32,074 - DEBUG - Online update step: 11/50
2025-06-02 16:03:32,081 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:32,215 - DEBUG - Node anomaly scores shape: torch.Size([17860, 1])
2025-06-02 16:03:32,221 - DEBUG - Edge anomaly scores shape: torch.Size([37120, 1])
2025-06-02 16:03:32,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:32,477 - DEBUG - Step 11: Loss=0.5831
2025-06-02 16:03:32,478 - DEBUG - Online update step: 12/50
2025-06-02 16:03:32,482 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:32,664 - DEBUG - Node anomaly scores shape: torch.Size([17889, 1])
2025-06-02 16:03:32,676 - DEBUG - Edge anomaly scores shape: torch.Size([37353, 1])
2025-06-02 16:03:32,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:33,128 - DEBUG - Step 12: Loss=0.5881
2025-06-02 16:03:33,128 - DEBUG - Online update step: 13/50
2025-06-02 16:03:33,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:33,250 - DEBUG - Node anomaly scores shape: torch.Size([18667, 1])
2025-06-02 16:03:33,254 - DEBUG - Edge anomaly scores shape: torch.Size([38927, 1])
2025-06-02 16:03:33,255 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:33,494 - DEBUG - Step 13: Loss=0.5832
2025-06-02 16:03:33,495 - DEBUG - Online update step: 14/50
2025-06-02 16:03:33,498 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:33,602 - DEBUG - Node anomaly scores shape: torch.Size([17327, 1])
2025-06-02 16:03:33,607 - DEBUG - Edge anomaly scores shape: torch.Size([36111, 1])
2025-06-02 16:03:33,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:33,793 - DEBUG - Step 14: Loss=0.5872
2025-06-02 16:03:33,794 - DEBUG - Online update step: 15/50
2025-06-02 16:03:33,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:33,879 - DEBUG - Node anomaly scores shape: torch.Size([17284, 1])
2025-06-02 16:03:33,883 - DEBUG - Edge anomaly scores shape: torch.Size([35915, 1])
2025-06-02 16:03:33,884 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:34,116 - DEBUG - Step 15: Loss=0.5836
2025-06-02 16:03:34,116 - DEBUG - Online update step: 16/50
2025-06-02 16:03:34,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:34,244 - DEBUG - Node anomaly scores shape: torch.Size([18357, 1])
2025-06-02 16:03:34,250 - DEBUG - Edge anomaly scores shape: torch.Size([38350, 1])
2025-06-02 16:03:34,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:34,555 - DEBUG - Step 16: Loss=0.5870
2025-06-02 16:03:34,555 - DEBUG - Online update step: 17/50
2025-06-02 16:03:34,558 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:34,674 - DEBUG - Node anomaly scores shape: torch.Size([17255, 1])
2025-06-02 16:03:34,678 - DEBUG - Edge anomaly scores shape: torch.Size([35899, 1])
2025-06-02 16:03:34,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:34,933 - DEBUG - Step 17: Loss=0.5828
2025-06-02 16:03:34,933 - DEBUG - Online update step: 18/50
2025-06-02 16:03:34,944 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:35,069 - DEBUG - Node anomaly scores shape: torch.Size([18531, 1])
2025-06-02 16:03:35,077 - DEBUG - Edge anomaly scores shape: torch.Size([38781, 1])
2025-06-02 16:03:35,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:35,356 - DEBUG - Step 18: Loss=0.5866
2025-06-02 16:03:35,356 - DEBUG - Online update step: 19/50
2025-06-02 16:03:35,359 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:35,469 - DEBUG - Node anomaly scores shape: torch.Size([17401, 1])
2025-06-02 16:03:35,473 - DEBUG - Edge anomaly scores shape: torch.Size([36153, 1])
2025-06-02 16:03:35,474 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:35,750 - DEBUG - Step 19: Loss=0.5826
2025-06-02 16:03:35,750 - DEBUG - Online update step: 20/50
2025-06-02 16:03:35,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:35,887 - DEBUG - Node anomaly scores shape: torch.Size([18375, 1])
2025-06-02 16:03:35,891 - DEBUG - Edge anomaly scores shape: torch.Size([38149, 1])
2025-06-02 16:03:35,892 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:36,166 - DEBUG - Step 20: Loss=0.5871
2025-06-02 16:03:36,167 - DEBUG - Online update step: 21/50
2025-06-02 16:03:36,173 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:36,278 - DEBUG - Node anomaly scores shape: torch.Size([17570, 1])
2025-06-02 16:03:36,282 - DEBUG - Edge anomaly scores shape: torch.Size([36466, 1])
2025-06-02 16:03:36,284 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:36,514 - DEBUG - Step 21: Loss=0.5832
2025-06-02 16:03:36,515 - DEBUG - Online update step: 22/50
2025-06-02 16:03:36,520 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:36,635 - DEBUG - Node anomaly scores shape: torch.Size([18549, 1])
2025-06-02 16:03:36,640 - DEBUG - Edge anomaly scores shape: torch.Size([38761, 1])
2025-06-02 16:03:36,642 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:36,886 - DEBUG - Step 22: Loss=0.5859
2025-06-02 16:03:36,886 - DEBUG - Online update step: 23/50
2025-06-02 16:03:36,895 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:37,015 - DEBUG - Node anomaly scores shape: torch.Size([17929, 1])
2025-06-02 16:03:37,020 - DEBUG - Edge anomaly scores shape: torch.Size([37336, 1])
2025-06-02 16:03:37,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:37,250 - DEBUG - Step 23: Loss=0.5824
2025-06-02 16:03:37,250 - DEBUG - Online update step: 24/50
2025-06-02 16:03:37,254 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:37,354 - DEBUG - Node anomaly scores shape: torch.Size([18341, 1])
2025-06-02 16:03:37,359 - DEBUG - Edge anomaly scores shape: torch.Size([38190, 1])
2025-06-02 16:03:37,360 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:37,584 - DEBUG - Step 24: Loss=0.5874
2025-06-02 16:03:37,585 - DEBUG - Online update step: 25/50
2025-06-02 16:03:37,588 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:37,689 - DEBUG - Node anomaly scores shape: torch.Size([18014, 1])
2025-06-02 16:03:37,693 - DEBUG - Edge anomaly scores shape: torch.Size([37621, 1])
2025-06-02 16:03:37,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:37,894 - DEBUG - Step 25: Loss=0.5823
2025-06-02 16:03:37,894 - DEBUG - Online update step: 26/50
2025-06-02 16:03:37,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:38,006 - DEBUG - Node anomaly scores shape: torch.Size([17874, 1])
2025-06-02 16:03:38,012 - DEBUG - Edge anomaly scores shape: torch.Size([37200, 1])
2025-06-02 16:03:38,015 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:38,282 - DEBUG - Step 26: Loss=0.5856
2025-06-02 16:03:38,283 - DEBUG - Online update step: 27/50
2025-06-02 16:03:38,287 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:38,399 - DEBUG - Node anomaly scores shape: torch.Size([17348, 1])
2025-06-02 16:03:38,405 - DEBUG - Edge anomaly scores shape: torch.Size([36049, 1])
2025-06-02 16:03:38,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:38,666 - DEBUG - Step 27: Loss=0.5825
2025-06-02 16:03:38,667 - DEBUG - Online update step: 28/50
2025-06-02 16:03:38,670 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:38,761 - DEBUG - Node anomaly scores shape: torch.Size([18787, 1])
2025-06-02 16:03:38,765 - DEBUG - Edge anomaly scores shape: torch.Size([39246, 1])
2025-06-02 16:03:38,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:39,008 - DEBUG - Step 28: Loss=0.5860
2025-06-02 16:03:39,009 - DEBUG - Online update step: 29/50
2025-06-02 16:03:39,017 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:39,142 - DEBUG - Node anomaly scores shape: torch.Size([19177, 1])
2025-06-02 16:03:39,148 - DEBUG - Edge anomaly scores shape: torch.Size([39998, 1])
2025-06-02 16:03:39,149 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:39,388 - DEBUG - Step 29: Loss=0.5819
2025-06-02 16:03:39,388 - DEBUG - Online update step: 30/50
2025-06-02 16:03:39,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:39,500 - DEBUG - Node anomaly scores shape: torch.Size([17522, 1])
2025-06-02 16:03:39,505 - DEBUG - Edge anomaly scores shape: torch.Size([36231, 1])
2025-06-02 16:03:39,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:39,765 - DEBUG - Step 30: Loss=0.5853
2025-06-02 16:03:39,765 - DEBUG - Online update step: 31/50
2025-06-02 16:03:39,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:39,887 - DEBUG - Node anomaly scores shape: torch.Size([18084, 1])
2025-06-02 16:03:39,894 - DEBUG - Edge anomaly scores shape: torch.Size([37799, 1])
2025-06-02 16:03:39,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:40,138 - DEBUG - Step 31: Loss=0.5821
2025-06-02 16:03:40,138 - DEBUG - Online update step: 32/50
2025-06-02 16:03:40,144 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:40,235 - DEBUG - Node anomaly scores shape: torch.Size([17230, 1])
2025-06-02 16:03:40,239 - DEBUG - Edge anomaly scores shape: torch.Size([35909, 1])
2025-06-02 16:03:40,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:40,455 - DEBUG - Step 32: Loss=0.5869
2025-06-02 16:03:40,456 - DEBUG - Online update step: 33/50
2025-06-02 16:03:40,459 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:40,565 - DEBUG - Node anomaly scores shape: torch.Size([19772, 1])
2025-06-02 16:03:40,570 - DEBUG - Edge anomaly scores shape: torch.Size([41265, 1])
2025-06-02 16:03:40,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:40,848 - DEBUG - Step 33: Loss=0.5812
2025-06-02 16:03:40,849 - DEBUG - Online update step: 34/50
2025-06-02 16:03:40,853 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:41,057 - DEBUG - Node anomaly scores shape: torch.Size([16709, 1])
2025-06-02 16:03:41,067 - DEBUG - Edge anomaly scores shape: torch.Size([34627, 1])
2025-06-02 16:03:41,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:41,338 - DEBUG - Step 34: Loss=0.5858
2025-06-02 16:03:41,338 - DEBUG - Online update step: 35/50
2025-06-02 16:03:41,342 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:41,584 - DEBUG - Node anomaly scores shape: torch.Size([19868, 1])
2025-06-02 16:03:41,606 - DEBUG - Edge anomaly scores shape: torch.Size([41589, 1])
2025-06-02 16:03:41,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:41,854 - DEBUG - Step 35: Loss=0.5813
2025-06-02 16:03:41,854 - DEBUG - Online update step: 36/50
2025-06-02 16:03:41,857 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:42,010 - DEBUG - Node anomaly scores shape: torch.Size([18372, 1])
2025-06-02 16:03:42,022 - DEBUG - Edge anomaly scores shape: torch.Size([38141, 1])
2025-06-02 16:03:42,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:42,351 - DEBUG - Step 36: Loss=0.5858
2025-06-02 16:03:42,351 - DEBUG - Online update step: 37/50
2025-06-02 16:03:42,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:42,468 - DEBUG - Node anomaly scores shape: torch.Size([18967, 1])
2025-06-02 16:03:42,474 - DEBUG - Edge anomaly scores shape: torch.Size([39568, 1])
2025-06-02 16:03:42,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:42,709 - DEBUG - Step 37: Loss=0.5815
2025-06-02 16:03:42,709 - DEBUG - Online update step: 38/50
2025-06-02 16:03:42,713 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:42,841 - DEBUG - Node anomaly scores shape: torch.Size([19577, 1])
2025-06-02 16:03:42,847 - DEBUG - Edge anomaly scores shape: torch.Size([40919, 1])
2025-06-02 16:03:42,849 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:43,331 - DEBUG - Step 38: Loss=0.5839
2025-06-02 16:03:43,333 - DEBUG - Online update step: 39/50
2025-06-02 16:03:43,340 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:44,480 - DEBUG - Node anomaly scores shape: torch.Size([18832, 1])
2025-06-02 16:03:44,560 - DEBUG - Edge anomaly scores shape: torch.Size([39293, 1])
2025-06-02 16:03:44,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:45,052 - DEBUG - Step 39: Loss=0.5813
2025-06-02 16:03:45,052 - DEBUG - Online update step: 40/50
2025-06-02 16:03:45,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:45,218 - DEBUG - Node anomaly scores shape: torch.Size([19551, 1])
2025-06-02 16:03:45,226 - DEBUG - Edge anomaly scores shape: torch.Size([41003, 1])
2025-06-02 16:03:45,227 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:45,528 - DEBUG - Step 40: Loss=0.5858
2025-06-02 16:03:45,528 - DEBUG - Online update step: 41/50
2025-06-02 16:03:45,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:45,641 - DEBUG - Node anomaly scores shape: torch.Size([18006, 1])
2025-06-02 16:03:45,645 - DEBUG - Edge anomaly scores shape: torch.Size([37559, 1])
2025-06-02 16:03:45,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:45,987 - DEBUG - Step 41: Loss=0.5817
2025-06-02 16:03:45,987 - DEBUG - Online update step: 42/50
2025-06-02 16:03:45,990 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:46,118 - DEBUG - Node anomaly scores shape: torch.Size([18410, 1])
2025-06-02 16:03:46,125 - DEBUG - Edge anomaly scores shape: torch.Size([38273, 1])
2025-06-02 16:03:46,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:46,352 - DEBUG - Step 42: Loss=0.5848
2025-06-02 16:03:46,353 - DEBUG - Online update step: 43/50
2025-06-02 16:03:46,356 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:46,452 - DEBUG - Node anomaly scores shape: torch.Size([16907, 1])
2025-06-02 16:03:46,456 - DEBUG - Edge anomaly scores shape: torch.Size([35029, 1])
2025-06-02 16:03:46,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:46,671 - DEBUG - Step 43: Loss=0.5819
2025-06-02 16:03:46,671 - DEBUG - Online update step: 44/50
2025-06-02 16:03:46,674 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:46,780 - DEBUG - Node anomaly scores shape: torch.Size([17683, 1])
2025-06-02 16:03:46,784 - DEBUG - Edge anomaly scores shape: torch.Size([36638, 1])
2025-06-02 16:03:46,785 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:46,999 - DEBUG - Step 44: Loss=0.5854
2025-06-02 16:03:47,000 - DEBUG - Online update step: 45/50
2025-06-02 16:03:47,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:47,097 - DEBUG - Node anomaly scores shape: torch.Size([17656, 1])
2025-06-02 16:03:47,103 - DEBUG - Edge anomaly scores shape: torch.Size([36634, 1])
2025-06-02 16:03:47,104 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:47,322 - DEBUG - Step 45: Loss=0.5809
2025-06-02 16:03:47,322 - DEBUG - Online update step: 46/50
2025-06-02 16:03:47,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:47,428 - DEBUG - Node anomaly scores shape: torch.Size([18705, 1])
2025-06-02 16:03:47,435 - DEBUG - Edge anomaly scores shape: torch.Size([38999, 1])
2025-06-02 16:03:47,436 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:47,717 - DEBUG - Step 46: Loss=0.5845
2025-06-02 16:03:47,718 - DEBUG - Online update step: 47/50
2025-06-02 16:03:47,725 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:47,839 - DEBUG - Node anomaly scores shape: torch.Size([16452, 1])
2025-06-02 16:03:47,844 - DEBUG - Edge anomaly scores shape: torch.Size([33880, 1])
2025-06-02 16:03:47,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:48,104 - DEBUG - Step 47: Loss=0.5814
2025-06-02 16:03:48,105 - DEBUG - Online update step: 48/50
2025-06-02 16:03:48,112 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:48,252 - DEBUG - Node anomaly scores shape: torch.Size([18999, 1])
2025-06-02 16:03:48,260 - DEBUG - Edge anomaly scores shape: torch.Size([39540, 1])
2025-06-02 16:03:48,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:48,542 - DEBUG - Step 48: Loss=0.5850
2025-06-02 16:03:48,543 - DEBUG - Online update step: 49/50
2025-06-02 16:03:48,546 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:48,655 - DEBUG - Node anomaly scores shape: torch.Size([18766, 1])
2025-06-02 16:03:48,659 - DEBUG - Edge anomaly scores shape: torch.Size([39223, 1])
2025-06-02 16:03:48,660 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:49,059 - DEBUG - Step 49: Loss=0.5804
2025-06-02 16:03:49,059 - DEBUG - Online update step: 50/50
2025-06-02 16:03:49,063 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:49,264 - DEBUG - Node anomaly scores shape: torch.Size([17528, 1])
2025-06-02 16:03:49,274 - DEBUG - Edge anomaly scores shape: torch.Size([36323, 1])
2025-06-02 16:03:49,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:49,520 - DEBUG - Step 50: Loss=0.5847
2025-06-02 16:03:49,521 - INFO - Online update finished. Average loss: 0.5844, Learning rate: 0.001000
2025-06-02 16:03:49,522 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], current edge mean: [ 9.1432734e+00  1.4123361e+00  5.6940260e+00 -2.7790412e-09
 -3.7053882e-09 -1.8526941e-09  0.0000000e+00  2.3158677e-09
 -1.9684876e-09  9.2634705e-10]
2025-06-02 16:03:49,522 - DEBUG - Node drift difference: 0.0061, Edge drift difference: 0.0036
2025-06-02 16:03:49,523 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  3.4130977e-08  7.4739365e-10
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -3.9860995e-09
 -5.9791492e-09  4.6089275e-09 -9.9652486e-10  1.4449611e-08
  2.2967608e+00  2.9623826e+00  1.3688610e-01  4.4158831e+00
 -1.6193530e-09  3.3009405e+00  5.8819227e+00  7.6133752e+00
  1.3688610e-01  7.9926853e+00 -1.1709168e-08 -2.1923547e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -4.9826244e-08], edge=[ 9.1432734e+00  1.4123361e+00  5.6940260e+00 -2.7790412e-09
 -3.7053882e-09 -1.8526941e-09  0.0000000e+00  2.3158677e-09
 -1.9684876e-09  9.2634705e-10]
2025-06-02 16:03:49,524 - DEBUG - Updated reference std: node=[0.         0.         1.0005229  1.0005229  0.         0.
 0.         1.0005229  1.0005229  1.0005229  1.0005229  1.0005229
 0.97763693 0.27184048 0.36169627 0.5735438  1.0005229  2.9591587
 2.8782218  1.4838562  0.36169627 0.22627786 1.0005229  1.0005229
 0.         0.         0.         0.         1.0005229  1.0005229 ], edge=[1.1124209 0.505041  2.159036  1.000243  1.000243  1.000243  1.000243
 1.000243  1.000243  1.000243 ]
2025-06-02 16:03:49,524 - INFO - Online update complete. Loss: 0.5844
2025-06-02 16:03:49,524 - INFO - Running anomaly detection...
2025-06-02 16:03:49,524 - INFO - Starting anomaly detection.
2025-06-02 16:03:49,543 - DEBUG - Node reconstruction errors: [0.07342602 0.7720515  0.08992839 0.00706072 0.02938812 0.01968865
 0.14984009 0.01858626 0.01858626 0.01839224 0.01858625 0.00867994
 0.48624727 0.1438741  0.00244743 0.01789575 0.01507801 0.01789604
 0.00814461 0.01754688 0.01987432 0.00244743 0.03941307 0.0042481
 0.00227684 0.00445146 0.00227691 0.04190809 0.01848387 0.00227693
 0.13419376 0.08605377 0.037713   0.00670326 0.01884387 0.03816095
 0.06003462 0.01754685 0.06077402 0.07924819 0.00738512 0.00207958
 0.01754685 0.01181285 0.01003588 0.01191858 0.01524986 0.2034251
 0.01859402 0.09931059 0.07312662 0.00392958 0.00398798 0.01147741
 0.01842436 0.04019679 0.08619035 0.01745019 0.00705252 0.02289875
 0.14830896 0.01723409 0.00177218 0.00481943 0.02316764 0.01842436
 0.00409956 0.01842423 0.00177218 0.01426574 0.02088867 0.01210376
 0.0038649  0.02209937 0.02486467 0.01261033 0.01983499 0.05421275
 0.01409374 0.01761577 0.0057029  0.02840157 0.27928773 0.00785377
 0.02059949 0.00825224 0.04307284 0.01815598 0.01651391 0.09996931
 0.00198701 0.03451035 0.00264066 0.01646098 0.00741574 0.05386447
 0.00511867 0.01459605 0.0014045  0.02332556 0.00731566 0.00511866
 0.00918419 0.12524971 0.00415812 0.01988622 0.00389175 0.02887012
 0.00254726 0.12238395 0.09062544 0.00616622 0.03373586 0.04602703
 0.00738903 0.00766884 0.00660705 0.02464124 0.01503576 0.00524086
 0.00186542 0.00275528 0.03971347 0.00322135 0.01611726 0.00523707
 0.00384646 0.01232067 0.01858094 0.00394132 0.00376523 0.00440631
 0.1309937  0.13325281 0.00616441 0.01831858 0.00773363 0.00142148
 0.11265016 0.03254073 0.00764188 0.03887786 0.00203534 0.00624933
 0.00764192 0.01366382 0.00660295 0.09107104 0.00654688 0.02166017
 0.25999877 0.00530901 0.02474899 0.00440631 0.03094537 0.02575771
 0.00320101 0.03420266 0.00731535 0.00900279 0.0076418  0.00599531
 0.003201   0.00376523 0.00602226 0.0284277  0.01186749 0.01496261
 0.0062815  0.0214667  0.01756043 0.00542344 0.00190564 0.03708482
 0.01504143 0.0076757  0.01614323 0.04069952 0.00589367 0.00589363
 0.02028951 0.0042206  0.00590135 0.05221245 0.04295574 0.01411586
 0.00198939 0.02357014 0.01864459 0.0030144  0.0309872  0.01570605
 0.00891138 0.00330048 0.11264483 0.00369166 0.29942128 0.0077038
 0.03353063 0.00698771 0.00384636 0.00320101 0.02965868 0.01971623
 0.01522752 0.00592039 0.02045755 0.10814073 0.00151594 0.02400276
 0.00522015 0.0228636  0.00295052 0.02828658 0.01311858 0.00194309
 0.01675972 0.0066077  0.09021207 0.00330047 0.04777915 0.00198939
 0.00176945 0.00295052 0.003201   0.02259307 0.02248076 0.00362447
 0.01658951 0.00395909 0.0022041  0.02614253 0.01857369 0.00660517
 0.00660733 0.00438752 0.01894948 0.00176945 0.00320103 0.0122291
 0.0238033  0.01995193 0.00468158 0.01840539 0.00345724 0.01994431
 0.02120761 0.03302001 0.00468159 0.00430037 0.00190564 0.00170934
 0.09020812 0.01544812 0.01880176 0.03349719 0.00301433 0.00174065
 0.00585492 0.00589374 0.02192122 0.00690489 0.01479863 0.00744697
 0.01638518 0.00699437 0.01026051 0.09597569 0.01026083 0.0164721
 0.08477657 0.04396827 0.02006016 0.0143389  0.01055288 0.06442667
 0.00135347 0.05854137 0.0202895  0.01339728 0.09174355 0.00131867
 0.01536891 0.00647022 0.02127859 0.00455955 0.09085353 0.00928821
 0.0042206  0.00721592 0.00731576 0.00547154 0.03590868 0.00345724
 0.12750134 0.0025606  0.01630671 0.00593785 0.00369169 0.0083187
 0.01408636 0.00739799 0.0102072  0.00915838 0.00130928 0.00130928
 0.00130929 0.01065995 0.00582656 0.00739796 0.00130929 0.02843035
 0.00130929 0.00284672 0.00672424 0.01765621 0.09986449 0.0030854
 0.0028496  0.00407544 0.02898613 0.00585165 0.01183318 0.0102072
 0.02759293 0.04776715 0.12384259 0.02440115 0.02362925 0.02362265
 0.09422348 0.00353316 0.00130933 0.01055242 0.00130929 0.01065978
 0.00573344 0.00152633 0.00871497 0.00136441 0.00739915 0.0035541
 0.00136442 0.02360826 0.01626045 0.0167616  0.01020685 0.00482451
 0.01235725 0.01555351 0.00130929 0.01486484 0.03171434 0.03864993
 0.00341306 0.00301434 0.00879703 0.00130928 0.00135487 0.03175538
 0.01314117 0.00259839 0.10581195 0.02021297 0.01019834 0.02183511
 0.00166503 0.0344451  0.00517741 0.0049614  0.01836639 0.01686363
 0.01372355 0.02631746 0.01677025 0.03864507 0.00168492 0.00327544
 0.0342572  0.00130929 0.01020759 0.00671599 0.00389663 0.01480416
 0.00696709 0.01294888 0.02014766 0.00443669 0.0269374  0.00130929
 0.09030306 0.01436302 0.00458621 0.04060014 0.02471661 0.02474025
 0.02476473 0.00912961 0.00131382 0.00884009 0.00267641 0.03894779
 0.03128428 0.00131382 0.00714835 0.00457931 0.0150105  0.00300842
 0.00458648 0.02930081 0.02475114 0.00458643 0.00131381 0.02473253
 0.02474613 0.00382975 0.00361417 0.02476742 0.00168464 0.00358926
 0.00388505 0.00266746 0.00450027 0.00363156 0.03743387 0.00426837
 0.00296542 0.00618487 0.01102558 0.00201775 0.01010565 0.02119544
 0.02409489 0.02833014 0.06768133 0.02473931 0.00267641 0.01552537
 0.03907382 0.00587888 0.00293802 0.00324773 0.09185077 0.00176904
 0.00384835 0.02710694 0.04244418 0.00334137 0.0036235  0.00356932
 0.02258983 0.00165002 0.00366152 0.00541752 0.00165002 0.01981249
 0.00363167 0.00433701 0.0053954  0.01513147 0.00468441 0.00381093
 0.00355135 0.00379295 0.00355083 0.0038109  0.00134746 0.01022111
 0.00909379 0.00377604 0.00134746 0.00464442 0.0127275  0.08150851
 0.01189032 0.00415532 0.01021142 0.00468449 0.00169104 0.0042198
 0.00488965 0.10039807 0.00315728 0.00334129 0.03727539 0.00179209
 0.00165002 0.01035095 0.01580282 0.08157157 0.01444059 0.00169103
 0.01504267 0.00178849 0.01968834 0.00373987 0.00438105 0.04780295
 0.00136536 0.00421981 0.09303407 0.0017885  0.09386541 0.00120975
 0.00131949 0.00282168 0.00148654 0.1123255  0.00340228 0.00165002
 0.00200044 0.00264116 0.00264116 0.00187517 0.01726609 0.00257809
 0.0014867  0.01021883 0.00764219 0.0205314  0.02907654 0.00324757
 0.00148655 0.00763893 0.00131949 0.0043904  0.0033231  0.005902
 0.02894291 0.01422772 0.00257809 0.01326506 0.00136537 0.00421982
 0.00437649 0.0042495  0.02120353 0.01520772 0.00136536 0.02732622
 0.00136536 0.0183224  0.00560232 0.01021313 0.00242849 0.02783826
 0.00894119 0.00146143 0.2380291  0.00146143 0.00146143 0.00146143
 0.00146144 0.00146143 0.00146143 0.00146143 0.0104684  0.00236573
 0.01611347 0.00146143 0.00146144 0.00146143 0.00146144 0.00146143
 0.00146144 0.00146144 0.00146143 0.00146144 0.01032664 0.00146145
 0.00146144 0.03707941 0.00146144 0.00205609 0.01957526 0.00136536
 0.0176574  0.02867374 0.01532946 0.01532946 0.01509325 0.0176574
 0.00136537 0.00148656 0.00148656 0.00136536 0.00148655 0.00470637
 0.00345127 0.00146154 0.00324755 0.00136536 0.00264117 0.00136536
 0.00136536 0.00518375 0.00136536 0.00148656 0.00136536 0.00136537
 0.01021509 0.00148655 0.00136537 0.00148655 0.00136537 0.00136536
 0.00136536 0.00877131 0.01370526 0.00435501 0.00146144 0.02138472
 0.01766741 0.00136536 0.00148655 0.00789369 0.00146145 0.00412039
 0.0158217  0.00161092 0.00136536 0.00136536 0.01269301 0.0090636
 0.00601641 0.00136535 0.01046843 0.00193962 0.00148654 0.00633106
 0.00146144 0.0056035  0.01141167 0.00146144 0.00146147 0.01046838
 0.00193958 0.00136536 0.1245904  0.01212647 0.00887972 0.00906975
 0.00213669 0.02174149 0.02174188 0.01948377 0.00187734 0.00146144
 0.00265462 0.02528973 0.00906733 0.00397302 0.00210142 0.00222839
 0.00147984 0.00147984 0.00147984 0.00147985 0.00147984 0.01034766
 0.0220343  0.00147984 0.00147986 0.00146144 0.00188016 0.00146143
 0.02174236 0.0185307  0.03799581 0.00432371 0.02707221 0.02234176
 0.01032672 0.00346449 0.01032708 0.00146144 0.02174366 0.00132808
 0.00151164 0.00151163 0.00147984 0.00132806 0.0129433  0.00440947
 0.00270316 0.00146143 0.00147984 0.00257835 0.00151164 0.00168723
 0.00162525 0.00231375 0.01034774 0.08702514 0.0012951  0.05243015
 0.00435901 0.00162523 0.00207791 0.00129509 0.00149067 0.00143603
 0.02004538 0.0025539  0.02069096 0.00162525 0.00162524 0.00162525
 0.00149438 0.00257833 0.00162525 0.00149067 0.00162525 0.00162525
 0.00162525 0.00433903 0.00124507 0.01603126 0.01283637 0.02392219
 0.02572593 0.00279794 0.01115033 0.01535767 0.00137506 0.00121353
 0.0013269  0.02384192 0.0238419  0.00149067 0.02463271 0.08968113
 0.00137504 0.00144126 0.0025437  0.02658269 0.00119986 0.00119986
 0.00119986 0.00145576 0.00116184 0.00489089 0.02382887 0.09783269
 0.00381071 0.00123356 0.00279665 0.00144125 0.00267503 0.00612331
 0.00125042 0.00269171 0.00137504 0.0898693  0.00144125 0.00616392
 0.00123355 0.01011194 0.00119986 0.00145578 0.00125042 0.0036645
 0.02441544 0.00145576 0.00145576 0.00145575 0.01554805 0.15587977
 0.8427884  0.00119986 0.06090689 0.00145577 0.02360568 0.00188019
 0.03306495 0.00392265 0.00145576 0.00148688 0.0022332  0.001282
 0.30643848 0.00392445 0.031592   0.00329754 0.01144517 0.00392253
 0.01948303 0.02501255 0.00475625 0.01110571 0.01266581 0.00122584
 0.00122584 0.05916945 0.1355044  0.01307734 0.00392253 0.00475625
 0.00392255 0.00104543 0.00119565 0.00119565 0.00110544 0.01702851
 0.00120756 0.00119565 0.00104542 0.00587212 0.00119565 0.00119565
 0.00154227 0.00243425 0.01273117 0.02038403 0.00119565 0.00856525
 0.00587212 0.00119565 0.00119289 0.00239201 0.00109102 0.00109102
 0.01754191 0.00239201 0.00119565 0.002392   0.00225086 0.02244285
 0.02269723 0.00119565 0.13147786 0.00227891 0.0022789  0.00243425
 0.00162622 0.00313132 0.00119289 0.00327895 0.00106456 0.02627547
 0.00424194 0.02627549 0.1080104  0.00104609 0.00424193 0.00177295
 0.00177295 0.02563517 0.00177295 0.00406853 0.0016261  0.02572652
 0.00302316 0.0010461  0.00302307 0.00899892 0.02325752 0.01861933
 0.00177295 0.00333128 0.0025381  0.00177295 0.01932359 0.05450866
 0.00333127 0.0010461  0.00177295 0.12472116 0.00177295 0.00177295
 0.00177294 0.00126337 0.0193565  0.00126337 0.00215141 0.00126336
 0.01541207 0.02690758 0.03324234 0.00177296 0.00177295 0.00177597
 0.00177295 0.13819203 0.00215096 0.00126337 0.00177598 0.00177295
 0.00177295 0.00631083 0.00177597 0.00177296 0.00168067 0.00424249
 0.00107888 0.03075764 0.00168067 0.00177294 0.00177295 0.00439328
 0.02139931 0.0230859  0.02309261 0.00193162 0.02126576 0.00236862
 0.00330462 0.1654911  0.02309112 0.00131505 0.02309252 0.00309212
 0.00330458 0.02309027 0.00211545 0.00107888 0.00442668 0.00203481
 0.00131231 0.00207811 0.00246342 0.00149977 0.00245928 0.0024593
 0.02487382 0.03703332 0.00245934 0.00245928 0.03449528 0.04418346
 0.00245928 0.00245928 0.00245928 0.00245928 0.00245928 0.00245928
 0.00245928 0.00245929 0.00254017 0.00504861 0.00245928 0.00245928
 0.00245928 0.00245928 0.19395041 0.00476662 0.00169534 0.00504857
 0.00141442 0.00299148 0.00299148 0.00245928 0.00299147 0.00299147
 0.00610536 0.03972743 0.03972696]
2025-06-02 16:03:49,544 - DEBUG - Edge reconstruction errors: [1.3641516 1.3615401 0.9578102 ... 0.1577934 1.2587407 0.1577934]
2025-06-02 16:03:49,546 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160349_update_44.json
2025-06-02 16:03:49,546 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:03:49,555 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160349_update_44.pth and as latest_checkpoint.pth
2025-06-02 16:03:49,555 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870415.dot): 0.1111
2025-06-02 16:03:49,555 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:03:49,555 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.7721, MLP Score: 0.5144
2025-06-02 16:03:49,555 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1498, MLP Score: 0.4972
2025-06-02 16:03:49,555 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4862, MLP Score: 0.4991
2025-06-02 16:03:49,555 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.2034, MLP Score: 0.4721
2025-06-02 16:03:49,555 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.1483, MLP Score: 0.4744
2025-06-02 16:03:49,555 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:03:49,556 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.9629, MLP Score: 0.4904
2025-06-02 16:03:49,556 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.5078, MLP Score: 0.4692
2025-06-02 16:03:49,556 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4705, MLP Score: 0.4785
2025-06-02 16:03:49,556 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 5.8718, MLP Score: 0.3471
2025-06-02 16:03:49,556 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8200, MLP Score: 0.4721
2025-06-02 16:03:49,556 - INFO - 
--- Processing file: nw_graph_encoded_1748870445.dot (Timestamp: 2025-06-02 15:20:45) ---
2025-06-02 16:03:49,556 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 16:03:49,556 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 16:03:49,586 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 16:03:49,617 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 16:03:49,617 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 16:03:49,617 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870445.dot
2025-06-02 16:03:49,642 - INFO - Parsed 962 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 16:03:49,674 - INFO - Parsed 2098 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870445.dot'.
2025-06-02 16:03:49,674 - INFO - Processing node updates/additions.
2025-06-02 16:03:49,682 - INFO - Processing edge updates/additions.
2025-06-02 16:03:49,701 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:03:49,703 - INFO - Finished updating NetworkX graph.
2025-06-02 16:03:49,703 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:03:49,706 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:03:49,723 - DEBUG - Initial node features tensor shape: torch.Size([962, 30])
2025-06-02 16:03:49,726 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:03:49,730 - DEBUG - Node features tensor shape after scaling: torch.Size([962, 30])
2025-06-02 16:03:49,735 - DEBUG - Edge index tensor shape: torch.Size([2, 2098])
2025-06-02 16:03:49,738 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:03:49,750 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:03:49,754 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:03:49,757 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:03:49,761 - DEBUG - Shape of encoded categorical edge features: torch.Size([2098, 3])
2025-06-02 16:03:49,764 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:03:49,764 - DEBUG - Shape of scaled numerical edge features: torch.Size([2098, 7])
2025-06-02 16:03:49,765 - DEBUG - Final edge attributes tensor shape: torch.Size([2098, 10])
2025-06-02 16:03:49,765 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:03:49,775 - INFO - Performing online update...
2025-06-02 16:03:49,776 - INFO - Starting online update for 50 steps.
2025-06-02 16:03:49,778 - DEBUG - Updated RunningStats: new_mean=0.9447302528549198, new_var=25800000000161.633, new_n=2610
2025-06-02 16:03:49,778 - DEBUG - Updated RunningStats: new_mean=0.9423829119140225, new_var=26100000000018.145, new_n=2640
2025-06-02 16:03:49,779 - DEBUG - Updated RunningStats: new_mean=1.142272530788233, new_var=8600000000094.006, new_n=870
2025-06-02 16:03:49,779 - DEBUG - Updated RunningStats: new_mean=1.1415350700314566, new_var=8700000000001.568, new_n=880
2025-06-02 16:03:49,779 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:03:49,779 - DEBUG - Online update step: 1/50
2025-06-02 16:03:49,786 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:50,093 - DEBUG - Node anomaly scores shape: torch.Size([17487, 1])
2025-06-02 16:03:50,101 - DEBUG - Edge anomaly scores shape: torch.Size([36352, 1])
2025-06-02 16:03:50,102 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:50,345 - DEBUG - Step 1: Loss=0.5813
2025-06-02 16:03:50,345 - DEBUG - Online update step: 2/50
2025-06-02 16:03:50,348 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:50,473 - DEBUG - Node anomaly scores shape: torch.Size([18914, 1])
2025-06-02 16:03:50,479 - DEBUG - Edge anomaly scores shape: torch.Size([39413, 1])
2025-06-02 16:03:50,481 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:50,727 - DEBUG - Step 2: Loss=0.5843
2025-06-02 16:03:50,727 - DEBUG - Online update step: 3/50
2025-06-02 16:03:50,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:50,910 - DEBUG - Node anomaly scores shape: torch.Size([17650, 1])
2025-06-02 16:03:50,918 - DEBUG - Edge anomaly scores shape: torch.Size([36801, 1])
2025-06-02 16:03:50,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:51,241 - DEBUG - Step 3: Loss=0.5804
2025-06-02 16:03:51,242 - DEBUG - Online update step: 4/50
2025-06-02 16:03:51,247 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:51,450 - DEBUG - Node anomaly scores shape: torch.Size([19846, 1])
2025-06-02 16:03:51,467 - DEBUG - Edge anomaly scores shape: torch.Size([41724, 1])
2025-06-02 16:03:51,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:51,815 - DEBUG - Step 4: Loss=0.5839
2025-06-02 16:03:51,815 - DEBUG - Online update step: 5/50
2025-06-02 16:03:51,818 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:51,962 - DEBUG - Node anomaly scores shape: torch.Size([18594, 1])
2025-06-02 16:03:51,970 - DEBUG - Edge anomaly scores shape: torch.Size([38933, 1])
2025-06-02 16:03:51,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:52,288 - DEBUG - Step 5: Loss=0.5809
2025-06-02 16:03:52,288 - DEBUG - Online update step: 6/50
2025-06-02 16:03:52,293 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:52,389 - DEBUG - Node anomaly scores shape: torch.Size([17912, 1])
2025-06-02 16:03:52,393 - DEBUG - Edge anomaly scores shape: torch.Size([37138, 1])
2025-06-02 16:03:52,395 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:52,608 - DEBUG - Step 6: Loss=0.5857
2025-06-02 16:03:52,609 - DEBUG - Online update step: 7/50
2025-06-02 16:03:52,615 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:52,719 - DEBUG - Node anomaly scores shape: torch.Size([18334, 1])
2025-06-02 16:03:52,727 - DEBUG - Edge anomaly scores shape: torch.Size([38344, 1])
2025-06-02 16:03:52,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:52,975 - DEBUG - Step 7: Loss=0.5814
2025-06-02 16:03:52,975 - DEBUG - Online update step: 8/50
2025-06-02 16:03:52,978 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:53,070 - DEBUG - Node anomaly scores shape: torch.Size([19031, 1])
2025-06-02 16:03:53,074 - DEBUG - Edge anomaly scores shape: torch.Size([39737, 1])
2025-06-02 16:03:53,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:53,376 - DEBUG - Step 8: Loss=0.5830
2025-06-02 16:03:53,376 - DEBUG - Online update step: 9/50
2025-06-02 16:03:53,379 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:53,530 - DEBUG - Node anomaly scores shape: torch.Size([20135, 1])
2025-06-02 16:03:53,536 - DEBUG - Edge anomaly scores shape: torch.Size([42166, 1])
2025-06-02 16:03:53,537 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:53,761 - DEBUG - Step 9: Loss=0.5795
2025-06-02 16:03:53,762 - DEBUG - Online update step: 10/50
2025-06-02 16:03:53,767 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:53,881 - DEBUG - Node anomaly scores shape: torch.Size([18231, 1])
2025-06-02 16:03:53,887 - DEBUG - Edge anomaly scores shape: torch.Size([37820, 1])
2025-06-02 16:03:53,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:54,137 - DEBUG - Step 10: Loss=0.5840
2025-06-02 16:03:54,138 - DEBUG - Online update step: 11/50
2025-06-02 16:03:54,141 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:54,246 - DEBUG - Node anomaly scores shape: torch.Size([17271, 1])
2025-06-02 16:03:54,252 - DEBUG - Edge anomaly scores shape: torch.Size([36006, 1])
2025-06-02 16:03:54,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:54,474 - DEBUG - Step 11: Loss=0.5802
2025-06-02 16:03:54,474 - DEBUG - Online update step: 12/50
2025-06-02 16:03:54,478 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:54,574 - DEBUG - Node anomaly scores shape: torch.Size([18235, 1])
2025-06-02 16:03:54,578 - DEBUG - Edge anomaly scores shape: torch.Size([38120, 1])
2025-06-02 16:03:54,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:54,808 - DEBUG - Step 12: Loss=0.5834
2025-06-02 16:03:54,809 - DEBUG - Online update step: 13/50
2025-06-02 16:03:54,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:54,935 - DEBUG - Node anomaly scores shape: torch.Size([17229, 1])
2025-06-02 16:03:54,942 - DEBUG - Edge anomaly scores shape: torch.Size([35902, 1])
2025-06-02 16:03:54,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:55,218 - DEBUG - Step 13: Loss=0.5806
2025-06-02 16:03:55,218 - DEBUG - Online update step: 14/50
2025-06-02 16:03:55,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:55,385 - DEBUG - Node anomaly scores shape: torch.Size([16879, 1])
2025-06-02 16:03:55,391 - DEBUG - Edge anomaly scores shape: torch.Size([34979, 1])
2025-06-02 16:03:55,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:55,682 - DEBUG - Step 14: Loss=0.5851
2025-06-02 16:03:55,682 - DEBUG - Online update step: 15/50
2025-06-02 16:03:55,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:55,860 - DEBUG - Node anomaly scores shape: torch.Size([18705, 1])
2025-06-02 16:03:55,867 - DEBUG - Edge anomaly scores shape: torch.Size([39124, 1])
2025-06-02 16:03:55,868 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:56,121 - DEBUG - Step 15: Loss=0.5802
2025-06-02 16:03:56,121 - DEBUG - Online update step: 16/50
2025-06-02 16:03:56,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:56,227 - DEBUG - Node anomaly scores shape: torch.Size([16394, 1])
2025-06-02 16:03:56,231 - DEBUG - Edge anomaly scores shape: torch.Size([33997, 1])
2025-06-02 16:03:56,233 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:56,417 - DEBUG - Step 16: Loss=0.5834
2025-06-02 16:03:56,417 - DEBUG - Online update step: 17/50
2025-06-02 16:03:56,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:56,529 - DEBUG - Node anomaly scores shape: torch.Size([18321, 1])
2025-06-02 16:03:56,533 - DEBUG - Edge anomaly scores shape: torch.Size([38032, 1])
2025-06-02 16:03:56,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:56,753 - DEBUG - Step 17: Loss=0.5800
2025-06-02 16:03:56,753 - DEBUG - Online update step: 18/50
2025-06-02 16:03:56,756 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:56,879 - DEBUG - Node anomaly scores shape: torch.Size([18756, 1])
2025-06-02 16:03:56,888 - DEBUG - Edge anomaly scores shape: torch.Size([39249, 1])
2025-06-02 16:03:56,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:57,330 - DEBUG - Step 18: Loss=0.5839
2025-06-02 16:03:57,331 - DEBUG - Online update step: 19/50
2025-06-02 16:03:57,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:57,519 - DEBUG - Node anomaly scores shape: torch.Size([18107, 1])
2025-06-02 16:03:57,530 - DEBUG - Edge anomaly scores shape: torch.Size([37663, 1])
2025-06-02 16:03:57,531 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:58,017 - DEBUG - Step 19: Loss=0.5790
2025-06-02 16:03:58,018 - DEBUG - Online update step: 20/50
2025-06-02 16:03:58,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:58,155 - DEBUG - Node anomaly scores shape: torch.Size([18761, 1])
2025-06-02 16:03:58,163 - DEBUG - Edge anomaly scores shape: torch.Size([39120, 1])
2025-06-02 16:03:58,164 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:58,453 - DEBUG - Step 20: Loss=0.5834
2025-06-02 16:03:58,453 - DEBUG - Online update step: 21/50
2025-06-02 16:03:58,456 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:58,599 - DEBUG - Node anomaly scores shape: torch.Size([17037, 1])
2025-06-02 16:03:58,604 - DEBUG - Edge anomaly scores shape: torch.Size([35366, 1])
2025-06-02 16:03:58,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:58,869 - DEBUG - Step 21: Loss=0.5806
2025-06-02 16:03:58,870 - DEBUG - Online update step: 22/50
2025-06-02 16:03:58,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:59,032 - DEBUG - Node anomaly scores shape: torch.Size([18487, 1])
2025-06-02 16:03:59,038 - DEBUG - Edge anomaly scores shape: torch.Size([38619, 1])
2025-06-02 16:03:59,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:59,343 - DEBUG - Step 22: Loss=0.5840
2025-06-02 16:03:59,343 - DEBUG - Online update step: 23/50
2025-06-02 16:03:59,346 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:03:59,511 - DEBUG - Node anomaly scores shape: torch.Size([20709, 1])
2025-06-02 16:03:59,518 - DEBUG - Edge anomaly scores shape: torch.Size([43521, 1])
2025-06-02 16:03:59,520 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:03:59,856 - DEBUG - Step 23: Loss=0.5794
2025-06-02 16:03:59,857 - DEBUG - Online update step: 24/50
2025-06-02 16:03:59,860 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:00,039 - DEBUG - Node anomaly scores shape: torch.Size([19067, 1])
2025-06-02 16:04:00,047 - DEBUG - Edge anomaly scores shape: torch.Size([39690, 1])
2025-06-02 16:04:00,049 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:00,345 - DEBUG - Step 24: Loss=0.5827
2025-06-02 16:04:00,346 - DEBUG - Online update step: 25/50
2025-06-02 16:04:00,349 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:00,494 - DEBUG - Node anomaly scores shape: torch.Size([17819, 1])
2025-06-02 16:04:00,501 - DEBUG - Edge anomaly scores shape: torch.Size([37154, 1])
2025-06-02 16:04:00,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:00,801 - DEBUG - Step 25: Loss=0.5800
2025-06-02 16:04:00,801 - DEBUG - Online update step: 26/50
2025-06-02 16:04:00,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:00,934 - DEBUG - Node anomaly scores shape: torch.Size([18310, 1])
2025-06-02 16:04:00,939 - DEBUG - Edge anomaly scores shape: torch.Size([38209, 1])
2025-06-02 16:04:00,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:01,202 - DEBUG - Step 26: Loss=0.5842
2025-06-02 16:04:01,202 - DEBUG - Online update step: 27/50
2025-06-02 16:04:01,206 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:01,351 - DEBUG - Node anomaly scores shape: torch.Size([19883, 1])
2025-06-02 16:04:01,358 - DEBUG - Edge anomaly scores shape: torch.Size([41468, 1])
2025-06-02 16:04:01,359 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:01,718 - DEBUG - Step 27: Loss=0.5787
2025-06-02 16:04:01,718 - DEBUG - Online update step: 28/50
2025-06-02 16:04:01,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:01,875 - DEBUG - Node anomaly scores shape: torch.Size([17626, 1])
2025-06-02 16:04:01,882 - DEBUG - Edge anomaly scores shape: torch.Size([36657, 1])
2025-06-02 16:04:01,885 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:02,264 - DEBUG - Step 28: Loss=0.5833
2025-06-02 16:04:02,265 - DEBUG - Online update step: 29/50
2025-06-02 16:04:02,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:02,408 - DEBUG - Node anomaly scores shape: torch.Size([19013, 1])
2025-06-02 16:04:02,414 - DEBUG - Edge anomaly scores shape: torch.Size([39759, 1])
2025-06-02 16:04:02,415 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:02,678 - DEBUG - Step 29: Loss=0.5790
2025-06-02 16:04:02,678 - DEBUG - Online update step: 30/50
2025-06-02 16:04:02,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:02,830 - DEBUG - Node anomaly scores shape: torch.Size([19220, 1])
2025-06-02 16:04:02,835 - DEBUG - Edge anomaly scores shape: torch.Size([40075, 1])
2025-06-02 16:04:02,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:03,180 - DEBUG - Step 30: Loss=0.5822
2025-06-02 16:04:03,180 - DEBUG - Online update step: 31/50
2025-06-02 16:04:03,183 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:03,318 - DEBUG - Node anomaly scores shape: torch.Size([18387, 1])
2025-06-02 16:04:03,328 - DEBUG - Edge anomaly scores shape: torch.Size([38128, 1])
2025-06-02 16:04:03,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:03,705 - DEBUG - Step 31: Loss=0.5797
2025-06-02 16:04:03,706 - DEBUG - Online update step: 32/50
2025-06-02 16:04:03,709 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:03,826 - DEBUG - Node anomaly scores shape: torch.Size([17959, 1])
2025-06-02 16:04:03,831 - DEBUG - Edge anomaly scores shape: torch.Size([37391, 1])
2025-06-02 16:04:03,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:04,079 - DEBUG - Step 32: Loss=0.5826
2025-06-02 16:04:04,080 - DEBUG - Online update step: 33/50
2025-06-02 16:04:04,091 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:04,231 - DEBUG - Node anomaly scores shape: torch.Size([17854, 1])
2025-06-02 16:04:04,236 - DEBUG - Edge anomaly scores shape: torch.Size([36975, 1])
2025-06-02 16:04:04,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:04,504 - DEBUG - Step 33: Loss=0.5792
2025-06-02 16:04:04,504 - DEBUG - Online update step: 34/50
2025-06-02 16:04:04,507 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:04,674 - DEBUG - Node anomaly scores shape: torch.Size([19367, 1])
2025-06-02 16:04:04,680 - DEBUG - Edge anomaly scores shape: torch.Size([40572, 1])
2025-06-02 16:04:04,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:05,089 - DEBUG - Step 34: Loss=0.5832
2025-06-02 16:04:05,089 - DEBUG - Online update step: 35/50
2025-06-02 16:04:05,092 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:05,237 - DEBUG - Node anomaly scores shape: torch.Size([18780, 1])
2025-06-02 16:04:05,243 - DEBUG - Edge anomaly scores shape: torch.Size([39196, 1])
2025-06-02 16:04:05,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:05,491 - DEBUG - Step 35: Loss=0.5781
2025-06-02 16:04:05,492 - DEBUG - Online update step: 36/50
2025-06-02 16:04:05,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:05,622 - DEBUG - Node anomaly scores shape: torch.Size([16528, 1])
2025-06-02 16:04:05,627 - DEBUG - Edge anomaly scores shape: torch.Size([34135, 1])
2025-06-02 16:04:05,630 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:05,906 - DEBUG - Step 36: Loss=0.5835
2025-06-02 16:04:05,907 - DEBUG - Online update step: 37/50
2025-06-02 16:04:05,917 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:06,046 - DEBUG - Node anomaly scores shape: torch.Size([18226, 1])
2025-06-02 16:04:06,051 - DEBUG - Edge anomaly scores shape: torch.Size([38064, 1])
2025-06-02 16:04:06,053 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:06,288 - DEBUG - Step 37: Loss=0.5792
2025-06-02 16:04:06,288 - DEBUG - Online update step: 38/50
2025-06-02 16:04:06,291 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:06,432 - DEBUG - Node anomaly scores shape: torch.Size([18569, 1])
2025-06-02 16:04:06,437 - DEBUG - Edge anomaly scores shape: torch.Size([38817, 1])
2025-06-02 16:04:06,438 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:06,804 - DEBUG - Step 38: Loss=0.5823
2025-06-02 16:04:06,805 - DEBUG - Online update step: 39/50
2025-06-02 16:04:06,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:06,933 - DEBUG - Node anomaly scores shape: torch.Size([18542, 1])
2025-06-02 16:04:06,938 - DEBUG - Edge anomaly scores shape: torch.Size([38880, 1])
2025-06-02 16:04:06,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:07,259 - DEBUG - Step 39: Loss=0.5792
2025-06-02 16:04:07,259 - DEBUG - Online update step: 40/50
2025-06-02 16:04:07,269 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:07,434 - DEBUG - Node anomaly scores shape: torch.Size([19277, 1])
2025-06-02 16:04:07,443 - DEBUG - Edge anomaly scores shape: torch.Size([40116, 1])
2025-06-02 16:04:07,446 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:07,820 - DEBUG - Step 40: Loss=0.5816
2025-06-02 16:04:07,821 - DEBUG - Online update step: 41/50
2025-06-02 16:04:07,824 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:07,968 - DEBUG - Node anomaly scores shape: torch.Size([19591, 1])
2025-06-02 16:04:07,973 - DEBUG - Edge anomaly scores shape: torch.Size([40965, 1])
2025-06-02 16:04:07,975 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:08,332 - DEBUG - Step 41: Loss=0.5785
2025-06-02 16:04:08,332 - DEBUG - Online update step: 42/50
2025-06-02 16:04:08,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:08,514 - DEBUG - Node anomaly scores shape: torch.Size([18391, 1])
2025-06-02 16:04:08,523 - DEBUG - Edge anomaly scores shape: torch.Size([38375, 1])
2025-06-02 16:04:08,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:08,897 - DEBUG - Step 42: Loss=0.5828
2025-06-02 16:04:08,898 - DEBUG - Online update step: 43/50
2025-06-02 16:04:08,901 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:09,058 - DEBUG - Node anomaly scores shape: torch.Size([18158, 1])
2025-06-02 16:04:09,065 - DEBUG - Edge anomaly scores shape: torch.Size([37967, 1])
2025-06-02 16:04:09,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:09,399 - DEBUG - Step 43: Loss=0.5793
2025-06-02 16:04:09,399 - DEBUG - Online update step: 44/50
2025-06-02 16:04:09,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:09,560 - DEBUG - Node anomaly scores shape: torch.Size([17096, 1])
2025-06-02 16:04:09,567 - DEBUG - Edge anomaly scores shape: torch.Size([35473, 1])
2025-06-02 16:04:09,568 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:09,929 - DEBUG - Step 44: Loss=0.5832
2025-06-02 16:04:09,929 - DEBUG - Online update step: 45/50
2025-06-02 16:04:09,932 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:10,072 - DEBUG - Node anomaly scores shape: torch.Size([18363, 1])
2025-06-02 16:04:10,078 - DEBUG - Edge anomaly scores shape: torch.Size([38422, 1])
2025-06-02 16:04:10,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:10,351 - DEBUG - Step 45: Loss=0.5784
2025-06-02 16:04:10,351 - DEBUG - Online update step: 46/50
2025-06-02 16:04:10,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:10,503 - DEBUG - Node anomaly scores shape: torch.Size([18529, 1])
2025-06-02 16:04:10,512 - DEBUG - Edge anomaly scores shape: torch.Size([38762, 1])
2025-06-02 16:04:10,515 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:10,963 - DEBUG - Step 46: Loss=0.5823
2025-06-02 16:04:10,963 - DEBUG - Online update step: 47/50
2025-06-02 16:04:10,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:11,223 - DEBUG - Node anomaly scores shape: torch.Size([18036, 1])
2025-06-02 16:04:11,234 - DEBUG - Edge anomaly scores shape: torch.Size([37473, 1])
2025-06-02 16:04:11,236 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:11,727 - DEBUG - Step 47: Loss=0.5785
2025-06-02 16:04:11,728 - DEBUG - Online update step: 48/50
2025-06-02 16:04:11,744 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:12,082 - DEBUG - Node anomaly scores shape: torch.Size([18077, 1])
2025-06-02 16:04:12,098 - DEBUG - Edge anomaly scores shape: torch.Size([37728, 1])
2025-06-02 16:04:12,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:12,619 - DEBUG - Step 48: Loss=0.5819
2025-06-02 16:04:12,620 - DEBUG - Online update step: 49/50
2025-06-02 16:04:12,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:12,944 - DEBUG - Node anomaly scores shape: torch.Size([19265, 1])
2025-06-02 16:04:12,954 - DEBUG - Edge anomaly scores shape: torch.Size([40263, 1])
2025-06-02 16:04:12,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:13,471 - DEBUG - Step 49: Loss=0.5782
2025-06-02 16:04:13,471 - DEBUG - Online update step: 50/50
2025-06-02 16:04:13,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:13,616 - DEBUG - Node anomaly scores shape: torch.Size([18263, 1])
2025-06-02 16:04:13,622 - DEBUG - Edge anomaly scores shape: torch.Size([38026, 1])
2025-06-02 16:04:13,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:13,927 - DEBUG - Step 50: Loss=0.5823
2025-06-02 16:04:13,929 - INFO - Online update finished. Average loss: 0.5814, Learning rate: 0.001000
2025-06-02 16:04:13,933 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], current edge mean: [ 9.1468067e+00  1.4180171e+00  5.6916113e+00 -7.2730169e-09
  3.1819447e-09  9.0912711e-10  1.8182542e-09 -9.0912711e-10
 -1.8182542e-09  1.8182542e-09]
2025-06-02 16:04:13,935 - DEBUG - Node drift difference: 0.0202, Edge drift difference: 0.0112
2025-06-02 16:04:13,940 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  1.0409127e-08  1.5861527e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -8.4264364e-09
 -6.7411492e-08  1.3383164e-08 -1.7844219e-08  4.9567270e-09
  2.2827442e+00  2.9625781e+00  1.4033264e-01  4.4064450e+00
 -1.7348546e-08  3.3607068e+00  5.8243241e+00  7.6091475e+00
  1.4033264e-01  7.9927235e+00  3.2218725e-08 -2.0322581e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -1.8835564e-08 -5.9480726e-08], edge=[ 9.1468067e+00  1.4180171e+00  5.6916113e+00 -7.2730169e-09
  3.1819447e-09  9.0912711e-10  1.8182542e-09 -9.0912711e-10
 -1.8182542e-09  1.8182542e-09]
2025-06-02 16:04:13,943 - DEBUG - Updated reference std: node=[0.         0.         1.0005201  1.0005201  0.         0.
 0.         1.0005201  1.0005201  1.0005202  1.0005201  1.0005201
 0.96617806 0.27114588 0.36217502 0.5716872  1.0005202  2.9931998
 2.895206   1.4912298  0.36217502 0.22568905 1.0005201  1.0005201
 0.         0.         0.         0.         1.0005202  1.0005201 ], edge=[1.1136607 0.5057603 2.15267   1.0002384 1.0002384 1.0002384 1.0002384
 1.0002384 1.0002384 1.0002384]
2025-06-02 16:04:13,954 - INFO - Online update complete. Loss: 0.5814
2025-06-02 16:04:13,954 - INFO - Running anomaly detection...
2025-06-02 16:04:13,955 - INFO - Starting anomaly detection.
2025-06-02 16:04:13,998 - DEBUG - Node reconstruction errors: [0.05188621 0.6623336  0.08342784 0.00514866 0.02794729 0.01438275
 0.15558876 0.01936005 0.01936007 0.01937935 0.01936005 0.00809196
 0.45455104 0.13440624 0.00245582 0.01775416 0.01177375 0.01775442
 0.00815671 0.01719405 0.02007507 0.00245582 0.03463114 0.00530603
 0.00239348 0.00500602 0.00239334 0.03856162 0.0191701  0.00239334
 0.11401121 0.07946341 0.03477771 0.00452372 0.01242223 0.03436693
 0.06134311 0.01719399 0.05206085 0.06513098 0.00550076 0.00212893
 0.01719399 0.00840431 0.00980411 0.00782965 0.01305541 0.19078247
 0.01923112 0.09986985 0.06324019 0.00461768 0.00451058 0.01024722
 0.01864809 0.0345472  0.07235756 0.01670644 0.00786306 0.01998707
 0.1364254  0.01269491 0.0018788  0.00554892 0.01374401 0.01864805
 0.00372319 0.01864794 0.00187879 0.01071537 0.02375348 0.00855697
 0.00350939 0.02006679 0.02034182 0.00879375 0.01255113 0.03394568
 0.00953818 0.01160724 0.00384472 0.02245237 0.2356378  0.04995627
 0.0142503  0.00714394 0.03899748 0.01328041 0.01203254 0.08819214
 0.00154013 0.03360812 0.00345076 0.01282462 0.00465919 0.04340928
 0.00377864 0.0107503  0.00175517 0.02043221 0.00483067 0.00377865
 0.00603694 0.09988277 0.00460299 0.02025357 0.00387249 0.02733679
 0.00303005 0.1032909  0.0833244  0.00436962 0.03104455 0.03886016
 0.00557494 0.02205878 0.00502411 0.02195513 0.01146165 0.00396503
 0.00160306 0.00416459 0.03492896 0.00449207 0.01594711 0.00396307
 0.00422546 0.00883873 0.01356335 0.00325634 0.00393558 0.00398756
 0.1191995  0.12444942 0.00460033 0.01833349 0.00566176 0.00164338
 0.1025456  0.03052662 0.00532559 0.0373997  0.00183831 0.00440743
 0.00690357 0.0092539  0.00502062 0.09709468 0.00483254 0.01573823
 0.25268954 0.00556389 0.01646901 0.00398756 0.02850974 0.02291086
 0.00303918 0.03354454 0.00483073 0.00600719 0.00532584 0.00460838
 0.0030392  0.00393559 0.00397614 0.02562883 0.00788879 0.01014277
 0.00495748 0.0156051  0.01155126 0.00397887 0.00143375 0.02971441
 0.01146388 0.00536641 0.0108816  0.03513107 0.00378214 0.00378219
 0.02054472 0.00452221 0.00612985 0.04638147 0.03742645 0.01056734
 0.00188177 0.0188395  0.01855563 0.00279355 0.02847602 0.0122674
 0.00572527 0.00346455 0.10253859 0.00341469 0.2561414  0.00572301
 0.03146584 0.00717093 0.00285752 0.00303918 0.02748959 0.01461115
 0.01434071 0.00433095 0.02045813 0.09839828 0.0019673  0.01604646
 0.00336952 0.01417295 0.00323686 0.02111324 0.01226139 0.00226348
 0.01466984 0.00502468 0.08568241 0.00346454 0.04179893 0.00188177
 0.00137875 0.00323687 0.0030392  0.01880497 0.01979736 0.00370719
 0.01094207 0.00330994 0.00325674 0.02124063 0.01355186 0.00502251
 0.00502435 0.00350367 0.01362217 0.00137875 0.00303918 0.00793891
 0.02136119 0.01443462 0.00420533 0.01621363 0.00345092 0.01754004
 0.01895973 0.02703824 0.00420533 0.00336413 0.00143374 0.00169528
 0.08568137 0.01057217 0.01348358 0.02860775 0.0027933  0.0023509
 0.00473779 0.00378216 0.01520224 0.00653358 0.01358969 0.00456376
 0.01177126 0.00453507 0.00601414 0.08726303 0.00601692 0.01471939
 0.07699347 0.03889481 0.01414142 0.0083081  0.00726056 0.06102157
 0.00144507 0.04543482 0.02054477 0.01010659 0.08554729 0.00131345
 0.0107858  0.00478936 0.01817115 0.00383659 0.08387483 0.00831978
 0.00452222 0.00631824 0.00460243 0.00405257 0.03541501 0.00345094
 0.11543828 0.00315278 0.01104225 0.00378121 0.00341449 0.00747191
 0.00972263 0.00637315 0.00732643 0.00804129 0.00165694 0.00165693
 0.00165694 0.00767444 0.00530545 0.00637315 0.00165694 0.02598822
 0.00165694 0.00518782 0.00527888 0.0118672  0.09153613 0.00370524
 0.00305025 0.00356697 0.02094165 0.00405986 0.01087758 0.00732641
 0.0263314  0.0421661  0.12464172 0.01616672 0.01586353 0.01585935
 0.08578496 0.00328374 0.00165706 0.00725992 0.00165694 0.00767504
 0.00671158 0.00160718 0.00716064 0.00177196 0.0063755  0.00421519
 0.00177196 0.02028924 0.01168274 0.01235515 0.00732576 0.00399933
 0.00677787 0.01037641 0.00165701 0.01387651 0.02923504 0.01200117
 0.00416738 0.0027933  0.00701372 0.00165693 0.00162719 0.03033705
 0.00786367 0.00245369 0.09738706 0.01631122 0.00730978 0.01894619
 0.00147359 0.03162792 0.00393756 0.00370901 0.01330986 0.01427579
 0.01278516 0.02617801 0.01255566 0.0331373  0.00137032 0.00311015
 0.03160072 0.00165694 0.00732715 0.00505435 0.00312088 0.01069437
 0.00515497 0.01240964 0.01883256 0.00430398 0.01974561 0.00165694
 0.07859306 0.01261942 0.0029081  0.03409228 0.01813745 0.01813904
 0.01814162 0.00982302 0.00172801 0.0091575  0.00240211 0.03394628
 0.02875365 0.00172795 0.00496862 0.00289987 0.01339691 0.00250735
 0.00290835 0.02753647 0.0181401  0.0029083  0.00172796 0.01813847
 0.01813959 0.00435514 0.00427642 0.01814197 0.0013707  0.00291601
 0.00302633 0.00249327 0.00344987 0.00285275 0.03256605 0.004284
 0.00276162 0.0050051  0.00976391 0.00279822 0.0058488  0.02119557
 0.01834919 0.02405743 0.03317178 0.01813902 0.00240209 0.01156218
 0.03411378 0.00405493 0.00249654 0.00287022 0.08486447 0.00171609
 0.00309441 0.02526191 0.03584399 0.0026245  0.00317811 0.00282023
 0.01837154 0.00147839 0.0030796  0.00503781 0.00147839 0.01931683
 0.00285265 0.00325868 0.00354601 0.01245205 0.0036041  0.0033289
 0.00275821 0.00376442 0.00275858 0.00332891 0.00155999 0.00697379
 0.00663519 0.00331074 0.00155999 0.00357754 0.01161506 0.06923584
 0.01107981 0.00324759 0.00696729 0.00360416 0.00164664 0.00348649
 0.00325101 0.09839988 0.00264937 0.00262454 0.03158009 0.00219508
 0.00147839 0.00742492 0.01402152 0.06927346 0.01455729 0.00164664
 0.01142666 0.00177231 0.01653134 0.00305978 0.00342734 0.04131334
 0.0018368  0.00348648 0.08579244 0.00177228 0.08907221 0.00135436
 0.00159288 0.00304306 0.00207343 0.10628117 0.00276258 0.00147839
 0.00218859 0.00244142 0.00244142 0.00182335 0.01129579 0.00226714
 0.00207374 0.00810758 0.0047898  0.01533553 0.02166233 0.00286999
 0.00207337 0.00502246 0.00159288 0.00343335 0.00335825 0.00514842
 0.02154899 0.01078    0.00226714 0.01084379 0.0018368  0.00348647
 0.00342464 0.00272908 0.01522715 0.01228042 0.00183683 0.02166072
 0.00183683 0.01141541 0.00460753 0.00810257 0.0022333  0.01836575
 0.00668034 0.00197185 0.22025889 0.00197185 0.00197186 0.00197186
 0.00197186 0.00197186 0.00197186 0.00197186 0.00831767 0.00219792
 0.01421722 0.00197185 0.00197186 0.00197186 0.00197186 0.00197186
 0.00197186 0.00197186 0.00197186 0.00197186 0.00829946 0.00197186
 0.00197186 0.03228761 0.00197186 0.00260795 0.01516638 0.0018368
 0.01524631 0.02304717 0.01351976 0.01351976 0.01178548 0.01524635
 0.00183681 0.00207336 0.0020734  0.0048853  0.00207341 0.00375318
 0.00273435 0.00197211 0.00286996 0.0018368  0.0024415  0.0018368
 0.0018368  0.00362523 0.0018368  0.00207336 0.0018368  0.0018368
 0.00810433 0.00207336 0.00183681 0.0020734  0.00183681 0.0018368
 0.0018368  0.00560232 0.01274622 0.00337232 0.00197186 0.02116119
 0.01521054 0.0018368  0.00207342 0.00652811 0.00197186 0.00295896
 0.01223779 0.00219227 0.0018368  0.0018368  0.01244003 0.0057839
 0.0040485  0.00183682 0.00831773 0.00255534 0.00207337 0.0061419
 0.00197186 0.00363055 0.01019415 0.00197185 0.00197193 0.00831766
 0.00255522 0.0018368  0.11365552 0.01121016 0.00770745 0.00578672
 0.00238533 0.0161513  0.01615128 0.01518391 0.00183622 0.00197186
 0.0023656  0.01841203 0.00578562 0.00265085 0.00196827 0.0020413
 0.00191411 0.00191411 0.00191412 0.00191412 0.00191411 0.00865545
 0.01702494 0.00191411 0.00191416 0.00197186 0.00249424 0.00197186
 0.01615125 0.01576622 0.03202577 0.00443852 0.02479164 0.02024862
 0.00829952 0.00258167 0.0082998  0.00197186 0.01615125 0.00165294
 0.00201966 0.00201964 0.00191411 0.00165294 0.01066843 0.00486257
 0.00312657 0.00197186 0.00191412 0.00226598 0.00201963 0.00227977
 0.00144121 0.00251666 0.00865547 0.07559644 0.00176804 0.04673035
 0.00306528 0.00144121 0.00213859 0.00157585 0.0013501  0.00154853
 0.01491958 0.0030196  0.01550431 0.00144119 0.00144121 0.00144119
 0.00139517 0.00226598 0.00144119 0.0013501  0.00144119 0.00144119
 0.00144121 0.00318808 0.00155456 0.01276628 0.0115063  0.01807942
 0.0173691  0.00247726 0.01010641 0.01613308 0.00128094 0.00155902
 0.0014914  0.02281563 0.02281559 0.0013501  0.0223998  0.08969007
 0.00128161 0.0018805  0.00283732 0.02380488 0.00157252 0.00157252
 0.00157252 0.0018887  0.00122023 0.00447274 0.0231301  0.08863296
 0.00237132 0.00136496 0.00241119 0.00188049 0.00234186 0.00484431
 0.0012575  0.00262963 0.0012816  0.08989245 0.00188049 0.00487001
 0.00136492 0.00965218 0.00157252 0.00188873 0.00125755 0.00292987
 0.0232919  0.0018887  0.00188869 0.0018887  0.01044407 0.1539883
 0.83400154 0.00157252 0.04867252 0.0018887  0.01771433 0.00204058
 0.03125165 0.00311652 0.00188869 0.00192718 0.0021683  0.00122619
 0.28361675 0.00311978 0.02973735 0.00259868 0.00945657 0.00311623
 0.01428543 0.02379277 0.00428191 0.00772127 0.01050335 0.00122291
 0.00122303 0.05250928 0.11714436 0.01202694 0.00311625 0.0042819
 0.00311625 0.00130284 0.00123419 0.00123419 0.00122397 0.01352368
 0.00149183 0.00123419 0.00130284 0.00454145 0.0012342  0.00123419
 0.00198379 0.00227799 0.01029239 0.01585544 0.0012342  0.00704681
 0.00454145 0.00123419 0.00126339 0.00227798 0.00141245 0.00141245
 0.01219464 0.00231673 0.00123419 0.00231671 0.00227039 0.01689247
 0.02211129 0.00123419 0.11426654 0.00226868 0.0022687  0.00243189
 0.00206154 0.0025923  0.00126339 0.00208579 0.00128125 0.02485816
 0.00332283 0.02485818 0.09509538 0.00134997 0.00332283 0.00215649
 0.00215648 0.02701036 0.00215649 0.00422047 0.0020613  0.02468601
 0.00259016 0.00134998 0.00259003 0.00763164 0.01717045 0.01581073
 0.00215649 0.00221962 0.00234323 0.00215649 0.01121613 0.05090225
 0.00221963 0.00134998 0.00215649 0.11482133 0.00215649 0.0021565
 0.00215649 0.00131341 0.01500131 0.0013134  0.00223893 0.00131341
 0.01175573 0.01902831 0.02493821 0.00215649 0.00215649 0.00248357
 0.00215649 0.09474329 0.00223757 0.00131341 0.0024836  0.00215649
 0.00215649 0.00653022 0.0024836  0.00215649 0.00222794 0.00341603
 0.00139369 0.0294655  0.00222796 0.00215649 0.00215649 0.00466664
 0.01564265 0.01605534 0.01605936 0.0022823  0.02119233 0.00245009
 0.00283936 0.15710755 0.01605851 0.00139866 0.01605932 0.00205888
 0.00283925 0.01605804 0.00237988 0.00139368 0.00389481 0.0025373
 0.0013947  0.00243032 0.00258184 0.00198321 0.00257874 0.0025788
 0.0180745  0.02817294 0.00257882 0.00257874 0.02588873 0.03185069
 0.00257874 0.00257874 0.00257874 0.00257875 0.02817798 0.0281736
 0.02817323 0.02817502 0.02817421 0.00419676 0.02817328 0.02817323
 0.00257874 0.00257874 0.18292214 0.00362476 0.00212817 0.02818325
 0.00147088 0.00293067 0.004299   0.00257874 0.00293066 0.00293067
 0.00414807 0.0281908  0.02818743 0.00241758 0.02819416 0.02819425
 0.00169958 0.02811775]
2025-06-02 16:04:13,999 - DEBUG - Edge reconstruction errors: [1.3648255  1.3620986  0.958049   ... 0.15803212 1.2589829  0.15803212]
2025-06-02 16:04:14,003 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160414_update_45.json
2025-06-02 16:04:14,003 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:04:14,013 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160414_update_45.pth and as latest_checkpoint.pth
2025-06-02 16:04:14,013 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870445.dot): 0.1134
2025-06-02 16:04:14,013 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:04:14,013 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.6623, MLP Score: 0.5310
2025-06-02 16:04:14,013 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1556, MLP Score: 0.5115
2025-06-02 16:04:14,014 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4546, MLP Score: 0.5134
2025-06-02 16:04:14,014 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1908, MLP Score: 0.4857
2025-06-02 16:04:14,014 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.1364, MLP Score: 0.4912
2025-06-02 16:04:14,014 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:04:14,014 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.1522, MLP Score: 0.5109
2025-06-02 16:04:14,014 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.5544, MLP Score: 0.4905
2025-06-02 16:04:14,014 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4830, MLP Score: 0.5040
2025-06-02 16:04:14,014 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1465, MLP Score: 0.3627
2025-06-02 16:04:14,014 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8302, MLP Score: 0.5062
2025-06-02 16:04:14,014 - INFO - 
--- Processing file: nw_graph_encoded_1748870475.dot (Timestamp: 2025-06-02 15:21:15) ---
2025-06-02 16:04:14,014 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 16:04:14,015 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 16:04:14,047 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 16:04:14,083 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 16:04:14,084 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 16:04:14,084 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870475.dot
2025-06-02 16:04:14,116 - INFO - Parsed 985 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 16:04:14,153 - INFO - Parsed 2150 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870475.dot'.
2025-06-02 16:04:14,154 - INFO - Processing node updates/additions.
2025-06-02 16:04:14,165 - INFO - Processing edge updates/additions.
2025-06-02 16:04:14,189 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:04:14,191 - INFO - Finished updating NetworkX graph.
2025-06-02 16:04:14,192 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:04:14,194 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:04:14,211 - DEBUG - Initial node features tensor shape: torch.Size([985, 30])
2025-06-02 16:04:14,213 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:04:14,213 - DEBUG - Node features tensor shape after scaling: torch.Size([985, 30])
2025-06-02 16:04:14,218 - DEBUG - Edge index tensor shape: torch.Size([2, 2150])
2025-06-02 16:04:14,221 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:04:14,232 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:04:14,234 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:04:14,236 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:04:14,239 - DEBUG - Shape of encoded categorical edge features: torch.Size([2150, 3])
2025-06-02 16:04:14,241 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:04:14,242 - DEBUG - Shape of scaled numerical edge features: torch.Size([2150, 7])
2025-06-02 16:04:14,242 - DEBUG - Final edge attributes tensor shape: torch.Size([2150, 10])
2025-06-02 16:04:14,242 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:04:14,250 - INFO - Performing online update...
2025-06-02 16:04:14,251 - INFO - Starting online update for 50 steps.
2025-06-02 16:04:14,253 - DEBUG - Updated RunningStats: new_mean=0.9448048532339003, new_var=26400000000161.727, new_n=2670
2025-06-02 16:04:14,253 - DEBUG - Updated RunningStats: new_mean=0.9425044059362168, new_var=26700000000018.18, new_n=2700
2025-06-02 16:04:14,253 - DEBUG - Updated RunningStats: new_mean=1.1469889484578373, new_var=8800000000094.084, new_n=890
2025-06-02 16:04:14,254 - DEBUG - Updated RunningStats: new_mean=1.1461973808687331, new_var=8900000000001.55, new_n=900
2025-06-02 16:04:14,254 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:04:14,254 - DEBUG - Online update step: 1/50
2025-06-02 16:04:14,260 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:14,627 - DEBUG - Node anomaly scores shape: torch.Size([19210, 1])
2025-06-02 16:04:14,656 - DEBUG - Edge anomaly scores shape: torch.Size([40189, 1])
2025-06-02 16:04:14,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:15,123 - DEBUG - Step 1: Loss=0.5786
2025-06-02 16:04:15,123 - DEBUG - Online update step: 2/50
2025-06-02 16:04:15,126 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:15,304 - DEBUG - Node anomaly scores shape: torch.Size([19405, 1])
2025-06-02 16:04:15,311 - DEBUG - Edge anomaly scores shape: torch.Size([40600, 1])
2025-06-02 16:04:15,314 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:15,786 - DEBUG - Step 2: Loss=0.5816
2025-06-02 16:04:15,786 - DEBUG - Online update step: 3/50
2025-06-02 16:04:15,797 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:16,088 - DEBUG - Node anomaly scores shape: torch.Size([20125, 1])
2025-06-02 16:04:16,106 - DEBUG - Edge anomaly scores shape: torch.Size([42382, 1])
2025-06-02 16:04:16,112 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:16,650 - DEBUG - Step 3: Loss=0.5776
2025-06-02 16:04:16,651 - DEBUG - Online update step: 4/50
2025-06-02 16:04:16,663 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:16,836 - DEBUG - Node anomaly scores shape: torch.Size([18747, 1])
2025-06-02 16:04:16,843 - DEBUG - Edge anomaly scores shape: torch.Size([39262, 1])
2025-06-02 16:04:16,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:17,192 - DEBUG - Step 4: Loss=0.5824
2025-06-02 16:04:17,192 - DEBUG - Online update step: 5/50
2025-06-02 16:04:17,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:17,431 - DEBUG - Node anomaly scores shape: torch.Size([19106, 1])
2025-06-02 16:04:17,452 - DEBUG - Edge anomaly scores shape: torch.Size([39869, 1])
2025-06-02 16:04:17,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:17,816 - DEBUG - Step 5: Loss=0.5780
2025-06-02 16:04:17,817 - DEBUG - Online update step: 6/50
2025-06-02 16:04:17,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:17,958 - DEBUG - Node anomaly scores shape: torch.Size([18416, 1])
2025-06-02 16:04:17,963 - DEBUG - Edge anomaly scores shape: torch.Size([38314, 1])
2025-06-02 16:04:17,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:18,225 - DEBUG - Step 6: Loss=0.5821
2025-06-02 16:04:18,225 - DEBUG - Online update step: 7/50
2025-06-02 16:04:18,229 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:18,366 - DEBUG - Node anomaly scores shape: torch.Size([18232, 1])
2025-06-02 16:04:18,372 - DEBUG - Edge anomaly scores shape: torch.Size([37936, 1])
2025-06-02 16:04:18,373 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:18,632 - DEBUG - Step 7: Loss=0.5785
2025-06-02 16:04:18,632 - DEBUG - Online update step: 8/50
2025-06-02 16:04:18,635 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:18,787 - DEBUG - Node anomaly scores shape: torch.Size([19297, 1])
2025-06-02 16:04:18,794 - DEBUG - Edge anomaly scores shape: torch.Size([40568, 1])
2025-06-02 16:04:18,795 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:19,119 - DEBUG - Step 8: Loss=0.5814
2025-06-02 16:04:19,119 - DEBUG - Online update step: 9/50
2025-06-02 16:04:19,122 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:19,289 - DEBUG - Node anomaly scores shape: torch.Size([18080, 1])
2025-06-02 16:04:19,295 - DEBUG - Edge anomaly scores shape: torch.Size([37710, 1])
2025-06-02 16:04:19,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:19,581 - DEBUG - Step 9: Loss=0.5784
2025-06-02 16:04:19,581 - DEBUG - Online update step: 10/50
2025-06-02 16:04:19,584 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:19,717 - DEBUG - Node anomaly scores shape: torch.Size([18573, 1])
2025-06-02 16:04:19,723 - DEBUG - Edge anomaly scores shape: torch.Size([38733, 1])
2025-06-02 16:04:19,724 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:19,988 - DEBUG - Step 10: Loss=0.5813
2025-06-02 16:04:19,988 - DEBUG - Online update step: 11/50
2025-06-02 16:04:19,991 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:20,149 - DEBUG - Node anomaly scores shape: torch.Size([19752, 1])
2025-06-02 16:04:20,155 - DEBUG - Edge anomaly scores shape: torch.Size([41523, 1])
2025-06-02 16:04:20,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:20,562 - DEBUG - Step 11: Loss=0.5774
2025-06-02 16:04:20,562 - DEBUG - Online update step: 12/50
2025-06-02 16:04:20,566 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:20,796 - DEBUG - Node anomaly scores shape: torch.Size([17745, 1])
2025-06-02 16:04:20,810 - DEBUG - Edge anomaly scores shape: torch.Size([37057, 1])
2025-06-02 16:04:20,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:21,166 - DEBUG - Step 12: Loss=0.5828
2025-06-02 16:04:21,166 - DEBUG - Online update step: 13/50
2025-06-02 16:04:21,175 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:21,500 - DEBUG - Node anomaly scores shape: torch.Size([18459, 1])
2025-06-02 16:04:21,514 - DEBUG - Edge anomaly scores shape: torch.Size([38480, 1])
2025-06-02 16:04:21,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:21,976 - DEBUG - Step 13: Loss=0.5784
2025-06-02 16:04:21,976 - DEBUG - Online update step: 14/50
2025-06-02 16:04:21,980 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:22,226 - DEBUG - Node anomaly scores shape: torch.Size([18068, 1])
2025-06-02 16:04:22,233 - DEBUG - Edge anomaly scores shape: torch.Size([37665, 1])
2025-06-02 16:04:22,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:22,517 - DEBUG - Step 14: Loss=0.5817
2025-06-02 16:04:22,517 - DEBUG - Online update step: 15/50
2025-06-02 16:04:22,528 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:22,809 - DEBUG - Node anomaly scores shape: torch.Size([18378, 1])
2025-06-02 16:04:22,823 - DEBUG - Edge anomaly scores shape: torch.Size([38514, 1])
2025-06-02 16:04:22,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:23,386 - DEBUG - Step 15: Loss=0.5780
2025-06-02 16:04:23,386 - DEBUG - Online update step: 16/50
2025-06-02 16:04:23,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:23,717 - DEBUG - Node anomaly scores shape: torch.Size([18320, 1])
2025-06-02 16:04:23,732 - DEBUG - Edge anomaly scores shape: torch.Size([38216, 1])
2025-06-02 16:04:23,735 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:24,057 - DEBUG - Step 16: Loss=0.5816
2025-06-02 16:04:24,057 - DEBUG - Online update step: 17/50
2025-06-02 16:04:24,060 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:24,189 - DEBUG - Node anomaly scores shape: torch.Size([17571, 1])
2025-06-02 16:04:24,194 - DEBUG - Edge anomaly scores shape: torch.Size([36486, 1])
2025-06-02 16:04:24,195 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:24,417 - DEBUG - Step 17: Loss=0.5776
2025-06-02 16:04:24,418 - DEBUG - Online update step: 18/50
2025-06-02 16:04:24,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:24,579 - DEBUG - Node anomaly scores shape: torch.Size([19315, 1])
2025-06-02 16:04:24,584 - DEBUG - Edge anomaly scores shape: torch.Size([40391, 1])
2025-06-02 16:04:24,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:24,835 - DEBUG - Step 18: Loss=0.5803
2025-06-02 16:04:24,835 - DEBUG - Online update step: 19/50
2025-06-02 16:04:24,839 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:24,958 - DEBUG - Node anomaly scores shape: torch.Size([19056, 1])
2025-06-02 16:04:24,963 - DEBUG - Edge anomaly scores shape: torch.Size([39861, 1])
2025-06-02 16:04:24,964 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:25,199 - DEBUG - Step 19: Loss=0.5768
2025-06-02 16:04:25,199 - DEBUG - Online update step: 20/50
2025-06-02 16:04:25,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:25,300 - DEBUG - Node anomaly scores shape: torch.Size([18240, 1])
2025-06-02 16:04:25,305 - DEBUG - Edge anomaly scores shape: torch.Size([38229, 1])
2025-06-02 16:04:25,306 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:25,523 - DEBUG - Step 20: Loss=0.5816
2025-06-02 16:04:25,523 - DEBUG - Online update step: 21/50
2025-06-02 16:04:25,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:25,643 - DEBUG - Node anomaly scores shape: torch.Size([19419, 1])
2025-06-02 16:04:25,647 - DEBUG - Edge anomaly scores shape: torch.Size([40567, 1])
2025-06-02 16:04:25,648 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:25,856 - DEBUG - Step 21: Loss=0.5776
2025-06-02 16:04:25,856 - DEBUG - Online update step: 22/50
2025-06-02 16:04:25,859 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:25,972 - DEBUG - Node anomaly scores shape: torch.Size([18705, 1])
2025-06-02 16:04:25,979 - DEBUG - Edge anomaly scores shape: torch.Size([38997, 1])
2025-06-02 16:04:25,980 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:26,229 - DEBUG - Step 22: Loss=0.5816
2025-06-02 16:04:26,229 - DEBUG - Online update step: 23/50
2025-06-02 16:04:26,233 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:26,340 - DEBUG - Node anomaly scores shape: torch.Size([18103, 1])
2025-06-02 16:04:26,345 - DEBUG - Edge anomaly scores shape: torch.Size([37858, 1])
2025-06-02 16:04:26,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:26,537 - DEBUG - Step 23: Loss=0.5780
2025-06-02 16:04:26,537 - DEBUG - Online update step: 24/50
2025-06-02 16:04:26,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:26,653 - DEBUG - Node anomaly scores shape: torch.Size([18703, 1])
2025-06-02 16:04:26,657 - DEBUG - Edge anomaly scores shape: torch.Size([38959, 1])
2025-06-02 16:04:26,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:26,896 - DEBUG - Step 24: Loss=0.5809
2025-06-02 16:04:26,896 - DEBUG - Online update step: 25/50
2025-06-02 16:04:26,899 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:27,010 - DEBUG - Node anomaly scores shape: torch.Size([16541, 1])
2025-06-02 16:04:27,015 - DEBUG - Edge anomaly scores shape: torch.Size([34372, 1])
2025-06-02 16:04:27,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:27,273 - DEBUG - Step 25: Loss=0.5779
2025-06-02 16:04:27,273 - DEBUG - Online update step: 26/50
2025-06-02 16:04:27,277 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:27,418 - DEBUG - Node anomaly scores shape: torch.Size([18984, 1])
2025-06-02 16:04:27,426 - DEBUG - Edge anomaly scores shape: torch.Size([39586, 1])
2025-06-02 16:04:27,429 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:27,778 - DEBUG - Step 26: Loss=0.5799
2025-06-02 16:04:27,779 - DEBUG - Online update step: 27/50
2025-06-02 16:04:27,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:27,924 - DEBUG - Node anomaly scores shape: torch.Size([19109, 1])
2025-06-02 16:04:27,929 - DEBUG - Edge anomaly scores shape: torch.Size([39842, 1])
2025-06-02 16:04:27,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:28,225 - DEBUG - Step 27: Loss=0.5757
2025-06-02 16:04:28,225 - DEBUG - Online update step: 28/50
2025-06-02 16:04:28,229 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:28,346 - DEBUG - Node anomaly scores shape: torch.Size([17432, 1])
2025-06-02 16:04:28,356 - DEBUG - Edge anomaly scores shape: torch.Size([36144, 1])
2025-06-02 16:04:28,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:28,644 - DEBUG - Step 28: Loss=0.5810
2025-06-02 16:04:28,644 - DEBUG - Online update step: 29/50
2025-06-02 16:04:28,648 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:28,772 - DEBUG - Node anomaly scores shape: torch.Size([17933, 1])
2025-06-02 16:04:28,779 - DEBUG - Edge anomaly scores shape: torch.Size([37245, 1])
2025-06-02 16:04:28,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:29,000 - DEBUG - Step 29: Loss=0.5772
2025-06-02 16:04:29,000 - DEBUG - Online update step: 30/50
2025-06-02 16:04:29,003 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:29,101 - DEBUG - Node anomaly scores shape: torch.Size([17469, 1])
2025-06-02 16:04:29,106 - DEBUG - Edge anomaly scores shape: torch.Size([36277, 1])
2025-06-02 16:04:29,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:29,336 - DEBUG - Step 30: Loss=0.5814
2025-06-02 16:04:29,336 - DEBUG - Online update step: 31/50
2025-06-02 16:04:29,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:29,480 - DEBUG - Node anomaly scores shape: torch.Size([19103, 1])
2025-06-02 16:04:29,485 - DEBUG - Edge anomaly scores shape: torch.Size([40067, 1])
2025-06-02 16:04:29,486 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:29,736 - DEBUG - Step 31: Loss=0.5770
2025-06-02 16:04:29,737 - DEBUG - Online update step: 32/50
2025-06-02 16:04:29,742 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:29,867 - DEBUG - Node anomaly scores shape: torch.Size([20698, 1])
2025-06-02 16:04:29,874 - DEBUG - Edge anomaly scores shape: torch.Size([43569, 1])
2025-06-02 16:04:29,875 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:30,146 - DEBUG - Step 32: Loss=0.5804
2025-06-02 16:04:30,147 - DEBUG - Online update step: 33/50
2025-06-02 16:04:30,152 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:30,284 - DEBUG - Node anomaly scores shape: torch.Size([18841, 1])
2025-06-02 16:04:30,290 - DEBUG - Edge anomaly scores shape: torch.Size([39502, 1])
2025-06-02 16:04:30,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:30,550 - DEBUG - Step 33: Loss=0.5773
2025-06-02 16:04:30,550 - DEBUG - Online update step: 34/50
2025-06-02 16:04:30,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:30,695 - DEBUG - Node anomaly scores shape: torch.Size([19399, 1])
2025-06-02 16:04:30,700 - DEBUG - Edge anomaly scores shape: torch.Size([40713, 1])
2025-06-02 16:04:30,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:30,958 - DEBUG - Step 34: Loss=0.5802
2025-06-02 16:04:30,958 - DEBUG - Online update step: 35/50
2025-06-02 16:04:30,965 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:31,073 - DEBUG - Node anomaly scores shape: torch.Size([18316, 1])
2025-06-02 16:04:31,077 - DEBUG - Edge anomaly scores shape: torch.Size([38246, 1])
2025-06-02 16:04:31,079 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:31,339 - DEBUG - Step 35: Loss=0.5766
2025-06-02 16:04:31,340 - DEBUG - Online update step: 36/50
2025-06-02 16:04:31,345 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:31,527 - DEBUG - Node anomaly scores shape: torch.Size([17347, 1])
2025-06-02 16:04:31,538 - DEBUG - Edge anomaly scores shape: torch.Size([36007, 1])
2025-06-02 16:04:31,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:31,813 - DEBUG - Step 36: Loss=0.5808
2025-06-02 16:04:31,813 - DEBUG - Online update step: 37/50
2025-06-02 16:04:31,816 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:31,935 - DEBUG - Node anomaly scores shape: torch.Size([20010, 1])
2025-06-02 16:04:31,940 - DEBUG - Edge anomaly scores shape: torch.Size([41848, 1])
2025-06-02 16:04:31,943 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:32,378 - DEBUG - Step 37: Loss=0.5769
2025-06-02 16:04:32,378 - DEBUG - Online update step: 38/50
2025-06-02 16:04:32,383 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:32,487 - DEBUG - Node anomaly scores shape: torch.Size([19055, 1])
2025-06-02 16:04:32,492 - DEBUG - Edge anomaly scores shape: torch.Size([39561, 1])
2025-06-02 16:04:32,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:32,786 - DEBUG - Step 38: Loss=0.5805
2025-06-02 16:04:32,786 - DEBUG - Online update step: 39/50
2025-06-02 16:04:32,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:32,893 - DEBUG - Node anomaly scores shape: torch.Size([17863, 1])
2025-06-02 16:04:32,897 - DEBUG - Edge anomaly scores shape: torch.Size([37272, 1])
2025-06-02 16:04:32,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:33,177 - DEBUG - Step 39: Loss=0.5767
2025-06-02 16:04:33,178 - DEBUG - Online update step: 40/50
2025-06-02 16:04:33,186 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:33,328 - DEBUG - Node anomaly scores shape: torch.Size([17350, 1])
2025-06-02 16:04:33,334 - DEBUG - Edge anomaly scores shape: torch.Size([36142, 1])
2025-06-02 16:04:33,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:33,661 - DEBUG - Step 40: Loss=0.5811
2025-06-02 16:04:33,662 - DEBUG - Online update step: 41/50
2025-06-02 16:04:33,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:33,843 - DEBUG - Node anomaly scores shape: torch.Size([18312, 1])
2025-06-02 16:04:33,873 - DEBUG - Edge anomaly scores shape: torch.Size([38279, 1])
2025-06-02 16:04:33,880 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:34,368 - DEBUG - Step 41: Loss=0.5769
2025-06-02 16:04:34,369 - DEBUG - Online update step: 42/50
2025-06-02 16:04:34,372 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:34,501 - DEBUG - Node anomaly scores shape: torch.Size([18016, 1])
2025-06-02 16:04:34,506 - DEBUG - Edge anomaly scores shape: torch.Size([37394, 1])
2025-06-02 16:04:34,507 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:34,773 - DEBUG - Step 42: Loss=0.5799
2025-06-02 16:04:34,773 - DEBUG - Online update step: 43/50
2025-06-02 16:04:34,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:34,923 - DEBUG - Node anomaly scores shape: torch.Size([19640, 1])
2025-06-02 16:04:34,933 - DEBUG - Edge anomaly scores shape: torch.Size([41037, 1])
2025-06-02 16:04:34,934 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:35,207 - DEBUG - Step 43: Loss=0.5758
2025-06-02 16:04:35,207 - DEBUG - Online update step: 44/50
2025-06-02 16:04:35,210 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:35,332 - DEBUG - Node anomaly scores shape: torch.Size([18118, 1])
2025-06-02 16:04:35,337 - DEBUG - Edge anomaly scores shape: torch.Size([37782, 1])
2025-06-02 16:04:35,338 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:35,594 - DEBUG - Step 44: Loss=0.5803
2025-06-02 16:04:35,594 - DEBUG - Online update step: 45/50
2025-06-02 16:04:35,597 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:35,700 - DEBUG - Node anomaly scores shape: torch.Size([16451, 1])
2025-06-02 16:04:35,705 - DEBUG - Edge anomaly scores shape: torch.Size([33985, 1])
2025-06-02 16:04:35,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:35,917 - DEBUG - Step 45: Loss=0.5779
2025-06-02 16:04:35,918 - DEBUG - Online update step: 46/50
2025-06-02 16:04:35,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:36,178 - DEBUG - Node anomaly scores shape: torch.Size([20459, 1])
2025-06-02 16:04:36,243 - DEBUG - Edge anomaly scores shape: torch.Size([42927, 1])
2025-06-02 16:04:36,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:36,781 - DEBUG - Step 46: Loss=0.5797
2025-06-02 16:04:36,781 - DEBUG - Online update step: 47/50
2025-06-02 16:04:36,786 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:36,986 - DEBUG - Node anomaly scores shape: torch.Size([17451, 1])
2025-06-02 16:04:37,003 - DEBUG - Edge anomaly scores shape: torch.Size([36357, 1])
2025-06-02 16:04:37,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:37,335 - DEBUG - Step 47: Loss=0.5760
2025-06-02 16:04:37,335 - DEBUG - Online update step: 48/50
2025-06-02 16:04:37,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:37,707 - DEBUG - Node anomaly scores shape: torch.Size([18828, 1])
2025-06-02 16:04:37,722 - DEBUG - Edge anomaly scores shape: torch.Size([39246, 1])
2025-06-02 16:04:37,724 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:38,260 - DEBUG - Step 48: Loss=0.5805
2025-06-02 16:04:38,261 - DEBUG - Online update step: 49/50
2025-06-02 16:04:38,265 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:38,579 - DEBUG - Node anomaly scores shape: torch.Size([20486, 1])
2025-06-02 16:04:38,597 - DEBUG - Edge anomaly scores shape: torch.Size([42982, 1])
2025-06-02 16:04:38,598 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:39,103 - DEBUG - Step 49: Loss=0.5765
2025-06-02 16:04:39,103 - DEBUG - Online update step: 50/50
2025-06-02 16:04:39,107 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:39,344 - DEBUG - Node anomaly scores shape: torch.Size([19546, 1])
2025-06-02 16:04:39,361 - DEBUG - Edge anomaly scores shape: torch.Size([40970, 1])
2025-06-02 16:04:39,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:39,885 - DEBUG - Step 50: Loss=0.5795
2025-06-02 16:04:39,885 - INFO - Online update finished. Average loss: 0.5792, Learning rate: 0.001000
2025-06-02 16:04:39,886 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], current edge mean: [ 9.1479073e+00  1.4181396e+00  5.7032557e+00  4.8792641e-09
  1.3307083e-09  3.1049860e-09  4.4356946e-10  5.3228333e-09
 -1.7742778e-09 -8.8713892e-10]
2025-06-02 16:04:39,886 - DEBUG - Node drift difference: 0.0114, Edge drift difference: 0.0054
2025-06-02 16:04:39,887 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  7.2614794e-09  4.0664286e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  9.9240225e-09
  5.8091838e-09  2.7714647e-08  1.4522960e-09  1.3554762e-08
  2.2720811e+00  2.9614213e+00  1.4213198e-01  4.4060912e+00
 -2.9651041e-08  3.3949239e+00  5.8081217e+00  7.6182742e+00
  1.4213198e-01  7.9928932e+00 -4.8409865e-10 -3.3886906e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  1.3070664e-08  1.8879847e-08], edge=[ 9.1479073e+00  1.4181396e+00  5.7032557e+00  4.8792641e-09
  1.3307083e-09  3.1049860e-09  4.4356946e-10  5.3228333e-09
 -1.7742778e-09 -8.8713892e-10]
2025-06-02 16:04:39,888 - DEBUG - Updated reference std: node=[0.         0.         1.000508   1.000508   0.         0.
 0.         1.0005081  1.0005081  1.0005081  1.000508   1.000508
 0.9526825  0.2752198  0.36361656 0.57165736 1.000508   3.002603
 2.8995261  1.4748815  0.36361656 0.22303854 1.000508   1.0005081
 0.         0.         0.         0.         1.000508   1.000508  ], edge=[1.1102479 0.5054807 2.1401215 1.0002327 1.0002327 1.0002327 1.0002327
 1.0002326 1.0002327 1.0002326]
2025-06-02 16:04:39,891 - INFO - Online update complete. Loss: 0.5792
2025-06-02 16:04:39,892 - INFO - Running anomaly detection...
2025-06-02 16:04:39,892 - INFO - Starting anomaly detection.
2025-06-02 16:04:39,906 - DEBUG - Node reconstruction errors: [3.56449448e-02 5.36391258e-01 7.94564858e-02 4.12837276e-03
 2.66475640e-02 1.08700059e-02 1.87228784e-01 1.69950444e-02
 1.69950444e-02 1.71834510e-02 1.69950351e-02 5.51234605e-03
 4.20177549e-01 1.26381025e-01 2.08115438e-03 1.54977525e-02
 9.77061316e-03 1.54979108e-02 7.43024703e-03 1.50720142e-02
 1.76377688e-02 2.08115578e-03 2.58347169e-02 4.78104921e-03
 2.10753828e-03 3.78431519e-03 2.10747076e-03 3.34299766e-02
 1.67418402e-02 2.10747076e-03 8.20739493e-02 9.11310986e-02
 2.85653118e-02 3.97441210e-03 1.09473811e-02 2.56999824e-02
 5.95371276e-02 1.50719853e-02 4.64305878e-02 5.04664406e-02
 7.47212116e-03 1.88364391e-03 1.50719853e-02 9.17247403e-03
 1.02584222e-02 9.66751762e-03 1.52152432e-02 1.76135063e-01
 1.66857261e-02 8.72528255e-02 5.10439724e-02 5.62201580e-03
 3.40351393e-03 7.72852125e-03 1.71499867e-02 2.66378243e-02
 5.35846278e-02 1.50052691e-02 7.09412200e-03 1.41747268e-02
 1.20576158e-01 9.88707971e-03 1.78338063e-03 5.63777378e-03
 1.04348222e-02 1.71499588e-02 2.46029790e-03 1.71498992e-02
 1.78336899e-03 9.22878645e-03 2.00055521e-02 7.64905615e-03
 2.13728449e-03 1.62031371e-02 2.09522322e-02 7.64976209e-03
 1.11715598e-02 2.54882164e-02 1.25066908e-02 9.24230926e-03
 3.27014341e-03 1.96764674e-02 1.95183754e-01 4.21750657e-02
 1.17975743e-02 6.62289653e-03 3.65135781e-02 1.04114069e-02
 9.54298675e-03 8.43006596e-02 1.14034920e-03 3.05646826e-02
 1.77409721e-03 8.64733942e-03 4.84743575e-03 4.02832143e-02
 2.83612357e-03 8.03580601e-03 1.87775574e-03 1.80865899e-02
 4.59308736e-03 2.83609773e-03 4.64160927e-03 9.38236937e-02
 4.07358818e-03 1.85007136e-02 3.60841816e-03 2.48914659e-02
 1.66511221e-03 9.88853350e-02 5.85530363e-02 3.35418433e-03
 2.73003262e-02 3.08250394e-02 4.52787615e-03 1.44182984e-02
 4.31019906e-03 2.03260537e-02 7.90630840e-03 4.18799929e-03
 1.05157110e-03 1.73678691e-03 2.85830535e-02 3.91770201e-03
 1.19766984e-02 4.18594200e-03 2.53300974e-03 6.33659167e-03
 1.10716196e-02 2.95178150e-03 4.49381769e-03 2.86414032e-03
 1.13371961e-01 1.05089948e-01 3.92295467e-03 1.70221459e-02
 6.60587335e-03 1.68822438e-03 9.63884667e-02 2.63345595e-02
 3.36210127e-03 3.79133821e-02 1.15986913e-03 3.02973459e-03
 3.89313209e-03 6.62104599e-03 4.30768495e-03 9.48286578e-02
 4.95280884e-03 1.08090499e-02 1.97443187e-01 5.27088903e-03
 1.31677939e-02 2.86414032e-03 2.52422933e-02 2.09752563e-02
 1.86184305e-03 3.13686803e-02 4.59301984e-03 4.80733672e-03
 3.36203608e-03 3.73604288e-03 1.86184223e-03 4.49381350e-03
 3.86049668e-03 2.29908880e-02 8.54813214e-03 7.90300593e-03
 3.88737489e-03 1.07066305e-02 9.10909753e-03 4.14547371e-03
 1.07770774e-03 2.16537844e-02 7.90978316e-03 3.38134775e-03
 9.65651684e-03 2.67629735e-02 3.85937886e-03 3.85931833e-03
 1.88234113e-02 2.48814537e-03 4.82177548e-03 4.04433422e-02
 3.54501829e-02 7.66861346e-03 1.15673849e-03 1.61870494e-02
 1.72613356e-02 3.29130259e-03 2.75912508e-02 9.66011267e-03
 4.29361034e-03 2.07126094e-03 9.63840932e-02 2.56834645e-03
 2.31622905e-01 3.88000417e-03 2.76840348e-02 4.84229811e-03
 3.22415004e-03 1.86186261e-03 2.45477278e-02 1.16791520e-02
 9.36683733e-03 3.48456902e-03 1.74817722e-02 9.11179334e-02
 2.15033232e-03 1.28449714e-02 3.46473558e-03 1.07996734e-02
 2.50926660e-03 1.61004085e-02 9.45586525e-03 1.20031286e-03
 1.20348269e-02 4.31061024e-03 7.98194259e-02 3.82483401e-03
 3.75564285e-02 1.15673698e-03 9.74259397e-04 2.50926660e-03
 1.86184491e-03 1.53134828e-02 1.81916617e-02 2.32081511e-03
 1.33718401e-02 2.63375184e-03 2.47571617e-03 1.57985669e-02
 1.12049589e-02 4.30899765e-03 4.31035738e-03 2.10133800e-03
 9.82950535e-03 9.74259397e-04 1.86184095e-03 5.30668581e-03
 1.98149513e-02 1.17504764e-02 3.16672167e-03 1.21218283e-02
 2.19441252e-03 1.30084706e-02 1.74674112e-02 2.02680845e-02
 3.16672167e-03 2.22036988e-03 1.07770774e-03 1.04874128e-03
 7.98180476e-02 9.30470321e-03 1.07761184e-02 2.20116619e-02
 1.74645719e-03 2.64235935e-03 3.12253577e-03 3.85935884e-03
 1.22320373e-02 4.11499012e-03 1.07914209e-02 4.79995925e-03
 1.19955037e-02 4.25649574e-03 6.19326346e-03 5.66122569e-02
 6.19654823e-03 1.39647555e-02 7.00326785e-02 3.29561941e-02
 1.18884733e-02 7.63640460e-03 7.81047996e-03 5.03934398e-02
 7.87209487e-04 3.57278995e-02 1.88234486e-02 7.03861285e-03
 7.58823529e-02 7.51128187e-04 8.36211257e-03 6.16385322e-03
 1.48745216e-02 4.58178110e-03 7.57301599e-02 5.49976015e-03
 2.48814700e-03 5.56798698e-03 4.17785160e-03 2.67722714e-03
 3.94650176e-02 2.19442346e-03 1.07582040e-01 3.09457886e-03
 1.00369630e-02 3.89460707e-03 2.56830547e-03 6.73214998e-03
 7.51739228e-03 5.87158510e-03 7.56532047e-03 7.94459693e-03
 1.81550393e-03 1.81550730e-03 1.81550521e-03 7.84505066e-03
 4.95315297e-03 5.87158510e-03 1.81550905e-03 2.26881523e-02
 1.81550905e-03 2.85676774e-03 5.31861279e-03 1.08931409e-02
 8.67587104e-02 1.96223217e-03 2.39762780e-03 2.67496356e-03
 1.56152882e-02 4.55515319e-03 9.26045515e-03 7.56528415e-03
 2.40653418e-02 3.64539586e-02 1.14437826e-01 1.27711836e-02
 1.27760358e-02 1.27728451e-02 8.27086419e-02 2.47493666e-03
 1.81556202e-03 7.81092839e-03 1.81550905e-03 7.84624089e-03
 4.75897314e-03 9.16688761e-04 6.59909239e-03 1.95188471e-03
 5.87355671e-03 2.78250827e-03 1.95187784e-03 1.57894306e-02
 1.03270514e-02 1.05699366e-02 7.56441895e-03 4.53962525e-03
 6.48658676e-03 8.11068248e-03 1.81551173e-03 1.33806150e-02
 2.58759074e-02 9.67794470e-03 2.84287403e-03 1.74646720e-03
 6.38872106e-03 1.81550730e-03 1.72640872e-03 1.88270006e-02
 5.14984643e-03 3.25009972e-03 8.90131146e-02 1.29875671e-02
 7.53646623e-03 1.61401760e-02 9.32324911e-04 2.89478656e-02
 3.76143050e-03 3.40358866e-03 1.13711841e-02 1.16518689e-02
 1.11824973e-02 2.30110623e-02 1.07411621e-02 2.54840814e-02
 9.16771358e-04 3.90968891e-03 2.92806234e-02 1.81550521e-03
 7.56643014e-03 4.22035297e-03 2.38234550e-03 8.22792295e-03
 4.28981660e-03 8.95721372e-03 1.79148484e-02 3.33864288e-03
 1.61137469e-02 1.81551522e-03 6.54753596e-02 8.64164252e-03
 3.36395600e-03 2.66758874e-02 1.47273783e-02 1.47269517e-02
 1.47272712e-02 8.80819187e-03 1.95090123e-03 3.20283547e-02
 2.92437081e-03 2.78222263e-02 2.13829968e-02 1.95086119e-03
 6.14249846e-03 3.36279627e-03 1.10291922e-02 1.81106001e-03
 3.36406101e-03 2.48585735e-02 1.47269936e-02 3.36404215e-03
 1.95086037e-03 1.47269471e-02 1.47269173e-02 2.91178608e-03
 2.78236018e-03 1.47273950e-02 6.26993412e-03 1.78899313e-03
 1.92182534e-03 1.54866709e-03 3.34533607e-03 2.24186433e-03
 2.64027845e-02 2.36974447e-03 1.65566662e-03 4.60530352e-03
 6.36660028e-03 1.69295422e-03 5.97049482e-03 1.95197854e-02
 1.55176530e-02 1.83107182e-02 2.91482508e-02 1.47268735e-02
 1.58817274e-03 8.50651693e-03 2.79727411e-02 3.99121456e-03
 1.47292460e-03 3.55309690e-03 7.71165267e-02 8.86182592e-04
 1.95036514e-03 2.14523561e-02 3.37927826e-02 2.07940093e-03
 2.76731281e-03 2.20487290e-03 1.46031762e-02 9.22387582e-04
 2.33478518e-03 4.62169247e-03 9.22387582e-04 1.80652514e-02
 2.24198052e-03 2.26773997e-03 2.53841584e-03 8.67994782e-03
 3.59595171e-03 2.47607427e-03 2.19487678e-03 2.13708822e-03
 2.19445233e-03 2.47607497e-03 7.80381844e-04 5.10554621e-03
 5.10998489e-03 2.84905941e-03 7.80381844e-04 3.56940133e-03
 8.65231734e-03 5.69063090e-02 9.95037146e-03 3.15877912e-03
 5.09936921e-03 3.59595241e-03 8.89542454e-04 2.71250308e-03
 2.48066126e-03 8.94301981e-02 1.57154666e-03 2.07934226e-03
 2.50878874e-02 1.08392839e-03 9.22387582e-04 5.52096684e-03
 1.12142526e-02 5.69199249e-02 1.40969837e-02 8.89542163e-04
 8.75246618e-03 9.72811540e-04 1.22535797e-02 2.33623525e-03
 3.44670843e-03 2.77537387e-02 2.12885835e-03 2.71250750e-03
 7.81235322e-02 9.72779293e-04 8.01810399e-02 6.96348143e-04
 7.68188096e-04 1.76647294e-03 2.19930708e-03 9.36965644e-02
 1.99723197e-03 9.22387582e-04 1.49783422e-03 3.16525390e-03
 3.16525227e-03 9.45584092e-04 1.18481778e-02 1.29196723e-03
 2.19960953e-03 8.17619637e-03 3.77980876e-03 1.30449561e-02
 1.64975524e-02 3.55299120e-03 2.19929428e-03 6.13770075e-03
 7.68188678e-04 3.45240394e-03 3.77617241e-03 2.95528327e-03
 1.64081063e-02 7.66877364e-03 1.29196723e-03 8.93540867e-03
 2.12885742e-03 2.71249982e-03 3.44341085e-03 3.22063686e-03
 1.26317479e-02 8.77280161e-03 2.12886510e-03 1.63241792e-02
 2.12886510e-03 7.69533217e-03 3.49740149e-03 8.16855393e-03
 2.90042162e-03 1.27380081e-02 5.81720518e-03 2.05767411e-03
 2.02237874e-01 2.05768482e-03 2.05768109e-03 2.05768109e-03
 2.05768482e-03 2.05768482e-03 2.05768109e-03 2.05768109e-03
 8.43928475e-03 2.82532210e-03 1.13888290e-02 2.05768901e-03
 2.05768482e-03 2.05768435e-03 2.05768482e-03 2.05768482e-03
 2.05768482e-03 2.05768435e-03 2.05768482e-03 2.05768482e-03
 8.38992000e-03 2.05769786e-03 2.05768482e-03 2.76456363e-02
 2.05768482e-03 2.81489152e-03 1.35056283e-02 2.12886184e-03
 1.29771195e-02 1.68227982e-02 1.07813897e-02 1.07813897e-02
 8.61407537e-03 1.29771195e-02 2.12885975e-03 2.19929335e-03
 2.19928520e-03 4.67489380e-03 2.19931197e-03 4.06210963e-03
 2.86397920e-03 2.05788040e-03 3.55295767e-03 2.12886930e-03
 3.16528697e-03 2.12886930e-03 2.12885742e-03 3.59905511e-03
 2.12886767e-03 2.19929335e-03 2.12885789e-03 2.12885975e-03
 1.79568455e-02 2.19930056e-03 2.12885975e-03 2.19931034e-03
 2.12886254e-03 2.12885835e-03 2.12886184e-03 5.74334292e-03
 1.01431711e-02 3.27301375e-03 2.05768482e-03 1.78112220e-02
 1.32978102e-02 2.12885742e-03 2.19931197e-03 6.66887593e-03
 2.05770088e-03 3.07407975e-03 1.11919511e-02 2.23133666e-03
 2.12885835e-03 2.12886184e-03 1.15155261e-02 5.77013940e-03
 3.46921175e-03 2.12888280e-03 8.43936298e-03 2.41997000e-03
 2.19929055e-03 3.98365641e-03 2.05768482e-03 4.27812291e-03
 9.18735377e-03 2.05768435e-03 2.05773208e-03 8.43929313e-03
 2.41989270e-03 2.12885742e-03 9.73568931e-02 9.97055601e-03
 7.61300186e-03 5.77150472e-03 1.27620494e-03 1.29598621e-02
 1.29600270e-02 1.34738497e-02 9.57878365e-04 2.05768482e-03
 3.01826256e-03 1.44937141e-02 5.77086303e-03 2.99267541e-03
 1.06800301e-03 1.15232007e-03 1.92537205e-03 1.92537205e-03
 1.92536670e-03 1.92536775e-03 1.92537205e-03 8.59396346e-03
 1.36558795e-02 1.92537205e-03 1.92536856e-03 2.05768435e-03
 2.28836178e-03 2.05768109e-03 1.29601676e-02 1.21037085e-02
 2.41977368e-02 2.89367954e-03 1.85547639e-02 1.56045370e-02
 8.39008577e-03 2.73134443e-03 8.39042291e-03 2.05768482e-03
 1.29606286e-02 7.31683976e-04 2.05362658e-03 2.05362192e-03
 1.92537205e-03 7.31690670e-04 8.01318604e-03 3.66916182e-03
 2.84082303e-03 2.05768482e-03 1.92536670e-03 1.33719738e-03
 2.05362262e-03 4.49375622e-03 7.68678321e-04 1.43330742e-03
 8.59407708e-03 6.22950196e-02 7.94445048e-04 4.29060869e-02
 3.14009655e-03 7.68680009e-04 1.28123106e-03 6.96886680e-04
 6.96410600e-04 7.52074528e-04 1.18672205e-02 2.62286537e-03
 1.23516861e-02 7.68677623e-04 7.68679834e-04 7.68677623e-04
 7.18390336e-04 1.33719773e-03 7.68677623e-04 6.96410600e-04
 7.68677623e-04 7.68677623e-04 7.68678903e-04 3.44750262e-03
 6.77832169e-04 1.21923797e-02 9.64712910e-03 1.33492192e-02
 1.50508489e-02 1.53139804e-03 7.45589333e-03 1.28208436e-02
 6.35918346e-04 6.78899698e-04 7.09492830e-04 2.05048826e-02
 1.90653410e-02 6.96410600e-04 1.98988840e-02 8.35743770e-02
 6.35941862e-04 1.69996789e-03 1.73982279e-03 2.05554850e-02
 6.89711014e-04 6.89711014e-04 6.89711014e-04 1.60302012e-03
 5.56012732e-04 2.79579055e-03 2.22530384e-02 7.95474127e-02
 1.90577144e-03 6.37561781e-04 2.87382910e-03 1.69995509e-03
 1.72417436e-03 4.14613169e-03 6.01112435e-04 2.32674205e-03
 6.35941862e-04 8.38614404e-02 1.69995509e-03 4.17282106e-03
 6.37544901e-04 6.98736450e-03 6.89711014e-04 1.60301931e-03
 6.01114531e-04 3.37908859e-03 1.94416605e-02 1.60302012e-03
 1.60301488e-03 1.60301046e-03 7.49495160e-03 1.40785888e-01
 8.25941145e-01 6.89711014e-04 3.61361690e-02 1.60301581e-03
 1.28718978e-02 2.40856665e-03 1.86659005e-02 3.37353977e-03
 1.60301174e-03 1.54645008e-03 2.50871968e-03 5.87267277e-04
 2.65344411e-01 3.37562314e-03 2.58509312e-02 3.03121563e-03
 6.93593360e-03 3.37337377e-03 1.10291680e-02 1.98170040e-02
 5.01260580e-03 2.00463757e-02 9.95114353e-03 5.57992898e-04
 5.57984109e-04 4.62223999e-02 1.01217732e-01 8.56467523e-03
 3.37337423e-03 5.01261232e-03 3.37339053e-03 5.43893548e-04
 5.46896248e-04 5.46896248e-04 5.31213183e-04 9.42093320e-03
 6.91467372e-04 5.46896248e-04 5.43887785e-04 4.20670118e-03
 5.46896248e-04 5.46896248e-04 1.52191496e-03 1.28400896e-03
 7.91078061e-03 1.47806266e-02 5.46896248e-04 5.64664416e-03
 4.20670118e-03 5.46896248e-04 5.51789242e-04 1.33144413e-03
 6.05684007e-04 6.05684007e-04 7.85455480e-03 1.48313714e-03
 5.46896248e-04 1.48313364e-03 1.39592856e-03 1.51466327e-02
 2.12428756e-02 5.46896248e-04 1.00885727e-01 1.42218184e-03
 1.42218941e-03 2.73111602e-03 1.51536136e-03 1.78967614e-03
 5.51788427e-04 1.62575964e-03 5.22235525e-04 2.05680300e-02
 2.36928370e-03 2.05680430e-02 8.36737975e-02 5.56607672e-04
 2.36928370e-03 1.52975169e-03 1.52975169e-03 1.83136947e-02
 1.52975391e-03 2.54776189e-03 1.51521212e-03 2.04812046e-02
 2.60493229e-03 5.56608255e-04 2.60486081e-03 4.36665956e-03
 1.49470037e-02 9.05179139e-03 1.52975565e-03 2.50297529e-03
 2.80536967e-03 1.52975565e-03 8.17741547e-03 4.71859202e-02
 1.64380565e-03 5.56610466e-04 1.52975298e-03 9.65687931e-02
 2.28475803e-03 2.06290791e-03 1.52975391e-03 5.75046812e-04
 1.29510816e-02 5.75048907e-04 2.06742203e-03 5.75052749e-04
 8.50929413e-03 1.25382282e-02 1.58221517e-02 1.52975298e-03
 2.28475570e-03 2.28476967e-03 1.52975298e-03 6.92072958e-02
 2.06300034e-03 5.75046812e-04 2.28474825e-03 1.52975169e-03
 2.28475663e-03 5.24794310e-03 2.28478387e-03 1.52975298e-03
 1.59858516e-03 2.06296449e-03 6.14974881e-04 2.56662611e-02
 1.59858481e-03 2.28476129e-03 1.52975146e-03 3.24465008e-03
 1.18078729e-02 1.23365941e-02 1.23407701e-02 1.57795520e-03
 2.03492846e-02 2.20840634e-03 1.74790248e-03 1.37232274e-01
 1.23396572e-02 6.47768495e-04 1.23406434e-02 2.30759010e-03
 1.74788758e-03 1.23391412e-02 1.68117555e-03 6.14974007e-04
 2.28954642e-03 1.94161211e-03 7.70120823e-04 1.76321086e-03
 1.85612880e-03 1.03644328e-03 1.76777679e-03 1.76780485e-03
 1.15764085e-02 2.04182342e-02 1.76784000e-03 1.76777772e-03
 1.89481359e-02 1.95242465e-02 1.76777772e-03 1.76777679e-03
 1.76777446e-03 1.76778075e-03 2.04140861e-02 2.04177126e-02
 2.04180349e-02 2.04167087e-02 2.22184584e-02 3.36202886e-03
 2.04180516e-02 2.04180591e-02 2.04088502e-02 1.76777772e-03
 1.72604412e-01 2.04082262e-02 1.16247952e-03 2.04114746e-02
 8.53749109e-04 1.85223820e-03 3.26799043e-02 1.76777365e-03
 1.64901502e-02 1.85225729e-03 3.25278495e-03 1.81333777e-02
 1.81311052e-02 1.28756685e-03 1.81356277e-02 1.81356929e-02
 9.07621114e-04 2.35726479e-02 2.26106066e-02 2.06501829e-03
 2.06501386e-03 2.06503621e-03 2.06503808e-03 2.06501805e-03
 2.06501829e-03 3.98302451e-02 2.26240456e-02 1.28743553e-03
 1.89494919e-02 2.06502038e-03 4.50118165e-03 2.06502038e-03
 2.26193946e-02 1.53664558e-03 3.50805838e-03 2.24788226e-02
 2.26221979e-02 2.26238165e-02 3.70803731e-03 2.06502038e-03
 2.26181652e-02]
2025-06-02 16:04:39,907 - DEBUG - Edge reconstruction errors: [1.364422   1.3617252  0.9577066  ... 0.15768987 1.258636   0.15768987]
2025-06-02 16:04:39,909 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160439_update_46.json
2025-06-02 16:04:39,909 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:04:39,918 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160439_update_46.pth and as latest_checkpoint.pth
2025-06-02 16:04:39,918 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870475.dot): 0.1099
2025-06-02 16:04:39,918 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:04:39,918 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.5364, MLP Score: 0.5136
2025-06-02 16:04:39,918 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1872, MLP Score: 0.4905
2025-06-02 16:04:39,918 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.4202, MLP Score: 0.4828
2025-06-02 16:04:39,918 - WARNING -   Node ID: 8.8.8.8, Recon Error: 0.1264, MLP Score: 0.4924
2025-06-02 16:04:39,919 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1761, MLP Score: 0.4908
2025-06-02 16:04:39,919 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:04:39,919 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 21.4137, MLP Score: 0.4907
2025-06-02 16:04:39,919 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 17.4430, MLP Score: 0.4740
2025-06-02 16:04:39,919 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4883, MLP Score: 0.4797
2025-06-02 16:04:39,919 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.4052, MLP Score: 0.3161
2025-06-02 16:04:39,919 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.8215, MLP Score: 0.4770
2025-06-02 16:04:39,926 - DEBUG - Embedding standard deviations before t-SNE: [1.692735   1.0299108  0.817749   0.7635181  1.0439693  0.
 2.4036386  0.         1.5627408  1.5576344  1.615077   0.13926722
 0.06435581 1.4561033  0.         0.         1.2152573  0.18714295
 0.         0.00688399 0.09580144 1.3720181  0.5340899  0.59791315
 0.26040122 0.86967593 0.70248604 0.9969065  0.9047826  1.5596882
 1.5316277  0.4071887 ]
2025-06-02 16:04:40,939 - INFO - Embeddings visualization saved to vis/embeddings_46_updates_20250602_160439.png
2025-06-02 16:04:40,939 - INFO - Performing visualization of node and edge features.
2025-06-02 16:04:40,941 - INFO - Starting visualization of node features.
2025-06-02 16:04:40,941 - INFO - Graph has 985 nodes and 30 features.
2025-06-02 16:04:40,941 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 16:04:40,941 - INFO - Calculating feature statistics:
2025-06-02 16:04:40,941 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,941 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,942 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(3.0982314e-08), 'std': np.float32(1.0), 'min': np.float32(-1.7551239), 'max': np.float32(2.4481673)}
2025-06-02 16:04:40,942 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3552341), 'max': np.float32(1.85407)}
2025-06-02 16:04:40,942 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,942 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,942 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,942 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-0.45509103), 'max': np.float32(2.1973627)}
2025-06-02 16:04:40,942 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.1244411), 'max': np.float32(0.8893307)}
2025-06-02 16:04:40,942 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.349739), 'max': np.float32(0.10923729)}
2025-06-02 16:04:40,942 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 24, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.3229966), 'max': np.float32(1.4913315)}
2025-06-02 16:04:40,942 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 24, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.4571143), 'max': np.float32(2.4393346)}
2025-06-02 16:04:40,943 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 9, 'mean': np.float32(2.2720811), 'std': np.float32(0.95219874), 'min': np.float32(0.0), 'max': np.float32(11.0)}
2025-06-02 16:04:40,943 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9614213), 'std': np.float32(0.27508003), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 16:04:40,943 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:04:40,943 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.406091), 'std': np.float32(0.57136714), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 16:04:40,943 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.4855102e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.10923729), 'max': np.float32(9.349739)}
2025-06-02 16:04:40,943 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.394924), 'std': np.float32(3.0010784), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 16:04:40,943 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.8081217), 'std': np.float32(2.8980536), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:04:40,943 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.618274), 'std': np.float32(1.4741325), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:04:40,943 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14213198), 'std': np.float32(0.36343193), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:04:40,944 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.992893), 'std': np.float32(0.22292528), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:04:40,944 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(3.872789e-09), 'std': np.float32(1.0), 'min': np.float32(-0.12862214), 'max': np.float32(16.396528)}
2025-06-02 16:04:40,944 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-2.9045918e-08), 'std': np.float32(1.0), 'min': np.float32(-0.14024527), 'max': np.float32(7.1303654)}
2025-06-02 16:04:40,944 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,944 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,944 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,944 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:04:40,944 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(7.745578e-09), 'std': np.float32(1.0), 'min': np.float32(-0.9681856), 'max': np.float32(10.4042845)}
2025-06-02 16:04:40,944 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(1.5491157e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0705417), 'max': np.float32(4.459967)}
2025-06-02 16:04:40,958 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1ad0140>
2025-06-02 16:04:41,143 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 16:04:41,595 - DEBUG - Plotted ranges of node feature values.
2025-06-02 16:04:41,631 - DEBUG - Plotted sparsity of node features.
2025-06-02 16:04:43,652 - INFO - Node feature visualization saved to vis/node_features_20250602_160441.png
2025-06-02 16:04:43,653 - INFO - Finished visualization of node features.
2025-06-02 16:04:43,653 - INFO - Performing additional feature analysis:
2025-06-02 16:04:43,653 - INFO - - Maximum correlation between different features: nan
2025-06-02 16:04:43,655 - INFO - Starting visualization of edge features.
2025-06-02 16:04:43,655 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 16:04:43,655 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:04:43,655 - INFO - Calculating edge feature statistics:
2025-06-02 16:04:43,656 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 16:04:43,656 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.147907), 'std': np.float32(1.1099896), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-02 16:04:43,656 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4181396), 'std': np.float32(0.5053631), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:04:43,656 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.7032557), 'std': np.float32(2.1396236), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 16:04:43,656 - INFO - - service: {'name': 'service', 'unique': 38, 'mean': np.float32(3.5485557e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.035350062), 'max': np.float32(35.62755)}
2025-06-02 16:04:43,656 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1444, 'mean': np.float32(-2.6614166e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05988589), 'max': np.float32(29.227173)}
2025-06-02 16:04:43,656 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1519, 'mean': np.float32(-1.7742778e-09), 'std': np.float32(1.0), 'min': np.float32(-0.05659186), 'max': np.float32(32.76064)}
2025-06-02 16:04:43,656 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 500, 'mean': np.float32(-1.7742778e-09), 'std': np.float32(1.0), 'min': np.float32(-0.0443943), 'max': np.float32(35.47036)}
2025-06-02 16:04:43,656 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1493, 'mean': np.float32(2.6614166e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08654886), 'max': np.float32(29.027)}
2025-06-02 16:04:43,656 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1521, 'mean': np.float32(-1.7742778e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08664058), 'max': np.float32(28.039663)}
2025-06-02 16:04:43,656 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 547, 'mean': np.float32(-8.871389e-10), 'std': np.float32(1.0), 'min': np.float32(-0.053714637), 'max': np.float32(34.84866)}
2025-06-02 16:04:43,676 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a099f27320>
2025-06-02 16:04:43,823 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 16:04:43,840 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a09f5e20>
2025-06-02 16:04:44,019 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 16:04:44,242 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 16:04:44,462 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 16:04:44,486 - DEBUG - Plotted sparsity of edge features.
2025-06-02 16:04:44,497 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 16:04:46,828 - INFO - Edge feature visualization saved to vis/edge_features_20250602_160444.png
2025-06-02 16:04:46,829 - INFO - Finished visualization of edge features.
2025-06-02 16:04:46,829 - INFO - Performing additional edge feature analysis:
2025-06-02 16:04:46,829 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 16:04:46,832 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 16:04:46,832 - INFO - Graph has 2150 edges and 10 edge features.
2025-06-02 16:04:46,832 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:04:47,377 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_160446_summary.png
2025-06-02 16:04:47,834 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_160446_pca_3d.png
2025-06-02 16:04:48,116 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_160446_pca_variance.png
2025-06-02 16:04:48,116 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 16:04:48,116 - INFO - 
--- Processing file: nw_graph_encoded_1748870505.dot (Timestamp: 2025-06-02 15:21:45) ---
2025-06-02 16:04:48,116 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 16:04:48,116 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 16:04:48,146 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 16:04:48,178 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 16:04:48,178 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 16:04:48,179 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870505.dot
2025-06-02 16:04:48,209 - INFO - Parsed 994 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 16:04:48,243 - INFO - Parsed 2170 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870505.dot'.
2025-06-02 16:04:48,243 - INFO - Processing node updates/additions.
2025-06-02 16:04:48,251 - INFO - Processing edge updates/additions.
2025-06-02 16:04:48,271 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:04:48,273 - INFO - Finished updating NetworkX graph.
2025-06-02 16:04:48,273 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:04:48,275 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:04:48,291 - DEBUG - Initial node features tensor shape: torch.Size([994, 30])
2025-06-02 16:04:48,293 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:04:48,294 - DEBUG - Node features tensor shape after scaling: torch.Size([994, 30])
2025-06-02 16:04:48,297 - DEBUG - Edge index tensor shape: torch.Size([2, 2170])
2025-06-02 16:04:48,299 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:04:48,308 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:04:48,310 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:04:48,312 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:04:48,315 - DEBUG - Shape of encoded categorical edge features: torch.Size([2170, 3])
2025-06-02 16:04:48,316 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:04:48,316 - DEBUG - Shape of scaled numerical edge features: torch.Size([2170, 7])
2025-06-02 16:04:48,316 - DEBUG - Final edge attributes tensor shape: torch.Size([2170, 10])
2025-06-02 16:04:48,317 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:04:48,322 - INFO - Performing online update...
2025-06-02 16:04:48,322 - INFO - Starting online update for 50 steps.
2025-06-02 16:04:48,323 - DEBUG - Updated RunningStats: new_mean=0.944865281087555, new_var=27000000000161.66, new_n=2730
2025-06-02 16:04:48,324 - DEBUG - Updated RunningStats: new_mean=0.9426092598686419, new_var=27300000000018.19, new_n=2760
2025-06-02 16:04:48,324 - DEBUG - Updated RunningStats: new_mean=1.1514845209981157, new_var=9000000000094.082, new_n=910
2025-06-02 16:04:48,324 - DEBUG - Updated RunningStats: new_mean=1.1506583636734893, new_var=9100000000001.55, new_n=920
2025-06-02 16:04:48,324 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:04:48,324 - DEBUG - Online update step: 1/50
2025-06-02 16:04:48,329 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:48,697 - DEBUG - Node anomaly scores shape: torch.Size([21915, 1])
2025-06-02 16:04:48,730 - DEBUG - Edge anomaly scores shape: torch.Size([46376, 1])
2025-06-02 16:04:48,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:49,281 - DEBUG - Step 1: Loss=0.5757
2025-06-02 16:04:49,281 - DEBUG - Online update step: 2/50
2025-06-02 16:04:49,284 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:49,432 - DEBUG - Node anomaly scores shape: torch.Size([19309, 1])
2025-06-02 16:04:49,438 - DEBUG - Edge anomaly scores shape: torch.Size([40262, 1])
2025-06-02 16:04:49,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:49,762 - DEBUG - Step 2: Loss=0.5796
2025-06-02 16:04:49,762 - DEBUG - Online update step: 3/50
2025-06-02 16:04:49,766 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:49,912 - DEBUG - Node anomaly scores shape: torch.Size([20998, 1])
2025-06-02 16:04:49,920 - DEBUG - Edge anomaly scores shape: torch.Size([44044, 1])
2025-06-02 16:04:49,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:50,262 - DEBUG - Step 3: Loss=0.5766
2025-06-02 16:04:50,262 - DEBUG - Online update step: 4/50
2025-06-02 16:04:50,266 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:50,403 - DEBUG - Node anomaly scores shape: torch.Size([20349, 1])
2025-06-02 16:04:50,409 - DEBUG - Edge anomaly scores shape: torch.Size([42812, 1])
2025-06-02 16:04:50,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:50,706 - DEBUG - Step 4: Loss=0.5792
2025-06-02 16:04:50,707 - DEBUG - Online update step: 5/50
2025-06-02 16:04:50,712 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:50,883 - DEBUG - Node anomaly scores shape: torch.Size([20641, 1])
2025-06-02 16:04:50,891 - DEBUG - Edge anomaly scores shape: torch.Size([43494, 1])
2025-06-02 16:04:50,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:51,323 - DEBUG - Step 5: Loss=0.5755
2025-06-02 16:04:51,323 - DEBUG - Online update step: 6/50
2025-06-02 16:04:51,326 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:51,467 - DEBUG - Node anomaly scores shape: torch.Size([20230, 1])
2025-06-02 16:04:51,471 - DEBUG - Edge anomaly scores shape: torch.Size([42691, 1])
2025-06-02 16:04:51,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:51,695 - DEBUG - Step 6: Loss=0.5801
2025-06-02 16:04:51,695 - DEBUG - Online update step: 7/50
2025-06-02 16:04:51,698 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:51,814 - DEBUG - Node anomaly scores shape: torch.Size([18043, 1])
2025-06-02 16:04:51,819 - DEBUG - Edge anomaly scores shape: torch.Size([37896, 1])
2025-06-02 16:04:51,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:52,039 - DEBUG - Step 7: Loss=0.5773
2025-06-02 16:04:52,040 - DEBUG - Online update step: 8/50
2025-06-02 16:04:52,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:52,139 - DEBUG - Node anomaly scores shape: torch.Size([16771, 1])
2025-06-02 16:04:52,143 - DEBUG - Edge anomaly scores shape: torch.Size([34845, 1])
2025-06-02 16:04:52,144 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:52,368 - DEBUG - Step 8: Loss=0.5802
2025-06-02 16:04:52,368 - DEBUG - Online update step: 9/50
2025-06-02 16:04:52,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:52,489 - DEBUG - Node anomaly scores shape: torch.Size([20069, 1])
2025-06-02 16:04:52,495 - DEBUG - Edge anomaly scores shape: torch.Size([41915, 1])
2025-06-02 16:04:52,496 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:52,725 - DEBUG - Step 9: Loss=0.5759
2025-06-02 16:04:52,726 - DEBUG - Online update step: 10/50
2025-06-02 16:04:52,729 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:52,844 - DEBUG - Node anomaly scores shape: torch.Size([18737, 1])
2025-06-02 16:04:52,849 - DEBUG - Edge anomaly scores shape: torch.Size([39174, 1])
2025-06-02 16:04:52,850 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:53,068 - DEBUG - Step 10: Loss=0.5796
2025-06-02 16:04:53,068 - DEBUG - Online update step: 11/50
2025-06-02 16:04:53,072 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:53,196 - DEBUG - Node anomaly scores shape: torch.Size([19658, 1])
2025-06-02 16:04:53,201 - DEBUG - Edge anomaly scores shape: torch.Size([41252, 1])
2025-06-02 16:04:53,202 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:53,468 - DEBUG - Step 11: Loss=0.5761
2025-06-02 16:04:53,469 - DEBUG - Online update step: 12/50
2025-06-02 16:04:53,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:53,571 - DEBUG - Node anomaly scores shape: torch.Size([17520, 1])
2025-06-02 16:04:53,575 - DEBUG - Edge anomaly scores shape: torch.Size([36460, 1])
2025-06-02 16:04:53,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:53,768 - DEBUG - Step 12: Loss=0.5800
2025-06-02 16:04:53,768 - DEBUG - Online update step: 13/50
2025-06-02 16:04:53,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:53,872 - DEBUG - Node anomaly scores shape: torch.Size([18637, 1])
2025-06-02 16:04:53,876 - DEBUG - Edge anomaly scores shape: torch.Size([38999, 1])
2025-06-02 16:04:53,877 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:54,078 - DEBUG - Step 13: Loss=0.5764
2025-06-02 16:04:54,079 - DEBUG - Online update step: 14/50
2025-06-02 16:04:54,086 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:54,199 - DEBUG - Node anomaly scores shape: torch.Size([19621, 1])
2025-06-02 16:04:54,206 - DEBUG - Edge anomaly scores shape: torch.Size([41130, 1])
2025-06-02 16:04:54,207 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:54,458 - DEBUG - Step 14: Loss=0.5793
2025-06-02 16:04:54,458 - DEBUG - Online update step: 15/50
2025-06-02 16:04:54,461 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:54,547 - DEBUG - Node anomaly scores shape: torch.Size([16309, 1])
2025-06-02 16:04:54,551 - DEBUG - Edge anomaly scores shape: torch.Size([33730, 1])
2025-06-02 16:04:54,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:54,738 - DEBUG - Step 15: Loss=0.5774
2025-06-02 16:04:54,738 - DEBUG - Online update step: 16/50
2025-06-02 16:04:54,741 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:54,833 - DEBUG - Node anomaly scores shape: torch.Size([18604, 1])
2025-06-02 16:04:54,838 - DEBUG - Edge anomaly scores shape: torch.Size([38632, 1])
2025-06-02 16:04:54,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:55,056 - DEBUG - Step 16: Loss=0.5792
2025-06-02 16:04:55,057 - DEBUG - Online update step: 17/50
2025-06-02 16:04:55,063 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:55,170 - DEBUG - Node anomaly scores shape: torch.Size([18465, 1])
2025-06-02 16:04:55,175 - DEBUG - Edge anomaly scores shape: torch.Size([38424, 1])
2025-06-02 16:04:55,177 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:55,400 - DEBUG - Step 17: Loss=0.5748
2025-06-02 16:04:55,401 - DEBUG - Online update step: 18/50
2025-06-02 16:04:55,404 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:55,505 - DEBUG - Node anomaly scores shape: torch.Size([18406, 1])
2025-06-02 16:04:55,517 - DEBUG - Edge anomaly scores shape: torch.Size([38458, 1])
2025-06-02 16:04:55,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:55,743 - DEBUG - Step 18: Loss=0.5797
2025-06-02 16:04:55,744 - DEBUG - Online update step: 19/50
2025-06-02 16:04:55,751 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:55,866 - DEBUG - Node anomaly scores shape: torch.Size([19425, 1])
2025-06-02 16:04:55,873 - DEBUG - Edge anomaly scores shape: torch.Size([40794, 1])
2025-06-02 16:04:55,874 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:56,117 - DEBUG - Step 19: Loss=0.5757
2025-06-02 16:04:56,117 - DEBUG - Online update step: 20/50
2025-06-02 16:04:56,123 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:56,216 - DEBUG - Node anomaly scores shape: torch.Size([18062, 1])
2025-06-02 16:04:56,222 - DEBUG - Edge anomaly scores shape: torch.Size([37709, 1])
2025-06-02 16:04:56,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:56,476 - DEBUG - Step 20: Loss=0.5792
2025-06-02 16:04:56,476 - DEBUG - Online update step: 21/50
2025-06-02 16:04:56,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:56,583 - DEBUG - Node anomaly scores shape: torch.Size([19248, 1])
2025-06-02 16:04:56,588 - DEBUG - Edge anomaly scores shape: torch.Size([40246, 1])
2025-06-02 16:04:56,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:56,809 - DEBUG - Step 21: Loss=0.5762
2025-06-02 16:04:56,809 - DEBUG - Online update step: 22/50
2025-06-02 16:04:56,812 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:56,917 - DEBUG - Node anomaly scores shape: torch.Size([20132, 1])
2025-06-02 16:04:56,922 - DEBUG - Edge anomaly scores shape: torch.Size([42246, 1])
2025-06-02 16:04:56,923 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:57,155 - DEBUG - Step 22: Loss=0.5783
2025-06-02 16:04:57,155 - DEBUG - Online update step: 23/50
2025-06-02 16:04:57,158 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:57,275 - DEBUG - Node anomaly scores shape: torch.Size([19710, 1])
2025-06-02 16:04:57,280 - DEBUG - Edge anomaly scores shape: torch.Size([41326, 1])
2025-06-02 16:04:57,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:57,534 - DEBUG - Step 23: Loss=0.5760
2025-06-02 16:04:57,534 - DEBUG - Online update step: 24/50
2025-06-02 16:04:57,540 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:57,638 - DEBUG - Node anomaly scores shape: torch.Size([19056, 1])
2025-06-02 16:04:57,642 - DEBUG - Edge anomaly scores shape: torch.Size([39905, 1])
2025-06-02 16:04:57,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:57,858 - DEBUG - Step 24: Loss=0.5788
2025-06-02 16:04:57,858 - DEBUG - Online update step: 25/50
2025-06-02 16:04:57,861 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:57,972 - DEBUG - Node anomaly scores shape: torch.Size([20498, 1])
2025-06-02 16:04:57,978 - DEBUG - Edge anomaly scores shape: torch.Size([43121, 1])
2025-06-02 16:04:57,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:58,207 - DEBUG - Step 25: Loss=0.5739
2025-06-02 16:04:58,208 - DEBUG - Online update step: 26/50
2025-06-02 16:04:58,211 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:58,315 - DEBUG - Node anomaly scores shape: torch.Size([18222, 1])
2025-06-02 16:04:58,319 - DEBUG - Edge anomaly scores shape: torch.Size([37894, 1])
2025-06-02 16:04:58,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:58,526 - DEBUG - Step 26: Loss=0.5799
2025-06-02 16:04:58,527 - DEBUG - Online update step: 27/50
2025-06-02 16:04:58,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:58,656 - DEBUG - Node anomaly scores shape: torch.Size([20446, 1])
2025-06-02 16:04:58,661 - DEBUG - Edge anomaly scores shape: torch.Size([43014, 1])
2025-06-02 16:04:58,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:58,894 - DEBUG - Step 27: Loss=0.5758
2025-06-02 16:04:58,894 - DEBUG - Online update step: 28/50
2025-06-02 16:04:58,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:58,996 - DEBUG - Node anomaly scores shape: torch.Size([19002, 1])
2025-06-02 16:04:59,001 - DEBUG - Edge anomaly scores shape: torch.Size([39764, 1])
2025-06-02 16:04:59,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:59,231 - DEBUG - Step 28: Loss=0.5784
2025-06-02 16:04:59,231 - DEBUG - Online update step: 29/50
2025-06-02 16:04:59,238 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:59,347 - DEBUG - Node anomaly scores shape: torch.Size([19200, 1])
2025-06-02 16:04:59,351 - DEBUG - Edge anomaly scores shape: torch.Size([40304, 1])
2025-06-02 16:04:59,352 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:59,560 - DEBUG - Step 29: Loss=0.5754
2025-06-02 16:04:59,560 - DEBUG - Online update step: 30/50
2025-06-02 16:04:59,563 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:59,659 - DEBUG - Node anomaly scores shape: torch.Size([18605, 1])
2025-06-02 16:04:59,665 - DEBUG - Edge anomaly scores shape: torch.Size([38932, 1])
2025-06-02 16:04:59,666 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:04:59,885 - DEBUG - Step 30: Loss=0.5785
2025-06-02 16:04:59,886 - DEBUG - Online update step: 31/50
2025-06-02 16:04:59,891 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:04:59,993 - DEBUG - Node anomaly scores shape: torch.Size([17437, 1])
2025-06-02 16:04:59,997 - DEBUG - Edge anomaly scores shape: torch.Size([36220, 1])
2025-06-02 16:04:59,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:00,209 - DEBUG - Step 31: Loss=0.5758
2025-06-02 16:05:00,209 - DEBUG - Online update step: 32/50
2025-06-02 16:05:00,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:00,343 - DEBUG - Node anomaly scores shape: torch.Size([20973, 1])
2025-06-02 16:05:00,348 - DEBUG - Edge anomaly scores shape: torch.Size([44204, 1])
2025-06-02 16:05:00,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:00,602 - DEBUG - Step 32: Loss=0.5791
2025-06-02 16:05:00,602 - DEBUG - Online update step: 33/50
2025-06-02 16:05:00,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:00,700 - DEBUG - Node anomaly scores shape: torch.Size([19775, 1])
2025-06-02 16:05:00,705 - DEBUG - Edge anomaly scores shape: torch.Size([41487, 1])
2025-06-02 16:05:00,706 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:00,955 - DEBUG - Step 33: Loss=0.5743
2025-06-02 16:05:00,955 - DEBUG - Online update step: 34/50
2025-06-02 16:05:00,958 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:01,046 - DEBUG - Node anomaly scores shape: torch.Size([16553, 1])
2025-06-02 16:05:01,050 - DEBUG - Edge anomaly scores shape: torch.Size([34163, 1])
2025-06-02 16:05:01,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:01,238 - DEBUG - Step 34: Loss=0.5800
2025-06-02 16:05:01,238 - DEBUG - Online update step: 35/50
2025-06-02 16:05:01,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:01,363 - DEBUG - Node anomaly scores shape: torch.Size([19817, 1])
2025-06-02 16:05:01,368 - DEBUG - Edge anomaly scores shape: torch.Size([41680, 1])
2025-06-02 16:05:01,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:01,604 - DEBUG - Step 35: Loss=0.5759
2025-06-02 16:05:01,605 - DEBUG - Online update step: 36/50
2025-06-02 16:05:01,610 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:01,709 - DEBUG - Node anomaly scores shape: torch.Size([18496, 1])
2025-06-02 16:05:01,713 - DEBUG - Edge anomaly scores shape: torch.Size([38572, 1])
2025-06-02 16:05:01,714 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:01,943 - DEBUG - Step 36: Loss=0.5783
2025-06-02 16:05:01,943 - DEBUG - Online update step: 37/50
2025-06-02 16:05:01,948 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:02,057 - DEBUG - Node anomaly scores shape: torch.Size([19313, 1])
2025-06-02 16:05:02,061 - DEBUG - Edge anomaly scores shape: torch.Size([40260, 1])
2025-06-02 16:05:02,063 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:02,307 - DEBUG - Step 37: Loss=0.5744
2025-06-02 16:05:02,308 - DEBUG - Online update step: 38/50
2025-06-02 16:05:02,311 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:02,406 - DEBUG - Node anomaly scores shape: torch.Size([19455, 1])
2025-06-02 16:05:02,410 - DEBUG - Edge anomaly scores shape: torch.Size([40842, 1])
2025-06-02 16:05:02,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:02,624 - DEBUG - Step 38: Loss=0.5780
2025-06-02 16:05:02,624 - DEBUG - Online update step: 39/50
2025-06-02 16:05:02,627 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:02,732 - DEBUG - Node anomaly scores shape: torch.Size([19274, 1])
2025-06-02 16:05:02,736 - DEBUG - Edge anomaly scores shape: torch.Size([40339, 1])
2025-06-02 16:05:02,737 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:02,935 - DEBUG - Step 39: Loss=0.5753
2025-06-02 16:05:02,935 - DEBUG - Online update step: 40/50
2025-06-02 16:05:02,939 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:03,050 - DEBUG - Node anomaly scores shape: torch.Size([18789, 1])
2025-06-02 16:05:03,055 - DEBUG - Edge anomaly scores shape: torch.Size([39366, 1])
2025-06-02 16:05:03,056 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:03,290 - DEBUG - Step 40: Loss=0.5787
2025-06-02 16:05:03,290 - DEBUG - Online update step: 41/50
2025-06-02 16:05:03,293 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:03,407 - DEBUG - Node anomaly scores shape: torch.Size([18845, 1])
2025-06-02 16:05:03,412 - DEBUG - Edge anomaly scores shape: torch.Size([39445, 1])
2025-06-02 16:05:03,413 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:03,621 - DEBUG - Step 41: Loss=0.5751
2025-06-02 16:05:03,621 - DEBUG - Online update step: 42/50
2025-06-02 16:05:03,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:03,722 - DEBUG - Node anomaly scores shape: torch.Size([18306, 1])
2025-06-02 16:05:03,731 - DEBUG - Edge anomaly scores shape: torch.Size([38093, 1])
2025-06-02 16:05:03,732 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:03,965 - DEBUG - Step 42: Loss=0.5793
2025-06-02 16:05:03,965 - DEBUG - Online update step: 43/50
2025-06-02 16:05:03,971 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:04,063 - DEBUG - Node anomaly scores shape: torch.Size([18269, 1])
2025-06-02 16:05:04,067 - DEBUG - Edge anomaly scores shape: torch.Size([38057, 1])
2025-06-02 16:05:04,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:04,288 - DEBUG - Step 43: Loss=0.5756
2025-06-02 16:05:04,289 - DEBUG - Online update step: 44/50
2025-06-02 16:05:04,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:04,381 - DEBUG - Node anomaly scores shape: torch.Size([16803, 1])
2025-06-02 16:05:04,384 - DEBUG - Edge anomaly scores shape: torch.Size([34840, 1])
2025-06-02 16:05:04,386 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:04,574 - DEBUG - Step 44: Loss=0.5783
2025-06-02 16:05:04,575 - DEBUG - Online update step: 45/50
2025-06-02 16:05:04,580 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:04,687 - DEBUG - Node anomaly scores shape: torch.Size([18953, 1])
2025-06-02 16:05:04,692 - DEBUG - Edge anomaly scores shape: torch.Size([39703, 1])
2025-06-02 16:05:04,693 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:04,941 - DEBUG - Step 45: Loss=0.5740
2025-06-02 16:05:04,941 - DEBUG - Online update step: 46/50
2025-06-02 16:05:04,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:05,037 - DEBUG - Node anomaly scores shape: torch.Size([18257, 1])
2025-06-02 16:05:05,041 - DEBUG - Edge anomaly scores shape: torch.Size([38126, 1])
2025-06-02 16:05:05,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:05,218 - DEBUG - Step 46: Loss=0.5783
2025-06-02 16:05:05,218 - DEBUG - Online update step: 47/50
2025-06-02 16:05:05,221 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:05,325 - DEBUG - Node anomaly scores shape: torch.Size([19234, 1])
2025-06-02 16:05:05,332 - DEBUG - Edge anomaly scores shape: torch.Size([40328, 1])
2025-06-02 16:05:05,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:05,549 - DEBUG - Step 47: Loss=0.5750
2025-06-02 16:05:05,549 - DEBUG - Online update step: 48/50
2025-06-02 16:05:05,552 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:05,647 - DEBUG - Node anomaly scores shape: torch.Size([17601, 1])
2025-06-02 16:05:05,651 - DEBUG - Edge anomaly scores shape: torch.Size([36463, 1])
2025-06-02 16:05:05,652 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:05,836 - DEBUG - Step 48: Loss=0.5774
2025-06-02 16:05:05,836 - DEBUG - Online update step: 49/50
2025-06-02 16:05:05,839 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:05,960 - DEBUG - Node anomaly scores shape: torch.Size([18903, 1])
2025-06-02 16:05:05,966 - DEBUG - Edge anomaly scores shape: torch.Size([39650, 1])
2025-06-02 16:05:05,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:06,204 - DEBUG - Step 49: Loss=0.5757
2025-06-02 16:05:06,204 - DEBUG - Online update step: 50/50
2025-06-02 16:05:06,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:06,306 - DEBUG - Node anomaly scores shape: torch.Size([18755, 1])
2025-06-02 16:05:06,310 - DEBUG - Edge anomaly scores shape: torch.Size([39266, 1])
2025-06-02 16:05:06,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:06,513 - DEBUG - Step 50: Loss=0.5783
2025-06-02 16:05:06,514 - INFO - Online update finished. Average loss: 0.5773, Learning rate: 0.001000
2025-06-02 16:05:06,516 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], current edge mean: [ 9.1488476e+00  1.4179723e+00  5.7064514e+00  2.1974063e-09
  6.9218298e-09 -2.4171469e-09 -4.3948125e-09  1.4283140e-09
  0.0000000e+00  4.3948126e-10]
2025-06-02 16:05:06,516 - DEBUG - Node drift difference: 0.0170, Edge drift difference: 0.0015
2025-06-02 16:05:06,519 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00  4.4613536e-08 -5.2288986e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.7989329e-08
 -3.8377237e-08  2.6864065e-08  3.8377237e-08 -1.8229187e-08
  2.2676055e+00  2.9617705e+00  1.3883300e-01  4.3963780e+00
 -3.0701788e-08  3.3983903e+00  5.8098593e+00  7.6156940e+00
  1.3883300e-01  7.9929576e+00  1.4391464e-09  1.6909970e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  3.5498942e-08  7.6754469e-09], edge=[ 9.1488476e+00  1.4179723e+00  5.7064514e+00  2.1974063e-09
  6.9218298e-09 -2.4171469e-09 -4.3948125e-09  1.4283140e-09
  0.0000000e+00  4.3948126e-10]
2025-06-02 16:05:06,520 - DEBUG - Updated reference std: node=[0.         0.         1.0005034  1.0005034  0.         0.
 0.         1.0005034  1.0005034  1.0005034  1.0005034  1.0005034
 0.9407508  0.27399415 0.3602073  0.5745763  1.0005034  3.003227
 2.8989465  1.479363   0.3602073  0.22202651 1.0005034  1.0005034
 0.         0.         0.         0.         1.0005034  1.0005034 ], edge=[1.1101032 0.5053422 2.1377213 1.0002306 1.0002306 1.0002306 1.0002306
 1.0002306 1.0002304 1.0002306]
2025-06-02 16:05:06,520 - INFO - Online update complete. Loss: 0.5773
2025-06-02 16:05:06,521 - INFO - Running anomaly detection...
2025-06-02 16:05:06,521 - INFO - Starting anomaly detection.
2025-06-02 16:05:06,542 - DEBUG - Node reconstruction errors: [0.02840683 0.44367483 0.07484255 0.00349683 0.023548   0.00874197
 0.19963971 0.0179356  0.0179356  0.01789328 0.0179356  0.00642642
 0.39678138 0.11761095 0.00242085 0.01565098 0.00930346 0.01565114
 0.0089296  0.01512561 0.01812857 0.00242085 0.02428929 0.0053723
 0.00254507 0.00445183 0.0025449  0.03054718 0.01758682 0.0025449
 0.06161975 0.08309425 0.02796039 0.00322719 0.00721856 0.02404823
 0.05945259 0.01512563 0.04072968 0.04418606 0.00644032 0.00228558
 0.01512563 0.00715578 0.01112878 0.00681644 0.01342243 0.16181293
 0.01747003 0.07360451 0.04152482 0.00589711 0.004033   0.00848504
 0.01794549 0.02425637 0.04281853 0.01486704 0.00926315 0.01200262
 0.11714155 0.00883072 0.00221387 0.00599156 0.00688546 0.01794549
 0.00274583 0.01794538 0.00221384 0.0083051  0.02080254 0.00553081
 0.00269392 0.01568791 0.01725507 0.0056084  0.00826036 0.02125893
 0.00975113 0.00700382 0.0029257  0.01495126 0.16656247 0.03779979
 0.00886619 0.00624575 0.03401233 0.00755527 0.00853778 0.07849099
 0.00153491 0.02844885 0.00318992 0.00762286 0.00440847 0.03970424
 0.00280324 0.00616723 0.00253248 0.0200464  0.00324114 0.00280324
 0.00356986 0.05726123 0.00427369 0.01923014 0.00397536 0.02371476
 0.0028539  0.09306821 0.04620157 0.00288207 0.02310146 0.02721598
 0.00352997 0.01049431 0.0033813  0.01812248 0.00639708 0.00357316
 0.001641   0.00360793 0.02629383 0.00502397 0.01208403 0.00357277
 0.00367591 0.00529214 0.00792649 0.00302824 0.00444813 0.0029716
 0.10180747 0.09924769 0.0030677  0.01763338 0.00544476 0.00225364
 0.08588941 0.02297845 0.00331001 0.03496324 0.001845   0.00281097
 0.00416283 0.00520211 0.00337845 0.09431315 0.00451742 0.00893935
 0.1693057  0.00508415 0.0100982  0.00297159 0.02136489 0.01819746
 0.00242288 0.02847335 0.00324122 0.00373156 0.00331032 0.08589122
 0.00242289 0.00444815 0.0027229  0.01918241 0.00600731 0.00619427
 0.00427021 0.00887623 0.00678786 0.00347682 0.00144168 0.01436634
 0.00639751 0.0033363  0.00720026 0.02232475 0.00268719 0.00268718
 0.01945232 0.00379173 0.00529266 0.03688208 0.03091126 0.006141
 0.00434743 0.01267291 0.01778124 0.00425016 0.02385696 0.00693848
 0.00488523 0.00272401 0.08588247 0.00268785 0.1975681  0.00490256
 0.02385681 0.00440892 0.00308054 0.00242289 0.02117741 0.00852912
 0.00770199 0.0033216  0.01762019 0.08004609 0.00288207 0.00997477
 0.00244448 0.00778906 0.00291968 0.01203999 0.0093053  0.00226492
 0.00853853 0.00338176 0.0782638  0.00542915 0.03325067 0.00188226
 0.00142361 0.00291968 0.00242288 0.01497213 0.01614549 0.00293635
 0.00938924 0.00294569 0.0042288  0.01382639 0.00810979 0.00337985
 0.00338141 0.00488516 0.00734064 0.00142361 0.00242289 0.00639537
 0.01756044 0.0084488  0.00318621 0.01136157 0.00273418 0.01201126
 0.01426171 0.01742885 0.00318621 0.0023461  0.00587868 0.00169437
 0.07826414 0.00675546 0.00792788 0.01903385 0.00225963 0.00342532
 0.00436986 0.00268717 0.00969292 0.00501207 0.01059647 0.00325741
 0.00820553 0.0039806  0.00475417 0.0541523  0.00475786 0.01080229
 0.06492972 0.0299627  0.00870601 0.00467683 0.00525767 0.04517046
 0.00160259 0.03002146 0.01945233 0.00862754 0.07264812 0.00145838
 0.00672009 0.00512314 0.0144747  0.0040748  0.07208779 0.00657117
 0.00379173 0.00571083 0.00367377 0.0026831  0.03856274 0.00273418
 0.09608485 0.00370941 0.00724171 0.00270273 0.0026876  0.00692782
 0.0059773  0.00560283 0.00514236 0.00720517 0.0024966  0.00249662
 0.00249662 0.00553155 0.00495329 0.00560284 0.00249661 0.01924754
 0.00249662 0.00389265 0.00483096 0.00769512 0.08235773 0.00328211
 0.0027444  0.00273267 0.01206644 0.00341818 0.0086724  0.00514237
 0.02431608 0.03311029 0.11504168 0.00861466 0.00988949 0.00988681
 0.07702149 0.00262721 0.00249676 0.00525788 0.00249661 0.00553079
 0.0056123  0.00165889 0.00618204 0.0026648  0.00560575 0.00386719
 0.00266481 0.01299969 0.00735037 0.00767756 0.00514261 0.00407328
 0.00452841 0.00622886 0.00249667 0.01097577 0.02192852 0.00741995
 0.00397772 0.00225964 0.00598257 0.00249662 0.00235225 0.02119866
 0.00374699 0.00328714 0.0807201  0.01103232 0.0051516  0.01510161
 0.00388832 0.02685746 0.00300477 0.00278465 0.0085245  0.01002202
 0.01119011 0.02044538 0.00778576 0.02128584 0.00144719 0.0039214
 0.02668376 0.00249662 0.00514212 0.00413955 0.0023671  0.00672271
 0.00412007 0.00927864 0.01769193 0.00380482 0.01295921 0.00249662
 0.05901395 0.0066579  0.0023917  0.02339506 0.01149533 0.01149812
 0.01150178 0.00987397 0.00268244 0.02607339 0.00411708 0.0255371
 0.01663803 0.00268237 0.00408208 0.00239479 0.00938209 0.0019226
 0.00239167 0.02495333 0.01149959 0.00239168 0.00268239 0.01149716
 0.01149903 0.00383438 0.00392272 0.01150208 0.004776   0.0021255
 0.00212705 0.00211094 0.00281796 0.0021923  0.02376067 0.00361233
 0.00231745 0.00423013 0.00743966 0.00288996 0.00417788 0.0199777
 0.01201047 0.01567442 0.02736294 0.01149795 0.00200726 0.0074706
 0.02517447 0.00317298 0.00313707 0.0034442  0.07927547 0.0015232
 0.0032702  0.01867458 0.02757129 0.00206591 0.00264826 0.00219525
 0.01337219 0.00150185 0.00235743 0.00466214 0.00150185 0.01840392
 0.00219218 0.00231664 0.00217657 0.00690205 0.00296358 0.00253114
 0.00213085 0.00325921 0.00213117 0.00253114 0.00170165 0.00400181
 0.00459782 0.00270407 0.00170165 0.00294282 0.00849133 0.04956071
 0.00995391 0.00267158 0.00399783 0.00296359 0.00147586 0.0025769
 0.00215085 0.08779865 0.00200589 0.00206593 0.0222664  0.00209671
 0.00150185 0.00487278 0.01076569 0.04956929 0.01252926 0.00147586
 0.00719828 0.00159013 0.01868826 0.00234478 0.00301461 0.0204764
 0.00272729 0.00257688 0.07127749 0.00159011 0.0742285  0.00149437
 0.00170567 0.00278535 0.00276899 0.08966443 0.00212895 0.00150185
 0.00228163 0.0032164  0.00321641 0.00159202 0.00829411 0.00179937
 0.00276946 0.006012   0.00286084 0.01011311 0.0112762  0.00344401
 0.00276897 0.00436608 0.00170567 0.00301821 0.00386422 0.00372088
 0.01122315 0.00683873 0.00179937 0.00812347 0.00272729 0.00257687
 0.00301184 0.00237791 0.01015371 0.00796888 0.00272731 0.01338089
 0.00272731 0.00517979 0.00341778 0.00601987 0.00298108 0.01086334
 0.00533765 0.00259257 0.18260662 0.00259257 0.00259257 0.00259257
 0.00259257 0.00259257 0.00259257 0.00259257 0.0066011  0.00294143
 0.01091637 0.00259257 0.00259256 0.00259257 0.00259257 0.00259257
 0.00259256 0.00259257 0.00259257 0.00259257 0.00644096 0.00259257
 0.00259256 0.02420732 0.00259257 0.00414525 0.01211119 0.00272729
 0.01245842 0.01435207 0.01191078 0.01191078 0.00745773 0.01245842
 0.00272729 0.00276897 0.00276898 0.00363624 0.00276899 0.00372639
 0.0032172  0.00259292 0.00344399 0.00272729 0.00321644 0.00272729
 0.00272729 0.00294723 0.0027273  0.00276897 0.00272729 0.00272729
 0.01229831 0.00276897 0.00272729 0.00276898 0.0027273  0.00272729
 0.00272729 0.00421054 0.00970875 0.00290587 0.00259256 0.01798683
 0.01235617 0.00272729 0.00276899 0.00578515 0.0025926  0.00263336
 0.00830938 0.00284386 0.00272729 0.00272729 0.01172866 0.00413948
 0.00284319 0.00272733 0.0066011  0.00308325 0.00276898 0.00470748
 0.00259256 0.00324777 0.01154882 0.00259256 0.00259263 0.0066011
 0.00308314 0.0027273  0.08854298 0.00945466 0.00671308 0.00413945
 0.00215325 0.00965627 0.00965659 0.01207565 0.00159795 0.00259257
 0.0030875  0.01085272 0.00413945 0.00229238 0.00164011 0.00167411
 0.00247365 0.00247365 0.00247365 0.00247365 0.00247364 0.00682629
 0.01015101 0.00247365 0.00247371 0.00259257 0.0029596  0.00259257
 0.00965662 0.00964893 0.02057343 0.00365369 0.01391697 0.01419575
 0.00644078 0.00243191 0.00644042 0.00259257 0.00965713 0.00165188
 0.00264    0.00264002 0.00247364 0.00165189 0.00778921 0.00433296
 0.003383   0.00259257 0.00247366 0.00178214 0.00264    0.00456047
 0.00130622 0.00286007 0.00682632 0.05484049 0.00177682 0.03945943
 0.00232083 0.00130625 0.00191915 0.00160865 0.00122582 0.00141778
 0.0084495  0.00320962 0.00899047 0.00130622 0.00130623 0.00130622
 0.00129192 0.00178213 0.00130622 0.00122582 0.00130622 0.00130622
 0.00130623 0.00244846 0.00157437 0.00906089 0.00821859 0.0107005
 0.01096265 0.00234331 0.00967572 0.01361963 0.00119409 0.00159583
 0.00139489 0.1058187  0.01894848 0.00122582 0.01759974 0.08305914
 0.00119447 0.00230172 0.00267419 0.018616   0.00161728 0.00161728
 0.00161728 0.00224109 0.00117866 0.00361375 0.02156201 0.07256363
 0.00164444 0.00130513 0.00302165 0.0023017  0.00192973 0.00372312
 0.00120376 0.00242925 0.00119447 0.08316597 0.0023017  0.00373751
 0.00216077 0.00658807 0.00161728 0.00224113 0.00120379 0.00317674
 0.01928743 0.00224109 0.0022411  0.0022411  0.00664667 0.12070631
 0.82491404 0.00161728 0.0292929  0.00224112 0.01013698 0.00272456
 0.01588588 0.00314037 0.0022411  0.00222253 0.00276251 0.0011663
 0.24996907 0.00314418 0.0256628  0.00289846 0.00571996 0.0031401
 0.00761284 0.0196374  0.00498927 0.01475426 0.00887707 0.00116215
 0.00116222 0.01934136 0.09074284 0.00874296 0.00314008 0.00498926
 0.00314009 0.00127227 0.00117454 0.00117454 0.00119052 0.00827557
 0.00147022 0.00117454 0.00127224 0.00378809 0.00117454 0.00117454
 0.00223167 0.00228054 0.00696031 0.01141377 0.00117454 0.00461021
 0.00378809 0.00117454 0.00119456 0.00201254 0.00136325 0.00136325
 0.00622691 0.00189672 0.00117454 0.00189672 0.00188872 0.01204444
 0.02108287 0.00117454 0.09051982 0.00187992 0.00187993 0.00240583
 0.0021549  0.00200646 0.00119456 0.00152725 0.00123652 0.02030856
 0.00219254 0.02030856 0.07472747 0.00130701 0.00219254 0.00228454
 0.00228454 0.01916663 0.00228453 0.00336912 0.00225133 0.02043163
 0.00284313 0.00130701 0.00284294 0.00433626 0.01121757 0.0071027
 0.00228454 0.0023199  0.00259534 0.00228454 0.00526926 0.04375825
 0.00159138 0.00130702 0.00228454 0.09101575 0.00303201 0.00274393
 0.00228453 0.00122487 0.01075468 0.00122488 0.00274729 0.0012249
 0.0066615  0.00862681 0.01366851 0.00228454 0.02109582 0.00273721
 0.00228454 0.05004641 0.00273727 0.00122487 0.00273723 0.003032
 0.003032   0.00627195 0.00303203 0.00228453 0.00239737 0.00273721
 0.00212543 0.02515415 0.00239737 0.00303201 0.00228454 0.00404379
 0.00908482 0.00761426 0.00761397 0.00230939 0.02120125 0.00233943
 0.00201951 0.13125256 0.0076141  0.00126215 0.00761399 0.00227816
 0.00201941 0.0076141  0.00235097 0.00161147 0.00260173 0.00274852
 0.00132296 0.00247839 0.00236854 0.00183562 0.00243025 0.00243026
 0.00806464 0.01520737 0.00243033 0.00243025 0.01441327 0.01266924
 0.00243025 0.00243024 0.00243024 0.00243024 0.01521089 0.01520769
 0.01520749 0.0152084  0.01628723 0.00317854 0.01520746 0.01520749
 0.01629268 0.00243025 0.16651417 0.01629793 0.0019252  0.0152128
 0.00141831 0.01887237 0.0257562  0.00243024 0.0123905  0.01877633
 0.03633947 0.01058292 0.01058322 0.00197846 0.01058254 0.01058251
 0.00145444 0.01754515 0.01369487 0.00260137 0.00260138 0.00260138
 0.00352523 0.02262816 0.00260137 0.03762141 0.01356347 0.00197811
 0.01174053 0.00260137 0.0047736  0.00260137 0.01373683 0.00210963
 0.00352518 0.02262765 0.01356622 0.01356363 0.00352522 0.00260137
 0.01357364 0.01357861 0.00260137 0.00210962 0.02449681 0.00260137
 0.00285923 0.00156216 0.00210963 0.00156215]
2025-06-02 16:05:06,543 - DEBUG - Edge reconstruction errors: [1.3639926  1.3615038  0.95776415 ... 0.15774888 1.2586324  0.15774888]
2025-06-02 16:05:06,547 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160506_update_47.json
2025-06-02 16:05:06,548 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:05:06,569 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160506_update_47.pth and as latest_checkpoint.pth
2025-06-02 16:05:06,569 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870505.dot): 0.1123
2025-06-02 16:05:06,569 - WARNING - Detected 16 anomalous nodes (reconstruction-based):
2025-06-02 16:05:06,570 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.4437, MLP Score: 0.5288
2025-06-02 16:05:06,570 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1996, MLP Score: 0.5057
2025-06-02 16:05:06,570 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3968, MLP Score: 0.4972
2025-06-02 16:05:06,570 - WARNING -   Node ID: 8.8.8.8, Recon Error: 0.1176, MLP Score: 0.5068
2025-06-02 16:05:06,570 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1618, MLP Score: 0.5020
2025-06-02 16:05:06,570 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:05:06,570 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.1711, MLP Score: 0.5277
2025-06-02 16:05:06,570 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.7405, MLP Score: 0.4710
2025-06-02 16:05:06,570 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4345, MLP Score: 0.5030
2025-06-02 16:05:06,570 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.0951, MLP Score: 0.3983
2025-06-02 16:05:06,570 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7052, MLP Score: 0.5072
2025-06-02 16:05:06,571 - INFO - 
--- Processing file: nw_graph_encoded_1748870535.dot (Timestamp: 2025-06-02 15:22:15) ---
2025-06-02 16:05:06,571 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 16:05:06,571 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 16:05:06,599 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 16:05:06,625 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 16:05:06,625 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 16:05:06,625 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870535.dot
2025-06-02 16:05:06,646 - INFO - Parsed 996 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 16:05:06,666 - INFO - Parsed 2181 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870535.dot'.
2025-06-02 16:05:06,666 - INFO - Processing node updates/additions.
2025-06-02 16:05:06,671 - INFO - Processing edge updates/additions.
2025-06-02 16:05:06,681 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:05:06,682 - INFO - Finished updating NetworkX graph.
2025-06-02 16:05:06,682 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:05:06,683 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:05:06,691 - DEBUG - Initial node features tensor shape: torch.Size([996, 30])
2025-06-02 16:05:06,692 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:05:06,693 - DEBUG - Node features tensor shape after scaling: torch.Size([996, 30])
2025-06-02 16:05:06,695 - DEBUG - Edge index tensor shape: torch.Size([2, 2181])
2025-06-02 16:05:06,696 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:05:06,700 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:05:06,701 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:05:06,702 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:05:06,704 - DEBUG - Shape of encoded categorical edge features: torch.Size([2181, 3])
2025-06-02 16:05:06,705 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:05:06,705 - DEBUG - Shape of scaled numerical edge features: torch.Size([2181, 7])
2025-06-02 16:05:06,705 - DEBUG - Final edge attributes tensor shape: torch.Size([2181, 10])
2025-06-02 16:05:06,705 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:05:06,707 - INFO - Performing online update...
2025-06-02 16:05:06,707 - INFO - Starting online update for 50 steps.
2025-06-02 16:05:06,708 - DEBUG - Updated RunningStats: new_mean=0.9449173580080591, new_var=27600000000161.516, new_n=2790
2025-06-02 16:05:06,708 - DEBUG - Updated RunningStats: new_mean=0.9427162085269993, new_var=27900000000018.227, new_n=2820
2025-06-02 16:05:06,708 - DEBUG - Updated RunningStats: new_mean=1.1557818596479448, new_var=9200000000093.998, new_n=930
2025-06-02 16:05:06,708 - DEBUG - Updated RunningStats: new_mean=1.1549255750674887, new_var=9300000000001.559, new_n=940
2025-06-02 16:05:06,708 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:05:06,708 - DEBUG - Online update step: 1/50
2025-06-02 16:05:06,710 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:06,862 - DEBUG - Node anomaly scores shape: torch.Size([18686, 1])
2025-06-02 16:05:06,870 - DEBUG - Edge anomaly scores shape: torch.Size([39062, 1])
2025-06-02 16:05:06,871 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:07,031 - DEBUG - Step 1: Loss=0.5754
2025-06-02 16:05:07,031 - DEBUG - Online update step: 2/50
2025-06-02 16:05:07,034 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:07,157 - DEBUG - Node anomaly scores shape: torch.Size([18948, 1])
2025-06-02 16:05:07,164 - DEBUG - Edge anomaly scores shape: torch.Size([39554, 1])
2025-06-02 16:05:07,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:07,341 - DEBUG - Step 2: Loss=0.5781
2025-06-02 16:05:07,342 - DEBUG - Online update step: 3/50
2025-06-02 16:05:07,345 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:07,493 - DEBUG - Node anomaly scores shape: torch.Size([19512, 1])
2025-06-02 16:05:07,497 - DEBUG - Edge anomaly scores shape: torch.Size([41118, 1])
2025-06-02 16:05:07,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:07,688 - DEBUG - Step 3: Loss=0.5741
2025-06-02 16:05:07,688 - DEBUG - Online update step: 4/50
2025-06-02 16:05:07,691 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:07,813 - DEBUG - Node anomaly scores shape: torch.Size([17831, 1])
2025-06-02 16:05:07,817 - DEBUG - Edge anomaly scores shape: torch.Size([37104, 1])
2025-06-02 16:05:07,818 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:07,982 - DEBUG - Step 4: Loss=0.5780
2025-06-02 16:05:07,982 - DEBUG - Online update step: 5/50
2025-06-02 16:05:07,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:08,097 - DEBUG - Node anomaly scores shape: torch.Size([18251, 1])
2025-06-02 16:05:08,102 - DEBUG - Edge anomaly scores shape: torch.Size([38157, 1])
2025-06-02 16:05:08,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:08,287 - DEBUG - Step 5: Loss=0.5755
2025-06-02 16:05:08,287 - DEBUG - Online update step: 6/50
2025-06-02 16:05:08,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:08,433 - DEBUG - Node anomaly scores shape: torch.Size([19795, 1])
2025-06-02 16:05:08,440 - DEBUG - Edge anomaly scores shape: torch.Size([41660, 1])
2025-06-02 16:05:08,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:08,663 - DEBUG - Step 6: Loss=0.5776
2025-06-02 16:05:08,664 - DEBUG - Online update step: 7/50
2025-06-02 16:05:08,667 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:08,775 - DEBUG - Node anomaly scores shape: torch.Size([18913, 1])
2025-06-02 16:05:08,780 - DEBUG - Edge anomaly scores shape: torch.Size([39550, 1])
2025-06-02 16:05:08,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:09,004 - DEBUG - Step 7: Loss=0.5740
2025-06-02 16:05:09,004 - DEBUG - Online update step: 8/50
2025-06-02 16:05:09,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:09,128 - DEBUG - Node anomaly scores shape: torch.Size([20462, 1])
2025-06-02 16:05:09,133 - DEBUG - Edge anomaly scores shape: torch.Size([42789, 1])
2025-06-02 16:05:09,134 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:09,384 - DEBUG - Step 8: Loss=0.5777
2025-06-02 16:05:09,385 - DEBUG - Online update step: 9/50
2025-06-02 16:05:09,390 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:09,481 - DEBUG - Node anomaly scores shape: torch.Size([17012, 1])
2025-06-02 16:05:09,484 - DEBUG - Edge anomaly scores shape: torch.Size([35199, 1])
2025-06-02 16:05:09,486 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:09,689 - DEBUG - Step 9: Loss=0.5751
2025-06-02 16:05:09,689 - DEBUG - Online update step: 10/50
2025-06-02 16:05:09,695 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:09,797 - DEBUG - Node anomaly scores shape: torch.Size([18944, 1])
2025-06-02 16:05:09,802 - DEBUG - Edge anomaly scores shape: torch.Size([39865, 1])
2025-06-02 16:05:09,804 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:10,046 - DEBUG - Step 10: Loss=0.5781
2025-06-02 16:05:10,046 - DEBUG - Online update step: 11/50
2025-06-02 16:05:10,049 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:10,152 - DEBUG - Node anomaly scores shape: torch.Size([18480, 1])
2025-06-02 16:05:10,156 - DEBUG - Edge anomaly scores shape: torch.Size([38418, 1])
2025-06-02 16:05:10,157 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:10,413 - DEBUG - Step 11: Loss=0.5744
2025-06-02 16:05:10,413 - DEBUG - Online update step: 12/50
2025-06-02 16:05:10,418 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:10,518 - DEBUG - Node anomaly scores shape: torch.Size([18842, 1])
2025-06-02 16:05:10,522 - DEBUG - Edge anomaly scores shape: torch.Size([39323, 1])
2025-06-02 16:05:10,524 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:10,742 - DEBUG - Step 12: Loss=0.5788
2025-06-02 16:05:10,743 - DEBUG - Online update step: 13/50
2025-06-02 16:05:10,748 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:10,857 - DEBUG - Node anomaly scores shape: torch.Size([19272, 1])
2025-06-02 16:05:10,862 - DEBUG - Edge anomaly scores shape: torch.Size([40274, 1])
2025-06-02 16:05:10,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:11,111 - DEBUG - Step 13: Loss=0.5755
2025-06-02 16:05:11,112 - DEBUG - Online update step: 14/50
2025-06-02 16:05:11,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:11,224 - DEBUG - Node anomaly scores shape: torch.Size([20737, 1])
2025-06-02 16:05:11,229 - DEBUG - Edge anomaly scores shape: torch.Size([43758, 1])
2025-06-02 16:05:11,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:11,492 - DEBUG - Step 14: Loss=0.5767
2025-06-02 16:05:11,493 - DEBUG - Online update step: 15/50
2025-06-02 16:05:11,499 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:11,598 - DEBUG - Node anomaly scores shape: torch.Size([18086, 1])
2025-06-02 16:05:11,602 - DEBUG - Edge anomaly scores shape: torch.Size([37784, 1])
2025-06-02 16:05:11,604 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:11,801 - DEBUG - Step 15: Loss=0.5740
2025-06-02 16:05:11,802 - DEBUG - Online update step: 16/50
2025-06-02 16:05:11,808 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:11,906 - DEBUG - Node anomaly scores shape: torch.Size([18221, 1])
2025-06-02 16:05:11,910 - DEBUG - Edge anomaly scores shape: torch.Size([38046, 1])
2025-06-02 16:05:11,912 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:12,102 - DEBUG - Step 16: Loss=0.5778
2025-06-02 16:05:12,102 - DEBUG - Online update step: 17/50
2025-06-02 16:05:12,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:12,219 - DEBUG - Node anomaly scores shape: torch.Size([19205, 1])
2025-06-02 16:05:12,223 - DEBUG - Edge anomaly scores shape: torch.Size([40304, 1])
2025-06-02 16:05:12,225 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:12,463 - DEBUG - Step 17: Loss=0.5742
2025-06-02 16:05:12,464 - DEBUG - Online update step: 18/50
2025-06-02 16:05:12,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:12,583 - DEBUG - Node anomaly scores shape: torch.Size([20416, 1])
2025-06-02 16:05:12,588 - DEBUG - Edge anomaly scores shape: torch.Size([43054, 1])
2025-06-02 16:05:12,589 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:12,803 - DEBUG - Step 18: Loss=0.5776
2025-06-02 16:05:12,803 - DEBUG - Online update step: 19/50
2025-06-02 16:05:12,807 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:12,910 - DEBUG - Node anomaly scores shape: torch.Size([18615, 1])
2025-06-02 16:05:12,914 - DEBUG - Edge anomaly scores shape: torch.Size([38912, 1])
2025-06-02 16:05:12,915 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:13,107 - DEBUG - Step 19: Loss=0.5741
2025-06-02 16:05:13,107 - DEBUG - Online update step: 20/50
2025-06-02 16:05:13,110 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:13,220 - DEBUG - Node anomaly scores shape: torch.Size([19231, 1])
2025-06-02 16:05:13,225 - DEBUG - Edge anomaly scores shape: torch.Size([40234, 1])
2025-06-02 16:05:13,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:13,454 - DEBUG - Step 20: Loss=0.5780
2025-06-02 16:05:13,454 - DEBUG - Online update step: 21/50
2025-06-02 16:05:13,457 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:13,567 - DEBUG - Node anomaly scores shape: torch.Size([18152, 1])
2025-06-02 16:05:13,571 - DEBUG - Edge anomaly scores shape: torch.Size([37667, 1])
2025-06-02 16:05:13,572 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:13,775 - DEBUG - Step 21: Loss=0.5751
2025-06-02 16:05:13,776 - DEBUG - Online update step: 22/50
2025-06-02 16:05:13,779 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:13,876 - DEBUG - Node anomaly scores shape: torch.Size([17696, 1])
2025-06-02 16:05:13,880 - DEBUG - Edge anomaly scores shape: torch.Size([36817, 1])
2025-06-02 16:05:13,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:14,070 - DEBUG - Step 22: Loss=0.5767
2025-06-02 16:05:14,071 - DEBUG - Online update step: 23/50
2025-06-02 16:05:14,074 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:14,191 - DEBUG - Node anomaly scores shape: torch.Size([18784, 1])
2025-06-02 16:05:14,196 - DEBUG - Edge anomaly scores shape: torch.Size([39245, 1])
2025-06-02 16:05:14,197 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:14,390 - DEBUG - Step 23: Loss=0.5730
2025-06-02 16:05:14,391 - DEBUG - Online update step: 24/50
2025-06-02 16:05:14,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:14,501 - DEBUG - Node anomaly scores shape: torch.Size([18160, 1])
2025-06-02 16:05:14,505 - DEBUG - Edge anomaly scores shape: torch.Size([37850, 1])
2025-06-02 16:05:14,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:14,712 - DEBUG - Step 24: Loss=0.5775
2025-06-02 16:05:14,712 - DEBUG - Online update step: 25/50
2025-06-02 16:05:14,715 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:14,826 - DEBUG - Node anomaly scores shape: torch.Size([19183, 1])
2025-06-02 16:05:14,831 - DEBUG - Edge anomaly scores shape: torch.Size([40478, 1])
2025-06-02 16:05:14,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:15,068 - DEBUG - Step 25: Loss=0.5742
2025-06-02 16:05:15,069 - DEBUG - Online update step: 26/50
2025-06-02 16:05:15,072 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:15,176 - DEBUG - Node anomaly scores shape: torch.Size([19102, 1])
2025-06-02 16:05:15,181 - DEBUG - Edge anomaly scores shape: torch.Size([40098, 1])
2025-06-02 16:05:15,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:15,397 - DEBUG - Step 26: Loss=0.5775
2025-06-02 16:05:15,397 - DEBUG - Online update step: 27/50
2025-06-02 16:05:15,400 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:15,493 - DEBUG - Node anomaly scores shape: torch.Size([17244, 1])
2025-06-02 16:05:15,497 - DEBUG - Edge anomaly scores shape: torch.Size([35921, 1])
2025-06-02 16:05:15,498 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:15,700 - DEBUG - Step 27: Loss=0.5752
2025-06-02 16:05:15,700 - DEBUG - Online update step: 28/50
2025-06-02 16:05:15,703 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:15,803 - DEBUG - Node anomaly scores shape: torch.Size([20502, 1])
2025-06-02 16:05:15,809 - DEBUG - Edge anomaly scores shape: torch.Size([42943, 1])
2025-06-02 16:05:15,810 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:16,022 - DEBUG - Step 28: Loss=0.5770
2025-06-02 16:05:16,022 - DEBUG - Online update step: 29/50
2025-06-02 16:05:16,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:16,146 - DEBUG - Node anomaly scores shape: torch.Size([20242, 1])
2025-06-02 16:05:16,153 - DEBUG - Edge anomaly scores shape: torch.Size([42698, 1])
2025-06-02 16:05:16,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:16,384 - DEBUG - Step 29: Loss=0.5741
2025-06-02 16:05:16,385 - DEBUG - Online update step: 30/50
2025-06-02 16:05:16,388 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:16,506 - DEBUG - Node anomaly scores shape: torch.Size([20610, 1])
2025-06-02 16:05:16,510 - DEBUG - Edge anomaly scores shape: torch.Size([43403, 1])
2025-06-02 16:05:16,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:16,722 - DEBUG - Step 30: Loss=0.5770
2025-06-02 16:05:16,722 - DEBUG - Online update step: 31/50
2025-06-02 16:05:16,725 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:16,833 - DEBUG - Node anomaly scores shape: torch.Size([19476, 1])
2025-06-02 16:05:16,839 - DEBUG - Edge anomaly scores shape: torch.Size([40856, 1])
2025-06-02 16:05:16,840 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:17,048 - DEBUG - Step 31: Loss=0.5734
2025-06-02 16:05:17,048 - DEBUG - Online update step: 32/50
2025-06-02 16:05:17,052 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:17,142 - DEBUG - Node anomaly scores shape: torch.Size([17474, 1])
2025-06-02 16:05:17,146 - DEBUG - Edge anomaly scores shape: torch.Size([36298, 1])
2025-06-02 16:05:17,147 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:17,325 - DEBUG - Step 32: Loss=0.5783
2025-06-02 16:05:17,325 - DEBUG - Online update step: 33/50
2025-06-02 16:05:17,328 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:17,438 - DEBUG - Node anomaly scores shape: torch.Size([20231, 1])
2025-06-02 16:05:17,443 - DEBUG - Edge anomaly scores shape: torch.Size([42585, 1])
2025-06-02 16:05:17,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:17,674 - DEBUG - Step 33: Loss=0.5745
2025-06-02 16:05:17,674 - DEBUG - Online update step: 34/50
2025-06-02 16:05:17,677 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:17,797 - DEBUG - Node anomaly scores shape: torch.Size([18042, 1])
2025-06-02 16:05:17,801 - DEBUG - Edge anomaly scores shape: torch.Size([37724, 1])
2025-06-02 16:05:17,802 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:18,016 - DEBUG - Step 34: Loss=0.5777
2025-06-02 16:05:18,016 - DEBUG - Online update step: 35/50
2025-06-02 16:05:18,019 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:18,110 - DEBUG - Node anomaly scores shape: torch.Size([18309, 1])
2025-06-02 16:05:18,114 - DEBUG - Edge anomaly scores shape: torch.Size([38100, 1])
2025-06-02 16:05:18,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:18,332 - DEBUG - Step 35: Loss=0.5745
2025-06-02 16:05:18,333 - DEBUG - Online update step: 36/50
2025-06-02 16:05:18,336 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:18,425 - DEBUG - Node anomaly scores shape: torch.Size([16724, 1])
2025-06-02 16:05:18,428 - DEBUG - Edge anomaly scores shape: torch.Size([34610, 1])
2025-06-02 16:05:18,429 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:18,636 - DEBUG - Step 36: Loss=0.5775
2025-06-02 16:05:18,636 - DEBUG - Online update step: 37/50
2025-06-02 16:05:18,639 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:18,742 - DEBUG - Node anomaly scores shape: torch.Size([19534, 1])
2025-06-02 16:05:18,747 - DEBUG - Edge anomaly scores shape: torch.Size([40972, 1])
2025-06-02 16:05:18,749 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:18,969 - DEBUG - Step 37: Loss=0.5737
2025-06-02 16:05:18,969 - DEBUG - Online update step: 38/50
2025-06-02 16:05:18,973 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:19,090 - DEBUG - Node anomaly scores shape: torch.Size([19148, 1])
2025-06-02 16:05:19,095 - DEBUG - Edge anomaly scores shape: torch.Size([40147, 1])
2025-06-02 16:05:19,097 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:19,351 - DEBUG - Step 38: Loss=0.5769
2025-06-02 16:05:19,351 - DEBUG - Online update step: 39/50
2025-06-02 16:05:19,354 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:19,455 - DEBUG - Node anomaly scores shape: torch.Size([19676, 1])
2025-06-02 16:05:19,460 - DEBUG - Edge anomaly scores shape: torch.Size([41383, 1])
2025-06-02 16:05:19,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:19,670 - DEBUG - Step 39: Loss=0.5734
2025-06-02 16:05:19,670 - DEBUG - Online update step: 40/50
2025-06-02 16:05:19,674 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:19,785 - DEBUG - Node anomaly scores shape: torch.Size([19375, 1])
2025-06-02 16:05:19,789 - DEBUG - Edge anomaly scores shape: torch.Size([40556, 1])
2025-06-02 16:05:19,790 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:20,022 - DEBUG - Step 40: Loss=0.5776
2025-06-02 16:05:20,022 - DEBUG - Online update step: 41/50
2025-06-02 16:05:20,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:20,143 - DEBUG - Node anomaly scores shape: torch.Size([19392, 1])
2025-06-02 16:05:20,147 - DEBUG - Edge anomaly scores shape: torch.Size([40685, 1])
2025-06-02 16:05:20,148 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:20,371 - DEBUG - Step 41: Loss=0.5743
2025-06-02 16:05:20,371 - DEBUG - Online update step: 42/50
2025-06-02 16:05:20,374 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:20,471 - DEBUG - Node anomaly scores shape: torch.Size([17959, 1])
2025-06-02 16:05:20,475 - DEBUG - Edge anomaly scores shape: torch.Size([37510, 1])
2025-06-02 16:05:20,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:20,678 - DEBUG - Step 42: Loss=0.5781
2025-06-02 16:05:20,678 - DEBUG - Online update step: 43/50
2025-06-02 16:05:20,681 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:20,767 - DEBUG - Node anomaly scores shape: torch.Size([16903, 1])
2025-06-02 16:05:20,771 - DEBUG - Edge anomaly scores shape: torch.Size([35074, 1])
2025-06-02 16:05:20,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:20,963 - DEBUG - Step 43: Loss=0.5741
2025-06-02 16:05:20,963 - DEBUG - Online update step: 44/50
2025-06-02 16:05:20,967 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:21,084 - DEBUG - Node anomaly scores shape: torch.Size([19606, 1])
2025-06-02 16:05:21,089 - DEBUG - Edge anomaly scores shape: torch.Size([41107, 1])
2025-06-02 16:05:21,091 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:21,356 - DEBUG - Step 44: Loss=0.5768
2025-06-02 16:05:21,357 - DEBUG - Online update step: 45/50
2025-06-02 16:05:21,360 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:21,454 - DEBUG - Node anomaly scores shape: torch.Size([18940, 1])
2025-06-02 16:05:21,459 - DEBUG - Edge anomaly scores shape: torch.Size([39837, 1])
2025-06-02 16:05:21,460 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:21,661 - DEBUG - Step 45: Loss=0.5736
2025-06-02 16:05:21,661 - DEBUG - Online update step: 46/50
2025-06-02 16:05:21,664 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:21,771 - DEBUG - Node anomaly scores shape: torch.Size([19232, 1])
2025-06-02 16:05:21,775 - DEBUG - Edge anomaly scores shape: torch.Size([40212, 1])
2025-06-02 16:05:21,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:21,993 - DEBUG - Step 46: Loss=0.5759
2025-06-02 16:05:21,993 - DEBUG - Online update step: 47/50
2025-06-02 16:05:21,996 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:22,109 - DEBUG - Node anomaly scores shape: torch.Size([18617, 1])
2025-06-02 16:05:22,114 - DEBUG - Edge anomaly scores shape: torch.Size([39087, 1])
2025-06-02 16:05:22,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:22,374 - DEBUG - Step 47: Loss=0.5737
2025-06-02 16:05:22,375 - DEBUG - Online update step: 48/50
2025-06-02 16:05:22,380 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:22,473 - DEBUG - Node anomaly scores shape: torch.Size([18380, 1])
2025-06-02 16:05:22,477 - DEBUG - Edge anomaly scores shape: torch.Size([38433, 1])
2025-06-02 16:05:22,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:22,693 - DEBUG - Step 48: Loss=0.5769
2025-06-02 16:05:22,694 - DEBUG - Online update step: 49/50
2025-06-02 16:05:22,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:22,800 - DEBUG - Node anomaly scores shape: torch.Size([18375, 1])
2025-06-02 16:05:22,804 - DEBUG - Edge anomaly scores shape: torch.Size([38490, 1])
2025-06-02 16:05:22,805 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:23,048 - DEBUG - Step 49: Loss=0.5741
2025-06-02 16:05:23,048 - DEBUG - Online update step: 50/50
2025-06-02 16:05:23,051 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:23,146 - DEBUG - Node anomaly scores shape: torch.Size([17969, 1])
2025-06-02 16:05:23,149 - DEBUG - Edge anomaly scores shape: torch.Size([37360, 1])
2025-06-02 16:05:23,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:23,358 - DEBUG - Step 50: Loss=0.5766
2025-06-02 16:05:23,359 - INFO - Online update finished. Average loss: 0.5759, Learning rate: 0.001000
2025-06-02 16:05:23,360 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], current edge mean: [ 9.1480970e+00  1.4204494e+00  5.7028885e+00 -8.7452939e-10
  6.5589706e-10  0.0000000e+00 -2.1863236e-09 -2.5142721e-09
 -4.3726471e-09 -8.7452939e-10]
2025-06-02 16:05:23,360 - DEBUG - Node drift difference: 0.0104, Edge drift difference: 0.0049
2025-06-02 16:05:23,361 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -5.7450258e-09  1.3405061e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.8725129e-09
  1.4362564e-09 -1.9150086e-08  2.0107590e-08  9.5750430e-09
  2.2650602e+00  2.9618473e+00  1.4257029e-01  4.3945785e+00
  2.2980103e-08  3.4056225e+00  5.8022089e+00  7.6104417e+00
  1.4257029e-01  7.9929719e+00 -2.3937607e-09  1.1370364e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  4.2848320e-08  2.0586343e-08], edge=[ 9.1480970e+00  1.4204494e+00  5.7028885e+00 -8.7452939e-10
  6.5589706e-10  0.0000000e+00 -2.1863236e-09 -2.5142721e-09
 -4.3726471e-09 -8.7452939e-10]
2025-06-02 16:05:23,362 - DEBUG - Updated reference std: node=[0.         0.         1.0005023  1.0005023  0.         0.
 0.         1.0005023  1.0005023  1.0005023  1.0005023  1.0005023
 0.9383103  0.273724   0.3638916  0.5740894  1.0005023  3.008886
 2.9010541  1.4886004  0.3638916  0.22180349 1.0005023  1.0005023
 0.         0.         0.         0.         1.0005023  1.0005023 ], edge=[1.1073493 0.5056778 2.1382785 1.0002294 1.0002294 1.0002294 1.0002294
 1.0002294 1.0002294 1.0002294]
2025-06-02 16:05:23,362 - INFO - Online update complete. Loss: 0.5759
2025-06-02 16:05:23,362 - INFO - Running anomaly detection...
2025-06-02 16:05:23,362 - INFO - Starting anomaly detection.
2025-06-02 16:05:23,372 - DEBUG - Node reconstruction errors: [1.95416734e-02 3.60901445e-01 7.23351538e-02 3.48328450e-03
 2.18898933e-02 7.11613940e-03 1.89243808e-01 1.55820977e-02
 1.55820996e-02 1.65093895e-02 1.55821042e-02 3.85574647e-03
 3.86255354e-01 1.09549142e-01 1.95065513e-03 1.15714213e-02
 7.20514171e-03 1.15714427e-02 6.86755078e-03 1.11856908e-02
 1.60545651e-02 1.95065513e-03 2.03501824e-02 4.05850681e-03
 1.92076934e-03 3.28446226e-03 1.92076142e-03 2.77936179e-02
 1.53863095e-02 1.92076142e-03 5.61627299e-02 7.77017176e-02
 2.56490801e-02 3.46791791e-03 7.30299903e-03 2.05637328e-02
 5.84296770e-02 1.11857150e-02 3.60583663e-02 3.86870354e-02
 5.49118128e-03 1.70612009e-03 1.11857150e-02 5.59799420e-03
 9.96333919e-03 7.95506127e-03 1.19146323e-02 1.47160277e-01
 1.53706046e-02 6.67942241e-02 3.53392437e-02 4.50811768e-03
 2.96778977e-03 6.30260957e-03 1.66115575e-02 2.50853710e-02
 2.97987070e-02 1.09283924e-02 6.89296331e-03 9.13501624e-03
 1.05527051e-01 6.64331717e-03 1.53641077e-03 4.20537358e-03
 2.95004249e-02 1.66115556e-02 2.19251961e-03 1.66115258e-02
 1.53639843e-03 6.18988276e-03 1.84386652e-02 4.56388621e-03
 2.00733636e-03 1.18699456e-02 1.47782369e-02 4.58319345e-03
 6.67079072e-03 1.69613529e-02 7.05334125e-03 6.50697667e-03
 2.81424914e-03 1.24765374e-02 1.54634014e-01 3.25373672e-02
 6.98449742e-03 4.42619622e-03 3.35249454e-02 5.19931503e-03
 7.16811558e-03 7.47961029e-02 1.27850624e-03 2.64721252e-02
 1.44981011e-03 4.45843348e-03 2.77657411e-03 6.07922003e-02
 2.31041759e-03 4.05498780e-03 1.53185485e-03 1.78615395e-02
 2.65948265e-03 2.31041759e-03 3.45458672e-03 5.41917235e-02
 3.52027360e-03 1.77274700e-02 3.07961321e-03 2.24013366e-02
 1.42972148e-03 8.34616646e-02 3.81347202e-02 2.55026063e-03
 2.07160991e-02 2.10805181e-02 2.52596708e-03 8.72112811e-03
 2.35881167e-03 1.59507096e-02 3.62594146e-03 3.51644517e-03
 1.15627877e-03 1.34523632e-03 1.99324116e-02 3.09346756e-03
 8.48896336e-03 3.51466238e-03 2.11117323e-03 4.03841492e-03
 5.32613182e-03 2.17578537e-03 3.64794489e-03 2.56845425e-03
 9.31947455e-02 8.56481567e-02 2.22890079e-03 1.64307524e-02
 4.24080109e-03 1.39544636e-03 7.79685676e-02 2.00238563e-02
 2.26671412e-03 3.36140841e-02 1.19269791e-03 2.45512812e-03
 2.40261387e-03 3.90827330e-03 2.35651573e-03 8.06770697e-02
 3.29870638e-03 6.37493702e-03 1.34808213e-01 4.26395703e-03
 9.41717997e-03 2.56845425e-03 1.91121586e-02 1.71220340e-02
 1.82394334e-03 2.52300240e-02 2.65932665e-03 3.70938447e-03
 2.26656953e-03 7.79690072e-02 1.82393799e-03 3.64796747e-03
 2.24786880e-03 1.67816970e-02 4.08057263e-03 5.25806379e-03
 3.75194615e-03 6.28775125e-03 6.35701744e-03 3.48243653e-03
 1.23722514e-03 1.29685514e-02 3.62861878e-03 2.26140628e-03
 6.35463651e-03 1.71346944e-02 2.30335724e-03 2.30327388e-03
 1.80087574e-02 1.82387640e-03 3.63569357e-03 2.98284087e-02
 2.98213977e-02 3.70110874e-03 3.51851387e-03 1.05513968e-02
 1.66530684e-02 2.24492466e-03 2.11657882e-02 4.47325082e-03
 2.44641630e-03 1.90516736e-03 7.79645592e-02 2.38522608e-03
 1.82119191e-01 4.00989596e-03 2.12661978e-02 3.40967416e-03
 2.68833782e-03 1.82393496e-03 1.84626877e-02 5.90170640e-03
 4.41006012e-03 2.83854804e-03 1.67547166e-02 7.21952468e-02
 1.73589587e-03 9.09814052e-03 2.03466346e-03 6.44818554e-03
 2.27980968e-03 9.23824869e-03 6.56638946e-03 1.07006391e-03
 5.44106355e-03 2.35919049e-03 7.53606558e-02 2.75009917e-03
 2.70507969e-02 1.07506791e-03 1.13447988e-03 2.27980968e-03
 1.82394206e-03 1.12137450e-02 1.46375056e-02 1.99682009e-03
 7.21956370e-03 2.43391539e-03 3.11308284e-03 9.72194038e-03
 5.00164274e-03 2.35766196e-03 2.35887384e-03 2.44641607e-03
 5.14630927e-03 1.13447988e-03 1.82392716e-03 5.37795341e-03
 1.59235988e-02 5.25025325e-03 2.63225404e-03 8.63426086e-03
 1.87728286e-03 9.22861136e-03 1.16645182e-02 1.39216594e-02
 2.63225404e-03 1.97816803e-03 5.36946254e-03 1.10195309e-03
 7.53613263e-02 6.12887274e-03 5.30825462e-03 1.45858582e-02
 1.74746616e-03 1.78170996e-03 3.30674625e-03 2.30336050e-03
 8.29610601e-03 3.35298199e-03 7.82573503e-03 3.51725402e-03
 5.42664668e-03 2.55677314e-03 4.41433396e-03 4.60132584e-02
 4.41316050e-03 8.49480368e-03 5.91846220e-02 2.35398579e-02
 6.80465903e-03 5.03023248e-03 3.60015663e-03 3.78848389e-02
 8.81343323e-04 2.52066758e-02 1.80087462e-02 5.88683737e-03
 6.60276413e-02 8.93051212e-04 5.69809740e-03 4.15212056e-03
 1.06720505e-02 3.00795562e-03 6.71311915e-02 4.01712582e-03
 1.82386499e-03 5.17976098e-03 2.61406461e-03 2.06711399e-03
 3.77789885e-02 1.87728414e-03 8.71817619e-02 1.94568420e-03
 5.82924532e-03 2.32579885e-03 2.38527101e-03 5.51767182e-03
 4.97769425e-03 3.83683643e-03 3.67794046e-03 5.22314152e-03
 1.47809100e-03 1.47808820e-03 1.47808820e-03 3.87621764e-03
 3.20643582e-03 3.83681827e-03 1.47808820e-03 1.69137754e-02
 1.47808820e-03 2.02964200e-03 4.12067957e-03 7.42435269e-03
 7.89590329e-02 1.57088123e-03 2.21600151e-03 2.46572914e-03
 9.35840886e-03 4.04518098e-03 6.25629677e-03 3.67794419e-03
 2.24869736e-02 2.64663436e-02 1.03467777e-01 6.72207354e-03
 9.06148646e-03 9.05756559e-03 7.07058832e-02 2.31411308e-03
 1.47810997e-03 3.60009586e-03 1.47808227e-03 3.87622835e-03
 4.42043599e-03 9.79719218e-04 4.33462812e-03 1.58448413e-03
 3.83792142e-03 2.09055725e-03 1.58448319e-03 1.03123132e-02
 5.04858000e-03 4.83615603e-03 3.67785245e-03 2.94794817e-03
 4.88608889e-03 5.50706591e-03 1.47809705e-03 8.73773731e-03
 1.96322408e-02 5.89508796e-03 2.03516264e-03 1.74746348e-03
 4.19417536e-03 1.47808820e-03 1.41127850e-03 1.42388102e-02
 3.05427564e-03 2.55432026e-03 7.19623119e-02 7.58279674e-03
 3.67508712e-03 1.33567126e-02 3.08195595e-03 2.56689116e-02
 2.17951718e-03 2.00310233e-03 6.39715185e-03 7.00154761e-03
 7.66093889e-03 1.75036062e-02 5.18093398e-03 1.63342133e-02
 1.07861729e-03 2.85517029e-03 2.57036630e-02 1.47808820e-03
 3.67803918e-03 3.80257657e-03 2.28314451e-03 5.58236986e-03
 3.78583535e-03 6.30237209e-03 1.76584981e-02 3.04315262e-03
 9.39465407e-03 1.47809344e-03 5.12741692e-02 4.02165903e-03
 2.07568565e-03 1.77759118e-02 8.70467629e-03 8.72014184e-03
 8.73686466e-03 8.35042540e-03 1.46813539e-03 2.06220616e-02
 1.98509684e-03 2.21026354e-02 1.31876869e-02 1.46814797e-03
 3.73544591e-03 2.07420718e-03 7.07342662e-03 1.79659203e-03
 2.07574177e-03 2.29295474e-02 8.72712955e-03 2.07574014e-03
 1.46813539e-03 8.71540047e-03 8.72460939e-03 2.10097129e-03
 2.07687705e-03 8.73822533e-03 4.41075908e-03 1.35048840e-03
 1.58183696e-03 1.56728539e-03 2.06477474e-03 2.19949055e-03
 1.81711912e-02 1.75343512e-03 1.57271302e-03 3.17074358e-03
 4.53067478e-03 1.65468105e-03 4.17087413e-03 1.86337102e-02
 8.84422194e-03 1.17432121e-02 2.53292341e-02 8.71936604e-03
 1.64752011e-03 6.05032174e-03 1.94336995e-02 2.95408769e-03
 2.35095248e-03 2.55688978e-03 6.90498054e-02 8.61979963e-04
 1.67538924e-03 1.60462465e-02 2.57220827e-02 2.04666704e-03
 2.77396571e-03 2.15501362e-03 9.75005142e-03 9.52926232e-04
 2.22216407e-03 2.98471842e-03 9.52926232e-04 1.74652636e-02
 2.19970243e-03 1.97815872e-03 1.98903400e-03 4.35752934e-03
 2.17276672e-03 2.29795487e-03 2.14136927e-03 1.77302503e-03
 2.14084401e-03 2.29796860e-03 8.57076200e-04 3.32831382e-03
 4.10654861e-03 2.80891405e-03 8.57076200e-04 2.14425591e-03
 5.71048399e-03 3.96832116e-02 7.67060602e-03 1.86909467e-03
 3.32274893e-03 2.17276509e-03 8.94807337e-04 2.30291649e-03
 2.09471048e-03 8.06427822e-02 1.22070732e-03 2.04659486e-03
 1.72051601e-02 9.96882794e-04 9.52926232e-04 4.25039791e-03
 8.14663526e-03 3.96883488e-02 9.40002874e-03 8.94798664e-04
 5.63186500e-03 9.21902538e-04 1.56485997e-02 2.23731389e-03
 2.24579172e-03 1.72392260e-02 1.35999476e-03 2.30291556e-03
 6.33656234e-02 9.21915984e-04 6.49201944e-02 7.62857730e-04
 8.27519805e-04 1.55393151e-03 1.35994342e-03 7.87826255e-02
 1.90520438e-03 9.52926232e-04 1.54072349e-03 2.44679069e-03
 2.44680326e-03 8.83338449e-04 6.95270393e-03 1.06443232e-03
 1.36007497e-03 4.14713519e-03 2.94145895e-03 7.69306254e-03
 9.19640902e-03 2.55687395e-03 1.35992444e-03 4.94322507e-03
 8.27526150e-04 2.25121388e-03 3.14221741e-03 1.81498379e-03
 9.12826974e-03 5.28454361e-03 1.06442964e-03 6.31348090e-03
 1.36000325e-03 2.30291113e-03 2.24116421e-03 2.09397380e-03
 8.80541280e-03 5.55715151e-03 1.36000372e-03 1.03968587e-02
 1.36000372e-03 4.51053167e-03 2.39192322e-03 4.14732797e-03
 2.33216095e-03 1.01487199e-02 4.42430330e-03 1.27308851e-03
 1.66421041e-01 1.27308595e-03 1.27308851e-03 1.27308688e-03
 1.27308595e-03 1.27308688e-03 1.27308688e-03 1.27308688e-03
 4.66103433e-03 2.25930032e-03 8.29025079e-03 1.27309863e-03
 1.27308746e-03 1.27308688e-03 1.27308595e-03 1.27308688e-03
 1.27308746e-03 1.27308688e-03 1.27308688e-03 1.27308746e-03
 4.51398734e-03 1.27308432e-03 1.27308746e-03 1.94903910e-02
 1.27308688e-03 2.01739511e-03 9.83467232e-03 1.36000267e-03
 9.32569522e-03 1.07303206e-02 7.56608928e-03 7.56608928e-03
 5.93222538e-03 9.32569522e-03 1.36000477e-03 1.35992072e-03
 1.35992840e-03 3.37800267e-03 1.35994633e-03 2.60570599e-03
 1.93540961e-03 1.27315905e-03 2.55688559e-03 1.35999476e-03
 2.44679837e-03 1.35999476e-03 1.36000477e-03 2.69233342e-03
 1.36000221e-03 1.35992072e-03 1.35999476e-03 1.36000477e-03
 1.00316443e-02 1.35992444e-03 1.36000477e-03 1.35992863e-03
 1.36000186e-03 1.35999476e-03 1.36000267e-03 3.92697984e-03
 7.10938685e-03 2.18060007e-03 1.27308746e-03 1.62971690e-02
 8.98328610e-03 1.36000477e-03 1.35993154e-03 4.04994609e-03
 1.27309829e-03 2.42203032e-03 6.31545950e-03 1.38780649e-03
 1.35999476e-03 1.35999476e-03 9.79206339e-03 3.79285589e-03
 2.38920050e-03 1.36000663e-03 4.66100965e-03 1.51923089e-03
 1.35993364e-03 2.19654152e-03 1.27308746e-03 3.57356970e-03
 8.92829895e-03 1.27308688e-03 1.27308734e-03 4.66105482e-03
 1.51920028e-03 1.36000325e-03 7.57695958e-02 6.90924330e-03
 4.62057116e-03 3.79512040e-03 1.12657761e-03 7.24134035e-03
 7.24181253e-03 9.78471898e-03 8.88850016e-04 1.27308746e-03
 2.36345339e-03 8.55327304e-03 3.79380095e-03 2.04807287e-03
 9.45526990e-04 9.83462087e-04 1.20335596e-03 1.20335596e-03
 1.20335759e-03 1.20335759e-03 1.20335596e-03 4.97248303e-03
 7.01371627e-03 1.20335596e-03 1.20335014e-03 1.27308688e-03
 1.44426920e-03 1.27308688e-03 7.24204537e-03 7.37631507e-03
 1.55046564e-02 2.14962871e-03 1.06783928e-02 1.12178773e-02
 4.51394217e-03 2.25955527e-03 4.51397477e-03 1.27308688e-03
 7.24270893e-03 8.14205618e-04 1.27869041e-03 1.27869635e-03
 1.20335596e-03 8.14204803e-04 5.00725815e-03 2.77536805e-03
 1.80458173e-03 1.27308595e-03 1.20335759e-03 1.08581292e-03
 1.27868832e-03 2.89651076e-03 8.60436878e-04 1.88257510e-03
 4.97245323e-03 4.44826148e-02 8.58248270e-04 3.68743427e-02
 2.21136003e-03 8.60428263e-04 1.38840184e-03 8.13125109e-04
 8.31583398e-04 7.80026021e-04 6.22317521e-03 1.65623054e-03
 6.67166896e-03 8.60436878e-04 8.60439497e-04 8.60436878e-04
 8.13293853e-04 1.08581956e-03 8.60436878e-04 8.31583398e-04
 8.60436878e-04 8.60436878e-04 8.60436470e-04 2.48422730e-03
 8.20980640e-04 7.43548572e-03 6.48860727e-03 8.19537323e-03
 9.97868273e-03 1.59375870e-03 7.58041348e-03 1.09555339e-02
 7.95785105e-04 8.29317083e-04 7.51301297e-04 9.68107134e-02
 1.73468348e-02 8.31583398e-04 1.41341127e-02 7.90539756e-02
 7.95624626e-04 1.08018715e-03 1.55943586e-03 1.47209587e-02
 8.39877001e-04 8.39877001e-04 8.39877001e-04 1.01734872e-03
 7.18740514e-04 2.19743792e-03 2.12844945e-02 6.37978092e-02
 1.76706875e-03 7.28756597e-04 2.16542627e-03 1.08018517e-03
 1.75070716e-03 3.38456780e-03 7.50134524e-04 2.37408280e-03
 7.95621832e-04 7.93795735e-02 1.08018517e-03 3.40667390e-03
 1.40928722e-03 4.53265663e-03 8.39877001e-04 1.01736200e-03
 7.50121137e-04 2.25735456e-03 1.76158957e-02 1.01734651e-03
 1.01734069e-03 1.01734232e-03 5.16462419e-03 1.14419729e-01
 8.13298821e-01 8.39877001e-04 2.32085809e-02 1.01735129e-03
 7.66024506e-03 1.78196176e-03 1.39510687e-02 2.07955041e-03
 1.01734197e-03 9.81363235e-04 1.86746626e-03 7.62123498e-04
 2.32931644e-01 2.08024448e-03 2.09225826e-02 2.13797088e-03
 4.70267376e-03 2.07947800e-03 5.38786175e-03 1.78926028e-02
 3.36329476e-03 5.47670340e-03 7.27029005e-03 7.25481077e-04
 7.25446327e-04 1.50147928e-02 8.04414377e-02 5.63052949e-03
 2.07949313e-03 3.36328894e-03 2.07950268e-03 6.55626645e-04
 6.94244402e-04 6.94244402e-04 6.86670130e-04 6.17929688e-03
 7.16258015e-04 6.94244402e-04 6.55629789e-04 3.14966636e-03
 6.94244402e-04 6.94244402e-04 9.60128498e-04 1.14937627e-03
 5.07832598e-03 1.02132792e-02 6.94244402e-04 4.61963518e-03
 3.14966636e-03 6.94244402e-04 6.72664086e-04 1.23370416e-03
 6.73451170e-04 6.73451170e-04 5.03988750e-03 1.50829810e-03
 6.94244402e-04 1.50829414e-03 1.41612231e-03 1.04121165e-02
 2.03777198e-02 6.94244402e-04 8.05804953e-02 1.45351107e-03
 1.45352376e-03 2.26800982e-03 1.36729993e-03 1.65641517e-03
 6.72663329e-04 1.59951346e-03 6.48887595e-04 1.83331147e-02
 1.79744209e-03 1.83331240e-02 6.49437904e-02 6.50300004e-04
 1.79744209e-03 9.59515281e-04 9.59512952e-04 1.39285242e-02
 9.59515397e-04 1.94291514e-03 9.51815688e-04 1.84227657e-02
 1.85069069e-03 6.50297035e-04 1.85063889e-03 2.29994301e-03
 1.07039828e-02 5.57500590e-03 9.59515863e-04 2.09343433e-03
 2.37755338e-03 9.59515863e-04 4.56609856e-03 4.17389460e-02
 1.53259770e-03 6.50295580e-04 9.59514698e-04 7.70220757e-02
 1.45933649e-03 1.37456402e-03 9.59512719e-04 6.63479266e-04
 9.14289150e-03 6.63480198e-04 1.37571408e-03 6.63477229e-04
 6.39750017e-03 6.41467189e-03 9.51822195e-03 9.59514698e-04
 1.89012997e-02 1.37272838e-03 9.59514698e-04 4.25786637e-02
 1.37274910e-03 6.63479266e-04 1.37273117e-03 1.45933847e-03
 1.45933882e-03 3.84479132e-03 1.45935104e-03 9.59514698e-04
 1.00484130e-03 1.37273432e-03 1.18216802e-03 2.08186544e-02
 1.00484001e-03 1.45933824e-03 9.59514698e-04 2.40143621e-03
 7.13672489e-03 5.41763008e-03 5.42054046e-03 9.91704059e-04
 1.97557267e-02 2.33355793e-03 1.49004452e-03 1.14708848e-01
 5.41954720e-03 7.03148427e-04 5.42044966e-03 2.08677351e-03
 1.49007002e-03 5.41907642e-03 1.05886161e-03 8.61673849e-04
 1.47865410e-03 1.23636564e-03 7.83147931e-04 1.12560659e-03
 1.88914756e-03 9.11588722e-04 1.16573833e-03 1.16574706e-03
 7.86164030e-03 1.29483482e-02 1.16573670e-03 1.16574089e-03
 1.23685412e-02 9.72657837e-03 1.16573996e-03 1.16573833e-03
 1.16573845e-03 1.16574019e-03 1.29319727e-02 1.29470332e-02
 1.29479859e-02 1.29438182e-02 1.37563106e-02 1.87652966e-03
 1.29480977e-02 1.29479971e-02 1.37023544e-02 1.16573670e-03
 1.58915102e-01 1.37209035e-02 1.02395180e-03 1.29252784e-02
 8.99294741e-04 1.56424884e-02 2.30610501e-02 1.16573845e-03
 1.03931446e-02 1.56867187e-02 2.87359934e-02 7.88997393e-03
 7.88789336e-03 1.08571735e-03 7.89208803e-03 7.89221842e-03
 9.44438740e-04 9.66585334e-03 9.96340159e-03 1.26974855e-03
 1.26975239e-03 1.98452007e-02 1.95842562e-03 1.99125167e-02
 1.26975402e-03 2.75616515e-02 1.00903828e-02 1.08570966e-03
 1.27304513e-02 1.26975018e-03 3.46854329e-03 1.26975356e-03
 9.94458981e-03 1.15841266e-03 1.95839722e-03 1.99122988e-02
 1.00854607e-02 1.00900913e-02 1.95842702e-03 1.26974855e-03
 1.00730145e-02 1.00662867e-02 1.26974855e-03 1.15840591e-03
 2.02708878e-02 1.26975472e-03 1.85307290e-03 9.83844046e-04
 1.15840649e-03 9.83842532e-04 1.36639019e-02 1.36632742e-02]
2025-06-02 16:05:23,373 - DEBUG - Edge reconstruction errors: [1.363985   1.3614961  0.9577552  ... 0.15773967 1.2586238  0.15773967]
2025-06-02 16:05:23,375 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160523_update_48.json
2025-06-02 16:05:23,375 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:05:23,384 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160523_update_48.pth and as latest_checkpoint.pth
2025-06-02 16:05:23,384 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870535.dot): 0.1121
2025-06-02 16:05:23,384 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:05:23,385 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.3609, MLP Score: 0.5054
2025-06-02 16:05:23,385 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1892, MLP Score: 0.4902
2025-06-02 16:05:23,385 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3863, MLP Score: 0.4820
2025-06-02 16:05:23,385 - WARNING -   Node ID: 8.8.8.8, Recon Error: 0.1095, MLP Score: 0.4892
2025-06-02 16:05:23,385 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1472, MLP Score: 0.4872
2025-06-02 16:05:23,385 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:05:23,385 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.2342, MLP Score: 0.5067
2025-06-02 16:05:23,385 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.7499, MLP Score: 0.4520
2025-06-02 16:05:23,385 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4373, MLP Score: 0.4808
2025-06-02 16:05:23,385 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1701, MLP Score: 0.3835
2025-06-02 16:05:23,385 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7069, MLP Score: 0.4807
2025-06-02 16:05:23,385 - INFO - 
--- Processing file: nw_graph_encoded_1748870565.dot (Timestamp: 2025-06-02 15:22:45) ---
2025-06-02 16:05:23,386 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 16:05:23,386 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 16:05:23,417 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 16:05:23,448 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 16:05:23,448 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 16:05:23,448 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870565.dot
2025-06-02 16:05:23,470 - INFO - Parsed 1002 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 16:05:23,492 - INFO - Parsed 2201 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870565.dot'.
2025-06-02 16:05:23,492 - INFO - Processing node updates/additions.
2025-06-02 16:05:23,497 - INFO - Processing edge updates/additions.
2025-06-02 16:05:23,508 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:05:23,509 - INFO - Finished updating NetworkX graph.
2025-06-02 16:05:23,509 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:05:23,510 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:05:23,518 - DEBUG - Initial node features tensor shape: torch.Size([1002, 30])
2025-06-02 16:05:23,520 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:05:23,520 - DEBUG - Node features tensor shape after scaling: torch.Size([1002, 30])
2025-06-02 16:05:23,521 - DEBUG - Edge index tensor shape: torch.Size([2, 2201])
2025-06-02 16:05:23,522 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:05:23,526 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:05:23,528 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:05:23,529 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:05:23,530 - DEBUG - Shape of encoded categorical edge features: torch.Size([2201, 3])
2025-06-02 16:05:23,531 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:05:23,531 - DEBUG - Shape of scaled numerical edge features: torch.Size([2201, 7])
2025-06-02 16:05:23,531 - DEBUG - Final edge attributes tensor shape: torch.Size([2201, 10])
2025-06-02 16:05:23,531 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:05:23,534 - INFO - Performing online update...
2025-06-02 16:05:23,534 - INFO - Starting online update for 50 steps.
2025-06-02 16:05:23,534 - DEBUG - Updated RunningStats: new_mean=0.94498078497351, new_var=28200000000161.395, new_n=2850
2025-06-02 16:05:23,534 - DEBUG - Updated RunningStats: new_mean=0.9428342472347508, new_var=28500000000018.305, new_n=2880
2025-06-02 16:05:23,535 - DEBUG - Updated RunningStats: new_mean=1.1598984764025904, new_var=9400000000093.924, new_n=950
2025-06-02 16:05:23,535 - DEBUG - Updated RunningStats: new_mean=1.159007636137512, new_var=9500000000001.557, new_n=960
2025-06-02 16:05:23,535 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:05:23,535 - DEBUG - Online update step: 1/50
2025-06-02 16:05:23,537 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:23,715 - DEBUG - Node anomaly scores shape: torch.Size([19641, 1])
2025-06-02 16:05:23,720 - DEBUG - Edge anomaly scores shape: torch.Size([41178, 1])
2025-06-02 16:05:23,722 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:23,922 - DEBUG - Step 1: Loss=0.5738
2025-06-02 16:05:23,923 - DEBUG - Online update step: 2/50
2025-06-02 16:05:23,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:24,056 - DEBUG - Node anomaly scores shape: torch.Size([19196, 1])
2025-06-02 16:05:24,061 - DEBUG - Edge anomaly scores shape: torch.Size([40307, 1])
2025-06-02 16:05:24,062 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:24,277 - DEBUG - Step 2: Loss=0.5772
2025-06-02 16:05:24,277 - DEBUG - Online update step: 3/50
2025-06-02 16:05:24,280 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:24,456 - DEBUG - Node anomaly scores shape: torch.Size([20254, 1])
2025-06-02 16:05:24,461 - DEBUG - Edge anomaly scores shape: torch.Size([42621, 1])
2025-06-02 16:05:24,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:24,734 - DEBUG - Step 3: Loss=0.5735
2025-06-02 16:05:24,735 - DEBUG - Online update step: 4/50
2025-06-02 16:05:24,738 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:24,843 - DEBUG - Node anomaly scores shape: torch.Size([19580, 1])
2025-06-02 16:05:24,847 - DEBUG - Edge anomaly scores shape: torch.Size([41204, 1])
2025-06-02 16:05:24,849 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:25,110 - DEBUG - Step 4: Loss=0.5769
2025-06-02 16:05:25,111 - DEBUG - Online update step: 5/50
2025-06-02 16:05:25,116 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:25,211 - DEBUG - Node anomaly scores shape: torch.Size([18903, 1])
2025-06-02 16:05:25,215 - DEBUG - Edge anomaly scores shape: torch.Size([39444, 1])
2025-06-02 16:05:25,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:25,431 - DEBUG - Step 5: Loss=0.5729
2025-06-02 16:05:25,432 - DEBUG - Online update step: 6/50
2025-06-02 16:05:25,437 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:25,535 - DEBUG - Node anomaly scores shape: torch.Size([18387, 1])
2025-06-02 16:05:25,539 - DEBUG - Edge anomaly scores shape: torch.Size([38405, 1])
2025-06-02 16:05:25,541 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:25,767 - DEBUG - Step 6: Loss=0.5764
2025-06-02 16:05:25,767 - DEBUG - Online update step: 7/50
2025-06-02 16:05:25,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:25,882 - DEBUG - Node anomaly scores shape: torch.Size([18722, 1])
2025-06-02 16:05:25,887 - DEBUG - Edge anomaly scores shape: torch.Size([39263, 1])
2025-06-02 16:05:25,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:26,109 - DEBUG - Step 7: Loss=0.5733
2025-06-02 16:05:26,109 - DEBUG - Online update step: 8/50
2025-06-02 16:05:26,112 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:26,218 - DEBUG - Node anomaly scores shape: torch.Size([20346, 1])
2025-06-02 16:05:26,225 - DEBUG - Edge anomaly scores shape: torch.Size([42917, 1])
2025-06-02 16:05:26,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:26,462 - DEBUG - Step 8: Loss=0.5767
2025-06-02 16:05:26,462 - DEBUG - Online update step: 9/50
2025-06-02 16:05:26,466 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:26,570 - DEBUG - Node anomaly scores shape: torch.Size([18742, 1])
2025-06-02 16:05:26,574 - DEBUG - Edge anomaly scores shape: torch.Size([39208, 1])
2025-06-02 16:05:26,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:26,778 - DEBUG - Step 9: Loss=0.5730
2025-06-02 16:05:26,778 - DEBUG - Online update step: 10/50
2025-06-02 16:05:26,781 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:26,894 - DEBUG - Node anomaly scores shape: torch.Size([19359, 1])
2025-06-02 16:05:26,900 - DEBUG - Edge anomaly scores shape: torch.Size([40551, 1])
2025-06-02 16:05:26,901 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:27,116 - DEBUG - Step 10: Loss=0.5772
2025-06-02 16:05:27,116 - DEBUG - Online update step: 11/50
2025-06-02 16:05:27,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:27,226 - DEBUG - Node anomaly scores shape: torch.Size([19572, 1])
2025-06-02 16:05:27,230 - DEBUG - Edge anomaly scores shape: torch.Size([41096, 1])
2025-06-02 16:05:27,231 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:27,474 - DEBUG - Step 11: Loss=0.5735
2025-06-02 16:05:27,474 - DEBUG - Online update step: 12/50
2025-06-02 16:05:27,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:27,585 - DEBUG - Node anomaly scores shape: torch.Size([18761, 1])
2025-06-02 16:05:27,589 - DEBUG - Edge anomaly scores shape: torch.Size([39387, 1])
2025-06-02 16:05:27,591 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:27,832 - DEBUG - Step 12: Loss=0.5770
2025-06-02 16:05:27,832 - DEBUG - Online update step: 13/50
2025-06-02 16:05:27,835 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:27,942 - DEBUG - Node anomaly scores shape: torch.Size([20373, 1])
2025-06-02 16:05:27,946 - DEBUG - Edge anomaly scores shape: torch.Size([42820, 1])
2025-06-02 16:05:27,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:28,195 - DEBUG - Step 13: Loss=0.5730
2025-06-02 16:05:28,195 - DEBUG - Online update step: 14/50
2025-06-02 16:05:28,198 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:28,301 - DEBUG - Node anomaly scores shape: torch.Size([20847, 1])
2025-06-02 16:05:28,306 - DEBUG - Edge anomaly scores shape: torch.Size([43985, 1])
2025-06-02 16:05:28,307 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:28,583 - DEBUG - Step 14: Loss=0.5766
2025-06-02 16:05:28,583 - DEBUG - Online update step: 15/50
2025-06-02 16:05:28,587 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:28,718 - DEBUG - Node anomaly scores shape: torch.Size([21251, 1])
2025-06-02 16:05:28,726 - DEBUG - Edge anomaly scores shape: torch.Size([45059, 1])
2025-06-02 16:05:28,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:28,994 - DEBUG - Step 15: Loss=0.5729
2025-06-02 16:05:28,994 - DEBUG - Online update step: 16/50
2025-06-02 16:05:28,997 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:29,097 - DEBUG - Node anomaly scores shape: torch.Size([19307, 1])
2025-06-02 16:05:29,102 - DEBUG - Edge anomaly scores shape: torch.Size([40388, 1])
2025-06-02 16:05:29,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:29,355 - DEBUG - Step 16: Loss=0.5761
2025-06-02 16:05:29,355 - DEBUG - Online update step: 17/50
2025-06-02 16:05:29,358 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:29,482 - DEBUG - Node anomaly scores shape: torch.Size([21382, 1])
2025-06-02 16:05:29,487 - DEBUG - Edge anomaly scores shape: torch.Size([45074, 1])
2025-06-02 16:05:29,489 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:29,756 - DEBUG - Step 17: Loss=0.5738
2025-06-02 16:05:29,756 - DEBUG - Online update step: 18/50
2025-06-02 16:05:29,759 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:29,867 - DEBUG - Node anomaly scores shape: torch.Size([20222, 1])
2025-06-02 16:05:29,872 - DEBUG - Edge anomaly scores shape: torch.Size([42418, 1])
2025-06-02 16:05:29,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:30,113 - DEBUG - Step 18: Loss=0.5761
2025-06-02 16:05:30,114 - DEBUG - Online update step: 19/50
2025-06-02 16:05:30,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:30,230 - DEBUG - Node anomaly scores shape: torch.Size([20691, 1])
2025-06-02 16:05:30,234 - DEBUG - Edge anomaly scores shape: torch.Size([43594, 1])
2025-06-02 16:05:30,236 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:30,491 - DEBUG - Step 19: Loss=0.5733
2025-06-02 16:05:30,491 - DEBUG - Online update step: 20/50
2025-06-02 16:05:30,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:30,606 - DEBUG - Node anomaly scores shape: torch.Size([20238, 1])
2025-06-02 16:05:30,611 - DEBUG - Edge anomaly scores shape: torch.Size([42530, 1])
2025-06-02 16:05:30,612 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:30,855 - DEBUG - Step 20: Loss=0.5759
2025-06-02 16:05:30,855 - DEBUG - Online update step: 21/50
2025-06-02 16:05:30,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:30,977 - DEBUG - Node anomaly scores shape: torch.Size([19640, 1])
2025-06-02 16:05:30,982 - DEBUG - Edge anomaly scores shape: torch.Size([41225, 1])
2025-06-02 16:05:30,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:31,194 - DEBUG - Step 21: Loss=0.5722
2025-06-02 16:05:31,195 - DEBUG - Online update step: 22/50
2025-06-02 16:05:31,198 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:31,312 - DEBUG - Node anomaly scores shape: torch.Size([19847, 1])
2025-06-02 16:05:31,318 - DEBUG - Edge anomaly scores shape: torch.Size([41568, 1])
2025-06-02 16:05:31,319 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:31,556 - DEBUG - Step 22: Loss=0.5764
2025-06-02 16:05:31,557 - DEBUG - Online update step: 23/50
2025-06-02 16:05:31,560 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:31,676 - DEBUG - Node anomaly scores shape: torch.Size([18165, 1])
2025-06-02 16:05:31,680 - DEBUG - Edge anomaly scores shape: torch.Size([37909, 1])
2025-06-02 16:05:31,681 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:31,900 - DEBUG - Step 23: Loss=0.5736
2025-06-02 16:05:31,900 - DEBUG - Online update step: 24/50
2025-06-02 16:05:31,903 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:32,037 - DEBUG - Node anomaly scores shape: torch.Size([21444, 1])
2025-06-02 16:05:32,042 - DEBUG - Edge anomaly scores shape: torch.Size([45267, 1])
2025-06-02 16:05:32,043 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:32,275 - DEBUG - Step 24: Loss=0.5758
2025-06-02 16:05:32,275 - DEBUG - Online update step: 25/50
2025-06-02 16:05:32,278 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:32,396 - DEBUG - Node anomaly scores shape: torch.Size([20174, 1])
2025-06-02 16:05:32,401 - DEBUG - Edge anomaly scores shape: torch.Size([42388, 1])
2025-06-02 16:05:32,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:32,647 - DEBUG - Step 25: Loss=0.5729
2025-06-02 16:05:32,647 - DEBUG - Online update step: 26/50
2025-06-02 16:05:32,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:32,761 - DEBUG - Node anomaly scores shape: torch.Size([20044, 1])
2025-06-02 16:05:32,766 - DEBUG - Edge anomaly scores shape: torch.Size([42044, 1])
2025-06-02 16:05:32,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:33,023 - DEBUG - Step 26: Loss=0.5757
2025-06-02 16:05:33,024 - DEBUG - Online update step: 27/50
2025-06-02 16:05:33,030 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:33,137 - DEBUG - Node anomaly scores shape: torch.Size([19261, 1])
2025-06-02 16:05:33,142 - DEBUG - Edge anomaly scores shape: torch.Size([40417, 1])
2025-06-02 16:05:33,143 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:33,385 - DEBUG - Step 27: Loss=0.5730
2025-06-02 16:05:33,385 - DEBUG - Online update step: 28/50
2025-06-02 16:05:33,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:33,504 - DEBUG - Node anomaly scores shape: torch.Size([18246, 1])
2025-06-02 16:05:33,508 - DEBUG - Edge anomaly scores shape: torch.Size([38260, 1])
2025-06-02 16:05:33,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:33,755 - DEBUG - Step 28: Loss=0.5766
2025-06-02 16:05:33,755 - DEBUG - Online update step: 29/50
2025-06-02 16:05:33,760 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:33,867 - DEBUG - Node anomaly scores shape: torch.Size([18263, 1])
2025-06-02 16:05:33,872 - DEBUG - Edge anomaly scores shape: torch.Size([38108, 1])
2025-06-02 16:05:33,873 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:34,074 - DEBUG - Step 29: Loss=0.5725
2025-06-02 16:05:34,074 - DEBUG - Online update step: 30/50
2025-06-02 16:05:34,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:34,190 - DEBUG - Node anomaly scores shape: torch.Size([19031, 1])
2025-06-02 16:05:34,195 - DEBUG - Edge anomaly scores shape: torch.Size([39934, 1])
2025-06-02 16:05:34,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:34,413 - DEBUG - Step 30: Loss=0.5767
2025-06-02 16:05:34,413 - DEBUG - Online update step: 31/50
2025-06-02 16:05:34,416 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:34,512 - DEBUG - Node anomaly scores shape: torch.Size([18443, 1])
2025-06-02 16:05:34,516 - DEBUG - Edge anomaly scores shape: torch.Size([38592, 1])
2025-06-02 16:05:34,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:34,729 - DEBUG - Step 31: Loss=0.5737
2025-06-02 16:05:34,729 - DEBUG - Online update step: 32/50
2025-06-02 16:05:34,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:34,858 - DEBUG - Node anomaly scores shape: torch.Size([19976, 1])
2025-06-02 16:05:34,866 - DEBUG - Edge anomaly scores shape: torch.Size([41860, 1])
2025-06-02 16:05:34,867 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:35,123 - DEBUG - Step 32: Loss=0.5756
2025-06-02 16:05:35,124 - DEBUG - Online update step: 33/50
2025-06-02 16:05:35,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:35,241 - DEBUG - Node anomaly scores shape: torch.Size([19477, 1])
2025-06-02 16:05:35,244 - DEBUG - Edge anomaly scores shape: torch.Size([41145, 1])
2025-06-02 16:05:35,246 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:35,521 - DEBUG - Step 33: Loss=0.5726
2025-06-02 16:05:35,521 - DEBUG - Online update step: 34/50
2025-06-02 16:05:35,526 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:35,621 - DEBUG - Node anomaly scores shape: torch.Size([18974, 1])
2025-06-02 16:05:35,625 - DEBUG - Edge anomaly scores shape: torch.Size([39773, 1])
2025-06-02 16:05:35,626 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:35,846 - DEBUG - Step 34: Loss=0.5767
2025-06-02 16:05:35,847 - DEBUG - Online update step: 35/50
2025-06-02 16:05:35,853 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:35,967 - DEBUG - Node anomaly scores shape: torch.Size([19165, 1])
2025-06-02 16:05:35,971 - DEBUG - Edge anomaly scores shape: torch.Size([40263, 1])
2025-06-02 16:05:35,973 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:36,227 - DEBUG - Step 35: Loss=0.5730
2025-06-02 16:05:36,228 - DEBUG - Online update step: 36/50
2025-06-02 16:05:36,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:36,333 - DEBUG - Node anomaly scores shape: torch.Size([18953, 1])
2025-06-02 16:05:36,338 - DEBUG - Edge anomaly scores shape: torch.Size([39812, 1])
2025-06-02 16:05:36,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:36,608 - DEBUG - Step 36: Loss=0.5769
2025-06-02 16:05:36,608 - DEBUG - Online update step: 37/50
2025-06-02 16:05:36,613 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:36,710 - DEBUG - Node anomaly scores shape: torch.Size([18923, 1])
2025-06-02 16:05:36,715 - DEBUG - Edge anomaly scores shape: torch.Size([39468, 1])
2025-06-02 16:05:36,716 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:36,944 - DEBUG - Step 37: Loss=0.5732
2025-06-02 16:05:36,945 - DEBUG - Online update step: 38/50
2025-06-02 16:05:36,950 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:37,053 - DEBUG - Node anomaly scores shape: torch.Size([19537, 1])
2025-06-02 16:05:37,058 - DEBUG - Edge anomaly scores shape: torch.Size([41108, 1])
2025-06-02 16:05:37,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:37,290 - DEBUG - Step 38: Loss=0.5757
2025-06-02 16:05:37,290 - DEBUG - Online update step: 39/50
2025-06-02 16:05:37,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:37,423 - DEBUG - Node anomaly scores shape: torch.Size([19700, 1])
2025-06-02 16:05:37,428 - DEBUG - Edge anomaly scores shape: torch.Size([41632, 1])
2025-06-02 16:05:37,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:37,669 - DEBUG - Step 39: Loss=0.5721
2025-06-02 16:05:37,670 - DEBUG - Online update step: 40/50
2025-06-02 16:05:37,675 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:37,785 - DEBUG - Node anomaly scores shape: torch.Size([19467, 1])
2025-06-02 16:05:37,790 - DEBUG - Edge anomaly scores shape: torch.Size([40995, 1])
2025-06-02 16:05:37,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:38,052 - DEBUG - Step 40: Loss=0.5753
2025-06-02 16:05:38,053 - DEBUG - Online update step: 41/50
2025-06-02 16:05:38,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:38,164 - DEBUG - Node anomaly scores shape: torch.Size([20408, 1])
2025-06-02 16:05:38,169 - DEBUG - Edge anomaly scores shape: torch.Size([43068, 1])
2025-06-02 16:05:38,170 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:38,433 - DEBUG - Step 41: Loss=0.5718
2025-06-02 16:05:38,433 - DEBUG - Online update step: 42/50
2025-06-02 16:05:38,439 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:38,555 - DEBUG - Node anomaly scores shape: torch.Size([19669, 1])
2025-06-02 16:05:38,559 - DEBUG - Edge anomaly scores shape: torch.Size([41178, 1])
2025-06-02 16:05:38,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:38,782 - DEBUG - Step 42: Loss=0.5758
2025-06-02 16:05:38,782 - DEBUG - Online update step: 43/50
2025-06-02 16:05:38,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:38,900 - DEBUG - Node anomaly scores shape: torch.Size([19844, 1])
2025-06-02 16:05:38,905 - DEBUG - Edge anomaly scores shape: torch.Size([41795, 1])
2025-06-02 16:05:38,906 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:39,166 - DEBUG - Step 43: Loss=0.5737
2025-06-02 16:05:39,166 - DEBUG - Online update step: 44/50
2025-06-02 16:05:39,169 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:39,245 - DEBUG - Node anomaly scores shape: torch.Size([18137, 1])
2025-06-02 16:05:39,250 - DEBUG - Edge anomaly scores shape: torch.Size([37738, 1])
2025-06-02 16:05:39,251 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:39,451 - DEBUG - Step 44: Loss=0.5756
2025-06-02 16:05:39,451 - DEBUG - Online update step: 45/50
2025-06-02 16:05:39,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:39,572 - DEBUG - Node anomaly scores shape: torch.Size([18353, 1])
2025-06-02 16:05:39,576 - DEBUG - Edge anomaly scores shape: torch.Size([38399, 1])
2025-06-02 16:05:39,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:39,827 - DEBUG - Step 45: Loss=0.5728
2025-06-02 16:05:39,827 - DEBUG - Online update step: 46/50
2025-06-02 16:05:39,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:39,942 - DEBUG - Node anomaly scores shape: torch.Size([20305, 1])
2025-06-02 16:05:39,946 - DEBUG - Edge anomaly scores shape: torch.Size([42685, 1])
2025-06-02 16:05:39,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:40,210 - DEBUG - Step 46: Loss=0.5755
2025-06-02 16:05:40,210 - DEBUG - Online update step: 47/50
2025-06-02 16:05:40,214 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:40,310 - DEBUG - Node anomaly scores shape: torch.Size([19306, 1])
2025-06-02 16:05:40,314 - DEBUG - Edge anomaly scores shape: torch.Size([40509, 1])
2025-06-02 16:05:40,315 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:40,567 - DEBUG - Step 47: Loss=0.5722
2025-06-02 16:05:40,567 - DEBUG - Online update step: 48/50
2025-06-02 16:05:40,574 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:40,681 - DEBUG - Node anomaly scores shape: torch.Size([18512, 1])
2025-06-02 16:05:40,686 - DEBUG - Edge anomaly scores shape: torch.Size([38748, 1])
2025-06-02 16:05:40,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:40,927 - DEBUG - Step 48: Loss=0.5758
2025-06-02 16:05:40,928 - DEBUG - Online update step: 49/50
2025-06-02 16:05:40,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:41,030 - DEBUG - Node anomaly scores shape: torch.Size([19292, 1])
2025-06-02 16:05:41,036 - DEBUG - Edge anomaly scores shape: torch.Size([40574, 1])
2025-06-02 16:05:41,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:41,262 - DEBUG - Step 49: Loss=0.5719
2025-06-02 16:05:41,262 - DEBUG - Online update step: 50/50
2025-06-02 16:05:41,266 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:41,348 - DEBUG - Node anomaly scores shape: torch.Size([18620, 1])
2025-06-02 16:05:41,353 - DEBUG - Edge anomaly scores shape: torch.Size([38792, 1])
2025-06-02 16:05:41,356 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:41,574 - DEBUG - Step 50: Loss=0.5759
2025-06-02 16:05:41,575 - INFO - Online update finished. Average loss: 0.5746, Learning rate: 0.001000
2025-06-02 16:05:41,576 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], current edge mean: [ 9.1467514e+00  1.4257156e+00  5.7010450e+00 -8.6658275e-10
  2.3831026e-09 -2.1664568e-09  6.4993708e-09  2.1664569e-10
  4.1162682e-09  3.0330396e-09]
2025-06-02 16:05:41,576 - DEBUG - Node drift difference: 0.0196, Edge drift difference: 0.0104
2025-06-02 16:05:41,579 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -4.1402028e-08 -1.1897135e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  2.4746040e-08
 -2.0463071e-08 -1.6299074e-08  3.4263749e-08 -4.7588538e-09
  2.2634730e+00  2.9620759e+00  1.4970060e-01  4.3922157e+00
  1.6299074e-08  3.4391217e+00  5.7734532e+00  7.6127744e+00
  1.4970060e-01  7.9930139e+00 -2.3318384e-08  3.9379515e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  2.8791066e-08  8.0900513e-09], edge=[ 9.1467514e+00  1.4257156e+00  5.7010450e+00 -8.6658275e-10
  2.3831026e-09 -2.1664568e-09  6.4993708e-09  2.1664569e-10
  4.1162682e-09  3.0330396e-09]
2025-06-02 16:05:41,580 - DEBUG - Updated reference std: node=[0.         0.         1.0004994  1.0004994  0.         0.
 0.         1.0004994  1.0004994  1.0004994  1.0004994  1.0004994
 0.93571764 0.27291828 0.3706852  0.573176   1.0004994  3.0238457
 2.9087992  1.4844369  0.3706852  0.2211384  1.0004994  1.0004994
 0.         0.         0.         0.         1.0004994  1.0004994 ], edge=[1.102394   0.50637054 2.133423   1.0002272  1.0002272  1.0002272
 1.0002272  1.0002272  1.0002272  1.0002272 ]
2025-06-02 16:05:41,580 - INFO - Online update complete. Loss: 0.5746
2025-06-02 16:05:41,580 - INFO - Running anomaly detection...
2025-06-02 16:05:41,581 - INFO - Starting anomaly detection.
2025-06-02 16:05:41,599 - DEBUG - Node reconstruction errors: [0.01720583 0.30903405 0.06887887 ... 0.01320886 0.00830028 0.01246262]
2025-06-02 16:05:41,600 - DEBUG - Edge reconstruction errors: [1.364103   1.3616028  0.95784456 ... 0.15782909 1.2587173  0.15782909]
2025-06-02 16:05:41,603 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160541_update_49.json
2025-06-02 16:05:41,604 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:05:41,624 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160541_update_49.pth and as latest_checkpoint.pth
2025-06-02 16:05:41,625 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870565.dot): 0.1165
2025-06-02 16:05:41,625 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 16:05:41,625 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.3090, MLP Score: 0.5217
2025-06-02 16:05:41,625 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2007, MLP Score: 0.5065
2025-06-02 16:05:41,626 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3761, MLP Score: 0.4977
2025-06-02 16:05:41,626 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1382, MLP Score: 0.4967
2025-06-02 16:05:41,626 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.1064, MLP Score: 0.4940
2025-06-02 16:05:41,626 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:05:41,626 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3204, MLP Score: 0.5325
2025-06-02 16:05:41,626 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8339, MLP Score: 0.4763
2025-06-02 16:05:41,626 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4451, MLP Score: 0.4999
2025-06-02 16:05:41,626 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1907, MLP Score: 0.4254
2025-06-02 16:05:41,626 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7223, MLP Score: 0.5056
2025-06-02 16:05:41,626 - INFO - 
--- Processing file: nw_graph_encoded_1748870595.dot (Timestamp: 2025-06-02 15:23:15) ---
2025-06-02 16:05:41,626 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 16:05:41,626 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 16:05:41,656 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 16:05:41,682 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 16:05:41,682 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 16:05:41,682 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870595.dot
2025-06-02 16:05:41,702 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 16:05:41,723 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870595.dot'.
2025-06-02 16:05:41,723 - INFO - Processing node updates/additions.
2025-06-02 16:05:41,728 - INFO - Processing edge updates/additions.
2025-06-02 16:05:41,738 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:05:41,739 - INFO - Finished updating NetworkX graph.
2025-06-02 16:05:41,739 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:05:41,740 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:05:41,748 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:05:41,749 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:05:41,749 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:05:41,750 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:05:41,751 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:05:41,756 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:05:41,757 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:05:41,758 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:05:41,759 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:05:41,760 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:05:41,760 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:05:41,760 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:05:41,760 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:05:41,763 - INFO - Performing online update...
2025-06-02 16:05:41,763 - INFO - Starting online update for 50 steps.
2025-06-02 16:05:41,764 - DEBUG - Updated RunningStats: new_mean=0.9450520328433731, new_var=28800000000161.414, new_n=2910
2025-06-02 16:05:41,764 - DEBUG - Updated RunningStats: new_mean=0.942950469417523, new_var=29100000000018.3, new_n=2940
2025-06-02 16:05:41,764 - DEBUG - Updated RunningStats: new_mean=1.163832982827701, new_var=9600000000093.861, new_n=970
2025-06-02 16:05:41,764 - DEBUG - Updated RunningStats: new_mean=1.1629229218740786, new_var=9700000000001.568, new_n=980
2025-06-02 16:05:41,764 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:05:41,764 - DEBUG - Online update step: 1/50
2025-06-02 16:05:41,766 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:41,950 - DEBUG - Node anomaly scores shape: torch.Size([20691, 1])
2025-06-02 16:05:41,957 - DEBUG - Edge anomaly scores shape: torch.Size([43554, 1])
2025-06-02 16:05:41,958 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:42,199 - DEBUG - Step 1: Loss=0.5731
2025-06-02 16:05:42,199 - DEBUG - Online update step: 2/50
2025-06-02 16:05:42,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:42,310 - DEBUG - Node anomaly scores shape: torch.Size([20400, 1])
2025-06-02 16:05:42,315 - DEBUG - Edge anomaly scores shape: torch.Size([42975, 1])
2025-06-02 16:05:42,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:42,578 - DEBUG - Step 2: Loss=0.5757
2025-06-02 16:05:42,578 - DEBUG - Online update step: 3/50
2025-06-02 16:05:42,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:42,696 - DEBUG - Node anomaly scores shape: torch.Size([20391, 1])
2025-06-02 16:05:42,701 - DEBUG - Edge anomaly scores shape: torch.Size([42987, 1])
2025-06-02 16:05:42,703 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:42,956 - DEBUG - Step 3: Loss=0.5721
2025-06-02 16:05:42,956 - DEBUG - Online update step: 4/50
2025-06-02 16:05:42,960 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:43,043 - DEBUG - Node anomaly scores shape: torch.Size([17161, 1])
2025-06-02 16:05:43,047 - DEBUG - Edge anomaly scores shape: torch.Size([35764, 1])
2025-06-02 16:05:43,048 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:43,243 - DEBUG - Step 4: Loss=0.5760
2025-06-02 16:05:43,243 - DEBUG - Online update step: 5/50
2025-06-02 16:05:43,246 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:43,340 - DEBUG - Node anomaly scores shape: torch.Size([18706, 1])
2025-06-02 16:05:43,345 - DEBUG - Edge anomaly scores shape: torch.Size([39087, 1])
2025-06-02 16:05:43,347 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:43,575 - DEBUG - Step 5: Loss=0.5727
2025-06-02 16:05:43,576 - DEBUG - Online update step: 6/50
2025-06-02 16:05:43,579 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:43,719 - DEBUG - Node anomaly scores shape: torch.Size([21170, 1])
2025-06-02 16:05:43,725 - DEBUG - Edge anomaly scores shape: torch.Size([44790, 1])
2025-06-02 16:05:43,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:43,996 - DEBUG - Step 6: Loss=0.5751
2025-06-02 16:05:43,997 - DEBUG - Online update step: 7/50
2025-06-02 16:05:44,000 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:44,090 - DEBUG - Node anomaly scores shape: torch.Size([17051, 1])
2025-06-02 16:05:44,093 - DEBUG - Edge anomaly scores shape: torch.Size([35517, 1])
2025-06-02 16:05:44,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:44,287 - DEBUG - Step 7: Loss=0.5725
2025-06-02 16:05:44,288 - DEBUG - Online update step: 8/50
2025-06-02 16:05:44,291 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:44,400 - DEBUG - Node anomaly scores shape: torch.Size([20271, 1])
2025-06-02 16:05:44,405 - DEBUG - Edge anomaly scores shape: torch.Size([42787, 1])
2025-06-02 16:05:44,407 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:44,663 - DEBUG - Step 8: Loss=0.5757
2025-06-02 16:05:44,663 - DEBUG - Online update step: 9/50
2025-06-02 16:05:44,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:44,781 - DEBUG - Node anomaly scores shape: torch.Size([20534, 1])
2025-06-02 16:05:44,786 - DEBUG - Edge anomaly scores shape: torch.Size([43249, 1])
2025-06-02 16:05:44,787 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:45,032 - DEBUG - Step 9: Loss=0.5723
2025-06-02 16:05:45,032 - DEBUG - Online update step: 10/50
2025-06-02 16:05:45,036 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:45,147 - DEBUG - Node anomaly scores shape: torch.Size([21002, 1])
2025-06-02 16:05:45,152 - DEBUG - Edge anomaly scores shape: torch.Size([44195, 1])
2025-06-02 16:05:45,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:45,401 - DEBUG - Step 10: Loss=0.5760
2025-06-02 16:05:45,401 - DEBUG - Online update step: 11/50
2025-06-02 16:05:45,405 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:45,503 - DEBUG - Node anomaly scores shape: torch.Size([18188, 1])
2025-06-02 16:05:45,507 - DEBUG - Edge anomaly scores shape: torch.Size([38002, 1])
2025-06-02 16:05:45,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:45,695 - DEBUG - Step 11: Loss=0.5725
2025-06-02 16:05:45,696 - DEBUG - Online update step: 12/50
2025-06-02 16:05:45,699 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:45,800 - DEBUG - Node anomaly scores shape: torch.Size([20006, 1])
2025-06-02 16:05:45,806 - DEBUG - Edge anomaly scores shape: torch.Size([42159, 1])
2025-06-02 16:05:45,807 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:46,029 - DEBUG - Step 12: Loss=0.5755
2025-06-02 16:05:46,029 - DEBUG - Online update step: 13/50
2025-06-02 16:05:46,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:46,153 - DEBUG - Node anomaly scores shape: torch.Size([20948, 1])
2025-06-02 16:05:46,158 - DEBUG - Edge anomaly scores shape: torch.Size([44195, 1])
2025-06-02 16:05:46,159 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:46,383 - DEBUG - Step 13: Loss=0.5722
2025-06-02 16:05:46,384 - DEBUG - Online update step: 14/50
2025-06-02 16:05:46,387 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:46,500 - DEBUG - Node anomaly scores shape: torch.Size([21026, 1])
2025-06-02 16:05:46,505 - DEBUG - Edge anomaly scores shape: torch.Size([44455, 1])
2025-06-02 16:05:46,506 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:46,754 - DEBUG - Step 14: Loss=0.5750
2025-06-02 16:05:46,754 - DEBUG - Online update step: 15/50
2025-06-02 16:05:46,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:46,864 - DEBUG - Node anomaly scores shape: torch.Size([20053, 1])
2025-06-02 16:05:46,868 - DEBUG - Edge anomaly scores shape: torch.Size([42183, 1])
2025-06-02 16:05:46,869 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:47,106 - DEBUG - Step 15: Loss=0.5715
2025-06-02 16:05:47,106 - DEBUG - Online update step: 16/50
2025-06-02 16:05:47,109 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:47,236 - DEBUG - Node anomaly scores shape: torch.Size([19876, 1])
2025-06-02 16:05:47,240 - DEBUG - Edge anomaly scores shape: torch.Size([41844, 1])
2025-06-02 16:05:47,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:47,483 - DEBUG - Step 16: Loss=0.5754
2025-06-02 16:05:47,483 - DEBUG - Online update step: 17/50
2025-06-02 16:05:47,486 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:47,578 - DEBUG - Node anomaly scores shape: torch.Size([18535, 1])
2025-06-02 16:05:47,582 - DEBUG - Edge anomaly scores shape: torch.Size([38618, 1])
2025-06-02 16:05:47,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:47,788 - DEBUG - Step 17: Loss=0.5724
2025-06-02 16:05:47,788 - DEBUG - Online update step: 18/50
2025-06-02 16:05:47,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:47,905 - DEBUG - Node anomaly scores shape: torch.Size([20700, 1])
2025-06-02 16:05:47,910 - DEBUG - Edge anomaly scores shape: torch.Size([43696, 1])
2025-06-02 16:05:47,911 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:48,174 - DEBUG - Step 18: Loss=0.5756
2025-06-02 16:05:48,174 - DEBUG - Online update step: 19/50
2025-06-02 16:05:48,178 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:48,298 - DEBUG - Node anomaly scores shape: torch.Size([20523, 1])
2025-06-02 16:05:48,304 - DEBUG - Edge anomaly scores shape: torch.Size([43300, 1])
2025-06-02 16:05:48,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:48,538 - DEBUG - Step 19: Loss=0.5723
2025-06-02 16:05:48,539 - DEBUG - Online update step: 20/50
2025-06-02 16:05:48,542 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:48,643 - DEBUG - Node anomaly scores shape: torch.Size([19047, 1])
2025-06-02 16:05:48,648 - DEBUG - Edge anomaly scores shape: torch.Size([40301, 1])
2025-06-02 16:05:48,649 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:48,877 - DEBUG - Step 20: Loss=0.5753
2025-06-02 16:05:48,877 - DEBUG - Online update step: 21/50
2025-06-02 16:05:48,880 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:48,986 - DEBUG - Node anomaly scores shape: torch.Size([19041, 1])
2025-06-02 16:05:48,990 - DEBUG - Edge anomaly scores shape: torch.Size([39968, 1])
2025-06-02 16:05:48,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:49,209 - DEBUG - Step 21: Loss=0.5729
2025-06-02 16:05:49,209 - DEBUG - Online update step: 22/50
2025-06-02 16:05:49,212 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:49,317 - DEBUG - Node anomaly scores shape: torch.Size([19788, 1])
2025-06-02 16:05:49,322 - DEBUG - Edge anomaly scores shape: torch.Size([41744, 1])
2025-06-02 16:05:49,323 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:49,585 - DEBUG - Step 22: Loss=0.5748
2025-06-02 16:05:49,586 - DEBUG - Online update step: 23/50
2025-06-02 16:05:49,589 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:49,706 - DEBUG - Node anomaly scores shape: torch.Size([19966, 1])
2025-06-02 16:05:49,711 - DEBUG - Edge anomaly scores shape: torch.Size([41924, 1])
2025-06-02 16:05:49,712 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:49,937 - DEBUG - Step 23: Loss=0.5713
2025-06-02 16:05:49,938 - DEBUG - Online update step: 24/50
2025-06-02 16:05:49,941 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:50,068 - DEBUG - Node anomaly scores shape: torch.Size([19638, 1])
2025-06-02 16:05:50,073 - DEBUG - Edge anomaly scores shape: torch.Size([41246, 1])
2025-06-02 16:05:50,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:50,291 - DEBUG - Step 24: Loss=0.5754
2025-06-02 16:05:50,291 - DEBUG - Online update step: 25/50
2025-06-02 16:05:50,294 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:50,399 - DEBUG - Node anomaly scores shape: torch.Size([18274, 1])
2025-06-02 16:05:50,403 - DEBUG - Edge anomaly scores shape: torch.Size([38042, 1])
2025-06-02 16:05:50,405 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:50,634 - DEBUG - Step 25: Loss=0.5724
2025-06-02 16:05:50,635 - DEBUG - Online update step: 26/50
2025-06-02 16:05:50,638 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:50,751 - DEBUG - Node anomaly scores shape: torch.Size([19675, 1])
2025-06-02 16:05:50,755 - DEBUG - Edge anomaly scores shape: torch.Size([41305, 1])
2025-06-02 16:05:50,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:50,992 - DEBUG - Step 26: Loss=0.5756
2025-06-02 16:05:50,993 - DEBUG - Online update step: 27/50
2025-06-02 16:05:50,996 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:51,119 - DEBUG - Node anomaly scores shape: torch.Size([20925, 1])
2025-06-02 16:05:51,124 - DEBUG - Edge anomaly scores shape: torch.Size([44204, 1])
2025-06-02 16:05:51,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:51,387 - DEBUG - Step 27: Loss=0.5723
2025-06-02 16:05:51,387 - DEBUG - Online update step: 28/50
2025-06-02 16:05:51,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:51,504 - DEBUG - Node anomaly scores shape: torch.Size([19230, 1])
2025-06-02 16:05:51,509 - DEBUG - Edge anomaly scores shape: torch.Size([40219, 1])
2025-06-02 16:05:51,511 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:51,771 - DEBUG - Step 28: Loss=0.5752
2025-06-02 16:05:51,771 - DEBUG - Online update step: 29/50
2025-06-02 16:05:51,774 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:51,857 - DEBUG - Node anomaly scores shape: torch.Size([16814, 1])
2025-06-02 16:05:51,860 - DEBUG - Edge anomaly scores shape: torch.Size([34963, 1])
2025-06-02 16:05:51,861 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:52,062 - DEBUG - Step 29: Loss=0.5727
2025-06-02 16:05:52,062 - DEBUG - Online update step: 30/50
2025-06-02 16:05:52,065 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:52,203 - DEBUG - Node anomaly scores shape: torch.Size([21761, 1])
2025-06-02 16:05:52,209 - DEBUG - Edge anomaly scores shape: torch.Size([45947, 1])
2025-06-02 16:05:52,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:52,484 - DEBUG - Step 30: Loss=0.5743
2025-06-02 16:05:52,485 - DEBUG - Online update step: 31/50
2025-06-02 16:05:52,488 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:52,589 - DEBUG - Node anomaly scores shape: torch.Size([20070, 1])
2025-06-02 16:05:52,593 - DEBUG - Edge anomaly scores shape: torch.Size([42348, 1])
2025-06-02 16:05:52,595 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:52,826 - DEBUG - Step 31: Loss=0.5711
2025-06-02 16:05:52,827 - DEBUG - Online update step: 32/50
2025-06-02 16:05:52,830 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:52,947 - DEBUG - Node anomaly scores shape: torch.Size([19234, 1])
2025-06-02 16:05:52,952 - DEBUG - Edge anomaly scores shape: torch.Size([40337, 1])
2025-06-02 16:05:52,953 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:53,200 - DEBUG - Step 32: Loss=0.5755
2025-06-02 16:05:53,201 - DEBUG - Online update step: 33/50
2025-06-02 16:05:53,206 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:53,304 - DEBUG - Node anomaly scores shape: torch.Size([18876, 1])
2025-06-02 16:05:53,309 - DEBUG - Edge anomaly scores shape: torch.Size([39630, 1])
2025-06-02 16:05:53,310 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:53,558 - DEBUG - Step 33: Loss=0.5726
2025-06-02 16:05:53,558 - DEBUG - Online update step: 34/50
2025-06-02 16:05:53,564 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:53,667 - DEBUG - Node anomaly scores shape: torch.Size([18978, 1])
2025-06-02 16:05:53,671 - DEBUG - Edge anomaly scores shape: torch.Size([39840, 1])
2025-06-02 16:05:53,673 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:53,903 - DEBUG - Step 34: Loss=0.5748
2025-06-02 16:05:53,903 - DEBUG - Online update step: 35/50
2025-06-02 16:05:53,909 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:54,039 - DEBUG - Node anomaly scores shape: torch.Size([20903, 1])
2025-06-02 16:05:54,044 - DEBUG - Edge anomaly scores shape: torch.Size([44267, 1])
2025-06-02 16:05:54,046 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:54,319 - DEBUG - Step 35: Loss=0.5724
2025-06-02 16:05:54,320 - DEBUG - Online update step: 36/50
2025-06-02 16:05:54,324 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:54,435 - DEBUG - Node anomaly scores shape: torch.Size([19833, 1])
2025-06-02 16:05:54,442 - DEBUG - Edge anomaly scores shape: torch.Size([41801, 1])
2025-06-02 16:05:54,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:54,703 - DEBUG - Step 36: Loss=0.5747
2025-06-02 16:05:54,704 - DEBUG - Online update step: 37/50
2025-06-02 16:05:54,709 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:54,825 - DEBUG - Node anomaly scores shape: torch.Size([20244, 1])
2025-06-02 16:05:54,831 - DEBUG - Edge anomaly scores shape: torch.Size([42697, 1])
2025-06-02 16:05:54,832 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:55,098 - DEBUG - Step 37: Loss=0.5716
2025-06-02 16:05:55,099 - DEBUG - Online update step: 38/50
2025-06-02 16:05:55,103 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:55,198 - DEBUG - Node anomaly scores shape: torch.Size([19290, 1])
2025-06-02 16:05:55,203 - DEBUG - Edge anomaly scores shape: torch.Size([40422, 1])
2025-06-02 16:05:55,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:55,422 - DEBUG - Step 38: Loss=0.5745
2025-06-02 16:05:55,423 - DEBUG - Online update step: 39/50
2025-06-02 16:05:55,429 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:55,569 - DEBUG - Node anomaly scores shape: torch.Size([21837, 1])
2025-06-02 16:05:55,574 - DEBUG - Edge anomaly scores shape: torch.Size([46264, 1])
2025-06-02 16:05:55,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:55,832 - DEBUG - Step 39: Loss=0.5707
2025-06-02 16:05:55,833 - DEBUG - Online update step: 40/50
2025-06-02 16:05:55,839 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:55,937 - DEBUG - Node anomaly scores shape: torch.Size([18115, 1])
2025-06-02 16:05:55,942 - DEBUG - Edge anomaly scores shape: torch.Size([37614, 1])
2025-06-02 16:05:55,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:56,161 - DEBUG - Step 40: Loss=0.5754
2025-06-02 16:05:56,161 - DEBUG - Online update step: 41/50
2025-06-02 16:05:56,168 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:56,282 - DEBUG - Node anomaly scores shape: torch.Size([19755, 1])
2025-06-02 16:05:56,289 - DEBUG - Edge anomaly scores shape: torch.Size([41619, 1])
2025-06-02 16:05:56,291 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:56,524 - DEBUG - Step 41: Loss=0.5726
2025-06-02 16:05:56,525 - DEBUG - Online update step: 42/50
2025-06-02 16:05:56,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:56,647 - DEBUG - Node anomaly scores shape: torch.Size([20180, 1])
2025-06-02 16:05:56,653 - DEBUG - Edge anomaly scores shape: torch.Size([42533, 1])
2025-06-02 16:05:56,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:56,900 - DEBUG - Step 42: Loss=0.5744
2025-06-02 16:05:56,901 - DEBUG - Online update step: 43/50
2025-06-02 16:05:56,905 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:57,038 - DEBUG - Node anomaly scores shape: torch.Size([20710, 1])
2025-06-02 16:05:57,043 - DEBUG - Edge anomaly scores shape: torch.Size([43772, 1])
2025-06-02 16:05:57,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:57,294 - DEBUG - Step 43: Loss=0.5716
2025-06-02 16:05:57,294 - DEBUG - Online update step: 44/50
2025-06-02 16:05:57,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:57,415 - DEBUG - Node anomaly scores shape: torch.Size([19219, 1])
2025-06-02 16:05:57,420 - DEBUG - Edge anomaly scores shape: torch.Size([40255, 1])
2025-06-02 16:05:57,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:57,676 - DEBUG - Step 44: Loss=0.5745
2025-06-02 16:05:57,677 - DEBUG - Online update step: 45/50
2025-06-02 16:05:57,682 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:57,809 - DEBUG - Node anomaly scores shape: torch.Size([20414, 1])
2025-06-02 16:05:57,814 - DEBUG - Edge anomaly scores shape: torch.Size([43077, 1])
2025-06-02 16:05:57,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:58,055 - DEBUG - Step 45: Loss=0.5720
2025-06-02 16:05:58,056 - DEBUG - Online update step: 46/50
2025-06-02 16:05:58,059 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:58,178 - DEBUG - Node anomaly scores shape: torch.Size([21340, 1])
2025-06-02 16:05:58,182 - DEBUG - Edge anomaly scores shape: torch.Size([44929, 1])
2025-06-02 16:05:58,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:58,436 - DEBUG - Step 46: Loss=0.5740
2025-06-02 16:05:58,436 - DEBUG - Online update step: 47/50
2025-06-02 16:05:58,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:58,565 - DEBUG - Node anomaly scores shape: torch.Size([19423, 1])
2025-06-02 16:05:58,569 - DEBUG - Edge anomaly scores shape: torch.Size([40975, 1])
2025-06-02 16:05:58,571 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:58,800 - DEBUG - Step 47: Loss=0.5714
2025-06-02 16:05:58,801 - DEBUG - Online update step: 48/50
2025-06-02 16:05:58,804 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:58,912 - DEBUG - Node anomaly scores shape: torch.Size([18571, 1])
2025-06-02 16:05:58,916 - DEBUG - Edge anomaly scores shape: torch.Size([38831, 1])
2025-06-02 16:05:58,918 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:59,139 - DEBUG - Step 48: Loss=0.5752
2025-06-02 16:05:59,140 - DEBUG - Online update step: 49/50
2025-06-02 16:05:59,143 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:59,238 - DEBUG - Node anomaly scores shape: torch.Size([17878, 1])
2025-06-02 16:05:59,242 - DEBUG - Edge anomaly scores shape: torch.Size([37280, 1])
2025-06-02 16:05:59,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:59,452 - DEBUG - Step 49: Loss=0.5723
2025-06-02 16:05:59,452 - DEBUG - Online update step: 50/50
2025-06-02 16:05:59,456 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:05:59,568 - DEBUG - Node anomaly scores shape: torch.Size([19762, 1])
2025-06-02 16:05:59,573 - DEBUG - Edge anomaly scores shape: torch.Size([41635, 1])
2025-06-02 16:05:59,574 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:05:59,813 - DEBUG - Step 50: Loss=0.5751
2025-06-02 16:05:59,813 - INFO - Online update finished. Average loss: 0.5736, Learning rate: 0.001000
2025-06-02 16:05:59,814 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:05:59,814 - DEBUG - Node drift difference: 0.0040, Edge drift difference: 0.0012
2025-06-02 16:05:59,815 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:05:59,816 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-02 16:05:59,816 - INFO - Online update complete. Loss: 0.5736
2025-06-02 16:05:59,816 - INFO - Running anomaly detection...
2025-06-02 16:05:59,816 - INFO - Starting anomaly detection.
2025-06-02 16:05:59,822 - DEBUG - Node reconstruction errors: [0.01232936 0.25993448 0.06499995 ... 0.00683751 0.01028831 0.01341918]
2025-06-02 16:05:59,822 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783869 1.2587272  0.15783867]
2025-06-02 16:05:59,824 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160559_update_50.json
2025-06-02 16:05:59,824 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:05:59,833 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160559_update_50.pth and as latest_checkpoint.pth
2025-06-02 16:05:59,833 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870595.dot): 0.1178
2025-06-02 16:05:59,833 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 16:05:59,833 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.2599, MLP Score: 0.5027
2025-06-02 16:05:59,833 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1909, MLP Score: 0.4944
2025-06-02 16:05:59,834 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3591, MLP Score: 0.4863
2025-06-02 16:05:59,834 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1269, MLP Score: 0.4844
2025-06-02 16:05:59,834 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0988, MLP Score: 0.4811
2025-06-02 16:05:59,834 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:05:59,834 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.5150
2025-06-02 16:05:59,834 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4661
2025-06-02 16:05:59,834 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.4786
2025-06-02 16:05:59,834 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4340
2025-06-02 16:05:59,834 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.4814
2025-06-02 16:05:59,834 - INFO - 
--- Processing file: nw_graph_encoded_1748870625.dot (Timestamp: 2025-06-02 15:23:45) ---
2025-06-02 16:05:59,834 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 16:05:59,834 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 16:05:59,865 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 16:05:59,893 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 16:05:59,893 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 16:05:59,893 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870625.dot
2025-06-02 16:05:59,916 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 16:05:59,938 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870625.dot'.
2025-06-02 16:05:59,938 - INFO - Processing node updates/additions.
2025-06-02 16:05:59,943 - INFO - Processing edge updates/additions.
2025-06-02 16:05:59,955 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:05:59,957 - INFO - Finished updating NetworkX graph.
2025-06-02 16:05:59,957 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:05:59,958 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:05:59,967 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:05:59,969 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:05:59,969 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:05:59,971 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:05:59,972 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:05:59,977 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:05:59,978 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:05:59,980 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:05:59,981 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:05:59,982 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:05:59,982 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:05:59,982 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:05:59,982 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:05:59,985 - INFO - Performing online update...
2025-06-02 16:05:59,986 - INFO - Starting online update for 50 steps.
2025-06-02 16:05:59,986 - DEBUG - Updated RunningStats: new_mean=0.9451222773150341, new_var=29400000000161.41, new_n=2970
2025-06-02 16:05:59,986 - DEBUG - Updated RunningStats: new_mean=0.9430620427129843, new_var=29700000000018.305, new_n=3000
2025-06-02 16:05:59,987 - DEBUG - Updated RunningStats: new_mean=1.1676112384721773, new_var=9800000000093.826, new_n=990
2025-06-02 16:05:59,987 - DEBUG - Updated RunningStats: new_mean=1.1666815961811827, new_var=9900000000001.576, new_n=1000
2025-06-02 16:05:59,987 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:05:59,987 - DEBUG - Online update step: 1/50
2025-06-02 16:05:59,989 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:00,155 - DEBUG - Node anomaly scores shape: torch.Size([20372, 1])
2025-06-02 16:06:00,160 - DEBUG - Edge anomaly scores shape: torch.Size([43002, 1])
2025-06-02 16:06:00,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:00,365 - DEBUG - Step 1: Loss=0.5711
2025-06-02 16:06:00,365 - DEBUG - Online update step: 2/50
2025-06-02 16:06:00,368 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:00,465 - DEBUG - Node anomaly scores shape: torch.Size([19737, 1])
2025-06-02 16:06:00,469 - DEBUG - Edge anomaly scores shape: torch.Size([41273, 1])
2025-06-02 16:06:00,470 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:00,712 - DEBUG - Step 2: Loss=0.5744
2025-06-02 16:06:00,713 - DEBUG - Online update step: 3/50
2025-06-02 16:06:00,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:00,818 - DEBUG - Node anomaly scores shape: torch.Size([20049, 1])
2025-06-02 16:06:00,823 - DEBUG - Edge anomaly scores shape: torch.Size([42256, 1])
2025-06-02 16:06:00,824 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:01,040 - DEBUG - Step 3: Loss=0.5720
2025-06-02 16:06:01,041 - DEBUG - Online update step: 4/50
2025-06-02 16:06:01,044 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:01,158 - DEBUG - Node anomaly scores shape: torch.Size([21852, 1])
2025-06-02 16:06:01,163 - DEBUG - Edge anomaly scores shape: torch.Size([46162, 1])
2025-06-02 16:06:01,165 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:01,417 - DEBUG - Step 4: Loss=0.5737
2025-06-02 16:06:01,418 - DEBUG - Online update step: 5/50
2025-06-02 16:06:01,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:01,518 - DEBUG - Node anomaly scores shape: torch.Size([20117, 1])
2025-06-02 16:06:01,524 - DEBUG - Edge anomaly scores shape: torch.Size([42161, 1])
2025-06-02 16:06:01,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:01,728 - DEBUG - Step 5: Loss=0.5705
2025-06-02 16:06:01,728 - DEBUG - Online update step: 6/50
2025-06-02 16:06:01,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:01,841 - DEBUG - Node anomaly scores shape: torch.Size([20568, 1])
2025-06-02 16:06:01,846 - DEBUG - Edge anomaly scores shape: torch.Size([43261, 1])
2025-06-02 16:06:01,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:02,066 - DEBUG - Step 6: Loss=0.5744
2025-06-02 16:06:02,067 - DEBUG - Online update step: 7/50
2025-06-02 16:06:02,070 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:02,172 - DEBUG - Node anomaly scores shape: torch.Size([19601, 1])
2025-06-02 16:06:02,176 - DEBUG - Edge anomaly scores shape: torch.Size([41126, 1])
2025-06-02 16:06:02,177 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:02,395 - DEBUG - Step 7: Loss=0.5716
2025-06-02 16:06:02,396 - DEBUG - Online update step: 8/50
2025-06-02 16:06:02,399 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:02,535 - DEBUG - Node anomaly scores shape: torch.Size([22030, 1])
2025-06-02 16:06:02,541 - DEBUG - Edge anomaly scores shape: torch.Size([46688, 1])
2025-06-02 16:06:02,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:02,788 - DEBUG - Step 8: Loss=0.5751
2025-06-02 16:06:02,789 - DEBUG - Online update step: 9/50
2025-06-02 16:06:02,792 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:02,882 - DEBUG - Node anomaly scores shape: torch.Size([20005, 1])
2025-06-02 16:06:02,887 - DEBUG - Edge anomaly scores shape: torch.Size([42084, 1])
2025-06-02 16:06:02,888 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:03,096 - DEBUG - Step 9: Loss=0.5713
2025-06-02 16:06:03,097 - DEBUG - Online update step: 10/50
2025-06-02 16:06:03,101 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:03,210 - DEBUG - Node anomaly scores shape: torch.Size([18276, 1])
2025-06-02 16:06:03,214 - DEBUG - Edge anomaly scores shape: torch.Size([38199, 1])
2025-06-02 16:06:03,215 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:03,428 - DEBUG - Step 10: Loss=0.5750
2025-06-02 16:06:03,429 - DEBUG - Online update step: 11/50
2025-06-02 16:06:03,432 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:03,559 - DEBUG - Node anomaly scores shape: torch.Size([21886, 1])
2025-06-02 16:06:03,565 - DEBUG - Edge anomaly scores shape: torch.Size([46225, 1])
2025-06-02 16:06:03,567 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:03,829 - DEBUG - Step 11: Loss=0.5716
2025-06-02 16:06:03,830 - DEBUG - Online update step: 12/50
2025-06-02 16:06:03,836 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:03,960 - DEBUG - Node anomaly scores shape: torch.Size([21619, 1])
2025-06-02 16:06:03,965 - DEBUG - Edge anomaly scores shape: torch.Size([45749, 1])
2025-06-02 16:06:03,967 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:04,220 - DEBUG - Step 12: Loss=0.5736
2025-06-02 16:06:04,221 - DEBUG - Online update step: 13/50
2025-06-02 16:06:04,227 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:04,349 - DEBUG - Node anomaly scores shape: torch.Size([21510, 1])
2025-06-02 16:06:04,355 - DEBUG - Edge anomaly scores shape: torch.Size([45323, 1])
2025-06-02 16:06:04,357 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:04,605 - DEBUG - Step 13: Loss=0.5705
2025-06-02 16:06:04,605 - DEBUG - Online update step: 14/50
2025-06-02 16:06:04,608 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:04,703 - DEBUG - Node anomaly scores shape: torch.Size([19501, 1])
2025-06-02 16:06:04,707 - DEBUG - Edge anomaly scores shape: torch.Size([41105, 1])
2025-06-02 16:06:04,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:04,927 - DEBUG - Step 14: Loss=0.5750
2025-06-02 16:06:04,927 - DEBUG - Online update step: 15/50
2025-06-02 16:06:04,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:05,070 - DEBUG - Node anomaly scores shape: torch.Size([21814, 1])
2025-06-02 16:06:05,076 - DEBUG - Edge anomaly scores shape: torch.Size([46041, 1])
2025-06-02 16:06:05,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:05,346 - DEBUG - Step 15: Loss=0.5718
2025-06-02 16:06:05,347 - DEBUG - Online update step: 16/50
2025-06-02 16:06:05,351 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:05,476 - DEBUG - Node anomaly scores shape: torch.Size([20976, 1])
2025-06-02 16:06:05,481 - DEBUG - Edge anomaly scores shape: torch.Size([44421, 1])
2025-06-02 16:06:05,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:05,711 - DEBUG - Step 16: Loss=0.5740
2025-06-02 16:06:05,712 - DEBUG - Online update step: 17/50
2025-06-02 16:06:05,715 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:05,831 - DEBUG - Node anomaly scores shape: torch.Size([19696, 1])
2025-06-02 16:06:05,835 - DEBUG - Edge anomaly scores shape: torch.Size([41468, 1])
2025-06-02 16:06:05,836 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:06,071 - DEBUG - Step 17: Loss=0.5711
2025-06-02 16:06:06,071 - DEBUG - Online update step: 18/50
2025-06-02 16:06:06,078 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:06,208 - DEBUG - Node anomaly scores shape: torch.Size([21619, 1])
2025-06-02 16:06:06,213 - DEBUG - Edge anomaly scores shape: torch.Size([45836, 1])
2025-06-02 16:06:06,214 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:06,476 - DEBUG - Step 18: Loss=0.5741
2025-06-02 16:06:06,476 - DEBUG - Online update step: 19/50
2025-06-02 16:06:06,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:06,603 - DEBUG - Node anomaly scores shape: torch.Size([20523, 1])
2025-06-02 16:06:06,608 - DEBUG - Edge anomaly scores shape: torch.Size([43305, 1])
2025-06-02 16:06:06,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:06,851 - DEBUG - Step 19: Loss=0.5714
2025-06-02 16:06:06,851 - DEBUG - Online update step: 20/50
2025-06-02 16:06:06,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:06,967 - DEBUG - Node anomaly scores shape: torch.Size([19396, 1])
2025-06-02 16:06:06,971 - DEBUG - Edge anomaly scores shape: torch.Size([40729, 1])
2025-06-02 16:06:06,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:07,227 - DEBUG - Step 20: Loss=0.5739
2025-06-02 16:06:07,227 - DEBUG - Online update step: 21/50
2025-06-02 16:06:07,230 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:07,326 - DEBUG - Node anomaly scores shape: torch.Size([19437, 1])
2025-06-02 16:06:07,330 - DEBUG - Edge anomaly scores shape: torch.Size([41036, 1])
2025-06-02 16:06:07,331 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:07,521 - DEBUG - Step 21: Loss=0.5716
2025-06-02 16:06:07,521 - DEBUG - Online update step: 22/50
2025-06-02 16:06:07,524 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:07,622 - DEBUG - Node anomaly scores shape: torch.Size([18567, 1])
2025-06-02 16:06:07,627 - DEBUG - Edge anomaly scores shape: torch.Size([38834, 1])
2025-06-02 16:06:07,628 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:07,837 - DEBUG - Step 22: Loss=0.5748
2025-06-02 16:06:07,838 - DEBUG - Online update step: 23/50
2025-06-02 16:06:07,845 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:07,961 - DEBUG - Node anomaly scores shape: torch.Size([19497, 1])
2025-06-02 16:06:07,965 - DEBUG - Edge anomaly scores shape: torch.Size([40752, 1])
2025-06-02 16:06:07,966 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:08,201 - DEBUG - Step 23: Loss=0.5716
2025-06-02 16:06:08,202 - DEBUG - Online update step: 24/50
2025-06-02 16:06:08,205 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:08,337 - DEBUG - Node anomaly scores shape: torch.Size([22263, 1])
2025-06-02 16:06:08,343 - DEBUG - Edge anomaly scores shape: torch.Size([47159, 1])
2025-06-02 16:06:08,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:08,647 - DEBUG - Step 24: Loss=0.5732
2025-06-02 16:06:08,647 - DEBUG - Online update step: 25/50
2025-06-02 16:06:08,650 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:08,771 - DEBUG - Node anomaly scores shape: torch.Size([21099, 1])
2025-06-02 16:06:08,776 - DEBUG - Edge anomaly scores shape: torch.Size([44570, 1])
2025-06-02 16:06:08,777 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:09,037 - DEBUG - Step 25: Loss=0.5700
2025-06-02 16:06:09,037 - DEBUG - Online update step: 26/50
2025-06-02 16:06:09,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:09,156 - DEBUG - Node anomaly scores shape: torch.Size([20152, 1])
2025-06-02 16:06:09,161 - DEBUG - Edge anomaly scores shape: torch.Size([42317, 1])
2025-06-02 16:06:09,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:09,415 - DEBUG - Step 26: Loss=0.5737
2025-06-02 16:06:09,415 - DEBUG - Online update step: 27/50
2025-06-02 16:06:09,421 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:09,528 - DEBUG - Node anomaly scores shape: torch.Size([20139, 1])
2025-06-02 16:06:09,532 - DEBUG - Edge anomaly scores shape: torch.Size([42579, 1])
2025-06-02 16:06:09,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:09,780 - DEBUG - Step 27: Loss=0.5716
2025-06-02 16:06:09,780 - DEBUG - Online update step: 28/50
2025-06-02 16:06:09,785 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:09,879 - DEBUG - Node anomaly scores shape: torch.Size([19557, 1])
2025-06-02 16:06:09,885 - DEBUG - Edge anomaly scores shape: torch.Size([40988, 1])
2025-06-02 16:06:09,887 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:10,098 - DEBUG - Step 28: Loss=0.5742
2025-06-02 16:06:10,099 - DEBUG - Online update step: 29/50
2025-06-02 16:06:10,105 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:10,222 - DEBUG - Node anomaly scores shape: torch.Size([20906, 1])
2025-06-02 16:06:10,227 - DEBUG - Edge anomaly scores shape: torch.Size([43801, 1])
2025-06-02 16:06:10,229 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:10,464 - DEBUG - Step 29: Loss=0.5713
2025-06-02 16:06:10,465 - DEBUG - Online update step: 30/50
2025-06-02 16:06:10,470 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:10,572 - DEBUG - Node anomaly scores shape: torch.Size([19909, 1])
2025-06-02 16:06:10,577 - DEBUG - Edge anomaly scores shape: torch.Size([41727, 1])
2025-06-02 16:06:10,578 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:10,799 - DEBUG - Step 30: Loss=0.5742
2025-06-02 16:06:10,800 - DEBUG - Online update step: 31/50
2025-06-02 16:06:10,806 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:10,923 - DEBUG - Node anomaly scores shape: torch.Size([20340, 1])
2025-06-02 16:06:10,928 - DEBUG - Edge anomaly scores shape: torch.Size([42836, 1])
2025-06-02 16:06:10,930 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:11,176 - DEBUG - Step 31: Loss=0.5711
2025-06-02 16:06:11,177 - DEBUG - Online update step: 32/50
2025-06-02 16:06:11,180 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:11,280 - DEBUG - Node anomaly scores shape: torch.Size([20696, 1])
2025-06-02 16:06:11,285 - DEBUG - Edge anomaly scores shape: torch.Size([43700, 1])
2025-06-02 16:06:11,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:11,529 - DEBUG - Step 32: Loss=0.5730
2025-06-02 16:06:11,529 - DEBUG - Online update step: 33/50
2025-06-02 16:06:11,532 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:11,684 - DEBUG - Node anomaly scores shape: torch.Size([21257, 1])
2025-06-02 16:06:11,690 - DEBUG - Edge anomaly scores shape: torch.Size([44836, 1])
2025-06-02 16:06:11,691 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:11,965 - DEBUG - Step 33: Loss=0.5701
2025-06-02 16:06:11,965 - DEBUG - Online update step: 34/50
2025-06-02 16:06:11,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:12,076 - DEBUG - Node anomaly scores shape: torch.Size([20231, 1])
2025-06-02 16:06:12,080 - DEBUG - Edge anomaly scores shape: torch.Size([42512, 1])
2025-06-02 16:06:12,081 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:12,343 - DEBUG - Step 34: Loss=0.5738
2025-06-02 16:06:12,344 - DEBUG - Online update step: 35/50
2025-06-02 16:06:12,350 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:12,487 - DEBUG - Node anomaly scores shape: torch.Size([21806, 1])
2025-06-02 16:06:12,493 - DEBUG - Edge anomaly scores shape: torch.Size([46088, 1])
2025-06-02 16:06:12,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:12,757 - DEBUG - Step 35: Loss=0.5716
2025-06-02 16:06:12,757 - DEBUG - Online update step: 36/50
2025-06-02 16:06:12,762 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:12,865 - DEBUG - Node anomaly scores shape: torch.Size([19355, 1])
2025-06-02 16:06:12,872 - DEBUG - Edge anomaly scores shape: torch.Size([40492, 1])
2025-06-02 16:06:12,874 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:13,091 - DEBUG - Step 36: Loss=0.5742
2025-06-02 16:06:13,091 - DEBUG - Online update step: 37/50
2025-06-02 16:06:13,094 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:13,198 - DEBUG - Node anomaly scores shape: torch.Size([18705, 1])
2025-06-02 16:06:13,203 - DEBUG - Edge anomaly scores shape: torch.Size([39160, 1])
2025-06-02 16:06:13,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:13,436 - DEBUG - Step 37: Loss=0.5713
2025-06-02 16:06:13,436 - DEBUG - Online update step: 38/50
2025-06-02 16:06:13,443 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:13,558 - DEBUG - Node anomaly scores shape: torch.Size([19579, 1])
2025-06-02 16:06:13,563 - DEBUG - Edge anomaly scores shape: torch.Size([41036, 1])
2025-06-02 16:06:13,564 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:13,805 - DEBUG - Step 38: Loss=0.5740
2025-06-02 16:06:13,806 - DEBUG - Online update step: 39/50
2025-06-02 16:06:13,811 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:13,918 - DEBUG - Node anomaly scores shape: torch.Size([20046, 1])
2025-06-02 16:06:13,924 - DEBUG - Edge anomaly scores shape: torch.Size([42345, 1])
2025-06-02 16:06:13,926 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:14,158 - DEBUG - Step 39: Loss=0.5710
2025-06-02 16:06:14,158 - DEBUG - Online update step: 40/50
2025-06-02 16:06:14,164 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:14,255 - DEBUG - Node anomaly scores shape: torch.Size([17466, 1])
2025-06-02 16:06:14,259 - DEBUG - Edge anomaly scores shape: torch.Size([36494, 1])
2025-06-02 16:06:14,260 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:14,451 - DEBUG - Step 40: Loss=0.5738
2025-06-02 16:06:14,452 - DEBUG - Online update step: 41/50
2025-06-02 16:06:14,458 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:14,578 - DEBUG - Node anomaly scores shape: torch.Size([20499, 1])
2025-06-02 16:06:14,584 - DEBUG - Edge anomaly scores shape: torch.Size([43149, 1])
2025-06-02 16:06:14,586 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:14,802 - DEBUG - Step 41: Loss=0.5707
2025-06-02 16:06:14,802 - DEBUG - Online update step: 42/50
2025-06-02 16:06:14,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:14,918 - DEBUG - Node anomaly scores shape: torch.Size([19917, 1])
2025-06-02 16:06:14,923 - DEBUG - Edge anomaly scores shape: torch.Size([41949, 1])
2025-06-02 16:06:14,924 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:15,173 - DEBUG - Step 42: Loss=0.5743
2025-06-02 16:06:15,173 - DEBUG - Online update step: 43/50
2025-06-02 16:06:15,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:15,284 - DEBUG - Node anomaly scores shape: torch.Size([20700, 1])
2025-06-02 16:06:15,288 - DEBUG - Edge anomaly scores shape: torch.Size([43795, 1])
2025-06-02 16:06:15,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:15,529 - DEBUG - Step 43: Loss=0.5712
2025-06-02 16:06:15,530 - DEBUG - Online update step: 44/50
2025-06-02 16:06:15,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:15,653 - DEBUG - Node anomaly scores shape: torch.Size([21517, 1])
2025-06-02 16:06:15,661 - DEBUG - Edge anomaly scores shape: torch.Size([45335, 1])
2025-06-02 16:06:15,662 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:15,924 - DEBUG - Step 44: Loss=0.5739
2025-06-02 16:06:15,924 - DEBUG - Online update step: 45/50
2025-06-02 16:06:15,930 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:16,034 - DEBUG - Node anomaly scores shape: torch.Size([18834, 1])
2025-06-02 16:06:16,038 - DEBUG - Edge anomaly scores shape: torch.Size([39496, 1])
2025-06-02 16:06:16,040 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:16,233 - DEBUG - Step 45: Loss=0.5707
2025-06-02 16:06:16,234 - DEBUG - Online update step: 46/50
2025-06-02 16:06:16,238 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:16,358 - DEBUG - Node anomaly scores shape: torch.Size([22160, 1])
2025-06-02 16:06:16,364 - DEBUG - Edge anomaly scores shape: torch.Size([46823, 1])
2025-06-02 16:06:16,365 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:16,643 - DEBUG - Step 46: Loss=0.5739
2025-06-02 16:06:16,643 - DEBUG - Online update step: 47/50
2025-06-02 16:06:16,649 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:16,756 - DEBUG - Node anomaly scores shape: torch.Size([20825, 1])
2025-06-02 16:06:16,762 - DEBUG - Edge anomaly scores shape: torch.Size([43953, 1])
2025-06-02 16:06:16,763 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:16,979 - DEBUG - Step 47: Loss=0.5710
2025-06-02 16:06:16,979 - DEBUG - Online update step: 48/50
2025-06-02 16:06:16,982 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:17,078 - DEBUG - Node anomaly scores shape: torch.Size([19732, 1])
2025-06-02 16:06:17,082 - DEBUG - Edge anomaly scores shape: torch.Size([41472, 1])
2025-06-02 16:06:17,083 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:17,308 - DEBUG - Step 48: Loss=0.5733
2025-06-02 16:06:17,309 - DEBUG - Online update step: 49/50
2025-06-02 16:06:17,315 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:17,436 - DEBUG - Node anomaly scores shape: torch.Size([21119, 1])
2025-06-02 16:06:17,441 - DEBUG - Edge anomaly scores shape: torch.Size([44743, 1])
2025-06-02 16:06:17,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:17,685 - DEBUG - Step 49: Loss=0.5704
2025-06-02 16:06:17,685 - DEBUG - Online update step: 50/50
2025-06-02 16:06:17,689 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:17,815 - DEBUG - Node anomaly scores shape: torch.Size([23295, 1])
2025-06-02 16:06:17,820 - DEBUG - Edge anomaly scores shape: torch.Size([49576, 1])
2025-06-02 16:06:17,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:18,082 - DEBUG - Step 50: Loss=0.5738
2025-06-02 16:06:18,082 - INFO - Online update finished. Average loss: 0.5726, Learning rate: 0.001000
2025-06-02 16:06:18,083 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:06:18,083 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:06:18,084 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:06:18,085 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-02 16:06:18,085 - INFO - Online update complete. Loss: 0.5726
2025-06-02 16:06:18,085 - INFO - Running anomaly detection...
2025-06-02 16:06:18,085 - INFO - Starting anomaly detection.
2025-06-02 16:06:18,095 - DEBUG - Node reconstruction errors: [0.01280939 0.22415271 0.06595072 ... 0.00504889 0.0077336  0.01349709]
2025-06-02 16:06:18,095 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783866 1.2587271  0.15783866]
2025-06-02 16:06:18,097 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160618_update_51.json
2025-06-02 16:06:18,098 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:06:18,106 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160618_update_51.pth and as latest_checkpoint.pth
2025-06-02 16:06:18,106 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870625.dot): 0.1212
2025-06-02 16:06:18,107 - WARNING - Detected 15 anomalous nodes (reconstruction-based):
2025-06-02 16:06:18,107 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.2242, MLP Score: 0.5215
2025-06-02 16:06:18,107 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2049, MLP Score: 0.5071
2025-06-02 16:06:18,107 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3386, MLP Score: 0.5005
2025-06-02 16:06:18,107 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1222, MLP Score: 0.4959
2025-06-02 16:06:18,107 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0995, MLP Score: 0.4930
2025-06-02 16:06:18,107 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:06:18,107 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.4953
2025-06-02 16:06:18,107 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4516
2025-06-02 16:06:18,107 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.5002
2025-06-02 16:06:18,107 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4675
2025-06-02 16:06:18,107 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.4995
2025-06-02 16:06:18,113 - DEBUG - Embedding standard deviations before t-SNE: [1.6355604  1.002404   0.8132977  0.76956487 1.0488665  0.
 2.3956306  0.00756504 1.5592427  1.4921442  1.5182227  0.11907979
 0.06981562 1.4459473  0.         0.         1.1622944  0.23264056
 0.         0.01379771 0.11668749 1.3399864  0.51796144 0.61199844
 0.2796229  0.79543823 0.686349   0.9466056  0.89475274 1.5993555
 1.4497792  0.4793348 ]
2025-06-02 16:06:18,943 - INFO - Embeddings visualization saved to vis/embeddings_51_updates_20250602_160618.png
2025-06-02 16:06:18,944 - INFO - Performing visualization of node and edge features.
2025-06-02 16:06:18,945 - INFO - Starting visualization of node features.
2025-06-02 16:06:18,945 - INFO - Graph has 1003 nodes and 30 features.
2025-06-02 16:06:18,945 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 16:06:18,945 - INFO - Calculating feature statistics:
2025-06-02 16:06:18,946 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,946 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,946 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7199986), 'max': np.float32(2.4740193)}
2025-06-02 16:06:18,946 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(-6.08526e-08), 'std': np.float32(1.0), 'min': np.float32(-2.3749828), 'max': np.float32(1.8203772)}
2025-06-02 16:06:18,946 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,946 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,946 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,946 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45654544), 'max': np.float32(2.1903625)}
2025-06-02 16:06:18,946 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1496779), 'max': np.float32(0.86980885)}
2025-06-02 16:06:18,946 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(-7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-9.436405), 'max': np.float32(0.108228795)}
2025-06-02 16:06:18,946 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 25, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2683976), 'max': np.float32(1.4923526)}
2025-06-02 16:06:18,947 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 25, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.4565239), 'max': np.float32(2.385281)}
2025-06-02 16:06:18,947 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2671983), 'std': np.float32(0.94219303), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 16:06:18,947 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.9621136), 'std': np.float32(0.27264866), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 16:06:18,947 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:06:18,947 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3928213), 'std': np.float32(0.5729255), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 16:06:18,947 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(7.606575e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108228795), 'max': np.float32(9.436405)}
2025-06-02 16:06:18,947 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.435693), 'std': np.float32(3.0227787), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 16:06:18,947 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.775673), 'std': np.float32(2.906747), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:06:18,947 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.6131606), 'std': np.float32(1.4830064), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:06:18,947 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14955135), 'std': np.float32(0.37034556), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:06:18,947 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993021), 'std': np.float32(0.22091796), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:06:18,947 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-1.1409862e-08), 'std': np.float32(0.9999998), 'min': np.float32(-0.12744388), 'max': np.float32(16.54554)}
2025-06-02 16:06:18,947 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.13895662), 'max': np.float32(7.1964903)}
2025-06-02 16:06:18,947 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,948 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,948 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,948 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:06:18,948 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(1.521315e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.9900672), 'max': np.float32(10.424156)}
2025-06-02 16:06:18,948 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(3.04263e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0934536), 'max': np.float32(4.4456067)}
2025-06-02 16:06:18,961 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a1cd1490>
2025-06-02 16:06:19,343 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 16:06:19,394 - DEBUG - Plotted ranges of node feature values.
2025-06-02 16:06:19,419 - DEBUG - Plotted sparsity of node features.
2025-06-02 16:06:20,711 - INFO - Node feature visualization saved to vis/node_features_20250602_160619.png
2025-06-02 16:06:20,711 - INFO - Finished visualization of node features.
2025-06-02 16:06:20,711 - INFO - Performing additional feature analysis:
2025-06-02 16:06:20,711 - INFO - - Maximum correlation between different features: nan
2025-06-02 16:06:20,712 - INFO - Starting visualization of edge features.
2025-06-02 16:06:20,713 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 16:06:20,713 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:06:20,713 - INFO - Calculating edge feature statistics:
2025-06-02 16:06:20,713 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 16:06:20,713 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.146685), 'std': np.float32(1.1018977), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-02 16:06:20,713 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4255222), 'std': np.float32(0.50622183), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:06:20,713 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.698456), 'std': np.float32(2.1359105), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 16:06:20,713 - INFO - - service: {'name': 'service', 'unique': 39, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.034784634), 'max': np.float32(33.15622)}
2025-06-02 16:06:20,713 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1480, 'mean': np.float32(1.7323785e-09), 'std': np.float32(1.0), 'min': np.float32(-0.059619874), 'max': np.float32(27.69297)}
2025-06-02 16:06:20,713 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1552, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-0.05574151), 'max': np.float32(30.763012)}
2025-06-02 16:06:20,713 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 513, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.043342285), 'max': np.float32(33.037327)}
2025-06-02 16:06:20,713 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1525, 'mean': np.float32(-1.7323785e-09), 'std': np.float32(1.0), 'min': np.float32(-0.088083506), 'max': np.float32(28.738836)}
2025-06-02 16:06:20,713 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1555, 'mean': np.float32(1.7323785e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08783307), 'max': np.float32(27.616938)}
2025-06-02 16:06:20,713 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 567, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.052230977), 'max': np.float32(32.468086)}
2025-06-02 16:06:20,725 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a14de3c0>
2025-06-02 16:06:20,809 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 16:06:20,819 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a0cd6d80>
2025-06-02 16:06:20,904 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 16:06:21,147 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 16:06:21,312 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 16:06:21,325 - DEBUG - Plotted sparsity of edge features.
2025-06-02 16:06:21,331 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 16:06:22,633 - INFO - Edge feature visualization saved to vis/edge_features_20250602_160621.png
2025-06-02 16:06:22,634 - INFO - Finished visualization of edge features.
2025-06-02 16:06:22,634 - INFO - Performing additional edge feature analysis:
2025-06-02 16:06:22,634 - INFO - - Highest correlation (1.00) between features: 'total_resp_ip_bytes' and 'total_resp_bytes'.
2025-06-02 16:06:22,635 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 16:06:22,635 - INFO - Graph has 2202 edges and 10 edge features.
2025-06-02 16:06:22,635 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:06:22,951 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_160622_summary.png
2025-06-02 16:06:23,242 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_160622_pca_3d.png
2025-06-02 16:06:23,404 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_160622_pca_variance.png
2025-06-02 16:06:23,404 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 16:06:23,405 - INFO - 
--- Processing file: nw_graph_encoded_1748870655.dot (Timestamp: 2025-06-02 15:24:15) ---
2025-06-02 16:06:23,405 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 16:06:23,405 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 16:06:23,422 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 16:06:23,442 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 16:06:23,442 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 16:06:23,442 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870655.dot
2025-06-02 16:06:23,461 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 16:06:23,484 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870655.dot'.
2025-06-02 16:06:23,484 - INFO - Processing node updates/additions.
2025-06-02 16:06:23,491 - INFO - Processing edge updates/additions.
2025-06-02 16:06:23,507 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:06:23,509 - INFO - Finished updating NetworkX graph.
2025-06-02 16:06:23,509 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:06:23,511 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:06:23,524 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:06:23,528 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:06:23,528 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:06:23,531 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:06:23,533 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:06:23,539 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:06:23,541 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:06:23,543 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:06:23,545 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:06:23,546 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:06:23,546 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:06:23,546 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:06:23,546 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:06:23,549 - INFO - Performing online update...
2025-06-02 16:06:23,549 - INFO - Starting online update for 50 steps.
2025-06-02 16:06:23,550 - DEBUG - Updated RunningStats: new_mean=0.9451897398274213, new_var=30000000000161.41, new_n=3030
2025-06-02 16:06:23,550 - DEBUG - Updated RunningStats: new_mean=0.9431692405850942, new_var=30300000000018.305, new_n=3060
2025-06-02 16:06:23,551 - DEBUG - Updated RunningStats: new_mean=1.1712398602297438, new_var=10000000000093.791, new_n=1010
2025-06-02 16:06:23,551 - DEBUG - Updated RunningStats: new_mean=1.1702928714958514, new_var=10100000000001.582, new_n=1020
2025-06-02 16:06:23,551 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:06:23,551 - DEBUG - Online update step: 1/50
2025-06-02 16:06:23,554 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:23,638 - DEBUG - Node anomaly scores shape: torch.Size([18988, 1])
2025-06-02 16:06:23,643 - DEBUG - Edge anomaly scores shape: torch.Size([39879, 1])
2025-06-02 16:06:23,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:23,916 - DEBUG - Step 1: Loss=0.5716
2025-06-02 16:06:23,916 - DEBUG - Online update step: 2/50
2025-06-02 16:06:23,919 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:24,060 - DEBUG - Node anomaly scores shape: torch.Size([20686, 1])
2025-06-02 16:06:24,067 - DEBUG - Edge anomaly scores shape: torch.Size([43573, 1])
2025-06-02 16:06:24,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:24,344 - DEBUG - Step 2: Loss=0.5737
2025-06-02 16:06:24,344 - DEBUG - Online update step: 3/50
2025-06-02 16:06:24,347 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:24,466 - DEBUG - Node anomaly scores shape: torch.Size([20020, 1])
2025-06-02 16:06:24,470 - DEBUG - Edge anomaly scores shape: torch.Size([42175, 1])
2025-06-02 16:06:24,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:24,710 - DEBUG - Step 3: Loss=0.5703
2025-06-02 16:06:24,711 - DEBUG - Online update step: 4/50
2025-06-02 16:06:24,714 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:24,833 - DEBUG - Node anomaly scores shape: torch.Size([19537, 1])
2025-06-02 16:06:24,838 - DEBUG - Edge anomaly scores shape: torch.Size([41163, 1])
2025-06-02 16:06:24,839 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:25,075 - DEBUG - Step 4: Loss=0.5735
2025-06-02 16:06:25,076 - DEBUG - Online update step: 5/50
2025-06-02 16:06:25,079 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:25,172 - DEBUG - Node anomaly scores shape: torch.Size([20385, 1])
2025-06-02 16:06:25,180 - DEBUG - Edge anomaly scores shape: torch.Size([42749, 1])
2025-06-02 16:06:25,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:25,422 - DEBUG - Step 5: Loss=0.5710
2025-06-02 16:06:25,422 - DEBUG - Online update step: 6/50
2025-06-02 16:06:25,425 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:25,519 - DEBUG - Node anomaly scores shape: torch.Size([19705, 1])
2025-06-02 16:06:25,524 - DEBUG - Edge anomaly scores shape: torch.Size([41402, 1])
2025-06-02 16:06:25,525 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:25,728 - DEBUG - Step 6: Loss=0.5734
2025-06-02 16:06:25,728 - DEBUG - Online update step: 7/50
2025-06-02 16:06:25,731 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:25,849 - DEBUG - Node anomaly scores shape: torch.Size([20391, 1])
2025-06-02 16:06:25,854 - DEBUG - Edge anomaly scores shape: torch.Size([43053, 1])
2025-06-02 16:06:25,855 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:26,096 - DEBUG - Step 7: Loss=0.5706
2025-06-02 16:06:26,097 - DEBUG - Online update step: 8/50
2025-06-02 16:06:26,100 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:26,191 - DEBUG - Node anomaly scores shape: torch.Size([19395, 1])
2025-06-02 16:06:26,195 - DEBUG - Edge anomaly scores shape: torch.Size([40908, 1])
2025-06-02 16:06:26,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:26,385 - DEBUG - Step 8: Loss=0.5736
2025-06-02 16:06:26,385 - DEBUG - Online update step: 9/50
2025-06-02 16:06:26,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:26,518 - DEBUG - Node anomaly scores shape: torch.Size([21813, 1])
2025-06-02 16:06:26,524 - DEBUG - Edge anomaly scores shape: torch.Size([46360, 1])
2025-06-02 16:06:26,526 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:26,769 - DEBUG - Step 9: Loss=0.5711
2025-06-02 16:06:26,769 - DEBUG - Online update step: 10/50
2025-06-02 16:06:26,772 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:26,867 - DEBUG - Node anomaly scores shape: torch.Size([18104, 1])
2025-06-02 16:06:26,871 - DEBUG - Edge anomaly scores shape: torch.Size([38073, 1])
2025-06-02 16:06:26,872 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:27,085 - DEBUG - Step 10: Loss=0.5734
2025-06-02 16:06:27,085 - DEBUG - Online update step: 11/50
2025-06-02 16:06:27,089 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:27,192 - DEBUG - Node anomaly scores shape: torch.Size([20869, 1])
2025-06-02 16:06:27,196 - DEBUG - Edge anomaly scores shape: torch.Size([44114, 1])
2025-06-02 16:06:27,198 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:27,436 - DEBUG - Step 11: Loss=0.5701
2025-06-02 16:06:27,436 - DEBUG - Online update step: 12/50
2025-06-02 16:06:27,439 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:27,529 - DEBUG - Node anomaly scores shape: torch.Size([17078, 1])
2025-06-02 16:06:27,533 - DEBUG - Edge anomaly scores shape: torch.Size([35710, 1])
2025-06-02 16:06:27,534 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:27,718 - DEBUG - Step 12: Loss=0.5736
2025-06-02 16:06:27,718 - DEBUG - Online update step: 13/50
2025-06-02 16:06:27,721 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:27,822 - DEBUG - Node anomaly scores shape: torch.Size([18978, 1])
2025-06-02 16:06:27,828 - DEBUG - Edge anomaly scores shape: torch.Size([39959, 1])
2025-06-02 16:06:27,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:28,069 - DEBUG - Step 13: Loss=0.5710
2025-06-02 16:06:28,069 - DEBUG - Online update step: 14/50
2025-06-02 16:06:28,072 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:28,164 - DEBUG - Node anomaly scores shape: torch.Size([19548, 1])
2025-06-02 16:06:28,169 - DEBUG - Edge anomaly scores shape: torch.Size([41231, 1])
2025-06-02 16:06:28,170 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:28,383 - DEBUG - Step 14: Loss=0.5735
2025-06-02 16:06:28,383 - DEBUG - Online update step: 15/50
2025-06-02 16:06:28,386 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:28,512 - DEBUG - Node anomaly scores shape: torch.Size([20696, 1])
2025-06-02 16:06:28,518 - DEBUG - Edge anomaly scores shape: torch.Size([43738, 1])
2025-06-02 16:06:28,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:28,760 - DEBUG - Step 15: Loss=0.5705
2025-06-02 16:06:28,760 - DEBUG - Online update step: 16/50
2025-06-02 16:06:28,763 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:28,884 - DEBUG - Node anomaly scores shape: torch.Size([21703, 1])
2025-06-02 16:06:28,890 - DEBUG - Edge anomaly scores shape: torch.Size([45696, 1])
2025-06-02 16:06:28,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:29,109 - DEBUG - Step 16: Loss=0.5732
2025-06-02 16:06:29,110 - DEBUG - Online update step: 17/50
2025-06-02 16:06:29,113 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:29,219 - DEBUG - Node anomaly scores shape: torch.Size([20404, 1])
2025-06-02 16:06:29,223 - DEBUG - Edge anomaly scores shape: torch.Size([43014, 1])
2025-06-02 16:06:29,224 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:29,467 - DEBUG - Step 17: Loss=0.5711
2025-06-02 16:06:29,467 - DEBUG - Online update step: 18/50
2025-06-02 16:06:29,471 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:29,581 - DEBUG - Node anomaly scores shape: torch.Size([21626, 1])
2025-06-02 16:06:29,587 - DEBUG - Edge anomaly scores shape: torch.Size([45741, 1])
2025-06-02 16:06:29,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:29,842 - DEBUG - Step 18: Loss=0.5736
2025-06-02 16:06:29,842 - DEBUG - Online update step: 19/50
2025-06-02 16:06:29,845 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:29,949 - DEBUG - Node anomaly scores shape: torch.Size([20029, 1])
2025-06-02 16:06:29,955 - DEBUG - Edge anomaly scores shape: torch.Size([42319, 1])
2025-06-02 16:06:29,956 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:30,205 - DEBUG - Step 19: Loss=0.5705
2025-06-02 16:06:30,205 - DEBUG - Online update step: 20/50
2025-06-02 16:06:30,209 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:30,315 - DEBUG - Node anomaly scores shape: torch.Size([19116, 1])
2025-06-02 16:06:30,320 - DEBUG - Edge anomaly scores shape: torch.Size([39974, 1])
2025-06-02 16:06:30,321 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:30,570 - DEBUG - Step 20: Loss=0.5735
2025-06-02 16:06:30,570 - DEBUG - Online update step: 21/50
2025-06-02 16:06:30,573 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:30,689 - DEBUG - Node anomaly scores shape: torch.Size([22051, 1])
2025-06-02 16:06:30,694 - DEBUG - Edge anomaly scores shape: torch.Size([46633, 1])
2025-06-02 16:06:30,695 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:30,940 - DEBUG - Step 21: Loss=0.5704
2025-06-02 16:06:30,940 - DEBUG - Online update step: 22/50
2025-06-02 16:06:30,943 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:31,067 - DEBUG - Node anomaly scores shape: torch.Size([21544, 1])
2025-06-02 16:06:31,073 - DEBUG - Edge anomaly scores shape: torch.Size([45454, 1])
2025-06-02 16:06:31,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:31,326 - DEBUG - Step 22: Loss=0.5729
2025-06-02 16:06:31,326 - DEBUG - Online update step: 23/50
2025-06-02 16:06:31,329 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:31,437 - DEBUG - Node anomaly scores shape: torch.Size([19011, 1])
2025-06-02 16:06:31,442 - DEBUG - Edge anomaly scores shape: torch.Size([39947, 1])
2025-06-02 16:06:31,444 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:31,671 - DEBUG - Step 23: Loss=0.5703
2025-06-02 16:06:31,671 - DEBUG - Online update step: 24/50
2025-06-02 16:06:31,674 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:31,796 - DEBUG - Node anomaly scores shape: torch.Size([21609, 1])
2025-06-02 16:06:31,802 - DEBUG - Edge anomaly scores shape: torch.Size([46038, 1])
2025-06-02 16:06:31,803 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:32,053 - DEBUG - Step 24: Loss=0.5729
2025-06-02 16:06:32,053 - DEBUG - Online update step: 25/50
2025-06-02 16:06:32,056 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:32,152 - DEBUG - Node anomaly scores shape: torch.Size([19293, 1])
2025-06-02 16:06:32,157 - DEBUG - Edge anomaly scores shape: torch.Size([40618, 1])
2025-06-02 16:06:32,158 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:32,378 - DEBUG - Step 25: Loss=0.5709
2025-06-02 16:06:32,378 - DEBUG - Online update step: 26/50
2025-06-02 16:06:32,381 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:32,486 - DEBUG - Node anomaly scores shape: torch.Size([19477, 1])
2025-06-02 16:06:32,491 - DEBUG - Edge anomaly scores shape: torch.Size([40984, 1])
2025-06-02 16:06:32,492 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:32,730 - DEBUG - Step 26: Loss=0.5742
2025-06-02 16:06:32,730 - DEBUG - Online update step: 27/50
2025-06-02 16:06:32,733 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:32,825 - DEBUG - Node anomaly scores shape: torch.Size([17406, 1])
2025-06-02 16:06:32,830 - DEBUG - Edge anomaly scores shape: torch.Size([36409, 1])
2025-06-02 16:06:32,830 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:33,047 - DEBUG - Step 27: Loss=0.5709
2025-06-02 16:06:33,048 - DEBUG - Online update step: 28/50
2025-06-02 16:06:33,051 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:33,186 - DEBUG - Node anomaly scores shape: torch.Size([21966, 1])
2025-06-02 16:06:33,192 - DEBUG - Edge anomaly scores shape: torch.Size([46584, 1])
2025-06-02 16:06:33,193 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:33,460 - DEBUG - Step 28: Loss=0.5734
2025-06-02 16:06:33,461 - DEBUG - Online update step: 29/50
2025-06-02 16:06:33,467 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:33,598 - DEBUG - Node anomaly scores shape: torch.Size([22144, 1])
2025-06-02 16:06:33,603 - DEBUG - Edge anomaly scores shape: torch.Size([47008, 1])
2025-06-02 16:06:33,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:33,859 - DEBUG - Step 29: Loss=0.5703
2025-06-02 16:06:33,860 - DEBUG - Online update step: 30/50
2025-06-02 16:06:33,863 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:33,996 - DEBUG - Node anomaly scores shape: torch.Size([19342, 1])
2025-06-02 16:06:34,001 - DEBUG - Edge anomaly scores shape: torch.Size([40778, 1])
2025-06-02 16:06:34,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:34,240 - DEBUG - Step 30: Loss=0.5732
2025-06-02 16:06:34,240 - DEBUG - Online update step: 31/50
2025-06-02 16:06:34,243 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:34,363 - DEBUG - Node anomaly scores shape: torch.Size([20077, 1])
2025-06-02 16:06:34,368 - DEBUG - Edge anomaly scores shape: torch.Size([42387, 1])
2025-06-02 16:06:34,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:34,615 - DEBUG - Step 31: Loss=0.5704
2025-06-02 16:06:34,615 - DEBUG - Online update step: 32/50
2025-06-02 16:06:34,621 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:34,749 - DEBUG - Node anomaly scores shape: torch.Size([21204, 1])
2025-06-02 16:06:34,754 - DEBUG - Edge anomaly scores shape: torch.Size([44917, 1])
2025-06-02 16:06:34,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:34,986 - DEBUG - Step 32: Loss=0.5725
2025-06-02 16:06:34,987 - DEBUG - Online update step: 33/50
2025-06-02 16:06:34,990 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:35,104 - DEBUG - Node anomaly scores shape: torch.Size([18769, 1])
2025-06-02 16:06:35,108 - DEBUG - Edge anomaly scores shape: torch.Size([39246, 1])
2025-06-02 16:06:35,109 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:35,328 - DEBUG - Step 33: Loss=0.5711
2025-06-02 16:06:35,328 - DEBUG - Online update step: 34/50
2025-06-02 16:06:35,332 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:35,445 - DEBUG - Node anomaly scores shape: torch.Size([18884, 1])
2025-06-02 16:06:35,451 - DEBUG - Edge anomaly scores shape: torch.Size([39676, 1])
2025-06-02 16:06:35,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:35,684 - DEBUG - Step 34: Loss=0.5729
2025-06-02 16:06:35,684 - DEBUG - Online update step: 35/50
2025-06-02 16:06:35,687 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:35,811 - DEBUG - Node anomaly scores shape: torch.Size([20160, 1])
2025-06-02 16:06:35,815 - DEBUG - Edge anomaly scores shape: torch.Size([42535, 1])
2025-06-02 16:06:35,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:36,069 - DEBUG - Step 35: Loss=0.5697
2025-06-02 16:06:36,069 - DEBUG - Online update step: 36/50
2025-06-02 16:06:36,072 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:36,181 - DEBUG - Node anomaly scores shape: torch.Size([19150, 1])
2025-06-02 16:06:36,185 - DEBUG - Edge anomaly scores shape: torch.Size([40190, 1])
2025-06-02 16:06:36,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:36,396 - DEBUG - Step 36: Loss=0.5733
2025-06-02 16:06:36,396 - DEBUG - Online update step: 37/50
2025-06-02 16:06:36,399 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:36,512 - DEBUG - Node anomaly scores shape: torch.Size([19137, 1])
2025-06-02 16:06:36,517 - DEBUG - Edge anomaly scores shape: torch.Size([40445, 1])
2025-06-02 16:06:36,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:36,761 - DEBUG - Step 37: Loss=0.5712
2025-06-02 16:06:36,762 - DEBUG - Online update step: 38/50
2025-06-02 16:06:36,765 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:36,876 - DEBUG - Node anomaly scores shape: torch.Size([20339, 1])
2025-06-02 16:06:36,880 - DEBUG - Edge anomaly scores shape: torch.Size([42906, 1])
2025-06-02 16:06:36,882 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:37,115 - DEBUG - Step 38: Loss=0.5735
2025-06-02 16:06:37,115 - DEBUG - Online update step: 39/50
2025-06-02 16:06:37,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:37,233 - DEBUG - Node anomaly scores shape: torch.Size([21649, 1])
2025-06-02 16:06:37,238 - DEBUG - Edge anomaly scores shape: torch.Size([45762, 1])
2025-06-02 16:06:37,239 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:37,488 - DEBUG - Step 39: Loss=0.5702
2025-06-02 16:06:37,489 - DEBUG - Online update step: 40/50
2025-06-02 16:06:37,492 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:37,613 - DEBUG - Node anomaly scores shape: torch.Size([20138, 1])
2025-06-02 16:06:37,618 - DEBUG - Edge anomaly scores shape: torch.Size([42542, 1])
2025-06-02 16:06:37,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:37,863 - DEBUG - Step 40: Loss=0.5731
2025-06-02 16:06:37,863 - DEBUG - Online update step: 41/50
2025-06-02 16:06:37,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:37,980 - DEBUG - Node anomaly scores shape: torch.Size([20162, 1])
2025-06-02 16:06:37,985 - DEBUG - Edge anomaly scores shape: torch.Size([42543, 1])
2025-06-02 16:06:37,986 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:38,228 - DEBUG - Step 41: Loss=0.5705
2025-06-02 16:06:38,228 - DEBUG - Online update step: 42/50
2025-06-02 16:06:38,232 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:38,337 - DEBUG - Node anomaly scores shape: torch.Size([18085, 1])
2025-06-02 16:06:38,341 - DEBUG - Edge anomaly scores shape: torch.Size([37807, 1])
2025-06-02 16:06:38,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:38,567 - DEBUG - Step 42: Loss=0.5730
2025-06-02 16:06:38,567 - DEBUG - Online update step: 43/50
2025-06-02 16:06:38,574 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:38,694 - DEBUG - Node anomaly scores shape: torch.Size([19553, 1])
2025-06-02 16:06:38,700 - DEBUG - Edge anomaly scores shape: torch.Size([41225, 1])
2025-06-02 16:06:38,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:38,930 - DEBUG - Step 43: Loss=0.5697
2025-06-02 16:06:38,930 - DEBUG - Online update step: 44/50
2025-06-02 16:06:38,933 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:39,050 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-02 16:06:39,057 - DEBUG - Edge anomaly scores shape: torch.Size([44846, 1])
2025-06-02 16:06:39,059 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:39,332 - DEBUG - Step 44: Loss=0.5727
2025-06-02 16:06:39,332 - DEBUG - Online update step: 45/50
2025-06-02 16:06:39,335 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:39,437 - DEBUG - Node anomaly scores shape: torch.Size([18506, 1])
2025-06-02 16:06:39,441 - DEBUG - Edge anomaly scores shape: torch.Size([38810, 1])
2025-06-02 16:06:39,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:39,682 - DEBUG - Step 45: Loss=0.5709
2025-06-02 16:06:39,682 - DEBUG - Online update step: 46/50
2025-06-02 16:06:39,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:39,807 - DEBUG - Node anomaly scores shape: torch.Size([21956, 1])
2025-06-02 16:06:39,814 - DEBUG - Edge anomaly scores shape: torch.Size([46455, 1])
2025-06-02 16:06:39,815 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:40,080 - DEBUG - Step 46: Loss=0.5734
2025-06-02 16:06:40,081 - DEBUG - Online update step: 47/50
2025-06-02 16:06:40,084 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:40,204 - DEBUG - Node anomaly scores shape: torch.Size([20116, 1])
2025-06-02 16:06:40,209 - DEBUG - Edge anomaly scores shape: torch.Size([42427, 1])
2025-06-02 16:06:40,210 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:40,444 - DEBUG - Step 47: Loss=0.5698
2025-06-02 16:06:40,445 - DEBUG - Online update step: 48/50
2025-06-02 16:06:40,448 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:40,553 - DEBUG - Node anomaly scores shape: torch.Size([18268, 1])
2025-06-02 16:06:40,557 - DEBUG - Edge anomaly scores shape: torch.Size([38189, 1])
2025-06-02 16:06:40,558 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:40,792 - DEBUG - Step 48: Loss=0.5733
2025-06-02 16:06:40,792 - DEBUG - Online update step: 49/50
2025-06-02 16:06:40,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:40,932 - DEBUG - Node anomaly scores shape: torch.Size([21015, 1])
2025-06-02 16:06:40,937 - DEBUG - Edge anomaly scores shape: torch.Size([44402, 1])
2025-06-02 16:06:40,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:41,217 - DEBUG - Step 49: Loss=0.5705
2025-06-02 16:06:41,217 - DEBUG - Online update step: 50/50
2025-06-02 16:06:41,222 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:41,343 - DEBUG - Node anomaly scores shape: torch.Size([21585, 1])
2025-06-02 16:06:41,348 - DEBUG - Edge anomaly scores shape: torch.Size([45743, 1])
2025-06-02 16:06:41,349 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:41,589 - DEBUG - Step 50: Loss=0.5724
2025-06-02 16:06:41,590 - INFO - Online update finished. Average loss: 0.5719, Learning rate: 0.001000
2025-06-02 16:06:41,592 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:06:41,592 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:06:41,594 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.23606840e-08 -1.90164373e-09
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -5.1971352e-09
  1.5158311e-09 -3.6813042e-09 -6.4964190e-09 -8.6618923e-10
 -1.5158311e-09  1.7323785e-09]
2025-06-02 16:06:41,596 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002271]
2025-06-02 16:06:41,596 - INFO - Online update complete. Loss: 0.5719
2025-06-02 16:06:41,596 - INFO - Running anomaly detection...
2025-06-02 16:06:41,597 - INFO - Starting anomaly detection.
2025-06-02 16:06:41,605 - DEBUG - Node reconstruction errors: [0.00974976 0.1974228  0.05954747 ... 0.00409603 0.00646537 0.01057322]
2025-06-02 16:06:41,606 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783866 1.2587271  0.15783866]
2025-06-02 16:06:41,609 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160641_update_52.json
2025-06-02 16:06:41,609 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:06:41,618 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160641_update_52.pth and as latest_checkpoint.pth
2025-06-02 16:06:41,619 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870655.dot): 0.1218
2025-06-02 16:06:41,619 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-02 16:06:41,619 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1974, MLP Score: 0.4986
2025-06-02 16:06:41,619 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1944, MLP Score: 0.4967
2025-06-02 16:06:41,619 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3360, MLP Score: 0.4889
2025-06-02 16:06:41,619 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1136, MLP Score: 0.4854
2025-06-02 16:06:41,619 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0934, MLP Score: 0.4799
2025-06-02 16:06:41,619 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:06:41,619 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.4830
2025-06-02 16:06:41,619 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4401
2025-06-02 16:06:41,620 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.4776
2025-06-02 16:06:41,620 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4530
2025-06-02 16:06:41,620 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.4732
2025-06-02 16:06:41,620 - INFO - 
--- Processing file: nw_graph_encoded_1748870685.dot (Timestamp: 2025-06-02 15:24:45) ---
2025-06-02 16:06:41,620 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-02 16:06:41,620 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-02 16:06:41,651 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 16:06:41,679 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 16:06:41,679 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 16:06:41,680 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870685.dot
2025-06-02 16:06:41,701 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 16:06:41,722 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870685.dot'.
2025-06-02 16:06:41,722 - INFO - Processing node updates/additions.
2025-06-02 16:06:41,727 - INFO - Processing edge updates/additions.
2025-06-02 16:06:41,738 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:06:41,739 - INFO - Finished updating NetworkX graph.
2025-06-02 16:06:41,739 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:06:41,740 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:06:41,749 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:06:41,750 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:06:41,751 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:06:41,752 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:06:41,753 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:06:41,757 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:06:41,758 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:06:41,759 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:06:41,761 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:06:41,761 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:06:41,762 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:06:41,762 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:06:41,762 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:06:41,764 - INFO - Performing online update...
2025-06-02 16:06:41,765 - INFO - Starting online update for 50 steps.
2025-06-02 16:06:41,765 - DEBUG - Updated RunningStats: new_mean=0.9452545824321069, new_var=30600000000161.41, new_n=3090
2025-06-02 16:06:41,765 - DEBUG - Updated RunningStats: new_mean=0.9432723154578565, new_var=30900000000018.305, new_n=3120
2025-06-02 16:06:41,765 - DEBUG - Updated RunningStats: new_mean=1.174727564646332, new_var=10200000000093.76, new_n=1030
2025-06-02 16:06:41,766 - DEBUG - Updated RunningStats: new_mean=1.1737652517294792, new_var=10300000000001.59, new_n=1040
2025-06-02 16:06:41,766 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:06:41,766 - DEBUG - Online update step: 1/50
2025-06-02 16:06:41,768 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:41,929 - DEBUG - Node anomaly scores shape: torch.Size([20834, 1])
2025-06-02 16:06:41,936 - DEBUG - Edge anomaly scores shape: torch.Size([44009, 1])
2025-06-02 16:06:41,937 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:42,196 - DEBUG - Step 1: Loss=0.5700
2025-06-02 16:06:42,196 - DEBUG - Online update step: 2/50
2025-06-02 16:06:42,199 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:42,319 - DEBUG - Node anomaly scores shape: torch.Size([20092, 1])
2025-06-02 16:06:42,325 - DEBUG - Edge anomaly scores shape: torch.Size([42347, 1])
2025-06-02 16:06:42,326 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:42,588 - DEBUG - Step 2: Loss=0.5732
2025-06-02 16:06:42,588 - DEBUG - Online update step: 3/50
2025-06-02 16:06:42,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:42,703 - DEBUG - Node anomaly scores shape: torch.Size([19519, 1])
2025-06-02 16:06:42,709 - DEBUG - Edge anomaly scores shape: torch.Size([40984, 1])
2025-06-02 16:06:42,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:42,943 - DEBUG - Step 3: Loss=0.5710
2025-06-02 16:06:42,943 - DEBUG - Online update step: 4/50
2025-06-02 16:06:42,946 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:43,087 - DEBUG - Node anomaly scores shape: torch.Size([21598, 1])
2025-06-02 16:06:43,095 - DEBUG - Edge anomaly scores shape: torch.Size([45691, 1])
2025-06-02 16:06:43,096 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:43,389 - DEBUG - Step 4: Loss=0.5729
2025-06-02 16:06:43,390 - DEBUG - Online update step: 5/50
2025-06-02 16:06:43,395 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:43,535 - DEBUG - Node anomaly scores shape: torch.Size([21734, 1])
2025-06-02 16:06:43,543 - DEBUG - Edge anomaly scores shape: torch.Size([46174, 1])
2025-06-02 16:06:43,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:43,802 - DEBUG - Step 5: Loss=0.5695
2025-06-02 16:06:43,802 - DEBUG - Online update step: 6/50
2025-06-02 16:06:43,806 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:43,935 - DEBUG - Node anomaly scores shape: torch.Size([21023, 1])
2025-06-02 16:06:43,940 - DEBUG - Edge anomaly scores shape: torch.Size([44268, 1])
2025-06-02 16:06:43,942 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:44,159 - DEBUG - Step 6: Loss=0.5732
2025-06-02 16:06:44,159 - DEBUG - Online update step: 7/50
2025-06-02 16:06:44,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:44,269 - DEBUG - Node anomaly scores shape: torch.Size([20505, 1])
2025-06-02 16:06:44,274 - DEBUG - Edge anomaly scores shape: torch.Size([43174, 1])
2025-06-02 16:06:44,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:44,477 - DEBUG - Step 7: Loss=0.5710
2025-06-02 16:06:44,477 - DEBUG - Online update step: 8/50
2025-06-02 16:06:44,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:44,586 - DEBUG - Node anomaly scores shape: torch.Size([19410, 1])
2025-06-02 16:06:44,591 - DEBUG - Edge anomaly scores shape: torch.Size([40654, 1])
2025-06-02 16:06:44,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:44,796 - DEBUG - Step 8: Loss=0.5735
2025-06-02 16:06:44,796 - DEBUG - Online update step: 9/50
2025-06-02 16:06:44,799 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:44,932 - DEBUG - Node anomaly scores shape: torch.Size([21481, 1])
2025-06-02 16:06:44,939 - DEBUG - Edge anomaly scores shape: torch.Size([45349, 1])
2025-06-02 16:06:44,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:45,190 - DEBUG - Step 9: Loss=0.5693
2025-06-02 16:06:45,190 - DEBUG - Online update step: 10/50
2025-06-02 16:06:45,193 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:45,297 - DEBUG - Node anomaly scores shape: torch.Size([18434, 1])
2025-06-02 16:06:45,302 - DEBUG - Edge anomaly scores shape: torch.Size([38427, 1])
2025-06-02 16:06:45,303 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:45,486 - DEBUG - Step 10: Loss=0.5730
2025-06-02 16:06:45,487 - DEBUG - Online update step: 11/50
2025-06-02 16:06:45,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:45,607 - DEBUG - Node anomaly scores shape: torch.Size([19149, 1])
2025-06-02 16:06:45,612 - DEBUG - Edge anomaly scores shape: torch.Size([40095, 1])
2025-06-02 16:06:45,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:45,823 - DEBUG - Step 11: Loss=0.5708
2025-06-02 16:06:45,824 - DEBUG - Online update step: 12/50
2025-06-02 16:06:45,827 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:45,942 - DEBUG - Node anomaly scores shape: torch.Size([20511, 1])
2025-06-02 16:06:45,947 - DEBUG - Edge anomaly scores shape: torch.Size([43312, 1])
2025-06-02 16:06:45,948 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:46,204 - DEBUG - Step 12: Loss=0.5720
2025-06-02 16:06:46,204 - DEBUG - Online update step: 13/50
2025-06-02 16:06:46,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:46,324 - DEBUG - Node anomaly scores shape: torch.Size([20998, 1])
2025-06-02 16:06:46,328 - DEBUG - Edge anomaly scores shape: torch.Size([44464, 1])
2025-06-02 16:06:46,330 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:46,583 - DEBUG - Step 13: Loss=0.5690
2025-06-02 16:06:46,583 - DEBUG - Online update step: 14/50
2025-06-02 16:06:46,586 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:46,704 - DEBUG - Node anomaly scores shape: torch.Size([20890, 1])
2025-06-02 16:06:46,709 - DEBUG - Edge anomaly scores shape: torch.Size([44322, 1])
2025-06-02 16:06:46,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:46,923 - DEBUG - Step 14: Loss=0.5728
2025-06-02 16:06:46,923 - DEBUG - Online update step: 15/50
2025-06-02 16:06:46,926 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:47,034 - DEBUG - Node anomaly scores shape: torch.Size([19834, 1])
2025-06-02 16:06:47,039 - DEBUG - Edge anomaly scores shape: torch.Size([41833, 1])
2025-06-02 16:06:47,041 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:47,261 - DEBUG - Step 15: Loss=0.5706
2025-06-02 16:06:47,261 - DEBUG - Online update step: 16/50
2025-06-02 16:06:47,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:47,381 - DEBUG - Node anomaly scores shape: torch.Size([20441, 1])
2025-06-02 16:06:47,386 - DEBUG - Edge anomaly scores shape: torch.Size([43245, 1])
2025-06-02 16:06:47,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:47,599 - DEBUG - Step 16: Loss=0.5736
2025-06-02 16:06:47,600 - DEBUG - Online update step: 17/50
2025-06-02 16:06:47,603 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:47,712 - DEBUG - Node anomaly scores shape: torch.Size([19543, 1])
2025-06-02 16:06:47,717 - DEBUG - Edge anomaly scores shape: torch.Size([40999, 1])
2025-06-02 16:06:47,718 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:47,921 - DEBUG - Step 17: Loss=0.5696
2025-06-02 16:06:47,922 - DEBUG - Online update step: 18/50
2025-06-02 16:06:47,925 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:48,061 - DEBUG - Node anomaly scores shape: torch.Size([22846, 1])
2025-06-02 16:06:48,066 - DEBUG - Edge anomaly scores shape: torch.Size([48656, 1])
2025-06-02 16:06:48,068 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:48,339 - DEBUG - Step 18: Loss=0.5728
2025-06-02 16:06:48,340 - DEBUG - Online update step: 19/50
2025-06-02 16:06:48,343 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:48,458 - DEBUG - Node anomaly scores shape: torch.Size([21060, 1])
2025-06-02 16:06:48,463 - DEBUG - Edge anomaly scores shape: torch.Size([44423, 1])
2025-06-02 16:06:48,464 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:48,743 - DEBUG - Step 19: Loss=0.5704
2025-06-02 16:06:48,743 - DEBUG - Online update step: 20/50
2025-06-02 16:06:48,748 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:48,850 - DEBUG - Node anomaly scores shape: torch.Size([19605, 1])
2025-06-02 16:06:48,854 - DEBUG - Edge anomaly scores shape: torch.Size([41431, 1])
2025-06-02 16:06:48,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:49,078 - DEBUG - Step 20: Loss=0.5726
2025-06-02 16:06:49,078 - DEBUG - Online update step: 21/50
2025-06-02 16:06:49,084 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:49,219 - DEBUG - Node anomaly scores shape: torch.Size([21346, 1])
2025-06-02 16:06:49,224 - DEBUG - Edge anomaly scores shape: torch.Size([45008, 1])
2025-06-02 16:06:49,226 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:49,461 - DEBUG - Step 21: Loss=0.5691
2025-06-02 16:06:49,461 - DEBUG - Online update step: 22/50
2025-06-02 16:06:49,467 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:49,568 - DEBUG - Node anomaly scores shape: torch.Size([19855, 1])
2025-06-02 16:06:49,573 - DEBUG - Edge anomaly scores shape: torch.Size([41968, 1])
2025-06-02 16:06:49,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:49,789 - DEBUG - Step 22: Loss=0.5721
2025-06-02 16:06:49,789 - DEBUG - Online update step: 23/50
2025-06-02 16:06:49,796 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:49,899 - DEBUG - Node anomaly scores shape: torch.Size([18894, 1])
2025-06-02 16:06:49,904 - DEBUG - Edge anomaly scores shape: torch.Size([39776, 1])
2025-06-02 16:06:49,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:50,122 - DEBUG - Step 23: Loss=0.5702
2025-06-02 16:06:50,123 - DEBUG - Online update step: 24/50
2025-06-02 16:06:50,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:50,238 - DEBUG - Node anomaly scores shape: torch.Size([20396, 1])
2025-06-02 16:06:50,242 - DEBUG - Edge anomaly scores shape: torch.Size([43086, 1])
2025-06-02 16:06:50,244 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:50,469 - DEBUG - Step 24: Loss=0.5733
2025-06-02 16:06:50,469 - DEBUG - Online update step: 25/50
2025-06-02 16:06:50,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:50,577 - DEBUG - Node anomaly scores shape: torch.Size([19114, 1])
2025-06-02 16:06:50,582 - DEBUG - Edge anomaly scores shape: torch.Size([40199, 1])
2025-06-02 16:06:50,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:50,825 - DEBUG - Step 25: Loss=0.5691
2025-06-02 16:06:50,825 - DEBUG - Online update step: 26/50
2025-06-02 16:06:50,828 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:50,943 - DEBUG - Node anomaly scores shape: torch.Size([22539, 1])
2025-06-02 16:06:50,949 - DEBUG - Edge anomaly scores shape: torch.Size([47726, 1])
2025-06-02 16:06:50,950 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:51,199 - DEBUG - Step 26: Loss=0.5723
2025-06-02 16:06:51,200 - DEBUG - Online update step: 27/50
2025-06-02 16:06:51,203 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:51,311 - DEBUG - Node anomaly scores shape: torch.Size([19726, 1])
2025-06-02 16:06:51,316 - DEBUG - Edge anomaly scores shape: torch.Size([41590, 1])
2025-06-02 16:06:51,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:51,518 - DEBUG - Step 27: Loss=0.5708
2025-06-02 16:06:51,518 - DEBUG - Online update step: 28/50
2025-06-02 16:06:51,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:51,640 - DEBUG - Node anomaly scores shape: torch.Size([20715, 1])
2025-06-02 16:06:51,645 - DEBUG - Edge anomaly scores shape: torch.Size([43876, 1])
2025-06-02 16:06:51,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:51,874 - DEBUG - Step 28: Loss=0.5729
2025-06-02 16:06:51,874 - DEBUG - Online update step: 29/50
2025-06-02 16:06:51,878 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:51,997 - DEBUG - Node anomaly scores shape: torch.Size([22306, 1])
2025-06-02 16:06:52,002 - DEBUG - Edge anomaly scores shape: torch.Size([47229, 1])
2025-06-02 16:06:52,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:52,251 - DEBUG - Step 29: Loss=0.5689
2025-06-02 16:06:52,252 - DEBUG - Online update step: 30/50
2025-06-02 16:06:52,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:52,364 - DEBUG - Node anomaly scores shape: torch.Size([19783, 1])
2025-06-02 16:06:52,368 - DEBUG - Edge anomaly scores shape: torch.Size([41674, 1])
2025-06-02 16:06:52,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:52,579 - DEBUG - Step 30: Loss=0.5729
2025-06-02 16:06:52,579 - DEBUG - Online update step: 31/50
2025-06-02 16:06:52,583 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:52,702 - DEBUG - Node anomaly scores shape: torch.Size([20600, 1])
2025-06-02 16:06:52,707 - DEBUG - Edge anomaly scores shape: torch.Size([43405, 1])
2025-06-02 16:06:52,708 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:52,933 - DEBUG - Step 31: Loss=0.5699
2025-06-02 16:06:52,934 - DEBUG - Online update step: 32/50
2025-06-02 16:06:52,937 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:53,045 - DEBUG - Node anomaly scores shape: torch.Size([19914, 1])
2025-06-02 16:06:53,050 - DEBUG - Edge anomaly scores shape: torch.Size([41946, 1])
2025-06-02 16:06:53,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:53,297 - DEBUG - Step 32: Loss=0.5726
2025-06-02 16:06:53,297 - DEBUG - Online update step: 33/50
2025-06-02 16:06:53,300 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:53,404 - DEBUG - Node anomaly scores shape: torch.Size([18776, 1])
2025-06-02 16:06:53,410 - DEBUG - Edge anomaly scores shape: torch.Size([39481, 1])
2025-06-02 16:06:53,411 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:53,631 - DEBUG - Step 33: Loss=0.5699
2025-06-02 16:06:53,631 - DEBUG - Online update step: 34/50
2025-06-02 16:06:53,634 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:53,746 - DEBUG - Node anomaly scores shape: torch.Size([19089, 1])
2025-06-02 16:06:53,752 - DEBUG - Edge anomaly scores shape: torch.Size([40132, 1])
2025-06-02 16:06:53,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:53,996 - DEBUG - Step 34: Loss=0.5725
2025-06-02 16:06:53,996 - DEBUG - Online update step: 35/50
2025-06-02 16:06:54,002 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:54,114 - DEBUG - Node anomaly scores shape: torch.Size([19684, 1])
2025-06-02 16:06:54,120 - DEBUG - Edge anomaly scores shape: torch.Size([41324, 1])
2025-06-02 16:06:54,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:54,385 - DEBUG - Step 35: Loss=0.5702
2025-06-02 16:06:54,385 - DEBUG - Online update step: 36/50
2025-06-02 16:06:54,391 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:54,509 - DEBUG - Node anomaly scores shape: torch.Size([21396, 1])
2025-06-02 16:06:54,513 - DEBUG - Edge anomaly scores shape: torch.Size([45309, 1])
2025-06-02 16:06:54,514 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:54,770 - DEBUG - Step 36: Loss=0.5727
2025-06-02 16:06:54,770 - DEBUG - Online update step: 37/50
2025-06-02 16:06:54,773 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:54,887 - DEBUG - Node anomaly scores shape: torch.Size([22468, 1])
2025-06-02 16:06:54,892 - DEBUG - Edge anomaly scores shape: torch.Size([47782, 1])
2025-06-02 16:06:54,893 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:55,156 - DEBUG - Step 37: Loss=0.5684
2025-06-02 16:06:55,156 - DEBUG - Online update step: 38/50
2025-06-02 16:06:55,162 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:55,266 - DEBUG - Node anomaly scores shape: torch.Size([18722, 1])
2025-06-02 16:06:55,273 - DEBUG - Edge anomaly scores shape: torch.Size([39274, 1])
2025-06-02 16:06:55,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:55,476 - DEBUG - Step 38: Loss=0.5736
2025-06-02 16:06:55,476 - DEBUG - Online update step: 39/50
2025-06-02 16:06:55,479 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:55,588 - DEBUG - Node anomaly scores shape: torch.Size([19641, 1])
2025-06-02 16:06:55,593 - DEBUG - Edge anomaly scores shape: torch.Size([41618, 1])
2025-06-02 16:06:55,594 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:55,831 - DEBUG - Step 39: Loss=0.5711
2025-06-02 16:06:55,831 - DEBUG - Online update step: 40/50
2025-06-02 16:06:55,834 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:55,968 - DEBUG - Node anomaly scores shape: torch.Size([22189, 1])
2025-06-02 16:06:55,974 - DEBUG - Edge anomaly scores shape: torch.Size([46978, 1])
2025-06-02 16:06:55,976 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:56,246 - DEBUG - Step 40: Loss=0.5713
2025-06-02 16:06:56,247 - DEBUG - Online update step: 41/50
2025-06-02 16:06:56,252 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:56,342 - DEBUG - Node anomaly scores shape: torch.Size([16951, 1])
2025-06-02 16:06:56,346 - DEBUG - Edge anomaly scores shape: torch.Size([35486, 1])
2025-06-02 16:06:56,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:56,567 - DEBUG - Step 41: Loss=0.5696
2025-06-02 16:06:56,567 - DEBUG - Online update step: 42/50
2025-06-02 16:06:56,577 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:56,692 - DEBUG - Node anomaly scores shape: torch.Size([22532, 1])
2025-06-02 16:06:56,700 - DEBUG - Edge anomaly scores shape: torch.Size([47790, 1])
2025-06-02 16:06:56,701 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:56,969 - DEBUG - Step 42: Loss=0.5718
2025-06-02 16:06:56,970 - DEBUG - Online update step: 43/50
2025-06-02 16:06:56,974 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:57,099 - DEBUG - Node anomaly scores shape: torch.Size([23266, 1])
2025-06-02 16:06:57,104 - DEBUG - Edge anomaly scores shape: torch.Size([49666, 1])
2025-06-02 16:06:57,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:57,373 - DEBUG - Step 43: Loss=0.5693
2025-06-02 16:06:57,373 - DEBUG - Online update step: 44/50
2025-06-02 16:06:57,376 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:57,495 - DEBUG - Node anomaly scores shape: torch.Size([20754, 1])
2025-06-02 16:06:57,500 - DEBUG - Edge anomaly scores shape: torch.Size([43760, 1])
2025-06-02 16:06:57,501 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:57,742 - DEBUG - Step 44: Loss=0.5730
2025-06-02 16:06:57,743 - DEBUG - Online update step: 45/50
2025-06-02 16:06:57,746 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:57,839 - DEBUG - Node anomaly scores shape: torch.Size([17812, 1])
2025-06-02 16:06:57,844 - DEBUG - Edge anomaly scores shape: torch.Size([37128, 1])
2025-06-02 16:06:57,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:58,049 - DEBUG - Step 45: Loss=0.5711
2025-06-02 16:06:58,050 - DEBUG - Online update step: 46/50
2025-06-02 16:06:58,053 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:58,186 - DEBUG - Node anomaly scores shape: torch.Size([21884, 1])
2025-06-02 16:06:58,191 - DEBUG - Edge anomaly scores shape: torch.Size([46533, 1])
2025-06-02 16:06:58,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:58,459 - DEBUG - Step 46: Loss=0.5721
2025-06-02 16:06:58,459 - DEBUG - Online update step: 47/50
2025-06-02 16:06:58,462 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:58,587 - DEBUG - Node anomaly scores shape: torch.Size([20569, 1])
2025-06-02 16:06:58,592 - DEBUG - Edge anomaly scores shape: torch.Size([43391, 1])
2025-06-02 16:06:58,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:58,843 - DEBUG - Step 47: Loss=0.5696
2025-06-02 16:06:58,843 - DEBUG - Online update step: 48/50
2025-06-02 16:06:58,846 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:58,984 - DEBUG - Node anomaly scores shape: torch.Size([22556, 1])
2025-06-02 16:06:58,989 - DEBUG - Edge anomaly scores shape: torch.Size([47920, 1])
2025-06-02 16:06:58,991 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:59,238 - DEBUG - Step 48: Loss=0.5716
2025-06-02 16:06:59,238 - DEBUG - Online update step: 49/50
2025-06-02 16:06:59,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:59,364 - DEBUG - Node anomaly scores shape: torch.Size([20836, 1])
2025-06-02 16:06:59,369 - DEBUG - Edge anomaly scores shape: torch.Size([43905, 1])
2025-06-02 16:06:59,370 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:59,601 - DEBUG - Step 49: Loss=0.5687
2025-06-02 16:06:59,601 - DEBUG - Online update step: 50/50
2025-06-02 16:06:59,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:06:59,722 - DEBUG - Node anomaly scores shape: torch.Size([20285, 1])
2025-06-02 16:06:59,727 - DEBUG - Edge anomaly scores shape: torch.Size([42639, 1])
2025-06-02 16:06:59,728 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:06:59,960 - DEBUG - Step 50: Loss=0.5731
2025-06-02 16:06:59,960 - INFO - Online update finished. Average loss: 0.5713, Learning rate: 0.001000
2025-06-02 16:06:59,961 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:06:59,962 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:06:59,963 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:06:59,963 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-02 16:06:59,967 - INFO - Online update complete. Loss: 0.5713
2025-06-02 16:06:59,967 - INFO - Running anomaly detection...
2025-06-02 16:06:59,968 - INFO - Starting anomaly detection.
2025-06-02 16:06:59,973 - DEBUG - Node reconstruction errors: [0.0106715  0.16394812 0.06454813 ... 0.00306747 0.00486182 0.01139244]
2025-06-02 16:06:59,974 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783861 1.2587271  0.15783861]
2025-06-02 16:06:59,976 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160659_update_53.json
2025-06-02 16:06:59,976 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:06:59,985 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160659_update_53.pth and as latest_checkpoint.pth
2025-06-02 16:06:59,985 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870685.dot): 0.1262
2025-06-02 16:06:59,985 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:06:59,985 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1639, MLP Score: 0.5151
2025-06-02 16:06:59,985 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2047, MLP Score: 0.5080
2025-06-02 16:06:59,985 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.3179, MLP Score: 0.4978
2025-06-02 16:06:59,985 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1114, MLP Score: 0.4952
2025-06-02 16:06:59,985 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0939, MLP Score: 0.4931
2025-06-02 16:06:59,985 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:06:59,986 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.5168
2025-06-02 16:06:59,986 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4823
2025-06-02 16:06:59,986 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.5049
2025-06-02 16:06:59,986 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4970
2025-06-02 16:06:59,986 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.5063
2025-06-02 16:06:59,986 - INFO - 
--- Processing file: nw_graph_encoded_1748870715.dot (Timestamp: 2025-06-02 15:25:15) ---
2025-06-02 16:06:59,986 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-02 16:06:59,986 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-02 16:07:00,017 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 16:07:00,048 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 16:07:00,048 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 16:07:00,048 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870715.dot
2025-06-02 16:07:00,071 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 16:07:00,094 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870715.dot'.
2025-06-02 16:07:00,094 - INFO - Processing node updates/additions.
2025-06-02 16:07:00,099 - INFO - Processing edge updates/additions.
2025-06-02 16:07:00,110 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:07:00,111 - INFO - Finished updating NetworkX graph.
2025-06-02 16:07:00,111 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:07:00,112 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:07:00,122 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:07:00,124 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:07:00,124 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:07:00,127 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:07:00,129 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:07:00,137 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:07:00,139 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:07:00,141 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:07:00,144 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:07:00,146 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:07:00,146 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:07:00,146 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:07:00,146 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:07:00,149 - INFO - Performing online update...
2025-06-02 16:07:00,149 - INFO - Starting online update for 50 steps.
2025-06-02 16:07:00,149 - DEBUG - Updated RunningStats: new_mean=0.9453169548423284, new_var=31200000000161.41, new_n=3150
2025-06-02 16:07:00,149 - DEBUG - Updated RunningStats: new_mean=0.9433715007127786, new_var=31500000000018.31, new_n=3180
2025-06-02 16:07:00,150 - DEBUG - Updated RunningStats: new_mean=1.178082404246297, new_var=10400000000093.729, new_n=1050
2025-06-02 16:07:00,150 - DEBUG - Updated RunningStats: new_mean=1.1771065987467435, new_var=10500000000001.596, new_n=1060
2025-06-02 16:07:00,150 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:07:00,150 - DEBUG - Online update step: 1/50
2025-06-02 16:07:00,152 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:00,301 - DEBUG - Node anomaly scores shape: torch.Size([20620, 1])
2025-06-02 16:07:00,310 - DEBUG - Edge anomaly scores shape: torch.Size([43297, 1])
2025-06-02 16:07:00,311 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:00,532 - DEBUG - Step 1: Loss=0.5709
2025-06-02 16:07:00,532 - DEBUG - Online update step: 2/50
2025-06-02 16:07:00,540 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:00,677 - DEBUG - Node anomaly scores shape: torch.Size([22186, 1])
2025-06-02 16:07:00,682 - DEBUG - Edge anomaly scores shape: torch.Size([47157, 1])
2025-06-02 16:07:00,683 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:00,925 - DEBUG - Step 2: Loss=0.5721
2025-06-02 16:07:00,926 - DEBUG - Online update step: 3/50
2025-06-02 16:07:00,929 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:01,096 - DEBUG - Node anomaly scores shape: torch.Size([24069, 1])
2025-06-02 16:07:01,102 - DEBUG - Edge anomaly scores shape: torch.Size([51517, 1])
2025-06-02 16:07:01,103 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:01,437 - DEBUG - Step 3: Loss=0.5688
2025-06-02 16:07:01,437 - DEBUG - Online update step: 4/50
2025-06-02 16:07:01,440 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:01,549 - DEBUG - Node anomaly scores shape: torch.Size([20995, 1])
2025-06-02 16:07:01,554 - DEBUG - Edge anomaly scores shape: torch.Size([44610, 1])
2025-06-02 16:07:01,555 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:01,799 - DEBUG - Step 4: Loss=0.5722
2025-06-02 16:07:01,799 - DEBUG - Online update step: 5/50
2025-06-02 16:07:01,802 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:01,921 - DEBUG - Node anomaly scores shape: torch.Size([21790, 1])
2025-06-02 16:07:01,927 - DEBUG - Edge anomaly scores shape: torch.Size([46206, 1])
2025-06-02 16:07:01,928 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:02,164 - DEBUG - Step 5: Loss=0.5698
2025-06-02 16:07:02,165 - DEBUG - Online update step: 6/50
2025-06-02 16:07:02,168 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:02,270 - DEBUG - Node anomaly scores shape: torch.Size([18201, 1])
2025-06-02 16:07:02,274 - DEBUG - Edge anomaly scores shape: torch.Size([38263, 1])
2025-06-02 16:07:02,275 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:02,471 - DEBUG - Step 6: Loss=0.5725
2025-06-02 16:07:02,471 - DEBUG - Online update step: 7/50
2025-06-02 16:07:02,475 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:02,607 - DEBUG - Node anomaly scores shape: torch.Size([21314, 1])
2025-06-02 16:07:02,612 - DEBUG - Edge anomaly scores shape: torch.Size([45178, 1])
2025-06-02 16:07:02,613 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:02,862 - DEBUG - Step 7: Loss=0.5696
2025-06-02 16:07:02,863 - DEBUG - Online update step: 8/50
2025-06-02 16:07:02,866 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:03,000 - DEBUG - Node anomaly scores shape: torch.Size([21947, 1])
2025-06-02 16:07:03,005 - DEBUG - Edge anomaly scores shape: torch.Size([46363, 1])
2025-06-02 16:07:03,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:03,289 - DEBUG - Step 8: Loss=0.5718
2025-06-02 16:07:03,290 - DEBUG - Online update step: 9/50
2025-06-02 16:07:03,296 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:03,402 - DEBUG - Node anomaly scores shape: torch.Size([20322, 1])
2025-06-02 16:07:03,410 - DEBUG - Edge anomaly scores shape: torch.Size([42984, 1])
2025-06-02 16:07:03,412 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:03,662 - DEBUG - Step 9: Loss=0.5699
2025-06-02 16:07:03,663 - DEBUG - Online update step: 10/50
2025-06-02 16:07:03,666 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:03,775 - DEBUG - Node anomaly scores shape: torch.Size([21311, 1])
2025-06-02 16:07:03,780 - DEBUG - Edge anomaly scores shape: torch.Size([45153, 1])
2025-06-02 16:07:03,781 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:04,010 - DEBUG - Step 10: Loss=0.5724
2025-06-02 16:07:04,011 - DEBUG - Online update step: 11/50
2025-06-02 16:07:04,014 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:04,124 - DEBUG - Node anomaly scores shape: torch.Size([20358, 1])
2025-06-02 16:07:04,129 - DEBUG - Edge anomaly scores shape: torch.Size([43111, 1])
2025-06-02 16:07:04,130 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:04,365 - DEBUG - Step 11: Loss=0.5689
2025-06-02 16:07:04,365 - DEBUG - Online update step: 12/50
2025-06-02 16:07:04,369 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:04,488 - DEBUG - Node anomaly scores shape: torch.Size([21397, 1])
2025-06-02 16:07:04,493 - DEBUG - Edge anomaly scores shape: torch.Size([45352, 1])
2025-06-02 16:07:04,494 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:04,744 - DEBUG - Step 12: Loss=0.5722
2025-06-02 16:07:04,745 - DEBUG - Online update step: 13/50
2025-06-02 16:07:04,750 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:04,855 - DEBUG - Node anomaly scores shape: torch.Size([21248, 1])
2025-06-02 16:07:04,860 - DEBUG - Edge anomaly scores shape: torch.Size([45040, 1])
2025-06-02 16:07:04,862 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:05,099 - DEBUG - Step 13: Loss=0.5702
2025-06-02 16:07:05,099 - DEBUG - Online update step: 14/50
2025-06-02 16:07:05,103 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:05,211 - DEBUG - Node anomaly scores shape: torch.Size([19952, 1])
2025-06-02 16:07:05,215 - DEBUG - Edge anomaly scores shape: torch.Size([42241, 1])
2025-06-02 16:07:05,216 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:05,468 - DEBUG - Step 14: Loss=0.5723
2025-06-02 16:07:05,468 - DEBUG - Online update step: 15/50
2025-06-02 16:07:05,474 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:05,586 - DEBUG - Node anomaly scores shape: torch.Size([20667, 1])
2025-06-02 16:07:05,591 - DEBUG - Edge anomaly scores shape: torch.Size([43691, 1])
2025-06-02 16:07:05,592 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:05,840 - DEBUG - Step 15: Loss=0.5696
2025-06-02 16:07:05,840 - DEBUG - Online update step: 16/50
2025-06-02 16:07:05,843 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:05,938 - DEBUG - Node anomaly scores shape: torch.Size([19687, 1])
2025-06-02 16:07:05,943 - DEBUG - Edge anomaly scores shape: torch.Size([41442, 1])
2025-06-02 16:07:05,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:06,167 - DEBUG - Step 16: Loss=0.5717
2025-06-02 16:07:06,167 - DEBUG - Online update step: 17/50
2025-06-02 16:07:06,171 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:06,275 - DEBUG - Node anomaly scores shape: torch.Size([20984, 1])
2025-06-02 16:07:06,280 - DEBUG - Edge anomaly scores shape: torch.Size([44429, 1])
2025-06-02 16:07:06,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:06,509 - DEBUG - Step 17: Loss=0.5695
2025-06-02 16:07:06,510 - DEBUG - Online update step: 18/50
2025-06-02 16:07:06,516 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:06,614 - DEBUG - Node anomaly scores shape: torch.Size([18592, 1])
2025-06-02 16:07:06,618 - DEBUG - Edge anomaly scores shape: torch.Size([39105, 1])
2025-06-02 16:07:06,619 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:06,864 - DEBUG - Step 18: Loss=0.5721
2025-06-02 16:07:06,865 - DEBUG - Online update step: 19/50
2025-06-02 16:07:06,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:06,997 - DEBUG - Node anomaly scores shape: torch.Size([20569, 1])
2025-06-02 16:07:07,002 - DEBUG - Edge anomaly scores shape: torch.Size([43715, 1])
2025-06-02 16:07:07,003 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:07,250 - DEBUG - Step 19: Loss=0.5690
2025-06-02 16:07:07,250 - DEBUG - Online update step: 20/50
2025-06-02 16:07:07,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:07,365 - DEBUG - Node anomaly scores shape: torch.Size([21216, 1])
2025-06-02 16:07:07,370 - DEBUG - Edge anomaly scores shape: torch.Size([44952, 1])
2025-06-02 16:07:07,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:07,610 - DEBUG - Step 20: Loss=0.5724
2025-06-02 16:07:07,611 - DEBUG - Online update step: 21/50
2025-06-02 16:07:07,614 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:07,723 - DEBUG - Node anomaly scores shape: torch.Size([19939, 1])
2025-06-02 16:07:07,728 - DEBUG - Edge anomaly scores shape: torch.Size([41942, 1])
2025-06-02 16:07:07,729 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:07,983 - DEBUG - Step 21: Loss=0.5707
2025-06-02 16:07:07,984 - DEBUG - Online update step: 22/50
2025-06-02 16:07:07,990 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:08,118 - DEBUG - Node anomaly scores shape: torch.Size([23287, 1])
2025-06-02 16:07:08,125 - DEBUG - Edge anomaly scores shape: torch.Size([49493, 1])
2025-06-02 16:07:08,127 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:08,390 - DEBUG - Step 22: Loss=0.5717
2025-06-02 16:07:08,390 - DEBUG - Online update step: 23/50
2025-06-02 16:07:08,393 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:08,512 - DEBUG - Node anomaly scores shape: torch.Size([19812, 1])
2025-06-02 16:07:08,517 - DEBUG - Edge anomaly scores shape: torch.Size([41655, 1])
2025-06-02 16:07:08,519 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:08,748 - DEBUG - Step 23: Loss=0.5683
2025-06-02 16:07:08,748 - DEBUG - Online update step: 24/50
2025-06-02 16:07:08,752 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:08,860 - DEBUG - Node anomaly scores shape: torch.Size([21980, 1])
2025-06-02 16:07:08,864 - DEBUG - Edge anomaly scores shape: torch.Size([46430, 1])
2025-06-02 16:07:08,866 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:09,094 - DEBUG - Step 24: Loss=0.5724
2025-06-02 16:07:09,095 - DEBUG - Online update step: 25/50
2025-06-02 16:07:09,098 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:09,213 - DEBUG - Node anomaly scores shape: torch.Size([20818, 1])
2025-06-02 16:07:09,221 - DEBUG - Edge anomaly scores shape: torch.Size([44099, 1])
2025-06-02 16:07:09,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:09,462 - DEBUG - Step 25: Loss=0.5699
2025-06-02 16:07:09,462 - DEBUG - Online update step: 26/50
2025-06-02 16:07:09,465 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:09,571 - DEBUG - Node anomaly scores shape: torch.Size([19623, 1])
2025-06-02 16:07:09,576 - DEBUG - Edge anomaly scores shape: torch.Size([41216, 1])
2025-06-02 16:07:09,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:09,802 - DEBUG - Step 26: Loss=0.5722
2025-06-02 16:07:09,802 - DEBUG - Online update step: 27/50
2025-06-02 16:07:09,805 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:09,947 - DEBUG - Node anomaly scores shape: torch.Size([22067, 1])
2025-06-02 16:07:09,952 - DEBUG - Edge anomaly scores shape: torch.Size([46864, 1])
2025-06-02 16:07:09,954 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:10,223 - DEBUG - Step 27: Loss=0.5689
2025-06-02 16:07:10,223 - DEBUG - Online update step: 28/50
2025-06-02 16:07:10,226 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:10,337 - DEBUG - Node anomaly scores shape: torch.Size([19661, 1])
2025-06-02 16:07:10,341 - DEBUG - Edge anomaly scores shape: torch.Size([41445, 1])
2025-06-02 16:07:10,342 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:10,600 - DEBUG - Step 28: Loss=0.5718
2025-06-02 16:07:10,601 - DEBUG - Online update step: 29/50
2025-06-02 16:07:10,604 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:10,732 - DEBUG - Node anomaly scores shape: torch.Size([19261, 1])
2025-06-02 16:07:10,736 - DEBUG - Edge anomaly scores shape: torch.Size([40532, 1])
2025-06-02 16:07:10,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:10,978 - DEBUG - Step 29: Loss=0.5698
2025-06-02 16:07:10,978 - DEBUG - Online update step: 30/50
2025-06-02 16:07:10,981 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:11,084 - DEBUG - Node anomaly scores shape: torch.Size([20398, 1])
2025-06-02 16:07:11,089 - DEBUG - Edge anomaly scores shape: torch.Size([43005, 1])
2025-06-02 16:07:11,090 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:11,314 - DEBUG - Step 30: Loss=0.5720
2025-06-02 16:07:11,314 - DEBUG - Online update step: 31/50
2025-06-02 16:07:11,317 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:11,424 - DEBUG - Node anomaly scores shape: torch.Size([20240, 1])
2025-06-02 16:07:11,429 - DEBUG - Edge anomaly scores shape: torch.Size([42605, 1])
2025-06-02 16:07:11,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:11,643 - DEBUG - Step 31: Loss=0.5686
2025-06-02 16:07:11,643 - DEBUG - Online update step: 32/50
2025-06-02 16:07:11,647 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:11,770 - DEBUG - Node anomaly scores shape: torch.Size([20495, 1])
2025-06-02 16:07:11,775 - DEBUG - Edge anomaly scores shape: torch.Size([43359, 1])
2025-06-02 16:07:11,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:11,992 - DEBUG - Step 32: Loss=0.5722
2025-06-02 16:07:11,992 - DEBUG - Online update step: 33/50
2025-06-02 16:07:11,995 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:12,125 - DEBUG - Node anomaly scores shape: torch.Size([21172, 1])
2025-06-02 16:07:12,131 - DEBUG - Edge anomaly scores shape: torch.Size([44866, 1])
2025-06-02 16:07:12,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:12,387 - DEBUG - Step 33: Loss=0.5701
2025-06-02 16:07:12,387 - DEBUG - Online update step: 34/50
2025-06-02 16:07:12,390 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:12,527 - DEBUG - Node anomaly scores shape: torch.Size([21463, 1])
2025-06-02 16:07:12,534 - DEBUG - Edge anomaly scores shape: torch.Size([45404, 1])
2025-06-02 16:07:12,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:12,782 - DEBUG - Step 34: Loss=0.5720
2025-06-02 16:07:12,783 - DEBUG - Online update step: 35/50
2025-06-02 16:07:12,786 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:12,888 - DEBUG - Node anomaly scores shape: torch.Size([21213, 1])
2025-06-02 16:07:12,893 - DEBUG - Edge anomaly scores shape: torch.Size([45069, 1])
2025-06-02 16:07:12,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:13,125 - DEBUG - Step 35: Loss=0.5690
2025-06-02 16:07:13,125 - DEBUG - Online update step: 36/50
2025-06-02 16:07:13,131 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:13,234 - DEBUG - Node anomaly scores shape: torch.Size([19668, 1])
2025-06-02 16:07:13,240 - DEBUG - Edge anomaly scores shape: torch.Size([41444, 1])
2025-06-02 16:07:13,242 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:13,450 - DEBUG - Step 36: Loss=0.5717
2025-06-02 16:07:13,450 - DEBUG - Online update step: 37/50
2025-06-02 16:07:13,454 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:13,574 - DEBUG - Node anomaly scores shape: torch.Size([20328, 1])
2025-06-02 16:07:13,579 - DEBUG - Edge anomaly scores shape: torch.Size([42961, 1])
2025-06-02 16:07:13,580 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:13,813 - DEBUG - Step 37: Loss=0.5695
2025-06-02 16:07:13,813 - DEBUG - Online update step: 38/50
2025-06-02 16:07:13,817 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:13,930 - DEBUG - Node anomaly scores shape: torch.Size([20613, 1])
2025-06-02 16:07:13,935 - DEBUG - Edge anomaly scores shape: torch.Size([43396, 1])
2025-06-02 16:07:13,936 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:14,175 - DEBUG - Step 38: Loss=0.5718
2025-06-02 16:07:14,176 - DEBUG - Online update step: 39/50
2025-06-02 16:07:14,182 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:14,305 - DEBUG - Node anomaly scores shape: torch.Size([21440, 1])
2025-06-02 16:07:14,311 - DEBUG - Edge anomaly scores shape: torch.Size([45289, 1])
2025-06-02 16:07:14,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:14,576 - DEBUG - Step 39: Loss=0.5693
2025-06-02 16:07:14,576 - DEBUG - Online update step: 40/50
2025-06-02 16:07:14,581 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:14,710 - DEBUG - Node anomaly scores shape: torch.Size([20998, 1])
2025-06-02 16:07:14,716 - DEBUG - Edge anomaly scores shape: torch.Size([44409, 1])
2025-06-02 16:07:14,717 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:14,948 - DEBUG - Step 40: Loss=0.5718
2025-06-02 16:07:14,948 - DEBUG - Online update step: 41/50
2025-06-02 16:07:14,952 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:15,067 - DEBUG - Node anomaly scores shape: torch.Size([19048, 1])
2025-06-02 16:07:15,071 - DEBUG - Edge anomaly scores shape: torch.Size([40060, 1])
2025-06-02 16:07:15,073 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:15,317 - DEBUG - Step 41: Loss=0.5701
2025-06-02 16:07:15,317 - DEBUG - Online update step: 42/50
2025-06-02 16:07:15,320 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:15,419 - DEBUG - Node anomaly scores shape: torch.Size([19809, 1])
2025-06-02 16:07:15,424 - DEBUG - Edge anomaly scores shape: torch.Size([41887, 1])
2025-06-02 16:07:15,425 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:15,673 - DEBUG - Step 42: Loss=0.5720
2025-06-02 16:07:15,673 - DEBUG - Online update step: 43/50
2025-06-02 16:07:15,679 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:15,807 - DEBUG - Node anomaly scores shape: torch.Size([23280, 1])
2025-06-02 16:07:15,813 - DEBUG - Edge anomaly scores shape: torch.Size([49405, 1])
2025-06-02 16:07:15,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:16,066 - DEBUG - Step 43: Loss=0.5677
2025-06-02 16:07:16,066 - DEBUG - Online update step: 44/50
2025-06-02 16:07:16,069 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:16,180 - DEBUG - Node anomaly scores shape: torch.Size([19888, 1])
2025-06-02 16:07:16,185 - DEBUG - Edge anomaly scores shape: torch.Size([41992, 1])
2025-06-02 16:07:16,187 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:16,433 - DEBUG - Step 44: Loss=0.5718
2025-06-02 16:07:16,433 - DEBUG - Online update step: 45/50
2025-06-02 16:07:16,436 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:16,534 - DEBUG - Node anomaly scores shape: torch.Size([19354, 1])
2025-06-02 16:07:16,538 - DEBUG - Edge anomaly scores shape: torch.Size([40746, 1])
2025-06-02 16:07:16,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:16,767 - DEBUG - Step 45: Loss=0.5703
2025-06-02 16:07:16,767 - DEBUG - Online update step: 46/50
2025-06-02 16:07:16,771 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:16,897 - DEBUG - Node anomaly scores shape: torch.Size([20965, 1])
2025-06-02 16:07:16,902 - DEBUG - Edge anomaly scores shape: torch.Size([44322, 1])
2025-06-02 16:07:16,904 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:17,188 - DEBUG - Step 46: Loss=0.5710
2025-06-02 16:07:17,189 - DEBUG - Online update step: 47/50
2025-06-02 16:07:17,194 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:17,292 - DEBUG - Node anomaly scores shape: torch.Size([19443, 1])
2025-06-02 16:07:17,297 - DEBUG - Edge anomaly scores shape: torch.Size([40809, 1])
2025-06-02 16:07:17,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:17,532 - DEBUG - Step 47: Loss=0.5686
2025-06-02 16:07:17,532 - DEBUG - Online update step: 48/50
2025-06-02 16:07:17,536 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:17,689 - DEBUG - Node anomaly scores shape: torch.Size([21459, 1])
2025-06-02 16:07:17,695 - DEBUG - Edge anomaly scores shape: torch.Size([45474, 1])
2025-06-02 16:07:17,697 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:17,967 - DEBUG - Step 48: Loss=0.5715
2025-06-02 16:07:17,967 - DEBUG - Online update step: 49/50
2025-06-02 16:07:17,970 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:18,069 - DEBUG - Node anomaly scores shape: torch.Size([18930, 1])
2025-06-02 16:07:18,073 - DEBUG - Edge anomaly scores shape: torch.Size([39728, 1])
2025-06-02 16:07:18,074 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:18,305 - DEBUG - Step 49: Loss=0.5696
2025-06-02 16:07:18,306 - DEBUG - Online update step: 50/50
2025-06-02 16:07:18,309 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:18,445 - DEBUG - Node anomaly scores shape: torch.Size([20273, 1])
2025-06-02 16:07:18,450 - DEBUG - Edge anomaly scores shape: torch.Size([42691, 1])
2025-06-02 16:07:18,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:18,681 - DEBUG - Step 50: Loss=0.5720
2025-06-02 16:07:18,682 - INFO - Online update finished. Average loss: 0.5707, Learning rate: 0.001000
2025-06-02 16:07:18,683 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:07:18,683 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:07:18,684 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:07:18,684 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-02 16:07:18,685 - INFO - Online update complete. Loss: 0.5707
2025-06-02 16:07:18,685 - INFO - Running anomaly detection...
2025-06-02 16:07:18,685 - INFO - Starting anomaly detection.
2025-06-02 16:07:18,690 - DEBUG - Node reconstruction errors: [0.00881875 0.14484128 0.06120342 ... 0.00311505 0.00492763 0.00892456]
2025-06-02 16:07:18,690 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783861 1.2587271  0.1578386 ]
2025-06-02 16:07:18,692 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160718_update_54.json
2025-06-02 16:07:18,693 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:07:18,701 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160718_update_54.pth and as latest_checkpoint.pth
2025-06-02 16:07:18,701 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870715.dot): 0.1265
2025-06-02 16:07:18,701 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:07:18,701 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1448, MLP Score: 0.5025
2025-06-02 16:07:18,701 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1982, MLP Score: 0.4994
2025-06-02 16:07:18,701 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.2936, MLP Score: 0.4880
2025-06-02 16:07:18,701 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1031, MLP Score: 0.4831
2025-06-02 16:07:18,702 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0881, MLP Score: 0.4809
2025-06-02 16:07:18,702 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:07:18,702 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.4817
2025-06-02 16:07:18,702 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4468
2025-06-02 16:07:18,702 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.4807
2025-06-02 16:07:18,702 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4689
2025-06-02 16:07:18,702 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.4762
2025-06-02 16:07:18,702 - INFO - 
--- Processing file: nw_graph_encoded_1748870745.dot (Timestamp: 2025-06-02 15:25:45) ---
2025-06-02 16:07:18,702 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-02 16:07:18,702 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-02 16:07:18,734 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 16:07:18,762 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 16:07:18,762 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 16:07:18,762 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870745.dot
2025-06-02 16:07:18,783 - INFO - Parsed 1003 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 16:07:18,804 - INFO - Parsed 2202 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870745.dot'.
2025-06-02 16:07:18,805 - INFO - Processing node updates/additions.
2025-06-02 16:07:18,809 - INFO - Processing edge updates/additions.
2025-06-02 16:07:18,820 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:07:18,820 - INFO - Finished updating NetworkX graph.
2025-06-02 16:07:18,820 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:07:18,821 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:07:18,829 - DEBUG - Initial node features tensor shape: torch.Size([1003, 30])
2025-06-02 16:07:18,831 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:07:18,831 - DEBUG - Node features tensor shape after scaling: torch.Size([1003, 30])
2025-06-02 16:07:18,833 - DEBUG - Edge index tensor shape: torch.Size([2, 2202])
2025-06-02 16:07:18,835 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:07:18,842 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:07:18,844 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:07:18,846 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:07:18,849 - DEBUG - Shape of encoded categorical edge features: torch.Size([2202, 3])
2025-06-02 16:07:18,850 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:07:18,850 - DEBUG - Shape of scaled numerical edge features: torch.Size([2202, 7])
2025-06-02 16:07:18,850 - DEBUG - Final edge attributes tensor shape: torch.Size([2202, 10])
2025-06-02 16:07:18,850 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:07:18,853 - INFO - Performing online update...
2025-06-02 16:07:18,853 - INFO - Starting online update for 50 steps.
2025-06-02 16:07:18,853 - DEBUG - Updated RunningStats: new_mean=0.945376995573663, new_var=31800000000161.406, new_n=3210
2025-06-02 16:07:18,854 - DEBUG - Updated RunningStats: new_mean=0.9434670124397407, new_var=32100000000018.31, new_n=3240
2025-06-02 16:07:18,854 - DEBUG - Updated RunningStats: new_mean=1.1813118292817772, new_var=10600000000093.7, new_n=1070
2025-06-02 16:07:18,854 - DEBUG - Updated RunningStats: new_mean=1.1803241921707759, new_var=10700000000001.604, new_n=1080
2025-06-02 16:07:18,854 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:07:18,854 - DEBUG - Online update step: 1/50
2025-06-02 16:07:18,856 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:18,989 - DEBUG - Node anomaly scores shape: torch.Size([18698, 1])
2025-06-02 16:07:19,009 - DEBUG - Edge anomaly scores shape: torch.Size([39275, 1])
2025-06-02 16:07:19,010 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:19,212 - DEBUG - Step 1: Loss=0.5694
2025-06-02 16:07:19,213 - DEBUG - Online update step: 2/50
2025-06-02 16:07:19,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:19,362 - DEBUG - Node anomaly scores shape: torch.Size([20542, 1])
2025-06-02 16:07:19,366 - DEBUG - Edge anomaly scores shape: torch.Size([43356, 1])
2025-06-02 16:07:19,367 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:19,630 - DEBUG - Step 2: Loss=0.5713
2025-06-02 16:07:19,630 - DEBUG - Online update step: 3/50
2025-06-02 16:07:19,633 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:19,759 - DEBUG - Node anomaly scores shape: torch.Size([20255, 1])
2025-06-02 16:07:19,764 - DEBUG - Edge anomaly scores shape: torch.Size([42965, 1])
2025-06-02 16:07:19,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:19,982 - DEBUG - Step 3: Loss=0.5698
2025-06-02 16:07:19,982 - DEBUG - Online update step: 4/50
2025-06-02 16:07:19,985 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:20,095 - DEBUG - Node anomaly scores shape: torch.Size([19140, 1])
2025-06-02 16:07:20,099 - DEBUG - Edge anomaly scores shape: torch.Size([40322, 1])
2025-06-02 16:07:20,100 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:20,314 - DEBUG - Step 4: Loss=0.5718
2025-06-02 16:07:20,314 - DEBUG - Online update step: 5/50
2025-06-02 16:07:20,318 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:20,428 - DEBUG - Node anomaly scores shape: torch.Size([20403, 1])
2025-06-02 16:07:20,433 - DEBUG - Edge anomaly scores shape: torch.Size([43100, 1])
2025-06-02 16:07:20,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:20,650 - DEBUG - Step 5: Loss=0.5678
2025-06-02 16:07:20,650 - DEBUG - Online update step: 6/50
2025-06-02 16:07:20,654 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:20,785 - DEBUG - Node anomaly scores shape: torch.Size([22705, 1])
2025-06-02 16:07:20,791 - DEBUG - Edge anomaly scores shape: torch.Size([48474, 1])
2025-06-02 16:07:20,792 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:21,065 - DEBUG - Step 6: Loss=0.5715
2025-06-02 16:07:21,065 - DEBUG - Online update step: 7/50
2025-06-02 16:07:21,068 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:21,175 - DEBUG - Node anomaly scores shape: torch.Size([19844, 1])
2025-06-02 16:07:21,180 - DEBUG - Edge anomaly scores shape: torch.Size([41865, 1])
2025-06-02 16:07:21,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:21,410 - DEBUG - Step 7: Loss=0.5698
2025-06-02 16:07:21,410 - DEBUG - Online update step: 8/50
2025-06-02 16:07:21,414 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:21,530 - DEBUG - Node anomaly scores shape: torch.Size([20124, 1])
2025-06-02 16:07:21,534 - DEBUG - Edge anomaly scores shape: torch.Size([42522, 1])
2025-06-02 16:07:21,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:21,786 - DEBUG - Step 8: Loss=0.5725
2025-06-02 16:07:21,786 - DEBUG - Online update step: 9/50
2025-06-02 16:07:21,789 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:21,893 - DEBUG - Node anomaly scores shape: torch.Size([20310, 1])
2025-06-02 16:07:21,898 - DEBUG - Edge anomaly scores shape: torch.Size([43099, 1])
2025-06-02 16:07:21,899 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:22,138 - DEBUG - Step 9: Loss=0.5692
2025-06-02 16:07:22,139 - DEBUG - Online update step: 10/50
2025-06-02 16:07:22,142 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:22,248 - DEBUG - Node anomaly scores shape: torch.Size([19565, 1])
2025-06-02 16:07:22,253 - DEBUG - Edge anomaly scores shape: torch.Size([41275, 1])
2025-06-02 16:07:22,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:22,493 - DEBUG - Step 10: Loss=0.5713
2025-06-02 16:07:22,493 - DEBUG - Online update step: 11/50
2025-06-02 16:07:22,497 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:22,632 - DEBUG - Node anomaly scores shape: torch.Size([21787, 1])
2025-06-02 16:07:22,638 - DEBUG - Edge anomaly scores shape: torch.Size([46465, 1])
2025-06-02 16:07:22,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:22,901 - DEBUG - Step 11: Loss=0.5692
2025-06-02 16:07:22,901 - DEBUG - Online update step: 12/50
2025-06-02 16:07:22,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:23,016 - DEBUG - Node anomaly scores shape: torch.Size([20844, 1])
2025-06-02 16:07:23,022 - DEBUG - Edge anomaly scores shape: torch.Size([44059, 1])
2025-06-02 16:07:23,024 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:23,264 - DEBUG - Step 12: Loss=0.5716
2025-06-02 16:07:23,264 - DEBUG - Online update step: 13/50
2025-06-02 16:07:23,268 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:23,382 - DEBUG - Node anomaly scores shape: torch.Size([21635, 1])
2025-06-02 16:07:23,388 - DEBUG - Edge anomaly scores shape: torch.Size([45771, 1])
2025-06-02 16:07:23,390 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:23,643 - DEBUG - Step 13: Loss=0.5685
2025-06-02 16:07:23,644 - DEBUG - Online update step: 14/50
2025-06-02 16:07:23,647 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:23,757 - DEBUG - Node anomaly scores shape: torch.Size([19011, 1])
2025-06-02 16:07:23,764 - DEBUG - Edge anomaly scores shape: torch.Size([40007, 1])
2025-06-02 16:07:23,765 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:24,022 - DEBUG - Step 14: Loss=0.5726
2025-06-02 16:07:24,022 - DEBUG - Online update step: 15/50
2025-06-02 16:07:24,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:24,148 - DEBUG - Node anomaly scores shape: torch.Size([22142, 1])
2025-06-02 16:07:24,153 - DEBUG - Edge anomaly scores shape: torch.Size([46986, 1])
2025-06-02 16:07:24,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:24,409 - DEBUG - Step 15: Loss=0.5704
2025-06-02 16:07:24,409 - DEBUG - Online update step: 16/50
2025-06-02 16:07:24,412 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:24,533 - DEBUG - Node anomaly scores shape: torch.Size([20655, 1])
2025-06-02 16:07:24,538 - DEBUG - Edge anomaly scores shape: torch.Size([43522, 1])
2025-06-02 16:07:24,539 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:24,804 - DEBUG - Step 16: Loss=0.5707
2025-06-02 16:07:24,804 - DEBUG - Online update step: 17/50
2025-06-02 16:07:24,807 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:24,911 - DEBUG - Node anomaly scores shape: torch.Size([19938, 1])
2025-06-02 16:07:24,916 - DEBUG - Edge anomaly scores shape: torch.Size([41994, 1])
2025-06-02 16:07:24,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:25,144 - DEBUG - Step 17: Loss=0.5680
2025-06-02 16:07:25,144 - DEBUG - Online update step: 18/50
2025-06-02 16:07:25,147 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:25,274 - DEBUG - Node anomaly scores shape: torch.Size([22125, 1])
2025-06-02 16:07:25,281 - DEBUG - Edge anomaly scores shape: torch.Size([46885, 1])
2025-06-02 16:07:25,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:25,530 - DEBUG - Step 18: Loss=0.5711
2025-06-02 16:07:25,530 - DEBUG - Online update step: 19/50
2025-06-02 16:07:25,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:25,648 - DEBUG - Node anomaly scores shape: torch.Size([20519, 1])
2025-06-02 16:07:25,653 - DEBUG - Edge anomaly scores shape: torch.Size([43416, 1])
2025-06-02 16:07:25,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:25,905 - DEBUG - Step 19: Loss=0.5686
2025-06-02 16:07:25,905 - DEBUG - Online update step: 20/50
2025-06-02 16:07:25,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:26,017 - DEBUG - Node anomaly scores shape: torch.Size([20025, 1])
2025-06-02 16:07:26,021 - DEBUG - Edge anomaly scores shape: torch.Size([42118, 1])
2025-06-02 16:07:26,022 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:26,284 - DEBUG - Step 20: Loss=0.5723
2025-06-02 16:07:26,284 - DEBUG - Online update step: 21/50
2025-06-02 16:07:26,289 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:26,416 - DEBUG - Node anomaly scores shape: torch.Size([23344, 1])
2025-06-02 16:07:26,422 - DEBUG - Edge anomaly scores shape: torch.Size([49534, 1])
2025-06-02 16:07:26,423 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:26,685 - DEBUG - Step 21: Loss=0.5687
2025-06-02 16:07:26,685 - DEBUG - Online update step: 22/50
2025-06-02 16:07:26,688 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:26,808 - DEBUG - Node anomaly scores shape: torch.Size([21520, 1])
2025-06-02 16:07:26,812 - DEBUG - Edge anomaly scores shape: torch.Size([45481, 1])
2025-06-02 16:07:26,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:27,051 - DEBUG - Step 22: Loss=0.5712
2025-06-02 16:07:27,052 - DEBUG - Online update step: 23/50
2025-06-02 16:07:27,059 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:27,182 - DEBUG - Node anomaly scores shape: torch.Size([20836, 1])
2025-06-02 16:07:27,190 - DEBUG - Edge anomaly scores shape: torch.Size([43868, 1])
2025-06-02 16:07:27,191 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:27,444 - DEBUG - Step 23: Loss=0.5698
2025-06-02 16:07:27,445 - DEBUG - Online update step: 24/50
2025-06-02 16:07:27,448 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:27,578 - DEBUG - Node anomaly scores shape: torch.Size([20940, 1])
2025-06-02 16:07:27,583 - DEBUG - Edge anomaly scores shape: torch.Size([44404, 1])
2025-06-02 16:07:27,584 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:27,860 - DEBUG - Step 24: Loss=0.5709
2025-06-02 16:07:27,861 - DEBUG - Online update step: 25/50
2025-06-02 16:07:27,867 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:27,993 - DEBUG - Node anomaly scores shape: torch.Size([22835, 1])
2025-06-02 16:07:27,998 - DEBUG - Edge anomaly scores shape: torch.Size([48395, 1])
2025-06-02 16:07:28,000 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:28,260 - DEBUG - Step 25: Loss=0.5672
2025-06-02 16:07:28,260 - DEBUG - Online update step: 26/50
2025-06-02 16:07:28,264 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:28,378 - DEBUG - Node anomaly scores shape: torch.Size([21946, 1])
2025-06-02 16:07:28,385 - DEBUG - Edge anomaly scores shape: torch.Size([46638, 1])
2025-06-02 16:07:28,386 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:28,669 - DEBUG - Step 26: Loss=0.5715
2025-06-02 16:07:28,669 - DEBUG - Online update step: 27/50
2025-06-02 16:07:28,672 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:28,814 - DEBUG - Node anomaly scores shape: torch.Size([23552, 1])
2025-06-02 16:07:28,820 - DEBUG - Edge anomaly scores shape: torch.Size([50112, 1])
2025-06-02 16:07:28,821 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:29,104 - DEBUG - Step 27: Loss=0.5694
2025-06-02 16:07:29,105 - DEBUG - Online update step: 28/50
2025-06-02 16:07:29,108 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:29,246 - DEBUG - Node anomaly scores shape: torch.Size([22178, 1])
2025-06-02 16:07:29,251 - DEBUG - Edge anomaly scores shape: torch.Size([46884, 1])
2025-06-02 16:07:29,253 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:29,525 - DEBUG - Step 28: Loss=0.5717
2025-06-02 16:07:29,525 - DEBUG - Online update step: 29/50
2025-06-02 16:07:29,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:29,671 - DEBUG - Node anomaly scores shape: torch.Size([22499, 1])
2025-06-02 16:07:29,677 - DEBUG - Edge anomaly scores shape: torch.Size([47662, 1])
2025-06-02 16:07:29,679 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:29,951 - DEBUG - Step 29: Loss=0.5691
2025-06-02 16:07:29,951 - DEBUG - Online update step: 30/50
2025-06-02 16:07:29,954 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:30,071 - DEBUG - Node anomaly scores shape: torch.Size([20623, 1])
2025-06-02 16:07:30,076 - DEBUG - Edge anomaly scores shape: torch.Size([43736, 1])
2025-06-02 16:07:30,078 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:30,315 - DEBUG - Step 30: Loss=0.5713
2025-06-02 16:07:30,316 - DEBUG - Online update step: 31/50
2025-06-02 16:07:30,319 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:30,420 - DEBUG - Node anomaly scores shape: torch.Size([19501, 1])
2025-06-02 16:07:30,425 - DEBUG - Edge anomaly scores shape: torch.Size([41290, 1])
2025-06-02 16:07:30,426 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:30,653 - DEBUG - Step 31: Loss=0.5688
2025-06-02 16:07:30,654 - DEBUG - Online update step: 32/50
2025-06-02 16:07:30,657 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:30,815 - DEBUG - Node anomaly scores shape: torch.Size([24583, 1])
2025-06-02 16:07:30,824 - DEBUG - Edge anomaly scores shape: torch.Size([52458, 1])
2025-06-02 16:07:30,826 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:31,129 - DEBUG - Step 32: Loss=0.5710
2025-06-02 16:07:31,130 - DEBUG - Online update step: 33/50
2025-06-02 16:07:31,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:31,239 - DEBUG - Node anomaly scores shape: torch.Size([19903, 1])
2025-06-02 16:07:31,244 - DEBUG - Edge anomaly scores shape: torch.Size([41976, 1])
2025-06-02 16:07:31,245 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:31,477 - DEBUG - Step 33: Loss=0.5681
2025-06-02 16:07:31,478 - DEBUG - Online update step: 34/50
2025-06-02 16:07:31,481 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:31,600 - DEBUG - Node anomaly scores shape: torch.Size([21857, 1])
2025-06-02 16:07:31,606 - DEBUG - Edge anomaly scores shape: torch.Size([46634, 1])
2025-06-02 16:07:31,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:31,881 - DEBUG - Step 34: Loss=0.5717
2025-06-02 16:07:31,881 - DEBUG - Online update step: 35/50
2025-06-02 16:07:31,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:31,997 - DEBUG - Node anomaly scores shape: torch.Size([19312, 1])
2025-06-02 16:07:32,001 - DEBUG - Edge anomaly scores shape: torch.Size([40703, 1])
2025-06-02 16:07:32,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:32,252 - DEBUG - Step 35: Loss=0.5704
2025-06-02 16:07:32,252 - DEBUG - Online update step: 36/50
2025-06-02 16:07:32,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:32,348 - DEBUG - Node anomaly scores shape: torch.Size([18717, 1])
2025-06-02 16:07:32,352 - DEBUG - Edge anomaly scores shape: torch.Size([39165, 1])
2025-06-02 16:07:32,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:32,570 - DEBUG - Step 36: Loss=0.5713
2025-06-02 16:07:32,570 - DEBUG - Online update step: 37/50
2025-06-02 16:07:32,574 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:32,712 - DEBUG - Node anomaly scores shape: torch.Size([22532, 1])
2025-06-02 16:07:32,718 - DEBUG - Edge anomaly scores shape: torch.Size([48158, 1])
2025-06-02 16:07:32,719 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:32,972 - DEBUG - Step 37: Loss=0.5677
2025-06-02 16:07:32,972 - DEBUG - Online update step: 38/50
2025-06-02 16:07:32,975 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:33,087 - DEBUG - Node anomaly scores shape: torch.Size([20442, 1])
2025-06-02 16:07:33,092 - DEBUG - Edge anomaly scores shape: torch.Size([43291, 1])
2025-06-02 16:07:33,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:33,346 - DEBUG - Step 38: Loss=0.5708
2025-06-02 16:07:33,346 - DEBUG - Online update step: 39/50
2025-06-02 16:07:33,350 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:33,444 - DEBUG - Node anomaly scores shape: torch.Size([18713, 1])
2025-06-02 16:07:33,449 - DEBUG - Edge anomaly scores shape: torch.Size([39350, 1])
2025-06-02 16:07:33,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:33,642 - DEBUG - Step 39: Loss=0.5691
2025-06-02 16:07:33,643 - DEBUG - Online update step: 40/50
2025-06-02 16:07:33,646 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:33,778 - DEBUG - Node anomaly scores shape: torch.Size([21970, 1])
2025-06-02 16:07:33,786 - DEBUG - Edge anomaly scores shape: torch.Size([46704, 1])
2025-06-02 16:07:33,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:34,058 - DEBUG - Step 40: Loss=0.5713
2025-06-02 16:07:34,058 - DEBUG - Online update step: 41/50
2025-06-02 16:07:34,062 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:34,167 - DEBUG - Node anomaly scores shape: torch.Size([21163, 1])
2025-06-02 16:07:34,172 - DEBUG - Edge anomaly scores shape: torch.Size([44926, 1])
2025-06-02 16:07:34,174 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:34,410 - DEBUG - Step 41: Loss=0.5685
2025-06-02 16:07:34,410 - DEBUG - Online update step: 42/50
2025-06-02 16:07:34,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:34,529 - DEBUG - Node anomaly scores shape: torch.Size([22344, 1])
2025-06-02 16:07:34,535 - DEBUG - Edge anomaly scores shape: torch.Size([47519, 1])
2025-06-02 16:07:34,536 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:34,791 - DEBUG - Step 42: Loss=0.5707
2025-06-02 16:07:34,792 - DEBUG - Online update step: 43/50
2025-06-02 16:07:34,795 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:34,893 - DEBUG - Node anomaly scores shape: torch.Size([19731, 1])
2025-06-02 16:07:34,897 - DEBUG - Edge anomaly scores shape: torch.Size([41644, 1])
2025-06-02 16:07:34,898 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:35,130 - DEBUG - Step 43: Loss=0.5697
2025-06-02 16:07:35,130 - DEBUG - Online update step: 44/50
2025-06-02 16:07:35,133 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:35,237 - DEBUG - Node anomaly scores shape: torch.Size([18838, 1])
2025-06-02 16:07:35,242 - DEBUG - Edge anomaly scores shape: torch.Size([39313, 1])
2025-06-02 16:07:35,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:35,498 - DEBUG - Step 44: Loss=0.5716
2025-06-02 16:07:35,498 - DEBUG - Online update step: 45/50
2025-06-02 16:07:35,501 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:35,614 - DEBUG - Node anomaly scores shape: torch.Size([23038, 1])
2025-06-02 16:07:35,619 - DEBUG - Edge anomaly scores shape: torch.Size([48965, 1])
2025-06-02 16:07:35,620 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:35,864 - DEBUG - Step 45: Loss=0.5675
2025-06-02 16:07:35,865 - DEBUG - Online update step: 46/50
2025-06-02 16:07:35,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:35,979 - DEBUG - Node anomaly scores shape: torch.Size([19916, 1])
2025-06-02 16:07:35,984 - DEBUG - Edge anomaly scores shape: torch.Size([41937, 1])
2025-06-02 16:07:35,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:36,194 - DEBUG - Step 46: Loss=0.5705
2025-06-02 16:07:36,194 - DEBUG - Online update step: 47/50
2025-06-02 16:07:36,198 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:36,310 - DEBUG - Node anomaly scores shape: torch.Size([20634, 1])
2025-06-02 16:07:36,316 - DEBUG - Edge anomaly scores shape: torch.Size([43687, 1])
2025-06-02 16:07:36,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:36,527 - DEBUG - Step 47: Loss=0.5691
2025-06-02 16:07:36,527 - DEBUG - Online update step: 48/50
2025-06-02 16:07:36,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:36,658 - DEBUG - Node anomaly scores shape: torch.Size([21582, 1])
2025-06-02 16:07:36,663 - DEBUG - Edge anomaly scores shape: torch.Size([45864, 1])
2025-06-02 16:07:36,664 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:36,916 - DEBUG - Step 48: Loss=0.5713
2025-06-02 16:07:36,916 - DEBUG - Online update step: 49/50
2025-06-02 16:07:36,919 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:37,046 - DEBUG - Node anomaly scores shape: torch.Size([23927, 1])
2025-06-02 16:07:37,051 - DEBUG - Edge anomaly scores shape: torch.Size([51017, 1])
2025-06-02 16:07:37,052 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:37,312 - DEBUG - Step 49: Loss=0.5679
2025-06-02 16:07:37,312 - DEBUG - Online update step: 50/50
2025-06-02 16:07:37,319 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:37,426 - DEBUG - Node anomaly scores shape: torch.Size([20386, 1])
2025-06-02 16:07:37,431 - DEBUG - Edge anomaly scores shape: torch.Size([43084, 1])
2025-06-02 16:07:37,432 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:37,653 - DEBUG - Step 50: Loss=0.5713
2025-06-02 16:07:37,653 - INFO - Online update finished. Average loss: 0.5701, Learning rate: 0.001000
2025-06-02 16:07:37,654 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], current edge mean: [ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:07:37,654 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:07:37,656 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  2.28197248e-08 -1.90164373e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  1.33115057e-08
  3.09017101e-09 -3.68443476e-09 -1.33115057e-08 -1.42623273e-08
  2.26719832e+00  2.96211362e+00  1.49551347e-01  4.39282131e+00
  3.68443476e-09  3.43569303e+00  5.77567291e+00  7.61316061e+00
  1.49551347e-01  7.99302101e+00 -1.37869165e-08 -7.96313326e-09
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -4.51640370e-09  3.28033529e-08], edge=[ 9.1466846e+00  1.4255222e+00  5.6984558e+00 -2.1654729e-09
  1.5158311e-09 -2.5985676e-09 -5.1971352e-09 -8.6618923e-10
  2.1654729e-09  1.7323785e-09]
2025-06-02 16:07:37,656 - DEBUG - Updated reference std: node=[0.         0.         1.0004989  1.0004989  0.         0.
 0.         1.0004989  1.0004989  1.0004989  1.0004989  1.0004989
 0.942663   0.2727847  0.3705303  0.57321125 1.0004989  3.0242865
 2.9081972  1.4837464  0.3705303  0.22102815 1.0004989  1.0004989
 0.         0.         0.         0.         1.0004989  1.0004989 ], edge=[1.1021479 0.5063368 2.1363957 1.0002271 1.0002271 1.0002271 1.0002271
 1.0002271 1.0002271 1.0002272]
2025-06-02 16:07:37,656 - INFO - Online update complete. Loss: 0.5701
2025-06-02 16:07:37,656 - INFO - Running anomaly detection...
2025-06-02 16:07:37,656 - INFO - Starting anomaly detection.
2025-06-02 16:07:37,661 - DEBUG - Node reconstruction errors: [0.01033739 0.12723042 0.05549457 ... 0.00242916 0.00350778 0.00964139]
2025-06-02 16:07:37,662 - DEBUG - Edge reconstruction errors: [1.3641138  1.3616133  0.95785415 ... 0.15783858 1.2587271  0.15783858]
2025-06-02 16:07:37,664 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160737_update_55.json
2025-06-02 16:07:37,664 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:07:37,673 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160737_update_55.pth and as latest_checkpoint.pth
2025-06-02 16:07:37,673 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870745.dot): 0.1301
2025-06-02 16:07:37,673 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:07:37,673 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1272, MLP Score: 0.5134
2025-06-02 16:07:37,673 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2237, MLP Score: 0.5082
2025-06-02 16:07:37,673 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.2315, MLP Score: 0.4975
2025-06-02 16:07:37,673 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.1009, MLP Score: 0.4928
2025-06-02 16:07:37,673 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0904, MLP Score: 0.4936
2025-06-02 16:07:37,673 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:07:37,674 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3247, MLP Score: 0.5090
2025-06-02 16:07:37,674 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8380, MLP Score: 0.4821
2025-06-02 16:07:37,674 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4455, MLP Score: 0.5040
2025-06-02 16:07:37,674 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1917, MLP Score: 0.4941
2025-06-02 16:07:37,674 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7230, MLP Score: 0.5023
2025-06-02 16:07:37,674 - INFO - 
--- Processing file: nw_graph_encoded_1748870775.dot (Timestamp: 2025-06-02 15:26:15) ---
2025-06-02 16:07:37,674 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-02 16:07:37,674 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-02 16:07:37,710 - INFO - Parsed 1005 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 16:07:37,737 - INFO - Parsed 2207 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 16:07:37,737 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 16:07:37,737 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870775.dot
2025-06-02 16:07:37,758 - INFO - Parsed 1005 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 16:07:37,779 - INFO - Parsed 2207 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870775.dot'.
2025-06-02 16:07:37,779 - INFO - Processing node updates/additions.
2025-06-02 16:07:37,784 - INFO - Processing edge updates/additions.
2025-06-02 16:07:37,794 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:07:37,795 - INFO - Finished updating NetworkX graph.
2025-06-02 16:07:37,795 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:07:37,796 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:07:37,804 - DEBUG - Initial node features tensor shape: torch.Size([1005, 30])
2025-06-02 16:07:37,806 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:07:37,806 - DEBUG - Node features tensor shape after scaling: torch.Size([1005, 30])
2025-06-02 16:07:37,807 - DEBUG - Edge index tensor shape: torch.Size([2, 2207])
2025-06-02 16:07:37,808 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:07:37,813 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:07:37,814 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:07:37,815 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:07:37,816 - DEBUG - Shape of encoded categorical edge features: torch.Size([2207, 3])
2025-06-02 16:07:37,817 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:07:37,817 - DEBUG - Shape of scaled numerical edge features: torch.Size([2207, 7])
2025-06-02 16:07:37,817 - DEBUG - Final edge attributes tensor shape: torch.Size([2207, 10])
2025-06-02 16:07:37,818 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:07:37,820 - INFO - Performing online update...
2025-06-02 16:07:37,820 - INFO - Starting online update for 50 steps.
2025-06-02 16:07:37,820 - DEBUG - Updated RunningStats: new_mean=0.9454343832184556, new_var=32400000000161.445, new_n=3270
2025-06-02 16:07:37,820 - DEBUG - Updated RunningStats: new_mean=0.9435575135547243, new_var=32700000000018.293, new_n=3300
2025-06-02 16:07:37,821 - DEBUG - Updated RunningStats: new_mean=1.1844242597892138, new_var=10800000000093.691, new_n=1090
2025-06-02 16:07:37,821 - DEBUG - Updated RunningStats: new_mean=1.1834236252261776, new_var=10900000000001.605, new_n=1100
2025-06-02 16:07:37,821 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:07:37,821 - DEBUG - Online update step: 1/50
2025-06-02 16:07:37,823 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:37,993 - DEBUG - Node anomaly scores shape: torch.Size([21547, 1])
2025-06-02 16:07:38,000 - DEBUG - Edge anomaly scores shape: torch.Size([45607, 1])
2025-06-02 16:07:38,002 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:38,204 - DEBUG - Step 1: Loss=0.5696
2025-06-02 16:07:38,204 - DEBUG - Online update step: 2/50
2025-06-02 16:07:38,208 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:38,351 - DEBUG - Node anomaly scores shape: torch.Size([21962, 1])
2025-06-02 16:07:38,359 - DEBUG - Edge anomaly scores shape: torch.Size([46739, 1])
2025-06-02 16:07:38,360 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:38,644 - DEBUG - Step 2: Loss=0.5713
2025-06-02 16:07:38,644 - DEBUG - Online update step: 3/50
2025-06-02 16:07:38,647 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:38,763 - DEBUG - Node anomaly scores shape: torch.Size([20488, 1])
2025-06-02 16:07:38,768 - DEBUG - Edge anomaly scores shape: torch.Size([43489, 1])
2025-06-02 16:07:38,769 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:38,997 - DEBUG - Step 3: Loss=0.5681
2025-06-02 16:07:38,997 - DEBUG - Online update step: 4/50
2025-06-02 16:07:39,001 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:39,129 - DEBUG - Node anomaly scores shape: torch.Size([22152, 1])
2025-06-02 16:07:39,135 - DEBUG - Edge anomaly scores shape: torch.Size([47133, 1])
2025-06-02 16:07:39,136 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:39,378 - DEBUG - Step 4: Loss=0.5706
2025-06-02 16:07:39,378 - DEBUG - Online update step: 5/50
2025-06-02 16:07:39,381 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:39,485 - DEBUG - Node anomaly scores shape: torch.Size([21189, 1])
2025-06-02 16:07:39,490 - DEBUG - Edge anomaly scores shape: torch.Size([44915, 1])
2025-06-02 16:07:39,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:39,712 - DEBUG - Step 5: Loss=0.5689
2025-06-02 16:07:39,713 - DEBUG - Online update step: 6/50
2025-06-02 16:07:39,716 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:39,826 - DEBUG - Node anomaly scores shape: torch.Size([20218, 1])
2025-06-02 16:07:39,832 - DEBUG - Edge anomaly scores shape: torch.Size([42554, 1])
2025-06-02 16:07:39,833 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:40,108 - DEBUG - Step 6: Loss=0.5718
2025-06-02 16:07:40,108 - DEBUG - Online update step: 7/50
2025-06-02 16:07:40,114 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:40,225 - DEBUG - Node anomaly scores shape: torch.Size([21816, 1])
2025-06-02 16:07:40,230 - DEBUG - Edge anomaly scores shape: torch.Size([46374, 1])
2025-06-02 16:07:40,232 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:40,492 - DEBUG - Step 7: Loss=0.5684
2025-06-02 16:07:40,492 - DEBUG - Online update step: 8/50
2025-06-02 16:07:40,495 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:40,605 - DEBUG - Node anomaly scores shape: torch.Size([20836, 1])
2025-06-02 16:07:40,609 - DEBUG - Edge anomaly scores shape: torch.Size([44153, 1])
2025-06-02 16:07:40,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:40,865 - DEBUG - Step 8: Loss=0.5710
2025-06-02 16:07:40,865 - DEBUG - Online update step: 9/50
2025-06-02 16:07:40,869 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:40,993 - DEBUG - Node anomaly scores shape: torch.Size([21781, 1])
2025-06-02 16:07:40,997 - DEBUG - Edge anomaly scores shape: torch.Size([46296, 1])
2025-06-02 16:07:40,998 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:41,237 - DEBUG - Step 9: Loss=0.5690
2025-06-02 16:07:41,237 - DEBUG - Online update step: 10/50
2025-06-02 16:07:41,241 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:41,354 - DEBUG - Node anomaly scores shape: torch.Size([21424, 1])
2025-06-02 16:07:41,359 - DEBUG - Edge anomaly scores shape: torch.Size([45498, 1])
2025-06-02 16:07:41,360 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:41,588 - DEBUG - Step 10: Loss=0.5709
2025-06-02 16:07:41,589 - DEBUG - Online update step: 11/50
2025-06-02 16:07:41,592 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:41,736 - DEBUG - Node anomaly scores shape: torch.Size([23983, 1])
2025-06-02 16:07:41,741 - DEBUG - Edge anomaly scores shape: torch.Size([51025, 1])
2025-06-02 16:07:41,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:42,051 - DEBUG - Step 11: Loss=0.5672
2025-06-02 16:07:42,051 - DEBUG - Online update step: 12/50
2025-06-02 16:07:42,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:42,176 - DEBUG - Node anomaly scores shape: torch.Size([22205, 1])
2025-06-02 16:07:42,181 - DEBUG - Edge anomaly scores shape: torch.Size([47013, 1])
2025-06-02 16:07:42,182 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:42,458 - DEBUG - Step 12: Loss=0.5710
2025-06-02 16:07:42,458 - DEBUG - Online update step: 13/50
2025-06-02 16:07:42,464 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:42,596 - DEBUG - Node anomaly scores shape: torch.Size([22428, 1])
2025-06-02 16:07:42,601 - DEBUG - Edge anomaly scores shape: torch.Size([47407, 1])
2025-06-02 16:07:42,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:42,867 - DEBUG - Step 13: Loss=0.5692
2025-06-02 16:07:42,868 - DEBUG - Online update step: 14/50
2025-06-02 16:07:42,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:42,975 - DEBUG - Node anomaly scores shape: torch.Size([19638, 1])
2025-06-02 16:07:42,980 - DEBUG - Edge anomaly scores shape: torch.Size([41463, 1])
2025-06-02 16:07:42,981 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:43,217 - DEBUG - Step 14: Loss=0.5716
2025-06-02 16:07:43,217 - DEBUG - Online update step: 15/50
2025-06-02 16:07:43,220 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:43,337 - DEBUG - Node anomaly scores shape: torch.Size([19545, 1])
2025-06-02 16:07:43,343 - DEBUG - Edge anomaly scores shape: torch.Size([41249, 1])
2025-06-02 16:07:43,345 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:43,598 - DEBUG - Step 15: Loss=0.5680
2025-06-02 16:07:43,598 - DEBUG - Online update step: 16/50
2025-06-02 16:07:43,601 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:43,721 - DEBUG - Node anomaly scores shape: torch.Size([19685, 1])
2025-06-02 16:07:43,725 - DEBUG - Edge anomaly scores shape: torch.Size([41302, 1])
2025-06-02 16:07:43,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:43,959 - DEBUG - Step 16: Loss=0.5704
2025-06-02 16:07:43,959 - DEBUG - Online update step: 17/50
2025-06-02 16:07:43,962 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:44,092 - DEBUG - Node anomaly scores shape: torch.Size([20751, 1])
2025-06-02 16:07:44,097 - DEBUG - Edge anomaly scores shape: torch.Size([43907, 1])
2025-06-02 16:07:44,098 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:44,333 - DEBUG - Step 17: Loss=0.5686
2025-06-02 16:07:44,333 - DEBUG - Online update step: 18/50
2025-06-02 16:07:44,337 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:44,469 - DEBUG - Node anomaly scores shape: torch.Size([21339, 1])
2025-06-02 16:07:44,474 - DEBUG - Edge anomaly scores shape: torch.Size([45149, 1])
2025-06-02 16:07:44,476 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:44,752 - DEBUG - Step 18: Loss=0.5708
2025-06-02 16:07:44,752 - DEBUG - Online update step: 19/50
2025-06-02 16:07:44,757 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:44,906 - DEBUG - Node anomaly scores shape: torch.Size([21518, 1])
2025-06-02 16:07:44,914 - DEBUG - Edge anomaly scores shape: torch.Size([45653, 1])
2025-06-02 16:07:44,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:45,392 - DEBUG - Step 19: Loss=0.5679
2025-06-02 16:07:45,393 - DEBUG - Online update step: 20/50
2025-06-02 16:07:45,402 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:45,589 - DEBUG - Node anomaly scores shape: torch.Size([20420, 1])
2025-06-02 16:07:45,603 - DEBUG - Edge anomaly scores shape: torch.Size([43119, 1])
2025-06-02 16:07:45,605 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:45,958 - DEBUG - Step 20: Loss=0.5708
2025-06-02 16:07:45,959 - DEBUG - Online update step: 21/50
2025-06-02 16:07:45,964 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:46,076 - DEBUG - Node anomaly scores shape: torch.Size([19076, 1])
2025-06-02 16:07:46,080 - DEBUG - Edge anomaly scores shape: torch.Size([40113, 1])
2025-06-02 16:07:46,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:46,333 - DEBUG - Step 21: Loss=0.5696
2025-06-02 16:07:46,334 - DEBUG - Online update step: 22/50
2025-06-02 16:07:46,339 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:46,465 - DEBUG - Node anomaly scores shape: torch.Size([19851, 1])
2025-06-02 16:07:46,470 - DEBUG - Edge anomaly scores shape: torch.Size([41930, 1])
2025-06-02 16:07:46,472 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:46,737 - DEBUG - Step 22: Loss=0.5717
2025-06-02 16:07:46,738 - DEBUG - Online update step: 23/50
2025-06-02 16:07:46,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:46,896 - DEBUG - Node anomaly scores shape: torch.Size([21352, 1])
2025-06-02 16:07:46,901 - DEBUG - Edge anomaly scores shape: torch.Size([45307, 1])
2025-06-02 16:07:46,903 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:47,173 - DEBUG - Step 23: Loss=0.5673
2025-06-02 16:07:47,174 - DEBUG - Online update step: 24/50
2025-06-02 16:07:47,179 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:47,306 - DEBUG - Node anomaly scores shape: torch.Size([20830, 1])
2025-06-02 16:07:47,314 - DEBUG - Edge anomaly scores shape: torch.Size([43952, 1])
2025-06-02 16:07:47,316 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:47,574 - DEBUG - Step 24: Loss=0.5708
2025-06-02 16:07:47,574 - DEBUG - Online update step: 25/50
2025-06-02 16:07:47,578 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:47,732 - DEBUG - Node anomaly scores shape: torch.Size([23383, 1])
2025-06-02 16:07:47,744 - DEBUG - Edge anomaly scores shape: torch.Size([49873, 1])
2025-06-02 16:07:47,745 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:48,021 - DEBUG - Step 25: Loss=0.5690
2025-06-02 16:07:48,021 - DEBUG - Online update step: 26/50
2025-06-02 16:07:48,025 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:48,149 - DEBUG - Node anomaly scores shape: torch.Size([20690, 1])
2025-06-02 16:07:48,155 - DEBUG - Edge anomaly scores shape: torch.Size([43590, 1])
2025-06-02 16:07:48,156 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:48,413 - DEBUG - Step 26: Loss=0.5712
2025-06-02 16:07:48,414 - DEBUG - Online update step: 27/50
2025-06-02 16:07:48,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:48,538 - DEBUG - Node anomaly scores shape: torch.Size([20767, 1])
2025-06-02 16:07:48,544 - DEBUG - Edge anomaly scores shape: torch.Size([43984, 1])
2025-06-02 16:07:48,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:48,798 - DEBUG - Step 27: Loss=0.5680
2025-06-02 16:07:48,798 - DEBUG - Online update step: 28/50
2025-06-02 16:07:48,801 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:48,913 - DEBUG - Node anomaly scores shape: torch.Size([20792, 1])
2025-06-02 16:07:48,918 - DEBUG - Edge anomaly scores shape: torch.Size([43948, 1])
2025-06-02 16:07:48,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:49,146 - DEBUG - Step 28: Loss=0.5702
2025-06-02 16:07:49,147 - DEBUG - Online update step: 29/50
2025-06-02 16:07:49,150 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:49,284 - DEBUG - Node anomaly scores shape: torch.Size([20359, 1])
2025-06-02 16:07:49,290 - DEBUG - Edge anomaly scores shape: torch.Size([42859, 1])
2025-06-02 16:07:49,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:49,527 - DEBUG - Step 29: Loss=0.5685
2025-06-02 16:07:49,527 - DEBUG - Online update step: 30/50
2025-06-02 16:07:49,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:49,640 - DEBUG - Node anomaly scores shape: torch.Size([19079, 1])
2025-06-02 16:07:49,645 - DEBUG - Edge anomaly scores shape: torch.Size([40140, 1])
2025-06-02 16:07:49,646 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:49,868 - DEBUG - Step 30: Loss=0.5712
2025-06-02 16:07:49,868 - DEBUG - Online update step: 31/50
2025-06-02 16:07:49,872 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:49,990 - DEBUG - Node anomaly scores shape: torch.Size([20867, 1])
2025-06-02 16:07:49,995 - DEBUG - Edge anomaly scores shape: torch.Size([44267, 1])
2025-06-02 16:07:49,996 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:50,251 - DEBUG - Step 31: Loss=0.5679
2025-06-02 16:07:50,252 - DEBUG - Online update step: 32/50
2025-06-02 16:07:50,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:50,382 - DEBUG - Node anomaly scores shape: torch.Size([21510, 1])
2025-06-02 16:07:50,388 - DEBUG - Edge anomaly scores shape: torch.Size([45663, 1])
2025-06-02 16:07:50,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:50,643 - DEBUG - Step 32: Loss=0.5711
2025-06-02 16:07:50,643 - DEBUG - Online update step: 33/50
2025-06-02 16:07:50,646 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:50,808 - DEBUG - Node anomaly scores shape: torch.Size([22664, 1])
2025-06-02 16:07:50,815 - DEBUG - Edge anomaly scores shape: torch.Size([48175, 1])
2025-06-02 16:07:50,817 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:51,193 - DEBUG - Step 33: Loss=0.5696
2025-06-02 16:07:51,194 - DEBUG - Online update step: 34/50
2025-06-02 16:07:51,197 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:51,326 - DEBUG - Node anomaly scores shape: torch.Size([23400, 1])
2025-06-02 16:07:51,335 - DEBUG - Edge anomaly scores shape: torch.Size([49650, 1])
2025-06-02 16:07:51,336 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:51,618 - DEBUG - Step 34: Loss=0.5709
2025-06-02 16:07:51,618 - DEBUG - Online update step: 35/50
2025-06-02 16:07:51,621 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:51,785 - DEBUG - Node anomaly scores shape: torch.Size([19893, 1])
2025-06-02 16:07:51,790 - DEBUG - Edge anomaly scores shape: torch.Size([42032, 1])
2025-06-02 16:07:51,791 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:52,094 - DEBUG - Step 35: Loss=0.5671
2025-06-02 16:07:52,094 - DEBUG - Online update step: 36/50
2025-06-02 16:07:52,097 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:52,227 - DEBUG - Node anomaly scores shape: torch.Size([19877, 1])
2025-06-02 16:07:52,234 - DEBUG - Edge anomaly scores shape: torch.Size([41767, 1])
2025-06-02 16:07:52,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:52,479 - DEBUG - Step 36: Loss=0.5708
2025-06-02 16:07:52,479 - DEBUG - Online update step: 37/50
2025-06-02 16:07:52,482 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:52,628 - DEBUG - Node anomaly scores shape: torch.Size([21154, 1])
2025-06-02 16:07:52,632 - DEBUG - Edge anomaly scores shape: torch.Size([44870, 1])
2025-06-02 16:07:52,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:52,894 - DEBUG - Step 37: Loss=0.5686
2025-06-02 16:07:52,895 - DEBUG - Online update step: 38/50
2025-06-02 16:07:52,898 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:53,010 - DEBUG - Node anomaly scores shape: torch.Size([20635, 1])
2025-06-02 16:07:53,017 - DEBUG - Edge anomaly scores shape: torch.Size([43772, 1])
2025-06-02 16:07:53,018 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:53,284 - DEBUG - Step 38: Loss=0.5710
2025-06-02 16:07:53,284 - DEBUG - Online update step: 39/50
2025-06-02 16:07:53,287 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:53,439 - DEBUG - Node anomaly scores shape: torch.Size([22759, 1])
2025-06-02 16:07:53,448 - DEBUG - Edge anomaly scores shape: torch.Size([48286, 1])
2025-06-02 16:07:53,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:53,751 - DEBUG - Step 39: Loss=0.5681
2025-06-02 16:07:53,751 - DEBUG - Online update step: 40/50
2025-06-02 16:07:53,754 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:53,859 - DEBUG - Node anomaly scores shape: torch.Size([20432, 1])
2025-06-02 16:07:53,863 - DEBUG - Edge anomaly scores shape: torch.Size([43194, 1])
2025-06-02 16:07:53,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:54,191 - DEBUG - Step 40: Loss=0.5706
2025-06-02 16:07:54,192 - DEBUG - Online update step: 41/50
2025-06-02 16:07:54,196 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:54,386 - DEBUG - Node anomaly scores shape: torch.Size([22774, 1])
2025-06-02 16:07:54,396 - DEBUG - Edge anomaly scores shape: torch.Size([48379, 1])
2025-06-02 16:07:54,400 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:55,678 - DEBUG - Step 41: Loss=0.5686
2025-06-02 16:07:55,678 - DEBUG - Online update step: 42/50
2025-06-02 16:07:55,684 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:55,830 - DEBUG - Node anomaly scores shape: torch.Size([20083, 1])
2025-06-02 16:07:55,835 - DEBUG - Edge anomaly scores shape: torch.Size([42338, 1])
2025-06-02 16:07:55,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:56,076 - DEBUG - Step 42: Loss=0.5706
2025-06-02 16:07:56,076 - DEBUG - Online update step: 43/50
2025-06-02 16:07:56,082 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:56,213 - DEBUG - Node anomaly scores shape: torch.Size([21045, 1])
2025-06-02 16:07:56,219 - DEBUG - Edge anomaly scores shape: torch.Size([44540, 1])
2025-06-02 16:07:56,221 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:56,505 - DEBUG - Step 43: Loss=0.5672
2025-06-02 16:07:56,505 - DEBUG - Online update step: 44/50
2025-06-02 16:07:56,508 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:56,692 - DEBUG - Node anomaly scores shape: torch.Size([21906, 1])
2025-06-02 16:07:56,697 - DEBUG - Edge anomaly scores shape: torch.Size([46442, 1])
2025-06-02 16:07:56,698 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:57,072 - DEBUG - Step 44: Loss=0.5704
2025-06-02 16:07:57,072 - DEBUG - Online update step: 45/50
2025-06-02 16:07:57,077 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:57,230 - DEBUG - Node anomaly scores shape: torch.Size([23278, 1])
2025-06-02 16:07:57,238 - DEBUG - Edge anomaly scores shape: torch.Size([49589, 1])
2025-06-02 16:07:57,240 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:57,538 - DEBUG - Step 45: Loss=0.5685
2025-06-02 16:07:57,538 - DEBUG - Online update step: 46/50
2025-06-02 16:07:57,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:57,666 - DEBUG - Node anomaly scores shape: torch.Size([20813, 1])
2025-06-02 16:07:57,671 - DEBUG - Edge anomaly scores shape: torch.Size([44109, 1])
2025-06-02 16:07:57,672 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:57,901 - DEBUG - Step 46: Loss=0.5711
2025-06-02 16:07:57,901 - DEBUG - Online update step: 47/50
2025-06-02 16:07:57,908 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:58,037 - DEBUG - Node anomaly scores shape: torch.Size([21147, 1])
2025-06-02 16:07:58,042 - DEBUG - Edge anomaly scores shape: torch.Size([44572, 1])
2025-06-02 16:07:58,044 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:58,296 - DEBUG - Step 47: Loss=0.5673
2025-06-02 16:07:58,296 - DEBUG - Online update step: 48/50
2025-06-02 16:07:58,300 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:58,440 - DEBUG - Node anomaly scores shape: torch.Size([20514, 1])
2025-06-02 16:07:58,445 - DEBUG - Edge anomaly scores shape: torch.Size([43286, 1])
2025-06-02 16:07:58,447 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:58,698 - DEBUG - Step 48: Loss=0.5705
2025-06-02 16:07:58,698 - DEBUG - Online update step: 49/50
2025-06-02 16:07:58,701 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:58,844 - DEBUG - Node anomaly scores shape: torch.Size([22171, 1])
2025-06-02 16:07:58,850 - DEBUG - Edge anomaly scores shape: torch.Size([47083, 1])
2025-06-02 16:07:58,852 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:59,113 - DEBUG - Step 49: Loss=0.5683
2025-06-02 16:07:59,114 - DEBUG - Online update step: 50/50
2025-06-02 16:07:59,117 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:07:59,215 - DEBUG - Node anomaly scores shape: torch.Size([19098, 1])
2025-06-02 16:07:59,221 - DEBUG - Edge anomaly scores shape: torch.Size([40126, 1])
2025-06-02 16:07:59,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:07:59,449 - DEBUG - Step 50: Loss=0.5706
2025-06-02 16:07:59,450 - INFO - Online update finished. Average loss: 0.5696, Learning rate: 0.001000
2025-06-02 16:07:59,451 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8266896e-08
 -8.5403666e-09  4.1397058e-08 -9.0148315e-09 -3.7957189e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  2.1350917e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-08  2.1469534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.0257037e-08 -1.9927523e-08], current edge mean: [ 9.1463528e+00  1.4245583e+00  5.7014046e+00  8.6422686e-10
  3.4569074e-09  4.3211343e-10  4.3211341e-09  1.4043686e-09
 -6.4817014e-09  4.3211343e-10]
2025-06-02 16:07:59,451 - DEBUG - Node drift difference: 0.0048, Edge drift difference: 0.0019
2025-06-02 16:07:59,452 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -1.4471177e-08 -1.1149924e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -1.8266896e-08
 -8.5403666e-09  4.1397058e-08 -9.0148315e-09 -3.7957189e-09
  2.2626865e+00  2.9621890e+00  1.4925373e-01  4.3940296e+00
  2.1350917e-09  3.4328358e+00  5.7800994e+00  7.6139302e+00
  1.4925373e-01  7.9930348e+00 -1.4233945e-08  2.1469534e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  6.0257037e-08 -1.9927523e-08], edge=[ 9.1463528e+00  1.4245583e+00  5.7014046e+00  8.6422686e-10
  3.4569074e-09  4.3211343e-10  4.3211341e-09  1.4043686e-09
 -6.4817014e-09  4.3211343e-10]
2025-06-02 16:07:59,453 - DEBUG - Updated reference std: node=[0.         0.         1.0004979  1.0004979  0.         0.
 0.         1.0004978  1.0004979  1.0004978  1.0004978  1.0004978
 0.94502825 0.2725181  0.37022114 0.5732797  1.0004979  3.021951
 2.9069915  1.4823681  0.37022114 0.2208081  1.0004979  1.0004979
 0.         0.         0.         0.         1.0004979  1.0004978 ], edge=[1.1009203 0.5061673 2.1348705 1.0002267 1.0002266 1.0002266 1.0002266
 1.0002266 1.0002266 1.0002266]
2025-06-02 16:07:59,453 - INFO - Online update complete. Loss: 0.5696
2025-06-02 16:07:59,453 - INFO - Running anomaly detection...
2025-06-02 16:07:59,453 - INFO - Starting anomaly detection.
2025-06-02 16:07:59,462 - DEBUG - Node reconstruction errors: [0.01035756 0.12238182 0.06961995 ... 0.00834563 0.00213733 0.00178274]
2025-06-02 16:07:59,462 - DEBUG - Edge reconstruction errors: [1.3639435  1.3614402  0.95767754 ... 0.15766199 1.258551   0.15766197]
2025-06-02 16:07:59,464 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160759_update_56.json
2025-06-02 16:07:59,465 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:07:59,473 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160759_update_56.pth and as latest_checkpoint.pth
2025-06-02 16:07:59,473 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870775.dot): 0.1291
2025-06-02 16:07:59,474 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-02 16:07:59,474 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1224, MLP Score: 0.5043
2025-06-02 16:07:59,474 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2730, MLP Score: 0.4966
2025-06-02 16:07:59,474 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.2134, MLP Score: 0.4856
2025-06-02 16:07:59,474 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0939, MLP Score: 0.4818
2025-06-02 16:07:59,474 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0844, MLP Score: 0.4762
2025-06-02 16:07:59,474 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:07:59,474 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3414, MLP Score: 0.4910
2025-06-02 16:07:59,474 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8545, MLP Score: 0.4630
2025-06-02 16:07:59,474 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4453, MLP Score: 0.4840
2025-06-02 16:07:59,474 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.1961, MLP Score: 0.4734
2025-06-02 16:07:59,474 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7259, MLP Score: 0.4760
2025-06-02 16:07:59,479 - DEBUG - Embedding standard deviations before t-SNE: [1.587329   0.98321825 0.8049709  0.77337104 1.0425142  0.
 2.3852315  0.03129707 1.5432515  1.4412127  1.4590294  0.11009995
 0.06811349 1.4366723  0.         0.         1.1428369  0.23515779
 0.         0.01443932 0.1257745  1.3013685  0.51880884 0.60727465
 0.27362996 0.7692299  0.66937435 0.9275716  0.87399536 1.5956888
 1.3964095  0.510659  ]
2025-06-02 16:08:00,380 - INFO - Embeddings visualization saved to vis/embeddings_56_updates_20250602_160759.png
2025-06-02 16:08:00,380 - INFO - Performing visualization of node and edge features.
2025-06-02 16:08:00,381 - INFO - Starting visualization of node features.
2025-06-02 16:08:00,381 - INFO - Graph has 1005 nodes and 30 features.
2025-06-02 16:08:00,381 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-02 16:08:00,381 - INFO - Calculating feature statistics:
2025-06-02 16:08:00,382 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,382 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,382 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 26, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.7107942), 'max': np.float32(3.1591537)}
2025-06-02 16:08:00,382 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 26, 'mean': np.float32(-3.036575e-08), 'std': np.float32(1.0), 'min': np.float32(-2.9619691), 'max': np.float32(1.8120885)}
2025-06-02 16:08:00,382 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,382 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,382 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,382 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-7.591438e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.45599636), 'max': np.float32(2.1929998)}
2025-06-02 16:08:00,382 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-1.1470258), 'max': np.float32(0.87182)}
2025-06-02 16:08:00,382 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 4, 'mean': np.float32(3.7957186e-08), 'std': np.float32(0.99999994), 'min': np.float32(-9.445913), 'max': np.float32(0.10811979)}
2025-06-02 16:08:00,383 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 28, 'mean': np.float32(1.5182875e-08), 'std': np.float32(1.0), 'min': np.float32(-2.225497), 'max': np.float32(2.067204)}
2025-06-02 16:08:00,383 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 28, 'mean': np.float32(-3.036575e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.9784383), 'max': np.float32(2.3454158)}
2025-06-02 16:08:00,383 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 8, 'mean': np.float32(2.2626865), 'std': np.float32(0.94455796), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-02 16:08:00,383 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.962189), 'std': np.float32(0.27238247), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-02 16:08:00,383 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.14925373), 'std': np.float32(0.3700369), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:08:00,383 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.3940296), 'std': np.float32(0.57299435), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-02 16:08:00,383 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 4, 'mean': np.float32(-3.795719e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.108119786), 'max': np.float32(9.445913)}
2025-06-02 16:08:00,383 - INFO - - service_1: {'name': 'service_1', 'unique': 6, 'mean': np.float32(3.4328358), 'std': np.float32(3.0204473), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-02 16:08:00,383 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(5.7800994), 'std': np.float32(2.905545), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:08:00,383 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.61393), 'std': np.float32(1.4816304), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:08:00,383 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.14925373), 'std': np.float32(0.3700369), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:08:00,383 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 2, 'mean': np.float32(7.993035), 'std': np.float32(0.22069824), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-02 16:08:00,384 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 4, 'mean': np.float32(-7.591438e-09), 'std': np.float32(0.9999999), 'min': np.float32(-0.12731494), 'max': np.float32(16.562014)}
2025-06-02 16:08:00,384 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(2.6570032e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.13881561), 'max': np.float32(7.2038)}
2025-06-02 16:08:00,384 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,384 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,384 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,384 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-02 16:08:00,384 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 6, 'mean': np.float32(4.5548624e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9881183), 'max': np.float32(10.426352)}
2025-06-02 16:08:00,384 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(-4.5548624e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0910678), 'max': np.float32(4.446928)}
2025-06-02 16:08:00,397 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a099a9cce0>
2025-06-02 16:08:00,814 - DEBUG - Plotted correlation matrix of node features.
2025-06-02 16:08:00,867 - DEBUG - Plotted ranges of node feature values.
2025-06-02 16:08:00,894 - DEBUG - Plotted sparsity of node features.
2025-06-02 16:08:02,195 - INFO - Node feature visualization saved to vis/node_features_20250602_160800.png
2025-06-02 16:08:02,195 - INFO - Finished visualization of node features.
2025-06-02 16:08:02,195 - INFO - Performing additional feature analysis:
2025-06-02 16:08:02,195 - INFO - - Maximum correlation between different features: nan
2025-06-02 16:08:02,196 - INFO - Starting visualization of edge features.
2025-06-02 16:08:02,197 - INFO - Graph has 2207 edges and 10 edge features.
2025-06-02 16:08:02,197 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:08:02,197 - INFO - Calculating edge feature statistics:
2025-06-02 16:08:02,197 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-02 16:08:02,197 - INFO - - count: {'name': 'count', 'unique': 19, 'mean': np.float32(9.146353), 'std': np.float32(1.1006708), 'min': np.float32(0.0), 'max': np.float32(18.0)}
2025-06-02 16:08:02,197 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.4245583), 'std': np.float32(0.5060526), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-02 16:08:02,197 - INFO - - protocol: {'name': 'protocol', 'unique': 8, 'mean': np.float32(5.7014046), 'std': np.float32(2.134387), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-02 16:08:02,197 - INFO - - service: {'name': 'service', 'unique': 39, 'mean': np.float32(1.7284537e-09), 'std': np.float32(1.0), 'min': np.float32(-0.03474584), 'max': np.float32(33.19388)}
2025-06-02 16:08:02,197 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 1487, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.059603628), 'max': np.float32(27.724396)}
2025-06-02 16:08:02,197 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 1553, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.055753566), 'max': np.float32(30.797874)}
2025-06-02 16:08:02,197 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 512, 'mean': np.float32(6.913815e-09), 'std': np.float32(1.0), 'min': np.float32(-0.043381877), 'max': np.float32(33.074608)}
2025-06-02 16:08:02,197 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 1531, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.0889072), 'max': np.float32(28.729874)}
2025-06-02 16:08:02,197 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 1561, 'mean': np.float32(-1.7284537e-09), 'std': np.float32(1.0), 'min': np.float32(-0.08862654), 'max': np.float32(27.611528)}
2025-06-02 16:08:02,197 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 568, 'mean': np.float32(-3.4569074e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.052383557), 'max': np.float32(32.50327)}
2025-06-02 16:08:02,209 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a098b9d130>
2025-06-02 16:08:02,292 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-02 16:08:02,303 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x70a0a0de2540>
2025-06-02 16:08:02,390 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-02 16:08:02,609 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-02 16:08:02,768 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-02 16:08:02,785 - DEBUG - Plotted sparsity of edge features.
2025-06-02 16:08:02,792 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-02 16:08:04,855 - INFO - Edge feature visualization saved to vis/edge_features_20250602_160802.png
2025-06-02 16:08:04,855 - INFO - Finished visualization of edge features.
2025-06-02 16:08:04,855 - INFO - Performing additional edge feature analysis:
2025-06-02 16:08:04,856 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-02 16:08:04,858 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-02 16:08:04,858 - INFO - Graph has 2207 edges and 10 edge features.
2025-06-02 16:08:04,858 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-02 16:08:05,292 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250602_160804_summary.png
2025-06-02 16:08:05,588 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250602_160804_pca_3d.png
2025-06-02 16:08:05,753 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250602_160804_pca_variance.png
2025-06-02 16:08:05,753 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-02 16:08:05,753 - INFO - 
--- Processing file: nw_graph_encoded_1748870805.dot (Timestamp: 2025-06-02 15:26:45) ---
2025-06-02 16:08:05,753 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-02 16:08:05,753 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-02 16:08:05,770 - INFO - Parsed 1009 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 16:08:05,789 - INFO - Parsed 2219 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 16:08:05,789 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 16:08:05,789 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870805.dot
2025-06-02 16:08:05,808 - INFO - Parsed 1009 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 16:08:05,831 - INFO - Parsed 2219 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870805.dot'.
2025-06-02 16:08:05,831 - INFO - Processing node updates/additions.
2025-06-02 16:08:05,838 - INFO - Processing edge updates/additions.
2025-06-02 16:08:05,852 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:08:05,853 - INFO - Finished updating NetworkX graph.
2025-06-02 16:08:05,853 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:08:05,855 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:08:05,867 - DEBUG - Initial node features tensor shape: torch.Size([1009, 30])
2025-06-02 16:08:05,876 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:08:05,883 - DEBUG - Node features tensor shape after scaling: torch.Size([1009, 30])
2025-06-02 16:08:05,886 - DEBUG - Edge index tensor shape: torch.Size([2, 2219])
2025-06-02 16:08:05,893 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:08:05,903 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:08:05,905 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:08:05,907 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:08:05,909 - DEBUG - Shape of encoded categorical edge features: torch.Size([2219, 3])
2025-06-02 16:08:05,910 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:08:05,910 - DEBUG - Shape of scaled numerical edge features: torch.Size([2219, 7])
2025-06-02 16:08:05,910 - DEBUG - Final edge attributes tensor shape: torch.Size([2219, 10])
2025-06-02 16:08:05,911 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:08:05,914 - INFO - Performing online update...
2025-06-02 16:08:05,914 - INFO - Starting online update for 50 steps.
2025-06-02 16:08:05,915 - DEBUG - Updated RunningStats: new_mean=0.945477921874116, new_var=33000000000161.348, new_n=3330
2025-06-02 16:08:05,915 - DEBUG - Updated RunningStats: new_mean=0.9436303340368478, new_var=33300000000018.31, new_n=3360
2025-06-02 16:08:05,915 - DEBUG - Updated RunningStats: new_mean=1.187419756477527, new_var=11000000000093.672, new_n=1110
2025-06-02 16:08:05,915 - DEBUG - Updated RunningStats: new_mean=1.1864152501295118, new_var=11100000000001.621, new_n=1120
2025-06-02 16:08:05,915 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:08:05,915 - DEBUG - Online update step: 1/50
2025-06-02 16:08:05,918 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:06,066 - DEBUG - Node anomaly scores shape: torch.Size([21241, 1])
2025-06-02 16:08:06,091 - DEBUG - Edge anomaly scores shape: torch.Size([44976, 1])
2025-06-02 16:08:06,093 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:06,519 - DEBUG - Step 1: Loss=0.5678
2025-06-02 16:08:06,519 - DEBUG - Online update step: 2/50
2025-06-02 16:08:06,522 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:06,998 - DEBUG - Node anomaly scores shape: torch.Size([22161, 1])
2025-06-02 16:08:07,004 - DEBUG - Edge anomaly scores shape: torch.Size([46970, 1])
2025-06-02 16:08:07,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:07,466 - DEBUG - Step 2: Loss=0.5703
2025-06-02 16:08:07,470 - DEBUG - Online update step: 3/50
2025-06-02 16:08:07,474 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:07,913 - DEBUG - Node anomaly scores shape: torch.Size([22941, 1])
2025-06-02 16:08:07,919 - DEBUG - Edge anomaly scores shape: torch.Size([48956, 1])
2025-06-02 16:08:07,920 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:08,183 - DEBUG - Step 3: Loss=0.5685
2025-06-02 16:08:08,183 - DEBUG - Online update step: 4/50
2025-06-02 16:08:08,187 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:08,345 - DEBUG - Node anomaly scores shape: torch.Size([20960, 1])
2025-06-02 16:08:08,350 - DEBUG - Edge anomaly scores shape: torch.Size([44238, 1])
2025-06-02 16:08:08,351 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:08,623 - DEBUG - Step 4: Loss=0.5710
2025-06-02 16:08:08,623 - DEBUG - Online update step: 5/50
2025-06-02 16:08:08,626 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:08,786 - DEBUG - Node anomaly scores shape: torch.Size([21095, 1])
2025-06-02 16:08:08,807 - DEBUG - Edge anomaly scores shape: torch.Size([44666, 1])
2025-06-02 16:08:08,808 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:09,173 - DEBUG - Step 5: Loss=0.5675
2025-06-02 16:08:09,173 - DEBUG - Online update step: 6/50
2025-06-02 16:08:09,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:09,271 - DEBUG - Node anomaly scores shape: torch.Size([21057, 1])
2025-06-02 16:08:09,275 - DEBUG - Edge anomaly scores shape: torch.Size([44627, 1])
2025-06-02 16:08:09,276 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:09,449 - DEBUG - Step 6: Loss=0.5703
2025-06-02 16:08:09,450 - DEBUG - Online update step: 7/50
2025-06-02 16:08:09,453 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:09,583 - DEBUG - Node anomaly scores shape: torch.Size([21158, 1])
2025-06-02 16:08:09,589 - DEBUG - Edge anomaly scores shape: torch.Size([44963, 1])
2025-06-02 16:08:09,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:09,817 - DEBUG - Step 7: Loss=0.5687
2025-06-02 16:08:09,817 - DEBUG - Online update step: 8/50
2025-06-02 16:08:09,820 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:09,938 - DEBUG - Node anomaly scores shape: torch.Size([20360, 1])
2025-06-02 16:08:09,943 - DEBUG - Edge anomaly scores shape: torch.Size([42992, 1])
2025-06-02 16:08:09,944 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:10,160 - DEBUG - Step 8: Loss=0.5705
2025-06-02 16:08:10,160 - DEBUG - Online update step: 9/50
2025-06-02 16:08:10,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:10,284 - DEBUG - Node anomaly scores shape: torch.Size([21611, 1])
2025-06-02 16:08:10,291 - DEBUG - Edge anomaly scores shape: torch.Size([45801, 1])
2025-06-02 16:08:10,292 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:10,521 - DEBUG - Step 9: Loss=0.5677
2025-06-02 16:08:10,521 - DEBUG - Online update step: 10/50
2025-06-02 16:08:10,524 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:10,632 - DEBUG - Node anomaly scores shape: torch.Size([21186, 1])
2025-06-02 16:08:10,638 - DEBUG - Edge anomaly scores shape: torch.Size([45102, 1])
2025-06-02 16:08:10,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:10,859 - DEBUG - Step 10: Loss=0.5703
2025-06-02 16:08:10,859 - DEBUG - Online update step: 11/50
2025-06-02 16:08:10,862 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:10,979 - DEBUG - Node anomaly scores shape: torch.Size([20331, 1])
2025-06-02 16:08:10,986 - DEBUG - Edge anomaly scores shape: torch.Size([42785, 1])
2025-06-02 16:08:10,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:11,253 - DEBUG - Step 11: Loss=0.5687
2025-06-02 16:08:11,253 - DEBUG - Online update step: 12/50
2025-06-02 16:08:11,261 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:11,485 - DEBUG - Node anomaly scores shape: torch.Size([21093, 1])
2025-06-02 16:08:11,511 - DEBUG - Edge anomaly scores shape: torch.Size([44751, 1])
2025-06-02 16:08:11,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:11,963 - DEBUG - Step 12: Loss=0.5711
2025-06-02 16:08:11,964 - DEBUG - Online update step: 13/50
2025-06-02 16:08:11,968 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:12,197 - DEBUG - Node anomaly scores shape: torch.Size([19868, 1])
2025-06-02 16:08:12,225 - DEBUG - Edge anomaly scores shape: torch.Size([41898, 1])
2025-06-02 16:08:12,228 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:12,630 - DEBUG - Step 13: Loss=0.5674
2025-06-02 16:08:12,631 - DEBUG - Online update step: 14/50
2025-06-02 16:08:12,637 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:12,753 - DEBUG - Node anomaly scores shape: torch.Size([21823, 1])
2025-06-02 16:08:12,762 - DEBUG - Edge anomaly scores shape: torch.Size([46519, 1])
2025-06-02 16:08:12,767 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:13,277 - DEBUG - Step 14: Loss=0.5700
2025-06-02 16:08:13,278 - DEBUG - Online update step: 15/50
2025-06-02 16:08:13,289 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:13,443 - DEBUG - Node anomaly scores shape: torch.Size([20416, 1])
2025-06-02 16:08:13,452 - DEBUG - Edge anomaly scores shape: torch.Size([43122, 1])
2025-06-02 16:08:13,454 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:13,771 - DEBUG - Step 15: Loss=0.5686
2025-06-02 16:08:13,772 - DEBUG - Online update step: 16/50
2025-06-02 16:08:13,775 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:13,966 - DEBUG - Node anomaly scores shape: torch.Size([20692, 1])
2025-06-02 16:08:13,978 - DEBUG - Edge anomaly scores shape: torch.Size([43753, 1])
2025-06-02 16:08:13,979 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:14,312 - DEBUG - Step 16: Loss=0.5706
2025-06-02 16:08:14,312 - DEBUG - Online update step: 17/50
2025-06-02 16:08:14,315 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:14,451 - DEBUG - Node anomaly scores shape: torch.Size([22724, 1])
2025-06-02 16:08:14,457 - DEBUG - Edge anomaly scores shape: torch.Size([48494, 1])
2025-06-02 16:08:14,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:14,775 - DEBUG - Step 17: Loss=0.5678
2025-06-02 16:08:14,775 - DEBUG - Online update step: 18/50
2025-06-02 16:08:14,778 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:14,921 - DEBUG - Node anomaly scores shape: torch.Size([21173, 1])
2025-06-02 16:08:14,926 - DEBUG - Edge anomaly scores shape: torch.Size([44854, 1])
2025-06-02 16:08:14,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:15,201 - DEBUG - Step 18: Loss=0.5700
2025-06-02 16:08:15,202 - DEBUG - Online update step: 19/50
2025-06-02 16:08:15,207 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:15,351 - DEBUG - Node anomaly scores shape: torch.Size([19838, 1])
2025-06-02 16:08:15,358 - DEBUG - Edge anomaly scores shape: torch.Size([42170, 1])
2025-06-02 16:08:15,359 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:15,626 - DEBUG - Step 19: Loss=0.5689
2025-06-02 16:08:15,626 - DEBUG - Online update step: 20/50
2025-06-02 16:08:15,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:15,776 - DEBUG - Node anomaly scores shape: torch.Size([21808, 1])
2025-06-02 16:08:15,783 - DEBUG - Edge anomaly scores shape: torch.Size([46466, 1])
2025-06-02 16:08:15,784 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:16,085 - DEBUG - Step 20: Loss=0.5707
2025-06-02 16:08:16,086 - DEBUG - Online update step: 21/50
2025-06-02 16:08:16,089 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:16,245 - DEBUG - Node anomaly scores shape: torch.Size([20831, 1])
2025-06-02 16:08:16,252 - DEBUG - Edge anomaly scores shape: torch.Size([44164, 1])
2025-06-02 16:08:16,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:16,530 - DEBUG - Step 21: Loss=0.5671
2025-06-02 16:08:16,530 - DEBUG - Online update step: 22/50
2025-06-02 16:08:16,533 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:16,624 - DEBUG - Node anomaly scores shape: torch.Size([18728, 1])
2025-06-02 16:08:16,630 - DEBUG - Edge anomaly scores shape: torch.Size([39470, 1])
2025-06-02 16:08:16,631 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:16,868 - DEBUG - Step 22: Loss=0.5704
2025-06-02 16:08:16,869 - DEBUG - Online update step: 23/50
2025-06-02 16:08:16,877 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:17,022 - DEBUG - Node anomaly scores shape: torch.Size([19775, 1])
2025-06-02 16:08:17,027 - DEBUG - Edge anomaly scores shape: torch.Size([41586, 1])
2025-06-02 16:08:17,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:17,303 - DEBUG - Step 23: Loss=0.5686
2025-06-02 16:08:17,303 - DEBUG - Online update step: 24/50
2025-06-02 16:08:17,306 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:17,438 - DEBUG - Node anomaly scores shape: torch.Size([19827, 1])
2025-06-02 16:08:17,445 - DEBUG - Edge anomaly scores shape: torch.Size([41714, 1])
2025-06-02 16:08:17,447 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:17,831 - DEBUG - Step 24: Loss=0.5714
2025-06-02 16:08:17,832 - DEBUG - Online update step: 25/50
2025-06-02 16:08:17,849 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:18,082 - DEBUG - Node anomaly scores shape: torch.Size([22124, 1])
2025-06-02 16:08:18,105 - DEBUG - Edge anomaly scores shape: torch.Size([47172, 1])
2025-06-02 16:08:18,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:18,505 - DEBUG - Step 25: Loss=0.5675
2025-06-02 16:08:18,505 - DEBUG - Online update step: 26/50
2025-06-02 16:08:18,509 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:18,667 - DEBUG - Node anomaly scores shape: torch.Size([19959, 1])
2025-06-02 16:08:18,674 - DEBUG - Edge anomaly scores shape: torch.Size([42258, 1])
2025-06-02 16:08:18,676 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:19,081 - DEBUG - Step 26: Loss=0.5703
2025-06-02 16:08:19,082 - DEBUG - Online update step: 27/50
2025-06-02 16:08:19,096 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:19,329 - DEBUG - Node anomaly scores shape: torch.Size([21432, 1])
2025-06-02 16:08:19,344 - DEBUG - Edge anomaly scores shape: torch.Size([45453, 1])
2025-06-02 16:08:19,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:19,851 - DEBUG - Step 27: Loss=0.5682
2025-06-02 16:08:19,852 - DEBUG - Online update step: 28/50
2025-06-02 16:08:19,855 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:20,071 - DEBUG - Node anomaly scores shape: torch.Size([20347, 1])
2025-06-02 16:08:20,103 - DEBUG - Edge anomaly scores shape: torch.Size([43038, 1])
2025-06-02 16:08:20,105 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:20,570 - DEBUG - Step 28: Loss=0.5704
2025-06-02 16:08:20,571 - DEBUG - Online update step: 29/50
2025-06-02 16:08:20,585 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:20,760 - DEBUG - Node anomaly scores shape: torch.Size([20427, 1])
2025-06-02 16:08:20,770 - DEBUG - Edge anomaly scores shape: torch.Size([43246, 1])
2025-06-02 16:08:20,772 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:21,210 - DEBUG - Step 29: Loss=0.5675
2025-06-02 16:08:21,210 - DEBUG - Online update step: 30/50
2025-06-02 16:08:21,215 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:21,444 - DEBUG - Node anomaly scores shape: torch.Size([20849, 1])
2025-06-02 16:08:21,454 - DEBUG - Edge anomaly scores shape: torch.Size([44112, 1])
2025-06-02 16:08:21,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:21,788 - DEBUG - Step 30: Loss=0.5705
2025-06-02 16:08:21,788 - DEBUG - Online update step: 31/50
2025-06-02 16:08:21,792 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:21,931 - DEBUG - Node anomaly scores shape: torch.Size([20820, 1])
2025-06-02 16:08:21,939 - DEBUG - Edge anomaly scores shape: torch.Size([44317, 1])
2025-06-02 16:08:21,940 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:22,387 - DEBUG - Step 31: Loss=0.5689
2025-06-02 16:08:22,388 - DEBUG - Online update step: 32/50
2025-06-02 16:08:22,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:22,595 - DEBUG - Node anomaly scores shape: torch.Size([22295, 1])
2025-06-02 16:08:22,619 - DEBUG - Edge anomaly scores shape: torch.Size([47406, 1])
2025-06-02 16:08:22,633 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:23,016 - DEBUG - Step 32: Loss=0.5706
2025-06-02 16:08:23,017 - DEBUG - Online update step: 33/50
2025-06-02 16:08:23,020 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:23,157 - DEBUG - Node anomaly scores shape: torch.Size([21304, 1])
2025-06-02 16:08:23,162 - DEBUG - Edge anomaly scores shape: torch.Size([45361, 1])
2025-06-02 16:08:23,163 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:23,457 - DEBUG - Step 33: Loss=0.5676
2025-06-02 16:08:23,457 - DEBUG - Online update step: 34/50
2025-06-02 16:08:23,461 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:23,651 - DEBUG - Node anomaly scores shape: torch.Size([21520, 1])
2025-06-02 16:08:23,658 - DEBUG - Edge anomaly scores shape: torch.Size([45644, 1])
2025-06-02 16:08:23,665 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:24,016 - DEBUG - Step 34: Loss=0.5705
2025-06-02 16:08:24,017 - DEBUG - Online update step: 35/50
2025-06-02 16:08:24,028 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:24,260 - DEBUG - Node anomaly scores shape: torch.Size([22957, 1])
2025-06-02 16:08:24,288 - DEBUG - Edge anomaly scores shape: torch.Size([49251, 1])
2025-06-02 16:08:24,290 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:24,615 - DEBUG - Step 35: Loss=0.5685
2025-06-02 16:08:24,617 - DEBUG - Online update step: 36/50
2025-06-02 16:08:24,620 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:24,729 - DEBUG - Node anomaly scores shape: torch.Size([18420, 1])
2025-06-02 16:08:24,735 - DEBUG - Edge anomaly scores shape: torch.Size([38535, 1])
2025-06-02 16:08:24,736 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:25,033 - DEBUG - Step 36: Loss=0.5706
2025-06-02 16:08:25,033 - DEBUG - Online update step: 37/50
2025-06-02 16:08:25,039 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:25,408 - DEBUG - Node anomaly scores shape: torch.Size([22582, 1])
2025-06-02 16:08:25,420 - DEBUG - Edge anomaly scores shape: torch.Size([48149, 1])
2025-06-02 16:08:25,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:25,864 - DEBUG - Step 37: Loss=0.5674
2025-06-02 16:08:25,864 - DEBUG - Online update step: 38/50
2025-06-02 16:08:25,868 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:26,077 - DEBUG - Node anomaly scores shape: torch.Size([23069, 1])
2025-06-02 16:08:26,093 - DEBUG - Edge anomaly scores shape: torch.Size([49221, 1])
2025-06-02 16:08:26,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:26,648 - DEBUG - Step 38: Loss=0.5702
2025-06-02 16:08:26,649 - DEBUG - Online update step: 39/50
2025-06-02 16:08:26,652 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:26,821 - DEBUG - Node anomaly scores shape: torch.Size([21030, 1])
2025-06-02 16:08:26,828 - DEBUG - Edge anomaly scores shape: torch.Size([44386, 1])
2025-06-02 16:08:26,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:27,168 - DEBUG - Step 39: Loss=0.5684
2025-06-02 16:08:27,169 - DEBUG - Online update step: 40/50
2025-06-02 16:08:27,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:27,317 - DEBUG - Node anomaly scores shape: torch.Size([21643, 1])
2025-06-02 16:08:27,323 - DEBUG - Edge anomaly scores shape: torch.Size([45687, 1])
2025-06-02 16:08:27,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:27,587 - DEBUG - Step 40: Loss=0.5700
2025-06-02 16:08:27,587 - DEBUG - Online update step: 41/50
2025-06-02 16:08:27,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:27,739 - DEBUG - Node anomaly scores shape: torch.Size([24553, 1])
2025-06-02 16:08:27,748 - DEBUG - Edge anomaly scores shape: torch.Size([52558, 1])
2025-06-02 16:08:27,749 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:28,029 - DEBUG - Step 41: Loss=0.5669
2025-06-02 16:08:28,030 - DEBUG - Online update step: 42/50
2025-06-02 16:08:28,033 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:28,144 - DEBUG - Node anomaly scores shape: torch.Size([21707, 1])
2025-06-02 16:08:28,149 - DEBUG - Edge anomaly scores shape: torch.Size([46212, 1])
2025-06-02 16:08:28,150 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:28,382 - DEBUG - Step 42: Loss=0.5697
2025-06-02 16:08:28,382 - DEBUG - Online update step: 43/50
2025-06-02 16:08:28,385 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:28,517 - DEBUG - Node anomaly scores shape: torch.Size([21341, 1])
2025-06-02 16:08:28,523 - DEBUG - Edge anomaly scores shape: torch.Size([45382, 1])
2025-06-02 16:08:28,524 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:28,762 - DEBUG - Step 43: Loss=0.5689
2025-06-02 16:08:28,763 - DEBUG - Online update step: 44/50
2025-06-02 16:08:28,766 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:28,872 - DEBUG - Node anomaly scores shape: torch.Size([20532, 1])
2025-06-02 16:08:28,878 - DEBUG - Edge anomaly scores shape: torch.Size([43280, 1])
2025-06-02 16:08:28,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:29,120 - DEBUG - Step 44: Loss=0.5701
2025-06-02 16:08:29,120 - DEBUG - Online update step: 45/50
2025-06-02 16:08:29,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:29,258 - DEBUG - Node anomaly scores shape: torch.Size([22841, 1])
2025-06-02 16:08:29,275 - DEBUG - Edge anomaly scores shape: torch.Size([48596, 1])
2025-06-02 16:08:29,276 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:29,651 - DEBUG - Step 45: Loss=0.5676
2025-06-02 16:08:29,651 - DEBUG - Online update step: 46/50
2025-06-02 16:08:29,655 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:29,806 - DEBUG - Node anomaly scores shape: torch.Size([22471, 1])
2025-06-02 16:08:29,813 - DEBUG - Edge anomaly scores shape: torch.Size([47753, 1])
2025-06-02 16:08:29,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:30,125 - DEBUG - Step 46: Loss=0.5700
2025-06-02 16:08:30,126 - DEBUG - Online update step: 47/50
2025-06-02 16:08:30,129 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:30,252 - DEBUG - Node anomaly scores shape: torch.Size([21108, 1])
2025-06-02 16:08:30,256 - DEBUG - Edge anomaly scores shape: torch.Size([44527, 1])
2025-06-02 16:08:30,257 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:30,487 - DEBUG - Step 47: Loss=0.5685
2025-06-02 16:08:30,487 - DEBUG - Online update step: 48/50
2025-06-02 16:08:30,490 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:30,604 - DEBUG - Node anomaly scores shape: torch.Size([22981, 1])
2025-06-02 16:08:30,610 - DEBUG - Edge anomaly scores shape: torch.Size([48940, 1])
2025-06-02 16:08:30,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:30,868 - DEBUG - Step 48: Loss=0.5710
2025-06-02 16:08:30,868 - DEBUG - Online update step: 49/50
2025-06-02 16:08:30,871 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:30,991 - DEBUG - Node anomaly scores shape: torch.Size([21293, 1])
2025-06-02 16:08:30,996 - DEBUG - Edge anomaly scores shape: torch.Size([45045, 1])
2025-06-02 16:08:30,997 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:31,241 - DEBUG - Step 49: Loss=0.5672
2025-06-02 16:08:31,241 - DEBUG - Online update step: 50/50
2025-06-02 16:08:31,244 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:31,354 - DEBUG - Node anomaly scores shape: torch.Size([21496, 1])
2025-06-02 16:08:31,364 - DEBUG - Edge anomaly scores shape: torch.Size([45708, 1])
2025-06-02 16:08:31,365 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:31,598 - DEBUG - Step 50: Loss=0.5699
2025-06-02 16:08:31,599 - INFO - Online update finished. Average loss: 0.5692, Learning rate: 0.001000
2025-06-02 16:08:31,600 - DEBUG - Current node mean: [ 0.00000000e+00  0.00000000e+00  8.97909391e-09 -1.91396481e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.28445822e-08
  6.14359053e-09 -1.03968461e-08  1.08694298e-08 -1.74856041e-08
  2.25173450e+00  2.96233892e+00  1.44697726e-01  4.39643192e+00
  1.41775169e-08  3.42319131e+00  5.76412296e+00  7.62140751e+00
  1.44697726e-01  7.99306250e+00  5.67100678e-09 -1.13420136e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.03968461e-08  2.93002014e-08], current edge mean: [ 9.1478148e+00  1.4222623e+00  5.6998649e+00 -4.2977661e-09
  1.5042182e-09  4.2977661e-09  2.1488831e-09  4.7275428e-09
  5.5870961e-09  1.2893299e-09]
2025-06-02 16:08:31,600 - DEBUG - Node drift difference: 0.0123, Edge drift difference: 0.0045
2025-06-02 16:08:31,601 - DEBUG - Updated reference mean: node=[ 0.00000000e+00  0.00000000e+00  8.97909391e-09 -1.91396481e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  3.28445822e-08
  6.14359053e-09 -1.03968461e-08  1.08694298e-08 -1.74856041e-08
  2.25173450e+00  2.96233892e+00  1.44697726e-01  4.39643192e+00
  1.41775169e-08  3.42319131e+00  5.76412296e+00  7.62140751e+00
  1.44697726e-01  7.99306250e+00  5.67100678e-09 -1.13420136e-08
  0.00000000e+00  0.00000000e+00  0.00000000e+00  0.00000000e+00
 -1.03968461e-08  2.93002014e-08], edge=[ 9.1478148e+00  1.4222623e+00  5.6998649e+00 -4.2977661e-09
  1.5042182e-09  4.2977661e-09  2.1488831e-09  4.7275428e-09
  5.5870961e-09  1.2893299e-09]
2025-06-02 16:08:31,601 - DEBUG - Updated reference std: node=[0.         0.         1.0004959  1.0004959  0.         0.
 0.         1.0004959  1.0004959  1.0004959  1.0004959  1.0004959
 0.95122075 0.27198726 0.3657919  0.57340807 1.0004959  3.0204818
 2.9123883  1.4690516  0.3657919  0.22037    1.0004959  1.0004959
 0.         0.         0.         0.         1.0004959  1.0004959 ], edge=[1.1028116  0.50575596 2.139005   1.0002254  1.0002254  1.0002254
 1.0002254  1.0002254  1.0002254  1.0002254 ]
2025-06-02 16:08:31,609 - INFO - Online update complete. Loss: 0.5692
2025-06-02 16:08:31,609 - INFO - Running anomaly detection...
2025-06-02 16:08:31,609 - INFO - Starting anomaly detection.
2025-06-02 16:08:31,615 - DEBUG - Node reconstruction errors: [0.01042656 0.10086664 0.05634063 ... 0.00153582 0.00153581 0.00153581]
2025-06-02 16:08:31,616 - DEBUG - Edge reconstruction errors: [1.3638427  1.3613391  0.95757437 ... 0.15755866 1.2584487  0.15755866]
2025-06-02 16:08:31,617 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160831_update_57.json
2025-06-02 16:08:31,618 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:08:31,626 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160831_update_57.pth and as latest_checkpoint.pth
2025-06-02 16:08:31,627 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870805.dot): 0.1325
2025-06-02 16:08:31,627 - WARNING - Detected 10 anomalous nodes (reconstruction-based):
2025-06-02 16:08:31,627 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.1009, MLP Score: 0.5127
2025-06-02 16:08:31,627 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2518, MLP Score: 0.5089
2025-06-02 16:08:31,627 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1664, MLP Score: 0.4995
2025-06-02 16:08:31,627 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0901, MLP Score: 0.4920
2025-06-02 16:08:31,627 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0850, MLP Score: 0.4917
2025-06-02 16:08:31,627 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:08:31,627 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3557, MLP Score: 0.4723
2025-06-02 16:08:31,627 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8683, MLP Score: 0.4520
2025-06-02 16:08:31,627 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4484, MLP Score: 0.5007
2025-06-02 16:08:31,628 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.3441, MLP Score: 0.4743
2025-06-02 16:08:31,628 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7283, MLP Score: 0.4959
2025-06-02 16:08:31,628 - INFO - 
--- Processing file: nw_graph_encoded_1748870835.dot (Timestamp: 2025-06-02 15:27:15) ---
2025-06-02 16:08:31,628 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-02 16:08:31,628 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-02 16:08:31,660 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 16:08:31,690 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 16:08:31,690 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 16:08:31,690 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870835.dot
2025-06-02 16:08:31,990 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 16:08:32,010 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870835.dot'.
2025-06-02 16:08:32,010 - INFO - Processing node updates/additions.
2025-06-02 16:08:32,015 - INFO - Processing edge updates/additions.
2025-06-02 16:08:32,025 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:08:32,026 - INFO - Finished updating NetworkX graph.
2025-06-02 16:08:32,026 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:08:32,027 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:08:32,035 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 16:08:32,036 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:08:32,036 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 16:08:32,038 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 16:08:32,039 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:08:32,043 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:08:32,044 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:08:32,045 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:08:32,047 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-02 16:08:32,047 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:08:32,048 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-02 16:08:32,048 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 16:08:32,048 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:08:32,050 - INFO - Performing online update...
2025-06-02 16:08:32,050 - INFO - Starting online update for 50 steps.
2025-06-02 16:08:32,051 - DEBUG - Updated RunningStats: new_mean=0.9455161954885306, new_var=33600000000161.367, new_n=3390
2025-06-02 16:08:32,051 - DEBUG - Updated RunningStats: new_mean=0.9436999204951688, new_var=33900000000018.3, new_n=3420
2025-06-02 16:08:32,051 - DEBUG - Updated RunningStats: new_mean=1.1903144695633587, new_var=11200000000093.65, new_n=1130
2025-06-02 16:08:32,051 - DEBUG - Updated RunningStats: new_mean=1.1893016821502898, new_var=11300000000001.629, new_n=1140
2025-06-02 16:08:32,051 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:08:32,052 - DEBUG - Online update step: 1/50
2025-06-02 16:08:32,054 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:32,130 - DEBUG - Node anomaly scores shape: torch.Size([19334, 1])
2025-06-02 16:08:32,136 - DEBUG - Edge anomaly scores shape: torch.Size([40601, 1])
2025-06-02 16:08:32,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:32,400 - DEBUG - Step 1: Loss=0.5685
2025-06-02 16:08:32,400 - DEBUG - Online update step: 2/50
2025-06-02 16:08:32,413 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:32,515 - DEBUG - Node anomaly scores shape: torch.Size([21651, 1])
2025-06-02 16:08:32,521 - DEBUG - Edge anomaly scores shape: torch.Size([46122, 1])
2025-06-02 16:08:32,523 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:32,771 - DEBUG - Step 2: Loss=0.5704
2025-06-02 16:08:32,772 - DEBUG - Online update step: 3/50
2025-06-02 16:08:32,777 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:32,888 - DEBUG - Node anomaly scores shape: torch.Size([20273, 1])
2025-06-02 16:08:32,893 - DEBUG - Edge anomaly scores shape: torch.Size([42899, 1])
2025-06-02 16:08:32,894 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:33,132 - DEBUG - Step 3: Loss=0.5669
2025-06-02 16:08:33,132 - DEBUG - Online update step: 4/50
2025-06-02 16:08:33,139 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:33,258 - DEBUG - Node anomaly scores shape: torch.Size([23005, 1])
2025-06-02 16:08:33,263 - DEBUG - Edge anomaly scores shape: torch.Size([48762, 1])
2025-06-02 16:08:33,264 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:33,555 - DEBUG - Step 4: Loss=0.5696
2025-06-02 16:08:33,555 - DEBUG - Online update step: 5/50
2025-06-02 16:08:33,559 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:33,668 - DEBUG - Node anomaly scores shape: torch.Size([20645, 1])
2025-06-02 16:08:33,673 - DEBUG - Edge anomaly scores shape: torch.Size([43772, 1])
2025-06-02 16:08:33,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:33,918 - DEBUG - Step 5: Loss=0.5685
2025-06-02 16:08:33,918 - DEBUG - Online update step: 6/50
2025-06-02 16:08:33,921 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:34,030 - DEBUG - Node anomaly scores shape: torch.Size([21371, 1])
2025-06-02 16:08:34,036 - DEBUG - Edge anomaly scores shape: torch.Size([45201, 1])
2025-06-02 16:08:34,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:34,265 - DEBUG - Step 6: Loss=0.5714
2025-06-02 16:08:34,266 - DEBUG - Online update step: 7/50
2025-06-02 16:08:34,271 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:34,379 - DEBUG - Node anomaly scores shape: torch.Size([18329, 1])
2025-06-02 16:08:34,387 - DEBUG - Edge anomaly scores shape: torch.Size([38350, 1])
2025-06-02 16:08:34,389 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:34,620 - DEBUG - Step 7: Loss=0.5678
2025-06-02 16:08:34,620 - DEBUG - Online update step: 8/50
2025-06-02 16:08:34,623 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:34,728 - DEBUG - Node anomaly scores shape: torch.Size([21024, 1])
2025-06-02 16:08:34,733 - DEBUG - Edge anomaly scores shape: torch.Size([44518, 1])
2025-06-02 16:08:34,734 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:34,965 - DEBUG - Step 8: Loss=0.5697
2025-06-02 16:08:34,965 - DEBUG - Online update step: 9/50
2025-06-02 16:08:34,969 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:35,079 - DEBUG - Node anomaly scores shape: torch.Size([22454, 1])
2025-06-02 16:08:35,084 - DEBUG - Edge anomaly scores shape: torch.Size([47835, 1])
2025-06-02 16:08:35,086 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:35,326 - DEBUG - Step 9: Loss=0.5678
2025-06-02 16:08:35,326 - DEBUG - Online update step: 10/50
2025-06-02 16:08:35,330 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:35,434 - DEBUG - Node anomaly scores shape: torch.Size([20342, 1])
2025-06-02 16:08:35,440 - DEBUG - Edge anomaly scores shape: torch.Size([42985, 1])
2025-06-02 16:08:35,441 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:35,693 - DEBUG - Step 10: Loss=0.5706
2025-06-02 16:08:35,693 - DEBUG - Online update step: 11/50
2025-06-02 16:08:35,700 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:35,820 - DEBUG - Node anomaly scores shape: torch.Size([21921, 1])
2025-06-02 16:08:35,826 - DEBUG - Edge anomaly scores shape: torch.Size([46602, 1])
2025-06-02 16:08:35,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:36,072 - DEBUG - Step 11: Loss=0.5670
2025-06-02 16:08:36,073 - DEBUG - Online update step: 12/50
2025-06-02 16:08:36,076 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:36,206 - DEBUG - Node anomaly scores shape: torch.Size([21522, 1])
2025-06-02 16:08:36,212 - DEBUG - Edge anomaly scores shape: torch.Size([45480, 1])
2025-06-02 16:08:36,213 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:36,463 - DEBUG - Step 12: Loss=0.5696
2025-06-02 16:08:36,463 - DEBUG - Online update step: 13/50
2025-06-02 16:08:36,467 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:36,582 - DEBUG - Node anomaly scores shape: torch.Size([22158, 1])
2025-06-02 16:08:36,587 - DEBUG - Edge anomaly scores shape: torch.Size([47032, 1])
2025-06-02 16:08:36,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:36,830 - DEBUG - Step 13: Loss=0.5685
2025-06-02 16:08:36,831 - DEBUG - Online update step: 14/50
2025-06-02 16:08:36,834 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:36,962 - DEBUG - Node anomaly scores shape: torch.Size([23133, 1])
2025-06-02 16:08:36,969 - DEBUG - Edge anomaly scores shape: torch.Size([49474, 1])
2025-06-02 16:08:36,970 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:37,250 - DEBUG - Step 14: Loss=0.5704
2025-06-02 16:08:37,251 - DEBUG - Online update step: 15/50
2025-06-02 16:08:37,254 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:37,358 - DEBUG - Node anomaly scores shape: torch.Size([21351, 1])
2025-06-02 16:08:37,364 - DEBUG - Edge anomaly scores shape: torch.Size([45233, 1])
2025-06-02 16:08:37,366 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:37,626 - DEBUG - Step 15: Loss=0.5670
2025-06-02 16:08:37,627 - DEBUG - Online update step: 16/50
2025-06-02 16:08:37,633 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:37,751 - DEBUG - Node anomaly scores shape: torch.Size([21424, 1])
2025-06-02 16:08:37,756 - DEBUG - Edge anomaly scores shape: torch.Size([45626, 1])
2025-06-02 16:08:37,758 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:38,018 - DEBUG - Step 16: Loss=0.5702
2025-06-02 16:08:38,019 - DEBUG - Online update step: 17/50
2025-06-02 16:08:38,022 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:38,178 - DEBUG - Node anomaly scores shape: torch.Size([20883, 1])
2025-06-02 16:08:38,184 - DEBUG - Edge anomaly scores shape: torch.Size([44040, 1])
2025-06-02 16:08:38,186 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:38,759 - DEBUG - Step 17: Loss=0.5682
2025-06-02 16:08:38,759 - DEBUG - Online update step: 18/50
2025-06-02 16:08:38,767 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:39,031 - DEBUG - Node anomaly scores shape: torch.Size([19444, 1])
2025-06-02 16:08:39,036 - DEBUG - Edge anomaly scores shape: torch.Size([40943, 1])
2025-06-02 16:08:39,037 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:39,213 - DEBUG - Step 18: Loss=0.5710
2025-06-02 16:08:39,214 - DEBUG - Online update step: 19/50
2025-06-02 16:08:39,217 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:39,374 - DEBUG - Node anomaly scores shape: torch.Size([21643, 1])
2025-06-02 16:08:39,379 - DEBUG - Edge anomaly scores shape: torch.Size([45968, 1])
2025-06-02 16:08:39,380 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:39,603 - DEBUG - Step 19: Loss=0.5670
2025-06-02 16:08:39,605 - DEBUG - Online update step: 20/50
2025-06-02 16:08:39,609 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:39,741 - DEBUG - Node anomaly scores shape: torch.Size([20376, 1])
2025-06-02 16:08:39,750 - DEBUG - Edge anomaly scores shape: torch.Size([43211, 1])
2025-06-02 16:08:39,753 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:40,034 - DEBUG - Step 20: Loss=0.5697
2025-06-02 16:08:40,035 - DEBUG - Online update step: 21/50
2025-06-02 16:08:40,038 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:40,169 - DEBUG - Node anomaly scores shape: torch.Size([23895, 1])
2025-06-02 16:08:40,174 - DEBUG - Edge anomaly scores shape: torch.Size([51014, 1])
2025-06-02 16:08:40,176 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:40,427 - DEBUG - Step 21: Loss=0.5678
2025-06-02 16:08:40,428 - DEBUG - Online update step: 22/50
2025-06-02 16:08:40,431 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:40,543 - DEBUG - Node anomaly scores shape: torch.Size([22384, 1])
2025-06-02 16:08:40,550 - DEBUG - Edge anomaly scores shape: torch.Size([47777, 1])
2025-06-02 16:08:40,551 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:40,788 - DEBUG - Step 22: Loss=0.5705
2025-06-02 16:08:40,788 - DEBUG - Online update step: 23/50
2025-06-02 16:08:40,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:40,919 - DEBUG - Node anomaly scores shape: torch.Size([22840, 1])
2025-06-02 16:08:40,926 - DEBUG - Edge anomaly scores shape: torch.Size([48556, 1])
2025-06-02 16:08:40,927 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:41,213 - DEBUG - Step 23: Loss=0.5670
2025-06-02 16:08:41,213 - DEBUG - Online update step: 24/50
2025-06-02 16:08:41,216 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:41,330 - DEBUG - Node anomaly scores shape: torch.Size([21226, 1])
2025-06-02 16:08:41,334 - DEBUG - Edge anomaly scores shape: torch.Size([44941, 1])
2025-06-02 16:08:41,335 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:41,587 - DEBUG - Step 24: Loss=0.5699
2025-06-02 16:08:41,588 - DEBUG - Online update step: 25/50
2025-06-02 16:08:41,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:41,706 - DEBUG - Node anomaly scores shape: torch.Size([22723, 1])
2025-06-02 16:08:41,712 - DEBUG - Edge anomaly scores shape: torch.Size([48303, 1])
2025-06-02 16:08:41,713 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:41,943 - DEBUG - Step 25: Loss=0.5686
2025-06-02 16:08:41,944 - DEBUG - Online update step: 26/50
2025-06-02 16:08:41,947 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:42,055 - DEBUG - Node anomaly scores shape: torch.Size([22667, 1])
2025-06-02 16:08:42,060 - DEBUG - Edge anomaly scores shape: torch.Size([48235, 1])
2025-06-02 16:08:42,061 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:42,305 - DEBUG - Step 26: Loss=0.5695
2025-06-02 16:08:42,305 - DEBUG - Online update step: 27/50
2025-06-02 16:08:42,309 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:42,443 - DEBUG - Node anomaly scores shape: torch.Size([23542, 1])
2025-06-02 16:08:42,450 - DEBUG - Edge anomaly scores shape: torch.Size([50045, 1])
2025-06-02 16:08:42,452 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:42,711 - DEBUG - Step 27: Loss=0.5666
2025-06-02 16:08:42,711 - DEBUG - Online update step: 28/50
2025-06-02 16:08:42,715 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:42,814 - DEBUG - Node anomaly scores shape: torch.Size([21899, 1])
2025-06-02 16:08:42,825 - DEBUG - Edge anomaly scores shape: torch.Size([46499, 1])
2025-06-02 16:08:42,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:43,053 - DEBUG - Step 28: Loss=0.5703
2025-06-02 16:08:43,053 - DEBUG - Online update step: 29/50
2025-06-02 16:08:43,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:43,195 - DEBUG - Node anomaly scores shape: torch.Size([21942, 1])
2025-06-02 16:08:43,202 - DEBUG - Edge anomaly scores shape: torch.Size([46453, 1])
2025-06-02 16:08:43,204 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:43,432 - DEBUG - Step 29: Loss=0.5681
2025-06-02 16:08:43,432 - DEBUG - Online update step: 30/50
2025-06-02 16:08:43,436 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:43,569 - DEBUG - Node anomaly scores shape: torch.Size([22526, 1])
2025-06-02 16:08:43,575 - DEBUG - Edge anomaly scores shape: torch.Size([48009, 1])
2025-06-02 16:08:43,576 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:43,804 - DEBUG - Step 30: Loss=0.5698
2025-06-02 16:08:43,805 - DEBUG - Online update step: 31/50
2025-06-02 16:08:43,808 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:43,923 - DEBUG - Node anomaly scores shape: torch.Size([20386, 1])
2025-06-02 16:08:43,930 - DEBUG - Edge anomaly scores shape: torch.Size([43026, 1])
2025-06-02 16:08:43,931 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:44,159 - DEBUG - Step 31: Loss=0.5673
2025-06-02 16:08:44,159 - DEBUG - Online update step: 32/50
2025-06-02 16:08:44,163 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:44,286 - DEBUG - Node anomaly scores shape: torch.Size([21314, 1])
2025-06-02 16:08:44,292 - DEBUG - Edge anomaly scores shape: torch.Size([45212, 1])
2025-06-02 16:08:44,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:44,531 - DEBUG - Step 32: Loss=0.5697
2025-06-02 16:08:44,531 - DEBUG - Online update step: 33/50
2025-06-02 16:08:44,535 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:44,661 - DEBUG - Node anomaly scores shape: torch.Size([20630, 1])
2025-06-02 16:08:44,666 - DEBUG - Edge anomaly scores shape: torch.Size([43524, 1])
2025-06-02 16:08:44,667 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:44,900 - DEBUG - Step 33: Loss=0.5680
2025-06-02 16:08:44,901 - DEBUG - Online update step: 34/50
2025-06-02 16:08:44,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:45,019 - DEBUG - Node anomaly scores shape: torch.Size([21016, 1])
2025-06-02 16:08:45,025 - DEBUG - Edge anomaly scores shape: torch.Size([44521, 1])
2025-06-02 16:08:45,026 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:45,251 - DEBUG - Step 34: Loss=0.5698
2025-06-02 16:08:45,252 - DEBUG - Online update step: 35/50
2025-06-02 16:08:45,255 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:45,388 - DEBUG - Node anomaly scores shape: torch.Size([22280, 1])
2025-06-02 16:08:45,394 - DEBUG - Edge anomaly scores shape: torch.Size([47203, 1])
2025-06-02 16:08:45,395 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:45,690 - DEBUG - Step 35: Loss=0.5667
2025-06-02 16:08:45,690 - DEBUG - Online update step: 36/50
2025-06-02 16:08:45,697 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:45,807 - DEBUG - Node anomaly scores shape: torch.Size([21102, 1])
2025-06-02 16:08:45,813 - DEBUG - Edge anomaly scores shape: torch.Size([44730, 1])
2025-06-02 16:08:45,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:46,051 - DEBUG - Step 36: Loss=0.5699
2025-06-02 16:08:46,051 - DEBUG - Online update step: 37/50
2025-06-02 16:08:46,058 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:46,173 - DEBUG - Node anomaly scores shape: torch.Size([19369, 1])
2025-06-02 16:08:46,179 - DEBUG - Edge anomaly scores shape: torch.Size([40997, 1])
2025-06-02 16:08:46,181 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:46,393 - DEBUG - Step 37: Loss=0.5687
2025-06-02 16:08:46,394 - DEBUG - Online update step: 38/50
2025-06-02 16:08:46,397 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:46,497 - DEBUG - Node anomaly scores shape: torch.Size([19593, 1])
2025-06-02 16:08:46,501 - DEBUG - Edge anomaly scores shape: torch.Size([41427, 1])
2025-06-02 16:08:46,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:46,736 - DEBUG - Step 38: Loss=0.5702
2025-06-02 16:08:46,737 - DEBUG - Online update step: 39/50
2025-06-02 16:08:46,743 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:46,839 - DEBUG - Node anomaly scores shape: torch.Size([19198, 1])
2025-06-02 16:08:46,846 - DEBUG - Edge anomaly scores shape: torch.Size([40292, 1])
2025-06-02 16:08:46,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:47,067 - DEBUG - Step 39: Loss=0.5666
2025-06-02 16:08:47,067 - DEBUG - Online update step: 40/50
2025-06-02 16:08:47,074 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:47,195 - DEBUG - Node anomaly scores shape: torch.Size([20942, 1])
2025-06-02 16:08:47,200 - DEBUG - Edge anomaly scores shape: torch.Size([44182, 1])
2025-06-02 16:08:47,202 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:47,426 - DEBUG - Step 40: Loss=0.5699
2025-06-02 16:08:47,427 - DEBUG - Online update step: 41/50
2025-06-02 16:08:47,433 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:47,546 - DEBUG - Node anomaly scores shape: torch.Size([20620, 1])
2025-06-02 16:08:47,551 - DEBUG - Edge anomaly scores shape: torch.Size([43797, 1])
2025-06-02 16:08:47,553 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:47,810 - DEBUG - Step 41: Loss=0.5679
2025-06-02 16:08:47,810 - DEBUG - Online update step: 42/50
2025-06-02 16:08:47,816 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:47,915 - DEBUG - Node anomaly scores shape: torch.Size([19469, 1])
2025-06-02 16:08:47,919 - DEBUG - Edge anomaly scores shape: torch.Size([41097, 1])
2025-06-02 16:08:47,921 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:48,172 - DEBUG - Step 42: Loss=0.5697
2025-06-02 16:08:48,173 - DEBUG - Online update step: 43/50
2025-06-02 16:08:48,179 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:48,292 - DEBUG - Node anomaly scores shape: torch.Size([22183, 1])
2025-06-02 16:08:48,297 - DEBUG - Edge anomaly scores shape: torch.Size([47037, 1])
2025-06-02 16:08:48,298 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:48,577 - DEBUG - Step 43: Loss=0.5669
2025-06-02 16:08:48,577 - DEBUG - Online update step: 44/50
2025-06-02 16:08:48,584 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:48,703 - DEBUG - Node anomaly scores shape: torch.Size([20597, 1])
2025-06-02 16:08:48,707 - DEBUG - Edge anomaly scores shape: torch.Size([43549, 1])
2025-06-02 16:08:48,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:48,943 - DEBUG - Step 44: Loss=0.5701
2025-06-02 16:08:48,944 - DEBUG - Online update step: 45/50
2025-06-02 16:08:48,947 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:49,046 - DEBUG - Node anomaly scores shape: torch.Size([21200, 1])
2025-06-02 16:08:49,050 - DEBUG - Edge anomaly scores shape: torch.Size([45178, 1])
2025-06-02 16:08:49,052 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:49,267 - DEBUG - Step 45: Loss=0.5679
2025-06-02 16:08:49,267 - DEBUG - Online update step: 46/50
2025-06-02 16:08:49,270 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:49,380 - DEBUG - Node anomaly scores shape: torch.Size([20926, 1])
2025-06-02 16:08:49,386 - DEBUG - Edge anomaly scores shape: torch.Size([44372, 1])
2025-06-02 16:08:49,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:49,620 - DEBUG - Step 46: Loss=0.5698
2025-06-02 16:08:49,621 - DEBUG - Online update step: 47/50
2025-06-02 16:08:49,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:49,754 - DEBUG - Node anomaly scores shape: torch.Size([21341, 1])
2025-06-02 16:08:49,761 - DEBUG - Edge anomaly scores shape: torch.Size([45231, 1])
2025-06-02 16:08:49,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:50,006 - DEBUG - Step 47: Loss=0.5667
2025-06-02 16:08:50,006 - DEBUG - Online update step: 48/50
2025-06-02 16:08:50,010 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:50,118 - DEBUG - Node anomaly scores shape: torch.Size([20706, 1])
2025-06-02 16:08:50,124 - DEBUG - Edge anomaly scores shape: torch.Size([43556, 1])
2025-06-02 16:08:50,125 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:50,367 - DEBUG - Step 48: Loss=0.5700
2025-06-02 16:08:50,368 - DEBUG - Online update step: 49/50
2025-06-02 16:08:50,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:50,487 - DEBUG - Node anomaly scores shape: torch.Size([21477, 1])
2025-06-02 16:08:50,492 - DEBUG - Edge anomaly scores shape: torch.Size([45468, 1])
2025-06-02 16:08:50,493 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:50,743 - DEBUG - Step 49: Loss=0.5682
2025-06-02 16:08:50,743 - DEBUG - Online update step: 50/50
2025-06-02 16:08:50,747 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:50,871 - DEBUG - Node anomaly scores shape: torch.Size([22393, 1])
2025-06-02 16:08:50,876 - DEBUG - Edge anomaly scores shape: torch.Size([47424, 1])
2025-06-02 16:08:50,878 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:51,130 - DEBUG - Step 50: Loss=0.5701
2025-06-02 16:08:51,131 - INFO - Online update finished. Average loss: 0.5688, Learning rate: 0.001000
2025-06-02 16:08:51,132 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:08:51,132 - DEBUG - Node drift difference: 0.0013, Edge drift difference: 0.0004
2025-06-02 16:08:51,133 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:08:51,134 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-02 16:08:51,134 - INFO - Online update complete. Loss: 0.5688
2025-06-02 16:08:51,134 - INFO - Running anomaly detection...
2025-06-02 16:08:51,134 - INFO - Starting anomaly detection.
2025-06-02 16:08:51,140 - DEBUG - Node reconstruction errors: [0.00901609 0.08899721 0.0561887  ... 0.00247129 0.00247129 0.00247129]
2025-06-02 16:08:51,140 - DEBUG - Edge reconstruction errors: [1.363853  1.3613489 0.9575833 ... 0.1575677 1.2584579 0.1575677]
2025-06-02 16:08:51,142 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160851_update_58.json
2025-06-02 16:08:51,142 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:08:51,151 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160851_update_58.pth and as latest_checkpoint.pth
2025-06-02 16:08:51,151 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870835.dot): 0.1318
2025-06-02 16:08:51,152 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:08:51,152 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.0890, MLP Score: 0.5002
2025-06-02 16:08:51,152 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2448, MLP Score: 0.4991
2025-06-02 16:08:51,152 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1519, MLP Score: 0.4895
2025-06-02 16:08:51,152 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0854, MLP Score: 0.4817
2025-06-02 16:08:51,152 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0807, MLP Score: 0.4813
2025-06-02 16:08:51,152 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:08:51,152 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3600, MLP Score: 0.4892
2025-06-02 16:08:51,152 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8725, MLP Score: 0.4640
2025-06-02 16:08:51,152 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4487, MLP Score: 0.4837
2025-06-02 16:08:51,152 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.3451, MLP Score: 0.4551
2025-06-02 16:08:51,152 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7291, MLP Score: 0.4760
2025-06-02 16:08:51,153 - INFO - 
--- Processing file: nw_graph_encoded_1748870865.dot (Timestamp: 2025-06-02 15:27:45) ---
2025-06-02 16:08:51,153 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-02 16:08:51,153 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-02 16:08:51,184 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 16:08:51,213 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 16:08:51,213 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 16:08:51,213 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870865.dot
2025-06-02 16:08:51,235 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 16:08:51,257 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870865.dot'.
2025-06-02 16:08:51,257 - INFO - Processing node updates/additions.
2025-06-02 16:08:51,262 - INFO - Processing edge updates/additions.
2025-06-02 16:08:51,273 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:08:51,273 - INFO - Finished updating NetworkX graph.
2025-06-02 16:08:51,273 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:08:51,274 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:08:51,283 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 16:08:51,284 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:08:51,284 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 16:08:51,287 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 16:08:51,288 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:08:51,292 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:08:51,293 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:08:51,294 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:08:51,296 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-02 16:08:51,297 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:08:51,297 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-02 16:08:51,297 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 16:08:51,297 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:08:51,300 - INFO - Performing online update...
2025-06-02 16:08:51,300 - INFO - Starting online update for 50 steps.
2025-06-02 16:08:51,300 - DEBUG - Updated RunningStats: new_mean=0.9455523792567501, new_var=34200000000161.367, new_n=3450
2025-06-02 16:08:51,300 - DEBUG - Updated RunningStats: new_mean=0.9437671074204443, new_var=34500000000018.305, new_n=3480
2025-06-02 16:08:51,301 - DEBUG - Updated RunningStats: new_mean=1.1931079896633674, new_var=11400000000093.625, new_n=1150
2025-06-02 16:08:51,301 - DEBUG - Updated RunningStats: new_mean=1.1920885820324203, new_var=11500000000001.635, new_n=1160
2025-06-02 16:08:51,301 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:08:51,301 - DEBUG - Online update step: 1/50
2025-06-02 16:08:51,303 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:51,491 - DEBUG - Node anomaly scores shape: torch.Size([20960, 1])
2025-06-02 16:08:51,497 - DEBUG - Edge anomaly scores shape: torch.Size([44568, 1])
2025-06-02 16:08:51,499 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:51,723 - DEBUG - Step 1: Loss=0.5667
2025-06-02 16:08:51,724 - DEBUG - Online update step: 2/50
2025-06-02 16:08:51,734 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:51,840 - DEBUG - Node anomaly scores shape: torch.Size([20323, 1])
2025-06-02 16:08:51,845 - DEBUG - Edge anomaly scores shape: torch.Size([42712, 1])
2025-06-02 16:08:51,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:52,109 - DEBUG - Step 2: Loss=0.5698
2025-06-02 16:08:52,109 - DEBUG - Online update step: 3/50
2025-06-02 16:08:52,115 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:52,236 - DEBUG - Node anomaly scores shape: torch.Size([23276, 1])
2025-06-02 16:08:52,242 - DEBUG - Edge anomaly scores shape: torch.Size([49810, 1])
2025-06-02 16:08:52,243 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:52,514 - DEBUG - Step 3: Loss=0.5678
2025-06-02 16:08:52,514 - DEBUG - Online update step: 4/50
2025-06-02 16:08:52,520 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:52,625 - DEBUG - Node anomaly scores shape: torch.Size([22467, 1])
2025-06-02 16:08:52,630 - DEBUG - Edge anomaly scores shape: torch.Size([47655, 1])
2025-06-02 16:08:52,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:52,890 - DEBUG - Step 4: Loss=0.5693
2025-06-02 16:08:52,890 - DEBUG - Online update step: 5/50
2025-06-02 16:08:52,894 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:53,006 - DEBUG - Node anomaly scores shape: torch.Size([23089, 1])
2025-06-02 16:08:53,011 - DEBUG - Edge anomaly scores shape: torch.Size([49054, 1])
2025-06-02 16:08:53,012 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:53,291 - DEBUG - Step 5: Loss=0.5670
2025-06-02 16:08:53,291 - DEBUG - Online update step: 6/50
2025-06-02 16:08:53,297 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:53,414 - DEBUG - Node anomaly scores shape: torch.Size([20875, 1])
2025-06-02 16:08:53,425 - DEBUG - Edge anomaly scores shape: torch.Size([44463, 1])
2025-06-02 16:08:53,427 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:53,687 - DEBUG - Step 6: Loss=0.5699
2025-06-02 16:08:53,687 - DEBUG - Online update step: 7/50
2025-06-02 16:08:53,693 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:53,816 - DEBUG - Node anomaly scores shape: torch.Size([23532, 1])
2025-06-02 16:08:53,821 - DEBUG - Edge anomaly scores shape: torch.Size([50398, 1])
2025-06-02 16:08:53,822 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:54,086 - DEBUG - Step 7: Loss=0.5677
2025-06-02 16:08:54,086 - DEBUG - Online update step: 8/50
2025-06-02 16:08:54,089 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:54,178 - DEBUG - Node anomaly scores shape: torch.Size([19342, 1])
2025-06-02 16:08:54,183 - DEBUG - Edge anomaly scores shape: torch.Size([40569, 1])
2025-06-02 16:08:54,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:54,390 - DEBUG - Step 8: Loss=0.5697
2025-06-02 16:08:54,390 - DEBUG - Online update step: 9/50
2025-06-02 16:08:54,394 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:54,526 - DEBUG - Node anomaly scores shape: torch.Size([23425, 1])
2025-06-02 16:08:54,531 - DEBUG - Edge anomaly scores shape: torch.Size([50141, 1])
2025-06-02 16:08:54,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:54,805 - DEBUG - Step 9: Loss=0.5670
2025-06-02 16:08:54,805 - DEBUG - Online update step: 10/50
2025-06-02 16:08:54,808 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:54,932 - DEBUG - Node anomaly scores shape: torch.Size([23003, 1])
2025-06-02 16:08:54,938 - DEBUG - Edge anomaly scores shape: torch.Size([49019, 1])
2025-06-02 16:08:54,939 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:55,232 - DEBUG - Step 10: Loss=0.5695
2025-06-02 16:08:55,232 - DEBUG - Online update step: 11/50
2025-06-02 16:08:55,240 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:55,362 - DEBUG - Node anomaly scores shape: torch.Size([23017, 1])
2025-06-02 16:08:55,368 - DEBUG - Edge anomaly scores shape: torch.Size([48817, 1])
2025-06-02 16:08:55,369 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:55,626 - DEBUG - Step 11: Loss=0.5676
2025-06-02 16:08:55,626 - DEBUG - Online update step: 12/50
2025-06-02 16:08:55,630 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:55,748 - DEBUG - Node anomaly scores shape: torch.Size([21635, 1])
2025-06-02 16:08:55,754 - DEBUG - Edge anomaly scores shape: torch.Size([45761, 1])
2025-06-02 16:08:55,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:56,019 - DEBUG - Step 12: Loss=0.5697
2025-06-02 16:08:56,020 - DEBUG - Online update step: 13/50
2025-06-02 16:08:56,026 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:56,131 - DEBUG - Node anomaly scores shape: torch.Size([21286, 1])
2025-06-02 16:08:56,136 - DEBUG - Edge anomaly scores shape: torch.Size([44830, 1])
2025-06-02 16:08:56,137 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:56,365 - DEBUG - Step 13: Loss=0.5669
2025-06-02 16:08:56,365 - DEBUG - Online update step: 14/50
2025-06-02 16:08:56,371 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:56,503 - DEBUG - Node anomaly scores shape: torch.Size([23132, 1])
2025-06-02 16:08:56,509 - DEBUG - Edge anomaly scores shape: torch.Size([49316, 1])
2025-06-02 16:08:56,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:56,782 - DEBUG - Step 14: Loss=0.5693
2025-06-02 16:08:56,782 - DEBUG - Online update step: 15/50
2025-06-02 16:08:56,786 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:56,898 - DEBUG - Node anomaly scores shape: torch.Size([21255, 1])
2025-06-02 16:08:56,903 - DEBUG - Edge anomaly scores shape: torch.Size([44848, 1])
2025-06-02 16:08:56,905 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:57,152 - DEBUG - Step 15: Loss=0.5677
2025-06-02 16:08:57,152 - DEBUG - Online update step: 16/50
2025-06-02 16:08:57,156 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:57,276 - DEBUG - Node anomaly scores shape: torch.Size([21887, 1])
2025-06-02 16:08:57,281 - DEBUG - Edge anomaly scores shape: torch.Size([46503, 1])
2025-06-02 16:08:57,282 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:57,527 - DEBUG - Step 16: Loss=0.5694
2025-06-02 16:08:57,528 - DEBUG - Online update step: 17/50
2025-06-02 16:08:57,531 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:57,629 - DEBUG - Node anomaly scores shape: torch.Size([19786, 1])
2025-06-02 16:08:57,633 - DEBUG - Edge anomaly scores shape: torch.Size([41955, 1])
2025-06-02 16:08:57,635 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:57,844 - DEBUG - Step 17: Loss=0.5670
2025-06-02 16:08:57,845 - DEBUG - Online update step: 18/50
2025-06-02 16:08:57,858 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:57,982 - DEBUG - Node anomaly scores shape: torch.Size([19799, 1])
2025-06-02 16:08:57,988 - DEBUG - Edge anomaly scores shape: torch.Size([41713, 1])
2025-06-02 16:08:57,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:58,236 - DEBUG - Step 18: Loss=0.5699
2025-06-02 16:08:58,236 - DEBUG - Online update step: 19/50
2025-06-02 16:08:58,243 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:58,363 - DEBUG - Node anomaly scores shape: torch.Size([21555, 1])
2025-06-02 16:08:58,370 - DEBUG - Edge anomaly scores shape: torch.Size([45761, 1])
2025-06-02 16:08:58,372 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:58,621 - DEBUG - Step 19: Loss=0.5676
2025-06-02 16:08:58,621 - DEBUG - Online update step: 20/50
2025-06-02 16:08:58,624 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:58,750 - DEBUG - Node anomaly scores shape: torch.Size([22497, 1])
2025-06-02 16:08:58,755 - DEBUG - Edge anomaly scores shape: torch.Size([47837, 1])
2025-06-02 16:08:58,756 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:59,003 - DEBUG - Step 20: Loss=0.5696
2025-06-02 16:08:59,003 - DEBUG - Online update step: 21/50
2025-06-02 16:08:59,007 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:59,132 - DEBUG - Node anomaly scores shape: torch.Size([23430, 1])
2025-06-02 16:08:59,138 - DEBUG - Edge anomaly scores shape: torch.Size([49841, 1])
2025-06-02 16:08:59,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:59,402 - DEBUG - Step 21: Loss=0.5663
2025-06-02 16:08:59,403 - DEBUG - Online update step: 22/50
2025-06-02 16:08:59,410 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:59,531 - DEBUG - Node anomaly scores shape: torch.Size([21102, 1])
2025-06-02 16:08:59,536 - DEBUG - Edge anomaly scores shape: torch.Size([44899, 1])
2025-06-02 16:08:59,538 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:08:59,782 - DEBUG - Step 22: Loss=0.5699
2025-06-02 16:08:59,783 - DEBUG - Online update step: 23/50
2025-06-02 16:08:59,787 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:08:59,899 - DEBUG - Node anomaly scores shape: torch.Size([21914, 1])
2025-06-02 16:08:59,906 - DEBUG - Edge anomaly scores shape: torch.Size([46539, 1])
2025-06-02 16:08:59,908 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:00,169 - DEBUG - Step 23: Loss=0.5680
2025-06-02 16:09:00,169 - DEBUG - Online update step: 24/50
2025-06-02 16:09:00,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:00,280 - DEBUG - Node anomaly scores shape: torch.Size([21502, 1])
2025-06-02 16:09:00,285 - DEBUG - Edge anomaly scores shape: torch.Size([45557, 1])
2025-06-02 16:09:00,286 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:00,526 - DEBUG - Step 24: Loss=0.5701
2025-06-02 16:09:00,526 - DEBUG - Online update step: 25/50
2025-06-02 16:09:00,530 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:00,652 - DEBUG - Node anomaly scores shape: torch.Size([22727, 1])
2025-06-02 16:09:00,657 - DEBUG - Edge anomaly scores shape: torch.Size([48300, 1])
2025-06-02 16:09:00,658 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:00,900 - DEBUG - Step 25: Loss=0.5665
2025-06-02 16:09:00,900 - DEBUG - Online update step: 26/50
2025-06-02 16:09:00,904 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:01,018 - DEBUG - Node anomaly scores shape: torch.Size([20785, 1])
2025-06-02 16:09:01,022 - DEBUG - Edge anomaly scores shape: torch.Size([44303, 1])
2025-06-02 16:09:01,024 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:01,232 - DEBUG - Step 26: Loss=0.5693
2025-06-02 16:09:01,232 - DEBUG - Online update step: 27/50
2025-06-02 16:09:01,235 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:01,348 - DEBUG - Node anomaly scores shape: torch.Size([21588, 1])
2025-06-02 16:09:01,353 - DEBUG - Edge anomaly scores shape: torch.Size([45681, 1])
2025-06-02 16:09:01,355 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:01,601 - DEBUG - Step 27: Loss=0.5674
2025-06-02 16:09:01,601 - DEBUG - Online update step: 28/50
2025-06-02 16:09:01,605 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:01,740 - DEBUG - Node anomaly scores shape: torch.Size([22773, 1])
2025-06-02 16:09:01,745 - DEBUG - Edge anomaly scores shape: torch.Size([48475, 1])
2025-06-02 16:09:01,747 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:02,021 - DEBUG - Step 28: Loss=0.5696
2025-06-02 16:09:02,022 - DEBUG - Online update step: 29/50
2025-06-02 16:09:02,029 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:02,153 - DEBUG - Node anomaly scores shape: torch.Size([22524, 1])
2025-06-02 16:09:02,158 - DEBUG - Edge anomaly scores shape: torch.Size([48013, 1])
2025-06-02 16:09:02,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:02,404 - DEBUG - Step 29: Loss=0.5669
2025-06-02 16:09:02,405 - DEBUG - Online update step: 30/50
2025-06-02 16:09:02,408 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:02,536 - DEBUG - Node anomaly scores shape: torch.Size([23786, 1])
2025-06-02 16:09:02,542 - DEBUG - Edge anomaly scores shape: torch.Size([50956, 1])
2025-06-02 16:09:02,543 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:02,794 - DEBUG - Step 30: Loss=0.5697
2025-06-02 16:09:02,794 - DEBUG - Online update step: 31/50
2025-06-02 16:09:02,798 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:02,925 - DEBUG - Node anomaly scores shape: torch.Size([22889, 1])
2025-06-02 16:09:02,931 - DEBUG - Edge anomaly scores shape: torch.Size([48723, 1])
2025-06-02 16:09:02,932 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:03,196 - DEBUG - Step 31: Loss=0.5682
2025-06-02 16:09:03,196 - DEBUG - Online update step: 32/50
2025-06-02 16:09:03,199 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:03,332 - DEBUG - Node anomaly scores shape: torch.Size([23002, 1])
2025-06-02 16:09:03,339 - DEBUG - Edge anomaly scores shape: torch.Size([49143, 1])
2025-06-02 16:09:03,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:03,678 - DEBUG - Step 32: Loss=0.5693
2025-06-02 16:09:03,678 - DEBUG - Online update step: 33/50
2025-06-02 16:09:03,685 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:03,806 - DEBUG - Node anomaly scores shape: torch.Size([22797, 1])
2025-06-02 16:09:03,812 - DEBUG - Edge anomaly scores shape: torch.Size([48524, 1])
2025-06-02 16:09:03,813 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:04,071 - DEBUG - Step 33: Loss=0.5660
2025-06-02 16:09:04,071 - DEBUG - Online update step: 34/50
2025-06-02 16:09:04,075 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:04,192 - DEBUG - Node anomaly scores shape: torch.Size([23938, 1])
2025-06-02 16:09:04,198 - DEBUG - Edge anomaly scores shape: torch.Size([51224, 1])
2025-06-02 16:09:04,199 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:04,442 - DEBUG - Step 34: Loss=0.5692
2025-06-02 16:09:04,442 - DEBUG - Online update step: 35/50
2025-06-02 16:09:04,445 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:04,559 - DEBUG - Node anomaly scores shape: torch.Size([22723, 1])
2025-06-02 16:09:04,564 - DEBUG - Edge anomaly scores shape: torch.Size([48235, 1])
2025-06-02 16:09:04,565 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:04,804 - DEBUG - Step 35: Loss=0.5677
2025-06-02 16:09:04,804 - DEBUG - Online update step: 36/50
2025-06-02 16:09:04,808 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:04,939 - DEBUG - Node anomaly scores shape: torch.Size([22670, 1])
2025-06-02 16:09:04,945 - DEBUG - Edge anomaly scores shape: torch.Size([48258, 1])
2025-06-02 16:09:04,947 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:05,217 - DEBUG - Step 36: Loss=0.5701
2025-06-02 16:09:05,218 - DEBUG - Online update step: 37/50
2025-06-02 16:09:05,221 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:05,328 - DEBUG - Node anomaly scores shape: torch.Size([21943, 1])
2025-06-02 16:09:05,333 - DEBUG - Edge anomaly scores shape: torch.Size([46666, 1])
2025-06-02 16:09:05,334 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:05,588 - DEBUG - Step 37: Loss=0.5672
2025-06-02 16:09:05,588 - DEBUG - Online update step: 38/50
2025-06-02 16:09:05,591 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:05,681 - DEBUG - Node anomaly scores shape: torch.Size([20402, 1])
2025-06-02 16:09:05,686 - DEBUG - Edge anomaly scores shape: torch.Size([43061, 1])
2025-06-02 16:09:05,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:05,882 - DEBUG - Step 38: Loss=0.5696
2025-06-02 16:09:05,882 - DEBUG - Online update step: 39/50
2025-06-02 16:09:05,885 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:05,999 - DEBUG - Node anomaly scores shape: torch.Size([19751, 1])
2025-06-02 16:09:06,004 - DEBUG - Edge anomaly scores shape: torch.Size([41665, 1])
2025-06-02 16:09:06,005 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:06,259 - DEBUG - Step 39: Loss=0.5674
2025-06-02 16:09:06,259 - DEBUG - Online update step: 40/50
2025-06-02 16:09:06,262 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:06,369 - DEBUG - Node anomaly scores shape: torch.Size([20999, 1])
2025-06-02 16:09:06,373 - DEBUG - Edge anomaly scores shape: torch.Size([44441, 1])
2025-06-02 16:09:06,375 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:06,608 - DEBUG - Step 40: Loss=0.5696
2025-06-02 16:09:06,609 - DEBUG - Online update step: 41/50
2025-06-02 16:09:06,612 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:06,744 - DEBUG - Node anomaly scores shape: torch.Size([21788, 1])
2025-06-02 16:09:06,750 - DEBUG - Edge anomaly scores shape: torch.Size([46249, 1])
2025-06-02 16:09:06,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:06,992 - DEBUG - Step 41: Loss=0.5666
2025-06-02 16:09:06,992 - DEBUG - Online update step: 42/50
2025-06-02 16:09:06,996 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:07,143 - DEBUG - Node anomaly scores shape: torch.Size([24701, 1])
2025-06-02 16:09:07,151 - DEBUG - Edge anomaly scores shape: torch.Size([52689, 1])
2025-06-02 16:09:07,152 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:07,464 - DEBUG - Step 42: Loss=0.5696
2025-06-02 16:09:07,465 - DEBUG - Online update step: 43/50
2025-06-02 16:09:07,468 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:07,603 - DEBUG - Node anomaly scores shape: torch.Size([22468, 1])
2025-06-02 16:09:07,609 - DEBUG - Edge anomaly scores shape: torch.Size([47701, 1])
2025-06-02 16:09:07,610 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:07,865 - DEBUG - Step 43: Loss=0.5679
2025-06-02 16:09:07,866 - DEBUG - Online update step: 44/50
2025-06-02 16:09:07,874 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:08,005 - DEBUG - Node anomaly scores shape: torch.Size([22763, 1])
2025-06-02 16:09:08,013 - DEBUG - Edge anomaly scores shape: torch.Size([48379, 1])
2025-06-02 16:09:08,014 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:08,286 - DEBUG - Step 44: Loss=0.5689
2025-06-02 16:09:08,287 - DEBUG - Online update step: 45/50
2025-06-02 16:09:08,293 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:08,431 - DEBUG - Node anomaly scores shape: torch.Size([22546, 1])
2025-06-02 16:09:08,437 - DEBUG - Edge anomaly scores shape: torch.Size([47983, 1])
2025-06-02 16:09:08,439 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:08,729 - DEBUG - Step 45: Loss=0.5660
2025-06-02 16:09:08,729 - DEBUG - Online update step: 46/50
2025-06-02 16:09:08,732 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:08,856 - DEBUG - Node anomaly scores shape: torch.Size([21940, 1])
2025-06-02 16:09:08,863 - DEBUG - Edge anomaly scores shape: torch.Size([46731, 1])
2025-06-02 16:09:08,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:09,124 - DEBUG - Step 46: Loss=0.5692
2025-06-02 16:09:09,124 - DEBUG - Online update step: 47/50
2025-06-02 16:09:09,128 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:09,251 - DEBUG - Node anomaly scores shape: torch.Size([22191, 1])
2025-06-02 16:09:09,257 - DEBUG - Edge anomaly scores shape: torch.Size([46902, 1])
2025-06-02 16:09:09,258 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:09,522 - DEBUG - Step 47: Loss=0.5674
2025-06-02 16:09:09,522 - DEBUG - Online update step: 48/50
2025-06-02 16:09:09,525 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:09,637 - DEBUG - Node anomaly scores shape: torch.Size([20935, 1])
2025-06-02 16:09:09,643 - DEBUG - Edge anomaly scores shape: torch.Size([44374, 1])
2025-06-02 16:09:09,644 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:09,887 - DEBUG - Step 48: Loss=0.5694
2025-06-02 16:09:09,888 - DEBUG - Online update step: 49/50
2025-06-02 16:09:09,891 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:09,999 - DEBUG - Node anomaly scores shape: torch.Size([20656, 1])
2025-06-02 16:09:10,005 - DEBUG - Edge anomaly scores shape: torch.Size([43743, 1])
2025-06-02 16:09:10,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:10,236 - DEBUG - Step 49: Loss=0.5671
2025-06-02 16:09:10,237 - DEBUG - Online update step: 50/50
2025-06-02 16:09:10,240 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:10,368 - DEBUG - Node anomaly scores shape: torch.Size([24895, 1])
2025-06-02 16:09:10,374 - DEBUG - Edge anomaly scores shape: torch.Size([53562, 1])
2025-06-02 16:09:10,376 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:10,682 - DEBUG - Step 50: Loss=0.5690
2025-06-02 16:09:10,683 - INFO - Online update finished. Average loss: 0.5684, Learning rate: 0.001000
2025-06-02 16:09:10,684 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:09:10,684 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:09:10,686 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:09:10,687 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-02 16:09:10,687 - INFO - Online update complete. Loss: 0.5684
2025-06-02 16:09:10,687 - INFO - Running anomaly detection...
2025-06-02 16:09:10,687 - INFO - Starting anomaly detection.
2025-06-02 16:09:10,695 - DEBUG - Node reconstruction errors: [0.00972739 0.08158129 0.05237879 ... 0.00190862 0.00190862 0.00190862]
2025-06-02 16:09:10,695 - DEBUG - Edge reconstruction errors: [1.363853   1.3613487  0.9575833  ... 0.15756766 1.2584579  0.15756766]
2025-06-02 16:09:10,698 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160910_update_59.json
2025-06-02 16:09:10,699 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:09:10,715 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160910_update_59.pth and as latest_checkpoint.pth
2025-06-02 16:09:10,715 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870865.dot): 0.1357
2025-06-02 16:09:10,716 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:09:10,716 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.0816, MLP Score: 0.5118
2025-06-02 16:09:10,716 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.2301, MLP Score: 0.5086
2025-06-02 16:09:10,716 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1241, MLP Score: 0.4997
2025-06-02 16:09:10,716 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0828, MLP Score: 0.4920
2025-06-02 16:09:10,716 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0817, MLP Score: 0.4938
2025-06-02 16:09:10,716 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:09:10,717 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3600, MLP Score: 0.4764
2025-06-02 16:09:10,717 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8725, MLP Score: 0.4573
2025-06-02 16:09:10,717 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4487, MLP Score: 0.5025
2025-06-02 16:09:10,717 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.3451, MLP Score: 0.4779
2025-06-02 16:09:10,718 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7291, MLP Score: 0.4962
2025-06-02 16:09:10,718 - INFO - 
--- Processing file: nw_graph_encoded_1748870895.dot (Timestamp: 2025-06-02 15:28:15) ---
2025-06-02 16:09:10,718 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-02 16:09:10,718 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-02 16:09:10,743 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 16:09:10,767 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 16:09:10,767 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 16:09:10,767 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748870895.dot
2025-06-02 16:09:10,786 - INFO - Parsed 1010 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 16:09:10,807 - INFO - Parsed 2220 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748870895.dot'.
2025-06-02 16:09:10,807 - INFO - Processing node updates/additions.
2025-06-02 16:09:10,811 - INFO - Processing edge updates/additions.
2025-06-02 16:09:10,822 - INFO - Processing deletions (nodes and edges).
2025-06-02 16:09:10,823 - INFO - Finished updating NetworkX graph.
2025-06-02 16:09:10,823 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 16:09:10,824 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 16:09:10,831 - DEBUG - Initial node features tensor shape: torch.Size([1010, 30])
2025-06-02 16:09:10,833 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-02 16:09:10,834 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 30])
2025-06-02 16:09:10,836 - DEBUG - Edge index tensor shape: torch.Size([2, 2220])
2025-06-02 16:09:10,837 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-02 16:09:10,845 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 19
2025-06-02 16:09:10,847 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-02 16:09:10,849 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-02 16:09:10,850 - DEBUG - Shape of encoded categorical edge features: torch.Size([2220, 3])
2025-06-02 16:09:10,851 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-02 16:09:10,852 - DEBUG - Shape of scaled numerical edge features: torch.Size([2220, 7])
2025-06-02 16:09:10,852 - DEBUG - Final edge attributes tensor shape: torch.Size([2220, 10])
2025-06-02 16:09:10,852 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 16:09:10,854 - INFO - Performing online update...
2025-06-02 16:09:10,855 - INFO - Starting online update for 50 steps.
2025-06-02 16:09:10,855 - DEBUG - Updated RunningStats: new_mean=0.9455873259730645, new_var=34800000000161.363, new_n=3510
2025-06-02 16:09:10,855 - DEBUG - Updated RunningStats: new_mean=0.9438320168228291, new_var=35100000000018.305, new_n=3540
2025-06-02 16:09:10,856 - DEBUG - Updated RunningStats: new_mean=1.195806004802692, new_var=11600000000093.602, new_n=1170
2025-06-02 16:09:10,856 - DEBUG - Updated RunningStats: new_mean=1.1947810107321055, new_var=11700000000001.64, new_n=1180
2025-06-02 16:09:10,856 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-02 16:09:10,856 - DEBUG - Online update step: 1/50
2025-06-02 16:09:10,858 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:11,031 - DEBUG - Node anomaly scores shape: torch.Size([20356, 1])
2025-06-02 16:09:11,037 - DEBUG - Edge anomaly scores shape: torch.Size([43170, 1])
2025-06-02 16:09:11,038 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:11,222 - DEBUG - Step 1: Loss=0.5671
2025-06-02 16:09:11,222 - DEBUG - Online update step: 2/50
2025-06-02 16:09:11,225 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:11,376 - DEBUG - Node anomaly scores shape: torch.Size([21266, 1])
2025-06-02 16:09:11,383 - DEBUG - Edge anomaly scores shape: torch.Size([45132, 1])
2025-06-02 16:09:11,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:11,618 - DEBUG - Step 2: Loss=0.5694
2025-06-02 16:09:11,618 - DEBUG - Online update step: 3/50
2025-06-02 16:09:11,622 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:11,736 - DEBUG - Node anomaly scores shape: torch.Size([19894, 1])
2025-06-02 16:09:11,741 - DEBUG - Edge anomaly scores shape: torch.Size([42040, 1])
2025-06-02 16:09:11,742 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:11,957 - DEBUG - Step 3: Loss=0.5663
2025-06-02 16:09:11,957 - DEBUG - Online update step: 4/50
2025-06-02 16:09:11,960 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:12,089 - DEBUG - Node anomaly scores shape: torch.Size([22103, 1])
2025-06-02 16:09:12,097 - DEBUG - Edge anomaly scores shape: torch.Size([47277, 1])
2025-06-02 16:09:12,099 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:12,374 - DEBUG - Step 4: Loss=0.5694
2025-06-02 16:09:12,375 - DEBUG - Online update step: 5/50
2025-06-02 16:09:12,378 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:12,475 - DEBUG - Node anomaly scores shape: torch.Size([21496, 1])
2025-06-02 16:09:12,481 - DEBUG - Edge anomaly scores shape: torch.Size([45832, 1])
2025-06-02 16:09:12,482 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:12,710 - DEBUG - Step 5: Loss=0.5677
2025-06-02 16:09:12,711 - DEBUG - Online update step: 6/50
2025-06-02 16:09:12,717 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:12,847 - DEBUG - Node anomaly scores shape: torch.Size([21410, 1])
2025-06-02 16:09:12,853 - DEBUG - Edge anomaly scores shape: torch.Size([45685, 1])
2025-06-02 16:09:12,856 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:13,112 - DEBUG - Step 6: Loss=0.5693
2025-06-02 16:09:13,112 - DEBUG - Online update step: 7/50
2025-06-02 16:09:13,119 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:13,245 - DEBUG - Node anomaly scores shape: torch.Size([22640, 1])
2025-06-02 16:09:13,251 - DEBUG - Edge anomaly scores shape: torch.Size([48225, 1])
2025-06-02 16:09:13,252 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:13,514 - DEBUG - Step 7: Loss=0.5666
2025-06-02 16:09:13,515 - DEBUG - Online update step: 8/50
2025-06-02 16:09:13,518 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:13,627 - DEBUG - Node anomaly scores shape: torch.Size([23089, 1])
2025-06-02 16:09:13,633 - DEBUG - Edge anomaly scores shape: torch.Size([49218, 1])
2025-06-02 16:09:13,634 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:13,883 - DEBUG - Step 8: Loss=0.5690
2025-06-02 16:09:13,883 - DEBUG - Online update step: 9/50
2025-06-02 16:09:13,887 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:14,010 - DEBUG - Node anomaly scores shape: torch.Size([23582, 1])
2025-06-02 16:09:14,015 - DEBUG - Edge anomaly scores shape: torch.Size([50292, 1])
2025-06-02 16:09:14,017 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:14,275 - DEBUG - Step 9: Loss=0.5671
2025-06-02 16:09:14,275 - DEBUG - Online update step: 10/50
2025-06-02 16:09:14,282 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:14,388 - DEBUG - Node anomaly scores shape: torch.Size([19477, 1])
2025-06-02 16:09:14,393 - DEBUG - Edge anomaly scores shape: torch.Size([41095, 1])
2025-06-02 16:09:14,394 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:14,608 - DEBUG - Step 10: Loss=0.5698
2025-06-02 16:09:14,608 - DEBUG - Online update step: 11/50
2025-06-02 16:09:14,615 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:14,749 - DEBUG - Node anomaly scores shape: torch.Size([22511, 1])
2025-06-02 16:09:14,755 - DEBUG - Edge anomaly scores shape: torch.Size([47957, 1])
2025-06-02 16:09:14,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:15,023 - DEBUG - Step 11: Loss=0.5665
2025-06-02 16:09:15,023 - DEBUG - Online update step: 12/50
2025-06-02 16:09:15,027 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:15,165 - DEBUG - Node anomaly scores shape: torch.Size([21467, 1])
2025-06-02 16:09:15,171 - DEBUG - Edge anomaly scores shape: torch.Size([45852, 1])
2025-06-02 16:09:15,173 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:15,395 - DEBUG - Step 12: Loss=0.5690
2025-06-02 16:09:15,395 - DEBUG - Online update step: 13/50
2025-06-02 16:09:15,399 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:15,507 - DEBUG - Node anomaly scores shape: torch.Size([21284, 1])
2025-06-02 16:09:15,511 - DEBUG - Edge anomaly scores shape: torch.Size([45260, 1])
2025-06-02 16:09:15,512 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:15,724 - DEBUG - Step 13: Loss=0.5673
2025-06-02 16:09:15,724 - DEBUG - Online update step: 14/50
2025-06-02 16:09:15,728 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:15,862 - DEBUG - Node anomaly scores shape: torch.Size([21048, 1])
2025-06-02 16:09:15,868 - DEBUG - Edge anomaly scores shape: torch.Size([44598, 1])
2025-06-02 16:09:15,869 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:16,114 - DEBUG - Step 14: Loss=0.5695
2025-06-02 16:09:16,114 - DEBUG - Online update step: 15/50
2025-06-02 16:09:16,118 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:16,252 - DEBUG - Node anomaly scores shape: torch.Size([21882, 1])
2025-06-02 16:09:16,258 - DEBUG - Edge anomaly scores shape: torch.Size([46482, 1])
2025-06-02 16:09:16,259 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:16,494 - DEBUG - Step 15: Loss=0.5663
2025-06-02 16:09:16,494 - DEBUG - Online update step: 16/50
2025-06-02 16:09:16,498 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:16,615 - DEBUG - Node anomaly scores shape: torch.Size([21854, 1])
2025-06-02 16:09:16,621 - DEBUG - Edge anomaly scores shape: torch.Size([46363, 1])
2025-06-02 16:09:16,622 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:16,885 - DEBUG - Step 16: Loss=0.5686
2025-06-02 16:09:16,886 - DEBUG - Online update step: 17/50
2025-06-02 16:09:16,892 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:17,015 - DEBUG - Node anomaly scores shape: torch.Size([21059, 1])
2025-06-02 16:09:17,020 - DEBUG - Edge anomaly scores shape: torch.Size([44538, 1])
2025-06-02 16:09:17,022 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:17,241 - DEBUG - Step 17: Loss=0.5674
2025-06-02 16:09:17,241 - DEBUG - Online update step: 18/50
2025-06-02 16:09:17,244 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:17,355 - DEBUG - Node anomaly scores shape: torch.Size([20153, 1])
2025-06-02 16:09:17,360 - DEBUG - Edge anomaly scores shape: torch.Size([42713, 1])
2025-06-02 16:09:17,361 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:17,576 - DEBUG - Step 18: Loss=0.5699
2025-06-02 16:09:17,576 - DEBUG - Online update step: 19/50
2025-06-02 16:09:17,579 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:17,703 - DEBUG - Node anomaly scores shape: torch.Size([20856, 1])
2025-06-02 16:09:17,709 - DEBUG - Edge anomaly scores shape: torch.Size([43981, 1])
2025-06-02 16:09:17,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:17,972 - DEBUG - Step 19: Loss=0.5666
2025-06-02 16:09:17,973 - DEBUG - Online update step: 20/50
2025-06-02 16:09:17,979 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:18,105 - DEBUG - Node anomaly scores shape: torch.Size([23569, 1])
2025-06-02 16:09:18,111 - DEBUG - Edge anomaly scores shape: torch.Size([50509, 1])
2025-06-02 16:09:18,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:18,371 - DEBUG - Step 20: Loss=0.5689
2025-06-02 16:09:18,371 - DEBUG - Online update step: 21/50
2025-06-02 16:09:18,375 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:18,490 - DEBUG - Node anomaly scores shape: torch.Size([21366, 1])
2025-06-02 16:09:18,495 - DEBUG - Edge anomaly scores shape: torch.Size([45223, 1])
2025-06-02 16:09:18,496 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:18,755 - DEBUG - Step 21: Loss=0.5673
2025-06-02 16:09:18,756 - DEBUG - Online update step: 22/50
2025-06-02 16:09:18,762 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:18,902 - DEBUG - Node anomaly scores shape: torch.Size([23461, 1])
2025-06-02 16:09:18,908 - DEBUG - Edge anomaly scores shape: torch.Size([50180, 1])
2025-06-02 16:09:18,909 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:19,198 - DEBUG - Step 22: Loss=0.5696
2025-06-02 16:09:19,199 - DEBUG - Online update step: 23/50
2025-06-02 16:09:19,204 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:19,316 - DEBUG - Node anomaly scores shape: torch.Size([23564, 1])
2025-06-02 16:09:19,322 - DEBUG - Edge anomaly scores shape: torch.Size([50266, 1])
2025-06-02 16:09:19,325 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:19,609 - DEBUG - Step 23: Loss=0.5662
2025-06-02 16:09:19,609 - DEBUG - Online update step: 24/50
2025-06-02 16:09:19,615 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:19,720 - DEBUG - Node anomaly scores shape: torch.Size([21695, 1])
2025-06-02 16:09:19,726 - DEBUG - Edge anomaly scores shape: torch.Size([46034, 1])
2025-06-02 16:09:19,727 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:19,973 - DEBUG - Step 24: Loss=0.5689
2025-06-02 16:09:19,973 - DEBUG - Online update step: 25/50
2025-06-02 16:09:19,977 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:20,089 - DEBUG - Node anomaly scores shape: torch.Size([21687, 1])
2025-06-02 16:09:20,094 - DEBUG - Edge anomaly scores shape: torch.Size([46097, 1])
2025-06-02 16:09:20,095 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:20,321 - DEBUG - Step 25: Loss=0.5672
2025-06-02 16:09:20,321 - DEBUG - Online update step: 26/50
2025-06-02 16:09:20,325 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:20,448 - DEBUG - Node anomaly scores shape: torch.Size([21857, 1])
2025-06-02 16:09:20,455 - DEBUG - Edge anomaly scores shape: torch.Size([46358, 1])
2025-06-02 16:09:20,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:20,736 - DEBUG - Step 26: Loss=0.5689
2025-06-02 16:09:20,736 - DEBUG - Online update step: 27/50
2025-06-02 16:09:20,740 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:20,872 - DEBUG - Node anomaly scores shape: torch.Size([22103, 1])
2025-06-02 16:09:20,879 - DEBUG - Edge anomaly scores shape: torch.Size([46919, 1])
2025-06-02 16:09:20,881 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:21,160 - DEBUG - Step 27: Loss=0.5663
2025-06-02 16:09:21,161 - DEBUG - Online update step: 28/50
2025-06-02 16:09:21,164 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:21,316 - DEBUG - Node anomaly scores shape: torch.Size([23703, 1])
2025-06-02 16:09:21,323 - DEBUG - Edge anomaly scores shape: torch.Size([50624, 1])
2025-06-02 16:09:21,324 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:21,623 - DEBUG - Step 28: Loss=0.5691
2025-06-02 16:09:21,623 - DEBUG - Online update step: 29/50
2025-06-02 16:09:21,631 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:21,742 - DEBUG - Node anomaly scores shape: torch.Size([20504, 1])
2025-06-02 16:09:21,747 - DEBUG - Edge anomaly scores shape: torch.Size([43414, 1])
2025-06-02 16:09:21,748 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:22,020 - DEBUG - Step 29: Loss=0.5673
2025-06-02 16:09:22,021 - DEBUG - Online update step: 30/50
2025-06-02 16:09:22,027 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:22,157 - DEBUG - Node anomaly scores shape: torch.Size([23606, 1])
2025-06-02 16:09:22,164 - DEBUG - Edge anomaly scores shape: torch.Size([50316, 1])
2025-06-02 16:09:22,166 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:22,416 - DEBUG - Step 30: Loss=0.5693
2025-06-02 16:09:22,416 - DEBUG - Online update step: 31/50
2025-06-02 16:09:22,420 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:22,524 - DEBUG - Node anomaly scores shape: torch.Size([21466, 1])
2025-06-02 16:09:22,529 - DEBUG - Edge anomaly scores shape: torch.Size([45654, 1])
2025-06-02 16:09:22,530 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:22,783 - DEBUG - Step 31: Loss=0.5664
2025-06-02 16:09:22,784 - DEBUG - Online update step: 32/50
2025-06-02 16:09:22,791 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:22,915 - DEBUG - Node anomaly scores shape: torch.Size([21426, 1])
2025-06-02 16:09:22,920 - DEBUG - Edge anomaly scores shape: torch.Size([45212, 1])
2025-06-02 16:09:22,922 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:23,168 - DEBUG - Step 32: Loss=0.5687
2025-06-02 16:09:23,169 - DEBUG - Online update step: 33/50
2025-06-02 16:09:23,176 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:23,286 - DEBUG - Node anomaly scores shape: torch.Size([22362, 1])
2025-06-02 16:09:23,292 - DEBUG - Edge anomaly scores shape: torch.Size([47445, 1])
2025-06-02 16:09:23,293 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:23,555 - DEBUG - Step 33: Loss=0.5673
2025-06-02 16:09:23,555 - DEBUG - Online update step: 34/50
2025-06-02 16:09:23,558 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:23,671 - DEBUG - Node anomaly scores shape: torch.Size([21225, 1])
2025-06-02 16:09:23,676 - DEBUG - Edge anomaly scores shape: torch.Size([44972, 1])
2025-06-02 16:09:23,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:23,921 - DEBUG - Step 34: Loss=0.5691
2025-06-02 16:09:23,921 - DEBUG - Online update step: 35/50
2025-06-02 16:09:23,927 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:24,032 - DEBUG - Node anomaly scores shape: torch.Size([19684, 1])
2025-06-02 16:09:24,037 - DEBUG - Edge anomaly scores shape: torch.Size([41566, 1])
2025-06-02 16:09:24,039 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:24,263 - DEBUG - Step 35: Loss=0.5665
2025-06-02 16:09:24,263 - DEBUG - Online update step: 36/50
2025-06-02 16:09:24,269 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:24,388 - DEBUG - Node anomaly scores shape: torch.Size([21114, 1])
2025-06-02 16:09:24,393 - DEBUG - Edge anomaly scores shape: torch.Size([44528, 1])
2025-06-02 16:09:24,395 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:24,645 - DEBUG - Step 36: Loss=0.5689
2025-06-02 16:09:24,646 - DEBUG - Online update step: 37/50
2025-06-02 16:09:24,651 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:24,761 - DEBUG - Node anomaly scores shape: torch.Size([20575, 1])
2025-06-02 16:09:24,766 - DEBUG - Edge anomaly scores shape: torch.Size([43627, 1])
2025-06-02 16:09:24,768 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:25,015 - DEBUG - Step 37: Loss=0.5672
2025-06-02 16:09:25,015 - DEBUG - Online update step: 38/50
2025-06-02 16:09:25,019 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:25,135 - DEBUG - Node anomaly scores shape: torch.Size([22701, 1])
2025-06-02 16:09:25,141 - DEBUG - Edge anomaly scores shape: torch.Size([48449, 1])
2025-06-02 16:09:25,142 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:25,377 - DEBUG - Step 38: Loss=0.5693
2025-06-02 16:09:25,378 - DEBUG - Online update step: 39/50
2025-06-02 16:09:25,381 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:25,491 - DEBUG - Node anomaly scores shape: torch.Size([19846, 1])
2025-06-02 16:09:25,496 - DEBUG - Edge anomaly scores shape: torch.Size([42002, 1])
2025-06-02 16:09:25,497 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:25,690 - DEBUG - Step 39: Loss=0.5670
2025-06-02 16:09:25,690 - DEBUG - Online update step: 40/50
2025-06-02 16:09:25,694 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:25,835 - DEBUG - Node anomaly scores shape: torch.Size([23625, 1])
2025-06-02 16:09:25,844 - DEBUG - Edge anomaly scores shape: torch.Size([50482, 1])
2025-06-02 16:09:25,846 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:26,120 - DEBUG - Step 40: Loss=0.5690
2025-06-02 16:09:26,120 - DEBUG - Online update step: 41/50
2025-06-02 16:09:26,124 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:26,252 - DEBUG - Node anomaly scores shape: torch.Size([23335, 1])
2025-06-02 16:09:26,262 - DEBUG - Edge anomaly scores shape: torch.Size([49766, 1])
2025-06-02 16:09:26,263 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:26,532 - DEBUG - Step 41: Loss=0.5669
2025-06-02 16:09:26,533 - DEBUG - Online update step: 42/50
2025-06-02 16:09:26,536 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:26,647 - DEBUG - Node anomaly scores shape: torch.Size([23047, 1])
2025-06-02 16:09:26,653 - DEBUG - Edge anomaly scores shape: torch.Size([49021, 1])
2025-06-02 16:09:26,654 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:26,894 - DEBUG - Step 42: Loss=0.5689
2025-06-02 16:09:26,894 - DEBUG - Online update step: 43/50
2025-06-02 16:09:26,897 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:27,012 - DEBUG - Node anomaly scores shape: torch.Size([21271, 1])
2025-06-02 16:09:27,018 - DEBUG - Edge anomaly scores shape: torch.Size([45249, 1])
2025-06-02 16:09:27,019 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:27,235 - DEBUG - Step 43: Loss=0.5663
2025-06-02 16:09:27,236 - DEBUG - Online update step: 44/50
2025-06-02 16:09:27,239 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:27,364 - DEBUG - Node anomaly scores shape: torch.Size([21589, 1])
2025-06-02 16:09:27,369 - DEBUG - Edge anomaly scores shape: torch.Size([45923, 1])
2025-06-02 16:09:27,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:27,613 - DEBUG - Step 44: Loss=0.5690
2025-06-02 16:09:27,613 - DEBUG - Online update step: 45/50
2025-06-02 16:09:27,617 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:27,753 - DEBUG - Node anomaly scores shape: torch.Size([22809, 1])
2025-06-02 16:09:27,765 - DEBUG - Edge anomaly scores shape: torch.Size([48440, 1])
2025-06-02 16:09:27,766 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:28,039 - DEBUG - Step 45: Loss=0.5670
2025-06-02 16:09:28,039 - DEBUG - Online update step: 46/50
2025-06-02 16:09:28,043 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:28,155 - DEBUG - Node anomaly scores shape: torch.Size([20782, 1])
2025-06-02 16:09:28,160 - DEBUG - Edge anomaly scores shape: torch.Size([44076, 1])
2025-06-02 16:09:28,161 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:28,384 - DEBUG - Step 46: Loss=0.5693
2025-06-02 16:09:28,385 - DEBUG - Online update step: 47/50
2025-06-02 16:09:28,392 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:28,525 - DEBUG - Node anomaly scores shape: torch.Size([21726, 1])
2025-06-02 16:09:28,530 - DEBUG - Edge anomaly scores shape: torch.Size([46377, 1])
2025-06-02 16:09:28,532 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:28,771 - DEBUG - Step 47: Loss=0.5671
2025-06-02 16:09:28,771 - DEBUG - Online update step: 48/50
2025-06-02 16:09:28,778 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:28,909 - DEBUG - Node anomaly scores shape: torch.Size([23295, 1])
2025-06-02 16:09:28,916 - DEBUG - Edge anomaly scores shape: torch.Size([49583, 1])
2025-06-02 16:09:28,918 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:29,166 - DEBUG - Step 48: Loss=0.5691
2025-06-02 16:09:29,166 - DEBUG - Online update step: 49/50
2025-06-02 16:09:29,172 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:29,288 - DEBUG - Node anomaly scores shape: torch.Size([22582, 1])
2025-06-02 16:09:29,294 - DEBUG - Edge anomaly scores shape: torch.Size([48038, 1])
2025-06-02 16:09:29,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:29,538 - DEBUG - Step 49: Loss=0.5669
2025-06-02 16:09:29,538 - DEBUG - Online update step: 50/50
2025-06-02 16:09:29,541 - DEBUG - Sampled batch from replay buffer (size: 32 graphs).
2025-06-02 16:09:29,662 - DEBUG - Node anomaly scores shape: torch.Size([21848, 1])
2025-06-02 16:09:29,668 - DEBUG - Edge anomaly scores shape: torch.Size([46566, 1])
2025-06-02 16:09:29,669 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 16:09:29,890 - DEBUG - Step 50: Loss=0.5687
2025-06-02 16:09:29,891 - INFO - Online update finished. Average loss: 0.5680, Learning rate: 0.001000
2025-06-02 16:09:29,892 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], current edge mean: [ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:09:29,892 - DEBUG - Node drift difference: 0.0000, Edge drift difference: 0.0000
2025-06-02 16:09:29,893 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -3.7769281e-09  3.7769281e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.3177979e-09
  1.5107712e-08  4.2962554e-08  9.4423198e-09  8.4980876e-09
  2.2504950e+00  2.9623764e+00  1.4455445e-01  4.3970299e+00
 -3.9185629e-08  3.4217823e+00  5.7663364e+00  7.6217823e+00
  1.4455445e-01  7.9930692e+00 -2.0773104e-08  3.3048121e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  7.7899136e-09  2.9743308e-08], edge=[ 9.1477480e+00  1.4220721e+00  5.7004504e+00 -1.7183321e-09
  1.1813533e-09  0.0000000e+00 -1.2887491e-09  0.0000000e+00
 -3.4366643e-09  0.0000000e+00]
2025-06-02 16:09:29,893 - DEBUG - Updated reference std: node=[0.         0.         1.0004954  1.0004954  0.         0.
 0.         1.0004954  1.0004954  1.0004954  1.0004954  1.0004954
 0.9515647  0.27185503 0.3656389  0.5734384  1.0004954  3.019317
 2.9117947  1.4683717  0.3656389  0.22026087 1.0004954  1.0004954
 0.         0.         0.         0.         1.0004954  1.0004954 ], edge=[1.1025676 0.5057214 2.138701  1.0002253 1.0002253 1.0002253 1.0002253
 1.0002253 1.0002253 1.0002253]
2025-06-02 16:09:29,894 - INFO - Online update complete. Loss: 0.5680
2025-06-02 16:09:29,894 - INFO - Running anomaly detection...
2025-06-02 16:09:29,894 - INFO - Starting anomaly detection.
2025-06-02 16:09:29,900 - DEBUG - Node reconstruction errors: [0.00887653 0.06854431 0.05188526 ... 0.00234703 0.00234703 0.00234703]
2025-06-02 16:09:29,900 - DEBUG - Edge reconstruction errors: [1.363853   1.3613487  0.9575833  ... 0.15756765 1.2584579  0.15756765]
2025-06-02 16:09:29,902 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250602_160929_update_60.json
2025-06-02 16:09:29,902 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-02 16:09:29,911 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250602_160929_update_60.pth and as latest_checkpoint.pth
2025-06-02 16:09:29,912 - INFO - 
Global anomaly score (after nw_graph_encoded_1748870895.dot): 0.1348
2025-06-02 16:09:29,912 - WARNING - Detected 14 anomalous nodes (reconstruction-based):
2025-06-02 16:09:29,912 - WARNING -   Node ID: 192.168.239.101, Recon Error: 0.0685, MLP Score: 0.5001
2025-06-02 16:09:29,912 - WARNING -   Node ID: 192.168.27.12, Recon Error: 0.1998, MLP Score: 0.5009
2025-06-02 16:09:29,912 - WARNING -   Node ID: 192.168.27.10, Recon Error: 0.1063, MLP Score: 0.4916
2025-06-02 16:09:29,912 - WARNING -   Node ID: 150.171.28.10, Recon Error: 0.0777, MLP Score: 0.4818
2025-06-02 16:09:29,912 - WARNING -   Node ID: 34.107.152.202, Recon Error: 0.0776, MLP Score: 0.4847
2025-06-02 16:09:29,912 - WARNING - Detected 10 anomalous edges (reconstruction-based):
2025-06-02 16:09:29,912 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 20.3600, MLP Score: 0.4912
2025-06-02 16:09:29,912 - WARNING -   Source: 192.168.27.13, Target: 1.1.1.1, Recon Error: 19.8725, MLP Score: 0.4704
2025-06-02 16:09:29,912 - WARNING -   Source: 192.168.27.13, Target: 172.67.14.191, Recon Error: 3.4487, MLP Score: 0.4833
2025-06-02 16:09:29,913 - WARNING -   Source: 192.168.27.13, Target: 4.153.72.49, Recon Error: 6.3451, MLP Score: 0.4706
2025-06-02 16:09:29,913 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 4.7291, MLP Score: 0.4760
2025-06-02 16:09:29,913 - INFO - Finished processing all files in the directory.
