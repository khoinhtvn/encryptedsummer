2025-06-02 10:51:51,933 - INFO - Application logging to file: logs/app_20250602_105151.log
2025-06-02 10:51:51,933 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-02 10:51:51,934 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/
2025-06-02 10:51:51,934 - INFO - 
--- Processing file: nw_graph_encoded_1748706078.dot (Timestamp: 2025-05-31 17:41:18) ---
2025-06-02 10:51:51,934 - INFO - Processing update file: /home/lu/Desktop/output/nw_graph_encoded_1748706078.dot
2025-06-02 10:51:51,934 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748706078.dot
2025-06-02 10:51:51,939 - INFO - Parsed 170 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748706078.dot'.
2025-06-02 10:51:51,946 - INFO - Parsed 986 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748706078.dot'.
2025-06-02 10:51:51,946 - INFO - Starting NetworkX to PyG conversion.
2025-06-02 10:51:51,946 - DEBUG - Sorted node attribute keys: ['encoded_feature_count', 'ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_seconds', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_seconds', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-02 10:51:51,948 - DEBUG - Initial node features tensor shape: torch.Size([170, 29])
2025-06-02 10:51:51,948 - ERROR - Error during node standard scaling: name 'np' is not defined
2025-06-02 10:51:51,948 - DEBUG - Node features tensor shape after scaling: torch.Size([170, 29])
2025-06-02 10:51:51,950 - DEBUG - Edge index tensor shape: torch.Size([2, 986])
2025-06-02 10:51:51,952 - DEBUG - Sorted edge attribute keys: ['conn_state_partial_other_unknown', 'conn_state_rejected_reset', 'conn_state_successful', 'protocol_ICMP', 'protocol_TCP', 'protocol_UDP', 'protocol_UNKNOWN']
2025-06-02 10:51:51,958 - DEBUG - Initial edge attributes tensor shape: torch.Size([986, 7])
2025-06-02 10:51:51,958 - INFO - No edge feature scaling applied.
2025-06-02 10:51:51,958 - DEBUG - Edge attributes tensor shape after scaling: torch.Size([986, 7])
2025-06-02 10:51:51,959 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-02 10:51:51,959 - INFO - Initialized main graph with 170 nodes and 986 edges.
2025-06-02 10:51:51,959 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=29, edge_dim=7, hidden_dim=64, embedding_dim=32, heads=4
2025-06-02 10:51:51,959 - INFO - Initializing GraphAutoencoder with node_dim=29, edge_dim=7, hidden_dim=64, embedding_dim=32
2025-06-02 10:51:52,032 - DEBUG - Encoder GATConv layers initialized: conv1 out_channels=256, conv2 out_channels=32
2025-06-02 10:51:52,033 - DEBUG - Decoder MLP layers initialized.
2025-06-02 10:51:52,034 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-02 10:51:52,035 - INFO - Optimizer and scheduler initialized.
2025-06-02 10:51:52,035 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-02 10:51:52,035 - INFO - RunningStats initialized.
2025-06-02 10:51:52,035 - INFO - RunningStats initialized.
2025-06-02 10:51:52,035 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-02 10:51:52,035 - INFO - Embedding export will occur every 5 updates, saving to vis
2025-06-02 10:51:52,036 - INFO - Using device: cpu
2025-06-02 10:51:52,036 - INFO - Initialized Hybrid GNN (node_dim=29, edge_dim=7)
2025-06-02 10:51:52,036 - INFO - Performing initial training for 50 epochs...
2025-06-02 10:51:52,384 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:52,406 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:52,456 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:53,102 - INFO - Epoch 1/50, Loss: 170135113567305728.0000
2025-06-02 10:51:53,191 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:53,191 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:53,192 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:53,467 - INFO - Epoch 2/50, Loss: 167506662301630464.0000
2025-06-02 10:51:53,993 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:54,030 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:54,113 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:54,598 - INFO - Epoch 3/50, Loss: 164533222082871296.0000
2025-06-02 10:51:55,146 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:55,177 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:55,254 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:55,847 - INFO - Epoch 4/50, Loss: 161652398538883072.0000
2025-06-02 10:51:56,391 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:56,439 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:56,552 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:57,356 - INFO - Epoch 5/50, Loss: 158921641152217088.0000
2025-06-02 10:51:57,800 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:57,810 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:57,863 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:58,442 - INFO - Epoch 6/50, Loss: 156189114239025152.0000
2025-06-02 10:51:58,815 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:58,835 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:58,886 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:51:59,524 - INFO - Epoch 7/50, Loss: 153832087726587904.0000
2025-06-02 10:51:59,735 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:51:59,742 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:51:59,743 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:00,014 - INFO - Epoch 8/50, Loss: 152130524763127808.0000
2025-06-02 10:52:00,194 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:00,210 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:00,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:00,644 - INFO - Epoch 9/50, Loss: 150133210351665152.0000
2025-06-02 10:52:00,675 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:00,676 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:00,687 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:01,182 - INFO - Epoch 10/50, Loss: 148258920983429120.0000
2025-06-02 10:52:01,540 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:01,567 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:01,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:02,199 - INFO - Epoch 11/50, Loss: 146252862018551808.0000
2025-06-02 10:52:02,611 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:02,635 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:02,684 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:03,300 - INFO - Epoch 12/50, Loss: 144134377989734400.0000
2025-06-02 10:52:03,678 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:03,700 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:03,725 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:04,226 - INFO - Epoch 13/50, Loss: 141833538239463424.0000
2025-06-02 10:52:04,604 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:04,628 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:04,678 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:05,058 - INFO - Epoch 14/50, Loss: 139434043090403328.0000
2025-06-02 10:52:05,110 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:05,114 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:05,121 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:05,631 - INFO - Epoch 15/50, Loss: 136881724415016960.0000
2025-06-02 10:52:06,034 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:06,066 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:06,132 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:06,771 - INFO - Epoch 16/50, Loss: 134253453537968128.0000
2025-06-02 10:52:07,143 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:07,175 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:07,221 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:07,715 - INFO - Epoch 17/50, Loss: 131380670172758016.0000
2025-06-02 10:52:07,825 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:07,828 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:07,829 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:08,328 - INFO - Epoch 18/50, Loss: 128351738976534528.0000
2025-06-02 10:52:08,623 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:08,639 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:08,688 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,191 - INFO - Epoch 19/50, Loss: 125178823296679936.0000
2025-06-02 10:52:09,530 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,554 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,786 - INFO - Epoch 20/50, Loss: 121768163997122560.0000
2025-06-02 10:52:09,794 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,795 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,796 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,810 - INFO - Epoch 21/50, Loss: 118424222719541248.0000
2025-06-02 10:52:09,817 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,819 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,820 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,842 - INFO - Epoch 22/50, Loss: 114937542498844672.0000
2025-06-02 10:52:09,849 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,850 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,851 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,859 - INFO - Epoch 23/50, Loss: 111291115264540672.0000
2025-06-02 10:52:09,867 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,868 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,868 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,923 - INFO - Epoch 24/50, Loss: 107572661428682752.0000
2025-06-02 10:52:09,936 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,937 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,938 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:09,964 - INFO - Epoch 25/50, Loss: 103770627529244672.0000
2025-06-02 10:52:09,980 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:09,982 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:09,984 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,176 - INFO - Epoch 26/50, Loss: 99808975465218048.0000
2025-06-02 10:52:10,234 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,239 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,241 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,538 - INFO - Epoch 27/50, Loss: 95666393608880128.0000
2025-06-02 10:52:10,543 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,544 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,545 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,595 - INFO - Epoch 28/50, Loss: 91412151192780800.0000
2025-06-02 10:52:10,600 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,601 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,601 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,650 - INFO - Epoch 29/50, Loss: 87103886678032384.0000
2025-06-02 10:52:10,656 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,657 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,667 - INFO - Epoch 30/50, Loss: 82641982593171456.0000
2025-06-02 10:52:10,676 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,677 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,688 - INFO - Epoch 31/50, Loss: 78142437414928384.0000
2025-06-02 10:52:10,693 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,694 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,694 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,739 - INFO - Epoch 32/50, Loss: 73617165382582272.0000
2025-06-02 10:52:10,747 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,751 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,751 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,820 - INFO - Epoch 33/50, Loss: 68943566654668800.0000
2025-06-02 10:52:10,827 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,828 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,828 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-02 10:52:10,876 - INFO - Epoch 34/50, Loss: 64218303765151744.0000
2025-06-02 10:52:10,882 - DEBUG - Node anomaly scores shape: torch.Size([170, 1])
2025-06-02 10:52:10,883 - DEBUG - Edge anomaly scores shape: torch.Size([986, 1])
2025-06-02 10:52:10,883 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
