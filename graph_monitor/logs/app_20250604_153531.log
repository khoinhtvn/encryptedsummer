2025-06-04 15:35:31,723 - INFO - Application logging to file: logs/app_20250604_153531.log
2025-06-04 15:35:31,723 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-04 15:35:31,723 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-04 15:35:31,723 - INFO - Train Mode: train, Visualization Path: vis
2025-06-04 15:35:31,726 - INFO - Found 1406 files to process.
2025-06-04 15:35:31,726 - INFO - 
--- Processing file: nw_graph_encoded_1749028219.dot ---
2025-06-04 15:35:31,726 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot
2025-06-04 15:35:31,726 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028219.dot file.
2025-06-04 15:35:31,726 - INFO - Parsed 13 nodes.
2025-06-04 15:35:31,726 - INFO - Parsed 15 edges.
2025-06-04 15:35:31,727 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:31,727 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:31,727 - DEBUG - Initial node features tensor shape: torch.Size([13, 19])
2025-06-04 15:35:31,728 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:31,729 - DEBUG - Node features tensor shape after scaling: torch.Size([13, 19])
2025-06-04 15:35:31,729 - DEBUG - Edge index tensor shape: torch.Size([2, 15])
2025-06-04 15:35:31,729 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:31,729 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:35:31,730 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:35:31,730 - DEBUG - Shape of encoded categorical edge features: torch.Size([15, 2])
2025-06-04 15:35:31,730 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:31,730 - DEBUG - Shape of scaled numerical edge features: torch.Size([15, 20])
2025-06-04 15:35:31,731 - DEBUG - Final edge attributes tensor shape: torch.Size([15, 22])
2025-06-04 15:35:31,731 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:31,731 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-04 15:35:31,731 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-04 15:35:31,780 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-04 15:35:31,782 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-04 15:35:31,784 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-04 15:35:31,784 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-04 15:35:31,784 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-04 15:35:31,784 - INFO - RunningStats initialized.
2025-06-04 15:35:31,784 - INFO - RunningStats initialized.
2025-06-04 15:35:31,784 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-04 15:35:31,785 - INFO - Using device: cpu
2025-06-04 15:35:31,785 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-04 15:35:31,815 - INFO - Checkpoint loaded from model_checkpoints/latest_checkpoint.pth at epoch 2
2025-06-04 15:35:31,815 - INFO - Resuming online updates from step: 2
2025-06-04 15:35:31,815 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-04 15:35:31,815 - INFO - Performing online update...
2025-06-04 15:35:31,815 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:31,816 - DEBUG - Updated RunningStats: new_mean=[ 5.34474558e-10 -5.19796293e-10 -2.68532214e-09  2.48946690e-09
 -2.75697549e-08  1.52382510e-08 -1.07174387e-08 -2.37997693e-09
 -3.13383936e-09  8.19102615e-10  1.61692473e-09 -1.68785284e-09
  4.08042816e-09 -3.41406549e-09  9.24033950e-10  9.18657488e-10
 -3.92724401e-09  1.40650421e-09 -5.25294361e-09], new_M2=[179783.00530757 179783.00523874 179783.00044972 179783.00436551
 179782.99865682 179782.99836197 179782.99586767 179782.99837014
 179782.99315194 179782.99817391 179783.00201377 179782.99364819
 179782.992499   140031.99643628 140032.00026795 140031.99903983
 140032.00007233 179783.00042583 179783.00760021], new_n=179783
2025-06-04 15:35:31,817 - DEBUG - Updated RunningStats: new_mean=[ 1.41763115e+00  5.52523446e+00  1.17891805e-10  3.03051639e-10
  1.61928286e-10 -1.75743435e-10 -1.30687056e-09  2.39582712e-10
  2.65296243e-10 -2.94830062e-10  3.59136296e-10 -3.80421750e-09
 -9.51941418e-10  6.42565084e-10  3.58105304e-10 -1.70816239e-10
 -1.70816239e-10 -1.70816239e-10 -1.70816239e-10 -1.70816239e-10
 -1.70816239e-10 -7.45320252e-11], new_M2=[  99624.75007472 1723594.85366385  388119.999042    388120.00641529
  388120.00549505  388119.99334929  388120.0003553   388119.99902662
  388120.00172451  388119.99938608  388119.99310784  388120.00869598
  388120.00114715  388119.99975168  388120.00177251  388119.99445109
  388119.99445109  388119.99445109  388119.99445109  388119.99445109
  388119.99445109  388119.99936196], new_n=388120
2025-06-04 15:35:31,817 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88255002 0.88255003 0.88255003 0.88255003 1.
 1.00000002]
2025-06-04 15:35:31,817 - DEBUG - Calculated standard deviation: [0.50664133 2.10733987 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:31,817 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:31,817 - DEBUG - Online update step: 1/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,817 - DEBUG - Online update step: 2/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,817 - DEBUG - Online update step: 3/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,817 - DEBUG - Online update step: 4/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,817 - DEBUG - Online update step: 5/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,817 - DEBUG - Online update step: 6/50
2025-06-04 15:35:31,817 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 7/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 8/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 9/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 10/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 11/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 12/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 13/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 14/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 15/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 16/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 17/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 18/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 19/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 20/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 21/50
2025-06-04 15:35:31,818 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,818 - DEBUG - Online update step: 22/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 23/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 24/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 25/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 26/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 27/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 28/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 29/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 30/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 31/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 32/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 33/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 34/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 35/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 36/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 37/50
2025-06-04 15:35:31,819 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,819 - DEBUG - Online update step: 38/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 39/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 40/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 41/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 42/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 43/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 44/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 45/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 46/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 47/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 48/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 49/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - DEBUG - Online update step: 50/50
2025-06-04 15:35:31,820 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:31,820 - WARNING - No successful steps during online update.
2025-06-04 15:35:31,821 - DEBUG - Current node mean: [-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], current edge mean: [ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 15:35:31,821 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4033
2025-06-04 15:35:31,821 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:35:31,821 - DEBUG - Updated reference mean: node=[-9.1699457e-09  9.1699457e-09  9.1699457e-09  0.0000000e+00
 -9.1699457e-09  9.1699457e-09 -2.7509836e-08  9.1699457e-09
 -3.4387295e-09  0.0000000e+00  9.1699457e-09 -9.1699457e-09
  9.1699457e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.3754918e-08  9.1699457e-09], edge=[ 2.0000000e-01  2.2000000e+00 -1.5894573e-08 -7.9472864e-09
  1.9868216e-09 -1.1920929e-08  1.5894573e-08  0.0000000e+00
  1.1920929e-08  1.5894573e-08  2.3841858e-08  1.1920929e-08
  3.9736432e-09 -2.3841858e-08  7.9472864e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  3.9736432e-09]
2025-06-04 15:35:31,822 - DEBUG - Updated reference std: node=[1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833 1.040833
 1.040833 1.040833 1.040833 1.040833 1.040833 0.       0.       0.
 0.       1.040833 1.040833], edge=[0.41403934 1.6124516  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983  1.0350983  1.0350983
 1.0350983  1.0350983  1.0350983  1.0350983 ]
2025-06-04 15:35:31,822 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:31,822 - INFO - Running anomaly detection...
2025-06-04 15:35:31,822 - INFO - Starting anomaly detection.
2025-06-04 15:35:32,285 - DEBUG - Node reconstruction errors: [0.07355527 0.08192086 0.08192095 0.07355537 0.36360836 0.47969657
 0.40595096 0.28280684 0.08192104 0.08192081 0.9514917  0.08192105
 0.89784694]
2025-06-04 15:35:32,285 - DEBUG - Edge reconstruction errors: [0.19998747 0.19998819 0.70493174 0.78112996 0.7997163  0.79779494
 0.7997091  0.7501874  0.7455566  0.7547384  0.79753345 0.790026
 0.7871708  0.79325336 0.7575994 ]
2025-06-04 15:35:32,351 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153532_update_1.json
2025-06-04 15:35:32,352 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:32,395 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153532_update_1.pth and as latest_checkpoint.pth
2025-06-04 15:35:32,395 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028219.dot): 0.0000
2025-06-04 15:35:32,396 - INFO - No significant node anomalies detected (reconstruction-based)
2025-06-04 15:35:32,396 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:32,773 - INFO - Starting 3D embedding visualization...
2025-06-04 15:35:32,775 - ERROR - Error during 3D t-SNE or plotting: perplexity must be less than n_samples
2025-06-04 15:35:32,776 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 46, in visualize_embeddings_3d
    reduced_embeddings = tsne.fit_transform(embeddings)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/utils/_set_output.py", line 319, in wrapped
    data_to_wrap = f(self, X, *args, **kwargs)
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/base.py", line 1389, in wrapper
    return fit_method(estimator, *args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 1177, in fit_transform
    self._check_params_vs_input(X)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/sklearn/manifold/_t_sne.py", line 862, in _check_params_vs_input
    raise ValueError("perplexity must be less than n_samples")
ValueError: perplexity must be less than n_samples

2025-06-04 15:35:32,780 - INFO - Performing visualization of node and edge features.
2025-06-04 15:35:32,780 - INFO - Starting visualization of node features.
2025-06-04 15:35:32,780 - INFO - Graph has 13 nodes and 19 features.
2025-06-04 15:35:32,780 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:35:32,780 - INFO - Calculating feature statistics:
2025-06-04 15:35:32,781 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 15:35:32,781 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 15:35:32,781 - INFO - - server_score: {'name': 'server_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.4013742), 'max': np.float32(2.4682057)}
2025-06-04 15:35:32,781 - INFO - - client_score: {'name': 'client_score', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.51907015), 'max': np.float32(2.5818622)}
2025-06-04 15:35:32,781 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(1.8339891e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42640144), 'max': np.float32(2.345208)}
2025-06-04 15:35:32,782 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 3, 'mean': np.float32(3.6679783e-08), 'std': np.float32(1.0), 'min': np.float32(-0.42617667), 'max': np.float32(2.4267406)}
2025-06-04 15:35:32,782 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.503131), 'max': np.float32(0.42553222)}
2025-06-04 15:35:32,782 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.4602873), 'max': np.float32(3.1299536)}
2025-06-04 15:35:32,782 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.89260745), 'max': np.float32(3.2516413)}
2025-06-04 15:35:32,782 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 4, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.5204165), 'max': np.float32(2.6020825)}
2025-06-04 15:35:32,782 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 3, 'mean': np.float32(-9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.7344548), 'max': np.float32(0.63900965)}
2025-06-04 15:35:32,782 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.5477226), 'max': np.float32(1.8257419)}
2025-06-04 15:35:32,783 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.8257419), 'max': np.float32(0.5477226)}
2025-06-04 15:35:32,783 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:35:32,783 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:35:32,783 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:35:32,783 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-04 15:35:32,783 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 5, 'mean': np.float32(-1.432804e-09), 'std': np.float32(0.9999999), 'min': np.float32(-1.9622618), 'max': np.float32(0.6965064)}
2025-06-04 15:35:32,784 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 5, 'mean': np.float32(9.169946e-09), 'std': np.float32(1.0), 'min': np.float32(-1.2277385), 'max': np.float32(1.7117991)}
2025-06-04 15:35:32,786 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-04 15:35:32,815 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f94c796c90>
2025-06-04 15:35:32,943 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:35:32,988 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:35:33,022 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:35:34,562 - INFO - Node feature visualization saved to vis/node_features_20250604_153533.png
2025-06-04 15:35:34,562 - INFO - Finished visualization of node features.
2025-06-04 15:35:34,562 - INFO - Performing additional feature analysis:
2025-06-04 15:35:34,562 - INFO - - Maximum correlation between different features: nan
2025-06-04 15:35:34,562 - INFO - Starting visualization of edge features.
2025-06-04 15:35:34,562 - INFO - Graph has 15 edges and 22 edge features.
2025-06-04 15:35:34,562 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:35:34,563 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:35:34,563 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:35:34,563 - INFO - 
--- Processing file: nw_graph_encoded_1749028234.dot ---
2025-06-04 15:35:34,563 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot
2025-06-04 15:35:34,563 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028234.dot file.
2025-06-04 15:35:34,564 - INFO - Parsed 19 nodes.
2025-06-04 15:35:34,564 - INFO - Parsed 25 edges.
2025-06-04 15:35:34,565 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:34,565 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:34,565 - DEBUG - Initial node features tensor shape: torch.Size([19, 19])
2025-06-04 15:35:34,566 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:34,566 - DEBUG - Node features tensor shape after scaling: torch.Size([19, 19])
2025-06-04 15:35:34,566 - DEBUG - Edge index tensor shape: torch.Size([2, 25])
2025-06-04 15:35:34,567 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:34,567 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:35:34,567 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:35:34,567 - DEBUG - Shape of encoded categorical edge features: torch.Size([25, 2])
2025-06-04 15:35:34,568 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:34,568 - DEBUG - Shape of scaled numerical edge features: torch.Size([25, 20])
2025-06-04 15:35:34,568 - DEBUG - Final edge attributes tensor shape: torch.Size([25, 22])
2025-06-04 15:35:34,568 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:34,568 - INFO - Performing online update...
2025-06-04 15:35:34,569 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:34,569 - DEBUG - Updated RunningStats: new_mean=[ 5.35578335e-10 -5.20735870e-10 -2.68464472e-09  2.48820933e-09
 -2.75668416e-08  1.52339888e-08 -1.07182951e-08 -2.38146582e-09
 -3.13551793e-09  8.19181810e-10  1.61924012e-09 -1.68601697e-09
  4.07999698e-09 -3.41370472e-09  9.23936305e-10  9.18560412e-10
 -3.92682901e-09  1.40668708e-09 -5.25155977e-09], new_M2=[179802.00530992 179802.0052411  179802.00045069 179802.00436491
 179801.99865614 179801.99836135 179801.99586946 179801.99837015
 179801.99315196 179801.99817442 179802.00201181 179801.99364895
 179801.99249831 140031.99643628 140032.00026795 140031.99903983
 140032.00007233 179802.00042619 179802.0076015 ], new_n=179802
2025-06-04 15:35:34,570 - DEBUG - Updated RunningStats: new_mean=[ 1.41755014e+00  5.52504348e+00  1.17644270e-10  3.03286459e-10
  1.61577139e-10 -1.75319415e-10 -1.30722128e-09  2.39029810e-10
  2.65375132e-10 -2.94446361e-10  3.58460523e-10 -3.80462512e-09
 -9.51524991e-10  6.42984385e-10  3.57160862e-10 -1.70270767e-10
 -1.70270767e-10 -1.70270767e-10 -1.70270767e-10 -1.70270767e-10
 -1.70270767e-10 -7.45080293e-11], new_M2=[  99667.64843036 1723874.81489138  388144.99904215  388145.00641502
  388145.00549391  388144.99334954  388145.00035563  388144.99902579
  388145.00172428  388144.9993866   388144.99310691  388145.00869706
  388145.00114653  388144.99975047  388145.00177217  388144.99445112
  388144.99445112  388144.99445112  388144.99445112  388144.99445112
  388144.99445112  388144.9993622 ], new_n=388145
2025-06-04 15:35:34,570 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88250339 0.8825034  0.8825034  0.8825034  1.
 1.00000002]
2025-06-04 15:35:34,570 - DEBUG - Calculated standard deviation: [0.50673407 2.10744313 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:34,570 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:34,570 - DEBUG - Online update step: 1/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 2/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 3/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 4/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 5/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 6/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 7/50
2025-06-04 15:35:34,570 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,570 - DEBUG - Online update step: 8/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 9/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 10/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 11/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 12/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 13/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 14/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 15/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 16/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 17/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 18/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 19/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 20/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 21/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 22/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 23/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 24/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,571 - DEBUG - Online update step: 25/50
2025-06-04 15:35:34,571 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 26/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 27/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 28/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 29/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 30/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 31/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 32/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 33/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 34/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 35/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 36/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 37/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 38/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 39/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 40/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 41/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 42/50
2025-06-04 15:35:34,572 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,572 - DEBUG - Online update step: 43/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 44/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 45/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 46/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 47/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 48/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 49/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - DEBUG - Online update step: 50/50
2025-06-04 15:35:34,573 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:34,573 - WARNING - No successful steps during online update.
2025-06-04 15:35:34,573 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], current edge mean: [ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 15:35:34,573 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.4817
2025-06-04 15:35:34,574 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:35:34,574 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -6.2741732e-09 -1.2548346e-08
 -1.2548346e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
 -6.2741732e-09  2.5096693e-08  2.5096693e-08  5.0193385e-08
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.5685433e-08], edge=[ 1.6000000e-01  2.5599999e+00  0.0000000e+00  4.7683715e-09
 -9.5367430e-09  9.5367430e-09 -4.7683715e-09  1.9073486e-08
  0.0000000e+00  2.3841857e-09 -4.7683715e-09 -1.2516975e-08
  1.9073486e-08  3.8146972e-08  0.0000000e+00  1.6689301e-08
  1.6689301e-08  1.6689301e-08  1.6689301e-08  1.6689301e-08
  1.6689301e-08 -2.3841857e-09]
2025-06-04 15:35:34,574 - DEBUG - Updated reference std: node=[1.0274024 1.0274024 1.0274024 1.0274023 1.0274023 1.0274023 1.0274024
 1.0274023 1.0274023 1.0274024 1.0274023 1.0274024 1.0274023 0.
 0.        0.        0.        1.0274024 1.0274024], edge=[0.37416574 1.5832456  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207  1.0206207  1.0206207
 1.0206207  1.0206207  1.0206207  1.0206207 ]
2025-06-04 15:35:34,574 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:34,574 - INFO - Running anomaly detection...
2025-06-04 15:35:34,574 - INFO - Starting anomaly detection.
2025-06-04 15:35:35,056 - DEBUG - Node reconstruction errors: [0.04703716 0.04703718 0.04703716 0.04703716 0.04703722 1.0216042
 0.04703724 0.94961035 0.04703715 0.04703714 0.24937128 0.62280303
 0.2218669  0.0470372  0.04409145 0.50170773 0.04703716 0.04703715
 0.04409139]
2025-06-04 15:35:35,058 - DEBUG - Edge reconstruction errors: [0.7994462  0.7991707  0.79975873 0.79589605 0.19986635 0.19985753
 0.1998468  0.7791605  0.5521017  0.77832186 0.79638046 0.7758937
 0.19997507 0.19997925 0.1999777  0.79668164 0.79695684 0.7941532
 0.7954036  0.7965522  0.79437    0.79465044 0.79975754 0.19999999
 0.19999999]
2025-06-04 15:35:35,158 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153535_update_2.json
2025-06-04 15:35:35,158 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:35,187 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153535_update_2.pth and as latest_checkpoint.pth
2025-06-04 15:35:35,188 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028234.dot): 0.0000
2025-06-04 15:35:35,188 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:35:35,188 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.0216, MLP Score: 0.0000
2025-06-04 15:35:35,188 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:35,188 - INFO - 
--- Processing file: nw_graph_encoded_1749028249.dot ---
2025-06-04 15:35:35,188 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot
2025-06-04 15:35:35,188 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028249.dot file.
2025-06-04 15:35:35,189 - INFO - Parsed 21 nodes.
2025-06-04 15:35:35,190 - INFO - Parsed 29 edges.
2025-06-04 15:35:35,191 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:35,191 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:35,192 - DEBUG - Initial node features tensor shape: torch.Size([21, 19])
2025-06-04 15:35:35,193 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:35,193 - DEBUG - Node features tensor shape after scaling: torch.Size([21, 19])
2025-06-04 15:35:35,193 - DEBUG - Edge index tensor shape: torch.Size([2, 29])
2025-06-04 15:35:35,193 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:35,194 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:35:35,195 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:35:35,195 - DEBUG - Shape of encoded categorical edge features: torch.Size([29, 2])
2025-06-04 15:35:35,196 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:35,196 - DEBUG - Shape of scaled numerical edge features: torch.Size([29, 20])
2025-06-04 15:35:35,196 - DEBUG - Final edge attributes tensor shape: torch.Size([29, 22])
2025-06-04 15:35:35,196 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:35,196 - INFO - Performing online update...
2025-06-04 15:35:35,197 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:35,197 - DEBUG - Updated RunningStats: new_mean=[ 5.35267192e-10 -5.20012132e-10 -2.68656858e-09  2.48841594e-09
 -2.75636223e-08  1.52315468e-08 -1.07173749e-08 -2.38342508e-09
 -3.13577325e-09  8.21074922e-10  1.62037688e-09 -1.68896897e-09
  4.07952051e-09 -3.41330607e-09  9.23828407e-10  9.18453141e-10
 -3.92637043e-09  1.40370537e-09 -5.24779500e-09], new_M2=[179823.00530863 179823.00523983 179823.00045154 179823.00436475
 179822.99865767 179822.99836152 179822.99586848 179822.99837002
 179822.99315373 179822.99817482 179823.0020099  179822.99364849
 179822.99249984 140031.99643628 140032.00026795 140031.99903983
 140032.00007233 179823.00042601 179823.0076025 ], new_n=179823
2025-06-04 15:35:35,197 - DEBUG - Updated RunningStats: new_mean=[ 1.41745454e+00  5.52483422e+00  1.17371564e-10  3.03646479e-10
  1.61761805e-10 -1.75258333e-10 -1.30698926e-09  2.38858401e-10
  2.65163367e-10 -2.94539527e-10  3.58539309e-10 -3.80414894e-09
 -9.52183273e-10  6.41439223e-10  3.57441282e-10 -1.70753489e-10
 -1.70753489e-10 -1.70753489e-10 -1.70753489e-10 -1.70753489e-10
 -1.70753489e-10 -7.45024629e-11], new_M2=[  99718.57848542 1724168.09808234  388173.99904127  388174.00641666
  388174.00549408  388173.99334873  388174.00035498  388173.99902583
  388174.00172337  388173.99938605  388173.99310764  388174.00869679
  388174.00114669  388173.99975097  388174.0017725   388173.99445026
  388173.99445026  388173.99445026  388173.99445026  388173.99445026
  388173.99445026  388173.99936188], new_n=388174
2025-06-04 15:35:35,198 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88245186 0.88245187 0.88245186 0.88245187 1.
 1.00000002]
2025-06-04 15:35:35,198 - DEBUG - Calculated standard deviation: [0.50684459 2.10754366 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:35,198 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:35,198 - DEBUG - Online update step: 1/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 2/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 3/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 4/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 5/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 6/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 7/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 8/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,198 - DEBUG - Online update step: 9/50
2025-06-04 15:35:35,198 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 10/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 11/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 12/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 13/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 14/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 15/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 16/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 17/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,199 - DEBUG - Online update step: 18/50
2025-06-04 15:35:35,199 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 19/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 20/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 21/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 22/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 23/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 24/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 25/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 26/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 27/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 28/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,200 - DEBUG - Online update step: 29/50
2025-06-04 15:35:35,200 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 30/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 31/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 32/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 33/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 34/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 35/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 36/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 37/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 38/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 39/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,201 - DEBUG - Online update step: 40/50
2025-06-04 15:35:35,201 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 41/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 42/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 43/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 44/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 45/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 46/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 47/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 48/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 49/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,202 - DEBUG - Online update step: 50/50
2025-06-04 15:35:35,202 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:35,203 - WARNING - No successful steps during online update.
2025-06-04 15:35:35,203 - DEBUG - Current node mean: [ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], current edge mean: [ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 15:35:35,203 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5245
2025-06-04 15:35:35,203 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:35:35,203 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:35:35,204 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:35:35,205 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:35:35,206 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:35:35,206 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:35:35,206 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:35:35,206 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:35:35,206 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:35:35,207 - INFO - Optimizer and scheduler reset.
2025-06-04 15:35:35,207 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  0.0000000e+00 -2.2706532e-08  1.7029899e-08
 -5.6766329e-09 -2.2706532e-08  0.0000000e+00 -1.1353266e-08
 -1.7029899e-08  3.4059799e-08  1.7029899e-08 -3.2640639e-08
  5.6766329e-09  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -2.2706532e-08  2.2706532e-08], edge=[ 1.3793103e-01  2.7241380e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  1.6442661e-08  1.6442661e-08 -8.2213303e-09
 -8.2213303e-09 -4.1106651e-09  0.0000000e+00  0.0000000e+00
 -1.2331996e-08 -1.6442661e-08 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09 -8.2213303e-09
 -8.2213303e-09  4.1106651e-09]
2025-06-04 15:35:35,207 - DEBUG - Updated reference std: node=[1.024695  1.024695  1.024695  1.024695  1.0246952 1.024695  1.024695
 1.024695  1.0246952 1.024695  1.024695  1.024695  1.0246952 0.
 0.        0.        0.        1.024695  1.0246952], edge=[0.3509312 1.5328907 1.0177004 1.0177006 1.0177004 1.0177004 1.0177004
 1.0177004 1.0177004 1.0177004 1.0177006 1.0177004 1.0177004 1.0177006
 1.0177006 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004 1.0177004
 1.0177004]
2025-06-04 15:35:35,207 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:35,207 - INFO - Running anomaly detection...
2025-06-04 15:35:35,208 - INFO - Starting anomaly detection.
2025-06-04 15:35:35,858 - DEBUG - Node reconstruction errors: [ 24.155264  24.155258  24.155268  24.155258  24.155266  24.155266
  24.155258  57.85977   24.155264 141.28496   24.155266  24.155262
  17.626152  22.630026  20.675278  24.155264  22.340881  35.97979
  24.155258  24.155258  22.340887]
2025-06-04 15:35:35,859 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        0.8        0.19528365 0.19818926
 0.19829357 0.1984933  0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 15:35:36,048 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153536_update_3.json
2025-06-04 15:35:36,049 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:36,072 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153536_update_3.pth and as latest_checkpoint.pth
2025-06-04 15:35:36,073 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028249.dot): 0.0883
2025-06-04 15:35:36,073 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:35:36,073 - WARNING -   Node ID: 192.168.27.10, Recon Error: 141.2850, MLP Score: 1.0000
2025-06-04 15:35:36,073 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:36,073 - INFO - 
--- Processing file: nw_graph_encoded_1749028264.dot ---
2025-06-04 15:35:36,073 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot
2025-06-04 15:35:36,073 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028264.dot file.
2025-06-04 15:35:36,074 - INFO - Parsed 31 nodes.
2025-06-04 15:35:36,075 - INFO - Parsed 41 edges.
2025-06-04 15:35:36,076 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:36,076 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:36,077 - DEBUG - Initial node features tensor shape: torch.Size([31, 19])
2025-06-04 15:35:36,078 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:36,078 - DEBUG - Node features tensor shape after scaling: torch.Size([31, 19])
2025-06-04 15:35:36,078 - DEBUG - Edge index tensor shape: torch.Size([2, 41])
2025-06-04 15:35:36,078 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:36,079 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:35:36,080 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:35:36,080 - DEBUG - Shape of encoded categorical edge features: torch.Size([41, 2])
2025-06-04 15:35:36,081 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:36,081 - DEBUG - Shape of scaled numerical edge features: torch.Size([41, 20])
2025-06-04 15:35:36,081 - DEBUG - Final edge attributes tensor shape: torch.Size([41, 22])
2025-06-04 15:35:36,081 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:36,081 - INFO - Performing online update...
2025-06-04 15:35:36,081 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:36,082 - DEBUG - Updated RunningStats: new_mean=[ 5.39441781e-10 -5.24023647e-10 -2.68463490e-09  2.48599860e-09
 -2.75601970e-08  1.52269330e-08 -1.07168533e-08 -2.38152295e-09
 -3.13409356e-09  8.19773480e-10  1.62175461e-09 -1.69149481e-09
  4.08014298e-09 -3.41106071e-09  9.22012145e-10  9.22271703e-10
 -3.92171680e-09  1.40603182e-09 -5.24556486e-09], new_M2=[179854.00531163 179854.00524284 179854.00045211 179854.00436635
 179853.99865599 179853.99836062 179853.99586782 179853.99836889
 179853.99315229 179853.99817324 179854.00201207 179853.99364634
 179853.99249817 140062.99643721 140063.00026888 140062.99903916
 140063.00007167 179854.00042653 179854.0076021 ], new_n=179854
2025-06-04 15:35:36,082 - DEBUG - Updated RunningStats: new_mean=[ 1.41731772e+00  5.52453151e+00  1.17542691e-10  3.03045851e-10
  1.61562398e-10 -1.76103459e-10 -1.30629466e-09  2.38238226e-10
  2.65288898e-10 -2.94477233e-10  3.58280736e-10 -3.80382395e-09
 -9.52824598e-10  6.41371480e-10  3.56789391e-10 -1.70850607e-10
 -1.70850607e-10 -1.70850607e-10 -1.70850607e-10 -1.70850607e-10
 -1.70850607e-10 -7.44466148e-11], new_M2=[  99791.7729454  1724612.12416834  388214.99904335  388215.00641416
  388215.00549444  388214.99334609  388215.00035347  388214.99902563
  388215.00172403  388214.99938597  388214.99310877  388215.0086975
  388215.00114648  388214.99975086  388215.0017721   388214.99444989
  388214.99444989  388214.99444989  388214.99444989  388214.99444989
  388214.99444989  388214.99936185], new_n=388215
2025-06-04 15:35:36,083 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88247347 0.88247348 0.88247347 0.88247348 1.
 1.00000002]
2025-06-04 15:35:36,083 - DEBUG - Calculated standard deviation: [0.5070038  2.10770372 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:36,083 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:36,084 - DEBUG - Online update step: 1/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 2/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 3/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 4/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 5/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 6/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 7/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 8/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 9/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 10/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 11/50
2025-06-04 15:35:36,084 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,084 - DEBUG - Online update step: 12/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 13/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 14/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 15/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 16/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 17/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 18/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 19/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 20/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 21/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 22/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 23/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,085 - DEBUG - Online update step: 24/50
2025-06-04 15:35:36,085 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 25/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 26/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 27/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 28/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 29/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 30/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 31/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 32/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 33/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 34/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 35/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 36/50
2025-06-04 15:35:36,086 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,086 - DEBUG - Online update step: 37/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 38/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 39/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 40/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 41/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 42/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 43/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 44/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 45/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 46/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,087 - DEBUG - Online update step: 47/50
2025-06-04 15:35:36,087 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,088 - DEBUG - Online update step: 48/50
2025-06-04 15:35:36,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,088 - DEBUG - Online update step: 49/50
2025-06-04 15:35:36,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,088 - DEBUG - Online update step: 50/50
2025-06-04 15:35:36,088 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,088 - WARNING - No successful steps during online update.
2025-06-04 15:35:36,089 - DEBUG - Current node mean: [ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], current edge mean: [ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 15:35:36,089 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5549
2025-06-04 15:35:36,089 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:35:36,089 - DEBUG - Updated reference mean: node=[ 1.9227304e-08 -1.9227304e-08  2.3072765e-08 -1.2497748e-08
  1.5381843e-08  0.0000000e+00 -7.6909217e-09  8.6522869e-09
  2.3072765e-08  1.5381843e-08  2.6918226e-08  0.0000000e+00
 -1.5381843e-08 -2.3072765e-08  2.3072765e-08  2.3072765e-08
  2.3072765e-08  1.5381843e-08  1.9227304e-09], edge=[ 1.2195122e-01  2.6585367e+00 -3.6344294e-10  4.3613153e-09
  4.3613153e-09 -1.1630174e-08  1.8899033e-08  0.0000000e+00
  1.1630174e-08 -1.1630174e-08  6.5419732e-09 -1.2902225e-08
  1.4537719e-08 -2.0352806e-08 -2.3260348e-08  2.9075435e-09
  2.9075435e-09  2.9075435e-09  2.9075435e-09  2.9075435e-09
  2.9075435e-09  2.9075435e-09]
2025-06-04 15:35:36,090 - DEBUG - Updated reference std: node=[1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653 1.01653
 1.01653], edge=[0.33129457 1.6372195  1.0124229  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228  1.0124228  1.0124228
 1.0124228  1.0124228  1.0124228  1.0124228 ]
2025-06-04 15:35:36,090 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:36,090 - INFO - Running anomaly detection...
2025-06-04 15:35:36,091 - INFO - Starting anomaly detection.
2025-06-04 15:35:36,654 - DEBUG - Node reconstruction errors: [ 22.665892  20.69729   22.882828  55.716236  20.697292  22.882832
  17.654781  30.47644   16.750616  22.882832  22.882828  22.88283
  22.882828 264.74655   22.882833  22.88283   73.07743   22.88283
  22.882828  22.665892  22.882828  22.882828  22.88283   22.882828
  22.882833  22.88283   19.69609   19.69609   22.88283   20.697287
  22.882837]
2025-06-04 15:35:36,655 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.79999995 0.19999903 0.19999963 0.19999975 0.19999975]
2025-06-04 15:35:36,738 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153536_update_4.json
2025-06-04 15:35:36,739 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:36,760 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153536_update_4.pth and as latest_checkpoint.pth
2025-06-04 15:35:36,760 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028264.dot): 0.0408
2025-06-04 15:35:36,760 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:35:36,760 - WARNING -   Node ID: 192.168.27.10, Recon Error: 264.7466, MLP Score: 1.0000
2025-06-04 15:35:36,760 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:36,761 - INFO - 
--- Processing file: nw_graph_encoded_1749028279.dot ---
2025-06-04 15:35:36,761 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot
2025-06-04 15:35:36,761 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028279.dot file.
2025-06-04 15:35:36,761 - INFO - Parsed 41 nodes.
2025-06-04 15:35:36,762 - INFO - Parsed 54 edges.
2025-06-04 15:35:36,764 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:36,764 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:36,765 - DEBUG - Initial node features tensor shape: torch.Size([41, 19])
2025-06-04 15:35:36,766 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:36,766 - DEBUG - Node features tensor shape after scaling: torch.Size([41, 19])
2025-06-04 15:35:36,766 - DEBUG - Edge index tensor shape: torch.Size([2, 54])
2025-06-04 15:35:36,766 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:36,767 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 2
2025-06-04 15:35:36,767 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 5
2025-06-04 15:35:36,767 - DEBUG - Shape of encoded categorical edge features: torch.Size([54, 2])
2025-06-04 15:35:36,768 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:36,768 - DEBUG - Shape of scaled numerical edge features: torch.Size([54, 20])
2025-06-04 15:35:36,768 - DEBUG - Final edge attributes tensor shape: torch.Size([54, 22])
2025-06-04 15:35:36,768 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:36,768 - INFO - Performing online update...
2025-06-04 15:35:36,769 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:36,769 - DEBUG - Updated RunningStats: new_mean=[ 5.36067659e-10 -5.20508082e-10 -2.68563828e-09  2.48427236e-09
 -2.75554067e-08  1.52266103e-08 -1.07154048e-08 -2.38363081e-09
 -3.13389697e-09  8.18592654e-10  1.62055667e-09 -1.69260028e-09
  4.07358045e-09 -3.41094596e-09  9.22464669e-10  9.33326734e-10
 -3.92976891e-09  1.40620837e-09 -5.24751697e-09], new_M2=[179895.00531417 179895.00524538 179895.00045169 179895.00436953
 179894.99865227 179894.99836053 179894.99586949 179894.99836592
 179894.99315042 179894.99817219 179895.0020124  179894.99364262
 179894.99250122 140103.99643649 140104.00026816 140103.99904172
 140104.00007179 179895.00042345 179895.00760165], new_n=179895
2025-06-04 15:35:36,770 - DEBUG - Updated RunningStats: new_mean=[ 1.41713863e+00  5.52411344e+00  1.17489164e-10  3.02811811e-10
  1.61808578e-10 -1.76251669e-10 -1.30513913e-09  2.38406579e-10
  2.65218421e-10 -2.94397899e-10  3.57564082e-10 -3.80164225e-09
 -9.52250728e-10  6.41359035e-10  3.59503018e-10 -1.71009143e-10
 -1.71009143e-10 -1.71009143e-10 -1.71009143e-10 -1.71009143e-10
 -1.71009143e-10 -7.44746393e-11], new_M2=[  99887.39267879 1725247.48794782  388268.99904423  388269.00641298
  388269.00549466  388268.9933454   388269.00035169  388268.99902447
  388269.00172522  388268.99938678  388268.99310822  388269.00869517
  388269.00114712  388268.99974946  388269.00177278  388268.99445019
  388268.99445019  388268.99445019  388268.99445019  388268.99445019
  388268.99445019  388268.9993612 ], new_n=388269
2025-06-04 15:35:36,770 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88250203 0.88250205 0.88250204 0.88250205 1.
 1.00000002]
2025-06-04 15:35:36,770 - DEBUG - Calculated standard deviation: [0.50721137 2.10794533 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:36,770 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:36,770 - DEBUG - Online update step: 1/50
2025-06-04 15:35:36,770 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,770 - DEBUG - Online update step: 2/50
2025-06-04 15:35:36,770 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,770 - DEBUG - Online update step: 3/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 4/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 5/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 6/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 7/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 8/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 9/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,771 - DEBUG - Online update step: 10/50
2025-06-04 15:35:36,771 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 11/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 12/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 13/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 14/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 15/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 16/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 17/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 18/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 19/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 20/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,773 - DEBUG - Online update step: 21/50
2025-06-04 15:35:36,773 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 22/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 23/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 24/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 25/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 26/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 27/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 28/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 29/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 30/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 31/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 32/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 33/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 34/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,774 - DEBUG - Online update step: 35/50
2025-06-04 15:35:36,774 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 36/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 37/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 38/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 39/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 40/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 41/50
2025-06-04 15:35:36,775 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,775 - DEBUG - Online update step: 42/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 43/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 44/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 45/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 46/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 47/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 48/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 49/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - DEBUG - Online update step: 50/50
2025-06-04 15:35:36,776 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:36,776 - WARNING - No successful steps during online update.
2025-06-04 15:35:36,777 - DEBUG - Current node mean: [ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], current edge mean: [ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 15:35:36,777 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 2.5384
2025-06-04 15:35:36,777 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:35:36,777 - DEBUG - Updated reference mean: node=[ 1.1630174e-08 -1.1630174e-08 -7.2688593e-09 -2.3260348e-08
 -1.1630174e-08  2.3260348e-08  0.0000000e+00 -3.4890522e-08
 -3.9251841e-08  1.1630174e-08 -1.1630174e-08 -1.1630174e-08
 -1.1630174e-08  1.4537719e-08 -1.4537719e-08  6.9781045e-08
 -5.8150874e-08  1.5991491e-08 -4.0705611e-08], edge=[ 1.2962963e-01  2.5185184e+00  1.7660636e-08  0.0000000e+00
  4.4151589e-09 -1.3245477e-08  1.2141687e-08 -3.3113692e-09
  1.3245477e-08  4.4151589e-09 -1.1037897e-08  2.4283374e-08
  8.8303178e-09  0.0000000e+00  2.6490953e-08 -1.3245477e-08
 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08 -1.3245477e-08
 -1.3245477e-08 -8.8303178e-09]
2025-06-04 15:35:36,778 - DEBUG - Updated reference std: node=[1.0124229 1.0124229 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228
 1.0124228 1.0124228 1.0124228 1.0124228 1.0124228 1.0124229 1.0124228
 1.0124228 1.0124229 1.0124228 1.0124228 1.0124228], edge=[0.33904952 1.6681335  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899  1.0093899  1.0093899
 1.0093899  1.0093899  1.0093899  1.0093899 ]
2025-06-04 15:35:36,778 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:36,778 - INFO - Running anomaly detection...
2025-06-04 15:35:36,778 - INFO - Starting anomaly detection.
2025-06-04 15:35:37,342 - DEBUG - Node reconstruction errors: [ 21.329037  21.329037  19.15625   21.329037  16.904263  21.329037
  20.333755  22.737226  59.427547  20.333755  22.737228  16.15339
  47.30921   21.329037  16.254023  21.329037  19.15625   22.737226
  22.737226  22.737226  22.737226 312.76752   22.737226  21.329037
  22.737226 103.14141   22.737226  22.737226  21.329037  22.737226
  22.737226  22.737226  22.737226  21.329037  22.737226  22.737228
  19.699713  19.699718  22.737226  20.333755  19.699718]
2025-06-04 15:35:37,342 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.8       ]
2025-06-04 15:35:37,447 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153537_update_5.json
2025-06-04 15:35:37,448 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:37,459 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153537_update_5.pth and as latest_checkpoint.pth
2025-06-04 15:35:37,459 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028279.dot): 0.0136
2025-06-04 15:35:37,459 - WARNING - Detected 1 anomalous nodes (reconstruction-based):
2025-06-04 15:35:37,459 - WARNING -   Node ID: 192.168.27.10, Recon Error: 312.7675, MLP Score: 1.0000
2025-06-04 15:35:37,460 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:37,460 - INFO - 
--- Processing file: nw_graph_encoded_1749028294.dot ---
2025-06-04 15:35:37,460 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot
2025-06-04 15:35:37,460 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028294.dot file.
2025-06-04 15:35:37,461 - INFO - Parsed 48 nodes.
2025-06-04 15:35:37,462 - INFO - Parsed 62 edges.
2025-06-04 15:35:37,464 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:37,465 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:37,465 - DEBUG - Initial node features tensor shape: torch.Size([48, 19])
2025-06-04 15:35:37,467 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:37,467 - DEBUG - Node features tensor shape after scaling: torch.Size([48, 19])
2025-06-04 15:35:37,467 - DEBUG - Edge index tensor shape: torch.Size([2, 62])
2025-06-04 15:35:37,467 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:37,468 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:37,469 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:37,469 - DEBUG - Shape of encoded categorical edge features: torch.Size([62, 2])
2025-06-04 15:35:37,470 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:37,470 - DEBUG - Shape of scaled numerical edge features: torch.Size([62, 20])
2025-06-04 15:35:37,470 - DEBUG - Final edge attributes tensor shape: torch.Size([62, 22])
2025-06-04 15:35:37,470 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:37,470 - INFO - Performing online update...
2025-06-04 15:35:37,471 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:37,471 - DEBUG - Updated RunningStats: new_mean=[ 5.36669956e-10 -5.20948909e-10 -2.68558437e-09  2.48137379e-09
 -2.75467313e-08  1.52192361e-08 -1.07171838e-08 -2.38514805e-09
 -3.13306100e-09  8.18705535e-10  1.61747445e-09 -1.68850512e-09
  4.07116885e-09 -3.40241752e-09  9.17581215e-10  9.27446657e-10
 -3.92308953e-09  1.40222065e-09 -5.25025771e-09], new_M2=[179943.00531617 179943.00524738 179943.00045583 179943.00436512
 179942.99865472 179942.99835926 179942.99587398 179942.99836418
 179942.99315314 179942.99817332 179943.00201051 179942.99364358
 179942.99250367 140151.99643172 140152.00027178 140151.99903797
 140152.00007351 179943.00042048 179943.00759952], new_n=179943
2025-06-04 15:35:37,472 - DEBUG - Updated RunningStats: new_mean=[ 1.41709263e+00  5.52373362e+00  1.17637030e-10  3.02859396e-10
  1.61399021e-10 -1.76645625e-10 -1.30556150e-09  2.38119096e-10
  2.65689307e-10 -2.94187814e-10  3.56969781e-10 -3.79949080e-09
 -9.52033940e-10  6.41736291e-10  3.58678174e-10 -1.71389546e-10
 -1.71389546e-10 -1.71389546e-10 -1.71389546e-10 -1.71389546e-10
 -1.71389546e-10 -7.46929828e-11], new_M2=[  99901.50592665 1725878.00910052  388330.99904412  388331.00641301
  388331.0054918   388330.99334319  388331.00035284  388330.99902419
  388331.001723    388330.99938627  388330.99310823  388331.00869206
  388331.00114559  388330.99975286  388331.00177146  388330.99444841
  388330.99444841  388330.99444841  388330.99444841  388330.99444841
  388330.99444841  388330.9993595 ], new_n=388331
2025-06-04 15:35:37,472 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88253546 0.88253548 0.88253547 0.88253547 1.
 1.00000002]
2025-06-04 15:35:37,472 - DEBUG - Calculated standard deviation: [0.50720671 2.10816218 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:37,473 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:37,473 - DEBUG - Online update step: 1/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 2/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 3/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 4/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 5/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 6/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 7/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 8/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 9/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,473 - DEBUG - Online update step: 10/50
2025-06-04 15:35:37,473 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 11/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 12/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 13/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 14/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 15/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 16/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 17/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 18/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 19/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 20/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 21/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,474 - DEBUG - Online update step: 22/50
2025-06-04 15:35:37,474 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 23/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 24/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 25/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 26/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 27/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 28/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,475 - DEBUG - Online update step: 29/50
2025-06-04 15:35:37,475 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 30/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 31/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 32/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 33/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 34/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 35/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 36/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 37/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 38/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 39/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 40/50
2025-06-04 15:35:37,476 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,476 - DEBUG - Online update step: 41/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 42/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 43/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 44/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 45/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 46/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 47/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 48/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 49/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - DEBUG - Online update step: 50/50
2025-06-04 15:35:37,477 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:37,477 - WARNING - No successful steps during online update.
2025-06-04 15:35:37,478 - DEBUG - Current node mean: [ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], current edge mean: [ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 15:35:37,478 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1283
2025-06-04 15:35:37,478 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:35:37,478 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:35:37,478 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:35:37,479 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:35:37,479 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:35:37,479 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:35:37,479 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:35:37,479 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:35:37,480 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:35:37,480 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:35:37,480 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:35:37,480 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:35:37,480 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:35:37,481 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:35:37,482 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:35:37,482 - INFO - Optimizer and scheduler reset.
2025-06-04 15:35:37,483 - DEBUG - Updated reference mean: node=[ 1.7384687e-08 -1.7384687e-08 -9.9341078e-09 -1.7384687e-08
  3.4769375e-08 -2.7318796e-08 -1.9868216e-08 -4.9670539e-09
  0.0000000e+00  1.2417634e-08  9.9341078e-09 -1.2417635e-09
 -2.4835268e-08  4.4703484e-08 -9.9341078e-09 -1.9868216e-08
  1.9868216e-08 -1.9868216e-08 -5.4637592e-08], edge=[ 1.1290323e+00  3.1451614e+00 -1.5381843e-08 -7.6909217e-09
  0.0000000e+00  0.0000000e+00  0.0000000e+00 -7.6909217e-09
 -7.6909217e-09 -3.8454608e-09  7.6909217e-09  0.0000000e+00
  7.6909217e-09  7.6909217e-09 -3.8454608e-08 -3.8454608e-09
 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09 -3.8454608e-09
 -3.8454608e-09 -1.5381843e-08]
2025-06-04 15:35:37,483 - DEBUG - Updated reference std: node=[1.0105823 1.0105823 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823
 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105823 1.0105822
 1.0105823 1.0105822 1.0105823 1.0105823 1.0105823], edge=[0.38342166 2.141294   1.0081635  1.0081635  1.0081633  1.0081633
 1.0081635  1.0081635  1.0081633  1.0081635  1.0081635  1.0081633
 1.0081633  1.0081635  1.0081633  1.0081633  1.0081633  1.0081633
 1.0081633  1.0081633  1.0081633  1.0081633 ]
2025-06-04 15:35:37,483 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:37,483 - INFO - Running anomaly detection...
2025-06-04 15:35:37,483 - INFO - Starting anomaly detection.
2025-06-04 15:35:38,041 - DEBUG - Node reconstruction errors: [ 16.945501 332.06866   16.084652  16.084652  16.084652  14.276621
  16.084652  16.945501  16.084652  18.475388  16.084652  20.411116
 214.07262   18.475388  20.411114  19.54767   16.603144  16.084652
  16.084652  18.684927  16.084652  14.276621  20.411116  20.411116
  20.411116  20.411112 366.44174   20.411116  16.084652  16.084652
  20.411116 213.35197   16.084652  20.411116  20.411116  16.084652
  20.411116  20.09723   20.411116  20.411114  16.084652  20.411116
  20.09723   19.589342  20.09723   20.097235  18.475388  20.097235]
2025-06-04 15:35:38,042 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.04117024 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:35:38,060 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153538_update_6.json
2025-06-04 15:35:38,060 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:38,069 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153538_update_6.pth and as latest_checkpoint.pth
2025-06-04 15:35:38,070 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028294.dot): 0.9828
2025-06-04 15:35:38,070 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 15:35:38,070 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 332.0687, MLP Score: 0.0576
2025-06-04 15:35:38,070 - WARNING -   Node ID: 192.168.27.10, Recon Error: 366.4417, MLP Score: 0.0000
2025-06-04 15:35:38,070 - WARNING - Detected 1 anomalous edges (reconstruction-based):
2025-06-04 15:35:38,070 - WARNING -   Source: fe80::20c:29ff:fe89:3ead, Target: ff02::2, Recon Error: 0.8000, MLP Score: 1.0000
2025-06-04 15:35:38,537 - INFO - Starting 3D embedding visualization...
2025-06-04 15:35:51,947 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x79f945df2b40> <matplotlib.colors.Normalize object at 0x79f945df2b40>
2025-06-04 15:35:51,949 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f945b6cbc0>
2025-06-04 15:35:51,951 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x79f945df2b40> <matplotlib.colors.Normalize object at 0x79f945df2b40>
2025-06-04 15:35:51,952 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f945b6cbc0>
2025-06-04 15:35:51,954 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f945ccba70>
2025-06-04 15:35:52,124 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_6_updates_20250604_153538.png
2025-06-04 15:35:52,124 - INFO - Performing visualization of node and edge features.
2025-06-04 15:35:52,124 - INFO - Starting visualization of node features.
2025-06-04 15:35:52,124 - INFO - Graph has 48 nodes and 19 features.
2025-06-04 15:35:52,124 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:35:52,124 - INFO - Calculating feature statistics:
2025-06-04 15:35:52,124 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30681947), 'max': np.float32(3.3146563)}
2025-06-04 15:35:52,125 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3146563), 'max': np.float32(0.30681947)}
2025-06-04 15:35:52,125 - INFO - - server_score: {'name': 'server_score', 'unique': 5, 'mean': np.float32(4.967054e-09), 'std': np.float32(1.0), 'min': np.float32(-1.9474404), 'max': np.float32(4.976149)}
2025-06-04 15:35:52,125 - INFO - - client_score: {'name': 'client_score', 'unique': 6, 'mean': np.float32(-2.4835268e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.27038658), 'max': np.float32(5.1146607)}
2025-06-04 15:35:52,125 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(2.4835268e-08), 'std': np.float32(1.0), 'min': np.float32(-0.30151135), 'max': np.float32(3.3166249)}
2025-06-04 15:35:52,125 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 4, 'mean': np.float32(-2.7318796e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29470298), 'max': np.float32(3.9405174)}
2025-06-04 15:35:52,125 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 4, 'mean': np.float32(-1.7384687e-08), 'std': np.float32(1.0), 'min': np.float32(-4.16387), 'max': np.float32(0.28778362)}
2025-06-04 15:35:52,125 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 5, 'mean': np.float32(-2.483527e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2806588), 'max': np.float32(4.6825705)}
2025-06-04 15:35:52,125 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 3, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-1.5491934), 'max': np.float32(6.1967735)}
2025-06-04 15:35:52,125 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 5, 'mean': np.float32(-9.934108e-09), 'std': np.float32(1.0), 'min': np.float32(-0.30420706), 'max': np.float32(4.142791)}
2025-06-04 15:35:52,125 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 5, 'mean': np.float32(1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-2.77095), 'max': np.float32(0.43216652)}
2025-06-04 15:35:52,125 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(-1.4901161e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.34099716), 'max': np.float32(2.9325757)}
2025-06-04 15:35:52,125 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-3.3166249), 'max': np.float32(0.30151135)}
2025-06-04 15:35:52,126 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(4.4703484e-08), 'std': np.float32(0.9999999), 'min': np.float32(-1.2354414), 'max': np.float32(0.8094272)}
2025-06-04 15:35:52,126 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(-1.9868216e-08), 'std': np.float32(1.0), 'min': np.float32(-0.80942726), 'max': np.float32(1.2354416)}
2025-06-04 15:35:52,126 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(-2.9802322e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503811)}
2025-06-04 15:35:52,126 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(2.9802322e-08), 'std': np.float32(1.0), 'min': np.float32(-0.7405316), 'max': np.float32(1.3503813)}
2025-06-04 15:35:52,126 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 6, 'mean': np.float32(-1.2417634e-08), 'std': np.float32(1.0), 'min': np.float32(-2.7371583), 'max': np.float32(0.4274241)}
2025-06-04 15:35:52,126 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 6, 'mean': np.float32(-3.228585e-08), 'std': np.float32(1.0), 'min': np.float32(-1.8509557), 'max': np.float32(1.5174342)}
2025-06-04 15:35:52,139 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f945ccb470>
2025-06-04 15:35:52,446 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:35:52,485 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:35:52,505 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:35:53,923 - INFO - Node feature visualization saved to vis/node_features_20250604_153552.png
2025-06-04 15:35:53,923 - INFO - Finished visualization of node features.
2025-06-04 15:35:53,923 - INFO - Performing additional feature analysis:
2025-06-04 15:35:53,923 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 15:35:53,923 - INFO - Starting visualization of edge features.
2025-06-04 15:35:53,923 - INFO - Graph has 62 edges and 22 edge features.
2025-06-04 15:35:53,923 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:35:53,923 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:35:53,924 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:35:53,924 - INFO - 
--- Processing file: nw_graph_encoded_1749028309.dot ---
2025-06-04 15:35:53,924 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot
2025-06-04 15:35:53,924 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028309.dot file.
2025-06-04 15:35:53,925 - INFO - Parsed 52 nodes.
2025-06-04 15:35:53,926 - INFO - Parsed 68 edges.
2025-06-04 15:35:53,928 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:53,928 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:53,928 - DEBUG - Initial node features tensor shape: torch.Size([52, 19])
2025-06-04 15:35:53,929 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:53,930 - DEBUG - Node features tensor shape after scaling: torch.Size([52, 19])
2025-06-04 15:35:53,930 - DEBUG - Edge index tensor shape: torch.Size([2, 68])
2025-06-04 15:35:53,930 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:53,931 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:53,931 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:53,931 - DEBUG - Shape of encoded categorical edge features: torch.Size([68, 2])
2025-06-04 15:35:53,932 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:53,932 - DEBUG - Shape of scaled numerical edge features: torch.Size([68, 20])
2025-06-04 15:35:53,932 - DEBUG - Final edge attributes tensor shape: torch.Size([68, 22])
2025-06-04 15:35:53,932 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:53,932 - INFO - Performing online update...
2025-06-04 15:35:53,932 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:53,933 - DEBUG - Updated RunningStats: new_mean=[ 5.38522487e-10 -5.22661106e-10 -2.68364950e-09  2.48115365e-09
 -2.75397666e-08  1.52108656e-08 -1.07154122e-08 -2.37916065e-09
 -3.13246632e-09  8.14660834e-10  1.61932519e-09 -1.69182550e-09
  4.07794021e-09 -3.40640176e-09  9.22283321e-10  9.34132789e-10
 -3.92659221e-09  1.39751066e-09 -5.24824421e-09], new_M2=[179995.00531879 179995.00525    179995.00045673 179995.00436904
 179994.99865576 179994.99836247 179994.99587758 179994.99836447
 179994.99315027 179994.99817046 179995.00200678 179994.99363952
 179994.99250263 140203.99643268 140204.00027275 140203.9990364
 140204.00007484 179995.00041818 179995.00759444], new_n=179995
2025-06-04 15:35:53,933 - DEBUG - Updated RunningStats: new_mean=[ 1.41704021e+00  5.52330722e+00  1.17126223e-10  3.01847232e-10
  1.61672892e-10 -1.76370117e-10 -1.30607626e-09  2.38547385e-10
  2.65247145e-10 -2.95047491e-10  3.55986509e-10 -3.80089554e-09
 -9.52879153e-10  6.42026776e-10  3.56927291e-10 -1.71911045e-10
 -1.71911045e-10 -1.71911045e-10 -1.71911045e-10 -1.71911045e-10
 -1.71911045e-10 -7.47518412e-11], new_M2=[  99916.66108306 1726600.76141291  388398.99904151  388399.00640706
  388399.00549401  388398.99334532  388399.00035433  388398.99902767
  388399.0017209   388398.99938515  388398.99310404  388399.00869457
  388399.00114731  388398.99975154  388399.00177237  388398.9944466
  388398.9944466   388398.9944466   388398.9944466   388398.9944466
  388398.9944466   388398.99935976], new_n=388399
2025-06-04 15:35:53,934 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88257166 0.88257167 0.88257166 0.88257167 1.
 1.00000002]
2025-06-04 15:35:53,934 - DEBUG - Calculated standard deviation: [0.50720077 2.10841896 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:53,934 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:53,934 - DEBUG - Online update step: 1/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 2/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 3/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 4/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 5/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 6/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 7/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 8/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,934 - DEBUG - Online update step: 9/50
2025-06-04 15:35:53,934 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 10/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 11/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 12/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 13/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 14/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 15/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 16/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 17/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 18/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 19/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 20/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 21/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 22/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 23/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 24/50
2025-06-04 15:35:53,935 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,935 - DEBUG - Online update step: 25/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 26/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 27/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 28/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 29/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 30/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 31/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 32/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 33/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 34/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 35/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 36/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 37/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 38/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 39/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,936 - DEBUG - Online update step: 40/50
2025-06-04 15:35:53,936 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 41/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 42/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 43/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 44/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 45/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 46/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 47/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 48/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 49/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - DEBUG - Online update step: 50/50
2025-06-04 15:35:53,937 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:53,937 - WARNING - No successful steps during online update.
2025-06-04 15:35:53,938 - DEBUG - Current node mean: [-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], current edge mean: [ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 15:35:53,938 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1549
2025-06-04 15:35:53,938 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:35:53,938 - DEBUG - Updated reference mean: node=[-4.5849728e-09  4.5849728e-09 -2.2924864e-09  3.6679783e-08
 -9.1699457e-09 -2.7509836e-08 -3.6679783e-08 -1.8339891e-08
 -1.6620525e-08  1.3754918e-08 -2.7509836e-08 -3.6679783e-08
  4.1264755e-08 -3.2094810e-08  3.2094810e-08  3.0948566e-08
 -1.3754918e-08  0.0000000e+00 -4.5849728e-08], edge=[ 1.1176471e+00  3.0882354e+00 -1.4024622e-08 -7.0123112e-09
  7.0123112e-09 -7.0123112e-09 -7.0123112e-09  3.5061556e-09
  7.0123112e-09 -7.0123112e-09 -3.5061556e-09  1.4024622e-08
  1.4024622e-08  7.0123112e-09  1.4024622e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  7.0123112e-09]
2025-06-04 15:35:53,938 - DEBUG - Updated reference std: node=[1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563
 1.0097563 1.0097563 1.0097563 1.0097563 1.0097563], edge=[0.36770412 2.183625   1.0074351  1.007435   1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.007435   1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351  1.0074351  1.0074351
 1.0074351  1.0074351  1.0074351  1.0074351 ]
2025-06-04 15:35:53,939 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:53,939 - INFO - Running anomaly detection...
2025-06-04 15:35:53,939 - INFO - Starting anomaly detection.
2025-06-04 15:35:54,427 - DEBUG - Node reconstruction errors: [ 16.373255  17.204117 361.90182   16.373255  16.373255  16.373255
  16.373255  14.479527  16.373255  17.204117  16.373255  18.740566
  16.373255  20.686996 235.18845   18.740566  20.686996  16.010635
  19.318138  16.373255  16.373255  19.06726   16.373255  14.479527
  20.686996  20.686996  20.686996  20.686996 394.83447   20.686996
  16.373255  16.373255  20.686996 232.24695   16.373255  20.686996
  20.686996  16.373255  20.686996  16.373255  20.431345  20.686996
  20.686995  16.373255  20.686996  20.431345  18.605783  20.431345
  20.431345  18.740566  16.373253  20.431335]
2025-06-04 15:35:54,428 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 0.19999999 0.31503728 0.19899154
 0.1986975  0.1989699  0.79999954 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999]
2025-06-04 15:35:54,507 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153554_update_7.json
2025-06-04 15:35:54,507 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:54,522 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153554_update_7.pth and as latest_checkpoint.pth
2025-06-04 15:35:54,523 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028309.dot): 0.9867
2025-06-04 15:35:54,523 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 15:35:54,523 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 361.9018, MLP Score: 0.0252
2025-06-04 15:35:54,523 - WARNING -   Node ID: 192.168.27.10, Recon Error: 394.8345, MLP Score: 0.0000
2025-06-04 15:35:54,523 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-04 15:35:54,523 - WARNING -   Source: fe80::20c:29ff:fe89:3ead, Target: ff02::2, Recon Error: 0.8000, MLP Score: 1.0000
2025-06-04 15:35:54,523 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 1.0000
2025-06-04 15:35:54,523 - INFO - 
--- Processing file: nw_graph_encoded_1749028324.dot ---
2025-06-04 15:35:54,523 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot
2025-06-04 15:35:54,523 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028324.dot file.
2025-06-04 15:35:54,524 - INFO - Parsed 54 nodes.
2025-06-04 15:35:54,526 - INFO - Parsed 71 edges.
2025-06-04 15:35:54,528 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:54,528 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:54,529 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 15:35:54,530 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:54,530 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 15:35:54,530 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 15:35:54,530 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:54,532 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:54,532 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:54,532 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 15:35:54,533 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:54,533 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 15:35:54,533 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 15:35:54,533 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:54,533 - INFO - Performing online update...
2025-06-04 15:35:54,534 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:54,534 - DEBUG - Updated RunningStats: new_mean=[ 5.36436765e-10 -5.20435308e-10 -2.68301015e-09  2.47445067e-09
 -2.75315069e-08  1.52135866e-08 -1.07165021e-08 -2.38291623e-09
 -3.13351311e-09  8.15244119e-10  1.62032924e-09 -1.69297332e-09
  4.08035868e-09 -3.42623607e-09  9.16709962e-10  9.35838906e-10
 -3.92342827e-09  1.39304654e-09 -5.24203551e-09], new_M2=[180049.0053196  180049.00525082 180049.00045562 180049.00436871
 180048.99865391 180048.99836284 180048.99587923 180048.99836057
 180048.993152   180048.99817083 180049.00201068 180048.99363637
 180048.99250297 140257.99643388 140258.00027073 140257.99903464
 140258.00007308 180049.00041985 180049.00759234], new_n=180049
2025-06-04 15:35:54,535 - DEBUG - Updated RunningStats: new_mean=[ 1.41698458e+00  5.52286148e+00  1.17531556e-10  3.02731849e-10
  1.61341270e-10 -1.76102936e-10 -1.30426005e-09  2.38214898e-10
  2.65419228e-10 -2.95041514e-10  3.57877734e-10 -3.79909325e-09
 -9.52796099e-10  6.45860369e-10  3.52259025e-10 -1.72268006e-10
 -1.72268006e-10 -1.72268006e-10 -1.72268006e-10 -1.72268006e-10
 -1.72268006e-10 -7.55053508e-11], new_M2=[  99932.33573764 1727348.46717639  388469.99904336  388470.00641394
  388470.00549323  388469.99334729  388470.00035639  388469.99902698
  388470.00172273  388469.99938612  388469.9931093   388470.00869316
  388470.00114639  388469.99975251  388470.00177175  388469.9944437
  388469.9944437   388469.9944437   388469.9944437   388469.9944437
  388469.9944437   388469.9993549 ], new_n=388470
2025-06-04 15:35:54,535 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88260922 0.88260923 0.88260923 0.88260923 1.
 1.00000002]
2025-06-04 15:35:54,535 - DEBUG - Calculated standard deviation: [0.5071942  2.10868271 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:54,536 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:54,536 - DEBUG - Online update step: 1/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 2/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 3/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 4/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 5/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 6/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 7/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 8/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 9/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 10/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 11/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,536 - DEBUG - Online update step: 12/50
2025-06-04 15:35:54,536 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 13/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 14/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 15/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 16/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 17/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 18/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 19/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 20/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 21/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 22/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 23/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 24/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 25/50
2025-06-04 15:35:54,537 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,537 - DEBUG - Online update step: 26/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 27/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 28/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 29/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 30/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 31/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 32/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 33/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 34/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 35/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,538 - DEBUG - Online update step: 36/50
2025-06-04 15:35:54,538 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 37/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 38/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 39/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 40/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 41/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 42/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 43/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 44/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 45/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 46/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 47/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 48/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 49/50
2025-06-04 15:35:54,539 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,539 - DEBUG - Online update step: 50/50
2025-06-04 15:35:54,540 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:54,540 - WARNING - No successful steps during online update.
2025-06-04 15:35:54,541 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 15:35:54,541 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1563
2025-06-04 15:35:54,541 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:35:54,541 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  0.0000000e+00
  0.0000000e+00  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09  3.3580081e-09
  3.3580081e-09  5.0370121e-09  2.0148049e-08  0.0000000e+00
  2.0148049e-08  1.6790040e-09  1.3432032e-08 -5.0370121e-09
  1.1753029e-08 -3.3580081e-09 -1.3432032e-08  6.7160162e-09
  6.7160162e-09  6.7160162e-09  6.7160162e-09  6.7160162e-09
  6.7160162e-09 -6.7160162e-09]
2025-06-04 15:35:54,542 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071176  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175 ]
2025-06-04 15:35:54,542 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:54,542 - INFO - Running anomaly detection...
2025-06-04 15:35:54,542 - INFO - Starting anomaly detection.
2025-06-04 15:35:55,077 - DEBUG - Node reconstruction errors: [ 16.486666  17.314182 380.44604   16.486666  16.486666  16.486668
  16.486666  14.596783  16.486666  17.314182  16.486668  18.919378
  16.486668  20.875965 246.63147   18.919378  20.875965  16.201986
  20.15844   16.486666  16.486666  19.181595  16.486666  14.596783
  20.875967  20.875967  20.875965  20.875965 409.96036   20.875965
  16.486666  16.486666  20.875967 236.51205   16.486666  20.875965
  20.875963  16.486666  20.875963  16.486666  20.573168  16.486668
  20.875965  20.875965  16.486666  20.875965  20.57317   18.607975
  20.57317   14.596783  20.57317   18.294643  16.486668  20.57317 ]
2025-06-04 15:35:55,078 - DEBUG - Edge reconstruction errors: [0.8        0.19999999 0.19999999 0.19999999 0.7828934  0.08550286
 0.05711108 0.08421457 0.8        0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999]
2025-06-04 15:35:55,186 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153555_update_8.json
2025-06-04 15:35:55,186 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:55,204 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153555_update_8.pth and as latest_checkpoint.pth
2025-06-04 15:35:55,204 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028324.dot): 0.9879
2025-06-04 15:35:55,205 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:35:55,205 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 380.4460, MLP Score: 0.0115
2025-06-04 15:35:55,205 - WARNING -   Node ID: 192.168.27.13, Recon Error: 246.6315, MLP Score: 0.0000
2025-06-04 15:35:55,205 - WARNING -   Node ID: 192.168.27.10, Recon Error: 409.9604, MLP Score: 0.0000
2025-06-04 15:35:55,205 - WARNING - Detected 3 anomalous edges (reconstruction-based):
2025-06-04 15:35:55,205 - WARNING -   Source: fe80::20c:29ff:fe89:3ead, Target: ff02::2, Recon Error: 0.8000, MLP Score: 1.0000
2025-06-04 15:35:55,206 - WARNING -   Source: 192.168.27.13, Target: 8.8.8.8, Recon Error: 0.7829, MLP Score: 1.0000
2025-06-04 15:35:55,206 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 1.0000
2025-06-04 15:35:55,206 - INFO - 
--- Processing file: nw_graph_encoded_1749028339.dot ---
2025-06-04 15:35:55,206 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot
2025-06-04 15:35:55,206 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028339.dot file.
2025-06-04 15:35:55,208 - INFO - Parsed 54 nodes.
2025-06-04 15:35:55,209 - INFO - Parsed 71 edges.
2025-06-04 15:35:55,212 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:55,212 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:55,213 - DEBUG - Initial node features tensor shape: torch.Size([54, 19])
2025-06-04 15:35:55,214 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:55,214 - DEBUG - Node features tensor shape after scaling: torch.Size([54, 19])
2025-06-04 15:35:55,214 - DEBUG - Edge index tensor shape: torch.Size([2, 71])
2025-06-04 15:35:55,214 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:55,215 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:55,216 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:55,216 - DEBUG - Shape of encoded categorical edge features: torch.Size([71, 2])
2025-06-04 15:35:55,217 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:55,217 - DEBUG - Shape of scaled numerical edge features: torch.Size([71, 20])
2025-06-04 15:35:55,217 - DEBUG - Final edge attributes tensor shape: torch.Size([71, 22])
2025-06-04 15:35:55,217 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:55,217 - INFO - Performing online update...
2025-06-04 15:35:55,218 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:55,218 - DEBUG - Updated RunningStats: new_mean=[ 5.34352293e-10 -5.18210844e-10 -2.68237118e-09  2.46775170e-09
 -2.75232522e-08  1.52163060e-08 -1.07175913e-08 -2.38666955e-09
 -3.13455928e-09  8.15827054e-10  1.62133268e-09 -1.69412046e-09
  4.08277569e-09 -3.44605848e-09  9.11139946e-10  9.38205896e-10
 -3.91364728e-09  1.38858510e-09 -5.23583054e-09], new_M2=[180103.00532042 180103.00525164 180103.00045451 180103.00436839
 180102.99865206 180102.99836321 180102.99588087 180102.99835668
 180102.99315372 180102.99817121 180103.00201458 180102.99363321
 180102.99250331 140311.99643507 140312.00026872 140311.99903667
 140312.00007525 180103.00042152 180103.00759025], new_n=180103
2025-06-04 15:35:55,219 - DEBUG - Updated RunningStats: new_mean=[ 1.41692897e+00  5.52241591e+00  1.17174502e-10  3.01756092e-10
  1.60808423e-10 -1.76358393e-10 -1.30468448e-09  2.39133753e-10
  2.65993940e-10 -2.95188945e-10  3.59768268e-10 -3.80112678e-09
 -9.52903035e-10  6.46068336e-10  3.47592466e-10 -1.72313229e-10
 -1.72313229e-10 -1.72313229e-10 -1.72313229e-10 -1.72313229e-10
 -1.72313229e-10 -7.45327638e-11], new_M2=[  99948.00798886 1728096.01863385  388540.99904229  388541.0064088
  388541.00549233  388540.99334609  388541.00035437  388540.99902659
  388541.00172631  388540.99938579  388540.99311455  388541.00869566
  388541.00114767  388540.99975246  388541.00177112  388540.99444414
  388540.99444414  388540.99444414  388540.99444414  388540.99444414
  388540.99444414  388540.99936167], new_n=388541
2025-06-04 15:35:55,219 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88264675 0.88264677 0.88264676 0.88264677 1.
 1.00000002]
2025-06-04 15:35:55,219 - DEBUG - Calculated standard deviation: [0.50718762 2.10894623 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:55,220 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:55,220 - DEBUG - Online update step: 1/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 2/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 3/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 4/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 5/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 6/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 7/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 8/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 9/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 10/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,220 - DEBUG - Online update step: 11/50
2025-06-04 15:35:55,220 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 12/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 13/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 14/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 15/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 16/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 17/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 18/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 19/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 20/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 21/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 22/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 23/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 24/50
2025-06-04 15:35:55,221 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,221 - DEBUG - Online update step: 25/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 26/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 27/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 28/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 29/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 30/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 31/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 32/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 33/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 34/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 35/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 36/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 37/50
2025-06-04 15:35:55,222 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,222 - DEBUG - Online update step: 38/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 39/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 40/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 41/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 42/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 43/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 44/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 45/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 46/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 47/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,223 - DEBUG - Online update step: 48/50
2025-06-04 15:35:55,223 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,224 - DEBUG - Online update step: 49/50
2025-06-04 15:35:55,224 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,224 - DEBUG - Online update step: 50/50
2025-06-04 15:35:55,224 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,224 - WARNING - No successful steps during online update.
2025-06-04 15:35:55,225 - DEBUG - Current node mean: [-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], current edge mean: [ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 15:35:55,225 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1560
2025-06-04 15:35:55,225 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:35:55,226 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:35:55,226 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:35:55,226 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:35:55,226 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:35:55,226 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:35:55,227 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:35:55,227 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:35:55,227 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:35:55,227 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:35:55,227 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:35:55,228 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:35:55,229 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:35:55,229 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:35:55,230 - INFO - Optimizer and scheduler reset.
2025-06-04 15:35:55,230 - DEBUG - Updated reference mean: node=[-2.2075794e-08  2.2075794e-08  8.8303178e-09 -3.5321271e-08
  2.8698533e-08  1.4349267e-08 -2.7042848e-08 -3.0906111e-08
 -7.1746333e-09  0.0000000e+00 -2.8698533e-08  8.8303178e-09
 -8.8303178e-09 -9.1614545e-08 -3.3113693e-08  2.2075794e-08
  8.8303178e-09  2.6490953e-08 -5.2981907e-08], edge=[ 1.1126760e+00  3.0845070e+00 -6.7160162e-09 -1.6790041e-08
  6.7160162e-09  3.3580081e-09 -6.7160162e-09  6.7160162e-09
  0.0000000e+00  6.7160162e-09  1.3432032e-08 -6.7160162e-09
  7.5555180e-09 -3.3580081e-09 -1.3432032e-08 -6.7160162e-09
 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09 -6.7160162e-09
 -6.7160162e-09 -8.3950207e-09]
2025-06-04 15:35:55,231 - DEBUG - Updated reference std: node=[1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899
 1.0093899 1.0093899 1.0093899 1.0093899 1.0093899], edge=[0.36052722 2.1563625  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071175  1.0071175  1.0071175
 1.0071175  1.0071175  1.0071175  1.0071176 ]
2025-06-04 15:35:55,231 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:55,231 - INFO - Running anomaly detection...
2025-06-04 15:35:55,231 - INFO - Starting anomaly detection.
2025-06-04 15:35:55,768 - DEBUG - Node reconstruction errors: [ 11.486646   9.523801 206.43355   11.486646  11.486646  11.486646
  11.486646  10.332259  11.486646   9.523801  11.486647   9.946438
  11.486645  10.530691 153.52275    9.946438  10.530689  12.237207
  25.968885  11.486646  11.486646   9.284976  11.486646  10.332259
  10.530689  10.530689  10.530691  10.530691 243.77585   10.530689
  11.486646  11.486646  10.530689 165.49263   11.486646  10.530689
  10.530689  11.486646  10.530689  11.486646  13.604926  11.486645
  10.530689  10.530689  11.486646  10.530689  13.604926  16.096554
  13.604926  10.332259  13.604926  11.970434  11.486643  13.604926]
2025-06-04 15:35:55,768 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.19999999 0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8       ]
2025-06-04 15:35:55,869 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153555_update_9.json
2025-06-04 15:35:55,869 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:55,883 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153555_update_9.pth and as latest_checkpoint.pth
2025-06-04 15:35:55,887 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028339.dot): 1.0000
2025-06-04 15:35:55,887 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:35:55,887 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 206.4335, MLP Score: 0.0000
2025-06-04 15:35:55,887 - WARNING -   Node ID: 192.168.27.13, Recon Error: 153.5228, MLP Score: 1.0000
2025-06-04 15:35:55,887 - WARNING -   Node ID: 192.168.27.10, Recon Error: 243.7758, MLP Score: 0.0000
2025-06-04 15:35:55,887 - WARNING -   Node ID: 192.168.27.12, Recon Error: 165.4926, MLP Score: 1.0000
2025-06-04 15:35:55,887 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:55,887 - INFO - 
--- Processing file: nw_graph_encoded_1749028354.dot ---
2025-06-04 15:35:55,888 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot
2025-06-04 15:35:55,888 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028354.dot file.
2025-06-04 15:35:55,889 - INFO - Parsed 58 nodes.
2025-06-04 15:35:55,890 - INFO - Parsed 81 edges.
2025-06-04 15:35:55,893 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:55,893 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:55,894 - DEBUG - Initial node features tensor shape: torch.Size([58, 19])
2025-06-04 15:35:55,895 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:55,895 - DEBUG - Node features tensor shape after scaling: torch.Size([58, 19])
2025-06-04 15:35:55,895 - DEBUG - Edge index tensor shape: torch.Size([2, 81])
2025-06-04 15:35:55,895 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:55,896 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:55,897 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:55,897 - DEBUG - Shape of encoded categorical edge features: torch.Size([81, 2])
2025-06-04 15:35:55,898 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:55,898 - DEBUG - Shape of scaled numerical edge features: torch.Size([81, 20])
2025-06-04 15:35:55,898 - DEBUG - Final edge attributes tensor shape: torch.Size([81, 22])
2025-06-04 15:35:55,898 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:55,898 - INFO - Performing online update...
2025-06-04 15:35:55,898 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:55,899 - DEBUG - Updated RunningStats: new_mean=[ 5.35586341e-10 -5.19367378e-10 -2.68307913e-09  2.46993481e-09
 -2.75130681e-08  1.52133924e-08 -1.07161260e-08 -2.38490868e-09
 -3.13355016e-09  8.19038242e-10  1.62891632e-09 -1.69225170e-09
  4.08576224e-09 -3.44891917e-09  9.06545686e-10  9.29301989e-10
 -3.91966585e-09  1.38479444e-09 -5.23596457e-09], new_M2=[180161.00532032 180161.00525154 180161.00045555 180161.00437154
 180160.99865526 180160.99836324 180160.99588059 180160.99835566
 180160.99315789 180160.99816602 180161.00201478 180160.9936364
 180160.99249981 140369.99643544 140370.00026992 140369.99903837
 140370.00007903 180161.00042492 180161.00758842], new_n=180161
2025-06-04 15:35:55,899 - DEBUG - Updated RunningStats: new_mean=[ 1.41686266e+00  5.52191590e+00  1.16269376e-10  3.01501479e-10
  1.59691699e-10 -1.77541440e-10 -1.30400994e-09  2.40162324e-10
  2.66091873e-10 -2.93170698e-10  3.59769969e-10 -3.80023865e-09
 -9.53993726e-10  6.44169872e-10  3.49820632e-10 -1.72325244e-10
 -1.72325244e-10 -1.72325244e-10 -1.72325244e-10 -1.72325244e-10
 -1.72325244e-10 -7.48329458e-11], new_M2=[  99965.41562753 1728916.84229924  388621.99903604  388622.00640948
  388622.00548411  388621.99333858  388622.00035488  388621.99903017
  388622.00172773  388621.99938636  388621.99311498  388622.00869441
  388622.00114805  388621.99975494  388622.00177156  388621.99444503
  388621.99444503  388621.99444503  388621.99444503  388621.99444503
  388621.99444503  388621.99935919], new_n=388622
2025-06-04 15:35:55,900 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88268704 0.88268706 0.88268705 0.88268706 1.
 1.00000002]
2025-06-04 15:35:55,900 - DEBUG - Calculated standard deviation: [0.50717892 2.10922719 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:55,900 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:55,900 - DEBUG - Online update step: 1/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,900 - DEBUG - Online update step: 2/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,900 - DEBUG - Online update step: 3/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,900 - DEBUG - Online update step: 4/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,900 - DEBUG - Online update step: 5/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,900 - DEBUG - Online update step: 6/50
2025-06-04 15:35:55,900 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 7/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 8/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 9/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 10/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 11/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 12/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 13/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 14/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 15/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 16/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 17/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 18/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,901 - DEBUG - Online update step: 19/50
2025-06-04 15:35:55,901 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 20/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 21/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 22/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 23/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 24/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 25/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 26/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 27/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 28/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 29/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 30/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 31/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 32/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 33/50
2025-06-04 15:35:55,902 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,902 - DEBUG - Online update step: 34/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 35/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 36/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 37/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 38/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 39/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 40/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 41/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 42/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 43/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 44/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 45/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 46/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 47/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,903 - DEBUG - Online update step: 48/50
2025-06-04 15:35:55,903 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,904 - DEBUG - Online update step: 49/50
2025-06-04 15:35:55,904 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,904 - DEBUG - Online update step: 50/50
2025-06-04 15:35:55,904 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:55,904 - WARNING - No successful steps during online update.
2025-06-04 15:35:55,904 - DEBUG - Current node mean: [-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], current edge mean: [ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 15:35:55,904 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1371
2025-06-04 15:35:55,904 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:35:55,905 - DEBUG - Updated reference mean: node=[-1.0276663e-08  1.0276663e-08 -2.4663992e-08  2.0553326e-08
  2.4663992e-08  1.6442661e-08  1.6442661e-08  0.0000000e+00
  4.1106651e-09  1.2331996e-08  1.6442661e-08  3.2885321e-08
 -1.4387328e-08 -3.2885321e-08  0.0000000e+00 -2.8774656e-08
 -2.0553326e-08 -8.2213303e-09  1.6442661e-08], edge=[ 1.0987654e+00  3.1234567e+00 -1.1773757e-08  8.8303178e-09
 -5.8868785e-09  4.4151589e-09  5.8868785e-09 -5.8868785e-09
  0.0000000e+00  2.0604075e-08 -1.4717196e-08  0.0000000e+00
  0.0000000e+00  8.8303178e-09  1.7660636e-08  5.8868785e-09
  5.8868785e-09  5.8868785e-09  5.8868785e-09  5.8868785e-09
  5.8868785e-09 -5.8868785e-09]
2025-06-04 15:35:55,905 - DEBUG - Updated reference std: node=[1.0087337 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087339 1.0087337 1.0087337 1.0087339 1.0087337 1.0087337
 1.0087337 1.0087337 1.0087339 1.0087339 1.0087337], edge=[0.3392985 2.1058414 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306 1.0062306
 1.0062306]
2025-06-04 15:35:55,905 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:55,905 - INFO - Running anomaly detection...
2025-06-04 15:35:55,905 - INFO - Starting anomaly detection.
2025-06-04 15:35:56,460 - DEBUG - Node reconstruction errors: [ 11.225786    9.259298  178.59256    11.225786   11.225786   11.225787
  11.225786   10.100751   11.225786    9.259298   11.225787    9.757323
  11.225786   10.4316435 129.96078    11.225689    9.757323   12.836151
  10.4316435  12.4144945  23.262619   11.225786   11.225786    9.869364
  11.225786   10.100751   10.4316435  10.4316435  10.4316435 146.3664
  10.431643  224.11865    10.4316435  11.225786   11.225786   10.4316435
 147.83525    11.225786   10.4316435  13.689587   11.225786   10.4316435
  11.225786   12.787951   11.225689   11.225786   10.4316435  10.431647
  11.225786   10.4316435  12.787951   17.322132   12.787951   10.100751
  12.787951   11.253537   11.225786   12.787951 ]
2025-06-04 15:35:56,461 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.19999999 0.19914562 0.1947155
 0.19960272 0.19696021 0.19833207 0.19746166 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8       ]
2025-06-04 15:35:56,579 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153556_update_10.json
2025-06-04 15:35:56,579 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:56,597 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153556_update_10.pth and as latest_checkpoint.pth
2025-06-04 15:35:56,598 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028354.dot): 1.0000
2025-06-04 15:35:56,598 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:35:56,598 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 178.5926, MLP Score: 0.0000
2025-06-04 15:35:56,598 - WARNING -   Node ID: 192.168.209.130, Recon Error: 146.3664, MLP Score: 1.0000
2025-06-04 15:35:56,598 - WARNING -   Node ID: 192.168.27.10, Recon Error: 224.1187, MLP Score: 0.0000
2025-06-04 15:35:56,598 - WARNING -   Node ID: 192.168.27.12, Recon Error: 147.8353, MLP Score: 1.0000
2025-06-04 15:35:56,598 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:56,598 - INFO - 
--- Processing file: nw_graph_encoded_1749028369.dot ---
2025-06-04 15:35:56,598 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot
2025-06-04 15:35:56,598 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028369.dot file.
2025-06-04 15:35:56,599 - INFO - Parsed 68 nodes.
2025-06-04 15:35:56,601 - INFO - Parsed 92 edges.
2025-06-04 15:35:56,605 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:35:56,605 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:35:56,605 - DEBUG - Initial node features tensor shape: torch.Size([68, 19])
2025-06-04 15:35:56,606 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:35:56,607 - DEBUG - Node features tensor shape after scaling: torch.Size([68, 19])
2025-06-04 15:35:56,607 - DEBUG - Edge index tensor shape: torch.Size([2, 92])
2025-06-04 15:35:56,607 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:35:56,608 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:35:56,608 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:35:56,608 - DEBUG - Shape of encoded categorical edge features: torch.Size([92, 2])
2025-06-04 15:35:56,609 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:35:56,609 - DEBUG - Shape of scaled numerical edge features: torch.Size([92, 20])
2025-06-04 15:35:56,609 - DEBUG - Final edge attributes tensor shape: torch.Size([92, 22])
2025-06-04 15:35:56,609 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:35:56,609 - INFO - Performing online update...
2025-06-04 15:35:56,610 - INFO - Starting online update for 50 steps.
2025-06-04 15:35:56,610 - DEBUG - Updated RunningStats: new_mean=[ 5.35549624e-10 -5.19254101e-10 -2.68578736e-09  2.46825880e-09
 -2.75073175e-08  1.52066603e-08 -1.07107599e-08 -2.38384350e-09
 -3.13348405e-09  8.22780494e-10  1.63656964e-09 -1.69194393e-09
  4.08885072e-09 -3.44976756e-09  9.03061844e-10  9.29447440e-10
 -3.91024978e-09  1.38093379e-09 -5.22935902e-09], new_M2=[180229.00532693 180229.00525816 180229.00045775 180229.00436954
 180228.9986559  180228.99836168 180228.99587827 180228.99835285
 180228.99315093 180228.99816262 180229.00200716 180228.99364284
 180228.99250046 140437.99644308 140438.00027799 140437.9990365
 140438.00008476 180229.00042704 180229.0075862 ], new_n=180229
2025-06-04 15:35:56,611 - DEBUG - Updated RunningStats: new_mean=[ 1.41678200e+00  5.52136275e+00  1.15762077e-10  3.01612209e-10
  1.58344540e-10 -1.77480253e-10 -1.30285795e-09  2.41432815e-10
  2.66039677e-10 -2.92176491e-10  3.61084029e-10 -3.79682831e-09
 -9.53317506e-10  6.45090778e-10  3.48357795e-10 -1.73367408e-10
 -1.73367408e-10 -1.73367408e-10 -1.73367408e-10 -1.73367408e-10
 -1.73367408e-10 -7.54597334e-11], new_M2=[  99986.56427348 1729831.10372411  388713.99903427  388714.00640935
  388714.00547625  388713.9933388   388714.00035258  388713.99903485
  388714.00172912  388713.99938661  388713.99312183  388714.00869162
  388714.00114737  388713.99975379  388714.00177022  388713.99443754
  388713.99443754  388713.99443754  388713.99443754  388713.99443754
  388713.99443754  388713.99935523], new_n=388714
2025-06-04 15:35:56,611 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88273425 0.88273426 0.88273426 0.88273426 1.
 1.00000002]
2025-06-04 15:35:56,611 - DEBUG - Calculated standard deviation: [0.50717254 2.10953512 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:35:56,611 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:35:56,611 - DEBUG - Online update step: 1/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,611 - DEBUG - Online update step: 2/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,611 - DEBUG - Online update step: 3/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,611 - DEBUG - Online update step: 4/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,611 - DEBUG - Online update step: 5/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,611 - DEBUG - Online update step: 6/50
2025-06-04 15:35:56,611 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 7/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 8/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 9/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 10/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 11/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 12/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 13/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 14/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 15/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 16/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 17/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 18/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 19/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 20/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,612 - DEBUG - Online update step: 21/50
2025-06-04 15:35:56,612 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 22/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 23/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 24/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 25/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 26/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 27/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 28/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 29/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 30/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 31/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 32/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 33/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 34/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 35/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 36/50
2025-06-04 15:35:56,613 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,613 - DEBUG - Online update step: 37/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 38/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 39/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 40/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 41/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 42/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 43/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 44/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 45/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 46/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 47/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 48/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 49/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - DEBUG - Online update step: 50/50
2025-06-04 15:35:56,614 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:35:56,614 - WARNING - No successful steps during online update.
2025-06-04 15:35:56,615 - DEBUG - Current node mean: [ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], current edge mean: [ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 15:35:56,615 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.1076
2025-06-04 15:35:56,615 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:35:56,615 - DEBUG - Updated reference mean: node=[ 0.0000000e+00  3.5061556e-09 -3.4185017e-08  2.8049245e-08
 -2.1036934e-08  1.7092509e-08  3.8567713e-08 -3.5061556e-09
 -3.3308478e-08 -9.6419281e-09  1.7530778e-09  2.4543089e-08
 -7.0123112e-09 -3.3308478e-08 -3.1555402e-08 -7.0123112e-09
  4.2073868e-08  0.0000000e+00  3.5061557e-08], edge=[ 1.0760870e+00  3.1847825e+00  0.0000000e+00  1.2957532e-09
 -9.0702716e-09  2.5915063e-09  1.2957532e-09 -1.5549038e-08
  5.1830127e-09  6.4787655e-09  4.4055607e-08  9.0702716e-09
  0.0000000e+00 -1.2957531e-08  1.0366025e-08 -2.5915063e-09
 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09 -2.5915063e-09
 -2.5915063e-09 -5.1830127e-09]
2025-06-04 15:35:56,616 - DEBUG - Updated reference std: node=[1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351
 1.0074351 1.007435  1.007435  1.007435  1.0074351 1.0074351 1.0074351
 1.0074351 1.0074351 1.0074351 1.0074351 1.0074351], edge=[0.33915523 2.127421   1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054796  1.0054795  1.0054795  1.0054796  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795  1.0054795  1.0054795
 1.0054795  1.0054795  1.0054795  1.0054795 ]
2025-06-04 15:35:56,616 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:35:56,616 - INFO - Running anomaly detection...
2025-06-04 15:35:56,616 - INFO - Starting anomaly detection.
2025-06-04 15:35:57,260 - DEBUG - Node reconstruction errors: [ 12.287773  12.287773  12.287773  12.287773 170.4044    12.318282
  12.31828   10.020051  17.70441   10.279424  11.082491  10.279424
  11.082493  10.279424  11.082491  12.891161  12.287773 171.17175
  10.279424  10.279426 244.31363   10.279424 137.82426   10.279424
  10.279426  10.020051  11.082493  10.828421  12.318282  11.082491
  10.279424  10.279425  12.287773   9.685605  11.082494  14.428408
  10.787453 134.21936   10.279426  11.08249   11.082493  10.787453
  10.279424   9.685605  12.318282  11.082491  12.318282   8.896967
   9.436279  21.75308   11.082491  11.082491  10.020051  11.082491
  11.702312  11.082495  11.082491  11.082491  12.287773  12.28777
  10.279424  11.082491  11.082494 170.07208    9.619622  11.082491
  11.082491  12.287773]
2025-06-04 15:35:57,262 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.19999999 0.19999999]
2025-06-04 15:35:57,376 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153557_update_11.json
2025-06-04 15:35:57,376 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:35:57,392 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153557_update_11.pth and as latest_checkpoint.pth
2025-06-04 15:35:57,392 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028369.dot): 1.0000
2025-06-04 15:35:57,392 - WARNING - Detected 4 anomalous nodes (reconstruction-based):
2025-06-04 15:35:57,392 - WARNING -   Node ID: fe80::84e3:94ff:fe03:126c, Recon Error: 170.4044, MLP Score: 0.0001
2025-06-04 15:35:57,392 - WARNING -   Node ID: 192.168.27.12, Recon Error: 171.1718, MLP Score: 0.9877
2025-06-04 15:35:57,392 - WARNING -   Node ID: 192.168.27.10, Recon Error: 244.3136, MLP Score: 0.0000
2025-06-04 15:35:57,393 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 170.0721, MLP Score: 0.0000
2025-06-04 15:35:57,393 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:35:58,023 - INFO - Starting 3D embedding visualization...
2025-06-04 15:36:11,615 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x79f9453cab40> <matplotlib.colors.Normalize object at 0x79f9453cab40>
2025-06-04 15:36:11,619 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f9451e76e0>
2025-06-04 15:36:11,621 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x79f9453cab40> <matplotlib.colors.Normalize object at 0x79f9453cab40>
2025-06-04 15:36:11,623 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f9451e76e0>
2025-06-04 15:36:11,626 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f9451e5340>
2025-06-04 15:36:11,993 - INFO - 3D embeddings visualization saved to vis/embeddings_3d_11_updates_20250604_153557.png
2025-06-04 15:36:11,993 - INFO - Performing visualization of node and edge features.
2025-06-04 15:36:11,993 - INFO - Starting visualization of node features.
2025-06-04 15:36:11,994 - INFO - Graph has 68 nodes and 19 features.
2025-06-04 15:36:11,994 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-04 15:36:11,994 - INFO - Calculating feature statistics:
2025-06-04 15:36:11,994 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 3, 'mean': np.float32(7.8888505e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3137314), 'max': np.float32(3.2138941)}
2025-06-04 15:36:11,994 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 3, 'mean': np.float32(-7.8888505e-09), 'std': np.float32(1.0), 'min': np.float32(-3.2138941), 'max': np.float32(0.3137314)}
2025-06-04 15:36:11,994 - INFO - - server_score: {'name': 'server_score', 'unique': 6, 'mean': np.float32(-3.1336267e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.8689933), 'max': np.float32(5.635342)}
2025-06-04 15:36:11,994 - INFO - - client_score: {'name': 'client_score', 'unique': 7, 'mean': np.float32(8.765389e-10), 'std': np.float32(1.0000001), 'min': np.float32(-0.26787958), 'max': np.float32(5.5366836)}
2025-06-04 15:36:11,995 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 2, 'mean': np.float32(1.0518467e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.31108552), 'max': np.float32(3.2145503)}
2025-06-04 15:36:11,995 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 7, 'mean': np.float32(6.1357723e-09), 'std': np.float32(1.0), 'min': np.float32(-0.28304532), 'max': np.float32(5.020001)}
2025-06-04 15:36:11,995 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 7, 'mean': np.float32(2.1036934e-08), 'std': np.float32(1.0), 'min': np.float32(-5.9950714), 'max': np.float32(0.2521996)}
2025-06-04 15:36:11,995 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 6, 'mean': np.float32(8.765389e-10), 'std': np.float32(1.0), 'min': np.float32(-0.27697536), 'max': np.float32(4.9966354)}
2025-06-04 15:36:11,995 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 4, 'mean': np.float32(-4.9305315e-10), 'std': np.float32(1.0), 'min': np.float32(-1.6947097), 'max': np.float32(6.905309)}
2025-06-04 15:36:11,995 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 6, 'mean': np.float32(-1.0518467e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.29942673), 'max': np.float32(3.9775536)}
2025-06-04 15:36:11,995 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 6, 'mean': np.float32(1.8407317e-08), 'std': np.float32(1.0), 'min': np.float32(-2.6244278), 'max': np.float32(0.47924337)}
2025-06-04 15:36:11,995 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 2, 'mean': np.float32(1.8407317e-08), 'std': np.float32(1.0), 'min': np.float32(-0.33875376), 'max': np.float32(2.951997)}
2025-06-04 15:36:11,996 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 2, 'mean': np.float32(-3.5061556e-09), 'std': np.float32(0.9999999), 'min': np.float32(-3.2145503), 'max': np.float32(0.31108552)}
2025-06-04 15:36:11,996 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 3, 'mean': np.float32(-8.765389e-09), 'std': np.float32(1.0), 'min': np.float32(-1.5975674), 'max': np.float32(1.0202055)}
2025-06-04 15:36:11,996 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 3, 'mean': np.float32(-1.7530779e-08), 'std': np.float32(1.0000001), 'min': np.float32(-1.0050591), 'max': np.float32(1.6276143)}
2025-06-04 15:36:11,996 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 3, 'mean': np.float32(3.1555402e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.1954559), 'max': np.float32(1.5136075)}
2025-06-04 15:36:11,996 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 3, 'mean': np.float32(8.765389e-09), 'std': np.float32(1.0), 'min': np.float32(-1.1904813), 'max': np.float32(1.5211649)}
2025-06-04 15:36:11,996 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 6, 'mean': np.float32(-3.5061556e-09), 'std': np.float32(0.99999994), 'min': np.float32(-3.1060073), 'max': np.float32(0.38859296)}
2025-06-04 15:36:11,996 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 6, 'mean': np.float32(2.2790012e-08), 'std': np.float32(1.0000001), 'min': np.float32(-1.8902164), 'max': np.float32(1.6818346)}
2025-06-04 15:36:12,019 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x79f9453c8e30>
2025-06-04 15:36:12,203 - DEBUG - Plotted correlation matrix of node features.
2025-06-04 15:36:12,272 - DEBUG - Plotted ranges of node feature values.
2025-06-04 15:36:12,308 - DEBUG - Plotted sparsity of node features.
2025-06-04 15:36:13,683 - INFO - Node feature visualization saved to vis/node_features_20250604_153612.png
2025-06-04 15:36:13,683 - INFO - Finished visualization of node features.
2025-06-04 15:36:13,683 - INFO - Performing additional feature analysis:
2025-06-04 15:36:13,683 - INFO - - Maximum correlation between different features: 1.00
2025-06-04 15:36:13,683 - INFO - Starting visualization of edge features.
2025-06-04 15:36:13,683 - INFO - Graph has 92 edges and 22 edge features.
2025-06-04 15:36:13,683 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-04 15:36:13,683 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-04 15:36:13,684 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 491, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-04 15:36:13,684 - INFO - 
--- Processing file: nw_graph_encoded_1749028384.dot ---
2025-06-04 15:36:13,684 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028384.dot
2025-06-04 15:36:13,684 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028384.dot file.
2025-06-04 15:36:13,685 - INFO - Parsed 70 nodes.
2025-06-04 15:36:13,686 - INFO - Parsed 95 edges.
2025-06-04 15:36:13,689 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:36:13,689 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:36:13,689 - DEBUG - Initial node features tensor shape: torch.Size([70, 19])
2025-06-04 15:36:13,690 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:36:13,690 - DEBUG - Node features tensor shape after scaling: torch.Size([70, 19])
2025-06-04 15:36:13,690 - DEBUG - Edge index tensor shape: torch.Size([2, 95])
2025-06-04 15:36:13,690 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:36:13,691 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:36:13,691 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:36:13,692 - DEBUG - Shape of encoded categorical edge features: torch.Size([95, 2])
2025-06-04 15:36:13,692 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:36:13,692 - DEBUG - Shape of scaled numerical edge features: torch.Size([95, 20])
2025-06-04 15:36:13,692 - DEBUG - Final edge attributes tensor shape: torch.Size([95, 22])
2025-06-04 15:36:13,692 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:36:13,692 - INFO - Performing online update...
2025-06-04 15:36:13,692 - INFO - Starting online update for 50 steps.
2025-06-04 15:36:13,693 - DEBUG - Updated RunningStats: new_mean=[ 5.37159933e-10 -5.20788090e-10 -2.68185198e-09  2.46738316e-09
 -2.74966380e-08  1.52020787e-08 -1.07099074e-08 -2.38407504e-09
 -3.13075918e-09  8.20642822e-10  1.64502542e-09 -1.69475822e-09
  4.08726325e-09 -3.44818026e-09  9.00479769e-10  9.31400702e-10
 -3.90112813e-09  1.38767058e-09 -5.23063463e-09], new_M2=[180299.0053244  180299.00525564 180299.00045863 180299.00436497
 180298.998661   180298.9983646  180298.99588018 180298.99835365
 180298.99314428 180298.99815815 180299.00200599 180298.99364326
 180298.99250556 140507.99644308 140508.00028639 140507.99903417
 140508.00008855 180299.00042926 180299.00758755], new_n=180299
2025-06-04 15:36:13,693 - DEBUG - Updated RunningStats: new_mean=[ 1.41669817e+00  5.52080585e+00  1.16196089e-10  3.00762431e-10
  1.57491442e-10 -1.76718291e-10 -1.30209169e-09  2.43202653e-10
  2.65665677e-10 -2.91913476e-10  3.61647331e-10 -3.79690185e-09
 -9.55436782e-10  6.44013355e-10  3.41834055e-10 -1.72536987e-10
 -1.72536987e-10 -1.72536987e-10 -1.72536987e-10 -1.72536987e-10
 -1.72536987e-10 -7.67826760e-11], new_M2=[ 100008.22878071 1730745.94111251  388808.99903847  388809.00640321
  388809.00547199  388808.99334475  388809.00035525  388808.9990404
  388809.00172837  388808.99938687  388808.99312905  388809.00869174
  388809.00114677  388808.99975398  388809.00177085  388808.99444268
  388808.99444268  388808.99444268  388808.99444268  388808.99444268
  388808.99444268  388808.99934755], new_n=388809
2025-06-04 15:36:13,693 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.8827828  0.88278281 0.88278281 0.88278281 1.
 1.00000002]
2025-06-04 15:36:13,694 - DEBUG - Calculated standard deviation: [0.50716551 2.10983507 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:36:13,694 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:36:13,694 - DEBUG - Online update step: 1/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 2/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 3/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 4/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 5/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 6/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 7/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 8/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 9/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 10/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 11/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 12/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 13/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 14/50
2025-06-04 15:36:13,694 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,694 - DEBUG - Online update step: 15/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 16/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 17/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 18/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 19/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 20/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 21/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 22/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 23/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 24/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 25/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 26/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 27/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 28/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 29/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 30/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 31/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 32/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,695 - DEBUG - Online update step: 33/50
2025-06-04 15:36:13,695 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 34/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 35/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 36/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 37/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 38/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 39/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 40/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 41/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 42/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 43/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 44/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 45/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 46/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 47/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 48/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 49/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - DEBUG - Online update step: 50/50
2025-06-04 15:36:13,696 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:13,696 - WARNING - No successful steps during online update.
2025-06-04 15:36:13,697 - DEBUG - Current node mean: [ 4.4277737e-08 -4.4277737e-08 -3.4059797e-09 -2.3841858e-08
  1.3623919e-08 -4.0871758e-08 -1.3623919e-08 -1.8732889e-08
  1.0217939e-08 -1.7029899e-08  3.7465778e-08 -6.8119594e-09
 -1.7029899e-08  3.4059797e-09  6.8119594e-09  2.7247838e-08
  2.2138869e-08  0.0000000e+00 -2.7247838e-08], current edge mean: [ 1.07368422e+00  3.24210525e+00 -5.01933872e-09 -4.39192105e-09
 -6.27417318e-09  6.27417318e-09  7.52900764e-09  2.50966927e-08
  0.00000000e+00 -5.01933872e-09  2.25870238e-08 -1.75676842e-08
 -2.50966936e-09 -1.00386774e-08 -4.51740476e-08  7.52900764e-09
  7.52900764e-09  7.52900764e-09  7.52900764e-09  7.52900764e-09
  7.52900764e-09 -5.01933872e-09]
2025-06-04 15:36:13,697 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0800
2025-06-04 15:36:13,697 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:36:13,697 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:36:13,697 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:36:13,697 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:36:13,698 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:36:13,699 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:36:13,699 - INFO - Optimizer and scheduler reset.
2025-06-04 15:36:13,700 - DEBUG - Updated reference mean: node=[ 4.4277737e-08 -4.4277737e-08 -3.4059797e-09 -2.3841858e-08
  1.3623919e-08 -4.0871758e-08 -1.3623919e-08 -1.8732889e-08
  1.0217939e-08 -1.7029899e-08  3.7465778e-08 -6.8119594e-09
 -1.7029899e-08  3.4059797e-09  6.8119594e-09  2.7247838e-08
  2.2138869e-08  0.0000000e+00 -2.7247838e-08], edge=[ 1.07368422e+00  3.24210525e+00 -5.01933872e-09 -4.39192105e-09
 -6.27417318e-09  6.27417318e-09  7.52900764e-09  2.50966927e-08
  0.00000000e+00 -5.01933872e-09  2.25870238e-08 -1.75676842e-08
 -2.50966936e-09 -1.00386774e-08 -4.51740476e-08  7.52900764e-09
  7.52900764e-09  7.52900764e-09  7.52900764e-09  7.52900764e-09
  7.52900764e-09 -5.01933872e-09]
2025-06-04 15:36:13,700 - DEBUG - Updated reference std: node=[1.0072203 1.0072203 1.0072203 1.0072203 1.0072204 1.0072204 1.0072203
 1.0072203 1.0072203 1.0072203 1.0072203 1.0072203 1.0072204 1.0072203
 1.0072204 1.0072203 1.0072204 1.0072203 1.0072203], edge=[0.3339673 2.117384  1.005305  1.005305  1.005305  1.005305  1.005305
 1.005305  1.005305  1.005305  1.0053052 1.005305  1.005305  1.005305
 1.005305  1.005305  1.005305  1.005305  1.005305  1.005305  1.005305
 1.005305 ]
2025-06-04 15:36:13,700 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:36:13,700 - INFO - Running anomaly detection...
2025-06-04 15:36:13,700 - INFO - Starting anomaly detection.
2025-06-04 15:36:14,386 - DEBUG - Node reconstruction errors: [ 10.341121  10.341121  10.341121  10.341121  10.341121 372.56836
  11.793688  11.793689   9.94981   13.163689  11.037298  10.267494
  11.037294  10.267491  11.037296   9.119726  10.439846  10.341121
 614.28595   11.037298  11.037296 992.4123    11.037296 260.01242
  11.037296  11.037296   9.949811  10.267491  10.927652  11.793689
  10.267494  11.037295  11.037295  10.341121  11.037219  10.267494
  18.447273   9.977246 342.4446    11.037296  10.267494  10.267491
   9.977246  11.037296  11.03722   11.793689  10.267494  11.793689
  15.742746  15.421591  61.297947  10.267494  10.267494   9.94981
  10.267491   8.294177  10.267494  10.267494  10.267494  10.341121
  10.341121  11.037295  10.267495  10.341121  10.267494 365.11636
  14.204752  10.267494  10.267491  10.341122]
2025-06-04 15:36:14,387 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.8        0.19999999]
2025-06-04 15:36:14,485 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153614_update_12.json
2025-06-04 15:36:14,486 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:36:14,507 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153614_update_12.pth and as latest_checkpoint.pth
2025-06-04 15:36:14,508 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028384.dot): 0.0000
2025-06-04 15:36:14,508 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 15:36:14,508 - WARNING -   Node ID: 192.168.27.12, Recon Error: 614.2859, MLP Score: 1.0000
2025-06-04 15:36:14,508 - WARNING -   Node ID: 192.168.27.10, Recon Error: 992.4123, MLP Score: 1.0000
2025-06-04 15:36:14,508 - WARNING - Detected 1 anomalous edges (reconstruction-based):
2025-06-04 15:36:14,508 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-04 15:36:14,508 - INFO - 
--- Processing file: nw_graph_encoded_1749028399.dot ---
2025-06-04 15:36:14,508 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028399.dot
2025-06-04 15:36:14,508 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028399.dot file.
2025-06-04 15:36:14,510 - INFO - Parsed 73 nodes.
2025-06-04 15:36:14,511 - INFO - Parsed 98 edges.
2025-06-04 15:36:14,515 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:36:14,515 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:36:14,516 - DEBUG - Initial node features tensor shape: torch.Size([73, 19])
2025-06-04 15:36:14,517 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:36:14,517 - DEBUG - Node features tensor shape after scaling: torch.Size([73, 19])
2025-06-04 15:36:14,517 - DEBUG - Edge index tensor shape: torch.Size([2, 98])
2025-06-04 15:36:14,517 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:36:14,518 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:36:14,518 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-04 15:36:14,519 - DEBUG - Shape of encoded categorical edge features: torch.Size([98, 2])
2025-06-04 15:36:14,519 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:36:14,519 - DEBUG - Shape of scaled numerical edge features: torch.Size([98, 20])
2025-06-04 15:36:14,520 - DEBUG - Final edge attributes tensor shape: torch.Size([98, 22])
2025-06-04 15:36:14,520 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:36:14,520 - INFO - Performing online update...
2025-06-04 15:36:14,520 - INFO - Starting online update for 50 steps.
2025-06-04 15:36:14,520 - DEBUG - Updated RunningStats: new_mean=[ 5.43799454e-10 -5.27351623e-10 -2.68415374e-09  2.47555466e-09
 -2.74825355e-08  1.52000568e-08 -1.07052425e-08 -2.39004970e-09
 -3.13212541e-09  8.09405710e-10  1.65427326e-09 -1.69208959e-09
  4.08263497e-09 -3.42724663e-09  8.99578339e-10  9.27719206e-10
 -3.90549744e-09  1.39446350e-09 -5.22802201e-09], new_M2=[180372.00532902 180372.00526026 180372.00046153 180372.00436841
 180371.99866813 180371.99835966 180371.99588093 180371.99834985
 180371.99314143 180371.99815293 180372.00200744 180371.99364268
 180371.99251268 140580.99644781 140581.00028407 140580.99903457
 140581.00008496 180372.00042767 180372.00758494], new_n=180372
2025-06-04 15:36:14,521 - DEBUG - Updated RunningStats: new_mean=[ 1.41661117e+00  5.52024520e+00  1.15511854e-10  3.00792009e-10
  1.56259186e-10 -1.75503941e-10 -1.30170431e-09  2.43408379e-10
  2.65004843e-10 -2.93147434e-10  3.60923995e-10 -3.79568286e-09
 -9.56460434e-10  6.42165190e-10  3.42054440e-10 -1.72075632e-10
 -1.72075632e-10 -1.72075632e-10 -1.72075632e-10 -1.72075632e-10
 -1.72075632e-10 -7.66675389e-11], new_M2=[ 100030.4085244  1731661.34941776  388906.99903429  388907.00640084
  388907.00546376  388906.99335196  388907.00035532  388906.99904616
  388907.00172707  388906.99938613  388906.99312817  388907.00869029
  388907.00114779  388906.99975194  388907.00177536  388906.99444376
  388906.99444376  388906.99444376  388906.99444376  388906.99444376
  388906.99444376  388906.99934589], new_n=388907
2025-06-04 15:36:14,521 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88283339 0.8828334  0.88283339 0.8828334  1.
 1.00000002]
2025-06-04 15:36:14,521 - DEBUG - Calculated standard deviation: [0.50715784 2.11012704 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:36:14,521 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:36:14,521 - DEBUG - Online update step: 1/50
2025-06-04 15:36:14,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,521 - DEBUG - Online update step: 2/50
2025-06-04 15:36:14,521 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 3/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 4/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 5/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 6/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 7/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 8/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 9/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 10/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 11/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 12/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 13/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 14/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 15/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 16/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,522 - DEBUG - Online update step: 17/50
2025-06-04 15:36:14,522 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 18/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 19/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 20/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 21/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 22/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 23/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 24/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 25/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 26/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 27/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 28/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 29/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,523 - DEBUG - Online update step: 30/50
2025-06-04 15:36:14,523 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 31/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 32/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 33/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 34/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 35/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 36/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 37/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 38/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 39/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 40/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 41/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 42/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 43/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 44/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 45/50
2025-06-04 15:36:14,524 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,524 - DEBUG - Online update step: 46/50
2025-06-04 15:36:14,525 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,525 - DEBUG - Online update step: 47/50
2025-06-04 15:36:14,525 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,525 - DEBUG - Online update step: 48/50
2025-06-04 15:36:14,525 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,525 - DEBUG - Online update step: 49/50
2025-06-04 15:36:14,525 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,525 - DEBUG - Online update step: 50/50
2025-06-04 15:36:14,525 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:14,525 - WARNING - No successful steps during online update.
2025-06-04 15:36:14,525 - DEBUG - Current node mean: [ 6.5320158e-09 -6.5320158e-09 -4.2458105e-08  0.0000000e+00
  1.4697036e-08 -1.9596047e-08  1.9596047e-08  1.3064032e-08
  1.6330040e-09 -1.4697036e-08  1.4697036e-08 -6.5320158e-09
 -2.6128063e-08  7.1852178e-08  0.0000000e+00 -1.6330040e-08
 -2.2862055e-08  3.9192095e-08 -1.3064032e-08], current edge mean: [ 1.0714285e+00  3.2959185e+00  4.8656852e-09  2.4328426e-09
  2.4328426e-09  1.2164213e-09 -2.4328426e-09  0.0000000e+00
  2.4328426e-09  2.4328426e-09 -6.5686748e-08  1.2164213e-09
 -1.2164213e-09  4.8656852e-09  1.2164213e-09 -4.8656852e-09
 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09
 -4.8656852e-09  1.2164213e-09]
2025-06-04 15:36:14,525 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 1.0541
2025-06-04 15:36:14,526 - WARNING - Feature drift detected (1 consecutive)
2025-06-04 15:36:14,526 - DEBUG - Updated reference mean: node=[ 6.5320158e-09 -6.5320158e-09 -4.2458105e-08  0.0000000e+00
  1.4697036e-08 -1.9596047e-08  1.9596047e-08  1.3064032e-08
  1.6330040e-09 -1.4697036e-08  1.4697036e-08 -6.5320158e-09
 -2.6128063e-08  7.1852178e-08  0.0000000e+00 -1.6330040e-08
 -2.2862055e-08  3.9192095e-08 -1.3064032e-08], edge=[ 1.0714285e+00  3.2959185e+00  4.8656852e-09  2.4328426e-09
  2.4328426e-09  1.2164213e-09 -2.4328426e-09  0.0000000e+00
  2.4328426e-09  2.4328426e-09 -6.5686748e-08  1.2164213e-09
 -1.2164213e-09  4.8656852e-09  1.2164213e-09 -4.8656852e-09
 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09 -4.8656852e-09
 -4.8656852e-09  1.2164213e-09]
2025-06-04 15:36:14,526 - DEBUG - Updated reference std: node=[1.0069206 1.0069206 1.0069206 1.0069206 1.0069206 1.0069205 1.0069205
 1.0069205 1.0069205 1.0069205 1.0069205 1.0069205 1.0069206 1.0069206
 1.0069205 1.0069205 1.0069205 1.0069205 1.0069205], edge=[0.32900977 2.1064906  1.0051414  1.0051414  1.0051414  1.0051415
 1.0051414  1.0051415  1.0051414  1.0051414  1.0051414  1.0051414
 1.0051414  1.0051414  1.0051415  1.0051414  1.0051414  1.0051414
 1.0051414  1.0051414  1.0051414  1.0051414 ]
2025-06-04 15:36:14,526 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:36:14,526 - INFO - Running anomaly detection...
2025-06-04 15:36:14,526 - INFO - Starting anomaly detection.
2025-06-04 15:36:15,197 - DEBUG - Node reconstruction errors: [  10.933327    10.933327    10.189557    10.189557    10.189557
   10.189557    10.189552   387.51508     11.687813    11.687813
   10.004169    13.302599    10.99645     10.298561    10.933327
   10.996452    10.298563    10.996455     8.996961    10.902891
   10.189557   670.9068      10.996452    10.996452  1026.6597
   10.996451   269.82007     10.99645     10.996448    10.004164
   10.298561    10.68376     11.687813    10.298563    10.996452
   10.996451    10.189552    10.998568    10.298561    18.57698
    9.822319   352.41214     10.996448    10.298561    10.298561
    9.822319    10.996452    10.998571    11.687813    10.298566
   11.687813    15.692611    14.905494    62.98102     10.298561
   10.298561    10.004169    10.298561     9.030132    10.298565
   10.298563    10.298563    10.189552    10.189552    10.996452
   10.298563    10.189557    10.298563   380.94525     14.000193
   10.298561    10.298561    10.1895485]
2025-06-04 15:36:15,200 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.8        0.19999999]
2025-06-04 15:36:15,317 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153615_update_13.json
2025-06-04 15:36:15,318 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:36:15,332 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153615_update_13.pth and as latest_checkpoint.pth
2025-06-04 15:36:15,332 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028399.dot): 0.0000
2025-06-04 15:36:15,332 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 15:36:15,332 - WARNING -   Node ID: 192.168.27.12, Recon Error: 670.9068, MLP Score: 1.0000
2025-06-04 15:36:15,332 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1026.6597, MLP Score: 1.0000
2025-06-04 15:36:15,332 - WARNING - Detected 1 anomalous edges (reconstruction-based):
2025-06-04 15:36:15,332 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-04 15:36:15,333 - INFO - 
--- Processing file: nw_graph_encoded_1749028414.dot ---
2025-06-04 15:36:15,333 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028414.dot
2025-06-04 15:36:15,333 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028414.dot file.
2025-06-04 15:36:15,334 - INFO - Parsed 79 nodes.
2025-06-04 15:36:15,336 - INFO - Parsed 109 edges.
2025-06-04 15:36:15,341 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:36:15,341 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:36:15,342 - DEBUG - Initial node features tensor shape: torch.Size([79, 19])
2025-06-04 15:36:15,343 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:36:15,343 - DEBUG - Node features tensor shape after scaling: torch.Size([79, 19])
2025-06-04 15:36:15,343 - DEBUG - Edge index tensor shape: torch.Size([2, 109])
2025-06-04 15:36:15,343 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:36:15,345 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:36:15,345 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:36:15,346 - DEBUG - Shape of encoded categorical edge features: torch.Size([109, 2])
2025-06-04 15:36:15,346 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:36:15,346 - DEBUG - Shape of scaled numerical edge features: torch.Size([109, 20])
2025-06-04 15:36:15,347 - DEBUG - Final edge attributes tensor shape: torch.Size([109, 22])
2025-06-04 15:36:15,347 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:36:15,347 - INFO - Performing online update...
2025-06-04 15:36:15,347 - INFO - Starting online update for 50 steps.
2025-06-04 15:36:15,347 - DEBUG - Updated RunningStats: new_mean=[ 5.44872298e-10 -5.27987815e-10 -2.68326766e-09  2.47504893e-09
 -2.74638976e-08  1.52006692e-08 -1.07051801e-08 -2.38718665e-09
 -3.13091934e-09  8.12189297e-10  1.65057625e-09 -1.69828530e-09
  4.07424144e-09 -3.42425981e-09  8.88243015e-10  9.28964605e-10
 -3.91204537e-09  1.40136756e-09 -5.22887117e-09], new_M2=[180451.00533656 180451.0052678  180451.00046467 180451.00436971
 180450.9986703  180450.99835983 180450.99587782 180450.99834893
 180450.99313276 180450.99815581 180451.00201148 180450.99364182
 180450.99251485 140659.99645171 140660.00028388 140659.99903098
 140660.00008372 180451.00042711 180451.00758168], new_n=180451
2025-06-04 15:36:15,348 - DEBUG - Updated RunningStats: new_mean=[ 1.41652785e+00  5.51980895e+00  1.16755515e-10  3.01167386e-10
  1.56344682e-10 -1.74372656e-10 -1.30274129e-09  2.43462274e-10
  2.64320108e-10 -2.94780630e-10  3.61071847e-10 -3.79627840e-09
 -9.56884319e-10  6.36919456e-10  3.42111818e-10 -1.72420041e-10
 -1.72420041e-10 -1.72420041e-10 -1.72420041e-10 -1.72420041e-10
 -1.72420041e-10 -7.64018644e-11], new_M2=[ 100055.49250416 1732619.35220149  389015.99904021  389016.00640574
  389016.00546699  389015.99336106  389016.0003549   389015.99904994
  389016.00172768  389015.99938567  389015.99313184  389016.00869327
  389016.00114698  389015.9997515   389016.00177613  389015.99444039
  389015.99444039  389015.99444039  389015.99444039  389015.99444039
  389015.99444039  389015.99934674], new_n=389016
2025-06-04 15:36:15,348 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88288808 0.88288809 0.88288809 0.88288809 1.
 1.00000002]
2025-06-04 15:36:15,348 - DEBUG - Calculated standard deviation: [0.50715036 2.11041492 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:36:15,349 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:36:15,349 - DEBUG - Online update step: 1/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 2/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 3/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 4/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 5/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 6/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 7/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 8/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 9/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 10/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 11/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 12/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 13/50
2025-06-04 15:36:15,349 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,349 - DEBUG - Online update step: 14/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 15/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 16/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 17/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 18/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 19/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 20/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 21/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 22/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 23/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 24/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 25/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 26/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 27/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 28/50
2025-06-04 15:36:15,350 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,350 - DEBUG - Online update step: 29/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 30/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 31/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 32/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 33/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 34/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 35/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 36/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 37/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 38/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 39/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 40/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 41/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 42/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 43/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,351 - DEBUG - Online update step: 44/50
2025-06-04 15:36:15,351 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 45/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 46/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 47/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 48/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 49/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - DEBUG - Online update step: 50/50
2025-06-04 15:36:15,352 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:15,352 - WARNING - No successful steps during online update.
2025-06-04 15:36:15,353 - DEBUG - Current node mean: [ 5.1305264e-08 -5.1305264e-08  7.5448919e-10  0.0000000e+00
  1.2071827e-08  4.8287308e-08 -3.6215479e-08 -6.0359135e-09
 -9.0538697e-09  6.0359135e-09  0.0000000e+00 -6.0359135e-09
 -1.2071827e-08  1.2071827e-08 -4.2251393e-08 -5.6586686e-09
 -5.0928019e-08  1.8107739e-08 -3.0179568e-09], current edge mean: [ 1.1192660e+00  3.9633029e+00  8.7493053e-09  4.3746526e-09
  6.5619794e-09 -4.3746526e-09 -8.7493053e-09  0.0000000e+00
 -1.3123959e-08 -1.3123959e-08  1.3123959e-08 -2.1873263e-09
 -8.7493053e-09 -2.2966928e-08 -2.6247918e-08 -4.3746526e-09
 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09
 -4.3746526e-09  6.5619794e-09]
2025-06-04 15:36:15,353 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7375
2025-06-04 15:36:15,353 - WARNING - Feature drift detected (2 consecutive)
2025-06-04 15:36:15,353 - DEBUG - Updated reference mean: node=[ 5.1305264e-08 -5.1305264e-08  7.5448919e-10  0.0000000e+00
  1.2071827e-08  4.8287308e-08 -3.6215479e-08 -6.0359135e-09
 -9.0538697e-09  6.0359135e-09  0.0000000e+00 -6.0359135e-09
 -1.2071827e-08  1.2071827e-08 -4.2251393e-08 -5.6586686e-09
 -5.0928019e-08  1.8107739e-08 -3.0179568e-09], edge=[ 1.1192660e+00  3.9633029e+00  8.7493053e-09  4.3746526e-09
  6.5619794e-09 -4.3746526e-09 -8.7493053e-09  0.0000000e+00
 -1.3123959e-08 -1.3123959e-08  1.3123959e-08 -2.1873263e-09
 -8.7493053e-09 -2.2966928e-08 -2.6247918e-08 -4.3746526e-09
 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09 -4.3746526e-09
 -4.3746526e-09  6.5619794e-09]
2025-06-04 15:36:15,354 - DEBUG - Updated reference std: node=[1.0063899 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899
 1.0063899 1.0063897 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899
 1.0063899 1.0063899 1.0063899 1.0063899 1.0063899], edge=[0.37822124 2.534673   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619   1.004619   1.004619
 1.004619   1.004619   1.004619   1.004619  ]
2025-06-04 15:36:15,354 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:36:15,354 - INFO - Running anomaly detection...
2025-06-04 15:36:15,354 - INFO - Starting anomaly detection.
2025-06-04 15:36:16,009 - DEBUG - Node reconstruction errors: [  16.72847     10.747943    10.747943    10.747943    10.253532
   10.253532    10.253532    10.253532    10.253532   381.2268
   11.710702    11.710702    10.214495    12.6008415   11.078764
   10.500702    10.747943    11.078764    10.500706    11.078764
    9.10405     10.771252    13.073841   761.93976      8.709726
   11.078764    11.078764  1041.8684      11.078764   264.4079
   11.078764    11.078764    10.214495    10.747943    10.500706
   11.260607    11.710702    10.500706    11.078764    11.078764
   10.253532    11.084755    10.500706    17.778154     9.886402
  161.40428    339.25183     11.078764    10.500704    10.500706
    9.886402    11.078764    11.084755    11.710702    10.500705
   11.710698    15.701334    14.462563    58.834118    10.500706
   10.500706    10.214495    10.500702     9.027193    10.500704
   10.747943    10.500706    10.500706    10.253532    10.253531
   11.078764    10.500702    10.253532    10.500706   375.42505
   13.947574    10.500701    10.500701    10.253532 ]
2025-06-04 15:36:16,010 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.19999999]
2025-06-04 15:36:16,116 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153616_update_14.json
2025-06-04 15:36:16,117 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:36:16,135 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153616_update_14.pth and as latest_checkpoint.pth
2025-06-04 15:36:16,135 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028414.dot): 0.0000
2025-06-04 15:36:16,135 - WARNING - Detected 2 anomalous nodes (reconstruction-based):
2025-06-04 15:36:16,135 - WARNING -   Node ID: 192.168.27.12, Recon Error: 761.9398, MLP Score: 1.0000
2025-06-04 15:36:16,135 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1041.8684, MLP Score: 1.0000
2025-06-04 15:36:16,135 - WARNING - Detected 2 anomalous edges (reconstruction-based):
2025-06-04 15:36:16,136 - WARNING -   Source: 192.168.239.101, Target: 1.1.1.1, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-04 15:36:16,136 - WARNING -   Source: 192.168.239.101, Target: 91.189.91.157, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-04 15:36:16,136 - INFO - 
--- Processing file: nw_graph_encoded_1749028429.dot ---
2025-06-04 15:36:16,136 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028429.dot
2025-06-04 15:36:16,136 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028429.dot file.
2025-06-04 15:36:16,138 - INFO - Parsed 82 nodes.
2025-06-04 15:36:16,140 - INFO - Parsed 117 edges.
2025-06-04 15:36:16,145 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:36:16,145 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:36:16,146 - DEBUG - Initial node features tensor shape: torch.Size([82, 19])
2025-06-04 15:36:16,147 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:36:16,147 - DEBUG - Node features tensor shape after scaling: torch.Size([82, 19])
2025-06-04 15:36:16,147 - DEBUG - Edge index tensor shape: torch.Size([2, 117])
2025-06-04 15:36:16,147 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:36:16,149 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:36:16,149 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:36:16,149 - DEBUG - Shape of encoded categorical edge features: torch.Size([117, 2])
2025-06-04 15:36:16,150 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:36:16,150 - DEBUG - Shape of scaled numerical edge features: torch.Size([117, 20])
2025-06-04 15:36:16,150 - DEBUG - Final edge attributes tensor shape: torch.Size([117, 22])
2025-06-04 15:36:16,150 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:36:16,150 - INFO - Performing online update...
2025-06-04 15:36:16,151 - INFO - Starting online update for 50 steps.
2025-06-04 15:36:16,151 - DEBUG - Updated RunningStats: new_mean=[ 5.51986331e-10 -5.34671025e-10 -2.68237905e-09  2.46971520e-09
 -2.74434994e-08  1.51935998e-08 -1.07004828e-08 -2.39600714e-09
 -3.13407821e-09  8.20569613e-10  1.63331858e-09 -1.70048536e-09
  4.06446705e-09 -3.42584099e-09  9.00550698e-10  9.26561704e-10
 -3.92347485e-09  1.40132945e-09 -5.21890250e-09], new_M2=[180533.00533907 180533.00527031 180533.00046876 180533.00437277
 180532.99867482 180532.99836052 180532.99587873 180532.99834838
 180532.99313576 180532.99815963 180533.00200913 180532.99363439
 180532.99251937 140741.99645102 140742.00028398 140741.99903062
 140742.00008814 180533.00043008 180533.00757817], new_n=180533
2025-06-04 15:36:16,152 - DEBUG - Updated RunningStats: new_mean=[ 1.41643603e+00  5.51935200e+00  1.16389682e-10  3.00928449e-10
  1.57427324e-10 -1.73946869e-10 -1.30392920e-09  2.44930376e-10
  2.62962973e-10 -2.94196879e-10  3.60264432e-10 -3.79575207e-09
 -9.57731051e-10  6.37407659e-10  3.46297798e-10 -1.71602335e-10
 -1.71602335e-10 -1.71602335e-10 -1.71602335e-10 -1.71602335e-10
 -1.71602335e-10 -7.70777443e-11], new_M2=[ 100081.95846664 1733639.51979918  389132.99903992  389133.00640724
  389133.00547499  389132.99336265  389133.0003557   389132.99905413
  389133.00172871  389132.99938787  389132.99312645  389133.00869457
  389133.00114923  389132.99974915  389133.00178063  389132.99444689
  389132.99444689  389132.99444689  389132.99444689  389132.99444689
  389132.99444689  389132.99933983], new_n=389133
2025-06-04 15:36:16,152 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.8829448  0.88294481 0.88294481 0.88294481 1.
 1.00000002]
2025-06-04 15:36:16,152 - DEBUG - Calculated standard deviation: [0.50714117 2.11071875 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:36:16,152 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:36:16,152 - DEBUG - Online update step: 1/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 2/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 3/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 4/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 5/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 6/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,152 - DEBUG - Online update step: 7/50
2025-06-04 15:36:16,152 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 8/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 9/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 10/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 11/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 12/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 13/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 14/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 15/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 16/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 17/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 18/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 19/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 20/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 21/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 22/50
2025-06-04 15:36:16,153 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,153 - DEBUG - Online update step: 23/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 24/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 25/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 26/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 27/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 28/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 29/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 30/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 31/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 32/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 33/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 34/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 35/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 36/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 37/50
2025-06-04 15:36:16,154 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,154 - DEBUG - Online update step: 38/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 39/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 40/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 41/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 42/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 43/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 44/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 45/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 46/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 47/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 48/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 49/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - DEBUG - Online update step: 50/50
2025-06-04 15:36:16,155 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-04 15:36:16,155 - WARNING - No successful steps during online update.
2025-06-04 15:36:16,156 - DEBUG - Current node mean: [ 3.4890522e-08 -3.4890522e-08  7.2688593e-09 -1.1630174e-08
  2.9075437e-08  1.7445261e-08 -1.1630174e-08 -4.6520697e-08
 -1.0176403e-08  1.1630174e-08 -4.6520697e-08 -1.1630174e-08
 -4.0705611e-08  5.8150871e-09  8.1411223e-08 -1.0176403e-08
 -3.2709867e-08  4.3613153e-09  2.3260348e-08], current edge mean: [ 1.1111112e+00  4.0000000e+00 -8.1510629e-09  8.1510629e-09
  0.0000000e+00  1.6302126e-08 -1.2226594e-08  4.0755315e-09
 -4.0755315e-09 -4.0755315e-09 -8.1510629e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.6302126e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-04 15:36:16,156 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.7198
2025-06-04 15:36:16,156 - WARNING - Feature drift detected (3 consecutive)
2025-06-04 15:36:16,156 - WARNING - Major behavior change detected - performing adaptive reset of scoring heads and decoder.
2025-06-04 15:36:16,156 - INFO - Resetting parameters of module: autoencoder.node_decoder
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.0
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.1
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.2
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.3
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.4
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.5
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.node_decoder.6
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.edge_decoder
2025-06-04 15:36:16,157 - INFO - Resetting parameters of module: autoencoder.edge_decoder.0
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.1
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.2
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.3
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.4
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.5
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: autoencoder.edge_decoder.6
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: node_anomaly_mlp
2025-06-04 15:36:16,158 - INFO - Resetting parameters of module: edge_anomaly_mlp
2025-06-04 15:36:16,159 - INFO - Resetting parameters of module: global_anomaly_mlp
2025-06-04 15:36:16,159 - INFO - Optimizer and scheduler reset.
2025-06-04 15:36:16,159 - DEBUG - Updated reference mean: node=[ 3.4890522e-08 -3.4890522e-08  7.2688593e-09 -1.1630174e-08
  2.9075437e-08  1.7445261e-08 -1.1630174e-08 -4.6520697e-08
 -1.0176403e-08  1.1630174e-08 -4.6520697e-08 -1.1630174e-08
 -4.0705611e-08  5.8150871e-09  8.1411223e-08 -1.0176403e-08
 -3.2709867e-08  4.3613153e-09  2.3260348e-08], edge=[ 1.1111112e+00  4.0000000e+00 -8.1510629e-09  8.1510629e-09
  0.0000000e+00  1.6302126e-08 -1.2226594e-08  4.0755315e-09
 -4.0755315e-09 -4.0755315e-09 -8.1510629e-09  0.0000000e+00
  0.0000000e+00  0.0000000e+00  1.6302126e-08  0.0000000e+00
  0.0000000e+00  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00  0.0000000e+00]
2025-06-04 15:36:16,160 - DEBUG - Updated reference std: node=[1.006154  1.006154  1.006154  1.006154  1.006154  1.006154  1.006154
 1.006154  1.006154  1.006154  1.006154  1.0061538 1.006154  1.006154
 1.006154  1.006154  1.006154  1.006154  1.006154 ], edge=[0.36619616 2.5427382  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011  1.0043011  1.0043011
 1.0043011  1.0043011  1.0043011  1.0043011 ]
2025-06-04 15:36:16,160 - INFO - Online update complete. Loss: 0.0000
2025-06-04 15:36:16,160 - INFO - Running anomaly detection...
2025-06-04 15:36:16,160 - INFO - Starting anomaly detection.
2025-06-04 15:36:16,799 - DEBUG - Node reconstruction errors: [  13.057555   13.057555   13.057555   12.683692   13.057555   13.057555
   13.057553   12.789609   13.477436   12.789607   12.789607   13.477431
  141.40634    13.011182   13.011181   11.933374   16.159166   12.600866
   12.774843   13.057555   12.600867   12.774843   12.600867   13.62722
   14.563245   15.468602  740.7685     13.196146   12.600867   12.600867
 1021.8042     12.600867  164.9431     12.600866   12.600866   11.933374
   13.057555   12.774843   14.323646   13.011182   12.774843   12.600867
   12.600866   12.789609   12.012098   12.774843   20.574085   11.911375
  100.22627   460.5643     12.600867   12.774847   12.774847   11.911378
   12.600867   12.012098   13.011181   12.774842   13.011181   13.501733
   16.137365   33.425194   12.774847   12.774843   11.933375   12.774843
   13.715363   12.774842   13.057555   12.774847   12.774847   12.789609
   12.789608   12.600867   12.774843   12.789607   12.774843  137.51636
   14.447251   12.774847   12.774848   12.789607]
2025-06-04 15:36:16,801 - DEBUG - Edge reconstruction errors: [0.19999999 0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.19999999 0.19999999 0.19999999 0.19999999
 0.19999999 0.19999999 0.19999999 0.19999999 0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.8        0.8        0.8        0.8        0.8        0.8
 0.19999999 0.19999999 0.19999999]
2025-06-04 15:36:16,909 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250604_153616_update_15.json
2025-06-04 15:36:16,910 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-04 15:36:16,934 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250604_153616_update_15.pth and as latest_checkpoint.pth
2025-06-04 15:36:16,935 - INFO - 
Global anomaly score (after nw_graph_encoded_1749028429.dot): 1.0000
2025-06-04 15:36:16,935 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-04 15:36:16,935 - WARNING -   Node ID: 192.168.27.12, Recon Error: 740.7685, MLP Score: 0.0000
2025-06-04 15:36:16,935 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1021.8042, MLP Score: 0.0000
2025-06-04 15:36:16,935 - WARNING -   Node ID: 192.168.27.13, Recon Error: 460.5643, MLP Score: 0.0000
2025-06-04 15:36:16,935 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-04 15:36:16,935 - INFO - 
--- Processing file: nw_graph_encoded_1749028444.dot ---
2025-06-04 15:36:16,935 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1749028444.dot
2025-06-04 15:36:16,935 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1749028444.dot file.
2025-06-04 15:36:16,937 - INFO - Parsed 86 nodes.
2025-06-04 15:36:16,939 - INFO - Parsed 123 edges.
2025-06-04 15:36:16,945 - INFO - Starting NetworkX to PyG conversion.
2025-06-04 15:36:16,945 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-04 15:36:16,946 - DEBUG - Initial node features tensor shape: torch.Size([86, 19])
2025-06-04 15:36:16,947 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-04 15:36:16,947 - DEBUG - Node features tensor shape after scaling: torch.Size([86, 19])
2025-06-04 15:36:16,947 - DEBUG - Edge index tensor shape: torch.Size([2, 123])
2025-06-04 15:36:16,947 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-04 15:36:16,949 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-04 15:36:16,949 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 7
2025-06-04 15:36:16,949 - DEBUG - Shape of encoded categorical edge features: torch.Size([123, 2])
2025-06-04 15:36:16,950 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-04 15:36:16,950 - DEBUG - Shape of scaled numerical edge features: torch.Size([123, 20])
2025-06-04 15:36:16,950 - DEBUG - Final edge attributes tensor shape: torch.Size([123, 22])
2025-06-04 15:36:16,950 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-04 15:36:16,950 - INFO - Performing online update...
2025-06-04 15:36:16,951 - INFO - Starting online update for 50 steps.
2025-06-04 15:36:16,951 - DEBUG - Updated RunningStats: new_mean=[ 5.55509508e-10 -5.37756428e-10 -2.68019435e-09  2.46878677e-09
 -2.74282875e-08  1.51880155e-08 -1.06906028e-08 -2.39057628e-09
 -3.13334908e-09  8.24633935e-10  1.63485090e-09 -1.69373565e-09
  4.06038678e-09 -3.40902972e-09  8.97316892e-10  9.22985510e-10
 -3.92276174e-09  1.39339702e-09 -5.22169760e-09], new_M2=[180619.00534098 180619.00527222 180619.00046854 180619.00436948
 180618.99867516 180618.99836265 180618.99587928 180618.9983495
 180618.99313897 180618.99816172 180619.00200534 180618.99363314
 180618.99251971 140827.99645297 140828.00028578 140827.99902892
 140828.00008807 180619.00043445 180619.00758239], new_n=180619
2025-06-04 15:36:16,952 - DEBUG - Updated RunningStats: new_mean=[ 1.41634554e+00  5.51886933e+00  1.16218921e-10  3.01259237e-10
  1.57396720e-10 -1.73518663e-10 -1.30266542e-09  2.45819579e-10
  2.62477928e-10 -2.94498691e-10  3.60571686e-10 -3.79332385e-09
 -9.57957627e-10  6.40230456e-10  3.46494621e-10 -1.71261002e-10
 -1.71261002e-10 -1.71261002e-10 -1.71261002e-10 -1.71261002e-10
 -1.71261002e-10 -7.67854207e-11], new_M2=[ 100109.95985932 1734713.40476965  389255.99903878  389256.00641214
  389256.00547835  389255.99336679  389256.00035133  389255.99905299
  389256.00172677  389255.99938708  389255.99312178  389256.0086926
  389256.00114772  389255.99975207  389256.00177892  389255.99444928
  389255.99444928  389255.99444928  389255.99444928  389255.99444928
  389255.99444928  389255.99934097], new_n=389256
2025-06-04 15:36:16,952 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 0.99999999 1.00000001 0.99999998
 0.99999998 0.88300423 0.88300424 0.88300424 0.88300424 1.
 1.00000002]
2025-06-04 15:36:16,952 - DEBUG - Calculated standard deviation: [0.50713197 2.11103877 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-04 15:36:16,952 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-04 15:36:16,952 - DEBUG - Online update step: 1/50
2025-06-04 15:36:16,953 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:16,953 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:36:16,954 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:36:16,954 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:16,954 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:16,954 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:16,955 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:36:16,955 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:16,955 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:36:16,955 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:36:16,956 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:16,956 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:16,956 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:36:16,956 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:16,957 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:16,957 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:36:16,958 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:36:18,247 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:36:18,404 - DEBUG - Edge anomaly scores shape: torch.Size([1029, 1])
2025-06-04 15:36:18,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:36:18,458 - DEBUG - Node reconstruction loss: 20.6775
2025-06-04 15:36:19,497 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8466
2025-06-04 15:36:19,651 - DEBUG - Step 1: Loss=16.8280
2025-06-04 15:36:19,651 - DEBUG - Online update step: 2/50
2025-06-04 15:36:19,652 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:36:19,653 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:36:19,656 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:36:19,656 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:36:19,657 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:19,658 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:36:19,658 - DEBUG - Applied edge dropout: 10 edges dropped.
2025-06-04 15:36:19,659 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:19,660 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:36:19,660 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:36:19,661 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:19,661 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:19,662 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:19,663 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:19,663 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:36:19,664 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:19,666 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:36:20,969 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:36:21,119 - DEBUG - Edge anomaly scores shape: torch.Size([1047, 1])
2025-06-04 15:36:21,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:36:21,169 - DEBUG - Node reconstruction loss: 9.0938
2025-06-04 15:36:22,419 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8206
2025-06-04 15:36:22,624 - DEBUG - Step 2: Loss=7.4006
2025-06-04 15:36:22,624 - DEBUG - Online update step: 3/50
2025-06-04 15:36:22,625 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:22,627 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:22,627 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:22,628 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:22,629 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:22,634 - DEBUG - Applied edge dropout: 3 edges dropped.
2025-06-04 15:36:22,636 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:22,636 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:22,642 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:22,643 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:22,644 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:36:22,649 - DEBUG - Applied edge dropout: 15 edges dropped.
2025-06-04 15:36:22,650 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:22,650 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:36:22,651 - DEBUG - Applied edge dropout: 18 edges dropped.
2025-06-04 15:36:22,652 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:22,654 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:36:24,402 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:36:24,568 - DEBUG - Edge anomaly scores shape: torch.Size([1023, 1])
2025-06-04 15:36:24,618 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:36:24,619 - DEBUG - Node reconstruction loss: 5.6513
2025-06-04 15:36:26,259 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8002
2025-06-04 15:36:26,478 - DEBUG - Step 3: Loss=4.6122
2025-06-04 15:36:26,482 - DEBUG - Online update step: 4/50
2025-06-04 15:36:26,483 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:36:26,484 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:26,484 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:26,484 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:26,485 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:36:26,493 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:36:26,494 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:26,494 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:26,495 - DEBUG - Applied edge dropout: 2 edges dropped.
2025-06-04 15:36:26,495 - DEBUG - Applied edge dropout: 11 edges dropped.
2025-06-04 15:36:26,495 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:26,496 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:36:26,496 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:26,497 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:26,498 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:36:26,498 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:26,499 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-04 15:36:27,787 - DEBUG - Node anomaly scores shape: torch.Size([849, 1])
2025-06-04 15:36:27,920 - DEBUG - Edge anomaly scores shape: torch.Size([1053, 1])
2025-06-04 15:36:27,971 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-04 15:36:27,971 - DEBUG - Node reconstruction loss: 4.1963
2025-06-04 15:36:30,057 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.7720
2025-06-04 15:36:30,196 - DEBUG - Step 4: Loss=3.4142
2025-06-04 15:36:30,196 - DEBUG - Online update step: 5/50
2025-06-04 15:36:30,197 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:30,198 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:30,199 - DEBUG - Applied edge dropout: 4 edges dropped.
2025-06-04 15:36:30,200 - DEBUG - Applied edge dropout: 6 edges dropped.
2025-06-04 15:36:30,201 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:36:30,201 - DEBUG - Applied edge dropout: 12 edges dropped.
2025-06-04 15:36:30,202 - DEBUG - Applied edge dropout: 9 edges dropped.
2025-06-04 15:36:30,203 - DEBUG - Applied edge dropout: 0 edges dropped.
2025-06-04 15:36:30,203 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:30,204 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:30,205 - DEBUG - Applied edge dropout: 7 edges dropped.
2025-06-04 15:36:30,205 - DEBUG - Applied edge dropout: 8 edges dropped.
2025-06-04 15:36:30,206 - DEBUG - Applied edge dropout: 13 edges dropped.
2025-06-04 15:36:30,207 - DEBUG - Applied edge dropout: 5 edges dropped.
2025-06-04 15:36:30,208 - DEBUG - Applied edge dropout: 14 edges dropped.
2025-06-04 15:36:30,209 - DEBUG - Applied edge dropout: 1 edges dropped.
2025-06-04 15:36:30,210 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
