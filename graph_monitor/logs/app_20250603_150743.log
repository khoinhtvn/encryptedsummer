2025-06-03 15:07:43,360 - INFO - Application logging to file: logs/app_20250603_150743.log
2025-06-03 15:07:43,360 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 15:07:43,360 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new files every 30 seconds.
2025-06-03 15:07:43,360 - INFO - Train Mode: train, Visualization Path: vis
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955880.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955865.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748956015.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748956060.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748956030.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955910.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955895.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955850.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748956045.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955955.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748956000.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955970.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955985.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955940.dot
2025-06-03 15:07:43,360 - INFO - Initially found and marked as processed: nw_graph_encoded_1748955925.dot
2025-06-03 15:07:43,360 - INFO - Initial scan complete. 15 existing files found.
2025-06-03 15:07:55,233 - INFO - Found 1 new .dot files.
2025-06-03 15:07:55,233 - INFO - 
--- Processing new file: nw_graph_encoded_1748956075.dot ---
2025-06-03 15:07:55,233 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot
2025-06-03 15:07:55,233 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot file.
2025-06-03 15:07:55,233 - INFO - Parsed 0 nodes.
2025-06-03 15:07:55,234 - INFO - Parsed 0 edges.
2025-06-03 15:07:55,234 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:07:55,234 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:07:55,234 - DEBUG - Initial node features tensor shape: torch.Size([0, 19])
2025-06-03 15:07:55,234 - WARNING - Skipping standard scaling for node features: No features to scale.
2025-06-03 15:07:55,234 - DEBUG - Node features tensor shape after scaling: torch.Size([0, 19])
2025-06-03 15:07:55,234 - DEBUG - Edge index tensor shape: torch.Size([2, 0])
2025-06-03 15:07:55,234 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:07:55,234 - INFO - No edge attributes (numerical or categorical) found.
2025-06-03 15:07:55,234 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:07:55,234 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=0, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 15:07:55,234 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=0, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-03 15:07:55,271 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-03 15:07:55,272 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-03 15:07:55,274 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 15:07:55,275 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-03 15:07:55,275 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-03 15:07:55,275 - INFO - RunningStats initialized.
2025-06-03 15:07:55,275 - INFO - RunningStats initialized.
2025-06-03 15:07:55,275 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 15:07:55,275 - INFO - Using device: cpu
2025-06-03 15:07:55,276 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=0)
2025-06-03 15:07:55,292 - ERROR - Error loading checkpoint from model_checkpoints/latest_checkpoint.pth: Error(s) in loading state_dict for HybridGNNAnomalyDetector:
	size mismatch for autoencoder.edge_decoder.0.weight: copying a param with shape torch.Size([256, 150]) from checkpoint, the shape in current model is torch.Size([256, 129]).
	size mismatch for edge_anomaly_mlp.0.weight: copying a param with shape torch.Size([128, 150]) from checkpoint, the shape in current model is torch.Size([128, 129]).
2025-06-03 15:07:55,292 - INFO - Resuming online updates from step: 0
2025-06-03 15:07:55,292 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-03 15:07:55,292 - INFO - Performing online update...
2025-06-03 15:07:55,292 - INFO - Starting online update for 50 steps.
2025-06-03 15:07:55,293 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.99545771 0.99545772 0.99545772 0.99545772 1.
 1.00000002]
2025-06-03 15:07:55,293 - DEBUG - Calculated standard deviation: [0.50539635 2.0879168  1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:07:55,293 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:07:55,293 - DEBUG - Online update step: 1/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 2/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 3/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 4/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 5/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 6/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 7/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 8/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 9/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 10/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 11/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,293 - DEBUG - Online update step: 12/50
2025-06-03 15:07:55,293 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 13/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 14/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 15/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 16/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 17/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 18/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 19/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 20/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 21/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 22/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 23/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 24/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 25/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 26/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 27/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 28/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 29/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 30/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 31/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 32/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 33/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,294 - DEBUG - Online update step: 34/50
2025-06-03 15:07:55,294 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 35/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 36/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 37/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 38/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 39/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 40/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 41/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 42/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 43/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 44/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 45/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 46/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 47/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 48/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 49/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - DEBUG - Online update step: 50/50
2025-06-03 15:07:55,295 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:07:55,295 - WARNING - No successful steps during online update.
2025-06-03 15:07:55,295 - WARNING - Skipping drift detection: Node or edge features are None.
2025-06-03 15:07:55,295 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:07:55,295 - INFO - Running anomaly detection...
2025-06-03 15:07:55,295 - INFO - Starting anomaly detection.
2025-06-03 15:07:55,336 - ERROR - An error occurred while processing file nw_graph_encoded_1748956075.dot: mat1 and mat2 shapes cannot be multiplied (0x128 and 129x256)
2025-06-03 15:07:55,342 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 459, in monitor_new_files
    anomalies = gnn_model.detect_anomalies(main_data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 677, in detect_anomalies
    embedding, node_recon, edge_recon = self.autoencoder(normalized_data)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 227, in forward
    edge_recon = self.decode_edge(embedding, edge_index, edge_attr)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 221, in decode_edge
    return self.edge_decoder(edge_features).squeeze()  # Removed torch.sigmoid
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (0x128 and 129x256)

2025-06-03 15:07:55,342 - INFO - No new .dot files found in /home/lu/Desktop/output/. Waiting for 30 seconds...
2025-06-03 15:08:25,343 - INFO - Found 3 new .dot files.
2025-06-03 15:08:25,343 - INFO - 
--- Processing new file: nw_graph_encoded_1748956075.dot ---
2025-06-03 15:08:25,343 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot
2025-06-03 15:08:25,343 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot file.
2025-06-03 15:08:25,371 - INFO - Parsed 1010 nodes.
2025-06-03 15:08:25,412 - INFO - Parsed 2221 edges.
2025-06-03 15:08:26,193 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:08:26,193 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:08:26,199 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:08:26,205 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:08:26,210 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:08:26,212 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:08:26,212 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:08:26,222 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:08:26,223 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:08:26,225 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:08:26,226 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:08:26,230 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:08:26,235 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:08:26,235 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:08:26,235 - INFO - Performing online update...
2025-06-03 15:08:26,235 - INFO - Starting online update for 50 steps.
2025-06-03 15:08:26,236 - DEBUG - Updated RunningStats: new_mean=[ 7.09877440e-10 -6.30198958e-10  3.80164884e-09  9.05218233e-10
 -2.23755168e-08  7.83954867e-09 -8.70029581e-09 -1.59876373e-09
 -2.52475834e-09  2.21255042e-09  2.32010030e-09 -1.17081317e-09
  3.43222556e-09 -4.43075677e-09  1.15539153e-09  1.07176477e-09
 -5.14358099e-09  1.88015890e-09 -5.46236687e-09], new_M2=[139140.00418243 139140.00406378 139139.99902711 139140.00070489
 139139.99948792 139139.99851575 139139.9991692  139139.99872843
 139139.99629952 139139.99955105 139140.00045483 139139.99635924
 139139.9951608  136877.99641158 136878.0002393  136877.99904333
 136878.00004105 139140.00056484 139140.00546728], new_n=139140
2025-06-03 15:08:26,236 - DEBUG - Updated RunningStats: new_mean=[ 1.41925101e+00  5.48763917e+00  7.94142691e-11  1.96727583e-10
  3.13053313e-10 -2.17506539e-11 -1.75179279e-09 -3.24998764e-11
 -9.65278098e-11  7.74477902e-10  6.28191956e-11 -3.33395840e-09
 -7.08821981e-10  3.16694968e-09  8.67677882e-10 -1.24675965e-10
 -1.24675965e-10 -1.24675965e-10 -1.24675965e-10 -1.24675965e-10
 -1.24675965e-10 -2.07599133e-10], new_M2=[  76581.56700732 1307594.69075574  299817.99952606  299818.00356229
  299818.00698437  299817.99812017  299818.00059489  299817.9988571
  299818.00177085  299817.99845688  299817.99564957  299818.00604897
  299818.00093942  299817.99886112  299818.0035108   299817.99655952
  299817.99655952  299817.99655952  299817.99655952  299817.99655952
  299817.99655952  299817.99891562], new_n=299818
2025-06-03 15:08:26,236 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.99183818 0.99183819 0.99183819 0.99183819 1.
 1.00000002]
2025-06-03 15:08:26,237 - DEBUG - Calculated standard deviation: [0.50539771 2.08837133 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:08:26,237 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:08:26,237 - DEBUG - Online update step: 1/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 2/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 3/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 4/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 5/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 6/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 7/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 8/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 9/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 10/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 11/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 12/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 13/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 14/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 15/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,237 - DEBUG - Online update step: 16/50
2025-06-03 15:08:26,237 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 17/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 18/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 19/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 20/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 21/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 22/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 23/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 24/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 25/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 26/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 27/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 28/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 29/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 30/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 31/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 32/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 33/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 34/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 35/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 36/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 37/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 38/50
2025-06-03 15:08:26,238 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,238 - DEBUG - Online update step: 39/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 40/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 41/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 42/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 43/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 44/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 45/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 46/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 47/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 48/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 49/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - DEBUG - Online update step: 50/50
2025-06-03 15:08:26,239 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:26,239 - WARNING - No successful steps during online update.
2025-06-03 15:08:26,240 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:26,240 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1020
2025-06-03 15:08:26,240 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:26,241 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:08:26,241 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:08:26,241 - INFO - Running anomaly detection...
2025-06-03 15:08:26,241 - INFO - Starting anomaly detection.
2025-06-03 15:08:26,260 - ERROR - An error occurred while processing file nw_graph_encoded_1748956075.dot: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)
2025-06-03 15:08:26,261 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 459, in monitor_new_files
    anomalies = gnn_model.detect_anomalies(main_data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 677, in detect_anomalies
    embedding, node_recon, edge_recon = self.autoencoder(normalized_data)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 227, in forward
    edge_recon = self.decode_edge(embedding, edge_index, edge_attr)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 221, in decode_edge
    return self.edge_decoder(edge_features).squeeze()  # Removed torch.sigmoid
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)

2025-06-03 15:08:26,261 - INFO - 
--- Processing new file: nw_graph_encoded_1748956090.dot ---
2025-06-03 15:08:26,261 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956090.dot
2025-06-03 15:08:26,261 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956090.dot file.
2025-06-03 15:08:26,272 - INFO - Parsed 1010 nodes.
2025-06-03 15:08:26,291 - INFO - Parsed 2221 edges.
2025-06-03 15:08:27,064 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:08:27,064 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:08:27,070 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:08:27,072 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:08:27,072 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:08:27,074 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:08:27,074 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:08:27,084 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:08:27,085 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:08:27,087 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:08:27,089 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:08:27,089 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:08:27,089 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:08:27,089 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:08:27,089 - INFO - Performing online update...
2025-06-03 15:08:27,090 - INFO - Starting online update for 50 steps.
2025-06-03 15:08:27,090 - DEBUG - Updated RunningStats: new_mean=[ 7.03485787e-10 -6.26082681e-10  3.58956906e-09  9.58341894e-10
 -2.25519479e-08  8.08373375e-09 -8.76699160e-09 -1.62381723e-09
 -2.54462712e-09  2.16686168e-09  2.29612381e-09 -1.18730836e-09
  3.45384781e-09 -4.39882624e-09  1.14706513e-09  1.06404103e-09
 -5.10651344e-09  1.86575883e-09 -5.45723796e-09], new_M2=[140150.00421006 140150.00409268 140149.9990629  140150.00079842
 140149.99946614 140149.99851172 140149.99908391 140149.99872018
 140149.99621895 140149.99951626 140150.000495   140149.99629037
 140149.99509196 136877.99641158 136878.0002393  136877.99904333
 136878.00004105 140150.00056109 140150.00552274], new_n=140150
2025-06-03 15:08:27,091 - DEBUG - Updated RunningStats: new_mean=[ 1.41927036e+00  5.48920504e+00  8.08085345e-11  2.01418392e-10
  3.07859044e-10 -2.65317517e-11 -1.73786826e-09 -2.06278502e-11
 -7.95959688e-11  7.35484700e-10  7.77529366e-11 -3.35769170e-09
 -7.14887485e-10  3.08423769e-09  8.51664836e-10 -1.26341569e-10
 -1.26341569e-10 -1.26341569e-10 -1.26341569e-10 -1.26341569e-10
 -1.26341569e-10 -2.02524686e-10], new_M2=[  77149.27880174 1317844.55302131  302038.99951457  302039.00365488
  302039.00694581  302038.99799605  302039.00058627  302038.99886798
  302039.00176855  302038.9984827   302038.99559595  302039.00613144
  302039.00094518  302038.99888388  302039.00346607  302038.9965011
  302038.9965011   302038.9965011   302038.9965011   302038.9965011
  302038.9965011   302038.99893598], new_n=302039
2025-06-03 15:08:27,091 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.98825784 0.98825785 0.98825785 0.98825785 1.
 1.00000002]
2025-06-03 15:08:27,091 - DEBUG - Calculated standard deviation: [0.50539905 2.0888179  1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:08:27,091 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:08:27,091 - DEBUG - Online update step: 1/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,091 - DEBUG - Online update step: 2/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,091 - DEBUG - Online update step: 3/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,091 - DEBUG - Online update step: 4/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,091 - DEBUG - Online update step: 5/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,091 - DEBUG - Online update step: 6/50
2025-06-03 15:08:27,091 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 7/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 8/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 9/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 10/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 11/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 12/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 13/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 14/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 15/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 16/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 17/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 18/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 19/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 20/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 21/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 22/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 23/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 24/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 25/50
2025-06-03 15:08:27,092 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,092 - DEBUG - Online update step: 26/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 27/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 28/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 29/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 30/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 31/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 32/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 33/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 34/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 35/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 36/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 37/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 38/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 39/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 40/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 41/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 42/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 43/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 44/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 45/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,093 - DEBUG - Online update step: 46/50
2025-06-03 15:08:27,093 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,094 - DEBUG - Online update step: 47/50
2025-06-03 15:08:27,094 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,094 - DEBUG - Online update step: 48/50
2025-06-03 15:08:27,094 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,094 - DEBUG - Online update step: 49/50
2025-06-03 15:08:27,094 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,094 - DEBUG - Online update step: 50/50
2025-06-03 15:08:27,094 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,094 - WARNING - No successful steps during online update.
2025-06-03 15:08:27,094 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:27,094 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1012
2025-06-03 15:08:27,095 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:27,095 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:08:27,095 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:08:27,095 - INFO - Running anomaly detection...
2025-06-03 15:08:27,095 - INFO - Starting anomaly detection.
2025-06-03 15:08:27,109 - ERROR - An error occurred while processing file nw_graph_encoded_1748956090.dot: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)
2025-06-03 15:08:27,110 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 459, in monitor_new_files
    anomalies = gnn_model.detect_anomalies(main_data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 677, in detect_anomalies
    embedding, node_recon, edge_recon = self.autoencoder(normalized_data)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 227, in forward
    edge_recon = self.decode_edge(embedding, edge_index, edge_attr)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 221, in decode_edge
    return self.edge_decoder(edge_features).squeeze()  # Removed torch.sigmoid
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)

2025-06-03 15:08:27,110 - INFO - 
--- Processing new file: nw_graph_encoded_1748956105.dot ---
2025-06-03 15:08:27,110 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956105.dot
2025-06-03 15:08:27,110 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956105.dot file.
2025-06-03 15:08:27,122 - INFO - Parsed 1010 nodes.
2025-06-03 15:08:27,143 - INFO - Parsed 2221 edges.
2025-06-03 15:08:27,751 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:08:27,751 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:08:27,756 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:08:27,758 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:08:27,758 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:08:27,760 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:08:27,760 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:08:27,770 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:08:27,771 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:08:27,773 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:08:27,775 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:08:27,775 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:08:27,775 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:08:27,775 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:08:27,776 - INFO - Performing online update...
2025-06-03 15:08:27,776 - INFO - Starting online update for 50 steps.
2025-06-03 15:08:27,776 - DEBUG - Updated RunningStats: new_mean=[ 6.97185599e-10 -6.22025307e-10  3.38052413e-09  1.01070535e-09
 -2.27258543e-08  8.32442455e-09 -8.83273297e-09 -1.64851221e-09
 -2.56421158e-09  2.12182676e-09  2.27249042e-09 -1.20356751e-09
  3.47516065e-09 -4.36735263e-09  1.13885787e-09  1.05642781e-09
 -5.06997633e-09  1.85156483e-09 -5.45218245e-09], new_M2=[141160.00423768 141160.00412158 141159.9990987  141160.00089194
 141159.99944436 141159.9985077  141159.99899862 141159.99871193
 141159.99613838 141159.99948147 141160.00053517 141159.9962215
 141159.99502311 136877.99641158 136878.0002393  136877.99904333
 136878.00004105 141160.00055734 141160.0055782 ], new_n=141160
2025-06-03 15:08:27,777 - DEBUG - Updated RunningStats: new_mean=[ 1.41928942e+00  5.49074804e+00  8.21824446e-11  2.06040719e-10
  3.02740607e-10 -3.12430486e-11 -1.72414702e-09 -8.92914792e-12
 -6.29113217e-11  6.97060773e-10  9.24686545e-11 -3.38107850e-09
 -7.20864436e-10  3.00273326e-09  8.35885570e-10 -1.27982856e-10
 -1.27982856e-10 -1.27982856e-10 -1.27982856e-10 -1.27982856e-10
 -1.27982856e-10 -1.97524324e-10], new_M2=[  77716.99037337 1328092.9557451   304259.99950308  304260.00374746
  304260.00690725  304259.99787192  304260.00057764  304259.99887885
  304260.00176625  304259.99850852  304259.99554232  304260.0062139
  304260.00095094  304259.99890663  304260.00342134  304259.99644267
  304259.99644267  304259.99644267  304259.99644267  304259.99644267
  304259.99644267  304259.99895635], new_n=304260
2025-06-03 15:08:27,777 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.984716   0.98471601 0.98471601 0.98471601 1.
 1.00000002]
2025-06-03 15:08:27,777 - DEBUG - Calculated standard deviation: [0.50540037 2.08925671 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:08:27,777 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:08:27,777 - DEBUG - Online update step: 1/50
2025-06-03 15:08:27,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,777 - DEBUG - Online update step: 2/50
2025-06-03 15:08:27,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,777 - DEBUG - Online update step: 3/50
2025-06-03 15:08:27,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,777 - DEBUG - Online update step: 4/50
2025-06-03 15:08:27,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,777 - DEBUG - Online update step: 5/50
2025-06-03 15:08:27,777 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 6/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 7/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 8/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 9/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 10/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 11/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 12/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 13/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 14/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 15/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 16/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 17/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 18/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 19/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 20/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 21/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 22/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 23/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 24/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 25/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,778 - DEBUG - Online update step: 26/50
2025-06-03 15:08:27,778 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 27/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 28/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 29/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 30/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 31/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 32/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 33/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 34/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 35/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 36/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 37/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 38/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 39/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 40/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 41/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 42/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 43/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 44/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 45/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 46/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,779 - DEBUG - Online update step: 47/50
2025-06-03 15:08:27,779 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,780 - DEBUG - Online update step: 48/50
2025-06-03 15:08:27,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,780 - DEBUG - Online update step: 49/50
2025-06-03 15:08:27,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,780 - DEBUG - Online update step: 50/50
2025-06-03 15:08:27,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:08:27,780 - WARNING - No successful steps during online update.
2025-06-03 15:08:27,780 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:27,780 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1004
2025-06-03 15:08:27,781 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:08:27,781 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:08:27,781 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:08:27,781 - INFO - Running anomaly detection...
2025-06-03 15:08:27,781 - INFO - Starting anomaly detection.
2025-06-03 15:08:27,799 - ERROR - An error occurred while processing file nw_graph_encoded_1748956105.dot: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)
2025-06-03 15:08:27,800 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 459, in monitor_new_files
    anomalies = gnn_model.detect_anomalies(main_data)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 677, in detect_anomalies
    embedding, node_recon, edge_recon = self.autoencoder(normalized_data)
                                        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 227, in forward
    edge_recon = self.decode_edge(embedding, edge_index, edge_attr)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/neural_net.py", line 221, in decode_edge
    return self.edge_decoder(edge_features).squeeze()  # Removed torch.sigmoid
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/container.py", line 240, in forward
    input = module(input)
            ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1751, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/module.py", line 1762, in _call_impl
    return forward_call(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/torch/nn/modules/linear.py", line 125, in forward
    return F.linear(input, self.weight, self.bias)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
RuntimeError: mat1 and mat2 shapes cannot be multiplied (2221x150 and 129x256)

2025-06-03 15:08:27,800 - INFO - No new .dot files found in /home/lu/Desktop/output/. Waiting for 30 seconds...
2025-06-03 15:08:57,801 - INFO - Found 5 new .dot files.
2025-06-03 15:08:57,801 - INFO - 
--- Processing new file: nw_graph_encoded_1748956075.dot ---
2025-06-03 15:08:57,801 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot
2025-06-03 15:08:57,801 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot file.
2025-06-03 15:08:57,813 - INFO - Parsed 1010 nodes.
