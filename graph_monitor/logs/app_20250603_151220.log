2025-06-03 15:12:20,046 - INFO - Application logging to file: logs/app_20250603_151220.log
2025-06-03 15:12:20,047 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 15:12:20,047 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ for new and existing files every 30 seconds.
2025-06-03 15:12:20,047 - INFO - Train Mode: train, Visualization Path: vis
2025-06-03 15:12:20,047 - INFO - Found 66 files to process.
2025-06-03 15:12:20,047 - INFO - 
--- Processing file: nw_graph_encoded_1748955850.dot ---
2025-06-03 15:12:20,047 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955850.dot
2025-06-03 15:12:20,047 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955850.dot file.
2025-06-03 15:12:20,058 - INFO - Parsed 819 nodes.
2025-06-03 15:12:20,075 - INFO - Parsed 2221 edges.
2025-06-03 15:12:20,703 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:20,703 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:20,708 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:20,710 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:20,710 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:20,712 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:20,712 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:20,722 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:20,723 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:20,725 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:20,726 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:20,727 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:20,727 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:20,727 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:20,727 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 15:12:20,727 - INFO - Initializing GraphAutoencoder with node_dim=19, edge_dim=22, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4, use_batch_norm=True, use_residual=True
2025-06-03 15:12:20,768 - DEBUG - Encoder GATConv layers initialized with final embedding dimension: 64
2025-06-03 15:12:20,770 - DEBUG - Decoder MLP layers initialized with proper weight initialization.
2025-06-03 15:12:20,771 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 15:12:20,772 - INFO - Optimizer (AdamW) and scheduler (CosineAnnealingWarmRestarts) initialized.
2025-06-03 15:12:20,772 - INFO - Replay buffer initialized with maxlen=2000, batch_size=16
2025-06-03 15:12:20,772 - INFO - RunningStats initialized.
2025-06-03 15:12:20,772 - INFO - RunningStats initialized.
2025-06-03 15:12:20,772 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 15:12:20,773 - INFO - Using device: cpu
2025-06-03 15:12:20,773 - INFO - Initialized Hybrid GNN (node_dim=19, edge_dim=22)
2025-06-03 15:12:20,778 - ERROR - Error loading checkpoint from model_checkpoints/latest_checkpoint.pth: Error(s) in loading state_dict for HybridGNNAnomalyDetector:
	size mismatch for autoencoder.edge_decoder.0.weight: copying a param with shape torch.Size([256, 129]) from checkpoint, the shape in current model is torch.Size([256, 150]).
	size mismatch for edge_anomaly_mlp.0.weight: copying a param with shape torch.Size([128, 129]) from checkpoint, the shape in current model is torch.Size([128, 150]).
2025-06-03 15:12:20,778 - INFO - Resuming online updates from step: 0
2025-06-03 15:12:20,778 - INFO - Running statistics loaded from stats/running_stats.pkl
2025-06-03 15:12:20,778 - INFO - Performing online update...
2025-06-03 15:12:20,779 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:20,779 - DEBUG - Updated RunningStats: new_mean=[ 7.09877440e-10 -6.30198958e-10  3.80164884e-09  9.05218233e-10
 -2.23755168e-08  7.83954867e-09 -8.70029581e-09 -1.59876373e-09
 -2.52475834e-09  2.21255042e-09  2.32010030e-09 -1.17081317e-09
  3.43222556e-09 -4.38684793e-09  1.19930037e-09  1.11567361e-09
 -5.09967215e-09  1.88015890e-09 -5.46236687e-09], new_M2=[139140.00418243 139140.00406378 139139.99902711 139140.00070489
 139139.99948792 139139.99851575 139139.9991692  139139.99872843
 139139.99629952 139139.99955105 139140.00045483 139139.99635924
 139139.9951608  137887.996416   137888.00024373 137887.99904776
 137888.00004548 139140.00056484 139140.00546728], new_n=139140
2025-06-03 15:12:20,780 - DEBUG - Updated RunningStats: new_mean=[ 1.41925101e+00  5.48763917e+00  7.94142691e-11  1.96727583e-10
  3.13053313e-10 -2.17506539e-11 -1.75179279e-09 -3.24998764e-11
 -9.65278098e-11  7.74477902e-10  6.28191956e-11 -3.33395840e-09
 -7.08821981e-10  3.16694968e-09  8.67677882e-10 -1.24675965e-10
 -1.24675965e-10 -1.24675965e-10 -1.24675965e-10 -1.24675965e-10
 -1.24675965e-10 -2.07599133e-10], new_M2=[  76581.56700732 1307594.69075574  299817.99952606  299818.00356229
  299818.00698437  299817.99812017  299818.00059489  299817.9988571
  299818.00177085  299817.99845688  299817.99564957  299818.00604897
  299818.00093942  299817.99886112  299818.0035108   299817.99655952
  299817.99655952  299817.99655952  299817.99655952  299817.99655952
  299817.99655952  299817.99891562], new_n=299818
2025-06-03 15:12:20,780 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.99549075 0.99549077 0.99549076 0.99549077 1.
 1.00000002]
2025-06-03 15:12:20,780 - DEBUG - Calculated standard deviation: [0.50539771 2.08837133 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:20,780 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:20,780 - DEBUG - Online update step: 1/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 2/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 3/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 4/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 5/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 6/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 7/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,780 - DEBUG - Online update step: 8/50
2025-06-03 15:12:20,780 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 9/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 10/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 11/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 12/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 13/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 14/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 15/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 16/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 17/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 18/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 19/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 20/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 21/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 22/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 23/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 24/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 25/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 26/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 27/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 28/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,781 - DEBUG - Online update step: 29/50
2025-06-03 15:12:20,781 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 30/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 31/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 32/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 33/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 34/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 35/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 36/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 37/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 38/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 39/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 40/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 41/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 42/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 43/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 44/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 45/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 46/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 47/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 48/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 49/50
2025-06-03 15:12:20,782 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,782 - DEBUG - Online update step: 50/50
2025-06-03 15:12:20,783 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:20,783 - WARNING - No successful steps during online update.
2025-06-03 15:12:20,783 - DEBUG - Current node mean: [ 2.9271192e-08 -3.1159654e-08 -2.3133683e-08  1.4163480e-08
 -5.4765454e-08  5.6653921e-08  9.4423198e-09  8.4980876e-09
 -9.4423198e-09  9.4423203e-10  6.1375078e-09 -4.7211601e-10
 -1.6996175e-08 -1.5343770e-07 -1.5343770e-07 -1.5343770e-07
 -1.5343770e-07 -9.4423198e-09  2.2661569e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  1.7175584e-09  1.7175584e-09
 -6.0114544e-09  0.0000000e+00  4.2938961e-10  3.0057272e-09
  2.7910325e-09 -3.8645065e-09 -5.1526752e-09 -1.0305350e-08
  8.5877921e-10 -2.5763376e-09 -1.7175584e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:20,783 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1020
2025-06-03 15:12:20,784 - DEBUG - Updated reference mean: node=[ 2.9271192e-08 -3.1159654e-08 -2.3133683e-08  1.4163480e-08
 -5.4765454e-08  5.6653921e-08  9.4423198e-09  8.4980876e-09
 -9.4423198e-09  9.4423203e-10  6.1375078e-09 -4.7211601e-10
 -1.6996175e-08 -1.5343770e-07 -1.5343770e-07 -1.5343770e-07
 -1.5343770e-07 -9.4423198e-09  2.2661569e-08], edge=[ 1.4218820e+00  5.7005854e+00  1.7175584e-09  1.7175584e-09
 -6.0114544e-09  0.0000000e+00  4.2938961e-10  3.0057272e-09
  2.7910325e-09 -3.8645065e-09 -5.1526752e-09 -1.0305350e-08
  8.5877921e-10 -2.5763376e-09 -1.7175584e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:20,784 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:20,784 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:20,784 - INFO - Running anomaly detection...
2025-06-03 15:12:20,784 - INFO - Starting anomaly detection.
2025-06-03 15:12:20,809 - DEBUG - Node reconstruction errors: [0.02688889 0.02688889 0.02688889 ... 0.32088485 0.32088485 0.32088485]
2025-06-03 15:12:20,810 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.19999999 0.8       ]
2025-06-03 15:12:20,815 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151220_update_1.json
2025-06-03 15:12:20,815 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:20,827 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151220_update_1.pth and as latest_checkpoint.pth
2025-06-03 15:12:20,827 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955850.dot): 0.6807
2025-06-03 15:12:20,827 - WARNING - Detected 13 anomalous nodes (reconstruction-based):
2025-06-03 15:12:20,827 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 1.0592, MLP Score: 0.0000
2025-06-03 15:12:20,827 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7594, MLP Score: 0.0000
2025-06-03 15:12:20,827 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.2366, MLP Score: 0.0000
2025-06-03 15:12:20,827 - WARNING -   Node ID: 192.168.27.12, Recon Error: 1.0841, MLP Score: 0.0000
2025-06-03 15:12:20,827 - WARNING -   Node ID: 192.168.27.13, Recon Error: 1.9982, MLP Score: 0.0000
2025-06-03 15:12:20,827 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:20,842 - INFO - Starting 3D embedding visualization...
2025-06-03 15:12:21,508 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-03 15:12:21,525 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5e11e4470> <matplotlib.colors.Normalize object at 0x74a5e11e4470>
2025-06-03 15:12:21,526 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5dc84ea80>
2025-06-03 15:12:21,527 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5e11e4470> <matplotlib.colors.Normalize object at 0x74a5e11e4470>
2025-06-03 15:12:21,527 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5dc84ea80>
2025-06-03 15:12:21,529 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5dc84e960>
2025-06-03 15:12:21,601 - ERROR - Error during 3D t-SNE or plotting: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_1_updates_20250603_151220.png'
2025-06-03 15:12:21,615 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 331, in visualize_embeddings_3d
    plt.savefig(filepath)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1657, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_1_updates_20250603_151220.png'

2025-06-03 15:12:21,615 - INFO - Performing visualization of node and edge features.
2025-06-03 15:12:21,615 - INFO - Starting visualization of node features.
2025-06-03 15:12:21,615 - INFO - Graph has 1010 nodes and 19 features.
2025-06-03 15:12:21,616 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-03 15:12:21,616 - INFO - Calculating feature statistics:
2025-06-03 15:12:21,618 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(2.9743308e-08), 'std': np.float32(1.0), 'min': np.float32(-0.10731402), 'max': np.float32(9.494974)}
2025-06-03 15:12:21,618 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-2.9743308e-08), 'std': np.float32(1.0), 'min': np.float32(-9.494974), 'max': np.float32(0.10731402)}
2025-06-03 15:12:21,618 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-3.399235e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2924573), 'max': np.float32(3.179208)}
2025-06-03 15:12:21,618 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.7940408e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07549707), 'max': np.float32(18.159897)}
2025-06-03 15:12:21,618 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-03 15:12:21,618 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(4.154621e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65014666), 'max': np.float32(2.8871822)}
2025-06-03 15:12:21,618 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(0.9999999), 'min': np.float32(-2.9084294), 'max': np.float32(0.63373893)}
2025-06-03 15:12:21,618 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(5.665392e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.07902002), 'max': np.float32(20.264761)}
2025-06-03 15:12:21,618 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(-1.5107712e-08), 'std': np.float32(1.0), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-03 15:12:21,618 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-0.09293793), 'max': np.float32(11.41274)}
2025-06-03 15:12:21,618 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(-3.776928e-09), 'std': np.float32(1.0), 'min': np.float32(-2.002014), 'max': np.float32(0.92043453)}
2025-06-03 15:12:21,618 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-03 15:12:21,618 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.5107712e-08), 'std': np.float32(0.99999994), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-03 15:12:21,619 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.48291948), 'max': np.float32(2.0707386)}
2025-06-03 15:12:21,619 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.48291948), 'max': np.float32(2.0707386)}
2025-06-03 15:12:21,619 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 2, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.48291948), 'max': np.float32(2.0707386)}
2025-06-03 15:12:21,619 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 2, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.48291948), 'max': np.float32(2.0707386)}
2025-06-03 15:12:21,619 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-1.7940408e-08), 'std': np.float32(1.0), 'min': np.float32(-7.4247913), 'max': np.float32(0.15153895)}
2025-06-03 15:12:21,619 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.18029e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.1466002), 'max': np.float32(4.358143)}
2025-06-03 15:12:21,633 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5e11e5f40>
2025-06-03 15:12:21,734 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 15:12:21,772 - DEBUG - Plotted ranges of node feature values.
2025-06-03 15:12:21,794 - DEBUG - Plotted sparsity of node features.
2025-06-03 15:12:22,857 - INFO - Node feature visualization saved to vis/node_features_20250603_151221.png
2025-06-03 15:12:22,857 - INFO - Finished visualization of node features.
2025-06-03 15:12:22,857 - INFO - Performing additional feature analysis:
2025-06-03 15:12:22,857 - INFO - - Maximum correlation between different features: 1.00
2025-06-03 15:12:22,857 - INFO - Starting visualization of edge features.
2025-06-03 15:12:22,857 - INFO - Graph has 2221 edges and 22 edge features.
2025-06-03 15:12:22,857 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 15:12:22,857 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-03 15:12:22,861 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 526, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-03 15:12:22,862 - INFO - 
--- Processing file: nw_graph_encoded_1748955865.dot ---
2025-06-03 15:12:22,862 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955865.dot
2025-06-03 15:12:22,862 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955865.dot file.
2025-06-03 15:12:22,873 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:22,997 - INFO - Parsed 2221 edges.
2025-06-03 15:12:23,652 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:23,652 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:23,657 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:23,659 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:23,659 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:23,661 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:23,661 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:23,672 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:23,673 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:23,675 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:23,676 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:23,677 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:23,677 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:23,677 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:23,677 - INFO - Performing online update...
2025-06-03 15:12:23,677 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:23,678 - DEBUG - Updated RunningStats: new_mean=[ 7.03485787e-10 -6.26082681e-10  3.58956906e-09  9.58341894e-10
 -2.25519479e-08  8.08373375e-09 -8.76699160e-09 -1.62381723e-09
 -2.54462712e-09  2.16686168e-09  2.29612381e-09 -1.18730836e-09
  3.45384781e-09 -4.35523383e-09  1.19065754e-09  1.10763343e-09
 -5.06292104e-09  1.86575883e-09 -5.45723796e-09], new_M2=[140150.00421006 140150.00409268 140149.9990629  140150.00079842
 140149.99946614 140149.99851172 140149.99908391 140149.99872018
 140149.99621895 140149.99951626 140150.000495   140149.99629037
 140149.99509196 137887.996416   137888.00024373 137887.99904776
 137888.00004548 140150.00056109 140150.00552274], new_n=140150
2025-06-03 15:12:23,678 - DEBUG - Updated RunningStats: new_mean=[ 1.41927036e+00  5.48920504e+00  8.08085345e-11  2.01418392e-10
  3.07859044e-10 -2.65317517e-11 -1.73786826e-09 -2.06278502e-11
 -7.95959688e-11  7.35484700e-10  7.77529366e-11 -3.35769170e-09
 -7.14887485e-10  3.08423769e-09  8.51664836e-10 -1.26341569e-10
 -1.26341569e-10 -1.26341569e-10 -1.26341569e-10 -1.26341569e-10
 -1.26341569e-10 -2.02524686e-10], new_M2=[  77149.27880174 1317844.55302131  302038.99951457  302039.00365488
  302039.00694581  302038.99799605  302039.00058627  302038.99886798
  302039.00176855  302038.9984827   302038.99559595  302039.00613144
  302039.00094518  302038.99888388  302039.00346607  302038.9965011
  302038.9965011   302038.9965011   302038.9965011   302038.9965011
  302038.9965011   302038.99893598], new_n=302039
2025-06-03 15:12:23,679 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.99189723 0.99189725 0.99189724 0.99189725 1.
 1.00000002]
2025-06-03 15:12:23,679 - DEBUG - Calculated standard deviation: [0.50539905 2.0888179  1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:23,679 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:23,679 - DEBUG - Online update step: 1/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 2/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 3/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 4/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 5/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 6/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 7/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 8/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 9/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 10/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 11/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 12/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,679 - DEBUG - Online update step: 13/50
2025-06-03 15:12:23,679 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 14/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 15/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 16/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 17/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 18/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 19/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 20/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 21/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 22/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 23/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 24/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 25/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 26/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 27/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 28/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 29/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 30/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 31/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 32/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,680 - DEBUG - Online update step: 33/50
2025-06-03 15:12:23,680 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 34/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 35/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 36/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 37/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 38/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 39/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 40/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 41/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 42/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 43/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 44/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 45/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 46/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 47/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 48/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 49/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - DEBUG - Online update step: 50/50
2025-06-03 15:12:23,681 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:23,681 - WARNING - No successful steps during online update.
2025-06-03 15:12:23,682 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:23,682 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1012
2025-06-03 15:12:23,682 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:23,683 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:23,683 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:23,683 - INFO - Running anomaly detection...
2025-06-03 15:12:23,683 - INFO - Starting anomaly detection.
2025-06-03 15:12:23,694 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:23,695 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:23,699 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151223_update_2.json
2025-06-03 15:12:23,699 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:23,710 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151223_update_2.pth and as latest_checkpoint.pth
2025-06-03 15:12:23,710 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955865.dot): 0.4294
2025-06-03 15:12:23,710 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:23,710 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:23,710 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:23,710 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:23,710 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:23,710 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:23,710 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:23,710 - INFO - 
--- Processing file: nw_graph_encoded_1748955880.dot ---
2025-06-03 15:12:23,710 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955880.dot
2025-06-03 15:12:23,711 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955880.dot file.
2025-06-03 15:12:23,722 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:23,740 - INFO - Parsed 2221 edges.
2025-06-03 15:12:24,401 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:24,401 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:24,406 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:24,408 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:24,408 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:24,409 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:24,409 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:24,420 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:24,421 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:24,423 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:24,424 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:24,425 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:24,425 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:24,425 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:24,425 - INFO - Performing online update...
2025-06-03 15:12:24,425 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:24,426 - DEBUG - Updated RunningStats: new_mean=[ 6.97185599e-10 -6.22025307e-10  3.38052413e-09  1.01070535e-09
 -2.27258543e-08  8.32442455e-09 -8.83273297e-09 -1.64851221e-09
 -2.56421158e-09  2.12182676e-09  2.27249042e-09 -1.20356751e-09
  3.47516065e-09 -4.32407213e-09  1.18213838e-09  1.09970832e-09
 -5.02669583e-09  1.85156483e-09 -5.45218245e-09], new_M2=[141160.00423768 141160.00412158 141159.9990987  141160.00089194
 141159.99944436 141159.9985077  141159.99899862 141159.99871193
 141159.99613838 141159.99948147 141160.00053517 141159.9962215
 141159.99502311 137887.996416   137888.00024373 137887.99904776
 137888.00004548 141160.00055734 141160.0055782 ], new_n=141160
2025-06-03 15:12:24,426 - DEBUG - Updated RunningStats: new_mean=[ 1.41928942e+00  5.49074804e+00  8.21824446e-11  2.06040719e-10
  3.02740607e-10 -3.12430486e-11 -1.72414702e-09 -8.92914792e-12
 -6.29113217e-11  6.97060773e-10  9.24686545e-11 -3.38107850e-09
 -7.20864436e-10  3.00273326e-09  8.35885570e-10 -1.27982856e-10
 -1.27982856e-10 -1.27982856e-10 -1.27982856e-10 -1.27982856e-10
 -1.27982856e-10 -1.97524324e-10], new_M2=[  77716.99037337 1328092.9557451   304259.99950308  304260.00374746
  304260.00690725  304259.99787192  304260.00057764  304259.99887885
  304260.00176625  304259.99850852  304259.99554232  304260.0062139
  304260.00095094  304259.99890663  304260.00342134  304259.99644267
  304259.99644267  304259.99644267  304259.99644267  304259.99644267
  304259.99644267  304259.99895635], new_n=304260
2025-06-03 15:12:24,426 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.98834235 0.98834237 0.98834236 0.98834236 1.
 1.00000002]
2025-06-03 15:12:24,427 - DEBUG - Calculated standard deviation: [0.50540037 2.08925671 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:24,427 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:24,427 - DEBUG - Online update step: 1/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 2/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 3/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 4/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 5/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 6/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 7/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 8/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 9/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 10/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 11/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 12/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 13/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 14/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 15/50
2025-06-03 15:12:24,427 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,427 - DEBUG - Online update step: 16/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 17/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 18/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 19/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 20/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 21/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 22/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 23/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 24/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 25/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 26/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 27/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 28/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 29/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 30/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 31/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 32/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 33/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 34/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,428 - DEBUG - Online update step: 35/50
2025-06-03 15:12:24,428 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 36/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 37/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 38/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 39/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 40/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 41/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 42/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 43/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 44/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 45/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 46/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 47/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 48/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 49/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - DEBUG - Online update step: 50/50
2025-06-03 15:12:24,429 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:24,429 - WARNING - No successful steps during online update.
2025-06-03 15:12:24,430 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:24,430 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.1004
2025-06-03 15:12:24,430 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:24,430 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:24,430 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:24,431 - INFO - Running anomaly detection...
2025-06-03 15:12:24,431 - INFO - Starting anomaly detection.
2025-06-03 15:12:24,442 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:24,442 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:24,446 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151224_update_3.json
2025-06-03 15:12:24,446 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:24,453 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151224_update_3.pth and as latest_checkpoint.pth
2025-06-03 15:12:24,453 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955880.dot): 0.4294
2025-06-03 15:12:24,453 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:24,454 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:24,454 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:24,454 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:24,454 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:24,454 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:24,454 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:24,454 - INFO - 
--- Processing file: nw_graph_encoded_1748955895.dot ---
2025-06-03 15:12:24,454 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955895.dot
2025-06-03 15:12:24,454 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955895.dot file.
2025-06-03 15:12:24,466 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:24,485 - INFO - Parsed 2221 edges.
2025-06-03 15:12:25,133 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:25,133 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:25,138 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:25,139 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:25,140 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:25,141 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:25,141 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:25,151 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:25,152 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:25,154 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:25,156 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:25,156 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:25,156 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:25,156 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:25,156 - INFO - Performing online update...
2025-06-03 15:12:25,156 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:25,157 - DEBUG - Updated RunningStats: new_mean=[ 6.90974926e-10 -6.18025582e-10  3.17444939e-09  1.06232482e-09
 -2.28972897e-08  8.56169553e-09 -8.89754026e-09 -1.67285632e-09
 -2.58351778e-09  2.07743170e-09  2.24919282e-09 -1.21959564e-09
  3.49617066e-09 -4.29335318e-09  1.17374027e-09  1.09189580e-09
 -4.99098532e-09  1.83757250e-09 -5.44719876e-09], new_M2=[142170.00426531 142170.00415048 142169.99913449 142170.00098546
 142169.99942258 142169.99850368 142169.99891333 142169.99870368
 142169.99605781 142169.99944668 142170.00057534 142169.99615264
 142169.99495427 137887.996416   137888.00024373 137887.99904776
 137888.00004548 142170.00055359 142170.00563366], new_n=142170
2025-06-03 15:12:25,157 - DEBUG - Updated RunningStats: new_mean=[ 1.41930821e+00  5.49226869e+00  8.35364419e-11  2.10596052e-10
  2.97696355e-10 -3.58860621e-11 -1.71062465e-09  2.59999852e-12
 -4.64684946e-11  6.59193745e-10  1.06971089e-10 -3.40412635e-09
 -7.26754761e-10  2.92241011e-09  8.20335003e-10 -1.29600355e-10
 -1.29600355e-10 -1.29600355e-10 -1.29600355e-10 -1.29600355e-10
 -1.29600355e-10 -1.92596434e-10], new_M2=[  78284.70172702 1338339.93065803  306480.99949159  306481.00384005
  306481.0068687   306480.9977478   306481.00056902  306480.99888972
  306481.00176395  306480.99853434  306480.9954887   306481.00629636
  306481.00095671  306480.99892938  306481.00337662  306480.99638424
  306480.99638424  306480.99638424  306480.99638424  306480.99638424
  306480.99638424  306480.99897671], new_n=306481
2025-06-03 15:12:25,158 - DEBUG - Calculated standard deviation: [1.00000002 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.98482542 0.98482543 0.98482543 0.98482543 1.
 1.00000002]
2025-06-03 15:12:25,158 - DEBUG - Calculated standard deviation: [0.50540167 2.08968796 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:25,158 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:25,158 - DEBUG - Online update step: 1/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 2/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 3/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 4/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 5/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 6/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 7/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 8/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 9/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 10/50
2025-06-03 15:12:25,158 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,158 - DEBUG - Online update step: 11/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 12/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 13/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 14/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 15/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 16/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 17/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 18/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 19/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 20/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 21/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 22/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 23/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 24/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 25/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 26/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 27/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 28/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 29/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,159 - DEBUG - Online update step: 30/50
2025-06-03 15:12:25,159 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 31/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 32/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 33/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 34/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 35/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 36/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 37/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 38/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 39/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 40/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 41/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 42/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 43/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 44/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 45/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 46/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 47/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 48/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 49/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,160 - DEBUG - Online update step: 50/50
2025-06-03 15:12:25,160 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,161 - WARNING - No successful steps during online update.
2025-06-03 15:12:25,161 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:25,161 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0997
2025-06-03 15:12:25,161 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:25,162 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:25,162 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:25,162 - INFO - Running anomaly detection...
2025-06-03 15:12:25,162 - INFO - Starting anomaly detection.
2025-06-03 15:12:25,173 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:25,173 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:25,175 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151225_update_4.json
2025-06-03 15:12:25,175 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:25,181 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151225_update_4.pth and as latest_checkpoint.pth
2025-06-03 15:12:25,181 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955895.dot): 0.4294
2025-06-03 15:12:25,181 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:25,182 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,182 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,182 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,182 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:25,182 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,182 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:25,182 - INFO - 
--- Processing file: nw_graph_encoded_1748955910.dot ---
2025-06-03 15:12:25,182 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955910.dot
2025-06-03 15:12:25,182 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955910.dot file.
2025-06-03 15:12:25,195 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:25,215 - INFO - Parsed 2221 edges.
2025-06-03 15:12:25,865 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:25,865 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:25,870 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:25,872 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:25,872 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:25,873 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:25,873 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:25,883 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:25,885 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:25,886 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:25,888 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:25,888 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:25,888 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:25,888 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:25,888 - INFO - Performing online update...
2025-06-03 15:12:25,889 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:25,889 - DEBUG - Updated RunningStats: new_mean=[ 6.84851873e-10 -6.14082285e-10  2.97128197e-09  1.11321603e-09
 -2.30663065e-08  8.79561906e-09 -8.96143325e-09 -1.69685698e-09
 -2.60255160e-09  2.03366298e-09  2.22622391e-09 -1.23539764e-09
  3.51688427e-09 -4.26306762e-09  1.16546063e-09  1.08419350e-09
 -4.95577862e-09  1.82377757e-09 -5.44228539e-09], new_M2=[143180.00429293 143180.00417938 143179.99917028 143180.00107899
 143179.9994008  143179.99849965 143179.99882804 143179.99869542
 143179.99597725 143179.99941189 143180.00061551 143179.99608377
 143179.99488542 137887.996416   137888.00024373 137887.99904776
 137888.00004548 143180.00054983 143180.00568912], new_n=143180
2025-06-03 15:12:25,890 - DEBUG - Updated RunningStats: new_mean=[ 1.41932673e+00  5.49376745e+00  8.48709561e-11  2.15085836e-10
  2.92724686e-10 -4.04622659e-11 -1.69729685e-09  1.39632488e-11
 -3.02622679e-11  6.21871597e-10  1.21264845e-10 -3.42684255e-09
 -7.32560327e-10  2.84324275e-09  8.05008196e-10 -1.31194580e-10
 -1.31194580e-10 -1.31194580e-10 -1.31194580e-10 -1.31194580e-10
 -1.31194580e-10 -1.87739453e-10], new_M2=[  78852.41286743 1348585.50857787  308701.99948009  308702.00393264
  308702.00683014  308701.99762368  308702.0005604   308701.99890059
  308702.00176166  308701.99856015  308701.99543508  308702.00637882
  308702.00096247  308701.99895214  308702.00333189  308701.99632582
  308701.99632582  308701.99632582  308701.99632582  308701.99632582
  308701.99632582  308701.99899708], new_n=308702
2025-06-03 15:12:25,890 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.98134576 0.98134578 0.98134577 0.98134578 1.
 1.00000002]
2025-06-03 15:12:25,890 - DEBUG - Calculated standard deviation: [0.50540295 2.09011183 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:25,890 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:25,890 - DEBUG - Online update step: 1/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 2/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 3/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 4/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 5/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 6/50
2025-06-03 15:12:25,890 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,890 - DEBUG - Online update step: 7/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 8/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 9/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 10/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 11/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 12/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 13/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 14/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 15/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 16/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 17/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 18/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 19/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 20/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 21/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 22/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 23/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 24/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 25/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,891 - DEBUG - Online update step: 26/50
2025-06-03 15:12:25,891 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 27/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 28/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 29/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 30/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 31/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 32/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 33/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 34/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 35/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 36/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 37/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 38/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 39/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 40/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 41/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 42/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 43/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 44/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 45/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 46/50
2025-06-03 15:12:25,892 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,892 - DEBUG - Online update step: 47/50
2025-06-03 15:12:25,893 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,893 - DEBUG - Online update step: 48/50
2025-06-03 15:12:25,893 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,893 - DEBUG - Online update step: 49/50
2025-06-03 15:12:25,893 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,893 - DEBUG - Online update step: 50/50
2025-06-03 15:12:25,893 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:25,893 - WARNING - No successful steps during online update.
2025-06-03 15:12:25,893 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:25,893 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0990
2025-06-03 15:12:25,894 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:25,894 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:25,894 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:25,894 - INFO - Running anomaly detection...
2025-06-03 15:12:25,894 - INFO - Starting anomaly detection.
2025-06-03 15:12:25,904 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:25,904 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:25,906 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151225_update_5.json
2025-06-03 15:12:25,906 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:25,912 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151225_update_5.pth and as latest_checkpoint.pth
2025-06-03 15:12:25,912 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955910.dot): 0.4294
2025-06-03 15:12:25,912 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:25,912 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,912 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,912 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,912 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:25,912 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:25,913 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:25,913 - INFO - 
--- Processing file: nw_graph_encoded_1748955925.dot ---
2025-06-03 15:12:25,913 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955925.dot
2025-06-03 15:12:25,913 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955925.dot file.
2025-06-03 15:12:25,926 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:25,946 - INFO - Parsed 2221 edges.
2025-06-03 15:12:26,576 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:26,576 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:26,581 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:26,582 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:26,582 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:26,584 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:26,584 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:26,594 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:26,595 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:26,597 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:26,598 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:26,599 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:26,599 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:26,599 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:26,599 - INFO - Performing online update...
2025-06-03 15:12:26,599 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:26,600 - DEBUG - Updated RunningStats: new_mean=[ 6.78814601e-10 -6.10194232e-10  2.77096078e-09  1.16339429e-09
 -2.32329555e-08  9.02626549e-09 -9.02443114e-09 -1.72052141e-09
 -2.62131877e-09  1.99050743e-09  2.20357677e-09 -1.25097827e-09
  3.53730769e-09 -4.23320633e-09  1.15729699e-09  1.07659911e-09
 -4.92106514e-09  1.81017590e-09 -5.43744085e-09], new_M2=[144190.00432056 144190.00420828 144189.99920608 144190.00117251
 144189.99937903 144189.99849563 144189.99874276 144189.99868717
 144189.99589668 144189.9993771  144190.00065568 144189.9960149
 144189.99481658 137887.996416   137888.00024373 137887.99904776
 137888.00004548 144190.00054608 144190.00574458], new_n=144190
2025-06-03 15:12:26,600 - DEBUG - Updated RunningStats: new_mean=[ 1.41934498e+00  5.49524480e+00  8.61864047e-11  2.19511478e-10
  2.87824045e-10 -4.49730918e-11 -1.68415946e-09  2.51641581e-11
 -1.42875714e-11  5.85082651e-10  1.35354392e-10 -3.44923423e-09
 -7.38282952e-10  2.76520642e-09  7.89900356e-10 -1.32766028e-10
 -1.32766028e-10 -1.32766028e-10 -1.32766028e-10 -1.32766028e-10
 -1.32766028e-10 -1.82951861e-10], new_M2=[  79420.12379914 1358829.71944181  310922.9994686   310923.00402523
  310923.00679159  310922.99749956  310923.00055178  310922.99891146
  310923.00175936  310922.99858597  310922.99538145  310923.00646129
  310923.00096823  310922.99897489  310923.00328717  310922.99626739
  310922.99626739  310922.99626739  310922.99626739  310922.99626739
  310922.99626739  310922.99901744], new_n=310923
2025-06-03 15:12:26,600 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.97790273 0.97790275 0.97790274 0.97790275 1.
 1.00000002]
2025-06-03 15:12:26,601 - DEBUG - Calculated standard deviation: [0.50540421 2.09052851 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:26,601 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:26,601 - DEBUG - Online update step: 1/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 2/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 3/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 4/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 5/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 6/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 7/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 8/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 9/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 10/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 11/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 12/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 13/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 14/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 15/50
2025-06-03 15:12:26,601 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,601 - DEBUG - Online update step: 16/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 17/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 18/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 19/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 20/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 21/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 22/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 23/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 24/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 25/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 26/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 27/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 28/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 29/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 30/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 31/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 32/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 33/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 34/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 35/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,602 - DEBUG - Online update step: 36/50
2025-06-03 15:12:26,602 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 37/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 38/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 39/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 40/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 41/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 42/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 43/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 44/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 45/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 46/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 47/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 48/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 49/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - DEBUG - Online update step: 50/50
2025-06-03 15:12:26,603 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:26,603 - WARNING - No successful steps during online update.
2025-06-03 15:12:26,604 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:26,604 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0982
2025-06-03 15:12:26,604 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:26,604 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:26,604 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:26,605 - INFO - Running anomaly detection...
2025-06-03 15:12:26,605 - INFO - Starting anomaly detection.
2025-06-03 15:12:26,615 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:26,616 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:26,617 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151226_update_6.json
2025-06-03 15:12:26,617 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:26,624 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151226_update_6.pth and as latest_checkpoint.pth
2025-06-03 15:12:26,624 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955925.dot): 0.4294
2025-06-03 15:12:26,624 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:26,624 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:26,624 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:26,624 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:26,624 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:26,624 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:26,624 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:26,634 - INFO - Starting 3D embedding visualization...
2025-06-03 15:12:27,475 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5dc6b4470> <matplotlib.colors.Normalize object at 0x74a5dc6b4470>
2025-06-03 15:12:27,476 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d7fc8d40>
2025-06-03 15:12:27,477 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5dc6b4470> <matplotlib.colors.Normalize object at 0x74a5dc6b4470>
2025-06-03 15:12:27,478 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d7fc8d40>
2025-06-03 15:12:27,480 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5dc3ff200>
2025-06-03 15:12:27,547 - ERROR - Error during 3D t-SNE or plotting: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_6_updates_20250603_151226.png'
2025-06-03 15:12:27,547 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 331, in visualize_embeddings_3d
    plt.savefig(filepath)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1657, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_6_updates_20250603_151226.png'

2025-06-03 15:12:27,547 - INFO - Performing visualization of node and edge features.
2025-06-03 15:12:27,547 - INFO - Starting visualization of node features.
2025-06-03 15:12:27,548 - INFO - Graph has 1010 nodes and 19 features.
2025-06-03 15:12:27,548 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-03 15:12:27,548 - INFO - Calculating feature statistics:
2025-06-03 15:12:27,548 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.10731402), 'max': np.float32(9.494974)}
2025-06-03 15:12:27,548 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-1.416348e-08), 'std': np.float32(0.9999999), 'min': np.float32(-9.494974), 'max': np.float32(0.10731402)}
2025-06-03 15:12:27,548 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2924573), 'max': np.float32(3.179208)}
2025-06-03 15:12:27,548 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.6996175e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07549707), 'max': np.float32(18.159897)}
2025-06-03 15:12:27,548 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-03 15:12:27,548 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(5.287699e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65014666), 'max': np.float32(2.8871822)}
2025-06-03 15:12:27,548 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-2.9084294), 'max': np.float32(0.63373893)}
2025-06-03 15:12:27,548 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.07902002), 'max': np.float32(20.264761)}
2025-06-03 15:12:27,548 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.888464e-09), 'std': np.float32(1.0), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-03 15:12:27,549 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(1.2275016e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.09293793), 'max': np.float32(11.41274)}
2025-06-03 15:12:27,549 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.002014), 'max': np.float32(0.92043453)}
2025-06-03 15:12:27,549 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-2.36058e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-03 15:12:27,549 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.888464e-08), 'std': np.float32(0.9999998), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-03 15:12:27,549 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:27,549 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:27,549 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:27,549 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:27,549 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-1.6996175e-08), 'std': np.float32(1.0), 'min': np.float32(-7.4247913), 'max': np.float32(0.15153895)}
2025-06-03 15:12:27,549 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.1466002), 'max': np.float32(4.358143)}
2025-06-03 15:12:27,565 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d54a4680>
2025-06-03 15:12:27,650 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 15:12:27,685 - DEBUG - Plotted ranges of node feature values.
2025-06-03 15:12:27,705 - DEBUG - Plotted sparsity of node features.
2025-06-03 15:12:28,676 - INFO - Node feature visualization saved to vis/node_features_20250603_151227.png
2025-06-03 15:12:28,676 - INFO - Finished visualization of node features.
2025-06-03 15:12:28,677 - INFO - Performing additional feature analysis:
2025-06-03 15:12:28,677 - INFO - - Maximum correlation between different features: nan
2025-06-03 15:12:28,677 - INFO - Starting visualization of edge features.
2025-06-03 15:12:28,677 - INFO - Graph has 2221 edges and 22 edge features.
2025-06-03 15:12:28,677 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 15:12:28,677 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-03 15:12:28,677 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 526, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-03 15:12:28,677 - INFO - 
--- Processing file: nw_graph_encoded_1748955940.dot ---
2025-06-03 15:12:28,677 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955940.dot
2025-06-03 15:12:28,677 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955940.dot file.
2025-06-03 15:12:28,689 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:28,708 - INFO - Parsed 2221 edges.
2025-06-03 15:12:29,346 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:29,346 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:29,351 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:29,352 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:29,353 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:29,354 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:29,354 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:29,364 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:29,366 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:29,367 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:29,369 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:29,369 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:29,369 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:29,369 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:29,369 - INFO - Performing online update...
2025-06-03 15:12:29,370 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:29,370 - DEBUG - Updated RunningStats: new_mean=[ 6.72861318e-10 -6.06360268e-10  2.57342643e-09  1.21287447e-09
 -2.33972861e-08  9.25370320e-09 -9.08655261e-09 -1.74385662e-09
 -2.63982486e-09  1.94795224e-09  2.18124470e-09 -1.26634214e-09
  3.55744698e-09 -4.20376048e-09  1.14924693e-09  1.06911037e-09
 -4.88683459e-09  1.79676346e-09 -5.43266371e-09], new_M2=[145200.00434818 145200.00423718 145199.99924187 145200.00126603
 145199.99935725 145199.99849161 145199.99865747 145199.99867892
 145199.99581611 145199.99934231 145200.00069585 145199.99594603
 145199.99474773 137887.996416   137888.00024373 137887.99904776
 137888.00004548 145200.00054233 145200.00580004], new_n=145200
2025-06-03 15:12:29,371 - DEBUG - Updated RunningStats: new_mean=[ 1.41936298e+00  5.49670120e+00  8.74831936e-11  2.23874341e-10
  2.82992920e-10 -4.94199309e-11 -1.67120843e-09  3.62061806e-11
  1.46052138e-12  5.48815563e-10  1.49244077e-10 -3.47130827e-09
 -7.43924401e-10  2.68827704e-09  7.75006824e-10 -1.34315186e-10
 -1.34315186e-10 -1.34315186e-10 -1.34315186e-10 -1.34315186e-10
 -1.34315186e-10 -1.78232183e-10], new_M2=[  79987.83452661 1369072.59233773  313143.99945711  313144.00411782
  313144.00675303  313143.99737543  313144.00054316  313143.99892233
  313144.00175706  313143.99861179  313143.99532783  313144.00654375
  313144.00097399  313143.99899764  313144.00324244  313143.99620896
  313143.99620896  313143.99620896  313143.99620896  313143.99620896
  313143.99620896  313143.99903781], new_n=313144
2025-06-03 15:12:29,371 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.97449569 0.9744957  0.9744957  0.9744957  1.
 1.00000002]
2025-06-03 15:12:29,371 - DEBUG - Calculated standard deviation: [0.50540545 2.09093817 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:29,371 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:29,371 - DEBUG - Online update step: 1/50
2025-06-03 15:12:29,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,371 - DEBUG - Online update step: 2/50
2025-06-03 15:12:29,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,371 - DEBUG - Online update step: 3/50
2025-06-03 15:12:29,371 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 4/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 5/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 6/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 7/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 8/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 9/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 10/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 11/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 12/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 13/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 14/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 15/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 16/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 17/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 18/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 19/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 20/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 21/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,372 - DEBUG - Online update step: 22/50
2025-06-03 15:12:29,372 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 23/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 24/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 25/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 26/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 27/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 28/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 29/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 30/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 31/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 32/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 33/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 34/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 35/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 36/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 37/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 38/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 39/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 40/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 41/50
2025-06-03 15:12:29,373 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,373 - DEBUG - Online update step: 42/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 43/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 44/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 45/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 46/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 47/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 48/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 49/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - DEBUG - Online update step: 50/50
2025-06-03 15:12:29,374 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:29,374 - WARNING - No successful steps during online update.
2025-06-03 15:12:29,375 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:29,375 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0975
2025-06-03 15:12:29,375 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:29,375 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:29,375 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:29,375 - INFO - Running anomaly detection...
2025-06-03 15:12:29,375 - INFO - Starting anomaly detection.
2025-06-03 15:12:29,387 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:29,388 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:29,390 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151229_update_7.json
2025-06-03 15:12:29,390 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:29,396 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151229_update_7.pth and as latest_checkpoint.pth
2025-06-03 15:12:29,396 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955940.dot): 0.4294
2025-06-03 15:12:29,396 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:29,396 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:29,396 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:29,396 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:29,396 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:29,397 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:29,397 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:29,397 - INFO - 
--- Processing file: nw_graph_encoded_1748955955.dot ---
2025-06-03 15:12:29,397 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955955.dot
2025-06-03 15:12:29,397 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955955.dot file.
2025-06-03 15:12:29,538 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:29,556 - INFO - Parsed 2221 edges.
2025-06-03 15:12:30,248 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:30,248 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:30,253 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:30,254 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:30,255 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:30,256 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:30,256 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:30,266 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:30,267 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:30,269 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:30,271 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:30,271 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:30,271 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:30,271 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:30,271 - INFO - Performing online update...
2025-06-03 15:12:30,271 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:30,272 - DEBUG - Updated RunningStats: new_mean=[ 6.66990284e-10 -6.02579273e-10  2.37862117e-09  1.26167106e-09
 -2.35593463e-08  9.47799869e-09 -9.14781582e-09 -1.76686944e-09
 -2.65807527e-09  1.90598499e-09  2.15922116e-09 -1.28149375e-09
  3.57730804e-09 -4.17472144e-09  1.14130807e-09  1.06172509e-09
 -4.85307697e-09  1.78353632e-09 -5.42795256e-09], new_M2=[146210.00437581 146210.00426608 146209.99927766 146210.00135956
 146209.99933547 146209.99848758 146209.99857218 146209.99867066
 146209.99573555 146209.99930752 146210.00073602 146209.99587716
 146209.99467889 137887.996416   137888.00024373 137887.99904776
 137888.00004548 146210.00053858 146210.00585551], new_n=146210
2025-06-03 15:12:30,272 - DEBUG - Updated RunningStats: new_mean=[ 1.41938072e+00  5.49813708e+00  8.87617167e-11  2.28175752e-10
  2.78229843e-10 -5.38041351e-11 -1.65843982e-09  4.70926733e-11
  1.69867981e-11  5.13059307e-10  1.62938122e-10 -3.49307139e-09
 -7.49486389e-10  2.61243124e-09  7.60323070e-10 -1.35842523e-10
 -1.35842523e-10 -1.35842523e-10 -1.35842523e-10 -1.35842523e-10
 -1.35842523e-10 -1.73578982e-10], new_M2=[  80555.54505414 1379314.15553408  315364.99944562  315365.00421041
  315365.00671448  315364.99725131  315365.00053454  315364.9989332
  315365.00175476  315364.99863761  315364.99527421  315365.00662621
  315365.00097976  315364.9990204   315365.00319772  315364.99615054
  315364.99615054  315364.99615054  315364.99615054  315364.99615054
  315364.99615054  315364.99905817], new_n=315365
2025-06-03 15:12:30,273 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.         1.         0.99999999
 1.         1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.97112401 0.97112402 0.97112402 0.97112402 1.
 1.00000002]
2025-06-03 15:12:30,273 - DEBUG - Calculated standard deviation: [0.50540668 2.09134099 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.00000001 0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:30,273 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:30,273 - DEBUG - Online update step: 1/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 2/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 3/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 4/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 5/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 6/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 7/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 8/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 9/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 10/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 11/50
2025-06-03 15:12:30,273 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,273 - DEBUG - Online update step: 12/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 13/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 14/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 15/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 16/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 17/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 18/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 19/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 20/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 21/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 22/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 23/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 24/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 25/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 26/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 27/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 28/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 29/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 30/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 31/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,274 - DEBUG - Online update step: 32/50
2025-06-03 15:12:30,274 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 33/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 34/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 35/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 36/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 37/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 38/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 39/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 40/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 41/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 42/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 43/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 44/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 45/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 46/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 47/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 48/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 49/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - DEBUG - Online update step: 50/50
2025-06-03 15:12:30,275 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:30,275 - WARNING - No successful steps during online update.
2025-06-03 15:12:30,276 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:30,276 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0968
2025-06-03 15:12:30,276 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:30,277 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:30,277 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:30,277 - INFO - Running anomaly detection...
2025-06-03 15:12:30,277 - INFO - Starting anomaly detection.
2025-06-03 15:12:30,287 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:30,287 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:30,289 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151230_update_8.json
2025-06-03 15:12:30,289 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:30,295 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151230_update_8.pth and as latest_checkpoint.pth
2025-06-03 15:12:30,295 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955955.dot): 0.4294
2025-06-03 15:12:30,295 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:30,295 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:30,295 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:30,295 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:30,295 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:30,295 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:30,295 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:30,295 - INFO - 
--- Processing file: nw_graph_encoded_1748955970.dot ---
2025-06-03 15:12:30,295 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955970.dot
2025-06-03 15:12:30,295 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955970.dot file.
2025-06-03 15:12:30,308 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:30,327 - INFO - Parsed 2221 edges.
2025-06-03 15:12:30,998 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:30,998 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:31,004 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:31,007 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:31,009 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:31,010 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:31,010 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:31,026 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:31,027 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:31,028 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:31,030 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:31,033 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:31,033 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:31,033 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:31,033 - INFO - Performing online update...
2025-06-03 15:12:31,033 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:31,034 - DEBUG - Updated RunningStats: new_mean=[ 6.61199806e-10 -5.98850158e-10  2.18648882e-09  1.30979810e-09
 -2.37191830e-08  9.69921663e-09 -9.20823845e-09 -1.78956650e-09
 -2.67607527e-09  1.86459358e-09  2.13749981e-09 -1.29643746e-09
  3.59689658e-09 -4.14608084e-09  1.13347815e-09  1.05444115e-09
 -4.81978252e-09  1.77049066e-09 -5.42330606e-09], new_M2=[147220.00440343 147220.00429498 147219.99931346 147220.00145308
 147219.99931369 147219.99848356 147219.99848689 147219.99866241
 147219.99565498 147219.99927273 147220.00077619 147219.9958083
 147219.99461004 137887.996416   137888.00024373 137887.99904776
 137888.00004548 147220.00053482 147220.00591097], new_n=147220
2025-06-03 15:12:31,034 - DEBUG - Updated RunningStats: new_mean=[ 1.41939821e+00  5.49955288e+00  9.00223575e-11  2.32417000e-10
  2.73533385e-10 -5.81270185e-11 -1.64584980e-09  5.78268992e-11
  3.22959124e-11  4.77803164e-10  1.76440632e-10 -3.51453012e-09
 -7.54970582e-10  2.53764627e-09  7.45844695e-10 -1.37348497e-10
 -1.37348497e-10 -1.37348497e-10 -1.37348497e-10 -1.37348497e-10
 -1.37348497e-10 -1.68990864e-10], new_M2=[  81123.25538594 1389554.43650855  317585.99943413  317586.004303
  317586.00667592  317585.99712719  317586.00052592  317585.99894407
  317586.00175246  317585.99866343  317585.99522058  317586.00670867
  317586.00098552  317585.99904315  317586.00315299  317585.99609211
  317585.99609211  317585.99609211  317585.99609211  317585.99609211
  317585.99609211  317585.99907854], new_n=317586
2025-06-03 15:12:31,034 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.         1.         0.99999999
 0.99999999 1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.96778709 0.9677871  0.9677871  0.9677871  1.
 1.00000002]
2025-06-03 15:12:31,035 - DEBUG - Calculated standard deviation: [0.50540788 2.09173714 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:31,035 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:31,035 - DEBUG - Online update step: 1/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 2/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 3/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 4/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 5/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 6/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 7/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 8/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 9/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 10/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 11/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 12/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 13/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 14/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 15/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 16/50
2025-06-03 15:12:31,035 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,035 - DEBUG - Online update step: 17/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 18/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 19/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 20/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 21/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 22/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 23/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 24/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 25/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 26/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 27/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 28/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 29/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 30/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 31/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 32/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 33/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 34/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 35/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 36/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 37/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 38/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,036 - DEBUG - Online update step: 39/50
2025-06-03 15:12:31,036 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 40/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 41/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 42/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 43/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 44/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 45/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 46/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 47/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 48/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 49/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - DEBUG - Online update step: 50/50
2025-06-03 15:12:31,037 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,037 - WARNING - No successful steps during online update.
2025-06-03 15:12:31,038 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:31,038 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0961
2025-06-03 15:12:31,038 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:31,038 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:31,039 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:31,039 - INFO - Running anomaly detection...
2025-06-03 15:12:31,039 - INFO - Starting anomaly detection.
2025-06-03 15:12:31,058 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:31,058 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:31,060 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151231_update_9.json
2025-06-03 15:12:31,060 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:31,067 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151231_update_9.pth and as latest_checkpoint.pth
2025-06-03 15:12:31,067 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955970.dot): 0.4294
2025-06-03 15:12:31,067 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:31,068 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,068 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,068 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,068 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:31,068 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,068 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:31,068 - INFO - 
--- Processing file: nw_graph_encoded_1748955985.dot ---
2025-06-03 15:12:31,068 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748955985.dot
2025-06-03 15:12:31,068 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748955985.dot file.
2025-06-03 15:12:31,082 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:31,102 - INFO - Parsed 2221 edges.
2025-06-03 15:12:31,769 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:31,769 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:31,774 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:31,775 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:31,776 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:31,777 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:31,777 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:31,788 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:31,789 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:31,791 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:31,793 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:31,793 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:31,794 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:31,794 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:31,794 - INFO - Performing online update...
2025-06-03 15:12:31,794 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:31,794 - DEBUG - Updated RunningStats: new_mean=[ 6.55488238e-10 -5.95171860e-10  1.99697475e-09  1.35726930e-09
 -2.38768414e-08  9.91741993e-09 -9.26783767e-09 -1.81195426e-09
 -2.69382997e-09  1.82376622e-09  2.11607446e-09 -1.31117753e-09
  3.61621818e-09 -4.11783054e-09  1.12575493e-09  1.04725646e-09
 -4.78694180e-09  1.75762279e-09 -5.41872288e-09], new_M2=[148230.00443106 148230.00432388 148229.99934925 148230.00154661
 148229.99929191 148229.99847954 148229.9984016  148229.99865416
 148229.99557441 148229.99923794 148230.00081636 148229.99573943
 148229.99454119 137887.996416   137888.00024373 137887.99904776
 137888.00004548 148230.00053107 148230.00596643], new_n=148230
2025-06-03 15:12:31,795 - DEBUG - Updated RunningStats: new_mean=[ 1.41941546e+00  5.50094901e+00  9.12654885e-11  2.36599339e-10
  2.68902160e-10 -6.23898586e-11 -1.63343464e-09  6.84120307e-11
  4.73923889e-11  4.43036717e-10  1.89755597e-10 -3.53569079e-09
 -7.60378602e-10  2.46390004e-09  7.31567419e-10 -1.38833554e-10
 -1.38833554e-10 -1.38833554e-10 -1.38833554e-10 -1.38833554e-10
 -1.38833554e-10 -1.64466473e-10], new_M2=[  81690.96552608 1399793.46197552  319806.99942264  319807.00439558
  319807.00663737  319806.99700307  319807.0005173   319806.99895494
  319807.00175016  319806.99868925  319806.99516696  319807.00679114
  319807.00099128  319806.99906591  319807.00310827  319806.99603369
  319806.99603369  319806.99603369  319806.99603369  319806.99603369
  319806.99603369  319806.9990989 ], new_n=319807
2025-06-03 15:12:31,795 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999999 1.         1.         0.99999999
 0.99999998 0.96448433 0.96448434 0.96448434 0.96448434 1.
 1.00000002]
2025-06-03 15:12:31,795 - DEBUG - Calculated standard deviation: [0.50540907 2.09212678 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:31,795 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:31,795 - DEBUG - Online update step: 1/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 2/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 3/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 4/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 5/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 6/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 7/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 8/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 9/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 10/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 11/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 12/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 13/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 14/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 15/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 16/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 17/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 18/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 19/50
2025-06-03 15:12:31,796 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,796 - DEBUG - Online update step: 20/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 21/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 22/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 23/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 24/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 25/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 26/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 27/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 28/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 29/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 30/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 31/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 32/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 33/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 34/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 35/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 36/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 37/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 38/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,797 - DEBUG - Online update step: 39/50
2025-06-03 15:12:31,797 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 40/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 41/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 42/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 43/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 44/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 45/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 46/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 47/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 48/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 49/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - DEBUG - Online update step: 50/50
2025-06-03 15:12:31,798 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:31,798 - WARNING - No successful steps during online update.
2025-06-03 15:12:31,799 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:31,799 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0954
2025-06-03 15:12:31,799 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:31,799 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:31,799 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:31,799 - INFO - Running anomaly detection...
2025-06-03 15:12:31,800 - INFO - Starting anomaly detection.
2025-06-03 15:12:31,812 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:31,812 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:31,814 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151231_update_10.json
2025-06-03 15:12:31,814 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:31,820 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151231_update_10.pth and as latest_checkpoint.pth
2025-06-03 15:12:31,820 - INFO - 
Global anomaly score (after nw_graph_encoded_1748955985.dot): 0.4294
2025-06-03 15:12:31,820 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:31,820 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,820 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,820 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,820 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:31,820 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:31,821 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:31,821 - INFO - 
--- Processing file: nw_graph_encoded_1748956000.dot ---
2025-06-03 15:12:31,821 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956000.dot
2025-06-03 15:12:31,821 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956000.dot file.
2025-06-03 15:12:31,833 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:31,853 - INFO - Parsed 2221 edges.
2025-06-03 15:12:32,502 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:32,502 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:32,507 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:32,509 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:32,509 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:32,510 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:32,510 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:32,521 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:32,523 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:32,525 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:32,526 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:32,527 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:32,527 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:32,527 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:32,527 - INFO - Performing online update...
2025-06-03 15:12:32,527 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:32,528 - DEBUG - Updated RunningStats: new_mean=[ 6.49853978e-10 -5.91543350e-10  1.81002580e-09  1.40409796e-09
 -2.40323659e-08  1.01326698e-08 -9.32663020e-09 -1.83403899e-09
 -2.71134436e-09  1.78349147e-09  2.09493912e-09 -1.32571809e-09
  3.63527826e-09 -4.08996262e-09  1.11813625e-09  1.04016903e-09
 -4.75454559e-09  1.74492909e-09 -5.41420173e-09], new_M2=[149240.00445868 149240.00435277 149239.99938504 149240.00164013
 149239.99927013 149239.99847551 149239.99831631 149239.99864591
 149239.99549384 149239.99920315 149240.00085653 149239.99567056
 149239.99447235 137887.996416   137888.00024373 137887.99904776
 137888.00004548 149240.00052732 149240.00602189], new_n=149240
2025-06-03 15:12:32,528 - DEBUG - Updated RunningStats: new_mean=[ 1.41943247e+00  5.50232588e+00  9.24914719e-11  2.40723987e-10
  2.64334817e-10 -6.65938978e-11 -1.62119075e-09  7.88511526e-11
  6.22806271e-11  4.08749832e-10  2.02886897e-10 -3.55655958e-09
 -7.65712025e-10  2.39117105e-09  7.17487081e-10 -1.40298127e-10
 -1.40298127e-10 -1.40298127e-10 -1.40298127e-10 -1.40298127e-10
 -1.40298127e-10 -1.60004492e-10], new_M2=[  82258.67547853 1410031.25791237  322027.99941114  322028.00448817
  322028.00659881  322027.99687894  322028.00050868  322027.99896581
  322028.00174786  322027.99871507  322027.99511334  322028.0068736
  322028.00099704  322027.99908866  322028.00306354  322027.99597526
  322027.99597526  322027.99597526  322027.99597526  322027.99597526
  322027.99597526  322027.99911927], new_n=322028
2025-06-03 15:12:32,529 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999999
 0.99999998 0.96121516 0.96121517 0.96121517 0.96121517 1.
 1.00000002]
2025-06-03 15:12:32,529 - DEBUG - Calculated standard deviation: [0.50541024 2.09251005 1.         1.00000001 1.00000001 1.
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:32,529 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:32,529 - DEBUG - Online update step: 1/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 2/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 3/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 4/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 5/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 6/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 7/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 8/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 9/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 10/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 11/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,529 - DEBUG - Online update step: 12/50
2025-06-03 15:12:32,529 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 13/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 14/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 15/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 16/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 17/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 18/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 19/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 20/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 21/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 22/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 23/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 24/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 25/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 26/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 27/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 28/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 29/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 30/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,530 - DEBUG - Online update step: 31/50
2025-06-03 15:12:32,530 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 32/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 33/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 34/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 35/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 36/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 37/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 38/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 39/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 40/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 41/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 42/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 43/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 44/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 45/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 46/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 47/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 48/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 49/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - DEBUG - Online update step: 50/50
2025-06-03 15:12:32,531 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:32,531 - WARNING - No successful steps during online update.
2025-06-03 15:12:32,532 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:32,532 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0947
2025-06-03 15:12:32,533 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:32,533 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:32,533 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:32,533 - INFO - Running anomaly detection...
2025-06-03 15:12:32,533 - INFO - Starting anomaly detection.
2025-06-03 15:12:32,547 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:32,547 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:32,549 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151232_update_11.json
2025-06-03 15:12:32,550 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:32,556 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151232_update_11.pth and as latest_checkpoint.pth
2025-06-03 15:12:32,556 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956000.dot): 0.4294
2025-06-03 15:12:32,556 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:32,556 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:32,556 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:32,556 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:32,556 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:32,556 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:32,556 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:32,572 - INFO - Starting 3D embedding visualization...
2025-06-03 15:12:33,402 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5d4f7c470> <matplotlib.colors.Normalize object at 0x74a5d4f7c470>
2025-06-03 15:12:33,403 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d77e9160>
2025-06-03 15:12:33,404 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5d4f7c470> <matplotlib.colors.Normalize object at 0x74a5d4f7c470>
2025-06-03 15:12:33,405 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d77e9160>
2025-06-03 15:12:33,407 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d77e9010>
2025-06-03 15:12:33,473 - ERROR - Error during 3D t-SNE or plotting: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_11_updates_20250603_151232.png'
2025-06-03 15:12:33,474 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 331, in visualize_embeddings_3d
    plt.savefig(filepath)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1657, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_11_updates_20250603_151232.png'

2025-06-03 15:12:33,474 - INFO - Performing visualization of node and edge features.
2025-06-03 15:12:33,474 - INFO - Starting visualization of node features.
2025-06-03 15:12:33,474 - INFO - Graph has 1010 nodes and 19 features.
2025-06-03 15:12:33,474 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-03 15:12:33,474 - INFO - Calculating feature statistics:
2025-06-03 15:12:33,474 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.10731402), 'max': np.float32(9.494974)}
2025-06-03 15:12:33,474 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-1.416348e-08), 'std': np.float32(0.9999999), 'min': np.float32(-9.494974), 'max': np.float32(0.10731402)}
2025-06-03 15:12:33,474 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2924573), 'max': np.float32(3.179208)}
2025-06-03 15:12:33,474 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.6996175e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07549707), 'max': np.float32(18.159897)}
2025-06-03 15:12:33,474 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-03 15:12:33,474 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(5.287699e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65014666), 'max': np.float32(2.8871822)}
2025-06-03 15:12:33,475 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-2.9084294), 'max': np.float32(0.63373893)}
2025-06-03 15:12:33,475 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.07902002), 'max': np.float32(20.264761)}
2025-06-03 15:12:33,475 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.888464e-09), 'std': np.float32(1.0), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-03 15:12:33,475 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(1.2275016e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.09293793), 'max': np.float32(11.41274)}
2025-06-03 15:12:33,475 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.002014), 'max': np.float32(0.92043453)}
2025-06-03 15:12:33,475 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-2.36058e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-03 15:12:33,475 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.888464e-08), 'std': np.float32(0.9999998), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-03 15:12:33,475 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:33,475 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:33,475 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:33,475 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:12:33,475 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-1.6996175e-08), 'std': np.float32(1.0), 'min': np.float32(-7.4247913), 'max': np.float32(0.15153895)}
2025-06-03 15:12:33,475 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.1466002), 'max': np.float32(4.358143)}
2025-06-03 15:12:33,486 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d4eac980>
2025-06-03 15:12:33,569 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 15:12:33,603 - DEBUG - Plotted ranges of node feature values.
2025-06-03 15:12:33,623 - DEBUG - Plotted sparsity of node features.
2025-06-03 15:12:34,591 - INFO - Node feature visualization saved to vis/node_features_20250603_151233.png
2025-06-03 15:12:34,591 - INFO - Finished visualization of node features.
2025-06-03 15:12:34,591 - INFO - Performing additional feature analysis:
2025-06-03 15:12:34,591 - INFO - - Maximum correlation between different features: nan
2025-06-03 15:12:34,591 - INFO - Starting visualization of edge features.
2025-06-03 15:12:34,592 - INFO - Graph has 2221 edges and 22 edge features.
2025-06-03 15:12:34,592 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 15:12:34,592 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-03 15:12:34,592 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 526, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-03 15:12:34,592 - INFO - 
--- Processing file: nw_graph_encoded_1748956015.dot ---
2025-06-03 15:12:34,592 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956015.dot
2025-06-03 15:12:34,592 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956015.dot file.
2025-06-03 15:12:34,603 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:34,622 - INFO - Parsed 2221 edges.
2025-06-03 15:12:35,239 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:35,239 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:35,244 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:35,245 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:35,245 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:35,246 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:35,246 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:35,257 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:35,258 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:35,260 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:35,261 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:35,261 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:35,262 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:35,262 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:35,262 - INFO - Performing online update...
2025-06-03 15:12:35,262 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:35,262 - DEBUG - Updated RunningStats: new_mean=[ 6.44295466e-10 -5.87963622e-10  1.62559024e-09  1.45029704e-09
 -2.41857995e-08  1.03450258e-08 -9.38463231e-09 -1.85582681e-09
 -2.72862328e-09  1.74375818e-09  2.07408792e-09 -1.34006316e-09
  3.65408209e-09 -4.06246936e-09  1.11061999e-09  1.03317688e-09
 -4.72258491e-09  1.73240604e-09 -5.40974136e-09], new_M2=[150250.0044863  150250.00438167 150249.99942084 150250.00173365
 150249.99924835 150249.99847149 150249.99823102 150249.99863765
 150249.99541328 150249.99916836 150250.0008967  150249.99560169
 150249.9944035  137887.996416   137888.00024373 137887.99904776
 137888.00004548 150250.00052357 150250.00607735], new_n=150250
2025-06-03 15:12:35,263 - DEBUG - Updated RunningStats: new_mean=[ 1.41944925e+00  5.50368390e+00  9.37006602e-11  2.44792130e-10
  2.59830044e-10 -7.07403444e-11 -1.60911458e-09  8.91472655e-11
  7.69649061e-11  3.74932655e-10  2.15838307e-10 -3.57714247e-09
 -7.70972383e-10  2.31943840e-09  7.03599635e-10 -1.41742635e-10
 -1.41742635e-10 -1.41742635e-10 -1.41742635e-10 -1.41742635e-10
 -1.41742635e-10 -1.55603636e-10], new_M2=[  82826.38524714 1420267.84958475  324248.99939965  324249.00458076
  324249.00656026  324248.99675482  324249.00050005  324248.99897668
  324249.00174556  324248.99874089  324248.99505971  324249.00695606
  324249.00100281  324248.99911141  324249.00301882  324248.99591683
  324248.99591683  324248.99591683  324248.99591683  324248.99591683
  324248.99591683  324248.99913963], new_n=324249
2025-06-03 15:12:35,263 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999999
 0.99999998 0.957979   0.95797902 0.95797901 0.95797902 1.
 1.00000002]
2025-06-03 15:12:35,263 - DEBUG - Calculated standard deviation: [0.5054114  2.09288712 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:35,263 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:35,263 - DEBUG - Online update step: 1/50
2025-06-03 15:12:35,263 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,263 - DEBUG - Online update step: 2/50
2025-06-03 15:12:35,263 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,263 - DEBUG - Online update step: 3/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 4/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 5/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 6/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 7/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 8/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 9/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 10/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 11/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 12/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 13/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 14/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 15/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 16/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 17/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 18/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 19/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 20/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 21/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 22/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 23/50
2025-06-03 15:12:35,264 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,264 - DEBUG - Online update step: 24/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 25/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 26/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 27/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 28/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 29/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 30/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 31/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 32/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 33/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 34/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 35/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 36/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 37/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 38/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 39/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 40/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 41/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 42/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 43/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 44/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,265 - DEBUG - Online update step: 45/50
2025-06-03 15:12:35,265 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - DEBUG - Online update step: 46/50
2025-06-03 15:12:35,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - DEBUG - Online update step: 47/50
2025-06-03 15:12:35,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - DEBUG - Online update step: 48/50
2025-06-03 15:12:35,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - DEBUG - Online update step: 49/50
2025-06-03 15:12:35,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - DEBUG - Online update step: 50/50
2025-06-03 15:12:35,266 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:35,266 - WARNING - No successful steps during online update.
2025-06-03 15:12:35,266 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:35,266 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0941
2025-06-03 15:12:35,267 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:35,267 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:35,267 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:35,267 - INFO - Running anomaly detection...
2025-06-03 15:12:35,267 - INFO - Starting anomaly detection.
2025-06-03 15:12:35,276 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:35,276 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:35,278 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151235_update_12.json
2025-06-03 15:12:35,278 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:35,284 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151235_update_12.pth and as latest_checkpoint.pth
2025-06-03 15:12:35,284 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956015.dot): 0.4294
2025-06-03 15:12:35,284 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:35,284 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:35,284 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:35,284 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:35,284 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:35,285 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:35,285 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:35,285 - INFO - 
--- Processing file: nw_graph_encoded_1748956030.dot ---
2025-06-03 15:12:35,285 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956030.dot
2025-06-03 15:12:35,285 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956030.dot file.
2025-06-03 15:12:35,297 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:35,316 - INFO - Parsed 2221 edges.
2025-06-03 15:12:35,959 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:35,959 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:35,964 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:35,966 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:35,966 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:35,967 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:35,967 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:36,114 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:36,115 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:36,117 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:36,118 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:36,119 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:36,119 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:36,119 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:36,119 - INFO - Performing online update...
2025-06-03 15:12:36,119 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:36,120 - DEBUG - Updated RunningStats: new_mean=[ 6.38811184e-10 -5.84431699e-10  1.44361772e-09  1.49587916e-09
 -2.43371841e-08  1.05545459e-08 -9.44185983e-09 -1.87732367e-09
 -2.74567145e-09  1.70455551e-09  2.05351517e-09 -1.35421666e-09
  3.67263480e-09 -4.03534326e-09  1.10320411e-09  1.02627810e-09
 -4.69105106e-09  1.72005023e-09 -5.40534056e-09], new_M2=[151260.00451393 151260.00441057 151259.99945663 151260.00182718
 151259.99922657 151259.99846747 151259.99814573 151259.9986294
 151259.99533271 151259.99913357 151260.00093686 151259.99553282
 151259.99433466 137887.996416   137888.00024373 137887.99904776
 137888.00004548 151260.00051981 151260.00613281], new_n=151260
2025-06-03 15:12:36,120 - DEBUG - Updated RunningStats: new_mean=[ 1.41946580e+00  5.50502343e+00  9.48933960e-11  2.48804922e-10
  2.55386564e-10 -7.48303739e-11 -1.59720273e-09  9.93032878e-11
  9.14493886e-11  3.41575599e-10  2.28613499e-10 -3.59744532e-09
 -7.76161168e-10  2.24868176e-09  6.89901144e-10 -1.43167490e-10
 -1.43167490e-10 -1.43167490e-10 -1.43167490e-10 -1.43167490e-10
 -1.43167490e-10 -1.51262659e-10], new_M2=[  83394.09483567 1430503.26157076  326469.99938816  326470.00467335
  326470.0065217   326469.9966307   326470.00049143  326469.99898756
  326470.00174327  326469.99876671  326469.99500609  326470.00703852
  326470.00100857  326469.99913417  326470.00297409  326469.99585841
  326469.99585841  326469.99585841  326469.99585841  326469.99585841
  326469.99585841  326469.99916   ], new_n=326470
2025-06-03 15:12:36,121 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999999
 0.99999998 0.95477532 0.95477533 0.95477533 0.95477533 1.
 1.00000002]
2025-06-03 15:12:36,121 - DEBUG - Calculated standard deviation: [0.50541254 2.09325813 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:36,121 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:36,121 - DEBUG - Online update step: 1/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 2/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 3/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 4/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 5/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 6/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 7/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 8/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 9/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 10/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 11/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 12/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 13/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 14/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,121 - DEBUG - Online update step: 15/50
2025-06-03 15:12:36,121 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 16/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 17/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 18/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 19/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 20/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 21/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 22/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 23/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 24/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 25/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 26/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 27/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 28/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 29/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 30/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 31/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 32/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 33/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 34/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 35/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 36/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,122 - DEBUG - Online update step: 37/50
2025-06-03 15:12:36,122 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 38/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 39/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 40/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 41/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 42/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 43/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 44/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 45/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 46/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 47/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 48/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 49/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - DEBUG - Online update step: 50/50
2025-06-03 15:12:36,123 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,123 - WARNING - No successful steps during online update.
2025-06-03 15:12:36,124 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:36,124 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0934
2025-06-03 15:12:36,124 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:36,124 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:36,124 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:36,124 - INFO - Running anomaly detection...
2025-06-03 15:12:36,124 - INFO - Starting anomaly detection.
2025-06-03 15:12:36,135 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:36,135 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:36,137 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151236_update_13.json
2025-06-03 15:12:36,137 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:36,143 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151236_update_13.pth and as latest_checkpoint.pth
2025-06-03 15:12:36,143 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956030.dot): 0.4294
2025-06-03 15:12:36,143 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:36,143 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,143 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,143 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,143 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:36,143 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,143 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:36,143 - INFO - 
--- Processing file: nw_graph_encoded_1748956045.dot ---
2025-06-03 15:12:36,143 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956045.dot
2025-06-03 15:12:36,143 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956045.dot file.
2025-06-03 15:12:36,156 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:36,175 - INFO - Parsed 2221 edges.
2025-06-03 15:12:36,903 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:36,903 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:36,909 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:36,911 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:36,911 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:36,913 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:36,913 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:36,923 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:36,925 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:36,927 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:36,928 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:36,932 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:36,940 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:36,940 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:36,940 - INFO - Performing online update...
2025-06-03 15:12:36,940 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:36,941 - DEBUG - Updated RunningStats: new_mean=[ 6.33399657e-10 -5.80946631e-10  1.26405923e-09  1.54085659e-09
 -2.44865604e-08  1.07612865e-08 -9.49832817e-09 -1.89853535e-09
 -2.76249346e-09  1.66587290e-09  2.03321535e-09 -1.36818240e-09
  3.69094139e-09 -4.00857701e-09  1.09588661e-09  1.01947085e-09
 -4.65993553e-09  1.70785834e-09 -5.40099814e-09], new_M2=[152270.00454155 152270.00443947 152269.99949242 152270.0019207
 152269.9992048  152269.99846344 152269.99806044 152269.99862115
 152269.99525214 152269.99909878 152270.00097703 152269.99546396
 152269.99426581 137887.996416   137888.00024373 137887.99904776
 137888.00004548 152270.00051606 152270.00618827], new_n=152270
2025-06-03 15:12:36,941 - DEBUG - Updated RunningStats: new_mean=[ 1.41948213e+00  5.50634486e+00  9.60700130e-11  2.52763484e-10
  2.51003133e-10 -7.88651298e-11 -1.58545185e-09  1.09322060e-10
  1.05738125e-10  3.08669338e-10  2.41216044e-10 -3.61747378e-09
 -7.81279831e-10  2.17888134e-09  6.76387777e-10 -1.44573089e-10
 -1.44573089e-10 -1.44573089e-10 -1.44573089e-10 -1.44573089e-10
 -1.44573089e-10 -1.46980347e-10], new_M2=[  83961.80424776 1440737.5177842   328690.99937667  328691.00476594
  328691.00648315  328690.99650657  328691.00048281  328690.99899843
  328691.00174097  328690.99879253  328690.99495247  328691.00712099
  328691.00101433  328690.99915692  328691.00292936  328690.99579998
  328690.99579998  328690.99579998  328690.99579998  328690.99579998
  328690.99579998  328690.99918036], new_n=328691
2025-06-03 15:12:36,942 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999999
 0.99999998 0.95160356 0.95160357 0.95160357 0.95160357 1.
 1.00000002]
2025-06-03 15:12:36,942 - DEBUG - Calculated standard deviation: [0.50541366 2.09362322 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:36,942 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:36,942 - DEBUG - Online update step: 1/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 2/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 3/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 4/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 5/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 6/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 7/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 8/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 9/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 10/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 11/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 12/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 13/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,942 - DEBUG - Online update step: 14/50
2025-06-03 15:12:36,942 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 15/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 16/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 17/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 18/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 19/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 20/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 21/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 22/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 23/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 24/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 25/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 26/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 27/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 28/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 29/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 30/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 31/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 32/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 33/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 34/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 35/50
2025-06-03 15:12:36,943 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,943 - DEBUG - Online update step: 36/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 37/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 38/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 39/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 40/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 41/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 42/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 43/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 44/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 45/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 46/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 47/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 48/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 49/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - DEBUG - Online update step: 50/50
2025-06-03 15:12:36,944 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:36,944 - WARNING - No successful steps during online update.
2025-06-03 15:12:36,954 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:36,954 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0928
2025-06-03 15:12:36,955 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:36,955 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:36,955 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:36,955 - INFO - Running anomaly detection...
2025-06-03 15:12:36,955 - INFO - Starting anomaly detection.
2025-06-03 15:12:36,973 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:36,973 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:36,976 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151236_update_14.json
2025-06-03 15:12:36,976 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:36,983 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151236_update_14.pth and as latest_checkpoint.pth
2025-06-03 15:12:36,983 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956045.dot): 0.4294
2025-06-03 15:12:36,983 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:36,983 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,983 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,983 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,983 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:36,983 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:36,983 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:36,983 - INFO - 
--- Processing file: nw_graph_encoded_1748956060.dot ---
2025-06-03 15:12:36,983 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956060.dot
2025-06-03 15:12:36,983 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956060.dot file.
2025-06-03 15:12:36,996 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:37,016 - INFO - Parsed 2221 edges.
2025-06-03 15:12:37,701 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:37,701 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:37,707 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:37,708 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:37,709 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:37,711 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:37,711 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:37,722 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:37,723 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:37,725 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:37,727 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:37,727 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:37,728 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:37,728 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:37,728 - INFO - Performing online update...
2025-06-03 15:12:37,728 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:37,729 - DEBUG - Updated RunningStats: new_mean=[ 6.28059446e-10 -5.77507490e-10  1.08686705e-09  1.58524129e-09
 -2.46339682e-08  1.09653026e-08 -9.55405235e-09 -1.91946749e-09
 -2.77909378e-09  1.62770007e-09  2.01318304e-09 -1.38196410e-09
  3.70900674e-09 -3.98216350e-09  1.08866554e-09  1.01275330e-09
 -4.62923006e-09  1.69582711e-09 -5.39671295e-09], new_M2=[153280.00456918 153280.00446837 153279.99952822 153280.00201422
 153279.99918302 153279.99845942 153279.99797515 153279.99861289
 153279.99517158 153279.99906399 153280.0010172  153279.99539509
 153279.99419697 137887.996416   137888.00024373 137887.99904776
 137888.00004548 153280.00051231 153280.00624374], new_n=153280
2025-06-03 15:12:37,729 - DEBUG - Updated RunningStats: new_mean=[ 1.41949824e+00  5.50764856e+00  9.72308356e-11  2.56668908e-10
  2.46678544e-10 -8.28457251e-11 -1.57385871e-09  1.19206344e-10
  1.19835056e-10  2.76204794e-10  2.53649418e-10 -3.63723340e-09
 -7.86329783e-10  2.11001788e-09  6.63055806e-10 -1.45959819e-10
 -1.45959819e-10 -1.45959819e-10 -1.45959819e-10 -1.45959819e-10
 -1.45959819e-10 -1.42755519e-10], new_M2=[  84529.51348697 1450970.64149685  330911.99936518  330912.00485853
  330912.00644459  330911.99638245  330912.00047419  330911.9990093
  330912.00173867  330911.99881835  330911.99489884  330912.00720345
  330912.00102009  330911.99917967  330912.00288464  330911.99574155
  330911.99574155  330911.99574155  330911.99574155  330911.99574155
  330911.99574155  330911.99920073], new_n=330912
2025-06-03 15:12:37,729 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.9484632  0.94846321 0.94846321 0.94846321 1.
 1.00000002]
2025-06-03 15:12:37,730 - DEBUG - Calculated standard deviation: [0.50541477 2.09398253 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:37,730 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:37,730 - DEBUG - Online update step: 1/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 2/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 3/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 4/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 5/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 6/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 7/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 8/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 9/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 10/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 11/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 12/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 13/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,730 - DEBUG - Online update step: 14/50
2025-06-03 15:12:37,730 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 15/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 16/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 17/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 18/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 19/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 20/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 21/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 22/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 23/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 24/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 25/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 26/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 27/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 28/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 29/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 30/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 31/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 32/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 33/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,731 - DEBUG - Online update step: 34/50
2025-06-03 15:12:37,731 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 35/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 36/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 37/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 38/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 39/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 40/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 41/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 42/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 43/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 44/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 45/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 46/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 47/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 48/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 49/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - DEBUG - Online update step: 50/50
2025-06-03 15:12:37,732 - WARNING - Not enough data in replay buffer for a full batch. Skipping this step.
2025-06-03 15:12:37,732 - WARNING - No successful steps during online update.
2025-06-03 15:12:37,733 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:37,733 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0921
2025-06-03 15:12:37,733 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:12:37,734 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:12:37,734 - INFO - Online update complete. Loss: 0.0000
2025-06-03 15:12:37,734 - INFO - Running anomaly detection...
2025-06-03 15:12:37,734 - INFO - Starting anomaly detection.
2025-06-03 15:12:37,748 - DEBUG - Node reconstruction errors: [0.00036395 0.00043124 0.00043124 ... 0.00036395 0.0002744  0.00043124]
2025-06-03 15:12:37,748 - DEBUG - Edge reconstruction errors: [0.19999999 0.19999999 0.8        ... 0.19999999 0.17309642 0.19999999]
2025-06-03 15:12:37,750 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151237_update_15.json
2025-06-03 15:12:37,750 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:12:37,757 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151237_update_15.pth and as latest_checkpoint.pth
2025-06-03 15:12:37,757 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956060.dot): 0.4294
2025-06-03 15:12:37,757 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:12:37,757 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:37,757 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:37,757 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:37,757 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9840, MLP Score: 0.0000
2025-06-03 15:12:37,757 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.7063, MLP Score: 0.0000
2025-06-03 15:12:37,757 - INFO - No significant edge anomalies detected (reconstruction-based)
2025-06-03 15:12:37,757 - INFO - 
--- Processing file: nw_graph_encoded_1748956075.dot ---
2025-06-03 15:12:37,757 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot
2025-06-03 15:12:37,757 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956075.dot file.
2025-06-03 15:12:37,770 - INFO - Parsed 1010 nodes.
2025-06-03 15:12:37,789 - INFO - Parsed 2221 edges.
2025-06-03 15:12:38,417 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:12:38,417 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:12:38,423 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:12:38,424 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:12:38,424 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:12:38,425 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:12:38,425 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:12:38,435 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:12:38,437 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:12:38,438 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:12:38,440 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:12:38,440 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:12:38,441 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:12:38,441 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:12:38,441 - INFO - Performing online update...
2025-06-03 15:12:38,441 - INFO - Starting online update for 50 steps.
2025-06-03 15:12:38,442 - DEBUG - Updated RunningStats: new_mean=[ 6.22789150e-10 -5.74113376e-10  9.11994719e-10  1.62904489e-09
 -2.47794460e-08  1.11666476e-08 -9.60904697e-09 -1.94012559e-09
 -2.79547677e-09  1.59002701e-09  1.99341300e-09 -1.39556536e-09
  3.72683556e-09 -3.95609580e-09  1.08153901e-09  1.00612370e-09
 -4.59892659e-09  1.68395340e-09 -5.39248386e-09], new_M2=[154290.0045968  154290.00449727 154289.99956401 154290.00210775
 154289.99916124 154289.9984554  154289.99788987 154289.99860464
 154289.99509101 154289.9990292  154290.00105737 154289.99532622
 154289.99412812 137887.996416   137888.00024373 137887.99904776
 137888.00004548 154290.00050856 154290.0062992 ], new_n=154290
2025-06-03 15:12:38,442 - DEBUG - Updated RunningStats: new_mean=[ 1.41951413e+00  5.50893487e+00  9.83761798e-11  2.60522257e-10
  2.42411618e-10 -8.67732431e-11 -1.56242016e-09  1.28958832e-10
  1.33744018e-10  2.44173133e-10  2.65917006e-10 -3.65672954e-09
 -7.91312399e-10  2.04207265e-09  6.49901605e-10 -1.47328059e-10
 -1.47328059e-10 -1.47328059e-10 -1.47328059e-10 -1.47328059e-10
 -1.47328059e-10 -1.38587025e-10], new_M2=[  85097.22255676 1461202.65535989  333132.99935368  333133.00495111
  333133.00640604  333132.99625833  333133.00046557  333132.99902017
  333133.00173637  333132.99884417  333132.99484522  333133.00728591
  333133.00102586  333132.99920243  333133.00283991  333132.99568313
  333132.99568313  333132.99568313  333132.99568313  333132.99568313
  333132.99568313  333132.99922109], new_n=333133
2025-06-03 15:12:38,442 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         0.99999999
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.94535373 0.94535374 0.94535374 0.94535374 1.
 1.00000002]
2025-06-03 15:12:38,442 - DEBUG - Calculated standard deviation: [0.50541586 2.0943362  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:12:38,443 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:12:38,443 - DEBUG - Online update step: 1/50
2025-06-03 15:12:38,443 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:12:38,444 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:38,444 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:38,444 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:38,445 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:12:38,445 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:12:38,445 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:12:38,445 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:38,446 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:38,446 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:12:38,446 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:38,447 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:12:38,447 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:12:38,447 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:38,448 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:12:38,448 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:12:38,449 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:39,349 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:39,419 - DEBUG - Edge anomaly scores shape: torch.Size([32058, 1])
2025-06-03 15:12:39,421 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:39,422 - DEBUG - Node reconstruction loss: 0.1242
2025-06-03 15:12:40,800 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1204
2025-06-03 15:12:40,812 - DEBUG - Step 1: Loss=0.1025
2025-06-03 15:12:40,812 - DEBUG - Online update step: 2/50
2025-06-03 15:12:40,813 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:40,814 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:40,814 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:12:40,815 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:12:40,816 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:12:40,817 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:12:40,817 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:12:40,818 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:40,818 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:12:40,819 - DEBUG - Applied edge dropout: 264 edges dropped.
2025-06-03 15:12:40,820 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:40,820 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:40,821 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:12:40,822 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:12:40,823 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:40,824 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:40,828 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:41,455 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:41,502 - DEBUG - Edge anomaly scores shape: torch.Size([31937, 1])
2025-06-03 15:12:41,503 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:41,504 - DEBUG - Node reconstruction loss: 0.1888
2025-06-03 15:12:42,330 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.8655
2025-06-03 15:12:42,332 - DEBUG - Step 2: Loss=0.1532
2025-06-03 15:12:42,332 - DEBUG - Online update step: 3/50
2025-06-03 15:12:42,333 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:42,333 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:42,334 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:12:42,334 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:42,334 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:12:42,335 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:12:42,335 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:42,335 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:12:42,335 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:42,336 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:12:42,336 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:42,337 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:12:42,337 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:42,337 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:12:42,338 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:12:42,338 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:42,339 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:43,053 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:43,106 - DEBUG - Edge anomaly scores shape: torch.Size([32034, 1])
2025-06-03 15:12:43,107 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:43,107 - DEBUG - Node reconstruction loss: 0.1346
2025-06-03 15:12:43,906 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5754
2025-06-03 15:12:44,072 - DEBUG - Step 3: Loss=0.1091
2025-06-03 15:12:44,073 - DEBUG - Online update step: 4/50
2025-06-03 15:12:44,086 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:12:44,086 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:44,087 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:44,088 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:44,088 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:12:44,089 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:44,090 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:44,090 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:12:44,091 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:12:44,092 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:12:44,092 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:12:44,093 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:12:44,094 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:12:44,095 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:12:44,096 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:12:44,096 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:44,099 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:44,716 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:44,784 - DEBUG - Edge anomaly scores shape: torch.Size([31971, 1])
2025-06-03 15:12:44,789 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:44,790 - DEBUG - Node reconstruction loss: 0.1239
2025-06-03 15:12:45,726 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.5724
2025-06-03 15:12:45,728 - DEBUG - Step 4: Loss=0.1004
2025-06-03 15:12:45,729 - DEBUG - Online update step: 5/50
2025-06-03 15:12:45,729 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:45,729 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:45,730 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:12:45,730 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:45,730 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:12:45,731 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:12:45,731 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:12:45,731 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:45,731 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:45,732 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:45,733 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:12:45,733 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:12:45,733 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:12:45,734 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:45,734 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:12:45,734 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:45,735 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:46,314 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:46,361 - DEBUG - Edge anomaly scores shape: torch.Size([31981, 1])
2025-06-03 15:12:46,362 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:46,362 - DEBUG - Node reconstruction loss: 0.1292
2025-06-03 15:12:47,442 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.4635
2025-06-03 15:12:47,444 - DEBUG - Step 5: Loss=0.1047
2025-06-03 15:12:47,444 - DEBUG - Online update step: 6/50
2025-06-03 15:12:47,444 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:12:47,445 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:12:47,445 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:47,446 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:12:47,446 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:12:47,446 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:47,446 - DEBUG - Applied edge dropout: 252 edges dropped.
2025-06-03 15:12:47,447 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:47,447 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:12:47,447 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:12:47,448 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:12:47,448 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:12:47,448 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:12:47,449 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:12:47,449 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:12:47,449 - DEBUG - Applied edge dropout: 288 edges dropped.
2025-06-03 15:12:47,450 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:48,061 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:48,110 - DEBUG - Edge anomaly scores shape: torch.Size([31944, 1])
2025-06-03 15:12:48,111 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:48,111 - DEBUG - Node reconstruction loss: 0.1157
2025-06-03 15:12:49,023 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.4832
2025-06-03 15:12:49,025 - DEBUG - Step 6: Loss=0.0937
2025-06-03 15:12:49,025 - DEBUG - Online update step: 7/50
2025-06-03 15:12:49,026 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:12:49,026 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:12:49,027 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:12:49,028 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:49,029 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:49,029 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:12:49,029 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:49,029 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-03 15:12:49,030 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:49,030 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:12:49,030 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:49,031 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:49,031 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:49,031 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:12:49,031 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:49,032 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:49,033 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:49,623 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:49,676 - DEBUG - Edge anomaly scores shape: torch.Size([32102, 1])
2025-06-03 15:12:49,677 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:49,677 - DEBUG - Node reconstruction loss: 0.1039
2025-06-03 15:12:50,657 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.4710
2025-06-03 15:12:50,711 - DEBUG - Step 7: Loss=0.0841
2025-06-03 15:12:50,711 - DEBUG - Online update step: 8/50
2025-06-03 15:12:50,712 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:12:50,712 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:50,713 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:12:50,713 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:50,713 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:50,714 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:12:50,714 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:12:50,719 - DEBUG - Applied edge dropout: 252 edges dropped.
2025-06-03 15:12:50,719 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:12:50,720 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:12:50,720 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:50,720 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:12:50,721 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:12:50,721 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:12:50,721 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:50,721 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:50,725 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:51,303 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:51,347 - DEBUG - Edge anomaly scores shape: torch.Size([32013, 1])
2025-06-03 15:12:51,348 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:51,349 - DEBUG - Node reconstruction loss: 0.1074
2025-06-03 15:12:52,295 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.3031
2025-06-03 15:12:52,315 - DEBUG - Step 8: Loss=0.0870
2025-06-03 15:12:52,315 - DEBUG - Online update step: 9/50
2025-06-03 15:12:52,316 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:12:52,317 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:12:52,317 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:12:52,318 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:52,319 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:12:52,319 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:12:52,319 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:12:52,320 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:12:52,320 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:12:52,320 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:12:52,321 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:12:52,321 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:12:52,321 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:12:52,322 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:12:52,322 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:12:52,322 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:12:52,324 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:53,026 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:53,075 - DEBUG - Edge anomaly scores shape: torch.Size([31838, 1])
2025-06-03 15:12:53,076 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:53,076 - DEBUG - Node reconstruction loss: 0.0989
2025-06-03 15:12:54,052 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.2528
2025-06-03 15:12:54,055 - DEBUG - Step 9: Loss=0.0801
2025-06-03 15:12:54,055 - DEBUG - Online update step: 10/50
2025-06-03 15:12:54,056 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:54,056 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:12:54,056 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:12:54,057 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:54,057 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:54,058 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:12:54,059 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:12:54,059 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:12:54,060 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:12:54,061 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:12:54,061 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:54,062 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:12:54,062 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:12:54,063 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:12:54,064 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:54,064 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:12:54,066 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:54,647 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:54,708 - DEBUG - Edge anomaly scores shape: torch.Size([32003, 1])
2025-06-03 15:12:54,709 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:54,710 - DEBUG - Node reconstruction loss: 0.1051
2025-06-03 15:12:55,902 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.3226
2025-06-03 15:12:55,905 - DEBUG - Step 10: Loss=0.0851
2025-06-03 15:12:55,905 - DEBUG - Online update step: 11/50
2025-06-03 15:12:55,906 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:55,906 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:12:55,907 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:12:55,907 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:55,907 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:12:55,908 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:12:55,908 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:12:55,908 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:12:55,909 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:12:55,909 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:12:55,909 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:55,909 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:12:55,910 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:12:55,910 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:12:55,910 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:12:55,911 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:12:55,912 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:56,551 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:56,596 - DEBUG - Edge anomaly scores shape: torch.Size([31978, 1])
2025-06-03 15:12:56,596 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:56,597 - DEBUG - Node reconstruction loss: 0.1149
2025-06-03 15:12:57,531 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.3212
2025-06-03 15:12:57,533 - DEBUG - Step 11: Loss=0.0931
2025-06-03 15:12:57,533 - DEBUG - Online update step: 12/50
2025-06-03 15:12:57,534 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:12:57,534 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:57,534 - DEBUG - Applied edge dropout: 256 edges dropped.
2025-06-03 15:12:57,535 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:12:57,535 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:12:57,535 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:12:57,536 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:12:57,536 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:57,536 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:12:57,536 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:12:57,537 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:12:57,537 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:12:57,537 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:12:57,537 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:12:57,538 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:12:57,538 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:12:57,539 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:12:58,212 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:12:58,264 - DEBUG - Edge anomaly scores shape: torch.Size([32012, 1])
2025-06-03 15:12:58,265 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:12:58,266 - DEBUG - Node reconstruction loss: 0.0970
2025-06-03 15:12:59,396 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.2461
2025-06-03 15:12:59,558 - DEBUG - Step 12: Loss=0.0786
2025-06-03 15:12:59,561 - DEBUG - Online update step: 13/50
2025-06-03 15:12:59,608 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:12:59,652 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:12:59,692 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:12:59,755 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:12:59,793 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:12:59,836 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-03 15:12:59,918 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:12:59,985 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:00,062 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:00,116 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:00,160 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:00,204 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:00,246 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:00,303 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:00,357 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:00,413 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:00,550 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:01,351 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:01,402 - DEBUG - Edge anomaly scores shape: torch.Size([32013, 1])
2025-06-03 15:13:01,403 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:01,404 - DEBUG - Node reconstruction loss: 0.1124
2025-06-03 15:13:02,319 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1970
2025-06-03 15:13:02,322 - DEBUG - Step 13: Loss=0.0910
2025-06-03 15:13:02,322 - DEBUG - Online update step: 14/50
2025-06-03 15:13:02,323 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:02,323 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:02,325 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:02,325 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:02,325 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:02,326 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:02,326 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:02,326 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:02,327 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:02,327 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:02,327 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:02,328 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:02,328 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:02,328 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:02,328 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:02,329 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:02,330 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:03,104 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:03,153 - DEBUG - Edge anomaly scores shape: torch.Size([31981, 1])
2025-06-03 15:13:03,154 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:03,154 - DEBUG - Node reconstruction loss: 0.0780
2025-06-03 15:13:04,112 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1985
2025-06-03 15:13:04,115 - DEBUG - Step 14: Loss=0.0632
2025-06-03 15:13:04,115 - DEBUG - Online update step: 15/50
2025-06-03 15:13:04,116 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:04,116 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:13:04,117 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:04,117 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:04,117 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:04,118 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:13:04,118 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:04,118 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:04,119 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:04,119 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:04,119 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:04,119 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:04,120 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:04,120 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:04,120 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:04,120 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:04,122 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:04,705 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:04,756 - DEBUG - Edge anomaly scores shape: torch.Size([31995, 1])
2025-06-03 15:13:04,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:04,758 - DEBUG - Node reconstruction loss: 0.1003
2025-06-03 15:13:05,726 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1730
2025-06-03 15:13:05,729 - DEBUG - Step 15: Loss=0.0812
2025-06-03 15:13:05,729 - DEBUG - Online update step: 16/50
2025-06-03 15:13:05,730 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:05,730 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:05,730 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:05,731 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:05,731 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:05,731 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:05,732 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:05,732 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:05,732 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:05,733 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:05,733 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:05,733 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:05,734 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:05,734 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:13:05,734 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:05,735 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:05,736 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:06,434 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:06,483 - DEBUG - Edge anomaly scores shape: torch.Size([32052, 1])
2025-06-03 15:13:06,484 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:06,484 - DEBUG - Node reconstruction loss: 0.0845
2025-06-03 15:13:07,427 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1759
2025-06-03 15:13:07,429 - DEBUG - Step 16: Loss=0.0685
2025-06-03 15:13:07,429 - DEBUG - Online update step: 17/50
2025-06-03 15:13:07,430 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:07,430 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:07,430 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:07,430 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:07,431 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:07,431 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:07,431 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:07,432 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:07,432 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:07,432 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:07,432 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:07,433 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:07,433 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:07,433 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:07,433 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:07,434 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:07,435 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:08,068 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:08,150 - DEBUG - Edge anomaly scores shape: torch.Size([31897, 1])
2025-06-03 15:13:08,152 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:08,152 - DEBUG - Node reconstruction loss: 0.0960
2025-06-03 15:13:09,286 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1384
2025-06-03 15:13:09,289 - DEBUG - Step 17: Loss=0.0777
2025-06-03 15:13:09,289 - DEBUG - Online update step: 18/50
2025-06-03 15:13:09,289 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:13:09,290 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:09,290 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:13:09,290 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:09,291 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:09,291 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:09,291 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:09,291 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:09,292 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:13:09,292 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:09,292 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:09,293 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:09,293 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:09,293 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:09,294 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:09,294 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:13:09,295 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:09,919 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:09,971 - DEBUG - Edge anomaly scores shape: torch.Size([31945, 1])
2025-06-03 15:13:09,972 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:09,973 - DEBUG - Node reconstruction loss: 0.1047
2025-06-03 15:13:11,185 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1321
2025-06-03 15:13:11,187 - DEBUG - Step 18: Loss=0.0848
2025-06-03 15:13:11,188 - DEBUG - Online update step: 19/50
2025-06-03 15:13:11,188 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:11,188 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:11,189 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:11,189 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:11,189 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:11,190 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:11,190 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:11,190 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:11,191 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:11,191 - DEBUG - Applied edge dropout: 169 edges dropped.
2025-06-03 15:13:11,191 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:11,191 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:13:11,192 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:11,192 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:11,192 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:13:11,193 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:11,194 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:11,797 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:11,847 - DEBUG - Edge anomaly scores shape: torch.Size([31982, 1])
2025-06-03 15:13:11,848 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:11,849 - DEBUG - Node reconstruction loss: 0.0799
2025-06-03 15:13:13,018 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1335
2025-06-03 15:13:13,021 - DEBUG - Step 19: Loss=0.0647
2025-06-03 15:13:13,021 - DEBUG - Online update step: 20/50
2025-06-03 15:13:13,021 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:13:13,022 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:13,022 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-03 15:13:13,022 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:13,023 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:13,023 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:13,023 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:13,023 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:13:13,024 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:13,024 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:13,024 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:13,025 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:13,025 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:13,025 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:13,026 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:13,026 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:13,027 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:13,694 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:13,786 - DEBUG - Edge anomaly scores shape: torch.Size([32035, 1])
2025-06-03 15:13:13,788 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:13,795 - DEBUG - Node reconstruction loss: 0.0936
2025-06-03 15:13:14,913 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1379
2025-06-03 15:13:14,915 - DEBUG - Step 20: Loss=0.0758
2025-06-03 15:13:14,916 - DEBUG - Online update step: 21/50
2025-06-03 15:13:14,916 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:13:14,917 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:14,917 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:13:14,917 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:14,918 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:14,918 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:14,918 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:13:14,919 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:14,919 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:13:14,919 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:13:14,920 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:14,920 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:14,920 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:14,921 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:14,921 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:13:14,921 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:13:14,923 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:16,015 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:16,064 - DEBUG - Edge anomaly scores shape: torch.Size([31998, 1])
2025-06-03 15:13:16,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:16,066 - DEBUG - Node reconstruction loss: 0.0819
2025-06-03 15:13:17,238 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1179
2025-06-03 15:13:17,241 - DEBUG - Step 21: Loss=0.0663
2025-06-03 15:13:17,241 - DEBUG - Online update step: 22/50
2025-06-03 15:13:17,242 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:17,242 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:17,243 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:17,243 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:17,243 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:13:17,244 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:17,244 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:17,245 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:17,246 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:17,246 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:17,247 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:17,247 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:17,248 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:17,249 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:17,249 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:17,250 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:17,252 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:17,846 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:17,895 - DEBUG - Edge anomaly scores shape: torch.Size([32004, 1])
2025-06-03 15:13:17,896 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:17,896 - DEBUG - Node reconstruction loss: 0.1011
2025-06-03 15:13:19,022 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0956
2025-06-03 15:13:19,025 - DEBUG - Step 22: Loss=0.0819
2025-06-03 15:13:19,025 - DEBUG - Online update step: 23/50
2025-06-03 15:13:19,026 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:19,026 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:19,027 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:19,027 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:13:19,028 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:19,028 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:19,028 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:19,028 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:19,029 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:19,029 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:13:19,029 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:19,029 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:19,030 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:13:19,030 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:19,030 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:19,031 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:19,032 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:19,654 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:19,703 - DEBUG - Edge anomaly scores shape: torch.Size([32025, 1])
2025-06-03 15:13:19,704 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:19,705 - DEBUG - Node reconstruction loss: 0.0878
2025-06-03 15:13:20,688 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0873
2025-06-03 15:13:20,699 - DEBUG - Step 23: Loss=0.0711
2025-06-03 15:13:20,700 - DEBUG - Online update step: 24/50
2025-06-03 15:13:20,701 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:20,705 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:20,706 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:20,707 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:13:20,712 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:20,713 - DEBUG - Applied edge dropout: 186 edges dropped.
2025-06-03 15:13:20,716 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:20,717 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:20,718 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:20,718 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:20,719 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:20,720 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:20,725 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:20,727 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:20,730 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:20,733 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:20,735 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:21,373 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:21,427 - DEBUG - Edge anomaly scores shape: torch.Size([31977, 1])
2025-06-03 15:13:21,428 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:21,429 - DEBUG - Node reconstruction loss: 0.1037
2025-06-03 15:13:22,318 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1251
2025-06-03 15:13:22,320 - DEBUG - Step 24: Loss=0.0840
2025-06-03 15:13:22,321 - DEBUG - Online update step: 25/50
2025-06-03 15:13:22,321 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:22,321 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:22,322 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:22,322 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:22,322 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:22,323 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:22,323 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:22,323 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:22,324 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:22,324 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:22,324 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:22,324 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:22,325 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:22,325 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:13:22,325 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:22,326 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:22,327 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:22,932 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:22,982 - DEBUG - Edge anomaly scores shape: torch.Size([32058, 1])
2025-06-03 15:13:22,983 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:22,984 - DEBUG - Node reconstruction loss: 0.0747
2025-06-03 15:13:24,084 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.1112
2025-06-03 15:13:24,086 - DEBUG - Step 25: Loss=0.0605
2025-06-03 15:13:24,086 - DEBUG - Online update step: 26/50
2025-06-03 15:13:24,087 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:13:24,087 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:24,088 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:24,088 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:13:24,088 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:24,089 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:24,089 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:24,089 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:24,090 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:24,090 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:24,091 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:24,092 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:24,092 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:24,093 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:13:24,093 - DEBUG - Applied edge dropout: 180 edges dropped.
2025-06-03 15:13:24,093 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:24,095 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:24,751 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:24,800 - DEBUG - Edge anomaly scores shape: torch.Size([32060, 1])
2025-06-03 15:13:24,801 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:24,802 - DEBUG - Node reconstruction loss: 0.0769
2025-06-03 15:13:26,033 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0739
2025-06-03 15:13:26,059 - DEBUG - Step 26: Loss=0.0623
2025-06-03 15:13:26,059 - DEBUG - Online update step: 27/50
2025-06-03 15:13:26,065 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:13:26,066 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:26,071 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:26,072 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:26,076 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:26,079 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:26,083 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:26,084 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:26,085 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:26,089 - DEBUG - Applied edge dropout: 256 edges dropped.
2025-06-03 15:13:26,090 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:26,091 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:26,092 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:26,096 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:13:26,097 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:26,102 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:26,128 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:26,693 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:26,749 - DEBUG - Edge anomaly scores shape: torch.Size([31994, 1])
2025-06-03 15:13:26,750 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:26,750 - DEBUG - Node reconstruction loss: 0.0878
2025-06-03 15:13:27,808 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0684
2025-06-03 15:13:27,810 - DEBUG - Step 27: Loss=0.0711
2025-06-03 15:13:27,811 - DEBUG - Online update step: 28/50
2025-06-03 15:13:27,811 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:27,812 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:13:27,812 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:27,812 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:13:27,813 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:27,813 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:27,813 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:13:27,814 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:27,814 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:27,814 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:27,815 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:27,815 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:27,815 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:27,816 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:27,816 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:27,816 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:27,818 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:28,404 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:28,457 - DEBUG - Edge anomaly scores shape: torch.Size([31949, 1])
2025-06-03 15:13:28,458 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:28,458 - DEBUG - Node reconstruction loss: 0.0986
2025-06-03 15:13:29,404 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0920
2025-06-03 15:13:29,406 - DEBUG - Step 28: Loss=0.0799
2025-06-03 15:13:29,406 - DEBUG - Online update step: 29/50
2025-06-03 15:13:29,407 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:29,407 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:29,408 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:29,408 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:29,408 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:29,409 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:29,409 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:29,409 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:29,410 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:29,410 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:29,410 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:29,411 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:29,411 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:13:29,411 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:29,411 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:29,412 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:29,413 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:29,980 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:30,033 - DEBUG - Edge anomaly scores shape: torch.Size([32011, 1])
2025-06-03 15:13:30,035 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:30,038 - DEBUG - Node reconstruction loss: 0.0973
2025-06-03 15:13:31,047 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0942
2025-06-03 15:13:31,050 - DEBUG - Step 29: Loss=0.0788
2025-06-03 15:13:31,050 - DEBUG - Online update step: 30/50
2025-06-03 15:13:31,051 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:31,051 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:31,052 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:31,052 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:31,053 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:31,053 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:31,054 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:31,055 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:31,055 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:13:31,055 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:31,056 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:13:31,057 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:31,058 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:31,058 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:31,058 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:31,059 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:31,060 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:31,714 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:31,774 - DEBUG - Edge anomaly scores shape: torch.Size([31996, 1])
2025-06-03 15:13:31,776 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:31,778 - DEBUG - Node reconstruction loss: 0.0996
2025-06-03 15:13:33,020 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0614
2025-06-03 15:13:33,023 - DEBUG - Step 30: Loss=0.0807
2025-06-03 15:13:33,023 - DEBUG - Online update step: 31/50
2025-06-03 15:13:33,024 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:33,024 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:13:33,025 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:33,025 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:33,025 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:33,026 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:33,026 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:33,029 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:13:33,029 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:33,030 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:33,033 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:13:33,033 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:33,033 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:13:33,034 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:33,034 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:33,034 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:13:33,036 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:33,626 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:33,681 - DEBUG - Edge anomaly scores shape: torch.Size([31935, 1])
2025-06-03 15:13:33,682 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:33,684 - DEBUG - Node reconstruction loss: 0.0799
2025-06-03 15:13:34,760 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0787
2025-06-03 15:13:34,763 - DEBUG - Step 31: Loss=0.0647
2025-06-03 15:13:34,763 - DEBUG - Online update step: 32/50
2025-06-03 15:13:34,764 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:13:34,764 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:34,765 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:34,765 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:34,766 - DEBUG - Applied edge dropout: 252 edges dropped.
2025-06-03 15:13:34,766 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:34,766 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:34,767 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:34,767 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:13:34,767 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:34,768 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:34,768 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:34,769 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:34,769 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:34,769 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:34,770 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:34,771 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:35,368 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:35,421 - DEBUG - Edge anomaly scores shape: torch.Size([31949, 1])
2025-06-03 15:13:35,422 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:35,422 - DEBUG - Node reconstruction loss: 0.0850
2025-06-03 15:13:36,432 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0855
2025-06-03 15:13:36,434 - DEBUG - Step 32: Loss=0.0689
2025-06-03 15:13:36,434 - DEBUG - Online update step: 33/50
2025-06-03 15:13:36,435 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:13:36,435 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:36,436 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:36,436 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:36,436 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:13:36,437 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:36,437 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:13:36,437 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:36,438 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:36,438 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:36,438 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:36,439 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:13:36,439 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:36,439 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:36,439 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:36,440 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:36,441 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:37,029 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:37,084 - DEBUG - Edge anomaly scores shape: torch.Size([32024, 1])
2025-06-03 15:13:37,085 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:37,086 - DEBUG - Node reconstruction loss: 0.1011
2025-06-03 15:13:38,130 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0787
2025-06-03 15:13:38,133 - DEBUG - Step 33: Loss=0.0819
2025-06-03 15:13:38,133 - DEBUG - Online update step: 34/50
2025-06-03 15:13:38,133 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:38,134 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:38,134 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:38,134 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:38,135 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:38,135 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:13:38,135 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:38,136 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:38,136 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:38,136 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:38,136 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:38,137 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:38,137 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:38,137 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:38,138 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:38,138 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:38,139 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:38,715 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:38,773 - DEBUG - Edge anomaly scores shape: torch.Size([32018, 1])
2025-06-03 15:13:38,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:38,775 - DEBUG - Node reconstruction loss: 0.0861
2025-06-03 15:13:39,847 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0462
2025-06-03 15:13:39,885 - DEBUG - Step 34: Loss=0.0698
2025-06-03 15:13:39,885 - DEBUG - Online update step: 35/50
2025-06-03 15:13:39,886 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:39,886 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:39,886 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:39,887 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:39,887 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:39,888 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:39,888 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:39,888 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:13:39,888 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:39,889 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:39,889 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:39,889 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:39,890 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:13:39,895 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:39,895 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:39,897 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:39,899 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:40,589 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:40,634 - DEBUG - Edge anomaly scores shape: torch.Size([31984, 1])
2025-06-03 15:13:40,635 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:40,636 - DEBUG - Node reconstruction loss: 0.0875
2025-06-03 15:13:41,707 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0584
2025-06-03 15:13:41,714 - DEBUG - Step 35: Loss=0.0709
2025-06-03 15:13:41,714 - DEBUG - Online update step: 36/50
2025-06-03 15:13:41,715 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:13:41,716 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:41,717 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:41,718 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:41,718 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:41,719 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:13:41,719 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:41,720 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:41,721 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:41,722 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:41,723 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:41,723 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:41,724 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:41,725 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:41,725 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:13:41,726 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:41,728 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:42,425 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:42,508 - DEBUG - Edge anomaly scores shape: torch.Size([31939, 1])
2025-06-03 15:13:42,510 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:42,510 - DEBUG - Node reconstruction loss: 0.0888
2025-06-03 15:13:43,661 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0690
2025-06-03 15:13:43,667 - DEBUG - Step 36: Loss=0.0719
2025-06-03 15:13:43,667 - DEBUG - Online update step: 37/50
2025-06-03 15:13:43,667 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:43,668 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:43,668 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:13:43,669 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:43,670 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:43,670 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:43,671 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:43,671 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:43,671 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:13:43,672 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:43,674 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:13:43,674 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:13:43,675 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:13:43,675 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:43,676 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:43,677 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:43,678 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:44,396 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:44,452 - DEBUG - Edge anomaly scores shape: torch.Size([31982, 1])
2025-06-03 15:13:44,453 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:44,453 - DEBUG - Node reconstruction loss: 0.0979
2025-06-03 15:13:45,703 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0678
2025-06-03 15:13:45,710 - DEBUG - Step 37: Loss=0.0793
2025-06-03 15:13:45,710 - DEBUG - Online update step: 38/50
2025-06-03 15:13:45,711 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:45,711 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:45,712 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:45,714 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:45,714 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:45,714 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:45,715 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:45,715 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:45,715 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:45,716 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:13:45,716 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:45,716 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:13:45,717 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:45,719 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:45,720 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:45,720 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:13:45,722 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:46,317 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:46,370 - DEBUG - Edge anomaly scores shape: torch.Size([31963, 1])
2025-06-03 15:13:46,371 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:46,371 - DEBUG - Node reconstruction loss: 0.0963
2025-06-03 15:13:47,429 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0516
2025-06-03 15:13:47,432 - DEBUG - Step 38: Loss=0.0780
2025-06-03 15:13:47,432 - DEBUG - Online update step: 39/50
2025-06-03 15:13:47,432 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:47,433 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:47,433 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:47,433 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:47,434 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:13:47,434 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:47,434 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:47,435 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:47,435 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:47,435 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:47,436 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:13:47,436 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:47,436 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:47,437 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:47,437 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:47,437 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:13:47,438 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:48,155 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:48,210 - DEBUG - Edge anomaly scores shape: torch.Size([31996, 1])
2025-06-03 15:13:48,212 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:48,212 - DEBUG - Node reconstruction loss: 0.1008
2025-06-03 15:13:49,413 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0594
2025-06-03 15:13:49,416 - DEBUG - Step 39: Loss=0.0817
2025-06-03 15:13:49,416 - DEBUG - Online update step: 40/50
2025-06-03 15:13:49,416 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:49,417 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:49,417 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:49,417 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:49,418 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:13:49,418 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:13:49,418 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:49,419 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:49,419 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:49,419 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:49,419 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-03 15:13:49,420 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:49,420 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:13:49,420 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:13:49,421 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:49,421 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:49,422 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:50,230 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:50,307 - DEBUG - Edge anomaly scores shape: torch.Size([32082, 1])
2025-06-03 15:13:50,308 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:50,311 - DEBUG - Node reconstruction loss: 0.0935
2025-06-03 15:13:51,742 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0518
2025-06-03 15:13:51,745 - DEBUG - Step 40: Loss=0.0757
2025-06-03 15:13:51,745 - DEBUG - Online update step: 41/50
2025-06-03 15:13:51,747 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:13:51,747 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:51,748 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:13:51,748 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:51,748 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:51,749 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:51,749 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:13:51,749 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:13:51,750 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:51,750 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:13:51,750 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:51,751 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:13:51,751 - DEBUG - Applied edge dropout: 186 edges dropped.
2025-06-03 15:13:51,751 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:51,752 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:51,752 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:13:51,753 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:53,611 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:53,708 - DEBUG - Edge anomaly scores shape: torch.Size([32088, 1])
2025-06-03 15:13:53,710 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:53,723 - DEBUG - Node reconstruction loss: 0.0740
2025-06-03 15:13:54,978 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0603
2025-06-03 15:13:54,981 - DEBUG - Step 41: Loss=0.0599
2025-06-03 15:13:54,981 - DEBUG - Online update step: 42/50
2025-06-03 15:13:54,985 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:54,986 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:13:54,987 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:13:54,987 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:13:54,988 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:54,989 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:13:54,989 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:54,989 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:54,990 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:54,990 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:13:54,991 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:54,996 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:55,003 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:55,008 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:55,008 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:55,009 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:55,014 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:55,718 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:55,773 - DEBUG - Edge anomaly scores shape: torch.Size([32037, 1])
2025-06-03 15:13:55,774 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:55,775 - DEBUG - Node reconstruction loss: 0.0829
2025-06-03 15:13:56,911 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0532
2025-06-03 15:13:56,913 - DEBUG - Step 42: Loss=0.0672
2025-06-03 15:13:56,913 - DEBUG - Online update step: 43/50
2025-06-03 15:13:56,914 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:13:56,914 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:56,914 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:56,915 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:13:56,915 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:13:56,915 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:13:56,916 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:56,916 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:13:56,917 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:13:56,917 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:13:56,917 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:13:56,917 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:13:56,918 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:13:56,918 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:13:56,918 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:13:56,918 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:13:56,920 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:57,814 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:57,869 - DEBUG - Edge anomaly scores shape: torch.Size([32030, 1])
2025-06-03 15:13:57,870 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:57,870 - DEBUG - Node reconstruction loss: 0.0810
2025-06-03 15:13:59,258 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0513
2025-06-03 15:13:59,261 - DEBUG - Step 43: Loss=0.0656
2025-06-03 15:13:59,261 - DEBUG - Online update step: 44/50
2025-06-03 15:13:59,262 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:13:59,262 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:13:59,263 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:13:59,263 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:13:59,263 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:13:59,264 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:13:59,264 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:13:59,264 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:13:59,265 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:13:59,266 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:13:59,266 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:59,266 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:13:59,267 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:13:59,267 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:13:59,267 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:13:59,268 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:13:59,269 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:13:59,865 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:13:59,916 - DEBUG - Edge anomaly scores shape: torch.Size([31972, 1])
2025-06-03 15:13:59,917 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:13:59,917 - DEBUG - Node reconstruction loss: 0.0927
2025-06-03 15:14:00,957 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0592
2025-06-03 15:14:00,959 - DEBUG - Step 44: Loss=0.0751
2025-06-03 15:14:00,959 - DEBUG - Online update step: 45/50
2025-06-03 15:14:00,960 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:00,960 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:00,960 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:00,961 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:00,961 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:00,961 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:14:00,961 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:00,962 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:00,962 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:00,962 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-03 15:14:00,963 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:00,963 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:00,963 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:00,963 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:00,964 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:14:00,964 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:00,965 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:01,531 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:01,582 - DEBUG - Edge anomaly scores shape: torch.Size([31945, 1])
2025-06-03 15:14:01,583 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:01,584 - DEBUG - Node reconstruction loss: 0.0916
2025-06-03 15:14:02,666 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0560
2025-06-03 15:14:02,668 - DEBUG - Step 45: Loss=0.0742
2025-06-03 15:14:02,668 - DEBUG - Online update step: 46/50
2025-06-03 15:14:02,669 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:14:02,669 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:02,669 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:02,670 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:02,670 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:02,670 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:02,671 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:02,671 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:02,671 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:14:02,671 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:02,672 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:02,672 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:02,672 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:02,673 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:02,673 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:02,673 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:02,674 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:03,269 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:03,321 - DEBUG - Edge anomaly scores shape: torch.Size([31998, 1])
2025-06-03 15:14:03,322 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:03,323 - DEBUG - Node reconstruction loss: 0.0952
2025-06-03 15:14:04,447 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0683
2025-06-03 15:14:04,449 - DEBUG - Step 46: Loss=0.0771
2025-06-03 15:14:04,449 - DEBUG - Online update step: 47/50
2025-06-03 15:14:04,449 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:04,450 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:04,450 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:04,450 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:04,450 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-03 15:14:04,451 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:04,451 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:04,451 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:04,452 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:04,452 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:04,452 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:04,452 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:04,453 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:04,453 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:04,453 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:04,454 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:04,455 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:05,049 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:05,184 - DEBUG - Edge anomaly scores shape: torch.Size([31969, 1])
2025-06-03 15:14:05,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:05,186 - DEBUG - Node reconstruction loss: 0.0823
2025-06-03 15:14:06,316 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0504
2025-06-03 15:14:06,325 - DEBUG - Step 47: Loss=0.0667
2025-06-03 15:14:06,325 - DEBUG - Online update step: 48/50
2025-06-03 15:14:06,329 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:06,334 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:06,334 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:06,335 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:06,335 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:06,338 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:06,338 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:06,339 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:14:06,339 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:06,340 - DEBUG - Applied edge dropout: 185 edges dropped.
2025-06-03 15:14:06,340 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:06,340 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:06,340 - DEBUG - Applied edge dropout: 266 edges dropped.
2025-06-03 15:14:06,344 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:06,345 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:06,345 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:06,347 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:06,981 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:07,032 - DEBUG - Edge anomaly scores shape: torch.Size([32048, 1])
2025-06-03 15:14:07,033 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:07,034 - DEBUG - Node reconstruction loss: 0.0770
2025-06-03 15:14:08,024 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0539
2025-06-03 15:14:08,027 - DEBUG - Step 48: Loss=0.0623
2025-06-03 15:14:08,027 - DEBUG - Online update step: 49/50
2025-06-03 15:14:08,028 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:08,028 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:14:08,028 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:08,029 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:08,029 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:08,029 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:08,030 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:14:08,030 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:08,030 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:08,030 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:08,031 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:08,031 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:08,031 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:08,032 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:08,032 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:08,032 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:08,034 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:08,611 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:08,673 - DEBUG - Edge anomaly scores shape: torch.Size([31995, 1])
2025-06-03 15:14:08,674 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:08,675 - DEBUG - Node reconstruction loss: 0.0937
2025-06-03 15:14:09,952 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0776
2025-06-03 15:14:09,959 - DEBUG - Step 49: Loss=0.0759
2025-06-03 15:14:09,959 - DEBUG - Online update step: 50/50
2025-06-03 15:14:09,963 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:09,964 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:09,964 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:09,965 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:09,965 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:09,965 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:09,966 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:09,966 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:09,966 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:09,967 - DEBUG - Applied edge dropout: 188 edges dropped.
2025-06-03 15:14:09,967 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:09,967 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:14:09,968 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:09,968 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:09,968 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:09,969 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:09,970 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:10,730 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:10,781 - DEBUG - Edge anomaly scores shape: torch.Size([31990, 1])
2025-06-03 15:14:10,783 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:10,783 - DEBUG - Node reconstruction loss: 0.0968
2025-06-03 15:14:11,786 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0539
2025-06-03 15:14:11,788 - DEBUG - Step 50: Loss=0.0784
2025-06-03 15:14:11,789 - INFO - Online update finished. Average loss: 0.0792, Learning rate: 0.002927
2025-06-03 15:14:11,789 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:14:11,790 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0915
2025-06-03 15:14:11,790 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:14:11,790 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:14:11,800 - INFO - Online update complete. Loss: 0.0792
2025-06-03 15:14:11,800 - INFO - Running anomaly detection...
2025-06-03 15:14:11,800 - INFO - Starting anomaly detection.
2025-06-03 15:14:11,815 - DEBUG - Node reconstruction errors: [0.00010291 0.00020109 0.00020109 ... 0.00010291 0.00033556 0.00020109]
2025-06-03 15:14:11,815 - DEBUG - Edge reconstruction errors: [0.79999995 0.79999995 0.8        ... 0.19999999 0.8        0.19999999]
2025-06-03 15:14:11,818 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151411_update_16.json
2025-06-03 15:14:11,818 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:14:11,835 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151411_update_16.pth and as latest_checkpoint.pth
2025-06-03 15:14:11,835 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956075.dot): 0.9813
2025-06-03 15:14:11,835 - WARNING - Detected 12 anomalous nodes (reconstruction-based):
2025-06-03 15:14:11,835 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.9741, MLP Score: 0.0000
2025-06-03 15:14:11,835 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.9741, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.9741, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.9302, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Node ID: fe80::1cee:30ff:fe26:4f78, Recon Error: 0.9741, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING - Detected 42 anomalous edges (reconstruction-based):
2025-06-03 15:14:11,836 - WARNING -   Source: fe80::20c:29ff:fe89:3ead, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Source: fe80::20c:29ff:fe02:9537, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Source: 192.168.209.1, Target: 192.168.239.101, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Source: fe80::1cee:30ff:fe26:4f78, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:14:11,836 - WARNING -   Source: 192.168.239.101, Target: 8.8.8.8, Recon Error: 0.7981, MLP Score: 0.0000
2025-06-03 15:14:11,847 - INFO - Starting 3D embedding visualization...
2025-06-03 15:14:12,756 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5d4f4af00> <matplotlib.colors.Normalize object at 0x74a5d4f4af00>
2025-06-03 15:14:12,757 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d515a5d0>
2025-06-03 15:14:12,758 - DEBUG - colorbar update normal <matplotlib.colors.Normalize object at 0x74a5d4f4af00> <matplotlib.colors.Normalize object at 0x74a5d4f4af00>
2025-06-03 15:14:12,759 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d515a5d0>
2025-06-03 15:14:12,761 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d515af00>
2025-06-03 15:14:12,839 - ERROR - Error during 3D t-SNE or plotting: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_16_updates_20250603_151411.png'
2025-06-03 15:14:12,840 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 331, in visualize_embeddings_3d
    plt.savefig(filepath)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/pyplot.py", line 1251, in savefig
    res = fig.savefig(*args, **kwargs)  # type: ignore[func-returns-value]
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/figure.py", line 3490, in savefig
    self.canvas.print_figure(fname, **kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2184, in print_figure
    result = print_method(
             ^^^^^^^^^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backend_bases.py", line 2040, in <lambda>
    print_method = functools.wraps(meth)(lambda *args, **kwargs: meth(
                                                                 ^^^^^
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 481, in print_png
    self._print_pil(filename_or_obj, "png", pil_kwargs, metadata)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/backends/backend_agg.py", line 430, in _print_pil
    mpl.image.imsave(
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/matplotlib/image.py", line 1657, in imsave
    image.save(fname, **pil_kwargs)
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/.venv/lib/python3.12/site-packages/PIL/Image.py", line 2576, in save
    fp = builtins.open(filename, "w+b")
         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
FileNotFoundError: [Errno 2] No such file or directory: 'vis/vis/embeddings_3d_16_updates_20250603_151411.png'

2025-06-03 15:14:12,840 - INFO - Performing visualization of node and edge features.
2025-06-03 15:14:12,840 - INFO - Starting visualization of node features.
2025-06-03 15:14:12,841 - INFO - Graph has 1010 nodes and 19 features.
2025-06-03 15:14:12,841 - INFO - Feature names: outgoing_ratio, incoming_ratio, server_score, client_score, unique_protocols, protocol_entropy, most_freq_proto_ratio, unique_remote_ports, unique_local_ports, remote_port_diversity, local_port_diversity, privileged_remote_ratio, privileged_local_ratio, first_seen_hour_minute_sin, first_seen_hour_minute_cos, last_seen_hour_minute_sin, last_seen_hour_minute_cos, http_ratio, ssl_ratio
2025-06-03 15:14:12,841 - INFO - Calculating feature statistics:
2025-06-03 15:14:12,841 - INFO - - outgoing_ratio: {'name': 'outgoing_ratio', 'unique': 4, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.10731402), 'max': np.float32(9.494974)}
2025-06-03 15:14:12,841 - INFO - - incoming_ratio: {'name': 'incoming_ratio', 'unique': 4, 'mean': np.float32(-1.416348e-08), 'std': np.float32(0.9999999), 'min': np.float32(-9.494974), 'max': np.float32(0.10731402)}
2025-06-03 15:14:12,841 - INFO - - server_score: {'name': 'server_score', 'unique': 14, 'mean': np.float32(-3.0215425e-08), 'std': np.float32(1.0), 'min': np.float32(-2.2924573), 'max': np.float32(3.179208)}
2025-06-03 15:14:12,841 - INFO - - client_score: {'name': 'client_score', 'unique': 8, 'mean': np.float32(1.6996175e-08), 'std': np.float32(1.0000001), 'min': np.float32(-0.07549707), 'max': np.float32(18.159897)}
2025-06-03 15:14:12,841 - INFO - - unique_protocols: {'name': 'unique_protocols', 'unique': 3, 'mean': np.float32(-6.043085e-08), 'std': np.float32(1.0), 'min': np.float32(-0.64383537), 'max': np.float32(3.5112681)}
2025-06-03 15:14:12,841 - INFO - - protocol_entropy: {'name': 'protocol_entropy', 'unique': 16, 'mean': np.float32(5.287699e-08), 'std': np.float32(1.0), 'min': np.float32(-0.65014666), 'max': np.float32(2.8871822)}
2025-06-03 15:14:12,841 - INFO - - most_freq_proto_ratio: {'name': 'most_freq_proto_ratio', 'unique': 14, 'mean': np.float32(0.0), 'std': np.float32(0.99999994), 'min': np.float32(-2.9084294), 'max': np.float32(0.63373893)}
2025-06-03 15:14:12,842 - INFO - - unique_remote_ports: {'name': 'unique_remote_ports', 'unique': 8, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.07902002), 'max': np.float32(20.264761)}
2025-06-03 15:14:12,842 - INFO - - unique_local_ports: {'name': 'unique_local_ports', 'unique': 5, 'mean': np.float32(1.888464e-09), 'std': np.float32(1.0), 'min': np.float32(-4.2803183), 'max': np.float32(21.025759)}
2025-06-03 15:14:12,842 - INFO - - remote_port_diversity: {'name': 'remote_port_diversity', 'unique': 7, 'mean': np.float32(1.2275016e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.09293793), 'max': np.float32(11.41274)}
2025-06-03 15:14:12,842 - INFO - - local_port_diversity: {'name': 'local_port_diversity', 'unique': 16, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-2.002014), 'max': np.float32(0.92043453)}
2025-06-03 15:14:12,842 - INFO - - privileged_remote_ratio: {'name': 'privileged_remote_ratio', 'unique': 6, 'mean': np.float32(-2.36058e-09), 'std': np.float32(1.0), 'min': np.float32(-0.1026304), 'max': np.float32(10.273981)}
2025-06-03 15:14:12,842 - INFO - - privileged_local_ratio: {'name': 'privileged_local_ratio', 'unique': 3, 'mean': np.float32(-1.888464e-08), 'std': np.float32(0.9999998), 'min': np.float32(-8.024705), 'max': np.float32(0.12643686)}
2025-06-03 15:14:12,842 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:14:12,842 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:14:12,842 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:14:12,842 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 15:14:12,843 - INFO - - http_ratio: {'name': 'http_ratio', 'unique': 13, 'mean': np.float32(-1.6996175e-08), 'std': np.float32(1.0), 'min': np.float32(-7.4247913), 'max': np.float32(0.15153895)}
2025-06-03 15:14:12,843 - INFO - - ssl_ratio: {'name': 'ssl_ratio', 'unique': 16, 'mean': np.float32(1.3219248e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.1466002), 'max': np.float32(4.358143)}
2025-06-03 15:14:12,856 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x74a5d530ce00>
2025-06-03 15:14:12,952 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 15:14:12,992 - DEBUG - Plotted ranges of node feature values.
2025-06-03 15:14:13,016 - DEBUG - Plotted sparsity of node features.
2025-06-03 15:14:14,055 - INFO - Node feature visualization saved to vis/node_features_20250603_151413.png
2025-06-03 15:14:14,055 - INFO - Finished visualization of node features.
2025-06-03 15:14:14,055 - INFO - Performing additional feature analysis:
2025-06-03 15:14:14,055 - INFO - - Maximum correlation between different features: nan
2025-06-03 15:14:14,055 - INFO - Starting visualization of edge features.
2025-06-03 15:14:14,055 - INFO - Graph has 2221 edges and 22 edge features.
2025-06-03 15:14:14,055 - ERROR - Expected 22 edge feature names, but got 10.
2025-06-03 15:14:14,055 - ERROR - Error during 2D feature visualization: Expected 22 names, got 10
2025-06-03 15:14:14,056 - ERROR - Traceback (most recent call last):
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/workflow_test.py", line 526, in monitor_new_files
    visualize_edge_features(main_data, save_path=visualization_path,
  File "/home/lu/Documents/graph_anomaly_detection/graph_monitor/visualization.py", line 197, in visualize_edge_features
    raise ValueError(f"Expected {num_features} names, got {len(edge_feature_names)}")
ValueError: Expected 22 names, got 10

2025-06-03 15:14:14,056 - INFO - 
--- Processing file: nw_graph_encoded_1748956090.dot ---
2025-06-03 15:14:14,056 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956090.dot
2025-06-03 15:14:14,056 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956090.dot file.
2025-06-03 15:14:14,071 - INFO - Parsed 1010 nodes.
2025-06-03 15:14:14,093 - INFO - Parsed 2221 edges.
2025-06-03 15:14:14,834 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:14:14,835 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:14:14,841 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:14:14,842 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:14:14,843 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:14:14,844 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:14:14,844 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:14:14,856 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:14:14,857 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:14:14,860 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:14:14,861 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:14:14,862 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:14:14,862 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:14:14,862 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:14:14,862 - INFO - Performing online update...
2025-06-03 15:14:14,862 - INFO - Starting online update for 50 steps.
2025-06-03 15:14:14,863 - DEBUG - Updated RunningStats: new_mean=[ 6.17587405e-10 -5.70763409e-10  7.39396962e-10  1.67227874e-09
 -2.49230317e-08  1.13653738e-08 -9.66332627e-09 -1.96051498e-09
 -2.81164666e-09  1.55284396e-09  1.97390012e-09 -1.40898971e-09
  3.74443249e-09 -3.93036717e-09  1.07450517e-09  9.99580334e-10
 -4.56901728e-09  1.67223413e-09 -5.38830978e-09], new_M2=[155300.00462443 155300.00452617 155299.9995998  155300.00220127
 155299.99913946 155299.99845137 155299.99780458 155299.99859639
 155299.99501044 155299.99899441 155300.00109754 155299.99525735
 155299.99405928 137887.996416   137888.00024373 137887.99904776
 137888.00004548 155300.0005048  155300.00635466], new_n=155300
2025-06-03 15:14:14,864 - DEBUG - Updated RunningStats: new_mean=[ 1.41952981e+00  5.51020414e+00  9.95063531e-11  2.64324566e-10
  2.38201212e-10 -9.06487384e-11 -1.55113311e-09  1.38582140e-10
  1.47468747e-10  2.12565754e-10  2.78022100e-10 -3.67596744e-09
 -7.96229017e-10  1.97502740e-09  6.36921640e-10 -1.48678176e-10
 -1.48678176e-10 -1.48678176e-10 -1.48678176e-10 -1.48678176e-10
 -1.48678176e-10 -1.34473745e-10], new_M2=[  85664.93146049 1471433.58142443  335353.99934219  335354.0050437
  335354.00636748  335353.99613421  335354.00045695  335353.99903104
  335354.00173407  335353.99886999  335353.9947916   335354.00736837
  335354.00103162  335353.99922518  335354.00279519  335353.9956247
  335353.9956247   335353.9956247   335353.9956247   335353.9956247
  335353.9956247   335353.99924146], new_n=335354
2025-06-03 15:14:14,864 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.94227464 0.94227465 0.94227465 0.94227465 1.
 1.00000002]
2025-06-03 15:14:14,864 - DEBUG - Calculated standard deviation: [0.50541694 2.09468434 1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:14:14,864 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:14:14,864 - DEBUG - Online update step: 1/50
2025-06-03 15:14:14,865 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:14,865 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:14,866 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:14:14,866 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:14,867 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:14,867 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:14,867 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:14,868 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:14,868 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:14,868 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:14,869 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:14:14,870 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-03 15:14:14,871 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:14,871 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:14,871 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:14:14,872 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:14,874 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:15,459 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:15,517 - DEBUG - Edge anomaly scores shape: torch.Size([32016, 1])
2025-06-03 15:14:15,518 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:15,519 - DEBUG - Node reconstruction loss: 0.0873
2025-06-03 15:14:16,917 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0420
2025-06-03 15:14:16,946 - DEBUG - Step 1: Loss=0.0707
2025-06-03 15:14:16,946 - DEBUG - Online update step: 2/50
2025-06-03 15:14:16,947 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:16,947 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:16,948 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:16,948 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:16,948 - DEBUG - Applied edge dropout: 262 edges dropped.
2025-06-03 15:14:16,952 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:16,952 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:16,953 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:14:16,953 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:16,953 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:16,954 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:16,957 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:14:16,957 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:14:16,958 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:14:16,958 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:16,958 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:14:16,960 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:17,581 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:17,635 - DEBUG - Edge anomaly scores shape: torch.Size([31964, 1])
2025-06-03 15:14:17,636 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:17,636 - DEBUG - Node reconstruction loss: 0.0829
2025-06-03 15:14:18,997 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0484
2025-06-03 15:14:19,006 - DEBUG - Step 2: Loss=0.0672
2025-06-03 15:14:19,006 - DEBUG - Online update step: 3/50
2025-06-03 15:14:19,007 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:19,007 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:19,008 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:19,011 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:19,013 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:19,014 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:19,014 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:19,015 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:19,018 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:19,018 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:19,021 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:14:19,022 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:19,023 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:19,023 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:19,023 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:19,024 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:19,027 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:19,675 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:19,724 - DEBUG - Edge anomaly scores shape: torch.Size([31964, 1])
2025-06-03 15:14:19,726 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:19,726 - DEBUG - Node reconstruction loss: 0.0878
2025-06-03 15:14:20,768 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0465
2025-06-03 15:14:20,771 - DEBUG - Step 3: Loss=0.0711
2025-06-03 15:14:20,771 - DEBUG - Online update step: 4/50
2025-06-03 15:14:20,771 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:20,772 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:20,772 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:20,772 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:20,773 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:20,773 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:20,773 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:20,774 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:20,774 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:20,774 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:14:20,775 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:20,775 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:14:20,775 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:20,775 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:20,776 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:20,776 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:20,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:21,323 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:21,373 - DEBUG - Edge anomaly scores shape: torch.Size([31905, 1])
2025-06-03 15:14:21,374 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:21,375 - DEBUG - Node reconstruction loss: 0.0668
2025-06-03 15:14:22,364 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0388
2025-06-03 15:14:22,368 - DEBUG - Step 4: Loss=0.0541
2025-06-03 15:14:22,368 - DEBUG - Online update step: 5/50
2025-06-03 15:14:22,369 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:22,369 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:22,369 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:22,370 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:22,374 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:22,374 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:14:22,376 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:14:22,377 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:22,378 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:14:22,378 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:14:22,380 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:22,381 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:22,381 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:22,382 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:22,382 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:14:22,383 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:22,386 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:23,079 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:23,132 - DEBUG - Edge anomaly scores shape: torch.Size([31984, 1])
2025-06-03 15:14:23,133 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:23,134 - DEBUG - Node reconstruction loss: 0.0889
2025-06-03 15:14:24,209 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0412
2025-06-03 15:14:24,212 - DEBUG - Step 5: Loss=0.0720
2025-06-03 15:14:24,212 - DEBUG - Online update step: 6/50
2025-06-03 15:14:24,213 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:24,213 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:24,213 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:24,214 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:24,214 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:24,214 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:24,215 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:24,215 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:24,215 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:24,216 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:24,216 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:24,216 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:14:24,217 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:24,217 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:24,217 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:24,218 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:24,219 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:24,844 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:24,896 - DEBUG - Edge anomaly scores shape: torch.Size([32031, 1])
2025-06-03 15:14:24,897 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:24,898 - DEBUG - Node reconstruction loss: 0.0902
2025-06-03 15:14:26,095 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0462
2025-06-03 15:14:26,100 - DEBUG - Step 6: Loss=0.0731
2025-06-03 15:14:26,100 - DEBUG - Online update step: 7/50
2025-06-03 15:14:26,101 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:26,102 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:26,102 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:26,102 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:26,103 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:26,103 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:26,103 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:26,104 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:26,104 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:26,105 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:14:26,105 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:26,105 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:14:26,106 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:26,106 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:26,106 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:26,107 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:26,108 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:26,722 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:26,777 - DEBUG - Edge anomaly scores shape: torch.Size([32066, 1])
2025-06-03 15:14:26,778 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:26,779 - DEBUG - Node reconstruction loss: 0.0854
2025-06-03 15:14:27,750 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0386
2025-06-03 15:14:27,753 - DEBUG - Step 7: Loss=0.0692
2025-06-03 15:14:27,753 - DEBUG - Online update step: 8/50
2025-06-03 15:14:27,754 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:27,754 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:27,754 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:27,755 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:27,755 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:27,755 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:14:27,755 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:27,756 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:27,756 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:27,756 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:27,757 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:27,757 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:27,757 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:27,758 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:27,758 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:27,758 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:27,759 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:28,400 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:28,459 - DEBUG - Edge anomaly scores shape: torch.Size([32024, 1])
2025-06-03 15:14:28,461 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:28,462 - DEBUG - Node reconstruction loss: 0.0921
2025-06-03 15:14:29,852 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0437
2025-06-03 15:14:29,854 - DEBUG - Step 8: Loss=0.0746
2025-06-03 15:14:29,854 - DEBUG - Online update step: 9/50
2025-06-03 15:14:29,854 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:29,854 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:14:29,855 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:29,855 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:29,855 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:14:29,856 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:29,856 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:14:29,856 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:29,856 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:29,857 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:29,857 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:29,857 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:29,858 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:29,858 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:29,858 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:14:29,858 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:29,860 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:30,591 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:30,649 - DEBUG - Edge anomaly scores shape: torch.Size([31948, 1])
2025-06-03 15:14:30,650 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:30,652 - DEBUG - Node reconstruction loss: 0.1007
2025-06-03 15:14:31,769 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0300
2025-06-03 15:14:31,771 - DEBUG - Step 9: Loss=0.0816
2025-06-03 15:14:31,771 - DEBUG - Online update step: 10/50
2025-06-03 15:14:31,771 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:31,772 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:31,772 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:31,773 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:31,773 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:31,773 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:31,773 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:31,774 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:14:31,775 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:31,775 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:31,775 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:31,776 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:31,776 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:14:31,776 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:31,776 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:14:31,777 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:31,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:32,381 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:32,429 - DEBUG - Edge anomaly scores shape: torch.Size([31918, 1])
2025-06-03 15:14:32,430 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:32,431 - DEBUG - Node reconstruction loss: 0.0941
2025-06-03 15:14:33,518 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0302
2025-06-03 15:14:33,526 - DEBUG - Step 10: Loss=0.0762
2025-06-03 15:14:33,526 - DEBUG - Online update step: 11/50
2025-06-03 15:14:33,527 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:33,527 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:33,528 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:33,565 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:33,566 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:33,567 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:14:33,567 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:33,567 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:33,568 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:33,568 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:33,568 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:33,568 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:33,569 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:33,569 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:33,572 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:33,573 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:33,575 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:34,153 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:34,249 - DEBUG - Edge anomaly scores shape: torch.Size([31946, 1])
2025-06-03 15:14:34,294 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:34,302 - DEBUG - Node reconstruction loss: 0.0931
2025-06-03 15:14:35,693 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0297
2025-06-03 15:14:35,696 - DEBUG - Step 11: Loss=0.0754
2025-06-03 15:14:35,697 - DEBUG - Online update step: 12/50
2025-06-03 15:14:35,697 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:35,698 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:35,698 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:35,699 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:35,699 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:35,700 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:35,700 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:35,700 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:14:35,701 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:35,701 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:35,701 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:35,702 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:14:35,702 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:35,702 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:35,703 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:35,703 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:14:35,704 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:36,304 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:36,363 - DEBUG - Edge anomaly scores shape: torch.Size([31881, 1])
2025-06-03 15:14:36,364 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:36,365 - DEBUG - Node reconstruction loss: 0.0792
2025-06-03 15:14:37,358 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0214
2025-06-03 15:14:37,360 - DEBUG - Step 12: Loss=0.0641
2025-06-03 15:14:37,361 - DEBUG - Online update step: 13/50
2025-06-03 15:14:37,361 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:37,362 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:37,362 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:37,362 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:37,363 - DEBUG - Applied edge dropout: 270 edges dropped.
2025-06-03 15:14:37,363 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:37,363 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:14:37,364 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:37,364 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:37,364 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:14:37,365 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:37,365 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:14:37,365 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:37,365 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:37,366 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:37,366 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:37,367 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:37,965 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:38,022 - DEBUG - Edge anomaly scores shape: torch.Size([31979, 1])
2025-06-03 15:14:38,023 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:38,026 - DEBUG - Node reconstruction loss: 0.0968
2025-06-03 15:14:39,270 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0373
2025-06-03 15:14:39,273 - DEBUG - Step 13: Loss=0.0784
2025-06-03 15:14:39,273 - DEBUG - Online update step: 14/50
2025-06-03 15:14:39,278 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:39,279 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:39,279 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:39,280 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:39,280 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:39,280 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:14:39,280 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:39,281 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:39,281 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:14:39,281 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:39,282 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:39,282 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:39,287 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:14:39,288 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:39,288 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:39,288 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:39,290 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:39,840 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:39,890 - DEBUG - Edge anomaly scores shape: torch.Size([31993, 1])
2025-06-03 15:14:39,891 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:39,892 - DEBUG - Node reconstruction loss: 0.1048
2025-06-03 15:14:40,984 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0422
2025-06-03 15:14:40,986 - DEBUG - Step 14: Loss=0.0849
2025-06-03 15:14:40,987 - DEBUG - Online update step: 15/50
2025-06-03 15:14:40,987 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:40,987 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:40,988 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-03 15:14:40,988 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:40,988 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:40,989 - DEBUG - Applied edge dropout: 265 edges dropped.
2025-06-03 15:14:40,989 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:40,989 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:40,990 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:40,990 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:40,990 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:14:40,990 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:14:40,991 - DEBUG - Applied edge dropout: 257 edges dropped.
2025-06-03 15:14:40,991 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:40,992 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:40,992 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:40,993 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:41,555 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:41,606 - DEBUG - Edge anomaly scores shape: torch.Size([31957, 1])
2025-06-03 15:14:41,607 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:41,608 - DEBUG - Node reconstruction loss: 0.0888
2025-06-03 15:14:42,496 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0373
2025-06-03 15:14:42,499 - DEBUG - Step 15: Loss=0.0719
2025-06-03 15:14:42,499 - DEBUG - Online update step: 16/50
2025-06-03 15:14:42,500 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:42,500 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:14:42,500 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:42,501 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:42,501 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:14:42,501 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:42,502 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:42,502 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:42,502 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:42,503 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:42,503 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:42,503 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:14:42,504 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:42,504 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:42,504 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:42,505 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:42,506 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:43,104 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:43,159 - DEBUG - Edge anomaly scores shape: torch.Size([31923, 1])
2025-06-03 15:14:43,160 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:43,160 - DEBUG - Node reconstruction loss: 0.0878
2025-06-03 15:14:44,235 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0574
2025-06-03 15:14:44,237 - DEBUG - Step 16: Loss=0.0711
2025-06-03 15:14:44,237 - DEBUG - Online update step: 17/50
2025-06-03 15:14:44,238 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:44,238 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:14:44,238 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:44,239 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:44,239 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:44,239 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:44,239 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:44,240 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:14:44,240 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:44,240 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:14:44,241 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:44,241 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:44,241 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:44,242 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:44,242 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:14:44,242 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:44,244 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:44,853 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:44,907 - DEBUG - Edge anomaly scores shape: torch.Size([31894, 1])
2025-06-03 15:14:44,908 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:44,908 - DEBUG - Node reconstruction loss: 0.0839
2025-06-03 15:14:45,922 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0285
2025-06-03 15:14:45,924 - DEBUG - Step 17: Loss=0.0680
2025-06-03 15:14:45,925 - DEBUG - Online update step: 18/50
2025-06-03 15:14:45,925 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:45,926 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:45,926 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:45,926 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:45,927 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:45,927 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:45,927 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:45,927 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:45,928 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:14:45,928 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:45,928 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:45,929 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:45,929 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:14:45,929 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:45,930 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:14:45,930 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:45,931 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:46,581 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:46,639 - DEBUG - Edge anomaly scores shape: torch.Size([31973, 1])
2025-06-03 15:14:46,640 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:46,641 - DEBUG - Node reconstruction loss: 0.0741
2025-06-03 15:14:48,213 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0314
2025-06-03 15:14:48,356 - DEBUG - Step 18: Loss=0.0600
2025-06-03 15:14:48,356 - DEBUG - Online update step: 19/50
2025-06-03 15:14:48,396 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:14:48,438 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:48,457 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:48,458 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:48,458 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:14:48,458 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:14:48,459 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:48,459 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:48,459 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:48,460 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:48,460 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:48,460 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:48,460 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:48,461 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:48,461 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:48,461 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:48,463 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:49,095 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:49,144 - DEBUG - Edge anomaly scores shape: torch.Size([31971, 1])
2025-06-03 15:14:49,145 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:49,146 - DEBUG - Node reconstruction loss: 0.0870
2025-06-03 15:14:50,287 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0434
2025-06-03 15:14:50,295 - DEBUG - Step 19: Loss=0.0705
2025-06-03 15:14:50,296 - DEBUG - Online update step: 20/50
2025-06-03 15:14:50,297 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:50,301 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:50,301 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-03 15:14:50,301 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:14:50,302 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:50,302 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:50,303 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:50,303 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:50,303 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:50,304 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-03 15:14:50,304 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:50,308 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:50,308 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:50,309 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:50,309 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:50,311 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:14:50,317 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:50,934 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:50,986 - DEBUG - Edge anomaly scores shape: torch.Size([32125, 1])
2025-06-03 15:14:50,987 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:50,988 - DEBUG - Node reconstruction loss: 0.0896
2025-06-03 15:14:52,054 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0412
2025-06-03 15:14:52,056 - DEBUG - Step 20: Loss=0.0726
2025-06-03 15:14:52,056 - DEBUG - Online update step: 21/50
2025-06-03 15:14:52,057 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:14:52,057 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:52,058 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:52,058 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:52,058 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:52,058 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:52,059 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:52,060 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:52,061 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:52,061 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:14:52,061 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:52,062 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:52,062 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:52,062 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:52,062 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:52,063 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:52,064 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:52,703 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:52,753 - DEBUG - Edge anomaly scores shape: torch.Size([32055, 1])
2025-06-03 15:14:52,754 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:52,755 - DEBUG - Node reconstruction loss: 0.0900
2025-06-03 15:14:53,712 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0329
2025-06-03 15:14:53,714 - DEBUG - Step 21: Loss=0.0729
2025-06-03 15:14:53,714 - DEBUG - Online update step: 22/50
2025-06-03 15:14:53,714 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:53,715 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:14:53,715 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:53,715 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:14:53,716 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:53,716 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:53,716 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:53,717 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:14:53,717 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:14:53,717 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:14:53,717 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:14:53,718 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:53,718 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:14:53,718 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:14:53,718 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:53,719 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:53,720 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:54,335 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:54,386 - DEBUG - Edge anomaly scores shape: torch.Size([32060, 1])
2025-06-03 15:14:54,387 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:54,388 - DEBUG - Node reconstruction loss: 0.0844
2025-06-03 15:14:55,606 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0564
2025-06-03 15:14:55,611 - DEBUG - Step 22: Loss=0.0684
2025-06-03 15:14:55,611 - DEBUG - Online update step: 23/50
2025-06-03 15:14:55,612 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:55,612 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:14:55,613 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:14:55,613 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:14:55,614 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:14:55,615 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:14:55,615 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:14:55,616 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:55,617 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:55,617 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:14:55,618 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:55,618 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:55,619 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:14:55,620 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:14:55,620 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:14:55,621 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:14:55,623 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:56,164 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:56,215 - DEBUG - Edge anomaly scores shape: torch.Size([31946, 1])
2025-06-03 15:14:56,217 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:56,217 - DEBUG - Node reconstruction loss: 0.0764
2025-06-03 15:14:57,204 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0558
2025-06-03 15:14:57,210 - DEBUG - Step 23: Loss=0.0619
2025-06-03 15:14:57,210 - DEBUG - Online update step: 24/50
2025-06-03 15:14:57,211 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:57,212 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:14:57,212 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:14:57,212 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:14:57,213 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:14:57,216 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:14:57,217 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:57,217 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:57,218 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:14:57,218 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:14:57,219 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:14:57,219 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:57,219 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:57,220 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:14:57,223 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:14:57,223 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:14:57,225 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:57,811 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:57,863 - DEBUG - Edge anomaly scores shape: torch.Size([31967, 1])
2025-06-03 15:14:57,864 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:57,864 - DEBUG - Node reconstruction loss: 0.0674
2025-06-03 15:14:58,893 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0337
2025-06-03 15:14:58,895 - DEBUG - Step 24: Loss=0.0546
2025-06-03 15:14:58,895 - DEBUG - Online update step: 25/50
2025-06-03 15:14:58,896 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:14:58,896 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:14:58,897 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:58,897 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:14:58,897 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:14:58,898 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:14:58,898 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:14:58,899 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:14:58,899 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:58,900 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:14:58,901 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:58,902 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:14:58,902 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:14:58,902 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:14:58,903 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:14:58,903 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:14:58,904 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:14:59,513 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:14:59,567 - DEBUG - Edge anomaly scores shape: torch.Size([31951, 1])
2025-06-03 15:14:59,568 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:14:59,569 - DEBUG - Node reconstruction loss: 0.0911
2025-06-03 15:15:00,746 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0598
2025-06-03 15:15:00,748 - DEBUG - Step 25: Loss=0.0738
2025-06-03 15:15:00,748 - DEBUG - Online update step: 26/50
2025-06-03 15:15:00,748 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:00,749 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:00,749 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:00,749 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:00,750 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:00,750 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:00,750 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:00,751 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:00,751 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:00,751 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:15:00,751 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:00,752 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:00,752 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:00,752 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:00,753 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:15:00,753 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:00,754 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:01,398 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:01,448 - DEBUG - Edge anomaly scores shape: torch.Size([31974, 1])
2025-06-03 15:15:01,449 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:01,450 - DEBUG - Node reconstruction loss: 0.1076
2025-06-03 15:15:02,494 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0684
2025-06-03 15:15:02,497 - DEBUG - Step 26: Loss=0.0871
2025-06-03 15:15:02,497 - DEBUG - Online update step: 27/50
2025-06-03 15:15:02,497 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:02,498 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:02,498 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:02,498 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:02,499 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:02,499 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:02,499 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:02,500 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:02,500 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:02,500 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:02,501 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:02,501 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:15:02,501 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:02,502 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:02,502 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:02,503 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:02,504 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:03,133 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:03,183 - DEBUG - Edge anomaly scores shape: torch.Size([32010, 1])
2025-06-03 15:15:03,184 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:03,185 - DEBUG - Node reconstruction loss: 0.0790
2025-06-03 15:15:04,218 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.2101
2025-06-03 15:15:04,221 - DEBUG - Step 27: Loss=0.0640
2025-06-03 15:15:04,222 - DEBUG - Online update step: 28/50
2025-06-03 15:15:04,222 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:04,223 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:04,223 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:04,223 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:04,224 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:04,224 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:04,224 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:04,225 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:04,225 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:04,226 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:15:04,226 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:04,227 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:04,227 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:04,227 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:04,228 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:04,228 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:04,230 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:04,838 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:04,888 - DEBUG - Edge anomaly scores shape: torch.Size([31992, 1])
2025-06-03 15:15:04,889 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:04,890 - DEBUG - Node reconstruction loss: 0.1055
2025-06-03 15:15:05,977 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0464
2025-06-03 15:15:05,979 - DEBUG - Step 28: Loss=0.0854
2025-06-03 15:15:05,979 - DEBUG - Online update step: 29/50
2025-06-03 15:15:05,980 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:05,980 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:05,981 - DEBUG - Applied edge dropout: 187 edges dropped.
2025-06-03 15:15:05,981 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:05,981 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:05,981 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:05,982 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:05,982 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:05,982 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:05,983 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:05,983 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:05,983 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:05,983 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:05,984 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:05,984 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:05,984 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:15:05,986 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:06,558 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:06,614 - DEBUG - Edge anomaly scores shape: torch.Size([31967, 1])
2025-06-03 15:15:06,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:06,616 - DEBUG - Node reconstruction loss: 0.0971
2025-06-03 15:15:07,771 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0543
2025-06-03 15:15:07,781 - DEBUG - Step 29: Loss=0.0786
2025-06-03 15:15:07,781 - DEBUG - Online update step: 30/50
2025-06-03 15:15:07,782 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:15:07,783 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:07,783 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:07,784 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:07,785 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:15:07,785 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:07,786 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:15:07,786 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:07,787 - DEBUG - Applied edge dropout: 259 edges dropped.
2025-06-03 15:15:07,788 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:07,788 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:07,789 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:07,789 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:07,790 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:07,792 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:07,792 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:07,795 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:08,370 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:08,423 - DEBUG - Edge anomaly scores shape: torch.Size([31932, 1])
2025-06-03 15:15:08,424 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:08,425 - DEBUG - Node reconstruction loss: 0.1040
2025-06-03 15:15:09,520 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0287
2025-06-03 15:15:09,523 - DEBUG - Step 30: Loss=0.0842
2025-06-03 15:15:09,523 - DEBUG - Online update step: 31/50
2025-06-03 15:15:09,523 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:09,524 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:09,524 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:09,525 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:09,525 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:09,525 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:09,526 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:09,526 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:09,526 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:09,527 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:09,527 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:09,527 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:09,528 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:09,528 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:15:09,528 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:09,529 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:09,530 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:10,127 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:10,221 - DEBUG - Edge anomaly scores shape: torch.Size([32026, 1])
2025-06-03 15:15:10,222 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:10,223 - DEBUG - Node reconstruction loss: 0.0852
2025-06-03 15:15:11,561 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0538
2025-06-03 15:15:11,564 - DEBUG - Step 31: Loss=0.0690
2025-06-03 15:15:11,564 - DEBUG - Online update step: 32/50
2025-06-03 15:15:11,564 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:11,565 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:11,565 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:11,566 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:11,566 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:11,566 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:11,567 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:11,567 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:11,567 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:11,567 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:11,568 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:11,568 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:11,568 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:11,569 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:11,569 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:11,569 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:11,571 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:12,133 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:12,182 - DEBUG - Edge anomaly scores shape: torch.Size([32081, 1])
2025-06-03 15:15:12,183 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:12,183 - DEBUG - Node reconstruction loss: 0.0932
2025-06-03 15:15:13,321 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0505
2025-06-03 15:15:13,324 - DEBUG - Step 32: Loss=0.0755
2025-06-03 15:15:13,324 - DEBUG - Online update step: 33/50
2025-06-03 15:15:13,325 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:13,325 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:13,326 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:15:13,326 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:13,326 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:13,327 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:13,327 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:13,327 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:13,328 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:13,328 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:13,329 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:13,329 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:13,329 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:13,330 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:13,330 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:13,330 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:15:13,332 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:13,916 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:13,967 - DEBUG - Edge anomaly scores shape: torch.Size([31973, 1])
2025-06-03 15:15:13,968 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:13,969 - DEBUG - Node reconstruction loss: 0.0813
2025-06-03 15:15:15,223 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0432
2025-06-03 15:15:15,225 - DEBUG - Step 33: Loss=0.0658
2025-06-03 15:15:15,226 - DEBUG - Online update step: 34/50
2025-06-03 15:15:15,226 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:15,226 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:15,227 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:15,227 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:15,227 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:15,228 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:15,228 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:15,228 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:15,228 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:15,229 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:15,229 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:15,229 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:15,229 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:15,230 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:15:15,230 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:15,230 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:15,232 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:15,842 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:15,894 - DEBUG - Edge anomaly scores shape: torch.Size([31974, 1])
2025-06-03 15:15:15,895 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:15,895 - DEBUG - Node reconstruction loss: 0.1020
2025-06-03 15:15:16,971 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0615
2025-06-03 15:15:16,977 - DEBUG - Step 34: Loss=0.0827
2025-06-03 15:15:16,977 - DEBUG - Online update step: 35/50
2025-06-03 15:15:16,978 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:16,979 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:15:16,979 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:16,980 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:16,981 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:15:16,981 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:16,982 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:16,982 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:16,983 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:16,984 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:16,984 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:16,985 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:16,986 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:16,986 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:16,987 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:16,987 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:16,989 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:17,599 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:17,690 - DEBUG - Edge anomaly scores shape: torch.Size([31939, 1])
2025-06-03 15:15:17,692 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:17,693 - DEBUG - Node reconstruction loss: 0.1043
2025-06-03 15:15:18,931 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0527
2025-06-03 15:15:18,934 - DEBUG - Step 35: Loss=0.0845
2025-06-03 15:15:18,934 - DEBUG - Online update step: 36/50
2025-06-03 15:15:18,935 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:18,935 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:18,936 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:18,936 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:18,936 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:18,937 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:18,937 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:18,937 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:18,938 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:18,938 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:18,938 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:18,938 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:18,939 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:15:18,939 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:18,939 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:18,940 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:18,941 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:19,520 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:19,577 - DEBUG - Edge anomaly scores shape: torch.Size([31952, 1])
2025-06-03 15:15:19,579 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:19,579 - DEBUG - Node reconstruction loss: 0.0890
2025-06-03 15:15:20,631 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0466
2025-06-03 15:15:20,634 - DEBUG - Step 36: Loss=0.0721
2025-06-03 15:15:20,634 - DEBUG - Online update step: 37/50
2025-06-03 15:15:20,635 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:20,635 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:20,635 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:20,636 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:20,636 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:20,637 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:20,637 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:15:20,637 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:20,637 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:20,638 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:20,638 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:20,638 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:15:20,639 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:20,639 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:20,639 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:15:20,640 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:20,641 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:21,260 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:21,315 - DEBUG - Edge anomaly scores shape: torch.Size([31927, 1])
2025-06-03 15:15:21,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:21,317 - DEBUG - Node reconstruction loss: 0.0984
2025-06-03 15:15:22,299 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0544
2025-06-03 15:15:22,303 - DEBUG - Step 37: Loss=0.0797
2025-06-03 15:15:22,303 - DEBUG - Online update step: 38/50
2025-06-03 15:15:22,304 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:22,304 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:22,304 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:22,305 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:22,305 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:15:22,305 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:15:22,306 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:22,306 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:22,306 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:22,307 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:15:22,307 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:22,307 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:22,308 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:22,308 - DEBUG - Applied edge dropout: 189 edges dropped.
2025-06-03 15:15:22,309 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:22,309 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:22,310 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:23,004 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:23,172 - DEBUG - Edge anomaly scores shape: torch.Size([31950, 1])
2025-06-03 15:15:23,185 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:23,185 - DEBUG - Node reconstruction loss: 0.0908
2025-06-03 15:15:24,460 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0406
2025-06-03 15:15:24,463 - DEBUG - Step 38: Loss=0.0736
2025-06-03 15:15:24,463 - DEBUG - Online update step: 39/50
2025-06-03 15:15:24,463 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:24,464 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:24,464 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:24,465 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:24,465 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:24,465 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:24,466 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:15:24,466 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:24,466 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:24,467 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:24,467 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:24,467 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:24,468 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:24,468 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:24,468 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:24,469 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:24,470 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:25,122 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:25,176 - DEBUG - Edge anomaly scores shape: torch.Size([31955, 1])
2025-06-03 15:15:25,177 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:25,178 - DEBUG - Node reconstruction loss: 0.0940
2025-06-03 15:15:27,370 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0246
2025-06-03 15:15:27,372 - DEBUG - Step 39: Loss=0.0761
2025-06-03 15:15:27,372 - DEBUG - Online update step: 40/50
2025-06-03 15:15:27,373 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:27,373 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:15:27,374 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:27,374 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:27,374 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:27,375 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:27,375 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:27,375 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:27,376 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:27,376 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:27,376 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:27,376 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:27,377 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:27,377 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:27,377 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:15:27,378 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:15:27,379 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:27,955 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:28,005 - DEBUG - Edge anomaly scores shape: torch.Size([32016, 1])
2025-06-03 15:15:28,006 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:28,007 - DEBUG - Node reconstruction loss: 0.0790
2025-06-03 15:15:29,316 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0362
2025-06-03 15:15:29,441 - DEBUG - Step 40: Loss=0.0640
2025-06-03 15:15:29,441 - DEBUG - Online update step: 41/50
2025-06-03 15:15:29,444 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:29,444 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:29,445 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:29,454 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:15:29,455 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:29,455 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:29,456 - DEBUG - Applied edge dropout: 253 edges dropped.
2025-06-03 15:15:29,456 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:29,456 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:15:29,457 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:29,457 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:29,462 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:29,462 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:29,462 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:29,463 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:15:29,467 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:29,469 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:30,087 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:30,138 - DEBUG - Edge anomaly scores shape: torch.Size([31864, 1])
2025-06-03 15:15:30,139 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:30,139 - DEBUG - Node reconstruction loss: 0.0903
2025-06-03 15:15:31,331 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0504
2025-06-03 15:15:31,333 - DEBUG - Step 41: Loss=0.0731
2025-06-03 15:15:31,334 - DEBUG - Online update step: 42/50
2025-06-03 15:15:31,334 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:31,334 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:31,335 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:31,335 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:31,336 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:31,336 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:31,336 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:31,337 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:31,337 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:31,337 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:31,338 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:31,338 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:31,338 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:31,339 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:31,339 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:31,339 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:31,341 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:31,938 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:31,988 - DEBUG - Edge anomaly scores shape: torch.Size([31961, 1])
2025-06-03 15:15:31,989 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:31,990 - DEBUG - Node reconstruction loss: 0.0927
2025-06-03 15:15:33,084 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0502
2025-06-03 15:15:33,089 - DEBUG - Step 42: Loss=0.0751
2025-06-03 15:15:33,089 - DEBUG - Online update step: 43/50
2025-06-03 15:15:33,090 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:33,091 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:33,091 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:15:33,092 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:33,093 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:33,093 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:33,094 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:33,095 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:33,095 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:15:33,096 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:33,097 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:33,098 - DEBUG - Applied edge dropout: 191 edges dropped.
2025-06-03 15:15:33,099 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:33,100 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:33,100 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:33,101 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:15:33,103 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:33,704 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:33,756 - DEBUG - Edge anomaly scores shape: torch.Size([32019, 1])
2025-06-03 15:15:33,757 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:33,758 - DEBUG - Node reconstruction loss: 0.0770
2025-06-03 15:15:34,781 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0401
2025-06-03 15:15:34,783 - DEBUG - Step 43: Loss=0.0624
2025-06-03 15:15:34,783 - DEBUG - Online update step: 44/50
2025-06-03 15:15:34,784 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:34,784 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:34,784 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:34,785 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:34,785 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:34,786 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:34,786 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:34,787 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:34,787 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:34,787 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:34,788 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:34,788 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:34,788 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:34,789 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:15:34,789 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:34,789 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:34,791 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:35,414 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:35,468 - DEBUG - Edge anomaly scores shape: torch.Size([32075, 1])
2025-06-03 15:15:35,469 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:35,469 - DEBUG - Node reconstruction loss: 0.0929
2025-06-03 15:15:36,561 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0457
2025-06-03 15:15:36,564 - DEBUG - Step 44: Loss=0.0752
2025-06-03 15:15:36,564 - DEBUG - Online update step: 45/50
2025-06-03 15:15:36,564 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:36,565 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:15:36,565 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:36,566 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:15:36,566 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:36,566 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:36,567 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:36,567 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:36,567 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:36,568 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:15:36,568 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:36,568 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:36,569 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:36,569 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:36,569 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:36,570 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:36,571 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:37,144 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:37,195 - DEBUG - Edge anomaly scores shape: torch.Size([31987, 1])
2025-06-03 15:15:37,196 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:37,196 - DEBUG - Node reconstruction loss: 0.1017
2025-06-03 15:15:38,289 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0320
2025-06-03 15:15:38,292 - DEBUG - Step 45: Loss=0.0824
2025-06-03 15:15:38,292 - DEBUG - Online update step: 46/50
2025-06-03 15:15:38,293 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:15:38,293 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:38,293 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:38,294 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:38,294 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:38,294 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:15:38,295 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:38,295 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:38,295 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:38,295 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:38,296 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:38,296 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:38,296 - DEBUG - Applied edge dropout: 197 edges dropped.
2025-06-03 15:15:38,297 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:38,297 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:38,297 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:38,299 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:38,891 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:38,943 - DEBUG - Edge anomaly scores shape: torch.Size([32016, 1])
2025-06-03 15:15:38,946 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:38,946 - DEBUG - Node reconstruction loss: 0.0968
2025-06-03 15:15:39,916 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0432
2025-06-03 15:15:39,919 - DEBUG - Step 46: Loss=0.0784
2025-06-03 15:15:39,919 - DEBUG - Online update step: 47/50
2025-06-03 15:15:39,919 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:39,920 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:39,920 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:15:39,920 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:39,921 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:39,921 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:39,921 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:39,922 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:15:39,922 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:15:39,922 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:39,923 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:39,923 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:39,923 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:15:39,924 - DEBUG - Applied edge dropout: 262 edges dropped.
2025-06-03 15:15:39,924 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:39,924 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:39,925 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:40,582 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:40,655 - DEBUG - Edge anomaly scores shape: torch.Size([31888, 1])
2025-06-03 15:15:40,656 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:40,657 - DEBUG - Node reconstruction loss: 0.0916
2025-06-03 15:15:41,831 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0353
2025-06-03 15:15:41,833 - DEBUG - Step 47: Loss=0.0742
2025-06-03 15:15:41,833 - DEBUG - Online update step: 48/50
2025-06-03 15:15:41,834 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:15:41,834 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:41,835 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:41,835 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:41,835 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:41,835 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:41,836 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:41,836 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:15:41,837 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:41,837 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:41,837 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:41,837 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:15:41,838 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:15:41,838 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:41,838 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:15:41,839 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:15:41,840 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:42,462 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:42,550 - DEBUG - Edge anomaly scores shape: torch.Size([31933, 1])
2025-06-03 15:15:42,554 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:42,555 - DEBUG - Node reconstruction loss: 0.0845
2025-06-03 15:15:43,865 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.2259
2025-06-03 15:15:43,870 - DEBUG - Step 48: Loss=0.0684
2025-06-03 15:15:43,870 - DEBUG - Online update step: 49/50
2025-06-03 15:15:43,871 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:43,872 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:43,873 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:43,873 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:43,874 - DEBUG - Applied edge dropout: 193 edges dropped.
2025-06-03 15:15:43,875 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:43,876 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:15:43,877 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:43,878 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:43,878 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:43,879 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:15:43,879 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:43,880 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:43,881 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:43,881 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:43,882 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:43,884 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:44,511 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:44,575 - DEBUG - Edge anomaly scores shape: torch.Size([31983, 1])
2025-06-03 15:15:44,577 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:44,578 - DEBUG - Node reconstruction loss: 0.0820
2025-06-03 15:15:45,628 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0355
2025-06-03 15:15:45,630 - DEBUG - Step 49: Loss=0.0664
2025-06-03 15:15:45,630 - DEBUG - Online update step: 50/50
2025-06-03 15:15:45,631 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:45,631 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:45,632 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:45,632 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:15:45,632 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:45,632 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:45,633 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:45,633 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:45,634 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:45,635 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:45,635 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:45,635 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:45,635 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:45,636 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:45,636 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:45,636 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:45,638 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:46,218 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:46,271 - DEBUG - Edge anomaly scores shape: torch.Size([31976, 1])
2025-06-03 15:15:46,272 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:46,273 - DEBUG - Node reconstruction loss: 0.0827
2025-06-03 15:15:47,252 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0448
2025-06-03 15:15:47,254 - DEBUG - Step 50: Loss=0.0670
2025-06-03 15:15:47,254 - INFO - Online update finished. Average loss: 0.0725, Learning rate: 0.002714
2025-06-03 15:15:47,255 - DEBUG - Current node mean: [ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], current edge mean: [ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:15:47,255 - DEBUG - Node drift difference (max): 0.0000, Edge drift difference (max): 0.0909
2025-06-03 15:15:47,255 - DEBUG - Updated reference mean: node=[ 2.0773104e-08 -2.0773104e-08 -2.5494264e-08  1.7291249e-08
 -4.7211600e-08  6.0430850e-08 -9.4423203e-10  7.0817401e-09
 -7.0817401e-09  6.6096240e-09  7.5538562e-09 -2.8326961e-09
 -2.2189452e-08  0.0000000e+00  0.0000000e+00  0.0000000e+00
  0.0000000e+00 -1.7940408e-08  1.6996175e-08], edge=[ 1.4218820e+00  5.7005854e+00  8.5877921e-10 -2.5763376e-09
 -2.5763376e-09 -5.1526752e-09  0.0000000e+00  1.1164130e-08
  4.9379807e-09  1.7175584e-09 -5.7967595e-09 -6.2261494e-09
 -1.7175584e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09 -2.5763376e-09
 -2.5763376e-09  8.5877921e-10]
2025-06-03 15:15:47,255 - DEBUG - Updated reference std: node=[1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954
 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 1.0004954 0.
 0.        0.        0.        1.0004954 1.0004954], edge=[0.5056868 2.1382287 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252 1.0002252
 1.0002252]
2025-06-03 15:15:47,256 - INFO - Online update complete. Loss: 0.0725
2025-06-03 15:15:47,256 - INFO - Running anomaly detection...
2025-06-03 15:15:47,256 - INFO - Starting anomaly detection.
2025-06-03 15:15:47,267 - DEBUG - Node reconstruction errors: [2.1274961e-04 9.3747847e-05 9.3747847e-05 ... 2.1274961e-04 9.3860363e-05
 9.3747847e-05]
2025-06-03 15:15:47,267 - DEBUG - Edge reconstruction errors: [0.8        0.8        0.8        ... 0.19999999 0.19999999 0.19999999]
2025-06-03 15:15:47,270 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_151547_update_17.json
2025-06-03 15:15:47,270 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 15:15:47,287 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_151547_update_17.pth and as latest_checkpoint.pth
2025-06-03 15:15:47,287 - INFO - 
Global anomaly score (after nw_graph_encoded_1748956090.dot): 0.9865
2025-06-03 15:15:47,287 - WARNING - Detected 17 anomalous nodes (reconstruction-based):
2025-06-03 15:15:47,287 - WARNING -   Node ID: fe80::20c:29ff:fe89:3ead, Recon Error: 0.7930, MLP Score: 0.0000
2025-06-03 15:15:47,287 - WARNING -   Node ID: fe80::20c:29ff:fe02:9537, Recon Error: 0.7930, MLP Score: 0.0000
2025-06-03 15:15:47,287 - WARNING -   Node ID: 192.168.209.1, Recon Error: 0.7930, MLP Score: 0.0000
2025-06-03 15:15:47,287 - WARNING -   Node ID: 210.245.26.100, Recon Error: 0.2586, MLP Score: 0.0000
2025-06-03 15:15:47,287 - WARNING -   Node ID: fe80::eb4e:a54d:8c61:6ce1, Recon Error: 0.7328, MLP Score: 0.0000
2025-06-03 15:15:47,287 - WARNING - Detected 37 anomalous edges (reconstruction-based):
2025-06-03 15:15:47,288 - WARNING -   Source: fe80::20c:29ff:fe89:3ead, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:15:47,288 - WARNING -   Source: fe80::20c:29ff:fe02:9537, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:15:47,288 - WARNING -   Source: 192.168.209.1, Target: 192.168.239.101, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:15:47,288 - WARNING -   Source: fe80::1cee:30ff:fe26:4f78, Target: ff02::2, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:15:47,288 - WARNING -   Source: 192.168.239.101, Target: 8.8.8.8, Recon Error: 0.8000, MLP Score: 0.0000
2025-06-03 15:15:47,288 - INFO - 
--- Processing file: nw_graph_encoded_1748956105.dot ---
2025-06-03 15:15:47,288 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748956105.dot
2025-06-03 15:15:47,288 - INFO - Processing /home/lu/Desktop/output/nw_graph_encoded_1748956105.dot file.
2025-06-03 15:15:47,304 - INFO - Parsed 1010 nodes.
2025-06-03 15:15:47,326 - INFO - Parsed 2221 edges.
2025-06-03 15:15:48,074 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 15:15:48,074 - DEBUG - Sorted node attribute keys: ['outgoing_ratio', 'incoming_ratio', 'server_score', 'client_score', 'unique_protocols', 'protocol_entropy', 'most_freq_proto_ratio', 'unique_remote_ports', 'unique_local_ports', 'remote_port_diversity', 'local_port_diversity', 'privileged_remote_ratio', 'privileged_local_ratio', 'first_seen_hour_minute_sin', 'first_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'last_seen_hour_minute_cos', 'http_ratio', 'ssl_ratio']
2025-06-03 15:15:48,080 - DEBUG - Initial node features tensor shape: torch.Size([1010, 19])
2025-06-03 15:15:48,082 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 15:15:48,082 - DEBUG - Node features tensor shape after scaling: torch.Size([1010, 19])
2025-06-03 15:15:48,083 - DEBUG - Edge index tensor shape: torch.Size([2, 2221])
2025-06-03 15:15:48,083 - DEBUG - Sorted edge attribute keys: ['dst_port', 'count', 'total_orig_bytes', 'total_resp_bytes', 'total_orig_pkts', 'total_resp_pkts', 'total_orig_ip_bytes', 'total_resp_ip_bytes', 'protocol', 'service']
2025-06-03 15:15:48,096 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 15:15:48,097 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 8
2025-06-03 15:15:48,099 - DEBUG - Shape of encoded categorical edge features: torch.Size([2221, 2])
2025-06-03 15:15:48,101 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 15:15:48,101 - DEBUG - Shape of scaled numerical edge features: torch.Size([2221, 20])
2025-06-03 15:15:48,101 - DEBUG - Final edge attributes tensor shape: torch.Size([2221, 22])
2025-06-03 15:15:48,101 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 15:15:48,102 - INFO - Performing online update...
2025-06-03 15:15:48,102 - INFO - Starting online update for 50 steps.
2025-06-03 15:15:48,102 - DEBUG - Updated RunningStats: new_mean=[ 6.12452883e-10 -5.67456733e-10  5.69029692e-10  1.71495387e-09
 -2.50647617e-08  1.15615317e-08 -9.71690412e-09 -1.98064088e-09
 -2.82760759e-09  1.51614143e-09  1.95463939e-09 -1.42224057e-09
  3.76180200e-09 -3.90497103e-09  1.06756224e-09  9.93121526e-10
 -4.53949449e-09  1.66066632e-09 -5.38418964e-09], new_M2=[156310.00465205 156310.00455507 156309.9996356  156310.0022948
 156309.99911768 156309.99844735 156309.99771929 156309.99858814
 156309.99492987 156309.99895962 156310.00113771 156309.99518849
 156309.99399043 137887.996416   137888.00024373 137887.99904776
 137888.00004548 156310.00050105 156310.00641012], new_n=156310
2025-06-03 15:15:48,103 - DEBUG - Updated RunningStats: new_mean=[ 1.41954529e+00  5.51145671e+00  1.00621655e-10  2.68076842e-10
  2.34046208e-10 -9.44732378e-11 -1.53999459e-09  1.48078820e-10
  1.61012878e-10  1.81374283e-10  2.89967910e-10 -3.69495219e-09
 -8.01080940e-10  1.90886437e-09  6.24112472e-10 -1.50010527e-10
 -1.50010527e-10 -1.50010527e-10 -1.50010527e-10 -1.50010527e-10
 -1.50010527e-10 -1.30414590e-10], new_M2=[  86232.64020144 1481663.44116125  337574.9993307   337575.00513629
  337575.00632893  337574.99601008  337575.00044833  337574.99904191
  337575.00173177  337574.99889581  337574.99473797  337575.00745084
  337575.00103738  337574.99924794  337575.00275046  337574.99556627
  337574.99556627  337574.99556627  337574.99556627  337574.99556627
  337574.99556627  337574.99926182], new_n=337575
2025-06-03 15:15:48,103 - DEBUG - Calculated standard deviation: [1.00000001 1.00000001 1.         1.00000001 1.         1.
 0.99999999 1.         0.99999998 1.         1.         0.99999998
 0.99999998 0.93922544 0.93922546 0.93922545 0.93922546 1.
 1.00000002]
2025-06-03 15:15:48,103 - DEBUG - Calculated standard deviation: [0.505418   2.0950271  1.         1.00000001 1.00000001 0.99999999
 1.         1.         1.         1.         0.99999999 1.00000001
 1.         1.         1.         0.99999999 0.99999999 0.99999999
 0.99999999 0.99999999 0.99999999 1.        ]
2025-06-03 15:15:48,104 - DEBUG - Adding data to replay buffer. Has edge_index: True
2025-06-03 15:15:48,104 - DEBUG - Online update step: 1/50
2025-06-03 15:15:48,104 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:15:48,105 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:48,105 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:48,105 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:15:48,106 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:15:48,106 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:48,106 - DEBUG - Applied edge dropout: 241 edges dropped.
2025-06-03 15:15:48,107 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:15:48,107 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:48,107 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:15:48,108 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:48,108 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:48,108 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:48,109 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:15:48,109 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:15:48,109 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:48,111 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:48,686 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:48,737 - DEBUG - Edge anomaly scores shape: torch.Size([31972, 1])
2025-06-03 15:15:48,738 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:48,738 - DEBUG - Node reconstruction loss: 0.0997
2025-06-03 15:15:49,826 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0523
2025-06-03 15:15:49,828 - DEBUG - Step 1: Loss=0.0807
2025-06-03 15:15:49,828 - DEBUG - Online update step: 2/50
2025-06-03 15:15:49,828 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:49,829 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:49,829 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:49,830 - DEBUG - Applied edge dropout: 254 edges dropped.
2025-06-03 15:15:49,830 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:15:49,830 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:49,830 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:49,831 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:49,831 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:15:49,831 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:49,832 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:49,832 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:15:49,832 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:49,832 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:49,833 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:49,833 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:49,834 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:50,442 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:50,494 - DEBUG - Edge anomaly scores shape: torch.Size([32024, 1])
2025-06-03 15:15:50,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:50,495 - DEBUG - Node reconstruction loss: 0.0894
2025-06-03 15:15:51,513 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0453
2025-06-03 15:15:51,515 - DEBUG - Step 2: Loss=0.0724
2025-06-03 15:15:51,515 - DEBUG - Online update step: 3/50
2025-06-03 15:15:51,516 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:51,516 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:51,516 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:15:51,517 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:15:51,517 - DEBUG - Applied edge dropout: 196 edges dropped.
2025-06-03 15:15:51,517 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:51,518 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:51,518 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:51,518 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:51,519 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:51,519 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:51,519 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:51,519 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:15:51,520 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:51,520 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:15:51,520 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:15:51,521 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:52,111 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:52,164 - DEBUG - Edge anomaly scores shape: torch.Size([31921, 1])
2025-06-03 15:15:52,165 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:52,165 - DEBUG - Node reconstruction loss: 0.0951
2025-06-03 15:15:53,245 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0515
2025-06-03 15:15:53,247 - DEBUG - Step 3: Loss=0.0770
2025-06-03 15:15:53,247 - DEBUG - Online update step: 4/50
2025-06-03 15:15:53,248 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:53,248 - DEBUG - Applied edge dropout: 251 edges dropped.
2025-06-03 15:15:53,249 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:53,249 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:15:53,249 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:53,250 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:15:53,250 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:15:53,251 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:53,251 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:53,251 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:53,252 - DEBUG - Applied edge dropout: 194 edges dropped.
2025-06-03 15:15:53,252 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:53,252 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:53,252 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:53,253 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:15:53,253 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:53,254 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:53,855 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:53,912 - DEBUG - Edge anomaly scores shape: torch.Size([31931, 1])
2025-06-03 15:15:53,913 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:53,914 - DEBUG - Node reconstruction loss: 0.0846
2025-06-03 15:15:54,956 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0406
2025-06-03 15:15:54,959 - DEBUG - Step 4: Loss=0.0686
2025-06-03 15:15:54,960 - DEBUG - Online update step: 5/50
2025-06-03 15:15:54,960 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:54,961 - DEBUG - Applied edge dropout: 246 edges dropped.
2025-06-03 15:15:54,961 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:15:54,961 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:15:54,962 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:54,962 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:54,962 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:15:54,963 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:54,963 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:54,963 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:54,963 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:15:54,964 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:54,964 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:15:54,964 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:54,965 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:54,965 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:54,966 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:55,708 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:55,761 - DEBUG - Edge anomaly scores shape: torch.Size([31952, 1])
2025-06-03 15:15:55,762 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:55,764 - DEBUG - Node reconstruction loss: 0.1037
2025-06-03 15:15:56,755 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0474
2025-06-03 15:15:56,891 - DEBUG - Step 5: Loss=0.0840
2025-06-03 15:15:56,891 - DEBUG - Online update step: 6/50
2025-06-03 15:15:56,916 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:56,917 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:15:56,917 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:56,918 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:15:56,918 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:56,918 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:15:56,919 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:15:56,919 - DEBUG - Applied edge dropout: 208 edges dropped.
2025-06-03 15:15:56,919 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:15:56,920 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:15:56,920 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:56,920 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:56,921 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:56,921 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:56,921 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:15:56,922 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:15:56,923 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:57,490 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:57,539 - DEBUG - Edge anomaly scores shape: torch.Size([32002, 1])
2025-06-03 15:15:57,541 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:57,541 - DEBUG - Node reconstruction loss: 0.0881
2025-06-03 15:15:58,430 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0410
2025-06-03 15:15:58,432 - DEBUG - Step 6: Loss=0.0714
2025-06-03 15:15:58,432 - DEBUG - Online update step: 7/50
2025-06-03 15:15:58,433 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:15:58,433 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:58,434 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:15:58,434 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-03 15:15:58,434 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:15:58,435 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:15:58,435 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:15:58,435 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:15:58,435 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:15:58,436 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:15:58,436 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:58,436 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:15:58,437 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:15:58,437 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:15:58,437 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:15:58,437 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:15:58,439 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:15:59,016 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:15:59,068 - DEBUG - Edge anomaly scores shape: torch.Size([32035, 1])
2025-06-03 15:15:59,069 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:15:59,070 - DEBUG - Node reconstruction loss: 0.0687
2025-06-03 15:16:00,120 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0507
2025-06-03 15:16:00,124 - DEBUG - Step 7: Loss=0.0557
2025-06-03 15:16:00,124 - DEBUG - Online update step: 8/50
2025-06-03 15:16:00,124 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:16:00,125 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:16:00,125 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:16:00,125 - DEBUG - Applied edge dropout: 244 edges dropped.
2025-06-03 15:16:00,126 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:00,126 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:16:00,127 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:16:00,127 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:16:00,127 - DEBUG - Applied edge dropout: 212 edges dropped.
2025-06-03 15:16:00,128 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:16:00,128 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:16:00,128 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:16:00,128 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:16:00,129 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:16:00,130 - DEBUG - Applied edge dropout: 243 edges dropped.
2025-06-03 15:16:00,130 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:16:00,132 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:00,761 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:00,846 - DEBUG - Edge anomaly scores shape: torch.Size([31996, 1])
2025-06-03 15:16:00,847 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:00,848 - DEBUG - Node reconstruction loss: 0.0863
2025-06-03 15:16:01,924 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0380
2025-06-03 15:16:01,930 - DEBUG - Step 8: Loss=0.0699
2025-06-03 15:16:01,930 - DEBUG - Online update step: 9/50
2025-06-03 15:16:01,931 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:16:01,932 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:16:01,933 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:16:01,933 - DEBUG - Applied edge dropout: 213 edges dropped.
2025-06-03 15:16:01,934 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:16:01,935 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:16:01,935 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:16:01,936 - DEBUG - Applied edge dropout: 245 edges dropped.
2025-06-03 15:16:01,936 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:16:01,937 - DEBUG - Applied edge dropout: 198 edges dropped.
2025-06-03 15:16:01,938 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:16:01,938 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:16:01,939 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:16:01,940 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:01,940 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:01,941 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:16:01,943 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:02,536 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:02,589 - DEBUG - Edge anomaly scores shape: torch.Size([31980, 1])
2025-06-03 15:16:02,590 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:02,590 - DEBUG - Node reconstruction loss: 0.0873
2025-06-03 15:16:03,945 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0365
2025-06-03 15:16:03,947 - DEBUG - Step 9: Loss=0.0707
2025-06-03 15:16:03,948 - DEBUG - Online update step: 10/50
2025-06-03 15:16:03,948 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:16:03,948 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:16:03,949 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:16:03,949 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:16:03,949 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:16:03,950 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:16:03,950 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:16:03,950 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:16:03,951 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:16:03,951 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:16:03,951 - DEBUG - Applied edge dropout: 223 edges dropped.
2025-06-03 15:16:03,952 - DEBUG - Applied edge dropout: 199 edges dropped.
2025-06-03 15:16:03,952 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:16:03,952 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:16:03,952 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:16:03,953 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:16:03,954 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:04,558 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:04,610 - DEBUG - Edge anomaly scores shape: torch.Size([32114, 1])
2025-06-03 15:16:04,611 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:04,612 - DEBUG - Node reconstruction loss: 0.0872
2025-06-03 15:16:05,810 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0354
2025-06-03 15:16:05,813 - DEBUG - Step 10: Loss=0.0707
2025-06-03 15:16:05,813 - DEBUG - Online update step: 11/50
2025-06-03 15:16:05,813 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:16:05,814 - DEBUG - Applied edge dropout: 190 edges dropped.
2025-06-03 15:16:05,814 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:16:05,815 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:05,815 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:16:05,815 - DEBUG - Applied edge dropout: 192 edges dropped.
2025-06-03 15:16:05,816 - DEBUG - Applied edge dropout: 206 edges dropped.
2025-06-03 15:16:05,816 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:16:05,816 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:16:05,816 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:16:05,817 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:16:05,818 - DEBUG - Applied edge dropout: 209 edges dropped.
2025-06-03 15:16:05,818 - DEBUG - Applied edge dropout: 220 edges dropped.
2025-06-03 15:16:05,819 - DEBUG - Applied edge dropout: 221 edges dropped.
2025-06-03 15:16:05,819 - DEBUG - Applied edge dropout: 240 edges dropped.
2025-06-03 15:16:05,819 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:16:05,821 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:06,440 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:06,490 - DEBUG - Edge anomaly scores shape: torch.Size([32021, 1])
2025-06-03 15:16:06,491 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:06,492 - DEBUG - Node reconstruction loss: 0.0896
2025-06-03 15:16:07,702 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0354
2025-06-03 15:16:07,809 - DEBUG - Step 11: Loss=0.0726
2025-06-03 15:16:07,810 - DEBUG - Online update step: 12/50
2025-06-03 15:16:07,811 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:16:07,811 - DEBUG - Applied edge dropout: 250 edges dropped.
2025-06-03 15:16:07,813 - DEBUG - Applied edge dropout: 234 edges dropped.
2025-06-03 15:16:07,814 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:07,818 - DEBUG - Applied edge dropout: 247 edges dropped.
2025-06-03 15:16:07,818 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:16:07,821 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:16:07,823 - DEBUG - Applied edge dropout: 207 edges dropped.
2025-06-03 15:16:07,823 - DEBUG - Applied edge dropout: 218 edges dropped.
2025-06-03 15:16:07,824 - DEBUG - Applied edge dropout: 235 edges dropped.
2025-06-03 15:16:07,825 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:16:07,826 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:16:07,826 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:16:07,827 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:16:07,828 - DEBUG - Applied edge dropout: 232 edges dropped.
2025-06-03 15:16:07,828 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:16:07,830 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:08,487 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:08,543 - DEBUG - Edge anomaly scores shape: torch.Size([31897, 1])
2025-06-03 15:16:08,544 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:08,545 - DEBUG - Node reconstruction loss: 0.0912
2025-06-03 15:16:09,846 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0326
2025-06-03 15:16:09,916 - DEBUG - Step 12: Loss=0.0739
2025-06-03 15:16:09,916 - DEBUG - Online update step: 13/50
2025-06-03 15:16:09,921 - DEBUG - Applied edge dropout: 224 edges dropped.
2025-06-03 15:16:09,922 - DEBUG - Applied edge dropout: 210 edges dropped.
2025-06-03 15:16:09,926 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:16:09,927 - DEBUG - Applied edge dropout: 231 edges dropped.
2025-06-03 15:16:09,928 - DEBUG - Applied edge dropout: 200 edges dropped.
2025-06-03 15:16:09,929 - DEBUG - Applied edge dropout: 248 edges dropped.
2025-06-03 15:16:09,933 - DEBUG - Applied edge dropout: 202 edges dropped.
2025-06-03 15:16:09,936 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:16:09,942 - DEBUG - Applied edge dropout: 255 edges dropped.
2025-06-03 15:16:09,943 - DEBUG - Applied edge dropout: 230 edges dropped.
2025-06-03 15:16:09,943 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:16:09,949 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:09,949 - DEBUG - Applied edge dropout: 226 edges dropped.
2025-06-03 15:16:09,950 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:16:09,951 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:16:09,952 - DEBUG - Applied edge dropout: 201 edges dropped.
2025-06-03 15:16:09,958 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:11,507 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:11,640 - DEBUG - Edge anomaly scores shape: torch.Size([31970, 1])
2025-06-03 15:16:11,685 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:11,702 - DEBUG - Node reconstruction loss: 0.0896
2025-06-03 15:16:13,569 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0299
2025-06-03 15:16:13,571 - DEBUG - Step 13: Loss=0.0726
2025-06-03 15:16:13,571 - DEBUG - Online update step: 14/50
2025-06-03 15:16:13,573 - DEBUG - Applied edge dropout: 227 edges dropped.
2025-06-03 15:16:13,574 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:16:13,574 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:13,574 - DEBUG - Applied edge dropout: 195 edges dropped.
2025-06-03 15:16:13,575 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:16:13,575 - DEBUG - Applied edge dropout: 228 edges dropped.
2025-06-03 15:16:13,575 - DEBUG - Applied edge dropout: 225 edges dropped.
2025-06-03 15:16:13,575 - DEBUG - Applied edge dropout: 242 edges dropped.
2025-06-03 15:16:13,576 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:16:13,580 - DEBUG - Applied edge dropout: 219 edges dropped.
2025-06-03 15:16:13,580 - DEBUG - Applied edge dropout: 217 edges dropped.
2025-06-03 15:16:13,581 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:16:13,581 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:16:13,581 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:16:13,582 - DEBUG - Applied edge dropout: 249 edges dropped.
2025-06-03 15:16:13,582 - DEBUG - Applied edge dropout: 214 edges dropped.
2025-06-03 15:16:13,583 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:14,308 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
2025-06-03 15:16:14,420 - DEBUG - Edge anomaly scores shape: torch.Size([31973, 1])
2025-06-03 15:16:14,457 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 15:16:14,458 - DEBUG - Node reconstruction loss: 0.0919
2025-06-03 15:16:16,768 - DEBUG - Gradient norms - Min: 0.0000, Max: 0.0437
2025-06-03 15:16:16,770 - DEBUG - Step 14: Loss=0.0744
2025-06-03 15:16:16,771 - DEBUG - Online update step: 15/50
2025-06-03 15:16:16,771 - DEBUG - Applied edge dropout: 238 edges dropped.
2025-06-03 15:16:16,772 - DEBUG - Applied edge dropout: 203 edges dropped.
2025-06-03 15:16:16,772 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:16:16,773 - DEBUG - Applied edge dropout: 204 edges dropped.
2025-06-03 15:16:16,773 - DEBUG - Applied edge dropout: 233 edges dropped.
2025-06-03 15:16:16,773 - DEBUG - Applied edge dropout: 236 edges dropped.
2025-06-03 15:16:16,774 - DEBUG - Applied edge dropout: 216 edges dropped.
2025-06-03 15:16:16,774 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:16:16,774 - DEBUG - Applied edge dropout: 211 edges dropped.
2025-06-03 15:16:16,775 - DEBUG - Applied edge dropout: 205 edges dropped.
2025-06-03 15:16:16,775 - DEBUG - Applied edge dropout: 237 edges dropped.
2025-06-03 15:16:16,776 - DEBUG - Applied edge dropout: 215 edges dropped.
2025-06-03 15:16:16,776 - DEBUG - Applied edge dropout: 181 edges dropped.
2025-06-03 15:16:16,776 - DEBUG - Applied edge dropout: 239 edges dropped.
2025-06-03 15:16:16,776 - DEBUG - Applied edge dropout: 229 edges dropped.
2025-06-03 15:16:16,777 - DEBUG - Applied edge dropout: 222 edges dropped.
2025-06-03 15:16:16,778 - DEBUG - Sampled batch from replay buffer (size: 16 graphs).
2025-06-03 15:16:17,350 - DEBUG - Node anomaly scores shape: torch.Size([16160, 1])
