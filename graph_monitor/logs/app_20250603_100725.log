2025-06-03 10:07:25,418 - INFO - Application logging to file: logs/app_20250603_100725.log
2025-06-03 10:07:25,418 - INFO - Starting to monitor directory: /home/lu/Desktop/output/ with log level: DEBUG
2025-06-03 10:07:25,419 - INFO - Starting processing of existing directory: /home/lu/Desktop/output/, Train Mode: train
2025-06-03 10:07:25,420 - INFO - 
--- Processing file: nw_graph_encoded_1748869365.dot (Timestamp: 2025-06-02 15:02:45) ---
2025-06-03 10:07:25,420 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 10:07:25,420 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869365.dot
2025-06-03 10:07:25,422 - INFO - Parsed 89 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-03 10:07:25,423 - INFO - Parsed 133 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869365.dot'.
2025-06-03 10:07:25,423 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:07:25,423 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:07:25,424 - DEBUG - Initial node features tensor shape: torch.Size([89, 30])
2025-06-03 10:07:25,427 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:07:25,427 - DEBUG - Node features tensor shape after scaling: torch.Size([89, 30])
2025-06-03 10:07:25,427 - DEBUG - Edge index tensor shape: torch.Size([2, 133])
2025-06-03 10:07:25,427 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:07:25,428 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 8
2025-06-03 10:07:25,428 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:07:25,428 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 10:07:25,429 - DEBUG - Shape of encoded categorical edge features: torch.Size([133, 3])
2025-06-03 10:07:25,429 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:07:25,429 - DEBUG - Shape of scaled numerical edge features: torch.Size([133, 7])
2025-06-03 10:07:25,429 - DEBUG - Final edge attributes tensor shape: torch.Size([133, 10])
2025-06-03 10:07:25,429 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:07:25,429 - INFO - Initializing HybridGNNAnomalyDetector with node_dim=30, edge_dim=10, hidden_dim=128, embedding_dim=64, heads=4, num_gat_layers=3, gat_heads=4, recon_loss_type=mse, edge_recon_loss_type=bce
2025-06-03 10:07:25,429 - INFO - Initializing GraphAutoencoder with node_dim=30, edge_dim=10, hidden_dim=128, embedding_dim=64, num_gat_layers=3, gat_heads=4
2025-06-03 10:07:25,465 - DEBUG - Encoder GATConv layers initialized with output dimension: 64
2025-06-03 10:07:25,466 - DEBUG - Decoder MLP layers initialized.
2025-06-03 10:07:25,466 - DEBUG - Anomaly scoring MLPs initialized.
2025-06-03 10:07:25,466 - INFO - Optimizer and scheduler initialized.
2025-06-03 10:07:25,466 - INFO - Replay buffer initialized with maxlen=1000, batch_size=32
2025-06-03 10:07:25,466 - INFO - RunningStats initialized.
2025-06-03 10:07:25,466 - INFO - RunningStats initialized.
2025-06-03 10:07:25,466 - INFO - Statistical controls initialized: drift_threshold=0.15
2025-06-03 10:07:25,467 - INFO - Using device: cpu
2025-06-03 10:07:25,467 - INFO - Initialized Hybrid GNN (node_dim=30, edge_dim=10)
2025-06-03 10:07:25,467 - INFO - Performing initial training for 100 epochs...
2025-06-03 10:07:25,478 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,478 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,478 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,490 - INFO - Epoch 1/100, Loss: 6.9518
2025-06-03 10:07:25,495 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,495 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,496 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,504 - INFO - Epoch 2/100, Loss: 6.3917
2025-06-03 10:07:25,509 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,509 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,509 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,517 - INFO - Epoch 3/100, Loss: 5.8857
2025-06-03 10:07:25,522 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,522 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,522 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,530 - INFO - Epoch 4/100, Loss: 5.3050
2025-06-03 10:07:25,535 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,535 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,535 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,543 - INFO - Epoch 5/100, Loss: 4.6134
2025-06-03 10:07:25,548 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,548 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,548 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,556 - INFO - Epoch 6/100, Loss: 3.8787
2025-06-03 10:07:25,561 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,562 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,562 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,569 - INFO - Epoch 7/100, Loss: 2.9601
2025-06-03 10:07:25,575 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,575 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,582 - INFO - Epoch 8/100, Loss: 2.2913
2025-06-03 10:07:25,587 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,588 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,588 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,598 - INFO - Epoch 9/100, Loss: 1.8715
2025-06-03 10:07:25,603 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,603 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,603 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,611 - INFO - Epoch 10/100, Loss: 1.8753
2025-06-03 10:07:25,616 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,617 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,617 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,625 - INFO - Epoch 11/100, Loss: 1.9682
2025-06-03 10:07:25,652 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,653 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,653 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,740 - INFO - Epoch 12/100, Loss: 1.8647
2025-06-03 10:07:25,759 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,759 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,760 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,798 - INFO - Epoch 13/100, Loss: 1.7741
2025-06-03 10:07:25,802 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,802 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,802 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,807 - INFO - Epoch 14/100, Loss: 1.6322
2025-06-03 10:07:25,810 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,811 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,811 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,815 - INFO - Epoch 15/100, Loss: 1.5517
2025-06-03 10:07:25,819 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,819 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,819 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,823 - INFO - Epoch 16/100, Loss: 1.6016
2025-06-03 10:07:25,826 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,827 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,827 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,866 - INFO - Epoch 17/100, Loss: 1.6193
2025-06-03 10:07:25,878 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,878 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,879 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,968 - INFO - Epoch 18/100, Loss: 1.6949
2025-06-03 10:07:25,974 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,974 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,975 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,984 - INFO - Epoch 19/100, Loss: 1.6798
2025-06-03 10:07:25,989 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:25,990 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:25,990 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:25,996 - INFO - Epoch 20/100, Loss: 1.5836
2025-06-03 10:07:26,001 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,001 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,001 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,005 - INFO - Epoch 21/100, Loss: 1.5525
2025-06-03 10:07:26,008 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,008 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,008 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,013 - INFO - Epoch 22/100, Loss: 1.4599
2025-06-03 10:07:26,015 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,015 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,016 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,023 - INFO - Epoch 23/100, Loss: 1.4218
2025-06-03 10:07:26,028 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,028 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,029 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,036 - INFO - Epoch 24/100, Loss: 1.4112
2025-06-03 10:07:26,041 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,041 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,042 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,049 - INFO - Epoch 25/100, Loss: 1.4109
2025-06-03 10:07:26,055 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,055 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,055 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,065 - INFO - Epoch 26/100, Loss: 1.3804
2025-06-03 10:07:26,070 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,070 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,071 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,232 - INFO - Epoch 27/100, Loss: 1.4454
2025-06-03 10:07:26,236 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,237 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,237 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,278 - INFO - Epoch 28/100, Loss: 1.4064
2025-06-03 10:07:26,284 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,284 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,285 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,293 - INFO - Epoch 29/100, Loss: 1.3961
2025-06-03 10:07:26,298 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,298 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,299 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,307 - INFO - Epoch 30/100, Loss: 1.3959
2025-06-03 10:07:26,312 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,313 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,313 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,321 - INFO - Epoch 31/100, Loss: 1.3817
2025-06-03 10:07:26,327 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,327 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,327 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,335 - INFO - Epoch 32/100, Loss: 1.3654
2025-06-03 10:07:26,340 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,340 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,340 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,348 - INFO - Epoch 33/100, Loss: 1.3808
2025-06-03 10:07:26,353 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,353 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,353 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,361 - INFO - Epoch 34/100, Loss: 1.3686
2025-06-03 10:07:26,367 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,367 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,367 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,375 - INFO - Epoch 35/100, Loss: 1.3467
2025-06-03 10:07:26,380 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,380 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,381 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,428 - INFO - Epoch 36/100, Loss: 1.3334
2025-06-03 10:07:26,434 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,436 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,437 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,557 - INFO - Epoch 37/100, Loss: 1.3490
2025-06-03 10:07:26,560 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,560 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,561 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,565 - INFO - Epoch 38/100, Loss: 1.3268
2025-06-03 10:07:26,568 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,568 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,569 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,572 - INFO - Epoch 39/100, Loss: 1.3137
2025-06-03 10:07:26,575 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,575 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,575 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,604 - INFO - Epoch 40/100, Loss: 1.3291
2025-06-03 10:07:26,608 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,608 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,608 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,612 - INFO - Epoch 41/100, Loss: 1.3177
2025-06-03 10:07:26,615 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,615 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,615 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,620 - INFO - Epoch 42/100, Loss: 1.3033
2025-06-03 10:07:26,624 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,624 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,624 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,628 - INFO - Epoch 43/100, Loss: 1.2883
2025-06-03 10:07:26,631 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,632 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,632 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,636 - INFO - Epoch 44/100, Loss: 1.2808
2025-06-03 10:07:26,639 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,639 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,639 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,772 - INFO - Epoch 45/100, Loss: 1.2866
2025-06-03 10:07:26,778 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,779 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,779 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,788 - INFO - Epoch 46/100, Loss: 1.2737
2025-06-03 10:07:26,794 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,794 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,794 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,803 - INFO - Epoch 47/100, Loss: 1.2602
2025-06-03 10:07:26,808 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,809 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,809 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,817 - INFO - Epoch 48/100, Loss: 1.2506
2025-06-03 10:07:26,822 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,823 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,823 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,831 - INFO - Epoch 49/100, Loss: 1.2388
2025-06-03 10:07:26,837 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,837 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,837 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:26,845 - INFO - Epoch 50/100, Loss: 1.2313
2025-06-03 10:07:26,983 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:26,984 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:26,985 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,028 - INFO - Epoch 51/100, Loss: 1.2209
2025-06-03 10:07:27,034 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,034 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,034 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,044 - INFO - Epoch 52/100, Loss: 1.2102
2025-06-03 10:07:27,050 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,050 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,051 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,059 - INFO - Epoch 53/100, Loss: 1.1983
2025-06-03 10:07:27,065 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,065 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,066 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,074 - INFO - Epoch 54/100, Loss: 1.1978
2025-06-03 10:07:27,081 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,082 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,082 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,093 - INFO - Epoch 55/100, Loss: 1.1784
2025-06-03 10:07:27,098 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,099 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,099 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,108 - INFO - Epoch 56/100, Loss: 1.1751
2025-06-03 10:07:27,115 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,115 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,115 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,140 - INFO - Epoch 57/100, Loss: 1.1661
2025-06-03 10:07:27,145 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,146 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,146 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,152 - INFO - Epoch 58/100, Loss: 1.1480
2025-06-03 10:07:27,155 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,155 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,155 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,162 - INFO - Epoch 59/100, Loss: 1.1387
2025-06-03 10:07:27,167 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,167 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,168 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,251 - INFO - Epoch 60/100, Loss: 1.1226
2025-06-03 10:07:27,306 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,307 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,307 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,345 - INFO - Epoch 61/100, Loss: 1.1101
2025-06-03 10:07:27,349 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,350 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,350 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,380 - INFO - Epoch 62/100, Loss: 1.1132
2025-06-03 10:07:27,386 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,386 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,386 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,396 - INFO - Epoch 63/100, Loss: 1.0929
2025-06-03 10:07:27,402 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,402 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,402 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,411 - INFO - Epoch 64/100, Loss: 1.0817
2025-06-03 10:07:27,417 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,418 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,418 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,428 - INFO - Epoch 65/100, Loss: 1.0708
2025-06-03 10:07:27,434 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,434 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,434 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,443 - INFO - Epoch 66/100, Loss: 1.0692
2025-06-03 10:07:27,449 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,450 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,461 - INFO - Epoch 67/100, Loss: 1.0443
2025-06-03 10:07:27,474 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,475 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,475 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,520 - INFO - Epoch 68/100, Loss: 1.0369
2025-06-03 10:07:27,545 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,546 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,546 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,587 - INFO - Epoch 69/100, Loss: 1.0273
2025-06-03 10:07:27,593 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,593 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,593 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,622 - INFO - Epoch 70/100, Loss: 1.0157
2025-06-03 10:07:27,628 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,628 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,629 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,637 - INFO - Epoch 71/100, Loss: 1.0194
2025-06-03 10:07:27,643 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,643 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,643 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,651 - INFO - Epoch 72/100, Loss: 0.9998
2025-06-03 10:07:27,656 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,657 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,657 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,665 - INFO - Epoch 73/100, Loss: 0.9898
2025-06-03 10:07:27,671 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,674 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,675 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,765 - INFO - Epoch 74/100, Loss: 0.9907
2025-06-03 10:07:27,784 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,785 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,785 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,794 - INFO - Epoch 75/100, Loss: 0.9783
2025-06-03 10:07:27,800 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,800 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,800 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,808 - INFO - Epoch 76/100, Loss: 0.9696
2025-06-03 10:07:27,814 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,814 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,814 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,824 - INFO - Epoch 77/100, Loss: 0.9694
2025-06-03 10:07:27,831 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,831 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,831 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,839 - INFO - Epoch 78/100, Loss: 0.9529
2025-06-03 10:07:27,844 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,844 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,845 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,853 - INFO - Epoch 79/100, Loss: 0.9606
2025-06-03 10:07:27,859 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,860 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,860 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,868 - INFO - Epoch 80/100, Loss: 0.9440
2025-06-03 10:07:27,874 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,874 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,875 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:27,903 - INFO - Epoch 81/100, Loss: 0.9322
2025-06-03 10:07:27,917 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:27,918 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:27,919 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,011 - INFO - Epoch 82/100, Loss: 0.9250
2025-06-03 10:07:28,047 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,047 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,048 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,088 - INFO - Epoch 83/100, Loss: 0.9064
2025-06-03 10:07:28,094 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,094 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,094 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,102 - INFO - Epoch 84/100, Loss: 0.9098
2025-06-03 10:07:28,107 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,107 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,108 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,229 - INFO - Epoch 85/100, Loss: 0.8960
2025-06-03 10:07:28,235 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,235 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,235 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,244 - INFO - Epoch 86/100, Loss: 0.9037
2025-06-03 10:07:28,251 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,251 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,252 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,261 - INFO - Epoch 87/100, Loss: 0.8833
2025-06-03 10:07:28,266 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,267 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,267 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,275 - INFO - Epoch 88/100, Loss: 0.8747
2025-06-03 10:07:28,280 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,281 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,281 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,290 - INFO - Epoch 89/100, Loss: 0.8680
2025-06-03 10:07:28,295 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,296 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,296 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,302 - INFO - Epoch 90/100, Loss: 0.8576
2025-06-03 10:07:28,304 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,304 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,305 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,308 - INFO - Epoch 91/100, Loss: 0.8591
2025-06-03 10:07:28,311 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,311 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,317 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,439 - INFO - Epoch 92/100, Loss: 0.8432
2025-06-03 10:07:28,443 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,443 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,443 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,447 - INFO - Epoch 93/100, Loss: 0.8423
2025-06-03 10:07:28,450 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,450 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,450 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,457 - INFO - Epoch 94/100, Loss: 0.8297
2025-06-03 10:07:28,462 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,463 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,463 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,467 - INFO - Epoch 95/100, Loss: 0.8139
2025-06-03 10:07:28,471 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,471 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,471 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,476 - INFO - Epoch 96/100, Loss: 0.8178
2025-06-03 10:07:28,479 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,479 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,480 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,484 - INFO - Epoch 97/100, Loss: 0.8122
2025-06-03 10:07:28,487 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,487 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,487 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,491 - INFO - Epoch 98/100, Loss: 0.8020
2025-06-03 10:07:28,494 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,495 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,495 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,499 - INFO - Epoch 99/100, Loss: 0.7996
2025-06-03 10:07:28,502 - DEBUG - Node anomaly scores shape: torch.Size([89, 1])
2025-06-03 10:07:28,502 - DEBUG - Edge anomaly scores shape: torch.Size([133, 1])
2025-06-03 10:07:28,502 - DEBUG - Global anomaly score shape: torch.Size([1, 1])
2025-06-03 10:07:28,507 - INFO - Epoch 100/100, Loss: 0.7905
2025-06-03 10:07:28,507 - INFO - Initial training complete.
2025-06-03 10:07:28,507 - INFO - No checkpoint found. Starting from scratch.
2025-06-03 10:07:28,507 - INFO - Starting or resuming online updates from step: 0
2025-06-03 10:07:28,507 - INFO - No running statistics file found. Starting with new statistics.
2025-06-03 10:07:28,507 - INFO - Running anomaly detection...
2025-06-03 10:07:28,507 - INFO - Starting anomaly detection.
2025-06-03 10:07:28,511 - DEBUG - Node reconstruction errors: [0.03404479 0.03404553 0.03404503 0.06208611 0.03404466 0.11855412
 0.13837208 0.05843227 0.11568459 0.08904502 0.08066493 0.06849675
 0.03872817 0.03742502 0.05021109 0.58776087 0.05761825 0.06218003
 0.07866467 0.08587404 0.06218002 0.07619309 0.06735708 0.03326037
 1.6648129  0.11454178 0.04670434 0.03404576 0.06218    0.09459831
 0.05068043 0.11442785 0.54007393 0.3279977  0.81540674 0.8281486
 0.9668526  0.06695171 0.51048666 0.13929622 0.07484166 0.65865105
 0.4489408  0.03745241 0.04916955 0.08586502 1.3352401  0.02251875
 0.0438407  0.05593073 0.73513776 0.06758455 0.0442195  0.06695191
 0.1146001  0.07921457 0.07390215 0.04448897 0.5246079  0.339807
 0.3755985  0.07386325 0.5770403  0.07716264 0.34876645 0.08843359
 0.31262296 0.06735725 0.05512166 0.08446126 0.28677318 0.2591768
 0.04241579 0.03405141 1.697246   0.4152216  0.0559307  0.08611046
 0.7146273  0.04422162 0.05029355 0.07256566 0.06388511 0.03745323
 0.09569588 0.08468075 0.07604373 0.05888829 0.27602556]
2025-06-03 10:07:28,511 - DEBUG - Edge reconstruction errors: [0.14676861 0.75940675 0.7622051  0.69112545 0.8911256  0.76933104
 5.8784637  0.5549895  1.0696032  1.1696049  0.8690497  0.8784514
 0.9835229  0.795019   0.7697213  0.85288906 0.75726813 0.25291514
 0.9935105  0.7627584  0.6712144  0.87121534 0.7620826  0.75780416
 0.83224607 0.7574857  0.7639613  0.79200757 0.79133403 0.7737084
 0.81319124 0.7703607  0.66452545 0.86452556 0.66774076 0.86774117
 0.67598933 0.8759897  0.6754776  0.87547773 0.6685304  0.86853063
 0.66141534 0.8614154  0.7265468  0.92654705 0.5894753  0.9528025
 0.6828808  0.85635006 0.75767106 0.8535374  1.2346927  1.6315997
 0.25472912 0.65161026 0.2516244  0.87628126 0.9544495  0.5544442
 0.86006284 0.8554956  0.86051214 0.25186718 0.29857406 1.1632468
 0.80607384 0.7760601  0.78456455 0.7695624  0.7636772  2.777041
 0.8721277  0.8420002  0.3710787  0.9805539  1.1805552  0.25472414
 0.8373712  0.7644172  0.786664   1.12105    3.272433   0.76681435
 0.7654915  0.47978473 0.25329188 0.76030743 2.6329575  0.15138286
 0.85945326 0.25131267 0.25160977 0.25162426 0.2517853  0.7772978
 0.8485562  0.7643552  0.7719825  0.79551977 0.83372957 0.25210288
 0.7660427  0.85383767 0.25164557 0.78860986 0.77821434 0.2792829
 0.76518077 1.0112351  0.77672243 0.66805303 0.86805326 0.7598285
 0.7581531  0.85598856 0.8196846  0.55497885 1.5965812  0.7594809
 0.7796262  0.76035416 0.8530607  0.25149697 0.78523296 0.7620718
 0.8347462  0.25290936 0.7627461  0.9164636  0.6549927  0.79086965
 0.7606171 ]
2025-06-03 10:07:28,512 - INFO - Anomalies saved to: anomaly_logs/anomalies_20250603_100728_update_1.json
2025-06-03 10:07:28,512 - INFO - Running statistics saved to stats/running_stats.pkl
2025-06-03 10:07:28,521 - INFO - Checkpoint saved to model_checkpoints/checkpoint_20250603_100728_update_1.pth and as latest_checkpoint.pth
2025-06-03 10:07:28,521 - INFO - 
Global anomaly score (after nw_graph_encoded_1748869365.dot): 0.3573
2025-06-03 10:07:28,521 - WARNING - Detected 3 anomalous nodes (reconstruction-based):
2025-06-03 10:07:28,521 - WARNING -   Node ID: 162.159.61.3, Recon Error: 1.6648, MLP Score: 0.4694
2025-06-03 10:07:28,522 - WARNING -   Node ID: 192.168.27.10, Recon Error: 1.3352, MLP Score: 0.5092
2025-06-03 10:07:28,522 - WARNING -   Node ID: 192.168.239.101, Recon Error: 1.6972, MLP Score: 0.4901
2025-06-03 10:07:28,522 - WARNING - Detected 4 anomalous edges (reconstruction-based):
2025-06-03 10:07:28,522 - WARNING -   Source: 192.168.27.12, Target: 1.1.1.1, Recon Error: 5.8785, MLP Score: 0.5025
2025-06-03 10:07:28,522 - WARNING -   Source: 192.168.27.10, Target: 13.85.23.206, Recon Error: 2.7770, MLP Score: 0.5131
2025-06-03 10:07:28,522 - WARNING -   Source: 192.168.27.10, Target: 199.232.214.172, Recon Error: 3.2724, MLP Score: 0.5144
2025-06-03 10:07:28,522 - WARNING -   Source: 192.168.27.10, Target: 113.171.234.51, Recon Error: 2.6330, MLP Score: 0.4955
2025-06-03 10:07:28,522 - ERROR - Error during periodic embedding export: expected str, bytes or os.PathLike object, not NoneType
2025-06-03 10:07:28,522 - INFO - Performing visualization of node and edge features.
2025-06-03 10:07:28,522 - INFO - Starting visualization of node features.
2025-06-03 10:07:28,523 - INFO - Graph has 89 nodes and 30 features.
2025-06-03 10:07:28,523 - INFO - Feature names: ever_connected_to_privileged_port, ever_listened_on_privileged_port, first_seen_hour_minute_cos, first_seen_hour_minute_sin, has_http_error_4xx, has_http_error_5xx, has_ssl_history, has_ssl_resumption, has_ssl_server_name, incoming_connection_ratio, last_seen_hour_minute_cos, last_seen_hour_minute_sin, most_freq_conn_state, most_freq_http_version, most_freq_proto, most_freq_ssl_version, outgoing_connection_ratio, service_1, service_2, service_3, top_proto_1, top_user_agent_1, unique_http_status_codes_seen, unique_http_versions_used, unique_local_ports_listening_on, unique_local_ports_used, unique_remote_ports_connected_from, unique_remote_ports_connected_to, unique_ssl_ciphers_used, unique_ssl_versions_used
2025-06-03 10:07:28,523 - INFO - Calculating feature statistics:
2025-06-03 10:07:28,525 - INFO - - ever_connected_to_privileged_port: {'name': 'ever_connected_to_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,525 - INFO - - ever_listened_on_privileged_port: {'name': 'ever_listened_on_privileged_port', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,525 - INFO - - first_seen_hour_minute_cos: {'name': 'first_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(-1.6240591e-08), 'std': np.float32(1.0), 'min': np.float32(-1.3339475), 'max': np.float32(1.5135604)}
2025-06-03 10:07:28,525 - INFO - - first_seen_hour_minute_sin: {'name': 'first_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(-1.3645446e-08), 'std': np.float32(0.99999994), 'min': np.float32(-1.5060302), 'max': np.float32(1.3409579)}
2025-06-03 10:07:28,526 - INFO - - has_http_error_4xx: {'name': 'has_http_error_4xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,526 - INFO - - has_http_error_5xx: {'name': 'has_http_error_5xx', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,526 - INFO - - has_ssl_history: {'name': 'has_ssl_history', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,526 - INFO - - has_ssl_resumption: {'name': 'has_ssl_resumption', 'unique': 2, 'mean': np.float32(-1.8417165e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.18677184), 'max': np.float32(5.354126)}
2025-06-03 10:07:28,526 - INFO - - has_ssl_server_name: {'name': 'has_ssl_server_name', 'unique': 2, 'mean': np.float32(-1.6073162e-08), 'std': np.float32(1.0), 'min': np.float32(-0.9242114), 'max': np.float32(1.0820036)}
2025-06-03 10:07:28,526 - INFO - - incoming_connection_ratio: {'name': 'incoming_connection_ratio', 'unique': 3, 'mean': np.float32(2.3105171e-08), 'std': np.float32(0.9999999), 'min': np.float32(-4.0625086), 'max': np.float32(0.25681368)}
2025-06-03 10:07:28,527 - INFO - - last_seen_hour_minute_cos: {'name': 'last_seen_hour_minute_cos', 'unique': 5, 'mean': np.float32(3.4825185e-08), 'std': np.float32(1.0), 'min': np.float32(-1.727558), 'max': np.float32(1.0981954)}
2025-06-03 10:07:28,527 - INFO - - last_seen_hour_minute_sin: {'name': 'last_seen_hour_minute_sin', 'unique': 5, 'mean': np.float32(3.6499472e-08), 'std': np.float32(1.0), 'min': np.float32(-1.0945183), 'max': np.float32(1.7363071)}
2025-06-03 10:07:28,527 - INFO - - most_freq_conn_state: {'name': 'most_freq_conn_state', 'unique': 7, 'mean': np.float32(2.7977529), 'std': np.float32(1.4929029), 'min': np.float32(0.0), 'max': np.float32(10.0)}
2025-06-03 10:07:28,527 - INFO - - most_freq_http_version: {'name': 'most_freq_http_version', 'unique': 2, 'mean': np.float32(2.8202248), 'std': np.float32(0.57204145), 'min': np.float32(1.0), 'max': np.float32(3.0)}
2025-06-03 10:07:28,527 - INFO - - most_freq_proto: {'name': 'most_freq_proto', 'unique': 3, 'mean': np.float32(0.21348314), 'std': np.float32(0.4613588), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:07:28,527 - INFO - - most_freq_ssl_version: {'name': 'most_freq_ssl_version', 'unique': 3, 'mean': np.float32(4.4044943), 'std': np.float32(0.73007774), 'min': np.float32(3.0), 'max': np.float32(5.0)}
2025-06-03 10:07:28,528 - INFO - - outgoing_connection_ratio: {'name': 'outgoing_connection_ratio', 'unique': 3, 'mean': np.float32(-2.3105171e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.25681368), 'max': np.float32(4.0625086)}
2025-06-03 10:07:28,528 - INFO - - service_1: {'name': 'service_1', 'unique': 5, 'mean': np.float32(1.9662921), 'std': np.float32(2.215621), 'min': np.float32(0.0), 'max': np.float32(8.0)}
2025-06-03 10:07:28,528 - INFO - - service_2: {'name': 'service_2', 'unique': 4, 'mean': np.float32(6.741573), 'std': np.float32(2.4288902), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:07:28,528 - INFO - - service_3: {'name': 'service_3', 'unique': 3, 'mean': np.float32(7.5617976), 'std': np.float32(1.6349763), 'min': np.float32(1.0), 'max': np.float32(8.0)}
2025-06-03 10:07:28,528 - INFO - - top_proto_1: {'name': 'top_proto_1', 'unique': 3, 'mean': np.float32(0.21348314), 'std': np.float32(0.4613588), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:07:28,528 - INFO - - top_user_agent_1: {'name': 'top_user_agent_1', 'unique': 1, 'mean': np.float32(8.0), 'std': np.float32(0.0), 'min': np.float32(8.0), 'max': np.float32(8.0)}
2025-06-03 10:07:28,529 - INFO - - unique_http_status_codes_seen: {'name': 'unique_http_status_codes_seen', 'unique': 3, 'mean': np.float32(1.1720014e-08), 'std': np.float32(1.0), 'min': np.float32(-0.29483095), 'max': np.float32(4.47607)}
2025-06-03 10:07:28,529 - INFO - - unique_http_versions_used: {'name': 'unique_http_versions_used', 'unique': 2, 'mean': np.float32(-7.0320088e-09), 'std': np.float32(1.0), 'min': np.float32(-0.3142697), 'max': np.float32(3.1819806)}
2025-06-03 10:07:28,529 - INFO - - unique_local_ports_listening_on: {'name': 'unique_local_ports_listening_on', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,529 - INFO - - unique_local_ports_used: {'name': 'unique_local_ports_used', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,529 - INFO - - unique_remote_ports_connected_from: {'name': 'unique_remote_ports_connected_from', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,530 - INFO - - unique_remote_ports_connected_to: {'name': 'unique_remote_ports_connected_to', 'unique': 1, 'mean': np.float32(0.0), 'std': np.float32(0.0), 'min': np.float32(0.0), 'max': np.float32(0.0)}
2025-06-03 10:07:28,530 - INFO - - unique_ssl_ciphers_used: {'name': 'unique_ssl_ciphers_used', 'unique': 4, 'mean': np.float32(2.611889e-08), 'std': np.float32(0.9999999), 'min': np.float32(-0.734376), 'max': np.float32(4.6010904)}
2025-06-03 10:07:28,530 - INFO - - unique_ssl_versions_used: {'name': 'unique_ssl_versions_used', 'unique': 4, 'mean': np.float32(2.745832e-08), 'std': np.float32(0.99999994), 'min': np.float32(-0.8399851), 'max': np.float32(4.143926)}
2025-06-03 10:07:28,543 - DEBUG - Loaded backend module://backend_interagg version unknown.
2025-06-03 10:07:28,576 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7c8141c04c20>
2025-06-03 10:07:28,734 - DEBUG - Plotted correlation matrix of node features.
2025-06-03 10:07:28,791 - DEBUG - Plotted ranges of node feature values.
2025-06-03 10:07:28,824 - DEBUG - Plotted sparsity of node features.
2025-06-03 10:07:30,061 - INFO - Node feature visualization saved to vis/node_features_20250603_100728.png
2025-06-03 10:07:30,061 - INFO - Finished visualization of node features.
2025-06-03 10:07:30,061 - INFO - Performing additional feature analysis:
2025-06-03 10:07:30,061 - INFO - - Maximum correlation between different features: nan
2025-06-03 10:07:30,062 - INFO - Starting visualization of edge features.
2025-06-03 10:07:30,062 - INFO - Graph has 133 edges and 10 edge features.
2025-06-03 10:07:30,062 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:07:30,062 - INFO - Calculating edge feature statistics:
2025-06-03 10:07:30,062 - INFO - Showing statistics for the first 5 and last 5 edge features:
2025-06-03 10:07:30,062 - INFO - - count: {'name': 'count', 'unique': 8, 'mean': np.float32(3.5639098), 'std': np.float32(1.4160911), 'min': np.float32(0.0), 'max': np.float32(7.0)}
2025-06-03 10:07:30,062 - INFO - - dst_port: {'name': 'dst_port', 'unique': 3, 'mean': np.float32(1.2255639), 'std': np.float32(0.43557137), 'min': np.float32(0.0), 'max': np.float32(2.0)}
2025-06-03 10:07:30,062 - INFO - - protocol: {'name': 'protocol', 'unique': 6, 'mean': np.float32(3.4586465), 'std': np.float32(1.9792581), 'min': np.float32(0.0), 'max': np.float32(5.0)}
2025-06-03 10:07:30,062 - INFO - - service: {'name': 'service', 'unique': 13, 'mean': np.float32(-1.43409675e-08), 'std': np.float32(1.0), 'min': np.float32(-0.13801745), 'max': np.float32(10.9908285)}
2025-06-03 10:07:30,062 - INFO - - total_orig_bytes: {'name': 'total_orig_bytes', 'unique': 100, 'mean': np.float32(5.3778626e-09), 'std': np.float32(1.0), 'min': np.float32(-0.23179126), 'max': np.float32(9.476409)}
2025-06-03 10:07:30,062 - INFO - - total_orig_ip_bytes: {'name': 'total_orig_ip_bytes', 'unique': 112, 'mean': np.float32(3.5852419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.25956312), 'max': np.float32(7.983913)}
2025-06-03 10:07:30,062 - INFO - - total_orig_pkts: {'name': 'total_orig_pkts', 'unique': 60, 'mean': np.float32(0.0), 'std': np.float32(1.0), 'min': np.float32(-0.20947704), 'max': np.float32(10.808742)}
2025-06-03 10:07:30,062 - INFO - - total_resp_bytes: {'name': 'total_resp_bytes', 'unique': 97, 'mean': np.float32(3.5852419e-09), 'std': np.float32(1.0), 'min': np.float32(-0.2045888), 'max': np.float32(8.801429)}
2025-06-03 10:07:30,062 - INFO - - total_resp_ip_bytes: {'name': 'total_resp_ip_bytes', 'unique': 109, 'mean': np.float32(3.5852419e-09), 'std': np.float32(0.99999994), 'min': np.float32(-0.21361978), 'max': np.float32(8.714024)}
2025-06-03 10:07:30,062 - INFO - - total_resp_pkts: {'name': 'total_resp_pkts', 'unique': 66, 'mean': np.float32(8.963104e-09), 'std': np.float32(1.0), 'min': np.float32(-0.23307015), 'max': np.float32(10.26763)}
2025-06-03 10:07:30,073 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7c813bfcc650>
2025-06-03 10:07:30,133 - DEBUG - Plotted heatmap of the first 10 edge features.
2025-06-03 10:07:30,142 - DEBUG - locator: <matplotlib.ticker.AutoLocator object at 0x7c813bfe2a80>
2025-06-03 10:07:30,205 - DEBUG - Plotted correlation matrix of non-constant edge features.
2025-06-03 10:07:30,504 - DEBUG - Plotted distributions of the top 10 variable edge features.
2025-06-03 10:07:30,612 - DEBUG - Plotted boxplots of the first 10 non-constant edge features.
2025-06-03 10:07:30,624 - DEBUG - Plotted sparsity of edge features.
2025-06-03 10:07:30,639 - DEBUG - Applied PCA for dimensionality reduction of non-constant edge features.
2025-06-03 10:07:31,788 - INFO - Edge feature visualization saved to vis/edge_features_20250603_100730.png
2025-06-03 10:07:31,788 - INFO - Finished visualization of edge features.
2025-06-03 10:07:31,788 - INFO - Performing additional edge feature analysis:
2025-06-03 10:07:31,788 - INFO - - Highest correlation (1.00) between features: 'total_resp_bytes' and 'total_resp_ip_bytes'.
2025-06-03 10:07:31,789 - INFO - Starting visualization of all edge features with 3D PCA.
2025-06-03 10:07:31,789 - INFO - Graph has 133 edges and 10 edge features.
2025-06-03 10:07:31,789 - INFO - Edge feature names: count, dst_port, protocol, service, total_orig_bytes, total_orig_ip_bytes, total_orig_pkts, total_resp_bytes, total_resp_ip_bytes, total_resp_pkts
2025-06-03 10:07:32,082 - INFO - Summary statistics plot saved to vis/all_edge_features_3d_pca_20250603_100731_summary.png
2025-06-03 10:07:32,260 - INFO - PCA (3D) plot saved to vis/all_edge_features_3d_pca_20250603_100731_pca_3d.png
2025-06-03 10:07:32,420 - INFO - PCA explained variance ratio plot saved to vis/all_edge_features_3d_pca_20250603_100731_pca_variance.png
2025-06-03 10:07:32,420 - INFO - Finished visualization of all edge features with 3D PCA.
2025-06-03 10:07:32,420 - INFO - 
--- Processing file: nw_graph_encoded_1748869395.dot (Timestamp: 2025-06-02 15:03:15) ---
2025-06-03 10:07:32,420 - INFO - Processing update from: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:07:32,420 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:07:32,423 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:07:32,425 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:07:32,425 - INFO - Updating NetworkX graph from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:07:32,425 - INFO - Processing .dot file: /home/lu/Desktop/output/nw_graph_encoded_1748869395.dot
2025-06-03 10:07:32,427 - INFO - Parsed 129 nodes from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:07:32,429 - INFO - Parsed 186 edges from '/home/lu/Desktop/output/nw_graph_encoded_1748869395.dot'.
2025-06-03 10:07:32,429 - INFO - Processing node updates/additions.
2025-06-03 10:07:32,430 - INFO - Processing edge updates/additions.
2025-06-03 10:07:32,431 - INFO - Processing deletions (nodes and edges).
2025-06-03 10:07:32,431 - INFO - Finished updating NetworkX graph.
2025-06-03 10:07:32,431 - INFO - Starting NetworkX to PyG conversion.
2025-06-03 10:07:32,431 - DEBUG - Sorted node attribute keys: ['ever_connected_to_privileged_port', 'ever_listened_on_privileged_port', 'first_seen_hour_minute_cos', 'first_seen_hour_minute_sin', 'has_http_error_4xx', 'has_http_error_5xx', 'has_ssl_history', 'has_ssl_resumption', 'has_ssl_server_name', 'incoming_connection_ratio', 'last_seen_hour_minute_cos', 'last_seen_hour_minute_sin', 'most_freq_conn_state', 'most_freq_http_version', 'most_freq_proto', 'most_freq_ssl_version', 'outgoing_connection_ratio', 'service_1', 'service_2', 'service_3', 'top_proto_1', 'top_user_agent_1', 'unique_http_status_codes_seen', 'unique_http_versions_used', 'unique_local_ports_listening_on', 'unique_local_ports_used', 'unique_remote_ports_connected_from', 'unique_remote_ports_connected_to', 'unique_ssl_ciphers_used', 'unique_ssl_versions_used']
2025-06-03 10:07:32,432 - DEBUG - Initial node features tensor shape: torch.Size([129, 30])
2025-06-03 10:07:32,433 - INFO - Numerical Node Features (x) after initial standard scaling.
2025-06-03 10:07:32,433 - DEBUG - Node features tensor shape after scaling: torch.Size([129, 30])
2025-06-03 10:07:32,433 - DEBUG - Edge index tensor shape: torch.Size([2, 186])
2025-06-03 10:07:32,433 - DEBUG - Sorted edge attribute keys: ['count', 'dst_port', 'protocol', 'service', 'total_orig_bytes', 'total_orig_ip_bytes', 'total_orig_pkts', 'total_resp_bytes', 'total_resp_ip_bytes', 'total_resp_pkts']
2025-06-03 10:07:32,434 - INFO - Fitted and transformed categorical edge feature: dst_port. Unique values: 9
2025-06-03 10:07:32,434 - INFO - Fitted and transformed categorical edge feature: protocol. Unique values: 3
2025-06-03 10:07:32,434 - INFO - Fitted and transformed categorical edge feature: service. Unique values: 6
2025-06-03 10:07:32,434 - DEBUG - Shape of encoded categorical edge features: torch.Size([186, 3])
2025-06-03 10:07:32,435 - INFO - Numerical Edge Attributes after initial standard scaling.
2025-06-03 10:07:32,435 - DEBUG - Shape of scaled numerical edge features: torch.Size([186, 7])
2025-06-03 10:07:32,435 - DEBUG - Final edge attributes tensor shape: torch.Size([186, 10])
2025-06-03 10:07:32,435 - INFO - Successfully converted NetworkX graph to PyG Data object.
2025-06-03 10:07:32,435 - INFO - Performing online update...
2025-06-03 10:07:32,435 - INFO - Starting online update for 50 steps.
